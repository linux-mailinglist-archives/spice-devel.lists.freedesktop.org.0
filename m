Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 30FE49E3F7
	for <lists+spice-devel@lfdr.de>; Tue, 27 Aug 2019 11:23:27 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 9596C8989E;
	Tue, 27 Aug 2019 09:23:25 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id B07DB8989E
 for <spice-devel@lists.freedesktop.org>; Tue, 27 Aug 2019 09:23:23 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx04.intmail.prod.int.phx2.redhat.com
 [10.5.11.14])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id 57BCA3084242;
 Tue, 27 Aug 2019 09:23:23 +0000 (UTC)
Received: from fziglio.remote.csb (ovpn-204-114.brq.redhat.com [10.40.204.114])
 by smtp.corp.redhat.com (Postfix) with ESMTP id A6F275D9CC;
 Tue, 27 Aug 2019 09:23:18 +0000 (UTC)
From: Frediano Ziglio <fziglio@redhat.com>
To: spice-devel@lists.freedesktop.org
Date: Tue, 27 Aug 2019 10:22:26 +0100
Message-Id: <20190827092246.10276-10-fziglio@redhat.com>
In-Reply-To: <20190827092246.10276-1-fziglio@redhat.com>
References: <20190827092246.10276-1-fziglio@redhat.com>
MIME-Version: 1.0
X-Scanned-By: MIMEDefang 2.79 on 10.5.11.14
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16
 (mx1.redhat.com [10.5.110.40]); Tue, 27 Aug 2019 09:23:23 +0000 (UTC)
Subject: [Spice-devel] [PATCH spice-gtk v4 09/29] usb-redir: add files for
 SCSI and USB MSC implementation
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Alexander Nezhinsky <anezhins@redhat.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

RnJvbTogWXVyaSBCZW5kaXRvdmljaCA8eXVyaS5iZW5kaXRvdmljaEBkYXluaXguY29tPgoKRmls
ZXMgYWRkZWQgd2l0aG91dCBpbmNsdWRpbmcgdGhlbSBpbiBjb21waWxhdGlvbi4KVGhleSBjb250
YWluIGltcGxlbWVudGF0aW9uIG9mIFNDU0kgY29tbWFuZHMgZm9yIGxvZ2ljYWwKdW5pdHMgb2Yg
bWFzcy1zdG9yYWdlIGRldmljZSBjbGFzcyBhbmQgVVNCIGJ1bGstb25seQptYXNzLXN0b3JhZ2Ug
ZGV2aWNlIHByb3RvY29sLgoKU2lnbmVkLW9mZi1ieTogQWxleGFuZGVyIE5lemhpbnNreTxhbmV6
aGluc0ByZWRoYXQuY29tPgpTaWduZWQtb2ZmLWJ5OiBZdXJpIEJlbmRpdG92aWNoIDx5dXJpLmJl
bmRpdG92aWNoQGRheW5peC5jb20+Ci0tLQogc3JjL2NkLXNjc2ktZGV2LXBhcmFtcy5oIHwgICA0
OSArCiBzcmMvY2Qtc2NzaS5jICAgICAgICAgICAgfCAyNzQwICsrKysrKysrKysrKysrKysrKysr
KysrKysrKysrKysrKysrKysrCiBzcmMvY2Qtc2NzaS5oICAgICAgICAgICAgfCAgMTIwICsrCiBz
cmMvY2QtdXNiLWJ1bGstbXNkLmMgICAgfCAgNTQ0ICsrKysrKysrCiBzcmMvY2QtdXNiLWJ1bGst
bXNkLmggICAgfCAgMTM0ICsrCiBzcmMvc2NzaS1jb25zdGFudHMuaCAgICAgfCAgMzI0ICsrKysr
CiA2IGZpbGVzIGNoYW5nZWQsIDM5MTEgaW5zZXJ0aW9ucygrKQogY3JlYXRlIG1vZGUgMTAwNjQ0
IHNyYy9jZC1zY3NpLWRldi1wYXJhbXMuaAogY3JlYXRlIG1vZGUgMTAwNjQ0IHNyYy9jZC1zY3Np
LmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBzcmMvY2Qtc2NzaS5oCiBjcmVhdGUgbW9kZSAxMDA2NDQg
c3JjL2NkLXVzYi1idWxrLW1zZC5jCiBjcmVhdGUgbW9kZSAxMDA2NDQgc3JjL2NkLXVzYi1idWxr
LW1zZC5oCiBjcmVhdGUgbW9kZSAxMDA2NDQgc3JjL3Njc2ktY29uc3RhbnRzLmgKCmRpZmYgLS1n
aXQgYS9zcmMvY2Qtc2NzaS1kZXYtcGFyYW1zLmggYi9zcmMvY2Qtc2NzaS1kZXYtcGFyYW1zLmgK
bmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAuLmI0ODBiY2RjCi0tLSAvZGV2L251
bGwKKysrIGIvc3JjL2NkLXNjc2ktZGV2LXBhcmFtcy5oCkBAIC0wLDAgKzEsNDkgQEAKKy8qIC0q
LSBNb2RlOiBDOyBjLWJhc2ljLW9mZnNldDogNDsgaW5kZW50LXRhYnMtbW9kZTogbmlsIC0qLSAq
LworLyoKKyAgIENEIFNDU0kgZGV2aWNlIHBhcmFtZXRlcnMKKworICAgQ29weXJpZ2h0IChDKSAy
MDE4IFJlZCBIYXQsIEluYy4KKworICAgUmVkIEhhdCBBdXRob3JzOgorICAgQWxleGFuZGVyIE5l
emhpbnNreTxhbmV6aGluc0ByZWRoYXQuY29tPgorCisgICBUaGlzIGxpYnJhcnkgaXMgZnJlZSBz
b2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yCisgICBtb2RpZnkgaXQgdW5k
ZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCisgICBMaWNlbnNl
IGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIKKyAg
IHZlcnNpb24gMi4xIG9mIHRoZSBMaWNlbnNlLCBvciAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRl
ciB2ZXJzaW9uLgorCisgICBUaGlzIGxpYnJhcnkgaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUg
dGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKKyAgIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0
aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCisgICBNRVJDSEFOVEFCSUxJVFkgb3Ig
RklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlIEdOVQorICAgTGVzc2Vy
IEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KKworICAgWW91IHNob3Vs
ZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYwor
ICAgTGljZW5zZSBhbG9uZyB3aXRoIHRoaXMgbGlicmFyeTsgaWYgbm90LCBzZWUgPGh0dHA6Ly93
d3cuZ251Lm9yZy9saWNlbnNlcy8+LgorKi8KKworI2lmbmRlZiBTUElDRV9HVEtfQ0RfU0NTSV9E
RVZfUEFSQU1TX0hfCisjZGVmaW5lIFNQSUNFX0dUS19DRF9TQ1NJX0RFVl9QQVJBTVNfSF8KKwor
I2luY2x1ZGUgPGdpby9naW8uaD4KKwordHlwZWRlZiBzdHJ1Y3QgQ2RTY3NpRGV2aWNlUGFyYW1l
dGVycyB7CisgICAgY29uc3QgY2hhciAqdmVuZG9yOworICAgIGNvbnN0IGNoYXIgKnByb2R1Y3Q7
CisgICAgY29uc3QgY2hhciAqdmVyc2lvbjsKKyAgICBjb25zdCBjaGFyICpzZXJpYWw7Cit9IENk
U2NzaURldmljZVBhcmFtZXRlcnM7CisKK3R5cGVkZWYgc3RydWN0IENkU2NzaURldmljZUluZm8g
eworICAgIENkU2NzaURldmljZVBhcmFtZXRlcnMgcGFyYW1ldGVyczsKKyAgICB1aW50MzJfdCBz
dGFydGVkICAgIDogMTsKKyAgICB1aW50MzJfdCBsb2NrZWQgICAgIDogMTsKKyAgICB1aW50MzJf
dCBsb2FkZWQgICAgIDogMTsKK30gQ2RTY3NpRGV2aWNlSW5mbzsKKwordHlwZWRlZiBzdHJ1Y3Qg
Q2RTY3NpTWVkaWFQYXJhbWV0ZXJzIHsKKyAgICBHRmlsZUlucHV0U3RyZWFtICpzdHJlYW07Cisg
ICAgdWludDY0X3Qgc2l6ZTsKKyAgICB1aW50MzJfdCBibG9ja19zaXplOworfSBDZFNjc2lNZWRp
YVBhcmFtZXRlcnM7CisKKyNlbmRpZiAvKiBTUElDRV9HVEtfQ0RfU0NTSV9ERVZfUEFSQU1TX0hf
ICovCmRpZmYgLS1naXQgYS9zcmMvY2Qtc2NzaS5jIGIvc3JjL2NkLXNjc2kuYwpuZXcgZmlsZSBt
b2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMC4uMjU4NDJiM2IKLS0tIC9kZXYvbnVsbAorKysgYi9z
cmMvY2Qtc2NzaS5jCkBAIC0wLDAgKzEsMjc0MCBAQAorLyogLSotIE1vZGU6IEM7IGMtYmFzaWMt
b2Zmc2V0OiA0OyBpbmRlbnQtdGFicy1tb2RlOiBuaWwgLSotICovCisvKgorICAgQ0QgZGV2aWNl
IGVtdWxhdGlvbiAtIFNDU0kgZW5naW5lCisKKyAgIENvcHlyaWdodCAoQykgMjAxOCBSZWQgSGF0
LCBJbmMuCisKKyAgIFJlZCBIYXQgQXV0aG9yczoKKyAgIEFsZXhhbmRlciBOZXpoaW5za3k8YW5l
emhpbnNAcmVkaGF0LmNvbT4KKworICAgVGhpcyBsaWJyYXJ5IGlzIGZyZWUgc29mdHdhcmU7IHlv
dSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vcgorICAgbW9kaWZ5IGl0IHVuZGVyIHRoZSB0ZXJt
cyBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYworICAgTGljZW5zZSBhcyBwdWJsaXNo
ZWQgYnkgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyCisgICB2ZXJzaW9uIDIu
MSBvZiB0aGUgTGljZW5zZSwgb3IgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4K
KworICAgVGhpcyBsaWJyYXJ5IGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2ls
bCBiZSB1c2VmdWwsCisgICBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0
aGUgaW1wbGllZCB3YXJyYW50eSBvZgorICAgTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9S
IEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZSBHTlUKKyAgIExlc3NlciBHZW5lcmFsIFB1
YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCisKKyAgIFlvdSBzaG91bGQgaGF2ZSByZWNl
aXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKKyAgIExpY2Vuc2Ug
YWxvbmcgd2l0aCB0aGlzIGxpYnJhcnk7IGlmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcv
bGljZW5zZXMvPi4KKyovCisKKyNpbmNsdWRlICJjb25maWcuaCIKKyNpbmNsdWRlICJzcGljZS90
eXBlcy5oIgorI2luY2x1ZGUgInNwaWNlLWNvbW1vbi5oIgorI2luY2x1ZGUgInNwaWNlLXV0aWwu
aCIKKyNpbmNsdWRlICJjZC1zY3NpLmgiCisKKyNpZmRlZiBVU0VfVVNCUkVESVIKKworI2RlZmlu
ZSBTUElDRV9FUlJPUihmbXQsIC4uLikgXAorICAgIGRvIHsgU1BJQ0VfREVCVUcoImRldi1zY3Np
IGVycm9yOiAiIGZtdCAsICMjIF9fVkFfQVJHU19fKTsgfSB3aGlsZSAoMCkKKworI2RlZmluZSBG
SVhFRF9TRU5TRV9DVVJSRU5UIDB4NzAKKyNkZWZpbmUgRklYRURfU0VOU0VfTEVOIDE4CisKKyNk
ZWZpbmUgTUFYX0xVTlMgICAzMgorCit0eXBlZGVmIGVudW0gQ2RTY3NpUG93ZXJDb25kaXRpb24g
eworICAgIENEX1NDU0lfUE9XRVJfU1RPUFBFRCwKKyAgICBDRF9TQ1NJX1BPV0VSX0FDVElWRSwK
KyAgICBDRF9TQ1NJX1BPV0VSX0lETEUsCisgICAgQ0RfU0NTSV9QT1dFUl9TVEFOREJZCit9IENk
U2NzaVBvd2VyQ29uZGl0aW9uOworCit0eXBlZGVmIHN0cnVjdCBTY3NpU2hvcnRTZW5zZSB7Cisg
ICAgdWludDhfdCBrZXk7CisgICAgdWludDhfdCBhc2M7CisgICAgdWludDhfdCBhc2NxOworICAg
IGNvbnN0IGNoYXIgKmRlc2NyOworfSBTY3NpU2hvcnRTZW5zZTsKKworI2RlZmluZSBDRF9NRURJ
QV9FVkVOVF9OT19DSEFOR0UgICAgICAgICAgICAweDAKKyNkZWZpbmUgQ0RfTUVESUFfRVZFTlRf
RUpFQ1RfUkVRICAgICAgICAgICAgMHgxIC8qIHVzZXIgcmVxdWVzdCAobWVjaGFuaWNhbCBzd2l0
Y2gpIHRvCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
KiBlamVjdCB0aGUgbWVkaWEgKi8KKyNkZWZpbmUgQ0RfTUVESUFfRVZFTlRfTkVXX01FRElBICAg
ICAgICAgICAgMHgyIC8qIG5ldyBtZWRpYSByZWNlaXZlZCAqLworI2RlZmluZSBDRF9NRURJQV9F
VkVOVF9NRURJQV9SRU1PVkFMICAgICAgICAweDMgLyogbWVkaWEgcmVtb3ZlZCAqLworI2RlZmlu
ZSBDRF9NRURJQV9FVkVOVF9NRURJQV9DSEFOR0VEICAgICAgICAweDQgLyogdXNlciByZXF1ZXN0
IHRvIGxvYWQgbmV3IG1lZGlhICovCisjZGVmaW5lIENEX01FRElBX0VWRU5UX0JHX0ZPUk1BVF9D
T01QTEVURSAgIDB4NQorI2RlZmluZSBDRF9NRURJQV9FVkVOVF9CR19GT1JNQVRfUkVTVEFSVCAg
ICAweDYKKworI2RlZmluZSBDRF9QT1dFUl9FVkVOVF9OT19DSEFOR0UgICAgICAgICAgICAweDAK
KyNkZWZpbmUgQ0RfUE9XRVJfRVZFTlRfQ0hBTkdFX1NVQ0NFU1MgICAgICAgMHgxCisjZGVmaW5l
IENEX1BPV0VSX0VWRU5UX0NIQU5HRV9GQUxFRCAgICAgICAgIDB4MgorCit0eXBlZGVmIHN0cnVj
dCBDZFNjc2lMVSB7CisgICAgQ2RTY3NpVGFyZ2V0ICp0Z3Q7CisgICAgdWludDMyX3QgbHVuOwor
CisgICAgZ2Jvb2xlYW4gcmVhbGl6ZWQ7CisgICAgZ2Jvb2xlYW4gcmVtb3ZhYmxlOworICAgIGdi
b29sZWFuIGxvYWRlZDsKKyAgICBnYm9vbGVhbiBwcmV2ZW50X21lZGlhX3JlbW92YWw7CisgICAg
Z2Jvb2xlYW4gY2Rfcm9tOworCisgICAgQ2RTY3NpUG93ZXJDb25kaXRpb24gcG93ZXJfY29uZDsK
KyAgICB1aW50MzJfdCBwb3dlcl9ldmVudDsKKyAgICB1aW50MzJfdCBtZWRpYV9ldmVudDsKKwor
ICAgIHVpbnQzMl90IGNsYWltX3ZlcnNpb247CisKKyAgICB1aW50NjRfdCBzaXplOworICAgIHVp
bnQzMl90IGJsb2NrX3NpemU7CisgICAgdWludDMyX3QgbnVtX2Jsb2NrczsKKworICAgIGNoYXIg
KnZlbmRvcjsKKyAgICBjaGFyICpwcm9kdWN0OworICAgIGNoYXIgKnZlcnNpb247CisgICAgY2hh
ciAqc2VyaWFsOworCisgICAgR0ZpbGVJbnB1dFN0cmVhbSAqc3RyZWFtOworCisgICAgU2NzaVNo
b3J0U2Vuc2Ugc2hvcnRfc2Vuc2U7IC8qIGN1cnJlbnRseSBoZWxkIHNlbnNlIG9mIHRoZSBzY3Np
IGRldmljZSAqLworICAgIHVpbnQ4X3QgZml4ZWRfc2Vuc2VbRklYRURfU0VOU0VfTEVOXTsKK30g
Q2RTY3NpTFU7CisKK3R5cGVkZWYgZW51bSBDZFNjc2lUYXJnZXRTdGF0ZSB7CisgICAgQ0RfU0NT
SV9UR1RfU1RBVEVfUlVOTklORywKKyAgICBDRF9TQ1NJX1RHVF9TVEFURV9SRVNFVCwKK30gQ2RT
Y3NpVGFyZ2V0U3RhdGU7CisKK3N0cnVjdCBDZFNjc2lUYXJnZXQgeworICAgIHZvaWQgKnVzZXJf
ZGF0YTsKKworICAgIENkU2NzaVRhcmdldFN0YXRlIHN0YXRlOworICAgIENkU2NzaVJlcXVlc3Qg
KmN1cl9yZXE7CisgICAgR0NhbmNlbGxhYmxlICpjYW5jZWxsYWJsZTsKKworICAgIHVpbnQzMl90
IG1heF9sdW5zOworICAgIENkU2NzaUxVIHVuaXRzW01BWF9MVU5TXTsKK307CisKK3N0YXRpYyBj
b25zdCBjaGFyKiBzY3NpX2NtZF9uYW1lWzI1Nl07CisKKy8qIFByZWRlZmluZWQgc2Vuc2UgY29k
ZXMgKi8KKworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9OT19TRU5TRSA9IHsKKyAg
ICAua2V5ID0gTk9fU0VOU0UgLCAuYXNjID0gMHgwMCAsIC5hc2NxID0gMHgwMCwKKyAgICAuZGVz
Y3IgPSAiIgorfTsKKworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9OT1RfUkVBRFlf
Q0FVU0VfTk9UX1JFUE9SVEFCTEUgPSB7CisgICAgLmtleSA9IE5PVF9SRUFEWSwgLmFzYyA9IDB4
MDQsIC5hc2NxID0gMHgwMCwKKyAgICAuZGVzY3IgPSAiQ0FVU0UgTk9UIFJFUE9SVEFCTEUiCit9
OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX0JFQ09NSU5HX1JFQURZID0gewor
ICAgIC5rZXkgPSBOT1RfUkVBRFksIC5hc2MgPSAweDA0LCAuYXNjcSA9IDB4MDEsCisgICAgLmRl
c2NyID0gIklOIFBST0NFU1MgT0YgQkVDT01JTkcgUkVBRFkiCit9OworCitjb25zdCBTY3NpU2hv
cnRTZW5zZSBzZW5zZV9jb2RlX0lOSVRfQ01EX1JFUVVJUkVEID0geworICAgIC5rZXkgPSBOT1Rf
UkVBRFksIC5hc2MgPSAweDA0LCAuYXNjcSA9IDB4MDIsCisgICAgLmRlc2NyID0gIklOSVRJQUxJ
WklORyBDT01NQU5EIFJFUVVJUkVEIgorfTsKKworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2Vf
Y29kZV9JTlRFUlZFTlRJT05fUkVRVUlSRUQgPSB7CisgICAgLmtleSA9IE5PVF9SRUFEWSwgLmFz
YyA9IDB4MDQsIC5hc2NxID0gMHgwMywKKyAgICAuZGVzY3IgPSAiTUFOVUFMIElOVEVSVkVOVElP
TiBSRVFVSVJFRCIKK307CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNlIHNlbnNlX2NvZGVfTk9UX1JF
QURZX05PX01FRElVTSA9IHsKKyAgICAua2V5ID0gTk9UX1JFQURZLCAuYXNjID0gMHgzYSwgLmFz
Y3EgPSAweDAwLAorICAgIC5kZXNjciA9ICJNRURJVU0gTk9UIFBSRVNFTlQiCit9OworCitjb25z
dCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX05PVF9SRUFEWV9OT19NRURJVU1fVFJBWV9DTE9T
RUQgPSB7CisgICAgLmtleSA9IE5PVF9SRUFEWSwgLmFzYyA9IDB4M2EsIC5hc2NxID0gMHgwMSwK
KyAgICAuZGVzY3IgPSAiTUVESVVNIE5PVCBQUkVTRU5UIC0gVFJBWSBDTE9TRUQiCit9OworCitj
b25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX05PVF9SRUFEWV9OT19NRURJVU1fVFJBWV9P
UEVOID0geworICAgIC5rZXkgPSBOT1RfUkVBRFksIC5hc2MgPSAweDNhLCAuYXNjcSA9IDB4MDIs
CisgICAgLmRlc2NyID0gIk1FRElVTSBOT1QgUFJFU0VOVCAtIFRSQVkgT1BFTiIKK307CisKK2Nv
bnN0IFNjc2lTaG9ydFNlbnNlIHNlbnNlX2NvZGVfVEFSR0VUX0ZBSUxVUkUgPSB7CisgICAgLmtl
eSA9IEhBUkRXQVJFX0VSUk9SLCAuYXNjID0gMHg0NCwgLmFzY3EgPSAweDAwLAorICAgIC5kZXNj
ciA9ICJJTlRFUk5BTCBUQVJHRVQgRkFJTFVSRSIKK307CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNl
IHNlbnNlX2NvZGVfSU5WQUxJRF9PUENPREUgPSB7CisgICAgLmtleSA9IElMTEVHQUxfUkVRVUVT
VCwgLmFzYyA9IDB4MjAsIC5hc2NxID0gMHgwMCwKKyAgICAuZGVzY3IgPSAiSU5WQUxJRCBDT01N
QU5EIE9QRVJBVElPTiBDT0RFIgorfTsKKworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29k
ZV9MQkFfT1VUX09GX1JBTkdFID0geworICAgIC5rZXkgPSBJTExFR0FMX1JFUVVFU1QsIC5hc2Mg
PSAweDIxLCAuYXNjcSA9IDB4MDAsCisgICAgLmRlc2NyID0gIkxPR0lDQUwgQkxPQ0sgQUREUkVT
UyBPVVQgT0YgUkFOR0UiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX0lO
VkFMSURfQ0RCX0ZJRUxEID0geworICAgIC5rZXkgPSBJTExFR0FMX1JFUVVFU1QsIC5hc2MgPSAw
eDI0LCAuYXNjcSA9IDB4MDAsCisgICAgLmRlc2NyID0gIklOVkFMSUQgRklFTEQgSU4gQ0RCIgor
fTsKKworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9JTlZBTElEX1BBUkFNX0ZJRUxE
ID0geworICAgIC5rZXkgPSBJTExFR0FMX1JFUVVFU1QsIC5hc2MgPSAweDI2LCAuYXNjcSA9IDB4
MDAsCisgICAgLmRlc2NyID0gIklOVkFMSUQgRklFTEQgSU4gUEFSQU1FVEVSIExJU1QiCit9Owor
Citjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX0lOVkFMSURfUEFSQU1fTEVOID0gewor
ICAgIC5rZXkgPSBJTExFR0FMX1JFUVVFU1QsIC5hc2MgPSAweDFhLCAuYXNjcSA9IDB4MDAsCisg
ICAgLmRlc2NyID0gIlBBUkFNRVRFUiBMSVNUIExFTkdUSCBFUlJPUiIKK307CisKK2NvbnN0IFNj
c2lTaG9ydFNlbnNlIHNlbnNlX2NvZGVfTFVOX05PVF9TVVBQT1JURUQgPSB7CisgICAgLmtleSA9
IElMTEVHQUxfUkVRVUVTVCwgLmFzYyA9IDB4MjUsIC5hc2NxID0gMHgwMCwKKyAgICAuZGVzY3Ig
PSAiTE9HSUNBTCBVTklUIE5PVCBTVVBQT1JURUQiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5z
ZSBzZW5zZV9jb2RlX1NBVklOR19QQVJBTVNfTk9UX1NVUFBPUlRFRCA9IHsKKyAgICAua2V5ID0g
SUxMRUdBTF9SRVFVRVNULCAuYXNjID0gMHgzOSwgLmFzY3EgPSAweDAwLAorICAgIC5kZXNjciA9
ICJTQVZJTkcgUEFSQU1FVEVSUyBOT1QgU1VQUE9SVEVEIgorfTsKKworY29uc3QgU2NzaVNob3J0
U2Vuc2Ugc2Vuc2VfY29kZV9JTkNPTVBBVElCTEVfTUVESVVNID0geworICAgIC5rZXkgPSBJTExF
R0FMX1JFUVVFU1QsIC5hc2MgPSAweDMwLCAuYXNjcSA9IDB4MDAsCisgICAgLmRlc2NyID0gIklO
Q09NUEFUSUJMRSBNRURJVU0gSU5TVEFMTEVEIgorfTsKKworY29uc3QgU2NzaVNob3J0U2Vuc2Ug
c2Vuc2VfY29kZV9NRURJVU1fUkVNT1ZBTF9QUkVWRU5URUQgPSB7CisgICAgLmtleSA9IElMTEVH
QUxfUkVRVUVTVCwgLmFzYyA9IDB4NTMsIC5hc2NxID0gMHgwMiwKKyAgICAuZGVzY3IgPSAiTUVE
SVVNIFJFTU9WQUwgUFJFVkVOVEVEIgorfTsKKworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2Vf
Y29kZV9QQVJBTUVURVJTX0NIQU5HRUQgPSB7CisgICAgLmtleSA9IFVOSVRfQVRURU5USU9OLCAu
YXNjID0gMHgyYSwgLmFzY3EgPSAweDAwLAorICAgIC5kZXNjciA9ICJQQVJBTUVURVJTIENIQU5H
RUQiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX1BPV0VSX09OX1JFU0VU
ID0geworICAgIC5rZXkgPSBVTklUX0FUVEVOVElPTiwgLmFzYyA9IDB4MjksIC5hc2NxID0gMHgw
MCwKKyAgICAuZGVzY3IgPSAiUE9XRVIgT04sIFJFU0VULCBPUiBCVVMgREVWSUNFIFJFU0VUIgor
fTsKKworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9TQ1NJX0JVU19SRVNFVCA9IHsK
KyAgICAua2V5ID0gVU5JVF9BVFRFTlRJT04sIC5hc2MgPSAweDI5LCAuYXNjcSA9IDB4MDIsCisg
ICAgLmRlc2NyID0gIlNDU0kgQlVTIFJFU0VUIgorfTsKKworY29uc3QgU2NzaVNob3J0U2Vuc2Ug
c2Vuc2VfY29kZV9VQV9OT19NRURJVU0gPSB7CisgICAgLmtleSA9IFVOSVRfQVRURU5USU9OLCAu
YXNjID0gMHgzYSwgLmFzY3EgPSAweDAwLAorICAgIC5kZXNjciA9ICJNRURJVU0gTk9UIFBSRVNF
TlQiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX01FRElVTV9DSEFOR0VE
ID0geworICAgIC5rZXkgPSBVTklUX0FUVEVOVElPTiwgLmFzYyA9IDB4MjgsIC5hc2NxID0gMHgw
MCwKKyAgICAuZGVzY3IgPSAiTUVESVVNIENIQU5HRUQiCit9OworCitjb25zdCBTY3NpU2hvcnRT
ZW5zZSBzZW5zZV9jb2RlX1JFUE9SVEVEX0xVTlNfQ0hBTkdFRCA9IHsKKyAgICAua2V5ID0gVU5J
VF9BVFRFTlRJT04sIC5hc2MgPSAweDNmLCAuYXNjcSA9IDB4MGUsCisgICAgLmRlc2NyID0gIlJF
UE9SVEVEIExVTlMgQ0hBTkdFRCIKK307CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNlIHNlbnNlX2Nv
ZGVfREVWSUNFX0lOVEVSTkFMX1JFU0VUID0geworICAgIC5rZXkgPSBVTklUX0FUVEVOVElPTiwg
LmFzYyA9IDB4MjksIC5hc2NxID0gMHgwNCwKKyAgICAuZGVzY3IgPSAiREVWSUNFIElOVEVSTkFM
IFJFU0VUIgorfTsKKworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9VTklUX0FUVEVO
VElPTl9NRURJVU1fUkVNT1ZBTF9SRVFVRVNUID0geworICAgIC5rZXkgPSBVTklUX0FUVEVOVElP
TiwgLmFzYyA9IDB4NWEsIC5hc2NxID0gMHgwMSwKKyAgICAuZGVzY3IgPSAiT1BFUkFUT1IgTUVE
SVVNIFJFTU9WQUwgUkVRVUVTVCIKK307CisKK3N0YXRpYyBpbmxpbmUgZ2Jvb2xlYW4gY2Rfc2Nz
aV9vcGNvZGVfdWFfc3VwcmVzcyh1aW50MzJfdCBvcGNvZGUpCit7CisgICAgc3dpdGNoIChvcGNv
ZGUpIHsKKyAgICBjYXNlIElOUVVJUlk6CisgICAgY2FzZSBSRVBPUlRfTFVOUzoKKyAgICBjYXNl
IEdFVF9DT05GSUdVUkFUSU9OOgorICAgIGNhc2UgR0VUX0VWRU5UX1NUQVRVU19OT1RJRklDQVRJ
T046CisgICAgY2FzZSBSRVFVRVNUX1NFTlNFOgorICAgICAgICByZXR1cm4gVFJVRTsKKyAgICBk
ZWZhdWx0OgorICAgICAgICByZXR1cm4gRkFMU0U7CisgICAgfQorfQorCitzdGF0aWMgaW5saW5l
IGNvbnN0IGNoYXIgKkNkU2NzaVJlcVN0YXRlX3N0cihDZFNjc2lSZXFTdGF0ZSBzdGF0ZSkKK3sK
KyAgICBzd2l0Y2goc3RhdGUpIHsKKyAgICBjYXNlIFNDU0lfUkVRX0lETEU6CisgICAgICAgIHJl
dHVybiAiSURMRSI7CisgICAgY2FzZSBTQ1NJX1JFUV9SVU5OSU5HOgorICAgICAgICByZXR1cm4g
IlJVTk5JTkciOworICAgIGNhc2UgU0NTSV9SRVFfQ09NUExFVEU6CisgICAgICAgIHJldHVybiAi
Q09NUExFVEUiOworICAgIGNhc2UgU0NTSV9SRVFfQ0FOQ0VMRUQ6CisgICAgICAgIHJldHVybiAi
Q0FOQ0VMRUQiOworICAgIGRlZmF1bHQ6CisgICAgICAgIHJldHVybiAiSUxMRUdBTCI7CisgICAg
fQorfQorCitzdGF0aWMgY29uc3QgY2hhciAqY2Rfc2NzaV9zZW5zZV9rZXlfZGVzY3IodWludDhf
dCBzZW5zZV9rZXkpCit7CisgICAgc3dpdGNoKHNlbnNlX2tleSkgeworICAgIGNhc2UgTk9fU0VO
U0U6CisgICAgICAgIHJldHVybiAiTk8gU0VOU0UiOworICAgIGNhc2UgUkVDT1ZFUkVEX0VSUk9S
OgorICAgICAgICByZXR1cm4gIlJFQ09WRVJFRCBFUlJPUiI7CisgICAgY2FzZSBOT1RfUkVBRFk6
CisgICAgICAgIHJldHVybiAiTFVOIE5PVCBSRUFEWSI7CisgICAgY2FzZSBNRURJVU1fRVJST1I6
CisgICAgICAgIHJldHVybiAiTUVESVVNIEVSUk9SIjsKKyAgICBjYXNlIEhBUkRXQVJFX0VSUk9S
OgorICAgICAgICByZXR1cm4gIkhBUkRXQVJFIEVSUk9SIjsKKyAgICBjYXNlIElMTEVHQUxfUkVR
VUVTVDoKKyAgICAgICAgcmV0dXJuICJJTExFR0FMIFJFUVVFU1QiOworICAgIGNhc2UgVU5JVF9B
VFRFTlRJT046CisgICAgICAgIHJldHVybiAiVU5JVCBBVFRFTlRJT04iOworICAgIGNhc2UgQkxB
TktfQ0hFQ0s6CisgICAgICAgIHJldHVybiAiQkxBTksgQ0hFQ0siOworICAgIGNhc2UgQUJPUlRF
RF9DT01NQU5EOgorICAgICAgICByZXR1cm4gIkFCT1JURUQgQ09NTUFORCI7CisgICAgZGVmYXVs
dDoKKyAgICAgICAgcmV0dXJuICI/Pz8iOworICAgIH0KK30KK3N0YXRpYyB1aW50MzJfdCBjZF9z
Y3NpX2J1aWxkX2ZpeGVkX3NlbnNlKHVpbnQ4X3QgKmJ1ZiwgY29uc3QgU2NzaVNob3J0U2Vuc2Ug
KnNob3J0X3NlbnNlKQoreworICAgIG1lbXNldChidWYsIDAsIEZJWEVEX1NFTlNFX0xFTik7CisK
KyAgICBidWZbMF0gPSBGSVhFRF9TRU5TRV9DVVJSRU5UOworICAgIGJ1ZlsyXSA9IHNob3J0X3Nl
bnNlLT5rZXk7CisgICAgYnVmWzddID0gMTA7CisgICAgYnVmWzEyXSA9IHNob3J0X3NlbnNlLT5h
c2M7CisgICAgYnVmWzEzXSA9IHNob3J0X3NlbnNlLT5hc2NxOworCisgICAgcmV0dXJuIEZJWEVE
X1NFTlNFX0xFTjsKK30KKworc3RhdGljIGlubGluZSB2b2lkIGNkX3Njc2lfcmVxX2luaXQoQ2RT
Y3NpUmVxdWVzdCAqcmVxKQoreworICAgIHJlcS0+cmVxX3N0YXRlID0gU0NTSV9SRVFfSURMRTsK
KyAgICByZXEtPnhmZXJfZGlyID0gU0NTSV9YRkVSX05PTkU7CisgICAgcmVxLT5wcml2X2RhdGEg
PSBOVUxMOworICAgIHJlcS0+aW5fbGVuID0gMDsKKyAgICByZXEtPnN0YXR1cyA9IEdPT0Q7Cit9
CisKK3N0YXRpYyBpbmxpbmUgdm9pZCBjZF9zY3NpX2Rldl9zZW5zZV9yZXNldChDZFNjc2lMVSAq
ZGV2KQoreworICAgIG1lbXNldCgmZGV2LT5zaG9ydF9zZW5zZSwgMCwgc2l6ZW9mKGRldi0+c2hv
cnRfc2Vuc2UpKTsKKyAgICBjZF9zY3NpX2J1aWxkX2ZpeGVkX3NlbnNlKGRldi0+Zml4ZWRfc2Vu
c2UsICZkZXYtPnNob3J0X3NlbnNlKTsKK30KKworc3RhdGljIGlubGluZSB2b2lkIGNkX3Njc2lf
ZGV2X3NlbnNlX3NldChDZFNjc2lMVSAqZGV2LCBjb25zdCBTY3NpU2hvcnRTZW5zZSAqc2hvcnRf
c2Vuc2UpCit7CisgICAgaWYgKHNob3J0X3NlbnNlICE9IE5VTEwpIHsKKyAgICAgICAgLyogY29w
eSBzaG9ydCBzZW5zZSBhbmQgZ2VuZXJhdGUgZnVsbCBzZW5zZSBpbiBmaXhlZCBmb3JtYXQgKi8K
KyAgICAgICAgZGV2LT5zaG9ydF9zZW5zZSA9ICpzaG9ydF9zZW5zZTsKKyAgICAgICAgY2Rfc2Nz
aV9idWlsZF9maXhlZF9zZW5zZShkZXYtPmZpeGVkX3NlbnNlLCBzaG9ydF9zZW5zZSk7CisgICAg
fQorfQorCitzdGF0aWMgaW5saW5lIHZvaWQgY2Rfc2NzaV9kZXZfc2Vuc2Vfc2V0X3Bvd2VyX29u
KENkU2NzaUxVICpkZXYpCit7CisgICAgY2Rfc2NzaV9kZXZfc2Vuc2Vfc2V0KGRldiwgJnNlbnNl
X2NvZGVfUE9XRVJfT05fUkVTRVQpOworfQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9jb21w
bGV0ZV9jaGVja19jb25kKENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSwKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgU2NzaVNob3J0U2Vu
c2UgKnNob3J0X3NlbnNlKQoreworICAgIHJlcS0+cmVxX3N0YXRlID0gU0NTSV9SRVFfQ09NUExF
VEU7CisgICAgcmVxLT5zdGF0dXMgPSBDSEVDS19DT05ESVRJT047CisgICAgcmVxLT5pbl9sZW4g
PSAwOworCisgICAgY2Rfc2NzaV9kZXZfc2Vuc2Vfc2V0KGRldiwgc2hvcnRfc2Vuc2UpOworCisg
ICAgU1BJQ0VfREVCVUcoIkNIRUNLX0NPTkQsIHJlcXVlc3QgbHVuOiV1IgorICAgICAgICAgICAg
ICAgICIgb3A6IDB4JTAyeCwgcGVuZGluZyBzZW5zZTogMHglMDJ4ICUwMnggJTAyeCAtICVzLCAl
cyIsCisgICAgICAgICAgICAgICAgZGV2LT5sdW4sICh1aW50MzJfdClyZXEtPmNkYlswXSwKKyAg
ICAgICAgICAgICAgICAodWludDMyX3QpZGV2LT5zaG9ydF9zZW5zZS5rZXksCisgICAgICAgICAg
ICAgICAgKHVpbnQzMl90KWRldi0+c2hvcnRfc2Vuc2UuYXNjLAorICAgICAgICAgICAgICAgICh1
aW50MzJfdClkZXYtPnNob3J0X3NlbnNlLmFzY3EsCisgICAgICAgICAgICAgICAgY2Rfc2NzaV9z
ZW5zZV9rZXlfZGVzY3IoZGV2LT5zaG9ydF9zZW5zZS5rZXkpLAorICAgICAgICAgICAgICAgIGRl
di0+c2hvcnRfc2Vuc2UuZGVzY3IpOworfQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9jb21w
bGV0ZV9nb29kKENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICByZXEt
PnJlcV9zdGF0ZSA9IFNDU0lfUkVRX0NPTVBMRVRFOworICAgIHJlcS0+c3RhdHVzID0gR09PRDsK
K30KKworLyogU0NTSSBUYXJnZXQgKi8KKworU1BJQ0VfQ09OU1RSVUNUT1JfRlVOQyhjZF9zY3Np
X2NtZF9uYW1lc19pbml0KQoreworICAgIHVpbnQzMl90IG9wY29kZTsKKworICAgIGZvciAob3Bj
b2RlID0gMDsgb3Bjb2RlIDwgMjU2OyBvcGNvZGUrKykgeworICAgICAgICBzY3NpX2NtZF9uYW1l
W29wY29kZV0gPSAiVU5TVVBQT1JURUQiOworICAgIH0KKworICAgIHNjc2lfY21kX25hbWVbUkVQ
T1JUX0xVTlNdID0gIlJFUE9SVCBMVU5TIjsKKyAgICBzY3NpX2NtZF9uYW1lW1RFU1RfVU5JVF9S
RUFEWV0gPSAiVEVTVCBVTklUIFJFQURZIjsKKyAgICBzY3NpX2NtZF9uYW1lW0lOUVVJUlldID0g
IklOUVVJUlkiOworICAgIHNjc2lfY21kX25hbWVbUkVRVUVTVF9TRU5TRV0gPSAiUkVRVUVTVCBT
RU5TRSI7CisgICAgc2NzaV9jbWRfbmFtZVtSRUFEXzZdID0gIlJFQUQoNikiOworICAgIHNjc2lf
Y21kX25hbWVbUkVBRF8xMF0gPSAiUkVBRCgxMCkiOworICAgIHNjc2lfY21kX25hbWVbUkVBRF8x
Ml0gPSAiUkVBRCgxMikiOworICAgIHNjc2lfY21kX25hbWVbUkVBRF8xNl0gPSAiUkVBRCgxNiki
OworICAgIHNjc2lfY21kX25hbWVbUkVBRF9DQVBBQ0lUWV8xMF0gPSAiUkVBRCBDQVBBQ0lUWSgx
MCkiOworICAgIHNjc2lfY21kX25hbWVbUkVBRF9UT0NdID0gIlJFQUQgVE9DIjsKKyAgICBzY3Np
X2NtZF9uYW1lW0dFVF9FVkVOVF9TVEFUVVNfTk9USUZJQ0FUSU9OXSA9ICJHRVQgRVZFTlQvU1RB
VFVTIE5PVElGSUNBVElPTiI7CisgICAgc2NzaV9jbWRfbmFtZVtSRUFEX0RJU0NfSU5GT1JNQVRJ
T05dID0gIlJFQUQgRElTQyBJTkZPIjsKKyAgICBzY3NpX2NtZF9uYW1lW1JFQURfVFJBQ0tfSU5G
T1JNQVRJT05dID0gIlJFQUQgVFJBQ0sgSU5GTyI7CisgICAgc2NzaV9jbWRfbmFtZVtNT0RFX1NF
TlNFXzEwXSA9ICJNT0RFIFNFTlNFKDEwKSI7CisgICAgc2NzaV9jbWRfbmFtZVtNT0RFX1NFTEVD
VF0gPSAiTU9ERSBTRUxFQ1QoNikiOworICAgIHNjc2lfY21kX25hbWVbTU9ERV9TRUxFQ1RfMTBd
ID0gIk1PREUgU0VMRUNUKDEwKSI7CisgICAgc2NzaV9jbWRfbmFtZVtHRVRfQ09ORklHVVJBVElP
Tl0gPSAiR0VUIENPTkZJR1VSQVRJT04iOworICAgIHNjc2lfY21kX25hbWVbQUxMT1dfTUVESVVN
X1JFTU9WQUxdID0gIlBSRVZFTlQgQUxMT1cgTUVESVVNIFJFTU9WQUwiOworICAgIHNjc2lfY21k
X25hbWVbTU1DX1NFTkRfRVZFTlRdID0gIlNFTkQgRVZFTlQiOworICAgIHNjc2lfY21kX25hbWVb
TU1DX1JFUE9SVF9LRVldID0gIlJFUE9SVCBLRVkiOworICAgIHNjc2lfY21kX25hbWVbTU1DX1NF
TkRfS0VZXSA9ICJTRU5EX0tFWSI7CisgICAgc2NzaV9jbWRfbmFtZVtTVEFSVF9TVE9QXSA9ICJT
VEFSVCBTVE9QIFVOSVQiOworICAgIHNjc2lfY21kX25hbWVbTU1DX0dFVF9QRVJGT1JNQU5DRV0g
PSAiR0VUIFBFUkZPUk1BTkNFIjsKKyAgICBzY3NpX2NtZF9uYW1lW01NQ19NRUNIQU5JU01fU1RB
VFVTXSA9ICJNRUNIQU5JU00gU1RBVFVTIjsKK30KKworQ2RTY3NpVGFyZ2V0ICpjZF9zY3NpX3Rh
cmdldF9hbGxvYyh2b2lkICp0YXJnZXRfdXNlcl9kYXRhLCB1aW50MzJfdCBtYXhfbHVucykKK3sK
KyAgICBDZFNjc2lUYXJnZXQgKnN0OworCisgICAgaWYgKG1heF9sdW5zID09IDAgfHwgbWF4X2x1
bnMgPiBNQVhfTFVOUykgeworICAgICAgICBTUElDRV9FUlJPUigiQWxsb2MsIGlsbGVnYWwgbWF4
X2x1bnM6JXUiLCBtYXhfbHVucyk7CisgICAgICAgIHJldHVybiBOVUxMOworICAgIH0KKworICAg
IHN0ID0gZ19tYWxsb2MwKHNpemVvZigqc3QpKTsKKworICAgIHN0LT51c2VyX2RhdGEgPSB0YXJn
ZXRfdXNlcl9kYXRhOworICAgIHN0LT5zdGF0ZSA9IENEX1NDU0lfVEdUX1NUQVRFX1JVTk5JTkc7
CisgICAgc3QtPmN1cl9yZXEgPSBOVUxMOworICAgIHN0LT5jYW5jZWxsYWJsZSA9IGdfY2FuY2Vs
bGFibGVfbmV3KCk7CisgICAgc3QtPm1heF9sdW5zID0gbWF4X2x1bnM7CisKKyAgICByZXR1cm4g
c3Q7Cit9CisKK3ZvaWQgY2Rfc2NzaV90YXJnZXRfZnJlZShDZFNjc2lUYXJnZXQgKnN0KQorewor
ICAgIHVpbnQzMl90IGx1bjsKKworICAgIGNkX3Njc2lfdGFyZ2V0X3Jlc2V0KHN0KTsKKyAgICBm
b3IgKGx1biA9IDA7IGx1biA8IHN0LT5tYXhfbHVuczsgbHVuKyspIHsKKyAgICAgICAgQ2RTY3Np
TFUgKnVuaXQgPSAmc3QtPnVuaXRzW2x1bl07CisgICAgICAgIGlmICh1bml0LT5yZWFsaXplZCkg
eworICAgICAgICAgICAgY2Rfc2NzaV9kZXZfdW5yZWFsaXplKHN0LCBsdW4pOworICAgICAgICB9
CisgICAgICAgIGdfY2xlYXJfb2JqZWN0KCZ1bml0LT5zdHJlYW0pOworICAgIH0KKyAgICBnX2Ns
ZWFyX29iamVjdCgmc3QtPmNhbmNlbGxhYmxlKTsKKyAgICBnX2ZyZWUoc3QpOworfQorCisvKiBT
Q1NJIERldmljZSAqLworCitzdGF0aWMgaW5saW5lIGdib29sZWFuIGNkX3Njc2lfdGFyZ2V0X2x1
bl9sZWdhbChjb25zdCBDZFNjc2lUYXJnZXQgKnN0LCB1aW50MzJfdCBsdW4pCit7CisgICAgcmV0
dXJuIChsdW4gPCBzdC0+bWF4X2x1bnMpID8gVFJVRSA6IEZBTFNFOworfQorCitzdGF0aWMgaW5s
aW5lIGdib29sZWFuIGNkX3Njc2lfdGFyZ2V0X2x1bl9yZWFsaXplZChjb25zdCBDZFNjc2lUYXJn
ZXQgKnN0LCB1aW50MzJfdCBsdW4pCit7CisgICAgcmV0dXJuIHN0LT51bml0c1tsdW5dLnJlYWxp
emVkOworfQorCitpbnQgY2Rfc2NzaV9kZXZfcmVhbGl6ZShDZFNjc2lUYXJnZXQgKnN0LCB1aW50
MzJfdCBsdW4sCisgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBDZFNjc2lEZXZpY2VQYXJh
bWV0ZXJzICpkZXZfcGFyYW1zKQoreworICAgIENkU2NzaUxVICpkZXY7CisKKyAgICBpZiAoIWNk
X3Njc2lfdGFyZ2V0X2x1bl9sZWdhbChzdCwgbHVuKSkgeworICAgICAgICBTUElDRV9FUlJPUigi
UmVhbGl6ZSwgaWxsZWdhbCBsdW46JXUiLCBsdW4pOworICAgICAgICByZXR1cm4gLTE7CisgICAg
fQorICAgIGlmIChjZF9zY3NpX3RhcmdldF9sdW5fcmVhbGl6ZWQoc3QsIGx1bikpIHsKKyAgICAg
ICAgU1BJQ0VfRVJST1IoIlJlYWxpemUsIGFscmVhZHkgcmVhbGl6ZWQgbHVuOiV1IiwgbHVuKTsK
KyAgICAgICAgcmV0dXJuIC0xOworICAgIH0KKyAgICBkZXYgPSAmc3QtPnVuaXRzW2x1bl07CisK
KyAgICBtZW1zZXQoZGV2LCAwLCBzaXplb2YoKmRldikpOworICAgIGRldi0+dGd0ID0gc3Q7Cisg
ICAgZGV2LT5sdW4gPSBsdW47CisKKyAgICBkZXYtPnJlYWxpemVkID0gVFJVRTsKKyAgICBkZXYt
PnJlbW92YWJsZSA9IFRSVUU7CisgICAgZGV2LT5sb2FkZWQgPSBGQUxTRTsKKyAgICBkZXYtPnBy
ZXZlbnRfbWVkaWFfcmVtb3ZhbCA9IEZBTFNFOworICAgIGRldi0+Y2Rfcm9tID0gRkFMU0U7CisK
KyAgICBkZXYtPnBvd2VyX2NvbmQgPSBDRF9TQ1NJX1BPV0VSX0FDVElWRTsKKyAgICBkZXYtPnBv
d2VyX2V2ZW50ID0gQ0RfUE9XRVJfRVZFTlRfTk9fQ0hBTkdFOworICAgIGRldi0+bWVkaWFfZXZl
bnQgPSBDRF9NRURJQV9FVkVOVF9OT19DSEFOR0U7CisKKyAgICBkZXYtPmNsYWltX3ZlcnNpb24g
PSAzOyAvKiAwIDogbm9uZTsgMiwzLDUgOiBTUEMvTU1DLXggKi8KKworICAgIGRldi0+dmVuZG9y
ID0gZ19zdHJkdXAoZGV2X3BhcmFtcy0+dmVuZG9yKTsKKyAgICBkZXYtPnByb2R1Y3QgPSBnX3N0
cmR1cChkZXZfcGFyYW1zLT5wcm9kdWN0KTsKKyAgICBkZXYtPnZlcnNpb24gPSBnX3N0cmR1cChk
ZXZfcGFyYW1zLT52ZXJzaW9uKTsKKyAgICBkZXYtPnNlcmlhbCA9IGdfc3RyZHVwKGRldl9wYXJh
bXMtPnNlcmlhbCk7CisKKyAgICBjZF9zY3NpX2Rldl9zZW5zZV9zZXRfcG93ZXJfb24oZGV2KTsK
KworICAgIFNQSUNFX0RFQlVHKCJSZWFsaXplIGx1bjoldSBiczoldSBWUjpbJXNdIFBUOlslc10g
dmVyOlslc10gU05bJXNdIiwKKyAgICAgICAgICAgICAgICBsdW4sIGRldi0+YmxvY2tfc2l6ZSwg
ZGV2LT52ZW5kb3IsCisgICAgICAgICAgICAgICAgZGV2LT5wcm9kdWN0LCBkZXYtPnZlcnNpb24s
IGRldi0+c2VyaWFsKTsKKyAgICByZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9s
dV9tZWRpYV9yZXNldChDZFNjc2lMVSAqZGV2KQoreworICAgIC8qIG1lZGlhX2V2ZW50IGlzIG5v
dCBzZXQgaGVyZSwgYXMgaXQgZGVwZW5kcyBvbiB0aGUgY29udGV4dCAqLworICAgIGdfY2xlYXJf
b2JqZWN0KCZkZXYtPnN0cmVhbSk7CisgICAgZGV2LT5zaXplID0gMDsKKyAgICBkZXYtPmJsb2Nr
X3NpemUgPSAwOworICAgIGRldi0+bnVtX2Jsb2NrcyA9IDA7Cit9CisKK2ludCBjZF9zY3NpX2Rl
dl9sb2NrKENkU2NzaVRhcmdldCAqc3QsIHVpbnQzMl90IGx1biwgZ2Jvb2xlYW4gbG9jaykKK3sK
KyAgICBDZFNjc2lMVSAqZGV2OworCisgICAgaWYgKCFjZF9zY3NpX3RhcmdldF9sdW5fbGVnYWwo
c3QsIGx1bikpIHsKKyAgICAgICAgU1BJQ0VfRVJST1IoIkxvY2ssIGlsbGVnYWwgbHVuOiV1Iiwg
bHVuKTsKKyAgICAgICAgcmV0dXJuIC0xOworICAgIH0KKyAgICBpZiAoIWNkX3Njc2lfdGFyZ2V0
X2x1bl9yZWFsaXplZChzdCwgbHVuKSkgeworICAgICAgICBTUElDRV9FUlJPUigiTG9jaywgdW5y
ZWFsaXplZCBsdW46JXUiLCBsdW4pOworICAgICAgICByZXR1cm4gLTE7CisgICAgfQorICAgIGRl
diA9ICZzdC0+dW5pdHNbbHVuXTsKKyAgICBkZXYtPnByZXZlbnRfbWVkaWFfcmVtb3ZhbCA9IGxv
Y2s7CisgICAgU1BJQ0VfREVCVUcoImx1bjoldSAlc2xvY2siLCBsdW4sIGxvY2sgPyAidW4iIDoi
Iik7CisgICAgcmV0dXJuIDA7Cit9CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfbHVfbG9hZChDZFNj
c2lMVSAqZGV2LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IENkU2NzaU1lZGlh
UGFyYW1ldGVycyAqbWVkaWFfcGFyYW1zKQoreworICAgIGlmIChtZWRpYV9wYXJhbXMgIT0gTlVM
TCkgeworICAgICAgICBkZXYtPm1lZGlhX2V2ZW50ID0gQ0RfTUVESUFfRVZFTlRfTkVXX01FRElB
OworICAgICAgICBkZXYtPnN0cmVhbSA9IGdfb2JqZWN0X3JlZihtZWRpYV9wYXJhbXMtPnN0cmVh
bSk7CisgICAgICAgIGRldi0+c2l6ZSA9IG1lZGlhX3BhcmFtcy0+c2l6ZTsKKyAgICAgICAgZGV2
LT5ibG9ja19zaXplID0gbWVkaWFfcGFyYW1zLT5ibG9ja19zaXplOworICAgICAgICBkZXYtPm51
bV9ibG9ja3MgPSBtZWRpYV9wYXJhbXMtPnNpemUgLyBtZWRpYV9wYXJhbXMtPmJsb2NrX3NpemU7
CisgICAgICAgIGRldi0+bG9hZGVkID0gVFJVRTsKKyAgICB9IGVsc2UgeworICAgICAgICBkZXYt
Pm1lZGlhX2V2ZW50ID0gQ0RfTUVESUFfRVZFTlRfTUVESUFfUkVNT1ZBTDsKKyAgICAgICAgY2Rf
c2NzaV9sdV9tZWRpYV9yZXNldChkZXYpOworICAgICAgICBkZXYtPmxvYWRlZCA9IEZBTFNFOwor
ICAgIH0KK30KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9sdV91bmxvYWQoQ2RTY3NpTFUgKmRldikK
K3sKKyAgICBkZXYtPm1lZGlhX2V2ZW50ID0gQ0RfTUVESUFfRVZFTlRfTUVESUFfUkVNT1ZBTDsK
KyAgICBjZF9zY3NpX2x1X21lZGlhX3Jlc2V0KGRldik7CisgICAgZGV2LT5sb2FkZWQgPSBGQUxT
RTsKK30KKworaW50IGNkX3Njc2lfZGV2X2xvYWQoQ2RTY3NpVGFyZ2V0ICpzdCwgdWludDMyX3Qg
bHVuLAorICAgICAgICAgICAgICAgICAgICAgY29uc3QgQ2RTY3NpTWVkaWFQYXJhbWV0ZXJzICpt
ZWRpYV9wYXJhbXMpCit7CisgICAgQ2RTY3NpTFUgKmRldjsKKworICAgIGlmICghY2Rfc2NzaV90
YXJnZXRfbHVuX2xlZ2FsKHN0LCBsdW4pKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJMb2FkLCBp
bGxlZ2FsIGx1bjoldSIsIGx1bik7CisgICAgICAgIHJldHVybiAtMTsKKyAgICB9CisgICAgaWYg
KCFjZF9zY3NpX3RhcmdldF9sdW5fcmVhbGl6ZWQoc3QsIGx1bikpIHsKKyAgICAgICAgU1BJQ0Vf
RVJST1IoIkxvYWQsIHVucmVhbGl6ZWQgbHVuOiV1IiwgbHVuKTsKKyAgICAgICAgcmV0dXJuIC0x
OworICAgIH0KKyAgICBkZXYgPSAmc3QtPnVuaXRzW2x1bl07CisKKyAgICBjZF9zY3NpX2x1X2xv
YWQoZGV2LCBtZWRpYV9wYXJhbXMpOworICAgIGRldi0+cG93ZXJfY29uZCA9IENEX1NDU0lfUE9X
RVJfQUNUSVZFOworICAgIGRldi0+cG93ZXJfZXZlbnQgPSBDRF9QT1dFUl9FVkVOVF9DSEFOR0Vf
U1VDQ0VTUzsKKworICAgIGNkX3Njc2lfZGV2X3NlbnNlX3NldChkZXYsICZzZW5zZV9jb2RlX01F
RElVTV9DSEFOR0VEKTsKKworICAgIFNQSUNFX0RFQlVHKCJMb2FkIGx1bjoldSBzaXplOiUiIEdf
R1VJTlQ2NF9GT1JNQVQKKyAgICAgICAgICAgICAgICAiIGJsa19zejoldSBudW1fYmxvY2tzOiV1
IiwKKyAgICAgICAgICAgICAgICBsdW4sIGRldi0+c2l6ZSwgZGV2LT5ibG9ja19zaXplLCBkZXYt
Pm51bV9ibG9ja3MpOworICAgIHJldHVybiAwOworfQorCitpbnQgY2Rfc2NzaV9kZXZfZ2V0X2lu
Zm8oQ2RTY3NpVGFyZ2V0ICpzdCwgdWludDMyX3QgbHVuLCBDZFNjc2lEZXZpY2VJbmZvICpsdW5f
aW5mbykKK3sKKyAgICBDZFNjc2lMVSAqZGV2OworCisgICAgaWYgKCFjZF9zY3NpX3RhcmdldF9s
dW5fbGVnYWwoc3QsIGx1bikpIHsKKyAgICAgICAgU1BJQ0VfRVJST1IoIkxvYWQsIGlsbGVnYWwg
bHVuOiV1IiwgbHVuKTsKKyAgICAgICAgcmV0dXJuIC0xOworICAgIH0KKyAgICBpZiAoIWNkX3Nj
c2lfdGFyZ2V0X2x1bl9yZWFsaXplZChzdCwgbHVuKSkgeworICAgICAgICBTUElDRV9FUlJPUigi
TG9hZCwgdW5yZWFsaXplZCBsdW46JXUiLCBsdW4pOworICAgICAgICByZXR1cm4gLTE7CisgICAg
fQorICAgIGRldiA9ICZzdC0+dW5pdHNbbHVuXTsKKworICAgIGx1bl9pbmZvLT5zdGFydGVkID0g
ZGV2LT5wb3dlcl9jb25kID09IENEX1NDU0lfUE9XRVJfQUNUSVZFOworICAgIGx1bl9pbmZvLT5s
b2NrZWQgPSBkZXYtPnByZXZlbnRfbWVkaWFfcmVtb3ZhbDsKKyAgICBsdW5faW5mby0+bG9hZGVk
ID0gZGV2LT5sb2FkZWQ7CisKKyAgICBsdW5faW5mby0+cGFyYW1ldGVycy52ZW5kb3IgPSBkZXYt
PnZlbmRvcjsKKyAgICBsdW5faW5mby0+cGFyYW1ldGVycy5wcm9kdWN0ID0gZGV2LT5wcm9kdWN0
OworICAgIGx1bl9pbmZvLT5wYXJhbWV0ZXJzLnZlcnNpb24gPSBkZXYtPnZlcnNpb247CisgICAg
bHVuX2luZm8tPnBhcmFtZXRlcnMuc2VyaWFsID0gZGV2LT5zZXJpYWw7CisKKyAgICByZXR1cm4g
MDsKK30KKworaW50IGNkX3Njc2lfZGV2X3VubG9hZChDZFNjc2lUYXJnZXQgKnN0LCB1aW50MzJf
dCBsdW4pCit7CisgICAgQ2RTY3NpTFUgKmRldjsKKworICAgIGlmICghY2Rfc2NzaV90YXJnZXRf
bHVuX2xlZ2FsKHN0LCBsdW4pKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJVbmxvYWQsIGlsbGVn
YWwgbHVuOiV1IiwgbHVuKTsKKyAgICAgICAgcmV0dXJuIC0xOworICAgIH0KKyAgICBpZiAoIWNk
X3Njc2lfdGFyZ2V0X2x1bl9yZWFsaXplZChzdCwgbHVuKSkgeworICAgICAgICBTUElDRV9FUlJP
UigiVW5sb2FkLCB1bnJlYWxpemVkIGx1bjoldSIsIGx1bik7CisgICAgICAgIHJldHVybiAtMTsK
KyAgICB9CisgICAgZGV2ID0gJnN0LT51bml0c1tsdW5dOworICAgIGlmICghZGV2LT5sb2FkZWQp
IHsKKyAgICAgICAgU1BJQ0VfRVJST1IoIlVubG9hZCwgbHVuOiV1IG5vdCBsb2FkZWQgeWV0Iiwg
bHVuKTsKKyAgICAgICAgcmV0dXJuIDA7CisgICAgfQorICAgIGlmIChkZXYtPnByZXZlbnRfbWVk
aWFfcmVtb3ZhbCkgeworICAgICAgICBTUElDRV9FUlJPUigiVW5sb2FkLCBsdW46JXUgcHJldmVu
dF9tZWRpYV9yZW1vdmFsIHNldCIsIGx1bik7CisgICAgICAgIHJldHVybiAtMTsKKyAgICB9CisK
KyAgICBjZF9zY3NpX2x1X3VubG9hZChkZXYpOworICAgIGRldi0+cG93ZXJfY29uZCA9IENEX1ND
U0lfUE9XRVJfU1RPUFBFRDsKKyAgICBkZXYtPnBvd2VyX2V2ZW50ID0gQ0RfUE9XRVJfRVZFTlRf
Q0hBTkdFX1NVQ0NFU1M7CisKKyAgICBjZF9zY3NpX2Rldl9zZW5zZV9zZXQoZGV2LCAmc2Vuc2Vf
Y29kZV9VQV9OT19NRURJVU0pOworCisgICAgU1BJQ0VfREVCVUcoIlVubG9hZCBsdW46JXUiLCBs
dW4pOworICAgIHJldHVybiAwOworfQorCitpbnQgY2Rfc2NzaV9kZXZfdW5yZWFsaXplKENkU2Nz
aVRhcmdldCAqc3QsIHVpbnQzMl90IGx1bikKK3sKKyAgICBDZFNjc2lMVSAqZGV2OworCisgICAg
aWYgKCFjZF9zY3NpX3RhcmdldF9sdW5fbGVnYWwoc3QsIGx1bikpIHsKKyAgICAgICAgU1BJQ0Vf
RVJST1IoIlVucmVhbGl6ZSwgaWxsZWdhbCBsdW46JXUiLCBsdW4pOworICAgICAgICByZXR1cm4g
LTE7CisgICAgfQorICAgIGlmICghY2Rfc2NzaV90YXJnZXRfbHVuX3JlYWxpemVkKHN0LCBsdW4p
KSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJVbnJlYWxpemUsIGFic2VudCBsdW46JXUiLCBsdW4p
OworICAgICAgICByZXR1cm4gLTE7CisgICAgfQorICAgIGRldiA9ICZzdC0+dW5pdHNbbHVuXTsK
KworICAgIGdfY2xlYXJfcG9pbnRlcigmZGV2LT52ZW5kb3IsIGdfZnJlZSk7CisgICAgZ19jbGVh
cl9wb2ludGVyKCZkZXYtPnByb2R1Y3QsIGdfZnJlZSk7CisgICAgZ19jbGVhcl9wb2ludGVyKCZk
ZXYtPnZlcnNpb24sIGdfZnJlZSk7CisgICAgZ19jbGVhcl9wb2ludGVyKCZkZXYtPnNlcmlhbCwg
Z19mcmVlKTsKKworICAgIGdfY2xlYXJfb2JqZWN0KCZkZXYtPnN0cmVhbSk7CisKKyAgICBkZXYt
PmxvYWRlZCA9IEZBTFNFOworICAgIGRldi0+cmVhbGl6ZWQgPSBGQUxTRTsKKyAgICBkZXYtPnBv
d2VyX2NvbmQgPSBDRF9TQ1NJX1BPV0VSX1NUT1BQRUQ7CisKKyAgICBTUElDRV9ERUJVRygiVW5y
ZWFsaXplIGx1bjoldSIsIGx1bik7CisgICAgcmV0dXJuIDA7Cit9CisKK2ludCBjZF9zY3NpX2Rl
dl9yZXNldChDZFNjc2lUYXJnZXQgKnN0LCB1aW50MzJfdCBsdW4pCit7CisgICAgQ2RTY3NpTFUg
KmRldjsKKworICAgIGlmICghY2Rfc2NzaV90YXJnZXRfbHVuX2xlZ2FsKHN0LCBsdW4pKSB7Cisg
ICAgICAgIFNQSUNFX0VSUk9SKCJEZXZpY2UgcmVzZXQsIGlsbGVnYWwgbHVuOiV1IiwgbHVuKTsK
KyAgICAgICAgcmV0dXJuIC0xOworICAgIH0KKyAgICBpZiAoIWNkX3Njc2lfdGFyZ2V0X2x1bl9y
ZWFsaXplZChzdCwgbHVuKSkgeworICAgICAgICBTUElDRV9FUlJPUigiRGV2aWNlIHJlc2V0LCBh
YnNlbnQgbHVuOiV1IiwgbHVuKTsKKyAgICAgICAgcmV0dXJuIC0xOworICAgIH0KKyAgICBkZXYg
PSAmc3QtPnVuaXRzW2x1bl07CisKKyAgICAvKiBpZiB3ZSByZXNldCB0aGUgJ3ByZXZlbnQnIGZs
YWcgd2UgY2FuJ3QgY3JlYXRlCisgICAgICogdGhlIHVuaXQgdGhhdCBpcyBsb2NrZWQgZnJvbSB0
aGUgYmVnaW5uaW5nLCBzbworICAgICAqIHdlIGtlZXAgdGhpcyBmbGFnIGFzIHBlcnNpc3RlbnQg
b3ZlciByZXNldHMKKyAgICAgKi8KKyAgICAvKiBkZXYtPnByZXZlbnRfbWVkaWFfcmVtb3ZhbCA9
IEZBTFNFOyAqLworICAgIGRldi0+cG93ZXJfY29uZCA9IENEX1NDU0lfUE9XRVJfQUNUSVZFOwor
ICAgIGRldi0+cG93ZXJfZXZlbnQgPSBDRF9QT1dFUl9FVkVOVF9DSEFOR0VfU1VDQ0VTUzsKKyAg
ICBjZF9zY3NpX2Rldl9zZW5zZV9zZXRfcG93ZXJfb24oZGV2KTsKKworICAgIFNQSUNFX0RFQlVH
KCJEZXZpY2UgcmVzZXQgbHVuOiV1IiwgbHVuKTsKKyAgICByZXR1cm4gMDsKK30KKworc3RhdGlj
IHZvaWQgY2Rfc2NzaV90YXJnZXRfZG9fcmVzZXQoQ2RTY3NpVGFyZ2V0ICpzdCkKK3sKKyAgICB1
aW50MzJfdCBsdW47CisKKyAgICBmb3IgKGx1biA9IDA7IGx1biA8IHN0LT5tYXhfbHVuczsgbHVu
KyspIHsKKyAgICAgICAgaWYgKHN0LT51bml0c1tsdW5dLnJlYWxpemVkKSB7CisgICAgICAgICAg
ICBjZF9zY3NpX2Rldl9yZXNldChzdCwgbHVuKTsKKyAgICAgICAgfQorICAgIH0KKworICAgIFNQ
SUNFX0RFQlVHKCJUYXJnZXQgcmVzZXQgY29tcGxldGUiKTsKKyAgICBzdC0+c3RhdGUgPSBDRF9T
Q1NJX1RHVF9TVEFURV9SVU5OSU5HOworICAgIGNkX3Njc2lfdGFyZ2V0X3Jlc2V0X2NvbXBsZXRl
KHN0LT51c2VyX2RhdGEpOworfQorCitpbnQgY2Rfc2NzaV90YXJnZXRfcmVzZXQoQ2RTY3NpVGFy
Z2V0ICpzdCkKK3sKKyAgICBpZiAoc3QtPnN0YXRlID09IENEX1NDU0lfVEdUX1NUQVRFX1JFU0VU
KSB7CisgICAgICAgIFNQSUNFX0RFQlVHKCJUYXJnZXQgYWxyZWFkeSBpbiByZXNldCIpOworICAg
ICAgICByZXR1cm4gLTE7CisgICAgfQorCisgICAgc3QtPnN0YXRlID0gQ0RfU0NTSV9UR1RfU1RB
VEVfUkVTRVQ7CisKKyAgICBpZiAoc3QtPmN1cl9yZXEgIT0gTlVMTCkgeworICAgICAgICBjZF9z
Y3NpX2Rldl9yZXF1ZXN0X2NhbmNlbChzdCwgc3QtPmN1cl9yZXEpOworICAgICAgICBpZiAoc3Qt
PmN1cl9yZXEgIT0gTlVMTCkgeworICAgICAgICAgICAgU1BJQ0VfREVCVUcoIlRhcmdldCByZXNl
dCBpbiBwcm9ncmVzcy4uLiIpOworICAgICAgICAgICAgcmV0dXJuIDA7CisgICAgICAgIH0KKyAg
ICB9CisKKyAgICBjZF9zY3NpX3RhcmdldF9kb19yZXNldChzdCk7CisgICAgcmV0dXJuIDA7Cit9
CisKK0NkU2NzaVJlcVN0YXRlIGNkX3Njc2lfZ2V0X3JlcV9zdGF0ZShDZFNjc2lSZXF1ZXN0ICpy
ZXEpCit7CisgICAgcmV0dXJuIHJlcS0+cmVxX3N0YXRlOworfQorCitzdGF0aWMgdm9pZCBzdHJw
YWRjcHkoY2hhciAqYnVmLCBpbnQgYnVmX3NpemUsIGNvbnN0IGNoYXIgKnN0ciwgY2hhciBwYWQp
Cit7CisgICAgaW50IGxlbiA9IHN0cm5sZW4oc3RyLCBidWZfc2l6ZSk7CisgICAgbWVtY3B5KGJ1
Ziwgc3RyLCBsZW4pOworICAgIG1lbXNldChidWYgKyBsZW4sIHBhZCwgYnVmX3NpemUgLSBsZW4p
OworfQorCisvKiBTQ1NJIENEQiAqLworCitzdGF0aWMgdW5zaWduZWQgaW50IHNjc2lfY2RiX2xl
bmd0aChjb25zdCB1aW50OF90ICpjZGIpCit7CisgICAgdW5zaWduZWQgaW50IGNkYl9sZW47CisK
KyAgICBzd2l0Y2ggKGNkYlswXSA+PiA1KSB7CisgICAgY2FzZSAwOgorICAgICAgICBjZGJfbGVu
ID0gNjsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSAxOgorICAgIGNhc2UgMjoKKyAgICAgICAg
Y2RiX2xlbiA9IDEwOworICAgICAgICBicmVhazsKKyAgICBjYXNlIDQ6CisgICAgICAgIGNkYl9s
ZW4gPSAxNjsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSA1OgorICAgICAgICBjZGJfbGVuID0g
MTI7CisgICAgICAgIGJyZWFrOworICAgIGRlZmF1bHQ6CisgICAgICAgIGNkYl9sZW4gPSAwOwor
ICAgIH0KKyAgICByZXR1cm4gY2RiX2xlbjsKK30KKworc3RhdGljIHVpbnQ2NF90IHNjc2lfY2Ri
X2xiYShjb25zdCB1aW50OF90ICpjZGIsIGludCBjZGJfbGVuKQoreworICAgIHVpbnQ2NF90IGxi
YTsKKworICAgIHN3aXRjaCAoY2RiX2xlbikgeworICAgIGNhc2UgNjoKKyAgICAgICAgbGJhID0g
KCgodWludDY0X3QpKGNkYlsxXSAmIDB4MWYpKSA8PCAxNikgfAorICAgICAgICAgICAgICAoKCh1
aW50NjRfdCljZGJbMl0pIDw8IDgpIHwKKyAgICAgICAgICAgICAgICgodWludDY0X3QpY2RiWzNd
KTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSAxMDoKKyAgICBjYXNlIDEyOgorICAgICAgICBs
YmEgPSAoKCh1aW50NjRfdCljZGJbMl0pIDw8IDI0KSB8CisgICAgICAgICAgICAgICgoKHVpbnQ2
NF90KWNkYlszXSkgPDwgMTYpIHwKKyAgICAgICAgICAgICAgKCgodWludDY0X3QpY2RiWzRdKSA8
PCA4KSAgfAorICAgICAgICAgICAgICAgKCh1aW50NjRfdCljZGJbNV0pOworICAgICAgICBicmVh
azsKKyAgICBjYXNlIDE2OgorICAgICAgICBsYmEgPSAoKCh1aW50NjRfdCljZGJbMl0pIDw8IDU2
KSB8CisgICAgICAgICAgICAgICgoKHVpbnQ2NF90KWNkYlszXSkgPDwgNDgpIHwKKyAgICAgICAg
ICAgICAgKCgodWludDY0X3QpY2RiWzRdKSA8PCA0MCkgfAorICAgICAgICAgICAgICAoKCh1aW50
NjRfdCljZGJbNV0pIDw8IDMyKSB8CisgICAgICAgICAgICAgICgoKHVpbnQ2NF90KWNkYls2XSkg
PDwgMjQpIHwKKyAgICAgICAgICAgICAgKCgodWludDY0X3QpY2RiWzddKSA8PCAxNikgfAorICAg
ICAgICAgICAgICAoKCh1aW50NjRfdCljZGJbOF0pIDw8IDgpICB8CisgICAgICAgICAgICAgICAo
KHVpbnQ2NF90KWNkYls5XSk7CisgICAgICAgIGJyZWFrOworICAgIGRlZmF1bHQ6CisgICAgICAg
IGxiYSA9IDA7CisgICAgfQorICAgIHJldHVybiBsYmE7Cit9CisKK3N0YXRpYyB1aW50MzJfdCBz
Y3NpX2NkYl94ZmVyX2xlbmd0aChjb25zdCB1aW50OF90ICpjZGIsIGludCBjZGJfbGVuKQorewor
ICAgIHVpbnQzMl90IGxlbjsKKworICAgIHN3aXRjaCAoY2RiX2xlbikgeworICAgIGNhc2UgNjoK
KyAgICAgICAgbGVuID0gKHVpbnQzMl90KWNkYls0XTsKKyAgICAgICAgaWYgKGxlbiA9PSAwKQor
ICAgICAgICAgICAgbGVuID0gMjU2OworICAgICAgICBicmVhazsKKyAgICBjYXNlIDEwOgorICAg
ICAgICBsZW4gPSAoKCh1aW50MzJfdCljZGJbN10pIDw8IDgpIHwKKyAgICAgICAgICAgICAgICgo
dWludDMyX3QpY2RiWzhdKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSAxMjoKKyAgICAgICAg
bGVuID0gKCgodWludDMyX3QpY2RiWzZdKSA8PCAyNCkgfAorICAgICAgICAgICAgICAoKCh1aW50
MzJfdCljZGJbN10pIDw8IDE2KSB8CisgICAgICAgICAgICAgICgoKHVpbnQzMl90KWNkYls4XSkg
PDwgOCkgIHwKKyAgICAgICAgICAgICAgICgodWludDMyX3QpY2RiWzldKTsKKyAgICAgICAgYnJl
YWs7CisgICAgY2FzZSAxNjoKKyAgICAgICAgbGVuID0gKCgodWludDMyX3QpY2RiWzEwXSkgPDwg
MjQpIHwKKyAgICAgICAgICAgICAgKCgodWludDMyX3QpY2RiWzExXSkgPDwgMTYpIHwKKyAgICAg
ICAgICAgICAgKCgodWludDMyX3QpY2RiWzEyXSkgPDwgOCkgIHwKKyAgICAgICAgICAgICAgICgo
dWludDMyX3QpY2RiWzEzXSk7CisgICAgICAgIGJyZWFrOworICAgIGRlZmF1bHQ6CisgICAgICAg
IGxlbiA9IDA7CisgICAgICAgIGJyZWFrOworICAgIH0KKyAgICByZXR1cm4gbGVuOworfQorCisv
KiBTQ1NJIGNvbW1hbmRzICovCisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX3Rlc3RfdW5pdF9y
ZWFkeShDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgcmVxLT54ZmVy
X2RpciA9IFNDU0lfWEZFUl9OT05FOworICAgIHJlcS0+aW5fbGVuID0gMDsKKworICAgIGlmIChk
ZXYtPmxvYWRlZCkgeworICAgICAgICBpZiAoZGV2LT5wb3dlcl9jb25kICE9IENEX1NDU0lfUE9X
RVJfU1RPUFBFRCkgeworICAgICAgICAgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfZ29vZChkZXYs
IHJlcSk7CisgICAgICAgIH0gZWxzZSB7CisgICAgICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0
ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTklUX0NNRF9SRVFVSVJFRCk7Cisg
ICAgICAgIH0KKyAgICB9IGVsc2UgeworICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVj
a19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9OT1RfUkVBRFlfTk9fTUVESVVNKTsKKyAgICB9
Cit9CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX3JlcXVlc3Rfc2Vuc2UoQ2RTY3NpTFUgKmRl
diwgQ2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAgIHJlcS0+eGZlcl9kaXIgPSBTQ1NJX1hGRVJf
RlJPTV9ERVY7CisKKyAgICByZXEtPnJlcV9sZW4gPSByZXEtPmNkYls0XTsKKyAgICByZXEtPmlu
X2xlbiA9IE1JTihyZXEtPnJlcV9sZW4sIHNpemVvZihkZXYtPmZpeGVkX3NlbnNlKSk7CisKKyAg
ICBpZiAoZGV2LT5zaG9ydF9zZW5zZS5rZXkgIT0gTk9fU0VOU0UpIHsKKyAgICAgICAgU1BJQ0Vf
REVCVUcoIiVzLCBsdW46JXUgcmVwb3J0ZWQgc2Vuc2U6IDB4JTAyeCAlMDJ4ICUwMnggLSAlcywg
JXMiLAorICAgICAgICAgICAgICAgICAgICBfX0ZVTkNUSU9OX18sIHJlcS0+bHVuLAorICAgICAg
ICAgICAgICAgICAgICBkZXYtPnNob3J0X3NlbnNlLmtleSwgZGV2LT5zaG9ydF9zZW5zZS5hc2Ms
IGRldi0+c2hvcnRfc2Vuc2UuYXNjcSwKKyAgICAgICAgICAgICAgICAgICAgY2Rfc2NzaV9zZW5z
ZV9rZXlfZGVzY3IoZGV2LT5zaG9ydF9zZW5zZS5rZXkpLAorICAgICAgICAgICAgICAgICAgICBk
ZXYtPnNob3J0X3NlbnNlLmRlc2NyKTsKKyAgICB9CisgICAgbWVtY3B5KHJlcS0+YnVmLCBkZXYt
PmZpeGVkX3NlbnNlLCBzaXplb2YoZGV2LT5maXhlZF9zZW5zZSkpOworICAgIGNkX3Njc2lfZGV2
X3NlbnNlX3Jlc2V0KGRldik7IC8qIGNsZWFyIHJlcG9ydGVkIHNlbnNlICovCisKKyAgICBjZF9z
Y3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworc3RhdGljIHZvaWQgY2Rfc2Nz
aV9jbWRfcmVwb3J0X2x1bnMoQ2RTY3NpVGFyZ2V0ICpzdCwgQ2RTY3NpTFUgKmRldiwKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAg
ICB1aW50OF90ICpvdXRfYnVmID0gcmVxLT5idWY7CisgICAgdWludDMyX3QgbWF4X2x1bnMgPSBz
dC0+bWF4X2x1bnM7CisgICAgdWludDMyX3QgYnVmbGVuID0gODsgLyogaGVhZGVyIGxlbmd0aCAq
LworICAgIHVpbnQzMl90IGx1bjsKKworICAgIHJlcS0+cmVxX2xlbiA9IHNjc2lfY2RiX3hmZXJf
bGVuZ3RoKHJlcS0+Y2RiLCAxMik7CisgICAgcmVxLT54ZmVyX2RpciA9IFNDU0lfWEZFUl9GUk9N
X0RFVjsKKworICAgIC8qIGNoZWNrIFNFTEVDVCBSRVBPUlQgZmllbGQgKi8KKyAgICBpZiAocmVx
LT5jZGJbMl0gPT0gMHgwMSkgeworICAgICAgICAvKiBvbmx5IHdlbGwga25vd24gbG9naWNhbCB1
bml0cyAqLworICAgICAgICBtYXhfbHVucyA9IDA7CisgICAgfQorCisgICAgbWVtc2V0KG91dF9i
dWYsIDAsIDgpOworCisgICAgZm9yIChsdW4gPSAwOyBsdW4gPCBtYXhfbHVuczsgbHVuKyspIHsK
KyAgICAgICAgaWYgKHN0LT51bml0c1tsdW5dLnJlYWxpemVkKSB7CisgICAgICAgICAgICBvdXRf
YnVmW2J1ZmxlbisrXSA9IDA7CisgICAgICAgICAgICBvdXRfYnVmW2J1ZmxlbisrXSA9ICh1aW50
OF90KShsdW4pOworICAgICAgICAgICAgbWVtc2V0KCZvdXRfYnVmW2J1Zmxlbl0sIDAsIDYpOwor
ICAgICAgICAgICAgYnVmbGVuICs9IDY7CisgICAgICAgIH0KKyAgICB9CisKKyAgICAvKiBmaWxs
IExVTiBMSVNUIExFTkdUSCAqLworICAgIG91dF9idWZbMF0gPSAodWludDhfdCkoKGJ1Zmxlbi04
KSA+PiAyNCk7CisgICAgb3V0X2J1ZlsxXSA9ICh1aW50OF90KSgoYnVmbGVuLTgpID4+IDE2KTsK
KyAgICBvdXRfYnVmWzJdID0gKHVpbnQ4X3QpKChidWZsZW4tOCkgPj4gOCk7CisgICAgb3V0X2J1
ZlszXSA9ICh1aW50OF90KSgoYnVmbGVuLTgpKTsKKworICAgIHJlcS0+aW5fbGVuID0gYnVmbGVu
OworICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2LCByZXEpOworfQorCisjZGVmaW5l
IFNDU0lfTUFYX0lOUVVJUllfTEVOICAgICAgICAyNTYKKyNkZWZpbmUgU0NTSV9NQVhfTU9ERV9M
RU4gICAgICAgICAgIDI1NgorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9pbnF1aXJ5X3ZwZF9u
b19sdW4oQ2RTY3NpTFUgKmRldiwgQ2RTY3NpUmVxdWVzdCAqcmVxLAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IHBlcmlmX3F1YWwpCit7CisgICAg
dWludDhfdCAqb3V0YnVmID0gcmVxLT5idWY7CisgICAgdWludDhfdCBwYWdlX2NvZGUgPSByZXEt
PmNkYlsyXTsKKyAgICB1aW50MzJfdCByZXNwX2xlbiA9IDQ7CisKKyAgICBvdXRidWZbMF0gPSAo
cGVyaWZfcXVhbCA8PCA1KSB8IFRZUEVfUk9NOworICAgIG91dGJ1ZlsxXSA9IHBhZ2VfY29kZSA7
IC8qIHRoaXMgcGFnZSAqLworICAgIG91dGJ1ZlsyXSA9IDB4MDA7IC8qIHBhZ2UgbGVuZ3RoIE1T
QiAqLworICAgIG91dGJ1ZlszXSA9IDB4MDA7IC8qIHBhZ2UgbGVuZ3RoIExTQiAtIG5vIG1vcmUg
ZGF0YSAqLworCisgICAgcmVxLT5pbl9sZW4gPSBNSU4ocmVxLT5yZXFfbGVuLCByZXNwX2xlbik7
CisKKyAgICBTUElDRV9ERUJVRygiaW5xdWlyeV92cGQsIHVuc3VwcG9ydGVkIGx1bjoldSIKKyAg
ICAgICAgICAgICAgICAiIHBlcmlmX3F1YWw6MHgleCByZXNwX2xlbjogJSIgR19HVUlOVDY0X0ZP
Uk1BVCwKKyAgICAgICAgICAgICAgICByZXEtPmx1biwgcGVyaWZfcXVhbCwgcmVxLT5pbl9sZW4p
OworCisgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfZ29vZChkZXYsIHJlcSk7Cit9CisKK3N0YXRp
YyB2b2lkIGNkX3Njc2lfY21kX2lucXVpcnlfdnBkKENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVl
c3QgKnJlcSkKK3sKKyAgICB1aW50OF90ICpvdXRidWYgPSByZXEtPmJ1ZjsKKyAgICB1aW50OF90
IHBhZ2VfY29kZSA9IHJlcS0+Y2RiWzJdOworICAgIGludCBidWZsZW4gPSA0OworICAgIGludCBz
dGFydCA9IDQ7CisKKyAgICBvdXRidWZbMF0gPSBUWVBFX1JPTTsKKyAgICBvdXRidWZbMV0gPSBw
YWdlX2NvZGUgOyAvKiB0aGlzIHBhZ2UgKi8KKyAgICBvdXRidWZbMl0gPSAweDAwOyAvKiBwYWdl
IGxlbmd0aCBNU0IgKi8KKyAgICBvdXRidWZbM10gPSAweDAwOyAvKiBwYWdlIGxlbmd0aCBMU0Is
IHRvIHdyaXRlIGxhdGVyICovCisKKyAgICBzd2l0Y2ggKHBhZ2VfY29kZSkgeworICAgIGNhc2Ug
MHgwMDogLyogU3VwcG9ydGVkIHBhZ2UgY29kZXMsIG1hbmRhdG9yeSAqLworICAgIHsKKyAgICAg
ICAgb3V0YnVmW2J1ZmxlbisrXSA9IDB4MDA7IC8vIGxpc3Qgb2Ygc3VwcG9ydGVkIHBhZ2VzICh0
aGlzIHBhZ2UpCisgICAgICAgIGlmIChkZXYtPnNlcmlhbCkgeworICAgICAgICAgICAgb3V0YnVm
W2J1ZmxlbisrXSA9IDB4ODA7IC8vIHVuaXQgc2VyaWFsIG51bWJlcgorICAgICAgICB9CisgICAg
ICAgIG91dGJ1ZltidWZsZW4rK10gPSAweDgzOyAvLyBkZXZpY2UgaWRlbnRpZmljYXRpb24KKwor
ICAgICAgICBTUElDRV9ERUJVRygiSW5xdWlyeSBFVlBEW1N1cHBvcnRlZCBwYWdlc10gbHVuOiV1
IgorICAgICAgICAgICAgICAgICAgICAiIHJlcV9sZW46ICUiIEdfR1VJTlQ2NF9GT1JNQVQgIiBy
ZXNwX2xlbjogJWQiLAorICAgICAgICAgICAgICAgICAgICByZXEtPmx1biwgcmVxLT5yZXFfbGVu
LCBidWZsZW4pOworICAgICAgICBicmVhazsKKyAgICB9CisgICAgY2FzZSAweDgwOiAvKiBEZXZp
Y2Ugc2VyaWFsIG51bWJlciwgb3B0aW9uYWwgKi8KKyAgICB7CisgICAgICAgIGludCBzZXJpYWxf
bGVuOworCisgICAgICAgIHNlcmlhbF9sZW4gPSBzdHJsZW4oZGV2LT5zZXJpYWwpOworICAgICAg
ICBpZiAoc2VyaWFsX2xlbiA+IDM2KSB7CisgICAgICAgICAgICBzZXJpYWxfbGVuID0gMzY7Cisg
ICAgICAgIH0KKyAgICAgICAgbWVtY3B5KG91dGJ1ZitidWZsZW4sIGRldi0+c2VyaWFsLCBzZXJp
YWxfbGVuKTsKKyAgICAgICAgYnVmbGVuICs9IHNlcmlhbF9sZW47CisKKyAgICAgICAgU1BJQ0Vf
REVCVUcoIklucXVpcnkgRVZQRFtTZXJpYWwgbnVtXSBsdW46JXUiCisgICAgICAgICAgICAgICAg
ICAgICIgcmVxX2xlbjogJSIgR19HVUlOVDY0X0ZPUk1BVCAiIHJlc3BfbGVuOiAlZCIsCisgICAg
ICAgICAgICAgICAgICAgIHJlcS0+bHVuLCByZXEtPnJlcV9sZW4sIGJ1Zmxlbik7CisgICAgICAg
IGJyZWFrOworICAgIH0KKyAgICBjYXNlIDB4ODM6IC8qIERldmljZSBpZGVudGlmaWNhdGlvbiBw
YWdlLCBtYW5kYXRvcnkgKi8KKyAgICB7CisgICAgICAgIGludCBzZXJpYWxfbGVuID0gc3RybGVu
KGRldi0+c2VyaWFsKTsKKyAgICAgICAgaW50IG1heF9sZW4gPSAyMDsKKworICAgICAgICBpZiAo
c2VyaWFsX2xlbiA+IG1heF9sZW4pIHsKKyAgICAgICAgICAgIHNlcmlhbF9sZW4gPSBtYXhfbGVu
OworICAgICAgICB9CisKKyAgICAgICAgb3V0YnVmW2J1ZmxlbisrXSA9IDB4MjsgLy8gQVNDSUkK
KyAgICAgICAgb3V0YnVmW2J1ZmxlbisrXSA9IDA7ICAgLy8gbm90IG9mZmljaWFsbHkgYXNzaWdu
ZWQKKyAgICAgICAgb3V0YnVmW2J1ZmxlbisrXSA9IDA7ICAgLy8gcmVzZXJ2ZWQKKyAgICAgICAg
b3V0YnVmW2J1ZmxlbisrXSA9IHNlcmlhbF9sZW47IC8vIGxlbmd0aCBvZiBkYXRhIGZvbGxvd2lu
ZworCisgICAgICAgIG1lbWNweShvdXRidWYrYnVmbGVuLCBkZXYtPnNlcmlhbCwgc2VyaWFsX2xl
bik7CisgICAgICAgIGJ1ZmxlbiArPSBzZXJpYWxfbGVuOworCisgICAgICAgIFNQSUNFX0RFQlVH
KCJJbnF1aXJ5IEVWUERbRGV2aWNlIGlkXSBsdW46JXUiCisgICAgICAgICAgICAgICAgICAgICIg
cmVxX2xlbjogJSIgR19HVUlOVDY0X0ZPUk1BVCAiIHJlc3BfbGVuOiAlZCIsCisgICAgICAgICAg
ICAgICAgICAgIHJlcS0+bHVuLCByZXEtPnJlcV9sZW4sIGJ1Zmxlbik7CisgICAgICAgIGJyZWFr
OworICAgIH0KKworICAgIGRlZmF1bHQ6CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2No
ZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX0lOVkFMSURfQ0RCX0ZJRUxEKTsKKyAgICAg
ICAgU1BJQ0VfREVCVUcoImlucXVpcnlfc3RhbmRhcmQsIGx1bjoldSBpbnZhbGlkIHBhZ2VfY29k
ZTogJTAyeCIsCisgICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuLCAoaW50KXBhZ2VfY29kZSk7
CisgICAgICAgIHJldHVybjsKKyAgICB9CisKKyAgICAvKiBkb25lIHdpdGggRVZQRCAqLworICAg
IGdfYXNzZXJ0KGJ1ZmxlbiAtIHN0YXJ0IDw9IDI1NSk7CisgICAgb3V0YnVmWzNdID0gYnVmbGVu
IC0gc3RhcnQ7IC8qIHBhZ2UgbGVuZ3RoIExTQiAqLworCisgICAgcmVxLT5pbl9sZW4gPSBidWZs
ZW47CisgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfZ29vZChkZXYsIHJlcSk7Cit9CisKKyNkZWZp
bmUgSU5RVUlSWV9TVEFOREFSRF9MRU5fTUlOICAgICAgICAgICAgMzYKKyNkZWZpbmUgSU5RVUlS
WV9TVEFOREFSRF9MRU4gICAgICAgICAgICAgICAgOTYKKyNkZWZpbmUgSU5RVUlSWV9TVEFOREFS
RF9MRU5fTk9fVkVSICAgICAgICAgNTcKKworI2RlZmluZSBQRVJJRl9RVUFMSUZJRVJfQ09OTkVD
VEVEICAgICAgICAgICAweDAwCisjZGVmaW5lIFBFUklGX1FVQUxJRklFUl9OT1RfQ09OTkVDVEVE
ICAgICAgIDB4MDEKKyNkZWZpbmUgUEVSSUZfUVVBTElGSUVSX1VOU1VQUE9SVEVEICAgICAgICAg
MHgwMworCisjZGVmaW5lIElOUVVJUllfUkVNT1ZBQkxFX01FRElVTSAgICAgICAgICAgIDB4ODAK
KworI2RlZmluZSBJTlFVSVJZX1ZFUlNJT05fTk9ORSAgICAgICAgICAgICAgICAweDAwCisjZGVm
aW5lIElOUVVJUllfVkVSU0lPTl9TUEMzICAgICAgICAgICAgICAgIDB4MDUKKworLyogYnl0ZSAz
ICovCisjZGVmaW5lIElOUVVJUllfUkVTUF9ISVNVUCAgICAgICAgICAgICAgICAgICgweDAxIDw8
IDQpCisjZGVmaW5lIElOUVVJUllfUkVTUF9OT1JNX0FDQSAgICAgICAgICAgICAgICgweDAxIDw8
IDUpCisjZGVmaW5lIElOUVVJUllfUkVTUF9EQVRBX0ZPUk1BVF9TUEMzICAgICAgIDB4MDIKKwor
I2RlZmluZSBJTlFVSVJZX1ZFUlNJT05fREVTQ19TQU0yICAgICAgICAgICAweDA0MAorI2RlZmlu
ZSBJTlFVSVJZX1ZFUlNJT05fREVTQ19TUEMzICAgICAgICAgICAweDMwMAorI2RlZmluZSBJTlFV
SVJZX1ZFUlNJT05fREVTQ19NTUMzICAgICAgICAgICAweDJBMAorI2RlZmluZSBJTlFVSVJZX1ZF
UlNJT05fREVTQ19TQkMyICAgICAgICAgICAweDMyMAorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2Nt
ZF9pbnF1aXJ5X3N0YW5kYXJkX25vX2x1bihDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpy
ZXEsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50
MzJfdCBwZXJpZl9xdWFsKQoreworICAgIHVpbnQ4X3QgKm91dGJ1ZiA9IHJlcS0+YnVmOworICAg
IHVpbnQzMl90IHJlc3BfbGVuID0gSU5RVUlSWV9TVEFOREFSRF9MRU5fTUlOOworCisgICAgbWVt
c2V0KHJlcS0+YnVmLCAwLCBJTlFVSVJZX1NUQU5EQVJEX0xFTl9NSU4pOworCisgICAgb3V0YnVm
WzBdID0gKHBlcmlmX3F1YWwgPDwgNSkgfCBUWVBFX1JPTTsKKyAgICBvdXRidWZbMl0gPSBJTlFV
SVJZX1ZFUlNJT05fTk9ORTsKKyAgICBvdXRidWZbM10gPSBJTlFVSVJZX1JFU1BfREFUQV9GT1JN
QVRfU1BDMzsKKworICAgIG91dGJ1Zls0XSA9IHJlc3BfbGVuIC0gNDsgLyogYWRkaXRpb25hbCBs
ZW5ndGgsIGFmdGVyIGhlYWRlciAqLworCisgICAgcmVxLT5pbl9sZW4gPSBNSU4ocmVxLT5yZXFf
bGVuLCByZXNwX2xlbik7CisKKyAgICBTUElDRV9ERUJVRygiaW5xdWlyeV9zdGFuZGFyZCwgdW5z
dXBwb3J0ZWQgbHVuOiV1IHBlcmlmX3F1YWw6MHgleCAiCisgICAgICAgICAgICAgICAgImlucXVp
cnlfbGVuOiAldSByZXNwX2xlbjogJSIgR19HVUlOVDY0X0ZPUk1BVCwKKyAgICAgICAgICAgICAg
ICByZXEtPmx1biwgcGVyaWZfcXVhbCwgcmVzcF9sZW4sIHJlcS0+aW5fbGVuKTsKKworICAgIGNk
X3Njc2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2LCByZXEpOworfQorCitzdGF0aWMgdm9pZCBjZF9z
Y3NpX2NtZF9pbnF1aXJ5X3N0YW5kYXJkKENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJl
cSkKK3sKKyAgICB1aW50OF90ICpvdXRidWYgPSByZXEtPmJ1ZjsKKyAgICB1aW50MzJfdCByZXNw
X2xlbiA9CisgICAgICAgIChkZXYtPmNsYWltX3ZlcnNpb24gPT0gMCkgPyBJTlFVSVJZX1NUQU5E
QVJEX0xFTl9OT19WRVIgOiBJTlFVSVJZX1NUQU5EQVJEX0xFTjsKKworICAgIG91dGJ1ZlswXSA9
IChQRVJJRl9RVUFMSUZJRVJfQ09OTkVDVEVEIDw8IDUpIHwgVFlQRV9ST007CisgICAgb3V0YnVm
WzFdID0gKGRldi0+cmVtb3ZhYmxlKSA/IElOUVVJUllfUkVNT1ZBQkxFX01FRElVTSA6IDA7Cisg
ICAgb3V0YnVmWzJdID0gKGRldi0+Y2xhaW1fdmVyc2lvbiA9PSAwKSA/IElOUVVJUllfVkVSU0lP
Tl9OT05FIDogSU5RVUlSWV9WRVJTSU9OX1NQQzM7CisgICAgb3V0YnVmWzNdID0gSU5RVUlSWV9S
RVNQX05PUk1fQUNBIHwgSU5RVUlSWV9SRVNQX0hJU1VQIHwgSU5RVUlSWV9SRVNQX0RBVEFfRk9S
TUFUX1NQQzM7CisKKyAgICBvdXRidWZbNF0gPSByZXNwX2xlbiAtIDQ7IC8qIGFkZGl0aW9uYWwg
bGVuZ3RoLCBhZnRlciBoZWFkZXIgKi8KKworICAgIC8qIChvdXRidWZbNiw3XSA9IDApIG1lYW5z
IGFsc28ge0JRdWU9MCxDbWRRdWU9MH0gLSBubyBxdWV1ZWluZyBhdCBhbGwgKi8KKworICAgIHN0
cnBhZGNweSgoY2hhciAqKSAmb3V0YnVmWzhdLCA4LCBkZXYtPnZlbmRvciwgJyAnKTsKKyAgICBz
dHJwYWRjcHkoKGNoYXIgKikgJm91dGJ1ZlsxNl0sIDE2LCBkZXYtPnByb2R1Y3QsICcgJyk7Cisg
ICAgbWVtY3B5KCZvdXRidWZbMzJdLCBkZXYtPnZlcnNpb24sIE1JTig0LCBzdHJsZW4oZGV2LT52
ZXJzaW9uKSkpOworCisgICAgaWYgKGRldi0+Y2xhaW1fdmVyc2lvbiA+IDApIHsKKyAgICAgICAg
Lyogbm93IHN1cHBvcnRpbmcgb25seSAzICovCisgICAgICAgIG91dGJ1Zls1OF0gPSAoSU5RVUlS
WV9WRVJTSU9OX0RFU0NfU0FNMiA+PiA4KSAmIDB4ZmY7CisgICAgICAgIG91dGJ1Zls1OV0gPSBJ
TlFVSVJZX1ZFUlNJT05fREVTQ19TQU0yICYgMHhmZjsKKworICAgICAgICBvdXRidWZbNjBdID0g
KElOUVVJUllfVkVSU0lPTl9ERVNDX1NQQzMgPj4gOCkgJiAweGZmOworICAgICAgICBvdXRidWZb
NjFdID0gSU5RVUlSWV9WRVJTSU9OX0RFU0NfU1BDMyAmIDB4ZmY7CisKKyAgICAgICAgb3V0YnVm
WzYyXSA9IChJTlFVSVJZX1ZFUlNJT05fREVTQ19NTUMzID4+IDgpICYgMHhmZjsKKyAgICAgICAg
b3V0YnVmWzYzXSA9IElOUVVJUllfVkVSU0lPTl9ERVNDX01NQzMgJiAweGZmOworCisgICAgICAg
IG91dGJ1Zls2NF0gPSAoSU5RVUlSWV9WRVJTSU9OX0RFU0NfU0JDMiA+PiA4KSAmIDB4ZmY7Cisg
ICAgICAgIG91dGJ1Zls2NV0gPSBJTlFVSVJZX1ZFUlNJT05fREVTQ19TQkMyICYgMHhmZjsKKyAg
ICB9CisKKyAgICByZXEtPmluX2xlbiA9IE1JTihyZXEtPnJlcV9sZW4sIHJlc3BfbGVuKTsKKwor
ICAgIFNQSUNFX0RFQlVHKCJpbnF1aXJ5X3N0YW5kYXJkLCBsdW46JXUiCisgICAgICAgICAgICAg
ICAgIiBpbnF1aXJ5X2xlbjogJXUgcmVzcF9sZW46ICUiIEdfR1VJTlQ2NF9GT1JNQVQsCisgICAg
ICAgICAgICAgICAgcmVxLT5sdW4sIHJlc3BfbGVuLCByZXEtPmluX2xlbik7CisKKyAgICBjZF9z
Y3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworI2RlZmluZSBDRF9JTlFVSVJZ
X0ZMQUdfRVZQRCAgICAgICAgICAgICAgICAweDAxCisjZGVmaW5lIENEX0lOUVVJUllfRkxBR19D
TURfRFQgICAgICAgICAgICAgIDB4MDIKKworc3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRfaW5xdWly
eShDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgZ2Jvb2xlYW4gZXZw
ZCwgY21kX2RhdGE7CisKKyAgICByZXEtPnhmZXJfZGlyID0gU0NTSV9YRkVSX0ZST01fREVWOwor
CisgICAgZXZwZCA9IChyZXEtPmNkYlsxXSAmIENEX0lOUVVJUllfRkxBR19FVlBEKSA/IFRSVUUg
OiBGQUxTRTsKKyAgICBjbWRfZGF0YSA9IChyZXEtPmNkYlsxXSAmIENEX0lOUVVJUllfRkxBR19D
TURfRFQpID8gVFJVRSA6IEZBTFNFOworCisgICAgaWYgKGNtZF9kYXRhKSB7CisgICAgICAgIFNQ
SUNFX0RFQlVHKCJpbnF1aXJ5LCBsdW46JXUgQ21kRFQgYml0IHNldCAtIHVuc3VwcG9ydGVkLCAi
CisgICAgICAgICAgICAgICAgICAgICJjZGJbMV06MHglMDJ4IGNkYlsxXToweCUwMngiLAorICAg
ICAgICAgICAgICAgICAgICByZXEtPmx1biwgKGludClyZXEtPmNkYlsxXSwgKGludClyZXEtPmNk
YlsyXSk7CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEs
ICZzZW5zZV9jb2RlX0lOVkFMSURfQ0RCX0ZJRUxEKTsKKyAgICAgICAgcmV0dXJuOworICAgIH0K
KworICAgIHJlcS0+cmVxX2xlbiA9IHJlcS0+Y2RiWzRdIHwgKHJlcS0+Y2RiWzNdIDw8IDgpOwor
ICAgIG1lbXNldChyZXEtPmJ1ZiwgMCwgcmVxLT5yZXFfbGVuKTsKKworICAgIGlmIChldnBkKSB7
IC8qIGVuYWJsZSB2aXRhbCBwcm9kdWN0IGRhdGEgKi8KKyAgICAgICAgY2Rfc2NzaV9jbWRfaW5x
dWlyeV92cGQoZGV2LCByZXEpOworICAgIH0gZWxzZSB7IC8qIHN0YW5kYXJkIGlucXVpcnkgZGF0
YSAqLworICAgICAgICBpZiAocmVxLT5jZGJbMl0gIT0gMCkgeworICAgICAgICAgICAgU1BJQ0Vf
REVCVUcoImlucXVpcnlfc3RhbmRhcmQsIGx1bjoldSBub24temVybyBwYWdlIGNvZGU6ICUwMngi
LAorICAgICAgICAgICAgICAgICAgICAgICAgcmVxLT5sdW4sIChpbnQpcmVxLT5jZGJbMl0pOwor
ICAgICAgICAgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNl
bnNlX2NvZGVfSU5WQUxJRF9DREJfRklFTEQpOworICAgICAgICAgICAgcmV0dXJuOworICAgICAg
ICB9CisgICAgICAgIGNkX3Njc2lfY21kX2lucXVpcnlfc3RhbmRhcmQoZGV2LCByZXEpOworICAg
IH0KK30KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRfcmVhZF9jYXBhY2l0eShDZFNjc2lMVSAq
ZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgdWludDMyX3QgbGFzdF9ibGsgPSBkZXYt
Pm51bV9ibG9ja3MgLSAxOworICAgIHVpbnQzMl90IGJsa19zaXplID0gZGV2LT5ibG9ja19zaXpl
OworICAgIHVpbnQzMl90ICpsYXN0X2Jsa19vdXQgPSAodWludDMyX3QgKilyZXEtPmJ1ZjsKKyAg
ICB1aW50MzJfdCAqYmxrX3NpemVfb3V0ID0gKHVpbnQzMl90ICopKHJlcS0+YnVmICsgNCk7CisK
KyAgICByZXEtPnhmZXJfZGlyID0gU0NTSV9YRkVSX0ZST01fREVWOworICAgIHJlcS0+cmVxX2xl
biA9IDg7CisKKyAgICAqbGFzdF9ibGtfb3V0ID0gaHRvYmUzMihsYXN0X2Jsayk7CisgICAgKmJs
a19zaXplX291dCA9IGh0b2JlMzIoYmxrX3NpemUpOworCisgICAgU1BJQ0VfREVCVUcoIlJlYWQg
Y2FwYWNpdHksIGx1bjoldSBsYXN0X2JsazogJXUgYmxrX3N6OiAldSIsCisgICAgICAgICAgICAg
ICAgcmVxLT5sdW4sIGxhc3RfYmxrLCBibGtfc2l6ZSk7CisKKyAgICByZXEtPmluX2xlbiA9IDg7
CisgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfZ29vZChkZXYsIHJlcSk7Cit9CisKKyNkZWZpbmUg
UkRJX1RZUEVfU1RBTkRBUkQgICAgICAgICAgIDAgLyogU3RhbmRhcmQgRGlzYyBJbmZvcm1hdGlv
biAqLworI2RlZmluZSBSRElfVFlQRV9UUkFDS19SRVNPVVJDRVMgICAgMSAvKiBUcmFjayBSZXNv
dXJjZXMgSW5mb3JtYXRpb24gKi8KKyNkZWZpbmUgUkRJX1RZUEVfUE9XX1JFU09VUkNFUyAgICAg
IDIgLyogUE9XIFJlc291cmNlcyBJbmZvcm1hdGlvbiAqLworCisjZGVmaW5lIFJESV9TVEFOREFS
RF9MRU4gICAgICAgICAgICAzNAorCisjZGVmaW5lIFJESV9FUkFaQUJMRSAgICAgICAgICAgICAg
ICAoMHgwMSA8PCA0KQorI2RlZmluZSBSRElfTk9OX0VSQVpBQkxFICAgICAgICAgICAgKDB4MDAg
PDwgNCkKKworI2RlZmluZSBSRElfU0VTU0lPTl9FTVBUWSAgICAgICAgICAgKDB4MDAgPDwgMikK
KyNkZWZpbmUgUkRJX1NFU1NJT05fSU5DT01QTEVURSAgICAgICgweDAxIDw8IDIpCisjZGVmaW5l
IFJESV9TRVNTSU9OX0RBTUFHRUQgICAgICAgICAoMHgwMiA8PCAyKQorI2RlZmluZSBSRElfU0VT
U0lPTl9DT01QTEVURSAgICAgICAgKDB4MDMgPDwgMikKKworI2RlZmluZSBSRElfRElTQ19FTVBU
WSAgICAgICAgICAgICAgMHgwMAorI2RlZmluZSBSRElfRElTQ19JTkNPTVBMRVRFICAgICAgICAg
MHgwMQorI2RlZmluZSBSRElfRElTQ19DT01QTEVURSAgICAgICAgICAgMHgwMgorI2RlZmluZSBS
RElfRElTQ19SQU5ET01fV1IgICAgICAgICAgMHgwMworCisjZGVmaW5lIFJESV9ESVNDX1BNQV9U
WVBFX0NEX1JPTSAgICAweDAwCisjZGVmaW5lIFJESV9ESVNDX1BNQV9UWVBFX0NESSAgICAgICAw
eDEwCisjZGVmaW5lIFJESV9ESVNDX1BNQV9UWVBFX0REQ0QgICAgICAweDIwCisjZGVmaW5lIFJE
SV9ESVNDX1BNQV9UWVBFX1VOREVGSU5FRCAweEZGCisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21k
X2dldF9yZWFkX2Rpc2NfaW5mb3JtYXRpb24oQ2RTY3NpTFUgKmRldiwgQ2RTY3NpUmVxdWVzdCAq
cmVxKQoreworICAgIHVpbnQ4X3QgKm91dGJ1ZiA9IHJlcS0+YnVmOworICAgIHVpbnQzMl90IGRh
dGFfdHlwZTsKKyAgICB1aW50MzJfdCBmaXJzdF90cmFjayA9IDE7CisgICAgdWludDMyX3QgbGFz
dF90cmFjayA9IDE7CisgICAgdWludDMyX3QgbnVtX3Nlc3Npb25zID0gMTsKKworICAgIHJlcS0+
eGZlcl9kaXIgPSBTQ1NJX1hGRVJfRlJPTV9ERVY7CisKKyAgICBkYXRhX3R5cGUgPSByZXEtPmNk
YlsxXSAmIDB4NzsKKyAgICBpZiAoZGF0YV90eXBlICE9IFJESV9UWVBFX1NUQU5EQVJEKSB7Cisg
ICAgICAgIFNQSUNFX0RFQlVHKCJyZWFkX2Rpc2NfaW5mb3JtYXRpb24sIGx1bjoldSIKKyAgICAg
ICAgICAgICAgICAgICAgIiB1bnN1cHBvcnRlZCBkYXRhIHR5cGU6ICUwMngiLAorICAgICAgICAg
ICAgICAgICAgICByZXEtPmx1biwgZGF0YV90eXBlKTsKKyAgICAgICAgY2Rfc2NzaV9jbWRfY29t
cGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfSU5WQUxJRF9DREJfRklFTEQp
OworICAgICAgICByZXR1cm47CisgICAgfQorCisgICAgcmVxLT5yZXFfbGVuID0gKHJlcS0+Y2Ri
WzddIDw8IDgpIHwgcmVxLT5jZGJbOF07CisgICAgcmVxLT5pbl9sZW4gPSBNSU4ocmVxLT5yZXFf
bGVuLCBSRElfU1RBTkRBUkRfTEVOKTsKKworICAgIG1lbXNldChvdXRidWYsIDAsIFJESV9TVEFO
REFSRF9MRU4pOworICAgIG91dGJ1ZlsxXSA9IFJESV9TVEFOREFSRF9MRU4gLSAyOyAvKiBsZW5n
dGggZXhjbHVkaW5nIHRoZSBjb3VudGVyIGl0c2VsZiAqLworICAgIG91dGJ1ZlsyXSA9IFJESV9O
T05fRVJBWkFCTEUgfCBSRElfU0VTU0lPTl9DT01QTEVURSB8IFJESV9ESVNDX0NPTVBMRVRFOwor
ICAgIG91dGJ1ZlszXSA9IGZpcnN0X3RyYWNrOyAvKiBvbiBkaXNrICovCisgICAgb3V0YnVmWzRd
ID0gbnVtX3Nlc3Npb25zICYgMHhmZjsgLyogbHNiICovCisgICAgb3V0YnVmWzVdID0gZmlyc3Rf
dHJhY2sgJiAweGZmOyAvKiBpbiBsYXN0IHNlc3NvbiwgbHNiICovCisgICAgb3V0YnVmWzZdID0g
bGFzdF90cmFjayAmIDB4ZmY7IC8qIGluIGxhc3Qgc2Vzc29uLCBsc2IgKi8KKyAgICBvdXRidWZb
OF0gPSBSRElfRElTQ19QTUFfVFlQRV9DRF9ST007CisgICAgb3V0YnVmWzldID0gKG51bV9zZXNz
aW9ucyA+PiA4KSAmIDB4ZmY7IC8qIG1zYiAqLworICAgIG91dGJ1ZlsxMF0gPSAoZmlyc3RfdHJh
Y2sgPj4gOCkgJiAweGZmOyAvKiBpbiBsYXN0IHNlc3NvbiwgbHNiICovCisgICAgb3V0YnVmWzEx
XSA9IChsYXN0X3RyYWNrID4+IDgpICYgMHhmZjsgLyogaW4gbGFzdCBzZXNzb24sIGxzYiAqLwor
CisgICAgU1BJQ0VfREVCVUcoInJlYWRfZGlzY19pbmZvcm1hdGlvbiwgbHVuOiV1IGxlbjogJSIg
R19HVUlOVDY0X0ZPUk1BVCwKKyAgICAgICAgICAgICAgICByZXEtPmx1biwgcmVxLT5pbl9sZW4p
OworCisgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfZ29vZChkZXYsIHJlcSk7Cit9CisKKyNkZWZp
bmUgUlRJX0FERFJfVFlQRV9MQkEgICAgICAgICAgIDB4MDAKKyNkZWZpbmUgUlRJX0FERFJfVFlQ
RV9UUkFDS19OVU0gICAgIDB4MDEKKyNkZWZpbmUgUlRJX0FERFJfVFlQRV9TRVNTSU9OX05VTSAg
IDB4MDIKKworI2RlZmluZSBSVElfVFJBQ0tfTlVNX0xFQURfSU4gICAgICAgMHgwMAorI2RlZmlu
ZSBSVElfVFJBQ0tfTlVNX0lOVklTSUJMRSAgICAgMHhmZgorCisjZGVmaW5lIFRJQl9MRU4gICAg
ICAgICAgICAgICAgICAgICAweDM2CisKKyNkZWZpbmUgVElCX1RSQUNLX01PREVfQ0QgICAgICAg
ICAgIDB4MDQKKyNkZWZpbmUgVElCX0RBVEFfTU9ERV9JU09fMTAxNDkgICAgIDB4MDEKKworI2Rl
ZmluZSBUSUJfTFJBX1ZBTElEICAgICAgICAgICAgICAgKDB4MDEgPDwgMSkKKworc3RhdGljIHZv
aWQgY2Rfc2NzaV9jbWRfZ2V0X3JlYWRfdHJhY2tfaW5mb3JtYXRpb24oQ2RTY3NpTFUgKmRldiwg
Q2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAgIHVpbnQ4X3QgKm91dGJ1ZiA9IHJlcS0+YnVmOwor
ICAgIHVpbnQzMl90IHRyYWNrX3NpemUgPSBkZXYtPm51bV9ibG9ja3M7CisgICAgdWludDMyX3Qg
bGFzdF9hZGRyID0gdHJhY2tfc2l6ZSAtIDE7CisgICAgdWludDMyX3QgdHJhY2tfbnVtID0gMTsK
KyAgICB1aW50MzJfdCBzZXNzaW9uX251bSA9IDE7CisgICAgdWludDMyX3QgYWRkcl90eXBlOwor
ICAgIHVpbnQzMl90IGFkZHJfbnVtOworCisgICAgcmVxLT54ZmVyX2RpciA9IFNDU0lfWEZFUl9G
Uk9NX0RFVjsKKworICAgIGFkZHJfdHlwZSA9IHJlcS0+Y2RiWzFdICYgMHgzOworICAgIGFkZHJf
bnVtID0gKHJlcS0+Y2RiWzJdIDw8IDI0KSB8IChyZXEtPmNkYlszXSA8PCAxNikgfAorICAgICAg
ICAgICAgICAgKHJlcS0+Y2RiWzRdIDw8IDgpIHwgcmVxLT5jZGJbNV07CisKKyAgICBzd2l0Y2gg
KGFkZHJfdHlwZSkgeworICAgIGNhc2UgUlRJX0FERFJfVFlQRV9MQkE6CisgICAgICAgIGlmIChh
ZGRyX251bSA+IGxhc3RfYWRkcikgeworICAgICAgICAgICAgU1BJQ0VfREVCVUcoInJlYWRfdHJh
Y2tfaW5mb3JtYXRpb24sIGx1bjoldSIKKyAgICAgICAgICAgICAgICAgICAgICAgICIgYWRkcl90
eXBlIExCQTogJXUiCisgICAgICAgICAgICAgICAgICAgICAgICAiIGludmFsaWQgTEJBOiAldSIs
CisgICAgICAgICAgICAgICAgICAgICAgICByZXEtPmx1biwgYWRkcl90eXBlLCBhZGRyX251bSk7
CisgICAgICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAm
c2Vuc2VfY29kZV9JTlZBTElEX0NEQl9GSUVMRCk7CisgICAgICAgICAgICByZXR1cm47CisgICAg
ICAgIH0KKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBSVElfQUREUl9UWVBFX1RSQUNLX05VTToK
KyAgICAgICAgaWYgKGFkZHJfbnVtICE9IHRyYWNrX251bSkgeworICAgICAgICAgICAgU1BJQ0Vf
REVCVUcoInJlYWRfdHJhY2tfaW5mb3JtYXRpb24sIGx1bjoldSIKKyAgICAgICAgICAgICAgICAg
ICAgICAgICIgYWRkcl90eXBlIHRyYWNrOiAldSIKKyAgICAgICAgICAgICAgICAgICAgICAgICIg
aW52YWxpZCB0cmFjazogJXUiLAorICAgICAgICAgICAgICAgICAgICAgICAgcmVxLT5sdW4sIGFk
ZHJfdHlwZSwgYWRkcl9udW0pOworICAgICAgICAgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfY2hl
Y2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfSU5WQUxJRF9DREJfRklFTEQpOworICAgICAg
ICAgICAgcmV0dXJuOworICAgICAgICB9CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgUlRJX0FE
RFJfVFlQRV9TRVNTSU9OX05VTToKKyAgICAgICAgaWYgKGFkZHJfbnVtICE9IHNlc3Npb25fbnVt
KSB7CisgICAgICAgICAgICBTUElDRV9ERUJVRygicmVhZF90cmFja19pbmZvcm1hdGlvbiwgbHVu
OiV1IgorICAgICAgICAgICAgICAgICAgICAgICAgIiBhZGRyX3R5cGUgc2Vzc2lvbjogJXUiCisg
ICAgICAgICAgICAgICAgICAgICAgICAiIGludmFsaWQgc2Vzc2lvbjogJXUiLAorICAgICAgICAg
ICAgICAgICAgICAgICAgcmVxLT5sdW4sIGFkZHJfdHlwZSwgYWRkcl9udW0pOworICAgICAgICAg
ICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVf
SU5WQUxJRF9DREJfRklFTEQpOworICAgICAgICAgICAgcmV0dXJuOworICAgICAgICB9CisgICAg
ICAgIGJyZWFrOworICAgIGRlZmF1bHQ6CisgICAgICAgIFNQSUNFX0RFQlVHKCJyZWFkX3RyYWNr
X2luZm9ybWF0aW9uLCBsdW46JXUiCisgICAgICAgICAgICAgICAgICAgICIgaW52YWxpZCBhZGRy
X3R5cGU6ICV1IgorICAgICAgICAgICAgICAgICAgICAiIGFkZHJfbnVtOiAldSIsCisgICAgICAg
ICAgICAgICAgICAgIHJlcS0+bHVuLCBhZGRyX3R5cGUsIGFkZHJfbnVtKTsKKyAgICAgICAgY2Rf
c2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfSU5WQUxJ
RF9DREJfRklFTEQpOworICAgICAgICByZXR1cm47CisgICAgfQorCisgICAgcmVxLT5yZXFfbGVu
ID0gKHJlcS0+Y2RiWzddIDw8IDgpIHwgcmVxLT5jZGJbOF07CisgICAgcmVxLT5pbl9sZW4gPSBN
SU4ocmVxLT5yZXFfbGVuLCBUSUJfTEVOKTsKKworICAgIG1lbXNldChvdXRidWYsIDAsIFRJQl9M
RU4pOworICAgIG91dGJ1ZlsxXSA9IFRJQl9MRU4gLSAyOworICAgIG91dGJ1ZlsyXSA9IHNlc3Np
b25fbnVtOworICAgIG91dGJ1ZlszXSA9IHRyYWNrX251bTsKKyAgICBvdXRidWZbNV0gPSBUSUJf
VFJBQ0tfTU9ERV9DRCAmIDB4MGY7CisgICAgb3V0YnVmWzZdID0gVElCX0RBVEFfTU9ERV9JU09f
MTAxNDkgJiAweDBmOworICAgIG91dGJ1Zls3XSA9IFRJQl9MUkFfVkFMSUQ7CisKKyAgICAvKiBU
cmFjayBzaXplICovCisgICAgb3V0YnVmWzI0XSA9ICh0cmFja19zaXplID4+IDI0KSAmIDB4ZmY7
CisgICAgb3V0YnVmWzI1XSA9ICh0cmFja19zaXplID4+IDE2KSAmIDB4ZmY7CisgICAgb3V0YnVm
WzI2XSA9ICh0cmFja19zaXplID4+IDgpICYgMHhmZjsKKyAgICBvdXRidWZbMjddID0gKHRyYWNr
X3NpemUpICYgMHhmZjsKKworICAgIC8qIExhc3QgcmVjb3JkZWQgYWRkcmVzcyAqLworICAgIG91
dGJ1ZlsyOF0gPSAobGFzdF9hZGRyID4+IDI0KSAmIDB4ZmY7CisgICAgb3V0YnVmWzI5XSA9IChs
YXN0X2FkZHIgPj4gMTYpICYgMHhmZjsKKyAgICBvdXRidWZbMzBdID0gKGxhc3RfYWRkciA+PiA4
KSAmIDB4ZmY7CisgICAgb3V0YnVmWzMxXSA9IChsYXN0X2FkZHIpICYgMHhmZjsKKworICAgIFNQ
SUNFX0RFQlVHKCJyZWFkX3RyYWNrX2luZm9ybWF0aW9uLCBsdW46JXUiCisgICAgICAgICAgICAg
ICAgImFkZHJfdHlwZTogJXUgYWRkcl9udW06ICV1IiwKKyAgICAgICAgICAgICAgICByZXEtPmx1
biwgYWRkcl90eXBlLCBhZGRyX251bSk7CisKKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29k
KGRldiwgcmVxKTsKK30KKworI2RlZmluZSBSRUFEX1RPQ19UUkFDS19ERVNDX0xFTiAgICAgOAor
I2RlZmluZSBSRUFEX1RPQ19SRVNQX0xFTiAgICAgICAgICAgKDQgKyAyKlJFQURfVE9DX1RSQUNL
X0RFU0NfTEVOKQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9yZWFkX3RvYyhDZFNjc2lMVSAq
ZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgdWludDhfdCAqb3V0YnVmID0gcmVxLT5i
dWY7CisgICAgdWludDMyX3QgbXNmLCBmb3JtYXQsIHRyYWNrX251bTsKKyAgICB1aW50MzJfdCBs
YXN0X2JsayA9IGRldi0+bnVtX2Jsb2NrcyAtIDE7CisKKyAgICByZXEtPnhmZXJfZGlyID0gU0NT
SV9YRkVSX0ZST01fREVWOworCisgICAgbXNmID0gKHJlcS0+Y2RiWzFdID4+IDEpICYgMHgxOwor
ICAgIGZvcm1hdCA9IHJlcS0+Y2RiWzJdICYgMHhmOworICAgIHRyYWNrX251bSA9IHJlcS0+Y2Ri
WzZdOworCisgICAgcmVxLT5yZXFfbGVuID0gKHJlcS0+Y2RiWzddIDw8IDgpIHwgcmVxLT5jZGJb
OF07CisgICAgcmVxLT5pbl9sZW4gPSBNSU4ocmVxLT5yZXFfbGVuLCBSRUFEX1RPQ19SRVNQX0xF
Tik7CisKKyAgICBtZW1zZXQob3V0YnVmLCAwLCBSRUFEX1RPQ19SRVNQX0xFTik7CisgICAgb3V0
YnVmWzFdID0gUkVBRF9UT0NfUkVTUF9MRU4gLSAyOyAvKiBsZW5ndGggZXhjbHVkaW5nIHRoZSBj
b3VudGVyIGl0c2VsZiAqLworICAgIG91dGJ1ZlsyXSA9IDE7IC8qIGZpcnN0IHRyYWNrL3Nlc3Np
b24gKi8KKyAgICBvdXRidWZbM10gPSAxOyAvKiBsYXN0IHRyYWNrL3Nlc3Npb24gKi8KKworICAg
IG91dGJ1Zls1XSA9IDB4MDQ7IC8qIERhdGEgQ0QsIG5vIFEtc3ViY2hhbm5lbCAqLworICAgIG91
dGJ1Zls2XSA9IDB4MDE7IC8qIFRyYWNrIG51bWJlciAqLworICAgIG91dGJ1ZlsxMF0gPSBtc2Yg
PyAweDAyIDogMHgwOworCisgICAgb3V0YnVmWzEzXSA9IDB4MDQ7IC8qIERhdGEgQ0QsIG5vIFEt
c3ViY2hhbm5lbCAqLworICAgIG91dGJ1ZlsxNF0gPSAweGFhOyAvKiBUcmFjayBudW1iZXIgKi8K
KyAgICBpZiAobXNmKSB7CisgICAgICAgIGxhc3RfYmxrID0gMHhmZjMwMDAwMDsKKyAgICB9Cisg
ICAgb3V0YnVmWzE2XSA9IGxhc3RfYmxrID4+IDI0OworICAgIG91dGJ1ZlsxN10gPSBsYXN0X2Js
ayA+PiAxNjsKKyAgICBvdXRidWZbMThdID0gbGFzdF9ibGsgPj4gODsKKyAgICBvdXRidWZbMTld
ID0gbGFzdF9ibGs7CisKKyAgICBTUElDRV9ERUJVRygicmVhZF90b2MsIGx1bjoldSBsZW46ICUi
IEdfR1VJTlQ2NF9GT1JNQVQKKyAgICAgICAgICAgICAgICAiIG1zZjogJXggZm9ybWF0OiAweCUw
MnggdHJhY2svc2Vzc2lvbjogMHglMDJ4IiwKKyAgICAgICAgICAgICAgICByZXEtPmx1biwgcmVx
LT5pbl9sZW4sIG1zZiwgZm9ybWF0LCB0cmFja19udW0pOworCisgICAgY2Rfc2NzaV9jbWRfY29t
cGxldGVfZ29vZChkZXYsIHJlcSk7Cit9CisKKyNkZWZpbmUgQ0RfTU9ERV9QQVJBTV82X0xFTl9I
RUFERVIgICAgICAgICAgICAgIDQKKyNkZWZpbmUgQ0RfTU9ERV9QQVJBTV8xMF9MRU5fSEVBREVS
ICAgICAgICAgICAgIDgKKworI2RlZmluZSBDRF9NT0RFX1BBR0VfTEVOX1JXX0VSUk9SICAgICAg
ICAgICAgICAgMTIKKworc3RhdGljIHVpbnQzMl90IGNkX3Njc2lfYWRkX21vZGVfcGFnZV9yd19l
cnJvcl9yZWNvdmVyeShDZFNjc2lMVSAqZGV2LCB1aW50OF90ICpvdXRidWYpCit7CisgICAgdWlu
dDMyX3QgcGFnZV9sZW4gPSBDRF9NT0RFX1BBR0VfTEVOX1JXX0VSUk9SOworCisgICAgb3V0YnVm
WzBdID0gTU9ERV9QQUdFX1JfV19FUlJPUjsKKyAgICBvdXRidWZbMV0gPSBDRF9NT0RFX1BBR0Vf
TEVOX1JXX0VSUk9SIC0gMjsKKyAgICBvdXRidWZbM10gPSAxOyAvKiByZWFkIHJldHJ5IGNvdW50
ICovCisKKyAgICByZXR1cm4gcGFnZV9sZW47Cit9CisKKyNkZWZpbmUgQ0RfTU9ERV9QQUdFX0xF
Tl9QT1dFUiAgICAgICAgICAgICAgICAgIDEyCisKK3N0YXRpYyB1aW50MzJfdCBjZF9zY3NpX2Fk
ZF9tb2RlX3BhZ2VfcG93ZXJfY29uZGl0aW9uKENkU2NzaUxVICpkZXYsIHVpbnQ4X3QgKm91dGJ1
ZikKK3sKKyAgICB1aW50MzJfdCBwYWdlX2xlbiA9IENEX01PREVfUEFHRV9MRU5fUE9XRVI7CisK
KyAgICBvdXRidWZbMF0gPSBNT0RFX1BBR0VfUE9XRVI7CisgICAgb3V0YnVmWzFdID0gQ0RfTU9E
RV9QQUdFX0xFTl9QT1dFUiAtIDI7CisKKyAgICByZXR1cm4gcGFnZV9sZW47Cit9CisKKyNkZWZp
bmUgQ0RfTU9ERV9QQUdFX0xFTl9GQVVMVF9GQUlMICAgICAgICAgICAgIDEyCisjZGVmaW5lIENE
X01PREVfUEFHRV9GQVVMVF9GQUlMX0ZMQUdfUEVSRiAgICAgICAweDgwCisKK3N0YXRpYyB1aW50
MzJfdCBjZF9zY3NpX2FkZF9tb2RlX3BhZ2VfZmF1bHRfcmVwb3J0aW5nKENkU2NzaUxVICpkZXYs
IHVpbnQ4X3QgKm91dGJ1ZikKK3sKKyAgICB1aW50MzJfdCBwYWdlX2xlbiA9IENEX01PREVfUEFH
RV9MRU5fRkFVTFRfRkFJTDsKKworICAgIG91dGJ1ZlswXSA9IE1PREVfUEFHRV9GQVVMVF9GQUlM
OworICAgIG91dGJ1ZlsxXSA9IENEX01PREVfUEFHRV9MRU5fRkFVTFRfRkFJTCAtIDI7CisgICAg
b3V0YnVmWzJdIHw9IENEX01PREVfUEFHRV9GQVVMVF9GQUlMX0ZMQUdfUEVSRjsKKworICAgIHJl
dHVybiBwYWdlX2xlbjsKK30KKworI2RlZmluZSBDRF9NT0RFX1BBR0VfTEVOX0NBUFNfTUVDSF9T
VEFUVVNfUk8gICAgMjYKKy8qIGJ5dGUgMiAqLworI2RlZmluZSBDRF9NT0RFX1BBR0VfQ0FQU19D
RF9SX1JFQUQgICAgICAgICAgICAgMHgwMQorI2RlZmluZSBDRF9NT0RFX1BBR0VfQ0FQU19DRF9S
V19SRUFEICAgICAgICAgICAgKDB4MDEgPDwgMSkKKyNkZWZpbmUgQ0RfTU9ERV9QQUdFX0NBUFNf
RFZEX1JPTV9SRUFEICAgICAgICAgICgweDAxIDw8IDMpCisjZGVmaW5lIENEX01PREVfUEFHRV9D
QVBTX0RWRF9SX1JFQUQgICAgICAgICAgICAoMHgwMSA8PCA0KQorI2RlZmluZSBDRF9NT0RFX1BB
R0VfQ0FQU19EVkRfUkFNX1JFQUQgICAgICAgICAgKDB4MDEgPDwgNSkKKy8qIGJ5dGUgNiAqLwor
I2RlZmluZSBDRF9NT0RFX1BBR0VfQ0FQU19MT0NLX1NVUFBPUlQgICAgICAgICAgKDB4MDEpCisj
ZGVmaW5lIENEX01PREVfUEFHRV9DQVBTX0xPQ0tfU1RBVEUgICAgICAgICAgICAoMHgwMSA8PCAx
KQorI2RlZmluZSBDRF9NT0RFX1BBR0VfQ0FQU19QUkVWRU5UX0pVTVBFUiAgICAgICAgKDB4MDEg
PDwgMikKKyNkZWZpbmUgQ0RfTU9ERV9QQUdFX0NBUFNfRUpFQ1QgICAgICAgICAgICAgICAgICgw
eDAxIDw8IDMpCisjZGVmaW5lIENEX01PREVfUEFHRV9DQVBTX0xPQURJTkdfVFJBWSAgICAgICAg
ICAoMHgwMSA8PCA1KQorCitzdGF0aWMgdWludDMyX3QgY2Rfc2NzaV9hZGRfbW9kZV9wYWdlX2Nh
cHNfbWVjaF9zdGF0dXMoQ2RTY3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVmKQoreworICAgIHVp
bnQzMl90IHBhZ2VfbGVuID0gQ0RfTU9ERV9QQUdFX0xFTl9DQVBTX01FQ0hfU1RBVFVTX1JPOyAv
KiBubyB3cml0ZSAqLworCisgICAgb3V0YnVmWzBdID0gTU9ERV9QQUdFX0NBUFNfTUVDSF9TVEFU
VVM7CisgICAgb3V0YnVmWzFdID0gcGFnZV9sZW47CisgICAgb3V0YnVmWzJdID0gQ0RfTU9ERV9Q
QUdFX0NBUFNfQ0RfUl9SRUFEIHwgQ0RfTU9ERV9QQUdFX0NBUFNfQ0RfUldfUkVBRCB8CisgICAg
ICAgICAgICAgICAgQ0RfTU9ERV9QQUdFX0NBUFNfRFZEX1JPTV9SRUFEIHwgQ0RfTU9ERV9QQUdF
X0NBUFNfRFZEX1JfUkVBRCB8CisgICAgICAgICAgICAgICAgQ0RfTU9ERV9QQUdFX0NBUFNfRFZE
X1JBTV9SRUFEOworICAgIG91dGJ1Zls2XSA9IENEX01PREVfUEFHRV9DQVBTX0xPQURJTkdfVFJB
WSB8IENEX01PREVfUEFHRV9DQVBTX0VKRUNUIHwKKyAgICAgICAgICAgICAgICBDRF9NT0RFX1BB
R0VfQ0FQU19MT0NLX1NVUFBPUlQ7CisgICAgaWYgKGRldi0+cHJldmVudF9tZWRpYV9yZW1vdmFs
KSB7CisgICAgICAgIG91dGJ1Zls2XSB8PSBDRF9NT0RFX1BBR0VfQ0FQU19MT0NLX1NUQVRFOwor
ICAgIH0KKworICAgIHJldHVybiBwYWdlX2xlbjsKK30KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9j
bWRfbW9kZV9zZW5zZV8xMChDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7Cisg
ICAgdWludDhfdCAqb3V0YnVmID0gcmVxLT5idWY7CisgICAgaW50IGxvbmdfbGJhLCBkYmQsIHBh
Z2UsIHN1Yl9wYWdlLCBwYzsKKyAgICB1aW50MzJfdCByZXNwX2xlbiA9IENEX01PREVfUEFSQU1f
MTBfTEVOX0hFQURFUjsKKworICAgIHJlcS0+eGZlcl9kaXIgPSBTQ1NJX1hGRVJfRlJPTV9ERVY7
CisKKyAgICBsb25nX2xiYSA9IChyZXEtPmNkYlsxXSA+PiA0KSAmIDB4MTsKKyAgICBkYmQgPSAo
cmVxLT5jZGJbMV0gPj4gMykgJiAweDE7CisgICAgcGFnZSA9IHJlcS0+Y2RiWzJdICYgMHgzZjsK
KyAgICBwYyA9IHJlcS0+Y2RiWzJdID4+IDY7CisgICAgc3ViX3BhZ2UgPSByZXEtPmNkYlszXTsK
KworICAgIHJlcS0+cmVxX2xlbiA9IChyZXEtPmNkYls3XSA8PCA4KSB8IHJlcS0+Y2RiWzhdOwor
CisgICAgbWVtc2V0KG91dGJ1ZiwgMCwgcmVxLT5yZXFfbGVuKTsKKyAgICBvdXRidWZbMl0gPSAg
MDsgLyogbWVkaXVtIHR5cGUgKi8KKworICAgIHN3aXRjaCAocGFnZSkgeworICAgIGNhc2UgTU9E
RV9QQUdFX1JfV19FUlJPUjoKKyAgICAgICAgLyogUmVhZC9Xcml0ZSBFcnJvciBSZWNvdmVyeSAq
LworICAgICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9tb2RlX3BhZ2VfcndfZXJyb3JfcmVj
b3ZlcnkoZGV2LCBvdXRidWYgKyByZXNwX2xlbik7CisgICAgICAgIGJyZWFrOworICAgIGNhc2Ug
TU9ERV9QQUdFX1BPV0VSOgorICAgICAgICAvKiBQb3dlciBDb25kaXN0aW9ucyAqLworICAgICAg
ICByZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9tb2RlX3BhZ2VfcG93ZXJfY29uZGl0aW9uKGRldiwg
b3V0YnVmICsgcmVzcF9sZW4pOworICAgICAgICBicmVhazsKKyAgICBjYXNlIE1PREVfUEFHRV9G
QVVMVF9GQUlMOgorICAgICAgICAvKiBGYXVsdCAvIEZhaWx1cmUgUmVwb3J0aW5nIENvbnRyb2wg
Ki8KKyAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9hZGRfbW9kZV9wYWdlX2ZhdWx0X3JlcG9y
dGluZyhkZXYsIG91dGJ1ZiArIHJlc3BfbGVuKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBN
T0RFX1BBR0VfQ0FQU19NRUNIX1NUQVRVUzoKKyAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9h
ZGRfbW9kZV9wYWdlX2NhcHNfbWVjaF9zdGF0dXMoZGV2LCBvdXRidWYgKyByZXNwX2xlbik7Cisg
ICAgICAgIGJyZWFrOworCisgICAgLyogbm90IGltcGxlbWVudGVkICovCisgICAgY2FzZSBNT0RF
X1BBR0VfV1JJVEVfUEFSQU1FVEVSOiAvKiBXcml0ZXIgUGFyYW1ldGVycyAqLworICAgIGNhc2Ug
TU9ERV9QQUdFX01SVzoKKyAgICBjYXNlIE1PREVfUEFHRV9NUldfVkVORE9SOiAvKiBNUlcgKE1v
dW50IFJhaW5pZXIgUmUtd3JpdGFibGUgRGlza3MgKi8KKyAgICBjYXNlIE1PREVfUEFHRV9DRF9E
RVZJQ0U6IC8qIENEIERldmljZSBwYXJhbWV0ZXJzICovCisgICAgY2FzZSBNT0RFX1BBR0VfVE9f
UFJPVEVDVDogLyogVGltZS1vdXQgYW5kIFByb3RlY3QgKi8KKyAgICBkZWZhdWx0OgorICAgICAg
ICBTUElDRV9ERUJVRygibW9kZV9zZW5zZV8xMCwgbHVuOiV1IgorICAgICAgICAgICAgICAgICAg
ICAiIHBhZ2UgMHgleCBub3QgaW1wbGVtZW50ZWQiLAorICAgICAgICAgICAgICAgICAgICByZXEt
Pmx1biwgKHVuc2lnbmVkKXBhZ2UpOworICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVj
a19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZBTElEX0NEQl9GSUVMRCk7CisgICAgICAg
IHJldHVybjsKKyAgICB9CisKKyAgICBvdXRidWZbMF0gPSAoKHJlc3BfbGVuIC0gMikgPj4gOCkg
JiAweGZmOworICAgIG91dGJ1ZlsxXSA9IChyZXNwX2xlbiAtIDIpICYgMHhmZjsKKworICAgIHJl
cS0+aW5fbGVuID0gTUlOKHJlcS0+cmVxX2xlbiwgcmVzcF9sZW4pOworCisgICAgU1BJQ0VfREVC
VUcoIm1vZGVfc2Vuc2VfMTAsIGx1bjoldSIKKyAgICAgICAgICAgICAgICAiIGxvbmdfbGJhICVk
LCBkYmQgJWQsIHBhZ2UgJWQsIHN1Yl9wYWdlICVkLCBwYyAlZDsgIgorICAgICAgICAgICAgICAg
ICJyZXNwX2xlbiAldSIsCisgICAgICAgICAgICAgICAgcmVxLT5sdW4sIGxvbmdfbGJhLCBkYmQs
IHBhZ2UsIHN1Yl9wYWdlLCBwYywgcmVzcF9sZW4pOworCisgICAgY2Rfc2NzaV9jbWRfY29tcGxl
dGVfZ29vZChkZXYsIHJlcSk7Cit9CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX21vZGVfc2Vs
ZWN0XzYoQ2RTY3NpTFUgKmRldiwgQ2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAgIHVpbnQ4X3Qg
KmJsb2NrX2Rlc2NfZGF0YSwgKm1vZGVfZGF0YTsKKyAgICB1aW50MzJfdCBwYWdlX2Zvcm1hdCwg
c2F2ZV9wYWdlcywgbGlzdF9sZW47IC8qIGNkYiAqLworICAgIHVpbnQzMl90IG51bV9ibG9ja3Mg
PSAwLCBibG9ja19sZW4gPSAwOyAvKiBibG9jayBkZXNjcmlwdG9yICovCisgICAgdWludDMyX3Qg
bW9kZV9sZW4sIG1lZGl1bV90eXBlLCBkZXZfcGFyYW0sIGJsb2NrX2Rlc2NfbGVuOyAvKiBtb2Rl
IHBhcmFtIGhlYWRlciAqLworICAgIHVpbnQzMl90IHBhZ2VfbnVtID0gMCwgcGFnZV9sZW4gPSAw
OyAvKiBtb2RlIHBhZ2UgKi8KKworICAgIHBhZ2VfZm9ybWF0ID0gKHJlcS0+Y2RiWzFdID4+IDQp
ICYgMHgxOworICAgIHNhdmVfcGFnZXMgPSByZXEtPmNkYlsxXSAmIDB4MTsKKyAgICBsaXN0X2xl
biA9IHJlcS0+Y2RiWzRdOworCisgICAgaWYgKGxpc3RfbGVuID4gcmVxLT5idWZfbGVuKSB7Cisg
ICAgICAgIFNQSUNFX0RFQlVHKCJtb2RlX3NlbGVjdF82LCBsdW46JXUiCisgICAgICAgICAgICAg
ICAgICAgICIgcGY6JXUgc3A6JXUiCisgICAgICAgICAgICAgICAgICAgICIgbGlzdF9sZW46JXUg
ZXhjZWVkcyBkYXRhX2xlbjoldSIsCisgICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBwYWdl
X2Zvcm1hdCwgc2F2ZV9wYWdlcywgbGlzdF9sZW4sIHJlcS0+YnVmX2xlbik7CisgICAgICAgIGNk
X3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX0lOVkFM
SURfUEFSQU1fTEVOKTsKKyAgICAgICAgcmV0dXJuOworICAgIH0KKworICAgIG1vZGVfbGVuID0g
cmVxLT5idWZbMF07CisgICAgbWVkaXVtX3R5cGUgPSByZXEtPmJ1ZlsxXTsKKyAgICBkZXZfcGFy
YW0gPSByZXEtPmJ1ZlsyXTsKKyAgICBibG9ja19kZXNjX2xlbiA9IHJlcS0+YnVmWzNdOworCisg
ICAgaWYgKGJsb2NrX2Rlc2NfbGVuKSB7CisgICAgICAgIGJsb2NrX2Rlc2NfZGF0YSA9ICZyZXEt
PmJ1ZltDRF9NT0RFX1BBUkFNXzZfTEVOX0hFQURFUl07CisgICAgICAgIG51bV9ibG9ja3MgPSAo
YmxvY2tfZGVzY19kYXRhWzNdIDw8IDE2KSB8IChibG9ja19kZXNjX2RhdGFbMl0gPDwgOCkgfCBi
bG9ja19kZXNjX2RhdGFbM107CisgICAgICAgIGJsb2NrX2xlbiA9IChibG9ja19kZXNjX2RhdGFb
NV0gPDwgMTYpIHwgKGJsb2NrX2Rlc2NfZGF0YVs2XSA8PCA4KSB8IGJsb2NrX2Rlc2NfZGF0YVs3
XTsKKyAgICB9CisKKyAgICBpZiAobW9kZV9sZW4pIHsKKyAgICAgICAgbW9kZV9kYXRhID0gJnJl
cS0+YnVmW0NEX01PREVfUEFSQU1fNl9MRU5fSEVBREVSXTsKKyAgICAgICAgaWYgKGJsb2NrX2Rl
c2NfbGVuKSB7CisgICAgICAgICAgICBtb2RlX2RhdGEgKz0gYmxvY2tfZGVzY19sZW47CisgICAg
ICAgIH0KKyAgICAgICAgcGFnZV9udW0gPSBtb2RlX2RhdGFbMF0gJiAweDNmOworICAgICAgICBw
YWdlX2xlbiA9IG1vZGVfZGF0YVsxXTsKKyAgICB9CisKKyAgICBTUElDRV9ERUJVRygibW9kZV9z
ZWxlY3RfNiwgbHVuOiV1IgorICAgICAgICAgICAgICAgICIgcGY6JXUgc3A6JXUgbGlzdF9sZW46
JXUgZGF0YV9sZW46JXUiCisgICAgICAgICAgICAgICAgIiBtb2RlX2xlbjoldSBtZWRpdW06JXUg
ZGV2X3BhcmFtOiV1IGJsa19kZXNjX2xlbjoldSIKKyAgICAgICAgICAgICAgICAiIG51bV9ibG9j
a3M6JXUgYmxvY2tfbGVuOiV1IgorICAgICAgICAgICAgICAgICIgcGFnZV9udW06JXUgcGFnZV9s
ZW46JXUiLAorICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBwYWdlX2Zvcm1hdCwgc2F2ZV9wYWdl
cywgbGlzdF9sZW4sIHJlcS0+YnVmX2xlbiwKKyAgICAgICAgICAgICAgICBtb2RlX2xlbiwgbWVk
aXVtX3R5cGUsIGRldl9wYXJhbSwgYmxvY2tfZGVzY19sZW4sCisgICAgICAgICAgICAgICAgbnVt
X2Jsb2NrcywgYmxvY2tfbGVuLAorICAgICAgICAgICAgICAgIHBhZ2VfbnVtLCBwYWdlX2xlbik7
CisKKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworc3RhdGlj
IHZvaWQgY2Rfc2NzaV9jbWRfbW9kZV9zZWxlY3RfMTAoQ2RTY3NpTFUgKmRldiwgQ2RTY3NpUmVx
dWVzdCAqcmVxKQoreworICAgIHVpbnQzMl90IHBhZ2VfZm9ybWF0LCBzYXZlX3BhZ2VzLCBsaXN0
X2xlbjsKKworICAgIHBhZ2VfZm9ybWF0ID0gKHJlcS0+Y2RiWzFdID4+IDQpICYgMHgxOworICAg
IHNhdmVfcGFnZXMgPSByZXEtPmNkYlsxXSAmIDB4MTsKKyAgICBsaXN0X2xlbiA9IChyZXEtPmNk
Yls3XSA8PCA4KSB8IHJlcS0+Y2RiWzhdOworCisgICAgaWYgKGxpc3RfbGVuID4gcmVxLT5idWZf
bGVuKSB7CisgICAgICAgIFNQSUNFX0RFQlVHKCJtb2RlX3NlbGVjdF8xMCwgbHVuOiV1IHBmOiV1
IHNwOiV1IgorICAgICAgICAgICAgICAgICAgICAiIGxpc3RfbGVuOiV1IGV4Y2VlZHMgZGF0YV9s
ZW46JXUiLAorICAgICAgICAgICAgICAgICAgICByZXEtPmx1biwgcGFnZV9mb3JtYXQsIHNhdmVf
cGFnZXMsIGxpc3RfbGVuLCByZXEtPmJ1Zl9sZW4pOworICAgICAgICBjZF9zY3NpX2NtZF9jb21w
bGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZBTElEX1BBUkFNX0xFTik7
CisgICAgICAgIHJldHVybjsKKyAgICB9CisKKyAgICBTUElDRV9ERUJVRygibW9kZV9zZWxlY3Rf
MTAsIGx1bjoldSBwZjoldSBzcDoldSIKKyAgICAgICAgICAgICAgICAiIGxpc3RfbGVuOiV1IGRh
dGFfbGVuOiV1IiwKKyAgICAgICAgICAgICAgICByZXEtPmx1biwgcGFnZV9mb3JtYXQsIHNhdmVf
cGFnZXMsIGxpc3RfbGVuLCByZXEtPmJ1Zl9sZW4pOworCisgICAgY2Rfc2NzaV9jbWRfY29tcGxl
dGVfZ29vZChkZXYsIHJlcSk7Cit9CisKKyNkZWZpbmUgQ0RfRkVBVFVSRV9IRUFERVJfTEVOICAg
ICAgICAgICAgICAgOAorI2RlZmluZSBDRF9GRUFUVVJFX0RFU0NfTEVOICAgICAgICAgICAgICAg
ICA0CisKKyNkZWZpbmUgQ0RfUFJPRklMRV9ERVNDX0xFTiAgICAgICAgICAgICAgICAgNAorI2Rl
ZmluZSBDRF9QUk9GSUxFX0NVUlJFTlQgICAgICAgICAgICAgICAgICAweDAxCisKKy8qIFByb2Zp
bGVzIExpc3QgKi8KKyNkZWZpbmUgQ0RfRkVBVFVSRV9OVU1fUFJPRklMRVNfTElTVCAgICAgICAg
MHgwMAorLyogQ29yZSAtIEJhc2ljIEZ1bmN0aW9uYWxpdHkgKi8KKyNkZWZpbmUgQ0RfRkVBVFVS
RV9OVU1fQ09SRSAgICAgICAgICAgICAgICAgMHgwMQorLyogTW9ycGhpbmcgLSBUaGUgZGV2aWNl
IGNoYW5nZXMgaXRzIGJlaGF2aW9yIGR1ZSB0byBleHRlcm5hbCBldmVudHMgKi8KKyNkZWZpbmUg
Q0RfRkVBVFVSRV9OVU1fTU9SUEggICAgICAgICAgICAgICAgMHgwMgorLyogUmVtb3ZhYmxlIE1l
ZGl1bSAtIFRoZSBtZWRpdW0gbWF5IGJlIHJlbW92ZWQgZnJvbSB0aGUgZGV2aWNlICovCisjZGVm
aW5lIENEX0ZFQVRVUkVfTlVNX1JFTU9WQUJMRSAgICAgICAgICAgIDB4MDMKKy8qIFJhbmRvbSBS
ZWFkYWJsZSAtIFBQPTEgUmVhZCBhYmlsaXR5IGZvciBzdG9yYWdlIGRldmljZXMgd2l0aCByYW5k
b20gYWRkcmVzc2luZyAqLworI2RlZmluZSBDRF9GRUFUVVJFX05VTV9SQU5ET01fUkVBRCAgICAg
ICAgICAweDEwCisvKiBDRCBSZWFkIC0gVGhlIGFiaWxpdHkgdG8gcmVhZCBDRCBzcGVjaWZpYyBz
dHJ1Y3R1cmVzICovCisjZGVmaW5lIENEX0ZFQVRVUkVfTlVNX0NEX1JFQUQgICAgICAgICAgICAg
IDB4MUUKKy8qIERWRCBSZWFkIC0gVGhlIGFiaWxpdHkgdG8gcmVhZCBEVkQgc3BlY2lmaWMgc3Ry
dWN0dXJlcyAqLworI2RlZmluZSBDRF9GRUFUVVJFX05VTV9EVkRfUkVBRCAgICAgICAgICAgICAw
eDFGCisvKiBQb3dlciBNYW5hZ2VtZW50IC0gSW5pdGlhdG9yIGFuZCBkZXZpY2UgZGlyZWN0ZWQg
cG93ZXIgbWFuYWdlbWVudCAqLworI2RlZmluZSBDRF9GRUFUVVJFX05VTV9QT1dFUl9NTkdUICAg
ICAgICAgICAweDEwMAorLyogVGltZW91dCAqLworI2RlZmluZSBDRF9GRUFUVVJFX05VTV9USU1F
T1VUICAgICAgICAgICAgICAweDEwNQorCisjZGVmaW5lIENEX0ZFQVRVUkVfUkVRX0FMTCAgICAg
ICAgICAgICAgICAgIDAKKyNkZWZpbmUgQ0RfRkVBVFVSRV9SRVFfQ1VSUkVOVCAgICAgICAgICAg
ICAgMQorI2RlZmluZSBDRF9GRUFUVVJFX1JFUV9TSU5HTEUgICAgICAgICAgICAgICAyCisKKyNk
ZWZpbmUgQ0RfRkVBVFVSRV9DVVJSRU5UICAgICAgICAgICAgICAgICAgMHgwMQorI2RlZmluZSBD
RF9GRUFUVVJFX1BFUlNJU1RFTlQgICAgICAgICAgICAgICAweDAyCisKKyNkZWZpbmUgQ0RfRkVB
VFVSRV9WRVJTSU9OXzEgICAgICAgICAgICAgICAgKDB4MDEgPDwgMikKKworI2RlZmluZSBDRF9G
RUFUVVJFX1BIWVNfSUZfU0NTSSAgICAgICAgICAgICAweDAxCisKKyNkZWZpbmUgQ0RfRkVBVFVS
RV9SRU1PVkFCTEVfTE9BRElOR19UUkFZICAgKDB4MDEgPDwgNSkKKyNkZWZpbmUgQ0RfRkVBVFVS
RV9SRU1PVkFCTEVfRUpFQ1QgICAgICAgICAgKDB4MDEgPDwgMykKKyNkZWZpbmUgQ0RfRkVBVFVS
RV9SRU1PVkFCTEVfTk9fUFJWTlRfSk1QUiAgKDB4MDEgPDwgMikKKyNkZWZpbmUgQ0RfRkVBVFVS
RV9SRU1PVkFCTEVfTE9DSyAgICAgICAgICAgKDB4MDEpCisKK3N0YXRpYyBnYm9vbGVhbiBjZF9z
Y3NpX2ZlYXR1cmVfcmVwb3J0YWJsZSh1aW50MzJfdCBmZWF0dXJlLCB1aW50MzJfdCBzdGFydF9m
ZWF0dXJlLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQz
Ml90IHJlcV90eXBlKQoreworICAgIHJldHVybiAocmVxX3R5cGUgPT0gQ0RfRkVBVFVSRV9SRVFf
U0lOR0xFICYmIHN0YXJ0X2ZlYXR1cmUgPT0gZmVhdHVyZSkgfHwKKyAgICAgICAgICAgKGZlYXR1
cmUgPj0gc3RhcnRfZmVhdHVyZSk7Cit9CisKK3N0YXRpYyB1aW50MzJfdCBjZF9zY3NpX2FkZF9m
ZWF0dXJlX3Byb2ZpbGVzX2xpc3QoQ2RTY3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVmLAorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCBz
dGFydF9mZWF0dXJlLCB1aW50MzJfdCByZXFfdHlwZSkKK3sKKyAgICB1aW50OF90ICpwcm9maWxl
ID0gb3V0YnVmICsgQ0RfRkVBVFVSRV9ERVNDX0xFTjsKKyAgICB1aW50MzJfdCBmZWF0dXJlX2xl
biA9IENEX0ZFQVRVUkVfREVTQ19MRU47CisgICAgdWludDMyX3QgYWRkX2xlbiwgcHJvZmlsZV9u
dW07CisKKyAgICBpZiAoIWNkX3Njc2lfZmVhdHVyZV9yZXBvcnRhYmxlKENEX0ZFQVRVUkVfTlVN
X1BST0ZJTEVTX0xJU1QsIHN0YXJ0X2ZlYXR1cmUsIHJlcV90eXBlKSkgeworICAgICAgICByZXR1
cm4gMDsKKyAgICB9CisgICAgLyogZmVhdHVyZSBkZXNjcmlwdG9yIGhlYWRlciAqLworICAgIG91
dGJ1ZlswXSA9IChDRF9GRUFUVVJFX05VTV9QUk9GSUxFU19MSVNUID4+IDgpICYgMHhmZjsKKyAg
ICBvdXRidWZbMV0gPSBDRF9GRUFUVVJFX05VTV9QUk9GSUxFU19MSVNUICYgMHhmZjsKKyAgICBv
dXRidWZbMl0gPSBDRF9GRUFUVVJFX1BFUlNJU1RFTlQgfCBDRF9GRUFUVVJFX0NVUlJFTlQ7CisK
KyAgICAvKiBEVkQtUk9NIHByb2ZpbGUgZGVzY3JpcHRvciAqLworICAgIGFkZF9sZW4gPSBDRF9Q
Uk9GSUxFX0RFU0NfTEVOOyAvKiBzdGFydCB3aXRoIHNpbmdsZSBwcm9maWxlLCBhZGQgbGF0ZXIg
Ki8KKyAgICBwcm9maWxlX251bSA9IE1NQ19QUk9GSUxFX0RWRF9ST007CisKKyAgICBwcm9maWxl
WzBdID0gKHByb2ZpbGVfbnVtID4+IDgpICYgMHhmZjsgLyogZmVhdHVyZSBjb2RlICovCisgICAg
cHJvZmlsZVsxXSA9IHByb2ZpbGVfbnVtICYgMHhmZjsKKyAgICBwcm9maWxlWzJdID0gKCFkZXYt
PmNkX3JvbSkgPyBDRF9QUk9GSUxFX0NVUlJFTlQgOiAwOworCisgICAgLyogbmV4dCBwcm9maWxl
ICovCisgICAgYWRkX2xlbiArPSBDRF9QUk9GSUxFX0RFU0NfTEVOOworICAgIHByb2ZpbGUgKz0g
Q0RfUFJPRklMRV9ERVNDX0xFTjsKKworICAgIC8qIENELVJPTSBwcm9maWxlIGRlc2NyaXB0b3Ig
Ki8KKyAgICBwcm9maWxlX251bSA9IE1NQ19QUk9GSUxFX0NEX1JPTTsKKyAgICBwcm9maWxlWzBd
ID0gKHByb2ZpbGVfbnVtID4+IDgpICYgMHhmZjsKKyAgICBwcm9maWxlWzFdID0gcHJvZmlsZV9u
dW0gJiAweGZmOworICAgIHByb2ZpbGVbMl0gPSBkZXYtPmNkX3JvbSA/IENEX1BST0ZJTEVfQ1VS
UkVOVCA6IDA7CisKKyAgICBvdXRidWZbM10gPSBhZGRfbGVuOworICAgIGZlYXR1cmVfbGVuICs9
IGFkZF9sZW47CisKKyAgICByZXR1cm4gZmVhdHVyZV9sZW47Cit9CisKKyNkZWZpbmUgQ0RfRkVB
VFVSRV9DT1JFX1BIWVNfUFJPRklMRV9MRU4gICAgNAorCitzdGF0aWMgdWludDMyX3QgY2Rfc2Nz
aV9hZGRfZmVhdHVyZV9jb3JlKENkU2NzaUxVICpkZXYsIHVpbnQ4X3QgKm91dGJ1ZiwKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyX3Qgc3RhcnRfZmVhdHVy
ZSwgdWludDMyX3QgcmVxX3R5cGUpCit7CisgICAgdWludDhfdCAqcHJvZmlsZSA9IG91dGJ1ZiAr
IENEX0ZFQVRVUkVfREVTQ19MRU47CisgICAgdWludDMyX3QgZmVhdHVyZV9sZW4gPSBDRF9GRUFU
VVJFX0RFU0NfTEVOICsgQ0RfRkVBVFVSRV9DT1JFX1BIWVNfUFJPRklMRV9MRU47CisKKyAgICBp
ZiAoIWNkX3Njc2lfZmVhdHVyZV9yZXBvcnRhYmxlKENEX0ZFQVRVUkVfTlVNX0NPUkUsIHN0YXJ0
X2ZlYXR1cmUsIHJlcV90eXBlKSkgeworICAgICAgICByZXR1cm4gMDsKKyAgICB9CisgICAgb3V0
YnVmWzBdID0gKENEX0ZFQVRVUkVfTlVNX0NPUkUgPj4gOCkgJiAweGZmOworICAgIG91dGJ1Zlsx
XSA9IENEX0ZFQVRVUkVfTlVNX0NPUkUgJiAweGZmOworICAgIG91dGJ1ZlsyXSA9IENEX0ZFQVRV
UkVfUEVSU0lTVEVOVCB8IENEX0ZFQVRVUkVfQ1VSUkVOVDsKKyAgICBvdXRidWZbM10gPSBDRF9G
RUFUVVJFX0NPUkVfUEhZU19QUk9GSUxFX0xFTjsKKworICAgIHByb2ZpbGVbM10gPSBDRF9GRUFU
VVJFX1BIWVNfSUZfU0NTSTsKKworICAgIHJldHVybiBmZWF0dXJlX2xlbjsKK30KKworI2RlZmlu
ZSBDRF9GRUFUVVJFX01PUlBIX1BST0dJTEVfTEVOICAgIDQKKyNkZWZpbmUgQ0RfRkVBVFVSRV9N
T1JQSF9BU1lOQ19FVkVOVFMgICAweDAxCisKK3N0YXRpYyB1aW50MzJfdCBjZF9zY3NpX2FkZF9m
ZWF0dXJlX21vcnBoKENkU2NzaUxVICpkZXYsIHVpbnQ4X3QgKm91dGJ1ZiwKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IHN0YXJ0X2ZlYXR1cmUsIHVp
bnQzMl90IHJlcV90eXBlKQoreworICAgIHVpbnQ4X3QgKnByb2ZpbGUgPSBvdXRidWYgKyBDRF9G
RUFUVVJFX0RFU0NfTEVOOworICAgIHVpbnQzMl90IGZlYXR1cmVfbGVuID0gQ0RfRkVBVFVSRV9E
RVNDX0xFTiArIENEX0ZFQVRVUkVfTU9SUEhfUFJPR0lMRV9MRU47CisKKyAgICBpZiAoIWNkX3Nj
c2lfZmVhdHVyZV9yZXBvcnRhYmxlKENEX0ZFQVRVUkVfTlVNX01PUlBILCBzdGFydF9mZWF0dXJl
LCByZXFfdHlwZSkpIHsKKyAgICAgICAgcmV0dXJuIDA7CisgICAgfQorICAgIG91dGJ1ZlsxXSA9
IENEX0ZFQVRVUkVfTlVNX01PUlBIOworICAgIG91dGJ1ZlsyXSA9IENEX0ZFQVRVUkVfUEVSU0lT
VEVOVCB8IENEX0ZFQVRVUkVfQ1VSUkVOVDsKKyAgICBvdXRidWZbM10gPSBDRF9GRUFUVVJFX01P
UlBIX1BST0dJTEVfTEVOOworCisgICAgcHJvZmlsZVswXSA9IENEX0ZFQVRVUkVfTU9SUEhfQVNZ
TkNfRVZFTlRTOworCisgICAgcmV0dXJuIGZlYXR1cmVfbGVuOworfQorCisjZGVmaW5lIENEX0ZF
QVRVUkVfUkVNT1ZBQkxFX1BST0ZJTEVfTEVOICAgIDQKKworc3RhdGljIHVpbnQzMl90IGNkX3Nj
c2lfYWRkX2ZlYXR1cmVfcmVtb3ZhYmxlKENkU2NzaUxVICpkZXYsIHVpbnQ4X3QgKm91dGJ1ZiwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCBz
dGFydF9mZWF0dXJlLCB1aW50MzJfdCByZXFfdHlwZSkKK3sKKyAgICB1aW50OF90ICpwcm9maWxl
ID0gb3V0YnVmICsgQ0RfRkVBVFVSRV9ERVNDX0xFTjsKKyAgICB1aW50MzJfdCBmZWF0dXJlX2xl
biA9IENEX0ZFQVRVUkVfREVTQ19MRU4gKyBDRF9GRUFUVVJFX1JFTU9WQUJMRV9QUk9GSUxFX0xF
TjsKKworICAgIGlmICghY2Rfc2NzaV9mZWF0dXJlX3JlcG9ydGFibGUoQ0RfRkVBVFVSRV9OVU1f
UkVNT1ZBQkxFLCBzdGFydF9mZWF0dXJlLCByZXFfdHlwZSkpIHsKKyAgICAgICAgcmV0dXJuIDA7
CisgICAgfQorICAgIG91dGJ1ZlsxXSA9IENEX0ZFQVRVUkVfTlVNX1JFTU9WQUJMRTsKKyAgICBv
dXRidWZbMl0gPSBDRF9GRUFUVVJFX1BFUlNJU1RFTlQgfCBDRF9GRUFUVVJFX0NVUlJFTlQ7Cisg
ICAgb3V0YnVmWzNdID0gQ0RfRkVBVFVSRV9SRU1PVkFCTEVfUFJPRklMRV9MRU47CisKKyAgICBw
cm9maWxlWzBdID0gQ0RfRkVBVFVSRV9SRU1PVkFCTEVfTk9fUFJWTlRfSk1QUjsKKyAgICBpZiAo
ZGV2LT5yZW1vdmFibGUpIHsKKyAgICAgICAgcHJvZmlsZVswXSB8PSAoQ0RfRkVBVFVSRV9SRU1P
VkFCTEVfTE9BRElOR19UUkFZIHwgQ0RfRkVBVFVSRV9SRU1PVkFCTEVfRUpFQ1QpOworICAgIH0K
KworICAgIHJldHVybiBmZWF0dXJlX2xlbjsKK30KKworI2RlZmluZSBDRF9GRUFUVVJFX1JBTkRP
TV9SRUFEX1BST0ZJTEVfTEVOICAgIDgKKworc3RhdGljIHVpbnQzMl90IGNkX3Njc2lfYWRkX2Zl
YXR1cmVfcmFuZG9tX3JlYWQoQ2RTY3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVmLAorICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyX3Qgc3RhcnRf
ZmVhdHVyZSwgdWludDMyX3QgcmVxX3R5cGUpCit7CisgICAgdWludDhfdCAqcHJvZmlsZSA9IG91
dGJ1ZiArIENEX0ZFQVRVUkVfREVTQ19MRU47CisgICAgdWludDMyX3QgZmVhdHVyZV9sZW4gPSBD
RF9GRUFUVVJFX0RFU0NfTEVOICsgQ0RfRkVBVFVSRV9SQU5ET01fUkVBRF9QUk9GSUxFX0xFTjsK
KworICAgIGlmICghY2Rfc2NzaV9mZWF0dXJlX3JlcG9ydGFibGUoQ0RfRkVBVFVSRV9OVU1fUkFO
RE9NX1JFQUQsIHN0YXJ0X2ZlYXR1cmUsIHJlcV90eXBlKSkgeworICAgICAgICByZXR1cm4gMDsK
KyAgICB9CisgICAgb3V0YnVmWzBdID0gKENEX0ZFQVRVUkVfTlVNX1JBTkRPTV9SRUFEID4+IDgp
ICYgMHhmZjsKKyAgICBvdXRidWZbMV0gPSBDRF9GRUFUVVJFX05VTV9SQU5ET01fUkVBRCAmIDB4
ZmY7CisgICAgb3V0YnVmWzJdID0gQ0RfRkVBVFVSRV9QRVJTSVNURU5UIHwgQ0RfRkVBVFVSRV9D
VVJSRU5UOworICAgIG91dGJ1ZlszXSA9IENEX0ZFQVRVUkVfUkFORE9NX1JFQURfUFJPRklMRV9M
RU47CisKKyAgICBwcm9maWxlWzBdID0gKGRldi0+YmxvY2tfc2l6ZSA+PiAyNCkgJiAweGZmOwor
ICAgIHByb2ZpbGVbMV0gPSAoZGV2LT5ibG9ja19zaXplID4+IDE2KSAmIDB4ZmY7CisgICAgcHJv
ZmlsZVsyXSA9IChkZXYtPmJsb2NrX3NpemUgPj4gOCkgJiAweGZmOworICAgIHByb2ZpbGVbM10g
PSAoZGV2LT5ibG9ja19zaXplKSAmIDB4ZmY7CisgICAgcHJvZmlsZVs1XSA9IChkZXYtPmNkX3Jv
bSkgPyAweDAxIDogMHgxMDsgLyogbG9naWNhbCBibG9ja3MgcGVyIHJlYWRhYmxlIHVuaXQgKi8K
KworICAgIHJldHVybiBmZWF0dXJlX2xlbjsKK30KKworI2RlZmluZSBDRF9GRUFUVVJFX0NEX1JF
QURfUFJPRklMRV9MRU4gICAgNAorCitzdGF0aWMgdWludDMyX3QgY2Rfc2NzaV9hZGRfZmVhdHVy
ZV9jZF9yZWFkKENkU2NzaUxVICpkZXYsIHVpbnQ4X3QgKm91dGJ1ZiwKKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyX3Qgc3RhcnRfZmVhdHVyZSwgdWlu
dDMyX3QgcmVxX3R5cGUpCit7CisgICAgdWludDhfdCAqcHJvZmlsZSA9IG91dGJ1ZiArIENEX0ZF
QVRVUkVfREVTQ19MRU47CisgICAgdWludDMyX3QgZmVhdHVyZV9sZW4gPSBDRF9GRUFUVVJFX0RF
U0NfTEVOICsgQ0RfRkVBVFVSRV9DRF9SRUFEX1BST0ZJTEVfTEVOOworCisgICAgaWYgKCFjZF9z
Y3NpX2ZlYXR1cmVfcmVwb3J0YWJsZShDRF9GRUFUVVJFX05VTV9DRF9SRUFELCBzdGFydF9mZWF0
dXJlLCByZXFfdHlwZSkpIHsKKyAgICAgICAgcmV0dXJuIDA7CisgICAgfQorICAgIG91dGJ1Zlsw
XSA9IChDRF9GRUFUVVJFX05VTV9DRF9SRUFEID4+IDgpICYgMHhmZjsKKyAgICBvdXRidWZbMV0g
PSAoQ0RfRkVBVFVSRV9OVU1fQ0RfUkVBRCkgJiAweGZmOworICAgIG91dGJ1ZlsyXSA9IENEX0ZF
QVRVUkVfVkVSU0lPTl8xIHwgQ0RfRkVBVFVSRV9QRVJTSVNURU5UIHwgQ0RfRkVBVFVSRV9DVVJS
RU5UOworICAgIG91dGJ1ZlszXSA9IENEX0ZFQVRVUkVfQ0RfUkVBRF9QUk9GSUxFX0xFTjsKKwor
ICAgIHByb2ZpbGVbMF0gPSAwOyAvKiBDMiBFcnJvcnMsIENELVRleHQgbm90IHN1cHBvcnRlICov
CisKKyAgICByZXR1cm4gZmVhdHVyZV9sZW47Cit9CisKKyNkZWZpbmUgQ0RfRkVBVFVSRV9EVkRf
UkVBRF9QUk9GSUxFX0xFTiAgICAwCisKK3N0YXRpYyB1aW50MzJfdCBjZF9zY3NpX2FkZF9mZWF0
dXJlX2R2ZF9yZWFkKENkU2NzaUxVICpkZXYsIHVpbnQ4X3QgKm91dGJ1ZiwKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IHN0YXJ0X2ZlYXR1cmUs
IHVpbnQzMl90IHJlcV90eXBlKQoreworICAgIHVpbnQzMl90IGZlYXR1cmVfbGVuID0gQ0RfRkVB
VFVSRV9ERVNDX0xFTiArIENEX0ZFQVRVUkVfRFZEX1JFQURfUFJPRklMRV9MRU47CisKKyAgICBp
ZiAoIWNkX3Njc2lfZmVhdHVyZV9yZXBvcnRhYmxlKENEX0ZFQVRVUkVfTlVNX0NEX1JFQUQsIHN0
YXJ0X2ZlYXR1cmUsIHJlcV90eXBlKSkgeworICAgICAgICByZXR1cm4gMDsKKyAgICB9CisgICAg
b3V0YnVmWzBdID0gKENEX0ZFQVRVUkVfTlVNX0RWRF9SRUFEID4+IDgpICYgMHhmZjsKKyAgICBv
dXRidWZbMV0gPSAoQ0RfRkVBVFVSRV9OVU1fRFZEX1JFQUQpICYgMHhmZjsKKyAgICBvdXRidWZb
Ml0gPSBDRF9GRUFUVVJFX1ZFUlNJT05fMSB8IENEX0ZFQVRVUkVfUEVSU0lTVEVOVCB8IENEX0ZF
QVRVUkVfQ1VSUkVOVDsKKyAgICBvdXRidWZbM10gPSBDRF9GRUFUVVJFX0RWRF9SRUFEX1BST0ZJ
TEVfTEVOOworCisgICAgcmV0dXJuIGZlYXR1cmVfbGVuOworfQorCisjZGVmaW5lIENEX0ZFQVRV
UkVfUE9XRVJfTU5HVF9QUk9GSUxFX0xFTiAgICAwCisKK3N0YXRpYyB1aW50MzJfdCBjZF9zY3Np
X2FkZF9mZWF0dXJlX3Bvd2VyX21nbXQoQ2RTY3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVmLAor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCBz
dGFydF9mZWF0dXJlLCB1aW50MzJfdCByZXFfdHlwZSkKK3sKKyAgICB1aW50MzJfdCBmZWF0dXJl
X2xlbiA9IENEX0ZFQVRVUkVfREVTQ19MRU4gKyBDRF9GRUFUVVJFX1BPV0VSX01OR1RfUFJPRklM
RV9MRU47CisKKyAgICBpZiAoIWNkX3Njc2lfZmVhdHVyZV9yZXBvcnRhYmxlKENEX0ZFQVRVUkVf
TlVNX1BPV0VSX01OR1QsIHN0YXJ0X2ZlYXR1cmUsIHJlcV90eXBlKSkgeworICAgICAgICByZXR1
cm4gMDsKKyAgICB9CisgICAgb3V0YnVmWzBdID0gKENEX0ZFQVRVUkVfTlVNX1BPV0VSX01OR1Qg
Pj4gOCkgJiAweGZmOworICAgIG91dGJ1ZlsxXSA9IChDRF9GRUFUVVJFX05VTV9QT1dFUl9NTkdU
KSAmIDB4ZmY7CisgICAgb3V0YnVmWzJdID0gQ0RfRkVBVFVSRV9QRVJTSVNURU5UIHwgQ0RfRkVB
VFVSRV9DVVJSRU5UOworICAgIG91dGJ1ZlszXSA9IENEX0ZFQVRVUkVfUE9XRVJfTU5HVF9QUk9G
SUxFX0xFTjsKKworICAgIHJldHVybiBmZWF0dXJlX2xlbjsKK30KKworI2RlZmluZSBDRF9GRUFU
VVJFX1RJTUVPVVRfUFJPRklMRV9MRU4gICAgMAorCitzdGF0aWMgdWludDMyX3QgY2Rfc2NzaV9h
ZGRfZmVhdHVyZV90aW1lb3V0KENkU2NzaUxVICpkZXYsIHVpbnQ4X3QgKm91dGJ1ZiwKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyX3Qgc3RhcnRfZmVh
dHVyZSwgdWludDMyX3QgcmVxX3R5cGUpCit7CisgICAgdWludDMyX3QgZmVhdHVyZV9sZW4gPSBD
RF9GRUFUVVJFX0RFU0NfTEVOICsgQ0RfRkVBVFVSRV9USU1FT1VUX1BST0ZJTEVfTEVOOworCisg
ICAgaWYgKCFjZF9zY3NpX2ZlYXR1cmVfcmVwb3J0YWJsZShDRF9GRUFUVVJFX05VTV9USU1FT1VU
LCBzdGFydF9mZWF0dXJlLCByZXFfdHlwZSkpIHsKKyAgICAgICAgcmV0dXJuIDA7CisgICAgfQor
ICAgIG91dGJ1ZlswXSA9IChDRF9GRUFUVVJFX05VTV9USU1FT1VUID4+IDgpICYgMHhmZjsKKyAg
ICBvdXRidWZbMV0gPSBDRF9GRUFUVVJFX05VTV9USU1FT1VUICYgMHhmZjsKKyAgICBvdXRidWZb
Ml0gPSBDRF9GRUFUVVJFX1BFUlNJU1RFTlQgfCBDRF9GRUFUVVJFX0NVUlJFTlQ7CisgICAgb3V0
YnVmWzNdID0gQ0RfRkVBVFVSRV9USU1FT1VUX1BST0ZJTEVfTEVOOworCisgICAgcmV0dXJuIGZl
YXR1cmVfbGVuOworfQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9nZXRfY29uZmlndXJhdGlv
bihDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgdWludDhfdCAqb3V0
YnVmID0gcmVxLT5idWY7CisgICAgdWludDMyX3QgcHJvZmlsZV9udW0gPSAoIWRldi0+Y2Rfcm9t
KSA/IE1NQ19QUk9GSUxFX0RWRF9ST00gOiBNTUNfUFJPRklMRV9DRF9ST007CisgICAgdWludDMy
X3QgcmVxX3R5cGUsIHN0YXJ0X2ZlYXR1cmUsIHJlc3BfbGVuOworCisgICAgcmVxLT54ZmVyX2Rp
ciA9IFNDU0lfWEZFUl9GUk9NX0RFVjsKKworICAgIHJlcV90eXBlID0gcmVxLT5jZGJbMV0gJiAw
eDM7CisgICAgc3RhcnRfZmVhdHVyZSA9IChyZXEtPmNkYlsyXSA8PCA4KSB8IHJlcS0+Y2RiWzNd
OworICAgIHJlcS0+cmVxX2xlbiA9IChyZXEtPmNkYls3XSA8PCA4KSB8IHJlcS0+Y2RiWzhdOwor
CisgICAgbWVtc2V0KG91dGJ1ZiwgMCwgcmVxLT5yZXFfbGVuKTsKKworICAgIC8qIGF0IGxlYXN0
IEZlYXR1cmUgSGVhZGVyIHNob3VsZCBiZSBwcmVzZW50LCB0byBiZSBmaWxsZWQgbGF0ZXIgKi8K
KyAgICByZXNwX2xlbiA9IENEX0ZFQVRVUkVfSEVBREVSX0xFTjsKKworICAgIHN3aXRjaCAocmVx
X3R5cGUpIHsKKyAgICBjYXNlIENEX0ZFQVRVUkVfUkVRX0FMTDoKKyAgICBjYXNlIENEX0ZFQVRV
UkVfUkVRX0NVUlJFTlQ6CisgICAgICAgIHJlc3BfbGVuICs9IGNkX3Njc2lfYWRkX2ZlYXR1cmVf
cHJvZmlsZXNfbGlzdChkZXYsIG91dGJ1ZiArIHJlc3BfbGVuLCBzdGFydF9mZWF0dXJlLAorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxX3R5
cGUpOworICAgICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9mZWF0dXJlX2NvcmUoZGV2LCBv
dXRidWYgKyByZXNwX2xlbiwgc3RhcnRfZmVhdHVyZSwgcmVxX3R5cGUpOworICAgICAgICByZXNw
X2xlbiArPSBjZF9zY3NpX2FkZF9mZWF0dXJlX21vcnBoKGRldiwgb3V0YnVmICsgcmVzcF9sZW4s
IHN0YXJ0X2ZlYXR1cmUsIHJlcV90eXBlKTsKKyAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9h
ZGRfZmVhdHVyZV9yZW1vdmFibGUoZGV2LCBvdXRidWYgKyByZXNwX2xlbiwgc3RhcnRfZmVhdHVy
ZSwgcmVxX3R5cGUpOworICAgICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9mZWF0dXJlX3Jh
bmRvbV9yZWFkKGRldiwgb3V0YnVmICsgcmVzcF9sZW4sIHN0YXJ0X2ZlYXR1cmUsCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxX3R5cGUpOwor
ICAgICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9mZWF0dXJlX2NkX3JlYWQoZGV2LCBvdXRi
dWYgKyByZXNwX2xlbiwgc3RhcnRfZmVhdHVyZSwgcmVxX3R5cGUpOworICAgICAgICByZXNwX2xl
biArPSBjZF9zY3NpX2FkZF9mZWF0dXJlX2R2ZF9yZWFkKGRldiwgb3V0YnVmICsgcmVzcF9sZW4s
IHN0YXJ0X2ZlYXR1cmUsIHJlcV90eXBlKTsKKyAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9h
ZGRfZmVhdHVyZV9wb3dlcl9tZ210KGRldiwgb3V0YnVmICsgcmVzcF9sZW4sIHN0YXJ0X2ZlYXR1
cmUsIHJlcV90eXBlKTsKKyAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9hZGRfZmVhdHVyZV90
aW1lb3V0KGRldiwgb3V0YnVmICsgcmVzcF9sZW4sIHN0YXJ0X2ZlYXR1cmUsIHJlcV90eXBlKTsK
KyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBDRF9GRUFUVVJFX1JFUV9TSU5HTEU6CisgICAgICAg
IHN3aXRjaCAoc3RhcnRfZmVhdHVyZSkgeworICAgICAgICBjYXNlIENEX0ZFQVRVUkVfTlVNX0NP
UkU6CisgICAgICAgICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9mZWF0dXJlX2NvcmUoZGV2
LCBvdXRidWYgKyByZXNwX2xlbiwgc3RhcnRfZmVhdHVyZSwgcmVxX3R5cGUpOworICAgICAgICAg
ICAgYnJlYWs7CisgICAgICAgIGNhc2UgQ0RfRkVBVFVSRV9OVU1fTU9SUEg6CisgICAgICAgICAg
ICByZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9mZWF0dXJlX21vcnBoKGRldiwgb3V0YnVmICsgcmVz
cF9sZW4sIHN0YXJ0X2ZlYXR1cmUsIHJlcV90eXBlKTsKKyAgICAgICAgICAgIGJyZWFrOworICAg
ICAgICBjYXNlIENEX0ZFQVRVUkVfTlVNX1JFTU9WQUJMRToKKyAgICAgICAgICAgIHJlc3BfbGVu
ICs9IGNkX3Njc2lfYWRkX2ZlYXR1cmVfcmVtb3ZhYmxlKGRldiwgb3V0YnVmICsgcmVzcF9sZW4s
IHN0YXJ0X2ZlYXR1cmUsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICByZXFfdHlwZSk7CisgICAgICAgICAgICBicmVhazsKKyAgICAgICAgY2Fz
ZSBDRF9GRUFUVVJFX05VTV9SQU5ET01fUkVBRDoKKyAgICAgICAgICAgIHJlc3BfbGVuICs9IGNk
X3Njc2lfYWRkX2ZlYXR1cmVfcmFuZG9tX3JlYWQoZGV2LCBvdXRidWYgKyByZXNwX2xlbiwgc3Rh
cnRfZmVhdHVyZSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgcmVxX3R5cGUpOworICAgICAgICAgICAgYnJlYWs7CisgICAgICAgIGNhc2Ug
Q0RfRkVBVFVSRV9OVU1fQ0RfUkVBRDoKKyAgICAgICAgICAgIHJlc3BfbGVuICs9IGNkX3Njc2lf
YWRkX2ZlYXR1cmVfY2RfcmVhZChkZXYsIG91dGJ1ZiArIHJlc3BfbGVuLCBzdGFydF9mZWF0dXJl
LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJl
cV90eXBlKTsKKyAgICAgICAgICAgIGJyZWFrOworICAgICAgICBjYXNlIENEX0ZFQVRVUkVfTlVN
X0RWRF9SRUFEOgorICAgICAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9hZGRfZmVhdHVyZV9k
dmRfcmVhZChkZXYsIG91dGJ1ZiArIHJlc3BfbGVuLCBzdGFydF9mZWF0dXJlLAorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXFfdHlwZSk7Cisg
ICAgICAgICAgICBicmVhazsKKyAgICAgICAgY2FzZSBDRF9GRUFUVVJFX05VTV9QT1dFUl9NTkdU
OgorICAgICAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9hZGRfZmVhdHVyZV9wb3dlcl9tZ210
KGRldiwgb3V0YnVmICsgcmVzcF9sZW4sIHN0YXJ0X2ZlYXR1cmUsCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxX3R5cGUpOworICAgICAg
ICAgICAgYnJlYWs7CisgICAgICAgIGNhc2UgQ0RfRkVBVFVSRV9OVU1fVElNRU9VVDoKKyAgICAg
ICAgICAgIHJlc3BfbGVuICs9IGNkX3Njc2lfYWRkX2ZlYXR1cmVfdGltZW91dChkZXYsIG91dGJ1
ZiArIHJlc3BfbGVuLCBzdGFydF9mZWF0dXJlLAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHJlcV90eXBlKTsKKyAgICAgICAgICAgIGJyZWFrOwor
ICAgICAgICBkZWZhdWx0OgorICAgICAgICAgICAgYnJlYWs7CisgICAgICAgIH0KKyAgICAgICAg
YnJlYWs7CisKKyAgICBkZWZhdWx0OgorICAgICAgICBTUElDRV9ERUJVRygiZ2V0X2NvbmZpZ3Vy
YXRpb24sIGx1bjoldSBpbnZhbGlkIHJ0OiV1IHN0YXJ0X2Y6JXUiLAorICAgICAgICAgICAgICAg
ICAgICByZXEtPmx1biwgcmVxX3R5cGUsIHN0YXJ0X2ZlYXR1cmUpOworICAgICAgICBjZF9zY3Np
X2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZBTElEX0NE
Ql9GSUVMRCk7CisgICAgICAgIHJldHVybjsKKyAgICB9CisKKyAgICAvKiBzZXQgdG90YWwgZGF0
YSBsZW4gKi8KKyAgICBvdXRidWZbMF0gPSAocmVzcF9sZW4gPj4gMjQpICYgMHhmZjsKKyAgICBv
dXRidWZbMV0gPSAocmVzcF9sZW4gPj4gMTYpICYgMHhmZjsKKyAgICBvdXRidWZbMl0gPSAocmVz
cF9sZW4gPj4gOCkgJiAweGZmOworICAgIG91dGJ1ZlszXSA9IHJlc3BfbGVuICYgMHhmZjsKKwor
ICAgIC8qIHJlcG9ydCBjdXJyZW50IHByb2ZpbGUgbnVtICovCisgICAgb3V0YnVmWzZdID0gKHBy
b2ZpbGVfbnVtID4+IDgpICYgMHhmZjsKKyAgICBvdXRidWZbN10gPSBwcm9maWxlX251bSAmIDB4
ZmY7CisKKyAgICByZXEtPmluX2xlbiA9IE1JTihyZXEtPnJlcV9sZW4sIHJlc3BfbGVuKTsKKwor
ICAgIFNQSUNFX0RFQlVHKCJnZXRfY29uZmlndXJhdGlvbiwgbHVuOiV1IHJ0OiV1IHN0YXJ0X2Y6
JXUgcmVzcF9sZW46JXUiLAorICAgICAgICAgICAgICAgIHJlcS0+bHVuLCByZXFfdHlwZSwgc3Rh
cnRfZmVhdHVyZSwgcmVzcF9sZW4pOworCisgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfZ29vZChk
ZXYsIHJlcSk7Cit9CisKKyNkZWZpbmUgQ0RfR0VUX0VWRU5UX1NUQVRVU19JTU1FRCAgICAgICAg
ICAgIDB4MDEKKworI2RlZmluZSBDRF9HRVRfRVZFTlRfSEVBREVSX05PX0VWRU5UX0FWQUlMICAo
MHgwMSA8PCA3KQorI2RlZmluZSBDRF9HRVRfRVZFTlRfSEVBREVSX0xFTiAgICAgICAgICAgICA0
CisKKyNkZWZpbmUgQ0RfR0VUX0VWRU5UX0NMQVNTX05PTkUgICAgICAgICAgICAgKDB4MDApCisj
ZGVmaW5lIENEX0dFVF9FVkVOVF9DTEFTU19PUEVSX0NIQU5HRSAgICAgICgweDAxKQorI2RlZmlu
ZSBDRF9HRVRfRVZFTlRfQ0xBU1NfUE9XRVJfTUdNVCAgICAgICAoMHgwMikKKyNkZWZpbmUgQ0Rf
R0VUX0VWRU5UX0NMQVNTX0VYVEVSTkFMX1JFUSAgICAgKDB4MDMpCisjZGVmaW5lIENEX0dFVF9F
VkVOVF9DTEFTU19NRURJQSAgICAgICAgICAgICgweDA0KQorI2RlZmluZSBDRF9HRVRfRVZFTlRf
Q0xBU1NfTVVMVElfSU5JVElBVE9SICAoMHgwNSkKKyNkZWZpbmUgQ0RfR0VUX0VWRU5UX0NMQVNT
X0RFVl9CVVNZICAgICAgICAgKDB4MDYpCisKKyNkZWZpbmUgQ0RfR0VUX0VWRU5UX0xFTl9NRURJ
QSAgICAgICAgICAgICAgNAorCisjZGVmaW5lIENEX01FRElBX1NUQVRVU19NRURJQV9QUkVTRU5U
ICAgICAgIDB4MQorI2RlZmluZSBDRF9NRURJQV9TVEFUVVNfVFJBWV9PUEVOICAgICAgICAgICAw
eDIKKworc3RhdGljIHVpbnQzMl90IGNkX3Njc2lfY21kX2dldF9ldmVudF9yZXNwX2FkZF9tZWRp
YShDZFNjc2lMVSAqZGV2LCB1aW50OF90ICpvdXRidWYpCit7CisgICAgb3V0YnVmWzBdID0gKHVp
bnQ4X3QpZGV2LT5tZWRpYV9ldmVudCAmIDB4MGY7CisgICAgb3V0YnVmWzFdID0gKHVpbnQ4X3Qp
KChkZXYtPmxvYWRlZCA/IDAgOiBDRF9NRURJQV9TVEFUVVNfVFJBWV9PUEVOKSB8CisgICAgICAg
ICAgICAgICAgICAgICAgICAgIChkZXYtPnN0cmVhbSAhPSBOVUxMID8gQ0RfTUVESUFfU1RBVFVT
X01FRElBX1BSRVNFTlQgOiAwKSk7CisKKyAgICBkZXYtPm1lZGlhX2V2ZW50ID0gQ0RfTUVESUFf
RVZFTlRfTk9fQ0hBTkdFOyAvKiByZXNldCB0aGUgZXZlbnQgKi8KKyAgICByZXR1cm4gQ0RfR0VU
X0VWRU5UX0xFTl9NRURJQTsKK30KKworI2RlZmluZSBDRF9HRVRfRVZFTlRfTEVOX1BPV0VSICAg
ICAgICAgICAgICA0CisKKyNkZWZpbmUgQ0RfUE9XRVJfU1RBVFVTX0FDVElWRSAgICAgICAgICAg
ICAgMHgxCisjZGVmaW5lIENEX1BPV0VSX1NUQVRVU19JRExFICAgICAgICAgICAgICAgIDB4Mgor
CitzdGF0aWMgdWludDMyX3QgY2Rfc2NzaV9jbWRfZ2V0X2V2ZW50X3Jlc3BfYWRkX3Bvd2VyKENk
U2NzaUxVICpkZXYsIHVpbnQ4X3QgKm91dGJ1ZikKK3sKKyAgICBvdXRidWZbMF0gPSAodWludDhf
dClkZXYtPnBvd2VyX2V2ZW50ICYgMHgwZjsKKyAgICBvdXRidWZbMV0gPSAodWludDhfdCkoKGRl
di0+cG93ZXJfY29uZCA9PSBDRF9TQ1NJX1BPV0VSX0FDVElWRSkgPworICAgICAgICAgICAgICAg
ICAgICAgICAgICAgQ0RfUE9XRVJfU1RBVFVTX0FDVElWRSA6IENEX1BPV0VSX1NUQVRVU19JRExF
KTsKKworICAgIGRldi0+cG93ZXJfZXZlbnQgPSBDRF9QT1dFUl9FVkVOVF9OT19DSEFOR0U7IC8q
IHJlc2V0IHRoZSBldmVudCAqLworICAgIHJldHVybiBDRF9HRVRfRVZFTlRfTEVOX1BPV0VSOwor
fQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9nZXRfZXZlbnRfc3RhdHVzX25vdGlmaWNhdGlv
bihDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgdWludDhfdCAqb3V0
YnVmID0gcmVxLT5idWY7CisgICAgdWludDMyX3QgcmVzcF9sZW4gPSBDRF9HRVRfRVZFTlRfSEVB
REVSX0xFTjsKKyAgICBjb25zdCB1aW50MzJfdCBwb3dlcl9jbGFzc19tYXNrID0gKDB4MDEgPDwg
Q0RfR0VUX0VWRU5UX0NMQVNTX1BPV0VSX01HTVQpOworICAgIGNvbnN0IHVpbnQzMl90IG1lZGlh
X2NsYXNzX21hc2sgPSAoMHgwMSA8PCBDRF9HRVRfRVZFTlRfQ0xBU1NfTUVESUEpOworICAgIHVp
bnQzMl90IGNsYXNzZXNfc3VwcG9ydGVkID0gIHBvd2VyX2NsYXNzX21hc2sgfCBtZWRpYV9jbGFz
c19tYXNrOworICAgIHVpbnQzMl90IGltbWVkLCBjbGFzc2VzX3JlcXVlc3RlZDsKKworICAgIHJl
cS0+eGZlcl9kaXIgPSBTQ1NJX1hGRVJfRlJPTV9ERVY7CisKKyAgICBpbW1lZCA9IHJlcS0+Y2Ri
WzFdICYgQ0RfR0VUX0VWRU5UX1NUQVRVU19JTU1FRDsKKyAgICBjbGFzc2VzX3JlcXVlc3RlZCA9
IHJlcS0+Y2RiWzRdOworICAgIHJlcS0+cmVxX2xlbiA9IChyZXEtPmNkYls3XSA8PCA4KSB8IHJl
cS0+Y2RiWzhdOworCisgICAgaWYgKCFpbW1lZCkgeworICAgICAgICBTUElDRV9ERUJVRygiZ2V0
X2V2ZW50X3N0YXR1c19ub3RpZmljYXRpb24sIGx1bjoldSIKKyAgICAgICAgICAgICAgICAiIGlt
bTowIGNsYXNzX3JlcTolMDJ4LCBOb24taW1tZWRpYXRlIChhc3luYykgbW9kZSB1bnN1cHBvcnRl
ZCIsCisgICAgICAgICAgICAgICAgcmVxLT5sdW4sIGNsYXNzZXNfcmVxdWVzdGVkKTsKKyAgICAg
ICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVf
SU5WQUxJRF9DREJfRklFTEQpOworICAgICAgICByZXR1cm47CisgICAgfQorCisgICAgbWVtc2V0
KG91dGJ1ZiwgMCwgcmVxLT5yZXFfbGVuKTsKKyAgICBpZiAoKGNsYXNzZXNfc3VwcG9ydGVkICYg
Y2xhc3Nlc19yZXF1ZXN0ZWQpICE9IDApIHsKKyAgICAgICAgaWYgKGNsYXNzZXNfcmVxdWVzdGVk
ICYgcG93ZXJfY2xhc3NfbWFzaykgeworICAgICAgICAgICAgb3V0YnVmWzJdID0gQ0RfR0VUX0VW
RU5UX0NMQVNTX1BPV0VSX01HTVQ7CisgICAgICAgICAgICBvdXRidWZbM10gPSAodWludDhfdClw
b3dlcl9jbGFzc19tYXNrOworCisgICAgICAgICAgICBTUElDRV9ERUJVRygiZ2V0X2V2ZW50X3N0
YXR1c19ub3RpZmljYXRpb24sIGx1bjoldSIKKyAgICAgICAgICAgICAgICAgICAgICAgICIgaW1t
OiV1IGNsYXNzX3JlcToweCUwMnggY2xhc3Nfc3VwOjB4JTAyeCIKKyAgICAgICAgICAgICAgICAg
ICAgICAgICIgcG93ZXJfZXZlbnQ6MHglMDJ4IHBvd2VyX2NvbmQ6MHglMDJ4IiwKKyAgICAgICAg
ICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBpbW1lZCwgY2xhc3Nlc19yZXF1ZXN0ZWQsIGNsYXNz
ZXNfc3VwcG9ydGVkLAorICAgICAgICAgICAgICAgICAgICAgICAgZGV2LT5wb3dlcl9ldmVudCwg
ZGV2LT5wb3dlcl9jb25kKTsKKworICAgICAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9jbWRf
Z2V0X2V2ZW50X3Jlc3BfYWRkX3Bvd2VyKGRldiwgb3V0YnVmICsgcmVzcF9sZW4pOworICAgICAg
ICB9IGVsc2UgaWYgKGNsYXNzZXNfcmVxdWVzdGVkICYgbWVkaWFfY2xhc3NfbWFzaykgeworICAg
ICAgICAgICAgb3V0YnVmWzJdID0gQ0RfR0VUX0VWRU5UX0NMQVNTX01FRElBOworICAgICAgICAg
ICAgb3V0YnVmWzNdID0gKHVpbnQ4X3QpbWVkaWFfY2xhc3NfbWFzazsKKworICAgICAgICAgICAg
U1BJQ0VfREVCVUcoImdldF9ldmVudF9zdGF0dXNfbm90aWZpY2F0aW9uLCBsdW46JXUiCisgICAg
ICAgICAgICAgICAgICAgICAgICAiIGltbToldSBjbGFzc19yZXE6MHglMDJ4IGNsYXNzX3N1cDow
eCUwMngiCisgICAgICAgICAgICAgICAgICAgICAgICAiIG1lZGlhX2V2ZW50OjB4JTAyeCBsb2Fk
ZWQ6ICVkIiwKKyAgICAgICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBpbW1lZCwgY2xhc3Nl
c19yZXF1ZXN0ZWQsIGNsYXNzZXNfc3VwcG9ydGVkLAorICAgICAgICAgICAgICAgICAgICAgICAg
ZGV2LT5tZWRpYV9ldmVudCwgZGV2LT5sb2FkZWQpOworCisgICAgICAgICAgICByZXNwX2xlbiAr
PSBjZF9zY3NpX2NtZF9nZXRfZXZlbnRfcmVzcF9hZGRfbWVkaWEoZGV2LCBvdXRidWYgKyByZXNw
X2xlbik7CisgICAgICAgIH0KKyAgICB9IGVsc2UgeworICAgICAgICBvdXRidWZbMl0gPSBDRF9H
RVRfRVZFTlRfSEVBREVSX05PX0VWRU5UX0FWQUlMIHwgQ0RfR0VUX0VWRU5UX0NMQVNTX05PTkU7
CisKKyAgICAgICAgU1BJQ0VfREVCVUcoImdldF9ldmVudF9zdGF0dXNfbm90aWZpY2F0aW9uLCBs
dW46JXUiCisgICAgICAgICAgICAgICAgICAgICIgaW1tOiV1IGNsYXNzX3JlcToweCUwMnggY2xh
c3Nfc3VwOjB4JTAyeCIKKyAgICAgICAgICAgICAgICAgICAgIiBub25lIG9mIHJlcXVlc3RlZCBl
dmVudHMgc3VwcG9ydGVkIiwKKyAgICAgICAgICAgICAgICAgICAgcmVxLT5sdW4sIGltbWVkLCBj
bGFzc2VzX3JlcXVlc3RlZCwgY2xhc3Nlc19zdXBwb3J0ZWQpOworICAgIH0KKyAgICBvdXRidWZb
MV0gPSAodWludDhfdCkocmVzcF9sZW4gLSAyKTsgLyogRXZlbnQgRGF0YSBMZW5ndGggTFNCLCBs
ZW5ndGggZXhjbHVkaW5nIHRoZQorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgKiBmaWVsZCBpdHNlbGYgKi8KKyAgICBvdXRidWZbM10gPSAodWludDhfdCljbGFzc2Vz
X3N1cHBvcnRlZDsKKworICAgIHJlcS0+aW5fbGVuID0gTUlOKHJlcS0+cmVxX2xlbiwgcmVzcF9s
ZW4pOworICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2LCByZXEpOworfQorCisjZGVm
aW5lIENEX0VYVF9SRVFfRVZFTlRfRk9STUFUX05PX0NIRyAgICAgICAgICAweDAwCisjZGVmaW5l
IENEX0VYVF9SRVFfRVZFTlRfRk9STUFUX0xVX0tFWV9ET1dOICAgICAweDAxCisjZGVmaW5lIENE
X0VYVF9SRVFfRVZFTlRfRk9STUFUX0xVX0tFWV9VUCAgICAgICAweDAyCisjZGVmaW5lIENEX0VY
VF9SRVFfRVZFTlRfRk9STUFUX1JFUV9OT1RJRlkgICAgICAweDAzCisKKyNkZWZpbmUgQ0RfRVhU
X1JFUV9TVEFUVVNfUkVBRFkgICAgICAgICAgICAgICAgIDB4MDAKKyNkZWZpbmUgQ0RfRVhUX1JF
UV9TVEFUVVNfT1RIRVJfUFJFVkVOVCAgICAgICAgIDB4MDEKKworI2RlZmluZSBDRF9FWFRfUkVR
X0NPREVfTk9fUkVRVUVTVCAgICAgICAgICAgICAgMHgwMAorI2RlZmluZSBDRF9FWFRfUkVRX0NP
REVfT1ZFUlJVTiAgICAgICAgICAgICAgICAgMHgwMQorI2RlZmluZSBDRF9FWFRfUkVRX0NPREVf
UExBWSAgICAgICAgICAgICAgICAgICAgMHgxMDEKKyNkZWZpbmUgQ0RfRVhUX1JFUV9DT0RFX1JF
V0lORCAgICAgICAgICAgICAgICAgIDB4MTAyCisjZGVmaW5lIENEX0VYVF9SRVFfQ09ERV9GQVNU
X0ZXICAgICAgICAgICAgICAgICAweDEwMworI2RlZmluZSBDRF9FWFRfUkVRX0NPREVfUEFVU0Ug
ICAgICAgICAgICAgICAgICAgMHgxMDQKKyNkZWZpbmUgQ0RfRVhUX1JFUV9DT0RFX1NUT1AgICAg
ICAgICAgICAgICAgICAgIDB4MTA2CisjZGVmaW5lIENEX0VYVF9SRVFfQ09ERV9BU0NJSV9CQVNF
ICAgICAgICAgICAgICAweDIwMCAvKiBTQ1NJSSB2YWx1ZSBpcyBMU0IgKi8KKworc3RhdGljIHZv
aWQgY2Rfc2NzaV9jbWRfc2VuZF9ldmVudChDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpy
ZXEpCit7CisgICAgdWludDhfdCAqcGFyYW0sICpldmVudDsKKyAgICB1aW50MzJfdCBpbW1lZCwg
cGFyYW1fbGlzdF9sZW47CisgICAgdWludDMyX3QgZXZlbnRfcGFyYW1fbGVuLCBub3RpZmljYXRp
b25fY2xhc3M7CisgICAgdWludDMyX3QgZXh0X3JlcV9ldmVudCwgZXh0X3JlcV9zdGF0dXMsIHBl
cnNfcHJldmVudCwgZXh0X3JlcV9jb2RlOworCisgICAgcmVxLT54ZmVyX2RpciA9IFNDU0lfWEZF
Ul9UT19ERVY7CisKKyAgICBpbW1lZCA9IHJlcS0+Y2RiWzFdICYgMHgwMTsKKyAgICBwYXJhbV9s
aXN0X2xlbiA9IChyZXEtPmNkYls4XSA8PCA4KSB8IHJlcS0+Y2RiWzldOworCisgICAgaWYgKHJl
cS0+YnVmX2xlbiA8IHBhcmFtX2xpc3RfbGVuKSB7CisgICAgICAgIFNQSUNFX0RFQlVHKCJzZW5k
X2V2ZW50LCBsdW46JXUgaW52YWxpZCBwYXJhbSBsaXN0IGxlbjoweCV4LCBidWZfbGVuOjB4JXgi
LAorICAgICAgICAgICAgICAgICAgICByZXEtPmx1biwgcGFyYW1fbGlzdF9sZW4sIHJlcS0+YnVm
X2xlbik7CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEs
ICZzZW5zZV9jb2RlX0lOVkFMSURfUEFSQU1fTEVOKTsKKyAgICAgICAgcmV0dXJuOworICAgIH0K
KyAgICBwYXJhbSA9IHJlcS0+YnVmOworICAgIGV2ZW50X3BhcmFtX2xlbiA9IChwYXJhbVswXSA8
PCA4KSB8IHBhcmFtWzFdOworCisgICAgbm90aWZpY2F0aW9uX2NsYXNzID0gcGFyYW1bMl0gJiAw
eDA3OworICAgIGlmIChub3RpZmljYXRpb25fY2xhc3MgIT0gQ0RfR0VUX0VWRU5UX0NMQVNTX0VY
VEVSTkFMX1JFUSkgeworICAgICAgICBTUElDRV9ERUJVRygic2VuZF9ldmVudCwgbHVuOiV1IGlu
dmFsaWQgbm90aWZpY2F0aW9uIGNsYXNzOjB4JXgiLAorICAgICAgICAgICAgICAgICAgICByZXEt
Pmx1biwgbm90aWZpY2F0aW9uX2NsYXNzKTsKKyAgICAgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVf
Y2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfSU5WQUxJRF9DREJfRklFTEQpOworICAg
ICAgICByZXR1cm47CisgICAgfQorCisgICAgZXZlbnQgPSBwYXJhbSArIENEX0dFVF9FVkVOVF9I
RUFERVJfTEVOOworICAgIGV4dF9yZXFfZXZlbnQgPSBldmVudFswXSAmIDB4ZmY7CisgICAgZXh0
X3JlcV9zdGF0dXMgPSBldmVudFsxXSAmIDB4MGY7CisgICAgcGVyc19wcmV2ZW50ID0gZXZlbnRb
MV0gJiAweDgwOworICAgIGV4dF9yZXFfY29kZSA9IChldmVudFsyXSA8PCA4KSB8IGV2ZW50WzNd
OworCisgICAgU1BJQ0VfREVCVUcoInNlbmRfZXZlbnQsIGx1bjoweCV1IGltbWVkOiV1IHBhcmFt
X2xlbjoldSIKKyAgICAgICAgICAgICAgICAiIGV4dF9yZXFfZXZlbnQ6MHgleCBleHRfcmVxX3N0
YXR1czoweCV4IgorICAgICAgICAgICAgICAgICIgcGVyc19wcmV2ZW50OjB4JXggZXh0X3JlcV9j
b2RlOjB4JXgiLAorICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBpbW1lZCwgZXZlbnRfcGFyYW1f
bGVuLCBleHRfcmVxX2V2ZW50LAorICAgICAgICAgICAgICAgIGV4dF9yZXFfc3RhdHVzLCBwZXJz
X3ByZXZlbnQsIGV4dF9yZXFfY29kZSk7CisKKyAgICAvKiBUb0RvOiBwcm9jZXNzIHRoZSBldmVu
dCAqLworCisgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfZ29vZChkZXYsIHJlcSk7Cit9CisKKyNk
ZWZpbmUgQ0RfTUVESVVNX1JFTU9WQUxfUkVRX0FMTE9XICAgICAgICAgICAgICAgICAweDAwCisj
ZGVmaW5lIENEX01FRElVTV9SRU1PVkFMX1JFUV9QUkVWRU5UICAgICAgICAgICAgICAgMHgwMQor
I2RlZmluZSBDRF9NRURJVU1fUkVNT1ZBTF9SRVFfQUxMT1dfQ0hBTkdFUiAgICAgICAgIDB4MDIK
KyNkZWZpbmUgQ0RfTUVESVVNX1JFTU9WQUxfUkVRX1BSRVZFTlRfQ0hBTkdFUiAgICAgICAweDAz
CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX2FsbG93X21lZGl1bV9yZW1vdmFsKENkU2NzaUxV
ICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICB1aW50MzJfdCBwcmV2ZW50OworCisg
ICAgcmVxLT54ZmVyX2RpciA9IFNDU0lfWEZFUl9GUk9NX0RFVjsKKworICAgIHByZXZlbnQgPSBy
ZXEtPmNkYls0XSAmIDB4MDM7CisgICAgZGV2LT5wcmV2ZW50X21lZGlhX3JlbW92YWwgPSAocHJl
dmVudCA9PSBDRF9NRURJVU1fUkVNT1ZBTF9SRVFfUFJFVkVOVCB8fAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHByZXZlbnQgPT0gQ0RfTUVESVVNX1JFTU9WQUxfUkVRX1BSRVZF
TlRfQ0hBTkdFUik7CisgICAgcmVxLT5pbl9sZW4gPSAwOworCisgICAgU1BJQ0VfREVCVUcoImFs
bG93X21lZGl1bV9yZW1vdmFsLCBsdW46JXUgcHJldmVudCBmaWVsZDo6MHglMDJ4IGZsYWc6JWQi
LAorICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBwcmV2ZW50LCBkZXYtPnByZXZlbnRfbWVkaWFf
cmVtb3ZhbCk7CisKKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30K
Kworc3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRfcmVwb3J0X2tleShDZFNjc2lMVSAqZGV2LCBDZFNj
c2lSZXF1ZXN0ICpyZXEpCit7CisgICAgU1BJQ0VfREVCVUcoInJlcG9ydF9rZXkgLSBjb250ZW50
IHByb3RlY3Rpb24gdW5zdXBwb3J0ZWQsIGx1bjoldSIsIHJlcS0+bHVuKTsKKyAgICByZXEtPnhm
ZXJfZGlyID0gU0NTSV9YRkVSX05PTkU7CisgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tf
Y29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfSU5WQUxJRF9PUENPREUpOworfQorCitzdGF0aWMg
dm9pZCBjZF9zY3NpX2NtZF9zZW5kX2tleShDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpy
ZXEpCit7CisgICAgU1BJQ0VfREVCVUcoInNlbmRfa2V5IC0gY29udGVudCBwcm90ZWN0aW9uIHVu
c3VwcG9ydGVkLCBsdW46JXUiLCByZXEtPmx1bik7CisgICAgcmVxLT54ZmVyX2RpciA9IFNDU0lf
WEZFUl9OT05FOworICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEs
ICZzZW5zZV9jb2RlX0lOVkFMSURfT1BDT0RFKTsKK30KKworLyogYnl0ZSAxICovCisjZGVmaW5l
IENEX1NUQVJUX1NUT1BfRkxBR19JTU1FRCAgICAgICAgICAgICAgICAgICAgMHgwMQorCisvKiBi
eXRlIDQgKi8KKyNkZWZpbmUgQ0RfU1RBUlRfU1RPUF9GTEFHX1NUQVJUICAgICAgICAgICAgICAg
ICAgICAweDAxCisjZGVmaW5lIENEX1NUQVJUX1NUT1BfRkxBR19MT0VKICAgICAgICAgICAgICAg
ICAgICAgMHgwMgorCisvKiBQT1dFUiBDT05ESVRJT04gZmllbGQgdmFsdWVzICovCisjZGVmaW5l
IENEX1NUQVJUX1NUT1BfUE9XRVJfQ09ORF9TVEFSVF9WQUxJRCAgICAgICAgMHgwMAorI2RlZmlu
ZSBDRF9TVEFSVF9TVE9QX1BPV0VSX0NPTkRfQUNUSVZFICAgICAgICAgICAgIDB4MDEKKyNkZWZp
bmUgQ0RfU1RBUlRfU1RPUF9QT1dFUl9DT05EX0lETEUgICAgICAgICAgICAgICAweDAyCisjZGVm
aW5lIENEX1NUQVJUX1NUT1BfUE9XRVJfQ09ORF9TVEFOREJZICAgICAgICAgICAgMHgwMworI2Rl
ZmluZSBDRF9TVEFSVF9TVE9QX1BPV0VSX0NPTkRfTFVfQ09OVFJPTCAgICAgICAgIDB4MDcKKyNk
ZWZpbmUgQ0RfU1RBUlRfU1RPUF9QT1dFUl9DT05EX0ZPUkNFX0lETEVfMCAgICAgICAweDBhCisj
ZGVmaW5lIENEX1NUQVJUX1NUT1BfUE9XRVJfQ09ORF9GT1JDRV9TVEFOREJZXzAgICAgMHgwYgor
CitzdGF0aWMgaW5saW5lIGNvbnN0IGNoYXIgKmNkX3Njc2lfc3RhcnRfc3RvcF9wb3dlcl9jb25k
X25hbWUodWludDMyX3QgcG93ZXJfY29uZCkKK3sKKyAgICBzd2l0Y2ggKHBvd2VyX2NvbmQpIHsK
KyAgICBjYXNlIENEX1NUQVJUX1NUT1BfUE9XRVJfQ09ORF9TVEFSVF9WQUxJRDoKKyAgICAgICAg
cmV0dXJuICJTVEFSVF9WQUxJRCI7CisgICAgY2FzZSBDRF9TVEFSVF9TVE9QX1BPV0VSX0NPTkRf
QUNUSVZFOgorICAgICAgICByZXR1cm4gIkFDVElWRSI7CisgICAgY2FzZSBDRF9TVEFSVF9TVE9Q
X1BPV0VSX0NPTkRfSURMRToKKyAgICAgICAgcmV0dXJuICJJRExFIjsKKyAgICBjYXNlIENEX1NU
QVJUX1NUT1BfUE9XRVJfQ09ORF9TVEFOREJZOgorICAgICAgICByZXR1cm4gIlNUQU5EQlkiOwor
ICAgIGNhc2UgQ0RfU1RBUlRfU1RPUF9QT1dFUl9DT05EX0xVX0NPTlRST0w6CisgICAgICAgIHJl
dHVybiAiTFVfQ09OVFJPTCI7CisgICAgY2FzZSBDRF9TVEFSVF9TVE9QX1BPV0VSX0NPTkRfRk9S
Q0VfSURMRV8wOgorICAgICAgICByZXR1cm4gIkZPUkNFX0lETEVfMCI7CisgICAgY2FzZSBDRF9T
VEFSVF9TVE9QX1BPV0VSX0NPTkRfRk9SQ0VfU1RBTkRCWV8wOgorICAgICAgICByZXR1cm4gIkZP
UkNFX1NUQU5EQllfMCI7CisgICAgZGVmYXVsdDoKKyAgICAgICAgcmV0dXJuICJSRVNFUlZFRCI7
CisgICAgfQorfQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9zdGFydF9zdG9wX3VuaXQoQ2RT
Y3NpTFUgKmRldiwgQ2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAgIGdib29sZWFuIGltbWVkLCBz
dGFydCwgbG9hZF9lamVjdDsKKyAgICB1aW50MzJfdCBwb3dlcl9jb25kOworCisgICAgcmVxLT54
ZmVyX2RpciA9IFNDU0lfWEZFUl9OT05FOworICAgIHJlcS0+aW5fbGVuID0gMDsKKworICAgIGlt
bWVkID0gKHJlcS0+Y2RiWzFdICYgQ0RfU1RBUlRfU1RPUF9GTEFHX0lNTUVEKSA/IFRSVUUgOiBG
QUxTRTsKKyAgICBzdGFydCA9IChyZXEtPmNkYls0XSAmIENEX1NUQVJUX1NUT1BfRkxBR19TVEFS
VCkgPyBUUlVFIDogRkFMU0U7CisgICAgbG9hZF9lamVjdCA9IChyZXEtPmNkYls0XSAmIENEX1NU
QVJUX1NUT1BfRkxBR19MT0VKKSA/IFRSVUUgOiBGQUxTRTsKKyAgICBwb3dlcl9jb25kID0gcmVx
LT5jZGJbNF0gPj4gNDsKKworICAgIFNQSUNFX0RFQlVHKCJzdGFydF9zdG9wX3VuaXQsIGx1bjow
eCV1IgorICAgICAgICAgICAgICAgICIgaW1tZWQ6JWQgc3RhcnQ6JWQgbG9hZF9lamVjdDolZCBw
b3dlcl9jb25kOjB4JXgoJXMpIiwKKyAgICAgICAgICAgICAgICByZXEtPmx1biwgaW1tZWQsIHN0
YXJ0LCBsb2FkX2VqZWN0LCBwb3dlcl9jb25kLAorICAgICAgICAgICAgICAgIGNkX3Njc2lfc3Rh
cnRfc3RvcF9wb3dlcl9jb25kX25hbWUocG93ZXJfY29uZCkpOworCisgICAgc3dpdGNoIChwb3dl
cl9jb25kKSB7CisgICAgY2FzZSBDRF9TVEFSVF9TVE9QX1BPV0VSX0NPTkRfU1RBUlRfVkFMSUQ6
CisgICAgICAgIGlmICghc3RhcnQpIHsgLyogc3RvcCB0aGUgdW5pdCAqLworICAgICAgICAgICAg
aWYgKGxvYWRfZWplY3QpIHsgLyogZWplY3QgbWVkaXVtICovCisgICAgICAgICAgICAgICAgaWYg
KGRldi0+cHJldmVudF9tZWRpYV9yZW1vdmFsKSB7CisgICAgICAgICAgICAgICAgICAgIFNQSUNF
X0RFQlVHKCJzdGFydF9zdG9wX3VuaXQsIGx1bjoweCV1IgorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAiIHByZXZlbnRfbWVkaWFfcmVtb3ZhbCBzZXQsIGVqZWN0IGZhaWxlZCIsIHJl
cS0+bHVuKTsKKyAgICAgICAgICAgICAgICAgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tf
Y29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfTUVESVVNX1JFTU9WQUxfUFJFVkVOVEVEKTsKKyAg
ICAgICAgICAgICAgICAgICAgcmV0dXJuOworICAgICAgICAgICAgICAgIH0KKyAgICAgICAgICAg
ICAgICBTUElDRV9ERUJVRygic3RhcnRfc3RvcF91bml0LCBsdW46MHgldSBlamVjdCIsIHJlcS0+
bHVuKTsKKyAgICAgICAgICAgICAgICBjZF9zY3NpX2x1X3VubG9hZChkZXYpOworICAgICAgICAg
ICAgICAgIGNkX3Njc2lfZGV2X2NoYW5nZWQoZGV2LT50Z3QtPnVzZXJfZGF0YSwgcmVxLT5sdW4p
OworICAgICAgICAgICAgfQorICAgICAgICAgICAgZGV2LT5wb3dlcl9jb25kID0gQ0RfU0NTSV9Q
T1dFUl9TVE9QUEVEOworICAgICAgICAgICAgU1BJQ0VfREVCVUcoInN0YXJ0X3N0b3BfdW5pdCwg
bHVuOjB4JXUgc3RvcHBlZCIsIHJlcS0+bHVuKTsKKyAgICAgICAgfSBlbHNlIHsgLyogc3RhcnQg
dGhlIHVuaXQgKi8KKyAgICAgICAgICAgIGRldi0+cG93ZXJfY29uZCA9IENEX1NDU0lfUE9XRVJf
QUNUSVZFOworICAgICAgICAgICAgU1BJQ0VfREVCVUcoInN0YXJ0X3N0b3BfdW5pdCwgbHVuOjB4
JXUgc3RhcnRlZCIsIHJlcS0+bHVuKTsKKworICAgICAgICAgICAgaWYgKGxvYWRfZWplY3QpIHsg
LyogbG9hZCBtZWRpdW0gKi8KKyAgICAgICAgICAgICAgICBTUElDRV9ERUJVRygic3RhcnRfc3Rv
cF91bml0LCBsdW46MHgldSBsb2FkIHdpdGggbm8gbWVkaWEiLAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHJlcS0+bHVuKTsKKyAgICAgICAgICAgICAgICBjZF9zY3NpX2x1X2xvYWQoZGV2
LCBOVUxMKTsKKyAgICAgICAgICAgICAgICBjZF9zY3NpX2Rldl9jaGFuZ2VkKGRldi0+dGd0LT51
c2VyX2RhdGEsIHJlcS0+bHVuKTsKKyAgICAgICAgICAgIH0KKyAgICAgICAgfQorICAgICAgICBi
cmVhazsKKyAgICBjYXNlIENEX1NUQVJUX1NUT1BfUE9XRVJfQ09ORF9BQ1RJVkU6CisgICAgICAg
IC8qIG5vdCBlcnJvciB0byBzcGVjaWZ5IHRyYW5zaXRpb24gdG8gdGhlIGN1cnJlbnQgcG93ZXIg
Y29uZGl0aW9uICovCisgICAgICAgIGRldi0+cG93ZXJfY29uZCA9IENEX1NDU0lfUE9XRVJfQUNU
SVZFOworICAgICAgICBTUElDRV9ERUJVRygic3RhcnRfc3RvcF91bml0LCBsdW46MHgldSBhY3Rp
dmUiLCByZXEtPmx1bik7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgQ0RfU1RBUlRfU1RPUF9Q
T1dFUl9DT05EX0lETEU6CisgICAgY2FzZSBDRF9TVEFSVF9TVE9QX1BPV0VSX0NPTkRfRk9SQ0Vf
SURMRV8wOgorICAgICAgICBkZXYtPnBvd2VyX2NvbmQgPSBDRF9TQ1NJX1BPV0VSX0lETEU7Cisg
ICAgICAgIFNQSUNFX0RFQlVHKCJzdGFydF9zdG9wX3VuaXQsIGx1bjoweCV1IGlkbGUiLCByZXEt
Pmx1bik7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgQ0RfU1RBUlRfU1RPUF9QT1dFUl9DT05E
X1NUQU5EQlk6CisgICAgY2FzZSBDRF9TVEFSVF9TVE9QX1BPV0VSX0NPTkRfRk9SQ0VfU1RBTkRC
WV8wOgorICAgICAgICBkZXYtPnBvd2VyX2NvbmQgPSBDRF9TQ1NJX1BPV0VSX1NUQU5EQlk7Cisg
ICAgICAgIFNQSUNFX0RFQlVHKCJzdGFydF9zdG9wX3VuaXQsIGx1bjoweCV1IHN0YW5kYnkiLCBy
ZXEtPmx1bik7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgQ0RfU1RBUlRfU1RPUF9QT1dFUl9D
T05EX0xVX0NPTlRST0w6CisgICAgICAgIGJyZWFrOworICAgIGRlZmF1bHQ6CisgICAgICAgIGNk
X3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX0lOVkFM
SURfQ0RCX0ZJRUxEKTsKKyAgICAgICAgcmV0dXJuOworICAgIH0KKyAgICBjZF9zY3NpX2NtZF9j
b21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworI2RlZmluZSBDRF9QRVJGX1RZUEVfUEVSRk9S
TUFOQ0UgICAgICAgICAgICAgICAgMHgwMAorI2RlZmluZSBDRF9QRVJGX1RZUEVfVU5VU0FCTEVf
QVJFQSAgICAgICAgICAgICAgMHgwMQorI2RlZmluZSBDRF9QRVJGX1RZUEVfREVGRUNUX1NUQVRV
UyAgICAgICAgICAgICAgMHgwMgorI2RlZmluZSBDRF9QRVJGX1RZUEVfV1JJVEVfU1BFRUQgICAg
ICAgICAgICAgICAgMHgwMworCisjZGVmaW5lIENEX1BFUkZfSEVBREVSX0xFTiAgICAgICAgICAg
ICAgICAgICAgICA4CisKKyNkZWZpbmUgQ0RfUEVSRl9UWVBFX1BFUkZPUk1BTkNFX0RFU0NSX0xF
TiAgICAgIDE2CisKKyNkZWZpbmUgQ0RfUEVSRl9UWVBFX1BFUkZPUk1BTkNFX1JFUE9SVF9OT01J
TkFMIDB4MDAKKyNkZWZpbmUgQ0RfUEVSRl9UWVBFX1BFUkZPUk1BTkNFX1JFUE9SVF9BTEwgICAg
IDB4MDEKKyNkZWZpbmUgQ0RfUEVSRl9UWVBFX1BFUkZPUk1BTkNFX1JFUE9SVF9FWENFUFQgIDB4
MTAKKworCitzdGF0aWMgdm9pZCBjZF9zY3NpX2dldF9wZXJmb3JtYW5jZV9yZXNwX2VtcHR5KENk
U2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSwKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyX3QgdHlwZSwgdWludDMyX3QgZGF0YV90eXBl
LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJf
dCBtYXhfbnVtX2Rlc2NyKQoreworICAgIHVpbnQ4X3QgKm91dGJ1ZiA9IHJlcS0+YnVmOworICAg
IHVpbnQzMl90IHdyaXRlID0gKGRhdGFfdHlwZSA+PiAyKSAmIDB4MDE7CisKKyAgICBtZW1zZXQo
b3V0YnVmLCAwLCBDRF9QRVJGX0hFQURFUl9MRU4pOworICAgIGlmICh3cml0ZSkgeworICAgICAg
ICBvdXRidWZbNF0gPSAweDAyOworICAgIH0KKyAgICByZXEtPmluX2xlbiA9IENEX1BFUkZfSEVB
REVSX0xFTjsKKworICAgIFNQSUNFX0RFQlVHKCJnZXRfcGVyZm9ybWFuY2UsIGx1bjoldSIKKyAg
ICAgICAgICAgICAgICAiIHR5cGU6MHgleCBkYXRhX3R5cGU6MHgleCAtIHNlbmRpbmcgZW1wdHkg
cmVzcG9uc2UiLAorICAgICAgICAgICAgICAgIHJlcS0+bHVuLCB0eXBlLCBkYXRhX3R5cGUpOwor
CisgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfZ29vZChkZXYsIHJlcSk7Cit9CisKK3N0YXRpYyB2
b2lkIGNkX3Njc2lfZ2V0X3BlcmZvcm1hbmNlX3Jlc3BfcGVyZm9ybWFuY2UoQ2RTY3NpTFUgKmRl
diwgQ2RTY3NpUmVxdWVzdCAqcmVxLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCBzdGFydF9sYmEsCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IGRhdGFfdHlwZSwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWlu
dDMyX3QgbWF4X251bV9kZXNjcikKK3sKKyAgICB1aW50OF90ICpvdXRidWYgPSByZXEtPmJ1Ziwg
KnBlcmZfZGVzYzsKKyAgICB1aW50MzJfdCByZXNwX2xlbiA9IENEX1BFUkZfSEVBREVSX0xFTiAr
CisgICAgICAgICAgICAgICAgICAgICAgICBDRF9QRVJGX1RZUEVfUEVSRk9STUFOQ0VfREVTQ1Jf
TEVOOworICAgIHVpbnQzMl90IHBlcmZfZGF0YV9sZW4gPSByZXNwX2xlbiAtIDQ7IC8qIG5vdCBp
bmNsLiBQZXJmIERhdGEgTGVuZ3RoICovCisgICAgdWludDMyX3QgcGVyZl9rYiA9IDEwMDAwOwor
ICAgIHVpbnQzMl90IGVuZF9sYmEgPSBkZXYtPm51bV9ibG9ja3MgLSAxOworICAgIHVpbnQzMl90
IGV4Y2VwdCwgd3JpdGUsIHRvbGVyYW5jZTsKKworICAgIGV4Y2VwdCA9IGRhdGFfdHlwZSAmIDB4
MDM7CisgICAgaWYgKGV4Y2VwdCAhPSBDRF9QRVJGX1RZUEVfUEVSRk9STUFOQ0VfUkVQT1JUX0FM
TCkgeworICAgICAgICBzdGFydF9sYmEgPSAwOworICAgIH0KKyAgICB3cml0ZSA9IChkYXRhX3R5
cGUgPj4gMikgJiAweDAxOworICAgIHRvbGVyYW5jZSA9IChkYXRhX3R5cGUgPj4gMykgJiAweDAz
OworCisgICAgU1BJQ0VfREVCVUcoImdldF9wZXJmb3JtYW5jZSwgbHVuOiV1IgorICAgICAgICAg
ICAgICAgICIgcGVyZm9ybWFuY2UgdHlwZToweDAwIGRhdGFfdHlwZToweCV4IgorICAgICAgICAg
ICAgICAgICIgZXhjZXB0OjB4JXggd3JpdGU6MHgleCB0b2xlcmFuY2U6MHgleCIKKyAgICAgICAg
ICAgICAgICAiIG1heF9udW06JXUiLAorICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBkYXRhX3R5
cGUsIGV4Y2VwdCwgd3JpdGUsCisgICAgICAgICAgICAgICAgdG9sZXJhbmNlLCBtYXhfbnVtX2Rl
c2NyKTsKKworICAgIGlmICh3cml0ZSkgeworICAgICAgICBTUElDRV9ERUJVRygiZ2V0X3BlcmZv
cm1hbmNlLCBsdW46JXUiCisgICAgICAgICAgICAgICAgICAgICIgcGVyZm9ybWFuY2UgdHlwZTow
eDAwIGRhdGFfdHlwZToweCV4IC0gd3JpdGUgdW5zdXBwb3J0ZWQiLAorICAgICAgICAgICAgICAg
ICAgICByZXEtPmx1biwgZGF0YV90eXBlKTsKKyAgICAgICAgY2Rfc2NzaV9nZXRfcGVyZm9ybWFu
Y2VfcmVzcF9lbXB0eShkZXYsIHJlcSwgQ0RfUEVSRl9UWVBFX1BFUkZPUk1BTkNFLAorICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFfdHlwZSwgbWF4X251bV9k
ZXNjcik7CisgICAgICAgIHJldHVybjsKKyAgICB9CisKKyAgICBtZW1zZXQob3V0YnVmLCAwLCBy
ZXNwX2xlbik7CisKKyAgICBvdXRidWZbMF0gPSAocGVyZl9kYXRhX2xlbiA+PiAyNCkgJiAweGZm
OworICAgIG91dGJ1ZlsxXSA9IChwZXJmX2RhdGFfbGVuID4+IDE2KSAmIDB4ZmY7CisgICAgb3V0
YnVmWzJdID0gKHBlcmZfZGF0YV9sZW4gPj4gOCkgJiAweGZmOworICAgIG91dGJ1ZlszXSA9IHBl
cmZfZGF0YV9sZW4gJiAweGZmOworCisgICAgcGVyZl9kZXNjID0gb3V0YnVmICsgQ0RfUEVSRl9I
RUFERVJfTEVOOworCisgICAgcGVyZl9kZXNjWzBdID0gKHN0YXJ0X2xiYSA+PiAyNCkgJiAweGZm
OworICAgIHBlcmZfZGVzY1sxXSA9IChzdGFydF9sYmEgPj4gMTYpICYgMHhmZjsKKyAgICBwZXJm
X2Rlc2NbMl0gPSAoc3RhcnRfbGJhID4+IDgpICYgMHhmZjsKKyAgICBwZXJmX2Rlc2NbM10gPSBz
dGFydF9sYmEgJiAweGZmOworCisgICAgcGVyZl9kZXNjWzRdID0gKHBlcmZfa2IgPj4gMjQpICYg
MHhmZjsKKyAgICBwZXJmX2Rlc2NbNV0gPSAocGVyZl9rYiA+PiAxNikgJiAweGZmOworICAgIHBl
cmZfZGVzY1s2XSA9IChwZXJmX2tiID4+IDgpICYgMHhmZjsKKyAgICBwZXJmX2Rlc2NbN10gPSBw
ZXJmX2tiICYgMHhmZjsKKworICAgIHBlcmZfZGVzY1s4XSA9IChlbmRfbGJhID4+IDI0KSAmIDB4
ZmY7CisgICAgcGVyZl9kZXNjWzldID0gKGVuZF9sYmEgPj4gMTYpICYgMHhmZjsKKyAgICBwZXJm
X2Rlc2NbMTBdID0gKGVuZF9sYmEgPj4gOCkgJiAweGZmOworICAgIHBlcmZfZGVzY1sxMV0gPSBl
bmRfbGJhICYgMHhmZjsKKworICAgIHBlcmZfZGVzY1sxMl0gPSAocGVyZl9rYiA+PiAyNCkgJiAw
eGZmOworICAgIHBlcmZfZGVzY1sxM10gPSAocGVyZl9rYiA+PiAxNikgJiAweGZmOworICAgIHBl
cmZfZGVzY1sxNF0gPSAocGVyZl9rYiA+PiA4KSAmIDB4ZmY7CisgICAgcGVyZl9kZXNjWzE1XSA9
IHBlcmZfa2IgJiAweGZmOworCisgICAgcmVxLT5yZXFfbGVuID0gQ0RfUEVSRl9IRUFERVJfTEVO
ICsKKyAgICAgICAgICAgICAgICAgICAobWF4X251bV9kZXNjciAqIENEX1BFUkZfVFlQRV9QRVJG
T1JNQU5DRV9ERVNDUl9MRU4pOworCisgICAgcmVxLT5pbl9sZW4gPSBNSU4ocmVxLT5yZXFfbGVu
LCByZXNwX2xlbik7CisKKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsK
K30KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRfZ2V0X3BlcmZvcm1hbmNlKENkU2NzaUxVICpk
ZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICB1aW50MzJfdCBkYXRhX3R5cGUsIG1heF9u
dW1fZGVzY3IsIHN0YXJ0X2xiYSwgdHlwZTsKKworICAgIHJlcS0+eGZlcl9kaXIgPSBTQ1NJX1hG
RVJfRlJPTV9ERVY7CisKKyAgICBkYXRhX3R5cGUgPSByZXEtPmNkYlsxXSAmIDB4MGY7CisgICAg
c3RhcnRfbGJhID0gKHJlcS0+Y2RiWzJdIDw8IDI0KSB8CisgICAgICAgICAgICAgICAgKHJlcS0+
Y2RiWzNdIDw8IDE2KSB8CisgICAgICAgICAgICAgICAgKHJlcS0+Y2RiWzRdIDw8IDgpIHwKKyAg
ICAgICAgICAgICAgICAgcmVxLT5jZGJbNV07CisgICAgbWF4X251bV9kZXNjciA9IChyZXEtPmNk
Yls4XSA8PCA4KSB8IHJlcS0+Y2RiWzldOworICAgIHR5cGUgPSByZXEtPmNkYlsxMF07CisKKyAg
ICBzd2l0Y2ggKHR5cGUpIHsKKyAgICBjYXNlIENEX1BFUkZfVFlQRV9QRVJGT1JNQU5DRToKKyAg
ICAgICAgY2Rfc2NzaV9nZXRfcGVyZm9ybWFuY2VfcmVzcF9wZXJmb3JtYW5jZShkZXYsIHJlcSwg
c3RhcnRfbGJhLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGRhdGFfdHlwZSwgbWF4X251bV9kZXNjcik7CisgICAgICAgIGJyZWFrOworICAgIGNhc2Ug
Q0RfUEVSRl9UWVBFX1VOVVNBQkxFX0FSRUE6IC8qIG5vdCB3cml0YWJsZSAqLworICAgIGNhc2Ug
Q0RfUEVSRl9UWVBFX0RFRkVDVF9TVEFUVVM6IC8qIG5vdCByZXN0cmljdGVkIG92ZXJ3cml0ZSBt
ZWRpYSAqLworICAgIGNhc2UgQ0RfUEVSRl9UWVBFX1dSSVRFX1NQRUVEOiAvKiB1bnN1cHBvcnRl
ZCwgaXJyZWxldmFudCAqLworICAgIGRlZmF1bHQ6CisgICAgICAgIFNQSUNFX0RFQlVHKCJnZXRf
cGVyZm9ybWFuY2UsIGx1bjoldSIKKyAgICAgICAgICAgICAgICAgICAgIiB1bnN1cHBvcnRlZCB0
eXBlOjB4JXgiCisgICAgICAgICAgICAgICAgICAgICIgZGF0YV90eXBlOjB4JXggbWF4X251bTol
dSIsCisgICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuLCB0eXBlLCBkYXRhX3R5cGUsIG1heF9u
dW1fZGVzY3IpOworICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwg
cmVxLCAmc2Vuc2VfY29kZV9JTlZBTElEX0NEQl9GSUVMRCk7CisgICAgICAgIHJldHVybjsKKyAg
ICB9Cit9CisKKyNkZWZpbmUgQ0RfTUVDSEFOSVNNX1NUQVRVU19IRFJfTEVOICAgICA4CisKKy8q
IGJ5dGUgMCAqLworI2RlZmluZSBDRF9DSEFOR0VSX0ZBVUxUX0ZMQUcgICAgICAgICAgIDB4ODAK
KworI2RlZmluZSBDRF9DSEFOR0VSX1JFQURZICAgICAgICAgICAgICAgIDB4MDAKKyNkZWZpbmUg
Q0RfQ0hBTkdFUl9MT0FESU5HICAgICAgICAgICAgICAweDAxCisjZGVmaW5lIENEX0NIQU5HRVJf
VU5MT0FESU5HICAgICAgICAgICAgMHgwMgorI2RlZmluZSBDRF9DSEFOR0VSX0lOSVRJQUxJWklO
RyAgICAgICAgIDB4MDMKKworLyogYnl0ZSAxICovCisjZGVmaW5lIENEX0NIQU5HRVJfRE9PUl9P
UEVOX0ZMQUcgICAgICAgMHgxMAorCisjZGVmaW5lIENEX01FQ0hBTklTTV9TVEFURV9JRExFICAg
ICAgICAgMHgwMAorI2RlZmluZSBDRF9NRUNIQU5JU01fU1RBVEVfUExBWUlORyAgICAgIDB4MDEK
KyNkZWZpbmUgQ0RfTUVDSEFOSVNNX1NUQVRFX1NDQU5OSU5HICAgICAweDAyCisvKiBBQ1RJVkU6
IHdpdGggSW5pdGlhdG9yLCBDb21wb3NpdGUgb3IgT3RoZXIgcG9ydHMKKyAgKGkuZS4gUkVBRCwg
UExBWSBDRCwgU0NBTiBkdXJpbmcgUExBWSBDRCkgKi8KKyNkZWZpbmUgQ0RfTUVDSEFOSVNNX1NU
QVRFX0FDVElWRSAgICAgICAweDAzCisjZGVmaW5lIENEX01FQ0hBTklTTV9TVEFURV9OT19JTkZP
ICAgICAgMHgwNworCisvKiBzbG90cyAqLworI2RlZmluZSBDRF9NRUNIQU5JU01fU1RBVFVTX1NM
T1RfTEVOICAgIDQKKworI2RlZmluZSBDRF9NRUNIQU5JU01fU0xPVF9ESVNLX0NIQU5HRUQgIDB4
MDEKKyNkZWZpbmUgQ0RfTUVDSEFOSVNNX1NMT1RfRElTS19QUkVTRU5UICAweDgwCisjZGVmaW5l
IENEX01FQ0hBTklTTV9TTE9UX0RJU0tfQ1dQX1YgICAgMHgwMgorI2RlZmluZSBDRF9NRUNIQU5J
U01fU0xPVF9ESVNLX0NXUCAgICAgIDB4MDEKKworc3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRfbWVj
aGFuaXNtX3N0YXR1cyhDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAg
dWludDhfdCAqb3V0YnVmID0gcmVxLT5idWY7CisgICAgdWludDMyX3QgcmVzcF9sZW4gPSBDRF9N
RUNIQU5JU01fU1RBVFVTX0hEUl9MRU47CisKKyAgICByZXEtPnhmZXJfZGlyID0gU0NTSV9YRkVS
X0ZST01fREVWOworCisgICAgcmVxLT5yZXFfbGVuID0gKHJlcS0+Y2RiWzhdIDw8IDgpIHwgcmVx
LT5jZGJbOV07CisgICAgbWVtc2V0KG91dGJ1ZiwgMCwgcmVxLT5yZXFfbGVuKTsKKworICAgIC8q
IEZvciBub24tY2hhbmdlciBkZXZpY2VzIHRoZSBjdXJlbnQgc2xvdCBudW1iZXIgZmllbGQgaXMg
cmVzZXJ2ZWQsIHNldCBvbmx5IHN0YXR1cyAqLworICAgIG91dGJ1ZlswXSB8PSAoQ0RfQ0hBTkdF
Ul9SRUFEWSA8PCA1KTsKKworICAgIG91dGJ1ZlsxXSB8PSAoIWRldi0+bG9hZGVkKSA/IENEX0NI
QU5HRVJfRE9PUl9PUEVOX0ZMQUcgOiAwOworICAgIG91dGJ1ZlsxXSB8PSAoZGV2LT5wb3dlcl9j
b25kID09IENEX1BPV0VSX1NUQVRVU19BQ1RJVkUpID8KKyAgICAgICAgICAgICAgICAgKENEX01F
Q0hBTklTTV9TVEFURV9BQ1RJVkUgPDwgNSkgOiAoQ0RfTUVDSEFOSVNNX1NUQVRFX0lETEUgPDwg
NSk7CisKKyAgICAvKiBGb3Igbm9uLWNoYW5nZXIgZGV2aWNlcyB0aGUgbnVtYmVyIG9mIHNsb3Qg
dGFibGVzIHJldHVybmVkIHNoYWxsIGJlIHplcm8sIHNvIHdlIGxlYXZlCisgICAgICAgYm90aCAn
TnVtYmVyIG9mIFNsb3RzIEF2YWlsYWJsZScgYW5kICdMZW5ndGggb2YgU2xvdCBUYWJsZScgZmll
bGRzIGFzIHplcm9zICovCisKKyAgICByZXEtPmluX2xlbiA9IE1JTihyZXEtPnJlcV9sZW4sIHJl
c3BfbGVuKTsKKworICAgIFNQSUNFX0RFQlVHKCJtZWNoYW5pc21fc3RhdHVzLCBsdW46JXUiLCBy
ZXEtPmx1bik7CisKKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30K
Kworc3RhdGljIHZvaWQgY2Rfc2NzaV9yZWFkX2FzeW5jX2NvbXBsZXRlKEdPYmplY3QgKnNyY19v
YmplY3QsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgR0FzeW5jUmVz
dWx0ICpyZXN1bHQsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3Bv
aW50ZXIgdXNlcl9kYXRhKQoreworICAgIEdGaWxlSW5wdXRTdHJlYW0gKnN0cmVhbSA9IEdfRklM
RV9JTlBVVF9TVFJFQU0oc3JjX29iamVjdCk7CisgICAgQ2RTY3NpUmVxdWVzdCAqcmVxID0gKENk
U2NzaVJlcXVlc3QgKil1c2VyX2RhdGE7CisgICAgQ2RTY3NpVGFyZ2V0ICpzdCA9IChDZFNjc2lU
YXJnZXQgKilyZXEtPnByaXZfZGF0YTsKKyAgICBDZFNjc2lMVSAqZGV2ID0gJnN0LT51bml0c1ty
ZXEtPmx1bl07CisgICAgR0Vycm9yICplcnJvciA9IE5VTEw7CisgICAgZ3NpemUgYnl0ZXNfcmVh
ZDsKKyAgICBnYm9vbGVhbiBmaW5pc2hlZDsKKworICAgIHJlcS0+cmVxX3N0YXRlID0gU0NTSV9S
RVFfQ09NUExFVEU7CisgICAgcmVxLT5jYW5jZWxfaWQgPSAwOworCisvLyAgICBnX2Fzc2VydChz
dHJlYW0gPT0gZGV2LT5zdHJlYW0pOworICAgIGlmIChzdHJlYW0gIT0gZGV2LT5zdHJlYW0pIHsK
KyAgICAgICAgdWludDMyX3Qgb3Bjb2RlID0gKHVpbnQzMl90KXJlcS0+Y2RiWzBdOworICAgICAg
ICBTUElDRV9ERUJVRygicmVhZF9hc3luY19jb21wbGV0ZSBCQUQgU1RSRUFNLCBsdW46ICV1Igor
ICAgICAgICAgICAgICAgICAgICAiIHJlcTogJSIgR19HVUlOVDY0X0ZPUk1BVCAiIG9wOiAweCUw
MngiLAorICAgICAgICAgICAgICAgICAgICByZXEtPmx1biwgcmVxLT5yZXFfbGVuLCBvcGNvZGUp
OworICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vu
c2VfY29kZV9UQVJHRVRfRkFJTFVSRSk7CisgICAgICAgIGNkX3Njc2lfZGV2X3JlcXVlc3RfY29t
cGxldGUoc3QtPnVzZXJfZGF0YSwgcmVxKTsKKyAgICAgICAgcmV0dXJuOworICAgIH0KKworICAg
IGJ5dGVzX3JlYWQgPSBnX2lucHV0X3N0cmVhbV9yZWFkX2ZpbmlzaChHX0lOUFVUX1NUUkVBTShz
dHJlYW0pLCByZXN1bHQsICZlcnJvcik7CisgICAgZmluaXNoZWQgPSBieXRlc19yZWFkID4gMDsK
KyAgICBpZiAoZmluaXNoZWQpIHsKKyAgICAgICAgU1BJQ0VfREVCVUcoInJlYWRfYXN5bmNfY29t
cGxldGUsIGx1bjogJXUiCisgICAgICAgICAgICAgICAgICAgICIgZmluaXNoZWQ6ICVkIGJ5dGVz
X3JlYWQ6ICUiIEdfR1VJTlQ2NF9GT1JNQVQKKyAgICAgICAgICAgICAgICAgICAgIiByZXE6ICUi
ICBHX0dVSU5UNjRfRk9STUFULAorICAgICAgICAgICAgICAgICAgICByZXEtPmx1biwgZmluaXNo
ZWQsICh1aW50NjRfdClieXRlc19yZWFkLCByZXEtPnJlcV9sZW4pOworCisgICAgICAgIHJlcS0+
aW5fbGVuID0gTUlOKGJ5dGVzX3JlYWQsIHJlcS0+cmVxX2xlbik7CisgICAgICAgIHJlcS0+c3Rh
dHVzID0gR09PRDsKKyAgICB9IGVsc2UgeworICAgICAgICBpZiAoZXJyb3IgIT0gTlVMTCkgewor
ICAgICAgICAgICAgU1BJQ0VfRVJST1IoImdfaW5wdXRfc3RyZWFtX3JlYWRfZmluaXNoIGZhaWxl
ZDogJXMiLCBlcnJvci0+bWVzc2FnZSk7CisgICAgICAgICAgICBnX2NsZWFyX2Vycm9yICgmZXJy
b3IpOworICAgICAgICB9IGVsc2UgeworICAgICAgICAgICAgU1BJQ0VfRVJST1IoImdfaW5wdXRf
c3RyZWFtX3JlYWRfZmluaXNoIGZhaWxlZCAobm8gZXJyIHByb3ZpZGVkKSIpOworICAgICAgICB9
CisgICAgICAgIHJlcS0+aW5fbGVuID0gMDsKKyAgICAgICAgcmVxLT5zdGF0dXMgPSBHT09EOwor
ICAgIH0KKyAgICBjZF9zY3NpX2Rldl9yZXF1ZXN0X2NvbXBsZXRlKHN0LT51c2VyX2RhdGEsIHJl
cSk7Cit9CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfcmVhZF9hc3luY19jYW5jZWxlZChHQ2FuY2Vs
bGFibGUgKmNhbmNlbGxhYmxlLCBncG9pbnRlciB1c2VyX2RhdGEpCit7CisgICAgQ2RTY3NpUmVx
dWVzdCAqcmVxID0gKENkU2NzaVJlcXVlc3QgKil1c2VyX2RhdGE7CisgICAgQ2RTY3NpVGFyZ2V0
ICpzdCA9IChDZFNjc2lUYXJnZXQgKilyZXEtPnByaXZfZGF0YTsKKworICAgIGdfYXNzZXJ0KGNh
bmNlbGxhYmxlID09IHN0LT5jYW5jZWxsYWJsZSk7CisgICAgZ19jYW5jZWxsYWJsZV9kaXNjb25u
ZWN0KGNhbmNlbGxhYmxlLCByZXEtPmNhbmNlbF9pZCk7CisgICAgcmVxLT5jYW5jZWxfaWQgPSAw
OworCisgICAgcmVxLT5yZXFfc3RhdGUgPQorICAgICAgICAoc3QtPnN0YXRlID09IENEX1NDU0lf
VEdUX1NUQVRFX1JVTk5JTkcpID8gU0NTSV9SRVFfQ0FOQ0VMRUQgOiBTQ1NJX1JFUV9ESVNQT1NF
RDsKKyAgICByZXEtPmluX2xlbiA9IDA7CisgICAgcmVxLT5zdGF0dXMgPSBHT09EOworCisgICAg
Y2Rfc2NzaV9kZXZfcmVxdWVzdF9jb21wbGV0ZShzdC0+dXNlcl9kYXRhLCByZXEpOworfQorCitz
dGF0aWMgaW50IGNkX3Njc2lfcmVhZF9hc3luY19zdGFydChDZFNjc2lMVSAqZGV2LCBDZFNjc2lS
ZXF1ZXN0ICpyZXEpCit7CisgICAgQ2RTY3NpVGFyZ2V0ICpzdCA9IGRldi0+dGd0OworICAgIEdG
aWxlSW5wdXRTdHJlYW0gKnN0cmVhbSA9IGRldi0+c3RyZWFtOworCisgICAgU1BJQ0VfREVCVUco
InJlYWRfYXN5bmNfc3RhcnQsIGx1bjoldSIKKyAgICAgICAgICAgICAgICAiIGxiYTogJSIgR19H
VUlOVDY0X0ZPUk1BVCAiIG9mZnNldDogJSIgR19HVUlOVDY0X0ZPUk1BVAorICAgICAgICAgICAg
ICAgICIgY250OiAlIiBHX0dVSU5UNjRfRk9STUFUICIgbGVuOiAlIiBHX0dVSU5UNjRfRk9STUFU
LAorICAgICAgICAgICAgICAgIHJlcS0+bHVuLCByZXEtPmxiYSwgcmVxLT5vZmZzZXQsIHJlcS0+
Y291bnQsIHJlcS0+cmVxX2xlbik7CisKKyAgICByZXEtPmNhbmNlbF9pZCA9IGdfY2FuY2VsbGFi
bGVfY29ubmVjdChzdC0+Y2FuY2VsbGFibGUsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgR19DQUxMQkFDSyhjZF9zY3NpX3JlYWRfYXN5bmNfY2FuY2VsZWQpLAor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcSwgLyogZGF0YSAq
LworICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5VTEwpOyAvKiBk
YXRhIGRlc3Ryb3kgY2IgKi8KKyAgICBpZiAocmVxLT5jYW5jZWxfaWQgPT0gMCkgeworICAgICAg
ICAvKiBhbHJlYWR5IGNhbmNlbGVkICovCisgICAgICAgIHJldHVybiAtMTsKKyAgICB9CisKKyAg
ICBnX3NlZWthYmxlX3NlZWsoR19TRUVLQUJMRShzdHJlYW0pLAorICAgICAgICAgICAgICAgICAg
ICByZXEtPm9mZnNldCwKKyAgICAgICAgICAgICAgICAgICAgR19TRUVLX1NFVCwKKyAgICAgICAg
ICAgICAgICAgICAgTlVMTCwgLyogY2FuY2VsbGFibGUgKi8KKyAgICAgICAgICAgICAgICAgICAg
TlVMTCk7IC8qIGVycm9yICovCisKKyAgICBnX2lucHV0X3N0cmVhbV9yZWFkX2FzeW5jKEdfSU5Q
VVRfU1RSRUFNKHN0cmVhbSksCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXEtPmJ1
ZiwgLyogYnVmZmVyIHRvIGZpbGwgKi8KKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJl
cS0+cmVxX2xlbiwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdfUFJJT1JJVFlfREVG
QVVMVCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0LT5jYW5jZWxsYWJsZSwKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNkX3Njc2lfcmVhZF9hc3luY19jb21wbGV0ZSwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChncG9pbnRlcilyZXEpOyAvKiBjYWxsYmFj
ayBhcmd1bWVudCAqLworICAgIHJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2Nt
ZF9yZWFkKENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICBpZiAoZGV2
LT5wb3dlcl9jb25kID09IENEX1NDU0lfUE9XRVJfU1RPUFBFRCkgeworICAgICAgICBTUElDRV9E
RUJVRygicmVhZCwgbHVuOiAldSBpcyBzdG9wcGVkIiwgcmVxLT5sdW4pOworICAgICAgICBjZF9z
Y3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTklUX0NN
RF9SRVFVSVJFRCk7CisgICAgICAgIHJldHVybjsKKyAgICB9IGVsc2UgaWYgKCFkZXYtPmxvYWRl
ZCB8fCBkZXYtPnN0cmVhbSA9PSBOVUxMKSB7CisgICAgICAgIFNQSUNFX0RFQlVHKCJyZWFkLCBs
dW46ICV1IGlzIG5vdCBsb2FkZWQiLCByZXEtPmx1bik7CisgICAgICAgIGNkX3Njc2lfY21kX2Nv
bXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX05PVF9SRUFEWV9OT19NRURJ
VU0pOworICAgICAgICByZXR1cm47CisgICAgfQorCisgICAgcmVxLT5jZGJfbGVuID0gc2NzaV9j
ZGJfbGVuZ3RoKHJlcS0+Y2RiKTsKKworICAgIHJlcS0+bGJhID0gc2NzaV9jZGJfbGJhKHJlcS0+
Y2RiLCByZXEtPmNkYl9sZW4pOworICAgIHJlcS0+b2Zmc2V0ID0gcmVxLT5sYmEgKiBkZXYtPmJs
b2NrX3NpemU7CisKKyAgICByZXEtPmNvdW50ID0gc2NzaV9jZGJfeGZlcl9sZW5ndGgocmVxLT5j
ZGIsIHJlcS0+Y2RiX2xlbik7IC8qIHhmZXIgaW4gYmxvY2tzICovCisgICAgcmVxLT5yZXFfbGVu
ID0gKHVpbnQ2NF90KSByZXEtPmNvdW50ICogZGV2LT5ibG9ja19zaXplOworCisgICAgY2Rfc2Nz
aV9yZWFkX2FzeW5jX3N0YXJ0KGRldiwgcmVxKTsKK30KKwordm9pZCBjZF9zY3NpX2Rldl9yZXF1
ZXN0X3N1Ym1pdChDZFNjc2lUYXJnZXQgKnN0LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAg
dWludDMyX3QgbHVuID0gcmVxLT5sdW47CisgICAgdWludDMyX3Qgb3Bjb2RlID0gKHVpbnQzMl90
KXJlcS0+Y2RiWzBdOworICAgIGNvbnN0IGNoYXIgKmNtZF9uYW1lID0gc2NzaV9jbWRfbmFtZVtv
cGNvZGVdOworICAgIENkU2NzaUxVICpkZXYgPSAmc3QtPnVuaXRzW2x1bl07CisKKyAgICBTUElD
RV9ERUJVRygicmVxdWVzdF9zdWJtaXQsIGx1bjogJXUgb3A6IDB4JTAyeCAlcyIsIGx1biwgb3Bj
b2RlLCBjbWRfbmFtZSk7CisKKyAgICBpZiAoc3QtPmN1cl9yZXEgIT0gTlVMTCkgeworICAgICAg
ICBTUElDRV9FUlJPUigicmVxdWVzdF9zdWJtaXQsIHJlcXVlc3Qgbm90IGlkbGUiKTsKKyAgICAg
ICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVf
VEFSR0VUX0ZBSUxVUkUpOworICAgICAgICBnb3RvIGRvbmU7CisgICAgfQorICAgIGlmIChyZXEt
PnJlcV9zdGF0ZSAhPSBTQ1NJX1JFUV9JRExFKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJyZXF1
ZXN0X3N1Ym1pdCwgcHJldiByZXF1ZXN0IG91dHN0YW5kaW5nIik7CisgICAgICAgIGNkX3Njc2lf
Y21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX1RBUkdFVF9GQUlM
VVJFKTsKKyAgICAgICAgZ290byBkb25lOworICAgIH0KKyAgICByZXEtPnJlcV9zdGF0ZSA9IFND
U0lfUkVRX1JVTk5JTkc7CisgICAgc3QtPmN1cl9yZXEgPSByZXE7CisKKyAgICAvKiBJTlFVSVJZ
IHNob3VsZCBzZW5kIHJlc3BvbnNlIGV2ZW4gZm9yIG5vbi1leGlzdGluZyBMVU5zICovCisgICAg
aWYgKCFjZF9zY3NpX3RhcmdldF9sdW5fbGVnYWwoc3QsIGx1bikpIHsKKyAgICAgICAgU1BJQ0Vf
RVJST1IoInJlcXVlc3Rfc3VibWl0LCBpbGxlZ2FsIGx1bjoldSIsIGx1bik7CisgICAgICAgIGlm
IChvcGNvZGUgPT0gSU5RVUlSWSkgeworICAgICAgICAgICAgaWYgKHJlcS0+Y2RiWzFdICYgMHgx
KSB7CisgICAgICAgICAgICAgICAgY2Rfc2NzaV9jbWRfaW5xdWlyeV92cGRfbm9fbHVuKGRldiwg
cmVxLCBQRVJJRl9RVUFMSUZJRVJfVU5TVVBQT1JURUQpOworICAgICAgICAgICAgfSBlbHNlIHsK
KyAgICAgICAgICAgICAgICBjZF9zY3NpX2NtZF9pbnF1aXJ5X3N0YW5kYXJkX25vX2x1bihkZXYs
IHJlcSwgUEVSSUZfUVVBTElGSUVSX1VOU1VQUE9SVEVEKTsKKyAgICAgICAgICAgIH0KKyAgICAg
ICAgfSBlbHNlIHsKKyAgICAgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQo
ZGV2LCByZXEsICZzZW5zZV9jb2RlX0xVTl9OT1RfU1VQUE9SVEVEKTsKKyAgICAgICAgfQorICAg
ICAgICBnb3RvIGRvbmU7CisgICAgfQorICAgIGlmICghY2Rfc2NzaV90YXJnZXRfbHVuX3JlYWxp
emVkKHN0LCBsdW4pKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJyZXF1ZXN0X3N1Ym1pdCwgYWJz
ZW50IGx1bjoldSIsIGx1bik7CisgICAgICAgIGlmIChvcGNvZGUgPT0gSU5RVUlSWSkgeworICAg
ICAgICAgICAgaWYgKHJlcS0+Y2RiWzFdICYgMHgxKSB7CisgICAgICAgICAgICAgICAgY2Rfc2Nz
aV9jbWRfaW5xdWlyeV92cGRfbm9fbHVuKGRldiwgcmVxLCBQRVJJRl9RVUFMSUZJRVJfTk9UX0NP
Tk5FQ1RFRCk7CisgICAgICAgICAgICB9IGVsc2UgeworICAgICAgICAgICAgICAgIGNkX3Njc2lf
Y21kX2lucXVpcnlfc3RhbmRhcmRfbm9fbHVuKGRldiwgcmVxLCBQRVJJRl9RVUFMSUZJRVJfTk9U
X0NPTk5FQ1RFRCk7CisgICAgICAgICAgICB9CisgICAgICAgIH0gZWxzZSB7CisgICAgICAgICAg
ICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9M
VU5fTk9UX1NVUFBPUlRFRCk7CisgICAgICAgIH0KKyAgICAgICAgZ290byBkb25lOworICAgIH0K
KworICAgIGlmIChkZXYtPnNob3J0X3NlbnNlLmtleSAhPSBOT19TRU5TRSkgeworICAgICAgICBn
Ym9vbGVhbiBwZW5kaW5nX3NlbnNlID0gVFJVRTsKKyAgICAgICAgaWYgKGRldi0+c2hvcnRfc2Vu
c2Uua2V5ID09IFVOSVRfQVRURU5USU9OKSB7CisgICAgICAgICAgICBpZiAoY2Rfc2NzaV9vcGNv
ZGVfdWFfc3VwcmVzcyhvcGNvZGUpKSB7CisgICAgICAgICAgICAgICAgcGVuZGluZ19zZW5zZSA9
IEZBTFNFOyAvKiBVQSBzdXByZXNzZWQgKi8KKyAgICAgICAgICAgIH0KKyAgICAgICAgfSBlbHNl
IGlmIChvcGNvZGUgPT0gUkVRVUVTVF9TRU5TRSkgeworICAgICAgICAgICAgcGVuZGluZ19zZW5z
ZSA9IEZBTFNFOyAvKiBzZW5zZSByZXR1cm5lZCBhcyBkYXRhICovCisgICAgICAgIH0KKyAgICAg
ICAgaWYgKHBlbmRpbmdfc2Vuc2UpIHsKKyAgICAgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRl
X2NoZWNrX2NvbmQoZGV2LCByZXEsIE5VTEwpOyAvKiBzZW5zZSBhbHJlYWR5IHNldCAqLworICAg
ICAgICAgICAgZ290byBkb25lOworICAgICAgICB9CisgICAgfQorCisgICAgLyogc2F2ZSB0aGUg
dGFyZ2V0IHRvIGJlIHVzZWQgaW4gY2FsbGJhY2tzIHdoZXJlIG9ubHkgcmVxIGlzIHBhc3NlZCAq
LworICAgIHJlcS0+cHJpdl9kYXRhID0gKHZvaWQgKilzdDsKKworICAgIHJlcS0+cmVxX2xlbiA9
IDA7CisKKyAgICBzd2l0Y2ggKG9wY29kZSkgeworICAgIGNhc2UgUkVQT1JUX0xVTlM6CisgICAg
ICAgIGNkX3Njc2lfY21kX3JlcG9ydF9sdW5zKHN0LCBkZXYsIHJlcSk7CisgICAgICAgIGJyZWFr
OworICAgIGNhc2UgVEVTVF9VTklUX1JFQURZOgorICAgICAgICBjZF9zY3NpX2NtZF90ZXN0X3Vu
aXRfcmVhZHkoZGV2LCByZXEpOworICAgICAgICBicmVhazsKKyAgICBjYXNlIElOUVVJUlk6Cisg
ICAgICAgIGNkX3Njc2lfY21kX2lucXVpcnkoZGV2LCByZXEpOworICAgICAgICBicmVhazsKKyAg
ICBjYXNlIFJFUVVFU1RfU0VOU0U6CisgICAgICAgIGNkX3Njc2lfY21kX3JlcXVlc3Rfc2Vuc2Uo
ZGV2LCByZXEpOworICAgICAgICBicmVhazsKKyAgICBjYXNlIFJFQURfNjoKKyAgICBjYXNlIFJF
QURfMTA6CisgICAgY2FzZSBSRUFEXzEyOgorICAgIGNhc2UgUkVBRF8xNjoKKyAgICAgICAgY2Rf
c2NzaV9jbWRfcmVhZChkZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgUkVBRF9D
QVBBQ0lUWV8xMDoKKyAgICAgICAgY2Rfc2NzaV9jbWRfcmVhZF9jYXBhY2l0eShkZXYsIHJlcSk7
CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgUkVBRF9UT0M6CisgICAgICAgIGNkX3Njc2lfY21k
X3JlYWRfdG9jKGRldiwgcmVxKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBHRVRfRVZFTlRf
U1RBVFVTX05PVElGSUNBVElPTjoKKyAgICAgICAgY2Rfc2NzaV9jbWRfZ2V0X2V2ZW50X3N0YXR1
c19ub3RpZmljYXRpb24oZGV2LCByZXEpOworICAgICAgICBicmVhazsKKyAgICBjYXNlIFJFQURf
RElTQ19JTkZPUk1BVElPTjoKKyAgICAgICAgY2Rfc2NzaV9jbWRfZ2V0X3JlYWRfZGlzY19pbmZv
cm1hdGlvbihkZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgUkVBRF9UUkFDS19J
TkZPUk1BVElPTjoKKyAgICAgICAgY2Rfc2NzaV9jbWRfZ2V0X3JlYWRfdHJhY2tfaW5mb3JtYXRp
b24oZGV2LCByZXEpOworICAgICAgICBicmVhazsKKyAgICBjYXNlIE1PREVfU0VOU0VfMTA6Cisg
ICAgICAgIGNkX3Njc2lfY21kX21vZGVfc2Vuc2VfMTAoZGV2LCByZXEpOworICAgICAgICBicmVh
azsKKyAgICBjYXNlIE1PREVfU0VMRUNUOgorICAgICAgICBjZF9zY3NpX2NtZF9tb2RlX3NlbGVj
dF82KGRldiwgcmVxKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBNT0RFX1NFTEVDVF8xMDoK
KyAgICAgICAgY2Rfc2NzaV9jbWRfbW9kZV9zZWxlY3RfMTAoZGV2LCByZXEpOworICAgICAgICBi
cmVhazsKKyAgICBjYXNlIEdFVF9DT05GSUdVUkFUSU9OOgorICAgICAgICBjZF9zY3NpX2NtZF9n
ZXRfY29uZmlndXJhdGlvbihkZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgQUxM
T1dfTUVESVVNX1JFTU9WQUw6CisgICAgICAgIGNkX3Njc2lfY21kX2FsbG93X21lZGl1bV9yZW1v
dmFsKGRldiwgcmVxKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBNTUNfU0VORF9FVkVOVDoK
KyAgICAgICAgY2Rfc2NzaV9jbWRfc2VuZF9ldmVudChkZXYsIHJlcSk7CisgICAgICAgIGJyZWFr
OworICAgIGNhc2UgTU1DX1JFUE9SVF9LRVk6CisgICAgICAgIGNkX3Njc2lfY21kX3JlcG9ydF9r
ZXkoZGV2LCByZXEpOworICAgICAgICBicmVhazsKKyAgICBjYXNlIE1NQ19TRU5EX0tFWToKKyAg
ICAgICAgY2Rfc2NzaV9jbWRfc2VuZF9rZXkoZGV2LCByZXEpOworICAgICAgICBicmVhazsKKyAg
ICBjYXNlIFNUQVJUX1NUT1A6CisgICAgICAgIGNkX3Njc2lfY21kX3N0YXJ0X3N0b3BfdW5pdChk
ZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgTU1DX0dFVF9QRVJGT1JNQU5DRToK
KyAgICAgICAgY2Rfc2NzaV9jbWRfZ2V0X3BlcmZvcm1hbmNlKGRldiwgcmVxKTsKKyAgICAgICAg
YnJlYWs7CisgICAgY2FzZSBNTUNfTUVDSEFOSVNNX1NUQVRVUzoKKyAgICAgICAgY2Rfc2NzaV9j
bWRfbWVjaGFuaXNtX3N0YXR1cyhkZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGRlZmF1
bHQ6CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZz
ZW5zZV9jb2RlX0lOVkFMSURfT1BDT0RFKTsKKyAgICAgICAgYnJlYWs7CisgICAgfQorCisgICAg
aWYgKHJlcS0+cmVxX2xlbiA+IElOVDMyX01BWCkgeworICAgICAgICBjZF9zY3NpX2NtZF9jb21w
bGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZBTElEX0NEQl9GSUVMRCk7
CisgICAgICAgIGdvdG8gZG9uZTsKKyAgICB9CisKK2RvbmU6CisgICAgU1BJQ0VfREVCVUcoInJl
cXVlc3Rfc3VibWl0IGRvbmUsIGx1bjogJXUiCisgICAgICAgICAgICAgICAgIiBvcDogMHglMDJ4
ICVzLCBzdGF0ZTogJXMgc3RhdHVzOiAldSBsZW46ICUiIEdfR1VJTlQ2NF9GT1JNQVQsCisgICAg
ICAgICAgICAgICAgbHVuLCBvcGNvZGUsIGNtZF9uYW1lLCBDZFNjc2lSZXFTdGF0ZV9zdHIocmVx
LT5yZXFfc3RhdGUpLCByZXEtPnN0YXR1cywKKyAgICAgICAgICAgICAgICByZXEtPmluX2xlbik7
CisKKyAgICBpZiAocmVxLT5yZXFfc3RhdGUgPT0gU0NTSV9SRVFfQ09NUExFVEUpIHsKKyAgICAg
ICAgY2Rfc2NzaV9kZXZfcmVxdWVzdF9jb21wbGV0ZShzdC0+dXNlcl9kYXRhLCByZXEpOworICAg
IH0KK30KKwordm9pZCBjZF9zY3NpX2Rldl9yZXF1ZXN0X2NhbmNlbChDZFNjc2lUYXJnZXQgKnN0
LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgaWYgKHN0LT5jdXJfcmVxID09IHJlcSkgewor
ICAgICAgICBpZiAocmVxLT5yZXFfc3RhdGUgPT0gU0NTSV9SRVFfUlVOTklORykgeworICAgICAg
ICAgICAgU1BJQ0VfREVCVUcoInJlcXVlc3RfY2FuY2VsOiBsdW46ICV1IgorICAgICAgICAgICAg
ICAgICAgICAgICAgICIgb3A6IDB4JTAyeCBsZW46ICUiIEdfR1VJTlQ2NF9GT1JNQVQsCisgICAg
ICAgICAgICAgICAgICAgICAgICByZXEtPmx1biwgKHVuc2lnbmVkIGludClyZXEtPmNkYlswXSwg
cmVxLT5yZXFfbGVuKTsKKyAgICAgICAgICAgIGdfY2FuY2VsbGFibGVfY2FuY2VsKHN0LT5jYW5j
ZWxsYWJsZSk7CisgICAgICAgIH0gZWxzZSB7CisgICAgICAgICAgICBTUElDRV9ERUJVRygicmVx
dWVzdF9jYW5jZWw6IHJlcXVlc3QgaXMgbm90IHJ1bm5pbmciKTsKKyAgICAgICAgfQorICAgIH0g
ZWxzZSB7CisgICAgICAgIFNQSUNFX0RFQlVHKCJyZXF1ZXN0X2NhbmNlbDogb3RoZXIgcmVxdWVz
dCBpcyBvdXRzdGFuZGluZyIpOworICAgIH0KK30KKwordm9pZCBjZF9zY3NpX2Rldl9yZXF1ZXN0
X3JlbGVhc2UoQ2RTY3NpVGFyZ2V0ICpzdCwgQ2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAgIHN0
LT5jdXJfcmVxID0gTlVMTDsKKyAgICBjZF9zY3NpX3JlcV9pbml0KHJlcSk7CisKKyAgICBpZiAo
c3QtPnN0YXRlID09IENEX1NDU0lfVEdUX1NUQVRFX1JFU0VUKSB7CisgICAgICAgIGNkX3Njc2lf
dGFyZ2V0X2RvX3Jlc2V0KHN0KTsKKyAgICB9Cit9CisKKyNlbmRpZiAvKiBVU0VfVVNCUkVESVIg
Ki8KZGlmZiAtLWdpdCBhL3NyYy9jZC1zY3NpLmggYi9zcmMvY2Qtc2NzaS5oCm5ldyBmaWxlIG1v
ZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwLi5jMDU4YTY2ZQotLS0gL2Rldi9udWxsCisrKyBiL3Ny
Yy9jZC1zY3NpLmgKQEAgLTAsMCArMSwxMjAgQEAKKy8qIC0qLSBNb2RlOiBDOyBjLWJhc2ljLW9m
ZnNldDogNDsgaW5kZW50LXRhYnMtbW9kZTogbmlsIC0qLSAqLworLyoKKyAgIENEIGRldmljZSBl
bXVsYXRpb24gLSBTQ1NJIGVuZ2luZQorCisgICBDb3B5cmlnaHQgKEMpIDIwMTggUmVkIEhhdCwg
SW5jLgorCisgICBSZWQgSGF0IEF1dGhvcnM6CisgICBBbGV4YW5kZXIgTmV6aGluc2t5PGFuZXpo
aW5zQHJlZGhhdC5jb20+CisKKyAgIFRoaXMgbGlicmFyeSBpcyBmcmVlIHNvZnR3YXJlOyB5b3Ug
Y2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IKKyAgIG1vZGlmeSBpdCB1bmRlciB0aGUgdGVybXMg
b2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKKyAgIExpY2Vuc2UgYXMgcHVibGlzaGVk
IGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlcgorICAgdmVyc2lvbiAyLjEg
b2YgdGhlIExpY2Vuc2UsIG9yIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCisK
KyAgIFRoaXMgbGlicmFyeSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwg
YmUgdXNlZnVsLAorICAgYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhl
IGltcGxpZWQgd2FycmFudHkgb2YKKyAgIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBB
IFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUgR05VCisgICBMZXNzZXIgR2VuZXJhbCBQdWJs
aWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgorCisgICBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2
ZWQgYSBjb3B5IG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCisgICBMaWNlbnNlIGFs
b25nIHdpdGggdGhpcyBsaWJyYXJ5OyBpZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xp
Y2Vuc2VzLz4uCisqLworCisjaWZuZGVmIFNQSUNFX0dUS19DRF9TQ1NJX0hfXworI2RlZmluZSBT
UElDRV9HVEtfQ0RfU0NTSV9IX18KKworI2luY2x1ZGUgImNkLXNjc2ktZGV2LXBhcmFtcy5oIgor
I2luY2x1ZGUgImNkLXVzYi1idWxrLW1zZC5oIgorI2luY2x1ZGUgInNjc2ktY29uc3RhbnRzLmgi
CisKKyNpZiBkZWZpbmVkKEdfT1NfV0lOMzIpCisjaW5jbHVkZSA8d2luc29jazIuaD4KKyNpbmNs
dWRlIDx3aW5kb3dzLmg+CisvKiBXaW5kb3dzIGlzIGFsd2F5cyBMRSBhdCB0aGUgbW9tZW50ICov
CisjZGVmaW5lIGxlMzJ0b2goeCkgICAgICAgICAgKHgpCisjZGVmaW5lIGh0b2xlMzIoeCkgICAg
ICAgICAgKHgpCisjZGVmaW5lIGh0b2JlMzIoeCkgICAgICAgICAgaHRvbmwoeCkKKyNlbmRpZgor
Cit0eXBlZGVmIGVudW0gU2NzaVhmZXJEaXIgeworICAgIFNDU0lfWEZFUl9OT05FID0gMCwgIC8q
IFRFU1RfVU5JVF9SRUFEWSwgLi4uICAgICAgICAgICAqLworICAgIFNDU0lfWEZFUl9GUk9NX0RF
ViwgIC8qIFJFQUQsIElOUVVJUlksIE1PREVfU0VOU0UsIC4uLiAqLworICAgIFNDU0lfWEZFUl9U
T19ERVYsICAgIC8qIFdSSVRFLCBNT0RFX1NFTEVDVCwgLi4uICAgICAgICAqLworfSBTY3NpWGZl
ckRpcjsKKworI2RlZmluZSBTQ1NJX0NEQl9CVUZfU0laRSAgIDE2CisKK3R5cGVkZWYgZW51bSBD
ZFNjc2lSZXFTdGF0ZSB7CisgICAgU0NTSV9SRVFfSURMRSA9IDAsCisgICAgU0NTSV9SRVFfUlVO
TklORywKKyAgICBTQ1NJX1JFUV9DT01QTEVURSwKKyAgICBTQ1NJX1JFUV9DQU5DRUxFRCwKKyAg
ICBTQ1NJX1JFUV9ESVNQT1NFRCwKK30gQ2RTY3NpUmVxU3RhdGU7CisKK3R5cGVkZWYgc3RydWN0
IENkU2NzaVJlcXVlc3QgeworICAgIC8qIHJlcXVlc3QgKi8KKyAgICB1aW50OF90IGNkYltTQ1NJ
X0NEQl9CVUZfU0laRV07CisgICAgdWludDMyX3QgY2RiX2xlbjsKKworICAgIHVpbnQzMl90IGx1
bjsKKworICAgIHVpbnQ4X3QgKmJ1ZjsKKyAgICB1aW50MzJfdCBidWZfbGVuOworCisgICAgLyog
aW50ZXJuYWwgKi8KKyAgICBDZFNjc2lSZXFTdGF0ZSByZXFfc3RhdGU7CisgICAgU2NzaVhmZXJE
aXIgeGZlcl9kaXI7CisgICAgdWludDY0X3QgY2FuY2VsX2lkOworICAgIHZvaWQgKnByaXZfZGF0
YTsKKworICAgIHVpbnQ2NF90IGxiYTsgLyogb2Zmc2V0IGluIGxvZ2ljYWwgYmxvY2tzIGlmIHJl
bGV2YW50ICovCisgICAgdWludDY0X3QgY291bnQ7IC8qIGNvdW50IGluIGxvZ2ljYWwgYmxvY2tz
ICovCisKKyAgICB1aW50NjRfdCBvZmZzZXQ7IC8qIHNjc2kgY2RiIG9mZnNldCwgbm9ybWFsaXpl
ZCB0byBieXRlcyAqLworICAgIHVpbnQ2NF90IHJlcV9sZW47IC8qIHNjc2kgY2RiIHJlcXVlc3Qg
bGVuZ3RoLCBub3JtYWxpemVkIHRvIGJ5dGVzICovCisKKyAgICAvKiByZXN1bHQgKi8KKyAgICB1
aW50NjRfdCBpbl9sZW47IC8qIGxlbmd0aCBvZiBkYXRhIGFjdHVhbGx5IGF2YWlsYWJsZSBhZnRl
ciByZWFkICovCisgICAgdWludDMyX3Qgc3RhdHVzOyAvKiBTQ1NJIHN0YXR1cyBjb2RlICovCisK
K30gQ2RTY3NpUmVxdWVzdDsKKworQ2RTY3NpUmVxU3RhdGUgY2Rfc2NzaV9nZXRfcmVxX3N0YXRl
KENkU2NzaVJlcXVlc3QgKnJlcSk7CisKKy8qIFNDU0kgdGFyZ2V0L2RldmljZSBBUEkgKi8KK3R5
cGVkZWYgc3RydWN0IENkU2NzaVRhcmdldCBDZFNjc2lUYXJnZXQ7CisKKy8qIHRvIGJlIHVzZWQg
aW4gY2FsbGJhY2tzICovCitDZFNjc2lUYXJnZXQgKmNkX3Njc2lfdGFyZ2V0X2FsbG9jKHZvaWQg
KnRhcmdldF91c2VyX2RhdGEsIHVpbnQzMl90IG1heF9sdW5zKTsKK3ZvaWQgY2Rfc2NzaV90YXJn
ZXRfZnJlZShDZFNjc2lUYXJnZXQgKnNjc2lfdGFyZ2V0KTsKKworaW50IGNkX3Njc2lfZGV2X3Jl
YWxpemUoQ2RTY3NpVGFyZ2V0ICpzY3NpX3RhcmdldCwgdWludDMyX3QgbHVuLAorICAgICAgICAg
ICAgICAgICAgICAgICAgY29uc3QgQ2RTY3NpRGV2aWNlUGFyYW1ldGVycyAqZGV2X3BhcmFtcyk7
CitpbnQgY2Rfc2NzaV9kZXZfdW5yZWFsaXplKENkU2NzaVRhcmdldCAqc2NzaV90YXJnZXQsIHVp
bnQzMl90IGx1bik7CisKK2ludCBjZF9zY3NpX2Rldl9sb2NrKENkU2NzaVRhcmdldCAqc2NzaV90
YXJnZXQsIHVpbnQzMl90IGx1biwgZ2Jvb2xlYW4gbG9jayk7CitpbnQgY2Rfc2NzaV9kZXZfbG9h
ZChDZFNjc2lUYXJnZXQgKnNjc2lfdGFyZ2V0LCB1aW50MzJfdCBsdW4sCisgICAgICAgICAgICAg
ICAgICAgICBjb25zdCBDZFNjc2lNZWRpYVBhcmFtZXRlcnMgKm1lZGlhX3BhcmFtcyk7CitpbnQg
Y2Rfc2NzaV9kZXZfZ2V0X2luZm8oQ2RTY3NpVGFyZ2V0ICpzY3NpX3RhcmdldCwgdWludDMyX3Qg
bHVuLCBDZFNjc2lEZXZpY2VJbmZvICpsdW5faW5mbyk7CitpbnQgY2Rfc2NzaV9kZXZfdW5sb2Fk
KENkU2NzaVRhcmdldCAqc2NzaV90YXJnZXQsIHVpbnQzMl90IGx1bik7CisKK3ZvaWQgY2Rfc2Nz
aV9kZXZfcmVxdWVzdF9zdWJtaXQoQ2RTY3NpVGFyZ2V0ICpzY3NpX3RhcmdldCwgQ2RTY3NpUmVx
dWVzdCAqcmVxdWVzdCk7Cit2b2lkIGNkX3Njc2lfZGV2X3JlcXVlc3RfY2FuY2VsKENkU2NzaVRh
cmdldCAqc2NzaV90YXJnZXQsIENkU2NzaVJlcXVlc3QgKnJlcXVlc3QpOwordm9pZCBjZF9zY3Np
X2Rldl9yZXF1ZXN0X3JlbGVhc2UoQ2RTY3NpVGFyZ2V0ICpzY3NpX3RhcmdldCwgQ2RTY3NpUmVx
dWVzdCAqcmVxdWVzdCk7CisKK2ludCBjZF9zY3NpX2Rldl9yZXNldChDZFNjc2lUYXJnZXQgKnNj
c2lfdGFyZ2V0LCB1aW50MzJfdCBsdW4pOworCitpbnQgY2Rfc2NzaV90YXJnZXRfcmVzZXQoQ2RT
Y3NpVGFyZ2V0ICpzY3NpX3RhcmdldCk7CisKKy8qIENhbGxiYWNrcworICogVGhlc2UgY2FsbGJh
Y2tzIGFyZSB1c2VkIGJ5IHVwcGVyIGxheWVyIHRvIGltcGxlbWVudCBzcGVjaWZpYyBTQ1NJCisg
KiB0YXJnZXQgZGV2aWNlcy4KKyAqLwordm9pZCBjZF9zY3NpX2Rldl9yZXF1ZXN0X2NvbXBsZXRl
KHZvaWQgKnRhcmdldF91c2VyX2RhdGEsIENkU2NzaVJlcXVlc3QgKnJlcXVlc3QpOwordm9pZCBj
ZF9zY3NpX2Rldl9jaGFuZ2VkKHZvaWQgKnRhcmdldF91c2VyX2RhdGEsIHVpbnQzMl90IGx1bik7
Cit2b2lkIGNkX3Njc2lfZGV2X3Jlc2V0X2NvbXBsZXRlKHZvaWQgKnRhcmdldF91c2VyX2RhdGEs
IHVpbnQzMl90IGx1bik7Cit2b2lkIGNkX3Njc2lfdGFyZ2V0X3Jlc2V0X2NvbXBsZXRlKHZvaWQg
KnRhcmdldF91c2VyX2RhdGEpOworCisjZW5kaWYgLyogU1BJQ0VfR1RLX0NEX1NDU0lfSF9fICov
CmRpZmYgLS1naXQgYS9zcmMvY2QtdXNiLWJ1bGstbXNkLmMgYi9zcmMvY2QtdXNiLWJ1bGstbXNk
LmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAuLjQ5ZTAxZWI2Ci0tLSAvZGV2
L251bGwKKysrIGIvc3JjL2NkLXVzYi1idWxrLW1zZC5jCkBAIC0wLDAgKzEsNTQ0IEBACisvKiAt
Ki0gTW9kZTogQzsgYy1iYXNpYy1vZmZzZXQ6IDQ7IGluZGVudC10YWJzLW1vZGU6IG5pbCAtKi0g
Ki8KKy8qCisgICAgVVNCIENEIERldmljZSBlbXVsYXRpb24gLSBEYXRhIEJ1bGsgdHJhbnNmZXJz
IC0gTWFzcyBTdG9yYWdlIERldmljZQorCisgICAgQ29weXJpZ2h0IChDKSAyMDE4IFJlZCBIYXQs
IEluYy4KKworICAgIFJlZCBIYXQgQXV0aG9yczoKKyAgICBBbGV4YW5kZXIgTmV6aGluc2t5PGFu
ZXpoaW5zQHJlZGhhdC5jb20+CisKKyAgICBUaGlzIGxpYnJhcnkgaXMgZnJlZSBzb2Z0d2FyZTsg
eW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yCisgICAgbW9kaWZ5IGl0IHVuZGVyIHRoZSB0
ZXJtcyBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYworICAgIExpY2Vuc2UgYXMgcHVi
bGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlcgorICAgIHZlcnNp
b24gMi4xIG9mIHRoZSBMaWNlbnNlLCBvciAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJz
aW9uLgorCisgICAgVGhpcyBsaWJyYXJ5IGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQg
aXQgd2lsbCBiZSB1c2VmdWwsCisgICAgYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0
IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKKyAgICBNRVJDSEFOVEFCSUxJVFkgb3IgRklU
TkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlIEdOVQorICAgIExlc3NlciBH
ZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCisKKyAgICBZb3Ugc2hvdWxk
IGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCisg
ICAgTGljZW5zZSBhbG9uZyB3aXRoIHRoaXMgbGlicmFyeTsgaWYgbm90LCBzZWUgPGh0dHA6Ly93
d3cuZ251Lm9yZy9saWNlbnNlcy8+LgorKi8KKworI2luY2x1ZGUgImNvbmZpZy5oIgorI2luY2x1
ZGUgInNwaWNlL3R5cGVzLmgiCisjaW5jbHVkZSAic3BpY2UtY29tbW9uLmgiCisjaW5jbHVkZSAi
c3BpY2UtdXRpbC5oIgorI2luY2x1ZGUgImNkLXVzYi1idWxrLW1zZC5oIgorI2luY2x1ZGUgImNk
LXNjc2kuaCIKKworI2lmZGVmIFVTRV9VU0JSRURJUgorCisjZGVmaW5lIFNQSUNFX0VSUk9SKGZt
dCwgLi4uKSBcCisgICAgZG8geyBTUElDRV9ERUJVRygidXNiLW1zZCBlcnJvcjogIiBmbXQgLCAj
IyBfX1ZBX0FSR1NfXyk7IH0gd2hpbGUgKDApCisKK3R5cGVkZWYgZW51bSBVc2JDZFN0YXRlIHsK
KyAgICBVU0JfQ0RfU1RBVEVfSU5JVCwgLyogTm90IHJlYWR5ICovCisgICAgVVNCX0NEX1NUQVRF
X0NCVywgLyogV2FpdGluZyBmb3IgQ29tbWFuZCBCbG9jayAqLworICAgIFVTQl9DRF9TVEFURV9E
QVRBT1VULCAvKiBUcmFuc2ZlciBkYXRhIHRvIGRldmljZSAqLworICAgIFVTQl9DRF9TVEFURV9E
QVRBSU4sIC8qIFRyYW5zZmVyIGRhdGEgZnJvbSBkZXZpY2UgKi8KKyAgICBVU0JfQ0RfU1RBVEVf
WkVST19EQVRBSU4sIC8qIE5lZWQgdG8gc2VuZCB6ZXJvIGJ1bGstaW4gYmVmb3JlIHN0YXR1cyAq
LworICAgIFVTQl9DRF9TVEFURV9DU1csIC8qIFNlbmQgQ29tbWFuZCBTdGF0dXMgKi8KKyAgICBV
U0JfQ0RfU1RBVEVfREVWSUNFX1JFU0VULCAvKiByZXNldCBvZiBhIHNpbmdsZSBkZXZpY2UgKi8K
KyAgICBVU0JfQ0RfU1RBVEVfVEFSR0VUX1JFU0VUIC8qIHJlc2V0IG9mIGVudGlyZSB0YXJnZXQg
Ki8KK30gVXNiQ2RTdGF0ZTsKKworLyogVVNCIE1TRCBDb21tYW5kIEJsb2NrIFdyYXBwZXIgKi8K
K3N0cnVjdCBfX2F0dHJpYnV0ZV9fKChfX3BhY2tlZF9fKSkgVXNiQ2RDQlcgeworICAgIHVpbnQz
Ml90IHNpZzsKKyAgICB1aW50MzJfdCB0YWc7CisgICAgdWludDMyX3QgZXhwX2RhdGFfbGVuOyAv
KiBleHBlY3RlZCBkYXRhIHhmZXIgbGVuZ3RoIGZvciB0aGUgcmVxdWVzdCAqLworICAgIHVpbnQ4
X3QgZmxhZ3M7CisgICAgdWludDhfdCBsdW47CisgICAgdWludDhfdCBjbWRfbGVuOyAvKiBhY3R1
YWwgbGVuZ3RoIG9mIHRoZSBzY3NpIGNvbW1hbmQgdGhhdCBmb2xsb3dzICovCisgICAgdWludDhf
dCBjbWRbMTZdOyAvKiBzY3NpIGNvbW1hbmQgdG8gcGVyZm9ybSAqLworfTsKKworLyogVVNCIE1T
RCBDb21tYW5kIFN0YXR1cyBXcmFwcGVyICovCitzdHJ1Y3QgX19hdHRyaWJ1dGVfXygoX19wYWNr
ZWRfXykpIFVzYkNkQ1NXIHsKKyAgICB1aW50MzJfdCBzaWc7CisgICAgdWludDMyX3QgdGFnOwor
ICAgIHVpbnQzMl90IHJlc2lkdWU7CisgICAgdWludDhfdCBzdGF0dXM7Cit9OworCisvKiBVc2JD
ZENTVzo6c3RhdHVzICovCit0eXBlZGVmIGVudW0gVXNiTXNkU3RhdHVzIHsKKyAgICBVU0JfTVNE
X1NUQVRVU19HT09EID0gMCwKKyAgICBVU0JfTVNEX1NUQVRVU19GQUlMRUQgPSAxLAorICAgIFVT
Ql9NU0RfU1RBVFVTX1BIQVNFX0VSUiA9IDIsCit9IFVzYk1zZFN0YXR1czsKKwordHlwZWRlZiBz
dHJ1Y3QgVXNiQ2RCdWxrTXNkUmVxdWVzdCB7CisgICAgQ2RTY3NpUmVxdWVzdCBzY3NpX3JlcTsK
KworICAgIHVpbnQzMl90IGx1bjsKKyAgICB1aW50MzJfdCB1c2JfcmVxX2xlbjsgLyogbGVuZ3Ro
IG9mIGRhdGEgcmVxdWVzdGVkIGJ5IHVzYiAqLworICAgIHVpbnQzMl90IHNjc2lfaW5fbGVuOyAv
KiBsZW5ndGggb2YgZGF0YSByZXR1cm5lZCBieSBzY3NpIGxpbWl0ZWQgYnkgdXNiIHJlcXVlc3Qg
Ki8KKworICAgIHVpbnQzMl90IHhmZXJfbGVuOyAvKiBsZW5ndGggb2YgZGF0YSB0cmFuc2ZlcmVk
IHVudGlsIG5vdyAqLworICAgIHVpbnQzMl90IGJ1bGtfaW5fbGVuOyAvKiBsZW5ndGggb2YgdGhl
IGxhc3QgcG9zdHBvbmVkIGJ1bGstaW4gcmVxdWVzdCAqLworCisgICAgc3RydWN0IFVzYkNkQ1NX
IGNzdzsgLyogdXNiIHN0YXR1cyBoZWFkZXIgKi8KK30gVXNiQ2RCdWxrTXNkUmVxdWVzdDsKKwor
dHlwZWRlZiBzdHJ1Y3QgVXNiQ2RCdWxrTXNkRGV2aWNlIHsKKyAgICBVc2JDZFN0YXRlIHN0YXRl
OworICAgIENkU2NzaVRhcmdldCAqc2NzaV90YXJnZXQ7IC8qIHNjc2kgaGFuZGxlICovCisgICAg
dm9pZCAqdXNiX3VzZXJfZGF0YTsgLyogdXNlZCBpbiBjYWxsYmFja3MgdG8gdXNiICovCisgICAg
VXNiQ2RCdWxrTXNkUmVxdWVzdCB1c2JfcmVxOyAvKiBub3cgc3VwcG9ydGluZyBhIHNpbmdsZSBj
bWQgKi8KKyAgICB1aW50OF90ICpkYXRhX2J1ZjsKKyAgICB1aW50MzJfdCBkYXRhX2J1Zl9sZW47
Cit9IFVzYkNkQnVsa01zZERldmljZTsKKworc3RhdGljIGlubGluZSBjb25zdCBjaGFyICp1c2Jf
Y2Rfc3RhdGVfc3RyKFVzYkNkU3RhdGUgc3RhdGUpCit7CisgICAgc3dpdGNoIChzdGF0ZSkgewor
ICAgIGNhc2UgVVNCX0NEX1NUQVRFX0lOSVQ6CisgICAgICAgIHJldHVybiAiSU5JVCI7CisgICAg
Y2FzZSBVU0JfQ0RfU1RBVEVfQ0JXOgorICAgICAgICByZXR1cm4gIkNCVyI7CisgICAgY2FzZSBV
U0JfQ0RfU1RBVEVfREFUQU9VVDoKKyAgICAgICAgcmV0dXJuICJEQVRBT1VUIjsKKyAgICBjYXNl
IFVTQl9DRF9TVEFURV9EQVRBSU46CisgICAgICAgIHJldHVybiAiREFUQUlOIjsKKyAgICBjYXNl
IFVTQl9DRF9TVEFURV9aRVJPX0RBVEFJTjoKKyAgICAgICAgcmV0dXJuICJaRVJPX0RBVEFJTiI7
CisgICAgY2FzZSBVU0JfQ0RfU1RBVEVfQ1NXOgorICAgICAgICByZXR1cm4gIkNTVyI7CisgICAg
Y2FzZSBVU0JfQ0RfU1RBVEVfREVWSUNFX1JFU0VUOgorICAgICAgICByZXR1cm4gIkRFVl9SRVNF
VCI7CisgICAgY2FzZSBVU0JfQ0RfU1RBVEVfVEFSR0VUX1JFU0VUOgorICAgICAgICByZXR1cm4g
IlRHVF9SRVNFVCI7CisgICAgZGVmYXVsdDoKKyAgICAgICAgcmV0dXJuICJJTExFR0FMIjsKKyAg
ICB9Cit9CisKK3N0YXRpYyB2b2lkIGNkX3VzYl9idWxrX21zZF9zZXRfc3RhdGUoVXNiQ2RCdWxr
TXNkRGV2aWNlICpjZCwgVXNiQ2RTdGF0ZSBzdGF0ZSkKK3sKKyAgICBTUElDRV9ERUJVRygiU3Rh
dGUgJXMgLT4gJXMiLCB1c2JfY2Rfc3RhdGVfc3RyKGNkLT5zdGF0ZSksIHVzYl9jZF9zdGF0ZV9z
dHIoc3RhdGUpKTsKKyAgICBjZC0+c3RhdGUgPSBzdGF0ZTsKK30KKworVXNiQ2RCdWxrTXNkRGV2
aWNlICpjZF91c2JfYnVsa19tc2RfYWxsb2Modm9pZCAqdXNiX3VzZXJfZGF0YSwgdWludDMyX3Qg
bWF4X2x1bnMpCit7CisgICAgVXNiQ2RCdWxrTXNkRGV2aWNlICpjZCA9IGdfbmV3MChVc2JDZEJ1
bGtNc2REZXZpY2UsIDEpOworCisgICAgY2QtPmRhdGFfYnVmX2xlbiA9IDI1NiAqIDEwMjQ7Cisg
ICAgY2QtPmRhdGFfYnVmID0gZ19tYWxsb2MoY2QtPmRhdGFfYnVmX2xlbik7CisKKyAgICBjZC0+
c2NzaV90YXJnZXQgPSBjZF9zY3NpX3RhcmdldF9hbGxvYyhjZCwgbWF4X2x1bnMpOworICAgIGlm
IChjZC0+c2NzaV90YXJnZXQgPT0gTlVMTCkgeworICAgICAgICBnX2ZyZWUoY2QtPmRhdGFfYnVm
KTsKKyAgICAgICAgZ19mcmVlKGNkKTsKKyAgICAgICAgcmV0dXJuIE5VTEw7CisgICAgfQorICAg
IGNkX3VzYl9idWxrX21zZF9zZXRfc3RhdGUoY2QsIFVTQl9DRF9TVEFURV9JTklUKTsKKyAgICBj
ZC0+dXNiX3VzZXJfZGF0YSA9IHVzYl91c2VyX2RhdGE7CisKKyAgICBTUElDRV9ERUJVRygiQWxs
b2MsIG1heF9sdW5zOiUiIEdfR1VJTlQzMl9GT1JNQVQsIG1heF9sdW5zKTsKKyAgICByZXR1cm4g
Y2Q7Cit9CisKK2ludCBjZF91c2JfYnVsa19tc2RfcmVhbGl6ZShVc2JDZEJ1bGtNc2REZXZpY2Ug
KmNkLCB1aW50MzJfdCBsdW4sCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgQ2RT
Y3NpRGV2aWNlUGFyYW1ldGVycyAqZGV2X3BhcmFtcykKK3sKKyAgICBDZFNjc2lEZXZpY2VQYXJh
bWV0ZXJzIHNjc2lfZGV2X3BhcmFtczsKKyAgICBpbnQgcmM7CisKKyAgICBzY3NpX2Rldl9wYXJh
bXMudmVuZG9yID0gZGV2X3BhcmFtcy0+dmVuZG9yID8gOiAiU1BJQ0UiOworICAgIHNjc2lfZGV2
X3BhcmFtcy5wcm9kdWN0ID0gZGV2X3BhcmFtcy0+cHJvZHVjdCA/IDogIlVTQi1DRCI7CisgICAg
c2NzaV9kZXZfcGFyYW1zLnZlcnNpb24gPSBkZXZfcGFyYW1zLT52ZXJzaW9uID8gOiAiMC4xIjsK
KyAgICBzY3NpX2Rldl9wYXJhbXMuc2VyaWFsID0gZGV2X3BhcmFtcy0+c2VyaWFsID8gOiAiMTIz
NDU2IjsKKworICAgIHJjID0gY2Rfc2NzaV9kZXZfcmVhbGl6ZShjZC0+c2NzaV90YXJnZXQsIGx1
biwgJnNjc2lfZGV2X3BhcmFtcyk7CisgICAgaWYgKHJjICE9IDApIHsKKyAgICAgICAgU1BJQ0Vf
RVJST1IoIkZhaWxlZCB0byByZWFsaXplIGx1bjolIiBHX0dVSU5UMzJfRk9STUFULCBsdW4pOwor
ICAgICAgICByZXR1cm4gcmM7CisgICAgfQorCisgICAgaWYgKGNkLT5zdGF0ZSA9PSBVU0JfQ0Rf
U1RBVEVfSU5JVCkgeworICAgICAgICAvKiB3YWl0IG5leHQgcmVxdWVzdCAqLworICAgICAgICBj
ZF91c2JfYnVsa19tc2Rfc2V0X3N0YXRlKGNkLCBVU0JfQ0RfU1RBVEVfQ0JXKTsKKyAgICAgICAg
Y2Rfc2NzaV9kZXZfcmVxdWVzdF9yZWxlYXNlKGNkLT5zY3NpX3RhcmdldCwgJmNkLT51c2JfcmVx
LnNjc2lfcmVxKTsKKyAgICB9CisKKyAgICBTUElDRV9ERUJVRygiUmVhbGl6ZSBPSyBsdW46JSIg
R19HVUlOVDMyX0ZPUk1BVCwgbHVuKTsKKyAgICByZXR1cm4gMDsKK30KKworaW50IGNkX3VzYl9i
dWxrX21zZF9sb2NrKFVzYkNkQnVsa01zZERldmljZSAqY2QsIHVpbnQzMl90IGx1biwgZ2Jvb2xl
YW4gbG9jaykKK3sKKyAgICBpbnQgcmM7CisKKyAgICByYyA9IGNkX3Njc2lfZGV2X2xvY2soY2Qt
PnNjc2lfdGFyZ2V0LCBsdW4sIGxvY2spOworICAgIGlmIChyYyAhPSAwKSB7CisgICAgICAgIFNQ
SUNFX0VSUk9SKCJGYWlsZWQgdG8gbG9jayBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCwgbHVuKTsK
KyAgICAgICAgcmV0dXJuIHJjOworICAgIH0KKworICAgIFNQSUNFX0RFQlVHKCJMb2NrIE9LIGx1
bjolIiBHX0dVSU5UMzJfRk9STUFULCBsdW4pOworICAgIHJldHVybiAwOworfQorCitpbnQgY2Rf
dXNiX2J1bGtfbXNkX2xvYWQoVXNiQ2RCdWxrTXNkRGV2aWNlICpjZCwgdWludDMyX3QgbHVuLAor
ICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IENkU2NzaU1lZGlhUGFyYW1ldGVycyAqbWVk
aWFfcGFyYW1zKQoreworICAgIGludCByYzsKKworICAgIHJjID0gY2Rfc2NzaV9kZXZfbG9hZChj
ZC0+c2NzaV90YXJnZXQsIGx1biwgbWVkaWFfcGFyYW1zKTsKKyAgICBpZiAocmMgIT0gMCkgewor
ICAgICAgICBTUElDRV9FUlJPUigiRmFpbGVkIHRvIGxvYWQgbHVuOiUiIEdfR1VJTlQzMl9GT1JN
QVQsIGx1bik7CisgICAgICAgIHJldHVybiByYzsKKyAgICB9CisKKyAgICBTUElDRV9ERUJVRygi
TG9hZCBPSyBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCwgbHVuKTsKKyAgICByZXR1cm4gMDsKK30K
KworaW50IGNkX3VzYl9idWxrX21zZF9nZXRfaW5mbyhVc2JDZEJ1bGtNc2REZXZpY2UgKmNkLCB1
aW50MzJfdCBsdW4sIENkU2NzaURldmljZUluZm8gKmx1bl9pbmZvKQoreworICAgIGludCByYzsK
KworICAgIHJjID0gY2Rfc2NzaV9kZXZfZ2V0X2luZm8oY2QtPnNjc2lfdGFyZ2V0LCBsdW4sIGx1
bl9pbmZvKTsKKyAgICBpZiAocmMgIT0gMCkgeworICAgICAgICBTUElDRV9FUlJPUigiRmFpbGVk
IHRvIGdldCBpbmZvIGx1bjolIiBHX0dVSU5UMzJfRk9STUFULCBsdW4pOworICAgICAgICByZXR1
cm4gcmM7CisgICAgfQorCisgICAgcmV0dXJuIDA7Cit9CisKK2ludCBjZF91c2JfYnVsa19tc2Rf
dW5sb2FkKFVzYkNkQnVsa01zZERldmljZSAqY2QsIHVpbnQzMl90IGx1bikKK3sKKyAgICBpbnQg
cmM7CisKKyAgICByYyA9IGNkX3Njc2lfZGV2X3VubG9hZChjZC0+c2NzaV90YXJnZXQsIGx1bik7
CisgICAgaWYgKHJjICE9IDApIHsKKyAgICAgICAgU1BJQ0VfRVJST1IoIkZhaWxlZCB0byB1bmxv
YWQgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQsIGx1bik7CisgICAgICAgIHJldHVybiByYzsKKyAg
ICB9CisKKyAgICBTUElDRV9ERUJVRygiVW5sb2FkIE9LIGx1bjolIiBHX0dVSU5UMzJfRk9STUFU
LCBsdW4pOworICAgIHJldHVybiAwOworfQorCitpbnQgY2RfdXNiX2J1bGtfbXNkX3VucmVhbGl6
ZShVc2JDZEJ1bGtNc2REZXZpY2UgKmNkLCB1aW50MzJfdCBsdW4pCit7CisgICAgaW50IHJjOwor
CisgICAgcmMgPSBjZF9zY3NpX2Rldl91bnJlYWxpemUoY2QtPnNjc2lfdGFyZ2V0LCBsdW4pOwor
ICAgIGlmIChyYyAhPSAwKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJVbnJlYWxpemUgbHVuOiUi
IEdfR1VJTlQzMl9GT1JNQVQsIGx1bik7CisgICAgICAgIHJldHVybiByYzsKKyAgICB9CisKKyAg
ICBTUElDRV9ERUJVRygiVW5yZWFsaXplIGx1bjolIiBHX0dVSU5UMzJfRk9STUFULCBsdW4pOwor
ICAgIHJldHVybiAwOworfQorCit2b2lkIGNkX3VzYl9idWxrX21zZF9mcmVlKFVzYkNkQnVsa01z
ZERldmljZSAqY2QpCit7CisgICAgY2Rfc2NzaV90YXJnZXRfZnJlZShjZC0+c2NzaV90YXJnZXQp
OworICAgIGdfZnJlZShjZC0+ZGF0YV9idWYpOworICAgIGdfZnJlZShjZCk7CisKKyAgICBTUElD
RV9ERUJVRygiRnJlZSIpOworfQorCitpbnQgY2RfdXNiX2J1bGtfbXNkX3Jlc2V0KFVzYkNkQnVs
a01zZERldmljZSAqY2QpCit7CisgICAgY2Rfc2NzaV90YXJnZXRfcmVzZXQoY2QtPnNjc2lfdGFy
Z2V0KTsKKyAgICBjZF91c2JfYnVsa19tc2Rfc2V0X3N0YXRlKGNkLCBVU0JfQ0RfU1RBVEVfQ0JX
KTsKKworICAgIFNQSUNFX0RFQlVHKCJSZXNldCIpOworICAgIHJldHVybiAwOworfQorCitzdGF0
aWMgaW50IHBhcnNlX3VzYl9tc2RfY21kKFVzYkNkQnVsa01zZERldmljZSAqY2QsIHVpbnQ4X3Qg
KmJ1ZiwgdWludDMyX3QgY2J3X2xlbikKK3sKKyAgICBzdHJ1Y3QgVXNiQ2RDQlcgKmNidyA9IChz
dHJ1Y3QgVXNiQ2RDQlcgKilidWY7CisgICAgVXNiQ2RCdWxrTXNkUmVxdWVzdCAqdXNiX3JlcSA9
ICZjZC0+dXNiX3JlcTsKKyAgICBDZFNjc2lSZXF1ZXN0ICpzY3NpX3JlcSA9ICZ1c2JfcmVxLT5z
Y3NpX3JlcTsKKworICAgIGlmIChjYndfbGVuICE9IHNpemVvZigqY2J3KSkgeworICAgICAgICBT
UElDRV9FUlJPUigiQ01EOiBCYWQgQ0JXIHNpemU6JSIgR19HVUlOVDMyX0ZPUk1BVCwgY2J3X2xl
bik7CisgICAgICAgIHJldHVybiAtMTsKKyAgICB9CisgICAgaWYgKGxlMzJ0b2goY2J3LT5zaWcp
ICE9IDB4NDM0MjUzNTUpIHsgLyogTVNEIGNvbW1hbmQgc2lnbmF0dXJlICovCisgICAgICAgIFNQ
SUNFX0VSUk9SKCJDTUQ6IEJhZCBDQlcgc2lnbmF0dXJlOiUwOHgiLCBsZTMydG9oKGNidy0+c2ln
KSk7CisgICAgICAgIHJldHVybiAtMTsKKyAgICB9CisgICAgY29uc3QgdWludDhfdCBjbWRfbGVu
ID0gY2J3LT5jbWRfbGVuICYgMHgxRjsKKyAgICBpZiAoY21kX2xlbiA8IDEgfHwgY21kX2xlbiA+
IDE2KSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJDTUQ6IEJhZCBDQlcgY29tbWFuZCBsZW46JTA4
eCIsIGNtZF9sZW4pOworICAgICAgICByZXR1cm4gLTE7CisgICAgfQorCisgICAgdXNiX3JlcS0+
bHVuID0gY2J3LT5sdW47CisgICAgdXNiX3JlcS0+dXNiX3JlcV9sZW4gPSBsZTMydG9oKGNidy0+
ZXhwX2RhdGFfbGVuKTsKKworICAgIHVzYl9yZXEtPnNjc2lfaW5fbGVuID0gMDsgLyogbm8gZGF0
YSBmcm9tIHNjc2kgeWV0ICovCisgICAgdXNiX3JlcS0+eGZlcl9sZW4gPSAwOyAvKiBubyBidWxr
cyB0cmFuc2ZlcmVkIHlldCAqLworICAgIHVzYl9yZXEtPmJ1bGtfaW5fbGVuID0gMDsgLyogbm8g
YnVsay1pbiByZXF1ZXN0cyB5ZXQgKi8KKworICAgIGlmICh1c2JfcmVxLT51c2JfcmVxX2xlbiA9
PSAwKSB7CisgICAgICAgIGNkX3VzYl9idWxrX21zZF9zZXRfc3RhdGUoY2QsIFVTQl9DRF9TVEFU
RV9DU1cpOyAvKiBubyBkYXRhIC0gcmV0dXJuIHN0YXR1cyAqLworICAgICAgICBzY3NpX3JlcS0+
YnVmID0gTlVMTDsKKyAgICAgICAgc2NzaV9yZXEtPmJ1Zl9sZW4gPSAwOworICAgIH0gZWxzZSBp
ZiAoY2J3LT5mbGFncyAmIDB4ODApIHsKKyAgICAgICAgY2RfdXNiX2J1bGtfbXNkX3NldF9zdGF0
ZShjZCwgVVNCX0NEX1NUQVRFX0RBVEFJTik7IC8qIHJlYWQgY29tbWFuZCAqLworICAgICAgICBz
Y3NpX3JlcS0+YnVmID0gY2QtPmRhdGFfYnVmOworICAgICAgICBzY3NpX3JlcS0+YnVmX2xlbiA9
IGNkLT5kYXRhX2J1Zl9sZW47CisgICAgfSBlbHNlIHsKKyAgICAgICAgY2RfdXNiX2J1bGtfbXNk
X3NldF9zdGF0ZShjZCwgVVNCX0NEX1NUQVRFX0RBVEFPVVQpOyAvKiB3cml0ZSBjb21tYW5kICov
CisgICAgICAgIHNjc2lfcmVxLT5idWYgPSBOVUxMOworICAgICAgICBzY3NpX3JlcS0+YnVmX2xl
biA9IDA7CisgICAgfQorCisgICAgc2NzaV9yZXEtPmNkYl9sZW4gPSBjbWRfbGVuOworICAgIGdf
YXNzZXJ0KHNjc2lfcmVxLT5jZGJfbGVuIDw9IHNpemVvZihzY3NpX3JlcS0+Y2RiKSk7CisgICAg
bWVtY3B5KHNjc2lfcmVxLT5jZGIsIGNidy0+Y21kLCBzY3NpX3JlcS0+Y2RiX2xlbik7CisKKyAg
ICBzY3NpX3JlcS0+bHVuID0gdXNiX3JlcS0+bHVuOworCisgICAgU1BJQ0VfREVCVUcoIkNNRCBs
dW46JSIgR19HVUlOVDMyX0ZPUk1BVCAiIHRhZzolI3ggZmxhZ3M6JTA4eCAiCisgICAgICAgICJj
ZGJfbGVuOiUiIEdfR1VJTlQzMl9GT1JNQVQgIiByZXFfbGVuOiUiIEdfR1VJTlQzMl9GT1JNQVQs
CisgICAgICAgIHVzYl9yZXEtPmx1biwgbGUzMnRvaChjYnctPnRhZyksIGNidy0+ZmxhZ3MsCisg
ICAgICAgIHNjc2lfcmVxLT5jZGJfbGVuLCB1c2JfcmVxLT51c2JfcmVxX2xlbik7CisKKyAgICAv
KiBwcmVwYXJlIHN0YXR1cyAtIENTVyAqLworICAgIHVzYl9yZXEtPmNzdy5zaWcgPSBodG9sZTMy
KDB4NTM0MjUzNTUpOworICAgIHVzYl9yZXEtPmNzdy50YWcgPSBjYnctPnRhZzsKKyAgICB1c2Jf
cmVxLT5jc3cucmVzaWR1ZSA9IDA7CisgICAgdXNiX3JlcS0+Y3N3LnN0YXR1cyA9ICh1aW50OF90
KVVTQl9NU0RfU1RBVFVTX0dPT0Q7CisKKyAgICByZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQg
dXNiX2NkX2NtZF9kb25lKFVzYkNkQnVsa01zZERldmljZSAqY2QpCit7CisgICAgVXNiQ2RCdWxr
TXNkUmVxdWVzdCAqdXNiX3JlcSA9ICZjZC0+dXNiX3JlcTsKKyAgICBDZFNjc2lSZXF1ZXN0ICpz
Y3NpX3JlcSA9ICZ1c2JfcmVxLT5zY3NpX3JlcTsKKworICAgIGNkX3VzYl9idWxrX21zZF9zZXRf
c3RhdGUoY2QsIFVTQl9DRF9TVEFURV9DQlcpOyAvKiBDb21tYW5kIG5leHQgKi8KKyAgICBjZF9z
Y3NpX2Rldl9yZXF1ZXN0X3JlbGVhc2UoY2QtPnNjc2lfdGFyZ2V0LCBzY3NpX3JlcSk7Cit9CisK
K3N0YXRpYyB2b2lkIHVzYl9jZF9zZW5kX3N0YXR1cyhVc2JDZEJ1bGtNc2REZXZpY2UgKmNkKQor
eworICAgIFVzYkNkQnVsa01zZFJlcXVlc3QgKnVzYl9yZXEgPSAmY2QtPnVzYl9yZXE7CisKKyAg
ICBTUElDRV9ERUJVRygiQ29tbWFuZCBDU1cgdGFnOjB4JXggbXNkX3N0YXR1czolZCBsZW46JSIg
R19HVUlOVDY0X0ZPUk1BVCwKKyAgICAgICAgICAgICAgICBsZTMydG9oKHVzYl9yZXEtPmNzdy50
YWcpLCAoaW50KXVzYl9yZXEtPmNzdy5zdGF0dXMsIHNpemVvZih1c2JfcmVxLT5jc3cpKTsKKwor
ICAgIHVzYl9jZF9jbWRfZG9uZShjZCk7CisKKyAgICBnX2Fzc2VydCh1c2JfcmVxLT5jc3cuc2ln
ID09IGh0b2xlMzIoMHg1MzQyNTM1NSkpOworICAgIGNkX3VzYl9idWxrX21zZF9yZWFkX2NvbXBs
ZXRlKGNkLT51c2JfdXNlcl9kYXRhLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICh1aW50OF90ICopJnVzYl9yZXEtPmNzdywgc2l6ZW9mKHVzYl9yZXEtPmNzdyksCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgQlVMS19TVEFUVVNfR09PRCk7Cit9CisKK3N0YXRp
YyB2b2lkIHVzYl9jZF9zZW5kX2NhbmNlbGVkKFVzYkNkQnVsa01zZERldmljZSAqY2QpCit7Cisg
ICAgVXNiQ2RCdWxrTXNkUmVxdWVzdCAqdXNiX3JlcSA9ICZjZC0+dXNiX3JlcTsKKworICAgIFNQ
SUNFX0RFQlVHKCJDYW5jZWxlZCBjbWQgdGFnOjB4JXgsIGxlbjolIiBHX0dVSU5UNjRfRk9STUFU
LAorICAgICAgICAgICAgICAgIGxlMzJ0b2godXNiX3JlcS0+Y3N3LnRhZyksIHNpemVvZih1c2Jf
cmVxLT5jc3cpKTsKKworICAgIHVzYl9jZF9jbWRfZG9uZShjZCk7CisKKyAgICBjZF91c2JfYnVs
a19tc2RfcmVhZF9jb21wbGV0ZShjZC0+dXNiX3VzZXJfZGF0YSwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBOVUxMLCAwLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIEJVTEtfU1RBVFVTX0NBTkNFTEVEKTsKK30KKworc3RhdGljIHZvaWQgdXNiX2NkX3NlbmRf
ZGF0YV9pbihVc2JDZEJ1bGtNc2REZXZpY2UgKmNkLCB1aW50MzJfdCBtYXhfbGVuKQoreworICAg
IFVzYkNkQnVsa01zZFJlcXVlc3QgKnVzYl9yZXEgPSAmY2QtPnVzYl9yZXE7CisgICAgQ2RTY3Np
UmVxdWVzdCAqc2NzaV9yZXEgPSAmdXNiX3JlcS0+c2NzaV9yZXE7CisgICAgdWludDhfdCAqYnVm
ID0gKCh1aW50OF90ICopc2NzaV9yZXEtPmJ1ZikgKyB1c2JfcmVxLT54ZmVyX2xlbjsKKyAgICB1
aW50MzJfdCBhdmFpbF9sZW4gPSB1c2JfcmVxLT5zY3NpX2luX2xlbiAtIHVzYl9yZXEtPnhmZXJf
bGVuOworICAgIHVpbnQzMl90IHNlbmRfbGVuID0gTUlOKGF2YWlsX2xlbiwgbWF4X2xlbik7CisK
KyAgICBTUElDRV9ERUJVRygiRGF0YS1pbiBjbWQgdGFnIDB4JXgsIHJlbWFpbnMgJSIgR19HVUlO
VDMyX0ZPUk1BVAorICAgICAgICAgICAgICAgICIsIHJlcXVlc3RlZCAlIiBHX0dVSU5UMzJfRk9S
TUFUICIsIHNlbmQgJSIgR19HVUlOVDMyX0ZPUk1BVCwKKyAgICAgICAgICAgICAgICB1c2JfcmVx
LT5jc3cudGFnLCBhdmFpbF9sZW4sIG1heF9sZW4sIHNlbmRfbGVuKTsKKworICAgIGdfYXNzZXJ0
KG1heF9sZW4gPD0gdXNiX3JlcS0+dXNiX3JlcV9sZW4pOworCisgICAgY2RfdXNiX2J1bGtfbXNk
X3JlYWRfY29tcGxldGUoY2QtPnVzYl91c2VyX2RhdGEsCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgYnVmLCBzZW5kX2xlbiwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBCVUxLX1NUQVRVU19HT09EKTsKKworICAgIGlmIChzY3NpX3JlcS0+c3RhdHVzID09IEdP
T0QpIHsKKyAgICAgICAgdXNiX3JlcS0+eGZlcl9sZW4gKz0gc2VuZF9sZW47CisgICAgICAgIGlm
ICh1c2JfcmVxLT54ZmVyX2xlbiA9PSB1c2JfcmVxLT5zY3NpX2luX2xlbikgeworICAgICAgICAg
ICAgLyogYWxsIGRhdGEgZm9yIHRoaXMgYnVsayBoYXMgYmVlbiB0cmFuc2ZlcnJlZCAqLworICAg
ICAgICAgICAgaWYgKHVzYl9yZXEtPnNjc2lfaW5fbGVuID09IHVzYl9yZXEtPnVzYl9yZXFfbGVu
IHx8IC8qIHJlcSBmdWxseSBzYXRpc2ZpZWQgKi8KKyAgICAgICAgICAgICAgICBzZW5kX2xlbiA8
IG1heF9sZW4pIHsgLyogcGFydGlhbCBidWxrIC0gbm8gbW9yZSBkYXRhICovCisgICAgICAgICAg
ICAgICAgY2RfdXNiX2J1bGtfbXNkX3NldF9zdGF0ZShjZCwgVVNCX0NEX1NUQVRFX0NTVyk7Cisg
ICAgICAgICAgICB9IGVsc2UgeworICAgICAgICAgICAgICAgIC8qIHBhcnRpYWwgY21kIGRhdGEg
ZnVsbGZpbGxlZCBlbnRpcmUgdnVsay1pbiByZXF1ZXN0ICovCisgICAgICAgICAgICAgICAgY2Rf
dXNiX2J1bGtfbXNkX3NldF9zdGF0ZShjZCwgVVNCX0NEX1NUQVRFX1pFUk9fREFUQUlOKTsKKyAg
ICAgICAgICAgIH0KKyAgICAgICAgfQorICAgIH0gZWxzZSB7IC8qIGNtZCBmYWlsZWQgLSBubyBt
b3JlIGRhdGEgKi8KKyAgICAgICAgY2RfdXNiX2J1bGtfbXNkX3NldF9zdGF0ZShjZCwgVVNCX0NE
X1NUQVRFX0NTVyk7CisgICAgfQorfQorCitpbnQgY2RfdXNiX2J1bGtfbXNkX3JlYWQoVXNiQ2RC
dWxrTXNkRGV2aWNlICpjZCwgdWludDMyX3QgbWF4X2xlbikKK3sKKyAgICBVc2JDZEJ1bGtNc2RS
ZXF1ZXN0ICp1c2JfcmVxID0gJmNkLT51c2JfcmVxOworICAgIENkU2NzaVJlcXVlc3QgKnNjc2lf
cmVxID0gJnVzYl9yZXEtPnNjc2lfcmVxOworCisgICAgU1BJQ0VfREVCVUcoIm1zZF9yZWFkLCBz
dGF0ZTogJXMsIGxlbiAlIiBHX0dVSU5UMzJfRk9STUFULAorICAgICAgICAgICAgICAgIHVzYl9j
ZF9zdGF0ZV9zdHIoY2QtPnN0YXRlKSwgbWF4X2xlbik7CisKKyAgICBzd2l0Y2ggKGNkLT5zdGF0
ZSkgeworICAgIGNhc2UgVVNCX0NEX1NUQVRFX0NTVzogLyogQ29tbWFuZCBTdGF0dXMgKi8KKyAg
ICAgICAgaWYgKG1heF9sZW4gPCAxMykgeworICAgICAgICAgICAgZ290byBmYWlsOworICAgICAg
ICB9CisgICAgICAgIGlmIChjZF9zY3NpX2dldF9yZXFfc3RhdGUoc2NzaV9yZXEpID09IFNDU0lf
UkVRX0NPTVBMRVRFKSB7CisgICAgICAgICAgICB1c2JfY2Rfc2VuZF9zdGF0dXMoY2QpOworICAg
ICAgICB9IGVsc2UgeworICAgICAgICAgICAgdXNiX3JlcS0+YnVsa19pbl9sZW4gKz0gbWF4X2xl
bjsKKyAgICAgICAgICAgIFNQSUNFX0RFQlVHKCJtc2RfcmVhZCBDU1csIHJlcSBpbmNvbXBsZXRl
LCBhZGRlZCBsZW4gJSIgR19HVUlOVDMyX0ZPUk1BVAorICAgICAgICAgICAgICAgICAgICAgICAg
IiBzYXZlZCBsZW4gJSIgR19HVUlOVDMyX0ZPUk1BVCwKKyAgICAgICAgICAgICAgICAgICAgICAg
IG1heF9sZW4sIHVzYl9yZXEtPmJ1bGtfaW5fbGVuKTsKKyAgICAgICAgfQorICAgICAgICBicmVh
azsKKworICAgIGNhc2UgVVNCX0NEX1NUQVRFX0RBVEFJTjogLyogQnVsayBEYXRhLUlOICovCisg
ICAgICAgIGlmIChjZF9zY3NpX2dldF9yZXFfc3RhdGUoc2NzaV9yZXEpID09IFNDU0lfUkVRX0NP
TVBMRVRFKSB7CisgICAgICAgICAgICB1c2JfY2Rfc2VuZF9kYXRhX2luKGNkLCBtYXhfbGVuKTsK
KyAgICAgICAgfSBlbHNlIHsKKyAgICAgICAgICAgIHVzYl9yZXEtPmJ1bGtfaW5fbGVuICs9IG1h
eF9sZW47CisgICAgICAgICAgICBTUElDRV9ERUJVRygibXNkX3JlYWQgREFUQUlOLCByZXEgaW5j
b21wbGV0ZSwgYWRkZWQgbGVuICUiIEdfR1VJTlQzMl9GT1JNQVQKKyAgICAgICAgICAgICAgICAg
ICAgICAgICIgc2F2ZWQgbGVuICUiIEdfR1VJTlQzMl9GT1JNQVQsCisgICAgICAgICAgICAgICAg
ICAgICAgICBtYXhfbGVuLCB1c2JfcmVxLT5idWxrX2luX2xlbik7CisgICAgICAgIH0KKyAgICAg
ICAgYnJlYWs7CisKKyAgICBjYXNlIFVTQl9DRF9TVEFURV9aRVJPX0RBVEFJTjoKKyAgICAgICAg
Y2RfdXNiX2J1bGtfbXNkX3JlYWRfY29tcGxldGUoY2QtPnVzYl91c2VyX2RhdGEsCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5VTEwsIDAsCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIEJVTEtfU1RBVFVTX0dPT0QpOworICAgICAgICBjZF91c2Jf
YnVsa19tc2Rfc2V0X3N0YXRlKGNkLCBVU0JfQ0RfU1RBVEVfQ1NXKTsgLyogU3RhdHVzIG5leHQg
Ki8KKyAgICAgICAgYnJlYWs7CisKKyAgICBkZWZhdWx0OgorICAgICAgICBTUElDRV9FUlJPUigi
VW5leHBlY3RlZCByZWFkIHN0YXRlOiAlcywgbGVuICUiIEdfR1VJTlQzMl9GT1JNQVQsCisgICAg
ICAgICAgICAgICAgICAgIHVzYl9jZF9zdGF0ZV9zdHIoY2QtPnN0YXRlKSwgbWF4X2xlbik7Cisg
ICAgICAgIGdvdG8gZmFpbDsKKyAgICB9CisgICAgcmV0dXJuIDA7CisKK2ZhaWw6CisgICAgcmV0
dXJuIC0xOworfQorCit2b2lkIGNkX3Njc2lfZGV2X3JlcXVlc3RfY29tcGxldGUodm9pZCAqdGFy
Z2V0X3VzZXJfZGF0YSwgQ2RTY3NpUmVxdWVzdCAqc2NzaV9yZXEpCit7CisgICAgVXNiQ2RCdWxr
TXNkRGV2aWNlICpjZCA9IChVc2JDZEJ1bGtNc2REZXZpY2UgKil0YXJnZXRfdXNlcl9kYXRhOwor
ICAgIFVzYkNkQnVsa01zZFJlcXVlc3QgKnVzYl9yZXEgPSAmY2QtPnVzYl9yZXE7CisKKyAgICBn
X2Fzc2VydChzY3NpX3JlcSA9PSAmdXNiX3JlcS0+c2NzaV9yZXEpOworCisgICAgaWYgKHNjc2lf
cmVxLT5yZXFfc3RhdGUgPT0gU0NTSV9SRVFfQ09NUExFVEUpIHsKKworICAgICAgICB1c2JfcmVx
LT5zY3NpX2luX2xlbiA9IChzY3NpX3JlcS0+aW5fbGVuIDw9IHVzYl9yZXEtPnVzYl9yZXFfbGVu
KSA/CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjc2lfcmVxLT5pbl9sZW4gOiB1
c2JfcmVxLT51c2JfcmVxX2xlbjsKKworICAgICAgICAvKiBwcmVwYXJlIENTVyAqLworICAgICAg
ICBpZiAodXNiX3JlcS0+dXNiX3JlcV9sZW4gPiB1c2JfcmVxLT5zY3NpX2luX2xlbikgeworICAg
ICAgICAgICAgdXNiX3JlcS0+Y3N3LnJlc2lkdWUgPSBodG9sZTMyKHVzYl9yZXEtPnVzYl9yZXFf
bGVuIC0gdXNiX3JlcS0+c2NzaV9pbl9sZW4pOworICAgICAgICB9CisgICAgICAgIGlmIChzY3Np
X3JlcS0+c3RhdHVzICE9IEdPT0QpIHsKKyAgICAgICAgICAgIHVzYl9yZXEtPmNzdy5zdGF0dXMg
PSAodWludDhfdClVU0JfTVNEX1NUQVRVU19GQUlMRUQ7CisgICAgICAgIH0KKworICAgICAgICBp
ZiAodXNiX3JlcS0+YnVsa19pbl9sZW4pIHsKKyAgICAgICAgICAgIC8qIGJ1bGstaW4gcmVxdWVz
dCBhcnJpdmVkIHdoaWxlIHNjc2kgd2FzIHN0aWxsIHJ1bm5pbmcgKi8KKyAgICAgICAgICAgIGlm
IChjZC0+c3RhdGUgPT0gVVNCX0NEX1NUQVRFX0RBVEFJTikgeworICAgICAgICAgICAgICAgIHVz
Yl9jZF9zZW5kX2RhdGFfaW4oY2QsIHVzYl9yZXEtPmJ1bGtfaW5fbGVuKTsKKyAgICAgICAgICAg
IH0gZWxzZSBpZiAoY2QtPnN0YXRlID09IFVTQl9DRF9TVEFURV9DU1cpIHsKKyAgICAgICAgICAg
ICAgICB1c2JfY2Rfc2VuZF9zdGF0dXMoY2QpOworICAgICAgICAgICAgfQorICAgICAgICAgICAg
dXNiX3JlcS0+YnVsa19pbl9sZW4gPSAwOworICAgICAgICB9CisgICAgfSBlbHNlIGlmIChzY3Np
X3JlcS0+cmVxX3N0YXRlID09IFNDU0lfUkVRX0NBTkNFTEVEKSB7CisgICAgICAgIHVzYl9jZF9z
ZW5kX2NhbmNlbGVkKGNkKTsKKyAgICB9IGVsc2UgeworICAgICAgICBnX2Fzc2VydChzY3NpX3Jl
cS0+cmVxX3N0YXRlID09IFNDU0lfUkVRX0RJU1BPU0VEKTsKKyAgICAgICAgU1BJQ0VfREVCVUco
IkRpc3Bvc2VkIGNtZCB0YWc6MHgleCwgbGVuOiUiIEdfR1VJTlQ2NF9GT1JNQVQsCisgICAgICAg
ICAgICAgICAgbGUzMnRvaCh1c2JfcmVxLT5jc3cudGFnKSwgc2l6ZW9mKHVzYl9yZXEtPmNzdykp
OworICAgICAgICB1c2JfY2RfY21kX2RvbmUoY2QpOworICAgIH0KK30KKworaW50IGNkX3VzYl9i
dWxrX21zZF9jYW5jZWxfcmVhZChVc2JDZEJ1bGtNc2REZXZpY2UgKmNkKQoreworICAgIFVzYkNk
QnVsa01zZFJlcXVlc3QgKnVzYl9yZXEgPSAmY2QtPnVzYl9yZXE7CisgICAgQ2RTY3NpUmVxdWVz
dCAqc2NzaV9yZXEgPSAmdXNiX3JlcS0+c2NzaV9yZXE7CisKKyAgICBjZF9zY3NpX2Rldl9yZXF1
ZXN0X2NhbmNlbChjZC0+c2NzaV90YXJnZXQsIHNjc2lfcmVxKTsKKyAgICByZXR1cm4gMDsKK30K
KworaW50IGNkX3VzYl9idWxrX21zZF93cml0ZShVc2JDZEJ1bGtNc2REZXZpY2UgKmNkLCB1aW50
OF90ICpidWZfb3V0LCB1aW50MzJfdCBidWZfb3V0X2xlbikKK3sKKyAgICBzd2l0Y2ggKGNkLT5z
dGF0ZSkgeworICAgIGNhc2UgVVNCX0NEX1NUQVRFX0NCVzogLyogQ29tbWFuZCBCbG9jayAqLwor
ICAgICAgICBwYXJzZV91c2JfbXNkX2NtZChjZCwgYnVmX291dCwgYnVmX291dF9sZW4pOworICAg
ICAgICBpZiAoY2QtPnN0YXRlID09IFVTQl9DRF9TVEFURV9EQVRBSU4gfHwgY2QtPnN0YXRlID09
IFVTQl9DRF9TVEFURV9DU1cpIHsKKyAgICAgICAgICAgIGNkX3Njc2lfZGV2X3JlcXVlc3Rfc3Vi
bWl0KGNkLT5zY3NpX3RhcmdldCwgJmNkLT51c2JfcmVxLnNjc2lfcmVxKTsKKyAgICAgICAgfQor
ICAgICAgICBicmVhazsKKyAgICBjYXNlIFVTQl9DRF9TVEFURV9EQVRBT1VUOiAvKiBEYXRhLU91
dCBmb3IgYSBXcml0ZSBjbWQgKi8KKyAgICAgICAgY2QtPnVzYl9yZXEuc2NzaV9yZXEuYnVmID0g
YnVmX291dDsKKyAgICAgICAgY2QtPnVzYl9yZXEuc2NzaV9yZXEuYnVmX2xlbiA9IGJ1Zl9vdXRf
bGVuOworICAgICAgICBjZF9zY3NpX2Rldl9yZXF1ZXN0X3N1Ym1pdChjZC0+c2NzaV90YXJnZXQs
ICZjZC0+dXNiX3JlcS5zY3NpX3JlcSk7CisgICAgICAgIGNkX3VzYl9idWxrX21zZF9zZXRfc3Rh
dGUoY2QsIFVTQl9DRF9TVEFURV9DU1cpOyAvKiBTdGF0dXMgbmV4dCAqLworICAgICAgICBicmVh
azsKKyAgICBkZWZhdWx0OgorICAgICAgICBTUElDRV9ERUJVRygiVW5leHBlY3RlZCB3cml0ZSBz
dGF0ZTogJXMsIGxlbiAlIiBHX0dVSU5UMzJfRk9STUFULAorICAgICAgICAgICAgICAgICAgICB1
c2JfY2Rfc3RhdGVfc3RyKGNkLT5zdGF0ZSksIGJ1Zl9vdXRfbGVuKTsKKyAgICAgICAgZ290byBm
YWlsOworICAgIH0KKyAgICByZXR1cm4gMDsKKworZmFpbDoKKyAgICByZXR1cm4gLTE7Cit9CisK
K3ZvaWQgY2Rfc2NzaV9kZXZfcmVzZXRfY29tcGxldGUodm9pZCAqdGFyZ2V0X3VzZXJfZGF0YSwg
dWludDMyX3QgbHVuKQoreworICAgIFVzYkNkQnVsa01zZERldmljZSAqY2QgPSAoVXNiQ2RCdWxr
TXNkRGV2aWNlICopdGFyZ2V0X3VzZXJfZGF0YTsKKworICAgIGlmIChjZC0+c3RhdGUgPT0gVVNC
X0NEX1NUQVRFX0RFVklDRV9SRVNFVCkgeworICAgICAgICBjZF91c2JfYnVsa19tc2Rfc2V0X3N0
YXRlKGNkLCBVU0JfQ0RfU1RBVEVfQ0JXKTsKKyAgICAgICAgY2RfdXNiX2J1bGtfbXNkX3Jlc2V0
X2NvbXBsZXRlKGNkLT51c2JfdXNlcl9kYXRhLCAwKTsKKyAgICB9Cit9CisKK3ZvaWQgY2Rfc2Nz
aV90YXJnZXRfcmVzZXRfY29tcGxldGUodm9pZCAqdGFyZ2V0X3VzZXJfZGF0YSkKK3sKKyAgICBV
c2JDZEJ1bGtNc2REZXZpY2UgKmNkID0gKFVzYkNkQnVsa01zZERldmljZSAqKXRhcmdldF91c2Vy
X2RhdGE7CisgICAgY2RfdXNiX2J1bGtfbXNkX3NldF9zdGF0ZShjZCwgVVNCX0NEX1NUQVRFX0lO
SVQpOworfQorCit2b2lkIGNkX3Njc2lfZGV2X2NoYW5nZWQodm9pZCAqdGFyZ2V0X3VzZXJfZGF0
YSwgdWludDMyX3QgbHVuKQoreworICAgIFVzYkNkQnVsa01zZERldmljZSAqY2QgPSAoVXNiQ2RC
dWxrTXNkRGV2aWNlICopdGFyZ2V0X3VzZXJfZGF0YTsKKyAgICBTUElDRV9ERUJVRygiRGV2aWNl
IGNoYW5nZWQsIHN0YXRlOiAlcyBsdW46ICUiIEdfR1VJTlQzMl9GT1JNQVQsCisgICAgICAgICAg
ICAgICAgdXNiX2NkX3N0YXRlX3N0cihjZC0+c3RhdGUpLCBsdW4pOworICAgIGNkX3VzYl9idWxr
X21zZF9sdW5fY2hhbmdlZChjZC0+dXNiX3VzZXJfZGF0YSwgbHVuKTsKK30KKworI2VuZGlmIC8q
IFVTRV9VU0JSRURJUiAqLwpkaWZmIC0tZ2l0IGEvc3JjL2NkLXVzYi1idWxrLW1zZC5oIGIvc3Jj
L2NkLXVzYi1idWxrLW1zZC5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwLi40
OTJhNDliOAotLS0gL2Rldi9udWxsCisrKyBiL3NyYy9jZC11c2ItYnVsay1tc2QuaApAQCAtMCww
ICsxLDEzNCBAQAorLyogLSotIE1vZGU6IEM7IGMtYmFzaWMtb2Zmc2V0OiA0OyBpbmRlbnQtdGFi
cy1tb2RlOiBuaWwgLSotICovCisvKgorICAgIENvcHlyaWdodCAoQykgMjAxOCBSZWQgSGF0LCBJ
bmMuCisKKyAgICBSZWQgSGF0IEF1dGhvcnM6CisgICAgQWxleGFuZGVyIE5lemhpbnNreTxhbmV6
aGluc0ByZWRoYXQuY29tPgorCisgICAgVGhpcyBsaWJyYXJ5IGlzIGZyZWUgc29mdHdhcmU7IHlv
dSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vcgorICAgIG1vZGlmeSBpdCB1bmRlciB0aGUgdGVy
bXMgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKKyAgICBMaWNlbnNlIGFzIHB1Ymxp
c2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIKKyAgICB2ZXJzaW9u
IDIuMSBvZiB0aGUgTGljZW5zZSwgb3IgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lv
bi4KKworICAgIFRoaXMgbGlicmFyeSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0
IHdpbGwgYmUgdXNlZnVsLAorICAgIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBl
dmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCisgICAgTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5F
U1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZSBHTlUKKyAgICBMZXNzZXIgR2Vu
ZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgorCisgICAgWW91IHNob3VsZCBo
YXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYworICAg
IExpY2Vuc2UgYWxvbmcgd2l0aCB0aGlzIGxpYnJhcnk7IGlmIG5vdCwgc2VlIDxodHRwOi8vd3d3
LmdudS5vcmcvbGljZW5zZXMvPi4KKyovCisKKyNpZm5kZWYgU1BJQ0VfR1RLX0NEX1VTQl9CVUxL
X01TRF9IX18KKyNkZWZpbmUgU1BJQ0VfR1RLX0NEX1VTQl9CVUxLX01TRF9IX18KKworR19CRUdJ
Tl9ERUNMUworCisjaW5jbHVkZSA8Z2lvL2dpby5oPgorCisjaW5jbHVkZSAiY2Qtc2NzaS1kZXYt
cGFyYW1zLmgiCisKK3R5cGVkZWYgZW51bSBDZFVzYkJ1bGtTdGF0dXMgeworICAgIEJVTEtfU1RB
VFVTX0dPT0QgPSAwLAorICAgIEJVTEtfU1RBVFVTX0VSUk9SLAorICAgIEJVTEtfU1RBVFVTX0NB
TkNFTEVELAorICAgIEJVTEtfU1RBVFVTX1NUQUxMLAorfSBDZFVzYkJ1bGtTdGF0dXM7CisKK3R5
cGVkZWYgc3RydWN0IFVzYkNkQnVsa01zZERldmljZSBVc2JDZEJ1bGtNc2REZXZpY2U7CisKKy8q
IFVTQiBiYWNrZW5kIGNhbGxiYWNrcyAqLworCisvKiBjYWxsZWQgb24gY29tcGxldGVkIHJlYWQg
ZGF0YSBidWxrIHRyYW5zZmVyCisgKiB1c2VyX2RhdGEgLSB1c2VyX2RhdGEgaW4gdW5pdCBwYXJh
bWV0ZXJzIHN0cnVjdHVyZQorICogc3RhdHVzIC0gYnVsayBzdGF0dXMgY29kZQorICovCit2b2lk
IGNkX3VzYl9idWxrX21zZF9yZWFkX2NvbXBsZXRlKHZvaWQgKnVzZXJfZGF0YSwKKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDhfdCAqZGF0YSwgdWludDMyX3QgbGVuZ3Ro
LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDZFVzYkJ1bGtTdGF0dXMgc3Rh
dHVzKTsKKworLyogY2FsbGVkIHdoZW4gc3RhdGUgb2YgZGV2aWNlJ3MgdW5pdCBjaGFuZ2VkIHRv
IHNpZ25hbCBHVUkgY29tcG9uZW50CisgKiAgdXNlcl9kYXRhIC0gdXNlcl9kYXRhIGluIHVuaXQg
cGFyYW1ldGVycyBzdHJ1Y3R1cmUKKyAqLwordm9pZCBjZF91c2JfYnVsa19tc2RfbHVuX2NoYW5n
ZWQodm9pZCAqdXNlcl9kYXRhLCB1aW50MzJfdCBsdW4pOworCisvKiBjYWxsZWQgb24gY29tcGxl
dGVkIGRldmljZSByZXNldAorICogdXNlcl9kYXRhIC0gdXNlcl9kYXRhIGluIHVuaXQgcGFyYW1l
dGVycyBzdHJ1Y3R1cmUKKyAqIHN0YXR1cyAtIGVycm9yIGNvZGUKKyAqLwordm9pZCBjZF91c2Jf
YnVsa19tc2RfcmVzZXRfY29tcGxldGUodm9pZCAqdXNlcl9kYXRhLAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgaW50IHN0YXR1cyk7CisKKy8qIE1TRCBiYWNrZW5kIGFwaSAq
LworCisvKiBhbGxvY2F0ZSBuZXcgZGV2aWNlIGRlc2NyaXB0b3IgKi8KK1VzYkNkQnVsa01zZERl
dmljZSAqY2RfdXNiX2J1bGtfbXNkX2FsbG9jKHZvaWQgKnVzZXJfZGF0YSwgdWludDMyX3QgbWF4
X2x1bik7CisKKy8qIGZyZWUgZGV2aWNlIGRlc2NyaXB0b3IgKi8KK3ZvaWQgY2RfdXNiX2J1bGtf
bXNkX2ZyZWUoVXNiQ2RCdWxrTXNkRGV2aWNlICpkZXZpY2UpOworCisvKiBjb25maWd1cmUgYSBu
ZXcgTG9naWNhbCBVbml0IHRvIGJlIHJlcHJlc2VuIHRlZCBieSB0aGUgZGV2aWNlCisgKiAgcmV0
dXJuczogZXJyb3IgY29kZQorICovCitpbnQgY2RfdXNiX2J1bGtfbXNkX3JlYWxpemUoVXNiQ2RC
dWxrTXNkRGV2aWNlICpkZXZpY2UsIHVpbnQzMl90IGx1biwKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBjb25zdCBDZFNjc2lEZXZpY2VQYXJhbWV0ZXJzICpkZXZfcGFyYW1zKTsKKworLyog
bG9jayB0aGUgZGV2aWNlLCBwcmV2ZW50IHVubG9hZGluZworICogcmV0dXJuczogZXJyb3IgY29k
ZQorICovCitpbnQgY2RfdXNiX2J1bGtfbXNkX2xvY2soVXNiQ2RCdWxrTXNkRGV2aWNlICpkZXZp
Y2UsIHVpbnQzMl90IGx1biwgZ2Jvb2xlYW4gbG9jayk7CisKKy8qIGxvYWQgbmV3IG1lZGlhLCBp
ZiBhbHJlYWR5IGxvYWRlZCwgc2ltdWxhdGUgbWVkaWEgY2hhbmdlCisgKiByZXR1cm5zOiBlcnJv
ciBjb2RlCisgKi8KK2ludCBjZF91c2JfYnVsa19tc2RfbG9hZChVc2JDZEJ1bGtNc2REZXZpY2Ug
KmRldmljZSwgdWludDMyX3QgbHVuLAorICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IENk
U2NzaU1lZGlhUGFyYW1ldGVycyAqbWVkaWFfcGFyYW1zKTsKKworLyogcXVlcnkgdW5pdCBwYXJh
bWV0ZXJzIGFuZCBzdGF0dXMKKyAqIHJldHVybnM6IGVycm9yIGNvZGUKKyAqLworaW50IGNkX3Vz
Yl9idWxrX21zZF9nZXRfaW5mbyhVc2JDZEJ1bGtNc2REZXZpY2UgKmRldmljZSwgdWludDMyX3Qg
bHVuLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDZFNjc2lEZXZpY2VJbmZvICpsdW5f
aW5mbyk7CisKKy8qIHVubG9hZCB0aGUgbWVkaWEKKyAqIHJldHVybnM6IGVycm9yIGNvZGUKKyAq
LworaW50IGNkX3VzYl9idWxrX21zZF91bmxvYWQoVXNiQ2RCdWxrTXNkRGV2aWNlICpkZXZpY2Us
IHVpbnQzMl90IGx1bik7CisKKy8qIGRldGFjaCBhIExvZ2ljYWwgVW5pdAorICogcmV0dXJuczog
ZXJyb3IgY29kZQorICovCitpbnQgY2RfdXNiX2J1bGtfbXNkX3VucmVhbGl6ZShVc2JDZEJ1bGtN
c2REZXZpY2UgKmRldmljZSwgdWludDMyX3QgbHVuKTsKKworLyogcmVzZXQgdGhlIGRldmljZSBp
bnN0YW5jZTsgY2FuY2VsIGFsbCBJTyBvcHMsIHJlc2V0IHN0YXRlCisgKiByZXR1cm5zOiBlcnJv
ciBjb2RlCisgKi8KK2ludCBjZF91c2JfYnVsa19tc2RfcmVzZXQoVXNiQ2RCdWxrTXNkRGV2aWNl
ICpkZXZpY2UpOworCisKKy8qIHBlcmZvcm0gYSB3cml0ZSBkYXRhIGJ1bGsgdHJhbnNmZXIKKyAq
IGRhdGFfbGVuIC0gbGVuZ3RoIG9mIGF2YWlsYWJsZSBkYXRhIHRvIHdyaXRlCisgKiByZXR1cm5z
OiBlcnJvciBjb2RlCisgKi8KK2ludCBjZF91c2JfYnVsa19tc2Rfd3JpdGUoVXNiQ2RCdWxrTXNk
RGV2aWNlKmRldmljZSwgdWludDhfdCAqYnVmLCB1aW50MzJfdCBkYXRhX2xlbik7CisKKworLyog
cGVyZm9ybSBhIHJlYWQgZGF0YSBidWxrIHRyYW5zZmVyCisgKiBtYXhfbGVuIC0gbGVuZ3RoIG9m
IGF2YWlsYWJsZSBidWZmZXIgdG8gZmlsbAorICogSWYgZGF0YSBhdmFpbGFibGUgaW1tZWRpYXRl
bHksIHNob3VsZCBjYWxsIGNkX3VzYl9idWxrX21zZF9yZWFkX2NvbXBsZXRlKCkKKyAqICAgYW5k
IHJldHVybiBzdWNjZXNzCisgKiBJZiBmYXRhbCBlcnJvciBkZXRlY3RlZCBpbW1lZGlhdGVseSwg
c2hvdWxkIGNhbGwgY2RfdXNiX2J1bGtfbXNkX3JlYWRfY29tcGxldGUoKQorICogICB3aXRoIGVy
cm9yIGNvZGUgYW5kIHJldHVybiBzdWNjZXNzCisgKgorICogcmV0dXJuczogMCAtIHN1Y2Nlc3Ms
IC0xIC0gZXJyb3IKKyAqLworaW50IGNkX3VzYl9idWxrX21zZF9yZWFkKFVzYkNkQnVsa01zZERl
dmljZSAqZGV2aWNlLCB1aW50MzJfdCBtYXhfbGVuKTsKKworLyogY2FuY2VscyBwZW5kaW5nIHJl
YWQgZGF0YSBidWxrIHRyYW5zZmVyCisgKiByZXR1cm5zOiBlcnJvciBjb2RlCisgKi8KK2ludCBj
ZF91c2JfYnVsa19tc2RfY2FuY2VsX3JlYWQoVXNiQ2RCdWxrTXNkRGV2aWNlICpkZXZpY2UpOwor
CitHX0VORF9ERUNMUworCisjZW5kaWYgLyogU1BJQ0VfR1RLX0NEX1VTQl9CVUxLX01TRF9IX18g
Ki8KZGlmZiAtLWdpdCBhL3NyYy9zY3NpLWNvbnN0YW50cy5oIGIvc3JjL3Njc2ktY29uc3RhbnRz
LmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAuLmNmOGE4ODI1Ci0tLSAvZGV2
L251bGwKKysrIGIvc3JjL3Njc2ktY29uc3RhbnRzLmgKQEAgLTAsMCArMSwzMjQgQEAKKy8qIC0q
LSBNb2RlOiBDOyBjLWJhc2ljLW9mZnNldDogNDsgaW5kZW50LXRhYnMtbW9kZTogbmlsIC0qLSAq
LworLyoKKyAgIENvcHlyaWdodCAoQykgMjAxOCBSZWQgSGF0LCBJbmMuCisgICBCYXNlZCBvbiB0
aGUgR0xpYiBoZWFkZXIKKworICAgVGhpcyBsaWJyYXJ5IGlzIGZyZWUgc29mdHdhcmU7IHlvdSBj
YW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vcgorICAgbW9kaWZ5IGl0IHVuZGVyIHRoZSB0ZXJtcyBv
ZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYworICAgTGljZW5zZSBhcyBwdWJsaXNoZWQg
YnkgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyCisgICB2ZXJzaW9uIDIuMSBv
ZiB0aGUgTGljZW5zZSwgb3IgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4KKwor
ICAgVGhpcyBsaWJyYXJ5IGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBi
ZSB1c2VmdWwsCisgICBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUg
aW1wbGllZCB3YXJyYW50eSBvZgorICAgTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEg
UEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZSBHTlUKKyAgIExlc3NlciBHZW5lcmFsIFB1Ymxp
YyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCisKKyAgIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZl
ZCBhIGNvcHkgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKKyAgIExpY2Vuc2UgYWxv
bmcgd2l0aCB0aGlzIGxpYnJhcnk7IGlmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGlj
ZW5zZXMvPi4KKyovCisKKyNpZm5kZWYgU1BJQ0VfR1RLX1NDU0lfQ09OU1RBTlRTX0hfXworI2Rl
ZmluZSBTUElDRV9HVEtfU0NTSV9DT05TVEFOVFNfSF9fCisKKy8qCisgKiAgICAgIFNDU0kgb3Bj
b2RlcworICovCisKKyNkZWZpbmUgVEVTVF9VTklUX1JFQURZICAgICAgIDB4MDAKKyNkZWZpbmUg
UkVXSU5EICAgICAgICAgICAgICAgIDB4MDEKKyNkZWZpbmUgUkVRVUVTVF9TRU5TRSAgICAgICAg
IDB4MDMKKyNkZWZpbmUgRk9STUFUX1VOSVQgICAgICAgICAgIDB4MDQKKyNkZWZpbmUgUkVBRF9C
TE9DS19MSU1JVFMgICAgIDB4MDUKKyNkZWZpbmUgSU5JVElBTElaRV9FTEVNRU5UX1NUQVRVUyAw
eDA3CisjZGVmaW5lIFJFQVNTSUdOX0JMT0NLU18gICAgICAweDA3CisjZGVmaW5lIFJFQURfNiAg
ICAgICAgICAgICAgICAweDA4CisjZGVmaW5lIFdSSVRFXzYgICAgICAgICAgICAgICAweDBhCisj
ZGVmaW5lIFNFVF9DQVBBQ0lUWSAgICAgICAgICAweDBiCisjZGVmaW5lIFJFQURfUkVWRVJTRSAg
ICAgICAgICAweDBmCisjZGVmaW5lIFdSSVRFX0ZJTEVNQVJLUyAgICAgICAweDEwCisjZGVmaW5l
IFNQQUNFICAgICAgICAgICAgICAgICAweDExCisjZGVmaW5lIElOUVVJUlkgICAgICAgICAgICAg
ICAweDEyCisjZGVmaW5lIFJFQ09WRVJfQlVGRkVSRURfREFUQSAweDE0CisjZGVmaW5lIE1PREVf
U0VMRUNUICAgICAgICAgICAweDE1CisjZGVmaW5lIFJFU0VSVkUgICAgICAgICAgICAgICAweDE2
CisjZGVmaW5lIFJFTEVBU0UgICAgICAgICAgICAgICAweDE3CisjZGVmaW5lIENPUFkgICAgICAg
ICAgICAgICAgICAweDE4CisjZGVmaW5lIEVSQVNFICAgICAgICAgICAgICAgICAweDE5CisjZGVm
aW5lIE1PREVfU0VOU0UgICAgICAgICAgICAweDFhCisjZGVmaW5lIExPQURfVU5MT0FEICAgICAg
ICAgICAweDFiCisjZGVmaW5lIFNDQU4gICAgICAgICAgICAgICAgICAweDFiCisjZGVmaW5lIFNU
QVJUX1NUT1AgICAgICAgICAgICAweDFiCisjZGVmaW5lIFJFQ0VJVkVfRElBR05PU1RJQyAgICAw
eDFjCisjZGVmaW5lIFNFTkRfRElBR05PU1RJQyAgICAgICAweDFkCisjZGVmaW5lIEFMTE9XX01F
RElVTV9SRU1PVkFMICAweDFlCisjZGVmaW5lIFNFVF9XSU5ET1cgICAgICAgICAgICAweDI0Cisj
ZGVmaW5lIFJFQURfQ0FQQUNJVFlfMTAgICAgICAweDI1CisjZGVmaW5lIEdFVF9XSU5ET1cgICAg
ICAgICAgICAweDI1CisjZGVmaW5lIFJFQURfMTAgICAgICAgICAgICAgICAweDI4CisjZGVmaW5l
IFdSSVRFXzEwICAgICAgICAgICAgICAweDJhCisjZGVmaW5lIFNFTkQgICAgICAgICAgICAgICAg
ICAweDJhCisjZGVmaW5lIFNFRUtfMTAgICAgICAgICAgICAgICAweDJiCisjZGVmaW5lIExPQ0FU
RV8xMCAgICAgICAgICAgICAweDJiCisjZGVmaW5lIFBPU0lUSU9OX1RPX0VMRU1FTlQgICAweDJi
CisjZGVmaW5lIFdSSVRFX1ZFUklGWV8xMCAgICAgICAweDJlCisjZGVmaW5lIFZFUklGWV8xMCAg
ICAgICAgICAgICAweDJmCisjZGVmaW5lIFNFQVJDSF9ISUdIICAgICAgICAgICAweDMwCisjZGVm
aW5lIFNFQVJDSF9FUVVBTCAgICAgICAgICAweDMxCisjZGVmaW5lIE9CSkVDVF9QT1NJVElPTiAg
ICAgICAweDMxCisjZGVmaW5lIFNFQVJDSF9MT1cgICAgICAgICAgICAweDMyCisjZGVmaW5lIFNF
VF9MSU1JVFMgICAgICAgICAgICAweDMzCisjZGVmaW5lIFBSRV9GRVRDSCAgICAgICAgICAgICAw
eDM0CisjZGVmaW5lIFJFQURfUE9TSVRJT04gICAgICAgICAweDM0CisjZGVmaW5lIEdFVF9EQVRB
X0JVRkZFUl9TVEFUVVMgMHgzNAorI2RlZmluZSBTWU5DSFJPTklaRV9DQUNIRSAgICAgMHgzNQor
I2RlZmluZSBMT0NLX1VOTE9DS19DQUNIRSAgICAgMHgzNgorI2RlZmluZSBJTklUSUFMSVpFX0VM
RU1FTlRfU1RBVFVTX1dJVEhfUkFOR0UgMHgzNworI2RlZmluZSBSRUFEX0RFRkVDVF9EQVRBICAg
ICAgMHgzNworI2RlZmluZSBNRURJVU1fU0NBTiAgICAgICAgICAgMHgzOAorI2RlZmluZSBDT01Q
QVJFICAgICAgICAgICAgICAgMHgzOQorI2RlZmluZSBDT1BZX1ZFUklGWSAgICAgICAgICAgMHgz
YQorI2RlZmluZSBXUklURV9CVUZGRVIgICAgICAgICAgMHgzYgorI2RlZmluZSBSRUFEX0JVRkZF
UiAgICAgICAgICAgMHgzYworI2RlZmluZSBVUERBVEVfQkxPQ0sgICAgICAgICAgMHgzZAorI2Rl
ZmluZSBSRUFEX0xPTkdfMTAgICAgICAgICAgMHgzZQorI2RlZmluZSBXUklURV9MT05HXzEwICAg
ICAgICAgMHgzZgorI2RlZmluZSBDSEFOR0VfREVGSU5JVElPTiAgICAgMHg0MAorI2RlZmluZSBX
UklURV9TQU1FXzEwICAgICAgICAgMHg0MQorI2RlZmluZSBVTk1BUCAgICAgICAgICAgICAgICAg
MHg0MgorI2RlZmluZSBSRUFEX1RPQyAgICAgICAgICAgICAgMHg0MworI2RlZmluZSBSRVBPUlRf
REVOU0lUWV9TVVBQT1JUIDB4NDQKKyNkZWZpbmUgR0VUX0NPTkZJR1VSQVRJT04gICAgIDB4NDYK
KyNkZWZpbmUgU0FOSVRJWkUgICAgICAgICAgICAgIDB4NDgKKyNkZWZpbmUgR0VUX0VWRU5UX1NU
QVRVU19OT1RJRklDQVRJT04gMHg0YQorI2RlZmluZSBMT0dfU0VMRUNUICAgICAgICAgICAgMHg0
YworI2RlZmluZSBMT0dfU0VOU0UgICAgICAgICAgICAgMHg0ZAorI2RlZmluZSBSRUFEX0RJU0Nf
SU5GT1JNQVRJT04gMHg1MQorI2RlZmluZSBSRUFEX1RSQUNLX0lORk9STUFUSU9OIDB4NTIKKyNk
ZWZpbmUgUkVTRVJWRV9UUkFDSyAgICAgICAgIDB4NTMKKyNkZWZpbmUgTU9ERV9TRUxFQ1RfMTAg
ICAgICAgIDB4NTUKKyNkZWZpbmUgUkVTRVJWRV8xMCAgICAgICAgICAgIDB4NTYKKyNkZWZpbmUg
UkVMRUFTRV8xMCAgICAgICAgICAgIDB4NTcKKyNkZWZpbmUgTU9ERV9TRU5TRV8xMCAgICAgICAg
IDB4NWEKKyNkZWZpbmUgU0VORF9DVUVfU0hFRVQgICAgICAgIDB4NWQKKyNkZWZpbmUgUEVSU0lT
VEVOVF9SRVNFUlZFX0lOIDB4NWUKKyNkZWZpbmUgUEVSU0lTVEVOVF9SRVNFUlZFX09VVCAweDVm
CisjZGVmaW5lIFZBUkxFTkdUSF9DREIgICAgICAgICAweDdmCisjZGVmaW5lIFdSSVRFX0ZJTEVN
QVJLU18xNiAgICAweDgwCisjZGVmaW5lIFJFQURfUkVWRVJTRV8xNiAgICAgICAweDgxCisjZGVm
aW5lIEFMTE9XX09WRVJXUklURSAgICAgICAweDgyCisjZGVmaW5lIEVYVEVOREVEX0NPUFkgICAg
ICAgICAweDgzCisjZGVmaW5lIEFUQV9QQVNTVEhST1VHSF8xNiAgICAweDg1CisjZGVmaW5lIEFD
Q0VTU19DT05UUk9MX0lOICAgICAweDg2CisjZGVmaW5lIEFDQ0VTU19DT05UUk9MX09VVCAgICAw
eDg3CisjZGVmaW5lIFJFQURfMTYgICAgICAgICAgICAgICAweDg4CisjZGVmaW5lIENPTVBBUkVf
QU5EX1dSSVRFICAgICAweDg5CisjZGVmaW5lIFdSSVRFXzE2ICAgICAgICAgICAgICAweDhhCisj
ZGVmaW5lIFdSSVRFX1ZFUklGWV8xNiAgICAgICAweDhlCisjZGVmaW5lIFZFUklGWV8xNiAgICAg
ICAgICAgICAweDhmCisjZGVmaW5lIFBSRV9GRVRDSF8xNiAgICAgICAgICAweDkwCisjZGVmaW5l
IFNQQUNFXzE2ICAgICAgICAgICAgICAweDkxCisjZGVmaW5lIFNZTkNIUk9OSVpFX0NBQ0hFXzE2
ICAweDkxCisjZGVmaW5lIExPQ0FURV8xNiAgICAgICAgICAgICAweDkyCisjZGVmaW5lIFdSSVRF
X1NBTUVfMTYgICAgICAgICAweDkzCisjZGVmaW5lIEVSQVNFXzE2ICAgICAgICAgICAgICAweDkz
CisjZGVmaW5lIFNFUlZJQ0VfQUNUSU9OX0lOXzE2ICAweDllCisjZGVmaW5lIFdSSVRFX0xPTkdf
MTYgICAgICAgICAweDlmCisjZGVmaW5lIFJFUE9SVF9MVU5TICAgICAgICAgICAweGEwCisjZGVm
aW5lIEFUQV9QQVNTVEhST1VHSF8xMiAgICAweGExCisjZGVmaW5lIE1BSU5URU5BTkNFX0lOICAg
ICAgICAweGEzCisjZGVmaW5lIE1BSU5URU5BTkNFX09VVCAgICAgICAweGE0CisjZGVmaW5lIE1P
VkVfTUVESVVNICAgICAgICAgICAweGE1CisjZGVmaW5lIEVYQ0hBTkdFX01FRElVTSAgICAgICAw
eGE2CisjZGVmaW5lIFNFVF9SRUFEX0FIRUFEICAgICAgICAweGE3CisjZGVmaW5lIFJFQURfMTIg
ICAgICAgICAgICAgICAweGE4CisjZGVmaW5lIFdSSVRFXzEyICAgICAgICAgICAgICAweGFhCisj
ZGVmaW5lIFNFUlZJQ0VfQUNUSU9OX0lOXzEyICAweGFiCisjZGVmaW5lIEVSQVNFXzEyICAgICAg
ICAgICAgICAweGFjCisjZGVmaW5lIFdSSVRFX1ZFUklGWV8xMiAgICAgICAweGFlCisjZGVmaW5l
IFZFUklGWV8xMiAgICAgICAgICAgICAweGFmCisjZGVmaW5lIFNFQVJDSF9ISUdIXzEyICAgICAg
ICAweGIwCisjZGVmaW5lIFNFQVJDSF9FUVVBTF8xMiAgICAgICAweGIxCisjZGVmaW5lIFNFQVJD
SF9MT1dfMTIgICAgICAgICAweGIyCisjZGVmaW5lIFJFQURfRUxFTUVOVF9TVEFUVVMgICAweGI4
CisjZGVmaW5lIFNFTkRfVk9MVU1FX1RBRyAgICAgICAweGI2CisKKy8qIE1NQy1zcGVjaWZpYyBv
cGNvZGUgYXNzaWdubWVudCAqLworI2RlZmluZSBNTUNfU0VORF9FVkVOVCAgICAgICAgICAweGEy
CisjZGVmaW5lIE1NQ19TRU5EX0tFWSAgICAgICAgICAgIDB4YTMKKyNkZWZpbmUgTU1DX1JFUE9S
VF9LRVkgICAgICAgICAgMHhhNAorI2RlZmluZSBNTUNfR0VUX1BFUkZPUk1BTkNFICAgICAweGFj
CisjZGVmaW5lIE1NQ19SRUFEX0RWRF9TVFJVQ1RVUkUgIDB4YWQKKyNkZWZpbmUgTU1DX1JFQURf
REVGRUNUX0RBVEFfMTIgMHhiNworI2RlZmluZSBNTUNfU0VUX0NEX1NQRUVEICAgICAgICAweGJi
CisjZGVmaW5lIE1NQ19NRUNIQU5JU01fU1RBVFVTICAgIDB4YmQKKyNkZWZpbmUgTU1DX1JFQURf
Q0QgICAgICAgICAgICAgMHhiZQorI2RlZmluZSBNTUNfU0VORF9EVkRfU1RSVUNUVVJFICAweGJm
CisKKy8qCisgKiBTRVJWSUNFIEFDVElPTiBJTiBzdWJjb2RlcworICovCisjZGVmaW5lIFNBSV9S
RUFEX0NBUEFDSVRZXzE2ICAweDEwCisKKy8qCisgKiBSRUFEIFBPU0lUSU9OIHNlcnZpY2UgYWN0
aW9uIGNvZGVzCisgKi8KKyNkZWZpbmUgU0hPUlRfRk9STV9CTE9DS19JRCAgMHgwMAorI2RlZmlu
ZSBTSE9SVF9GT1JNX1ZFTkRPUl9TUEVDSUZJQyAweDAxCisjZGVmaW5lIExPTkdfRk9STSAgICAg
ICAgICAgIDB4MDYKKyNkZWZpbmUgRVhURU5ERURfRk9STSAgICAgICAgMHgwOAorCisvKgorICog
IFNBTSBTdGF0dXMgY29kZXMKKyAqLworCisjZGVmaW5lIEdPT0QgICAgICAgICAgICAgICAgIDB4
MDAKKyNkZWZpbmUgQ0hFQ0tfQ09ORElUSU9OICAgICAgMHgwMgorI2RlZmluZSBDT05ESVRJT05f
R09PRCAgICAgICAweDA0CisjZGVmaW5lIEJVU1kgICAgICAgICAgICAgICAgIDB4MDgKKyNkZWZp
bmUgSU5URVJNRURJQVRFX0dPT0QgICAgMHgxMAorI2RlZmluZSBJTlRFUk1FRElBVEVfQ19HT09E
ICAweDE0CisjZGVmaW5lIFJFU0VSVkFUSU9OX0NPTkZMSUNUIDB4MTgKKyNkZWZpbmUgQ09NTUFO
RF9URVJNSU5BVEVEICAgMHgyMgorI2RlZmluZSBUQVNLX1NFVF9GVUxMICAgICAgICAweDI4Cisj
ZGVmaW5lIEFDQV9BQ1RJVkUgICAgICAgICAgIDB4MzAKKyNkZWZpbmUgVEFTS19BQk9SVEVEICAg
ICAgICAgMHg0MAorCisjZGVmaW5lIFNUQVRVU19NQVNLICAgICAgICAgIDB4M2UKKworLyoKKyAq
ICBTRU5TRSBLRVlTCisgKi8KKworI2RlZmluZSBOT19TRU5TRSAgICAgICAgICAgIDB4MDAKKyNk
ZWZpbmUgUkVDT1ZFUkVEX0VSUk9SICAgICAweDAxCisjZGVmaW5lIE5PVF9SRUFEWSAgICAgICAg
ICAgMHgwMgorI2RlZmluZSBNRURJVU1fRVJST1IgICAgICAgIDB4MDMKKyNkZWZpbmUgSEFSRFdB
UkVfRVJST1IgICAgICAweDA0CisjZGVmaW5lIElMTEVHQUxfUkVRVUVTVCAgICAgMHgwNQorI2Rl
ZmluZSBVTklUX0FUVEVOVElPTiAgICAgIDB4MDYKKyNkZWZpbmUgREFUQV9QUk9URUNUICAgICAg
ICAweDA3CisjZGVmaW5lIEJMQU5LX0NIRUNLICAgICAgICAgMHgwOAorI2RlZmluZSBDT1BZX0FC
T1JURUQgICAgICAgIDB4MGEKKyNkZWZpbmUgQUJPUlRFRF9DT01NQU5EICAgICAweDBiCisjZGVm
aW5lIFZPTFVNRV9PVkVSRkxPVyAgICAgMHgwZAorI2RlZmluZSBNSVNDT01QQVJFICAgICAgICAg
IDB4MGUKKworCisvKgorICogIERFVklDRSBUWVBFUworICovCisKKyNkZWZpbmUgVFlQRV9ESVNL
ICAgICAgICAgICAweDAwCisjZGVmaW5lIFRZUEVfVEFQRSAgICAgICAgICAgMHgwMQorI2RlZmlu
ZSBUWVBFX1BSSU5URVIgICAgICAgIDB4MDIKKyNkZWZpbmUgVFlQRV9QUk9DRVNTT1IgICAgICAw
eDAzICAgIC8qIEhQIHNjYW5uZXJzIHVzZSB0aGlzICovCisjZGVmaW5lIFRZUEVfV09STSAgICAg
ICAgICAgMHgwNCAgICAvKiBUcmVhdGVkIGFzIFJPTSBieSBvdXIgc3lzdGVtICovCisjZGVmaW5l
IFRZUEVfUk9NICAgICAgICAgICAgMHgwNQorI2RlZmluZSBUWVBFX1NDQU5ORVIgICAgICAgIDB4
MDYKKyNkZWZpbmUgVFlQRV9NT0QgICAgICAgICAgICAweDA3ICAgIC8qIE1hZ25ldG8tb3B0aWNh
bCBkaXNrIC0KKwkJCQkgICAgICogLSB0cmVhdGVkIGFzIFRZUEVfRElTSyAqLworI2RlZmluZSBU
WVBFX01FRElVTV9DSEFOR0VSIDB4MDgKKyNkZWZpbmUgVFlQRV9TVE9SQUdFX0FSUkFZICAweDBj
ICAgIC8qIFN0b3JhZ2UgYXJyYXkgZGV2aWNlICovCisjZGVmaW5lIFRZUEVfRU5DTE9TVVJFICAg
ICAgMHgwZCAgICAvKiBFbmNsb3N1cmUgU2VydmljZXMgRGV2aWNlICovCisjZGVmaW5lIFRZUEVf
UkJDICAgICAgICAgICAgMHgwZSAgICAvKiBTaW1wbGlmaWVkIERpcmVjdC1BY2Nlc3MgRGV2aWNl
ICovCisjZGVmaW5lIFRZUEVfT1NEICAgICAgICAgICAgMHgxMSAgICAvKiBPYmplY3Qtc3RvcmFn
ZSBEZXZpY2UgKi8KKyNkZWZpbmUgVFlQRV9XTFVOICAgICAgICAgICAweDFlICAgIC8qIFdlbGwg
a25vd24gTFVOICovCisjZGVmaW5lIFRZUEVfTk9UX1BSRVNFTlQgICAgMHgxZgorI2RlZmluZSBU
WVBFX0lOQUNUSVZFICAgICAgIDB4MjAKKyNkZWZpbmUgVFlQRV9OT19MVU4gICAgICAgICAweDdm
CisKKy8qIE1vZGUgcGFnZSBjb2RlcyBmb3IgbW9kZSBzZW5zZS9zZXQgKi8KKyNkZWZpbmUgTU9E
RV9QQUdFX1JfV19FUlJPUiAgICAgICAgICAgICAgICAgICAweDAxCisjZGVmaW5lIE1PREVfUEFH
RV9NUlcgICAgICAgICAgICAgICAgICAgICAgICAgMHgwMworI2RlZmluZSBNT0RFX1BBR0VfSERf
R0VPTUVUUlkgICAgICAgICAgICAgICAgIDB4MDQKKyNkZWZpbmUgTU9ERV9QQUdFX0ZMRVhJQkxF
X0RJU0tfR0VPTUVUUlkgICAgICAweDA1IC8qIFNCQyAqLworI2RlZmluZSBNT0RFX1BBR0VfV1JJ
VEVfUEFSQU1FVEVSICAgICAgICAgICAgIDB4MDUgLyogTU1DICovCisjZGVmaW5lIE1PREVfUEFH
RV9DQUNISU5HICAgICAgICAgICAgICAgICAgICAgMHgwOAorI2RlZmluZSBNT0RFX1BBR0VfQ0Rf
REVWSUNFICAgICAgICAgICAgICAgICAgIDB4MGQKKyNkZWZpbmUgTU9ERV9QQUdFX0FVRElPX0NU
TCAgICAgICAgICAgICAgICAgICAweDBlCisjZGVmaW5lIE1PREVfUEFHRV9QT1dFUiAgICAgICAg
ICAgICAgICAgICAgICAgMHgxYQorI2RlZmluZSBNT0RFX1BBR0VfRkFVTFRfRkFJTCAgICAgICAg
ICAgICAgICAgIDB4MWMKKyNkZWZpbmUgTU9ERV9QQUdFX1RPX1BST1RFQ1QgICAgICAgICAgICAg
ICAgICAweDFkCisjZGVmaW5lIE1PREVfUEFHRV9DQVBTX01FQ0hfU1RBVFVTICAgICAgICAgICAg
MHgyYQorI2RlZmluZSBNT0RFX1BBR0VfTVJXX1ZFTkRPUiAgICAgICAgICAgICAgICAgIDB4MkMK
KyNkZWZpbmUgTU9ERV9QQUdFX0FMTFMgICAgICAgICAgICAgICAgICAgICAgICAweDNmCisvKiBO
b3QgaW4gTXQuIEZ1amksIGJ1dCBpbiBBVEFQSSAyLjYgLS0gZGVwcmVjYXRlZCBub3cgaW4gZmF2
b3IKKyAqIG9mIE1PREVfUEFHRV9TRU5TRV9QT1dFUiAqLworI2RlZmluZSBNT0RFX1BBR0VfQ0RS
T00gICAgICAgICAgICAgICAgICAgICAgIDB4MGQKKworI2RlZmluZSBNT0RFX1BBR0VfQ0RST00g
ICAgICAgICAgICAgICAgICAgICAgIDB4MGQKKworLyogRXZlbnQgbm90aWZpY2F0aW9uIGNsYXNz
ZXMgZm9yIEdFVCBFVkVOVCBTVEFUVVMgTk9USUZJQ0FUSU9OICovCisjZGVmaW5lIEdFU05fTk9f
RVZFTlRTICAgICAgICAgICAgICAgIDAKKyNkZWZpbmUgR0VTTl9PUEVSQVRJT05BTF9DSEFOR0Ug
ICAgICAgMQorI2RlZmluZSBHRVNOX1BPV0VSX01BTkFHRU1FTlQgICAgICAgICAyCisjZGVmaW5l
IEdFU05fRVhURVJOQUxfUkVRVUVTVCAgICAgICAgIDMKKyNkZWZpbmUgR0VTTl9NRURJQSAgICAg
ICAgICAgICAgICAgICAgNAorI2RlZmluZSBHRVNOX01VTFRJUExFX0hPU1RTICAgICAgICAgICA1
CisjZGVmaW5lIEdFU05fREVWSUNFX0JVU1kgICAgICAgICAgICAgIDYKKworLyogRXZlbnQgY29k
ZXMgZm9yIE1FRElBIGV2ZW50IHN0YXR1cyBub3RpZmljYXRpb24gKi8KKyNkZWZpbmUgTUVDX05P
X0NIQU5HRSAgICAgICAgICAgICAgICAgMAorI2RlZmluZSBNRUNfRUpFQ1RfUkVRVUVTVEVEICAg
ICAgICAgICAxCisjZGVmaW5lIE1FQ19ORVdfTUVESUEgICAgICAgICAgICAgICAgIDIKKyNkZWZp
bmUgTUVDX01FRElBX1JFTU9WQUwgICAgICAgICAgICAgMyAvKiBvbmx5IGZvciBtZWRpYSBjaGFu
Z2VycyAqLworI2RlZmluZSBNRUNfTUVESUFfQ0hBTkdFRCAgICAgICAgICAgICA0IC8qIG9ubHkg
Zm9yIG1lZGlhIGNoYW5nZXJzICovCisjZGVmaW5lIE1FQ19CR19GT1JNQVRfQ09NUExFVEVEICAg
ICAgIDUgLyogTVJXIG9yIERWRCtSVyBiL2cgZm9ybWF0IGNvbXBsZXRlZCAqLworI2RlZmluZSBN
RUNfQkdfRk9STUFUX1JFU1RBUlRFRCAgICAgICA2IC8qIE1SVyBvciBEVkQrUlcgYi9nIGZvcm1h
dCByZXN0YXJ0ZWQgKi8KKworI2RlZmluZSBNU19UUkFZX09QRU4gICAgICAgICAgICAgICAgICAx
CisjZGVmaW5lIE1TX01FRElBX1BSRVNFTlQgICAgICAgICAgICAgIDIKKworLyoKKyAqIEJhc2Vk
IG9uIHZhbHVlcyBmcm9tIDxsaW51eC9jZHJvbS5oPiBidXQgZXh0ZW5kaW5nIENEX01JTlMKKyAq
IHRvIHRoZSBtYXhpbXVtIGNvbW1vbiBzaXplIGFsbG93ZWQgYnkgdGhlIE9yYW5nZSdzIEJvb2sg
QVRJUAorICoKKyAqIDkwIGFuZCA5OSBtaW4gQ0RzIGFyZSBhbHNvIGF2YWlsYWJsZSBidXQgdXNp
bmcgdGhlbSBhcyB0aGUKKyAqIHVwcGVyIGxpbWl0IHJlZHVjZXMgdGhlIGVmZmVjdGl2ZW5lc3Mg
b2YgdGhlIGhldXJpc3RpYyB0bworICogZGV0ZWN0IERWRHMgYnVybmVkIHRvIGxlc3MgdGhhbiAy
NSUgb2YgdGhlaXIgbWF4aW11bSBjYXBhY2l0eQorICovCisKKy8qIFNvbWUgZ2VuZXJhbGx5IHVz
ZWZ1bCBDRC1ST00gaW5mb3JtYXRpb24gKi8KKyNkZWZpbmUgQ0RfTUlOUyAgICAgICAgICAgICAg
ICAgICAgICAgODAgLyogbWF4LiBtaW51dGVzIHBlciBDRCAqLworI2RlZmluZSBDRF9TRUNTICAg
ICAgICAgICAgICAgICAgICAgICA2MCAvKiBzZWNvbmRzIHBlciBtaW51dGUgKi8KKyNkZWZpbmUg
Q0RfRlJBTUVTICAgICAgICAgICAgICAgICAgICAgNzUgLyogZnJhbWVzIHBlciBzZWNvbmQgKi8K
KyNkZWZpbmUgQ0RfRlJBTUVTSVpFICAgICAgICAgICAgICAgIDIwNDggLyogYnl0ZXMgcGVyIGZy
YW1lLCAiY29va2VkIiBtb2RlICovCisjZGVmaW5lIENEX01BWF9CWVRFUyAgICAgICAoQ0RfTUlO
UyAqIENEX1NFQ1MgKiBDRF9GUkFNRVMgKiBDRF9GUkFNRVNJWkUpCisjZGVmaW5lIENEX01BWF9T
RUNUT1JTICAgICAoQ0RfTUFYX0JZVEVTIC8gNTEyKQorCisvKgorICogVGhlIE1NQyB2YWx1ZXMg
YXJlIG5vdCBJREUgc3BlY2lmaWMgYW5kIG1pZ2h0IG5lZWQgdG8gYmUgbW92ZWQKKyAqIHRvIGEg
Y29tbW9uIGhlYWRlciBpZiB0aGV5IGFyZSBhbHNvIG5lZWRlZCBmb3IgdGhlIFNDU0kgZW11bGF0
aW9uCisgKi8KKworLyogUHJvZmlsZSBsaXN0IGZyb20gTU1DLTYgcmV2aXNpb24gMSB0YWJsZSA5
MSAqLworI2RlZmluZSBNTUNfUFJPRklMRV9OT05FICAgICAgICAgICAgICAgIDB4MDAwMAorI2Rl
ZmluZSBNTUNfUFJPRklMRV9DRF9ST00gICAgICAgICAgICAgIDB4MDAwOAorI2RlZmluZSBNTUNf
UFJPRklMRV9DRF9SICAgICAgICAgICAgICAgIDB4MDAwOQorI2RlZmluZSBNTUNfUFJPRklMRV9D
RF9SVyAgICAgICAgICAgICAgIDB4MDAwQQorI2RlZmluZSBNTUNfUFJPRklMRV9EVkRfUk9NICAg
ICAgICAgICAgIDB4MDAxMAorI2RlZmluZSBNTUNfUFJPRklMRV9EVkRfUl9TUiAgICAgICAgICAg
IDB4MDAxMQorI2RlZmluZSBNTUNfUFJPRklMRV9EVkRfUkFNICAgICAgICAgICAgIDB4MDAxMgor
I2RlZmluZSBNTUNfUFJPRklMRV9EVkRfUldfUk8gICAgICAgICAgIDB4MDAxMworI2RlZmluZSBN
TUNfUFJPRklMRV9EVkRfUldfU1IgICAgICAgICAgIDB4MDAxNAorI2RlZmluZSBNTUNfUFJPRklM
RV9EVkRfUl9ETF9TUiAgICAgICAgIDB4MDAxNQorI2RlZmluZSBNTUNfUFJPRklMRV9EVkRfUl9E
TF9KUiAgICAgICAgIDB4MDAxNgorI2RlZmluZSBNTUNfUFJPRklMRV9EVkRfUldfREwgICAgICAg
ICAgIDB4MDAxNworI2RlZmluZSBNTUNfUFJPRklMRV9EVkRfRERSICAgICAgICAgICAgIDB4MDAx
OAorI2RlZmluZSBNTUNfUFJPRklMRV9EVkRfUExVU19SVyAgICAgICAgIDB4MDAxQQorI2RlZmlu
ZSBNTUNfUFJPRklMRV9EVkRfUExVU19SICAgICAgICAgIDB4MDAxQgorI2RlZmluZSBNTUNfUFJP
RklMRV9EVkRfUExVU19SV19ETCAgICAgIDB4MDAyQQorI2RlZmluZSBNTUNfUFJPRklMRV9EVkRf
UExVU19SX0RMICAgICAgIDB4MDAyQgorI2RlZmluZSBNTUNfUFJPRklMRV9CRF9ST00gICAgICAg
ICAgICAgIDB4MDA0MAorI2RlZmluZSBNTUNfUFJPRklMRV9CRF9SX1NSTSAgICAgICAgICAgIDB4
MDA0MQorI2RlZmluZSBNTUNfUFJPRklMRV9CRF9SX1JSTSAgICAgICAgICAgIDB4MDA0MgorI2Rl
ZmluZSBNTUNfUFJPRklMRV9CRF9SRSAgICAgICAgICAgICAgIDB4MDA0MworI2RlZmluZSBNTUNf
UFJPRklMRV9IRERWRF9ST00gICAgICAgICAgIDB4MDA1MAorI2RlZmluZSBNTUNfUFJPRklMRV9I
RERWRF9SICAgICAgICAgICAgIDB4MDA1MQorI2RlZmluZSBNTUNfUFJPRklMRV9IRERWRF9SQU0g
ICAgICAgICAgIDB4MDA1MgorI2RlZmluZSBNTUNfUFJPRklMRV9IRERWRF9SVyAgICAgICAgICAg
IDB4MDA1MworI2RlZmluZSBNTUNfUFJPRklMRV9IRERWRF9SX0RMICAgICAgICAgIDB4MDA1OAor
I2RlZmluZSBNTUNfUFJPRklMRV9IRERWRF9SV19ETCAgICAgICAgIDB4MDA1QQorI2RlZmluZSBN
TUNfUFJPRklMRV9JTlZBTElEICAgICAgICAgICAgIDB4RkZGRgorCisjZW5kaWYKLS0gCjIuMjAu
MQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KU3BpY2Ut
ZGV2ZWwgbWFpbGluZyBsaXN0ClNwaWNlLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRw
czovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL3NwaWNlLWRldmVs
