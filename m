Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 4B98CB7BCF
	for <lists+spice-devel@lfdr.de>; Thu, 19 Sep 2019 16:11:48 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 3D6D76F8E0;
	Thu, 19 Sep 2019 14:11:46 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 38D976F89B
 for <spice-devel@lists.freedesktop.org>; Thu, 19 Sep 2019 14:11:42 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx06.intmail.prod.int.phx2.redhat.com
 [10.5.11.16])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id D5B813018ED0
 for <spice-devel@lists.freedesktop.org>; Thu, 19 Sep 2019 14:11:41 +0000 (UTC)
Received: from wingsuit.mxp.redhat.com (unknown [10.32.181.155])
 by smtp.corp.redhat.com (Postfix) with ESMTP id 160B15C1B5
 for <spice-devel@lists.freedesktop.org>; Thu, 19 Sep 2019 14:11:40 +0000 (UTC)
From: Victor Toso <victortoso@redhat.com>
To: spice-devel@lists.freedesktop.org
Date: Thu, 19 Sep 2019 16:11:22 +0200
Message-Id: <20190919141133.10691-10-victortoso@redhat.com>
In-Reply-To: <20190919141133.10691-1-victortoso@redhat.com>
References: <20190919141133.10691-1-victortoso@redhat.com>
MIME-Version: 1.0
X-Scanned-By: MIMEDefang 2.79 on 10.5.11.16
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16
 (mx1.redhat.com [10.5.110.46]); Thu, 19 Sep 2019 14:11:41 +0000 (UTC)
Subject: [Spice-devel] [PATCH v8 09/20] usb-redir: add files for SCSI and
 USB MSC implementation
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

RnJvbTogWXVyaSBCZW5kaXRvdmljaCA8eXVyaS5iZW5kaXRvdmljaEBkYXluaXguY29tPgoKRmls
ZXMgYWRkZWQgd2l0aG91dCBpbmNsdWRpbmcgdGhlbSBpbiBjb21waWxhdGlvbi4KVGhleSBjb250
YWluIGltcGxlbWVudGF0aW9uIG9mIFNDU0kgY29tbWFuZHMgZm9yIGxvZ2ljYWwKdW5pdHMgb2Yg
bWFzcy1zdG9yYWdlIGRldmljZSBjbGFzcyBhbmQgVVNCIGJ1bGstb25seQptYXNzLXN0b3JhZ2Ug
ZGV2aWNlIHByb3RvY29sLgoKU2lnbmVkLW9mZi1ieTogQWxleGFuZGVyIE5lemhpbnNreTxhbmV6
aGluc0ByZWRoYXQuY29tPgpTaWduZWQtb2ZmLWJ5OiBZdXJpIEJlbmRpdG92aWNoIDx5dXJpLmJl
bmRpdG92aWNoQGRheW5peC5jb20+CkFja2VkLWJ5OiBGcmVkaWFubyBaaWdsaW8gPGZ6aWdsaW9A
cmVkaGF0LmNvbT4KLS0tCiBzcmMvY2Qtc2NzaS1kZXYtcGFyYW1zLmggfCAgIDQ2ICsKIHNyYy9j
ZC1zY3NpLmMgICAgICAgICAgICB8IDI3NDAgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr
KysrKysrKysKIHNyYy9jZC1zY3NpLmggICAgICAgICAgICB8ICAxMTcgKysKIHNyYy9jZC11c2It
YnVsay1tc2QuYyAgICB8ICA1NDMgKysrKysrKysKIHNyYy9jZC11c2ItYnVsay1tc2QuaCAgICB8
ICAxMzEgKysKIHNyYy9zY3NpLWNvbnN0YW50cy5oICAgICB8ICAzMjEgKysrKysKIDYgZmlsZXMg
Y2hhbmdlZCwgMzg5OCBpbnNlcnRpb25zKCspCiBjcmVhdGUgbW9kZSAxMDA2NDQgc3JjL2NkLXNj
c2ktZGV2LXBhcmFtcy5oCiBjcmVhdGUgbW9kZSAxMDA2NDQgc3JjL2NkLXNjc2kuYwogY3JlYXRl
IG1vZGUgMTAwNjQ0IHNyYy9jZC1zY3NpLmgKIGNyZWF0ZSBtb2RlIDEwMDY0NCBzcmMvY2QtdXNi
LWJ1bGstbXNkLmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBzcmMvY2QtdXNiLWJ1bGstbXNkLmgKIGNy
ZWF0ZSBtb2RlIDEwMDY0NCBzcmMvc2NzaS1jb25zdGFudHMuaAoKZGlmZiAtLWdpdCBhL3NyYy9j
ZC1zY3NpLWRldi1wYXJhbXMuaCBiL3NyYy9jZC1zY3NpLWRldi1wYXJhbXMuaApuZXcgZmlsZSBt
b2RlIDEwMDY0NAppbmRleCAwMDAwMDAwLi4zNDRmNzIwCi0tLSAvZGV2L251bGwKKysrIGIvc3Jj
L2NkLXNjc2ktZGV2LXBhcmFtcy5oCkBAIC0wLDAgKzEsNDYgQEAKKy8qIC0qLSBNb2RlOiBDOyBj
LWJhc2ljLW9mZnNldDogNDsgaW5kZW50LXRhYnMtbW9kZTogbmlsIC0qLSAqLworLyoKKyAgIENE
IFNDU0kgZGV2aWNlIHBhcmFtZXRlcnMKKworICAgQ29weXJpZ2h0IChDKSAyMDE4IFJlZCBIYXQs
IEluYy4KKworICAgUmVkIEhhdCBBdXRob3JzOgorICAgQWxleGFuZGVyIE5lemhpbnNreTxhbmV6
aGluc0ByZWRoYXQuY29tPgorCisgICBUaGlzIGxpYnJhcnkgaXMgZnJlZSBzb2Z0d2FyZTsgeW91
IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yCisgICBtb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1z
IG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCisgICBMaWNlbnNlIGFzIHB1Ymxpc2hl
ZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIKKyAgIHZlcnNpb24gMi4x
IG9mIHRoZSBMaWNlbnNlLCBvciAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgor
CisgICBUaGlzIGxpYnJhcnkgaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxs
IGJlIHVzZWZ1bCwKKyAgIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRo
ZSBpbXBsaWVkIHdhcnJhbnR5IG9mCisgICBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1Ig
QSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlIEdOVQorICAgTGVzc2VyIEdlbmVyYWwgUHVi
bGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KKworICAgWW91IHNob3VsZCBoYXZlIHJlY2Vp
dmVkIGEgY29weSBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYworICAgTGljZW5zZSBh
bG9uZyB3aXRoIHRoaXMgbGlicmFyeTsgaWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9s
aWNlbnNlcy8+LgorKi8KKworI3ByYWdtYSBvbmNlCisKKyNpbmNsdWRlIDxnaW8vZ2lvLmg+CisK
K3R5cGVkZWYgc3RydWN0IENkU2NzaURldmljZVBhcmFtZXRlcnMgeworICAgIGNvbnN0IGNoYXIg
KnZlbmRvcjsKKyAgICBjb25zdCBjaGFyICpwcm9kdWN0OworICAgIGNvbnN0IGNoYXIgKnZlcnNp
b247CisgICAgY29uc3QgY2hhciAqc2VyaWFsOworfSBDZFNjc2lEZXZpY2VQYXJhbWV0ZXJzOwor
Cit0eXBlZGVmIHN0cnVjdCBDZFNjc2lEZXZpY2VJbmZvIHsKKyAgICBDZFNjc2lEZXZpY2VQYXJh
bWV0ZXJzIHBhcmFtZXRlcnM7CisgICAgdWludDMyX3Qgc3RhcnRlZCAgICA6IDE7CisgICAgdWlu
dDMyX3QgbG9ja2VkICAgICA6IDE7CisgICAgdWludDMyX3QgbG9hZGVkICAgICA6IDE7Cit9IENk
U2NzaURldmljZUluZm87CisKK3R5cGVkZWYgc3RydWN0IENkU2NzaU1lZGlhUGFyYW1ldGVycyB7
CisgICAgR0ZpbGVJbnB1dFN0cmVhbSAqc3RyZWFtOworICAgIHVpbnQ2NF90IHNpemU7CisgICAg
dWludDMyX3QgYmxvY2tfc2l6ZTsKK30gQ2RTY3NpTWVkaWFQYXJhbWV0ZXJzOwpkaWZmIC0tZ2l0
IGEvc3JjL2NkLXNjc2kuYyBiL3NyYy9jZC1zY3NpLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5k
ZXggMDAwMDAwMC4uZWE2ODJlZgotLS0gL2Rldi9udWxsCisrKyBiL3NyYy9jZC1zY3NpLmMKQEAg
LTAsMCArMSwyNzQwIEBACisvKiAtKi0gTW9kZTogQzsgYy1iYXNpYy1vZmZzZXQ6IDQ7IGluZGVu
dC10YWJzLW1vZGU6IG5pbCAtKi0gKi8KKy8qCisgICBDRCBkZXZpY2UgZW11bGF0aW9uIC0gU0NT
SSBlbmdpbmUKKworICAgQ29weXJpZ2h0IChDKSAyMDE4IFJlZCBIYXQsIEluYy4KKworICAgUmVk
IEhhdCBBdXRob3JzOgorICAgQWxleGFuZGVyIE5lemhpbnNreTxhbmV6aGluc0ByZWRoYXQuY29t
PgorCisgICBUaGlzIGxpYnJhcnkgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1
dGUgaXQgYW5kL29yCisgICBtb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVz
c2VyIEdlbmVyYWwgUHVibGljCisgICBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBT
b2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIKKyAgIHZlcnNpb24gMi4xIG9mIHRoZSBMaWNlbnNl
LCBvciAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgorCisgICBUaGlzIGxpYnJh
cnkgaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKKyAg
IGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJh
bnR5IG9mCisgICBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBV
UlBPU0UuICBTZWUgdGhlIEdOVQorICAgTGVzc2VyIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9y
IG1vcmUgZGV0YWlscy4KKworICAgWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0
aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYworICAgTGljZW5zZSBhbG9uZyB3aXRoIHRoaXMg
bGlicmFyeTsgaWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+LgorKi8K
KworI2luY2x1ZGUgImNvbmZpZy5oIgorI2luY2x1ZGUgInNwaWNlL3R5cGVzLmgiCisjaW5jbHVk
ZSAic3BpY2UtY29tbW9uLmgiCisjaW5jbHVkZSAic3BpY2UtdXRpbC5oIgorI2luY2x1ZGUgImNk
LXNjc2kuaCIKKworI2lmZGVmIFVTRV9VU0JSRURJUgorCisjZGVmaW5lIFNQSUNFX0VSUk9SKGZt
dCwgLi4uKSBcCisgICAgZG8geyBTUElDRV9ERUJVRygiZGV2LXNjc2kgZXJyb3I6ICIgZm10ICwg
IyMgX19WQV9BUkdTX18pOyB9IHdoaWxlICgwKQorCisjZGVmaW5lIEZJWEVEX1NFTlNFX0NVUlJF
TlQgMHg3MAorI2RlZmluZSBGSVhFRF9TRU5TRV9MRU4gMTgKKworI2RlZmluZSBNQVhfTFVOUyAg
IDMyCisKK3R5cGVkZWYgZW51bSBDZFNjc2lQb3dlckNvbmRpdGlvbiB7CisgICAgQ0RfU0NTSV9Q
T1dFUl9TVE9QUEVELAorICAgIENEX1NDU0lfUE9XRVJfQUNUSVZFLAorICAgIENEX1NDU0lfUE9X
RVJfSURMRSwKKyAgICBDRF9TQ1NJX1BPV0VSX1NUQU5EQlkKK30gQ2RTY3NpUG93ZXJDb25kaXRp
b247CisKK3R5cGVkZWYgc3RydWN0IFNjc2lTaG9ydFNlbnNlIHsKKyAgICB1aW50OF90IGtleTsK
KyAgICB1aW50OF90IGFzYzsKKyAgICB1aW50OF90IGFzY3E7CisgICAgY29uc3QgY2hhciAqZGVz
Y3I7Cit9IFNjc2lTaG9ydFNlbnNlOworCisjZGVmaW5lIENEX01FRElBX0VWRU5UX05PX0NIQU5H
RSAgICAgICAgICAgIDB4MAorI2RlZmluZSBDRF9NRURJQV9FVkVOVF9FSkVDVF9SRVEgICAgICAg
ICAgICAweDEgLyogdXNlciByZXF1ZXN0IChtZWNoYW5pY2FsIHN3aXRjaCkgdG8KKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGVqZWN0IHRoZSBtZWRp
YSAqLworI2RlZmluZSBDRF9NRURJQV9FVkVOVF9ORVdfTUVESUEgICAgICAgICAgICAweDIgLyog
bmV3IG1lZGlhIHJlY2VpdmVkICovCisjZGVmaW5lIENEX01FRElBX0VWRU5UX01FRElBX1JFTU9W
QUwgICAgICAgIDB4MyAvKiBtZWRpYSByZW1vdmVkICovCisjZGVmaW5lIENEX01FRElBX0VWRU5U
X01FRElBX0NIQU5HRUQgICAgICAgIDB4NCAvKiB1c2VyIHJlcXVlc3QgdG8gbG9hZCBuZXcgbWVk
aWEgKi8KKyNkZWZpbmUgQ0RfTUVESUFfRVZFTlRfQkdfRk9STUFUX0NPTVBMRVRFICAgMHg1Cisj
ZGVmaW5lIENEX01FRElBX0VWRU5UX0JHX0ZPUk1BVF9SRVNUQVJUICAgIDB4NgorCisjZGVmaW5l
IENEX1BPV0VSX0VWRU5UX05PX0NIQU5HRSAgICAgICAgICAgIDB4MAorI2RlZmluZSBDRF9QT1dF
Ul9FVkVOVF9DSEFOR0VfU1VDQ0VTUyAgICAgICAweDEKKyNkZWZpbmUgQ0RfUE9XRVJfRVZFTlRf
Q0hBTkdFX0ZBTEVEICAgICAgICAgMHgyCisKK3R5cGVkZWYgc3RydWN0IENkU2NzaUxVIHsKKyAg
ICBDZFNjc2lUYXJnZXQgKnRndDsKKyAgICB1aW50MzJfdCBsdW47CisKKyAgICBnYm9vbGVhbiBy
ZWFsaXplZDsKKyAgICBnYm9vbGVhbiByZW1vdmFibGU7CisgICAgZ2Jvb2xlYW4gbG9hZGVkOwor
ICAgIGdib29sZWFuIHByZXZlbnRfbWVkaWFfcmVtb3ZhbDsKKyAgICBnYm9vbGVhbiBjZF9yb207
CisKKyAgICBDZFNjc2lQb3dlckNvbmRpdGlvbiBwb3dlcl9jb25kOworICAgIHVpbnQzMl90IHBv
d2VyX2V2ZW50OworICAgIHVpbnQzMl90IG1lZGlhX2V2ZW50OworCisgICAgdWludDMyX3QgY2xh
aW1fdmVyc2lvbjsKKworICAgIHVpbnQ2NF90IHNpemU7CisgICAgdWludDMyX3QgYmxvY2tfc2l6
ZTsKKyAgICB1aW50MzJfdCBudW1fYmxvY2tzOworCisgICAgY2hhciAqdmVuZG9yOworICAgIGNo
YXIgKnByb2R1Y3Q7CisgICAgY2hhciAqdmVyc2lvbjsKKyAgICBjaGFyICpzZXJpYWw7CisKKyAg
ICBHRmlsZUlucHV0U3RyZWFtICpzdHJlYW07CisKKyAgICBTY3NpU2hvcnRTZW5zZSBzaG9ydF9z
ZW5zZTsgLyogY3VycmVudGx5IGhlbGQgc2Vuc2Ugb2YgdGhlIHNjc2kgZGV2aWNlICovCisgICAg
dWludDhfdCBmaXhlZF9zZW5zZVtGSVhFRF9TRU5TRV9MRU5dOworfSBDZFNjc2lMVTsKKwordHlw
ZWRlZiBlbnVtIENkU2NzaVRhcmdldFN0YXRlIHsKKyAgICBDRF9TQ1NJX1RHVF9TVEFURV9SVU5O
SU5HLAorICAgIENEX1NDU0lfVEdUX1NUQVRFX1JFU0VULAorfSBDZFNjc2lUYXJnZXRTdGF0ZTsK
Kworc3RydWN0IENkU2NzaVRhcmdldCB7CisgICAgdm9pZCAqdXNlcl9kYXRhOworCisgICAgQ2RT
Y3NpVGFyZ2V0U3RhdGUgc3RhdGU7CisgICAgQ2RTY3NpUmVxdWVzdCAqY3VyX3JlcTsKKyAgICBH
Q2FuY2VsbGFibGUgKmNhbmNlbGxhYmxlOworCisgICAgdWludDMyX3QgbWF4X2x1bnM7CisgICAg
Q2RTY3NpTFUgdW5pdHNbTUFYX0xVTlNdOworfTsKKworc3RhdGljIGNvbnN0IGNoYXIqIHNjc2lf
Y21kX25hbWVbMjU2XTsKKworLyogUHJlZGVmaW5lZCBzZW5zZSBjb2RlcyAqLworCitjb25zdCBT
Y3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX05PX1NFTlNFID0geworICAgIC5rZXkgPSBOT19TRU5T
RSAsIC5hc2MgPSAweDAwICwgLmFzY3EgPSAweDAwLAorICAgIC5kZXNjciA9ICIiCit9OworCitj
b25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX05PVF9SRUFEWV9DQVVTRV9OT1RfUkVQT1JU
QUJMRSA9IHsKKyAgICAua2V5ID0gTk9UX1JFQURZLCAuYXNjID0gMHgwNCwgLmFzY3EgPSAweDAw
LAorICAgIC5kZXNjciA9ICJDQVVTRSBOT1QgUkVQT1JUQUJMRSIKK307CisKK2NvbnN0IFNjc2lT
aG9ydFNlbnNlIHNlbnNlX2NvZGVfQkVDT01JTkdfUkVBRFkgPSB7CisgICAgLmtleSA9IE5PVF9S
RUFEWSwgLmFzYyA9IDB4MDQsIC5hc2NxID0gMHgwMSwKKyAgICAuZGVzY3IgPSAiSU4gUFJPQ0VT
UyBPRiBCRUNPTUlORyBSRUFEWSIKK307CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNlIHNlbnNlX2Nv
ZGVfSU5JVF9DTURfUkVRVUlSRUQgPSB7CisgICAgLmtleSA9IE5PVF9SRUFEWSwgLmFzYyA9IDB4
MDQsIC5hc2NxID0gMHgwMiwKKyAgICAuZGVzY3IgPSAiSU5JVElBTElaSU5HIENPTU1BTkQgUkVR
VUlSRUQiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX0lOVEVSVkVOVElP
Tl9SRVFVSVJFRCA9IHsKKyAgICAua2V5ID0gTk9UX1JFQURZLCAuYXNjID0gMHgwNCwgLmFzY3Eg
PSAweDAzLAorICAgIC5kZXNjciA9ICJNQU5VQUwgSU5URVJWRU5USU9OIFJFUVVJUkVEIgorfTsK
KworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9OT1RfUkVBRFlfTk9fTUVESVVNID0g
eworICAgIC5rZXkgPSBOT1RfUkVBRFksIC5hc2MgPSAweDNhLCAuYXNjcSA9IDB4MDAsCisgICAg
LmRlc2NyID0gIk1FRElVTSBOT1QgUFJFU0VOVCIKK307CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNl
IHNlbnNlX2NvZGVfTk9UX1JFQURZX05PX01FRElVTV9UUkFZX0NMT1NFRCA9IHsKKyAgICAua2V5
ID0gTk9UX1JFQURZLCAuYXNjID0gMHgzYSwgLmFzY3EgPSAweDAxLAorICAgIC5kZXNjciA9ICJN
RURJVU0gTk9UIFBSRVNFTlQgLSBUUkFZIENMT1NFRCIKK307CisKK2NvbnN0IFNjc2lTaG9ydFNl
bnNlIHNlbnNlX2NvZGVfTk9UX1JFQURZX05PX01FRElVTV9UUkFZX09QRU4gPSB7CisgICAgLmtl
eSA9IE5PVF9SRUFEWSwgLmFzYyA9IDB4M2EsIC5hc2NxID0gMHgwMiwKKyAgICAuZGVzY3IgPSAi
TUVESVVNIE5PVCBQUkVTRU5UIC0gVFJBWSBPUEVOIgorfTsKKworY29uc3QgU2NzaVNob3J0U2Vu
c2Ugc2Vuc2VfY29kZV9UQVJHRVRfRkFJTFVSRSA9IHsKKyAgICAua2V5ID0gSEFSRFdBUkVfRVJS
T1IsIC5hc2MgPSAweDQ0LCAuYXNjcSA9IDB4MDAsCisgICAgLmRlc2NyID0gIklOVEVSTkFMIFRB
UkdFVCBGQUlMVVJFIgorfTsKKworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9JTlZB
TElEX09QQ09ERSA9IHsKKyAgICAua2V5ID0gSUxMRUdBTF9SRVFVRVNULCAuYXNjID0gMHgyMCwg
LmFzY3EgPSAweDAwLAorICAgIC5kZXNjciA9ICJJTlZBTElEIENPTU1BTkQgT1BFUkFUSU9OIENP
REUiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX0xCQV9PVVRfT0ZfUkFO
R0UgPSB7CisgICAgLmtleSA9IElMTEVHQUxfUkVRVUVTVCwgLmFzYyA9IDB4MjEsIC5hc2NxID0g
MHgwMCwKKyAgICAuZGVzY3IgPSAiTE9HSUNBTCBCTE9DSyBBRERSRVNTIE9VVCBPRiBSQU5HRSIK
K307CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNlIHNlbnNlX2NvZGVfSU5WQUxJRF9DREJfRklFTEQg
PSB7CisgICAgLmtleSA9IElMTEVHQUxfUkVRVUVTVCwgLmFzYyA9IDB4MjQsIC5hc2NxID0gMHgw
MCwKKyAgICAuZGVzY3IgPSAiSU5WQUxJRCBGSUVMRCBJTiBDREIiCit9OworCitjb25zdCBTY3Np
U2hvcnRTZW5zZSBzZW5zZV9jb2RlX0lOVkFMSURfUEFSQU1fRklFTEQgPSB7CisgICAgLmtleSA9
IElMTEVHQUxfUkVRVUVTVCwgLmFzYyA9IDB4MjYsIC5hc2NxID0gMHgwMCwKKyAgICAuZGVzY3Ig
PSAiSU5WQUxJRCBGSUVMRCBJTiBQQVJBTUVURVIgTElTVCIKK307CisKK2NvbnN0IFNjc2lTaG9y
dFNlbnNlIHNlbnNlX2NvZGVfSU5WQUxJRF9QQVJBTV9MRU4gPSB7CisgICAgLmtleSA9IElMTEVH
QUxfUkVRVUVTVCwgLmFzYyA9IDB4MWEsIC5hc2NxID0gMHgwMCwKKyAgICAuZGVzY3IgPSAiUEFS
QU1FVEVSIExJU1QgTEVOR1RIIEVSUk9SIgorfTsKKworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vu
c2VfY29kZV9MVU5fTk9UX1NVUFBPUlRFRCA9IHsKKyAgICAua2V5ID0gSUxMRUdBTF9SRVFVRVNU
LCAuYXNjID0gMHgyNSwgLmFzY3EgPSAweDAwLAorICAgIC5kZXNjciA9ICJMT0dJQ0FMIFVOSVQg
Tk9UIFNVUFBPUlRFRCIKK307CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNlIHNlbnNlX2NvZGVfU0FW
SU5HX1BBUkFNU19OT1RfU1VQUE9SVEVEID0geworICAgIC5rZXkgPSBJTExFR0FMX1JFUVVFU1Qs
IC5hc2MgPSAweDM5LCAuYXNjcSA9IDB4MDAsCisgICAgLmRlc2NyID0gIlNBVklORyBQQVJBTUVU
RVJTIE5PVCBTVVBQT1JURUQiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2Rl
X0lOQ09NUEFUSUJMRV9NRURJVU0gPSB7CisgICAgLmtleSA9IElMTEVHQUxfUkVRVUVTVCwgLmFz
YyA9IDB4MzAsIC5hc2NxID0gMHgwMCwKKyAgICAuZGVzY3IgPSAiSU5DT01QQVRJQkxFIE1FRElV
TSBJTlNUQUxMRUQiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX01FRElV
TV9SRU1PVkFMX1BSRVZFTlRFRCA9IHsKKyAgICAua2V5ID0gSUxMRUdBTF9SRVFVRVNULCAuYXNj
ID0gMHg1MywgLmFzY3EgPSAweDAyLAorICAgIC5kZXNjciA9ICJNRURJVU0gUkVNT1ZBTCBQUkVW
RU5URUQiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX1BBUkFNRVRFUlNf
Q0hBTkdFRCA9IHsKKyAgICAua2V5ID0gVU5JVF9BVFRFTlRJT04sIC5hc2MgPSAweDJhLCAuYXNj
cSA9IDB4MDAsCisgICAgLmRlc2NyID0gIlBBUkFNRVRFUlMgQ0hBTkdFRCIKK307CisKK2NvbnN0
IFNjc2lTaG9ydFNlbnNlIHNlbnNlX2NvZGVfUE9XRVJfT05fUkVTRVQgPSB7CisgICAgLmtleSA9
IFVOSVRfQVRURU5USU9OLCAuYXNjID0gMHgyOSwgLmFzY3EgPSAweDAwLAorICAgIC5kZXNjciA9
ICJQT1dFUiBPTiwgUkVTRVQsIE9SIEJVUyBERVZJQ0UgUkVTRVQiCit9OworCitjb25zdCBTY3Np
U2hvcnRTZW5zZSBzZW5zZV9jb2RlX1NDU0lfQlVTX1JFU0VUID0geworICAgIC5rZXkgPSBVTklU
X0FUVEVOVElPTiwgLmFzYyA9IDB4MjksIC5hc2NxID0gMHgwMiwKKyAgICAuZGVzY3IgPSAiU0NT
SSBCVVMgUkVTRVQiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX1VBX05P
X01FRElVTSA9IHsKKyAgICAua2V5ID0gVU5JVF9BVFRFTlRJT04sIC5hc2MgPSAweDNhLCAuYXNj
cSA9IDB4MDAsCisgICAgLmRlc2NyID0gIk1FRElVTSBOT1QgUFJFU0VOVCIKK307CisKK2NvbnN0
IFNjc2lTaG9ydFNlbnNlIHNlbnNlX2NvZGVfTUVESVVNX0NIQU5HRUQgPSB7CisgICAgLmtleSA9
IFVOSVRfQVRURU5USU9OLCAuYXNjID0gMHgyOCwgLmFzY3EgPSAweDAwLAorICAgIC5kZXNjciA9
ICJNRURJVU0gQ0hBTkdFRCIKK307CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNlIHNlbnNlX2NvZGVf
UkVQT1JURURfTFVOU19DSEFOR0VEID0geworICAgIC5rZXkgPSBVTklUX0FUVEVOVElPTiwgLmFz
YyA9IDB4M2YsIC5hc2NxID0gMHgwZSwKKyAgICAuZGVzY3IgPSAiUkVQT1JURUQgTFVOUyBDSEFO
R0VEIgorfTsKKworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9ERVZJQ0VfSU5URVJO
QUxfUkVTRVQgPSB7CisgICAgLmtleSA9IFVOSVRfQVRURU5USU9OLCAuYXNjID0gMHgyOSwgLmFz
Y3EgPSAweDA0LAorICAgIC5kZXNjciA9ICJERVZJQ0UgSU5URVJOQUwgUkVTRVQiCit9OworCitj
b25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX1VOSVRfQVRURU5USU9OX01FRElVTV9SRU1P
VkFMX1JFUVVFU1QgPSB7CisgICAgLmtleSA9IFVOSVRfQVRURU5USU9OLCAuYXNjID0gMHg1YSwg
LmFzY3EgPSAweDAxLAorICAgIC5kZXNjciA9ICJPUEVSQVRPUiBNRURJVU0gUkVNT1ZBTCBSRVFV
RVNUIgorfTsKKworc3RhdGljIGlubGluZSBnYm9vbGVhbiBjZF9zY3NpX29wY29kZV91YV9zdXBy
ZXNzKHVpbnQzMl90IG9wY29kZSkKK3sKKyAgICBzd2l0Y2ggKG9wY29kZSkgeworICAgIGNhc2Ug
SU5RVUlSWToKKyAgICBjYXNlIFJFUE9SVF9MVU5TOgorICAgIGNhc2UgR0VUX0NPTkZJR1VSQVRJ
T046CisgICAgY2FzZSBHRVRfRVZFTlRfU1RBVFVTX05PVElGSUNBVElPTjoKKyAgICBjYXNlIFJF
UVVFU1RfU0VOU0U6CisgICAgICAgIHJldHVybiBUUlVFOworICAgIGRlZmF1bHQ6CisgICAgICAg
IHJldHVybiBGQUxTRTsKKyAgICB9Cit9CisKK3N0YXRpYyBpbmxpbmUgY29uc3QgY2hhciAqQ2RT
Y3NpUmVxU3RhdGVfc3RyKENkU2NzaVJlcVN0YXRlIHN0YXRlKQoreworICAgIHN3aXRjaChzdGF0
ZSkgeworICAgIGNhc2UgU0NTSV9SRVFfSURMRToKKyAgICAgICAgcmV0dXJuICJJRExFIjsKKyAg
ICBjYXNlIFNDU0lfUkVRX1JVTk5JTkc6CisgICAgICAgIHJldHVybiAiUlVOTklORyI7CisgICAg
Y2FzZSBTQ1NJX1JFUV9DT01QTEVURToKKyAgICAgICAgcmV0dXJuICJDT01QTEVURSI7CisgICAg
Y2FzZSBTQ1NJX1JFUV9DQU5DRUxFRDoKKyAgICAgICAgcmV0dXJuICJDQU5DRUxFRCI7CisgICAg
ZGVmYXVsdDoKKyAgICAgICAgcmV0dXJuICJJTExFR0FMIjsKKyAgICB9Cit9CisKK3N0YXRpYyBj
b25zdCBjaGFyICpjZF9zY3NpX3NlbnNlX2tleV9kZXNjcih1aW50OF90IHNlbnNlX2tleSkKK3sK
KyAgICBzd2l0Y2goc2Vuc2Vfa2V5KSB7CisgICAgY2FzZSBOT19TRU5TRToKKyAgICAgICAgcmV0
dXJuICJOTyBTRU5TRSI7CisgICAgY2FzZSBSRUNPVkVSRURfRVJST1I6CisgICAgICAgIHJldHVy
biAiUkVDT1ZFUkVEIEVSUk9SIjsKKyAgICBjYXNlIE5PVF9SRUFEWToKKyAgICAgICAgcmV0dXJu
ICJMVU4gTk9UIFJFQURZIjsKKyAgICBjYXNlIE1FRElVTV9FUlJPUjoKKyAgICAgICAgcmV0dXJu
ICJNRURJVU0gRVJST1IiOworICAgIGNhc2UgSEFSRFdBUkVfRVJST1I6CisgICAgICAgIHJldHVy
biAiSEFSRFdBUkUgRVJST1IiOworICAgIGNhc2UgSUxMRUdBTF9SRVFVRVNUOgorICAgICAgICBy
ZXR1cm4gIklMTEVHQUwgUkVRVUVTVCI7CisgICAgY2FzZSBVTklUX0FUVEVOVElPTjoKKyAgICAg
ICAgcmV0dXJuICJVTklUIEFUVEVOVElPTiI7CisgICAgY2FzZSBCTEFOS19DSEVDSzoKKyAgICAg
ICAgcmV0dXJuICJCTEFOSyBDSEVDSyI7CisgICAgY2FzZSBBQk9SVEVEX0NPTU1BTkQ6CisgICAg
ICAgIHJldHVybiAiQUJPUlRFRCBDT01NQU5EIjsKKyAgICBkZWZhdWx0OgorICAgICAgICByZXR1
cm4gIj8/PyI7CisgICAgfQorfQorc3RhdGljIHVpbnQzMl90IGNkX3Njc2lfYnVpbGRfZml4ZWRf
c2Vuc2UodWludDhfdCAqYnVmLCBjb25zdCBTY3NpU2hvcnRTZW5zZSAqc2hvcnRfc2Vuc2UpCit7
CisgICAgbWVtc2V0KGJ1ZiwgMCwgRklYRURfU0VOU0VfTEVOKTsKKworICAgIGJ1ZlswXSA9IEZJ
WEVEX1NFTlNFX0NVUlJFTlQ7CisgICAgYnVmWzJdID0gc2hvcnRfc2Vuc2UtPmtleTsKKyAgICBi
dWZbN10gPSAxMDsKKyAgICBidWZbMTJdID0gc2hvcnRfc2Vuc2UtPmFzYzsKKyAgICBidWZbMTNd
ID0gc2hvcnRfc2Vuc2UtPmFzY3E7CisKKyAgICByZXR1cm4gRklYRURfU0VOU0VfTEVOOworfQor
CitzdGF0aWMgaW5saW5lIHZvaWQgY2Rfc2NzaV9yZXFfaW5pdChDZFNjc2lSZXF1ZXN0ICpyZXEp
Cit7CisgICAgcmVxLT5yZXFfc3RhdGUgPSBTQ1NJX1JFUV9JRExFOworICAgIHJlcS0+eGZlcl9k
aXIgPSBTQ1NJX1hGRVJfTk9ORTsKKyAgICByZXEtPnByaXZfZGF0YSA9IE5VTEw7CisgICAgcmVx
LT5pbl9sZW4gPSAwOworICAgIHJlcS0+c3RhdHVzID0gR09PRDsKK30KKworc3RhdGljIGlubGlu
ZSB2b2lkIGNkX3Njc2lfZGV2X3NlbnNlX3Jlc2V0KENkU2NzaUxVICpkZXYpCit7CisgICAgbWVt
c2V0KCZkZXYtPnNob3J0X3NlbnNlLCAwLCBzaXplb2YoZGV2LT5zaG9ydF9zZW5zZSkpOworICAg
IGNkX3Njc2lfYnVpbGRfZml4ZWRfc2Vuc2UoZGV2LT5maXhlZF9zZW5zZSwgJmRldi0+c2hvcnRf
c2Vuc2UpOworfQorCitzdGF0aWMgaW5saW5lIHZvaWQgY2Rfc2NzaV9kZXZfc2Vuc2Vfc2V0KENk
U2NzaUxVICpkZXYsIGNvbnN0IFNjc2lTaG9ydFNlbnNlICpzaG9ydF9zZW5zZSkKK3sKKyAgICBp
ZiAoc2hvcnRfc2Vuc2UgIT0gTlVMTCkgeworICAgICAgICAvKiBjb3B5IHNob3J0IHNlbnNlIGFu
ZCBnZW5lcmF0ZSBmdWxsIHNlbnNlIGluIGZpeGVkIGZvcm1hdCAqLworICAgICAgICBkZXYtPnNo
b3J0X3NlbnNlID0gKnNob3J0X3NlbnNlOworICAgICAgICBjZF9zY3NpX2J1aWxkX2ZpeGVkX3Nl
bnNlKGRldi0+Zml4ZWRfc2Vuc2UsIHNob3J0X3NlbnNlKTsKKyAgICB9Cit9CisKK3N0YXRpYyBp
bmxpbmUgdm9pZCBjZF9zY3NpX2Rldl9zZW5zZV9zZXRfcG93ZXJfb24oQ2RTY3NpTFUgKmRldikK
K3sKKyAgICBjZF9zY3NpX2Rldl9zZW5zZV9zZXQoZGV2LCAmc2Vuc2VfY29kZV9QT1dFUl9PTl9S
RVNFVCk7Cit9CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQo
Q2RTY3NpTFUgKmRldiwgQ2RTY3NpUmVxdWVzdCAqcmVxLAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBTY3NpU2hvcnRTZW5zZSAqc2hvcnRfc2Vuc2Up
Cit7CisgICAgcmVxLT5yZXFfc3RhdGUgPSBTQ1NJX1JFUV9DT01QTEVURTsKKyAgICByZXEtPnN0
YXR1cyA9IENIRUNLX0NPTkRJVElPTjsKKyAgICByZXEtPmluX2xlbiA9IDA7CisKKyAgICBjZF9z
Y3NpX2Rldl9zZW5zZV9zZXQoZGV2LCBzaG9ydF9zZW5zZSk7CisKKyAgICBTUElDRV9ERUJVRygi
Q0hFQ0tfQ09ORCwgcmVxdWVzdCBsdW46JXUiCisgICAgICAgICAgICAgICAgIiBvcDogMHglMDJ4
LCBwZW5kaW5nIHNlbnNlOiAweCUwMnggJTAyeCAlMDJ4IC0gJXMsICVzIiwKKyAgICAgICAgICAg
ICAgICBkZXYtPmx1biwgKHVpbnQzMl90KXJlcS0+Y2RiWzBdLAorICAgICAgICAgICAgICAgICh1
aW50MzJfdClkZXYtPnNob3J0X3NlbnNlLmtleSwKKyAgICAgICAgICAgICAgICAodWludDMyX3Qp
ZGV2LT5zaG9ydF9zZW5zZS5hc2MsCisgICAgICAgICAgICAgICAgKHVpbnQzMl90KWRldi0+c2hv
cnRfc2Vuc2UuYXNjcSwKKyAgICAgICAgICAgICAgICBjZF9zY3NpX3NlbnNlX2tleV9kZXNjcihk
ZXYtPnNob3J0X3NlbnNlLmtleSksCisgICAgICAgICAgICAgICAgZGV2LT5zaG9ydF9zZW5zZS5k
ZXNjcik7Cit9CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX2NvbXBsZXRlX2dvb2QoQ2RTY3Np
TFUgKmRldiwgQ2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAgIHJlcS0+cmVxX3N0YXRlID0gU0NT
SV9SRVFfQ09NUExFVEU7CisgICAgcmVxLT5zdGF0dXMgPSBHT09EOworfQorCisvKiBTQ1NJIFRh
cmdldCAqLworCitTUElDRV9DT05TVFJVQ1RPUl9GVU5DKGNkX3Njc2lfY21kX25hbWVzX2luaXQp
Cit7CisgICAgdWludDMyX3Qgb3Bjb2RlOworCisgICAgZm9yIChvcGNvZGUgPSAwOyBvcGNvZGUg
PCAyNTY7IG9wY29kZSsrKSB7CisgICAgICAgIHNjc2lfY21kX25hbWVbb3Bjb2RlXSA9ICJVTlNV
UFBPUlRFRCI7CisgICAgfQorCisgICAgc2NzaV9jbWRfbmFtZVtSRVBPUlRfTFVOU10gPSAiUkVQ
T1JUIExVTlMiOworICAgIHNjc2lfY21kX25hbWVbVEVTVF9VTklUX1JFQURZXSA9ICJURVNUIFVO
SVQgUkVBRFkiOworICAgIHNjc2lfY21kX25hbWVbSU5RVUlSWV0gPSAiSU5RVUlSWSI7CisgICAg
c2NzaV9jbWRfbmFtZVtSRVFVRVNUX1NFTlNFXSA9ICJSRVFVRVNUIFNFTlNFIjsKKyAgICBzY3Np
X2NtZF9uYW1lW1JFQURfNl0gPSAiUkVBRCg2KSI7CisgICAgc2NzaV9jbWRfbmFtZVtSRUFEXzEw
XSA9ICJSRUFEKDEwKSI7CisgICAgc2NzaV9jbWRfbmFtZVtSRUFEXzEyXSA9ICJSRUFEKDEyKSI7
CisgICAgc2NzaV9jbWRfbmFtZVtSRUFEXzE2XSA9ICJSRUFEKDE2KSI7CisgICAgc2NzaV9jbWRf
bmFtZVtSRUFEX0NBUEFDSVRZXzEwXSA9ICJSRUFEIENBUEFDSVRZKDEwKSI7CisgICAgc2NzaV9j
bWRfbmFtZVtSRUFEX1RPQ10gPSAiUkVBRCBUT0MiOworICAgIHNjc2lfY21kX25hbWVbR0VUX0VW
RU5UX1NUQVRVU19OT1RJRklDQVRJT05dID0gIkdFVCBFVkVOVC9TVEFUVVMgTk9USUZJQ0FUSU9O
IjsKKyAgICBzY3NpX2NtZF9uYW1lW1JFQURfRElTQ19JTkZPUk1BVElPTl0gPSAiUkVBRCBESVND
IElORk8iOworICAgIHNjc2lfY21kX25hbWVbUkVBRF9UUkFDS19JTkZPUk1BVElPTl0gPSAiUkVB
RCBUUkFDSyBJTkZPIjsKKyAgICBzY3NpX2NtZF9uYW1lW01PREVfU0VOU0VfMTBdID0gIk1PREUg
U0VOU0UoMTApIjsKKyAgICBzY3NpX2NtZF9uYW1lW01PREVfU0VMRUNUXSA9ICJNT0RFIFNFTEVD
VCg2KSI7CisgICAgc2NzaV9jbWRfbmFtZVtNT0RFX1NFTEVDVF8xMF0gPSAiTU9ERSBTRUxFQ1Qo
MTApIjsKKyAgICBzY3NpX2NtZF9uYW1lW0dFVF9DT05GSUdVUkFUSU9OXSA9ICJHRVQgQ09ORklH
VVJBVElPTiI7CisgICAgc2NzaV9jbWRfbmFtZVtBTExPV19NRURJVU1fUkVNT1ZBTF0gPSAiUFJF
VkVOVCBBTExPVyBNRURJVU0gUkVNT1ZBTCI7CisgICAgc2NzaV9jbWRfbmFtZVtNTUNfU0VORF9F
VkVOVF0gPSAiU0VORCBFVkVOVCI7CisgICAgc2NzaV9jbWRfbmFtZVtNTUNfUkVQT1JUX0tFWV0g
PSAiUkVQT1JUIEtFWSI7CisgICAgc2NzaV9jbWRfbmFtZVtNTUNfU0VORF9LRVldID0gIlNFTkRf
S0VZIjsKKyAgICBzY3NpX2NtZF9uYW1lW1NUQVJUX1NUT1BdID0gIlNUQVJUIFNUT1AgVU5JVCI7
CisgICAgc2NzaV9jbWRfbmFtZVtNTUNfR0VUX1BFUkZPUk1BTkNFXSA9ICJHRVQgUEVSRk9STUFO
Q0UiOworICAgIHNjc2lfY21kX25hbWVbTU1DX01FQ0hBTklTTV9TVEFUVVNdID0gIk1FQ0hBTklT
TSBTVEFUVVMiOworfQorCitDZFNjc2lUYXJnZXQgKmNkX3Njc2lfdGFyZ2V0X2FsbG9jKHZvaWQg
KnRhcmdldF91c2VyX2RhdGEsIHVpbnQzMl90IG1heF9sdW5zKQoreworICAgIENkU2NzaVRhcmdl
dCAqc3Q7CisKKyAgICBpZiAobWF4X2x1bnMgPT0gMCB8fCBtYXhfbHVucyA+IE1BWF9MVU5TKSB7
CisgICAgICAgIFNQSUNFX0VSUk9SKCJBbGxvYywgaWxsZWdhbCBtYXhfbHVuczoldSIsIG1heF9s
dW5zKTsKKyAgICAgICAgcmV0dXJuIE5VTEw7CisgICAgfQorCisgICAgc3QgPSBnX21hbGxvYzAo
c2l6ZW9mKCpzdCkpOworCisgICAgc3QtPnVzZXJfZGF0YSA9IHRhcmdldF91c2VyX2RhdGE7Cisg
ICAgc3QtPnN0YXRlID0gQ0RfU0NTSV9UR1RfU1RBVEVfUlVOTklORzsKKyAgICBzdC0+Y3VyX3Jl
cSA9IE5VTEw7CisgICAgc3QtPmNhbmNlbGxhYmxlID0gZ19jYW5jZWxsYWJsZV9uZXcoKTsKKyAg
ICBzdC0+bWF4X2x1bnMgPSBtYXhfbHVuczsKKworICAgIHJldHVybiBzdDsKK30KKwordm9pZCBj
ZF9zY3NpX3RhcmdldF9mcmVlKENkU2NzaVRhcmdldCAqc3QpCit7CisgICAgdWludDMyX3QgbHVu
OworCisgICAgY2Rfc2NzaV90YXJnZXRfcmVzZXQoc3QpOworICAgIGZvciAobHVuID0gMDsgbHVu
IDwgc3QtPm1heF9sdW5zOyBsdW4rKykgeworICAgICAgICBDZFNjc2lMVSAqdW5pdCA9ICZzdC0+
dW5pdHNbbHVuXTsKKyAgICAgICAgaWYgKHVuaXQtPnJlYWxpemVkKSB7CisgICAgICAgICAgICBj
ZF9zY3NpX2Rldl91bnJlYWxpemUoc3QsIGx1bik7CisgICAgICAgIH0KKyAgICAgICAgZ19jbGVh
cl9vYmplY3QoJnVuaXQtPnN0cmVhbSk7CisgICAgfQorICAgIGdfY2xlYXJfb2JqZWN0KCZzdC0+
Y2FuY2VsbGFibGUpOworICAgIGdfZnJlZShzdCk7Cit9CisKKy8qIFNDU0kgRGV2aWNlICovCisK
K3N0YXRpYyBpbmxpbmUgZ2Jvb2xlYW4gY2Rfc2NzaV90YXJnZXRfbHVuX2xlZ2FsKGNvbnN0IENk
U2NzaVRhcmdldCAqc3QsIHVpbnQzMl90IGx1bikKK3sKKyAgICByZXR1cm4gKGx1biA8IHN0LT5t
YXhfbHVucykgPyBUUlVFIDogRkFMU0U7Cit9CisKK3N0YXRpYyBpbmxpbmUgZ2Jvb2xlYW4gY2Rf
c2NzaV90YXJnZXRfbHVuX3JlYWxpemVkKGNvbnN0IENkU2NzaVRhcmdldCAqc3QsIHVpbnQzMl90
IGx1bikKK3sKKyAgICByZXR1cm4gc3QtPnVuaXRzW2x1bl0ucmVhbGl6ZWQ7Cit9CisKK2ludCBj
ZF9zY3NpX2Rldl9yZWFsaXplKENkU2NzaVRhcmdldCAqc3QsIHVpbnQzMl90IGx1biwKKyAgICAg
ICAgICAgICAgICAgICAgICAgIGNvbnN0IENkU2NzaURldmljZVBhcmFtZXRlcnMgKmRldl9wYXJh
bXMpCit7CisgICAgQ2RTY3NpTFUgKmRldjsKKworICAgIGlmICghY2Rfc2NzaV90YXJnZXRfbHVu
X2xlZ2FsKHN0LCBsdW4pKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJSZWFsaXplLCBpbGxlZ2Fs
IGx1bjoldSIsIGx1bik7CisgICAgICAgIHJldHVybiAtMTsKKyAgICB9CisgICAgaWYgKGNkX3Nj
c2lfdGFyZ2V0X2x1bl9yZWFsaXplZChzdCwgbHVuKSkgeworICAgICAgICBTUElDRV9FUlJPUigi
UmVhbGl6ZSwgYWxyZWFkeSByZWFsaXplZCBsdW46JXUiLCBsdW4pOworICAgICAgICByZXR1cm4g
LTE7CisgICAgfQorICAgIGRldiA9ICZzdC0+dW5pdHNbbHVuXTsKKworICAgIG1lbXNldChkZXYs
IDAsIHNpemVvZigqZGV2KSk7CisgICAgZGV2LT50Z3QgPSBzdDsKKyAgICBkZXYtPmx1biA9IGx1
bjsKKworICAgIGRldi0+cmVhbGl6ZWQgPSBUUlVFOworICAgIGRldi0+cmVtb3ZhYmxlID0gVFJV
RTsKKyAgICBkZXYtPmxvYWRlZCA9IEZBTFNFOworICAgIGRldi0+cHJldmVudF9tZWRpYV9yZW1v
dmFsID0gRkFMU0U7CisgICAgZGV2LT5jZF9yb20gPSBGQUxTRTsKKworICAgIGRldi0+cG93ZXJf
Y29uZCA9IENEX1NDU0lfUE9XRVJfQUNUSVZFOworICAgIGRldi0+cG93ZXJfZXZlbnQgPSBDRF9Q
T1dFUl9FVkVOVF9OT19DSEFOR0U7CisgICAgZGV2LT5tZWRpYV9ldmVudCA9IENEX01FRElBX0VW
RU5UX05PX0NIQU5HRTsKKworICAgIGRldi0+Y2xhaW1fdmVyc2lvbiA9IDM7IC8qIDAgOiBub25l
OyAyLDMsNSA6IFNQQy9NTUMteCAqLworCisgICAgZGV2LT52ZW5kb3IgPSBnX3N0cmR1cChkZXZf
cGFyYW1zLT52ZW5kb3IpOworICAgIGRldi0+cHJvZHVjdCA9IGdfc3RyZHVwKGRldl9wYXJhbXMt
PnByb2R1Y3QpOworICAgIGRldi0+dmVyc2lvbiA9IGdfc3RyZHVwKGRldl9wYXJhbXMtPnZlcnNp
b24pOworICAgIGRldi0+c2VyaWFsID0gZ19zdHJkdXAoZGV2X3BhcmFtcy0+c2VyaWFsKTsKKwor
ICAgIGNkX3Njc2lfZGV2X3NlbnNlX3NldF9wb3dlcl9vbihkZXYpOworCisgICAgU1BJQ0VfREVC
VUcoIlJlYWxpemUgbHVuOiV1IGJzOiV1IFZSOlslc10gUFQ6WyVzXSB2ZXI6WyVzXSBTTlslc10i
LAorICAgICAgICAgICAgICAgIGx1biwgZGV2LT5ibG9ja19zaXplLCBkZXYtPnZlbmRvciwKKyAg
ICAgICAgICAgICAgICBkZXYtPnByb2R1Y3QsIGRldi0+dmVyc2lvbiwgZGV2LT5zZXJpYWwpOwor
ICAgIHJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2x1X21lZGlhX3Jlc2V0KENk
U2NzaUxVICpkZXYpCit7CisgICAgLyogbWVkaWFfZXZlbnQgaXMgbm90IHNldCBoZXJlLCBhcyBp
dCBkZXBlbmRzIG9uIHRoZSBjb250ZXh0ICovCisgICAgZ19jbGVhcl9vYmplY3QoJmRldi0+c3Ry
ZWFtKTsKKyAgICBkZXYtPnNpemUgPSAwOworICAgIGRldi0+YmxvY2tfc2l6ZSA9IDA7CisgICAg
ZGV2LT5udW1fYmxvY2tzID0gMDsKK30KKworaW50IGNkX3Njc2lfZGV2X2xvY2soQ2RTY3NpVGFy
Z2V0ICpzdCwgdWludDMyX3QgbHVuLCBnYm9vbGVhbiBsb2NrKQoreworICAgIENkU2NzaUxVICpk
ZXY7CisKKyAgICBpZiAoIWNkX3Njc2lfdGFyZ2V0X2x1bl9sZWdhbChzdCwgbHVuKSkgeworICAg
ICAgICBTUElDRV9FUlJPUigiTG9jaywgaWxsZWdhbCBsdW46JXUiLCBsdW4pOworICAgICAgICBy
ZXR1cm4gLTE7CisgICAgfQorICAgIGlmICghY2Rfc2NzaV90YXJnZXRfbHVuX3JlYWxpemVkKHN0
LCBsdW4pKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJMb2NrLCB1bnJlYWxpemVkIGx1bjoldSIs
IGx1bik7CisgICAgICAgIHJldHVybiAtMTsKKyAgICB9CisgICAgZGV2ID0gJnN0LT51bml0c1ts
dW5dOworICAgIGRldi0+cHJldmVudF9tZWRpYV9yZW1vdmFsID0gbG9jazsKKyAgICBTUElDRV9E
RUJVRygibHVuOiV1ICVzbG9jayIsIGx1biwgbG9jayA/ICJ1biIgOiIiKTsKKyAgICByZXR1cm4g
MDsKK30KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9sdV9sb2FkKENkU2NzaUxVICpkZXYsCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgQ2RTY3NpTWVkaWFQYXJhbWV0ZXJzICptZWRp
YV9wYXJhbXMpCit7CisgICAgaWYgKG1lZGlhX3BhcmFtcyAhPSBOVUxMKSB7CisgICAgICAgIGRl
di0+bWVkaWFfZXZlbnQgPSBDRF9NRURJQV9FVkVOVF9ORVdfTUVESUE7CisgICAgICAgIGRldi0+
c3RyZWFtID0gZ19vYmplY3RfcmVmKG1lZGlhX3BhcmFtcy0+c3RyZWFtKTsKKyAgICAgICAgZGV2
LT5zaXplID0gbWVkaWFfcGFyYW1zLT5zaXplOworICAgICAgICBkZXYtPmJsb2NrX3NpemUgPSBt
ZWRpYV9wYXJhbXMtPmJsb2NrX3NpemU7CisgICAgICAgIGRldi0+bnVtX2Jsb2NrcyA9IG1lZGlh
X3BhcmFtcy0+c2l6ZSAvIG1lZGlhX3BhcmFtcy0+YmxvY2tfc2l6ZTsKKyAgICAgICAgZGV2LT5s
b2FkZWQgPSBUUlVFOworICAgIH0gZWxzZSB7CisgICAgICAgIGRldi0+bWVkaWFfZXZlbnQgPSBD
RF9NRURJQV9FVkVOVF9NRURJQV9SRU1PVkFMOworICAgICAgICBjZF9zY3NpX2x1X21lZGlhX3Jl
c2V0KGRldik7CisgICAgICAgIGRldi0+bG9hZGVkID0gRkFMU0U7CisgICAgfQorfQorCitzdGF0
aWMgdm9pZCBjZF9zY3NpX2x1X3VubG9hZChDZFNjc2lMVSAqZGV2KQoreworICAgIGRldi0+bWVk
aWFfZXZlbnQgPSBDRF9NRURJQV9FVkVOVF9NRURJQV9SRU1PVkFMOworICAgIGNkX3Njc2lfbHVf
bWVkaWFfcmVzZXQoZGV2KTsKKyAgICBkZXYtPmxvYWRlZCA9IEZBTFNFOworfQorCitpbnQgY2Rf
c2NzaV9kZXZfbG9hZChDZFNjc2lUYXJnZXQgKnN0LCB1aW50MzJfdCBsdW4sCisgICAgICAgICAg
ICAgICAgICAgICBjb25zdCBDZFNjc2lNZWRpYVBhcmFtZXRlcnMgKm1lZGlhX3BhcmFtcykKK3sK
KyAgICBDZFNjc2lMVSAqZGV2OworCisgICAgaWYgKCFjZF9zY3NpX3RhcmdldF9sdW5fbGVnYWwo
c3QsIGx1bikpIHsKKyAgICAgICAgU1BJQ0VfRVJST1IoIkxvYWQsIGlsbGVnYWwgbHVuOiV1Iiwg
bHVuKTsKKyAgICAgICAgcmV0dXJuIC0xOworICAgIH0KKyAgICBpZiAoIWNkX3Njc2lfdGFyZ2V0
X2x1bl9yZWFsaXplZChzdCwgbHVuKSkgeworICAgICAgICBTUElDRV9FUlJPUigiTG9hZCwgdW5y
ZWFsaXplZCBsdW46JXUiLCBsdW4pOworICAgICAgICByZXR1cm4gLTE7CisgICAgfQorICAgIGRl
diA9ICZzdC0+dW5pdHNbbHVuXTsKKworICAgIGNkX3Njc2lfbHVfbG9hZChkZXYsIG1lZGlhX3Bh
cmFtcyk7CisgICAgZGV2LT5wb3dlcl9jb25kID0gQ0RfU0NTSV9QT1dFUl9BQ1RJVkU7CisgICAg
ZGV2LT5wb3dlcl9ldmVudCA9IENEX1BPV0VSX0VWRU5UX0NIQU5HRV9TVUNDRVNTOworCisgICAg
Y2Rfc2NzaV9kZXZfc2Vuc2Vfc2V0KGRldiwgJnNlbnNlX2NvZGVfTUVESVVNX0NIQU5HRUQpOwor
CisgICAgU1BJQ0VfREVCVUcoIkxvYWQgbHVuOiV1IHNpemU6JSIgR19HVUlOVDY0X0ZPUk1BVAor
ICAgICAgICAgICAgICAgICIgYmxrX3N6OiV1IG51bV9ibG9ja3M6JXUiLAorICAgICAgICAgICAg
ICAgIGx1biwgZGV2LT5zaXplLCBkZXYtPmJsb2NrX3NpemUsIGRldi0+bnVtX2Jsb2Nrcyk7Cisg
ICAgcmV0dXJuIDA7Cit9CisKK2ludCBjZF9zY3NpX2Rldl9nZXRfaW5mbyhDZFNjc2lUYXJnZXQg
KnN0LCB1aW50MzJfdCBsdW4sIENkU2NzaURldmljZUluZm8gKmx1bl9pbmZvKQoreworICAgIENk
U2NzaUxVICpkZXY7CisKKyAgICBpZiAoIWNkX3Njc2lfdGFyZ2V0X2x1bl9sZWdhbChzdCwgbHVu
KSkgeworICAgICAgICBTUElDRV9FUlJPUigiTG9hZCwgaWxsZWdhbCBsdW46JXUiLCBsdW4pOwor
ICAgICAgICByZXR1cm4gLTE7CisgICAgfQorICAgIGlmICghY2Rfc2NzaV90YXJnZXRfbHVuX3Jl
YWxpemVkKHN0LCBsdW4pKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJMb2FkLCB1bnJlYWxpemVk
IGx1bjoldSIsIGx1bik7CisgICAgICAgIHJldHVybiAtMTsKKyAgICB9CisgICAgZGV2ID0gJnN0
LT51bml0c1tsdW5dOworCisgICAgbHVuX2luZm8tPnN0YXJ0ZWQgPSBkZXYtPnBvd2VyX2NvbmQg
PT0gQ0RfU0NTSV9QT1dFUl9BQ1RJVkU7CisgICAgbHVuX2luZm8tPmxvY2tlZCA9IGRldi0+cHJl
dmVudF9tZWRpYV9yZW1vdmFsOworICAgIGx1bl9pbmZvLT5sb2FkZWQgPSBkZXYtPmxvYWRlZDsK
KworICAgIGx1bl9pbmZvLT5wYXJhbWV0ZXJzLnZlbmRvciA9IGRldi0+dmVuZG9yOworICAgIGx1
bl9pbmZvLT5wYXJhbWV0ZXJzLnByb2R1Y3QgPSBkZXYtPnByb2R1Y3Q7CisgICAgbHVuX2luZm8t
PnBhcmFtZXRlcnMudmVyc2lvbiA9IGRldi0+dmVyc2lvbjsKKyAgICBsdW5faW5mby0+cGFyYW1l
dGVycy5zZXJpYWwgPSBkZXYtPnNlcmlhbDsKKworICAgIHJldHVybiAwOworfQorCitpbnQgY2Rf
c2NzaV9kZXZfdW5sb2FkKENkU2NzaVRhcmdldCAqc3QsIHVpbnQzMl90IGx1bikKK3sKKyAgICBD
ZFNjc2lMVSAqZGV2OworCisgICAgaWYgKCFjZF9zY3NpX3RhcmdldF9sdW5fbGVnYWwoc3QsIGx1
bikpIHsKKyAgICAgICAgU1BJQ0VfRVJST1IoIlVubG9hZCwgaWxsZWdhbCBsdW46JXUiLCBsdW4p
OworICAgICAgICByZXR1cm4gLTE7CisgICAgfQorICAgIGlmICghY2Rfc2NzaV90YXJnZXRfbHVu
X3JlYWxpemVkKHN0LCBsdW4pKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJVbmxvYWQsIHVucmVh
bGl6ZWQgbHVuOiV1IiwgbHVuKTsKKyAgICAgICAgcmV0dXJuIC0xOworICAgIH0KKyAgICBkZXYg
PSAmc3QtPnVuaXRzW2x1bl07CisgICAgaWYgKCFkZXYtPmxvYWRlZCkgeworICAgICAgICBTUElD
RV9FUlJPUigiVW5sb2FkLCBsdW46JXUgbm90IGxvYWRlZCB5ZXQiLCBsdW4pOworICAgICAgICBy
ZXR1cm4gMDsKKyAgICB9CisgICAgaWYgKGRldi0+cHJldmVudF9tZWRpYV9yZW1vdmFsKSB7Cisg
ICAgICAgIFNQSUNFX0VSUk9SKCJVbmxvYWQsIGx1bjoldSBwcmV2ZW50X21lZGlhX3JlbW92YWwg
c2V0IiwgbHVuKTsKKyAgICAgICAgcmV0dXJuIC0xOworICAgIH0KKworICAgIGNkX3Njc2lfbHVf
dW5sb2FkKGRldik7CisgICAgZGV2LT5wb3dlcl9jb25kID0gQ0RfU0NTSV9QT1dFUl9TVE9QUEVE
OworICAgIGRldi0+cG93ZXJfZXZlbnQgPSBDRF9QT1dFUl9FVkVOVF9DSEFOR0VfU1VDQ0VTUzsK
KworICAgIGNkX3Njc2lfZGV2X3NlbnNlX3NldChkZXYsICZzZW5zZV9jb2RlX1VBX05PX01FRElV
TSk7CisKKyAgICBTUElDRV9ERUJVRygiVW5sb2FkIGx1bjoldSIsIGx1bik7CisgICAgcmV0dXJu
IDA7Cit9CisKK2ludCBjZF9zY3NpX2Rldl91bnJlYWxpemUoQ2RTY3NpVGFyZ2V0ICpzdCwgdWlu
dDMyX3QgbHVuKQoreworICAgIENkU2NzaUxVICpkZXY7CisKKyAgICBpZiAoIWNkX3Njc2lfdGFy
Z2V0X2x1bl9sZWdhbChzdCwgbHVuKSkgeworICAgICAgICBTUElDRV9FUlJPUigiVW5yZWFsaXpl
LCBpbGxlZ2FsIGx1bjoldSIsIGx1bik7CisgICAgICAgIHJldHVybiAtMTsKKyAgICB9CisgICAg
aWYgKCFjZF9zY3NpX3RhcmdldF9sdW5fcmVhbGl6ZWQoc3QsIGx1bikpIHsKKyAgICAgICAgU1BJ
Q0VfRVJST1IoIlVucmVhbGl6ZSwgYWJzZW50IGx1bjoldSIsIGx1bik7CisgICAgICAgIHJldHVy
biAtMTsKKyAgICB9CisgICAgZGV2ID0gJnN0LT51bml0c1tsdW5dOworCisgICAgZ19jbGVhcl9w
b2ludGVyKCZkZXYtPnZlbmRvciwgZ19mcmVlKTsKKyAgICBnX2NsZWFyX3BvaW50ZXIoJmRldi0+
cHJvZHVjdCwgZ19mcmVlKTsKKyAgICBnX2NsZWFyX3BvaW50ZXIoJmRldi0+dmVyc2lvbiwgZ19m
cmVlKTsKKyAgICBnX2NsZWFyX3BvaW50ZXIoJmRldi0+c2VyaWFsLCBnX2ZyZWUpOworCisgICAg
Z19jbGVhcl9vYmplY3QoJmRldi0+c3RyZWFtKTsKKworICAgIGRldi0+bG9hZGVkID0gRkFMU0U7
CisgICAgZGV2LT5yZWFsaXplZCA9IEZBTFNFOworICAgIGRldi0+cG93ZXJfY29uZCA9IENEX1ND
U0lfUE9XRVJfU1RPUFBFRDsKKworICAgIFNQSUNFX0RFQlVHKCJVbnJlYWxpemUgbHVuOiV1Iiwg
bHVuKTsKKyAgICByZXR1cm4gMDsKK30KKworaW50IGNkX3Njc2lfZGV2X3Jlc2V0KENkU2NzaVRh
cmdldCAqc3QsIHVpbnQzMl90IGx1bikKK3sKKyAgICBDZFNjc2lMVSAqZGV2OworCisgICAgaWYg
KCFjZF9zY3NpX3RhcmdldF9sdW5fbGVnYWwoc3QsIGx1bikpIHsKKyAgICAgICAgU1BJQ0VfRVJS
T1IoIkRldmljZSByZXNldCwgaWxsZWdhbCBsdW46JXUiLCBsdW4pOworICAgICAgICByZXR1cm4g
LTE7CisgICAgfQorICAgIGlmICghY2Rfc2NzaV90YXJnZXRfbHVuX3JlYWxpemVkKHN0LCBsdW4p
KSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJEZXZpY2UgcmVzZXQsIGFic2VudCBsdW46JXUiLCBs
dW4pOworICAgICAgICByZXR1cm4gLTE7CisgICAgfQorICAgIGRldiA9ICZzdC0+dW5pdHNbbHVu
XTsKKworICAgIC8qIGlmIHdlIHJlc2V0IHRoZSAncHJldmVudCcgZmxhZyB3ZSBjYW4ndCBjcmVh
dGUKKyAgICAgKiB0aGUgdW5pdCB0aGF0IGlzIGxvY2tlZCBmcm9tIHRoZSBiZWdpbm5pbmcsIHNv
CisgICAgICogd2Uga2VlcCB0aGlzIGZsYWcgYXMgcGVyc2lzdGVudCBvdmVyIHJlc2V0cworICAg
ICAqLworICAgIC8qIGRldi0+cHJldmVudF9tZWRpYV9yZW1vdmFsID0gRkFMU0U7ICovCisgICAg
ZGV2LT5wb3dlcl9jb25kID0gQ0RfU0NTSV9QT1dFUl9BQ1RJVkU7CisgICAgZGV2LT5wb3dlcl9l
dmVudCA9IENEX1BPV0VSX0VWRU5UX0NIQU5HRV9TVUNDRVNTOworICAgIGNkX3Njc2lfZGV2X3Nl
bnNlX3NldF9wb3dlcl9vbihkZXYpOworCisgICAgU1BJQ0VfREVCVUcoIkRldmljZSByZXNldCBs
dW46JXUiLCBsdW4pOworICAgIHJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX3Rh
cmdldF9kb19yZXNldChDZFNjc2lUYXJnZXQgKnN0KQoreworICAgIHVpbnQzMl90IGx1bjsKKwor
ICAgIGZvciAobHVuID0gMDsgbHVuIDwgc3QtPm1heF9sdW5zOyBsdW4rKykgeworICAgICAgICBp
ZiAoc3QtPnVuaXRzW2x1bl0ucmVhbGl6ZWQpIHsKKyAgICAgICAgICAgIGNkX3Njc2lfZGV2X3Jl
c2V0KHN0LCBsdW4pOworICAgICAgICB9CisgICAgfQorCisgICAgU1BJQ0VfREVCVUcoIlRhcmdl
dCByZXNldCBjb21wbGV0ZSIpOworICAgIHN0LT5zdGF0ZSA9IENEX1NDU0lfVEdUX1NUQVRFX1JV
Tk5JTkc7CisgICAgY2Rfc2NzaV90YXJnZXRfcmVzZXRfY29tcGxldGUoc3QtPnVzZXJfZGF0YSk7
Cit9CisKK2ludCBjZF9zY3NpX3RhcmdldF9yZXNldChDZFNjc2lUYXJnZXQgKnN0KQoreworICAg
IGlmIChzdC0+c3RhdGUgPT0gQ0RfU0NTSV9UR1RfU1RBVEVfUkVTRVQpIHsKKyAgICAgICAgU1BJ
Q0VfREVCVUcoIlRhcmdldCBhbHJlYWR5IGluIHJlc2V0Iik7CisgICAgICAgIHJldHVybiAtMTsK
KyAgICB9CisKKyAgICBzdC0+c3RhdGUgPSBDRF9TQ1NJX1RHVF9TVEFURV9SRVNFVDsKKworICAg
IGlmIChzdC0+Y3VyX3JlcSAhPSBOVUxMKSB7CisgICAgICAgIGNkX3Njc2lfZGV2X3JlcXVlc3Rf
Y2FuY2VsKHN0LCBzdC0+Y3VyX3JlcSk7CisgICAgICAgIGlmIChzdC0+Y3VyX3JlcSAhPSBOVUxM
KSB7CisgICAgICAgICAgICBTUElDRV9ERUJVRygiVGFyZ2V0IHJlc2V0IGluIHByb2dyZXNzLi4u
Iik7CisgICAgICAgICAgICByZXR1cm4gMDsKKyAgICAgICAgfQorICAgIH0KKworICAgIGNkX3Nj
c2lfdGFyZ2V0X2RvX3Jlc2V0KHN0KTsKKyAgICByZXR1cm4gMDsKK30KKworQ2RTY3NpUmVxU3Rh
dGUgY2Rfc2NzaV9nZXRfcmVxX3N0YXRlKENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICByZXR1
cm4gcmVxLT5yZXFfc3RhdGU7Cit9CisKK3N0YXRpYyB2b2lkIHN0cnBhZGNweShjaGFyICpidWYs
IGludCBidWZfc2l6ZSwgY29uc3QgY2hhciAqc3RyLCBjaGFyIHBhZCkKK3sKKyAgICBpbnQgbGVu
ID0gc3RybmxlbihzdHIsIGJ1Zl9zaXplKTsKKyAgICBtZW1jcHkoYnVmLCBzdHIsIGxlbik7Cisg
ICAgbWVtc2V0KGJ1ZiArIGxlbiwgcGFkLCBidWZfc2l6ZSAtIGxlbik7Cit9CisKKy8qIFNDU0kg
Q0RCICovCisKK3N0YXRpYyB1bnNpZ25lZCBpbnQgc2NzaV9jZGJfbGVuZ3RoKGNvbnN0IHVpbnQ4
X3QgKmNkYikKK3sKKyAgICB1bnNpZ25lZCBpbnQgY2RiX2xlbjsKKworICAgIHN3aXRjaCAoY2Ri
WzBdID4+IDUpIHsKKyAgICBjYXNlIDA6CisgICAgICAgIGNkYl9sZW4gPSA2OworICAgICAgICBi
cmVhazsKKyAgICBjYXNlIDE6CisgICAgY2FzZSAyOgorICAgICAgICBjZGJfbGVuID0gMTA7Cisg
ICAgICAgIGJyZWFrOworICAgIGNhc2UgNDoKKyAgICAgICAgY2RiX2xlbiA9IDE2OworICAgICAg
ICBicmVhazsKKyAgICBjYXNlIDU6CisgICAgICAgIGNkYl9sZW4gPSAxMjsKKyAgICAgICAgYnJl
YWs7CisgICAgZGVmYXVsdDoKKyAgICAgICAgY2RiX2xlbiA9IDA7CisgICAgfQorICAgIHJldHVy
biBjZGJfbGVuOworfQorCitzdGF0aWMgdWludDY0X3Qgc2NzaV9jZGJfbGJhKGNvbnN0IHVpbnQ4
X3QgKmNkYiwgaW50IGNkYl9sZW4pCit7CisgICAgdWludDY0X3QgbGJhOworCisgICAgc3dpdGNo
IChjZGJfbGVuKSB7CisgICAgY2FzZSA2OgorICAgICAgICBsYmEgPSAoKCh1aW50NjRfdCkoY2Ri
WzFdICYgMHgxZikpIDw8IDE2KSB8CisgICAgICAgICAgICAgICgoKHVpbnQ2NF90KWNkYlsyXSkg
PDwgOCkgfAorICAgICAgICAgICAgICAgKCh1aW50NjRfdCljZGJbM10pOworICAgICAgICBicmVh
azsKKyAgICBjYXNlIDEwOgorICAgIGNhc2UgMTI6CisgICAgICAgIGxiYSA9ICgoKHVpbnQ2NF90
KWNkYlsyXSkgPDwgMjQpIHwKKyAgICAgICAgICAgICAgKCgodWludDY0X3QpY2RiWzNdKSA8PCAx
NikgfAorICAgICAgICAgICAgICAoKCh1aW50NjRfdCljZGJbNF0pIDw8IDgpICB8CisgICAgICAg
ICAgICAgICAoKHVpbnQ2NF90KWNkYls1XSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgMTY6
CisgICAgICAgIGxiYSA9ICgoKHVpbnQ2NF90KWNkYlsyXSkgPDwgNTYpIHwKKyAgICAgICAgICAg
ICAgKCgodWludDY0X3QpY2RiWzNdKSA8PCA0OCkgfAorICAgICAgICAgICAgICAoKCh1aW50NjRf
dCljZGJbNF0pIDw8IDQwKSB8CisgICAgICAgICAgICAgICgoKHVpbnQ2NF90KWNkYls1XSkgPDwg
MzIpIHwKKyAgICAgICAgICAgICAgKCgodWludDY0X3QpY2RiWzZdKSA8PCAyNCkgfAorICAgICAg
ICAgICAgICAoKCh1aW50NjRfdCljZGJbN10pIDw8IDE2KSB8CisgICAgICAgICAgICAgICgoKHVp
bnQ2NF90KWNkYls4XSkgPDwgOCkgIHwKKyAgICAgICAgICAgICAgICgodWludDY0X3QpY2RiWzld
KTsKKyAgICAgICAgYnJlYWs7CisgICAgZGVmYXVsdDoKKyAgICAgICAgbGJhID0gMDsKKyAgICB9
CisgICAgcmV0dXJuIGxiYTsKK30KKworc3RhdGljIHVpbnQzMl90IHNjc2lfY2RiX3hmZXJfbGVu
Z3RoKGNvbnN0IHVpbnQ4X3QgKmNkYiwgaW50IGNkYl9sZW4pCit7CisgICAgdWludDMyX3QgbGVu
OworCisgICAgc3dpdGNoIChjZGJfbGVuKSB7CisgICAgY2FzZSA2OgorICAgICAgICBsZW4gPSAo
dWludDMyX3QpY2RiWzRdOworICAgICAgICBpZiAobGVuID09IDApCisgICAgICAgICAgICBsZW4g
PSAyNTY7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgMTA6CisgICAgICAgIGxlbiA9ICgoKHVp
bnQzMl90KWNkYls3XSkgPDwgOCkgfAorICAgICAgICAgICAgICAgKCh1aW50MzJfdCljZGJbOF0p
OworICAgICAgICBicmVhazsKKyAgICBjYXNlIDEyOgorICAgICAgICBsZW4gPSAoKCh1aW50MzJf
dCljZGJbNl0pIDw8IDI0KSB8CisgICAgICAgICAgICAgICgoKHVpbnQzMl90KWNkYls3XSkgPDwg
MTYpIHwKKyAgICAgICAgICAgICAgKCgodWludDMyX3QpY2RiWzhdKSA8PCA4KSAgfAorICAgICAg
ICAgICAgICAgKCh1aW50MzJfdCljZGJbOV0pOworICAgICAgICBicmVhazsKKyAgICBjYXNlIDE2
OgorICAgICAgICBsZW4gPSAoKCh1aW50MzJfdCljZGJbMTBdKSA8PCAyNCkgfAorICAgICAgICAg
ICAgICAoKCh1aW50MzJfdCljZGJbMTFdKSA8PCAxNikgfAorICAgICAgICAgICAgICAoKCh1aW50
MzJfdCljZGJbMTJdKSA8PCA4KSAgfAorICAgICAgICAgICAgICAgKCh1aW50MzJfdCljZGJbMTNd
KTsKKyAgICAgICAgYnJlYWs7CisgICAgZGVmYXVsdDoKKyAgICAgICAgbGVuID0gMDsKKyAgICAg
ICAgYnJlYWs7CisgICAgfQorICAgIHJldHVybiBsZW47Cit9CisKKy8qIFNDU0kgY29tbWFuZHMg
Ki8KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRfdGVzdF91bml0X3JlYWR5KENkU2NzaUxVICpk
ZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICByZXEtPnhmZXJfZGlyID0gU0NTSV9YRkVS
X05PTkU7CisgICAgcmVxLT5pbl9sZW4gPSAwOworCisgICAgaWYgKGRldi0+bG9hZGVkKSB7Cisg
ICAgICAgIGlmIChkZXYtPnBvd2VyX2NvbmQgIT0gQ0RfU0NTSV9QT1dFUl9TVE9QUEVEKSB7Cisg
ICAgICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKKyAgICAgICAg
fSBlbHNlIHsKKyAgICAgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2
LCByZXEsICZzZW5zZV9jb2RlX0lOSVRfQ01EX1JFUVVJUkVEKTsKKyAgICAgICAgfQorICAgIH0g
ZWxzZSB7CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEs
ICZzZW5zZV9jb2RlX05PVF9SRUFEWV9OT19NRURJVU0pOworICAgIH0KK30KKworc3RhdGljIHZv
aWQgY2Rfc2NzaV9jbWRfcmVxdWVzdF9zZW5zZShDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0
ICpyZXEpCit7CisgICAgcmVxLT54ZmVyX2RpciA9IFNDU0lfWEZFUl9GUk9NX0RFVjsKKworICAg
IHJlcS0+cmVxX2xlbiA9IHJlcS0+Y2RiWzRdOworICAgIHJlcS0+aW5fbGVuID0gTUlOKHJlcS0+
cmVxX2xlbiwgc2l6ZW9mKGRldi0+Zml4ZWRfc2Vuc2UpKTsKKworICAgIGlmIChkZXYtPnNob3J0
X3NlbnNlLmtleSAhPSBOT19TRU5TRSkgeworICAgICAgICBTUElDRV9ERUJVRygiJXMsIGx1bjol
dSByZXBvcnRlZCBzZW5zZTogMHglMDJ4ICUwMnggJTAyeCAtICVzLCAlcyIsCisgICAgICAgICAg
ICAgICAgICAgIF9fRlVOQ1RJT05fXywgcmVxLT5sdW4sCisgICAgICAgICAgICAgICAgICAgIGRl
di0+c2hvcnRfc2Vuc2Uua2V5LCBkZXYtPnNob3J0X3NlbnNlLmFzYywgZGV2LT5zaG9ydF9zZW5z
ZS5hc2NxLAorICAgICAgICAgICAgICAgICAgICBjZF9zY3NpX3NlbnNlX2tleV9kZXNjcihkZXYt
PnNob3J0X3NlbnNlLmtleSksCisgICAgICAgICAgICAgICAgICAgIGRldi0+c2hvcnRfc2Vuc2Uu
ZGVzY3IpOworICAgIH0KKyAgICBtZW1jcHkocmVxLT5idWYsIGRldi0+Zml4ZWRfc2Vuc2UsIHNp
emVvZihkZXYtPmZpeGVkX3NlbnNlKSk7CisgICAgY2Rfc2NzaV9kZXZfc2Vuc2VfcmVzZXQoZGV2
KTsgLyogY2xlYXIgcmVwb3J0ZWQgc2Vuc2UgKi8KKworICAgIGNkX3Njc2lfY21kX2NvbXBsZXRl
X2dvb2QoZGV2LCByZXEpOworfQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9yZXBvcnRfbHVu
cyhDZFNjc2lUYXJnZXQgKnN0LCBDZFNjc2lMVSAqZGV2LAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgQ2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAgIHVpbnQ4X3QgKm91dF9i
dWYgPSByZXEtPmJ1ZjsKKyAgICB1aW50MzJfdCBtYXhfbHVucyA9IHN0LT5tYXhfbHVuczsKKyAg
ICB1aW50MzJfdCBidWZsZW4gPSA4OyAvKiBoZWFkZXIgbGVuZ3RoICovCisgICAgdWludDMyX3Qg
bHVuOworCisgICAgcmVxLT5yZXFfbGVuID0gc2NzaV9jZGJfeGZlcl9sZW5ndGgocmVxLT5jZGIs
IDEyKTsKKyAgICByZXEtPnhmZXJfZGlyID0gU0NTSV9YRkVSX0ZST01fREVWOworCisgICAgLyog
Y2hlY2sgU0VMRUNUIFJFUE9SVCBmaWVsZCAqLworICAgIGlmIChyZXEtPmNkYlsyXSA9PSAweDAx
KSB7CisgICAgICAgIC8qIG9ubHkgd2VsbCBrbm93biBsb2dpY2FsIHVuaXRzICovCisgICAgICAg
IG1heF9sdW5zID0gMDsKKyAgICB9CisKKyAgICBtZW1zZXQob3V0X2J1ZiwgMCwgOCk7CisKKyAg
ICBmb3IgKGx1biA9IDA7IGx1biA8IG1heF9sdW5zOyBsdW4rKykgeworICAgICAgICBpZiAoc3Qt
PnVuaXRzW2x1bl0ucmVhbGl6ZWQpIHsKKyAgICAgICAgICAgIG91dF9idWZbYnVmbGVuKytdID0g
MDsKKyAgICAgICAgICAgIG91dF9idWZbYnVmbGVuKytdID0gKHVpbnQ4X3QpKGx1bik7CisgICAg
ICAgICAgICBtZW1zZXQoJm91dF9idWZbYnVmbGVuXSwgMCwgNik7CisgICAgICAgICAgICBidWZs
ZW4gKz0gNjsKKyAgICAgICAgfQorICAgIH0KKworICAgIC8qIGZpbGwgTFVOIExJU1QgTEVOR1RI
ICovCisgICAgb3V0X2J1ZlswXSA9ICh1aW50OF90KSgoYnVmbGVuLTgpID4+IDI0KTsKKyAgICBv
dXRfYnVmWzFdID0gKHVpbnQ4X3QpKChidWZsZW4tOCkgPj4gMTYpOworICAgIG91dF9idWZbMl0g
PSAodWludDhfdCkoKGJ1Zmxlbi04KSA+PiA4KTsKKyAgICBvdXRfYnVmWzNdID0gKHVpbnQ4X3Qp
KChidWZsZW4tOCkpOworCisgICAgcmVxLT5pbl9sZW4gPSBidWZsZW47CisgICAgY2Rfc2NzaV9j
bWRfY29tcGxldGVfZ29vZChkZXYsIHJlcSk7Cit9CisKKyNkZWZpbmUgU0NTSV9NQVhfSU5RVUlS
WV9MRU4gICAgICAgIDI1NgorI2RlZmluZSBTQ1NJX01BWF9NT0RFX0xFTiAgICAgICAgICAgMjU2
CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX2lucXVpcnlfdnBkX25vX2x1bihDZFNjc2lMVSAq
ZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgdWludDMyX3QgcGVyaWZfcXVhbCkKK3sKKyAgICB1aW50OF90ICpvdXRidWYg
PSByZXEtPmJ1ZjsKKyAgICB1aW50OF90IHBhZ2VfY29kZSA9IHJlcS0+Y2RiWzJdOworICAgIHVp
bnQzMl90IHJlc3BfbGVuID0gNDsKKworICAgIG91dGJ1ZlswXSA9IChwZXJpZl9xdWFsIDw8IDUp
IHwgVFlQRV9ST007CisgICAgb3V0YnVmWzFdID0gcGFnZV9jb2RlIDsgLyogdGhpcyBwYWdlICov
CisgICAgb3V0YnVmWzJdID0gMHgwMDsgLyogcGFnZSBsZW5ndGggTVNCICovCisgICAgb3V0YnVm
WzNdID0gMHgwMDsgLyogcGFnZSBsZW5ndGggTFNCIC0gbm8gbW9yZSBkYXRhICovCisKKyAgICBy
ZXEtPmluX2xlbiA9IE1JTihyZXEtPnJlcV9sZW4sIHJlc3BfbGVuKTsKKworICAgIFNQSUNFX0RF
QlVHKCJpbnF1aXJ5X3ZwZCwgdW5zdXBwb3J0ZWQgbHVuOiV1IgorICAgICAgICAgICAgICAgICIg
cGVyaWZfcXVhbDoweCV4IHJlc3BfbGVuOiAlIiBHX0dVSU5UNjRfRk9STUFULAorICAgICAgICAg
ICAgICAgIHJlcS0+bHVuLCBwZXJpZl9xdWFsLCByZXEtPmluX2xlbik7CisKKyAgICBjZF9zY3Np
X2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9j
bWRfaW5xdWlyeV92cGQoQ2RTY3NpTFUgKmRldiwgQ2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAg
IHVpbnQ4X3QgKm91dGJ1ZiA9IHJlcS0+YnVmOworICAgIHVpbnQ4X3QgcGFnZV9jb2RlID0gcmVx
LT5jZGJbMl07CisgICAgaW50IGJ1ZmxlbiA9IDQ7CisgICAgaW50IHN0YXJ0ID0gNDsKKworICAg
IG91dGJ1ZlswXSA9IFRZUEVfUk9NOworICAgIG91dGJ1ZlsxXSA9IHBhZ2VfY29kZSA7IC8qIHRo
aXMgcGFnZSAqLworICAgIG91dGJ1ZlsyXSA9IDB4MDA7IC8qIHBhZ2UgbGVuZ3RoIE1TQiAqLwor
ICAgIG91dGJ1ZlszXSA9IDB4MDA7IC8qIHBhZ2UgbGVuZ3RoIExTQiwgdG8gd3JpdGUgbGF0ZXIg
Ki8KKworICAgIHN3aXRjaCAocGFnZV9jb2RlKSB7CisgICAgY2FzZSAweDAwOiAvKiBTdXBwb3J0
ZWQgcGFnZSBjb2RlcywgbWFuZGF0b3J5ICovCisgICAgeworICAgICAgICBvdXRidWZbYnVmbGVu
KytdID0gMHgwMDsgLy8gbGlzdCBvZiBzdXBwb3J0ZWQgcGFnZXMgKHRoaXMgcGFnZSkKKyAgICAg
ICAgaWYgKGRldi0+c2VyaWFsKSB7CisgICAgICAgICAgICBvdXRidWZbYnVmbGVuKytdID0gMHg4
MDsgLy8gdW5pdCBzZXJpYWwgbnVtYmVyCisgICAgICAgIH0KKyAgICAgICAgb3V0YnVmW2J1Zmxl
bisrXSA9IDB4ODM7IC8vIGRldmljZSBpZGVudGlmaWNhdGlvbgorCisgICAgICAgIFNQSUNFX0RF
QlVHKCJJbnF1aXJ5IEVWUERbU3VwcG9ydGVkIHBhZ2VzXSBsdW46JXUiCisgICAgICAgICAgICAg
ICAgICAgICIgcmVxX2xlbjogJSIgR19HVUlOVDY0X0ZPUk1BVCAiIHJlc3BfbGVuOiAlZCIsCisg
ICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuLCByZXEtPnJlcV9sZW4sIGJ1Zmxlbik7CisgICAg
ICAgIGJyZWFrOworICAgIH0KKyAgICBjYXNlIDB4ODA6IC8qIERldmljZSBzZXJpYWwgbnVtYmVy
LCBvcHRpb25hbCAqLworICAgIHsKKyAgICAgICAgaW50IHNlcmlhbF9sZW47CisKKyAgICAgICAg
c2VyaWFsX2xlbiA9IHN0cmxlbihkZXYtPnNlcmlhbCk7CisgICAgICAgIGlmIChzZXJpYWxfbGVu
ID4gMzYpIHsKKyAgICAgICAgICAgIHNlcmlhbF9sZW4gPSAzNjsKKyAgICAgICAgfQorICAgICAg
ICBtZW1jcHkob3V0YnVmK2J1ZmxlbiwgZGV2LT5zZXJpYWwsIHNlcmlhbF9sZW4pOworICAgICAg
ICBidWZsZW4gKz0gc2VyaWFsX2xlbjsKKworICAgICAgICBTUElDRV9ERUJVRygiSW5xdWlyeSBF
VlBEW1NlcmlhbCBudW1dIGx1bjoldSIKKyAgICAgICAgICAgICAgICAgICAgIiByZXFfbGVuOiAl
IiBHX0dVSU5UNjRfRk9STUFUICIgcmVzcF9sZW46ICVkIiwKKyAgICAgICAgICAgICAgICAgICAg
cmVxLT5sdW4sIHJlcS0+cmVxX2xlbiwgYnVmbGVuKTsKKyAgICAgICAgYnJlYWs7CisgICAgfQor
ICAgIGNhc2UgMHg4MzogLyogRGV2aWNlIGlkZW50aWZpY2F0aW9uIHBhZ2UsIG1hbmRhdG9yeSAq
LworICAgIHsKKyAgICAgICAgaW50IHNlcmlhbF9sZW4gPSBzdHJsZW4oZGV2LT5zZXJpYWwpOwor
ICAgICAgICBpbnQgbWF4X2xlbiA9IDIwOworCisgICAgICAgIGlmIChzZXJpYWxfbGVuID4gbWF4
X2xlbikgeworICAgICAgICAgICAgc2VyaWFsX2xlbiA9IG1heF9sZW47CisgICAgICAgIH0KKwor
ICAgICAgICBvdXRidWZbYnVmbGVuKytdID0gMHgyOyAvLyBBU0NJSQorICAgICAgICBvdXRidWZb
YnVmbGVuKytdID0gMDsgICAvLyBub3Qgb2ZmaWNpYWxseSBhc3NpZ25lZAorICAgICAgICBvdXRi
dWZbYnVmbGVuKytdID0gMDsgICAvLyByZXNlcnZlZAorICAgICAgICBvdXRidWZbYnVmbGVuKytd
ID0gc2VyaWFsX2xlbjsgLy8gbGVuZ3RoIG9mIGRhdGEgZm9sbG93aW5nCisKKyAgICAgICAgbWVt
Y3B5KG91dGJ1ZitidWZsZW4sIGRldi0+c2VyaWFsLCBzZXJpYWxfbGVuKTsKKyAgICAgICAgYnVm
bGVuICs9IHNlcmlhbF9sZW47CisKKyAgICAgICAgU1BJQ0VfREVCVUcoIklucXVpcnkgRVZQRFtE
ZXZpY2UgaWRdIGx1bjoldSIKKyAgICAgICAgICAgICAgICAgICAgIiByZXFfbGVuOiAlIiBHX0dV
SU5UNjRfRk9STUFUICIgcmVzcF9sZW46ICVkIiwKKyAgICAgICAgICAgICAgICAgICAgcmVxLT5s
dW4sIHJlcS0+cmVxX2xlbiwgYnVmbGVuKTsKKyAgICAgICAgYnJlYWs7CisgICAgfQorCisgICAg
ZGVmYXVsdDoKKyAgICAgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJl
cSwgJnNlbnNlX2NvZGVfSU5WQUxJRF9DREJfRklFTEQpOworICAgICAgICBTUElDRV9ERUJVRygi
aW5xdWlyeV9zdGFuZGFyZCwgbHVuOiV1IGludmFsaWQgcGFnZV9jb2RlOiAlMDJ4IiwKKyAgICAg
ICAgICAgICAgICAgICAgcmVxLT5sdW4sIChpbnQpcGFnZV9jb2RlKTsKKyAgICAgICAgcmV0dXJu
OworICAgIH0KKworICAgIC8qIGRvbmUgd2l0aCBFVlBEICovCisgICAgZ19hc3NlcnQoYnVmbGVu
IC0gc3RhcnQgPD0gMjU1KTsKKyAgICBvdXRidWZbM10gPSBidWZsZW4gLSBzdGFydDsgLyogcGFn
ZSBsZW5ndGggTFNCICovCisKKyAgICByZXEtPmluX2xlbiA9IGJ1ZmxlbjsKKyAgICBjZF9zY3Np
X2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworI2RlZmluZSBJTlFVSVJZX1NUQU5E
QVJEX0xFTl9NSU4gICAgICAgICAgICAzNgorI2RlZmluZSBJTlFVSVJZX1NUQU5EQVJEX0xFTiAg
ICAgICAgICAgICAgICA5NgorI2RlZmluZSBJTlFVSVJZX1NUQU5EQVJEX0xFTl9OT19WRVIgICAg
ICAgICA1NworCisjZGVmaW5lIFBFUklGX1FVQUxJRklFUl9DT05ORUNURUQgICAgICAgICAgIDB4
MDAKKyNkZWZpbmUgUEVSSUZfUVVBTElGSUVSX05PVF9DT05ORUNURUQgICAgICAgMHgwMQorI2Rl
ZmluZSBQRVJJRl9RVUFMSUZJRVJfVU5TVVBQT1JURUQgICAgICAgICAweDAzCisKKyNkZWZpbmUg
SU5RVUlSWV9SRU1PVkFCTEVfTUVESVVNICAgICAgICAgICAgMHg4MAorCisjZGVmaW5lIElOUVVJ
UllfVkVSU0lPTl9OT05FICAgICAgICAgICAgICAgIDB4MDAKKyNkZWZpbmUgSU5RVUlSWV9WRVJT
SU9OX1NQQzMgICAgICAgICAgICAgICAgMHgwNQorCisvKiBieXRlIDMgKi8KKyNkZWZpbmUgSU5R
VUlSWV9SRVNQX0hJU1VQICAgICAgICAgICAgICAgICAgKDB4MDEgPDwgNCkKKyNkZWZpbmUgSU5R
VUlSWV9SRVNQX05PUk1fQUNBICAgICAgICAgICAgICAgKDB4MDEgPDwgNSkKKyNkZWZpbmUgSU5R
VUlSWV9SRVNQX0RBVEFfRk9STUFUX1NQQzMgICAgICAgMHgwMgorCisjZGVmaW5lIElOUVVJUllf
VkVSU0lPTl9ERVNDX1NBTTIgICAgICAgICAgIDB4MDQwCisjZGVmaW5lIElOUVVJUllfVkVSU0lP
Tl9ERVNDX1NQQzMgICAgICAgICAgIDB4MzAwCisjZGVmaW5lIElOUVVJUllfVkVSU0lPTl9ERVND
X01NQzMgICAgICAgICAgIDB4MkEwCisjZGVmaW5lIElOUVVJUllfVkVSU0lPTl9ERVNDX1NCQzIg
ICAgICAgICAgIDB4MzIwCisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX2lucXVpcnlfc3RhbmRh
cmRfbm9fbHVuKENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSwKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IHBlcmlmX3F1YWwp
Cit7CisgICAgdWludDhfdCAqb3V0YnVmID0gcmVxLT5idWY7CisgICAgdWludDMyX3QgcmVzcF9s
ZW4gPSBJTlFVSVJZX1NUQU5EQVJEX0xFTl9NSU47CisKKyAgICBtZW1zZXQocmVxLT5idWYsIDAs
IElOUVVJUllfU1RBTkRBUkRfTEVOX01JTik7CisKKyAgICBvdXRidWZbMF0gPSAocGVyaWZfcXVh
bCA8PCA1KSB8IFRZUEVfUk9NOworICAgIG91dGJ1ZlsyXSA9IElOUVVJUllfVkVSU0lPTl9OT05F
OworICAgIG91dGJ1ZlszXSA9IElOUVVJUllfUkVTUF9EQVRBX0ZPUk1BVF9TUEMzOworCisgICAg
b3V0YnVmWzRdID0gcmVzcF9sZW4gLSA0OyAvKiBhZGRpdGlvbmFsIGxlbmd0aCwgYWZ0ZXIgaGVh
ZGVyICovCisKKyAgICByZXEtPmluX2xlbiA9IE1JTihyZXEtPnJlcV9sZW4sIHJlc3BfbGVuKTsK
KworICAgIFNQSUNFX0RFQlVHKCJpbnF1aXJ5X3N0YW5kYXJkLCB1bnN1cHBvcnRlZCBsdW46JXUg
cGVyaWZfcXVhbDoweCV4ICIKKyAgICAgICAgICAgICAgICAiaW5xdWlyeV9sZW46ICV1IHJlc3Bf
bGVuOiAlIiBHX0dVSU5UNjRfRk9STUFULAorICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBwZXJp
Zl9xdWFsLCByZXNwX2xlbiwgcmVxLT5pbl9sZW4pOworCisgICAgY2Rfc2NzaV9jbWRfY29tcGxl
dGVfZ29vZChkZXYsIHJlcSk7Cit9CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX2lucXVpcnlf
c3RhbmRhcmQoQ2RTY3NpTFUgKmRldiwgQ2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAgIHVpbnQ4
X3QgKm91dGJ1ZiA9IHJlcS0+YnVmOworICAgIHVpbnQzMl90IHJlc3BfbGVuID0KKyAgICAgICAg
KGRldi0+Y2xhaW1fdmVyc2lvbiA9PSAwKSA/IElOUVVJUllfU1RBTkRBUkRfTEVOX05PX1ZFUiA6
IElOUVVJUllfU1RBTkRBUkRfTEVOOworCisgICAgb3V0YnVmWzBdID0gKFBFUklGX1FVQUxJRklF
Ul9DT05ORUNURUQgPDwgNSkgfCBUWVBFX1JPTTsKKyAgICBvdXRidWZbMV0gPSAoZGV2LT5yZW1v
dmFibGUpID8gSU5RVUlSWV9SRU1PVkFCTEVfTUVESVVNIDogMDsKKyAgICBvdXRidWZbMl0gPSAo
ZGV2LT5jbGFpbV92ZXJzaW9uID09IDApID8gSU5RVUlSWV9WRVJTSU9OX05PTkUgOiBJTlFVSVJZ
X1ZFUlNJT05fU1BDMzsKKyAgICBvdXRidWZbM10gPSBJTlFVSVJZX1JFU1BfTk9STV9BQ0EgfCBJ
TlFVSVJZX1JFU1BfSElTVVAgfCBJTlFVSVJZX1JFU1BfREFUQV9GT1JNQVRfU1BDMzsKKworICAg
IG91dGJ1Zls0XSA9IHJlc3BfbGVuIC0gNDsgLyogYWRkaXRpb25hbCBsZW5ndGgsIGFmdGVyIGhl
YWRlciAqLworCisgICAgLyogKG91dGJ1Zls2LDddID0gMCkgbWVhbnMgYWxzbyB7QlF1ZT0wLENt
ZFF1ZT0wfSAtIG5vIHF1ZXVlaW5nIGF0IGFsbCAqLworCisgICAgc3RycGFkY3B5KChjaGFyICop
ICZvdXRidWZbOF0sIDgsIGRldi0+dmVuZG9yLCAnICcpOworICAgIHN0cnBhZGNweSgoY2hhciAq
KSAmb3V0YnVmWzE2XSwgMTYsIGRldi0+cHJvZHVjdCwgJyAnKTsKKyAgICBtZW1jcHkoJm91dGJ1
ZlszMl0sIGRldi0+dmVyc2lvbiwgTUlOKDQsIHN0cmxlbihkZXYtPnZlcnNpb24pKSk7CisKKyAg
ICBpZiAoZGV2LT5jbGFpbV92ZXJzaW9uID4gMCkgeworICAgICAgICAvKiBub3cgc3VwcG9ydGlu
ZyBvbmx5IDMgKi8KKyAgICAgICAgb3V0YnVmWzU4XSA9IChJTlFVSVJZX1ZFUlNJT05fREVTQ19T
QU0yID4+IDgpICYgMHhmZjsKKyAgICAgICAgb3V0YnVmWzU5XSA9IElOUVVJUllfVkVSU0lPTl9E
RVNDX1NBTTIgJiAweGZmOworCisgICAgICAgIG91dGJ1Zls2MF0gPSAoSU5RVUlSWV9WRVJTSU9O
X0RFU0NfU1BDMyA+PiA4KSAmIDB4ZmY7CisgICAgICAgIG91dGJ1Zls2MV0gPSBJTlFVSVJZX1ZF
UlNJT05fREVTQ19TUEMzICYgMHhmZjsKKworICAgICAgICBvdXRidWZbNjJdID0gKElOUVVJUllf
VkVSU0lPTl9ERVNDX01NQzMgPj4gOCkgJiAweGZmOworICAgICAgICBvdXRidWZbNjNdID0gSU5R
VUlSWV9WRVJTSU9OX0RFU0NfTU1DMyAmIDB4ZmY7CisKKyAgICAgICAgb3V0YnVmWzY0XSA9IChJ
TlFVSVJZX1ZFUlNJT05fREVTQ19TQkMyID4+IDgpICYgMHhmZjsKKyAgICAgICAgb3V0YnVmWzY1
XSA9IElOUVVJUllfVkVSU0lPTl9ERVNDX1NCQzIgJiAweGZmOworICAgIH0KKworICAgIHJlcS0+
aW5fbGVuID0gTUlOKHJlcS0+cmVxX2xlbiwgcmVzcF9sZW4pOworCisgICAgU1BJQ0VfREVCVUco
ImlucXVpcnlfc3RhbmRhcmQsIGx1bjoldSIKKyAgICAgICAgICAgICAgICAiIGlucXVpcnlfbGVu
OiAldSByZXNwX2xlbjogJSIgR19HVUlOVDY0X0ZPUk1BVCwKKyAgICAgICAgICAgICAgICByZXEt
Pmx1biwgcmVzcF9sZW4sIHJlcS0+aW5fbGVuKTsKKworICAgIGNkX3Njc2lfY21kX2NvbXBsZXRl
X2dvb2QoZGV2LCByZXEpOworfQorCisjZGVmaW5lIENEX0lOUVVJUllfRkxBR19FVlBEICAgICAg
ICAgICAgICAgIDB4MDEKKyNkZWZpbmUgQ0RfSU5RVUlSWV9GTEFHX0NNRF9EVCAgICAgICAgICAg
ICAgMHgwMgorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9pbnF1aXJ5KENkU2NzaUxVICpkZXYs
IENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICBnYm9vbGVhbiBldnBkLCBjbWRfZGF0YTsKKwor
ICAgIHJlcS0+eGZlcl9kaXIgPSBTQ1NJX1hGRVJfRlJPTV9ERVY7CisKKyAgICBldnBkID0gKHJl
cS0+Y2RiWzFdICYgQ0RfSU5RVUlSWV9GTEFHX0VWUEQpID8gVFJVRSA6IEZBTFNFOworICAgIGNt
ZF9kYXRhID0gKHJlcS0+Y2RiWzFdICYgQ0RfSU5RVUlSWV9GTEFHX0NNRF9EVCkgPyBUUlVFIDog
RkFMU0U7CisKKyAgICBpZiAoY21kX2RhdGEpIHsKKyAgICAgICAgU1BJQ0VfREVCVUcoImlucXVp
cnksIGx1bjoldSBDbWREVCBiaXQgc2V0IC0gdW5zdXBwb3J0ZWQsICIKKyAgICAgICAgICAgICAg
ICAgICAgImNkYlsxXToweCUwMnggY2RiWzFdOjB4JTAyeCIsCisgICAgICAgICAgICAgICAgICAg
IHJlcS0+bHVuLCAoaW50KXJlcS0+Y2RiWzFdLCAoaW50KXJlcS0+Y2RiWzJdKTsKKyAgICAgICAg
Y2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfSU5W
QUxJRF9DREJfRklFTEQpOworICAgICAgICByZXR1cm47CisgICAgfQorCisgICAgcmVxLT5yZXFf
bGVuID0gcmVxLT5jZGJbNF0gfCAocmVxLT5jZGJbM10gPDwgOCk7CisgICAgbWVtc2V0KHJlcS0+
YnVmLCAwLCByZXEtPnJlcV9sZW4pOworCisgICAgaWYgKGV2cGQpIHsgLyogZW5hYmxlIHZpdGFs
IHByb2R1Y3QgZGF0YSAqLworICAgICAgICBjZF9zY3NpX2NtZF9pbnF1aXJ5X3ZwZChkZXYsIHJl
cSk7CisgICAgfSBlbHNlIHsgLyogc3RhbmRhcmQgaW5xdWlyeSBkYXRhICovCisgICAgICAgIGlm
IChyZXEtPmNkYlsyXSAhPSAwKSB7CisgICAgICAgICAgICBTUElDRV9ERUJVRygiaW5xdWlyeV9z
dGFuZGFyZCwgbHVuOiV1IG5vbi16ZXJvIHBhZ2UgY29kZTogJTAyeCIsCisgICAgICAgICAgICAg
ICAgICAgICAgICByZXEtPmx1biwgKGludClyZXEtPmNkYlsyXSk7CisgICAgICAgICAgICBjZF9z
Y3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZBTElE
X0NEQl9GSUVMRCk7CisgICAgICAgICAgICByZXR1cm47CisgICAgICAgIH0KKyAgICAgICAgY2Rf
c2NzaV9jbWRfaW5xdWlyeV9zdGFuZGFyZChkZXYsIHJlcSk7CisgICAgfQorfQorCitzdGF0aWMg
dm9pZCBjZF9zY3NpX2NtZF9yZWFkX2NhcGFjaXR5KENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVl
c3QgKnJlcSkKK3sKKyAgICB1aW50MzJfdCBsYXN0X2JsayA9IGRldi0+bnVtX2Jsb2NrcyAtIDE7
CisgICAgdWludDMyX3QgYmxrX3NpemUgPSBkZXYtPmJsb2NrX3NpemU7CisgICAgdWludDMyX3Qg
Kmxhc3RfYmxrX291dCA9ICh1aW50MzJfdCAqKXJlcS0+YnVmOworICAgIHVpbnQzMl90ICpibGtf
c2l6ZV9vdXQgPSAodWludDMyX3QgKikocmVxLT5idWYgKyA0KTsKKworICAgIHJlcS0+eGZlcl9k
aXIgPSBTQ1NJX1hGRVJfRlJPTV9ERVY7CisgICAgcmVxLT5yZXFfbGVuID0gODsKKworICAgICps
YXN0X2Jsa19vdXQgPSBodG9iZTMyKGxhc3RfYmxrKTsKKyAgICAqYmxrX3NpemVfb3V0ID0gaHRv
YmUzMihibGtfc2l6ZSk7CisKKyAgICBTUElDRV9ERUJVRygiUmVhZCBjYXBhY2l0eSwgbHVuOiV1
IGxhc3RfYmxrOiAldSBibGtfc3o6ICV1IiwKKyAgICAgICAgICAgICAgICByZXEtPmx1biwgbGFz
dF9ibGssIGJsa19zaXplKTsKKworICAgIHJlcS0+aW5fbGVuID0gODsKKyAgICBjZF9zY3NpX2Nt
ZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworI2RlZmluZSBSRElfVFlQRV9TVEFOREFS
RCAgICAgICAgICAgMCAvKiBTdGFuZGFyZCBEaXNjIEluZm9ybWF0aW9uICovCisjZGVmaW5lIFJE
SV9UWVBFX1RSQUNLX1JFU09VUkNFUyAgICAxIC8qIFRyYWNrIFJlc291cmNlcyBJbmZvcm1hdGlv
biAqLworI2RlZmluZSBSRElfVFlQRV9QT1dfUkVTT1VSQ0VTICAgICAgMiAvKiBQT1cgUmVzb3Vy
Y2VzIEluZm9ybWF0aW9uICovCisKKyNkZWZpbmUgUkRJX1NUQU5EQVJEX0xFTiAgICAgICAgICAg
IDM0CisKKyNkZWZpbmUgUkRJX0VSQVpBQkxFICAgICAgICAgICAgICAgICgweDAxIDw8IDQpCisj
ZGVmaW5lIFJESV9OT05fRVJBWkFCTEUgICAgICAgICAgICAoMHgwMCA8PCA0KQorCisjZGVmaW5l
IFJESV9TRVNTSU9OX0VNUFRZICAgICAgICAgICAoMHgwMCA8PCAyKQorI2RlZmluZSBSRElfU0VT
U0lPTl9JTkNPTVBMRVRFICAgICAgKDB4MDEgPDwgMikKKyNkZWZpbmUgUkRJX1NFU1NJT05fREFN
QUdFRCAgICAgICAgICgweDAyIDw8IDIpCisjZGVmaW5lIFJESV9TRVNTSU9OX0NPTVBMRVRFICAg
ICAgICAoMHgwMyA8PCAyKQorCisjZGVmaW5lIFJESV9ESVNDX0VNUFRZICAgICAgICAgICAgICAw
eDAwCisjZGVmaW5lIFJESV9ESVNDX0lOQ09NUExFVEUgICAgICAgICAweDAxCisjZGVmaW5lIFJE
SV9ESVNDX0NPTVBMRVRFICAgICAgICAgICAweDAyCisjZGVmaW5lIFJESV9ESVNDX1JBTkRPTV9X
UiAgICAgICAgICAweDAzCisKKyNkZWZpbmUgUkRJX0RJU0NfUE1BX1RZUEVfQ0RfUk9NICAgIDB4
MDAKKyNkZWZpbmUgUkRJX0RJU0NfUE1BX1RZUEVfQ0RJICAgICAgIDB4MTAKKyNkZWZpbmUgUkRJ
X0RJU0NfUE1BX1RZUEVfRERDRCAgICAgIDB4MjAKKyNkZWZpbmUgUkRJX0RJU0NfUE1BX1RZUEVf
VU5ERUZJTkVEIDB4RkYKKworc3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRfZ2V0X3JlYWRfZGlzY19p
bmZvcm1hdGlvbihDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgdWlu
dDhfdCAqb3V0YnVmID0gcmVxLT5idWY7CisgICAgdWludDMyX3QgZGF0YV90eXBlOworICAgIHVp
bnQzMl90IGZpcnN0X3RyYWNrID0gMTsKKyAgICB1aW50MzJfdCBsYXN0X3RyYWNrID0gMTsKKyAg
ICB1aW50MzJfdCBudW1fc2Vzc2lvbnMgPSAxOworCisgICAgcmVxLT54ZmVyX2RpciA9IFNDU0lf
WEZFUl9GUk9NX0RFVjsKKworICAgIGRhdGFfdHlwZSA9IHJlcS0+Y2RiWzFdICYgMHg3OworICAg
IGlmIChkYXRhX3R5cGUgIT0gUkRJX1RZUEVfU1RBTkRBUkQpIHsKKyAgICAgICAgU1BJQ0VfREVC
VUcoInJlYWRfZGlzY19pbmZvcm1hdGlvbiwgbHVuOiV1IgorICAgICAgICAgICAgICAgICAgICAi
IHVuc3VwcG9ydGVkIGRhdGEgdHlwZTogJTAyeCIsCisgICAgICAgICAgICAgICAgICAgIHJlcS0+
bHVuLCBkYXRhX3R5cGUpOworICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25k
KGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZBTElEX0NEQl9GSUVMRCk7CisgICAgICAgIHJldHVy
bjsKKyAgICB9CisKKyAgICByZXEtPnJlcV9sZW4gPSAocmVxLT5jZGJbN10gPDwgOCkgfCByZXEt
PmNkYls4XTsKKyAgICByZXEtPmluX2xlbiA9IE1JTihyZXEtPnJlcV9sZW4sIFJESV9TVEFOREFS
RF9MRU4pOworCisgICAgbWVtc2V0KG91dGJ1ZiwgMCwgUkRJX1NUQU5EQVJEX0xFTik7CisgICAg
b3V0YnVmWzFdID0gUkRJX1NUQU5EQVJEX0xFTiAtIDI7IC8qIGxlbmd0aCBleGNsdWRpbmcgdGhl
IGNvdW50ZXIgaXRzZWxmICovCisgICAgb3V0YnVmWzJdID0gUkRJX05PTl9FUkFaQUJMRSB8IFJE
SV9TRVNTSU9OX0NPTVBMRVRFIHwgUkRJX0RJU0NfQ09NUExFVEU7CisgICAgb3V0YnVmWzNdID0g
Zmlyc3RfdHJhY2s7IC8qIG9uIGRpc2sgKi8KKyAgICBvdXRidWZbNF0gPSBudW1fc2Vzc2lvbnMg
JiAweGZmOyAvKiBsc2IgKi8KKyAgICBvdXRidWZbNV0gPSBmaXJzdF90cmFjayAmIDB4ZmY7IC8q
IGluIGxhc3Qgc2Vzc29uLCBsc2IgKi8KKyAgICBvdXRidWZbNl0gPSBsYXN0X3RyYWNrICYgMHhm
ZjsgLyogaW4gbGFzdCBzZXNzb24sIGxzYiAqLworICAgIG91dGJ1Zls4XSA9IFJESV9ESVNDX1BN
QV9UWVBFX0NEX1JPTTsKKyAgICBvdXRidWZbOV0gPSAobnVtX3Nlc3Npb25zID4+IDgpICYgMHhm
ZjsgLyogbXNiICovCisgICAgb3V0YnVmWzEwXSA9IChmaXJzdF90cmFjayA+PiA4KSAmIDB4ZmY7
IC8qIGluIGxhc3Qgc2Vzc29uLCBsc2IgKi8KKyAgICBvdXRidWZbMTFdID0gKGxhc3RfdHJhY2sg
Pj4gOCkgJiAweGZmOyAvKiBpbiBsYXN0IHNlc3NvbiwgbHNiICovCisKKyAgICBTUElDRV9ERUJV
RygicmVhZF9kaXNjX2luZm9ybWF0aW9uLCBsdW46JXUgbGVuOiAlIiBHX0dVSU5UNjRfRk9STUFU
LAorICAgICAgICAgICAgICAgIHJlcS0+bHVuLCByZXEtPmluX2xlbik7CisKKyAgICBjZF9zY3Np
X2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworI2RlZmluZSBSVElfQUREUl9UWVBF
X0xCQSAgICAgICAgICAgMHgwMAorI2RlZmluZSBSVElfQUREUl9UWVBFX1RSQUNLX05VTSAgICAg
MHgwMQorI2RlZmluZSBSVElfQUREUl9UWVBFX1NFU1NJT05fTlVNICAgMHgwMgorCisjZGVmaW5l
IFJUSV9UUkFDS19OVU1fTEVBRF9JTiAgICAgICAweDAwCisjZGVmaW5lIFJUSV9UUkFDS19OVU1f
SU5WSVNJQkxFICAgICAweGZmCisKKyNkZWZpbmUgVElCX0xFTiAgICAgICAgICAgICAgICAgICAg
IDB4MzYKKworI2RlZmluZSBUSUJfVFJBQ0tfTU9ERV9DRCAgICAgICAgICAgMHgwNAorI2RlZmlu
ZSBUSUJfREFUQV9NT0RFX0lTT18xMDE0OSAgICAgMHgwMQorCisjZGVmaW5lIFRJQl9MUkFfVkFM
SUQgICAgICAgICAgICAgICAoMHgwMSA8PCAxKQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9n
ZXRfcmVhZF90cmFja19pbmZvcm1hdGlvbihDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpy
ZXEpCit7CisgICAgdWludDhfdCAqb3V0YnVmID0gcmVxLT5idWY7CisgICAgdWludDMyX3QgdHJh
Y2tfc2l6ZSA9IGRldi0+bnVtX2Jsb2NrczsKKyAgICB1aW50MzJfdCBsYXN0X2FkZHIgPSB0cmFj
a19zaXplIC0gMTsKKyAgICB1aW50MzJfdCB0cmFja19udW0gPSAxOworICAgIHVpbnQzMl90IHNl
c3Npb25fbnVtID0gMTsKKyAgICB1aW50MzJfdCBhZGRyX3R5cGU7CisgICAgdWludDMyX3QgYWRk
cl9udW07CisKKyAgICByZXEtPnhmZXJfZGlyID0gU0NTSV9YRkVSX0ZST01fREVWOworCisgICAg
YWRkcl90eXBlID0gcmVxLT5jZGJbMV0gJiAweDM7CisgICAgYWRkcl9udW0gPSAocmVxLT5jZGJb
Ml0gPDwgMjQpIHwgKHJlcS0+Y2RiWzNdIDw8IDE2KSB8CisgICAgICAgICAgICAgICAocmVxLT5j
ZGJbNF0gPDwgOCkgfCByZXEtPmNkYls1XTsKKworICAgIHN3aXRjaCAoYWRkcl90eXBlKSB7Cisg
ICAgY2FzZSBSVElfQUREUl9UWVBFX0xCQToKKyAgICAgICAgaWYgKGFkZHJfbnVtID4gbGFzdF9h
ZGRyKSB7CisgICAgICAgICAgICBTUElDRV9ERUJVRygicmVhZF90cmFja19pbmZvcm1hdGlvbiwg
bHVuOiV1IgorICAgICAgICAgICAgICAgICAgICAgICAgIiBhZGRyX3R5cGUgTEJBOiAldSIKKyAg
ICAgICAgICAgICAgICAgICAgICAgICIgaW52YWxpZCBMQkE6ICV1IiwKKyAgICAgICAgICAgICAg
ICAgICAgICAgIHJlcS0+bHVuLCBhZGRyX3R5cGUsIGFkZHJfbnVtKTsKKyAgICAgICAgICAgIGNk
X3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX0lOVkFM
SURfQ0RCX0ZJRUxEKTsKKyAgICAgICAgICAgIHJldHVybjsKKyAgICAgICAgfQorICAgICAgICBi
cmVhazsKKyAgICBjYXNlIFJUSV9BRERSX1RZUEVfVFJBQ0tfTlVNOgorICAgICAgICBpZiAoYWRk
cl9udW0gIT0gdHJhY2tfbnVtKSB7CisgICAgICAgICAgICBTUElDRV9ERUJVRygicmVhZF90cmFj
a19pbmZvcm1hdGlvbiwgbHVuOiV1IgorICAgICAgICAgICAgICAgICAgICAgICAgIiBhZGRyX3R5
cGUgdHJhY2s6ICV1IgorICAgICAgICAgICAgICAgICAgICAgICAgIiBpbnZhbGlkIHRyYWNrOiAl
dSIsCisgICAgICAgICAgICAgICAgICAgICAgICByZXEtPmx1biwgYWRkcl90eXBlLCBhZGRyX251
bSk7CisgICAgICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVx
LCAmc2Vuc2VfY29kZV9JTlZBTElEX0NEQl9GSUVMRCk7CisgICAgICAgICAgICByZXR1cm47Cisg
ICAgICAgIH0KKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBSVElfQUREUl9UWVBFX1NFU1NJT05f
TlVNOgorICAgICAgICBpZiAoYWRkcl9udW0gIT0gc2Vzc2lvbl9udW0pIHsKKyAgICAgICAgICAg
IFNQSUNFX0RFQlVHKCJyZWFkX3RyYWNrX2luZm9ybWF0aW9uLCBsdW46JXUiCisgICAgICAgICAg
ICAgICAgICAgICAgICAiIGFkZHJfdHlwZSBzZXNzaW9uOiAldSIKKyAgICAgICAgICAgICAgICAg
ICAgICAgICIgaW52YWxpZCBzZXNzaW9uOiAldSIsCisgICAgICAgICAgICAgICAgICAgICAgICBy
ZXEtPmx1biwgYWRkcl90eXBlLCBhZGRyX251bSk7CisgICAgICAgICAgICBjZF9zY3NpX2NtZF9j
b21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZBTElEX0NEQl9GSUVM
RCk7CisgICAgICAgICAgICByZXR1cm47CisgICAgICAgIH0KKyAgICAgICAgYnJlYWs7CisgICAg
ZGVmYXVsdDoKKyAgICAgICAgU1BJQ0VfREVCVUcoInJlYWRfdHJhY2tfaW5mb3JtYXRpb24sIGx1
bjoldSIKKyAgICAgICAgICAgICAgICAgICAgIiBpbnZhbGlkIGFkZHJfdHlwZTogJXUiCisgICAg
ICAgICAgICAgICAgICAgICIgYWRkcl9udW06ICV1IiwKKyAgICAgICAgICAgICAgICAgICAgcmVx
LT5sdW4sIGFkZHJfdHlwZSwgYWRkcl9udW0pOworICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0
ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZBTElEX0NEQl9GSUVMRCk7Cisg
ICAgICAgIHJldHVybjsKKyAgICB9CisKKyAgICByZXEtPnJlcV9sZW4gPSAocmVxLT5jZGJbN10g
PDwgOCkgfCByZXEtPmNkYls4XTsKKyAgICByZXEtPmluX2xlbiA9IE1JTihyZXEtPnJlcV9sZW4s
IFRJQl9MRU4pOworCisgICAgbWVtc2V0KG91dGJ1ZiwgMCwgVElCX0xFTik7CisgICAgb3V0YnVm
WzFdID0gVElCX0xFTiAtIDI7CisgICAgb3V0YnVmWzJdID0gc2Vzc2lvbl9udW07CisgICAgb3V0
YnVmWzNdID0gdHJhY2tfbnVtOworICAgIG91dGJ1Zls1XSA9IFRJQl9UUkFDS19NT0RFX0NEICYg
MHgwZjsKKyAgICBvdXRidWZbNl0gPSBUSUJfREFUQV9NT0RFX0lTT18xMDE0OSAmIDB4MGY7Cisg
ICAgb3V0YnVmWzddID0gVElCX0xSQV9WQUxJRDsKKworICAgIC8qIFRyYWNrIHNpemUgKi8KKyAg
ICBvdXRidWZbMjRdID0gKHRyYWNrX3NpemUgPj4gMjQpICYgMHhmZjsKKyAgICBvdXRidWZbMjVd
ID0gKHRyYWNrX3NpemUgPj4gMTYpICYgMHhmZjsKKyAgICBvdXRidWZbMjZdID0gKHRyYWNrX3Np
emUgPj4gOCkgJiAweGZmOworICAgIG91dGJ1ZlsyN10gPSAodHJhY2tfc2l6ZSkgJiAweGZmOwor
CisgICAgLyogTGFzdCByZWNvcmRlZCBhZGRyZXNzICovCisgICAgb3V0YnVmWzI4XSA9IChsYXN0
X2FkZHIgPj4gMjQpICYgMHhmZjsKKyAgICBvdXRidWZbMjldID0gKGxhc3RfYWRkciA+PiAxNikg
JiAweGZmOworICAgIG91dGJ1ZlszMF0gPSAobGFzdF9hZGRyID4+IDgpICYgMHhmZjsKKyAgICBv
dXRidWZbMzFdID0gKGxhc3RfYWRkcikgJiAweGZmOworCisgICAgU1BJQ0VfREVCVUcoInJlYWRf
dHJhY2tfaW5mb3JtYXRpb24sIGx1bjoldSIKKyAgICAgICAgICAgICAgICAiYWRkcl90eXBlOiAl
dSBhZGRyX251bTogJXUiLAorICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBhZGRyX3R5cGUsIGFk
ZHJfbnVtKTsKKworICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2LCByZXEpOworfQor
CisjZGVmaW5lIFJFQURfVE9DX1RSQUNLX0RFU0NfTEVOICAgICA4CisjZGVmaW5lIFJFQURfVE9D
X1JFU1BfTEVOICAgICAgICAgICAoNCArIDIqUkVBRF9UT0NfVFJBQ0tfREVTQ19MRU4pCisKK3N0
YXRpYyB2b2lkIGNkX3Njc2lfY21kX3JlYWRfdG9jKENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVl
c3QgKnJlcSkKK3sKKyAgICB1aW50OF90ICpvdXRidWYgPSByZXEtPmJ1ZjsKKyAgICB1aW50MzJf
dCBtc2YsIGZvcm1hdCwgdHJhY2tfbnVtOworICAgIHVpbnQzMl90IGxhc3RfYmxrID0gZGV2LT5u
dW1fYmxvY2tzIC0gMTsKKworICAgIHJlcS0+eGZlcl9kaXIgPSBTQ1NJX1hGRVJfRlJPTV9ERVY7
CisKKyAgICBtc2YgPSAocmVxLT5jZGJbMV0gPj4gMSkgJiAweDE7CisgICAgZm9ybWF0ID0gcmVx
LT5jZGJbMl0gJiAweGY7CisgICAgdHJhY2tfbnVtID0gcmVxLT5jZGJbNl07CisKKyAgICByZXEt
PnJlcV9sZW4gPSAocmVxLT5jZGJbN10gPDwgOCkgfCByZXEtPmNkYls4XTsKKyAgICByZXEtPmlu
X2xlbiA9IE1JTihyZXEtPnJlcV9sZW4sIFJFQURfVE9DX1JFU1BfTEVOKTsKKworICAgIG1lbXNl
dChvdXRidWYsIDAsIFJFQURfVE9DX1JFU1BfTEVOKTsKKyAgICBvdXRidWZbMV0gPSBSRUFEX1RP
Q19SRVNQX0xFTiAtIDI7IC8qIGxlbmd0aCBleGNsdWRpbmcgdGhlIGNvdW50ZXIgaXRzZWxmICov
CisgICAgb3V0YnVmWzJdID0gMTsgLyogZmlyc3QgdHJhY2svc2Vzc2lvbiAqLworICAgIG91dGJ1
ZlszXSA9IDE7IC8qIGxhc3QgdHJhY2svc2Vzc2lvbiAqLworCisgICAgb3V0YnVmWzVdID0gMHgw
NDsgLyogRGF0YSBDRCwgbm8gUS1zdWJjaGFubmVsICovCisgICAgb3V0YnVmWzZdID0gMHgwMTsg
LyogVHJhY2sgbnVtYmVyICovCisgICAgb3V0YnVmWzEwXSA9IG1zZiA/IDB4MDIgOiAweDA7CisK
KyAgICBvdXRidWZbMTNdID0gMHgwNDsgLyogRGF0YSBDRCwgbm8gUS1zdWJjaGFubmVsICovCisg
ICAgb3V0YnVmWzE0XSA9IDB4YWE7IC8qIFRyYWNrIG51bWJlciAqLworICAgIGlmIChtc2YpIHsK
KyAgICAgICAgbGFzdF9ibGsgPSAweGZmMzAwMDAwOworICAgIH0KKyAgICBvdXRidWZbMTZdID0g
bGFzdF9ibGsgPj4gMjQ7CisgICAgb3V0YnVmWzE3XSA9IGxhc3RfYmxrID4+IDE2OworICAgIG91
dGJ1ZlsxOF0gPSBsYXN0X2JsayA+PiA4OworICAgIG91dGJ1ZlsxOV0gPSBsYXN0X2JsazsKKwor
ICAgIFNQSUNFX0RFQlVHKCJyZWFkX3RvYywgbHVuOiV1IGxlbjogJSIgR19HVUlOVDY0X0ZPUk1B
VAorICAgICAgICAgICAgICAgICIgbXNmOiAleCBmb3JtYXQ6IDB4JTAyeCB0cmFjay9zZXNzaW9u
OiAweCUwMngiLAorICAgICAgICAgICAgICAgIHJlcS0+bHVuLCByZXEtPmluX2xlbiwgbXNmLCBm
b3JtYXQsIHRyYWNrX251bSk7CisKKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwg
cmVxKTsKK30KKworI2RlZmluZSBDRF9NT0RFX1BBUkFNXzZfTEVOX0hFQURFUiAgICAgICAgICAg
ICAgNAorI2RlZmluZSBDRF9NT0RFX1BBUkFNXzEwX0xFTl9IRUFERVIgICAgICAgICAgICAgOAor
CisjZGVmaW5lIENEX01PREVfUEFHRV9MRU5fUldfRVJST1IgICAgICAgICAgICAgICAxMgorCitz
dGF0aWMgdWludDMyX3QgY2Rfc2NzaV9hZGRfbW9kZV9wYWdlX3J3X2Vycm9yX3JlY292ZXJ5KENk
U2NzaUxVICpkZXYsIHVpbnQ4X3QgKm91dGJ1ZikKK3sKKyAgICB1aW50MzJfdCBwYWdlX2xlbiA9
IENEX01PREVfUEFHRV9MRU5fUldfRVJST1I7CisKKyAgICBvdXRidWZbMF0gPSBNT0RFX1BBR0Vf
Ul9XX0VSUk9SOworICAgIG91dGJ1ZlsxXSA9IENEX01PREVfUEFHRV9MRU5fUldfRVJST1IgLSAy
OworICAgIG91dGJ1ZlszXSA9IDE7IC8qIHJlYWQgcmV0cnkgY291bnQgKi8KKworICAgIHJldHVy
biBwYWdlX2xlbjsKK30KKworI2RlZmluZSBDRF9NT0RFX1BBR0VfTEVOX1BPV0VSICAgICAgICAg
ICAgICAgICAgMTIKKworc3RhdGljIHVpbnQzMl90IGNkX3Njc2lfYWRkX21vZGVfcGFnZV9wb3dl
cl9jb25kaXRpb24oQ2RTY3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVmKQoreworICAgIHVpbnQz
Ml90IHBhZ2VfbGVuID0gQ0RfTU9ERV9QQUdFX0xFTl9QT1dFUjsKKworICAgIG91dGJ1ZlswXSA9
IE1PREVfUEFHRV9QT1dFUjsKKyAgICBvdXRidWZbMV0gPSBDRF9NT0RFX1BBR0VfTEVOX1BPV0VS
IC0gMjsKKworICAgIHJldHVybiBwYWdlX2xlbjsKK30KKworI2RlZmluZSBDRF9NT0RFX1BBR0Vf
TEVOX0ZBVUxUX0ZBSUwgICAgICAgICAgICAgMTIKKyNkZWZpbmUgQ0RfTU9ERV9QQUdFX0ZBVUxU
X0ZBSUxfRkxBR19QRVJGICAgICAgIDB4ODAKKworc3RhdGljIHVpbnQzMl90IGNkX3Njc2lfYWRk
X21vZGVfcGFnZV9mYXVsdF9yZXBvcnRpbmcoQ2RTY3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVm
KQoreworICAgIHVpbnQzMl90IHBhZ2VfbGVuID0gQ0RfTU9ERV9QQUdFX0xFTl9GQVVMVF9GQUlM
OworCisgICAgb3V0YnVmWzBdID0gTU9ERV9QQUdFX0ZBVUxUX0ZBSUw7CisgICAgb3V0YnVmWzFd
ID0gQ0RfTU9ERV9QQUdFX0xFTl9GQVVMVF9GQUlMIC0gMjsKKyAgICBvdXRidWZbMl0gfD0gQ0Rf
TU9ERV9QQUdFX0ZBVUxUX0ZBSUxfRkxBR19QRVJGOworCisgICAgcmV0dXJuIHBhZ2VfbGVuOwor
fQorCisjZGVmaW5lIENEX01PREVfUEFHRV9MRU5fQ0FQU19NRUNIX1NUQVRVU19STyAgICAyNgor
LyogYnl0ZSAyICovCisjZGVmaW5lIENEX01PREVfUEFHRV9DQVBTX0NEX1JfUkVBRCAgICAgICAg
ICAgICAweDAxCisjZGVmaW5lIENEX01PREVfUEFHRV9DQVBTX0NEX1JXX1JFQUQgICAgICAgICAg
ICAoMHgwMSA8PCAxKQorI2RlZmluZSBDRF9NT0RFX1BBR0VfQ0FQU19EVkRfUk9NX1JFQUQgICAg
ICAgICAgKDB4MDEgPDwgMykKKyNkZWZpbmUgQ0RfTU9ERV9QQUdFX0NBUFNfRFZEX1JfUkVBRCAg
ICAgICAgICAgICgweDAxIDw8IDQpCisjZGVmaW5lIENEX01PREVfUEFHRV9DQVBTX0RWRF9SQU1f
UkVBRCAgICAgICAgICAoMHgwMSA8PCA1KQorLyogYnl0ZSA2ICovCisjZGVmaW5lIENEX01PREVf
UEFHRV9DQVBTX0xPQ0tfU1VQUE9SVCAgICAgICAgICAoMHgwMSkKKyNkZWZpbmUgQ0RfTU9ERV9Q
QUdFX0NBUFNfTE9DS19TVEFURSAgICAgICAgICAgICgweDAxIDw8IDEpCisjZGVmaW5lIENEX01P
REVfUEFHRV9DQVBTX1BSRVZFTlRfSlVNUEVSICAgICAgICAoMHgwMSA8PCAyKQorI2RlZmluZSBD
RF9NT0RFX1BBR0VfQ0FQU19FSkVDVCAgICAgICAgICAgICAgICAgKDB4MDEgPDwgMykKKyNkZWZp
bmUgQ0RfTU9ERV9QQUdFX0NBUFNfTE9BRElOR19UUkFZICAgICAgICAgICgweDAxIDw8IDUpCisK
K3N0YXRpYyB1aW50MzJfdCBjZF9zY3NpX2FkZF9tb2RlX3BhZ2VfY2Fwc19tZWNoX3N0YXR1cyhD
ZFNjc2lMVSAqZGV2LCB1aW50OF90ICpvdXRidWYpCit7CisgICAgdWludDMyX3QgcGFnZV9sZW4g
PSBDRF9NT0RFX1BBR0VfTEVOX0NBUFNfTUVDSF9TVEFUVVNfUk87IC8qIG5vIHdyaXRlICovCisK
KyAgICBvdXRidWZbMF0gPSBNT0RFX1BBR0VfQ0FQU19NRUNIX1NUQVRVUzsKKyAgICBvdXRidWZb
MV0gPSBwYWdlX2xlbjsKKyAgICBvdXRidWZbMl0gPSBDRF9NT0RFX1BBR0VfQ0FQU19DRF9SX1JF
QUQgfCBDRF9NT0RFX1BBR0VfQ0FQU19DRF9SV19SRUFEIHwKKyAgICAgICAgICAgICAgICBDRF9N
T0RFX1BBR0VfQ0FQU19EVkRfUk9NX1JFQUQgfCBDRF9NT0RFX1BBR0VfQ0FQU19EVkRfUl9SRUFE
IHwKKyAgICAgICAgICAgICAgICBDRF9NT0RFX1BBR0VfQ0FQU19EVkRfUkFNX1JFQUQ7CisgICAg
b3V0YnVmWzZdID0gQ0RfTU9ERV9QQUdFX0NBUFNfTE9BRElOR19UUkFZIHwgQ0RfTU9ERV9QQUdF
X0NBUFNfRUpFQ1QgfAorICAgICAgICAgICAgICAgIENEX01PREVfUEFHRV9DQVBTX0xPQ0tfU1VQ
UE9SVDsKKyAgICBpZiAoZGV2LT5wcmV2ZW50X21lZGlhX3JlbW92YWwpIHsKKyAgICAgICAgb3V0
YnVmWzZdIHw9IENEX01PREVfUEFHRV9DQVBTX0xPQ0tfU1RBVEU7CisgICAgfQorCisgICAgcmV0
dXJuIHBhZ2VfbGVuOworfQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9tb2RlX3NlbnNlXzEw
KENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICB1aW50OF90ICpvdXRi
dWYgPSByZXEtPmJ1ZjsKKyAgICBpbnQgbG9uZ19sYmEsIGRiZCwgcGFnZSwgc3ViX3BhZ2UsIHBj
OworICAgIHVpbnQzMl90IHJlc3BfbGVuID0gQ0RfTU9ERV9QQVJBTV8xMF9MRU5fSEVBREVSOwor
CisgICAgcmVxLT54ZmVyX2RpciA9IFNDU0lfWEZFUl9GUk9NX0RFVjsKKworICAgIGxvbmdfbGJh
ID0gKHJlcS0+Y2RiWzFdID4+IDQpICYgMHgxOworICAgIGRiZCA9IChyZXEtPmNkYlsxXSA+PiAz
KSAmIDB4MTsKKyAgICBwYWdlID0gcmVxLT5jZGJbMl0gJiAweDNmOworICAgIHBjID0gcmVxLT5j
ZGJbMl0gPj4gNjsKKyAgICBzdWJfcGFnZSA9IHJlcS0+Y2RiWzNdOworCisgICAgcmVxLT5yZXFf
bGVuID0gKHJlcS0+Y2RiWzddIDw8IDgpIHwgcmVxLT5jZGJbOF07CisKKyAgICBtZW1zZXQob3V0
YnVmLCAwLCByZXEtPnJlcV9sZW4pOworICAgIG91dGJ1ZlsyXSA9ICAwOyAvKiBtZWRpdW0gdHlw
ZSAqLworCisgICAgc3dpdGNoIChwYWdlKSB7CisgICAgY2FzZSBNT0RFX1BBR0VfUl9XX0VSUk9S
OgorICAgICAgICAvKiBSZWFkL1dyaXRlIEVycm9yIFJlY292ZXJ5ICovCisgICAgICAgIHJlc3Bf
bGVuICs9IGNkX3Njc2lfYWRkX21vZGVfcGFnZV9yd19lcnJvcl9yZWNvdmVyeShkZXYsIG91dGJ1
ZiArIHJlc3BfbGVuKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBNT0RFX1BBR0VfUE9XRVI6
CisgICAgICAgIC8qIFBvd2VyIENvbmRpc3Rpb25zICovCisgICAgICAgIHJlc3BfbGVuICs9IGNk
X3Njc2lfYWRkX21vZGVfcGFnZV9wb3dlcl9jb25kaXRpb24oZGV2LCBvdXRidWYgKyByZXNwX2xl
bik7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgTU9ERV9QQUdFX0ZBVUxUX0ZBSUw6CisgICAg
ICAgIC8qIEZhdWx0IC8gRmFpbHVyZSBSZXBvcnRpbmcgQ29udHJvbCAqLworICAgICAgICByZXNw
X2xlbiArPSBjZF9zY3NpX2FkZF9tb2RlX3BhZ2VfZmF1bHRfcmVwb3J0aW5nKGRldiwgb3V0YnVm
ICsgcmVzcF9sZW4pOworICAgICAgICBicmVhazsKKyAgICBjYXNlIE1PREVfUEFHRV9DQVBTX01F
Q0hfU1RBVFVTOgorICAgICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9tb2RlX3BhZ2VfY2Fw
c19tZWNoX3N0YXR1cyhkZXYsIG91dGJ1ZiArIHJlc3BfbGVuKTsKKyAgICAgICAgYnJlYWs7CisK
KyAgICAvKiBub3QgaW1wbGVtZW50ZWQgKi8KKyAgICBjYXNlIE1PREVfUEFHRV9XUklURV9QQVJB
TUVURVI6IC8qIFdyaXRlciBQYXJhbWV0ZXJzICovCisgICAgY2FzZSBNT0RFX1BBR0VfTVJXOgor
ICAgIGNhc2UgTU9ERV9QQUdFX01SV19WRU5ET1I6IC8qIE1SVyAoTW91bnQgUmFpbmllciBSZS13
cml0YWJsZSBEaXNrcyAqLworICAgIGNhc2UgTU9ERV9QQUdFX0NEX0RFVklDRTogLyogQ0QgRGV2
aWNlIHBhcmFtZXRlcnMgKi8KKyAgICBjYXNlIE1PREVfUEFHRV9UT19QUk9URUNUOiAvKiBUaW1l
LW91dCBhbmQgUHJvdGVjdCAqLworICAgIGRlZmF1bHQ6CisgICAgICAgIFNQSUNFX0RFQlVHKCJt
b2RlX3NlbnNlXzEwLCBsdW46JXUiCisgICAgICAgICAgICAgICAgICAgICIgcGFnZSAweCV4IG5v
dCBpbXBsZW1lbnRlZCIsCisgICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuLCAodW5zaWduZWQp
cGFnZSk7CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEs
ICZzZW5zZV9jb2RlX0lOVkFMSURfQ0RCX0ZJRUxEKTsKKyAgICAgICAgcmV0dXJuOworICAgIH0K
KworICAgIG91dGJ1ZlswXSA9ICgocmVzcF9sZW4gLSAyKSA+PiA4KSAmIDB4ZmY7CisgICAgb3V0
YnVmWzFdID0gKHJlc3BfbGVuIC0gMikgJiAweGZmOworCisgICAgcmVxLT5pbl9sZW4gPSBNSU4o
cmVxLT5yZXFfbGVuLCByZXNwX2xlbik7CisKKyAgICBTUElDRV9ERUJVRygibW9kZV9zZW5zZV8x
MCwgbHVuOiV1IgorICAgICAgICAgICAgICAgICIgbG9uZ19sYmEgJWQsIGRiZCAlZCwgcGFnZSAl
ZCwgc3ViX3BhZ2UgJWQsIHBjICVkOyAiCisgICAgICAgICAgICAgICAgInJlc3BfbGVuICV1IiwK
KyAgICAgICAgICAgICAgICByZXEtPmx1biwgbG9uZ19sYmEsIGRiZCwgcGFnZSwgc3ViX3BhZ2Us
IHBjLCByZXNwX2xlbik7CisKKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVx
KTsKK30KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRfbW9kZV9zZWxlY3RfNihDZFNjc2lMVSAq
ZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgdWludDhfdCAqYmxvY2tfZGVzY19kYXRh
LCAqbW9kZV9kYXRhOworICAgIHVpbnQzMl90IHBhZ2VfZm9ybWF0LCBzYXZlX3BhZ2VzLCBsaXN0
X2xlbjsgLyogY2RiICovCisgICAgdWludDMyX3QgbnVtX2Jsb2NrcyA9IDAsIGJsb2NrX2xlbiA9
IDA7IC8qIGJsb2NrIGRlc2NyaXB0b3IgKi8KKyAgICB1aW50MzJfdCBtb2RlX2xlbiwgbWVkaXVt
X3R5cGUsIGRldl9wYXJhbSwgYmxvY2tfZGVzY19sZW47IC8qIG1vZGUgcGFyYW0gaGVhZGVyICov
CisgICAgdWludDMyX3QgcGFnZV9udW0gPSAwLCBwYWdlX2xlbiA9IDA7IC8qIG1vZGUgcGFnZSAq
LworCisgICAgcGFnZV9mb3JtYXQgPSAocmVxLT5jZGJbMV0gPj4gNCkgJiAweDE7CisgICAgc2F2
ZV9wYWdlcyA9IHJlcS0+Y2RiWzFdICYgMHgxOworICAgIGxpc3RfbGVuID0gcmVxLT5jZGJbNF07
CisKKyAgICBpZiAobGlzdF9sZW4gPiByZXEtPmJ1Zl9sZW4pIHsKKyAgICAgICAgU1BJQ0VfREVC
VUcoIm1vZGVfc2VsZWN0XzYsIGx1bjoldSIKKyAgICAgICAgICAgICAgICAgICAgIiBwZjoldSBz
cDoldSIKKyAgICAgICAgICAgICAgICAgICAgIiBsaXN0X2xlbjoldSBleGNlZWRzIGRhdGFfbGVu
OiV1IiwKKyAgICAgICAgICAgICAgICAgICAgcmVxLT5sdW4sIHBhZ2VfZm9ybWF0LCBzYXZlX3Bh
Z2VzLCBsaXN0X2xlbiwgcmVxLT5idWZfbGVuKTsKKyAgICAgICAgY2Rfc2NzaV9jbWRfY29tcGxl
dGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfSU5WQUxJRF9QQVJBTV9MRU4pOwor
ICAgICAgICByZXR1cm47CisgICAgfQorCisgICAgbW9kZV9sZW4gPSByZXEtPmJ1ZlswXTsKKyAg
ICBtZWRpdW1fdHlwZSA9IHJlcS0+YnVmWzFdOworICAgIGRldl9wYXJhbSA9IHJlcS0+YnVmWzJd
OworICAgIGJsb2NrX2Rlc2NfbGVuID0gcmVxLT5idWZbM107CisKKyAgICBpZiAoYmxvY2tfZGVz
Y19sZW4pIHsKKyAgICAgICAgYmxvY2tfZGVzY19kYXRhID0gJnJlcS0+YnVmW0NEX01PREVfUEFS
QU1fNl9MRU5fSEVBREVSXTsKKyAgICAgICAgbnVtX2Jsb2NrcyA9IChibG9ja19kZXNjX2RhdGFb
M10gPDwgMTYpIHwgKGJsb2NrX2Rlc2NfZGF0YVsyXSA8PCA4KSB8IGJsb2NrX2Rlc2NfZGF0YVsz
XTsKKyAgICAgICAgYmxvY2tfbGVuID0gKGJsb2NrX2Rlc2NfZGF0YVs1XSA8PCAxNikgfCAoYmxv
Y2tfZGVzY19kYXRhWzZdIDw8IDgpIHwgYmxvY2tfZGVzY19kYXRhWzddOworICAgIH0KKworICAg
IGlmIChtb2RlX2xlbikgeworICAgICAgICBtb2RlX2RhdGEgPSAmcmVxLT5idWZbQ0RfTU9ERV9Q
QVJBTV82X0xFTl9IRUFERVJdOworICAgICAgICBpZiAoYmxvY2tfZGVzY19sZW4pIHsKKyAgICAg
ICAgICAgIG1vZGVfZGF0YSArPSBibG9ja19kZXNjX2xlbjsKKyAgICAgICAgfQorICAgICAgICBw
YWdlX251bSA9IG1vZGVfZGF0YVswXSAmIDB4M2Y7CisgICAgICAgIHBhZ2VfbGVuID0gbW9kZV9k
YXRhWzFdOworICAgIH0KKworICAgIFNQSUNFX0RFQlVHKCJtb2RlX3NlbGVjdF82LCBsdW46JXUi
CisgICAgICAgICAgICAgICAgIiBwZjoldSBzcDoldSBsaXN0X2xlbjoldSBkYXRhX2xlbjoldSIK
KyAgICAgICAgICAgICAgICAiIG1vZGVfbGVuOiV1IG1lZGl1bToldSBkZXZfcGFyYW06JXUgYmxr
X2Rlc2NfbGVuOiV1IgorICAgICAgICAgICAgICAgICIgbnVtX2Jsb2NrczoldSBibG9ja19sZW46
JXUiCisgICAgICAgICAgICAgICAgIiBwYWdlX251bToldSBwYWdlX2xlbjoldSIsCisgICAgICAg
ICAgICAgICAgcmVxLT5sdW4sIHBhZ2VfZm9ybWF0LCBzYXZlX3BhZ2VzLCBsaXN0X2xlbiwgcmVx
LT5idWZfbGVuLAorICAgICAgICAgICAgICAgIG1vZGVfbGVuLCBtZWRpdW1fdHlwZSwgZGV2X3Bh
cmFtLCBibG9ja19kZXNjX2xlbiwKKyAgICAgICAgICAgICAgICBudW1fYmxvY2tzLCBibG9ja19s
ZW4sCisgICAgICAgICAgICAgICAgcGFnZV9udW0sIHBhZ2VfbGVuKTsKKworICAgIGNkX3Njc2lf
Y21kX2NvbXBsZXRlX2dvb2QoZGV2LCByZXEpOworfQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2Nt
ZF9tb2RlX3NlbGVjdF8xMChDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7Cisg
ICAgdWludDMyX3QgcGFnZV9mb3JtYXQsIHNhdmVfcGFnZXMsIGxpc3RfbGVuOworCisgICAgcGFn
ZV9mb3JtYXQgPSAocmVxLT5jZGJbMV0gPj4gNCkgJiAweDE7CisgICAgc2F2ZV9wYWdlcyA9IHJl
cS0+Y2RiWzFdICYgMHgxOworICAgIGxpc3RfbGVuID0gKHJlcS0+Y2RiWzddIDw8IDgpIHwgcmVx
LT5jZGJbOF07CisKKyAgICBpZiAobGlzdF9sZW4gPiByZXEtPmJ1Zl9sZW4pIHsKKyAgICAgICAg
U1BJQ0VfREVCVUcoIm1vZGVfc2VsZWN0XzEwLCBsdW46JXUgcGY6JXUgc3A6JXUiCisgICAgICAg
ICAgICAgICAgICAgICIgbGlzdF9sZW46JXUgZXhjZWVkcyBkYXRhX2xlbjoldSIsCisgICAgICAg
ICAgICAgICAgICAgIHJlcS0+bHVuLCBwYWdlX2Zvcm1hdCwgc2F2ZV9wYWdlcywgbGlzdF9sZW4s
IHJlcS0+YnVmX2xlbik7CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQo
ZGV2LCByZXEsICZzZW5zZV9jb2RlX0lOVkFMSURfUEFSQU1fTEVOKTsKKyAgICAgICAgcmV0dXJu
OworICAgIH0KKworICAgIFNQSUNFX0RFQlVHKCJtb2RlX3NlbGVjdF8xMCwgbHVuOiV1IHBmOiV1
IHNwOiV1IgorICAgICAgICAgICAgICAgICIgbGlzdF9sZW46JXUgZGF0YV9sZW46JXUiLAorICAg
ICAgICAgICAgICAgIHJlcS0+bHVuLCBwYWdlX2Zvcm1hdCwgc2F2ZV9wYWdlcywgbGlzdF9sZW4s
IHJlcS0+YnVmX2xlbik7CisKKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVx
KTsKK30KKworI2RlZmluZSBDRF9GRUFUVVJFX0hFQURFUl9MRU4gICAgICAgICAgICAgICA4Cisj
ZGVmaW5lIENEX0ZFQVRVUkVfREVTQ19MRU4gICAgICAgICAgICAgICAgIDQKKworI2RlZmluZSBD
RF9QUk9GSUxFX0RFU0NfTEVOICAgICAgICAgICAgICAgICA0CisjZGVmaW5lIENEX1BST0ZJTEVf
Q1VSUkVOVCAgICAgICAgICAgICAgICAgIDB4MDEKKworLyogUHJvZmlsZXMgTGlzdCAqLworI2Rl
ZmluZSBDRF9GRUFUVVJFX05VTV9QUk9GSUxFU19MSVNUICAgICAgICAweDAwCisvKiBDb3JlIC0g
QmFzaWMgRnVuY3Rpb25hbGl0eSAqLworI2RlZmluZSBDRF9GRUFUVVJFX05VTV9DT1JFICAgICAg
ICAgICAgICAgICAweDAxCisvKiBNb3JwaGluZyAtIFRoZSBkZXZpY2UgY2hhbmdlcyBpdHMgYmVo
YXZpb3IgZHVlIHRvIGV4dGVybmFsIGV2ZW50cyAqLworI2RlZmluZSBDRF9GRUFUVVJFX05VTV9N
T1JQSCAgICAgICAgICAgICAgICAweDAyCisvKiBSZW1vdmFibGUgTWVkaXVtIC0gVGhlIG1lZGl1
bSBtYXkgYmUgcmVtb3ZlZCBmcm9tIHRoZSBkZXZpY2UgKi8KKyNkZWZpbmUgQ0RfRkVBVFVSRV9O
VU1fUkVNT1ZBQkxFICAgICAgICAgICAgMHgwMworLyogUmFuZG9tIFJlYWRhYmxlIC0gUFA9MSBS
ZWFkIGFiaWxpdHkgZm9yIHN0b3JhZ2UgZGV2aWNlcyB3aXRoIHJhbmRvbSBhZGRyZXNzaW5nICov
CisjZGVmaW5lIENEX0ZFQVRVUkVfTlVNX1JBTkRPTV9SRUFEICAgICAgICAgIDB4MTAKKy8qIENE
IFJlYWQgLSBUaGUgYWJpbGl0eSB0byByZWFkIENEIHNwZWNpZmljIHN0cnVjdHVyZXMgKi8KKyNk
ZWZpbmUgQ0RfRkVBVFVSRV9OVU1fQ0RfUkVBRCAgICAgICAgICAgICAgMHgxRQorLyogRFZEIFJl
YWQgLSBUaGUgYWJpbGl0eSB0byByZWFkIERWRCBzcGVjaWZpYyBzdHJ1Y3R1cmVzICovCisjZGVm
aW5lIENEX0ZFQVRVUkVfTlVNX0RWRF9SRUFEICAgICAgICAgICAgIDB4MUYKKy8qIFBvd2VyIE1h
bmFnZW1lbnQgLSBJbml0aWF0b3IgYW5kIGRldmljZSBkaXJlY3RlZCBwb3dlciBtYW5hZ2VtZW50
ICovCisjZGVmaW5lIENEX0ZFQVRVUkVfTlVNX1BPV0VSX01OR1QgICAgICAgICAgIDB4MTAwCisv
KiBUaW1lb3V0ICovCisjZGVmaW5lIENEX0ZFQVRVUkVfTlVNX1RJTUVPVVQgICAgICAgICAgICAg
IDB4MTA1CisKKyNkZWZpbmUgQ0RfRkVBVFVSRV9SRVFfQUxMICAgICAgICAgICAgICAgICAgMAor
I2RlZmluZSBDRF9GRUFUVVJFX1JFUV9DVVJSRU5UICAgICAgICAgICAgICAxCisjZGVmaW5lIENE
X0ZFQVRVUkVfUkVRX1NJTkdMRSAgICAgICAgICAgICAgIDIKKworI2RlZmluZSBDRF9GRUFUVVJF
X0NVUlJFTlQgICAgICAgICAgICAgICAgICAweDAxCisjZGVmaW5lIENEX0ZFQVRVUkVfUEVSU0lT
VEVOVCAgICAgICAgICAgICAgIDB4MDIKKworI2RlZmluZSBDRF9GRUFUVVJFX1ZFUlNJT05fMSAg
ICAgICAgICAgICAgICAoMHgwMSA8PCAyKQorCisjZGVmaW5lIENEX0ZFQVRVUkVfUEhZU19JRl9T
Q1NJICAgICAgICAgICAgIDB4MDEKKworI2RlZmluZSBDRF9GRUFUVVJFX1JFTU9WQUJMRV9MT0FE
SU5HX1RSQVkgICAoMHgwMSA8PCA1KQorI2RlZmluZSBDRF9GRUFUVVJFX1JFTU9WQUJMRV9FSkVD
VCAgICAgICAgICAoMHgwMSA8PCAzKQorI2RlZmluZSBDRF9GRUFUVVJFX1JFTU9WQUJMRV9OT19Q
UlZOVF9KTVBSICAoMHgwMSA8PCAyKQorI2RlZmluZSBDRF9GRUFUVVJFX1JFTU9WQUJMRV9MT0NL
ICAgICAgICAgICAoMHgwMSkKKworc3RhdGljIGdib29sZWFuIGNkX3Njc2lfZmVhdHVyZV9yZXBv
cnRhYmxlKHVpbnQzMl90IGZlYXR1cmUsIHVpbnQzMl90IHN0YXJ0X2ZlYXR1cmUsCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyX3QgcmVxX3R5cGUpCit7
CisgICAgcmV0dXJuIChyZXFfdHlwZSA9PSBDRF9GRUFUVVJFX1JFUV9TSU5HTEUgJiYgc3RhcnRf
ZmVhdHVyZSA9PSBmZWF0dXJlKSB8fAorICAgICAgICAgICAoZmVhdHVyZSA+PSBzdGFydF9mZWF0
dXJlKTsKK30KKworc3RhdGljIHVpbnQzMl90IGNkX3Njc2lfYWRkX2ZlYXR1cmVfcHJvZmlsZXNf
bGlzdChDZFNjc2lMVSAqZGV2LCB1aW50OF90ICpvdXRidWYsCisgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IHN0YXJ0X2ZlYXR1cmUsIHVp
bnQzMl90IHJlcV90eXBlKQoreworICAgIHVpbnQ4X3QgKnByb2ZpbGUgPSBvdXRidWYgKyBDRF9G
RUFUVVJFX0RFU0NfTEVOOworICAgIHVpbnQzMl90IGZlYXR1cmVfbGVuID0gQ0RfRkVBVFVSRV9E
RVNDX0xFTjsKKyAgICB1aW50MzJfdCBhZGRfbGVuLCBwcm9maWxlX251bTsKKworICAgIGlmICgh
Y2Rfc2NzaV9mZWF0dXJlX3JlcG9ydGFibGUoQ0RfRkVBVFVSRV9OVU1fUFJPRklMRVNfTElTVCwg
c3RhcnRfZmVhdHVyZSwgcmVxX3R5cGUpKSB7CisgICAgICAgIHJldHVybiAwOworICAgIH0KKyAg
ICAvKiBmZWF0dXJlIGRlc2NyaXB0b3IgaGVhZGVyICovCisgICAgb3V0YnVmWzBdID0gKENEX0ZF
QVRVUkVfTlVNX1BST0ZJTEVTX0xJU1QgPj4gOCkgJiAweGZmOworICAgIG91dGJ1ZlsxXSA9IENE
X0ZFQVRVUkVfTlVNX1BST0ZJTEVTX0xJU1QgJiAweGZmOworICAgIG91dGJ1ZlsyXSA9IENEX0ZF
QVRVUkVfUEVSU0lTVEVOVCB8IENEX0ZFQVRVUkVfQ1VSUkVOVDsKKworICAgIC8qIERWRC1ST00g
cHJvZmlsZSBkZXNjcmlwdG9yICovCisgICAgYWRkX2xlbiA9IENEX1BST0ZJTEVfREVTQ19MRU47
IC8qIHN0YXJ0IHdpdGggc2luZ2xlIHByb2ZpbGUsIGFkZCBsYXRlciAqLworICAgIHByb2ZpbGVf
bnVtID0gTU1DX1BST0ZJTEVfRFZEX1JPTTsKKworICAgIHByb2ZpbGVbMF0gPSAocHJvZmlsZV9u
dW0gPj4gOCkgJiAweGZmOyAvKiBmZWF0dXJlIGNvZGUgKi8KKyAgICBwcm9maWxlWzFdID0gcHJv
ZmlsZV9udW0gJiAweGZmOworICAgIHByb2ZpbGVbMl0gPSAoIWRldi0+Y2Rfcm9tKSA/IENEX1BS
T0ZJTEVfQ1VSUkVOVCA6IDA7CisKKyAgICAvKiBuZXh0IHByb2ZpbGUgKi8KKyAgICBhZGRfbGVu
ICs9IENEX1BST0ZJTEVfREVTQ19MRU47CisgICAgcHJvZmlsZSArPSBDRF9QUk9GSUxFX0RFU0Nf
TEVOOworCisgICAgLyogQ0QtUk9NIHByb2ZpbGUgZGVzY3JpcHRvciAqLworICAgIHByb2ZpbGVf
bnVtID0gTU1DX1BST0ZJTEVfQ0RfUk9NOworICAgIHByb2ZpbGVbMF0gPSAocHJvZmlsZV9udW0g
Pj4gOCkgJiAweGZmOworICAgIHByb2ZpbGVbMV0gPSBwcm9maWxlX251bSAmIDB4ZmY7CisgICAg
cHJvZmlsZVsyXSA9IGRldi0+Y2Rfcm9tID8gQ0RfUFJPRklMRV9DVVJSRU5UIDogMDsKKworICAg
IG91dGJ1ZlszXSA9IGFkZF9sZW47CisgICAgZmVhdHVyZV9sZW4gKz0gYWRkX2xlbjsKKworICAg
IHJldHVybiBmZWF0dXJlX2xlbjsKK30KKworI2RlZmluZSBDRF9GRUFUVVJFX0NPUkVfUEhZU19Q
Uk9GSUxFX0xFTiAgICA0CisKK3N0YXRpYyB1aW50MzJfdCBjZF9zY3NpX2FkZF9mZWF0dXJlX2Nv
cmUoQ2RTY3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVmLAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCBzdGFydF9mZWF0dXJlLCB1aW50MzJfdCByZXFf
dHlwZSkKK3sKKyAgICB1aW50OF90ICpwcm9maWxlID0gb3V0YnVmICsgQ0RfRkVBVFVSRV9ERVND
X0xFTjsKKyAgICB1aW50MzJfdCBmZWF0dXJlX2xlbiA9IENEX0ZFQVRVUkVfREVTQ19MRU4gKyBD
RF9GRUFUVVJFX0NPUkVfUEhZU19QUk9GSUxFX0xFTjsKKworICAgIGlmICghY2Rfc2NzaV9mZWF0
dXJlX3JlcG9ydGFibGUoQ0RfRkVBVFVSRV9OVU1fQ09SRSwgc3RhcnRfZmVhdHVyZSwgcmVxX3R5
cGUpKSB7CisgICAgICAgIHJldHVybiAwOworICAgIH0KKyAgICBvdXRidWZbMF0gPSAoQ0RfRkVB
VFVSRV9OVU1fQ09SRSA+PiA4KSAmIDB4ZmY7CisgICAgb3V0YnVmWzFdID0gQ0RfRkVBVFVSRV9O
VU1fQ09SRSAmIDB4ZmY7CisgICAgb3V0YnVmWzJdID0gQ0RfRkVBVFVSRV9QRVJTSVNURU5UIHwg
Q0RfRkVBVFVSRV9DVVJSRU5UOworICAgIG91dGJ1ZlszXSA9IENEX0ZFQVRVUkVfQ09SRV9QSFlT
X1BST0ZJTEVfTEVOOworCisgICAgcHJvZmlsZVszXSA9IENEX0ZFQVRVUkVfUEhZU19JRl9TQ1NJ
OworCisgICAgcmV0dXJuIGZlYXR1cmVfbGVuOworfQorCisjZGVmaW5lIENEX0ZFQVRVUkVfTU9S
UEhfUFJPR0lMRV9MRU4gICAgNAorI2RlZmluZSBDRF9GRUFUVVJFX01PUlBIX0FTWU5DX0VWRU5U
UyAgIDB4MDEKKworc3RhdGljIHVpbnQzMl90IGNkX3Njc2lfYWRkX2ZlYXR1cmVfbW9ycGgoQ2RT
Y3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVmLAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgdWludDMyX3Qgc3RhcnRfZmVhdHVyZSwgdWludDMyX3QgcmVxX3R5cGUp
Cit7CisgICAgdWludDhfdCAqcHJvZmlsZSA9IG91dGJ1ZiArIENEX0ZFQVRVUkVfREVTQ19MRU47
CisgICAgdWludDMyX3QgZmVhdHVyZV9sZW4gPSBDRF9GRUFUVVJFX0RFU0NfTEVOICsgQ0RfRkVB
VFVSRV9NT1JQSF9QUk9HSUxFX0xFTjsKKworICAgIGlmICghY2Rfc2NzaV9mZWF0dXJlX3JlcG9y
dGFibGUoQ0RfRkVBVFVSRV9OVU1fTU9SUEgsIHN0YXJ0X2ZlYXR1cmUsIHJlcV90eXBlKSkgewor
ICAgICAgICByZXR1cm4gMDsKKyAgICB9CisgICAgb3V0YnVmWzFdID0gQ0RfRkVBVFVSRV9OVU1f
TU9SUEg7CisgICAgb3V0YnVmWzJdID0gQ0RfRkVBVFVSRV9QRVJTSVNURU5UIHwgQ0RfRkVBVFVS
RV9DVVJSRU5UOworICAgIG91dGJ1ZlszXSA9IENEX0ZFQVRVUkVfTU9SUEhfUFJPR0lMRV9MRU47
CisKKyAgICBwcm9maWxlWzBdID0gQ0RfRkVBVFVSRV9NT1JQSF9BU1lOQ19FVkVOVFM7CisKKyAg
ICByZXR1cm4gZmVhdHVyZV9sZW47Cit9CisKKyNkZWZpbmUgQ0RfRkVBVFVSRV9SRU1PVkFCTEVf
UFJPRklMRV9MRU4gICAgNAorCitzdGF0aWMgdWludDMyX3QgY2Rfc2NzaV9hZGRfZmVhdHVyZV9y
ZW1vdmFibGUoQ2RTY3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVmLAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IHN0YXJ0X2ZlYXR1cmUsIHVp
bnQzMl90IHJlcV90eXBlKQoreworICAgIHVpbnQ4X3QgKnByb2ZpbGUgPSBvdXRidWYgKyBDRF9G
RUFUVVJFX0RFU0NfTEVOOworICAgIHVpbnQzMl90IGZlYXR1cmVfbGVuID0gQ0RfRkVBVFVSRV9E
RVNDX0xFTiArIENEX0ZFQVRVUkVfUkVNT1ZBQkxFX1BST0ZJTEVfTEVOOworCisgICAgaWYgKCFj
ZF9zY3NpX2ZlYXR1cmVfcmVwb3J0YWJsZShDRF9GRUFUVVJFX05VTV9SRU1PVkFCTEUsIHN0YXJ0
X2ZlYXR1cmUsIHJlcV90eXBlKSkgeworICAgICAgICByZXR1cm4gMDsKKyAgICB9CisgICAgb3V0
YnVmWzFdID0gQ0RfRkVBVFVSRV9OVU1fUkVNT1ZBQkxFOworICAgIG91dGJ1ZlsyXSA9IENEX0ZF
QVRVUkVfUEVSU0lTVEVOVCB8IENEX0ZFQVRVUkVfQ1VSUkVOVDsKKyAgICBvdXRidWZbM10gPSBD
RF9GRUFUVVJFX1JFTU9WQUJMRV9QUk9GSUxFX0xFTjsKKworICAgIHByb2ZpbGVbMF0gPSBDRF9G
RUFUVVJFX1JFTU9WQUJMRV9OT19QUlZOVF9KTVBSOworICAgIGlmIChkZXYtPnJlbW92YWJsZSkg
eworICAgICAgICBwcm9maWxlWzBdIHw9IChDRF9GRUFUVVJFX1JFTU9WQUJMRV9MT0FESU5HX1RS
QVkgfCBDRF9GRUFUVVJFX1JFTU9WQUJMRV9FSkVDVCk7CisgICAgfQorCisgICAgcmV0dXJuIGZl
YXR1cmVfbGVuOworfQorCisjZGVmaW5lIENEX0ZFQVRVUkVfUkFORE9NX1JFQURfUFJPRklMRV9M
RU4gICAgOAorCitzdGF0aWMgdWludDMyX3QgY2Rfc2NzaV9hZGRfZmVhdHVyZV9yYW5kb21fcmVh
ZChDZFNjc2lMVSAqZGV2LCB1aW50OF90ICpvdXRidWYsCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCBzdGFydF9mZWF0dXJlLCB1aW50MzJf
dCByZXFfdHlwZSkKK3sKKyAgICB1aW50OF90ICpwcm9maWxlID0gb3V0YnVmICsgQ0RfRkVBVFVS
RV9ERVNDX0xFTjsKKyAgICB1aW50MzJfdCBmZWF0dXJlX2xlbiA9IENEX0ZFQVRVUkVfREVTQ19M
RU4gKyBDRF9GRUFUVVJFX1JBTkRPTV9SRUFEX1BST0ZJTEVfTEVOOworCisgICAgaWYgKCFjZF9z
Y3NpX2ZlYXR1cmVfcmVwb3J0YWJsZShDRF9GRUFUVVJFX05VTV9SQU5ET01fUkVBRCwgc3RhcnRf
ZmVhdHVyZSwgcmVxX3R5cGUpKSB7CisgICAgICAgIHJldHVybiAwOworICAgIH0KKyAgICBvdXRi
dWZbMF0gPSAoQ0RfRkVBVFVSRV9OVU1fUkFORE9NX1JFQUQgPj4gOCkgJiAweGZmOworICAgIG91
dGJ1ZlsxXSA9IENEX0ZFQVRVUkVfTlVNX1JBTkRPTV9SRUFEICYgMHhmZjsKKyAgICBvdXRidWZb
Ml0gPSBDRF9GRUFUVVJFX1BFUlNJU1RFTlQgfCBDRF9GRUFUVVJFX0NVUlJFTlQ7CisgICAgb3V0
YnVmWzNdID0gQ0RfRkVBVFVSRV9SQU5ET01fUkVBRF9QUk9GSUxFX0xFTjsKKworICAgIHByb2Zp
bGVbMF0gPSAoZGV2LT5ibG9ja19zaXplID4+IDI0KSAmIDB4ZmY7CisgICAgcHJvZmlsZVsxXSA9
IChkZXYtPmJsb2NrX3NpemUgPj4gMTYpICYgMHhmZjsKKyAgICBwcm9maWxlWzJdID0gKGRldi0+
YmxvY2tfc2l6ZSA+PiA4KSAmIDB4ZmY7CisgICAgcHJvZmlsZVszXSA9IChkZXYtPmJsb2NrX3Np
emUpICYgMHhmZjsKKyAgICBwcm9maWxlWzVdID0gKGRldi0+Y2Rfcm9tKSA/IDB4MDEgOiAweDEw
OyAvKiBsb2dpY2FsIGJsb2NrcyBwZXIgcmVhZGFibGUgdW5pdCAqLworCisgICAgcmV0dXJuIGZl
YXR1cmVfbGVuOworfQorCisjZGVmaW5lIENEX0ZFQVRVUkVfQ0RfUkVBRF9QUk9GSUxFX0xFTiAg
ICA0CisKK3N0YXRpYyB1aW50MzJfdCBjZF9zY3NpX2FkZF9mZWF0dXJlX2NkX3JlYWQoQ2RTY3Np
TFUgKmRldiwgdWludDhfdCAqb3V0YnVmLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB1aW50MzJfdCBzdGFydF9mZWF0dXJlLCB1aW50MzJfdCByZXFfdHlwZSkK
K3sKKyAgICB1aW50OF90ICpwcm9maWxlID0gb3V0YnVmICsgQ0RfRkVBVFVSRV9ERVNDX0xFTjsK
KyAgICB1aW50MzJfdCBmZWF0dXJlX2xlbiA9IENEX0ZFQVRVUkVfREVTQ19MRU4gKyBDRF9GRUFU
VVJFX0NEX1JFQURfUFJPRklMRV9MRU47CisKKyAgICBpZiAoIWNkX3Njc2lfZmVhdHVyZV9yZXBv
cnRhYmxlKENEX0ZFQVRVUkVfTlVNX0NEX1JFQUQsIHN0YXJ0X2ZlYXR1cmUsIHJlcV90eXBlKSkg
eworICAgICAgICByZXR1cm4gMDsKKyAgICB9CisgICAgb3V0YnVmWzBdID0gKENEX0ZFQVRVUkVf
TlVNX0NEX1JFQUQgPj4gOCkgJiAweGZmOworICAgIG91dGJ1ZlsxXSA9IChDRF9GRUFUVVJFX05V
TV9DRF9SRUFEKSAmIDB4ZmY7CisgICAgb3V0YnVmWzJdID0gQ0RfRkVBVFVSRV9WRVJTSU9OXzEg
fCBDRF9GRUFUVVJFX1BFUlNJU1RFTlQgfCBDRF9GRUFUVVJFX0NVUlJFTlQ7CisgICAgb3V0YnVm
WzNdID0gQ0RfRkVBVFVSRV9DRF9SRUFEX1BST0ZJTEVfTEVOOworCisgICAgcHJvZmlsZVswXSA9
IDA7IC8qIEMyIEVycm9ycywgQ0QtVGV4dCBub3Qgc3VwcG9ydGUgKi8KKworICAgIHJldHVybiBm
ZWF0dXJlX2xlbjsKK30KKworI2RlZmluZSBDRF9GRUFUVVJFX0RWRF9SRUFEX1BST0ZJTEVfTEVO
ICAgIDAKKworc3RhdGljIHVpbnQzMl90IGNkX3Njc2lfYWRkX2ZlYXR1cmVfZHZkX3JlYWQoQ2RT
Y3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVmLAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgdWludDMyX3Qgc3RhcnRfZmVhdHVyZSwgdWludDMyX3QgcmVxX3R5
cGUpCit7CisgICAgdWludDMyX3QgZmVhdHVyZV9sZW4gPSBDRF9GRUFUVVJFX0RFU0NfTEVOICsg
Q0RfRkVBVFVSRV9EVkRfUkVBRF9QUk9GSUxFX0xFTjsKKworICAgIGlmICghY2Rfc2NzaV9mZWF0
dXJlX3JlcG9ydGFibGUoQ0RfRkVBVFVSRV9OVU1fQ0RfUkVBRCwgc3RhcnRfZmVhdHVyZSwgcmVx
X3R5cGUpKSB7CisgICAgICAgIHJldHVybiAwOworICAgIH0KKyAgICBvdXRidWZbMF0gPSAoQ0Rf
RkVBVFVSRV9OVU1fRFZEX1JFQUQgPj4gOCkgJiAweGZmOworICAgIG91dGJ1ZlsxXSA9IChDRF9G
RUFUVVJFX05VTV9EVkRfUkVBRCkgJiAweGZmOworICAgIG91dGJ1ZlsyXSA9IENEX0ZFQVRVUkVf
VkVSU0lPTl8xIHwgQ0RfRkVBVFVSRV9QRVJTSVNURU5UIHwgQ0RfRkVBVFVSRV9DVVJSRU5UOwor
ICAgIG91dGJ1ZlszXSA9IENEX0ZFQVRVUkVfRFZEX1JFQURfUFJPRklMRV9MRU47CisKKyAgICBy
ZXR1cm4gZmVhdHVyZV9sZW47Cit9CisKKyNkZWZpbmUgQ0RfRkVBVFVSRV9QT1dFUl9NTkdUX1BS
T0ZJTEVfTEVOICAgIDAKKworc3RhdGljIHVpbnQzMl90IGNkX3Njc2lfYWRkX2ZlYXR1cmVfcG93
ZXJfbWdtdChDZFNjc2lMVSAqZGV2LCB1aW50OF90ICpvdXRidWYsCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IHN0YXJ0X2ZlYXR1cmUsIHVp
bnQzMl90IHJlcV90eXBlKQoreworICAgIHVpbnQzMl90IGZlYXR1cmVfbGVuID0gQ0RfRkVBVFVS
RV9ERVNDX0xFTiArIENEX0ZFQVRVUkVfUE9XRVJfTU5HVF9QUk9GSUxFX0xFTjsKKworICAgIGlm
ICghY2Rfc2NzaV9mZWF0dXJlX3JlcG9ydGFibGUoQ0RfRkVBVFVSRV9OVU1fUE9XRVJfTU5HVCwg
c3RhcnRfZmVhdHVyZSwgcmVxX3R5cGUpKSB7CisgICAgICAgIHJldHVybiAwOworICAgIH0KKyAg
ICBvdXRidWZbMF0gPSAoQ0RfRkVBVFVSRV9OVU1fUE9XRVJfTU5HVCA+PiA4KSAmIDB4ZmY7Cisg
ICAgb3V0YnVmWzFdID0gKENEX0ZFQVRVUkVfTlVNX1BPV0VSX01OR1QpICYgMHhmZjsKKyAgICBv
dXRidWZbMl0gPSBDRF9GRUFUVVJFX1BFUlNJU1RFTlQgfCBDRF9GRUFUVVJFX0NVUlJFTlQ7Cisg
ICAgb3V0YnVmWzNdID0gQ0RfRkVBVFVSRV9QT1dFUl9NTkdUX1BST0ZJTEVfTEVOOworCisgICAg
cmV0dXJuIGZlYXR1cmVfbGVuOworfQorCisjZGVmaW5lIENEX0ZFQVRVUkVfVElNRU9VVF9QUk9G
SUxFX0xFTiAgICAwCisKK3N0YXRpYyB1aW50MzJfdCBjZF9zY3NpX2FkZF9mZWF0dXJlX3RpbWVv
dXQoQ2RTY3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVmLAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCBzdGFydF9mZWF0dXJlLCB1aW50MzJfdCBy
ZXFfdHlwZSkKK3sKKyAgICB1aW50MzJfdCBmZWF0dXJlX2xlbiA9IENEX0ZFQVRVUkVfREVTQ19M
RU4gKyBDRF9GRUFUVVJFX1RJTUVPVVRfUFJPRklMRV9MRU47CisKKyAgICBpZiAoIWNkX3Njc2lf
ZmVhdHVyZV9yZXBvcnRhYmxlKENEX0ZFQVRVUkVfTlVNX1RJTUVPVVQsIHN0YXJ0X2ZlYXR1cmUs
IHJlcV90eXBlKSkgeworICAgICAgICByZXR1cm4gMDsKKyAgICB9CisgICAgb3V0YnVmWzBdID0g
KENEX0ZFQVRVUkVfTlVNX1RJTUVPVVQgPj4gOCkgJiAweGZmOworICAgIG91dGJ1ZlsxXSA9IENE
X0ZFQVRVUkVfTlVNX1RJTUVPVVQgJiAweGZmOworICAgIG91dGJ1ZlsyXSA9IENEX0ZFQVRVUkVf
UEVSU0lTVEVOVCB8IENEX0ZFQVRVUkVfQ1VSUkVOVDsKKyAgICBvdXRidWZbM10gPSBDRF9GRUFU
VVJFX1RJTUVPVVRfUFJPRklMRV9MRU47CisKKyAgICByZXR1cm4gZmVhdHVyZV9sZW47Cit9CisK
K3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX2dldF9jb25maWd1cmF0aW9uKENkU2NzaUxVICpkZXYs
IENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICB1aW50OF90ICpvdXRidWYgPSByZXEtPmJ1ZjsK
KyAgICB1aW50MzJfdCBwcm9maWxlX251bSA9ICghZGV2LT5jZF9yb20pID8gTU1DX1BST0ZJTEVf
RFZEX1JPTSA6IE1NQ19QUk9GSUxFX0NEX1JPTTsKKyAgICB1aW50MzJfdCByZXFfdHlwZSwgc3Rh
cnRfZmVhdHVyZSwgcmVzcF9sZW47CisKKyAgICByZXEtPnhmZXJfZGlyID0gU0NTSV9YRkVSX0ZS
T01fREVWOworCisgICAgcmVxX3R5cGUgPSByZXEtPmNkYlsxXSAmIDB4MzsKKyAgICBzdGFydF9m
ZWF0dXJlID0gKHJlcS0+Y2RiWzJdIDw8IDgpIHwgcmVxLT5jZGJbM107CisgICAgcmVxLT5yZXFf
bGVuID0gKHJlcS0+Y2RiWzddIDw8IDgpIHwgcmVxLT5jZGJbOF07CisKKyAgICBtZW1zZXQob3V0
YnVmLCAwLCByZXEtPnJlcV9sZW4pOworCisgICAgLyogYXQgbGVhc3QgRmVhdHVyZSBIZWFkZXIg
c2hvdWxkIGJlIHByZXNlbnQsIHRvIGJlIGZpbGxlZCBsYXRlciAqLworICAgIHJlc3BfbGVuID0g
Q0RfRkVBVFVSRV9IRUFERVJfTEVOOworCisgICAgc3dpdGNoIChyZXFfdHlwZSkgeworICAgIGNh
c2UgQ0RfRkVBVFVSRV9SRVFfQUxMOgorICAgIGNhc2UgQ0RfRkVBVFVSRV9SRVFfQ1VSUkVOVDoK
KyAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9hZGRfZmVhdHVyZV9wcm9maWxlc19saXN0KGRl
diwgb3V0YnVmICsgcmVzcF9sZW4sIHN0YXJ0X2ZlYXR1cmUsCisgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXFfdHlwZSk7CisgICAgICAgIHJl
c3BfbGVuICs9IGNkX3Njc2lfYWRkX2ZlYXR1cmVfY29yZShkZXYsIG91dGJ1ZiArIHJlc3BfbGVu
LCBzdGFydF9mZWF0dXJlLCByZXFfdHlwZSk7CisgICAgICAgIHJlc3BfbGVuICs9IGNkX3Njc2lf
YWRkX2ZlYXR1cmVfbW9ycGgoZGV2LCBvdXRidWYgKyByZXNwX2xlbiwgc3RhcnRfZmVhdHVyZSwg
cmVxX3R5cGUpOworICAgICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9mZWF0dXJlX3JlbW92
YWJsZShkZXYsIG91dGJ1ZiArIHJlc3BfbGVuLCBzdGFydF9mZWF0dXJlLCByZXFfdHlwZSk7Cisg
ICAgICAgIHJlc3BfbGVuICs9IGNkX3Njc2lfYWRkX2ZlYXR1cmVfcmFuZG9tX3JlYWQoZGV2LCBv
dXRidWYgKyByZXNwX2xlbiwgc3RhcnRfZmVhdHVyZSwKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXFfdHlwZSk7CisgICAgICAgIHJlc3BfbGVu
ICs9IGNkX3Njc2lfYWRkX2ZlYXR1cmVfY2RfcmVhZChkZXYsIG91dGJ1ZiArIHJlc3BfbGVuLCBz
dGFydF9mZWF0dXJlLCByZXFfdHlwZSk7CisgICAgICAgIHJlc3BfbGVuICs9IGNkX3Njc2lfYWRk
X2ZlYXR1cmVfZHZkX3JlYWQoZGV2LCBvdXRidWYgKyByZXNwX2xlbiwgc3RhcnRfZmVhdHVyZSwg
cmVxX3R5cGUpOworICAgICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9mZWF0dXJlX3Bvd2Vy
X21nbXQoZGV2LCBvdXRidWYgKyByZXNwX2xlbiwgc3RhcnRfZmVhdHVyZSwgcmVxX3R5cGUpOwor
ICAgICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9mZWF0dXJlX3RpbWVvdXQoZGV2LCBvdXRi
dWYgKyByZXNwX2xlbiwgc3RhcnRfZmVhdHVyZSwgcmVxX3R5cGUpOworICAgICAgICBicmVhazsK
KyAgICBjYXNlIENEX0ZFQVRVUkVfUkVRX1NJTkdMRToKKyAgICAgICAgc3dpdGNoIChzdGFydF9m
ZWF0dXJlKSB7CisgICAgICAgIGNhc2UgQ0RfRkVBVFVSRV9OVU1fQ09SRToKKyAgICAgICAgICAg
IHJlc3BfbGVuICs9IGNkX3Njc2lfYWRkX2ZlYXR1cmVfY29yZShkZXYsIG91dGJ1ZiArIHJlc3Bf
bGVuLCBzdGFydF9mZWF0dXJlLCByZXFfdHlwZSk7CisgICAgICAgICAgICBicmVhazsKKyAgICAg
ICAgY2FzZSBDRF9GRUFUVVJFX05VTV9NT1JQSDoKKyAgICAgICAgICAgIHJlc3BfbGVuICs9IGNk
X3Njc2lfYWRkX2ZlYXR1cmVfbW9ycGgoZGV2LCBvdXRidWYgKyByZXNwX2xlbiwgc3RhcnRfZmVh
dHVyZSwgcmVxX3R5cGUpOworICAgICAgICAgICAgYnJlYWs7CisgICAgICAgIGNhc2UgQ0RfRkVB
VFVSRV9OVU1fUkVNT1ZBQkxFOgorICAgICAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9hZGRf
ZmVhdHVyZV9yZW1vdmFibGUoZGV2LCBvdXRidWYgKyByZXNwX2xlbiwgc3RhcnRfZmVhdHVyZSwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJl
cV90eXBlKTsKKyAgICAgICAgICAgIGJyZWFrOworICAgICAgICBjYXNlIENEX0ZFQVRVUkVfTlVN
X1JBTkRPTV9SRUFEOgorICAgICAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9hZGRfZmVhdHVy
ZV9yYW5kb21fcmVhZChkZXYsIG91dGJ1ZiArIHJlc3BfbGVuLCBzdGFydF9mZWF0dXJlLAorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXFf
dHlwZSk7CisgICAgICAgICAgICBicmVhazsKKyAgICAgICAgY2FzZSBDRF9GRUFUVVJFX05VTV9D
RF9SRUFEOgorICAgICAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9hZGRfZmVhdHVyZV9jZF9y
ZWFkKGRldiwgb3V0YnVmICsgcmVzcF9sZW4sIHN0YXJ0X2ZlYXR1cmUsCisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxX3R5cGUpOworICAgICAg
ICAgICAgYnJlYWs7CisgICAgICAgIGNhc2UgQ0RfRkVBVFVSRV9OVU1fRFZEX1JFQUQ6CisgICAg
ICAgICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9mZWF0dXJlX2R2ZF9yZWFkKGRldiwgb3V0
YnVmICsgcmVzcF9sZW4sIHN0YXJ0X2ZlYXR1cmUsCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcV90eXBlKTsKKyAgICAgICAgICAgIGJyZWFr
OworICAgICAgICBjYXNlIENEX0ZFQVRVUkVfTlVNX1BPV0VSX01OR1Q6CisgICAgICAgICAgICBy
ZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9mZWF0dXJlX3Bvd2VyX21nbXQoZGV2LCBvdXRidWYgKyBy
ZXNwX2xlbiwgc3RhcnRfZmVhdHVyZSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICByZXFfdHlwZSk7CisgICAgICAgICAgICBicmVhazsKKyAg
ICAgICAgY2FzZSBDRF9GRUFUVVJFX05VTV9USU1FT1VUOgorICAgICAgICAgICAgcmVzcF9sZW4g
Kz0gY2Rfc2NzaV9hZGRfZmVhdHVyZV90aW1lb3V0KGRldiwgb3V0YnVmICsgcmVzcF9sZW4sIHN0
YXJ0X2ZlYXR1cmUsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgcmVxX3R5cGUpOworICAgICAgICAgICAgYnJlYWs7CisgICAgICAgIGRlZmF1bHQ6
CisgICAgICAgICAgICBicmVhazsKKyAgICAgICAgfQorICAgICAgICBicmVhazsKKworICAgIGRl
ZmF1bHQ6CisgICAgICAgIFNQSUNFX0RFQlVHKCJnZXRfY29uZmlndXJhdGlvbiwgbHVuOiV1IGlu
dmFsaWQgcnQ6JXUgc3RhcnRfZjoldSIsCisgICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBy
ZXFfdHlwZSwgc3RhcnRfZmVhdHVyZSk7CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2No
ZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX0lOVkFMSURfQ0RCX0ZJRUxEKTsKKyAgICAg
ICAgcmV0dXJuOworICAgIH0KKworICAgIC8qIHNldCB0b3RhbCBkYXRhIGxlbiAqLworICAgIG91
dGJ1ZlswXSA9IChyZXNwX2xlbiA+PiAyNCkgJiAweGZmOworICAgIG91dGJ1ZlsxXSA9IChyZXNw
X2xlbiA+PiAxNikgJiAweGZmOworICAgIG91dGJ1ZlsyXSA9IChyZXNwX2xlbiA+PiA4KSAmIDB4
ZmY7CisgICAgb3V0YnVmWzNdID0gcmVzcF9sZW4gJiAweGZmOworCisgICAgLyogcmVwb3J0IGN1
cnJlbnQgcHJvZmlsZSBudW0gKi8KKyAgICBvdXRidWZbNl0gPSAocHJvZmlsZV9udW0gPj4gOCkg
JiAweGZmOworICAgIG91dGJ1Zls3XSA9IHByb2ZpbGVfbnVtICYgMHhmZjsKKworICAgIHJlcS0+
aW5fbGVuID0gTUlOKHJlcS0+cmVxX2xlbiwgcmVzcF9sZW4pOworCisgICAgU1BJQ0VfREVCVUco
ImdldF9jb25maWd1cmF0aW9uLCBsdW46JXUgcnQ6JXUgc3RhcnRfZjoldSByZXNwX2xlbjoldSIs
CisgICAgICAgICAgICAgICAgcmVxLT5sdW4sIHJlcV90eXBlLCBzdGFydF9mZWF0dXJlLCByZXNw
X2xlbik7CisKKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKwor
I2RlZmluZSBDRF9HRVRfRVZFTlRfU1RBVFVTX0lNTUVEICAgICAgICAgICAgMHgwMQorCisjZGVm
aW5lIENEX0dFVF9FVkVOVF9IRUFERVJfTk9fRVZFTlRfQVZBSUwgICgweDAxIDw8IDcpCisjZGVm
aW5lIENEX0dFVF9FVkVOVF9IRUFERVJfTEVOICAgICAgICAgICAgIDQKKworI2RlZmluZSBDRF9H
RVRfRVZFTlRfQ0xBU1NfTk9ORSAgICAgICAgICAgICAoMHgwMCkKKyNkZWZpbmUgQ0RfR0VUX0VW
RU5UX0NMQVNTX09QRVJfQ0hBTkdFICAgICAgKDB4MDEpCisjZGVmaW5lIENEX0dFVF9FVkVOVF9D
TEFTU19QT1dFUl9NR01UICAgICAgICgweDAyKQorI2RlZmluZSBDRF9HRVRfRVZFTlRfQ0xBU1Nf
RVhURVJOQUxfUkVRICAgICAoMHgwMykKKyNkZWZpbmUgQ0RfR0VUX0VWRU5UX0NMQVNTX01FRElB
ICAgICAgICAgICAgKDB4MDQpCisjZGVmaW5lIENEX0dFVF9FVkVOVF9DTEFTU19NVUxUSV9JTklU
SUFUT1IgICgweDA1KQorI2RlZmluZSBDRF9HRVRfRVZFTlRfQ0xBU1NfREVWX0JVU1kgICAgICAg
ICAoMHgwNikKKworI2RlZmluZSBDRF9HRVRfRVZFTlRfTEVOX01FRElBICAgICAgICAgICAgICA0
CisKKyNkZWZpbmUgQ0RfTUVESUFfU1RBVFVTX01FRElBX1BSRVNFTlQgICAgICAgMHgxCisjZGVm
aW5lIENEX01FRElBX1NUQVRVU19UUkFZX09QRU4gICAgICAgICAgIDB4MgorCitzdGF0aWMgdWlu
dDMyX3QgY2Rfc2NzaV9jbWRfZ2V0X2V2ZW50X3Jlc3BfYWRkX21lZGlhKENkU2NzaUxVICpkZXYs
IHVpbnQ4X3QgKm91dGJ1ZikKK3sKKyAgICBvdXRidWZbMF0gPSAodWludDhfdClkZXYtPm1lZGlh
X2V2ZW50ICYgMHgwZjsKKyAgICBvdXRidWZbMV0gPSAodWludDhfdCkoKGRldi0+bG9hZGVkID8g
MCA6IENEX01FRElBX1NUQVRVU19UUkFZX09QRU4pIHwKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgKGRldi0+c3RyZWFtICE9IE5VTEwgPyBDRF9NRURJQV9TVEFUVVNfTUVESUFfUFJFU0VOVCA6
IDApKTsKKworICAgIGRldi0+bWVkaWFfZXZlbnQgPSBDRF9NRURJQV9FVkVOVF9OT19DSEFOR0U7
IC8qIHJlc2V0IHRoZSBldmVudCAqLworICAgIHJldHVybiBDRF9HRVRfRVZFTlRfTEVOX01FRElB
OworfQorCisjZGVmaW5lIENEX0dFVF9FVkVOVF9MRU5fUE9XRVIgICAgICAgICAgICAgIDQKKwor
I2RlZmluZSBDRF9QT1dFUl9TVEFUVVNfQUNUSVZFICAgICAgICAgICAgICAweDEKKyNkZWZpbmUg
Q0RfUE9XRVJfU1RBVFVTX0lETEUgICAgICAgICAgICAgICAgMHgyCisKK3N0YXRpYyB1aW50MzJf
dCBjZF9zY3NpX2NtZF9nZXRfZXZlbnRfcmVzcF9hZGRfcG93ZXIoQ2RTY3NpTFUgKmRldiwgdWlu
dDhfdCAqb3V0YnVmKQoreworICAgIG91dGJ1ZlswXSA9ICh1aW50OF90KWRldi0+cG93ZXJfZXZl
bnQgJiAweDBmOworICAgIG91dGJ1ZlsxXSA9ICh1aW50OF90KSgoZGV2LT5wb3dlcl9jb25kID09
IENEX1NDU0lfUE9XRVJfQUNUSVZFKSA/CisgICAgICAgICAgICAgICAgICAgICAgICAgICBDRF9Q
T1dFUl9TVEFUVVNfQUNUSVZFIDogQ0RfUE9XRVJfU1RBVFVTX0lETEUpOworCisgICAgZGV2LT5w
b3dlcl9ldmVudCA9IENEX1BPV0VSX0VWRU5UX05PX0NIQU5HRTsgLyogcmVzZXQgdGhlIGV2ZW50
ICovCisgICAgcmV0dXJuIENEX0dFVF9FVkVOVF9MRU5fUE9XRVI7Cit9CisKK3N0YXRpYyB2b2lk
IGNkX3Njc2lfY21kX2dldF9ldmVudF9zdGF0dXNfbm90aWZpY2F0aW9uKENkU2NzaUxVICpkZXYs
IENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICB1aW50OF90ICpvdXRidWYgPSByZXEtPmJ1ZjsK
KyAgICB1aW50MzJfdCByZXNwX2xlbiA9IENEX0dFVF9FVkVOVF9IRUFERVJfTEVOOworICAgIGNv
bnN0IHVpbnQzMl90IHBvd2VyX2NsYXNzX21hc2sgPSAoMHgwMSA8PCBDRF9HRVRfRVZFTlRfQ0xB
U1NfUE9XRVJfTUdNVCk7CisgICAgY29uc3QgdWludDMyX3QgbWVkaWFfY2xhc3NfbWFzayA9ICgw
eDAxIDw8IENEX0dFVF9FVkVOVF9DTEFTU19NRURJQSk7CisgICAgdWludDMyX3QgY2xhc3Nlc19z
dXBwb3J0ZWQgPSAgcG93ZXJfY2xhc3NfbWFzayB8IG1lZGlhX2NsYXNzX21hc2s7CisgICAgdWlu
dDMyX3QgaW1tZWQsIGNsYXNzZXNfcmVxdWVzdGVkOworCisgICAgcmVxLT54ZmVyX2RpciA9IFND
U0lfWEZFUl9GUk9NX0RFVjsKKworICAgIGltbWVkID0gcmVxLT5jZGJbMV0gJiBDRF9HRVRfRVZF
TlRfU1RBVFVTX0lNTUVEOworICAgIGNsYXNzZXNfcmVxdWVzdGVkID0gcmVxLT5jZGJbNF07Cisg
ICAgcmVxLT5yZXFfbGVuID0gKHJlcS0+Y2RiWzddIDw8IDgpIHwgcmVxLT5jZGJbOF07CisKKyAg
ICBpZiAoIWltbWVkKSB7CisgICAgICAgIFNQSUNFX0RFQlVHKCJnZXRfZXZlbnRfc3RhdHVzX25v
dGlmaWNhdGlvbiwgbHVuOiV1IgorICAgICAgICAgICAgICAgICIgaW1tOjAgY2xhc3NfcmVxOiUw
MngsIE5vbi1pbW1lZGlhdGUgKGFzeW5jKSBtb2RlIHVuc3VwcG9ydGVkIiwKKyAgICAgICAgICAg
ICAgICByZXEtPmx1biwgY2xhc3Nlc19yZXF1ZXN0ZWQpOworICAgICAgICBjZF9zY3NpX2NtZF9j
b21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZBTElEX0NEQl9GSUVM
RCk7CisgICAgICAgIHJldHVybjsKKyAgICB9CisKKyAgICBtZW1zZXQob3V0YnVmLCAwLCByZXEt
PnJlcV9sZW4pOworICAgIGlmICgoY2xhc3Nlc19zdXBwb3J0ZWQgJiBjbGFzc2VzX3JlcXVlc3Rl
ZCkgIT0gMCkgeworICAgICAgICBpZiAoY2xhc3Nlc19yZXF1ZXN0ZWQgJiBwb3dlcl9jbGFzc19t
YXNrKSB7CisgICAgICAgICAgICBvdXRidWZbMl0gPSBDRF9HRVRfRVZFTlRfQ0xBU1NfUE9XRVJf
TUdNVDsKKyAgICAgICAgICAgIG91dGJ1ZlszXSA9ICh1aW50OF90KXBvd2VyX2NsYXNzX21hc2s7
CisKKyAgICAgICAgICAgIFNQSUNFX0RFQlVHKCJnZXRfZXZlbnRfc3RhdHVzX25vdGlmaWNhdGlv
biwgbHVuOiV1IgorICAgICAgICAgICAgICAgICAgICAgICAgIiBpbW06JXUgY2xhc3NfcmVxOjB4
JTAyeCBjbGFzc19zdXA6MHglMDJ4IgorICAgICAgICAgICAgICAgICAgICAgICAgIiBwb3dlcl9l
dmVudDoweCUwMnggcG93ZXJfY29uZDoweCUwMngiLAorICAgICAgICAgICAgICAgICAgICAgICAg
cmVxLT5sdW4sIGltbWVkLCBjbGFzc2VzX3JlcXVlc3RlZCwgY2xhc3Nlc19zdXBwb3J0ZWQsCisg
ICAgICAgICAgICAgICAgICAgICAgICBkZXYtPnBvd2VyX2V2ZW50LCBkZXYtPnBvd2VyX2NvbmQp
OworCisgICAgICAgICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2NtZF9nZXRfZXZlbnRfcmVzcF9h
ZGRfcG93ZXIoZGV2LCBvdXRidWYgKyByZXNwX2xlbik7CisgICAgICAgIH0gZWxzZSBpZiAoY2xh
c3Nlc19yZXF1ZXN0ZWQgJiBtZWRpYV9jbGFzc19tYXNrKSB7CisgICAgICAgICAgICBvdXRidWZb
Ml0gPSBDRF9HRVRfRVZFTlRfQ0xBU1NfTUVESUE7CisgICAgICAgICAgICBvdXRidWZbM10gPSAo
dWludDhfdCltZWRpYV9jbGFzc19tYXNrOworCisgICAgICAgICAgICBTUElDRV9ERUJVRygiZ2V0
X2V2ZW50X3N0YXR1c19ub3RpZmljYXRpb24sIGx1bjoldSIKKyAgICAgICAgICAgICAgICAgICAg
ICAgICIgaW1tOiV1IGNsYXNzX3JlcToweCUwMnggY2xhc3Nfc3VwOjB4JTAyeCIKKyAgICAgICAg
ICAgICAgICAgICAgICAgICIgbWVkaWFfZXZlbnQ6MHglMDJ4IGxvYWRlZDogJWQiLAorICAgICAg
ICAgICAgICAgICAgICAgICAgcmVxLT5sdW4sIGltbWVkLCBjbGFzc2VzX3JlcXVlc3RlZCwgY2xh
c3Nlc19zdXBwb3J0ZWQsCisgICAgICAgICAgICAgICAgICAgICAgICBkZXYtPm1lZGlhX2V2ZW50
LCBkZXYtPmxvYWRlZCk7CisKKyAgICAgICAgICAgIHJlc3BfbGVuICs9IGNkX3Njc2lfY21kX2dl
dF9ldmVudF9yZXNwX2FkZF9tZWRpYShkZXYsIG91dGJ1ZiArIHJlc3BfbGVuKTsKKyAgICAgICAg
fQorICAgIH0gZWxzZSB7CisgICAgICAgIG91dGJ1ZlsyXSA9IENEX0dFVF9FVkVOVF9IRUFERVJf
Tk9fRVZFTlRfQVZBSUwgfCBDRF9HRVRfRVZFTlRfQ0xBU1NfTk9ORTsKKworICAgICAgICBTUElD
RV9ERUJVRygiZ2V0X2V2ZW50X3N0YXR1c19ub3RpZmljYXRpb24sIGx1bjoldSIKKyAgICAgICAg
ICAgICAgICAgICAgIiBpbW06JXUgY2xhc3NfcmVxOjB4JTAyeCBjbGFzc19zdXA6MHglMDJ4Igor
ICAgICAgICAgICAgICAgICAgICAiIG5vbmUgb2YgcmVxdWVzdGVkIGV2ZW50cyBzdXBwb3J0ZWQi
LAorICAgICAgICAgICAgICAgICAgICByZXEtPmx1biwgaW1tZWQsIGNsYXNzZXNfcmVxdWVzdGVk
LCBjbGFzc2VzX3N1cHBvcnRlZCk7CisgICAgfQorICAgIG91dGJ1ZlsxXSA9ICh1aW50OF90KShy
ZXNwX2xlbiAtIDIpOyAvKiBFdmVudCBEYXRhIExlbmd0aCBMU0IsIGxlbmd0aCBleGNsdWRpbmcg
dGhlCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGZpZWxkIGl0
c2VsZiAqLworICAgIG91dGJ1ZlszXSA9ICh1aW50OF90KWNsYXNzZXNfc3VwcG9ydGVkOworCisg
ICAgcmVxLT5pbl9sZW4gPSBNSU4ocmVxLT5yZXFfbGVuLCByZXNwX2xlbik7CisgICAgY2Rfc2Nz
aV9jbWRfY29tcGxldGVfZ29vZChkZXYsIHJlcSk7Cit9CisKKyNkZWZpbmUgQ0RfRVhUX1JFUV9F
VkVOVF9GT1JNQVRfTk9fQ0hHICAgICAgICAgIDB4MDAKKyNkZWZpbmUgQ0RfRVhUX1JFUV9FVkVO
VF9GT1JNQVRfTFVfS0VZX0RPV04gICAgIDB4MDEKKyNkZWZpbmUgQ0RfRVhUX1JFUV9FVkVOVF9G
T1JNQVRfTFVfS0VZX1VQICAgICAgIDB4MDIKKyNkZWZpbmUgQ0RfRVhUX1JFUV9FVkVOVF9GT1JN
QVRfUkVRX05PVElGWSAgICAgIDB4MDMKKworI2RlZmluZSBDRF9FWFRfUkVRX1NUQVRVU19SRUFE
WSAgICAgICAgICAgICAgICAgMHgwMAorI2RlZmluZSBDRF9FWFRfUkVRX1NUQVRVU19PVEhFUl9Q
UkVWRU5UICAgICAgICAgMHgwMQorCisjZGVmaW5lIENEX0VYVF9SRVFfQ09ERV9OT19SRVFVRVNU
ICAgICAgICAgICAgICAweDAwCisjZGVmaW5lIENEX0VYVF9SRVFfQ09ERV9PVkVSUlVOICAgICAg
ICAgICAgICAgICAweDAxCisjZGVmaW5lIENEX0VYVF9SRVFfQ09ERV9QTEFZICAgICAgICAgICAg
ICAgICAgICAweDEwMQorI2RlZmluZSBDRF9FWFRfUkVRX0NPREVfUkVXSU5EICAgICAgICAgICAg
ICAgICAgMHgxMDIKKyNkZWZpbmUgQ0RfRVhUX1JFUV9DT0RFX0ZBU1RfRlcgICAgICAgICAgICAg
ICAgIDB4MTAzCisjZGVmaW5lIENEX0VYVF9SRVFfQ09ERV9QQVVTRSAgICAgICAgICAgICAgICAg
ICAweDEwNAorI2RlZmluZSBDRF9FWFRfUkVRX0NPREVfU1RPUCAgICAgICAgICAgICAgICAgICAg
MHgxMDYKKyNkZWZpbmUgQ0RfRVhUX1JFUV9DT0RFX0FTQ0lJX0JBU0UgICAgICAgICAgICAgIDB4
MjAwIC8qIFNDU0lJIHZhbHVlIGlzIExTQiAqLworCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9z
ZW5kX2V2ZW50KENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICB1aW50
OF90ICpwYXJhbSwgKmV2ZW50OworICAgIHVpbnQzMl90IGltbWVkLCBwYXJhbV9saXN0X2xlbjsK
KyAgICB1aW50MzJfdCBldmVudF9wYXJhbV9sZW4sIG5vdGlmaWNhdGlvbl9jbGFzczsKKyAgICB1
aW50MzJfdCBleHRfcmVxX2V2ZW50LCBleHRfcmVxX3N0YXR1cywgcGVyc19wcmV2ZW50LCBleHRf
cmVxX2NvZGU7CisKKyAgICByZXEtPnhmZXJfZGlyID0gU0NTSV9YRkVSX1RPX0RFVjsKKworICAg
IGltbWVkID0gcmVxLT5jZGJbMV0gJiAweDAxOworICAgIHBhcmFtX2xpc3RfbGVuID0gKHJlcS0+
Y2RiWzhdIDw8IDgpIHwgcmVxLT5jZGJbOV07CisKKyAgICBpZiAocmVxLT5idWZfbGVuIDwgcGFy
YW1fbGlzdF9sZW4pIHsKKyAgICAgICAgU1BJQ0VfREVCVUcoInNlbmRfZXZlbnQsIGx1bjoldSBp
bnZhbGlkIHBhcmFtIGxpc3QgbGVuOjB4JXgsIGJ1Zl9sZW46MHgleCIsCisgICAgICAgICAgICAg
ICAgICAgIHJlcS0+bHVuLCBwYXJhbV9saXN0X2xlbiwgcmVxLT5idWZfbGVuKTsKKyAgICAgICAg
Y2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfSU5W
QUxJRF9QQVJBTV9MRU4pOworICAgICAgICByZXR1cm47CisgICAgfQorICAgIHBhcmFtID0gcmVx
LT5idWY7CisgICAgZXZlbnRfcGFyYW1fbGVuID0gKHBhcmFtWzBdIDw8IDgpIHwgcGFyYW1bMV07
CisKKyAgICBub3RpZmljYXRpb25fY2xhc3MgPSBwYXJhbVsyXSAmIDB4MDc7CisgICAgaWYgKG5v
dGlmaWNhdGlvbl9jbGFzcyAhPSBDRF9HRVRfRVZFTlRfQ0xBU1NfRVhURVJOQUxfUkVRKSB7Cisg
ICAgICAgIFNQSUNFX0RFQlVHKCJzZW5kX2V2ZW50LCBsdW46JXUgaW52YWxpZCBub3RpZmljYXRp
b24gY2xhc3M6MHgleCIsCisgICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBub3RpZmljYXRp
b25fY2xhc3MpOworICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwg
cmVxLCAmc2Vuc2VfY29kZV9JTlZBTElEX0NEQl9GSUVMRCk7CisgICAgICAgIHJldHVybjsKKyAg
ICB9CisKKyAgICBldmVudCA9IHBhcmFtICsgQ0RfR0VUX0VWRU5UX0hFQURFUl9MRU47CisgICAg
ZXh0X3JlcV9ldmVudCA9IGV2ZW50WzBdICYgMHhmZjsKKyAgICBleHRfcmVxX3N0YXR1cyA9IGV2
ZW50WzFdICYgMHgwZjsKKyAgICBwZXJzX3ByZXZlbnQgPSBldmVudFsxXSAmIDB4ODA7CisgICAg
ZXh0X3JlcV9jb2RlID0gKGV2ZW50WzJdIDw8IDgpIHwgZXZlbnRbM107CisKKyAgICBTUElDRV9E
RUJVRygic2VuZF9ldmVudCwgbHVuOiV1IGltbWVkOiV1IHBhcmFtX2xlbjoldSIKKyAgICAgICAg
ICAgICAgICAiIGV4dF9yZXFfZXZlbnQ6MHgleCBleHRfcmVxX3N0YXR1czoweCV4IgorICAgICAg
ICAgICAgICAgICIgcGVyc19wcmV2ZW50OjB4JXggZXh0X3JlcV9jb2RlOjB4JXgiLAorICAgICAg
ICAgICAgICAgIHJlcS0+bHVuLCBpbW1lZCwgZXZlbnRfcGFyYW1fbGVuLCBleHRfcmVxX2V2ZW50
LAorICAgICAgICAgICAgICAgIGV4dF9yZXFfc3RhdHVzLCBwZXJzX3ByZXZlbnQsIGV4dF9yZXFf
Y29kZSk7CisKKyAgICAvKiBUb0RvOiBwcm9jZXNzIHRoZSBldmVudCAqLworCisgICAgY2Rfc2Nz
aV9jbWRfY29tcGxldGVfZ29vZChkZXYsIHJlcSk7Cit9CisKKyNkZWZpbmUgQ0RfTUVESVVNX1JF
TU9WQUxfUkVRX0FMTE9XICAgICAgICAgICAgICAgICAweDAwCisjZGVmaW5lIENEX01FRElVTV9S
RU1PVkFMX1JFUV9QUkVWRU5UICAgICAgICAgICAgICAgMHgwMQorI2RlZmluZSBDRF9NRURJVU1f
UkVNT1ZBTF9SRVFfQUxMT1dfQ0hBTkdFUiAgICAgICAgIDB4MDIKKyNkZWZpbmUgQ0RfTUVESVVN
X1JFTU9WQUxfUkVRX1BSRVZFTlRfQ0hBTkdFUiAgICAgICAweDAzCisKK3N0YXRpYyB2b2lkIGNk
X3Njc2lfY21kX2FsbG93X21lZGl1bV9yZW1vdmFsKENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVl
c3QgKnJlcSkKK3sKKyAgICB1aW50MzJfdCBwcmV2ZW50OworCisgICAgcmVxLT54ZmVyX2RpciA9
IFNDU0lfWEZFUl9GUk9NX0RFVjsKKworICAgIHByZXZlbnQgPSByZXEtPmNkYls0XSAmIDB4MDM7
CisgICAgZGV2LT5wcmV2ZW50X21lZGlhX3JlbW92YWwgPSAocHJldmVudCA9PSBDRF9NRURJVU1f
UkVNT1ZBTF9SRVFfUFJFVkVOVCB8fAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHByZXZlbnQgPT0gQ0RfTUVESVVNX1JFTU9WQUxfUkVRX1BSRVZFTlRfQ0hBTkdFUik7CisgICAg
cmVxLT5pbl9sZW4gPSAwOworCisgICAgU1BJQ0VfREVCVUcoImFsbG93X21lZGl1bV9yZW1vdmFs
LCBsdW46JXUgcHJldmVudCBmaWVsZDo6MHglMDJ4IGZsYWc6JWQiLAorICAgICAgICAgICAgICAg
IHJlcS0+bHVuLCBwcmV2ZW50LCBkZXYtPnByZXZlbnRfbWVkaWFfcmVtb3ZhbCk7CisKKyAgICBj
ZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworc3RhdGljIHZvaWQgY2Rf
c2NzaV9jbWRfcmVwb3J0X2tleShDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7
CisgICAgU1BJQ0VfREVCVUcoInJlcG9ydF9rZXkgLSBjb250ZW50IHByb3RlY3Rpb24gdW5zdXBw
b3J0ZWQsIGx1bjoldSIsIHJlcS0+bHVuKTsKKyAgICByZXEtPnhmZXJfZGlyID0gU0NTSV9YRkVS
X05PTkU7CisgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNl
bnNlX2NvZGVfSU5WQUxJRF9PUENPREUpOworfQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9z
ZW5kX2tleShDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgU1BJQ0Vf
REVCVUcoInNlbmRfa2V5IC0gY29udGVudCBwcm90ZWN0aW9uIHVuc3VwcG9ydGVkLCBsdW46JXUi
LCByZXEtPmx1bik7CisgICAgcmVxLT54ZmVyX2RpciA9IFNDU0lfWEZFUl9OT05FOworICAgIGNk
X3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX0lOVkFM
SURfT1BDT0RFKTsKK30KKworLyogYnl0ZSAxICovCisjZGVmaW5lIENEX1NUQVJUX1NUT1BfRkxB
R19JTU1FRCAgICAgICAgICAgICAgICAgICAgMHgwMQorCisvKiBieXRlIDQgKi8KKyNkZWZpbmUg
Q0RfU1RBUlRfU1RPUF9GTEFHX1NUQVJUICAgICAgICAgICAgICAgICAgICAweDAxCisjZGVmaW5l
IENEX1NUQVJUX1NUT1BfRkxBR19MT0VKICAgICAgICAgICAgICAgICAgICAgMHgwMgorCisvKiBQ
T1dFUiBDT05ESVRJT04gZmllbGQgdmFsdWVzICovCisjZGVmaW5lIENEX1NUQVJUX1NUT1BfUE9X
RVJfQ09ORF9TVEFSVF9WQUxJRCAgICAgICAgMHgwMAorI2RlZmluZSBDRF9TVEFSVF9TVE9QX1BP
V0VSX0NPTkRfQUNUSVZFICAgICAgICAgICAgIDB4MDEKKyNkZWZpbmUgQ0RfU1RBUlRfU1RPUF9Q
T1dFUl9DT05EX0lETEUgICAgICAgICAgICAgICAweDAyCisjZGVmaW5lIENEX1NUQVJUX1NUT1Bf
UE9XRVJfQ09ORF9TVEFOREJZICAgICAgICAgICAgMHgwMworI2RlZmluZSBDRF9TVEFSVF9TVE9Q
X1BPV0VSX0NPTkRfTFVfQ09OVFJPTCAgICAgICAgIDB4MDcKKyNkZWZpbmUgQ0RfU1RBUlRfU1RP
UF9QT1dFUl9DT05EX0ZPUkNFX0lETEVfMCAgICAgICAweDBhCisjZGVmaW5lIENEX1NUQVJUX1NU
T1BfUE9XRVJfQ09ORF9GT1JDRV9TVEFOREJZXzAgICAgMHgwYgorCitzdGF0aWMgaW5saW5lIGNv
bnN0IGNoYXIgKmNkX3Njc2lfc3RhcnRfc3RvcF9wb3dlcl9jb25kX25hbWUodWludDMyX3QgcG93
ZXJfY29uZCkKK3sKKyAgICBzd2l0Y2ggKHBvd2VyX2NvbmQpIHsKKyAgICBjYXNlIENEX1NUQVJU
X1NUT1BfUE9XRVJfQ09ORF9TVEFSVF9WQUxJRDoKKyAgICAgICAgcmV0dXJuICJTVEFSVF9WQUxJ
RCI7CisgICAgY2FzZSBDRF9TVEFSVF9TVE9QX1BPV0VSX0NPTkRfQUNUSVZFOgorICAgICAgICBy
ZXR1cm4gIkFDVElWRSI7CisgICAgY2FzZSBDRF9TVEFSVF9TVE9QX1BPV0VSX0NPTkRfSURMRToK
KyAgICAgICAgcmV0dXJuICJJRExFIjsKKyAgICBjYXNlIENEX1NUQVJUX1NUT1BfUE9XRVJfQ09O
RF9TVEFOREJZOgorICAgICAgICByZXR1cm4gIlNUQU5EQlkiOworICAgIGNhc2UgQ0RfU1RBUlRf
U1RPUF9QT1dFUl9DT05EX0xVX0NPTlRST0w6CisgICAgICAgIHJldHVybiAiTFVfQ09OVFJPTCI7
CisgICAgY2FzZSBDRF9TVEFSVF9TVE9QX1BPV0VSX0NPTkRfRk9SQ0VfSURMRV8wOgorICAgICAg
ICByZXR1cm4gIkZPUkNFX0lETEVfMCI7CisgICAgY2FzZSBDRF9TVEFSVF9TVE9QX1BPV0VSX0NP
TkRfRk9SQ0VfU1RBTkRCWV8wOgorICAgICAgICByZXR1cm4gIkZPUkNFX1NUQU5EQllfMCI7Cisg
ICAgZGVmYXVsdDoKKyAgICAgICAgcmV0dXJuICJSRVNFUlZFRCI7CisgICAgfQorfQorCitzdGF0
aWMgdm9pZCBjZF9zY3NpX2NtZF9zdGFydF9zdG9wX3VuaXQoQ2RTY3NpTFUgKmRldiwgQ2RTY3Np
UmVxdWVzdCAqcmVxKQoreworICAgIGdib29sZWFuIGltbWVkLCBzdGFydCwgbG9hZF9lamVjdDsK
KyAgICB1aW50MzJfdCBwb3dlcl9jb25kOworCisgICAgcmVxLT54ZmVyX2RpciA9IFNDU0lfWEZF
Ul9OT05FOworICAgIHJlcS0+aW5fbGVuID0gMDsKKworICAgIGltbWVkID0gKHJlcS0+Y2RiWzFd
ICYgQ0RfU1RBUlRfU1RPUF9GTEFHX0lNTUVEKSA/IFRSVUUgOiBGQUxTRTsKKyAgICBzdGFydCA9
IChyZXEtPmNkYls0XSAmIENEX1NUQVJUX1NUT1BfRkxBR19TVEFSVCkgPyBUUlVFIDogRkFMU0U7
CisgICAgbG9hZF9lamVjdCA9IChyZXEtPmNkYls0XSAmIENEX1NUQVJUX1NUT1BfRkxBR19MT0VK
KSA/IFRSVUUgOiBGQUxTRTsKKyAgICBwb3dlcl9jb25kID0gcmVxLT5jZGJbNF0gPj4gNDsKKwor
ICAgIFNQSUNFX0RFQlVHKCJzdGFydF9zdG9wX3VuaXQsIGx1bjoldSIKKyAgICAgICAgICAgICAg
ICAiIGltbWVkOiVkIHN0YXJ0OiVkIGxvYWRfZWplY3Q6JWQgcG93ZXJfY29uZDoweCV4KCVzKSIs
CisgICAgICAgICAgICAgICAgcmVxLT5sdW4sIGltbWVkLCBzdGFydCwgbG9hZF9lamVjdCwgcG93
ZXJfY29uZCwKKyAgICAgICAgICAgICAgICBjZF9zY3NpX3N0YXJ0X3N0b3BfcG93ZXJfY29uZF9u
YW1lKHBvd2VyX2NvbmQpKTsKKworICAgIHN3aXRjaCAocG93ZXJfY29uZCkgeworICAgIGNhc2Ug
Q0RfU1RBUlRfU1RPUF9QT1dFUl9DT05EX1NUQVJUX1ZBTElEOgorICAgICAgICBpZiAoIXN0YXJ0
KSB7IC8qIHN0b3AgdGhlIHVuaXQgKi8KKyAgICAgICAgICAgIGlmIChsb2FkX2VqZWN0KSB7IC8q
IGVqZWN0IG1lZGl1bSAqLworICAgICAgICAgICAgICAgIGlmIChkZXYtPnByZXZlbnRfbWVkaWFf
cmVtb3ZhbCkgeworICAgICAgICAgICAgICAgICAgICBTUElDRV9ERUJVRygic3RhcnRfc3RvcF91
bml0LCBsdW46JXUiCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIgcHJldmVudF9t
ZWRpYV9yZW1vdmFsIHNldCwgZWplY3QgZmFpbGVkIiwgcmVxLT5sdW4pOworICAgICAgICAgICAg
ICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2Vf
Y29kZV9NRURJVU1fUkVNT1ZBTF9QUkVWRU5URUQpOworICAgICAgICAgICAgICAgICAgICByZXR1
cm47CisgICAgICAgICAgICAgICAgfQorICAgICAgICAgICAgICAgIFNQSUNFX0RFQlVHKCJzdGFy
dF9zdG9wX3VuaXQsIGx1bjoldSBlamVjdCIsIHJlcS0+bHVuKTsKKyAgICAgICAgICAgICAgICBj
ZF9zY3NpX2x1X3VubG9hZChkZXYpOworICAgICAgICAgICAgICAgIGNkX3Njc2lfZGV2X2NoYW5n
ZWQoZGV2LT50Z3QtPnVzZXJfZGF0YSwgcmVxLT5sdW4pOworICAgICAgICAgICAgfQorICAgICAg
ICAgICAgZGV2LT5wb3dlcl9jb25kID0gQ0RfU0NTSV9QT1dFUl9TVE9QUEVEOworICAgICAgICAg
ICAgU1BJQ0VfREVCVUcoInN0YXJ0X3N0b3BfdW5pdCwgbHVuOiV1IHN0b3BwZWQiLCByZXEtPmx1
bik7CisgICAgICAgIH0gZWxzZSB7IC8qIHN0YXJ0IHRoZSB1bml0ICovCisgICAgICAgICAgICBk
ZXYtPnBvd2VyX2NvbmQgPSBDRF9TQ1NJX1BPV0VSX0FDVElWRTsKKyAgICAgICAgICAgIFNQSUNF
X0RFQlVHKCJzdGFydF9zdG9wX3VuaXQsIGx1bjoldSBzdGFydGVkIiwgcmVxLT5sdW4pOworCisg
ICAgICAgICAgICBpZiAobG9hZF9lamVjdCkgeyAvKiBsb2FkIG1lZGl1bSAqLworICAgICAgICAg
ICAgICAgIFNQSUNFX0RFQlVHKCJzdGFydF9zdG9wX3VuaXQsIGx1bjoldSBsb2FkIHdpdGggbm8g
bWVkaWEiLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuKTsKKyAgICAgICAg
ICAgICAgICBjZF9zY3NpX2x1X2xvYWQoZGV2LCBOVUxMKTsKKyAgICAgICAgICAgICAgICBjZF9z
Y3NpX2Rldl9jaGFuZ2VkKGRldi0+dGd0LT51c2VyX2RhdGEsIHJlcS0+bHVuKTsKKyAgICAgICAg
ICAgIH0KKyAgICAgICAgfQorICAgICAgICBicmVhazsKKyAgICBjYXNlIENEX1NUQVJUX1NUT1Bf
UE9XRVJfQ09ORF9BQ1RJVkU6CisgICAgICAgIC8qIG5vdCBlcnJvciB0byBzcGVjaWZ5IHRyYW5z
aXRpb24gdG8gdGhlIGN1cnJlbnQgcG93ZXIgY29uZGl0aW9uICovCisgICAgICAgIGRldi0+cG93
ZXJfY29uZCA9IENEX1NDU0lfUE9XRVJfQUNUSVZFOworICAgICAgICBTUElDRV9ERUJVRygic3Rh
cnRfc3RvcF91bml0LCBsdW46JXUgYWN0aXZlIiwgcmVxLT5sdW4pOworICAgICAgICBicmVhazsK
KyAgICBjYXNlIENEX1NUQVJUX1NUT1BfUE9XRVJfQ09ORF9JRExFOgorICAgIGNhc2UgQ0RfU1RB
UlRfU1RPUF9QT1dFUl9DT05EX0ZPUkNFX0lETEVfMDoKKyAgICAgICAgZGV2LT5wb3dlcl9jb25k
ID0gQ0RfU0NTSV9QT1dFUl9JRExFOworICAgICAgICBTUElDRV9ERUJVRygic3RhcnRfc3RvcF91
bml0LCBsdW46JXUgaWRsZSIsIHJlcS0+bHVuKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBD
RF9TVEFSVF9TVE9QX1BPV0VSX0NPTkRfU1RBTkRCWToKKyAgICBjYXNlIENEX1NUQVJUX1NUT1Bf
UE9XRVJfQ09ORF9GT1JDRV9TVEFOREJZXzA6CisgICAgICAgIGRldi0+cG93ZXJfY29uZCA9IENE
X1NDU0lfUE9XRVJfU1RBTkRCWTsKKyAgICAgICAgU1BJQ0VfREVCVUcoInN0YXJ0X3N0b3BfdW5p
dCwgbHVuOiV1IHN0YW5kYnkiLCByZXEtPmx1bik7CisgICAgICAgIGJyZWFrOworICAgIGNhc2Ug
Q0RfU1RBUlRfU1RPUF9QT1dFUl9DT05EX0xVX0NPTlRST0w6CisgICAgICAgIGJyZWFrOworICAg
IGRlZmF1bHQ6CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCBy
ZXEsICZzZW5zZV9jb2RlX0lOVkFMSURfQ0RCX0ZJRUxEKTsKKyAgICAgICAgcmV0dXJuOworICAg
IH0KKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworI2RlZmlu
ZSBDRF9QRVJGX1RZUEVfUEVSRk9STUFOQ0UgICAgICAgICAgICAgICAgMHgwMAorI2RlZmluZSBD
RF9QRVJGX1RZUEVfVU5VU0FCTEVfQVJFQSAgICAgICAgICAgICAgMHgwMQorI2RlZmluZSBDRF9Q
RVJGX1RZUEVfREVGRUNUX1NUQVRVUyAgICAgICAgICAgICAgMHgwMgorI2RlZmluZSBDRF9QRVJG
X1RZUEVfV1JJVEVfU1BFRUQgICAgICAgICAgICAgICAgMHgwMworCisjZGVmaW5lIENEX1BFUkZf
SEVBREVSX0xFTiAgICAgICAgICAgICAgICAgICAgICA4CisKKyNkZWZpbmUgQ0RfUEVSRl9UWVBF
X1BFUkZPUk1BTkNFX0RFU0NSX0xFTiAgICAgIDE2CisKKyNkZWZpbmUgQ0RfUEVSRl9UWVBFX1BF
UkZPUk1BTkNFX1JFUE9SVF9OT01JTkFMIDB4MDAKKyNkZWZpbmUgQ0RfUEVSRl9UWVBFX1BFUkZP
Uk1BTkNFX1JFUE9SVF9BTEwgICAgIDB4MDEKKyNkZWZpbmUgQ0RfUEVSRl9UWVBFX1BFUkZPUk1B
TkNFX1JFUE9SVF9FWENFUFQgIDB4MTAKKworCitzdGF0aWMgdm9pZCBjZF9zY3NpX2dldF9wZXJm
b3JtYW5jZV9yZXNwX2VtcHR5KENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSwKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyX3QgdHlw
ZSwgdWludDMyX3QgZGF0YV90eXBlLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB1aW50MzJfdCBtYXhfbnVtX2Rlc2NyKQoreworICAgIHVpbnQ4X3QgKm91
dGJ1ZiA9IHJlcS0+YnVmOworICAgIHVpbnQzMl90IHdyaXRlID0gKGRhdGFfdHlwZSA+PiAyKSAm
IDB4MDE7CisKKyAgICBtZW1zZXQob3V0YnVmLCAwLCBDRF9QRVJGX0hFQURFUl9MRU4pOworICAg
IGlmICh3cml0ZSkgeworICAgICAgICBvdXRidWZbNF0gPSAweDAyOworICAgIH0KKyAgICByZXEt
PmluX2xlbiA9IENEX1BFUkZfSEVBREVSX0xFTjsKKworICAgIFNQSUNFX0RFQlVHKCJnZXRfcGVy
Zm9ybWFuY2UsIGx1bjoldSIKKyAgICAgICAgICAgICAgICAiIHR5cGU6MHgleCBkYXRhX3R5cGU6
MHgleCAtIHNlbmRpbmcgZW1wdHkgcmVzcG9uc2UiLAorICAgICAgICAgICAgICAgIHJlcS0+bHVu
LCB0eXBlLCBkYXRhX3R5cGUpOworCisgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfZ29vZChkZXYs
IHJlcSk7Cit9CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfZ2V0X3BlcmZvcm1hbmNlX3Jlc3BfcGVy
Zm9ybWFuY2UoQ2RTY3NpTFUgKmRldiwgQ2RTY3NpUmVxdWVzdCAqcmVxLAorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCBzdGFydF9s
YmEsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHVpbnQzMl90IGRhdGFfdHlwZSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgdWludDMyX3QgbWF4X251bV9kZXNjcikKK3sKKyAgICB1aW50OF90
ICpvdXRidWYgPSByZXEtPmJ1ZiwgKnBlcmZfZGVzYzsKKyAgICB1aW50MzJfdCByZXNwX2xlbiA9
IENEX1BFUkZfSEVBREVSX0xFTiArCisgICAgICAgICAgICAgICAgICAgICAgICBDRF9QRVJGX1RZ
UEVfUEVSRk9STUFOQ0VfREVTQ1JfTEVOOworICAgIHVpbnQzMl90IHBlcmZfZGF0YV9sZW4gPSBy
ZXNwX2xlbiAtIDQ7IC8qIG5vdCBpbmNsLiBQZXJmIERhdGEgTGVuZ3RoICovCisgICAgdWludDMy
X3QgcGVyZl9rYiA9IDEwMDAwOworICAgIHVpbnQzMl90IGVuZF9sYmEgPSBkZXYtPm51bV9ibG9j
a3MgLSAxOworICAgIHVpbnQzMl90IGV4Y2VwdCwgd3JpdGUsIHRvbGVyYW5jZTsKKworICAgIGV4
Y2VwdCA9IGRhdGFfdHlwZSAmIDB4MDM7CisgICAgaWYgKGV4Y2VwdCAhPSBDRF9QRVJGX1RZUEVf
UEVSRk9STUFOQ0VfUkVQT1JUX0FMTCkgeworICAgICAgICBzdGFydF9sYmEgPSAwOworICAgIH0K
KyAgICB3cml0ZSA9IChkYXRhX3R5cGUgPj4gMikgJiAweDAxOworICAgIHRvbGVyYW5jZSA9IChk
YXRhX3R5cGUgPj4gMykgJiAweDAzOworCisgICAgU1BJQ0VfREVCVUcoImdldF9wZXJmb3JtYW5j
ZSwgbHVuOiV1IgorICAgICAgICAgICAgICAgICIgcGVyZm9ybWFuY2UgdHlwZToweDAwIGRhdGFf
dHlwZToweCV4IgorICAgICAgICAgICAgICAgICIgZXhjZXB0OjB4JXggd3JpdGU6MHgleCB0b2xl
cmFuY2U6MHgleCIKKyAgICAgICAgICAgICAgICAiIG1heF9udW06JXUiLAorICAgICAgICAgICAg
ICAgIHJlcS0+bHVuLCBkYXRhX3R5cGUsIGV4Y2VwdCwgd3JpdGUsCisgICAgICAgICAgICAgICAg
dG9sZXJhbmNlLCBtYXhfbnVtX2Rlc2NyKTsKKworICAgIGlmICh3cml0ZSkgeworICAgICAgICBT
UElDRV9ERUJVRygiZ2V0X3BlcmZvcm1hbmNlLCBsdW46JXUiCisgICAgICAgICAgICAgICAgICAg
ICIgcGVyZm9ybWFuY2UgdHlwZToweDAwIGRhdGFfdHlwZToweCV4IC0gd3JpdGUgdW5zdXBwb3J0
ZWQiLAorICAgICAgICAgICAgICAgICAgICByZXEtPmx1biwgZGF0YV90eXBlKTsKKyAgICAgICAg
Y2Rfc2NzaV9nZXRfcGVyZm9ybWFuY2VfcmVzcF9lbXB0eShkZXYsIHJlcSwgQ0RfUEVSRl9UWVBF
X1BFUkZPUk1BTkNFLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGRhdGFfdHlwZSwgbWF4X251bV9kZXNjcik7CisgICAgICAgIHJldHVybjsKKyAgICB9CisKKyAg
ICBtZW1zZXQob3V0YnVmLCAwLCByZXNwX2xlbik7CisKKyAgICBvdXRidWZbMF0gPSAocGVyZl9k
YXRhX2xlbiA+PiAyNCkgJiAweGZmOworICAgIG91dGJ1ZlsxXSA9IChwZXJmX2RhdGFfbGVuID4+
IDE2KSAmIDB4ZmY7CisgICAgb3V0YnVmWzJdID0gKHBlcmZfZGF0YV9sZW4gPj4gOCkgJiAweGZm
OworICAgIG91dGJ1ZlszXSA9IHBlcmZfZGF0YV9sZW4gJiAweGZmOworCisgICAgcGVyZl9kZXNj
ID0gb3V0YnVmICsgQ0RfUEVSRl9IRUFERVJfTEVOOworCisgICAgcGVyZl9kZXNjWzBdID0gKHN0
YXJ0X2xiYSA+PiAyNCkgJiAweGZmOworICAgIHBlcmZfZGVzY1sxXSA9IChzdGFydF9sYmEgPj4g
MTYpICYgMHhmZjsKKyAgICBwZXJmX2Rlc2NbMl0gPSAoc3RhcnRfbGJhID4+IDgpICYgMHhmZjsK
KyAgICBwZXJmX2Rlc2NbM10gPSBzdGFydF9sYmEgJiAweGZmOworCisgICAgcGVyZl9kZXNjWzRd
ID0gKHBlcmZfa2IgPj4gMjQpICYgMHhmZjsKKyAgICBwZXJmX2Rlc2NbNV0gPSAocGVyZl9rYiA+
PiAxNikgJiAweGZmOworICAgIHBlcmZfZGVzY1s2XSA9IChwZXJmX2tiID4+IDgpICYgMHhmZjsK
KyAgICBwZXJmX2Rlc2NbN10gPSBwZXJmX2tiICYgMHhmZjsKKworICAgIHBlcmZfZGVzY1s4XSA9
IChlbmRfbGJhID4+IDI0KSAmIDB4ZmY7CisgICAgcGVyZl9kZXNjWzldID0gKGVuZF9sYmEgPj4g
MTYpICYgMHhmZjsKKyAgICBwZXJmX2Rlc2NbMTBdID0gKGVuZF9sYmEgPj4gOCkgJiAweGZmOwor
ICAgIHBlcmZfZGVzY1sxMV0gPSBlbmRfbGJhICYgMHhmZjsKKworICAgIHBlcmZfZGVzY1sxMl0g
PSAocGVyZl9rYiA+PiAyNCkgJiAweGZmOworICAgIHBlcmZfZGVzY1sxM10gPSAocGVyZl9rYiA+
PiAxNikgJiAweGZmOworICAgIHBlcmZfZGVzY1sxNF0gPSAocGVyZl9rYiA+PiA4KSAmIDB4ZmY7
CisgICAgcGVyZl9kZXNjWzE1XSA9IHBlcmZfa2IgJiAweGZmOworCisgICAgcmVxLT5yZXFfbGVu
ID0gQ0RfUEVSRl9IRUFERVJfTEVOICsKKyAgICAgICAgICAgICAgICAgICAobWF4X251bV9kZXNj
ciAqIENEX1BFUkZfVFlQRV9QRVJGT1JNQU5DRV9ERVNDUl9MRU4pOworCisgICAgcmVxLT5pbl9s
ZW4gPSBNSU4ocmVxLT5yZXFfbGVuLCByZXNwX2xlbik7CisKKyAgICBjZF9zY3NpX2NtZF9jb21w
bGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRfZ2V0X3Bl
cmZvcm1hbmNlKENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICB1aW50
MzJfdCBkYXRhX3R5cGUsIG1heF9udW1fZGVzY3IsIHN0YXJ0X2xiYSwgdHlwZTsKKworICAgIHJl
cS0+eGZlcl9kaXIgPSBTQ1NJX1hGRVJfRlJPTV9ERVY7CisKKyAgICBkYXRhX3R5cGUgPSByZXEt
PmNkYlsxXSAmIDB4MGY7CisgICAgc3RhcnRfbGJhID0gKHJlcS0+Y2RiWzJdIDw8IDI0KSB8Cisg
ICAgICAgICAgICAgICAgKHJlcS0+Y2RiWzNdIDw8IDE2KSB8CisgICAgICAgICAgICAgICAgKHJl
cS0+Y2RiWzRdIDw8IDgpIHwKKyAgICAgICAgICAgICAgICAgcmVxLT5jZGJbNV07CisgICAgbWF4
X251bV9kZXNjciA9IChyZXEtPmNkYls4XSA8PCA4KSB8IHJlcS0+Y2RiWzldOworICAgIHR5cGUg
PSByZXEtPmNkYlsxMF07CisKKyAgICBzd2l0Y2ggKHR5cGUpIHsKKyAgICBjYXNlIENEX1BFUkZf
VFlQRV9QRVJGT1JNQU5DRToKKyAgICAgICAgY2Rfc2NzaV9nZXRfcGVyZm9ybWFuY2VfcmVzcF9w
ZXJmb3JtYW5jZShkZXYsIHJlcSwgc3RhcnRfbGJhLAorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFfdHlwZSwgbWF4X251bV9kZXNjcik7CisgICAg
ICAgIGJyZWFrOworICAgIGNhc2UgQ0RfUEVSRl9UWVBFX1VOVVNBQkxFX0FSRUE6IC8qIG5vdCB3
cml0YWJsZSAqLworICAgIGNhc2UgQ0RfUEVSRl9UWVBFX0RFRkVDVF9TVEFUVVM6IC8qIG5vdCBy
ZXN0cmljdGVkIG92ZXJ3cml0ZSBtZWRpYSAqLworICAgIGNhc2UgQ0RfUEVSRl9UWVBFX1dSSVRF
X1NQRUVEOiAvKiB1bnN1cHBvcnRlZCwgaXJyZWxldmFudCAqLworICAgIGRlZmF1bHQ6CisgICAg
ICAgIFNQSUNFX0RFQlVHKCJnZXRfcGVyZm9ybWFuY2UsIGx1bjoldSIKKyAgICAgICAgICAgICAg
ICAgICAgIiB1bnN1cHBvcnRlZCB0eXBlOjB4JXgiCisgICAgICAgICAgICAgICAgICAgICIgZGF0
YV90eXBlOjB4JXggbWF4X251bToldSIsCisgICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuLCB0
eXBlLCBkYXRhX3R5cGUsIG1heF9udW1fZGVzY3IpOworICAgICAgICBjZF9zY3NpX2NtZF9jb21w
bGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZBTElEX0NEQl9GSUVMRCk7
CisgICAgICAgIHJldHVybjsKKyAgICB9Cit9CisKKyNkZWZpbmUgQ0RfTUVDSEFOSVNNX1NUQVRV
U19IRFJfTEVOICAgICA4CisKKy8qIGJ5dGUgMCAqLworI2RlZmluZSBDRF9DSEFOR0VSX0ZBVUxU
X0ZMQUcgICAgICAgICAgIDB4ODAKKworI2RlZmluZSBDRF9DSEFOR0VSX1JFQURZICAgICAgICAg
ICAgICAgIDB4MDAKKyNkZWZpbmUgQ0RfQ0hBTkdFUl9MT0FESU5HICAgICAgICAgICAgICAweDAx
CisjZGVmaW5lIENEX0NIQU5HRVJfVU5MT0FESU5HICAgICAgICAgICAgMHgwMgorI2RlZmluZSBD
RF9DSEFOR0VSX0lOSVRJQUxJWklORyAgICAgICAgIDB4MDMKKworLyogYnl0ZSAxICovCisjZGVm
aW5lIENEX0NIQU5HRVJfRE9PUl9PUEVOX0ZMQUcgICAgICAgMHgxMAorCisjZGVmaW5lIENEX01F
Q0hBTklTTV9TVEFURV9JRExFICAgICAgICAgMHgwMAorI2RlZmluZSBDRF9NRUNIQU5JU01fU1RB
VEVfUExBWUlORyAgICAgIDB4MDEKKyNkZWZpbmUgQ0RfTUVDSEFOSVNNX1NUQVRFX1NDQU5OSU5H
ICAgICAweDAyCisvKiBBQ1RJVkU6IHdpdGggSW5pdGlhdG9yLCBDb21wb3NpdGUgb3IgT3RoZXIg
cG9ydHMKKyAgKGkuZS4gUkVBRCwgUExBWSBDRCwgU0NBTiBkdXJpbmcgUExBWSBDRCkgKi8KKyNk
ZWZpbmUgQ0RfTUVDSEFOSVNNX1NUQVRFX0FDVElWRSAgICAgICAweDAzCisjZGVmaW5lIENEX01F
Q0hBTklTTV9TVEFURV9OT19JTkZPICAgICAgMHgwNworCisvKiBzbG90cyAqLworI2RlZmluZSBD
RF9NRUNIQU5JU01fU1RBVFVTX1NMT1RfTEVOICAgIDQKKworI2RlZmluZSBDRF9NRUNIQU5JU01f
U0xPVF9ESVNLX0NIQU5HRUQgIDB4MDEKKyNkZWZpbmUgQ0RfTUVDSEFOSVNNX1NMT1RfRElTS19Q
UkVTRU5UICAweDgwCisjZGVmaW5lIENEX01FQ0hBTklTTV9TTE9UX0RJU0tfQ1dQX1YgICAgMHgw
MgorI2RlZmluZSBDRF9NRUNIQU5JU01fU0xPVF9ESVNLX0NXUCAgICAgIDB4MDEKKworc3RhdGlj
IHZvaWQgY2Rfc2NzaV9jbWRfbWVjaGFuaXNtX3N0YXR1cyhDZFNjc2lMVSAqZGV2LCBDZFNjc2lS
ZXF1ZXN0ICpyZXEpCit7CisgICAgdWludDhfdCAqb3V0YnVmID0gcmVxLT5idWY7CisgICAgdWlu
dDMyX3QgcmVzcF9sZW4gPSBDRF9NRUNIQU5JU01fU1RBVFVTX0hEUl9MRU47CisKKyAgICByZXEt
PnhmZXJfZGlyID0gU0NTSV9YRkVSX0ZST01fREVWOworCisgICAgcmVxLT5yZXFfbGVuID0gKHJl
cS0+Y2RiWzhdIDw8IDgpIHwgcmVxLT5jZGJbOV07CisgICAgbWVtc2V0KG91dGJ1ZiwgMCwgcmVx
LT5yZXFfbGVuKTsKKworICAgIC8qIEZvciBub24tY2hhbmdlciBkZXZpY2VzIHRoZSBjdXJlbnQg
c2xvdCBudW1iZXIgZmllbGQgaXMgcmVzZXJ2ZWQsIHNldCBvbmx5IHN0YXR1cyAqLworICAgIG91
dGJ1ZlswXSB8PSAoQ0RfQ0hBTkdFUl9SRUFEWSA8PCA1KTsKKworICAgIG91dGJ1ZlsxXSB8PSAo
IWRldi0+bG9hZGVkKSA/IENEX0NIQU5HRVJfRE9PUl9PUEVOX0ZMQUcgOiAwOworICAgIG91dGJ1
ZlsxXSB8PSAoZGV2LT5wb3dlcl9jb25kID09IENEX1BPV0VSX1NUQVRVU19BQ1RJVkUpID8KKyAg
ICAgICAgICAgICAgICAgKENEX01FQ0hBTklTTV9TVEFURV9BQ1RJVkUgPDwgNSkgOiAoQ0RfTUVD
SEFOSVNNX1NUQVRFX0lETEUgPDwgNSk7CisKKyAgICAvKiBGb3Igbm9uLWNoYW5nZXIgZGV2aWNl
cyB0aGUgbnVtYmVyIG9mIHNsb3QgdGFibGVzIHJldHVybmVkIHNoYWxsIGJlIHplcm8sIHNvIHdl
IGxlYXZlCisgICAgICAgYm90aCAnTnVtYmVyIG9mIFNsb3RzIEF2YWlsYWJsZScgYW5kICdMZW5n
dGggb2YgU2xvdCBUYWJsZScgZmllbGRzIGFzIHplcm9zICovCisKKyAgICByZXEtPmluX2xlbiA9
IE1JTihyZXEtPnJlcV9sZW4sIHJlc3BfbGVuKTsKKworICAgIFNQSUNFX0RFQlVHKCJtZWNoYW5p
c21fc3RhdHVzLCBsdW46JXUiLCByZXEtPmx1bik7CisKKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0
ZV9nb29kKGRldiwgcmVxKTsKK30KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9yZWFkX2FzeW5jX2Nv
bXBsZXRlKEdPYmplY3QgKnNyY19vYmplY3QsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgR0FzeW5jUmVzdWx0ICpyZXN1bHQsCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgZ3BvaW50ZXIgdXNlcl9kYXRhKQoreworICAgIEdGaWxlSW5wdXRT
dHJlYW0gKnN0cmVhbSA9IEdfRklMRV9JTlBVVF9TVFJFQU0oc3JjX29iamVjdCk7CisgICAgQ2RT
Y3NpUmVxdWVzdCAqcmVxID0gKENkU2NzaVJlcXVlc3QgKil1c2VyX2RhdGE7CisgICAgQ2RTY3Np
VGFyZ2V0ICpzdCA9IChDZFNjc2lUYXJnZXQgKilyZXEtPnByaXZfZGF0YTsKKyAgICBDZFNjc2lM
VSAqZGV2ID0gJnN0LT51bml0c1tyZXEtPmx1bl07CisgICAgR0Vycm9yICplcnJvciA9IE5VTEw7
CisgICAgZ3NpemUgYnl0ZXNfcmVhZDsKKyAgICBnYm9vbGVhbiBmaW5pc2hlZDsKKworICAgIHJl
cS0+cmVxX3N0YXRlID0gU0NTSV9SRVFfQ09NUExFVEU7CisgICAgcmVxLT5jYW5jZWxfaWQgPSAw
OworCisvLyAgICBnX2Fzc2VydChzdHJlYW0gPT0gZGV2LT5zdHJlYW0pOworICAgIGlmIChzdHJl
YW0gIT0gZGV2LT5zdHJlYW0pIHsKKyAgICAgICAgdWludDMyX3Qgb3Bjb2RlID0gKHVpbnQzMl90
KXJlcS0+Y2RiWzBdOworICAgICAgICBTUElDRV9ERUJVRygicmVhZF9hc3luY19jb21wbGV0ZSBC
QUQgU1RSRUFNLCBsdW46ICV1IgorICAgICAgICAgICAgICAgICAgICAiIHJlcTogJSIgR19HVUlO
VDY0X0ZPUk1BVCAiIG9wOiAweCUwMngiLAorICAgICAgICAgICAgICAgICAgICByZXEtPmx1biwg
cmVxLT5yZXFfbGVuLCBvcGNvZGUpOworICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVj
a19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9UQVJHRVRfRkFJTFVSRSk7CisgICAgICAgIGNk
X3Njc2lfZGV2X3JlcXVlc3RfY29tcGxldGUoc3QtPnVzZXJfZGF0YSwgcmVxKTsKKyAgICAgICAg
cmV0dXJuOworICAgIH0KKworICAgIGJ5dGVzX3JlYWQgPSBnX2lucHV0X3N0cmVhbV9yZWFkX2Zp
bmlzaChHX0lOUFVUX1NUUkVBTShzdHJlYW0pLCByZXN1bHQsICZlcnJvcik7CisgICAgZmluaXNo
ZWQgPSBieXRlc19yZWFkID4gMDsKKyAgICBpZiAoZmluaXNoZWQpIHsKKyAgICAgICAgU1BJQ0Vf
REVCVUcoInJlYWRfYXN5bmNfY29tcGxldGUsIGx1bjogJXUiCisgICAgICAgICAgICAgICAgICAg
ICIgZmluaXNoZWQ6ICVkIGJ5dGVzX3JlYWQ6ICUiIEdfR1VJTlQ2NF9GT1JNQVQKKyAgICAgICAg
ICAgICAgICAgICAgIiByZXE6ICUiICBHX0dVSU5UNjRfRk9STUFULAorICAgICAgICAgICAgICAg
ICAgICByZXEtPmx1biwgZmluaXNoZWQsICh1aW50NjRfdClieXRlc19yZWFkLCByZXEtPnJlcV9s
ZW4pOworCisgICAgICAgIHJlcS0+aW5fbGVuID0gTUlOKGJ5dGVzX3JlYWQsIHJlcS0+cmVxX2xl
bik7CisgICAgICAgIHJlcS0+c3RhdHVzID0gR09PRDsKKyAgICB9IGVsc2UgeworICAgICAgICBp
ZiAoZXJyb3IgIT0gTlVMTCkgeworICAgICAgICAgICAgU1BJQ0VfRVJST1IoImdfaW5wdXRfc3Ry
ZWFtX3JlYWRfZmluaXNoIGZhaWxlZDogJXMiLCBlcnJvci0+bWVzc2FnZSk7CisgICAgICAgICAg
ICBnX2NsZWFyX2Vycm9yICgmZXJyb3IpOworICAgICAgICB9IGVsc2UgeworICAgICAgICAgICAg
U1BJQ0VfRVJST1IoImdfaW5wdXRfc3RyZWFtX3JlYWRfZmluaXNoIGZhaWxlZCAobm8gZXJyIHBy
b3ZpZGVkKSIpOworICAgICAgICB9CisgICAgICAgIHJlcS0+aW5fbGVuID0gMDsKKyAgICAgICAg
cmVxLT5zdGF0dXMgPSBHT09EOworICAgIH0KKyAgICBjZF9zY3NpX2Rldl9yZXF1ZXN0X2NvbXBs
ZXRlKHN0LT51c2VyX2RhdGEsIHJlcSk7Cit9CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfcmVhZF9h
c3luY19jYW5jZWxlZChHQ2FuY2VsbGFibGUgKmNhbmNlbGxhYmxlLCBncG9pbnRlciB1c2VyX2Rh
dGEpCit7CisgICAgQ2RTY3NpUmVxdWVzdCAqcmVxID0gKENkU2NzaVJlcXVlc3QgKil1c2VyX2Rh
dGE7CisgICAgQ2RTY3NpVGFyZ2V0ICpzdCA9IChDZFNjc2lUYXJnZXQgKilyZXEtPnByaXZfZGF0
YTsKKworICAgIGdfYXNzZXJ0KGNhbmNlbGxhYmxlID09IHN0LT5jYW5jZWxsYWJsZSk7CisgICAg
Z19jYW5jZWxsYWJsZV9kaXNjb25uZWN0KGNhbmNlbGxhYmxlLCByZXEtPmNhbmNlbF9pZCk7Cisg
ICAgcmVxLT5jYW5jZWxfaWQgPSAwOworCisgICAgcmVxLT5yZXFfc3RhdGUgPQorICAgICAgICAo
c3QtPnN0YXRlID09IENEX1NDU0lfVEdUX1NUQVRFX1JVTk5JTkcpID8gU0NTSV9SRVFfQ0FOQ0VM
RUQgOiBTQ1NJX1JFUV9ESVNQT1NFRDsKKyAgICByZXEtPmluX2xlbiA9IDA7CisgICAgcmVxLT5z
dGF0dXMgPSBHT09EOworCisgICAgY2Rfc2NzaV9kZXZfcmVxdWVzdF9jb21wbGV0ZShzdC0+dXNl
cl9kYXRhLCByZXEpOworfQorCitzdGF0aWMgaW50IGNkX3Njc2lfcmVhZF9hc3luY19zdGFydChD
ZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgQ2RTY3NpVGFyZ2V0ICpz
dCA9IGRldi0+dGd0OworICAgIEdGaWxlSW5wdXRTdHJlYW0gKnN0cmVhbSA9IGRldi0+c3RyZWFt
OworCisgICAgU1BJQ0VfREVCVUcoInJlYWRfYXN5bmNfc3RhcnQsIGx1bjoldSIKKyAgICAgICAg
ICAgICAgICAiIGxiYTogJSIgR19HVUlOVDY0X0ZPUk1BVCAiIG9mZnNldDogJSIgR19HVUlOVDY0
X0ZPUk1BVAorICAgICAgICAgICAgICAgICIgY250OiAlIiBHX0dVSU5UNjRfRk9STUFUICIgbGVu
OiAlIiBHX0dVSU5UNjRfRk9STUFULAorICAgICAgICAgICAgICAgIHJlcS0+bHVuLCByZXEtPmxi
YSwgcmVxLT5vZmZzZXQsIHJlcS0+Y291bnQsIHJlcS0+cmVxX2xlbik7CisKKyAgICByZXEtPmNh
bmNlbF9pZCA9IGdfY2FuY2VsbGFibGVfY29ubmVjdChzdC0+Y2FuY2VsbGFibGUsCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgR19DQUxMQkFDSyhjZF9zY3NpX3Jl
YWRfYXN5bmNfY2FuY2VsZWQpLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHJlcSwgLyogZGF0YSAqLworICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIE5VTEwpOyAvKiBkYXRhIGRlc3Ryb3kgY2IgKi8KKyAgICBpZiAocmVxLT5jYW5j
ZWxfaWQgPT0gMCkgeworICAgICAgICAvKiBhbHJlYWR5IGNhbmNlbGVkICovCisgICAgICAgIHJl
dHVybiAtMTsKKyAgICB9CisKKyAgICBnX3NlZWthYmxlX3NlZWsoR19TRUVLQUJMRShzdHJlYW0p
LAorICAgICAgICAgICAgICAgICAgICByZXEtPm9mZnNldCwKKyAgICAgICAgICAgICAgICAgICAg
R19TRUVLX1NFVCwKKyAgICAgICAgICAgICAgICAgICAgTlVMTCwgLyogY2FuY2VsbGFibGUgKi8K
KyAgICAgICAgICAgICAgICAgICAgTlVMTCk7IC8qIGVycm9yICovCisKKyAgICBnX2lucHV0X3N0
cmVhbV9yZWFkX2FzeW5jKEdfSU5QVVRfU1RSRUFNKHN0cmVhbSksCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICByZXEtPmJ1ZiwgLyogYnVmZmVyIHRvIGZpbGwgKi8KKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHJlcS0+cmVxX2xlbiwKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIEdfUFJJT1JJVFlfREVGQVVMVCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHN0LT5jYW5jZWxsYWJsZSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNkX3Njc2lf
cmVhZF9hc3luY19jb21wbGV0ZSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChncG9p
bnRlcilyZXEpOyAvKiBjYWxsYmFjayBhcmd1bWVudCAqLworICAgIHJldHVybiAwOworfQorCitz
dGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9yZWFkKENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3Qg
KnJlcSkKK3sKKyAgICBpZiAoZGV2LT5wb3dlcl9jb25kID09IENEX1NDU0lfUE9XRVJfU1RPUFBF
RCkgeworICAgICAgICBTUElDRV9ERUJVRygicmVhZCwgbHVuOiAldSBpcyBzdG9wcGVkIiwgcmVx
LT5sdW4pOworICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVx
LCAmc2Vuc2VfY29kZV9JTklUX0NNRF9SRVFVSVJFRCk7CisgICAgICAgIHJldHVybjsKKyAgICB9
IGVsc2UgaWYgKCFkZXYtPmxvYWRlZCB8fCBkZXYtPnN0cmVhbSA9PSBOVUxMKSB7CisgICAgICAg
IFNQSUNFX0RFQlVHKCJyZWFkLCBsdW46ICV1IGlzIG5vdCBsb2FkZWQiLCByZXEtPmx1bik7Cisg
ICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9j
b2RlX05PVF9SRUFEWV9OT19NRURJVU0pOworICAgICAgICByZXR1cm47CisgICAgfQorCisgICAg
cmVxLT5jZGJfbGVuID0gc2NzaV9jZGJfbGVuZ3RoKHJlcS0+Y2RiKTsKKworICAgIHJlcS0+bGJh
ID0gc2NzaV9jZGJfbGJhKHJlcS0+Y2RiLCByZXEtPmNkYl9sZW4pOworICAgIHJlcS0+b2Zmc2V0
ID0gcmVxLT5sYmEgKiBkZXYtPmJsb2NrX3NpemU7CisKKyAgICByZXEtPmNvdW50ID0gc2NzaV9j
ZGJfeGZlcl9sZW5ndGgocmVxLT5jZGIsIHJlcS0+Y2RiX2xlbik7IC8qIHhmZXIgaW4gYmxvY2tz
ICovCisgICAgcmVxLT5yZXFfbGVuID0gKHVpbnQ2NF90KSByZXEtPmNvdW50ICogZGV2LT5ibG9j
a19zaXplOworCisgICAgY2Rfc2NzaV9yZWFkX2FzeW5jX3N0YXJ0KGRldiwgcmVxKTsKK30KKwor
dm9pZCBjZF9zY3NpX2Rldl9yZXF1ZXN0X3N1Ym1pdChDZFNjc2lUYXJnZXQgKnN0LCBDZFNjc2lS
ZXF1ZXN0ICpyZXEpCit7CisgICAgdWludDMyX3QgbHVuID0gcmVxLT5sdW47CisgICAgdWludDMy
X3Qgb3Bjb2RlID0gKHVpbnQzMl90KXJlcS0+Y2RiWzBdOworICAgIGNvbnN0IGNoYXIgKmNtZF9u
YW1lID0gc2NzaV9jbWRfbmFtZVtvcGNvZGVdOworICAgIENkU2NzaUxVICpkZXYgPSAmc3QtPnVu
aXRzW2x1bl07CisKKyAgICBTUElDRV9ERUJVRygicmVxdWVzdF9zdWJtaXQsIGx1bjogJXUgb3A6
IDB4JTAyeCAlcyIsIGx1biwgb3Bjb2RlLCBjbWRfbmFtZSk7CisKKyAgICBpZiAoc3QtPmN1cl9y
ZXEgIT0gTlVMTCkgeworICAgICAgICBTUElDRV9FUlJPUigicmVxdWVzdF9zdWJtaXQsIHJlcXVl
c3Qgbm90IGlkbGUiKTsKKyAgICAgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChk
ZXYsIHJlcSwgJnNlbnNlX2NvZGVfVEFSR0VUX0ZBSUxVUkUpOworICAgICAgICBnb3RvIGRvbmU7
CisgICAgfQorICAgIGlmIChyZXEtPnJlcV9zdGF0ZSAhPSBTQ1NJX1JFUV9JRExFKSB7CisgICAg
ICAgIFNQSUNFX0VSUk9SKCJyZXF1ZXN0X3N1Ym1pdCwgcHJldiByZXF1ZXN0IG91dHN0YW5kaW5n
Iik7CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZz
ZW5zZV9jb2RlX1RBUkdFVF9GQUlMVVJFKTsKKyAgICAgICAgZ290byBkb25lOworICAgIH0KKyAg
ICByZXEtPnJlcV9zdGF0ZSA9IFNDU0lfUkVRX1JVTk5JTkc7CisgICAgc3QtPmN1cl9yZXEgPSBy
ZXE7CisKKyAgICAvKiBJTlFVSVJZIHNob3VsZCBzZW5kIHJlc3BvbnNlIGV2ZW4gZm9yIG5vbi1l
eGlzdGluZyBMVU5zICovCisgICAgaWYgKCFjZF9zY3NpX3RhcmdldF9sdW5fbGVnYWwoc3QsIGx1
bikpIHsKKyAgICAgICAgU1BJQ0VfRVJST1IoInJlcXVlc3Rfc3VibWl0LCBpbGxlZ2FsIGx1bjol
dSIsIGx1bik7CisgICAgICAgIGlmIChvcGNvZGUgPT0gSU5RVUlSWSkgeworICAgICAgICAgICAg
aWYgKHJlcS0+Y2RiWzFdICYgMHgxKSB7CisgICAgICAgICAgICAgICAgY2Rfc2NzaV9jbWRfaW5x
dWlyeV92cGRfbm9fbHVuKGRldiwgcmVxLCBQRVJJRl9RVUFMSUZJRVJfVU5TVVBQT1JURUQpOwor
ICAgICAgICAgICAgfSBlbHNlIHsKKyAgICAgICAgICAgICAgICBjZF9zY3NpX2NtZF9pbnF1aXJ5
X3N0YW5kYXJkX25vX2x1bihkZXYsIHJlcSwgUEVSSUZfUVVBTElGSUVSX1VOU1VQUE9SVEVEKTsK
KyAgICAgICAgICAgIH0KKyAgICAgICAgfSBlbHNlIHsKKyAgICAgICAgICAgIGNkX3Njc2lfY21k
X2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX0xVTl9OT1RfU1VQUE9S
VEVEKTsKKyAgICAgICAgfQorICAgICAgICBnb3RvIGRvbmU7CisgICAgfQorICAgIGlmICghY2Rf
c2NzaV90YXJnZXRfbHVuX3JlYWxpemVkKHN0LCBsdW4pKSB7CisgICAgICAgIFNQSUNFX0VSUk9S
KCJyZXF1ZXN0X3N1Ym1pdCwgYWJzZW50IGx1bjoldSIsIGx1bik7CisgICAgICAgIGlmIChvcGNv
ZGUgPT0gSU5RVUlSWSkgeworICAgICAgICAgICAgaWYgKHJlcS0+Y2RiWzFdICYgMHgxKSB7Cisg
ICAgICAgICAgICAgICAgY2Rfc2NzaV9jbWRfaW5xdWlyeV92cGRfbm9fbHVuKGRldiwgcmVxLCBQ
RVJJRl9RVUFMSUZJRVJfTk9UX0NPTk5FQ1RFRCk7CisgICAgICAgICAgICB9IGVsc2UgeworICAg
ICAgICAgICAgICAgIGNkX3Njc2lfY21kX2lucXVpcnlfc3RhbmRhcmRfbm9fbHVuKGRldiwgcmVx
LCBQRVJJRl9RVUFMSUZJRVJfTk9UX0NPTk5FQ1RFRCk7CisgICAgICAgICAgICB9CisgICAgICAg
IH0gZWxzZSB7CisgICAgICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRl
diwgcmVxLCAmc2Vuc2VfY29kZV9MVU5fTk9UX1NVUFBPUlRFRCk7CisgICAgICAgIH0KKyAgICAg
ICAgZ290byBkb25lOworICAgIH0KKworICAgIGlmIChkZXYtPnNob3J0X3NlbnNlLmtleSAhPSBO
T19TRU5TRSkgeworICAgICAgICBnYm9vbGVhbiBwZW5kaW5nX3NlbnNlID0gVFJVRTsKKyAgICAg
ICAgaWYgKGRldi0+c2hvcnRfc2Vuc2Uua2V5ID09IFVOSVRfQVRURU5USU9OKSB7CisgICAgICAg
ICAgICBpZiAoY2Rfc2NzaV9vcGNvZGVfdWFfc3VwcmVzcyhvcGNvZGUpKSB7CisgICAgICAgICAg
ICAgICAgcGVuZGluZ19zZW5zZSA9IEZBTFNFOyAvKiBVQSBzdXByZXNzZWQgKi8KKyAgICAgICAg
ICAgIH0KKyAgICAgICAgfSBlbHNlIGlmIChvcGNvZGUgPT0gUkVRVUVTVF9TRU5TRSkgeworICAg
ICAgICAgICAgcGVuZGluZ19zZW5zZSA9IEZBTFNFOyAvKiBzZW5zZSByZXR1cm5lZCBhcyBkYXRh
ICovCisgICAgICAgIH0KKyAgICAgICAgaWYgKHBlbmRpbmdfc2Vuc2UpIHsKKyAgICAgICAgICAg
IGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsIE5VTEwpOyAvKiBzZW5z
ZSBhbHJlYWR5IHNldCAqLworICAgICAgICAgICAgZ290byBkb25lOworICAgICAgICB9CisgICAg
fQorCisgICAgLyogc2F2ZSB0aGUgdGFyZ2V0IHRvIGJlIHVzZWQgaW4gY2FsbGJhY2tzIHdoZXJl
IG9ubHkgcmVxIGlzIHBhc3NlZCAqLworICAgIHJlcS0+cHJpdl9kYXRhID0gKHZvaWQgKilzdDsK
KworICAgIHJlcS0+cmVxX2xlbiA9IDA7CisKKyAgICBzd2l0Y2ggKG9wY29kZSkgeworICAgIGNh
c2UgUkVQT1JUX0xVTlM6CisgICAgICAgIGNkX3Njc2lfY21kX3JlcG9ydF9sdW5zKHN0LCBkZXYs
IHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgVEVTVF9VTklUX1JFQURZOgorICAgICAg
ICBjZF9zY3NpX2NtZF90ZXN0X3VuaXRfcmVhZHkoZGV2LCByZXEpOworICAgICAgICBicmVhazsK
KyAgICBjYXNlIElOUVVJUlk6CisgICAgICAgIGNkX3Njc2lfY21kX2lucXVpcnkoZGV2LCByZXEp
OworICAgICAgICBicmVhazsKKyAgICBjYXNlIFJFUVVFU1RfU0VOU0U6CisgICAgICAgIGNkX3Nj
c2lfY21kX3JlcXVlc3Rfc2Vuc2UoZGV2LCByZXEpOworICAgICAgICBicmVhazsKKyAgICBjYXNl
IFJFQURfNjoKKyAgICBjYXNlIFJFQURfMTA6CisgICAgY2FzZSBSRUFEXzEyOgorICAgIGNhc2Ug
UkVBRF8xNjoKKyAgICAgICAgY2Rfc2NzaV9jbWRfcmVhZChkZXYsIHJlcSk7CisgICAgICAgIGJy
ZWFrOworICAgIGNhc2UgUkVBRF9DQVBBQ0lUWV8xMDoKKyAgICAgICAgY2Rfc2NzaV9jbWRfcmVh
ZF9jYXBhY2l0eShkZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgUkVBRF9UT0M6
CisgICAgICAgIGNkX3Njc2lfY21kX3JlYWRfdG9jKGRldiwgcmVxKTsKKyAgICAgICAgYnJlYWs7
CisgICAgY2FzZSBHRVRfRVZFTlRfU1RBVFVTX05PVElGSUNBVElPTjoKKyAgICAgICAgY2Rfc2Nz
aV9jbWRfZ2V0X2V2ZW50X3N0YXR1c19ub3RpZmljYXRpb24oZGV2LCByZXEpOworICAgICAgICBi
cmVhazsKKyAgICBjYXNlIFJFQURfRElTQ19JTkZPUk1BVElPTjoKKyAgICAgICAgY2Rfc2NzaV9j
bWRfZ2V0X3JlYWRfZGlzY19pbmZvcm1hdGlvbihkZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOwor
ICAgIGNhc2UgUkVBRF9UUkFDS19JTkZPUk1BVElPTjoKKyAgICAgICAgY2Rfc2NzaV9jbWRfZ2V0
X3JlYWRfdHJhY2tfaW5mb3JtYXRpb24oZGV2LCByZXEpOworICAgICAgICBicmVhazsKKyAgICBj
YXNlIE1PREVfU0VOU0VfMTA6CisgICAgICAgIGNkX3Njc2lfY21kX21vZGVfc2Vuc2VfMTAoZGV2
LCByZXEpOworICAgICAgICBicmVhazsKKyAgICBjYXNlIE1PREVfU0VMRUNUOgorICAgICAgICBj
ZF9zY3NpX2NtZF9tb2RlX3NlbGVjdF82KGRldiwgcmVxKTsKKyAgICAgICAgYnJlYWs7CisgICAg
Y2FzZSBNT0RFX1NFTEVDVF8xMDoKKyAgICAgICAgY2Rfc2NzaV9jbWRfbW9kZV9zZWxlY3RfMTAo
ZGV2LCByZXEpOworICAgICAgICBicmVhazsKKyAgICBjYXNlIEdFVF9DT05GSUdVUkFUSU9OOgor
ICAgICAgICBjZF9zY3NpX2NtZF9nZXRfY29uZmlndXJhdGlvbihkZXYsIHJlcSk7CisgICAgICAg
IGJyZWFrOworICAgIGNhc2UgQUxMT1dfTUVESVVNX1JFTU9WQUw6CisgICAgICAgIGNkX3Njc2lf
Y21kX2FsbG93X21lZGl1bV9yZW1vdmFsKGRldiwgcmVxKTsKKyAgICAgICAgYnJlYWs7CisgICAg
Y2FzZSBNTUNfU0VORF9FVkVOVDoKKyAgICAgICAgY2Rfc2NzaV9jbWRfc2VuZF9ldmVudChkZXYs
IHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgTU1DX1JFUE9SVF9LRVk6CisgICAgICAg
IGNkX3Njc2lfY21kX3JlcG9ydF9rZXkoZGV2LCByZXEpOworICAgICAgICBicmVhazsKKyAgICBj
YXNlIE1NQ19TRU5EX0tFWToKKyAgICAgICAgY2Rfc2NzaV9jbWRfc2VuZF9rZXkoZGV2LCByZXEp
OworICAgICAgICBicmVhazsKKyAgICBjYXNlIFNUQVJUX1NUT1A6CisgICAgICAgIGNkX3Njc2lf
Y21kX3N0YXJ0X3N0b3BfdW5pdChkZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2Ug
TU1DX0dFVF9QRVJGT1JNQU5DRToKKyAgICAgICAgY2Rfc2NzaV9jbWRfZ2V0X3BlcmZvcm1hbmNl
KGRldiwgcmVxKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBNTUNfTUVDSEFOSVNNX1NUQVRV
UzoKKyAgICAgICAgY2Rfc2NzaV9jbWRfbWVjaGFuaXNtX3N0YXR1cyhkZXYsIHJlcSk7CisgICAg
ICAgIGJyZWFrOworICAgIGRlZmF1bHQ6CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2No
ZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX0lOVkFMSURfT1BDT0RFKTsKKyAgICAgICAg
YnJlYWs7CisgICAgfQorCisgICAgaWYgKHJlcS0+cmVxX2xlbiA+IElOVDMyX01BWCkgeworICAg
ICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29k
ZV9JTlZBTElEX0NEQl9GSUVMRCk7CisgICAgICAgIGdvdG8gZG9uZTsKKyAgICB9CisKK2RvbmU6
CisgICAgU1BJQ0VfREVCVUcoInJlcXVlc3Rfc3VibWl0IGRvbmUsIGx1bjogJXUiCisgICAgICAg
ICAgICAgICAgIiBvcDogMHglMDJ4ICVzLCBzdGF0ZTogJXMgc3RhdHVzOiAldSBsZW46ICUiIEdf
R1VJTlQ2NF9GT1JNQVQsCisgICAgICAgICAgICAgICAgbHVuLCBvcGNvZGUsIGNtZF9uYW1lLCBD
ZFNjc2lSZXFTdGF0ZV9zdHIocmVxLT5yZXFfc3RhdGUpLCByZXEtPnN0YXR1cywKKyAgICAgICAg
ICAgICAgICByZXEtPmluX2xlbik7CisKKyAgICBpZiAocmVxLT5yZXFfc3RhdGUgPT0gU0NTSV9S
RVFfQ09NUExFVEUpIHsKKyAgICAgICAgY2Rfc2NzaV9kZXZfcmVxdWVzdF9jb21wbGV0ZShzdC0+
dXNlcl9kYXRhLCByZXEpOworICAgIH0KK30KKwordm9pZCBjZF9zY3NpX2Rldl9yZXF1ZXN0X2Nh
bmNlbChDZFNjc2lUYXJnZXQgKnN0LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgaWYgKHN0
LT5jdXJfcmVxID09IHJlcSkgeworICAgICAgICBpZiAocmVxLT5yZXFfc3RhdGUgPT0gU0NTSV9S
RVFfUlVOTklORykgeworICAgICAgICAgICAgU1BJQ0VfREVCVUcoInJlcXVlc3RfY2FuY2VsOiBs
dW46ICV1IgorICAgICAgICAgICAgICAgICAgICAgICAgICIgb3A6IDB4JTAyeCBsZW46ICUiIEdf
R1VJTlQ2NF9GT1JNQVQsCisgICAgICAgICAgICAgICAgICAgICAgICByZXEtPmx1biwgKHVuc2ln
bmVkIGludClyZXEtPmNkYlswXSwgcmVxLT5yZXFfbGVuKTsKKyAgICAgICAgICAgIGdfY2FuY2Vs
bGFibGVfY2FuY2VsKHN0LT5jYW5jZWxsYWJsZSk7CisgICAgICAgIH0gZWxzZSB7CisgICAgICAg
ICAgICBTUElDRV9ERUJVRygicmVxdWVzdF9jYW5jZWw6IHJlcXVlc3QgaXMgbm90IHJ1bm5pbmci
KTsKKyAgICAgICAgfQorICAgIH0gZWxzZSB7CisgICAgICAgIFNQSUNFX0RFQlVHKCJyZXF1ZXN0
X2NhbmNlbDogb3RoZXIgcmVxdWVzdCBpcyBvdXRzdGFuZGluZyIpOworICAgIH0KK30KKwordm9p
ZCBjZF9zY3NpX2Rldl9yZXF1ZXN0X3JlbGVhc2UoQ2RTY3NpVGFyZ2V0ICpzdCwgQ2RTY3NpUmVx
dWVzdCAqcmVxKQoreworICAgIHN0LT5jdXJfcmVxID0gTlVMTDsKKyAgICBjZF9zY3NpX3JlcV9p
bml0KHJlcSk7CisKKyAgICBpZiAoc3QtPnN0YXRlID09IENEX1NDU0lfVEdUX1NUQVRFX1JFU0VU
KSB7CisgICAgICAgIGNkX3Njc2lfdGFyZ2V0X2RvX3Jlc2V0KHN0KTsKKyAgICB9Cit9CisKKyNl
bmRpZiAvKiBVU0VfVVNCUkVESVIgKi8KZGlmZiAtLWdpdCBhL3NyYy9jZC1zY3NpLmggYi9zcmMv
Y2Qtc2NzaS5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAuLjg2ZTk1MWIKLS0t
IC9kZXYvbnVsbAorKysgYi9zcmMvY2Qtc2NzaS5oCkBAIC0wLDAgKzEsMTE3IEBACisvKiAtKi0g
TW9kZTogQzsgYy1iYXNpYy1vZmZzZXQ6IDQ7IGluZGVudC10YWJzLW1vZGU6IG5pbCAtKi0gKi8K
Ky8qCisgICBDRCBkZXZpY2UgZW11bGF0aW9uIC0gU0NTSSBlbmdpbmUKKworICAgQ29weXJpZ2h0
IChDKSAyMDE4IFJlZCBIYXQsIEluYy4KKworICAgUmVkIEhhdCBBdXRob3JzOgorICAgQWxleGFu
ZGVyIE5lemhpbnNreTxhbmV6aGluc0ByZWRoYXQuY29tPgorCisgICBUaGlzIGxpYnJhcnkgaXMg
ZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yCisgICBtb2RpZnkg
aXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCisgICBM
aWNlbnNlIGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRo
ZXIKKyAgIHZlcnNpb24gMi4xIG9mIHRoZSBMaWNlbnNlLCBvciAoYXQgeW91ciBvcHRpb24pIGFu
eSBsYXRlciB2ZXJzaW9uLgorCisgICBUaGlzIGxpYnJhcnkgaXMgZGlzdHJpYnV0ZWQgaW4gdGhl
IGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKKyAgIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5U
WTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCisgICBNRVJDSEFOVEFCSUxJ
VFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlIEdOVQorICAg
TGVzc2VyIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KKworICAgWW91
IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1
YmxpYworICAgTGljZW5zZSBhbG9uZyB3aXRoIHRoaXMgbGlicmFyeTsgaWYgbm90LCBzZWUgPGh0
dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+LgorKi8KKworI3ByYWdtYSBvbmNlCisKKyNpbmNs
dWRlICJjZC1zY3NpLWRldi1wYXJhbXMuaCIKKyNpbmNsdWRlICJjZC11c2ItYnVsay1tc2QuaCIK
KyNpbmNsdWRlICJzY3NpLWNvbnN0YW50cy5oIgorCisjaWYgZGVmaW5lZChHX09TX1dJTjMyKQor
I2luY2x1ZGUgPHdpbnNvY2syLmg+CisjaW5jbHVkZSA8d2luZG93cy5oPgorLyogV2luZG93cyBp
cyBhbHdheXMgTEUgYXQgdGhlIG1vbWVudCAqLworI2RlZmluZSBsZTMydG9oKHgpICAgICAgICAg
ICh4KQorI2RlZmluZSBodG9sZTMyKHgpICAgICAgICAgICh4KQorI2RlZmluZSBodG9iZTMyKHgp
ICAgICAgICAgIGh0b25sKHgpCisjZW5kaWYKKwordHlwZWRlZiBlbnVtIFNjc2lYZmVyRGlyIHsK
KyAgICBTQ1NJX1hGRVJfTk9ORSA9IDAsICAvKiBURVNUX1VOSVRfUkVBRFksIC4uLiAgICAgICAg
ICAgKi8KKyAgICBTQ1NJX1hGRVJfRlJPTV9ERVYsICAvKiBSRUFELCBJTlFVSVJZLCBNT0RFX1NF
TlNFLCAuLi4gKi8KKyAgICBTQ1NJX1hGRVJfVE9fREVWLCAgICAvKiBXUklURSwgTU9ERV9TRUxF
Q1QsIC4uLiAgICAgICAgKi8KK30gU2NzaVhmZXJEaXI7CisKKyNkZWZpbmUgU0NTSV9DREJfQlVG
X1NJWkUgICAxNgorCit0eXBlZGVmIGVudW0gQ2RTY3NpUmVxU3RhdGUgeworICAgIFNDU0lfUkVR
X0lETEUgPSAwLAorICAgIFNDU0lfUkVRX1JVTk5JTkcsCisgICAgU0NTSV9SRVFfQ09NUExFVEUs
CisgICAgU0NTSV9SRVFfQ0FOQ0VMRUQsCisgICAgU0NTSV9SRVFfRElTUE9TRUQsCit9IENkU2Nz
aVJlcVN0YXRlOworCit0eXBlZGVmIHN0cnVjdCBDZFNjc2lSZXF1ZXN0IHsKKyAgICAvKiByZXF1
ZXN0ICovCisgICAgdWludDhfdCBjZGJbU0NTSV9DREJfQlVGX1NJWkVdOworICAgIHVpbnQzMl90
IGNkYl9sZW47CisKKyAgICB1aW50MzJfdCBsdW47CisKKyAgICB1aW50OF90ICpidWY7CisgICAg
dWludDMyX3QgYnVmX2xlbjsKKworICAgIC8qIGludGVybmFsICovCisgICAgQ2RTY3NpUmVxU3Rh
dGUgcmVxX3N0YXRlOworICAgIFNjc2lYZmVyRGlyIHhmZXJfZGlyOworICAgIHVpbnQ2NF90IGNh
bmNlbF9pZDsKKyAgICB2b2lkICpwcml2X2RhdGE7CisKKyAgICB1aW50NjRfdCBsYmE7IC8qIG9m
ZnNldCBpbiBsb2dpY2FsIGJsb2NrcyBpZiByZWxldmFudCAqLworICAgIHVpbnQ2NF90IGNvdW50
OyAvKiBjb3VudCBpbiBsb2dpY2FsIGJsb2NrcyAqLworCisgICAgdWludDY0X3Qgb2Zmc2V0OyAv
KiBzY3NpIGNkYiBvZmZzZXQsIG5vcm1hbGl6ZWQgdG8gYnl0ZXMgKi8KKyAgICB1aW50NjRfdCBy
ZXFfbGVuOyAvKiBzY3NpIGNkYiByZXF1ZXN0IGxlbmd0aCwgbm9ybWFsaXplZCB0byBieXRlcyAq
LworCisgICAgLyogcmVzdWx0ICovCisgICAgdWludDY0X3QgaW5fbGVuOyAvKiBsZW5ndGggb2Yg
ZGF0YSBhY3R1YWxseSBhdmFpbGFibGUgYWZ0ZXIgcmVhZCAqLworICAgIHVpbnQzMl90IHN0YXR1
czsgLyogU0NTSSBzdGF0dXMgY29kZSAqLworCit9IENkU2NzaVJlcXVlc3Q7CisKK0NkU2NzaVJl
cVN0YXRlIGNkX3Njc2lfZ2V0X3JlcV9zdGF0ZShDZFNjc2lSZXF1ZXN0ICpyZXEpOworCisvKiBT
Q1NJIHRhcmdldC9kZXZpY2UgQVBJICovCit0eXBlZGVmIHN0cnVjdCBDZFNjc2lUYXJnZXQgQ2RT
Y3NpVGFyZ2V0OworCisvKiB0byBiZSB1c2VkIGluIGNhbGxiYWNrcyAqLworQ2RTY3NpVGFyZ2V0
ICpjZF9zY3NpX3RhcmdldF9hbGxvYyh2b2lkICp0YXJnZXRfdXNlcl9kYXRhLCB1aW50MzJfdCBt
YXhfbHVucyk7Cit2b2lkIGNkX3Njc2lfdGFyZ2V0X2ZyZWUoQ2RTY3NpVGFyZ2V0ICpzY3NpX3Rh
cmdldCk7CisKK2ludCBjZF9zY3NpX2Rldl9yZWFsaXplKENkU2NzaVRhcmdldCAqc2NzaV90YXJn
ZXQsIHVpbnQzMl90IGx1biwKKyAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IENkU2NzaURl
dmljZVBhcmFtZXRlcnMgKmRldl9wYXJhbXMpOworaW50IGNkX3Njc2lfZGV2X3VucmVhbGl6ZShD
ZFNjc2lUYXJnZXQgKnNjc2lfdGFyZ2V0LCB1aW50MzJfdCBsdW4pOworCitpbnQgY2Rfc2NzaV9k
ZXZfbG9jayhDZFNjc2lUYXJnZXQgKnNjc2lfdGFyZ2V0LCB1aW50MzJfdCBsdW4sIGdib29sZWFu
IGxvY2spOworaW50IGNkX3Njc2lfZGV2X2xvYWQoQ2RTY3NpVGFyZ2V0ICpzY3NpX3RhcmdldCwg
dWludDMyX3QgbHVuLAorICAgICAgICAgICAgICAgICAgICAgY29uc3QgQ2RTY3NpTWVkaWFQYXJh
bWV0ZXJzICptZWRpYV9wYXJhbXMpOworaW50IGNkX3Njc2lfZGV2X2dldF9pbmZvKENkU2NzaVRh
cmdldCAqc2NzaV90YXJnZXQsIHVpbnQzMl90IGx1biwgQ2RTY3NpRGV2aWNlSW5mbyAqbHVuX2lu
Zm8pOworaW50IGNkX3Njc2lfZGV2X3VubG9hZChDZFNjc2lUYXJnZXQgKnNjc2lfdGFyZ2V0LCB1
aW50MzJfdCBsdW4pOworCit2b2lkIGNkX3Njc2lfZGV2X3JlcXVlc3Rfc3VibWl0KENkU2NzaVRh
cmdldCAqc2NzaV90YXJnZXQsIENkU2NzaVJlcXVlc3QgKnJlcXVlc3QpOwordm9pZCBjZF9zY3Np
X2Rldl9yZXF1ZXN0X2NhbmNlbChDZFNjc2lUYXJnZXQgKnNjc2lfdGFyZ2V0LCBDZFNjc2lSZXF1
ZXN0ICpyZXF1ZXN0KTsKK3ZvaWQgY2Rfc2NzaV9kZXZfcmVxdWVzdF9yZWxlYXNlKENkU2NzaVRh
cmdldCAqc2NzaV90YXJnZXQsIENkU2NzaVJlcXVlc3QgKnJlcXVlc3QpOworCitpbnQgY2Rfc2Nz
aV9kZXZfcmVzZXQoQ2RTY3NpVGFyZ2V0ICpzY3NpX3RhcmdldCwgdWludDMyX3QgbHVuKTsKKwor
aW50IGNkX3Njc2lfdGFyZ2V0X3Jlc2V0KENkU2NzaVRhcmdldCAqc2NzaV90YXJnZXQpOworCisv
KiBDYWxsYmFja3MKKyAqIFRoZXNlIGNhbGxiYWNrcyBhcmUgdXNlZCBieSB1cHBlciBsYXllciB0
byBpbXBsZW1lbnQgc3BlY2lmaWMgU0NTSQorICogdGFyZ2V0IGRldmljZXMuCisgKi8KK3ZvaWQg
Y2Rfc2NzaV9kZXZfcmVxdWVzdF9jb21wbGV0ZSh2b2lkICp0YXJnZXRfdXNlcl9kYXRhLCBDZFNj
c2lSZXF1ZXN0ICpyZXF1ZXN0KTsKK3ZvaWQgY2Rfc2NzaV9kZXZfY2hhbmdlZCh2b2lkICp0YXJn
ZXRfdXNlcl9kYXRhLCB1aW50MzJfdCBsdW4pOwordm9pZCBjZF9zY3NpX2Rldl9yZXNldF9jb21w
bGV0ZSh2b2lkICp0YXJnZXRfdXNlcl9kYXRhLCB1aW50MzJfdCBsdW4pOwordm9pZCBjZF9zY3Np
X3RhcmdldF9yZXNldF9jb21wbGV0ZSh2b2lkICp0YXJnZXRfdXNlcl9kYXRhKTsKZGlmZiAtLWdp
dCBhL3NyYy9jZC11c2ItYnVsay1tc2QuYyBiL3NyYy9jZC11c2ItYnVsay1tc2QuYwpuZXcgZmls
ZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwLi41ZDk1ZGFjCi0tLSAvZGV2L251bGwKKysrIGIv
c3JjL2NkLXVzYi1idWxrLW1zZC5jCkBAIC0wLDAgKzEsNTQzIEBACisvKiAtKi0gTW9kZTogQzsg
Yy1iYXNpYy1vZmZzZXQ6IDQ7IGluZGVudC10YWJzLW1vZGU6IG5pbCAtKi0gKi8KKy8qCisgICAg
VVNCIENEIERldmljZSBlbXVsYXRpb24gLSBEYXRhIEJ1bGsgdHJhbnNmZXJzIC0gTWFzcyBTdG9y
YWdlIERldmljZQorCisgICAgQ29weXJpZ2h0IChDKSAyMDE4IFJlZCBIYXQsIEluYy4KKworICAg
IFJlZCBIYXQgQXV0aG9yczoKKyAgICBBbGV4YW5kZXIgTmV6aGluc2t5PGFuZXpoaW5zQHJlZGhh
dC5jb20+CisKKyAgICBUaGlzIGxpYnJhcnkgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRp
c3RyaWJ1dGUgaXQgYW5kL29yCisgICAgbW9kaWZ5IGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUg
R05VIExlc3NlciBHZW5lcmFsIFB1YmxpYworICAgIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRo
ZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlcgorICAgIHZlcnNpb24gMi4xIG9mIHRo
ZSBMaWNlbnNlLCBvciAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgorCisgICAg
VGhpcyBsaWJyYXJ5IGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1
c2VmdWwsCisgICAgYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGlt
cGxpZWQgd2FycmFudHkgb2YKKyAgICBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQ
QVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlIEdOVQorICAgIExlc3NlciBHZW5lcmFsIFB1Ymxp
YyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCisKKyAgICBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2
ZWQgYSBjb3B5IG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCisgICAgTGljZW5zZSBh
bG9uZyB3aXRoIHRoaXMgbGlicmFyeTsgaWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9s
aWNlbnNlcy8+LgorKi8KKworI2luY2x1ZGUgImNvbmZpZy5oIgorI2luY2x1ZGUgInNwaWNlL3R5
cGVzLmgiCisjaW5jbHVkZSAic3BpY2UtY29tbW9uLmgiCisjaW5jbHVkZSAic3BpY2UtdXRpbC5o
IgorI2luY2x1ZGUgImNkLXVzYi1idWxrLW1zZC5oIgorI2luY2x1ZGUgImNkLXNjc2kuaCIKKwor
I2lmZGVmIFVTRV9VU0JSRURJUgorCisjZGVmaW5lIFNQSUNFX0VSUk9SKGZtdCwgLi4uKSBcCisg
ICAgZG8geyBTUElDRV9ERUJVRygidXNiLW1zZCBlcnJvcjogIiBmbXQgLCAjIyBfX1ZBX0FSR1Nf
Xyk7IH0gd2hpbGUgKDApCisKK3R5cGVkZWYgZW51bSBVc2JDZFN0YXRlIHsKKyAgICBVU0JfQ0Rf
U1RBVEVfSU5JVCwgLyogTm90IHJlYWR5ICovCisgICAgVVNCX0NEX1NUQVRFX0NCVywgLyogV2Fp
dGluZyBmb3IgQ29tbWFuZCBCbG9jayAqLworICAgIFVTQl9DRF9TVEFURV9EQVRBT1VULCAvKiBU
cmFuc2ZlciBkYXRhIHRvIGRldmljZSAqLworICAgIFVTQl9DRF9TVEFURV9EQVRBSU4sIC8qIFRy
YW5zZmVyIGRhdGEgZnJvbSBkZXZpY2UgKi8KKyAgICBVU0JfQ0RfU1RBVEVfWkVST19EQVRBSU4s
IC8qIE5lZWQgdG8gc2VuZCB6ZXJvIGJ1bGstaW4gYmVmb3JlIHN0YXR1cyAqLworICAgIFVTQl9D
RF9TVEFURV9DU1csIC8qIFNlbmQgQ29tbWFuZCBTdGF0dXMgKi8KKyAgICBVU0JfQ0RfU1RBVEVf
REVWSUNFX1JFU0VULCAvKiByZXNldCBvZiBhIHNpbmdsZSBkZXZpY2UgKi8KKyAgICBVU0JfQ0Rf
U1RBVEVfVEFSR0VUX1JFU0VUIC8qIHJlc2V0IG9mIGVudGlyZSB0YXJnZXQgKi8KK30gVXNiQ2RT
dGF0ZTsKKworLyogVVNCIE1TRCBDb21tYW5kIEJsb2NrIFdyYXBwZXIgKi8KK3N0cnVjdCBfX2F0
dHJpYnV0ZV9fKChfX3BhY2tlZF9fKSkgVXNiQ2RDQlcgeworICAgIHVpbnQzMl90IHNpZzsKKyAg
ICB1aW50MzJfdCB0YWc7CisgICAgdWludDMyX3QgZXhwX2RhdGFfbGVuOyAvKiBleHBlY3RlZCBk
YXRhIHhmZXIgbGVuZ3RoIGZvciB0aGUgcmVxdWVzdCAqLworICAgIHVpbnQ4X3QgZmxhZ3M7Cisg
ICAgdWludDhfdCBsdW47CisgICAgdWludDhfdCBjbWRfbGVuOyAvKiBhY3R1YWwgbGVuZ3RoIG9m
IHRoZSBzY3NpIGNvbW1hbmQgdGhhdCBmb2xsb3dzICovCisgICAgdWludDhfdCBjbWRbMTZdOyAv
KiBzY3NpIGNvbW1hbmQgdG8gcGVyZm9ybSAqLworfTsKKworLyogVVNCIE1TRCBDb21tYW5kIFN0
YXR1cyBXcmFwcGVyICovCitzdHJ1Y3QgX19hdHRyaWJ1dGVfXygoX19wYWNrZWRfXykpIFVzYkNk
Q1NXIHsKKyAgICB1aW50MzJfdCBzaWc7CisgICAgdWludDMyX3QgdGFnOworICAgIHVpbnQzMl90
IHJlc2lkdWU7CisgICAgdWludDhfdCBzdGF0dXM7Cit9OworCisvKiBVc2JDZENTVzo6c3RhdHVz
ICovCit0eXBlZGVmIGVudW0gVXNiTXNkU3RhdHVzIHsKKyAgICBVU0JfTVNEX1NUQVRVU19HT09E
ID0gMCwKKyAgICBVU0JfTVNEX1NUQVRVU19GQUlMRUQgPSAxLAorICAgIFVTQl9NU0RfU1RBVFVT
X1BIQVNFX0VSUiA9IDIsCit9IFVzYk1zZFN0YXR1czsKKwordHlwZWRlZiBzdHJ1Y3QgVXNiQ2RC
dWxrTXNkUmVxdWVzdCB7CisgICAgQ2RTY3NpUmVxdWVzdCBzY3NpX3JlcTsKKworICAgIHVpbnQz
Ml90IGx1bjsKKyAgICB1aW50MzJfdCB1c2JfcmVxX2xlbjsgLyogbGVuZ3RoIG9mIGRhdGEgcmVx
dWVzdGVkIGJ5IHVzYiAqLworICAgIHVpbnQzMl90IHNjc2lfaW5fbGVuOyAvKiBsZW5ndGggb2Yg
ZGF0YSByZXR1cm5lZCBieSBzY3NpIGxpbWl0ZWQgYnkgdXNiIHJlcXVlc3QgKi8KKworICAgIHVp
bnQzMl90IHhmZXJfbGVuOyAvKiBsZW5ndGggb2YgZGF0YSB0cmFuc2ZlcmVkIHVudGlsIG5vdyAq
LworICAgIHVpbnQzMl90IGJ1bGtfaW5fbGVuOyAvKiBsZW5ndGggb2YgdGhlIGxhc3QgcG9zdHBv
bmVkIGJ1bGstaW4gcmVxdWVzdCAqLworCisgICAgc3RydWN0IFVzYkNkQ1NXIGNzdzsgLyogdXNi
IHN0YXR1cyBoZWFkZXIgKi8KK30gVXNiQ2RCdWxrTXNkUmVxdWVzdDsKKwordHlwZWRlZiBzdHJ1
Y3QgVXNiQ2RCdWxrTXNkRGV2aWNlIHsKKyAgICBVc2JDZFN0YXRlIHN0YXRlOworICAgIENkU2Nz
aVRhcmdldCAqc2NzaV90YXJnZXQ7IC8qIHNjc2kgaGFuZGxlICovCisgICAgdm9pZCAqdXNiX3Vz
ZXJfZGF0YTsgLyogdXNlZCBpbiBjYWxsYmFja3MgdG8gdXNiICovCisgICAgVXNiQ2RCdWxrTXNk
UmVxdWVzdCB1c2JfcmVxOyAvKiBub3cgc3VwcG9ydGluZyBhIHNpbmdsZSBjbWQgKi8KKyAgICB1
aW50OF90ICpkYXRhX2J1ZjsKKyAgICB1aW50MzJfdCBkYXRhX2J1Zl9sZW47Cit9IFVzYkNkQnVs
a01zZERldmljZTsKKworc3RhdGljIGlubGluZSBjb25zdCBjaGFyICp1c2JfY2Rfc3RhdGVfc3Ry
KFVzYkNkU3RhdGUgc3RhdGUpCit7CisgICAgc3dpdGNoIChzdGF0ZSkgeworICAgIGNhc2UgVVNC
X0NEX1NUQVRFX0lOSVQ6CisgICAgICAgIHJldHVybiAiSU5JVCI7CisgICAgY2FzZSBVU0JfQ0Rf
U1RBVEVfQ0JXOgorICAgICAgICByZXR1cm4gIkNCVyI7CisgICAgY2FzZSBVU0JfQ0RfU1RBVEVf
REFUQU9VVDoKKyAgICAgICAgcmV0dXJuICJEQVRBT1VUIjsKKyAgICBjYXNlIFVTQl9DRF9TVEFU
RV9EQVRBSU46CisgICAgICAgIHJldHVybiAiREFUQUlOIjsKKyAgICBjYXNlIFVTQl9DRF9TVEFU
RV9aRVJPX0RBVEFJTjoKKyAgICAgICAgcmV0dXJuICJaRVJPX0RBVEFJTiI7CisgICAgY2FzZSBV
U0JfQ0RfU1RBVEVfQ1NXOgorICAgICAgICByZXR1cm4gIkNTVyI7CisgICAgY2FzZSBVU0JfQ0Rf
U1RBVEVfREVWSUNFX1JFU0VUOgorICAgICAgICByZXR1cm4gIkRFVl9SRVNFVCI7CisgICAgY2Fz
ZSBVU0JfQ0RfU1RBVEVfVEFSR0VUX1JFU0VUOgorICAgICAgICByZXR1cm4gIlRHVF9SRVNFVCI7
CisgICAgZGVmYXVsdDoKKyAgICAgICAgcmV0dXJuICJJTExFR0FMIjsKKyAgICB9Cit9CisKK3N0
YXRpYyB2b2lkIGNkX3VzYl9idWxrX21zZF9zZXRfc3RhdGUoVXNiQ2RCdWxrTXNkRGV2aWNlICpj
ZCwgVXNiQ2RTdGF0ZSBzdGF0ZSkKK3sKKyAgICBTUElDRV9ERUJVRygiU3RhdGUgJXMgLT4gJXMi
LCB1c2JfY2Rfc3RhdGVfc3RyKGNkLT5zdGF0ZSksIHVzYl9jZF9zdGF0ZV9zdHIoc3RhdGUpKTsK
KyAgICBjZC0+c3RhdGUgPSBzdGF0ZTsKK30KKworVXNiQ2RCdWxrTXNkRGV2aWNlICpjZF91c2Jf
YnVsa19tc2RfYWxsb2Modm9pZCAqdXNiX3VzZXJfZGF0YSwgdWludDMyX3QgbWF4X2x1bnMpCit7
CisgICAgVXNiQ2RCdWxrTXNkRGV2aWNlICpjZCA9IGdfbmV3MChVc2JDZEJ1bGtNc2REZXZpY2Us
IDEpOworCisgICAgY2QtPmRhdGFfYnVmX2xlbiA9IDI1NiAqIDEwMjQ7CisgICAgY2QtPmRhdGFf
YnVmID0gZ19tYWxsb2MoY2QtPmRhdGFfYnVmX2xlbik7CisKKyAgICBjZC0+c2NzaV90YXJnZXQg
PSBjZF9zY3NpX3RhcmdldF9hbGxvYyhjZCwgbWF4X2x1bnMpOworICAgIGlmIChjZC0+c2NzaV90
YXJnZXQgPT0gTlVMTCkgeworICAgICAgICBnX2ZyZWUoY2QtPmRhdGFfYnVmKTsKKyAgICAgICAg
Z19mcmVlKGNkKTsKKyAgICAgICAgcmV0dXJuIE5VTEw7CisgICAgfQorICAgIGNkX3VzYl9idWxr
X21zZF9zZXRfc3RhdGUoY2QsIFVTQl9DRF9TVEFURV9JTklUKTsKKyAgICBjZC0+dXNiX3VzZXJf
ZGF0YSA9IHVzYl91c2VyX2RhdGE7CisKKyAgICBTUElDRV9ERUJVRygiQWxsb2MsIG1heF9sdW5z
OiV1IiwgbWF4X2x1bnMpOworICAgIHJldHVybiBjZDsKK30KKworaW50IGNkX3VzYl9idWxrX21z
ZF9yZWFsaXplKFVzYkNkQnVsa01zZERldmljZSAqY2QsIHVpbnQzMl90IGx1biwKKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBjb25zdCBDZFNjc2lEZXZpY2VQYXJhbWV0ZXJzICpkZXZfcGFy
YW1zKQoreworICAgIENkU2NzaURldmljZVBhcmFtZXRlcnMgc2NzaV9kZXZfcGFyYW1zOworICAg
IGludCByYzsKKworICAgIHNjc2lfZGV2X3BhcmFtcy52ZW5kb3IgPSBkZXZfcGFyYW1zLT52ZW5k
b3IgPyA6ICJTUElDRSI7CisgICAgc2NzaV9kZXZfcGFyYW1zLnByb2R1Y3QgPSBkZXZfcGFyYW1z
LT5wcm9kdWN0ID8gOiAiVVNCLUNEIjsKKyAgICBzY3NpX2Rldl9wYXJhbXMudmVyc2lvbiA9IGRl
dl9wYXJhbXMtPnZlcnNpb24gPyA6ICIwLjEiOworICAgIHNjc2lfZGV2X3BhcmFtcy5zZXJpYWwg
PSBkZXZfcGFyYW1zLT5zZXJpYWwgPyA6ICIxMjM0NTYiOworCisgICAgcmMgPSBjZF9zY3NpX2Rl
dl9yZWFsaXplKGNkLT5zY3NpX3RhcmdldCwgbHVuLCAmc2NzaV9kZXZfcGFyYW1zKTsKKyAgICBp
ZiAocmMgIT0gMCkgeworICAgICAgICBTUElDRV9FUlJPUigiRmFpbGVkIHRvIHJlYWxpemUgbHVu
OiV1IiwgbHVuKTsKKyAgICAgICAgcmV0dXJuIHJjOworICAgIH0KKworICAgIGlmIChjZC0+c3Rh
dGUgPT0gVVNCX0NEX1NUQVRFX0lOSVQpIHsKKyAgICAgICAgLyogd2FpdCBuZXh0IHJlcXVlc3Qg
Ki8KKyAgICAgICAgY2RfdXNiX2J1bGtfbXNkX3NldF9zdGF0ZShjZCwgVVNCX0NEX1NUQVRFX0NC
Vyk7CisgICAgICAgIGNkX3Njc2lfZGV2X3JlcXVlc3RfcmVsZWFzZShjZC0+c2NzaV90YXJnZXQs
ICZjZC0+dXNiX3JlcS5zY3NpX3JlcSk7CisgICAgfQorCisgICAgU1BJQ0VfREVCVUcoIlJlYWxp
emUgT0sgbHVuOiV1IiwgbHVuKTsKKyAgICByZXR1cm4gMDsKK30KKworaW50IGNkX3VzYl9idWxr
X21zZF9sb2NrKFVzYkNkQnVsa01zZERldmljZSAqY2QsIHVpbnQzMl90IGx1biwgZ2Jvb2xlYW4g
bG9jaykKK3sKKyAgICBpbnQgcmM7CisKKyAgICByYyA9IGNkX3Njc2lfZGV2X2xvY2soY2QtPnNj
c2lfdGFyZ2V0LCBsdW4sIGxvY2spOworICAgIGlmIChyYyAhPSAwKSB7CisgICAgICAgIFNQSUNF
X0VSUk9SKCJGYWlsZWQgdG8gbG9jayBsdW46JXUiLCBsdW4pOworICAgICAgICByZXR1cm4gcmM7
CisgICAgfQorCisgICAgU1BJQ0VfREVCVUcoIkxvY2sgT0sgbHVuOiV1IiwgbHVuKTsKKyAgICBy
ZXR1cm4gMDsKK30KKworaW50IGNkX3VzYl9idWxrX21zZF9sb2FkKFVzYkNkQnVsa01zZERldmlj
ZSAqY2QsIHVpbnQzMl90IGx1biwKKyAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBDZFNj
c2lNZWRpYVBhcmFtZXRlcnMgKm1lZGlhX3BhcmFtcykKK3sKKyAgICBpbnQgcmM7CisKKyAgICBy
YyA9IGNkX3Njc2lfZGV2X2xvYWQoY2QtPnNjc2lfdGFyZ2V0LCBsdW4sIG1lZGlhX3BhcmFtcyk7
CisgICAgaWYgKHJjICE9IDApIHsKKyAgICAgICAgU1BJQ0VfRVJST1IoIkZhaWxlZCB0byBsb2Fk
IGx1bjoldSIsIGx1bik7CisgICAgICAgIHJldHVybiByYzsKKyAgICB9CisKKyAgICBTUElDRV9E
RUJVRygiTG9hZCBPSyBsdW46JXUiLCBsdW4pOworICAgIHJldHVybiAwOworfQorCitpbnQgY2Rf
dXNiX2J1bGtfbXNkX2dldF9pbmZvKFVzYkNkQnVsa01zZERldmljZSAqY2QsIHVpbnQzMl90IGx1
biwgQ2RTY3NpRGV2aWNlSW5mbyAqbHVuX2luZm8pCit7CisgICAgaW50IHJjOworCisgICAgcmMg
PSBjZF9zY3NpX2Rldl9nZXRfaW5mbyhjZC0+c2NzaV90YXJnZXQsIGx1biwgbHVuX2luZm8pOwor
ICAgIGlmIChyYyAhPSAwKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJGYWlsZWQgdG8gZ2V0IGlu
Zm8gbHVuOiV1IiwgbHVuKTsKKyAgICAgICAgcmV0dXJuIHJjOworICAgIH0KKworICAgIHJldHVy
biAwOworfQorCitpbnQgY2RfdXNiX2J1bGtfbXNkX3VubG9hZChVc2JDZEJ1bGtNc2REZXZpY2Ug
KmNkLCB1aW50MzJfdCBsdW4pCit7CisgICAgaW50IHJjOworCisgICAgcmMgPSBjZF9zY3NpX2Rl
dl91bmxvYWQoY2QtPnNjc2lfdGFyZ2V0LCBsdW4pOworICAgIGlmIChyYyAhPSAwKSB7CisgICAg
ICAgIFNQSUNFX0VSUk9SKCJGYWlsZWQgdG8gdW5sb2FkIGx1bjoldSIsIGx1bik7CisgICAgICAg
IHJldHVybiByYzsKKyAgICB9CisKKyAgICBTUElDRV9ERUJVRygiVW5sb2FkIE9LIGx1bjoldSIs
IGx1bik7CisgICAgcmV0dXJuIDA7Cit9CisKK2ludCBjZF91c2JfYnVsa19tc2RfdW5yZWFsaXpl
KFVzYkNkQnVsa01zZERldmljZSAqY2QsIHVpbnQzMl90IGx1bikKK3sKKyAgICBpbnQgcmM7CisK
KyAgICByYyA9IGNkX3Njc2lfZGV2X3VucmVhbGl6ZShjZC0+c2NzaV90YXJnZXQsIGx1bik7Cisg
ICAgaWYgKHJjICE9IDApIHsKKyAgICAgICAgU1BJQ0VfRVJST1IoIlVucmVhbGl6ZSBsdW46JXUi
LCBsdW4pOworICAgICAgICByZXR1cm4gcmM7CisgICAgfQorCisgICAgU1BJQ0VfREVCVUcoIlVu
cmVhbGl6ZSBsdW46JXUiLCBsdW4pOworICAgIHJldHVybiAwOworfQorCit2b2lkIGNkX3VzYl9i
dWxrX21zZF9mcmVlKFVzYkNkQnVsa01zZERldmljZSAqY2QpCit7CisgICAgY2Rfc2NzaV90YXJn
ZXRfZnJlZShjZC0+c2NzaV90YXJnZXQpOworICAgIGdfZnJlZShjZC0+ZGF0YV9idWYpOworICAg
IGdfZnJlZShjZCk7CisKKyAgICBTUElDRV9ERUJVRygiRnJlZSIpOworfQorCitpbnQgY2RfdXNi
X2J1bGtfbXNkX3Jlc2V0KFVzYkNkQnVsa01zZERldmljZSAqY2QpCit7CisgICAgY2Rfc2NzaV90
YXJnZXRfcmVzZXQoY2QtPnNjc2lfdGFyZ2V0KTsKKyAgICBjZF91c2JfYnVsa19tc2Rfc2V0X3N0
YXRlKGNkLCBVU0JfQ0RfU1RBVEVfQ0JXKTsKKworICAgIFNQSUNFX0RFQlVHKCJSZXNldCIpOwor
ICAgIHJldHVybiAwOworfQorCitzdGF0aWMgaW50IHBhcnNlX3VzYl9tc2RfY21kKFVzYkNkQnVs
a01zZERldmljZSAqY2QsIHVpbnQ4X3QgKmJ1ZiwgdWludDMyX3QgY2J3X2xlbikKK3sKKyAgICBz
dHJ1Y3QgVXNiQ2RDQlcgKmNidyA9IChzdHJ1Y3QgVXNiQ2RDQlcgKilidWY7CisgICAgVXNiQ2RC
dWxrTXNkUmVxdWVzdCAqdXNiX3JlcSA9ICZjZC0+dXNiX3JlcTsKKyAgICBDZFNjc2lSZXF1ZXN0
ICpzY3NpX3JlcSA9ICZ1c2JfcmVxLT5zY3NpX3JlcTsKKworICAgIGlmIChjYndfbGVuICE9IHNp
emVvZigqY2J3KSkgeworICAgICAgICBTUElDRV9FUlJPUigiQ01EOiBCYWQgQ0JXIHNpemU6JXUi
LCBjYndfbGVuKTsKKyAgICAgICAgcmV0dXJuIC0xOworICAgIH0KKyAgICBpZiAobGUzMnRvaChj
YnctPnNpZykgIT0gMHg0MzQyNTM1NSkgeyAvKiBNU0QgY29tbWFuZCBzaWduYXR1cmUgKi8KKyAg
ICAgICAgU1BJQ0VfRVJST1IoIkNNRDogQmFkIENCVyBzaWduYXR1cmU6JTA4eCIsIGxlMzJ0b2go
Y2J3LT5zaWcpKTsKKyAgICAgICAgcmV0dXJuIC0xOworICAgIH0KKyAgICBjb25zdCB1aW50OF90
IGNtZF9sZW4gPSBjYnctPmNtZF9sZW4gJiAweDFGOworICAgIGlmIChjbWRfbGVuIDwgMSB8fCBj
bWRfbGVuID4gMTYpIHsKKyAgICAgICAgU1BJQ0VfRVJST1IoIkNNRDogQmFkIENCVyBjb21tYW5k
IGxlbjolMDh4IiwgY21kX2xlbik7CisgICAgICAgIHJldHVybiAtMTsKKyAgICB9CisKKyAgICB1
c2JfcmVxLT5sdW4gPSBjYnctPmx1bjsKKyAgICB1c2JfcmVxLT51c2JfcmVxX2xlbiA9IGxlMzJ0
b2goY2J3LT5leHBfZGF0YV9sZW4pOworCisgICAgdXNiX3JlcS0+c2NzaV9pbl9sZW4gPSAwOyAv
KiBubyBkYXRhIGZyb20gc2NzaSB5ZXQgKi8KKyAgICB1c2JfcmVxLT54ZmVyX2xlbiA9IDA7IC8q
IG5vIGJ1bGtzIHRyYW5zZmVyZWQgeWV0ICovCisgICAgdXNiX3JlcS0+YnVsa19pbl9sZW4gPSAw
OyAvKiBubyBidWxrLWluIHJlcXVlc3RzIHlldCAqLworCisgICAgaWYgKHVzYl9yZXEtPnVzYl9y
ZXFfbGVuID09IDApIHsKKyAgICAgICAgY2RfdXNiX2J1bGtfbXNkX3NldF9zdGF0ZShjZCwgVVNC
X0NEX1NUQVRFX0NTVyk7IC8qIG5vIGRhdGEgLSByZXR1cm4gc3RhdHVzICovCisgICAgICAgIHNj
c2lfcmVxLT5idWYgPSBOVUxMOworICAgICAgICBzY3NpX3JlcS0+YnVmX2xlbiA9IDA7CisgICAg
fSBlbHNlIGlmIChjYnctPmZsYWdzICYgMHg4MCkgeworICAgICAgICBjZF91c2JfYnVsa19tc2Rf
c2V0X3N0YXRlKGNkLCBVU0JfQ0RfU1RBVEVfREFUQUlOKTsgLyogcmVhZCBjb21tYW5kICovCisg
ICAgICAgIHNjc2lfcmVxLT5idWYgPSBjZC0+ZGF0YV9idWY7CisgICAgICAgIHNjc2lfcmVxLT5i
dWZfbGVuID0gY2QtPmRhdGFfYnVmX2xlbjsKKyAgICB9IGVsc2UgeworICAgICAgICBjZF91c2Jf
YnVsa19tc2Rfc2V0X3N0YXRlKGNkLCBVU0JfQ0RfU1RBVEVfREFUQU9VVCk7IC8qIHdyaXRlIGNv
bW1hbmQgKi8KKyAgICAgICAgc2NzaV9yZXEtPmJ1ZiA9IE5VTEw7CisgICAgICAgIHNjc2lfcmVx
LT5idWZfbGVuID0gMDsKKyAgICB9CisKKyAgICBzY3NpX3JlcS0+Y2RiX2xlbiA9IGNtZF9sZW47
CisgICAgZ19hc3NlcnQoc2NzaV9yZXEtPmNkYl9sZW4gPD0gc2l6ZW9mKHNjc2lfcmVxLT5jZGIp
KTsKKyAgICBtZW1jcHkoc2NzaV9yZXEtPmNkYiwgY2J3LT5jbWQsIHNjc2lfcmVxLT5jZGJfbGVu
KTsKKworICAgIHNjc2lfcmVxLT5sdW4gPSB1c2JfcmVxLT5sdW47CisKKyAgICBTUElDRV9ERUJV
RygiQ01EIGx1bjoldSB0YWc6JSN4IGZsYWdzOiUwOHggIgorICAgICAgICAgICAgICAgICJjZGJf
bGVuOiV1IHJlcV9sZW46JXUiLAorICAgICAgICAgICAgICAgIHVzYl9yZXEtPmx1biwgbGUzMnRv
aChjYnctPnRhZyksIGNidy0+ZmxhZ3MsCisgICAgICAgICAgICAgICAgc2NzaV9yZXEtPmNkYl9s
ZW4sIHVzYl9yZXEtPnVzYl9yZXFfbGVuKTsKKworICAgIC8qIHByZXBhcmUgc3RhdHVzIC0gQ1NX
ICovCisgICAgdXNiX3JlcS0+Y3N3LnNpZyA9IGh0b2xlMzIoMHg1MzQyNTM1NSk7CisgICAgdXNi
X3JlcS0+Y3N3LnRhZyA9IGNidy0+dGFnOworICAgIHVzYl9yZXEtPmNzdy5yZXNpZHVlID0gMDsK
KyAgICB1c2JfcmVxLT5jc3cuc3RhdHVzID0gKHVpbnQ4X3QpVVNCX01TRF9TVEFUVVNfR09PRDsK
KworICAgIHJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCB1c2JfY2RfY21kX2RvbmUoVXNiQ2RC
dWxrTXNkRGV2aWNlICpjZCkKK3sKKyAgICBVc2JDZEJ1bGtNc2RSZXF1ZXN0ICp1c2JfcmVxID0g
JmNkLT51c2JfcmVxOworICAgIENkU2NzaVJlcXVlc3QgKnNjc2lfcmVxID0gJnVzYl9yZXEtPnNj
c2lfcmVxOworCisgICAgY2RfdXNiX2J1bGtfbXNkX3NldF9zdGF0ZShjZCwgVVNCX0NEX1NUQVRF
X0NCVyk7IC8qIENvbW1hbmQgbmV4dCAqLworICAgIGNkX3Njc2lfZGV2X3JlcXVlc3RfcmVsZWFz
ZShjZC0+c2NzaV90YXJnZXQsIHNjc2lfcmVxKTsKK30KKworc3RhdGljIHZvaWQgdXNiX2NkX3Nl
bmRfc3RhdHVzKFVzYkNkQnVsa01zZERldmljZSAqY2QpCit7CisgICAgVXNiQ2RCdWxrTXNkUmVx
dWVzdCAqdXNiX3JlcSA9ICZjZC0+dXNiX3JlcTsKKworICAgIFNQSUNFX0RFQlVHKCJDb21tYW5k
IENTVyB0YWc6MHgleCBtc2Rfc3RhdHVzOiVkIGxlbjolIiBHX0dVSU5UNjRfRk9STUFULAorICAg
ICAgICAgICAgICAgIGxlMzJ0b2godXNiX3JlcS0+Y3N3LnRhZyksIChpbnQpdXNiX3JlcS0+Y3N3
LnN0YXR1cywgc2l6ZW9mKHVzYl9yZXEtPmNzdykpOworCisgICAgdXNiX2NkX2NtZF9kb25lKGNk
KTsKKworICAgIGdfYXNzZXJ0KHVzYl9yZXEtPmNzdy5zaWcgPT0gaHRvbGUzMigweDUzNDI1MzU1
KSk7CisgICAgY2RfdXNiX2J1bGtfbXNkX3JlYWRfY29tcGxldGUoY2QtPnVzYl91c2VyX2RhdGEs
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHVpbnQ4X3QgKikmdXNiX3JlcS0+
Y3N3LCBzaXplb2YodXNiX3JlcS0+Y3N3KSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBCVUxLX1NUQVRVU19HT09EKTsKK30KKworc3RhdGljIHZvaWQgdXNiX2NkX3NlbmRfY2Fu
Y2VsZWQoVXNiQ2RCdWxrTXNkRGV2aWNlICpjZCkKK3sKKyAgICBVc2JDZEJ1bGtNc2RSZXF1ZXN0
ICp1c2JfcmVxID0gJmNkLT51c2JfcmVxOworCisgICAgU1BJQ0VfREVCVUcoIkNhbmNlbGVkIGNt
ZCB0YWc6MHgleCwgbGVuOiUiIEdfR1VJTlQ2NF9GT1JNQVQsCisgICAgICAgICAgICAgICAgbGUz
MnRvaCh1c2JfcmVxLT5jc3cudGFnKSwgc2l6ZW9mKHVzYl9yZXEtPmNzdykpOworCisgICAgdXNi
X2NkX2NtZF9kb25lKGNkKTsKKworICAgIGNkX3VzYl9idWxrX21zZF9yZWFkX2NvbXBsZXRlKGNk
LT51c2JfdXNlcl9kYXRhLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5VTEws
IDAsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQlVMS19TVEFUVVNfQ0FOQ0VM
RUQpOworfQorCitzdGF0aWMgdm9pZCB1c2JfY2Rfc2VuZF9kYXRhX2luKFVzYkNkQnVsa01zZERl
dmljZSAqY2QsIHVpbnQzMl90IG1heF9sZW4pCit7CisgICAgVXNiQ2RCdWxrTXNkUmVxdWVzdCAq
dXNiX3JlcSA9ICZjZC0+dXNiX3JlcTsKKyAgICBDZFNjc2lSZXF1ZXN0ICpzY3NpX3JlcSA9ICZ1
c2JfcmVxLT5zY3NpX3JlcTsKKyAgICB1aW50OF90ICpidWYgPSAoKHVpbnQ4X3QgKilzY3NpX3Jl
cS0+YnVmKSArIHVzYl9yZXEtPnhmZXJfbGVuOworICAgIHVpbnQzMl90IGF2YWlsX2xlbiA9IHVz
Yl9yZXEtPnNjc2lfaW5fbGVuIC0gdXNiX3JlcS0+eGZlcl9sZW47CisgICAgdWludDMyX3Qgc2Vu
ZF9sZW4gPSBNSU4oYXZhaWxfbGVuLCBtYXhfbGVuKTsKKworICAgIFNQSUNFX0RFQlVHKCJEYXRh
LWluIGNtZCB0YWcgMHgleCwgcmVtYWlucyAldSIKKyAgICAgICAgICAgICAgICAiLCByZXF1ZXN0
ZWQgJXUsIHNlbmQgJXUiLAorICAgICAgICAgICAgICAgIHVzYl9yZXEtPmNzdy50YWcsIGF2YWls
X2xlbiwgbWF4X2xlbiwgc2VuZF9sZW4pOworCisgICAgZ19hc3NlcnQobWF4X2xlbiA8PSB1c2Jf
cmVxLT51c2JfcmVxX2xlbik7CisKKyAgICBjZF91c2JfYnVsa19tc2RfcmVhZF9jb21wbGV0ZShj
ZC0+dXNiX3VzZXJfZGF0YSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidWYs
IHNlbmRfbGVuLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEJVTEtfU1RBVFVT
X0dPT0QpOworCisgICAgaWYgKHNjc2lfcmVxLT5zdGF0dXMgPT0gR09PRCkgeworICAgICAgICB1
c2JfcmVxLT54ZmVyX2xlbiArPSBzZW5kX2xlbjsKKyAgICAgICAgaWYgKHVzYl9yZXEtPnhmZXJf
bGVuID09IHVzYl9yZXEtPnNjc2lfaW5fbGVuKSB7CisgICAgICAgICAgICAvKiBhbGwgZGF0YSBm
b3IgdGhpcyBidWxrIGhhcyBiZWVuIHRyYW5zZmVycmVkICovCisgICAgICAgICAgICBpZiAodXNi
X3JlcS0+c2NzaV9pbl9sZW4gPT0gdXNiX3JlcS0+dXNiX3JlcV9sZW4gfHwgLyogcmVxIGZ1bGx5
IHNhdGlzZmllZCAqLworICAgICAgICAgICAgICAgIHNlbmRfbGVuIDwgbWF4X2xlbikgeyAvKiBw
YXJ0aWFsIGJ1bGsgLSBubyBtb3JlIGRhdGEgKi8KKyAgICAgICAgICAgICAgICBjZF91c2JfYnVs
a19tc2Rfc2V0X3N0YXRlKGNkLCBVU0JfQ0RfU1RBVEVfQ1NXKTsKKyAgICAgICAgICAgIH0gZWxz
ZSB7CisgICAgICAgICAgICAgICAgLyogcGFydGlhbCBjbWQgZGF0YSBmdWxsZmlsbGVkIGVudGly
ZSB2dWxrLWluIHJlcXVlc3QgKi8KKyAgICAgICAgICAgICAgICBjZF91c2JfYnVsa19tc2Rfc2V0
X3N0YXRlKGNkLCBVU0JfQ0RfU1RBVEVfWkVST19EQVRBSU4pOworICAgICAgICAgICAgfQorICAg
ICAgICB9CisgICAgfSBlbHNlIHsgLyogY21kIGZhaWxlZCAtIG5vIG1vcmUgZGF0YSAqLworICAg
ICAgICBjZF91c2JfYnVsa19tc2Rfc2V0X3N0YXRlKGNkLCBVU0JfQ0RfU1RBVEVfQ1NXKTsKKyAg
ICB9Cit9CisKK2ludCBjZF91c2JfYnVsa19tc2RfcmVhZChVc2JDZEJ1bGtNc2REZXZpY2UgKmNk
LCB1aW50MzJfdCBtYXhfbGVuKQoreworICAgIFVzYkNkQnVsa01zZFJlcXVlc3QgKnVzYl9yZXEg
PSAmY2QtPnVzYl9yZXE7CisgICAgQ2RTY3NpUmVxdWVzdCAqc2NzaV9yZXEgPSAmdXNiX3JlcS0+
c2NzaV9yZXE7CisKKyAgICBTUElDRV9ERUJVRygibXNkX3JlYWQsIHN0YXRlOiAlcywgbGVuICV1
IiwKKyAgICAgICAgICAgICAgICB1c2JfY2Rfc3RhdGVfc3RyKGNkLT5zdGF0ZSksIG1heF9sZW4p
OworCisgICAgc3dpdGNoIChjZC0+c3RhdGUpIHsKKyAgICBjYXNlIFVTQl9DRF9TVEFURV9DU1c6
IC8qIENvbW1hbmQgU3RhdHVzICovCisgICAgICAgIGlmIChtYXhfbGVuIDwgMTMpIHsKKyAgICAg
ICAgICAgIGdvdG8gZmFpbDsKKyAgICAgICAgfQorICAgICAgICBpZiAoY2Rfc2NzaV9nZXRfcmVx
X3N0YXRlKHNjc2lfcmVxKSA9PSBTQ1NJX1JFUV9DT01QTEVURSkgeworICAgICAgICAgICAgdXNi
X2NkX3NlbmRfc3RhdHVzKGNkKTsKKyAgICAgICAgfSBlbHNlIHsKKyAgICAgICAgICAgIHVzYl9y
ZXEtPmJ1bGtfaW5fbGVuICs9IG1heF9sZW47CisgICAgICAgICAgICBTUElDRV9ERUJVRygibXNk
X3JlYWQgQ1NXLCByZXEgaW5jb21wbGV0ZSwgYWRkZWQgbGVuICV1IgorICAgICAgICAgICAgICAg
ICAgICAgICAgIiBzYXZlZCBsZW4gJXUiLAorICAgICAgICAgICAgICAgICAgICAgICAgbWF4X2xl
biwgdXNiX3JlcS0+YnVsa19pbl9sZW4pOworICAgICAgICB9CisgICAgICAgIGJyZWFrOworCisg
ICAgY2FzZSBVU0JfQ0RfU1RBVEVfREFUQUlOOiAvKiBCdWxrIERhdGEtSU4gKi8KKyAgICAgICAg
aWYgKGNkX3Njc2lfZ2V0X3JlcV9zdGF0ZShzY3NpX3JlcSkgPT0gU0NTSV9SRVFfQ09NUExFVEUp
IHsKKyAgICAgICAgICAgIHVzYl9jZF9zZW5kX2RhdGFfaW4oY2QsIG1heF9sZW4pOworICAgICAg
ICB9IGVsc2UgeworICAgICAgICAgICAgdXNiX3JlcS0+YnVsa19pbl9sZW4gKz0gbWF4X2xlbjsK
KyAgICAgICAgICAgIFNQSUNFX0RFQlVHKCJtc2RfcmVhZCBEQVRBSU4sIHJlcSBpbmNvbXBsZXRl
LCBhZGRlZCBsZW4gJXUgc2F2ZWQgbGVuICV1IiwKKyAgICAgICAgICAgICAgICAgICAgICAgIG1h
eF9sZW4sIHVzYl9yZXEtPmJ1bGtfaW5fbGVuKTsKKyAgICAgICAgfQorICAgICAgICBicmVhazsK
KworICAgIGNhc2UgVVNCX0NEX1NUQVRFX1pFUk9fREFUQUlOOgorICAgICAgICBjZF91c2JfYnVs
a19tc2RfcmVhZF9jb21wbGV0ZShjZC0+dXNiX3VzZXJfZGF0YSwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgTlVMTCwgMCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgQlVMS19TVEFUVVNfR09PRCk7CisgICAgICAgIGNkX3VzYl9idWxrX21zZF9z
ZXRfc3RhdGUoY2QsIFVTQl9DRF9TVEFURV9DU1cpOyAvKiBTdGF0dXMgbmV4dCAqLworICAgICAg
ICBicmVhazsKKworICAgIGRlZmF1bHQ6CisgICAgICAgIFNQSUNFX0VSUk9SKCJVbmV4cGVjdGVk
IHJlYWQgc3RhdGU6ICVzLCBsZW4gJXUiLAorICAgICAgICAgICAgICAgICAgICB1c2JfY2Rfc3Rh
dGVfc3RyKGNkLT5zdGF0ZSksIG1heF9sZW4pOworICAgICAgICBnb3RvIGZhaWw7CisgICAgfQor
ICAgIHJldHVybiAwOworCitmYWlsOgorICAgIHJldHVybiAtMTsKK30KKwordm9pZCBjZF9zY3Np
X2Rldl9yZXF1ZXN0X2NvbXBsZXRlKHZvaWQgKnRhcmdldF91c2VyX2RhdGEsIENkU2NzaVJlcXVl
c3QgKnNjc2lfcmVxKQoreworICAgIFVzYkNkQnVsa01zZERldmljZSAqY2QgPSAoVXNiQ2RCdWxr
TXNkRGV2aWNlICopdGFyZ2V0X3VzZXJfZGF0YTsKKyAgICBVc2JDZEJ1bGtNc2RSZXF1ZXN0ICp1
c2JfcmVxID0gJmNkLT51c2JfcmVxOworCisgICAgZ19hc3NlcnQoc2NzaV9yZXEgPT0gJnVzYl9y
ZXEtPnNjc2lfcmVxKTsKKworICAgIGlmIChzY3NpX3JlcS0+cmVxX3N0YXRlID09IFNDU0lfUkVR
X0NPTVBMRVRFKSB7CisKKyAgICAgICAgdXNiX3JlcS0+c2NzaV9pbl9sZW4gPSAoc2NzaV9yZXEt
PmluX2xlbiA8PSB1c2JfcmVxLT51c2JfcmVxX2xlbikgPworICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBzY3NpX3JlcS0+aW5fbGVuIDogdXNiX3JlcS0+dXNiX3JlcV9sZW47CisKKyAg
ICAgICAgLyogcHJlcGFyZSBDU1cgKi8KKyAgICAgICAgaWYgKHVzYl9yZXEtPnVzYl9yZXFfbGVu
ID4gdXNiX3JlcS0+c2NzaV9pbl9sZW4pIHsKKyAgICAgICAgICAgIHVzYl9yZXEtPmNzdy5yZXNp
ZHVlID0gaHRvbGUzMih1c2JfcmVxLT51c2JfcmVxX2xlbiAtIHVzYl9yZXEtPnNjc2lfaW5fbGVu
KTsKKyAgICAgICAgfQorICAgICAgICBpZiAoc2NzaV9yZXEtPnN0YXR1cyAhPSBHT09EKSB7Cisg
ICAgICAgICAgICB1c2JfcmVxLT5jc3cuc3RhdHVzID0gKHVpbnQ4X3QpVVNCX01TRF9TVEFUVVNf
RkFJTEVEOworICAgICAgICB9CisKKyAgICAgICAgaWYgKHVzYl9yZXEtPmJ1bGtfaW5fbGVuKSB7
CisgICAgICAgICAgICAvKiBidWxrLWluIHJlcXVlc3QgYXJyaXZlZCB3aGlsZSBzY3NpIHdhcyBz
dGlsbCBydW5uaW5nICovCisgICAgICAgICAgICBpZiAoY2QtPnN0YXRlID09IFVTQl9DRF9TVEFU
RV9EQVRBSU4pIHsKKyAgICAgICAgICAgICAgICB1c2JfY2Rfc2VuZF9kYXRhX2luKGNkLCB1c2Jf
cmVxLT5idWxrX2luX2xlbik7CisgICAgICAgICAgICB9IGVsc2UgaWYgKGNkLT5zdGF0ZSA9PSBV
U0JfQ0RfU1RBVEVfQ1NXKSB7CisgICAgICAgICAgICAgICAgdXNiX2NkX3NlbmRfc3RhdHVzKGNk
KTsKKyAgICAgICAgICAgIH0KKyAgICAgICAgICAgIHVzYl9yZXEtPmJ1bGtfaW5fbGVuID0gMDsK
KyAgICAgICAgfQorICAgIH0gZWxzZSBpZiAoc2NzaV9yZXEtPnJlcV9zdGF0ZSA9PSBTQ1NJX1JF
UV9DQU5DRUxFRCkgeworICAgICAgICB1c2JfY2Rfc2VuZF9jYW5jZWxlZChjZCk7CisgICAgfSBl
bHNlIHsKKyAgICAgICAgZ19hc3NlcnQoc2NzaV9yZXEtPnJlcV9zdGF0ZSA9PSBTQ1NJX1JFUV9E
SVNQT1NFRCk7CisgICAgICAgIFNQSUNFX0RFQlVHKCJEaXNwb3NlZCBjbWQgdGFnOjB4JXgsIGxl
bjolIiBHX0dVSU5UNjRfRk9STUFULAorICAgICAgICAgICAgICAgIGxlMzJ0b2godXNiX3JlcS0+
Y3N3LnRhZyksIHNpemVvZih1c2JfcmVxLT5jc3cpKTsKKyAgICAgICAgdXNiX2NkX2NtZF9kb25l
KGNkKTsKKyAgICB9Cit9CisKK2ludCBjZF91c2JfYnVsa19tc2RfY2FuY2VsX3JlYWQoVXNiQ2RC
dWxrTXNkRGV2aWNlICpjZCkKK3sKKyAgICBVc2JDZEJ1bGtNc2RSZXF1ZXN0ICp1c2JfcmVxID0g
JmNkLT51c2JfcmVxOworICAgIENkU2NzaVJlcXVlc3QgKnNjc2lfcmVxID0gJnVzYl9yZXEtPnNj
c2lfcmVxOworCisgICAgY2Rfc2NzaV9kZXZfcmVxdWVzdF9jYW5jZWwoY2QtPnNjc2lfdGFyZ2V0
LCBzY3NpX3JlcSk7CisgICAgcmV0dXJuIDA7Cit9CisKK2ludCBjZF91c2JfYnVsa19tc2Rfd3Jp
dGUoVXNiQ2RCdWxrTXNkRGV2aWNlICpjZCwgdWludDhfdCAqYnVmX291dCwgdWludDMyX3QgYnVm
X291dF9sZW4pCit7CisgICAgc3dpdGNoIChjZC0+c3RhdGUpIHsKKyAgICBjYXNlIFVTQl9DRF9T
VEFURV9DQlc6IC8qIENvbW1hbmQgQmxvY2sgKi8KKyAgICAgICAgcGFyc2VfdXNiX21zZF9jbWQo
Y2QsIGJ1Zl9vdXQsIGJ1Zl9vdXRfbGVuKTsKKyAgICAgICAgaWYgKGNkLT5zdGF0ZSA9PSBVU0Jf
Q0RfU1RBVEVfREFUQUlOIHx8IGNkLT5zdGF0ZSA9PSBVU0JfQ0RfU1RBVEVfQ1NXKSB7CisgICAg
ICAgICAgICBjZF9zY3NpX2Rldl9yZXF1ZXN0X3N1Ym1pdChjZC0+c2NzaV90YXJnZXQsICZjZC0+
dXNiX3JlcS5zY3NpX3JlcSk7CisgICAgICAgIH0KKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBV
U0JfQ0RfU1RBVEVfREFUQU9VVDogLyogRGF0YS1PdXQgZm9yIGEgV3JpdGUgY21kICovCisgICAg
ICAgIGNkLT51c2JfcmVxLnNjc2lfcmVxLmJ1ZiA9IGJ1Zl9vdXQ7CisgICAgICAgIGNkLT51c2Jf
cmVxLnNjc2lfcmVxLmJ1Zl9sZW4gPSBidWZfb3V0X2xlbjsKKyAgICAgICAgY2Rfc2NzaV9kZXZf
cmVxdWVzdF9zdWJtaXQoY2QtPnNjc2lfdGFyZ2V0LCAmY2QtPnVzYl9yZXEuc2NzaV9yZXEpOwor
ICAgICAgICBjZF91c2JfYnVsa19tc2Rfc2V0X3N0YXRlKGNkLCBVU0JfQ0RfU1RBVEVfQ1NXKTsg
LyogU3RhdHVzIG5leHQgKi8KKyAgICAgICAgYnJlYWs7CisgICAgZGVmYXVsdDoKKyAgICAgICAg
U1BJQ0VfREVCVUcoIlVuZXhwZWN0ZWQgd3JpdGUgc3RhdGU6ICVzLCBsZW4gJXUiLAorICAgICAg
ICAgICAgICAgICAgICB1c2JfY2Rfc3RhdGVfc3RyKGNkLT5zdGF0ZSksIGJ1Zl9vdXRfbGVuKTsK
KyAgICAgICAgZ290byBmYWlsOworICAgIH0KKyAgICByZXR1cm4gMDsKKworZmFpbDoKKyAgICBy
ZXR1cm4gLTE7Cit9CisKK3ZvaWQgY2Rfc2NzaV9kZXZfcmVzZXRfY29tcGxldGUodm9pZCAqdGFy
Z2V0X3VzZXJfZGF0YSwgdWludDMyX3QgbHVuKQoreworICAgIFVzYkNkQnVsa01zZERldmljZSAq
Y2QgPSAoVXNiQ2RCdWxrTXNkRGV2aWNlICopdGFyZ2V0X3VzZXJfZGF0YTsKKworICAgIGlmIChj
ZC0+c3RhdGUgPT0gVVNCX0NEX1NUQVRFX0RFVklDRV9SRVNFVCkgeworICAgICAgICBjZF91c2Jf
YnVsa19tc2Rfc2V0X3N0YXRlKGNkLCBVU0JfQ0RfU1RBVEVfQ0JXKTsKKyAgICAgICAgY2RfdXNi
X2J1bGtfbXNkX3Jlc2V0X2NvbXBsZXRlKGNkLT51c2JfdXNlcl9kYXRhLCAwKTsKKyAgICB9Cit9
CisKK3ZvaWQgY2Rfc2NzaV90YXJnZXRfcmVzZXRfY29tcGxldGUodm9pZCAqdGFyZ2V0X3VzZXJf
ZGF0YSkKK3sKKyAgICBVc2JDZEJ1bGtNc2REZXZpY2UgKmNkID0gKFVzYkNkQnVsa01zZERldmlj
ZSAqKXRhcmdldF91c2VyX2RhdGE7CisgICAgY2RfdXNiX2J1bGtfbXNkX3NldF9zdGF0ZShjZCwg
VVNCX0NEX1NUQVRFX0lOSVQpOworfQorCit2b2lkIGNkX3Njc2lfZGV2X2NoYW5nZWQodm9pZCAq
dGFyZ2V0X3VzZXJfZGF0YSwgdWludDMyX3QgbHVuKQoreworICAgIFVzYkNkQnVsa01zZERldmlj
ZSAqY2QgPSAoVXNiQ2RCdWxrTXNkRGV2aWNlICopdGFyZ2V0X3VzZXJfZGF0YTsKKyAgICBTUElD
RV9ERUJVRygiRGV2aWNlIGNoYW5nZWQsIHN0YXRlOiAlcyBsdW46ICV1IiwKKyAgICAgICAgICAg
ICAgICB1c2JfY2Rfc3RhdGVfc3RyKGNkLT5zdGF0ZSksIGx1bik7CisgICAgY2RfdXNiX2J1bGtf
bXNkX2x1bl9jaGFuZ2VkKGNkLT51c2JfdXNlcl9kYXRhLCBsdW4pOworfQorCisjZW5kaWYgLyog
VVNFX1VTQlJFRElSICovCmRpZmYgLS1naXQgYS9zcmMvY2QtdXNiLWJ1bGstbXNkLmggYi9zcmMv
Y2QtdXNiLWJ1bGstbXNkLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMC4uYzE2
NWMxOAotLS0gL2Rldi9udWxsCisrKyBiL3NyYy9jZC11c2ItYnVsay1tc2QuaApAQCAtMCwwICsx
LDEzMSBAQAorLyogLSotIE1vZGU6IEM7IGMtYmFzaWMtb2Zmc2V0OiA0OyBpbmRlbnQtdGFicy1t
b2RlOiBuaWwgLSotICovCisvKgorICAgIENvcHlyaWdodCAoQykgMjAxOCBSZWQgSGF0LCBJbmMu
CisKKyAgICBSZWQgSGF0IEF1dGhvcnM6CisgICAgQWxleGFuZGVyIE5lemhpbnNreTxhbmV6aGlu
c0ByZWRoYXQuY29tPgorCisgICAgVGhpcyBsaWJyYXJ5IGlzIGZyZWUgc29mdHdhcmU7IHlvdSBj
YW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vcgorICAgIG1vZGlmeSBpdCB1bmRlciB0aGUgdGVybXMg
b2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKKyAgICBMaWNlbnNlIGFzIHB1Ymxpc2hl
ZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIKKyAgICB2ZXJzaW9uIDIu
MSBvZiB0aGUgTGljZW5zZSwgb3IgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4K
KworICAgIFRoaXMgbGlicmFyeSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdp
bGwgYmUgdXNlZnVsLAorICAgIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVu
IHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCisgICAgTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1Mg
Rk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZSBHTlUKKyAgICBMZXNzZXIgR2VuZXJh
bCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgorCisgICAgWW91IHNob3VsZCBoYXZl
IHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYworICAgIExp
Y2Vuc2UgYWxvbmcgd2l0aCB0aGlzIGxpYnJhcnk7IGlmIG5vdCwgc2VlIDxodHRwOi8vd3d3Lmdu
dS5vcmcvbGljZW5zZXMvPi4KKyovCisKKyNwcmFnbWEgb25jZQorCisjaW5jbHVkZSA8Z2lvL2dp
by5oPgorCisjaW5jbHVkZSAiY2Qtc2NzaS1kZXYtcGFyYW1zLmgiCisKK0dfQkVHSU5fREVDTFMK
KwordHlwZWRlZiBlbnVtIENkVXNiQnVsa1N0YXR1cyB7CisgICAgQlVMS19TVEFUVVNfR09PRCA9
IDAsCisgICAgQlVMS19TVEFUVVNfRVJST1IsCisgICAgQlVMS19TVEFUVVNfQ0FOQ0VMRUQsCisg
ICAgQlVMS19TVEFUVVNfU1RBTEwsCit9IENkVXNiQnVsa1N0YXR1czsKKwordHlwZWRlZiBzdHJ1
Y3QgVXNiQ2RCdWxrTXNkRGV2aWNlIFVzYkNkQnVsa01zZERldmljZTsKKworLyogVVNCIGJhY2tl
bmQgY2FsbGJhY2tzICovCisKKy8qIGNhbGxlZCBvbiBjb21wbGV0ZWQgcmVhZCBkYXRhIGJ1bGsg
dHJhbnNmZXIKKyAqIHVzZXJfZGF0YSAtIHVzZXJfZGF0YSBpbiB1bml0IHBhcmFtZXRlcnMgc3Ry
dWN0dXJlCisgKiBzdGF0dXMgLSBidWxrIHN0YXR1cyBjb2RlCisgKi8KK3ZvaWQgY2RfdXNiX2J1
bGtfbXNkX3JlYWRfY29tcGxldGUodm9pZCAqdXNlcl9kYXRhLAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICB1aW50OF90ICpkYXRhLCB1aW50MzJfdCBsZW5ndGgsCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIENkVXNiQnVsa1N0YXR1cyBzdGF0dXMpOworCisv
KiBjYWxsZWQgd2hlbiBzdGF0ZSBvZiBkZXZpY2UncyB1bml0IGNoYW5nZWQgdG8gc2lnbmFsIEdV
SSBjb21wb25lbnQKKyAqICB1c2VyX2RhdGEgLSB1c2VyX2RhdGEgaW4gdW5pdCBwYXJhbWV0ZXJz
IHN0cnVjdHVyZQorICovCit2b2lkIGNkX3VzYl9idWxrX21zZF9sdW5fY2hhbmdlZCh2b2lkICp1
c2VyX2RhdGEsIHVpbnQzMl90IGx1bik7CisKKy8qIGNhbGxlZCBvbiBjb21wbGV0ZWQgZGV2aWNl
IHJlc2V0CisgKiB1c2VyX2RhdGEgLSB1c2VyX2RhdGEgaW4gdW5pdCBwYXJhbWV0ZXJzIHN0cnVj
dHVyZQorICogc3RhdHVzIC0gZXJyb3IgY29kZQorICovCit2b2lkIGNkX3VzYl9idWxrX21zZF9y
ZXNldF9jb21wbGV0ZSh2b2lkICp1c2VyX2RhdGEsCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBpbnQgc3RhdHVzKTsKKworLyogTVNEIGJhY2tlbmQgYXBpICovCisKKy8qIGFs
bG9jYXRlIG5ldyBkZXZpY2UgZGVzY3JpcHRvciAqLworVXNiQ2RCdWxrTXNkRGV2aWNlICpjZF91
c2JfYnVsa19tc2RfYWxsb2Modm9pZCAqdXNlcl9kYXRhLCB1aW50MzJfdCBtYXhfbHVuKTsKKwor
LyogZnJlZSBkZXZpY2UgZGVzY3JpcHRvciAqLwordm9pZCBjZF91c2JfYnVsa19tc2RfZnJlZShV
c2JDZEJ1bGtNc2REZXZpY2UgKmRldmljZSk7CisKKy8qIGNvbmZpZ3VyZSBhIG5ldyBMb2dpY2Fs
IFVuaXQgdG8gYmUgcmVwcmVzZW4gdGVkIGJ5IHRoZSBkZXZpY2UKKyAqICByZXR1cm5zOiBlcnJv
ciBjb2RlCisgKi8KK2ludCBjZF91c2JfYnVsa19tc2RfcmVhbGl6ZShVc2JDZEJ1bGtNc2REZXZp
Y2UgKmRldmljZSwgdWludDMyX3QgbHVuLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNv
bnN0IENkU2NzaURldmljZVBhcmFtZXRlcnMgKmRldl9wYXJhbXMpOworCisvKiBsb2NrIHRoZSBk
ZXZpY2UsIHByZXZlbnQgdW5sb2FkaW5nCisgKiByZXR1cm5zOiBlcnJvciBjb2RlCisgKi8KK2lu
dCBjZF91c2JfYnVsa19tc2RfbG9jayhVc2JDZEJ1bGtNc2REZXZpY2UgKmRldmljZSwgdWludDMy
X3QgbHVuLCBnYm9vbGVhbiBsb2NrKTsKKworLyogbG9hZCBuZXcgbWVkaWEsIGlmIGFscmVhZHkg
bG9hZGVkLCBzaW11bGF0ZSBtZWRpYSBjaGFuZ2UKKyAqIHJldHVybnM6IGVycm9yIGNvZGUKKyAq
LworaW50IGNkX3VzYl9idWxrX21zZF9sb2FkKFVzYkNkQnVsa01zZERldmljZSAqZGV2aWNlLCB1
aW50MzJfdCBsdW4sCisgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgQ2RTY3NpTWVkaWFQ
YXJhbWV0ZXJzICptZWRpYV9wYXJhbXMpOworCisvKiBxdWVyeSB1bml0IHBhcmFtZXRlcnMgYW5k
IHN0YXR1cworICogcmV0dXJuczogZXJyb3IgY29kZQorICovCitpbnQgY2RfdXNiX2J1bGtfbXNk
X2dldF9pbmZvKFVzYkNkQnVsa01zZERldmljZSAqZGV2aWNlLCB1aW50MzJfdCBsdW4sCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIENkU2NzaURldmljZUluZm8gKmx1bl9pbmZvKTsKKwor
LyogdW5sb2FkIHRoZSBtZWRpYQorICogcmV0dXJuczogZXJyb3IgY29kZQorICovCitpbnQgY2Rf
dXNiX2J1bGtfbXNkX3VubG9hZChVc2JDZEJ1bGtNc2REZXZpY2UgKmRldmljZSwgdWludDMyX3Qg
bHVuKTsKKworLyogZGV0YWNoIGEgTG9naWNhbCBVbml0CisgKiByZXR1cm5zOiBlcnJvciBjb2Rl
CisgKi8KK2ludCBjZF91c2JfYnVsa19tc2RfdW5yZWFsaXplKFVzYkNkQnVsa01zZERldmljZSAq
ZGV2aWNlLCB1aW50MzJfdCBsdW4pOworCisvKiByZXNldCB0aGUgZGV2aWNlIGluc3RhbmNlOyBj
YW5jZWwgYWxsIElPIG9wcywgcmVzZXQgc3RhdGUKKyAqIHJldHVybnM6IGVycm9yIGNvZGUKKyAq
LworaW50IGNkX3VzYl9idWxrX21zZF9yZXNldChVc2JDZEJ1bGtNc2REZXZpY2UgKmRldmljZSk7
CisKKworLyogcGVyZm9ybSBhIHdyaXRlIGRhdGEgYnVsayB0cmFuc2ZlcgorICogZGF0YV9sZW4g
LSBsZW5ndGggb2YgYXZhaWxhYmxlIGRhdGEgdG8gd3JpdGUKKyAqIHJldHVybnM6IGVycm9yIGNv
ZGUKKyAqLworaW50IGNkX3VzYl9idWxrX21zZF93cml0ZShVc2JDZEJ1bGtNc2REZXZpY2UqZGV2
aWNlLCB1aW50OF90ICpidWYsIHVpbnQzMl90IGRhdGFfbGVuKTsKKworCisvKiBwZXJmb3JtIGEg
cmVhZCBkYXRhIGJ1bGsgdHJhbnNmZXIKKyAqIG1heF9sZW4gLSBsZW5ndGggb2YgYXZhaWxhYmxl
IGJ1ZmZlciB0byBmaWxsCisgKiBJZiBkYXRhIGF2YWlsYWJsZSBpbW1lZGlhdGVseSwgc2hvdWxk
IGNhbGwgY2RfdXNiX2J1bGtfbXNkX3JlYWRfY29tcGxldGUoKQorICogICBhbmQgcmV0dXJuIHN1
Y2Nlc3MKKyAqIElmIGZhdGFsIGVycm9yIGRldGVjdGVkIGltbWVkaWF0ZWx5LCBzaG91bGQgY2Fs
bCBjZF91c2JfYnVsa19tc2RfcmVhZF9jb21wbGV0ZSgpCisgKiAgIHdpdGggZXJyb3IgY29kZSBh
bmQgcmV0dXJuIHN1Y2Nlc3MKKyAqCisgKiByZXR1cm5zOiAwIC0gc3VjY2VzcywgLTEgLSBlcnJv
cgorICovCitpbnQgY2RfdXNiX2J1bGtfbXNkX3JlYWQoVXNiQ2RCdWxrTXNkRGV2aWNlICpkZXZp
Y2UsIHVpbnQzMl90IG1heF9sZW4pOworCisvKiBjYW5jZWxzIHBlbmRpbmcgcmVhZCBkYXRhIGJ1
bGsgdHJhbnNmZXIKKyAqIHJldHVybnM6IGVycm9yIGNvZGUKKyAqLworaW50IGNkX3VzYl9idWxr
X21zZF9jYW5jZWxfcmVhZChVc2JDZEJ1bGtNc2REZXZpY2UgKmRldmljZSk7CisKK0dfRU5EX0RF
Q0xTCmRpZmYgLS1naXQgYS9zcmMvc2NzaS1jb25zdGFudHMuaCBiL3NyYy9zY3NpLWNvbnN0YW50
cy5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAuLmE2ZDM0YTYKLS0tIC9kZXYv
bnVsbAorKysgYi9zcmMvc2NzaS1jb25zdGFudHMuaApAQCAtMCwwICsxLDMyMSBAQAorLyogLSot
IE1vZGU6IEM7IGMtYmFzaWMtb2Zmc2V0OiA0OyBpbmRlbnQtdGFicy1tb2RlOiBuaWwgLSotICov
CisvKgorICAgQ29weXJpZ2h0IChDKSAyMDE4IFJlZCBIYXQsIEluYy4KKyAgIEJhc2VkIG9uIHRo
ZSBHTGliIGhlYWRlcgorCisgICBUaGlzIGxpYnJhcnkgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNh
biByZWRpc3RyaWJ1dGUgaXQgYW5kL29yCisgICBtb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1zIG9m
IHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCisgICBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBi
eSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIKKyAgIHZlcnNpb24gMi4xIG9m
IHRoZSBMaWNlbnNlLCBvciAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgorCisg
ICBUaGlzIGxpYnJhcnkgaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJl
IHVzZWZ1bCwKKyAgIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBp
bXBsaWVkIHdhcnJhbnR5IG9mCisgICBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQ
QVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlIEdOVQorICAgTGVzc2VyIEdlbmVyYWwgUHVibGlj
IExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KKworICAgWW91IHNob3VsZCBoYXZlIHJlY2VpdmVk
IGEgY29weSBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYworICAgTGljZW5zZSBhbG9u
ZyB3aXRoIHRoaXMgbGlicmFyeTsgaWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNl
bnNlcy8+LgorKi8KKworI3ByYWdtYSBvbmNlCisKKy8qCisgKiAgICAgIFNDU0kgb3Bjb2Rlcwor
ICovCisKKyNkZWZpbmUgVEVTVF9VTklUX1JFQURZICAgICAgIDB4MDAKKyNkZWZpbmUgUkVXSU5E
ICAgICAgICAgICAgICAgIDB4MDEKKyNkZWZpbmUgUkVRVUVTVF9TRU5TRSAgICAgICAgIDB4MDMK
KyNkZWZpbmUgRk9STUFUX1VOSVQgICAgICAgICAgIDB4MDQKKyNkZWZpbmUgUkVBRF9CTE9DS19M
SU1JVFMgICAgIDB4MDUKKyNkZWZpbmUgSU5JVElBTElaRV9FTEVNRU5UX1NUQVRVUyAweDA3Cisj
ZGVmaW5lIFJFQVNTSUdOX0JMT0NLU18gICAgICAweDA3CisjZGVmaW5lIFJFQURfNiAgICAgICAg
ICAgICAgICAweDA4CisjZGVmaW5lIFdSSVRFXzYgICAgICAgICAgICAgICAweDBhCisjZGVmaW5l
IFNFVF9DQVBBQ0lUWSAgICAgICAgICAweDBiCisjZGVmaW5lIFJFQURfUkVWRVJTRSAgICAgICAg
ICAweDBmCisjZGVmaW5lIFdSSVRFX0ZJTEVNQVJLUyAgICAgICAweDEwCisjZGVmaW5lIFNQQUNF
ICAgICAgICAgICAgICAgICAweDExCisjZGVmaW5lIElOUVVJUlkgICAgICAgICAgICAgICAweDEy
CisjZGVmaW5lIFJFQ09WRVJfQlVGRkVSRURfREFUQSAweDE0CisjZGVmaW5lIE1PREVfU0VMRUNU
ICAgICAgICAgICAweDE1CisjZGVmaW5lIFJFU0VSVkUgICAgICAgICAgICAgICAweDE2CisjZGVm
aW5lIFJFTEVBU0UgICAgICAgICAgICAgICAweDE3CisjZGVmaW5lIENPUFkgICAgICAgICAgICAg
ICAgICAweDE4CisjZGVmaW5lIEVSQVNFICAgICAgICAgICAgICAgICAweDE5CisjZGVmaW5lIE1P
REVfU0VOU0UgICAgICAgICAgICAweDFhCisjZGVmaW5lIExPQURfVU5MT0FEICAgICAgICAgICAw
eDFiCisjZGVmaW5lIFNDQU4gICAgICAgICAgICAgICAgICAweDFiCisjZGVmaW5lIFNUQVJUX1NU
T1AgICAgICAgICAgICAweDFiCisjZGVmaW5lIFJFQ0VJVkVfRElBR05PU1RJQyAgICAweDFjCisj
ZGVmaW5lIFNFTkRfRElBR05PU1RJQyAgICAgICAweDFkCisjZGVmaW5lIEFMTE9XX01FRElVTV9S
RU1PVkFMICAweDFlCisjZGVmaW5lIFNFVF9XSU5ET1cgICAgICAgICAgICAweDI0CisjZGVmaW5l
IFJFQURfQ0FQQUNJVFlfMTAgICAgICAweDI1CisjZGVmaW5lIEdFVF9XSU5ET1cgICAgICAgICAg
ICAweDI1CisjZGVmaW5lIFJFQURfMTAgICAgICAgICAgICAgICAweDI4CisjZGVmaW5lIFdSSVRF
XzEwICAgICAgICAgICAgICAweDJhCisjZGVmaW5lIFNFTkQgICAgICAgICAgICAgICAgICAweDJh
CisjZGVmaW5lIFNFRUtfMTAgICAgICAgICAgICAgICAweDJiCisjZGVmaW5lIExPQ0FURV8xMCAg
ICAgICAgICAgICAweDJiCisjZGVmaW5lIFBPU0lUSU9OX1RPX0VMRU1FTlQgICAweDJiCisjZGVm
aW5lIFdSSVRFX1ZFUklGWV8xMCAgICAgICAweDJlCisjZGVmaW5lIFZFUklGWV8xMCAgICAgICAg
ICAgICAweDJmCisjZGVmaW5lIFNFQVJDSF9ISUdIICAgICAgICAgICAweDMwCisjZGVmaW5lIFNF
QVJDSF9FUVVBTCAgICAgICAgICAweDMxCisjZGVmaW5lIE9CSkVDVF9QT1NJVElPTiAgICAgICAw
eDMxCisjZGVmaW5lIFNFQVJDSF9MT1cgICAgICAgICAgICAweDMyCisjZGVmaW5lIFNFVF9MSU1J
VFMgICAgICAgICAgICAweDMzCisjZGVmaW5lIFBSRV9GRVRDSCAgICAgICAgICAgICAweDM0Cisj
ZGVmaW5lIFJFQURfUE9TSVRJT04gICAgICAgICAweDM0CisjZGVmaW5lIEdFVF9EQVRBX0JVRkZF
Ul9TVEFUVVMgMHgzNAorI2RlZmluZSBTWU5DSFJPTklaRV9DQUNIRSAgICAgMHgzNQorI2RlZmlu
ZSBMT0NLX1VOTE9DS19DQUNIRSAgICAgMHgzNgorI2RlZmluZSBJTklUSUFMSVpFX0VMRU1FTlRf
U1RBVFVTX1dJVEhfUkFOR0UgMHgzNworI2RlZmluZSBSRUFEX0RFRkVDVF9EQVRBICAgICAgMHgz
NworI2RlZmluZSBNRURJVU1fU0NBTiAgICAgICAgICAgMHgzOAorI2RlZmluZSBDT01QQVJFICAg
ICAgICAgICAgICAgMHgzOQorI2RlZmluZSBDT1BZX1ZFUklGWSAgICAgICAgICAgMHgzYQorI2Rl
ZmluZSBXUklURV9CVUZGRVIgICAgICAgICAgMHgzYgorI2RlZmluZSBSRUFEX0JVRkZFUiAgICAg
ICAgICAgMHgzYworI2RlZmluZSBVUERBVEVfQkxPQ0sgICAgICAgICAgMHgzZAorI2RlZmluZSBS
RUFEX0xPTkdfMTAgICAgICAgICAgMHgzZQorI2RlZmluZSBXUklURV9MT05HXzEwICAgICAgICAg
MHgzZgorI2RlZmluZSBDSEFOR0VfREVGSU5JVElPTiAgICAgMHg0MAorI2RlZmluZSBXUklURV9T
QU1FXzEwICAgICAgICAgMHg0MQorI2RlZmluZSBVTk1BUCAgICAgICAgICAgICAgICAgMHg0Mgor
I2RlZmluZSBSRUFEX1RPQyAgICAgICAgICAgICAgMHg0MworI2RlZmluZSBSRVBPUlRfREVOU0lU
WV9TVVBQT1JUIDB4NDQKKyNkZWZpbmUgR0VUX0NPTkZJR1VSQVRJT04gICAgIDB4NDYKKyNkZWZp
bmUgU0FOSVRJWkUgICAgICAgICAgICAgIDB4NDgKKyNkZWZpbmUgR0VUX0VWRU5UX1NUQVRVU19O
T1RJRklDQVRJT04gMHg0YQorI2RlZmluZSBMT0dfU0VMRUNUICAgICAgICAgICAgMHg0YworI2Rl
ZmluZSBMT0dfU0VOU0UgICAgICAgICAgICAgMHg0ZAorI2RlZmluZSBSRUFEX0RJU0NfSU5GT1JN
QVRJT04gMHg1MQorI2RlZmluZSBSRUFEX1RSQUNLX0lORk9STUFUSU9OIDB4NTIKKyNkZWZpbmUg
UkVTRVJWRV9UUkFDSyAgICAgICAgIDB4NTMKKyNkZWZpbmUgTU9ERV9TRUxFQ1RfMTAgICAgICAg
IDB4NTUKKyNkZWZpbmUgUkVTRVJWRV8xMCAgICAgICAgICAgIDB4NTYKKyNkZWZpbmUgUkVMRUFT
RV8xMCAgICAgICAgICAgIDB4NTcKKyNkZWZpbmUgTU9ERV9TRU5TRV8xMCAgICAgICAgIDB4NWEK
KyNkZWZpbmUgU0VORF9DVUVfU0hFRVQgICAgICAgIDB4NWQKKyNkZWZpbmUgUEVSU0lTVEVOVF9S
RVNFUlZFX0lOIDB4NWUKKyNkZWZpbmUgUEVSU0lTVEVOVF9SRVNFUlZFX09VVCAweDVmCisjZGVm
aW5lIFZBUkxFTkdUSF9DREIgICAgICAgICAweDdmCisjZGVmaW5lIFdSSVRFX0ZJTEVNQVJLU18x
NiAgICAweDgwCisjZGVmaW5lIFJFQURfUkVWRVJTRV8xNiAgICAgICAweDgxCisjZGVmaW5lIEFM
TE9XX09WRVJXUklURSAgICAgICAweDgyCisjZGVmaW5lIEVYVEVOREVEX0NPUFkgICAgICAgICAw
eDgzCisjZGVmaW5lIEFUQV9QQVNTVEhST1VHSF8xNiAgICAweDg1CisjZGVmaW5lIEFDQ0VTU19D
T05UUk9MX0lOICAgICAweDg2CisjZGVmaW5lIEFDQ0VTU19DT05UUk9MX09VVCAgICAweDg3Cisj
ZGVmaW5lIFJFQURfMTYgICAgICAgICAgICAgICAweDg4CisjZGVmaW5lIENPTVBBUkVfQU5EX1dS
SVRFICAgICAweDg5CisjZGVmaW5lIFdSSVRFXzE2ICAgICAgICAgICAgICAweDhhCisjZGVmaW5l
IFdSSVRFX1ZFUklGWV8xNiAgICAgICAweDhlCisjZGVmaW5lIFZFUklGWV8xNiAgICAgICAgICAg
ICAweDhmCisjZGVmaW5lIFBSRV9GRVRDSF8xNiAgICAgICAgICAweDkwCisjZGVmaW5lIFNQQUNF
XzE2ICAgICAgICAgICAgICAweDkxCisjZGVmaW5lIFNZTkNIUk9OSVpFX0NBQ0hFXzE2ICAweDkx
CisjZGVmaW5lIExPQ0FURV8xNiAgICAgICAgICAgICAweDkyCisjZGVmaW5lIFdSSVRFX1NBTUVf
MTYgICAgICAgICAweDkzCisjZGVmaW5lIEVSQVNFXzE2ICAgICAgICAgICAgICAweDkzCisjZGVm
aW5lIFNFUlZJQ0VfQUNUSU9OX0lOXzE2ICAweDllCisjZGVmaW5lIFdSSVRFX0xPTkdfMTYgICAg
ICAgICAweDlmCisjZGVmaW5lIFJFUE9SVF9MVU5TICAgICAgICAgICAweGEwCisjZGVmaW5lIEFU
QV9QQVNTVEhST1VHSF8xMiAgICAweGExCisjZGVmaW5lIE1BSU5URU5BTkNFX0lOICAgICAgICAw
eGEzCisjZGVmaW5lIE1BSU5URU5BTkNFX09VVCAgICAgICAweGE0CisjZGVmaW5lIE1PVkVfTUVE
SVVNICAgICAgICAgICAweGE1CisjZGVmaW5lIEVYQ0hBTkdFX01FRElVTSAgICAgICAweGE2Cisj
ZGVmaW5lIFNFVF9SRUFEX0FIRUFEICAgICAgICAweGE3CisjZGVmaW5lIFJFQURfMTIgICAgICAg
ICAgICAgICAweGE4CisjZGVmaW5lIFdSSVRFXzEyICAgICAgICAgICAgICAweGFhCisjZGVmaW5l
IFNFUlZJQ0VfQUNUSU9OX0lOXzEyICAweGFiCisjZGVmaW5lIEVSQVNFXzEyICAgICAgICAgICAg
ICAweGFjCisjZGVmaW5lIFdSSVRFX1ZFUklGWV8xMiAgICAgICAweGFlCisjZGVmaW5lIFZFUklG
WV8xMiAgICAgICAgICAgICAweGFmCisjZGVmaW5lIFNFQVJDSF9ISUdIXzEyICAgICAgICAweGIw
CisjZGVmaW5lIFNFQVJDSF9FUVVBTF8xMiAgICAgICAweGIxCisjZGVmaW5lIFNFQVJDSF9MT1df
MTIgICAgICAgICAweGIyCisjZGVmaW5lIFJFQURfRUxFTUVOVF9TVEFUVVMgICAweGI4CisjZGVm
aW5lIFNFTkRfVk9MVU1FX1RBRyAgICAgICAweGI2CisKKy8qIE1NQy1zcGVjaWZpYyBvcGNvZGUg
YXNzaWdubWVudCAqLworI2RlZmluZSBNTUNfU0VORF9FVkVOVCAgICAgICAgICAweGEyCisjZGVm
aW5lIE1NQ19TRU5EX0tFWSAgICAgICAgICAgIDB4YTMKKyNkZWZpbmUgTU1DX1JFUE9SVF9LRVkg
ICAgICAgICAgMHhhNAorI2RlZmluZSBNTUNfR0VUX1BFUkZPUk1BTkNFICAgICAweGFjCisjZGVm
aW5lIE1NQ19SRUFEX0RWRF9TVFJVQ1RVUkUgIDB4YWQKKyNkZWZpbmUgTU1DX1JFQURfREVGRUNU
X0RBVEFfMTIgMHhiNworI2RlZmluZSBNTUNfU0VUX0NEX1NQRUVEICAgICAgICAweGJiCisjZGVm
aW5lIE1NQ19NRUNIQU5JU01fU1RBVFVTICAgIDB4YmQKKyNkZWZpbmUgTU1DX1JFQURfQ0QgICAg
ICAgICAgICAgMHhiZQorI2RlZmluZSBNTUNfU0VORF9EVkRfU1RSVUNUVVJFICAweGJmCisKKy8q
CisgKiBTRVJWSUNFIEFDVElPTiBJTiBzdWJjb2RlcworICovCisjZGVmaW5lIFNBSV9SRUFEX0NB
UEFDSVRZXzE2ICAweDEwCisKKy8qCisgKiBSRUFEIFBPU0lUSU9OIHNlcnZpY2UgYWN0aW9uIGNv
ZGVzCisgKi8KKyNkZWZpbmUgU0hPUlRfRk9STV9CTE9DS19JRCAgMHgwMAorI2RlZmluZSBTSE9S
VF9GT1JNX1ZFTkRPUl9TUEVDSUZJQyAweDAxCisjZGVmaW5lIExPTkdfRk9STSAgICAgICAgICAg
IDB4MDYKKyNkZWZpbmUgRVhURU5ERURfRk9STSAgICAgICAgMHgwOAorCisvKgorICogIFNBTSBT
dGF0dXMgY29kZXMKKyAqLworCisjZGVmaW5lIEdPT0QgICAgICAgICAgICAgICAgIDB4MDAKKyNk
ZWZpbmUgQ0hFQ0tfQ09ORElUSU9OICAgICAgMHgwMgorI2RlZmluZSBDT05ESVRJT05fR09PRCAg
ICAgICAweDA0CisjZGVmaW5lIEJVU1kgICAgICAgICAgICAgICAgIDB4MDgKKyNkZWZpbmUgSU5U
RVJNRURJQVRFX0dPT0QgICAgMHgxMAorI2RlZmluZSBJTlRFUk1FRElBVEVfQ19HT09EICAweDE0
CisjZGVmaW5lIFJFU0VSVkFUSU9OX0NPTkZMSUNUIDB4MTgKKyNkZWZpbmUgQ09NTUFORF9URVJN
SU5BVEVEICAgMHgyMgorI2RlZmluZSBUQVNLX1NFVF9GVUxMICAgICAgICAweDI4CisjZGVmaW5l
IEFDQV9BQ1RJVkUgICAgICAgICAgIDB4MzAKKyNkZWZpbmUgVEFTS19BQk9SVEVEICAgICAgICAg
MHg0MAorCisjZGVmaW5lIFNUQVRVU19NQVNLICAgICAgICAgIDB4M2UKKworLyoKKyAqICBTRU5T
RSBLRVlTCisgKi8KKworI2RlZmluZSBOT19TRU5TRSAgICAgICAgICAgIDB4MDAKKyNkZWZpbmUg
UkVDT1ZFUkVEX0VSUk9SICAgICAweDAxCisjZGVmaW5lIE5PVF9SRUFEWSAgICAgICAgICAgMHgw
MgorI2RlZmluZSBNRURJVU1fRVJST1IgICAgICAgIDB4MDMKKyNkZWZpbmUgSEFSRFdBUkVfRVJS
T1IgICAgICAweDA0CisjZGVmaW5lIElMTEVHQUxfUkVRVUVTVCAgICAgMHgwNQorI2RlZmluZSBV
TklUX0FUVEVOVElPTiAgICAgIDB4MDYKKyNkZWZpbmUgREFUQV9QUk9URUNUICAgICAgICAweDA3
CisjZGVmaW5lIEJMQU5LX0NIRUNLICAgICAgICAgMHgwOAorI2RlZmluZSBDT1BZX0FCT1JURUQg
ICAgICAgIDB4MGEKKyNkZWZpbmUgQUJPUlRFRF9DT01NQU5EICAgICAweDBiCisjZGVmaW5lIFZP
TFVNRV9PVkVSRkxPVyAgICAgMHgwZAorI2RlZmluZSBNSVNDT01QQVJFICAgICAgICAgIDB4MGUK
KworCisvKgorICogIERFVklDRSBUWVBFUworICovCisKKyNkZWZpbmUgVFlQRV9ESVNLICAgICAg
ICAgICAweDAwCisjZGVmaW5lIFRZUEVfVEFQRSAgICAgICAgICAgMHgwMQorI2RlZmluZSBUWVBF
X1BSSU5URVIgICAgICAgIDB4MDIKKyNkZWZpbmUgVFlQRV9QUk9DRVNTT1IgICAgICAweDAzICAg
IC8qIEhQIHNjYW5uZXJzIHVzZSB0aGlzICovCisjZGVmaW5lIFRZUEVfV09STSAgICAgICAgICAg
MHgwNCAgICAvKiBUcmVhdGVkIGFzIFJPTSBieSBvdXIgc3lzdGVtICovCisjZGVmaW5lIFRZUEVf
Uk9NICAgICAgICAgICAgMHgwNQorI2RlZmluZSBUWVBFX1NDQU5ORVIgICAgICAgIDB4MDYKKyNk
ZWZpbmUgVFlQRV9NT0QgICAgICAgICAgICAweDA3ICAgIC8qIE1hZ25ldG8tb3B0aWNhbCBkaXNr
IC0KKwkJCQkgICAgICogLSB0cmVhdGVkIGFzIFRZUEVfRElTSyAqLworI2RlZmluZSBUWVBFX01F
RElVTV9DSEFOR0VSIDB4MDgKKyNkZWZpbmUgVFlQRV9TVE9SQUdFX0FSUkFZICAweDBjICAgIC8q
IFN0b3JhZ2UgYXJyYXkgZGV2aWNlICovCisjZGVmaW5lIFRZUEVfRU5DTE9TVVJFICAgICAgMHgw
ZCAgICAvKiBFbmNsb3N1cmUgU2VydmljZXMgRGV2aWNlICovCisjZGVmaW5lIFRZUEVfUkJDICAg
ICAgICAgICAgMHgwZSAgICAvKiBTaW1wbGlmaWVkIERpcmVjdC1BY2Nlc3MgRGV2aWNlICovCisj
ZGVmaW5lIFRZUEVfT1NEICAgICAgICAgICAgMHgxMSAgICAvKiBPYmplY3Qtc3RvcmFnZSBEZXZp
Y2UgKi8KKyNkZWZpbmUgVFlQRV9XTFVOICAgICAgICAgICAweDFlICAgIC8qIFdlbGwga25vd24g
TFVOICovCisjZGVmaW5lIFRZUEVfTk9UX1BSRVNFTlQgICAgMHgxZgorI2RlZmluZSBUWVBFX0lO
QUNUSVZFICAgICAgIDB4MjAKKyNkZWZpbmUgVFlQRV9OT19MVU4gICAgICAgICAweDdmCisKKy8q
IE1vZGUgcGFnZSBjb2RlcyBmb3IgbW9kZSBzZW5zZS9zZXQgKi8KKyNkZWZpbmUgTU9ERV9QQUdF
X1JfV19FUlJPUiAgICAgICAgICAgICAgICAgICAweDAxCisjZGVmaW5lIE1PREVfUEFHRV9NUlcg
ICAgICAgICAgICAgICAgICAgICAgICAgMHgwMworI2RlZmluZSBNT0RFX1BBR0VfSERfR0VPTUVU
UlkgICAgICAgICAgICAgICAgIDB4MDQKKyNkZWZpbmUgTU9ERV9QQUdFX0ZMRVhJQkxFX0RJU0tf
R0VPTUVUUlkgICAgICAweDA1IC8qIFNCQyAqLworI2RlZmluZSBNT0RFX1BBR0VfV1JJVEVfUEFS
QU1FVEVSICAgICAgICAgICAgIDB4MDUgLyogTU1DICovCisjZGVmaW5lIE1PREVfUEFHRV9DQUNI
SU5HICAgICAgICAgICAgICAgICAgICAgMHgwOAorI2RlZmluZSBNT0RFX1BBR0VfQ0RfREVWSUNF
ICAgICAgICAgICAgICAgICAgIDB4MGQKKyNkZWZpbmUgTU9ERV9QQUdFX0FVRElPX0NUTCAgICAg
ICAgICAgICAgICAgICAweDBlCisjZGVmaW5lIE1PREVfUEFHRV9QT1dFUiAgICAgICAgICAgICAg
ICAgICAgICAgMHgxYQorI2RlZmluZSBNT0RFX1BBR0VfRkFVTFRfRkFJTCAgICAgICAgICAgICAg
ICAgIDB4MWMKKyNkZWZpbmUgTU9ERV9QQUdFX1RPX1BST1RFQ1QgICAgICAgICAgICAgICAgICAw
eDFkCisjZGVmaW5lIE1PREVfUEFHRV9DQVBTX01FQ0hfU1RBVFVTICAgICAgICAgICAgMHgyYQor
I2RlZmluZSBNT0RFX1BBR0VfTVJXX1ZFTkRPUiAgICAgICAgICAgICAgICAgIDB4MkMKKyNkZWZp
bmUgTU9ERV9QQUdFX0FMTFMgICAgICAgICAgICAgICAgICAgICAgICAweDNmCisvKiBOb3QgaW4g
TXQuIEZ1amksIGJ1dCBpbiBBVEFQSSAyLjYgLS0gZGVwcmVjYXRlZCBub3cgaW4gZmF2b3IKKyAq
IG9mIE1PREVfUEFHRV9TRU5TRV9QT1dFUiAqLworI2RlZmluZSBNT0RFX1BBR0VfQ0RST00gICAg
ICAgICAgICAgICAgICAgICAgIDB4MGQKKworI2RlZmluZSBNT0RFX1BBR0VfQ0RST00gICAgICAg
ICAgICAgICAgICAgICAgIDB4MGQKKworLyogRXZlbnQgbm90aWZpY2F0aW9uIGNsYXNzZXMgZm9y
IEdFVCBFVkVOVCBTVEFUVVMgTk9USUZJQ0FUSU9OICovCisjZGVmaW5lIEdFU05fTk9fRVZFTlRT
ICAgICAgICAgICAgICAgIDAKKyNkZWZpbmUgR0VTTl9PUEVSQVRJT05BTF9DSEFOR0UgICAgICAg
MQorI2RlZmluZSBHRVNOX1BPV0VSX01BTkFHRU1FTlQgICAgICAgICAyCisjZGVmaW5lIEdFU05f
RVhURVJOQUxfUkVRVUVTVCAgICAgICAgIDMKKyNkZWZpbmUgR0VTTl9NRURJQSAgICAgICAgICAg
ICAgICAgICAgNAorI2RlZmluZSBHRVNOX01VTFRJUExFX0hPU1RTICAgICAgICAgICA1CisjZGVm
aW5lIEdFU05fREVWSUNFX0JVU1kgICAgICAgICAgICAgIDYKKworLyogRXZlbnQgY29kZXMgZm9y
IE1FRElBIGV2ZW50IHN0YXR1cyBub3RpZmljYXRpb24gKi8KKyNkZWZpbmUgTUVDX05PX0NIQU5H
RSAgICAgICAgICAgICAgICAgMAorI2RlZmluZSBNRUNfRUpFQ1RfUkVRVUVTVEVEICAgICAgICAg
ICAxCisjZGVmaW5lIE1FQ19ORVdfTUVESUEgICAgICAgICAgICAgICAgIDIKKyNkZWZpbmUgTUVD
X01FRElBX1JFTU9WQUwgICAgICAgICAgICAgMyAvKiBvbmx5IGZvciBtZWRpYSBjaGFuZ2VycyAq
LworI2RlZmluZSBNRUNfTUVESUFfQ0hBTkdFRCAgICAgICAgICAgICA0IC8qIG9ubHkgZm9yIG1l
ZGlhIGNoYW5nZXJzICovCisjZGVmaW5lIE1FQ19CR19GT1JNQVRfQ09NUExFVEVEICAgICAgIDUg
LyogTVJXIG9yIERWRCtSVyBiL2cgZm9ybWF0IGNvbXBsZXRlZCAqLworI2RlZmluZSBNRUNfQkdf
Rk9STUFUX1JFU1RBUlRFRCAgICAgICA2IC8qIE1SVyBvciBEVkQrUlcgYi9nIGZvcm1hdCByZXN0
YXJ0ZWQgKi8KKworI2RlZmluZSBNU19UUkFZX09QRU4gICAgICAgICAgICAgICAgICAxCisjZGVm
aW5lIE1TX01FRElBX1BSRVNFTlQgICAgICAgICAgICAgIDIKKworLyoKKyAqIEJhc2VkIG9uIHZh
bHVlcyBmcm9tIDxsaW51eC9jZHJvbS5oPiBidXQgZXh0ZW5kaW5nIENEX01JTlMKKyAqIHRvIHRo
ZSBtYXhpbXVtIGNvbW1vbiBzaXplIGFsbG93ZWQgYnkgdGhlIE9yYW5nZSdzIEJvb2sgQVRJUAor
ICoKKyAqIDkwIGFuZCA5OSBtaW4gQ0RzIGFyZSBhbHNvIGF2YWlsYWJsZSBidXQgdXNpbmcgdGhl
bSBhcyB0aGUKKyAqIHVwcGVyIGxpbWl0IHJlZHVjZXMgdGhlIGVmZmVjdGl2ZW5lc3Mgb2YgdGhl
IGhldXJpc3RpYyB0bworICogZGV0ZWN0IERWRHMgYnVybmVkIHRvIGxlc3MgdGhhbiAyNSUgb2Yg
dGhlaXIgbWF4aW11bSBjYXBhY2l0eQorICovCisKKy8qIFNvbWUgZ2VuZXJhbGx5IHVzZWZ1bCBD
RC1ST00gaW5mb3JtYXRpb24gKi8KKyNkZWZpbmUgQ0RfTUlOUyAgICAgICAgICAgICAgICAgICAg
ICAgODAgLyogbWF4LiBtaW51dGVzIHBlciBDRCAqLworI2RlZmluZSBDRF9TRUNTICAgICAgICAg
ICAgICAgICAgICAgICA2MCAvKiBzZWNvbmRzIHBlciBtaW51dGUgKi8KKyNkZWZpbmUgQ0RfRlJB
TUVTICAgICAgICAgICAgICAgICAgICAgNzUgLyogZnJhbWVzIHBlciBzZWNvbmQgKi8KKyNkZWZp
bmUgQ0RfRlJBTUVTSVpFICAgICAgICAgICAgICAgIDIwNDggLyogYnl0ZXMgcGVyIGZyYW1lLCAi
Y29va2VkIiBtb2RlICovCisjZGVmaW5lIENEX01BWF9CWVRFUyAgICAgICAoQ0RfTUlOUyAqIENE
X1NFQ1MgKiBDRF9GUkFNRVMgKiBDRF9GUkFNRVNJWkUpCisjZGVmaW5lIENEX01BWF9TRUNUT1JT
ICAgICAoQ0RfTUFYX0JZVEVTIC8gNTEyKQorCisvKgorICogVGhlIE1NQyB2YWx1ZXMgYXJlIG5v
dCBJREUgc3BlY2lmaWMgYW5kIG1pZ2h0IG5lZWQgdG8gYmUgbW92ZWQKKyAqIHRvIGEgY29tbW9u
IGhlYWRlciBpZiB0aGV5IGFyZSBhbHNvIG5lZWRlZCBmb3IgdGhlIFNDU0kgZW11bGF0aW9uCisg
Ki8KKworLyogUHJvZmlsZSBsaXN0IGZyb20gTU1DLTYgcmV2aXNpb24gMSB0YWJsZSA5MSAqLwor
I2RlZmluZSBNTUNfUFJPRklMRV9OT05FICAgICAgICAgICAgICAgIDB4MDAwMAorI2RlZmluZSBN
TUNfUFJPRklMRV9DRF9ST00gICAgICAgICAgICAgIDB4MDAwOAorI2RlZmluZSBNTUNfUFJPRklM
RV9DRF9SICAgICAgICAgICAgICAgIDB4MDAwOQorI2RlZmluZSBNTUNfUFJPRklMRV9DRF9SVyAg
ICAgICAgICAgICAgIDB4MDAwQQorI2RlZmluZSBNTUNfUFJPRklMRV9EVkRfUk9NICAgICAgICAg
ICAgIDB4MDAxMAorI2RlZmluZSBNTUNfUFJPRklMRV9EVkRfUl9TUiAgICAgICAgICAgIDB4MDAx
MQorI2RlZmluZSBNTUNfUFJPRklMRV9EVkRfUkFNICAgICAgICAgICAgIDB4MDAxMgorI2RlZmlu
ZSBNTUNfUFJPRklMRV9EVkRfUldfUk8gICAgICAgICAgIDB4MDAxMworI2RlZmluZSBNTUNfUFJP
RklMRV9EVkRfUldfU1IgICAgICAgICAgIDB4MDAxNAorI2RlZmluZSBNTUNfUFJPRklMRV9EVkRf
Ul9ETF9TUiAgICAgICAgIDB4MDAxNQorI2RlZmluZSBNTUNfUFJPRklMRV9EVkRfUl9ETF9KUiAg
ICAgICAgIDB4MDAxNgorI2RlZmluZSBNTUNfUFJPRklMRV9EVkRfUldfREwgICAgICAgICAgIDB4
MDAxNworI2RlZmluZSBNTUNfUFJPRklMRV9EVkRfRERSICAgICAgICAgICAgIDB4MDAxOAorI2Rl
ZmluZSBNTUNfUFJPRklMRV9EVkRfUExVU19SVyAgICAgICAgIDB4MDAxQQorI2RlZmluZSBNTUNf
UFJPRklMRV9EVkRfUExVU19SICAgICAgICAgIDB4MDAxQgorI2RlZmluZSBNTUNfUFJPRklMRV9E
VkRfUExVU19SV19ETCAgICAgIDB4MDAyQQorI2RlZmluZSBNTUNfUFJPRklMRV9EVkRfUExVU19S
X0RMICAgICAgIDB4MDAyQgorI2RlZmluZSBNTUNfUFJPRklMRV9CRF9ST00gICAgICAgICAgICAg
IDB4MDA0MAorI2RlZmluZSBNTUNfUFJPRklMRV9CRF9SX1NSTSAgICAgICAgICAgIDB4MDA0MQor
I2RlZmluZSBNTUNfUFJPRklMRV9CRF9SX1JSTSAgICAgICAgICAgIDB4MDA0MgorI2RlZmluZSBN
TUNfUFJPRklMRV9CRF9SRSAgICAgICAgICAgICAgIDB4MDA0MworI2RlZmluZSBNTUNfUFJPRklM
RV9IRERWRF9ST00gICAgICAgICAgIDB4MDA1MAorI2RlZmluZSBNTUNfUFJPRklMRV9IRERWRF9S
ICAgICAgICAgICAgIDB4MDA1MQorI2RlZmluZSBNTUNfUFJPRklMRV9IRERWRF9SQU0gICAgICAg
ICAgIDB4MDA1MgorI2RlZmluZSBNTUNfUFJPRklMRV9IRERWRF9SVyAgICAgICAgICAgIDB4MDA1
MworI2RlZmluZSBNTUNfUFJPRklMRV9IRERWRF9SX0RMICAgICAgICAgIDB4MDA1OAorI2RlZmlu
ZSBNTUNfUFJPRklMRV9IRERWRF9SV19ETCAgICAgICAgIDB4MDA1QQorI2RlZmluZSBNTUNfUFJP
RklMRV9JTlZBTElEICAgICAgICAgICAgIDB4RkZGRgotLSAKMi4yMS4wCgpfX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpTcGljZS1kZXZlbCBtYWlsaW5nIGxp
c3QKU3BpY2UtZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRl
c2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vc3BpY2UtZGV2ZWw=
