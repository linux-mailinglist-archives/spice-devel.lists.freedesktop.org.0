Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 738E78BCAC
	for <lists+spice-devel@lfdr.de>; Tue, 13 Aug 2019 17:10:58 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E8FA66E179;
	Tue, 13 Aug 2019 15:10:56 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mail-ot1-x332.google.com (mail-ot1-x332.google.com
 [IPv6:2607:f8b0:4864:20::332])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 3A9226E179
 for <spice-devel@lists.freedesktop.org>; Tue, 13 Aug 2019 15:10:56 +0000 (UTC)
Received: by mail-ot1-x332.google.com with SMTP id j7so28990642ota.9
 for <spice-devel@lists.freedesktop.org>; Tue, 13 Aug 2019 08:10:56 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc;
 bh=LpbojVqEIrXzLCLwzX0V9Hj+GG8ZbChHcMFfVnYi/eY=;
 b=qCLAtIw8QoeciYgkEXSk8Zr3uUUfZ5PExlbdOdUSXcPbJyL3l6VIg5tAu9ZnqIKJ3v
 ZPeuuFBy30aPO8H1L/w1D+3+NLdsRs6wTgKKaP801KQxJmfrD6fuzDQP2Ld7UkegU12h
 pN/eLHORIRlyY5td4Gr4nlBp71QJYLP/YARzYAOTREqvsofbOJWXomlR3IMBSCeIUpRG
 3Fi8xCvNVjqDszdECbP+1hE0P3Qw5tJXa9wjFpPGrOyvpA0uDAypdgpbobyWubEL0tHi
 EhW/h76rOgcU3NmkzTyZV6gbH+rjvOheMdGqpFlucp26rlX+YpcLKJQJy15MRJ7RphGQ
 bQXA==
X-Gm-Message-State: APjAAAWGrOjdL4AhGjleykhdYiHiunDAazJdj6FtuWiwwEyvR7GtOzlW
 VdgV0ycbF7LYV8/s/SP4TDWqySk/NCxbiAW8rk5skZGqEUU=
X-Google-Smtp-Source: APXvYqxvUjTsJgV0v9KBLV/uvYU9RuJE+VqPMOzVWD6ZSUnyNZElfO9WokB+DCUh/uVrlI+/p3nkoixmj68ydg14FDM=
X-Received: by 2002:a6b:b214:: with SMTP id b20mr39829558iof.149.1565709055311; 
 Tue, 13 Aug 2019 08:10:55 -0700 (PDT)
MIME-Version: 1.0
References: <20190812095729.32692-1-yuri.benditovich@daynix.com>
 <20190812095729.32692-6-yuri.benditovich@daynix.com>
 <1409051095.5635285.1565697543164.JavaMail.zimbra@redhat.com>
In-Reply-To: <1409051095.5635285.1565697543164.JavaMail.zimbra@redhat.com>
From: Yuri Benditovich <yuri.benditovich@daynix.com>
Date: Tue, 13 Aug 2019 18:10:40 +0300
Message-ID: <CAOEp5OdBZ-spO4jKoP6vLFnX6QjK8iM+caF9LyF4-mWubzNWYQ@mail.gmail.com>
To: Frediano Ziglio <fziglio@redhat.com>
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=daynix-com.20150623.gappssmtp.com; s=20150623;
 h=mime-version:references:in-reply-to:from:date:message-id:subject:to
 :cc;
 bh=LpbojVqEIrXzLCLwzX0V9Hj+GG8ZbChHcMFfVnYi/eY=;
 b=wBp0wfAfdGnPiKiZJkF7hL+k5Dme9Jit1tWGABamgM1k+ulPRYWbOYOC9t/4PCSBD2
 5mWUfcBbqANSd69Aa94vIr0fTCrluYdZ35I1jHGQQecOEqpJ2WPg82bjS3Vpym/K4fw4
 1v69pAr1yF1GDdTZ3YUUVfKAa4Ea0gaKo3HaswOXfOBLnRM3UbuTp6ENgomCXFBYxxHf
 Im627kmuxXV1LKnTCwx4txJVjR0UiR9pQ8QKR00seqwsLsb2GN4TT20eupGXFM90fedK
 chbedHO5491vQ5x21b6isc13t8iffNIqYGzqw53Gzvsc44cRqt0KkOaPn4N+fAwQo0NA
 5iTg==
Subject: Re: [Spice-devel] [spice-gtk v3 5/9] usb-redir: extend USB backend
 to support emulated devices
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Yan Vugenfirer <yan@daynix.com>,
 Spice List <spice-devel@lists.freedesktop.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

T24gVHVlLCBBdWcgMTMsIDIwMTkgYXQgMjo1OSBQTSBGcmVkaWFubyBaaWdsaW8gPGZ6aWdsaW9A
cmVkaGF0LmNvbT4gd3JvdGU6Cj4KPiA+Cj4gPiBSZWRpcmVjdGlvbiBvZiBlbXVsYXRlZCBkZXZp
Y2VzIHJlcXVpcmVzIHNwZWNpYWwgYXBwcm9hY2gsCj4gPiBhcyB1c2JyZWRpcmhvc3QgY2FuJ3Qg
YmUgdXNlZCBmb3IgdGhhdCAoaXQgd29ya3Mgb25seSB3aXRoCj4gPiBsaWJ1c2IgZGV2aWNlcyku
IEZvciBlbXVsYXRlZCBkZXZpY2VzIHdlIGNyZWF0ZSBpbnN0YW5jZSBvZgo+ID4gdXNicmVkaXJw
YXJzZXIgdGhhdCBpbXBsZW1lbnRzIFVTQiByZWRpcmVjdGlvbiBwcm90b2NvbC4KPgo+IE1ha2Ug
c2Vuc2UuIEFjdHVhbGx5IHVzYnJlZGlyaG9zdCBpbnRlcm5hbGx5IHVzZXMgYSBwYXJzZXIgdG8K
PiBwYXJzZSBwcm90b2NvbCBtZXNzYWdlcyBhbmQgcmVkaXJlY3QgdG8gdGhlIHBoeXNpY2FsIGRl
dmljZS4KPiBCdXQgdGhlIHBhcnNlIGlzIGludGVybmFsIGFuZCBpcyB1c2VkIGJ5IHVzYnJlZGly
aG9zdCBzbwo+IHdvdWxkIGJlIGhhcmQgdG8gcmV1c2UuCj4KPiA+IEluIG9yZGVyIHRvIHdvcmsg
d2l0aCB0aGUgc2FtZSBzZXQgb2YgcHJvdG9jb2wgY2FwYWJpbGl0aWVzCj4gPiB0aGF0IHVzYnJl
ZGlyaG9zdCBzZXRzIHVwIHdpdGggcmVtb3RlIHNpZGUsIHRoZSBwYXJzZXIgc2hhbGw6Cj4gPiAt
IG5vdCBzZW5kIGl0cyBvd24gJ2hlbGxvJyB0byB0aGUgc2VydmVyCj4gPiAtIGluaXRpYWxpemUg
dGhlIHNhbWUgY2FwYWJpbGl0aWVzIHRoYXQgdXNicmVkaXJob3N0Cj4gPiAtIHJlY2VpdmUgdGhl
IHNhbWUgJ2hlbGxvJyByZXNwb25zZQo+ID4gRm9yIHRoYXQgd2UgYW5hbHl6ZSAnaGVsbG8nIHNl
bnQgYnkgVVNCIHJlZGlyIHBhcnNlciBhbmQKPiA+IGV4dHJhY3Qgc2V0IG9mIGNhcGFiaWxpdGll
cyBmcm9tIGl0IGFuZCB1cG9uIHJlY2VpdmUgb2YKPiA+ICdoZWxsbycgcmVzcG9uc2Ugd2UgcHJv
dmlkZSBpdCBhbHNvIHRvIHRoZSBwYXJzZXIuCj4KPiBUaGlzIG1ha2Ugc2Vuc2UgYnV0IHNvbWUg
cGFydCBvZiB0aGUgY29kZSBkb2VzIG5vdCBleGFjdGx5IHRoYXQuCj4gSW4gc29tZSBwYXRoIHRo
ZSBjb2RlIHNlbmQgdGhlICdoZWxsbycgaXMgc2VudCBieSB0aGUgcGFyc2VyLgo+IEl0IHdvdWxk
IGJlIG1vcmUgY2xlYXIgdG8gaW1wbGVtZW50IGp1c3Qgd2hhdCB5b3UgZGVzY3JpYmVkCj4gYWJv
dmUsIHdoeSB0aGUgaW1wbGVtZW50YXRpb24gaXMgYSBiaXQgZGlmZmVyZW50LgoKRHVlIHRvIGNv
cm5lciBjYXNlIGRlc2NyaWJlZCBiZWxvdy4KCj4KPiA+IFdoZW4gbGlidXNiIGRldmljZSBpcyBy
ZWRpcmVjdGVkIHZpYSBhIGNoYW5uZWwsIGluc3RhbmNlIG9mCj4gPiB1c2JyZWRpcmhvc3Qgc2Vy
dmVzIGl0Lgo+ID4gV2hlbiBlbXVsYXRlZCBkZXZpY2UgaXMgcmVkaXJlY3RlZCB2aWEgYSBjaGFu
bmVsLCBpbnN0YW5jZQo+ID4gb2YgdXNicmVkaXJwYXJzZXIgZG9lcyB0aGUgam9iLgo+ID4KPiA+
IFNpZ25lZC1vZmYtYnk6IFl1cmkgQmVuZGl0b3ZpY2ggPHl1cmkuYmVuZGl0b3ZpY2hAZGF5bml4
LmNvbT4KPiA+IC0tLQo+ID4gIHNyYy91c2ItYmFja2VuZC5jIHwgNjE2ICsrKysrKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKystLS0KPiA+ICAxIGZpbGUgY2hhbmdlZCwgNTgw
IGluc2VydGlvbnMoKyksIDM2IGRlbGV0aW9ucygtKQo+ID4KPiA+IGRpZmYgLS1naXQgYS9zcmMv
dXNiLWJhY2tlbmQuYyBiL3NyYy91c2ItYmFja2VuZC5jCj4gPiBpbmRleCBhYTExYzc5Li45YWVl
NmM3IDEwMDY0NAo+ID4gLS0tIGEvc3JjL3VzYi1iYWNrZW5kLmMKPiA+ICsrKyBiL3NyYy91c2It
YmFja2VuZC5jCj4gPiBAQCAtNTUsNiArNTUsNyBAQCBzdHJ1Y3QgX1NwaWNlVXNiQmFja2VuZERl
dmljZQo+ID4gICAgICBnaW50IHJlZl9jb3VudDsKPiA+ICAgICAgU3BpY2VVc2JCYWNrZW5kQ2hh
bm5lbCAqYXR0YWNoZWRfdG87Cj4gPiAgICAgIFVzYkRldmljZUluZm9ybWF0aW9uIGRldmljZV9p
bmZvOwo+ID4gKyAgICBnYm9vbGVhbiBlZGV2X2NvbmZpZ3VyZWQ7Cj4KPiBUaGlzIHZhcmlhYmxl
IGlzIG5ldmVyIHJlc2V0LCBJIHdvdWxkIGV4cGVjdCB0aGF0IGF0IGxlYXN0Cj4gd2hlbiBkZXZp
Y2UgaXMgZGV0YWNoZWQgKHRoaXMgc2hvdWxkIGJlIGVxdWl2YWxlbnQgdG8gcGh5c2ljYWwKPiBy
ZW1vdmFsKS4KClByb2JhYmx5LCBuZWVkIHRvIHJlc2V0IGl0IG9uIGF0dGFjaC4KSW4gZmFjdCwg
bm9ib2R5IHVzZXMgaXQsIHRoZSBkcml2ZXIgdXN1YWxseSBqdXN0IHNldHMgdGhlIGNvbmZpZ3Vy
YXRpb24uCgo+IFdoeSBub3QgbW92aW5nIHRvIFNwaWNlVXNiQmFja2VuZENoYW5uZWw/Cj4KCkJl
Y2F1c2UgaXQgaXMgaGFyZGx5IHJlbGF0ZWQgdG8gdGhlIGNoYW5uZWwuCgo+ID4gIH07Cj4gPgo+
ID4gIHN0cnVjdCBfU3BpY2VVc2JCYWNrZW5kCj4gPiBAQCAtODAsMTAgKzgxLDIwIEBAIHN0cnVj
dCBfU3BpY2VVc2JCYWNrZW5kCj4gPiAgc3RydWN0IF9TcGljZVVzYkJhY2tlbmRDaGFubmVsCj4g
PiAgewo+ID4gICAgICBzdHJ1Y3QgdXNicmVkaXJob3N0ICp1c2JyZWRpcmhvc3Q7Cj4gPiArICAg
IHN0cnVjdCB1c2JyZWRpcmhvc3QgKmhpZGRlbl9ob3N0Owo+ID4gKyAgICBzdHJ1Y3QgdXNicmVk
aXJwYXJzZXIgKnBhcnNlcjsKPiA+ICsgICAgc3RydWN0IHVzYnJlZGlycGFyc2VyICpoaWRkZW5f
cGFyc2VyOwo+Cj4gSSBkb24ndCB1bmRlcnN0YW5kIGFsbCB0aGVzZSB2YXJpYWJsZS4KPiBXb24n
dCBiZSBlYXNpZXIgdG8gaGF2ZSBwYXJzZXIgaW5pdGlhbGl6ZWQgZm9yIGVtdWxhdGVkCj4gZGV2
aWNlcyBhbmQgYmVpbmcgTlVMTCAoc28gZnJlZWQpIHdoZW4gZW11bGF0ZWQgZGV2aWNlCj4gaXMg
ZGV0YWNoZWQ/CgpXaGVuIHRoZSBjaGFubmVsIGlzIGNyZWF0ZWQgaXQgZG9lcyBub3Qga25vdyB3
aGF0IGl0IHdpbGwgcmVkaXJlY3QuClRoZSBzYW1lIGNoYW5uZWwgaXMgdXNlZCBmb3IgcmVndWxh
ciBkZXZpY2VzIGFuZCBlbXVsYXRlZCBvbmUuIEJvdGgKcGFyc2VyIGFuZCB1c2JyZWRpcmhvc3Qg
c2hhbGwgYmUgaW50ZXJuYWxseSBzeW5jaHJvbml6ZWQgd2l0aCB0aGUKcmVtb3RlIHNpZGUuCklm
IEknZCBjcmVhdGUgdGhlIHBhcnNlciBlYWNoIHRpbWUgdGhlIGVtdWxhdGVkIGRldmljZSBpcyBh
dHRhY2hlZCBJJ2QKbmVlZCBlYWNoIHRpbWUgdG8gaW5pdGlhbGl6ZSBpdCB3aXRoIHJlY2VpdmVk
IGhlbGxvIGZyb20gdGhlIHNlY29uZApzaWRlLiBXZSdkIG5lZWQgdG8gd3JpdGUgYWRkaXRpb25h
bCBjb2RlIHRvIHByb2Nlc3MgKGV2ZW4gaW1hZ2luYWJsZSkKZXJyb3IgY2FzZXMgKHdoYXQgaWYg
d2UgY2FuJ3QgY3JlYXRlIHRoZSBwYXJzZXIgZXRjKS4KRmluYWxseSB0aGlzIGFwcGVhcnMgdG8g
YmUgbW9yZSBjb21wbGljYXRlZCB0aGFuIGhhdmUgZXZlcnl0aGlnbiByZWFkeQpmcm9tIHRoZSBi
ZWdpbm5pbmcuCgpUaGVyZSBpcyBhbHNvIGNvcm5lciBjYXNlIHdoZW4gdGhlIGRldmljZSBpcyBh
dHRhY2hlZCBiZWZvcmUgdGhlCmNoYW5uZWwgaXMgcmVhZHkgKHJlZGlyZWN0LW9uLWNvbm5lY3Qg
c2V0dGluZykuIFdlIGRlY2lkZSBvbgp1c2JyZWRpaG9zdCcgb3IgJ3BhcnNlcicgZGVwZW5kaW5n
IG9uIGtpbmQgb2YgYXR0YWNoZWQgZGV2aWNlIHRvCnJlZGlyZWN0LgpJZiB0aGUgY2hhbm5lbCBp
cyBzdGlsbCBub3QgcmVhZHksIHRoZSBwYXJzZXIvdXNicmVkaXJob3N0IGNhbid0IHNlbmQKYW55
dGhpbmcgdGlsbCB0aGUgY2hhbm5lbCBpcyB1cC4gSW4gdGhpcyBjYXNlIHN3aXRjaGluZyBiYWNr
IGFuZCBmb3J0aApiZXR3ZWVuIHVzYnJlZGlyaG9zdCBiZWNvbWVzIG1vcmUgY29tcGxpY2F0ZWQg
dGhhbiBjdXJyZW50IHNvbHV0aW9uLgoKPgo+ID4gICAgICB1aW50OF90ICpyZWFkX2J1ZjsKPiA+
ICAgICAgaW50IHJlYWRfYnVmX3NpemU7Cj4gPiAgICAgIHN0cnVjdCB1c2JyZWRpcmZpbHRlcl9y
dWxlICpydWxlczsKPiA+ICAgICAgaW50IHJ1bGVzX2NvdW50Owo+ID4gKyAgICB1aW50MzJfdCBo
b3N0X2NhcHM7Cj4gPiArICAgIHVpbnQzMl90IHBhcnNlcl9pbml0X2RvbmUgIDogMTsKPiA+ICsg
ICAgdWludDMyX3QgcGFyc2VyX3dpdGhfaGVsbG8gOiAxOwo+ID4gKyAgICB1aW50MzJfdCBoZWxs
b19kb25lX3BhcnNlciA6IDE7Cj4gPiArICAgIHVpbnQzMl90IGhlbGxvX3NlbnQgICAgICAgIDog
MTsKPiA+ICsgICAgdWludDMyX3QgcmVqZWN0ZWQgICAgICAgICAgOiAxOwo+ID4gKyAgICB1aW50
MzJfdCB3YWl0X2Rpc2NfYWNrICAgICA6IDE7Cj4KPiBUaGUgImRpc2MiIG5hbWluZyBpcyBjb25m
dXNpbmcsIGFsc28gdGFraW5nIGludG8gYWNjb3VudCB0aGUKPiAiQ29tcGFjdCBEaXNjIiBhZGRp
dGlvbi4gUmVhZGluZyB0aGUgY29kZSB0aGlzICJkaXNjIiBpcyBhIHNob3J0ZW4KPiBmb3IgImRp
c2Nvbm5lY3QiLCBtYXliZSB3b3VsZCBiZSBiZXR0ZXIgdG8ganVzdCB1c2UgIndhaXRfZGlzY29u
bmVjdF9hY2siPwo+CgpvawoKPiA+ICAgICAgU3BpY2VVc2JCYWNrZW5kRGV2aWNlICphdHRhY2hl
ZDsKPiA+ICAgICAgU3BpY2VVc2JyZWRpckNoYW5uZWwgICp1c2VyX2RhdGE7Cj4KPiBPVDogdGhp
cyBkZWZpbml0aXZlbHkgc2hvdWxkIGJlIHJlbmFtZWQhCgpQcm9iYWJseSBpbiBzZXBhcmF0ZSBj
b21taXQuCgo+Cj4gPiAgICAgIFNwaWNlVXNiQmFja2VuZCAqYmFja2VuZDsKPiA+IEBAIC0zNTUs
NyArMzY2LDExIEBAIGdib29sZWFuCj4gPiBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfaXNvY2go
U3BpY2VVc2JCYWNrZW5kRGV2aWNlICpkZXYpCj4gPiAgICAgIGdpbnQgaSwgaiwgazsKPiA+ICAg
ICAgaW50IHJjOwo+ID4KPiA+IC0gICAgZ19yZXR1cm5fdmFsX2lmX2ZhaWwobGliZGV2ICE9IE5V
TEwsIDApOwo+ID4gKyAgICBnX3JldHVybl92YWxfaWZfZmFpbChsaWJkZXYgIT0gTlVMTCB8fCBk
ZXYtPmVkZXYgIT0gTlVMTCwgMCk7Cj4gPiArICAgIGlmIChkZXYtPmVkZXYpIHsKPiA+ICsgICAg
ICAgIC8qIGN1cnJlbnRseSB3ZSBkbyBub3QgZW11bGF0ZSBpc29jaCBkZXZpY2VzICovCj4gPiAr
ICAgICAgICByZXR1cm4gRkFMU0U7Cj4gPiArICAgIH0KPiA+Cj4gPiAgICAgIHJjID0gbGlidXNi
X2dldF9hY3RpdmVfY29uZmlnX2Rlc2NyaXB0b3IobGliZGV2LCAmY29uZl9kZXNjKTsKPiA+ICAg
ICAgaWYgKHJjKSB7Cj4gPiBAQCAtMzkwLDEzICs0MDUsMTYgQEAgZnJvbSBib3RoIHRoZSBtYWlu
IHRocmVhZCBhcyB3ZWxsIGFzIGZyb20gdGhlIHVzYiBldmVudAo+ID4gaGFuZGxpbmcgdGhyZWFk
ICovCj4gPiAgc3RhdGljIHZvaWQgdXNicmVkaXJfd3JpdGVfZmx1c2hfY2FsbGJhY2sodm9pZCAq
dXNlcl9kYXRhKQo+ID4gIHsKPiA+ICAgICAgU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCAqY2ggPSB1
c2VyX2RhdGE7Cj4gPiAtICAgIGlmICghY2gtPnVzYnJlZGlyaG9zdCkgewo+ID4gLSAgICAgICAg
LyoganVzdCB0byBiZSBvbiB0aGUgc2FmZSBzaWRlICovCj4gPiAtICAgICAgICByZXR1cm47Cj4g
PiAtICAgIH0KPgo+IFRoZXNlIGNoZWNrIHNob3VsZCBiZSBpbiBhIHByZXBhcmF0b3J5IHBhdGNo
LiBOb3RoaW5nIHdyb25nIHdpdGggdGhpcyBwYXRjaCwKPiBidXQgdGhlIGNvZGUgKG1hc3Rlcikg
aXMgY29uZnVzaW5nLiB1c2JyZWRpcmhvc3QgaXMgaW5pdGlhbGl6ZWQgYXMgc29vbiBhcwo+IHBv
c3NpYmxlLCBjYW4gYmUgTlVMTCBvbmx5IGJlZm9yZSB1c2JyZWRpcmhvc3Rfb3Blbl9mdWxsIHJl
dHVybnMuCj4gQWN0dWFsbHkgY2FuIGJlIE5VTEwgaW4gdGhpcyBjYWxsIGZvciB0aGlzIHJlYXNv
biAodGhpcyBjYWxsYmFjayBpcyBjYWxsZWQKPiBpbnNpZGUgdXNicmVkaXJob3N0X29wZW5fZnVs
bCkuCj4KPiA+ICAgICAgaWYgKGlzX2NoYW5uZWxfcmVhZHkoY2gtPnVzZXJfZGF0YSkpIHsKPiA+
IC0gICAgICAgIFNQSUNFX0RFQlVHKCIlcyBjaCAlcCAtPiB1c2JyZWRpcmhvc3QiLCBfX0ZVTkNU
SU9OX18sIGNoKTsKPiA+IC0gICAgICAgIHVzYnJlZGlyaG9zdF93cml0ZV9ndWVzdF9kYXRhKGNo
LT51c2JyZWRpcmhvc3QpOwo+ID4gKyAgICAgICAgaWYgKGNoLT51c2JyZWRpcmhvc3QpIHsKPiA+
ICsgICAgICAgICAgICBTUElDRV9ERUJVRygiJXMgY2ggJXAgLT4gdXNicmVkaXJob3N0IiwgX19G
VU5DVElPTl9fLCBjaCk7Cj4gPiArICAgICAgICAgICAgdXNicmVkaXJob3N0X3dyaXRlX2d1ZXN0
X2RhdGEoY2gtPnVzYnJlZGlyaG9zdCk7Cj4gPiArICAgICAgICB9IGVsc2UgaWYgKGNoLT5wYXJz
ZXIpIHsKPiA+ICsgICAgICAgICAgICBTUElDRV9ERUJVRygiJXMgY2ggJXAgLT4gcGFyc2VyIiwg
X19GVU5DVElPTl9fLCBjaCk7Cj4gPiArICAgICAgICAgICAgdXNicmVkaXJwYXJzZXJfZG9fd3Jp
dGUoY2gtPnBhcnNlcik7Cj4gPiArICAgICAgICB9IGVsc2Ugewo+ID4gKyAgICAgICAgICAgIFNQ
SUNFX0RFQlVHKCIlcyBjaCAlcCAoTk9UIEFDVElWRSkiLCBfX0ZVTkNUSU9OX18sIGNoKTsKPgo+
IFRoaXMgdGhpcmQgY2FzZSBzaG91bGQgbmV2ZXIgYmUgcG9zc2libGUuIFRoaXMgaXMgb25lIGFz
cGVjdCB0aGF0IG1hc3Rlcgo+IGNvZGUgaXMgY29uZnVzaW5nIGFib3V0Lgo+Cj4gPiArICAgICAg
ICB9Cj4gPiAgICAgIH0gZWxzZSB7Cj4gPiAgICAgICAgICBTUElDRV9ERUJVRygiJXMgY2ggJXAg
KG5vdCByZWFkeSkiLCBfX0ZVTkNUSU9OX18sIGNoKTsKPiA+ICAgICAgfQo+ID4gQEAgLTU1MSwx
MyArNTY5LDUyIEBAIHZvaWQKPiA+IHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV91bnJlZihTcGlj
ZVVzYkJhY2tlbmREZXZpY2UgKmRldikKPiA+ICAgICAgfQo+ID4gIH0KPiA+Cj4gPiAtaW50IHNw
aWNlX3VzYl9iYWNrZW5kX2RldmljZV9jaGVja19maWx0ZXIoCj4gPiAtICAgIFNwaWNlVXNiQmFj
a2VuZERldmljZSAqZGV2LAo+ID4gLSAgICBjb25zdCBzdHJ1Y3QgdXNicmVkaXJmaWx0ZXJfcnVs
ZSAqcnVsZXMsCj4gPiAtICAgIGludCBjb3VudCkKPiA+ICtzdGF0aWMgaW50IGNoZWNrX2VkZXZf
ZGV2aWNlX2ZpbHRlcihTcGljZVVzYkJhY2tlbmREZXZpY2UgKmRldiwKPiA+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJ1Y3QgdXNicmVkaXJmaWx0ZXJfcnVs
ZSAqcnVsZXMsCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IGNv
dW50KQo+ID4gIHsKPiA+IC0gICAgcmV0dXJuIHVzYnJlZGlyaG9zdF9jaGVja19kZXZpY2VfZmls
dGVyKAo+ID4gLSAgICAgICAgcnVsZXMsIGNvdW50LCBkZXYtPmxpYnVzYl9kZXZpY2UsIDApOwo+
ID4gKyAgICBTcGljZVVzYkVtdWxhdGVkRGV2aWNlICplZGV2ID0gZGV2LT5lZGV2Owo+ID4gKyAg
ICB1aW50OF90IGNsc1szMl0sIHN1YmNsc1szMl0sIHByb3RvWzMyXSwgKmNmZywgaWZudW0gPSAw
Owo+ID4gKyAgICB1aW50MTZfdCBzaXplLCBvZmZzZXQgPSAwOwo+ID4gKyAgICBpZiAoIWVkZXYp
IHsKPiA+ICsgICAgICAgIHJldHVybiAxOwo+ID4gKyAgICB9Cj4gPiArICAgIGlmICghZGV2aWNl
X29wcyhlZGV2KS0+Z2V0X2Rlc2NyaXB0b3IoZWRldiwgTElCVVNCX0RUX0NPTkZJRywgMCwgKHZv
aWQKPiA+ICoqKSZjZmcsICZzaXplKSkgewo+ID4gKyAgICAgICAgcmV0dXJuIDE7Cj4gPiArICAg
IH0KPiA+ICsgICAgd2hpbGUgKChvZmZzZXQgKyAxKSA8IHNpemUpIHsKPiA+ICsgICAgICAgIHVp
bnQ4X3QgbGVuICA9IGNmZ1tvZmZzZXRdOwo+ID4gKyAgICAgICAgdWludDhfdCB0eXBlID0gY2Zn
W29mZnNldCArIDFdOwo+ID4gKyAgICAgICAgaWYgKChvZmZzZXQgKyBsZW4pID4gc2l6ZSkgewo+
ID4gKyAgICAgICAgICAgIGJyZWFrOwo+ID4gKyAgICAgICAgfQo+ID4gKyAgICAgICAgaWYgKHR5
cGUgPT0gTElCVVNCX0RUX0lOVEVSRkFDRSkgewo+ID4gKyAgICAgICAgICAgIGNsc1tpZm51bV0g
PSBjZmdbb2Zmc2V0ICsgNV07Cj4gPiArICAgICAgICAgICAgc3ViY2xzW2lmbnVtXSA9IGNmZ1tv
ZmZzZXQgKyA2XTsKPiA+ICsgICAgICAgICAgICBwcm90b1tpZm51bV0gPSBjZmdbb2Zmc2V0ICsg
N107Cj4gPiArICAgICAgICAgICAgaWZudW0rKzsKPiA+ICsgICAgICAgIH0KPiA+ICsgICAgICAg
IG9mZnNldCArPSBsZW47Cj4gPiArICAgIH0KPiA+ICsKPiA+ICsgICAgcmV0dXJuIHVzYnJlZGly
ZmlsdGVyX2NoZWNrKHJ1bGVzLCBjb3VudCwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGRldi0+ZGV2aWNlX2luZm8uY2xhc3MsCj4gPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBkZXYtPmRldmljZV9pbmZvLnN1YmNsYXNzLAo+ID4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgZGV2LT5kZXZpY2VfaW5mby5wcm90b2NvbCwKPiA+ICsgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGNscywgc3ViY2xzLCBwcm90bywgaWZudW0sCj4gPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXYtPmRldmljZV9pbmZvLnZpZCwKPiA+
ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRldi0+ZGV2aWNlX2luZm8ucGlkLAo+
ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGV2LT5kZXZpY2VfaW5mby5iY2RV
U0IsIDApOwo+ID4gK30KPiA+ICsKPiA+ICtpbnQgc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX2No
ZWNrX2ZpbHRlcihTcGljZVVzYkJhY2tlbmREZXZpY2UgKmRldiwKPiA+ICsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJ1Y3QgdXNicmVkaXJmaWx0ZXJf
cnVsZQo+ID4gKnJ1bGVzLCBpbnQgY291bnQpCj4gPiArewo+ID4gKyAgICBpZiAoZGV2LT5saWJ1
c2JfZGV2aWNlKSB7Cj4gPiArICAgICAgICByZXR1cm4gdXNicmVkaXJob3N0X2NoZWNrX2Rldmlj
ZV9maWx0ZXIocnVsZXMsIGNvdW50LAo+ID4gZGV2LT5saWJ1c2JfZGV2aWNlLCAwKTsKPiA+ICsg
ICAgfSBlbHNlIHsKPiA+ICsgICAgICAgIHJldHVybiBjaGVja19lZGV2X2RldmljZV9maWx0ZXIo
ZGV2LCBydWxlcywgY291bnQpOwo+ID4gKyAgICB9Cj4gPiAgfQo+ID4KPiA+ICBzdGF0aWMgaW50
IHVzYnJlZGlyX3JlYWRfY2FsbGJhY2sodm9pZCAqdXNlcl9kYXRhLCB1aW50OF90ICpkYXRhLCBp
bnQgY291bnQpCj4gPiBAQCAtNjIxLDYgKzY3OCwxNyBAQCBzdGF0aWMgaW50IHVzYnJlZGlyX3dy
aXRlX2NhbGxiYWNrKHZvaWQgKnVzZXJfZGF0YSwKPiA+IHVpbnQ4X3QgKmRhdGEsIGludCBjb3Vu
dCkKPiA+ICAgICAgU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCAqY2ggPSB1c2VyX2RhdGE7Cj4gPiAg
ICAgIGludCByZXM7Cj4gPiAgICAgIFNQSUNFX0RFQlVHKCIlcyBjaCAlcCwgJWQgYnl0ZXMiLCBf
X0ZVTkNUSU9OX18sIGNoLCBjb3VudCk7Cj4gPiArICAgIGlmICghY2gtPmhlbGxvX3NlbnQpIHsK
Pgo+IElzIGNvbmZ1c2luZyB0aGF0IHRoZSBzYW1lIGNhbGxiYWNrIGlzIHVzZWQgZm9yIGJvdGgg
dXNicmVkaXIgcGFyc2VyIGFuZAo+IHVzYnJlZGlyIGhvc3QgYnV0IHRoZSBoZWxsbyBzaG91bGQg
YmUgcGFyc2VkIG9ubHkgZm9yIHRoZSBob3N0Lgo+IE1heWJlIGRpc2FibGluZyBoZWxsbyBmb3Ig
dGhlIHBhcnNlciBhbmQgY2hlY2sgdGhlIHR5cGUgKGhlbGxvKSBoZXJlPwoKCgo+Cj4gPiArICAg
ICAgICAvKiBoZWxsbyBpcyBzaG9ydCBoZWFkZXIgKDEyKSArIGhlbGxvIHN0cnVjdCAoNjQpICsg
Y2FwYWJpbGl0aWVzICg0KQo+ID4gKi8KPiA+ICsgICAgICAgIGludCBoZWxsb19zaXplID0gc2l6
ZW9mKHN0cnVjdCB1c2JfcmVkaXJfaGVhZGVyKSArIHNpemVvZihzdHJ1Y3QKPiA+IHVzYl9yZWRp
cl9oZWxsb19oZWFkZXIpOwo+Cj4gVGhpcyBmb3JtdWxhZSBpcyBjb25mdXNpbmcgd2l0aCB0aGUg
ZGVzY3JpcHRpb24uIHNpemVvZihzdHJ1Y3QgdXNiX3JlZGlyX2hlYWRlcikKPiBpcyAxNiBidXQg
aXMgbm90IHRoZSBzaG9ydCAoMzJiaXQpIGhlYWRlci4KPgoKQXQgc3RhZ2Ugb2Ygc2VuZGluZyBo
ZWxsbyB0aGUgcGFyc2VyIChhbHNvIHdoZW4gaXMgd29ya3MgdW5kZXIKdXNicmVkaXJob3N0KSBk
b2VzIG5vdCBrbm93IHdoYXQgdGhlIHNlY29uZCBzaWRlIHN1cHBvcnQsIHNvIGl0CnVzZXMgbGVn
YWN5LWNvbXBhdGlibGUgc3RydWN0dXJlLiBJZiBzaXplIG9mIGhlbGxvIGlzIGJpZ2dlciB0aGFu
IHdlCmV4cGVjdCwgc29tZXRoaW5nIGlzIGNvbXBsZXRlbHkgbm90IGdvb2QuCldlIG5lZWQgdG8g
ZmluZCBjYXBhYmlsaXRpZXMgaW4gdGhlIHBhY2tldCwgc28gd2UgbmVlZCB0byBrbm93IGZvcgpz
dXJlIHdoZXJlIHRvIGxvb2sgZm9yIHRoZW0uCgo+ID4gKyAgICAgICAgY2gtPmhlbGxvX3NlbnQg
PSAxOwo+ID4gKyAgICAgICAgaWYgKGNvdW50ID09IGhlbGxvX3NpemUpIHsKPgo+IEkgd291bGQg
c2F5ICJjb3VudCA+PSBoZWxsb19zaXplIiB0byBzdXBwb3J0IGZ1dHVyZSBleHRlbnNpb25zIG9m
IHRoZQo+IGNhcGFiaWxpdHkgYXJyYXkuCgpJZiB0aGVyZSBhcmUgY2FwYWJpbGl0aWVzIHRoYXQg
d2UncmUgbm90IGF3YXJlIG9mLCB3ZSdyZSBub3QKc3luY2hyb25pemVkIHdpdGggdGhlIHVzYnJl
ZGlyIGxpYnJhcnkuCgo+Cj4gPiArICAgICAgICAgICAgbWVtY3B5KCZjaC0+aG9zdF9jYXBzLCBk
YXRhICsgaGVsbG9fc2l6ZSAtCj4gPiBzaXplb2YoY2gtPmhvc3RfY2FwcyksCj4gPiArICAgICAg
ICAgICAgICAgICAgIHNpemVvZihjaC0+aG9zdF9jYXBzKSk7Cj4gPiArICAgICAgICAgICAgU1BJ
Q0VfREVCVUcoIiVzIGNoICVwLCBzZW5kaW5nIGZpcnN0IGhlbGxvLCBjYXBzICUwOFgiLAo+ID4g
KyAgICAgICAgICAgICAgICAgICAgICAgIF9fRlVOQ1RJT05fXywgY2gsIGNoLT5ob3N0X2NhcHMp
Owo+ID4gKyAgICAgICAgfQo+ID4gKyAgICB9Cj4gPiAgICAgIHJlcyA9IHNwaWNlX3VzYnJlZGly
X3dyaXRlX2NhbGxiYWNrKGNoLT51c2VyX2RhdGEsIGRhdGEsIGNvdW50KTsKPiA+ICAgICAgcmV0
dXJuIHJlczsKPiA+ICB9Cj4gPiBAQCAtNjQxLDYgKzcwOSwyNyBAQCBpbnQKPiA+IHNwaWNlX3Vz
Yl9iYWNrZW5kX3JlYWRfZ3Vlc3RfZGF0YShTcGljZVVzYkJhY2tlbmRDaGFubmVsICpjaCwgdWlu
dDhfdCAqZGF0YSwKPiA+ICAgICAgY2gtPnJlYWRfYnVmX3NpemUgPSBjb3VudDsKPiA+ICAgICAg
aWYgKGNoLT51c2JyZWRpcmhvc3QpIHsKPgo+IE1heWJlIHRoaXMgY291bGQgYmUgImNoLT51c2Jy
ZWRpcmhvc3QgfHwgIWNoLT5oZWxsb19kb25lX3BhcnNlciIgdG8KPiBwYXJzZSB0aGUgJ2hlbGxv
JyBhbHdheXMgd2l0aCB1c2JyZWRpciBob3N0ID8KCkkgZXhwZWN0IHRoaXMgd2lsbCBtYWtlIHRo
ZSBjb2RlIG1vcmUgY29tcGxpY2F0ZWQgKGZyb20gcHJldmlvdXMgYXR0ZW1wdHMpLgoKPgo+ID4g
ICAgICAgICAgcmVzID0gdXNicmVkaXJob3N0X3JlYWRfZ3Vlc3RfZGF0YShjaC0+dXNicmVkaXJo
b3N0KTsKPiA+ICsgICAgICAgIGlmICghY2gtPmhlbGxvX2RvbmVfcGFyc2VyKSB7Cj4gPiArICAg
ICAgICAgICAgaW50IHJlc19wYXJzZXI7Cj4gPiArICAgICAgICAgICAgLyogdXNicmVkaXJob3N0
IHNob3VsZCBjb25zdW1lIGhlbGxvIHJlc3BvbnNlICovCj4gPiArICAgICAgICAgICAgZ19yZXR1
cm5fdmFsX2lmX2ZhaWwoY2gtPnJlYWRfYnVmID09IE5VTEwsCj4gPiBVU0JfUkVESVJfRVJST1Jf
UkVBRF9QQVJTRSk7Cj4gPiArCj4gPiArICAgICAgICAgICAgY2gtPnJlYWRfYnVmID0gZGF0YTsK
PiA+ICsgICAgICAgICAgICBjaC0+cmVhZF9idWZfc2l6ZSA9IGNvdW50Owo+ID4gKyAgICAgICAg
ICAgIGNoLT5oZWxsb19kb25lX3BhcnNlciA9IDE7Cj4gPiArICAgICAgICAgICAgaWYgKGNoLT5h
dHRhY2hlZCAmJiBjaC0+YXR0YWNoZWQtPmVkZXYpIHsKPiA+ICsgICAgICAgICAgICAgICAgLyog
Y2FzZSBvZiBDRCBzaGFyaW5nIG9uIGNvbm5lY3QgKi8KPiA+ICsgICAgICAgICAgICAgICAgY2gt
PnVzYnJlZGlyaG9zdCA9IE5VTEw7Cj4gPiArICAgICAgICAgICAgICAgIGNoLT5wYXJzZXIgPSBj
aC0+aGlkZGVuX3BhcnNlcjsKPiA+ICsgICAgICAgICAgICAgICAgU1BJQ0VfREVCVUcoIiVzOiBz
d2l0Y2ggJXAgdG8gcGFyc2VyIiwgX19GVU5DVElPTl9fLCBjaCk7Cj4gPiArICAgICAgICAgICAg
fQo+ID4gKyAgICAgICAgICAgIHJlc19wYXJzZXIgPSB1c2JyZWRpcnBhcnNlcl9kb19yZWFkKGNo
LT5oaWRkZW5fcGFyc2VyKTsKPiA+ICsgICAgICAgICAgICBpZiAocmVzID49IDApIHsKPiA+ICsg
ICAgICAgICAgICAgICAgcmVzID0gcmVzX3BhcnNlcjsKPiA+ICsgICAgICAgICAgICB9Cj4gPiAr
ICAgICAgICB9Cj4gPiArICAgIH0gZWxzZSBpZiAoY2gtPnBhcnNlcikgewo+ID4gKyAgICAgICAg
cmVzID0gdXNicmVkaXJwYXJzZXJfZG9fcmVhZChjaC0+cGFyc2VyKTsKPiA+ICAgICAgfSBlbHNl
IHsKPiA+ICAgICAgICAgIHJlcyA9IFVTQl9SRURJUl9FUlJPUl9JTzsKPiA+ICAgICAgfQo+ID4g
QEAgLTY2MSw2ICs3NTAsMTEgQEAgaW50Cj4gPiBzcGljZV91c2JfYmFja2VuZF9yZWFkX2d1ZXN0
X2RhdGEoU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCAqY2gsIHVpbnQ4X3QgKmRhdGEsCj4gPiAgICAg
IH0KPiA+ICAgICAgU1BJQ0VfREVCVUcoIiVzIGNoICVwLCAlZCBieXRlcywgcmVzICVkIiwgX19G
VU5DVElPTl9fLCBjaCwgY291bnQsIHJlcyk7Cj4gPgo+ID4gKyAgICBpZiAoY2gtPnJlamVjdGVk
KSB7Cj4gPiArICAgICAgICBjaC0+cmVqZWN0ZWQgPSAwOwo+ID4gKyAgICAgICAgcmVzID0gVVNC
X1JFRElSX0VSUk9SX0RFVl9SRUpFQ1RFRDsKPiA+ICsgICAgfQo+Cj4gV2h5IHRoaXMgaXMgYWZ0
ZXIgdGhlIHJlYWQ/IFdvbid0IGl0IGRpc2NhcmQgdGhlIHZhbHVlPwoKQmVjYXVzZSB3ZSBuZWVk
IHRvIHByb3ZpZGUgdGhlIGVycm9yIHRvIHRoZSB1c2ItcmVkaXItY2hhbm5lbC4KV2Uga25vdyBh
Ym91dCAncmVqZWN0JyBmcm9tIG91ciBjYWxsYmFjayB0aGF0IGlzIG5vdCBpbiBjb250ZXh0IG9m
CnVzYi1yZWRpci1jaGFubmVsIG9wZXJhdGlvbi4KCj4KPiA+ICsKPiA+ICAgICAgcmV0dXJuIHJl
czsKPiA+ICB9Cj4gPgo+ID4gQEAgLTY5MCwxMyArNzg0LDQyNiBAQCBHRXJyb3IgKnNwaWNlX3Vz
Yl9iYWNrZW5kX2dldF9lcnJvcl9kZXRhaWxzKGludAo+ID4gZXJyb3JfY29kZSwgZ2NoYXIgKmRl
c2MpCj4gPiAgdm9pZCBzcGljZV91c2JfYmFja2VuZF9yZXR1cm5fd3JpdGVfZGF0YShTcGljZVVz
YkJhY2tlbmRDaGFubmVsICpjaCwgdm9pZAo+ID4gICpkYXRhKQo+ID4gIHsKPiA+ICAgICAgaWYg
KGNoLT51c2JyZWRpcmhvc3QpIHsKPiA+IC0gICAgICAgIFNQSUNFX0RFQlVHKCIlcyBjaCAlcCIs
IF9fRlVOQ1RJT05fXywgY2gpOwo+ID4gKyAgICAgICAgU1BJQ0VfREVCVUcoIiVzIGNoICVwIC0+
IHVzYnJlZGlyaG9zdCIsIF9fRlVOQ1RJT05fXywgY2gpOwo+ID4gICAgICAgICAgdXNicmVkaXJo
b3N0X2ZyZWVfd3JpdGVfYnVmZmVyKGNoLT51c2JyZWRpcmhvc3QsIGRhdGEpOwo+ID4gKyAgICB9
IGVsc2UgaWYgKGNoLT5wYXJzZXIpIHsKPiA+ICsgICAgICAgIFNQSUNFX0RFQlVHKCIlcyBjaCAl
cCAtPiBwYXJzZXIiLCBfX0ZVTkNUSU9OX18sIGNoKTsKPiA+ICsgICAgICAgIHVzYnJlZGlycGFy
c2VyX2ZyZWVfd3JpdGVfYnVmZmVyKGNoLT5wYXJzZXIsIGRhdGEpOwo+Cj4gQSBiaXQgc2Nhcnkg
dGhhdCBkdXJpbmcgYSBzd2ljdGggaG9zdCA8LT4gcGFyc2VyIHRoaXMgY2FuIGNhbGwgdGhlIHdy
b25nCj4gZnVuY3Rpb24uIEJ1dCBjdXJyZW50bHkgdGhlIGltcGxlbWVudGF0aW9uIGZvciBib3Ro
IGlzIHRvIGZyZWUgJ2RhdGEnLgo+Cj4gPiAgICAgIH0gZWxzZSB7Cj4gPiAgICAgICAgICBTUElD
RV9ERUJVRygiJXMgY2ggJXAgLSBOT0JPRFkgVE8gQ0FMTCIsIF9fRlVOQ1RJT05fXywgY2gpOwo+
ID4gICAgICB9Cj4gPiAgfQo+ID4KPiA+ICtzdGF0aWMgdm9pZCB1c2JyZWRpcl9jb250cm9sX3Bh
Y2tldCh2b2lkICpwcml2LAo+ID4gKyAgICB1aW50NjRfdCBpZCwgc3RydWN0IHVzYl9yZWRpcl9j
b250cm9sX3BhY2tldF9oZWFkZXIgKmgsCj4gPiArICAgIHVpbnQ4X3QgKmRhdGEsIGludCBkYXRh
X2xlbikKPgo+IFRoaXMgc3R5bGUgaXMgbmV3LCBJIHN1cHBvc2UgY29waWVkIGZyb20gdXNicmVk
aXIsIGJ1dCBpcyBub3QKPiBzcGljZS1ndGsuCj4KPiA+ICt7Cj4gPiArICAgIFNwaWNlVXNiQmFj
a2VuZENoYW5uZWwgKmNoID0gcHJpdjsKPiA+ICsgICAgU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpk
ID0gY2gtPmF0dGFjaGVkOwo+ID4gKyAgICBTcGljZVVzYkVtdWxhdGVkRGV2aWNlICplZGV2ID0g
ZCA/IGQtPmVkZXYgOiBOVUxMOwo+ID4gKyAgICBzdHJ1Y3QgdXNiX3JlZGlyX2NvbnRyb2xfcGFj
a2V0X2hlYWRlciByZXNwb25zZSA9ICpoOwo+ID4gKyAgICB1aW50OF90IHJlcXR5cGUgPSBoLT5y
ZXF1ZXN0dHlwZSAmIDB4N2Y7Cj4gPiArICAgIGdib29sZWFuIGRvbmUgPSBGQUxTRTsKPiA+ICsg
ICAgdm9pZCAqb3V0X2J1ZmZlciA9IE5VTEw7Cj4gPiArCj4gPiArICAgIHJlc3BvbnNlLnN0YXR1
cyA9IHVzYl9yZWRpcl9zdGFsbDsKPiA+ICsgICAgU1BJQ0VfREVCVUcoIiVzICVwOiBUUlZJTCAl
MDJYICUwMlggJTA0WCAlMDRYICUwNFgiLAo+ID4gKyAgICAgICAgICAgICAgICBfX0ZVTkNUSU9O
X18sCj4gPiArICAgICAgICAgICAgICAgIGNoLCBoLT5yZXF1ZXN0dHlwZSwgaC0+cmVxdWVzdCwK
PiA+ICsgICAgICAgICAgICAgICAgaC0+dmFsdWUsIGgtPmluZGV4LCBoLT5sZW5ndGgpOwo+ID4g
Kwo+ID4gKyAgICBpZiAoIWVkZXYpIHsKPiA+ICsgICAgICAgIFNQSUNFX0RFQlVHKCIlczogZGV2
aWNlIG5vdCBhdHRhY2hlZCIsIF9fRlVOQ1RJT05fXyk7Cj4gPiArICAgICAgICByZXNwb25zZS5z
dGF0dXMgPSB1c2JfcmVkaXJfaW9lcnJvcjsKPiA+ICsgICAgICAgIGRvbmUgPSBUUlVFOwo+ID4g
KyAgICB9IGVsc2UgaWYgKHJlcXR5cGUgPT0gKExJQlVTQl9SRVFVRVNUX1RZUEVfU1RBTkRBUkQg
fAo+ID4gTElCVVNCX1JFQ0lQSUVOVF9ERVZJQ0UpICYmCj4gPiArICAgICAgICAgICAgICAgaC0+
cmVxdWVzdCA9PSBMSUJVU0JfUkVRVUVTVF9HRVRfREVTQ1JJUFRPUikgewo+ID4gKyAgICAgICAg
dWludDE2X3Qgc2l6ZTsKPiA+ICsgICAgICAgIGRvbmUgPSBkZXZpY2Vfb3BzKGVkZXYpLT5nZXRf
ZGVzY3JpcHRvcihlZGV2LCBoLT52YWx1ZSA+PiA4LAo+ID4gaC0+dmFsdWUgJiAweGZmLAo+ID4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZvdXRfYnVm
ZmVyLCAmc2l6ZSk7Cj4gPiArICAgICAgICByZXNwb25zZS5sZW5ndGggPSBzaXplOwo+ID4gKyAg
ICAgICAgaWYgKGRvbmUpIHsKPiA+ICsgICAgICAgICAgICByZXNwb25zZS5zdGF0dXMgPSAwOwo+
ID4gKyAgICAgICAgfQo+ID4gKyAgICAgICAgZG9uZSA9IFRSVUU7Cj4gPiArICAgIH0KPiA+ICsK
PiA+ICsgICAgaWYgKCFkb25lKSB7Cj4gPiArICAgICAgICBkZXZpY2Vfb3BzKGVkZXYpLT5jb250
cm9sX3JlcXVlc3QoZWRldiwgZGF0YSwgZGF0YV9sZW4sICZyZXNwb25zZSwKPiA+ICZvdXRfYnVm
ZmVyKTsKPiA+ICsgICAgICAgIGRvbmUgPSBUUlVFOwo+ID4gKyAgICB9Cj4gPiArCj4gPiArICAg
IGlmIChyZXNwb25zZS5zdGF0dXMpIHsKPiA+ICsgICAgICAgIHJlc3BvbnNlLmxlbmd0aCA9IDA7
Cj4gPiArICAgIH0gZWxzZSBpZiAocmVzcG9uc2UubGVuZ3RoID4gaC0+bGVuZ3RoKSB7Cj4gPiAr
ICAgICAgICByZXNwb25zZS5sZW5ndGggPSBoLT5sZW5ndGg7Cj4gPiArICAgIH0KPiA+ICsKPiA+
ICsgICAgU1BJQ0VfREVCVUcoIiVzIHJlc3BvbmRpbmcgd2l0aCBwYXlsb2FkIG9mICUwMlgsIHN0
YXR1cyAlWCIsCj4gPiArICAgICAgICAgICAgICAgIF9fRlVOQ1RJT05fXywgcmVzcG9uc2UubGVu
Z3RoLCByZXNwb25zZS5zdGF0dXMpOwo+ID4gKyAgICB1c2JyZWRpcnBhcnNlcl9zZW5kX2NvbnRy
b2xfcGFja2V0KGNoLT5wYXJzZXIsIGlkLCAmcmVzcG9uc2UsCj4gPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2UubGVuZ3RoID8gb3V0X2J1ZmZlciA6IE5V
TEwsCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2Uu
bGVuZ3RoKTsKPiA+ICsKPiA+ICsgICAgdXNicmVkaXJfd3JpdGVfZmx1c2hfY2FsbGJhY2soY2gp
Owo+ID4gKyAgICB1c2JyZWRpcnBhcnNlcl9mcmVlX3BhY2tldF9kYXRhKGNoLT5wYXJzZXIsIGRh
dGEpOwo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgdm9pZCB1c2JyZWRpcl9idWxrX3BhY2tldCh2
b2lkICpwcml2LAo+ID4gKyAgICB1aW50NjRfdCBpZCwgc3RydWN0IHVzYl9yZWRpcl9idWxrX3Bh
Y2tldF9oZWFkZXIgKmgsCj4gPiArICAgIHVpbnQ4X3QgKmRhdGEsIGludCBkYXRhX2xlbikKPiA+
ICt7Cj4gPiArICAgIFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmNoID0gcHJpdjsKPiA+ICsgICAg
U3BpY2VVc2JCYWNrZW5kRGV2aWNlICpkID0gY2gtPmF0dGFjaGVkOwo+ID4gKyAgICBTcGljZVVz
YkVtdWxhdGVkRGV2aWNlICplZGV2ID0gZCA/IGQtPmVkZXYgOiBOVUxMOwo+ID4gKyAgICBzdHJ1
Y3QgdXNiX3JlZGlyX2J1bGtfcGFja2V0X2hlYWRlciBob3V0ID0gKmg7Cj4gPiArICAgIHVpbnQz
Ml90IGxlbiA9IChoLT5sZW5ndGhfaGlnaCA8PCAxNikgfCBoLT5sZW5ndGg7Cj4gPiArICAgIFNQ
SUNFX0RFQlVHKCIlcyAlcDogZXAgJVgsIGxlbiAldSwgaWQgJSIgR19HVUlOVDY0X0ZPUk1BVCwg
X19GVU5DVElPTl9fLAo+ID4gKyAgICAgICAgICAgICAgICBjaCwgaC0+ZW5kcG9pbnQsIGxlbiwg
aWQpOwo+ID4gKwo+ID4gKyAgICBpZiAoIWVkZXYpIHsKPiA+ICsgICAgICAgIFNQSUNFX0RFQlVH
KCIlczogZGV2aWNlIG5vdCBhdHRhY2hlZCIsIF9fRlVOQ1RJT05fXyk7Cj4gPiArICAgICAgICBo
b3V0LnN0YXR1cyA9IHVzYl9yZWRpcl9pb2Vycm9yOwo+ID4gKyAgICAgICAgaG91dC5sZW5ndGgg
PSBob3V0Lmxlbmd0aF9oaWdoID0gMDsKPiA+ICsgICAgICAgIFNQSUNFX0RFQlVHKCIlczogcmVz
cG9uZGluZyB3aXRoIFpMUCBzdGF0dXMgJWQiLCBfX0ZVTkNUSU9OX18sCj4gPiBob3V0LnN0YXR1
cyk7Cj4gPiArICAgIH0gZWxzZSBpZiAoaC0+ZW5kcG9pbnQgJiBMSUJVU0JfRU5EUE9JTlRfSU4p
IHsKPiA+ICsgICAgICAgIGlmIChkZXZpY2Vfb3BzKGVkZXYpLT5idWxrX2luX3JlcXVlc3QoZWRl
diwgaWQsICZob3V0KSkgewo+ID4gKyAgICAgICAgICAgIHVzYnJlZGlycGFyc2VyX2ZyZWVfcGFj
a2V0X2RhdGEoY2gtPnBhcnNlciwgZGF0YSk7Cj4gPiArICAgICAgICAgICAgLyogY29tcGxldGlv
biBpcyBhc3luY2hyb25vdXMgKi8KPiA+ICsgICAgICAgICAgICByZXR1cm47Cj4gPiArICAgICAg
ICB9Cj4gPiArICAgIH0gZWxzZSB7Cj4gPiArICAgICAgICBob3V0LnN0YXR1cyA9IHVzYl9yZWRp
cl9zdGFsbDsKPiA+ICsgICAgICAgIGRldmljZV9vcHMoZWRldiktPmJ1bGtfb3V0X3JlcXVlc3Qo
ZWRldiwgaC0+ZW5kcG9pbnQsIGRhdGEsCj4gPiBkYXRhX2xlbiwgJmhvdXQuc3RhdHVzKTsKPiA+
ICsgICAgICAgIFNQSUNFX0RFQlVHKCIlczogcmVzcG9uZGluZyBzdGF0dXMgJWQiLCBfX0ZVTkNU
SU9OX18sIGhvdXQuc3RhdHVzKTsKPiA+ICsgICAgfQo+ID4gKwo+ID4gKyAgICB1c2JyZWRpcnBh
cnNlcl9zZW5kX2J1bGtfcGFja2V0KGNoLT5wYXJzZXIsIGlkLCAmaG91dCwgTlVMTCwgMCk7Cj4g
PiArICAgIHVzYnJlZGlycGFyc2VyX2ZyZWVfcGFja2V0X2RhdGEoY2gtPnBhcnNlciwgZGF0YSk7
Cj4gPiArICAgIHVzYnJlZGlyX3dyaXRlX2ZsdXNoX2NhbGxiYWNrKGNoKTsKPiA+ICt9Cj4gPiAr
Cj4gPiArc3RhdGljIHZvaWQgdXNicmVkaXJfZGV2aWNlX3Jlc2V0KHZvaWQgKnByaXYpCj4gPiAr
ewo+ID4gKyAgICBTcGljZVVzYkJhY2tlbmRDaGFubmVsICpjaCA9IHByaXY7Cj4gPiArICAgIFNw
aWNlVXNiQmFja2VuZERldmljZSAqZCA9IGNoLT5hdHRhY2hlZDsKPiA+ICsgICAgU3BpY2VVc2JF
bXVsYXRlZERldmljZSAqZWRldiA9IGQgPyBkLT5lZGV2IDogTlVMTDsKPiA+ICsgICAgU1BJQ0Vf
REVCVUcoIiVzIGNoICVwIiwgX19GVU5DVElPTl9fLCBjaCk7Cj4gPiArICAgIGlmIChlZGV2KSB7
Cj4gPiArICAgICAgICBkZXZpY2Vfb3BzKGVkZXYpLT5yZXNldChlZGV2KTsKPiA+ICsgICAgfQo+
ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgdm9pZCB1c2JyZWRpcl9pbnRlcmZhY2VfaW5mbyh2b2lk
ICpwcml2LAo+ID4gKyAgICBzdHJ1Y3QgdXNiX3JlZGlyX2ludGVyZmFjZV9pbmZvX2hlYWRlciAq
aW50ZXJmYWNlX2luZm8pCj4gPiArewo+ID4gKyAgICBTcGljZVVzYkJhY2tlbmRDaGFubmVsICpj
aCA9IHByaXY7Cj4gPiArICAgIFNQSUNFX0RFQlVHKCIlcyBub3QgaW1wbGVtZW50ZWQgJXAiLCBf
X0ZVTkNUSU9OX18sIGNoKTsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIHZvaWQgdXNicmVkaXJf
aW50ZXJmYWNlX2VwX2luZm8odm9pZCAqcHJpdiwKPiA+ICsgICAgc3RydWN0IHVzYl9yZWRpcl9l
cF9pbmZvX2hlYWRlciAqZXBfaW5mbykKPiA+ICt7Cj4gPiArICAgIFNwaWNlVXNiQmFja2VuZENo
YW5uZWwgKmNoID0gcHJpdjsKPiA+ICsgICAgU1BJQ0VfREVCVUcoIiVzIG5vdCBpbXBsZW1lbnRl
ZCAlcCIsIF9fRlVOQ1RJT05fXywgY2gpOwo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgdm9pZCB1
c2JyZWRpcl9zZXRfY29uZmlndXJhdGlvbih2b2lkICpwcml2LAo+ID4gKyAgICB1aW50NjRfdCBp
ZCwgc3RydWN0IHVzYl9yZWRpcl9zZXRfY29uZmlndXJhdGlvbl9oZWFkZXIKPiA+ICpzZXRfY29u
ZmlndXJhdGlvbikKPiA+ICt7Cj4gPiArICAgIFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmNoID0g
cHJpdjsKPiA+ICsgICAgc3RydWN0IHVzYl9yZWRpcl9jb25maWd1cmF0aW9uX3N0YXR1c19oZWFk
ZXIgaDsKPiA+ICsgICAgaC5zdGF0dXMgPSAwOwo+ID4gKyAgICBoLmNvbmZpZ3VyYXRpb24gPSBz
ZXRfY29uZmlndXJhdGlvbi0+Y29uZmlndXJhdGlvbjsKPiA+ICsgICAgU1BJQ0VfREVCVUcoIiVz
IGNoICVwLCBjZmcgJWQiLCBfX0ZVTkNUSU9OX18sIGNoLCBoLmNvbmZpZ3VyYXRpb24pOwo+ID4g
KyAgICBpZiAoY2gtPmF0dGFjaGVkKSB7Cj4gPiArICAgICAgICBjaC0+YXR0YWNoZWQtPmVkZXZf
Y29uZmlndXJlZCA9IGguY29uZmlndXJhdGlvbiAhPSAwOwo+ID4gKyAgICB9Cj4gPiArICAgIHVz
YnJlZGlycGFyc2VyX3NlbmRfY29uZmlndXJhdGlvbl9zdGF0dXMoY2gtPnBhcnNlciwgaWQsICZo
KTsKPiA+ICsgICAgdXNicmVkaXJfd3JpdGVfZmx1c2hfY2FsbGJhY2soY2gpOwo+ID4gK30KPiA+
ICsKPiA+ICtzdGF0aWMgdm9pZCB1c2JyZWRpcl9nZXRfY29uZmlndXJhdGlvbih2b2lkICpwcml2
LCB1aW50NjRfdCBpZCkKPiA+ICt7Cj4gPiArICAgIFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmNo
ID0gcHJpdjsKPiA+ICsgICAgc3RydWN0IHVzYl9yZWRpcl9jb25maWd1cmF0aW9uX3N0YXR1c19o
ZWFkZXIgaDsKPiA+ICsgICAgaC5zdGF0dXMgPSAwOwo+ID4gKyAgICBoLmNvbmZpZ3VyYXRpb24g
PSBjaC0+YXR0YWNoZWQgJiYgY2gtPmF0dGFjaGVkLT5lZGV2X2NvbmZpZ3VyZWQ7Cj4gPiArICAg
IFNQSUNFX0RFQlVHKCIlcyBjaCAlcCwgY2ZnICVkIiwgX19GVU5DVElPTl9fLCBjaCwgaC5jb25m
aWd1cmF0aW9uKTsKPiA+ICsgICAgdXNicmVkaXJwYXJzZXJfc2VuZF9jb25maWd1cmF0aW9uX3N0
YXR1cyhjaC0+cGFyc2VyLCBpZCwgJmgpOwo+ID4gKyAgICB1c2JyZWRpcl93cml0ZV9mbHVzaF9j
YWxsYmFjayhjaCk7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyB2b2lkIHVzYnJlZGlyX3NldF9h
bHRfc2V0dGluZyh2b2lkICpwcml2LAo+ID4gKyAgICB1aW50NjRfdCBpZCwgc3RydWN0IHVzYl9y
ZWRpcl9zZXRfYWx0X3NldHRpbmdfaGVhZGVyICpzKQo+ID4gK3sKPiA+ICsgICAgU3BpY2VVc2JC
YWNrZW5kQ2hhbm5lbCAqY2ggPSBwcml2Owo+ID4gKyAgICBzdHJ1Y3QgdXNiX3JlZGlyX2FsdF9z
ZXR0aW5nX3N0YXR1c19oZWFkZXIgc2g7Cj4gPiArICAgIHNoLnN0YXR1cyA9ICghcy0+aW50ZXJm
YWNlICYmICFzLT5hbHQpID8gMCA6IHVzYl9yZWRpcl9zdGFsbDsKPiA+ICsgICAgc2guaW50ZXJm
YWNlID0gcy0+aW50ZXJmYWNlOwo+ID4gKyAgICBzaC5hbHQgPSBzLT5hbHQ7Cj4gPiArICAgIFNQ
SUNFX0RFQlVHKCIlcyBjaCAlcCwgJWQ6JWQiLCBfX0ZVTkNUSU9OX18sIGNoLCBzLT5pbnRlcmZh
Y2UsIHMtPmFsdCk7Cj4gPiArICAgIHVzYnJlZGlycGFyc2VyX3NlbmRfYWx0X3NldHRpbmdfc3Rh
dHVzKGNoLT5wYXJzZXIsIGlkLCAmc2gpOwo+ID4gKyAgICB1c2JyZWRpcl93cml0ZV9mbHVzaF9j
YWxsYmFjayhjaCk7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyB2b2lkIHVzYnJlZGlyX2dldF9h
bHRfc2V0dGluZyh2b2lkICpwcml2LAo+ID4gKyAgICB1aW50NjRfdCBpZCwgc3RydWN0IHVzYl9y
ZWRpcl9nZXRfYWx0X3NldHRpbmdfaGVhZGVyICpzKQo+ID4gK3sKPiA+ICsgICAgU3BpY2VVc2JC
YWNrZW5kQ2hhbm5lbCAqY2ggPSBwcml2Owo+ID4gKyAgICBzdHJ1Y3QgdXNiX3JlZGlyX2FsdF9z
ZXR0aW5nX3N0YXR1c19oZWFkZXIgc2g7Cj4gPiArICAgIHNoLnN0YXR1cyA9IChzLT5pbnRlcmZh
Y2UgPT0gMCkgPyAwIDogdXNiX3JlZGlyX3N0YWxsOwo+ID4gKyAgICBzaC5pbnRlcmZhY2UgPSBz
LT5pbnRlcmZhY2U7Cj4gPiArICAgIHNoLmFsdCA9IDA7Cj4gPiArICAgIFNQSUNFX0RFQlVHKCIl
cyBjaCAlcCwgaWYgJWQiLCBfX0ZVTkNUSU9OX18sIGNoLCBzLT5pbnRlcmZhY2UpOwo+ID4gKyAg
ICB1c2JyZWRpcnBhcnNlcl9zZW5kX2FsdF9zZXR0aW5nX3N0YXR1cyhjaC0+cGFyc2VyLCBpZCwg
JnNoKTsKPiA+ICsgICAgdXNicmVkaXJfd3JpdGVfZmx1c2hfY2FsbGJhY2soY2gpOwo+ID4gK30K
PiA+ICsKPiA+ICtzdGF0aWMgdm9pZCB1c2JyZWRpcl9jYW5jZWxfZGF0YSh2b2lkICpwcml2LCB1
aW50NjRfdCBpZCkKPiA+ICt7Cj4gPiArICAgIFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmNoID0g
cHJpdjsKPiA+ICsgICAgU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpkID0gY2gtPmF0dGFjaGVkOwo+
ID4gKyAgICBTcGljZVVzYkVtdWxhdGVkRGV2aWNlICplZGV2ID0gZCA/IGQtPmVkZXYgOiBOVUxM
Owo+ID4gKyAgICBpZiAoIWVkZXYpIHsKPiA+ICsgICAgICAgIFNQSUNFX0RFQlVHKCIlczogZGV2
aWNlIG5vdCBhdHRhY2hlZCIsIF9fRlVOQ1RJT05fXyk7Cj4gPiArICAgICAgICByZXR1cm47Cj4g
PiArICAgIH0KPiA+ICsgICAgZGV2aWNlX29wcyhlZGV2KS0+Y2FuY2VsX3JlcXVlc3QoZWRldiwg
aWQpOwo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgdm9pZCB1c2JyZWRpcl9maWx0ZXJfcmVqZWN0
KHZvaWQgKnByaXYpCj4gPiArewo+ID4gKyAgICBTcGljZVVzYkJhY2tlbmRDaGFubmVsICpjaCA9
IHByaXY7Cj4gPiArICAgIFNQSUNFX0RFQlVHKCIlcyAlcCIsIF9fRlVOQ1RJT05fXywgY2gpOwo+
ID4gKyAgICBjaC0+cmVqZWN0ZWQgPSAxOwo+ID4gK30KPiA+ICsKPiA+ICsvKiBOb3RlIHRoYXQg
dGhlIG93bmVyc2hpcCBvZiB0aGUgcnVsZXMgYXJyYXkgaXMgcGFzc2VkIG9uIHRvIHRoZSBjYWxs
YmFjay4KPiA+ICovCj4gPiArc3RhdGljIHZvaWQgdXNicmVkaXJfZmlsdGVyX2ZpbHRlcih2b2lk
ICpwcml2LAo+ID4gKyAgICBzdHJ1Y3QgdXNicmVkaXJmaWx0ZXJfcnVsZSAqciwgaW50IGNvdW50
KQo+ID4gK3sKPiA+ICsgICAgU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCAqY2ggPSBwcml2Owo+ID4g
KyAgICBTUElDRV9ERUJVRygiJXMgY2ggJXAgJWQgZmlsdGVycyIsIF9fRlVOQ1RJT05fXywgY2gs
IGNvdW50KTsKPiA+ICsKPiA+ICsgICAgZnJlZShjaC0+cnVsZXMpOwo+ID4gKwo+ID4gKyAgICBj
aC0+cnVsZXMgPSByOwo+ID4gKyAgICBjaC0+cnVsZXNfY291bnQgPSBjb3VudDsKPiA+ICsgICAg
aWYgKGNvdW50KSB7Cj4gPiArICAgICAgICBpbnQgaTsKPiA+ICsgICAgICAgIGZvciAoaSA9IDA7
IGkgPCBjb3VudDsgaSsrKSB7Cj4gPiArICAgICAgICAgICAgU1BJQ0VfREVCVUcoIiVzIGNsYXNz
ICVkLCAlWDolWCIsCj4gPiArICAgICAgICAgICAgICAgIHJbaV0uYWxsb3cgPyAiYWxsb3dlZCIg
OiAiZGVuaWVkIiwgcltpXS5kZXZpY2VfY2xhc3MsCj4gPiArICAgICAgICAgICAgICAgICh1aW50
MzJfdClyW2ldLnZlbmRvcl9pZCwgKHVpbnQzMl90KXJbaV0ucHJvZHVjdF9pZCk7Cj4gPiArICAg
ICAgICB9Cj4gPiArICAgIH0KPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIHZvaWQgdXNicmVkaXJf
ZGV2aWNlX2Rpc2Nvbm5lY3RfYWNrKHZvaWQgKnByaXYpCj4gPiArewo+ID4gKyAgICBTcGljZVVz
YkJhY2tlbmRDaGFubmVsICpjaCA9IHByaXY7Cj4gPiArICAgIFNQSUNFX0RFQlVHKCIlcyBjaCAl
cCIsIF9fRlVOQ1RJT05fXywgY2gpOwo+ID4gKyAgICBpZiAoY2gtPnBhcnNlciAmJiBjaC0+d2Fp
dF9kaXNjX2Fjaykgewo+ID4gKyAgICAgICAgY2gtPnBhcnNlciA9IE5VTEw7Cj4gPiArICAgICAg
ICBTUElDRV9ERUJVRygiJXMgc3dpdGNoIHRvIHVzYnJlZGlyaG9zdCIsIF9fRlVOQ1RJT05fXyk7
Cj4gPiArICAgICAgICBjaC0+dXNicmVkaXJob3N0ID0gY2gtPmhpZGRlbl9ob3N0Owo+ID4gKyAg
ICB9Cj4gPiArICAgIGNoLT53YWl0X2Rpc2NfYWNrID0gMDsKPiA+ICt9Cj4gPiArCj4gPiArc3Rh
dGljIHZvaWQgdXNicmVkaXJfaGVsbG8odm9pZCAqcHJpdiwKPiA+ICsgICAgc3RydWN0IHVzYl9y
ZWRpcl9oZWxsb19oZWFkZXIgKmhlbGxvKQo+ID4gK3sKPiA+ICsgICAgU3BpY2VVc2JCYWNrZW5k
Q2hhbm5lbCAqY2ggPSBwcml2Owo+ID4gKyAgICBTcGljZVVzYkJhY2tlbmREZXZpY2UgKmQgPSBj
aC0+YXR0YWNoZWQ7Cj4gPiArICAgIFNwaWNlVXNiRW11bGF0ZWREZXZpY2UgKmVkZXYgPSBkID8g
ZC0+ZWRldiA6IE5VTEw7Cj4gPiArICAgIHN0cnVjdCB1c2JfcmVkaXJfZGV2aWNlX2Nvbm5lY3Rf
aGVhZGVyIGRldmljZV9jb25uZWN0Owo+ID4gKyAgICBzdHJ1Y3QgdXNiX3JlZGlyX2VwX2luZm9f
aGVhZGVyIGVwX2luZm8gPSB7IDAgfTsKPiA+ICsgICAgc3RydWN0IHVzYl9yZWRpcl9pbnRlcmZh
Y2VfaW5mb19oZWFkZXIgaW50ZXJmYWNlX2luZm8gPSB7IDAgfTsKPiA+ICsgICAgdWludDhfdCAq
Y2ZnOwo+ID4gKyAgICB1aW50MTZfdCBzaXplLCBvZmZzZXQgPSAwOwo+ID4gKyAgICBTUElDRV9E
RUJVRygiJXMgJXAgJXNhdHRhY2hlZCAlcyIsIF9fRlVOQ1RJT05fXywgY2gsCj4gPiArICAgICAg
ICBlZGV2ID8gIiIgOiAibm90ICIsICBoZWxsbyA/ICIiIDogIihpbnRlcm5hbCkiKTsKPiA+ICsK
PiA+ICsgICAgaWYgKGhlbGxvKSB7Cj4gPiArICAgICAgICBjaC0+aGVsbG9fZG9uZV9wYXJzZXIg
PSAxOwo+ID4gKyAgICB9Cj4gPiArICAgIGlmICghZWRldikgewo+ID4gKyAgICAgICAgcmV0dXJu
Owo+ID4gKyAgICB9Cj4gPiArICAgIGlmICghZGV2aWNlX29wcyhlZGV2KS0+Z2V0X2Rlc2NyaXB0
b3IoZWRldiwgTElCVVNCX0RUX0NPTkZJRywgMCwgKHZvaWQKPiA+ICoqKSZjZmcsICZzaXplKSkg
ewo+ID4gKyAgICAgICAgcmV0dXJuOwo+ID4gKyAgICB9Cj4gPiArICAgIHdoaWxlICgob2Zmc2V0
ICsgMSkgPCBzaXplKSB7Cj4gPiArICAgICAgICB1aW50OF90IGxlbiAgPSBjZmdbb2Zmc2V0XTsK
PiA+ICsgICAgICAgIHVpbnQ4X3QgdHlwZSA9IGNmZ1tvZmZzZXQgKyAxXTsKPiA+ICsgICAgICAg
IGlmICgob2Zmc2V0ICsgbGVuKSA+IHNpemUpIHsKPiA+ICsgICAgICAgICAgICBicmVhazsKPiA+
ICsgICAgICAgIH0KPiA+ICsgICAgICAgIGlmICh0eXBlID09IExJQlVTQl9EVF9JTlRFUkZBQ0Up
IHsKPiA+ICsgICAgICAgICAgICB1aW50MzJfdCBpID0gaW50ZXJmYWNlX2luZm8uaW50ZXJmYWNl
X2NvdW50Owo+ID4gKyAgICAgICAgICAgIHVpbnQ4X3QgY2xhc3MsIHN1YmNsYXNzLCBwcm90b2Nv
bDsKPiA+ICsgICAgICAgICAgICBjbGFzcyA9IGNmZ1tvZmZzZXQgKyA1XTsKPiA+ICsgICAgICAg
ICAgICBzdWJjbGFzcyA9IGNmZ1tvZmZzZXQgKyA2XTsKPiA+ICsgICAgICAgICAgICBwcm90b2Nv
bCA9IGNmZ1tvZmZzZXQgKyA3XTsKPiA+ICsgICAgICAgICAgICBpbnRlcmZhY2VfaW5mby5pbnRl
cmZhY2VfY2xhc3NbaV0gPSBjbGFzczsKPiA+ICsgICAgICAgICAgICBpbnRlcmZhY2VfaW5mby5p
bnRlcmZhY2Vfc3ViY2xhc3NbaV0gPSBzdWJjbGFzczsKPiA+ICsgICAgICAgICAgICBpbnRlcmZh
Y2VfaW5mby5pbnRlcmZhY2VfcHJvdG9jb2xbaV0gPSBwcm90b2NvbDsKPiA+ICsgICAgICAgICAg
ICBpbnRlcmZhY2VfaW5mby5pbnRlcmZhY2VfY291bnQrKzsKPiA+ICsgICAgICAgICAgICBTUElD
RV9ERUJVRygiJXMgSUYlZDogJWQvJWQvJWQiLCBfX0ZVTkNUSU9OX18sIGksIGNsYXNzLAo+ID4g
c3ViY2xhc3MsIHByb3RvY29sKTsKPiA+ICsgICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PSBMSUJV
U0JfRFRfRU5EUE9JTlQpIHsKPiA+ICsgICAgICAgICAgICB1aW50OF90IGFkZHJlc3MgPSBjZmdb
b2Zmc2V0ICsgMl07Cj4gPiArICAgICAgICAgICAgdWludDE2X3QgbWF4X3BhY2tldF9zaXplID0g
MHgxMDAgKiBjZmdbb2Zmc2V0ICsgNV0gKyBjZmdbb2Zmc2V0Cj4gPiArIDRdOwo+ID4gKyAgICAg
ICAgICAgIHVpbnQ4X3QgaW5kZXggPSBhZGRyZXNzICYgMHhmOwo+ID4gKyAgICAgICAgICAgIGlm
IChhZGRyZXNzICYgMHg4MCkgaW5kZXggKz0gMHgxMDsKPiA+ICsgICAgICAgICAgICBlcF9pbmZv
LnR5cGVbaW5kZXhdID0gY2ZnW29mZnNldCArIDNdICYgMHgzOwo+ID4gKyAgICAgICAgICAgIGVw
X2luZm8ubWF4X3BhY2tldF9zaXplW2luZGV4XSA9IG1heF9wYWNrZXRfc2l6ZTsKPiA+ICsgICAg
ICAgICAgICBTUElDRV9ERUJVRygiJXMgRVBbJTAyWF06ICVkLyVkIiwgX19GVU5DVElPTl9fLCBp
bmRleCwKPiA+IGVwX2luZm8udHlwZVtpbmRleF0sIG1heF9wYWNrZXRfc2l6ZSk7Cj4gPiArICAg
ICAgICB9Cj4gPiArICAgICAgICBvZmZzZXQgKz0gbGVuOwo+ID4gKyAgICB9Cj4gPiArCj4gPiAr
ICAgIHVzYnJlZGlycGFyc2VyX3NlbmRfaW50ZXJmYWNlX2luZm8oY2gtPnBhcnNlciwgJmludGVy
ZmFjZV9pbmZvKTsKPiA+ICsgICAgdXNicmVkaXJwYXJzZXJfc2VuZF9lcF9pbmZvKGNoLT5wYXJz
ZXIsICZlcF9pbmZvKTsKPiA+ICsKPiA+ICsgICAgZGV2aWNlX2Nvbm5lY3QuZGV2aWNlX2NsYXNz
ID0gMDsgLy9kLT5kZXZpY2VfaW5mby5jbGFzczsKPiA+ICsgICAgZGV2aWNlX2Nvbm5lY3QuZGV2
aWNlX3N1YmNsYXNzID0gMDsgLy9kLT5kZXZpY2VfaW5mby5zdWJjbGFzczsKPiA+ICsgICAgZGV2
aWNlX2Nvbm5lY3QuZGV2aWNlX3Byb3RvY29sID0gMDsgLy9kLT5kZXZpY2VfaW5mby5wcm90b2Nv
bDs7Cj4gPiArICAgIGRldmljZV9jb25uZWN0LnZlbmRvcl9pZCA9IGQtPmRldmljZV9pbmZvLnZp
ZDsKPiA+ICsgICAgZGV2aWNlX2Nvbm5lY3QucHJvZHVjdF9pZCA9IGQtPmRldmljZV9pbmZvLnBp
ZDsKPiA+ICsgICAgZGV2aWNlX2Nvbm5lY3QuZGV2aWNlX3ZlcnNpb25fYmNkID0gZC0+ZGV2aWNl
X2luZm8uYmNkVVNCOwo+ID4gKyAgICBkZXZpY2VfY29ubmVjdC5zcGVlZCA9IHVzYl9yZWRpcl9z
cGVlZF9oaWdoOwo+ID4gKyAgICB1c2JyZWRpcnBhcnNlcl9zZW5kX2RldmljZV9jb25uZWN0KGNo
LT5wYXJzZXIsICZkZXZpY2VfY29ubmVjdCk7Cj4gPiArICAgIHVzYnJlZGlyX3dyaXRlX2ZsdXNo
X2NhbGxiYWNrKGNoKTsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIHZvaWQgaW5pdGlhbGl6ZV9w
YXJzZXIoU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCAqY2gsIGdib29sZWFuIGRvX2hlbGxvKQo+ID4g
K3sKPiA+ICsgICAgdWludDMyX3QgZmxhZ3MsIGNhcHNbVVNCX1JFRElSX0NBUFNfU0laRV0gPSB7
IDAgfTsKPiA+ICsKPiA+ICsgICAgZ19yZXR1cm5faWZfZmFpbChjaC0+aGlkZGVuX3BhcnNlciAh
PSBOVUxMKTsKPiA+ICsgICAgaWYgKGNoLT5wYXJzZXJfaW5pdF9kb25lKSB7Cj4gPiArICAgICAg
ICBpZiAoY2gtPnBhcnNlcl93aXRoX2hlbGxvICE9IGRvX2hlbGxvKSB7Cj4gPiArICAgICAgICAg
ICAgZ19yZXR1cm5faWZfcmVhY2hlZCgpOwo+ID4gKyAgICAgICAgfQo+ID4gKyAgICAgICAgcmV0
dXJuOwo+ID4gKyAgICB9Cj4gPiArCj4gPiArICAgIGNoLT5wYXJzZXJfaW5pdF9kb25lID0gMTsK
PiA+ICsgICAgY2gtPnBhcnNlcl93aXRoX2hlbGxvID0gZG9faGVsbG87Cj4gPiArICAgIGZsYWdz
ID0gdXNicmVkaXJwYXJzZXJfZmxfd3JpdGVfY2Jfb3duc19idWZmZXIgfAo+ID4gdXNicmVkaXJw
YXJzZXJfZmxfdXNiX2hvc3Q7Cj4gPiArCj4gPiArICAgIGlmIChkb19oZWxsbykgewo+ID4gKyAg
ICAgICAgY2gtPmhlbGxvX3NlbnQgPSAxOwo+Cj4gSW4gd2hpY2ggY2FzZSB5b3UgbmVlZCB0byBk
byB0aGUgaGVsbG8gaW4gdGhlIHBhcnNlciBpbnN0ZWFkIG9mIHRoZSBob3N0Pwo+IFRoaXMgY291
bGQgY2F1c2UgaXNzdWVzIHN3aXRjaGluZyBmcm9tIHBhcnNlciBiYWNrIHRvIGhvc3QgaW4gY2Fz
ZSB5b3UKPiByZW1vdmUgYW4gZW11bGF0ZWQgZGV2aWNlIGFuZCB5b3UgYWRkIGEgcmVhbCBvbmUu
CgpUaGUgY2FzZSBpcyBkZXNjcmliZWQgYWJvdmUuIEZyb20gbXkgcG9pbnQgb2YgdmlldywgaGF2
aW5nIGJvdGgKKHVzYnJlZGlyaG9zdCBhbmQgcGFyc2VyKSByZWFkeSBhbmQgc3dpdGNoCmFjY29y
ZGluZyB0byB0aGUgY3VycmVudCBuZWVkIGlzIHRoZSBzaW1wbGVzdCB3YXkgdG8gZG8gdGhlIGpv
Yi4KCj4KPiA+ICsgICAgICAgIGNoLT5ob3N0X2NhcHMgfD0gMSA8PCB1c2JfcmVkaXJfY2FwX2Nv
bm5lY3RfZGV2aWNlX3ZlcnNpb247Cj4gPiArICAgICAgICBjaC0+aG9zdF9jYXBzIHw9IDEgPDwg
dXNiX3JlZGlyX2NhcF9kZXZpY2VfZGlzY29ubmVjdF9hY2s7Cj4gPiArICAgICAgICBjaC0+aG9z
dF9jYXBzIHw9IDEgPDwgdXNiX3JlZGlyX2NhcF9lcF9pbmZvX21heF9wYWNrZXRfc2l6ZTsKPiA+
ICsgICAgICAgIGNoLT5ob3N0X2NhcHMgfD0gMSA8PCB1c2JfcmVkaXJfY2FwXzY0Yml0c19pZHM7
Cj4gPiArICAgICAgICBjaC0+aG9zdF9jYXBzIHw9IDEgPDwgdXNiX3JlZGlyX2NhcF8zMmJpdHNf
YnVsa19sZW5ndGg7Cj4gPiArICAgIH0gZWxzZSB7Cj4gPiArICAgICAgICBmbGFncyB8PSB1c2Jy
ZWRpcnBhcnNlcl9mbF9ub19oZWxsbzsKPiA+ICsgICAgfQo+ID4gKwo+ID4gKyAgICBpZiAoY2gt
Pmhvc3RfY2FwcyAmICgxIDw8IHVzYl9yZWRpcl9jYXBfY29ubmVjdF9kZXZpY2VfdmVyc2lvbikp
IHsKPiA+ICsgICAgICAgIHVzYnJlZGlycGFyc2VyX2NhcHNfc2V0X2NhcChjYXBzLAo+ID4gdXNi
X3JlZGlyX2NhcF9jb25uZWN0X2RldmljZV92ZXJzaW9uKTsKPiA+ICsgICAgfQo+ID4gKyAgICB1
c2JyZWRpcnBhcnNlcl9jYXBzX3NldF9jYXAoY2FwcywgdXNiX3JlZGlyX2NhcF9maWx0ZXIpOwo+
ID4gKyAgICBpZiAoY2gtPmhvc3RfY2FwcyAmICgxIDw8IHVzYl9yZWRpcl9jYXBfZGV2aWNlX2Rp
c2Nvbm5lY3RfYWNrKSkgewo+ID4gKyAgICAgICAgdXNicmVkaXJwYXJzZXJfY2Fwc19zZXRfY2Fw
KGNhcHMsCj4gPiB1c2JfcmVkaXJfY2FwX2RldmljZV9kaXNjb25uZWN0X2Fjayk7Cj4gPiArICAg
IH0KPiA+ICsgICAgaWYgKGNoLT5ob3N0X2NhcHMgJiAoMSA8PCB1c2JfcmVkaXJfY2FwX2VwX2lu
Zm9fbWF4X3BhY2tldF9zaXplKSkgewo+ID4gKyAgICAgICAgdXNicmVkaXJwYXJzZXJfY2Fwc19z
ZXRfY2FwKGNhcHMsCj4gPiB1c2JfcmVkaXJfY2FwX2VwX2luZm9fbWF4X3BhY2tldF9zaXplKTsK
PiA+ICsgICAgfQo+ID4gKyAgICBpZiAoY2gtPmhvc3RfY2FwcyAmICgxIDw8IHVzYl9yZWRpcl9j
YXBfNjRiaXRzX2lkcykpIHsKPiA+ICsgICAgICAgIHVzYnJlZGlycGFyc2VyX2NhcHNfc2V0X2Nh
cChjYXBzLCB1c2JfcmVkaXJfY2FwXzY0Yml0c19pZHMpOwo+ID4gKyAgICB9Cj4gPiArICAgIGlm
IChjaC0+aG9zdF9jYXBzICYgKDEgPDwgdXNiX3JlZGlyX2NhcF8zMmJpdHNfYnVsa19sZW5ndGgp
KSB7Cj4gPiArICAgICAgICB1c2JyZWRpcnBhcnNlcl9jYXBzX3NldF9jYXAoY2FwcywgdXNiX3Jl
ZGlyX2NhcF8zMmJpdHNfYnVsa19sZW5ndGgpOwo+ID4gKyAgICB9Cj4gPiArICAgIGlmIChjaC0+
aG9zdF9jYXBzICYgKDEgPDwgdXNiX3JlZGlyX2NhcF9idWxrX3N0cmVhbXMpKSB7Cj4gPiArICAg
ICAgICB1c2JyZWRpcnBhcnNlcl9jYXBzX3NldF9jYXAoY2FwcywgdXNiX3JlZGlyX2NhcF9idWxr
X3N0cmVhbXMpOwo+ID4gKyAgICB9Cj4gPiArICAgIHVzYnJlZGlycGFyc2VyX2luaXQoY2gtPmhp
ZGRlbl9wYXJzZXIsIFBBQ0tBR0VfU1RSSU5HLCBjYXBzLAo+ID4gVVNCX1JFRElSX0NBUFNfU0la
RSwgZmxhZ3MpOwo+ID4gK30KPiA+ICsKPiA+ICsvKgo+ID4gKyAgICBXZSBjYW4gaW5pdGlhbGl6
ZSB0aGUgdXNicmVkaXJwYXJzZXIgd2l0aCBIRUxMTyBlbmFibGVkIG9ubHkgaW4gY2FzZQo+ID4g
KyAgICB0aGUgbGlidXNiIGlzIG5vdCBhY3RpdmUgYW5kIHRoZSB1c2JyZWRpcmhvc3QgZG9lcyBu
b3QgZnVuY3Rpb24uCj4gPiArICAgIFRoZW4gdGhlIHBhcnNlciBzZW5kcyBzZXNzaW9uIEhFTExP
IGFuZCByZWNlaXZlcyBzZXJ2ZXIncyByZXNwb25zZS4KPiA+ICsgICAgT3RoZXJ3aXNlICh1c2Jy
ZWRpcnBhcnNlciBpbml0aWFsaXplZCB3aXRoIEhFTExPIGRpc2FibGVkKToKPiA+ICsgICAgLSB0
aGUgdXNicmVkaXJob3N0IHNlbmRzIHNlc3Npb24gSEVMTE8KPiA+ICsgICAgLSB3ZSBsb29rIGlu
dG8gaXQgdG8ga25vdyBzZXQgb2YgY2FwYWJpbGl0aWVzIHdlIHNoYWxsIGluaXRpYWxpemUKPiA+
ICsgICAgICB0aGUgcGFyc2VyIHdpdGgKPiA+ICsgICAgLSB3aGVuIHdlIHJlY2VpdmUgc2VydmVy
J3MgcmVzcG9uc2UgdG8gSEVMTE8gd2UgcHJvdmlkZSBpdCBhbHNvIHRvCj4gPiArICAgICAgcGFy
c2VyIHRvIGxldCBpdCBzeW5jaHJvbml6ZSB3aXRoIHNlcnZlcidzIGNhcGFiaWxpdGllcwo+ID4g
KyovCj4gPiArc3RhdGljIHN0cnVjdCB1c2JyZWRpcnBhcnNlciAqY3JlYXRlX3BhcnNlcihTcGlj
ZVVzYkJhY2tlbmRDaGFubmVsICpjaCkKPiA+ICt7Cj4gPiArICAgIHN0cnVjdCB1c2JyZWRpcnBh
cnNlciAqcGFyc2VyID0gdXNicmVkaXJwYXJzZXJfY3JlYXRlKCk7Cj4gPiArCj4gPiArICAgIGdf
cmV0dXJuX3ZhbF9pZl9mYWlsKHBhcnNlciAhPSBOVUxMLCBOVUxMKTsKPiA+ICsKPiA+ICsgICAg
cGFyc2VyLT5wcml2ID0gY2g7Cj4gPiArICAgIHBhcnNlci0+bG9nX2Z1bmMgPSB1c2JyZWRpcl9s
b2c7Cj4gPiArICAgIHBhcnNlci0+cmVhZF9mdW5jID0gdXNicmVkaXJfcmVhZF9jYWxsYmFjazsK
PiA+ICsgICAgcGFyc2VyLT53cml0ZV9mdW5jID0gdXNicmVkaXJfd3JpdGVfY2FsbGJhY2s7Cj4g
PiArICAgIHBhcnNlci0+cmVzZXRfZnVuYyA9IHVzYnJlZGlyX2RldmljZV9yZXNldDsKPiA+ICsg
ICAgcGFyc2VyLT5zZXRfY29uZmlndXJhdGlvbl9mdW5jID0gdXNicmVkaXJfc2V0X2NvbmZpZ3Vy
YXRpb247Cj4gPiArICAgIHBhcnNlci0+Z2V0X2NvbmZpZ3VyYXRpb25fZnVuYyA9IHVzYnJlZGly
X2dldF9jb25maWd1cmF0aW9uOwo+ID4gKyAgICBwYXJzZXItPnNldF9hbHRfc2V0dGluZ19mdW5j
ID0gdXNicmVkaXJfc2V0X2FsdF9zZXR0aW5nOwo+ID4gKyAgICBwYXJzZXItPmdldF9hbHRfc2V0
dGluZ19mdW5jID0gdXNicmVkaXJfZ2V0X2FsdF9zZXR0aW5nOwo+ID4gKyAgICBwYXJzZXItPmNh
bmNlbF9kYXRhX3BhY2tldF9mdW5jID0gdXNicmVkaXJfY2FuY2VsX2RhdGE7Cj4gPiArICAgIHBh
cnNlci0+Y29udHJvbF9wYWNrZXRfZnVuYyA9IHVzYnJlZGlyX2NvbnRyb2xfcGFja2V0Owo+ID4g
KyAgICBwYXJzZXItPmJ1bGtfcGFja2V0X2Z1bmMgPSB1c2JyZWRpcl9idWxrX3BhY2tldDsKPiA+
ICsgICAgcGFyc2VyLT5hbGxvY19sb2NrX2Z1bmMgPSB1c2JyZWRpcl9hbGxvY19sb2NrOwo+ID4g
KyAgICBwYXJzZXItPmxvY2tfZnVuYyA9IHVzYnJlZGlyX2xvY2tfbG9jazsKPiA+ICsgICAgcGFy
c2VyLT51bmxvY2tfZnVuYyA9IHVzYnJlZGlyX3VubG9ja19sb2NrOwo+ID4gKyAgICBwYXJzZXIt
PmZyZWVfbG9ja19mdW5jID0gdXNicmVkaXJfZnJlZV9sb2NrOwo+ID4gKyAgICBwYXJzZXItPmhl
bGxvX2Z1bmMgPSB1c2JyZWRpcl9oZWxsbzsKPiA+ICsgICAgcGFyc2VyLT5maWx0ZXJfcmVqZWN0
X2Z1bmMgPSB1c2JyZWRpcl9maWx0ZXJfcmVqZWN0Owo+ID4gKyAgICBwYXJzZXItPmRldmljZV9k
aXNjb25uZWN0X2Fja19mdW5jID0gdXNicmVkaXJfZGV2aWNlX2Rpc2Nvbm5lY3RfYWNrOwo+ID4g
KyAgICBwYXJzZXItPmludGVyZmFjZV9pbmZvX2Z1bmMgPSB1c2JyZWRpcl9pbnRlcmZhY2VfaW5m
bzsKPiA+ICsgICAgcGFyc2VyLT5lcF9pbmZvX2Z1bmMgPSB1c2JyZWRpcl9pbnRlcmZhY2VfZXBf
aW5mbzsKPiA+ICsgICAgcGFyc2VyLT5maWx0ZXJfZmlsdGVyX2Z1bmMgPSB1c2JyZWRpcl9maWx0
ZXJfZmlsdGVyOwo+ID4gKwo+ID4gKyAgICByZXR1cm4gcGFyc2VyOwo+ID4gK30KPiA+ICsKPiA+
ICtzdGF0aWMgZ2Jvb2xlYW4gYXR0YWNoX2VkZXYoU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCAqY2gs
Cj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNwaWNlVXNiQmFja2VuZERldmljZSAq
ZGV2LAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBHRXJyb3IgKiplcnJvcikKPiA+
ICt7Cj4gPiArICAgIGlmICghZGV2LT5lZGV2KSB7Cj4gPiArICAgICAgICBnX3NldF9lcnJvcihl
cnJvciwgU1BJQ0VfQ0xJRU5UX0VSUk9SLCBTUElDRV9DTElFTlRfRVJST1JfRkFJTEVELAo+ID4g
KyAgICAgICAgICAgXygiRmFpbGVkIHRvIHJlZGlyZWN0IGRldmljZSAlZCIpLCAxKTsKPgo+IE1p
bm9yOiBJIHdvdWxkIHNheSBtb3JlIGFuIGFzc2VydCBsZXZlbCBlcnJvciwgdGhlIGRldmljZSBz
aG91bGQgYmUgcmVhbCBvciBlbXVsYXRlZC4KPgo+ID4gKyAgICAgICAgcmV0dXJuIEZBTFNFOwo+
ID4gKyAgICB9Cj4gPiArICAgIGlmIChjaC0+dXNicmVkaXJob3N0ICYmICFjaC0+aGVsbG9fZG9u
ZV9wYXJzZXIpIHsKPiA+ICsgICAgICAgIC8qCj4gPiArICAgICAgICAgICAgd2UgY2FuJ3QgaW5p
dGlhbGl6ZSBwYXJzZXIgdW50aWwgd2Ugc2VlIGhlbGxvIGZyb20gdXNicmVkaXIKPiA+ICsgICAg
ICAgICAgICBhbmQgdGhlIHBhcnNlciBjYW4ndCB3b3JrIHVudGlsIGl0IHNlZXMgdGhlIGhlbGxv
IHJlc3BvbnNlLgo+ID4gKyAgICAgICAgICAgIHRoaXMgaXMgY2FzZSBvZiBhdXRvY29ubmVjdCB3
aGVuIGVtdWxhdGVkIGRldmljZSBpcyBhdHRhY2hlZAo+ID4gKyAgICAgICAgICAgIGJlZm9yZSB0
aGUgY2hhbm5lbCBpcyB1cAo+ID4gKyAgICAgICAgKi8KPiA+ICsgICAgICAgIFNQSUNFX0RFQlVH
KCIlcyB3YWl0aW5nIHVudGlsIHRoZSBjaGFubmVsIGlzIHJlYWR5IiwgX19GVU5DVElPTl9fKTsK
PiA+ICsKPiA+ICsgICAgfSBlbHNlIHsKPiA+ICsgICAgICAgIGluaXRpYWxpemVfcGFyc2VyKGNo
LCBjaC0+aGlkZGVuX2hvc3QgPT0gTlVMTCk7Cj4gPiArICAgICAgICBjaC0+dXNicmVkaXJob3N0
ID0gTlVMTDsKPiA+ICsgICAgICAgIGNoLT5wYXJzZXIgPSBjaC0+aGlkZGVuX3BhcnNlcjsKPiA+
ICsgICAgfQo+ID4gKyAgICBjaC0+d2FpdF9kaXNjX2FjayA9IDA7Cj4gPiArICAgIGNoLT5hdHRh
Y2hlZCA9IGRldjsKPiA+ICsgICAgZGV2LT5hdHRhY2hlZF90byA9IGNoOwo+ID4gKyAgICBkZXZp
Y2Vfb3BzKGRldi0+ZWRldiktPmF0dGFjaChkZXYtPmVkZXYsIGNoLT5oaWRkZW5fcGFyc2VyKTsK
PiA+ICsgICAgaWYgKGNoLT5oZWxsb19kb25lX3BhcnNlcikgewo+ID4gKyAgICAgICAgLyogc2Vu
ZCBkZXZpY2UgaW5mbyAqLwo+ID4gKyAgICAgICAgdXNicmVkaXJfaGVsbG8oY2gsIE5VTEwpOwo+
ID4gKyAgICB9Cj4gPiArICAgIHJldHVybiBUUlVFOwo+ID4gK30KPiA+ICsKPiA+ICBnYm9vbGVh
biBzcGljZV91c2JfYmFja2VuZF9jaGFubmVsX2F0dGFjaChTcGljZVVzYkJhY2tlbmRDaGFubmVs
ICpjaCwKPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTcGlj
ZVVzYkJhY2tlbmREZXZpY2UgKmRldiwKPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBHRXJyb3IgKiplcnJvcikKPiA+IEBAIC03MDYsNyArMTIxMywxMyBAQCBn
Ym9vbGVhbgo+ID4gc3BpY2VfdXNiX2JhY2tlbmRfY2hhbm5lbF9hdHRhY2goU3BpY2VVc2JCYWNr
ZW5kQ2hhbm5lbCAqY2gsCj4gPgo+ID4gICAgICBnX3JldHVybl92YWxfaWZfZmFpbChkZXYgIT0g
TlVMTCwgRkFMU0UpOwo+ID4KPiA+ICsgICAgaWYgKCFkZXYtPmxpYnVzYl9kZXZpY2UpIHsKPiA+
ICsgICAgICAgIHJldHVybiBhdHRhY2hfZWRldihjaCwgZGV2LCBlcnJvcik7Cj4gPiArICAgIH0K
PiA+ICsKPiA+ICAgICAgbGlidXNiX2RldmljZV9oYW5kbGUgKmhhbmRsZSA9IE5VTEw7Cj4gPiAr
ICAgIGNoLT51c2JyZWRpcmhvc3QgPSBjaC0+aGlkZGVuX2hvc3Q7Cj4gPiArICAgIGNoLT5wYXJz
ZXIgPSBOVUxMOwo+ID4KPiA+ICAgICAgLyoKPiA+ICAgICAgICAgVW5kZXIgV2luZG93cyB3ZSBu
ZWVkIHRvIGF2b2lkIHVwZGF0aW5nCj4gPiBAQCAtNzQwLDE4ICsxMjUzLDMzIEBAIGdib29sZWFu
Cj4gPiBzcGljZV91c2JfYmFja2VuZF9jaGFubmVsX2F0dGFjaChTcGljZVVzYkJhY2tlbmRDaGFu
bmVsICpjaCwKPiA+Cj4gPiAgdm9pZCBzcGljZV91c2JfYmFja2VuZF9jaGFubmVsX2RldGFjaChT
cGljZVVzYkJhY2tlbmRDaGFubmVsICpjaCkKPiA+ICB7Cj4gPiArICAgIFNwaWNlVXNiQmFja2Vu
ZERldmljZSAqZCA9IGNoLT5hdHRhY2hlZDsKPiA+ICsgICAgU3BpY2VVc2JFbXVsYXRlZERldmlj
ZSAqZWRldiA9IGQgPyBkLT5lZGV2IDogTlVMTDsKPiA+ICAgICAgU1BJQ0VfREVCVUcoIiVzID4+
IGNoICVwLCB3YXMgYXR0YWNoZWQgJXAiLCBfX0ZVTkNUSU9OX18sIGNoLAo+ID4gICAgICBjaC0+
YXR0YWNoZWQpOwo+ID4gLSAgICBpZiAoIWNoLT5hdHRhY2hlZCkgewo+ID4gKyAgICBpZiAoIWQp
IHsKPiA+ICAgICAgICAgIFNQSUNFX0RFQlVHKCIlczogbm90aGluZyB0byBkZXRhY2giLCBfX0ZV
TkNUSU9OX18pOwo+ID4gICAgICAgICAgcmV0dXJuOwo+ID4gICAgICB9Cj4gPiAgICAgIGlmIChj
aC0+dXNicmVkaXJob3N0KSB7Cj4gPiAgICAgICAgICAvKiBpdCB3aWxsIGNhbGwgbGlidXNiX2Ns
b3NlIGludGVybmFsbHkgKi8KPiA+ICAgICAgICAgIHVzYnJlZGlyaG9zdF9zZXRfZGV2aWNlKGNo
LT51c2JyZWRpcmhvc3QsIE5VTEwpOwo+ID4gKyAgICB9IGVsc2UgaWYgKGNoLT5wYXJzZXIpIHsK
PiA+ICsgICAgICAgIGlmIChlZGV2KSB7Cj4gPiArICAgICAgICAgICAgZGV2aWNlX29wcyhlZGV2
KS0+ZGV0YWNoKGVkZXYpOwo+ID4gKyAgICAgICAgfQo+ID4gKyAgICAgICAgdXNicmVkaXJwYXJz
ZXJfc2VuZF9kZXZpY2VfZGlzY29ubmVjdChjaC0+cGFyc2VyKTsKPiA+ICsgICAgICAgIHVzYnJl
ZGlyX3dyaXRlX2ZsdXNoX2NhbGxiYWNrKGNoKTsKPiA+ICsgICAgICAgIGNoLT53YWl0X2Rpc2Nf
YWNrID0gdXNicmVkaXJwYXJzZXJfcGVlcl9oYXNfY2FwKGNoLT5wYXJzZXIsCj4gPiArCj4gPiB1
c2JfcmVkaXJfY2FwX2RldmljZV9kaXNjb25uZWN0X2Fjayk7Cj4gPiArICAgICAgICBpZiAoIWNo
LT53YWl0X2Rpc2NfYWNrKSB7Cj4gPiArICAgICAgICAgICAgY2gtPnVzYnJlZGlyaG9zdCA9IGNo
LT5oaWRkZW5faG9zdDsKPiA+ICsgICAgICAgICAgICBjaC0+cGFyc2VyID0gTlVMTDsKPiA+ICsg
ICAgICAgIH0KPiA+ICAgICAgfQo+ID4gICAgICBTUElDRV9ERUJVRygiJXMgY2ggJXAsIGRldGFj
aCBkb25lIiwgX19GVU5DVElPTl9fLCBjaCk7Cj4gPiAgICAgIGNoLT5hdHRhY2hlZC0+YXR0YWNo
ZWRfdG8gPSBOVUxMOwo+ID4gICAgICBjaC0+YXR0YWNoZWQgPSBOVUxMOwo+ID4gKyAgICBjaC0+
cmVqZWN0ZWQgPSAwOwo+ID4gIH0KPiA+Cj4gPiAgU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCAqc3Bp
Y2VfdXNiX2JhY2tlbmRfY2hhbm5lbF9uZXcoU3BpY2VVc2JCYWNrZW5kICpiZSwKPiA+IEBAIC03
NjYsMjYgKzEyOTQsMzMgQEAgU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbAo+ID4gKnNwaWNlX3VzYl9i
YWNrZW5kX2NoYW5uZWxfbmV3KFNwaWNlVXNiQmFja2VuZCAqYmUsCj4gPiAgICAgIGNoLT51c2Vy
X2RhdGEgPSBTUElDRV9VU0JSRURJUl9DSEFOTkVMKHVzZXJfZGF0YSk7Cj4gPiAgICAgIGlmIChi
ZS0+bGlidXNiX2NvbnRleHQpIHsKPgo+IFRoaXMgY2FuIG5ldmVyIGJlIE5VTEwsIGlmIHdlIGFy
ZSBub3QgYWJsZSB0byBhbGxvY2F0ZSBpdCBpbnNpZGUKPiBzcGljZV91c2JfYmFja2VuZF9uZXcg
dGhlIGZ1bmN0aW9uIHJldHVybnMgTlVMTC4KPiBUaGlzIHNob3VsZCBiZSBpbiBhIHByZWxpbWlu
YXJ5IHBhdGNoIHRvIG1ha2UgdGhpcyBjbGVhci4KCkxvb2tpbmcgYSBsaXR0bGUgZm9yd2FyZCwg
YWZ0ZXIgY2Qtc2hhcmluZyBpcyBpbiwgdGhpcyBjb3VsZCBiZQpwb3NzaWJsZSB0byBub3QgZGlz
YWJsZSB0aGUgcmVkaXJlY3Rpb24gaXMgdGhlcmUgaXMgbm8gdXNiZGsuCkV2ZW4gaW4gY2FzZSB0
aGUgbGlidXNiIGRvZXMgbm90IHdvcmssIHRoZSBjbGllbnQgY2FuIHdvcmsgd2l0aApyZWRpcmVj
dGlvbiBlbmFibGVkIGFuZCByZWRpcmVjdCBvbmx5IGVtdWxhdGVkIGRldmljZXMuCkkgd291bGQg
bm90IHJlbW92ZSB0aGlzIGNoZWNrLgoKPgo+ID4gICAgICAgICAgY2gtPmJhY2tlbmQgPSBiZTsK
PiA+IC0gICAgICAgIGNoLT51c2JyZWRpcmhvc3QgPSB1c2JyZWRpcmhvc3Rfb3Blbl9mdWxsKAo+
ID4gLSAgICAgICAgICAgIGJlLT5saWJ1c2JfY29udGV4dCwKPiA+IC0gICAgICAgICAgICBOVUxM
LAo+ID4gLSAgICAgICAgICAgIHVzYnJlZGlyX2xvZywKPiA+IC0gICAgICAgICAgICB1c2JyZWRp
cl9yZWFkX2NhbGxiYWNrLAo+ID4gLSAgICAgICAgICAgIHVzYnJlZGlyX3dyaXRlX2NhbGxiYWNr
LAo+ID4gLSAgICAgICAgICAgIHVzYnJlZGlyX3dyaXRlX2ZsdXNoX2NhbGxiYWNrLAo+ID4gLSAg
ICAgICAgICAgIHVzYnJlZGlyX2FsbG9jX2xvY2ssCj4gPiAtICAgICAgICAgICAgdXNicmVkaXJf
bG9ja19sb2NrLAo+ID4gLSAgICAgICAgICAgIHVzYnJlZGlyX3VubG9ja19sb2NrLAo+ID4gLSAg
ICAgICAgICAgIHVzYnJlZGlyX2ZyZWVfbG9jaywKPiA+IC0gICAgICAgICAgICBjaCwgUEFDS0FH
RV9TVFJJTkcsCj4gPiAtICAgICAgICAgICAgc3BpY2VfdXRpbF9nZXRfZGVidWcoKSA/IHVzYnJl
ZGlycGFyc2VyX2RlYnVnIDoKPiA+IHVzYnJlZGlycGFyc2VyX3dhcm5pbmcsCj4gPiAtICAgICAg
ICAgICAgdXNicmVkaXJob3N0X2ZsX3dyaXRlX2NiX293bnNfYnVmZmVyKTsKPiA+ICsgICAgICAg
IGNoLT51c2JyZWRpcmhvc3QgPQo+ID4gKyAgICAgICAgICAgIHVzYnJlZGlyaG9zdF9vcGVuX2Z1
bGwoYmUtPmxpYnVzYl9jb250ZXh0LAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgTlVMTCwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzYnJl
ZGlyX2xvZywKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzYnJlZGly
X3JlYWRfY2FsbGJhY2ssCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1
c2JyZWRpcl93cml0ZV9jYWxsYmFjaywKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHVzYnJlZGlyX3dyaXRlX2ZsdXNoX2NhbGxiYWNrLAo+ID4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgdXNicmVkaXJfYWxsb2NfbG9jaywKPiA+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHVzYnJlZGlyX2xvY2tfbG9jaywKPiA+ICsgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzYnJlZGlyX3VubG9ja19sb2NrLAo+ID4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNicmVkaXJfZnJlZV9sb2NrLAo+ID4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2gsIFBBQ0tBR0VfU1RSSU5HLAo+
ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BpY2VfdXRpbF9nZXRfZGVi
dWcoKSA/Cj4gPiB1c2JyZWRpcnBhcnNlcl9kZWJ1ZyA6Cj4gPiArICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHVzYnJlZGlycGFyc2VyX3dhcm5pbmcsCj4gPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2JyZWRpcmhvc3RfZmxfd3JpdGVfY2Jfb3du
c19idWZmZXIpOwo+ID4gICAgICAgICAgZ193YXJuX2lmX2ZhaWwoY2gtPnVzYnJlZGlyaG9zdCAh
PSBOVUxMKTsKPiA+ICAgICAgfQo+ID4gKwo+ID4gICAgICBpZiAoY2gtPnVzYnJlZGlyaG9zdCkg
ewo+ID4gLSAgICAgICAgdXNicmVkaXJob3N0X3NldF9idWZmZXJlZF9vdXRwdXRfc2l6ZV9jYihj
aC0+dXNicmVkaXJob3N0LAo+ID4gdXNicmVkaXJfYnVmZmVyZWRfb3V0cHV0X3NpemVfY2FsbGJh
Y2spOwo+ID4gLSAgICB9IGVsc2Ugewo+ID4gLSAgICAgICAgZ19mcmVlKGNoKTsKPiA+ICsgICAg
ICAgIGNoLT5oaWRkZW5fcGFyc2VyID0gY3JlYXRlX3BhcnNlcihjaCk7Cj4gPiArICAgICAgICBj
aC0+aGlkZGVuX2hvc3QgPSBjaC0+dXNicmVkaXJob3N0Owo+ID4gKyAgICAgICAgdXNicmVkaXJo
b3N0X3NldF9idWZmZXJlZF9vdXRwdXRfc2l6ZV9jYihjaC0+dXNicmVkaXJob3N0LAo+ID4gKwo+
ID4gdXNicmVkaXJfYnVmZmVyZWRfb3V0cHV0X3NpemVfY2FsbGJhY2spOwo+ID4gKyAgICB9Cj4g
PiArCj4gPiArICAgIGlmICghY2gtPmhpZGRlbl9wYXJzZXIpIHsKPiA+ICsgICAgICAgIHNwaWNl
X3VzYl9iYWNrZW5kX2NoYW5uZWxfZGVsZXRlKGNoKTsKPiA+ICAgICAgICAgIGNoID0gTlVMTDsK
PiA+ICAgICAgfQo+ID4KPiA+IEBAIC03OTUsOSArMTMzMCwxNCBAQCBTcGljZVVzYkJhY2tlbmRD
aGFubmVsCj4gPiAqc3BpY2VfdXNiX2JhY2tlbmRfY2hhbm5lbF9uZXcoU3BpY2VVc2JCYWNrZW5k
ICpiZSwKPiA+Cj4gPiAgdm9pZCBzcGljZV91c2JfYmFja2VuZF9jaGFubmVsX2ZsdXNoX3dyaXRl
cyhTcGljZVVzYkJhY2tlbmRDaGFubmVsICpjaCkKPiA+ICB7Cj4gPiAtICAgIFNQSUNFX0RFQlVH
KCIlcyAlcCwgaG9zdCAlcCIsIF9fRlVOQ1RJT05fXywgY2gsIGNoLT51c2JyZWRpcmhvc3QpOwo+
ID4gKyAgICBTUElDRV9ERUJVRygiJXMgJXAgaXMgdXAiLCBfX0ZVTkNUSU9OX18sIGNoKTsKPiA+
ICAgICAgaWYgKGNoLT51c2JyZWRpcmhvc3QpIHsKPiA+ICAgICAgICAgIHVzYnJlZGlyaG9zdF93
cml0ZV9ndWVzdF9kYXRhKGNoLT51c2JyZWRpcmhvc3QpOwo+ID4gKyAgICAgICAgaW5pdGlhbGl6
ZV9wYXJzZXIoY2gsIEZBTFNFKTsKPiA+ICsgICAgfSBlbHNlIHsKPiA+ICsgICAgICAgIGluaXRp
YWxpemVfcGFyc2VyKGNoLCBUUlVFKTsKPgo+IFdoeSBpbml0aWFsaXplX3BhcnNlIGlzIGNhbGxl
ZCBoZXJlPwoKVGhpcyBpcyB0aGUgZGVjaXNpb24gcG9pbnQgd2hldGhlciBwYXJzZXIgd29ya3Mg
d2l0aCBoZWxsbz1vbiBvciBub3QKCj4KPiA+ICsgICAgICAgIGNoLT5wYXJzZXIgPSBjaC0+aGlk
ZGVuX3BhcnNlcjsKPiA+ICsgICAgICAgIHVzYnJlZGlycGFyc2VyX2RvX3dyaXRlKGNoLT5wYXJz
ZXIpOwo+ID4gICAgICB9Cj4gPiAgfQo+ID4KPiA+IEBAIC04MDcsMTIgKzEzNDcsMTYgQEAgdm9p
ZAo+ID4gc3BpY2VfdXNiX2JhY2tlbmRfY2hhbm5lbF9kZWxldGUoU3BpY2VVc2JCYWNrZW5kQ2hh
bm5lbCAqY2gpCj4gPiAgICAgIGlmICghY2gpIHsKPiA+ICAgICAgICAgIHJldHVybjsKPiA+ICAg
ICAgfQo+ID4gLSAgICBpZiAoY2gtPnVzYnJlZGlyaG9zdCkgewo+ID4gLSAgICAgICAgdXNicmVk
aXJob3N0X2Nsb3NlKGNoLT51c2JyZWRpcmhvc3QpOwo+ID4gKyAgICBpZiAoY2gtPmhpZGRlbl9o
b3N0KSB7Cj4gPiArICAgICAgICB1c2JyZWRpcmhvc3RfY2xvc2UoY2gtPmhpZGRlbl9ob3N0KTsK
PiA+ICsgICAgfQo+ID4gKyAgICBpZiAoY2gtPmhpZGRlbl9wYXJzZXIpIHsKPiA+ICsgICAgICAg
IHVzYnJlZGlycGFyc2VyX2Rlc3Ryb3koY2gtPmhpZGRlbl9wYXJzZXIpOwo+ID4gICAgICB9Cj4g
Pgo+ID4gICAgICBpZiAoY2gtPnJ1bGVzKSB7Cj4gPiAtICAgICAgICBnX2ZyZWUoY2gtPnJ1bGVz
KTsKPiA+ICsgICAgICAgIC8qIHJ1bGVzIHdlcmUgYWxsb2NhdGVkIGJ5IHVzYnJlZGlycGFyc2Vy
ICovCj4gPiArICAgICAgICBmcmVlKGNoLT5ydWxlcyk7Cj4KPiBNaW5vciA6SSBzdXBwb3NlIHRo
aXMgc21hbGwgY2hhbmdlIGNhbiBnbyB0byBhIHByZWxpbWluYXJ5IHBhdGNoIHRvbwoKVGhpcyBj
b2RlIHdhcyBoZXJlIGJlZm9yZSwgYnV0IGl0IHdhcyBuZXZlciB1c2VkIGFzIGNoLT5ydWxlcyB3
YXMKbmV2ZXIgYXNzaWduZWQuCgpIb25lc3RseSBJIGRvIG5vdCB1bmRlcnN0YW5kIHdoYXQgdGhp
cyAicHJlbGltaW5hcnkgcGF0Y2giIHNob3VsZApjb250YWluIGFuZCB3aGF0IGl0IGlzIGdvb2Qg
Zm9yLgoKPgo+ID4gICAgICB9Cj4gPgo+ID4gICAgICBnX2ZyZWUoY2gpOwo+Cj4gRnJlZGlhbm8K
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KU3BpY2UtZGV2
ZWwgbWFpbGluZyBsaXN0ClNwaWNlLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczov
L2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL3NwaWNlLWRldmVs
