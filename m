Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 5B2AB6433B
	for <lists+spice-devel@lfdr.de>; Wed, 10 Jul 2019 10:02:32 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id D7C0E6E0AA;
	Wed, 10 Jul 2019 08:02:30 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mail-io1-xd42.google.com (mail-io1-xd42.google.com
 [IPv6:2607:f8b0:4864:20::d42])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 2D5976E0AA
 for <spice-devel@lists.freedesktop.org>; Wed, 10 Jul 2019 08:02:29 +0000 (UTC)
Received: by mail-io1-xd42.google.com with SMTP id z3so2832347iog.0
 for <spice-devel@lists.freedesktop.org>; Wed, 10 Jul 2019 01:02:29 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc;
 bh=sO3sfu5PIwuP5Y3SMYp0hKW6VqcCSSjeJDa/6fJ2Sv4=;
 b=iMRTd/C8agxJnF3czSSHKzfYsbdovPCgvM02pBcXtBYNhmihi6L0kSg9HMmKMiGRBa
 wU0HIX65TVCgEmJvBIPOxg6ocp7N7ydvondi0mUarNz1vahz4rLe8g/CqWu80D61KGXz
 64X9U4aSq4MWKA7U+EffdPAuEoOn5oqVnRx1H4QYnKPwddQW2RnVRq2cPA+Z/OZ8Z5De
 AZZOAr/nf68LWjLjTnaopIo2Yund9wrcOpRBSRL1/VXUBGujoScHbG3vvpYy4IaLgYvX
 OIjqBTtfq4d8tlttNJWem07HJ3qqQfDykH1JuVoOsa1wSsWgTvrCGXdFBuEnF+V13Cx4
 ZAQQ==
X-Gm-Message-State: APjAAAUwmFNmhlDHM7cx2VfvvwDW++4jS0I/R2eNbtCz6nCRPpi8Z4Mb
 JkmvG0x5SQrgqDdC2WcYbUtKbU+3WODXrPv+dYXKhw==
X-Google-Smtp-Source: APXvYqywuJGkDN4dAZ4jXtykB/XE+zphQv5pTN4+PWcctlPOMH3H60GwSW63u+ZerVKdiBANuWjQ7RQu1EfJnrW8PqI=
X-Received: by 2002:a02:c550:: with SMTP id g16mr6441494jaj.49.1562745747941; 
 Wed, 10 Jul 2019 01:02:27 -0700 (PDT)
MIME-Version: 1.0
References: <20190410193139.10912-1-yuri.benditovich@daynix.com>
 <20190410193139.10912-3-yuri.benditovich@daynix.com>
 <20190610104820.lyydy6rmbroobb5x@toolbox>
 <CAOEp5Od5vXhdPF2L+6dH-Et2Sv_pc_LxsSFfREdN2jyukoeNcg@mail.gmail.com>
 <20190709100745.jls5mvq5dwe7lphz@wingsuit>
In-Reply-To: <20190709100745.jls5mvq5dwe7lphz@wingsuit>
From: Yuri Benditovich <yuri.benditovich@daynix.com>
Date: Wed, 10 Jul 2019 11:02:13 +0300
Message-ID: <CAOEp5OfOQYbV=dXDpeTtsCTVK4sVzFh6Q2Vnit-WEKubqqEEQQ@mail.gmail.com>
To: Victor Toso <victortoso@redhat.com>
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=daynix-com.20150623.gappssmtp.com; s=20150623;
 h=mime-version:references:in-reply-to:from:date:message-id:subject:to
 :cc;
 bh=sO3sfu5PIwuP5Y3SMYp0hKW6VqcCSSjeJDa/6fJ2Sv4=;
 b=HelU+hJgHVBRtmguHF/VGkdnUrzEbszO50u8wfGKkXuNcT3wz2wycYgWbBMKvZmy9i
 lNzwpsGcicLCyWvMXDh8uKq+4sx75yrBGpEAl9tiia/IEij0ghwoVm1DP4BbOQoMxeDX
 8YSnymdGV/fJsaRbZcaFx1ArTL4K5c7O11VM6VODz/CtTK2W3H9El3vlbcAUJ/GEAw98
 vFBz6W2L3ICpzXLwLUBy0X1GGxBcmkfZWeVcNifZOlERYpNG2fS6JFUa4aIO2UXQ3czw
 ZQr2PU/0o1PtQB+5mWnhY8IcZDcjOnpeaCaCAR0EB8jCLqZgMcmFtQ0xLJWLbt+Uy5Pq
 Omuw==
Subject: Re: [Spice-devel] [PATCH 2/3] usb-redirection: isolate usage of
 libusb and usbredirhost
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Yan Vugenfirer <yan@daynix.com>,
 Spice List <spice-devel@lists.freedesktop.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

T24gVHVlLCBKdWwgOSwgMjAxOSBhdCAxOjA3IFBNIFZpY3RvciBUb3NvIDx2aWN0b3J0b3NvQHJl
ZGhhdC5jb20+IHdyb3RlOgo+Cj4gSGksCj4KPiBPbiBNb24sIEp1biAyNCwgMjAxOSBhdCAwNjow
MjoyM1BNICswMzAwLCBZdXJpIEJlbmRpdG92aWNoIHdyb3RlOgo+ID4gT24gTW9uLCBKdW4gMTAs
IDIwMTkgYXQgMTo0OCBQTSBWaWN0b3IgVG9zbyA8dmljdG9ydG9zb0ByZWRoYXQuY29tPiB3cm90
ZToKPiA+ID4KPiA+ID4gSGksCj4gPiA+Cj4gPiA+IEtlZXBpbmcgdGhlIGNoYXQgYXMgeW91IG1p
Z2h0IGVuam95IHRoZW4sIGluIG9yZGVyIHRvIG1lcmdlIHRoaXMKPiA+ID4gcGF0Y2hlczoKPiA+
ID4KPiA+ID4gT24gV2VkLCBBcHIgMTAsIDIwMTkgYXQgMTA6MzE6MzhQTSArMDMwMCwgWXVyaSBC
ZW5kaXRvdmljaCB3cm90ZToKPiA+ID4gPiBBcyBhIHN0ZXAgdG93YXJkIHBvc3NpYmlsaXR5IHRv
IHByZXNlbnQgZW11bGF0ZWQgVVNCIGRldmljZXMKPiA+ID4gPiB0byB0aGUgZ3Vlc3QsIHdlIHJl
bW92ZSB0aGUga25vd2xlZGdlIGFib3V0IGxpYnVzYiBhbmQKPiA+ID4gPiB1c2JyZWRpcmhvc3Qg
KHdoaWNoIGRlcGVuZHMgb24gbGlidXNiKSBmcm9tIGFsbCB0aGUgbW9kdWxlcwo+ID4gPiA+IGFu
ZCBjb25jZW50cmF0ZSBpdCBpbiBvbmUgKHVzYiBiYWNrZW5kKSB3aGljaCBwcmVzZW50cwo+ID4g
PiA+IGFic3RyYWN0IFVTQiBvYmplY3RzIGFuZCBpbnRlcm5hbCBBUEkgdG8gYWxsIG90aGVyIG1v
ZHVsZXMuCj4gPiA+Cj4gPiA+IEknbSBhc2tpbmcgeW91IHRvIGFkZCBpbmZvcm1hdGlvbiBhYm91
dCAiYWJzdHJhY3QgVVNCIG9iamVjdHMgYW5kCj4gPiA+IGludGVybmFsIEFQSSIgdGhhdCBhcmUg
YmVpbmcgaW50cm9kdWNlZCB0byB0aGUgY29tbWl0IGxvZyBhbmQgYQo+ID4gPiBzaG9ydCBpbnRy
byBvbiB0aGVpciByb2xlLgo+Cj4gTm90ZSwgc29tZXRoaW5nIGxpa2UgdGhpcyBJIGZpbmQgdG8g
YmUgYSBtdXN0LgpodHRwczovL2dpdGxhYi5mcmVlZGVza3RvcC5vcmcveXVyaV9iZW5kaXRvdmlj
aC9zcGljZS1ndGsvY29tbWl0LzY4OTg0ZDM3MjdkMjg5M2RiY2ZiZTg3NzhlNGQ2NjA4ZDlmMWE2
Y2MKY29udGFpbnMgZXh0ZW5kZWQgY29tbWl0IGRlc2NyaXB0aW9uClBsZWFzZSBsZXQgbWUga25v
dyB3aGV0aGVyIGl0IGlzIGVub3VnaC4KPgo+ID4gPgo+ID4gPiA+IFNpZ25lZC1vZmYtYnk6IFl1
cmkgQmVuZGl0b3ZpY2ggPHl1cmkuYmVuZGl0b3ZpY2hAZGF5bml4LmNvbT4KPiA+ID4gPiAtLS0K
PiA+ID4gPiAgc3JjL01ha2VmaWxlLmFtICAgICAgICAgICAgICAgfCAgIDIgKwo+ID4gPiA+ICBz
cmMvY2hhbm5lbC11c2JyZWRpci1wcml2LmggICB8ICAgOSArLQo+ID4gPiA+ICBzcmMvY2hhbm5l
bC11c2JyZWRpci5jICAgICAgICB8IDIxNiArKystLS0tLS0tLS0KPiA+ID4gPiAgc3JjL21lc29u
LmJ1aWxkICAgICAgICAgICAgICAgfCAgIDIgKwo+ID4gPiA+ICBzcmMvdXNiLWJhY2tlbmQuYyAg
ICAgICAgICAgICB8IDYyMiArKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrCj4gPiA+
ID4gIHNyYy91c2ItYmFja2VuZC5oICAgICAgICAgICAgIHwgMTEwICsrKysrKwo+ID4gPiA+ICBz
cmMvdXNiLWRldmljZS1tYW5hZ2VyLXByaXYuaCB8ICAgMSAtCj4gPiA+ID4gIHNyYy91c2ItZGV2
aWNlLW1hbmFnZXIuYyAgICAgIHwgMzM2ICsrKysrKy0tLS0tLS0tLS0tLQo+ID4gPiA+ICBzcmMv
dXNidXRpbC5jICAgICAgICAgICAgICAgICB8ICAgNiAtCj4gPiA+ID4gIHNyYy91c2J1dGlsLmgg
ICAgICAgICAgICAgICAgIHwgICAyIC0KPiA+ID4gPiAgc3JjL3dpbi11c2ItZGV2LmMgICAgICAg
ICAgICAgfCAxMDMgKystLS0tCj4gPiA+ID4gIHNyYy93aW4tdXNiLWRldi5oICAgICAgICAgICAg
IHwgICA1ICstCj4gPiA+ID4gIDEyIGZpbGVzIGNoYW5nZWQsIDkyOSBpbnNlcnRpb25zKCspLCA0
ODUgZGVsZXRpb25zKC0pCj4gPiA+ID4gIGNyZWF0ZSBtb2RlIDEwMDY0NCBzcmMvdXNiLWJhY2tl
bmQuYwo+ID4gPiA+ICBjcmVhdGUgbW9kZSAxMDA2NDQgc3JjL3VzYi1iYWNrZW5kLmgKPiA+ID4g
Pgo+ID4gPiA+IGRpZmYgLS1naXQgYS9zcmMvTWFrZWZpbGUuYW0gYi9zcmMvTWFrZWZpbGUuYW0K
PiA+ID4gPiBpbmRleCBjZGM0ZDI4Li42YzVkZTlmIDEwMDY0NAo+ID4gPiA+IC0tLSBhL3NyYy9N
YWtlZmlsZS5hbQo+ID4gPiA+ICsrKyBiL3NyYy9NYWtlZmlsZS5hbQo+ID4gPiA+IEBAIC0yNjIs
NiArMjYyLDggQEAgbGlic3BpY2VfY2xpZW50X2dsaWJfaW1wbF9sYV9TT1VSQ0VTID0gICAgICAg
ICAgICAgICAgICAgIFwKPiA+ID4gPiAgICAgICBzcGljZS11cmktcHJpdi5oICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBcCj4gPiA+ID4gICAgICAgdXNiLWRldmljZS1tYW5hZ2VyLmMg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgXAo+ID4gPiA+ICAgICAgIHVzYi1kZXZpY2UtbWFu
YWdlci1wcml2LmggICAgICAgICAgICAgICAgICAgICAgIFwKPiA+ID4gPiArICAgICB1c2ItYmFj
a2VuZC5jICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCj4gPiA+ID4gKyAgICAg
dXNiLWJhY2tlbmQuaCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAo+ID4gPiA+
ICAgICAgIHVzYnV0aWwuYyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwK
PiA+ID4gPiAgICAgICB1c2J1dGlsLmggICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBcCj4gPiA+ID4gICAgICAgJChVU0JfQUNMX0hFTFBFUl9TUkNTKSAgICAgICAgICAgICAg
ICAgICAgICAgICAgXAo+ID4gPiA+IGRpZmYgLS1naXQgYS9zcmMvY2hhbm5lbC11c2JyZWRpci1w
cml2LmggYi9zcmMvY2hhbm5lbC11c2JyZWRpci1wcml2LmgKPiA+ID4gPiBpbmRleCAxN2U5NzE2
Li40NmMyYzU2IDEwMDY0NAo+ID4gPiA+IC0tLSBhL3NyYy9jaGFubmVsLXVzYnJlZGlyLXByaXYu
aAo+ID4gPiA+ICsrKyBiL3NyYy9jaGFubmVsLXVzYnJlZGlyLXByaXYuaAo+ID4gPiA+IEBAIC0y
MSw5ICsyMSw4IEBACj4gPiA+ID4gICNpZm5kZWYgX19TUElDRV9DTElFTlRfVVNCUkVESVJfQ0hB
Tk5FTF9QUklWX0hfXwo+ID4gPiA+ICAjZGVmaW5lIF9fU1BJQ0VfQ0xJRU5UX1VTQlJFRElSX0NI
QU5ORUxfUFJJVl9IX18KPiA+ID4gPgo+ID4gPiA+IC0jaW5jbHVkZSA8bGlidXNiLmg+Cj4gPiA+
ID4gLSNpbmNsdWRlIDx1c2JyZWRpcmZpbHRlci5oPgo+ID4gPiA+ICAjaW5jbHVkZSAic3BpY2Ut
Y2xpZW50LmgiCj4gPiA+ID4gKyNpbmNsdWRlICJ1c2ItYmFja2VuZC5oIgo+ID4gPiA+Cj4gPiA+
ID4gIEdfQkVHSU5fREVDTFMKPiA+ID4gPgo+ID4gPiA+IEBAIC0zMSw3ICszMCw3IEBAIEdfQkVH
SU5fREVDTFMKPiA+ID4gPiAgICAgY29udGV4dCBzaG91bGQgbm90IGJlIGRlc3Ryb3llZCBiZWZv
cmUgdGhlIGxhc3QgZGV2aWNlIGhhcyBiZWVuCj4gPiA+ID4gICAgIGRpc2Nvbm5lY3RlZCAqLwo+
ID4gPiA+ICB2b2lkIHNwaWNlX3VzYnJlZGlyX2NoYW5uZWxfc2V0X2NvbnRleHQoU3BpY2VVc2Jy
ZWRpckNoYW5uZWwgKmNoYW5uZWwsCj4gPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBsaWJ1c2JfY29udGV4dCAgICAgICAqY29udGV4dCk7Cj4gPiA+ID4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTcGljZVVzYkJhY2tlbmQgICAg
ICAqY29udGV4dCk7Cj4gPiA+ID4KPiA+ID4gPiAgdm9pZCBzcGljZV91c2JyZWRpcl9jaGFubmVs
X2Rpc2Nvbm5lY3RfZGV2aWNlX2FzeW5jKFNwaWNlVXNicmVkaXJDaGFubmVsICpjaGFubmVsLAo+
ID4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgR0NhbmNlbGxhYmxlICpjYW5jZWxsYWJsZSwKPiA+ID4gPiBAQCAtNDYsNyArNDUsNyBAQCBn
Ym9vbGVhbiBzcGljZV91c2JyZWRpcl9jaGFubmVsX2Rpc2Nvbm5lY3RfZGV2aWNlX2ZpbmlzaChT
cGljZVVzYnJlZGlyQ2hhbm5lbCAqYwo+ID4gPiA+ICAgICAodGhyb3VnaCBzcGljZV9jaGFubmVs
X2Nvbm5lY3QoKSksIGJlZm9yZSBjYWxsaW5nIHRoaXMuICovCj4gPiA+ID4gIHZvaWQgc3BpY2Vf
dXNicmVkaXJfY2hhbm5lbF9jb25uZWN0X2RldmljZV9hc3luYygKPiA+ID4gPiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNwaWNlVXNicmVkaXJDaGFubmVsICpjaGFu
bmVsLAo+ID4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGli
dXNiX2RldmljZSAgICAgICAgKmRldmljZSwKPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIFNwaWNlVXNiQmFja2VuZERldmljZSAqZGV2aWNlLAo+ID4gPiA+
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU3BpY2VVc2JEZXZpY2Ug
ICAgICAgKnNwaWNlX2RldmljZSwKPiA+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIEdDYW5jZWxsYWJsZSAgICAgICAgICpjYW5jZWxsYWJsZSwKPiA+ID4gPiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdBc3luY1JlYWR5Q2FsbGJh
Y2sgICBjYWxsYmFjaywKPiA+ID4gPiBAQCAtNTgsNyArNTcsNyBAQCBnYm9vbGVhbiBzcGljZV91
c2JyZWRpcl9jaGFubmVsX2Nvbm5lY3RfZGV2aWNlX2ZpbmlzaCgKPiA+ID4gPgo+ID4gPiA+ICB2
b2lkIHNwaWNlX3VzYnJlZGlyX2NoYW5uZWxfZGlzY29ubmVjdF9kZXZpY2UoU3BpY2VVc2JyZWRp
ckNoYW5uZWwgKmNoYW5uZWwpOwo+ID4gPiA+Cj4gPiA+ID4gLWxpYnVzYl9kZXZpY2UgKnNwaWNl
X3VzYnJlZGlyX2NoYW5uZWxfZ2V0X2RldmljZShTcGljZVVzYnJlZGlyQ2hhbm5lbCAqY2hhbm5l
bCk7Cj4gPiA+ID4gK1NwaWNlVXNiQmFja2VuZERldmljZSAqc3BpY2VfdXNicmVkaXJfY2hhbm5l
bF9nZXRfZGV2aWNlKFNwaWNlVXNicmVkaXJDaGFubmVsICpjaGFubmVsKTsKPiA+ID4gPgo+ID4g
PiA+ICB2b2lkIHNwaWNlX3VzYnJlZGlyX2NoYW5uZWxfbG9jayhTcGljZVVzYnJlZGlyQ2hhbm5l
bCAqY2hhbm5lbCk7Cj4gPiA+ID4KPiA+ID4gPiBkaWZmIC0tZ2l0IGEvc3JjL2NoYW5uZWwtdXNi
cmVkaXIuYyBiL3NyYy9jaGFubmVsLXVzYnJlZGlyLmMKPiA+ID4gPiBpbmRleCAzNTYyMTY0Li5k
ODk0MTMwIDEwMDY0NAo+ID4gPiA+IC0tLSBhL3NyYy9jaGFubmVsLXVzYnJlZGlyLmMKPiA+ID4g
PiArKysgYi9zcmMvY2hhbm5lbC11c2JyZWRpci5jCj4gPiA+ID4gQEAgLTIzLDcgKzIzLDYgQEAK
PiA+ID4gPgo+ID4gPiA+ICAjaWZkZWYgVVNFX1VTQlJFRElSCj4gPiA+ID4gICNpbmNsdWRlIDxn
bGliL2dpMThuLWxpYi5oPgo+ID4gPiA+IC0jaW5jbHVkZSA8dXNicmVkaXJob3N0Lmg+Cj4gPiA+
ID4gICNpZmRlZiBVU0VfTFo0Cj4gPiA+ID4gICNpbmNsdWRlIDxsejQuaD4KPiA+ID4gPiAgI2Vu
ZGlmCj4gPiA+ID4gQEAgLTY2LDE1ICs2NSwxMiBAQCBlbnVtIFNwaWNlVXNicmVkaXJDaGFubmVs
U3RhdGUgewo+ID4gPiA+ICB9Owo+ID4gPiA+Cj4gPiA+ID4gIHN0cnVjdCBfU3BpY2VVc2JyZWRp
ckNoYW5uZWxQcml2YXRlIHsKPiA+ID4gPiAtICAgIGxpYnVzYl9kZXZpY2UgKmRldmljZTsKPiA+
ID4gPiArICAgIFNwaWNlVXNiQmFja2VuZERldmljZSAqZGV2aWNlOwo+ID4gPiA+ICAgICAgU3Bp
Y2VVc2JEZXZpY2UgKnNwaWNlX2RldmljZTsKPiA+ID4gPiAtICAgIGxpYnVzYl9jb250ZXh0ICpj
b250ZXh0Owo+ID4gPiA+IC0gICAgc3RydWN0IHVzYnJlZGlyaG9zdCAqaG9zdDsKPiA+ID4gPiAr
ICAgIFNwaWNlVXNiQmFja2VuZCAqY29udGV4dDsKPiA+ID4gPiArICAgIFNwaWNlVXNiQmFja2Vu
ZENoYW5uZWwgKmhvc3Q7Cj4gPiA+ID4gICAgICAvKiBUbyBjYXRjaCB1c2JyZWRpcmhvc3QgZXJy
b3IgbWVzc2FnZXMgYW5kIHJlcG9ydCB0aGVtIGFzIGEgR0Vycm9yICovCj4gPiA+ID4gICAgICBH
RXJyb3IgKipjYXRjaF9lcnJvcjsKPiA+ID4gPiAtICAgIC8qIERhdGEgcGFzc2VkIGZyb20gY2hh
bm5lbCBoYW5kbGUgbXNnIHRvIHRoZSB1c2JyZWRpcmhvc3QgcmVhZCBjYiAqLwo+ID4gPiA+IC0g
ICAgY29uc3QgdWludDhfdCAqcmVhZF9idWY7Cj4gPiA+ID4gLSAgICBpbnQgcmVhZF9idWZfc2l6
ZTsKPiA+ID4gPiAgICAgIGVudW0gU3BpY2VVc2JyZWRpckNoYW5uZWxTdGF0ZSBzdGF0ZTsKPiA+
ID4gPiAgI2lmZGVmIFVTRV9QT0xLSVQKPiA+ID4gPiAgICAgIEdUYXNrICp0YXNrOwo+ID4gPiA+
IEBAIC05MCwxNiArODYsOSBAQCBzdGF0aWMgdm9pZCBzcGljZV91c2JyZWRpcl9jaGFubmVsX2Rp
c3Bvc2UoR09iamVjdCAqb2JqKTsKPiA+ID4gPiAgc3RhdGljIHZvaWQgc3BpY2VfdXNicmVkaXJf
Y2hhbm5lbF9maW5hbGl6ZShHT2JqZWN0ICpvYmopOwo+ID4gPiA+ICBzdGF0aWMgdm9pZCB1c2Jy
ZWRpcl9oYW5kbGVfbXNnKFNwaWNlQ2hhbm5lbCAqY2hhbm5lbCwgU3BpY2VNc2dJbiAqaW4pOwo+
ID4gPiA+Cj4gPiA+ID4gLXN0YXRpYyB2b2lkIHVzYnJlZGlyX2xvZyh2b2lkICp1c2VyX2RhdGEs
IGludCBsZXZlbCwgY29uc3QgY2hhciAqbXNnKTsKPiA+ID4gPiAtc3RhdGljIGludCB1c2JyZWRp
cl9yZWFkX2NhbGxiYWNrKHZvaWQgKnVzZXJfZGF0YSwgdWludDhfdCAqZGF0YSwgaW50IGNvdW50
KTsKPiA+ID4gPiAgc3RhdGljIGludCB1c2JyZWRpcl93cml0ZV9jYWxsYmFjayh2b2lkICp1c2Vy
X2RhdGEsIHVpbnQ4X3QgKmRhdGEsIGludCBjb3VudCk7Cj4gPiA+ID4gLXN0YXRpYyB2b2lkIHVz
YnJlZGlyX3dyaXRlX2ZsdXNoX2NhbGxiYWNrKHZvaWQgKnVzZXJfZGF0YSk7Cj4gPiA+ID4gLXN0
YXRpYyB1aW50NjRfdCB1c2JyZWRpcl9idWZmZXJlZF9vdXRwdXRfc2l6ZV9jYWxsYmFjayh2b2lk
ICp1c2VyX2RhdGEpOwo+ID4gPiA+IC0KPiA+ID4gPiAtc3RhdGljIHZvaWQgKnVzYnJlZGlyX2Fs
bG9jX2xvY2sodm9pZCk7Cj4gPiA+ID4gLXN0YXRpYyB2b2lkIHVzYnJlZGlyX2xvY2tfbG9jayh2
b2lkICp1c2VyX2RhdGEpOwo+ID4gPiA+IC1zdGF0aWMgdm9pZCB1c2JyZWRpcl91bmxvY2tfbG9j
ayh2b2lkICp1c2VyX2RhdGEpOwo+ID4gPiA+IC1zdGF0aWMgdm9pZCB1c2JyZWRpcl9mcmVlX2xv
Y2sodm9pZCAqdXNlcl9kYXRhKTsKPiA+ID4gPiArc3RhdGljIGdib29sZWFuIHVzYnJlZGlyX2lz
X2NoYW5uZWxfcmVhZHkodm9pZCAqdXNlcl9kYXRhKTsKPiA+ID4gPiArc3RhdGljIHVpbnQ2NF90
IHVzYnJlZGlyX2dldF9xdWV1ZV9zaXplKHZvaWQgKnVzZXJfZGF0YSk7Cj4gPiA+ID4KPiA+ID4g
PiAgI2Vsc2UKPiA+ID4gPiAgc3RydWN0IF9TcGljZVVzYnJlZGlyQ2hhbm5lbFByaXZhdGUgewo+
ID4gPiA+IEBAIC0xMjYsNyArMTE1LDcgQEAgc3RhdGljIHZvaWQgX2NoYW5uZWxfcmVzZXRfZmlu
aXNoKFNwaWNlVXNicmVkaXJDaGFubmVsICpjaGFubmVsLCBnYm9vbGVhbiBtaWdyYXQKPiA+ID4g
Pgo+ID4gPiA+ICAgICAgc3BpY2VfdXNicmVkaXJfY2hhbm5lbF9sb2NrKGNoYW5uZWwpOwo+ID4g
PiA+Cj4gPiA+ID4gLSAgICB1c2JyZWRpcmhvc3RfY2xvc2UocHJpdi0+aG9zdCk7Cj4gPiA+ID4g
KyAgICBzcGljZV91c2JfYmFja2VuZF9jaGFubmVsX2RlbGV0ZShwcml2LT5ob3N0KTsKPiA+ID4g
PiAgICAgIHByaXYtPmhvc3QgPSBOVUxMOwo+ID4gPiA+Cj4gPiA+ID4gICAgICAvKiBDYWxsIHNl
dF9jb250ZXh0IHRvIHJlLWNyZWF0ZSB0aGUgaG9zdCAqLwo+ID4gPiA+IEBAIC0yMzYsNyArMjI1
LDcgQEAgc3RhdGljIHZvaWQgc3BpY2VfdXNicmVkaXJfY2hhbm5lbF9maW5hbGl6ZShHT2JqZWN0
ICpvYmopCj4gPiA+ID4gICAgICBTcGljZVVzYnJlZGlyQ2hhbm5lbCAqY2hhbm5lbCA9IFNQSUNF
X1VTQlJFRElSX0NIQU5ORUwob2JqKTsKPiA+ID4gPgo+ID4gPiA+ICAgICAgaWYgKGNoYW5uZWwt
PnByaXYtPmhvc3QpCj4gPiA+ID4gLSAgICAgICAgdXNicmVkaXJob3N0X2Nsb3NlKGNoYW5uZWwt
PnByaXYtPmhvc3QpOwo+ID4gPiA+ICsgICAgICAgIHNwaWNlX3VzYl9iYWNrZW5kX2NoYW5uZWxf
ZGVsZXRlKGNoYW5uZWwtPnByaXYtPmhvc3QpOwo+ID4gPiA+ICAjaWZkZWYgVVNFX1VTQlJFRElS
Cj4gPiA+ID4gICAgICBnX211dGV4X2NsZWFyKCZjaGFubmVsLT5wcml2LT5kZXZpY2VfY29ubmVj
dF9tdXRleCk7Cj4gPiA+ID4gICNlbmRpZgo+ID4gPiA+IEBAIC0yNjEsMzAgKzI1MCwyMiBAQCBz
dGF0aWMgdm9pZCBjaGFubmVsX3NldF9oYW5kbGVycyhTcGljZUNoYW5uZWxDbGFzcyAqa2xhc3Mp
Cj4gPiA+ID4KPiA+ID4gPiAgR19HTlVDX0lOVEVSTkFMCj4gPiA+ID4gIHZvaWQgc3BpY2VfdXNi
cmVkaXJfY2hhbm5lbF9zZXRfY29udGV4dChTcGljZVVzYnJlZGlyQ2hhbm5lbCAqY2hhbm5lbCwK
PiA+ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpYnVzYl9j
b250ZXh0ICAgICAgICpjb250ZXh0KQo+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgU3BpY2VVc2JCYWNrZW5kICAgICAgKmNvbnRleHQpCj4gPiA+ID4gIHsK
PiA+ID4gPiAgICAgIFNwaWNlVXNicmVkaXJDaGFubmVsUHJpdmF0ZSAqcHJpdiA9IGNoYW5uZWwt
PnByaXY7Cj4gPiA+ID4gKyAgICBTcGljZVVzYkJhY2tlbmRDaGFubmVsSW5pdERhdGEgaW5pdF9k
YXRhOwo+ID4gPiA+ICsgICAgaW5pdF9kYXRhLnVzZXJfZGF0YSA9IGNoYW5uZWw7Cj4gPiA+ID4g
KyAgICBpbml0X2RhdGEuZ2V0X3F1ZXVlX3NpemUgPSB1c2JyZWRpcl9nZXRfcXVldWVfc2l6ZTsK
PiA+ID4gPiArICAgIGluaXRfZGF0YS5pc19jaGFubmVsX3JlYWR5ID0gdXNicmVkaXJfaXNfY2hh
bm5lbF9yZWFkeTsKPiA+ID4gPiArICAgIGluaXRfZGF0YS53cml0ZV9jYWxsYmFjayA9IHVzYnJl
ZGlyX3dyaXRlX2NhbGxiYWNrOwo+ID4gPgo+ID4gPiBJJ2QgcmF0aGVyIHdlIGV4cG9ydCB0aG9z
ZSB0aHJlZSBmdW5jdGlvbnMgaW5zdGVhZCBvZiB1c2luZwo+ID4gPiBTcGljZVVzYkJhY2tlbmRD
aGFubmVsSW5pdERhdGEuIFlvdSBqdXN0IGNyZWF0ZSB3cmFwcGVycyBhZ2FpbiB0bwo+ID4gPiB0
aGVtIGluIHVzYi1iYWNrZW5kLiBJIGRvbid0IHRoaW5rIGl0IGlzIGEgZ29vZCBlZmZvcnQgbWFp
bmx5Cj4gPiA+IGJlY2F1c2UgdXNiLWJhY2tlbmQgYW5kIGNoYW5uZWwtdXNicmVkaXIgYXJlIGJv
dW5kZWQuCj4gPiA+Cj4gPiA+IENoYW5uZWwtdXNicmVkaXIgaXMgYSBTcGljZUNoYW5uZWwgc28g
eW91IGNvdWxkIGV2ZW4gcmVtb3ZlCj4gPiA+IF9nZXRfcXVldWVfc2l6ZSgpIGFuZCBfaXNfY2hh
bm5lbF9yZWFkeSgpIGlmIGNvbXByb21pc2VkIGEgYml0Cj4gPiA+IHRoZSBkZXNpZ24gYW5kIGhh
dmUgdGhvc2UgZnVuY3Rpb25zIHRoZXJlIGFzIHRoZXknbGwgYmUgdXNlbGVzcwo+ID4gPiBpbiBj
aGFubmVsLXVzYnJlZGlyICguLi4pCj4gPiA+Cj4gPiA+IElmIHdlIGhhZCBkaWZmZXJlbnQgdXNl
cnMgZm9yIHNwaWNlX3VzYl9iYWNrZW5kX2NoYW5uZWxfbmV3KCkgSQo+ID4gPiB3b3VsZG4ndCBt
aW5kLgo+ID4gPgo+ID4gPiBTbywgcGxlYXNlIEdfR05VQ19JTlRFUk5BTCBvbiB0aG9zZSBhbmQg
cmVtb3ZlIHRob3NlIHdyYXBwZXJzIGluCj4gPiA+IHVzYi1iYWNrZW5kLmMKPiA+ID4KPiA+ID4g
PiAgICAgIGdfcmV0dXJuX2lmX2ZhaWwocHJpdi0+aG9zdCA9PSBOVUxMKTsKPiA+ID4gPgo+ID4g
PiA+ICAgICAgcHJpdi0+Y29udGV4dCA9IGNvbnRleHQ7Cj4gPiA+ID4gLSAgICBwcml2LT5ob3N0
ID0gdXNicmVkaXJob3N0X29wZW5fZnVsbCgKPiA+ID4gPiAtICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBjb250ZXh0LCBOVUxMLAo+ID4gPiA+IC0gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHVzYnJlZGlyX2xvZywKPiA+ID4gPiAtICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICB1c2JyZWRpcl9yZWFkX2NhbGxiYWNrLAo+ID4gPiA+IC0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzYnJlZGlyX3dyaXRlX2NhbGxiYWNrLAo+ID4g
PiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzYnJlZGlyX3dyaXRlX2Zs
dXNoX2NhbGxiYWNrLAo+ID4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHVzYnJlZGlyX2FsbG9jX2xvY2ssCj4gPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgdXNicmVkaXJfbG9ja19sb2NrLAo+ID4gPiA+IC0gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHVzYnJlZGlyX3VubG9ja19sb2NrLAo+ID4gPiA+IC0gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHVzYnJlZGlyX2ZyZWVfbG9jaywKPiA+ID4gPiAtICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFubmVsLCBQQUNLQUdFX1NUUklORywK
PiA+ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcGljZV91dGlsX2dl
dF9kZWJ1ZygpID8gdXNicmVkaXJwYXJzZXJfZGVidWcgOiB1c2JyZWRpcnBhcnNlcl93YXJuaW5n
LAo+ID4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzYnJlZGlyaG9z
dF9mbF93cml0ZV9jYl9vd25zX2J1ZmZlcik7Cj4gPiA+ID4gKyAgICBwcml2LT5ob3N0ID0gc3Bp
Y2VfdXNiX2JhY2tlbmRfY2hhbm5lbF9uZXcoY29udGV4dCwgJmluaXRfZGF0YSk7Cj4gPiA+ID4g
ICAgICBpZiAoIXByaXYtPmhvc3QpCj4gPiA+ID4gLSAgICAgICAgZ19lcnJvcigiT3V0IG9mIG1l
bW9yeSBhbGxvY2F0aW5nIHVzYnJlZGlyaG9zdCIpOwo+ID4gPiA+ICsgICAgICAgIGdfZXJyb3Io
Ik91dCBvZiBtZW1vcnkgaW5pdGlhbGl6aW5nIHJlZGlyZWN0aW9uIHN1cHBvcnQiKTsKPiA+ID4g
Pgo+ID4gPiA+IC0gICAgdXNicmVkaXJob3N0X3NldF9idWZmZXJlZF9vdXRwdXRfc2l6ZV9jYihw
cml2LT5ob3N0LCB1c2JyZWRpcl9idWZmZXJlZF9vdXRwdXRfc2l6ZV9jYWxsYmFjayk7Cj4gPiA+
ID4gICNpZmRlZiBVU0VfTFo0Cj4gPiA+ID4gICAgICBzcGljZV9jaGFubmVsX3NldF9jYXBhYmls
aXR5KGNoYW5uZWwsIFNQSUNFX1NQSUNFVk1DX0NBUF9EQVRBX0NPTVBSRVNTX0xaNCk7Cj4gPiA+
ID4gICNlbmRpZgo+ID4gPiA+IEBAIC0yOTUsOCArMjc2LDYgQEAgc3RhdGljIGdib29sZWFuIHNw
aWNlX3VzYnJlZGlyX2NoYW5uZWxfb3Blbl9kZXZpY2UoCj4gPiA+ID4gIHsKPiA+ID4gPiAgICAg
IFNwaWNlVXNicmVkaXJDaGFubmVsUHJpdmF0ZSAqcHJpdiA9IGNoYW5uZWwtPnByaXY7Cj4gPiA+
ID4gICAgICBTcGljZVNlc3Npb24gKnNlc3Npb247Cj4gPiA+ID4gLSAgICBsaWJ1c2JfZGV2aWNl
X2hhbmRsZSAqaGFuZGxlID0gTlVMTDsKPiA+ID4gPiAtICAgIGludCByYywgc3RhdHVzOwo+ID4g
PiA+ICAgICAgU3BpY2VVc2JEZXZpY2VNYW5hZ2VyICptYW5hZ2VyOwo+ID4gPiA+Cj4gPiA+ID4g
ICAgICBnX3JldHVybl92YWxfaWZfZmFpbChwcml2LT5zdGF0ZSA9PSBTVEFURV9ESVNDT05ORUNU
RUQKPiA+ID4gPiBAQCAtMzA1LDE5ICsyODQsMTEgQEAgc3RhdGljIGdib29sZWFuIHNwaWNlX3Vz
YnJlZGlyX2NoYW5uZWxfb3Blbl9kZXZpY2UoCj4gPiA+ID4gICNlbmRpZgo+ID4gPiA+ICAgICAg
ICAgICAgICAgICAgICAgICAgICAgLCBGQUxTRSk7Cj4gPiA+ID4KPiA+ID4gPiAtICAgIHJjID0g
bGlidXNiX29wZW4ocHJpdi0+ZGV2aWNlLCAmaGFuZGxlKTsKPiA+ID4gPiAtICAgIGlmIChyYyAh
PSAwKSB7Cj4gPiA+ID4gLSAgICAgICAgZ19zZXRfZXJyb3IoZXJyLCBTUElDRV9DTElFTlRfRVJS
T1IsIFNQSUNFX0NMSUVOVF9FUlJPUl9GQUlMRUQsCj4gPiA+ID4gLSAgICAgICAgICAgICAgICAg
ICAgIkNvdWxkIG5vdCBvcGVuIHVzYiBkZXZpY2U6ICVzIFslaV0iLAo+ID4gPiA+IC0gICAgICAg
ICAgICAgICAgICAgIHNwaWNlX3VzYnV0aWxfbGlidXNiX3N0cmVycm9yKHJjKSwgcmMpOwo+ID4g
PiA+IC0gICAgICAgIHJldHVybiBGQUxTRTsKPiA+ID4gPiAtICAgIH0KPiA+ID4gPiAtCj4gPiA+
ID4gLSAgICBwcml2LT5jYXRjaF9lcnJvciA9IGVycjsKPiA+ID4gPiAtICAgIHN0YXR1cyA9IHVz
YnJlZGlyaG9zdF9zZXRfZGV2aWNlKHByaXYtPmhvc3QsIGhhbmRsZSk7Cj4gPiA+ID4gLSAgICBw
cml2LT5jYXRjaF9lcnJvciA9IE5VTEw7Cj4gPiA+ID4gLSAgICBpZiAoc3RhdHVzICE9IHVzYl9y
ZWRpcl9zdWNjZXNzKSB7Cj4gPiA+ID4gLSAgICAgICAgZ19yZXR1cm5fdmFsX2lmX2ZhaWwoZXJy
ID09IE5VTEwgfHwgKmVyciAhPSBOVUxMLCBGQUxTRSk7Cj4gPiA+ID4gKyAgICBpZiAoIXNwaWNl
X3VzYl9iYWNrZW5kX2NoYW5uZWxfYXR0YWNoKHByaXYtPmhvc3QsIHByaXYtPmRldmljZSwgZXJy
KSkgewo+ID4gPiA+ICsgICAgICAgIGlmICgqZXJyID09IE5VTEwpIHsKPiA+ID4gPiArICAgICAg
ICAgICAgZ19zZXRfZXJyb3IoZXJyLCBTUElDRV9DTElFTlRfRVJST1IsIFNQSUNFX0NMSUVOVF9F
UlJPUl9GQUlMRUQsCj4gPiA+ID4gKyAgICAgICAgICAgICAgICAiRXJyb3IgYXR0YWNoaW5nIGRl
dmljZTogKG5vIGVycm9yIGluZm9ybWF0aW9uKSIpOwo+ID4gPiA+ICsgICAgICAgIH0KPiA+ID4g
PiAgICAgICAgICByZXR1cm4gRkFMU0U7Cj4gPiA+ID4gICAgICB9Cj4gPiA+ID4KPiA+ID4gPiBA
QCAtMzI3LDcgKzI5OCw3IEBAIHN0YXRpYyBnYm9vbGVhbiBzcGljZV91c2JyZWRpcl9jaGFubmVs
X29wZW5fZGV2aWNlKAo+ID4gPiA+Cj4gPiA+ID4gICAgICBwcml2LT51c2JfZGV2aWNlX21hbmFn
ZXIgPSBnX29iamVjdF9yZWYobWFuYWdlcik7Cj4gPiA+ID4gICAgICBpZiAoIXNwaWNlX3VzYl9k
ZXZpY2VfbWFuYWdlcl9zdGFydF9ldmVudF9saXN0ZW5pbmcocHJpdi0+dXNiX2RldmljZV9tYW5h
Z2VyLCBlcnIpKSB7Cj4gPiA+ID4gLSAgICAgICAgdXNicmVkaXJob3N0X3NldF9kZXZpY2UocHJp
di0+aG9zdCwgTlVMTCk7Cj4gPiA+ID4gKyAgICAgICAgc3BpY2VfdXNiX2JhY2tlbmRfY2hhbm5l
bF9kZXRhY2gocHJpdi0+aG9zdCk7Cj4gPiA+ID4gICAgICAgICAgcmV0dXJuIEZBTFNFOwo+ID4g
PiA+ICAgICAgfQo+ID4gPiA+Cj4gPiA+ID4gQEAgLTM1OCw4ICszMjksNyBAQCBzdGF0aWMgdm9p
ZCBzcGljZV91c2JyZWRpcl9jaGFubmVsX29wZW5fYWNsX2NiKAo+ID4gPiA+ICAgICAgICAgIHNw
aWNlX3VzYnJlZGlyX2NoYW5uZWxfb3Blbl9kZXZpY2UoY2hhbm5lbCwgJmVycik7Cj4gPiA+ID4g
ICAgICB9Cj4gPiA+ID4gICAgICBpZiAoZXJyKSB7Cj4gPiA+ID4gLSAgICAgICAgbGlidXNiX3Vu
cmVmX2RldmljZShwcml2LT5kZXZpY2UpOwo+ID4gPiA+IC0gICAgICAgIHByaXYtPmRldmljZSA9
IE5VTEw7Cj4gPiA+ID4gKyAgICAgICAgZ19jbGVhcl9wb2ludGVyKCZwcml2LT5kZXZpY2UsIHNw
aWNlX3VzYl9iYWNrZW5kX2RldmljZV91bnJlZik7Cj4gPiA+ID4gICAgICAgICAgZ19ib3hlZF9m
cmVlKHNwaWNlX3VzYl9kZXZpY2VfZ2V0X3R5cGUoKSwgcHJpdi0+c3BpY2VfZGV2aWNlKTsKPiA+
ID4gPiAgICAgICAgICBwcml2LT5zcGljZV9kZXZpY2UgPSBOVUxMOwo+ID4gPiA+ICAgICAgICAg
IHByaXYtPnN0YXRlICA9IFNUQVRFX0RJU0NPTk5FQ1RFRDsKPiA+ID4gPiBAQCAtMzkwLDggKzM2
MCw3IEBAIF9vcGVuX2RldmljZV9hc3luY19jYihHVGFzayAqdGFzaywKPiA+ID4gPiAgICAgIHNw
aWNlX3VzYnJlZGlyX2NoYW5uZWxfbG9jayhjaGFubmVsKTsKPiA+ID4gPgo+ID4gPiA+ICAgICAg
aWYgKCFzcGljZV91c2JyZWRpcl9jaGFubmVsX29wZW5fZGV2aWNlKGNoYW5uZWwsICZlcnIpKSB7
Cj4gPiA+ID4gLSAgICAgICAgbGlidXNiX3VucmVmX2RldmljZShwcml2LT5kZXZpY2UpOwo+ID4g
PiA+IC0gICAgICAgIHByaXYtPmRldmljZSA9IE5VTEw7Cj4gPiA+ID4gKyAgICAgICAgZ19jbGVh
cl9wb2ludGVyKCZwcml2LT5kZXZpY2UsIHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV91bnJlZik7
Cj4gPiA+ID4gICAgICAgICAgZ19ib3hlZF9mcmVlKHNwaWNlX3VzYl9kZXZpY2VfZ2V0X3R5cGUo
KSwgcHJpdi0+c3BpY2VfZGV2aWNlKTsKPiA+ID4gPiAgICAgICAgICBwcml2LT5zcGljZV9kZXZp
Y2UgPSBOVUxMOwo+ID4gPiA+ICAgICAgfQo+ID4gPiA+IEBAIC00MDksMTMgKzM3OCwxNiBAQCBf
b3Blbl9kZXZpY2VfYXN5bmNfY2IoR1Rhc2sgKnRhc2ssCj4gPiA+ID4gIEdfR05VQ19JTlRFUk5B
TAo+ID4gPiA+ICB2b2lkIHNwaWNlX3VzYnJlZGlyX2NoYW5uZWxfY29ubmVjdF9kZXZpY2VfYXN5
bmMoCj4gPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNw
aWNlVXNicmVkaXJDaGFubmVsICpjaGFubmVsLAo+ID4gPiA+IC0gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBsaWJ1c2JfZGV2aWNlICAgICAgICAqZGV2aWNlLAo+ID4g
PiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTcGljZVVzYkJh
Y2tlbmREZXZpY2UgKmRldmljZSwKPiA+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgU3BpY2VVc2JEZXZpY2UgICAgICAgKnNwaWNlX2RldmljZSwKPiA+ID4g
PiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgR0NhbmNlbGxhYmxl
ICAgICAgICAgKmNhbmNlbGxhYmxlLAo+ID4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBHQXN5bmNSZWFkeUNhbGxiYWNrICAgY2FsbGJhY2ssCj4gPiA+ID4g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdwb2ludGVyICAgICAg
ICAgICAgICB1c2VyX2RhdGEpCj4gPiA+ID4gIHsKPiA+ID4gPiAgICAgIFNwaWNlVXNicmVkaXJD
aGFubmVsUHJpdmF0ZSAqcHJpdiA9IGNoYW5uZWwtPnByaXY7Cj4gPiA+ID4gKyNpZmRlZiBVU0Vf
UE9MS0lUCj4gPiA+ID4gKyAgICBjb25zdCBVc2JEZXZpY2VJbmZvcm1hdGlvbiAqaW5mbyA9IHNw
aWNlX3VzYl9iYWNrZW5kX2RldmljZV9nZXRfaW5mbyhkZXZpY2UpOwo+ID4gPiA+ICsjZW5kaWYK
PiA+ID4gPiAgICAgIEdUYXNrICp0YXNrOwo+ID4gPiA+Cj4gPiA+ID4gICAgICBnX3JldHVybl9p
Zl9mYWlsKFNQSUNFX0lTX1VTQlJFRElSX0NIQU5ORUwoY2hhbm5lbCkpOwo+ID4gPiA+IEBAIC00
NDIsNyArNDE0LDcgQEAgdm9pZCBzcGljZV91c2JyZWRpcl9jaGFubmVsX2Nvbm5lY3RfZGV2aWNl
X2FzeW5jKAo+ID4gPiA+ICAgICAgICAgIGdvdG8gZG9uZTsKPiA+ID4gPiAgICAgIH0KPiA+ID4g
Pgo+ID4gPiA+IC0gICAgcHJpdi0+ZGV2aWNlID0gbGlidXNiX3JlZl9kZXZpY2UoZGV2aWNlKTsK
PiA+ID4gPiArICAgIHByaXYtPmRldmljZSA9IHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9yZWYo
ZGV2aWNlKTsKPiA+ID4gPiAgICAgIHByaXYtPnNwaWNlX2RldmljZSA9IGdfYm94ZWRfY29weShz
cGljZV91c2JfZGV2aWNlX2dldF90eXBlKCksCj4gPiA+ID4gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgc3BpY2VfZGV2aWNlKTsKPiA+ID4gPiAgI2lmZGVmIFVTRV9QT0xL
SVQKPiA+ID4gPiBAQCAtNDUyLDggKzQyNCw4IEBAIHZvaWQgc3BpY2VfdXNicmVkaXJfY2hhbm5l
bF9jb25uZWN0X2RldmljZV9hc3luYygKPiA+ID4gPiAgICAgIGdfb2JqZWN0X3NldChzcGljZV9j
aGFubmVsX2dldF9zZXNzaW9uKFNQSUNFX0NIQU5ORUwoY2hhbm5lbCkpLAo+ID4gPiA+ICAgICAg
ICAgICAgICAgICAgICJpbmhpYml0LWtleWJvYXJkLWdyYWIiLCBUUlVFLCBOVUxMKTsKPiA+ID4g
PiAgICAgIHNwaWNlX3VzYl9hY2xfaGVscGVyX29wZW5fYWNsX2FzeW5jKHByaXYtPmFjbF9oZWxw
ZXIsCj4gPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWJ1
c2JfZ2V0X2J1c19udW1iZXIoZGV2aWNlKSwKPiA+ID4gPiAtICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGxpYnVzYl9nZXRfZGV2aWNlX2FkZHJlc3MoZGV2aWNlKSwKPiA+
ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZm8tPmJ1cywK
PiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZm8tPmFk
ZHJlc3MsCj4gPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBj
YW5jZWxsYWJsZSwKPiA+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHNwaWNlX3VzYnJlZGlyX2NoYW5uZWxfb3Blbl9hY2xfY2IsCj4gPiA+ID4gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFubmVsKTsKPiA+ID4gPiBAQCAtNTEx
LDkgKzQ4Myw4IEBAIHZvaWQgc3BpY2VfdXNicmVkaXJfY2hhbm5lbF9kaXNjb25uZWN0X2Rldmlj
ZShTcGljZVVzYnJlZGlyQ2hhbm5lbCAqY2hhbm5lbCkKPiA+ID4gPiAgICAgICAgICBnX2NsZWFy
X29iamVjdCgmcHJpdi0+dXNiX2RldmljZV9tYW5hZ2VyKTsKPiA+ID4gPgo+ID4gPiA+ICAgICAg
ICAgIC8qIFRoaXMgYWxzbyBjbG9zZXMgdGhlIGxpYnVzYiBoYW5kbGUgd2UgcGFzc2VkIGZyb20g
b3Blbl9kZXZpY2UgKi8KPiA+ID4gPiAtICAgICAgICB1c2JyZWRpcmhvc3Rfc2V0X2RldmljZShw
cml2LT5ob3N0LCBOVUxMKTsKPiA+ID4gPiAtICAgICAgICBsaWJ1c2JfdW5yZWZfZGV2aWNlKHBy
aXYtPmRldmljZSk7Cj4gPiA+ID4gLSAgICAgICAgcHJpdi0+ZGV2aWNlID0gTlVMTDsKPiA+ID4g
PiArICAgICAgICBzcGljZV91c2JfYmFja2VuZF9jaGFubmVsX2RldGFjaChwcml2LT5ob3N0KTsK
PiA+ID4gPiArICAgICAgICBnX2NsZWFyX3BvaW50ZXIoJnByaXYtPmRldmljZSwgc3BpY2VfdXNi
X2JhY2tlbmRfZGV2aWNlX3VucmVmKTsKPiA+ID4gPiAgICAgICAgICBnX2JveGVkX2ZyZWUoc3Bp
Y2VfdXNiX2RldmljZV9nZXRfdHlwZSgpLCBwcml2LT5zcGljZV9kZXZpY2UpOwo+ID4gPiA+ICAg
ICAgICAgIHByaXYtPnNwaWNlX2RldmljZSA9IE5VTEw7Cj4gPiA+ID4gICAgICAgICAgcHJpdi0+
c3RhdGUgID0gU1RBVEVfRElTQ09OTkVDVEVEOwo+ID4gPiA+IEBAIC01NjQsNyArNTM1LDcgQEAg
c3BpY2VfdXNicmVkaXJfY2hhbm5lbF9nZXRfc3BpY2VfdXNiX2RldmljZShTcGljZVVzYnJlZGly
Q2hhbm5lbCAqY2hhbm5lbCkKPiA+ID4gPiAgI2VuZGlmCj4gPiA+ID4KPiA+ID4gPiAgR19HTlVD
X0lOVEVSTkFMCj4gPiA+ID4gLWxpYnVzYl9kZXZpY2UgKnNwaWNlX3VzYnJlZGlyX2NoYW5uZWxf
Z2V0X2RldmljZShTcGljZVVzYnJlZGlyQ2hhbm5lbCAqY2hhbm5lbCkKPiA+ID4gPiArU3BpY2VV
c2JCYWNrZW5kRGV2aWNlICpzcGljZV91c2JyZWRpcl9jaGFubmVsX2dldF9kZXZpY2UoU3BpY2VV
c2JyZWRpckNoYW5uZWwgKmNoYW5uZWwpCj4gPiA+ID4gIHsKPiA+ID4gPiAgICAgIHJldHVybiBj
aGFubmVsLT5wcml2LT5kZXZpY2U7Cj4gPiA+ID4gIH0KPiA+ID4gPiBAQCAtNTc5LDgzICs1NTAs
MjQgQEAgdm9pZCBzcGljZV91c2JyZWRpcl9jaGFubmVsX2dldF9ndWVzdF9maWx0ZXIoCj4gPiA+
ID4KPiA+ID4gPiAgICAgIGdfcmV0dXJuX2lmX2ZhaWwocHJpdi0+aG9zdCAhPSBOVUxMKTsKPiA+
ID4gPgo+ID4gPiA+IC0gICAgdXNicmVkaXJob3N0X2dldF9ndWVzdF9maWx0ZXIocHJpdi0+aG9z
dCwgcnVsZXNfcmV0LCBydWxlc19jb3VudF9yZXQpOwo+ID4gPiA+ICsgICAgc3BpY2VfdXNiX2Jh
Y2tlbmRfY2hhbm5lbF9nZXRfZ3Vlc3RfZmlsdGVyKHByaXYtPmhvc3QsIHJ1bGVzX3JldCwgcnVs
ZXNfY291bnRfcmV0KTsKPiA+ID4gPiAgfQo+ID4gPiA+Cj4gPiA+ID4gIC8qIC0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAq
Lwo+ID4gPiA+ICAvKiBjYWxsYmFja3MgKGFueSBjb250ZXh0KSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgKi8KPiA+ID4gPgo+ID4gPiA+IC1zdGF0aWMgdWludDY0
X3QgdXNicmVkaXJfYnVmZmVyZWRfb3V0cHV0X3NpemVfY2FsbGJhY2sodm9pZCAqdXNlcl9kYXRh
KQo+ID4gPiA+ICtzdGF0aWMgdWludDY0X3QgdXNicmVkaXJfZ2V0X3F1ZXVlX3NpemUodm9pZCAq
dXNlcl9kYXRhKQo+ID4gPiA+ICB7Cj4gPiA+ID4gICAgICBnX3JldHVybl92YWxfaWZfZmFpbChT
UElDRV9JU19VU0JSRURJUl9DSEFOTkVMKHVzZXJfZGF0YSksIDApOwo+ID4gPiA+ICAgICAgcmV0
dXJuIHNwaWNlX2NoYW5uZWxfZ2V0X3F1ZXVlX3NpemUoU1BJQ0VfQ0hBTk5FTCh1c2VyX2RhdGEp
KTsKPiA+ID4gPiAgfQo+ID4gPiA+Cj4gPiA+ID4gLS8qIE5vdGUgdGhhdCB0aGlzIGZ1bmN0aW9u
IG11c3QgYmUgcmUtZW50cmFudCBzYWZlLCBhcyBpdCBjYW4gZ2V0IGNhbGxlZAo+ID4gPiA+IC0g
ICBmcm9tIGJvdGggdGhlIG1haW4gdGhyZWFkIGFzIHdlbGwgYXMgZnJvbSB0aGUgdXNiIGV2ZW50
IGhhbmRsaW5nIHRocmVhZCAqLwo+ID4gPiA+IC1zdGF0aWMgdm9pZCB1c2JyZWRpcl93cml0ZV9m
bHVzaF9jYWxsYmFjayh2b2lkICp1c2VyX2RhdGEpCj4gPiA+ID4gK3N0YXRpYyBnYm9vbGVhbiB1
c2JyZWRpcl9pc19jaGFubmVsX3JlYWR5KHZvaWQgKnVzZXJfZGF0YSkKPiA+ID4gPiAgewo+ID4g
PiA+ICAgICAgU3BpY2VVc2JyZWRpckNoYW5uZWwgKmNoYW5uZWwgPSBTUElDRV9VU0JSRURJUl9D
SEFOTkVMKHVzZXJfZGF0YSk7Cj4gPiA+ID4gICAgICBTcGljZVVzYnJlZGlyQ2hhbm5lbFByaXZh
dGUgKnByaXYgPSBjaGFubmVsLT5wcml2Owo+ID4gPiA+IC0KPiA+ID4gPiAtICAgIGlmIChzcGlj
ZV9jaGFubmVsX2dldF9zdGF0ZShTUElDRV9DSEFOTkVMKGNoYW5uZWwpKSAhPQo+ID4gPiA+IC0g
ICAgICAgICAgICBTUElDRV9DSEFOTkVMX1NUQVRFX1JFQURZKQo+ID4gPiA+IC0gICAgICAgIHJl
dHVybjsKPiA+ID4gPiAtCj4gPiA+ID4gLSAgICBpZiAoIXByaXYtPmhvc3QpCj4gPiA+ID4gLSAg
ICAgICAgcmV0dXJuOwo+ID4gPiA+IC0KPiA+ID4gPiAtICAgIHVzYnJlZGlyaG9zdF93cml0ZV9n
dWVzdF9kYXRhKHByaXYtPmhvc3QpOwo+ID4gPiA+IC19Cj4gPiA+ID4gLQo+ID4gPiA+IC1zdGF0
aWMgdm9pZCB1c2JyZWRpcl9sb2codm9pZCAqdXNlcl9kYXRhLCBpbnQgbGV2ZWwsIGNvbnN0IGNo
YXIgKm1zZykKPiA+ID4gPiAtewo+ID4gPiA+IC0gICAgU3BpY2VVc2JyZWRpckNoYW5uZWwgKmNo
YW5uZWwgPSB1c2VyX2RhdGE7Cj4gPiA+ID4gLSAgICBTcGljZVVzYnJlZGlyQ2hhbm5lbFByaXZh
dGUgKnByaXYgPSBjaGFubmVsLT5wcml2Owo+ID4gPiA+IC0KPiA+ID4gPiAtICAgIGlmIChwcml2
LT5jYXRjaF9lcnJvciAmJiBsZXZlbCA9PSB1c2JyZWRpcnBhcnNlcl9lcnJvcikgewo+ID4gPiA+
IC0gICAgICAgIENIQU5ORUxfREVCVUcoY2hhbm5lbCwgIiVzIiwgbXNnKTsKPiA+ID4gPiAtICAg
ICAgICAvKiBSZW1vdmUgInVzYnJlZGlyaG9zdDogIiBwcmVmaXggZnJvbSB1c2JyZWRpcmhvc3Qg
bWVzc2FnZXMgKi8KPiA+ID4gPiAtICAgICAgICBpZiAoc3RybmNtcChtc2csICJ1c2JyZWRpcmhv
c3Q6ICIsIDE0KSA9PSAwKQo+ID4gPiA+IC0gICAgICAgICAgICBnX3NldF9lcnJvcl9saXRlcmFs
KHByaXYtPmNhdGNoX2Vycm9yLCBTUElDRV9DTElFTlRfRVJST1IsCj4gPiA+ID4gLSAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgU1BJQ0VfQ0xJRU5UX0VSUk9SX0ZBSUxFRCwgbXNnICsg
MTQpOwo+ID4gPiA+IC0gICAgICAgIGVsc2UKPiA+ID4gPiAtICAgICAgICAgICAgZ19zZXRfZXJy
b3JfbGl0ZXJhbChwcml2LT5jYXRjaF9lcnJvciwgU1BJQ0VfQ0xJRU5UX0VSUk9SLAo+ID4gPiA+
IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNQSUNFX0NMSUVOVF9FUlJPUl9GQUlM
RUQsIG1zZyk7Cj4gPiA+ID4gLSAgICAgICAgcmV0dXJuOwo+ID4gPiA+IC0gICAgfQo+ID4gPiA+
IC0KPiA+ID4gPiAtICAgIHN3aXRjaCAobGV2ZWwpIHsKPiA+ID4gPiAtICAgICAgICBjYXNlIHVz
YnJlZGlycGFyc2VyX2Vycm9yOgo+ID4gPiA+IC0gICAgICAgICAgICBnX2NyaXRpY2FsKCIlcyIs
IG1zZyk7Cj4gPiA+ID4gLSAgICAgICAgICAgIGJyZWFrOwo+ID4gPiA+IC0gICAgICAgIGNhc2Ug
dXNicmVkaXJwYXJzZXJfd2FybmluZzoKPiA+ID4gPiAtICAgICAgICAgICAgZ193YXJuaW5nKCIl
cyIsIG1zZyk7Cj4gPiA+ID4gLSAgICAgICAgICAgIGJyZWFrOwo+ID4gPiA+IC0gICAgICAgIGRl
ZmF1bHQ6Cj4gPiA+ID4gLSAgICAgICAgICAgIENIQU5ORUxfREVCVUcoY2hhbm5lbCwgIiVzIiwg
bXNnKTsKPiA+ID4gPiAtICAgIH0KPiA+ID4gPiAtfQo+ID4gPiA+IC0KPiA+ID4gPiAtc3RhdGlj
IGludCB1c2JyZWRpcl9yZWFkX2NhbGxiYWNrKHZvaWQgKnVzZXJfZGF0YSwgdWludDhfdCAqZGF0
YSwgaW50IGNvdW50KQo+ID4gPiA+IC17Cj4gPiA+ID4gLSAgICBTcGljZVVzYnJlZGlyQ2hhbm5l
bCAqY2hhbm5lbCA9IHVzZXJfZGF0YTsKPiA+ID4gPiAtICAgIFNwaWNlVXNicmVkaXJDaGFubmVs
UHJpdmF0ZSAqcHJpdiA9IGNoYW5uZWwtPnByaXY7Cj4gPiA+ID4gLQo+ID4gPiA+IC0gICAgY291
bnQgPSBNSU4ocHJpdi0+cmVhZF9idWZfc2l6ZSwgY291bnQpOwo+ID4gPiA+IC0KPiA+ID4gPiAt
ICAgIGlmIChjb3VudCAhPSAwKSB7Cj4gPiA+ID4gLSAgICAgICAgbWVtY3B5KGRhdGEsIHByaXYt
PnJlYWRfYnVmLCBjb3VudCk7Cj4gPiA+ID4gLSAgICB9Cj4gPiA+ID4gLQo+ID4gPiA+IC0gICAg
cHJpdi0+cmVhZF9idWZfc2l6ZSAtPSBjb3VudDsKPiA+ID4gPiAtICAgIGlmIChwcml2LT5yZWFk
X2J1Zl9zaXplKSB7Cj4gPiA+ID4gLSAgICAgICAgcHJpdi0+cmVhZF9idWYgKz0gY291bnQ7Cj4g
PiA+ID4gLSAgICB9IGVsc2Ugewo+ID4gPiA+IC0gICAgICAgIHByaXYtPnJlYWRfYnVmID0gTlVM
TDsKPiA+ID4gPiAtICAgIH0KPiA+ID4gPiAtCj4gPiA+ID4gLSAgICByZXR1cm4gY291bnQ7Cj4g
PiA+ID4gKyAgICByZXR1cm4gcHJpdi0+aG9zdCAhPSBOVUxMICYmCj4gPiA+ID4gKyAgICAgICAg
ICAgc3BpY2VfY2hhbm5lbF9nZXRfc3RhdGUoU1BJQ0VfQ0hBTk5FTChjaGFubmVsKSkgPT0gU1BJ
Q0VfQ0hBTk5FTF9TVEFURV9SRUFEWTsKPiA+ID4gPiAgfQo+ID4gPiA+Cj4gPiA+ID4gIHN0YXRp
YyB2b2lkIHVzYnJlZGlyX2ZyZWVfd3JpdGVfY2JfZGF0YSh1aW50OF90ICpkYXRhLCB2b2lkICp1
c2VyX2RhdGEpCj4gPiA+ID4gQEAgLTY2Myw3ICs1NzUsNyBAQCBzdGF0aWMgdm9pZCB1c2JyZWRp
cl9mcmVlX3dyaXRlX2NiX2RhdGEodWludDhfdCAqZGF0YSwgdm9pZCAqdXNlcl9kYXRhKQo+ID4g
PiA+ICAgICAgU3BpY2VVc2JyZWRpckNoYW5uZWwgKmNoYW5uZWwgPSB1c2VyX2RhdGE7Cj4gPiA+
ID4gICAgICBTcGljZVVzYnJlZGlyQ2hhbm5lbFByaXZhdGUgKnByaXYgPSBjaGFubmVsLT5wcml2
Owo+ID4gPiA+Cj4gPiA+ID4gLSAgICB1c2JyZWRpcmhvc3RfZnJlZV93cml0ZV9idWZmZXIocHJp
di0+aG9zdCwgZGF0YSk7Cj4gPiA+ID4gKyAgICBzcGljZV91c2JfYmFja2VuZF9yZXR1cm5fd3Jp
dGVfZGF0YShwcml2LT5ob3N0LCBkYXRhKTsKPiA+ID4gPiAgfQo+ID4gPiA+Cj4gPiA+ID4gICNp
ZmRlZiBVU0VfTFo0Cj4gPiA+ID4gQEAgLTczNSw3ICs2NDcsNyBAQCBzdGF0aWMgaW50IHVzYnJl
ZGlyX3dyaXRlX2NhbGxiYWNrKHZvaWQgKnVzZXJfZGF0YSwgdWludDhfdCAqZGF0YSwgaW50IGNv
dW50KQo+ID4gPiA+Cj4gPiA+ID4gICNpZmRlZiBVU0VfTFo0Cj4gPiA+ID4gICAgICBpZiAodHJ5
X3dyaXRlX2NvbXByZXNzX0xaNChjaGFubmVsLCBkYXRhLCBjb3VudCkpIHsKPiA+ID4gPiAtICAg
ICAgICB1c2JyZWRpcmhvc3RfZnJlZV93cml0ZV9idWZmZXIoY2hhbm5lbC0+cHJpdi0+aG9zdCwg
ZGF0YSk7Cj4gPiA+ID4gKyAgICAgICAgc3BpY2VfdXNiX2JhY2tlbmRfcmV0dXJuX3dyaXRlX2Rh
dGEoY2hhbm5lbC0+cHJpdi0+aG9zdCwgZGF0YSk7Cj4gPiA+ID4gICAgICAgICAgcmV0dXJuIGNv
dW50Owo+ID4gPiA+ICAgICAgfQo+ID4gPiA+ICAjZW5kaWYKPiA+ID4gPiBAQCAtNzQ4LDE1ICs2
NjAsNiBAQCBzdGF0aWMgaW50IHVzYnJlZGlyX3dyaXRlX2NhbGxiYWNrKHZvaWQgKnVzZXJfZGF0
YSwgdWludDhfdCAqZGF0YSwgaW50IGNvdW50KQo+ID4gPiA+ICAgICAgcmV0dXJuIGNvdW50Owo+
ID4gPiA+ICB9Cj4gPiA+ID4KPiA+ID4gPiAtc3RhdGljIHZvaWQgKnVzYnJlZGlyX2FsbG9jX2xv
Y2sodm9pZCkgewo+ID4gPiA+IC0gICAgR011dGV4ICptdXRleDsKPiA+ID4gPiAtCj4gPiA+ID4g
LSAgICBtdXRleCA9IGdfbmV3MChHTXV0ZXgsIDEpOwo+ID4gPiA+IC0gICAgZ19tdXRleF9pbml0
KG11dGV4KTsKPiA+ID4gPiAtCj4gPiA+ID4gLSAgICByZXR1cm4gbXV0ZXg7Cj4gPiA+ID4gLX0K
PiA+ID4gPiAtCj4gPiA+ID4gIEdfR05VQ19JTlRFUk5BTAo+ID4gPiA+ICB2b2lkIHNwaWNlX3Vz
YnJlZGlyX2NoYW5uZWxfbG9jayhTcGljZVVzYnJlZGlyQ2hhbm5lbCAqY2hhbm5lbCkKPiA+ID4g
PiAgewo+ID4gPiA+IEBAIC03NjksMjUgKzY3Miw2IEBAIHZvaWQgc3BpY2VfdXNicmVkaXJfY2hh
bm5lbF91bmxvY2soU3BpY2VVc2JyZWRpckNoYW5uZWwgKmNoYW5uZWwpCj4gPiA+ID4gICAgICBn
X211dGV4X3VubG9jaygmY2hhbm5lbC0+cHJpdi0+ZGV2aWNlX2Nvbm5lY3RfbXV0ZXgpOwo+ID4g
PiA+ICB9Cj4gPiA+ID4KPiA+ID4gPiAtc3RhdGljIHZvaWQgdXNicmVkaXJfbG9ja19sb2NrKHZv
aWQgKnVzZXJfZGF0YSkgewo+ID4gPiA+IC0gICAgR011dGV4ICptdXRleCA9IHVzZXJfZGF0YTsK
PiA+ID4gPiAtCj4gPiA+ID4gLSAgICBnX211dGV4X2xvY2sobXV0ZXgpOwo+ID4gPiA+IC19Cj4g
PiA+ID4gLQo+ID4gPiA+IC1zdGF0aWMgdm9pZCB1c2JyZWRpcl91bmxvY2tfbG9jayh2b2lkICp1
c2VyX2RhdGEpIHsKPiA+ID4gPiAtICAgIEdNdXRleCAqbXV0ZXggPSB1c2VyX2RhdGE7Cj4gPiA+
ID4gLQo+ID4gPiA+IC0gICAgZ19tdXRleF91bmxvY2sobXV0ZXgpOwo+ID4gPiA+IC19Cj4gPiA+
ID4gLQo+ID4gPiA+IC1zdGF0aWMgdm9pZCB1c2JyZWRpcl9mcmVlX2xvY2sodm9pZCAqdXNlcl9k
YXRhKSB7Cj4gPiA+ID4gLSAgICBHTXV0ZXggKm11dGV4ID0gdXNlcl9kYXRhOwo+ID4gPiA+IC0K
PiA+ID4gPiAtICAgIGdfbXV0ZXhfY2xlYXIobXV0ZXgpOwo+ID4gPiA+IC0gICAgZ19mcmVlKG11
dGV4KTsKPiA+ID4gPiAtfQo+ID4gPiA+IC0KPiA+ID4gPiAgLyogLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovCj4g
PiA+ID4KPiA+ID4gPiAgdHlwZWRlZiBzdHJ1Y3QgZGV2aWNlX2Vycm9yX2RhdGEgewo+ID4gPiA+
IEBAIC04MjYsNyArNzEwLDcgQEAgc3RhdGljIHZvaWQgc3BpY2VfdXNicmVkaXJfY2hhbm5lbF91
cChTcGljZUNoYW5uZWwgKmMpCj4gPiA+ID4KPiA+ID4gPiAgICAgIGdfcmV0dXJuX2lmX2ZhaWwo
cHJpdi0+aG9zdCAhPSBOVUxMKTsKPiA+ID4gPiAgICAgIC8qIEZsdXNoIGFueSBwZW5kaW5nIHdy
aXRlcyAqLwo+ID4gPiA+IC0gICAgdXNicmVkaXJob3N0X3dyaXRlX2d1ZXN0X2RhdGEocHJpdi0+
aG9zdCk7Cj4gPiA+ID4gKyAgICBzcGljZV91c2JfYmFja2VuZF9jaGFubmVsX3VwKHByaXYtPmhv
c3QpOwo+ID4gPgo+ID4gPiBzcGljZV91c2JfYmFja2VuZF9jaGFubmVsX3VwKCkgY2FsbHMKPiA+
ID4gdXNicmVkaXJob3N0X3dyaXRlX2d1ZXN0X2RhdGEoKSBzbyBJTUhPIGEgYmV0dGVyIG5hbWUg
aXMgbmVlZGVkCj4gPiA+IGZvciB0aGlzIHdyYXBwZXIuIFBlcmhhcHMgc3BpY2VfdXNiX2JhY2tl
bmRfd3JpdGVfdG9fZ3Vlc3QoKSBvcgo+ID4gPiBzb21ldGhpbmcuCj4gPgo+ID4gRnJvbSBteSBw
b2ludCBvZiB2aWV3LCB0aGUgbmFtZSBsaWtlICJzcGljZV91c2JfYmFja2VuZF93cml0ZV90b19n
dWVzdCIKPiA+IGlzIG11Y2ggbGVzcyBjbGVhciBhbmQgbWFrZXMgaW1wcmVzc2lvbiB0aGF0IHRo
ZSB1c2ItcmVkaXItY2hhbm5lbCBzaG91bGQKPiA+IHVzZSBpdCB0byB3cml0ZSBkYXRhIHRvIGd1
ZXN0IHdoZW4gaXQgaXMgbm90Lgo+ID4gVHlwaWNhbGx5IHdlIGNhbGwgdXNicmVkaXJob3N0X3dy
aXRlX2d1ZXN0X2RhdGEoKSBvbmx5IHdoZW4gd2UgcmVjZWl2ZQo+ID4gJ2ZsdXNoJyBjYWxsYmFj
ayBmcm9tIHRoZSB1c2JyZWRpcmhvc3QgYW5kIG9ubHkgd2hlbiB3ZSdyZSByZWFkeSB0bwo+ID4g
c2VuZCBkYXRhLiBCdXQgaXQgaXMgcG9zc2libGUgdGhhdCB3aGVuIHdlIGNyZWF0ZSB0aGUgaW5z
dGFuY2Ugb2YKPiA+IHVzYnJlZGlyaG9zdCwgd2UgYXJlIG5vdCByZWFkeSB0byBzZW5kIGRhdGEg
eWV0IGFuZCB1c2JyZWRpcmhvc3QgaG9sZHMKPiA+IHRoZSBkYXRhIGJ1dCBub3QgYWJsZSB0byBz
ZW5kIHRoZW07IGl0IHdpbGwgbm90IGlzc3VlIGFub3RoZXIgJ2ZsdXNoJyBjYWxsYmFjawo+ID4g
dW50aWwgaXQgaGFzIGEgcmVhc29uLiBTbywgd2hlbiB0aGUgY2hhbm5lbCBnZXRzIHVwLCB3ZSBt
YWtlIHNpbmdsZQo+ID4gY2FsbCB0byB1c2JyZWRpcmhvc3QgdG8gZmx1c2ggdGhlIGRhdGEgdGhh
dCBpdCBoYXMgaW5zaWRlIGlmIGFueS4gVGhpcyBpcwo+ID4gZXhhY3RseSAnY2hhbm5lbCBpcyB1
cCcgbm90aWZpY2F0aW9uIHRvIHRoZSB1c2IgYmFja2VuZC4KPgo+IE9rLCB3aGF0IGFib3V0IHNw
aWNlX3VzYl9iYWNrZW5kX2ZsdXNoKCkgPyBNeSBjb25mdXNpb24gd2l0aAo+IF9jaGFubmVsX3Vw
KCkgaXMgdGhhdCBpcyBjbGVhciB0byBtZSBvbiBzcGljZS1jaGFubmVsIGJ1dCBmbHVzaAo+IG9y
IHRyeS13cml0ZSwgdHJ5LXJlYWQgc2VlbXMgbmljZXIgb24gdXNiX2JhY2tlbmQgbGV2ZWwsIG5v
PwpDaGFuZ2VkIHRvIHNwaWNlX3VzYl9iYWNrZW5kX2NoYW5uZWxfZmx1c2hfd3JpdGVzIGluCmh0
dHBzOi8vZ2l0bGFiLmZyZWVkZXNrdG9wLm9yZy95dXJpX2JlbmRpdG92aWNoL3NwaWNlLWd0ay9j
b21taXRzL2JhY2tlbmQyLWluY3JlbWVudAo+Cj4gPiA+ID4gIHN0YXRpYyBpbnQgdHJ5X2hhbmRs
ZV9jb21wcmVzc2VkX21zZyhTcGljZU1zZ0NvbXByZXNzZWREYXRhICpjb21wcmVzc2VkX2RhdGFf
bXNnLAo+ID4gPiA+IEBAIC04NzYsMjYgKzc2MCwyMCBAQCBzdGF0aWMgdm9pZCB1c2JyZWRpcl9o
YW5kbGVfbXNnKFNwaWNlQ2hhbm5lbCAqYywgU3BpY2VNc2dJbiAqaW4pCj4gPiA+ID4KPiA+ID4g
PiAgICAgIGdfcmV0dXJuX2lmX2ZhaWwocHJpdi0+aG9zdCAhPSBOVUxMKTsKPiA+ID4gPgo+ID4g
PiA+IC0gICAgLyogTm8gcmVjdXJzaW9uIGFsbG93ZWQhICovCj4gPiA+ID4gLSAgICBnX3JldHVy
bl9pZl9mYWlsKHByaXYtPnJlYWRfYnVmID09IE5VTEwpOwo+ID4gPiA+IC0KPiA+ID4gPiAgICAg
IGlmIChzcGljZV9tc2dfaW5fdHlwZShpbikgPT0gU1BJQ0VfTVNHX1NQSUNFVk1DX0NPTVBSRVNT
RURfREFUQSkgewo+ID4gPiA+ICAgICAgICAgIFNwaWNlTXNnQ29tcHJlc3NlZERhdGEgKmNvbXBy
ZXNzZWRfZGF0YV9tc2cgPSBzcGljZV9tc2dfaW5fcGFyc2VkKGluKTsKPiA+ID4gPiAgICAgICAg
ICBpZiAodHJ5X2hhbmRsZV9jb21wcmVzc2VkX21zZyhjb21wcmVzc2VkX2RhdGFfbXNnLCAmYnVm
LCAmc2l6ZSkpIHsKPiA+ID4gPiAtICAgICAgICAgICAgcHJpdi0+cmVhZF9idWZfc2l6ZSA9IHNp
emU7Cj4gPiA+ID4gLSAgICAgICAgICAgIHByaXYtPnJlYWRfYnVmID0gYnVmOwo+ID4gPiA+ICsg
ICAgICAgICAgICAvKiB1bmNvbXByZXNzZWQgb2sqLwo+ID4gPiA+ICAgICAgICAgIH0gZWxzZSB7
Cj4gPiA+ID4gLSAgICAgICAgICAgIHIgPSB1c2JyZWRpcmhvc3RfcmVhZF9wYXJzZV9lcnJvcjsK
PiA+ID4gPiArICAgICAgICAgICAgciA9IFVTQl9SRURJUl9FUlJPUl9SRUFEX1BBUlNFOwo+ID4g
PiA+ICAgICAgICAgIH0KPiA+ID4gPiAgICAgIH0gZWxzZSB7IC8qIFJlZ3VsYXIgU1BJQ0VfTVNH
X1NQSUNFVk1DX0RBVEEgbXNnICovCj4gPiA+ID4gICAgICAgICAgYnVmID0gc3BpY2VfbXNnX2lu
X3JhdyhpbiwgJnNpemUpOwo+ID4gPiA+IC0gICAgICAgIHByaXYtPnJlYWRfYnVmX3NpemUgPSBz
aXplOwo+ID4gPiA+IC0gICAgICAgIHByaXYtPnJlYWRfYnVmID0gYnVmOwo+ID4gPiA+ICAgICAg
fQo+ID4gPiA+Cj4gPiA+ID4gICAgICBzcGljZV91c2JyZWRpcl9jaGFubmVsX2xvY2soY2hhbm5l
bCk7Cj4gPiA+ID4gICAgICBpZiAociA9PSAwKQo+ID4gPiA+IC0gICAgICAgIHIgPSB1c2JyZWRp
cmhvc3RfcmVhZF9ndWVzdF9kYXRhKHByaXYtPmhvc3QpOwo+ID4gPiA+ICsgICAgICAgIHIgPSBz
cGljZV91c2JfYmFja2VuZF9wcm92aWRlX3JlYWRfZGF0YShwcml2LT5ob3N0LCBidWYsIHNpemUp
Owo+ID4gPgo+ID4gPiBQZXJoYXBzIHNwaWNlX3VzYl9iYWNrZW5kX3JlYWRfZnJvbV9ndWVzdCgp
Cj4gPiA+Cj4gPiA+ID4gICAgICBpZiAociAhPSAwKSB7Cj4gPiA+ID4gICAgICAgICAgU3BpY2VV
c2JEZXZpY2UgKnNwaWNlX2RldmljZSA9IHByaXYtPnNwaWNlX2RldmljZTsKPiA+ID4gPiAgICAg
ICAgICBkZXZpY2VfZXJyb3JfZGF0YSBlcnJfZGF0YTsKPiA+ID4gPiBAQCAtOTA5LDE2ICs3ODcs
MTYgQEAgc3RhdGljIHZvaWQgdXNicmVkaXJfaGFuZGxlX21zZyhTcGljZUNoYW5uZWwgKmMsIFNw
aWNlTXNnSW4gKmluKQo+ID4gPiA+Cj4gPiA+ID4gICAgICAgICAgZGVzYyA9IHNwaWNlX3VzYl9k
ZXZpY2VfZ2V0X2Rlc2NyaXB0aW9uKHNwaWNlX2RldmljZSwgTlVMTCk7Cj4gPiA+ID4gICAgICAg
ICAgc3dpdGNoIChyKSB7Cj4gPiA+ID4gLSAgICAgICAgY2FzZSB1c2JyZWRpcmhvc3RfcmVhZF9w
YXJzZV9lcnJvcjoKPiA+ID4gPiArICAgICAgICBjYXNlIFVTQl9SRURJUl9FUlJPUl9SRUFEX1BB
UlNFOgo+ID4gPiA+ICAgICAgICAgICAgICBlcnIgPSBnX2Vycm9yX25ldyhTUElDRV9DTElFTlRf
RVJST1IsIFNQSUNFX0NMSUVOVF9FUlJPUl9GQUlMRUQsCj4gPiA+ID4gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIF8oInVzYnJlZGlyIHByb3RvY29sIHBhcnNlIGVycm9yIGZvciAlcyIp
LCBkZXNjKTsKPiA+ID4gPiAgICAgICAgICAgICAgYnJlYWs7Cj4gPiA+ID4gLSAgICAgICAgY2Fz
ZSB1c2JyZWRpcmhvc3RfcmVhZF9kZXZpY2VfcmVqZWN0ZWQ6Cj4gPiA+ID4gKyAgICAgICAgY2Fz
ZSBVU0JfUkVESVJfRVJST1JfREVWX1JFSkVDVEVEOgo+ID4gPiA+ICAgICAgICAgICAgICBlcnIg
PSBnX2Vycm9yX25ldyhTUElDRV9DTElFTlRfRVJST1IsCj4gPiA+ID4gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIFNQSUNFX0NMSUVOVF9FUlJPUl9VU0JfREVWSUNFX1JFSkVDVEVELAo+
ID4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfKCIlcyByZWplY3RlZCBieSBo
b3N0IiksIGRlc2MpOwo+ID4gPiA+ICAgICAgICAgICAgICBicmVhazsKPiA+ID4gPiAtICAgICAg
ICBjYXNlIHVzYnJlZGlyaG9zdF9yZWFkX2RldmljZV9sb3N0Ogo+ID4gPiA+ICsgICAgICAgIGNh
c2UgVVNCX1JFRElSX0VSUk9SX0RFVl9MT1NUOgo+ID4gPgo+ID4gPiBBbiB1dGlsaXR5IGZ1bmN0
aW9uIGZyb20gdXNiLWJhY2tlbmQgdG8gbWFrZSBhbiBlcnJvciB0byBHRXJyb3IKPiA+ID4gd291
bGQgYmUgZ29vZCBmaXQgSSB0aGluaywgd2hpY2ggd291bGQgcmVtb3ZlIHRoaXMgY29kZSBoZXJl
IGFzCj4gPiA+IHdlbGwuCj4gPiA+Cj4gPiA+ID4gICAgICAgICAgICAgIGVyciA9IGdfZXJyb3Jf
bmV3KFNQSUNFX0NMSUVOVF9FUlJPUiwKPiA+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgU1BJQ0VfQ0xJRU5UX0VSUk9SX1VTQl9ERVZJQ0VfTE9TVCwKPiA+ID4gPiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgXygiJXMgZGlzY29ubmVjdGVkIChmYXRhbCBJTyBlcnJv
cikiKSwgZGVzYyk7Cj4gPiA+ID4gZGlmZiAtLWdpdCBhL3NyYy9tZXNvbi5idWlsZCBiL3NyYy9t
ZXNvbi5idWlsZAo+ID4gPiA+IGluZGV4IDUzNjVmMDUuLmE1MWQwYTkgMTAwNjQ0Cj4gPiA+ID4g
LS0tIGEvc3JjL21lc29uLmJ1aWxkCj4gPiA+ID4gKysrIGIvc3JjL21lc29uLmJ1aWxkCj4gPiA+
ID4gQEAgLTEyMSw2ICsxMjEsOCBAQCBzcGljZV9jbGllbnRfZ2xpYl9zb3VyY2VzID0gWwo+ID4g
PiA+ICAgICd1c2ItZGV2aWNlLW1hbmFnZXItcHJpdi5oJywKPiA+ID4gPiAgICAndXNidXRpbC5j
JywKPiA+ID4gPiAgICAndXNidXRpbC5oJywKPiA+ID4gPiArICAndXNiLWJhY2tlbmQuYycsCj4g
PiA+ID4gKyAgJ3VzYi1iYWNrZW5kLmgnLAo+ID4gPiA+ICAgICd2bWNzdHJlYW0uYycsCj4gPiA+
ID4gICAgJ3ZtY3N0cmVhbS5oJywKPiA+ID4gPiAgXQo+ID4gPiA+IGRpZmYgLS1naXQgYS9zcmMv
dXNiLWJhY2tlbmQuYyBiL3NyYy91c2ItYmFja2VuZC5jCj4gPiA+ID4gbmV3IGZpbGUgbW9kZSAx
MDA2NDQKPiA+ID4gPiBpbmRleCAwMDAwMDAwLi42NzVlYjYyCj4gPiA+ID4gLS0tIC9kZXYvbnVs
bAo+ID4gPiA+ICsrKyBiL3NyYy91c2ItYmFja2VuZC5jCj4gPiA+ID4gQEAgLTAsMCArMSw2MjIg
QEAKPiA+ID4gPiArLyogLSotIE1vZGU6IEM7IGMtYmFzaWMtb2Zmc2V0OiA0OyBpbmRlbnQtdGFi
cy1tb2RlOiBuaWwgLSotICovCj4gPiA+ID4gKy8qCj4gPiA+ID4gKyAgICBDb3B5cmlnaHQgKEMp
IDIwMTItMjAxOCBSZWQgSGF0LCBJbmMuCj4gPiA+ID4gKwo+ID4gPiA+ICsgICAgUmVkIEhhdCBB
dXRob3JzOgo+ID4gPiA+ICsgICAgWXVyaSBCZW5kaXRvdmljaDx5YmVuZGl0b0ByZWRoYXQuY29t
Pgo+ID4gPiA+ICsgICAgSGFucyBkZSBHb2VkZSA8aGRlZ29lZGVAcmVkaGF0LmNvbT4KPiA+ID4g
PiArCj4gPiA+ID4gKyAgICBUaGlzIGxpYnJhcnkgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiBy
ZWRpc3RyaWJ1dGUgaXQgYW5kL29yCj4gPiA+ID4gKyAgICBtb2RpZnkgaXQgdW5kZXIgdGhlIHRl
cm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCj4gPiA+ID4gKyAgICBMaWNlbnNl
IGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIKPiA+
ID4gPiArICAgIHZlcnNpb24gMi4xIG9mIHRoZSBMaWNlbnNlLCBvciAoYXQgeW91ciBvcHRpb24p
IGFueSBsYXRlciB2ZXJzaW9uLgo+ID4gPiA+ICsKPiA+ID4gPiArICAgIFRoaXMgbGlicmFyeSBp
cyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAo+ID4gPiA+
ICsgICAgYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQg
d2FycmFudHkgb2YKPiA+ID4gPiArICAgIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBB
IFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUgR05VCj4gPiA+ID4gKyAgICBMZXNzZXIgR2Vu
ZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgo+ID4gPiA+ICsKPiA+ID4gPiAr
ICAgIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBMZXNzZXIgR2Vu
ZXJhbCBQdWJsaWMKPiA+ID4gPiArICAgIExpY2Vuc2UgYWxvbmcgd2l0aCB0aGlzIGxpYnJhcnk7
IGlmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4KPiA+ID4gPiArKi8K
PiA+ID4gPiArCj4gPiA+ID4gKyNpbmNsdWRlICJjb25maWcuaCIKPiA+ID4gPiArCj4gPiA+ID4g
KyNpZmRlZiBVU0VfVVNCUkVESVIKPiA+ID4gPiArCj4gPiA+ID4gKyNpbmNsdWRlIDxnbGliLW9i
amVjdC5oPgo+ID4gPiA+ICsjaW5jbHVkZSA8aW50dHlwZXMuaD4KPiA+ID4gPiArI2luY2x1ZGUg
PGdpby9naW8uaD4KPiA+ID4gPiArI2luY2x1ZGUgPGVycm5vLmg+Cj4gPiA+ID4gKyNpbmNsdWRl
IDxsaWJ1c2IuaD4KPiA+ID4gPiArI2luY2x1ZGUgPHN0cmluZy5oPgo+ID4gPiA+ICsjaW5jbHVk
ZSA8ZmNudGwuaD4KPiA+ID4gPiArI2luY2x1ZGUgInVzYnJlZGlyaG9zdC5oIgo+ID4gPiA+ICsj
aW5jbHVkZSAidXNicmVkaXJwYXJzZXIuaCIKPiA+ID4gPiArI2luY2x1ZGUgInNwaWNlLXV0aWwu
aCIKPiA+ID4gPiArI2luY2x1ZGUgInVzYi1iYWNrZW5kLmgiCj4gPiA+ID4gKwo+ID4gPiA+ICsv
LyNkZWZpbmUgTE9VRF9ERUJVRyBTUElDRV9ERUJVRwo+ID4gPiA+ICsjZGVmaW5lIExPVURfREVC
VUcoeCwgLi4uKQo+ID4gPgo+ID4gPiBBbnkgcmVhc29uIHRoaXMgaXMgYmVpbmcga2VwdD8KPiA+
Cj4gPiBUaGlzIGlzIGNsZWFyIHBsYWNlIHdoZXJlIGxvdWQgcHJpbnRvdXRzIGNhbiBiZSBlbmFi
bGVkCj4gPiBmb3IgZGVidWcgcHVycG9zZS4KPgo+IEl0IGlzIGEgY29tcGlsZSB0aW1lIGNoYW5n
ZSwgdGhhdCBzZWVtcyBvayBmcm9tIGRldmVsb3BlciBvbgo+IGRldmVsb3Bpbmcgc3RhZ2UuIE9u
IG1haW50YWluaW5nIHN0YWdlLCB3ZSB3YW50IGVpdGhlciBhIHJ1bnRpbWUKPiB3YXkgdG8gZW5h
YmxlIGxvdWQgZGVidWdzIG9yIHRoYXQgdGhleSBhcmUgcHJlc2VudCBzb21laG93LgpBZGRyZXNz
ZWQgaW4gaHR0cHM6Ly9naXRsYWIuZnJlZWRlc2t0b3Aub3JnL3l1cmlfYmVuZGl0b3ZpY2gvc3Bp
Y2UtZ3RrL2NvbW1pdHMvYmFja2VuZDItaW5jcmVtZW50Cj4KPiA+ID4KPiA+ID4gPiArCj4gPiA+
ID4gK3N0cnVjdCBfU3BpY2VVc2JCYWNrZW5kRGV2aWNlCj4gPiA+ID4gK3sKPiA+ID4gPiArICAg
IGxpYnVzYl9kZXZpY2UgKmxpYnVzYl9kZXZpY2U7Cj4gPiA+ID4gKyAgICBnaW50IHJlZl9jb3Vu
dDsKPiA+ID4gPiArICAgIFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmF0dGFjaGVkX3RvOwo+ID4g
PiA+ICsgICAgVXNiRGV2aWNlSW5mb3JtYXRpb24gZGV2aWNlX2luZm87Cj4gPiA+ID4gK307Cj4g
PiA+ID4gKwo+ID4gPiA+ICtzdHJ1Y3QgX1NwaWNlVXNiQmFja2VuZAo+ID4gPiA+ICt7Cj4gPiA+
ID4gKyAgICBsaWJ1c2JfY29udGV4dCAqbGlidXNiX2NvbnRleHQ7Cj4gPiA+ID4gKyAgICB1c2Jf
aG90X3BsdWdfY2FsbGJhY2sgaG90cGx1Z19jYWxsYmFjazsKPiA+ID4gPiArICAgIHZvaWQgKmhv
dHBsdWdfdXNlcl9kYXRhOwo+ID4gPiA+ICsgICAgbGlidXNiX2hvdHBsdWdfY2FsbGJhY2tfaGFu
ZGxlIGhvdHBsdWdfaGFuZGxlOwo+ID4gPiA+ICt9Owo+ID4gPiA+ICsKPiA+ID4gPiArc3RydWN0
IF9TcGljZVVzYkJhY2tlbmRDaGFubmVsCj4gPiA+ID4gK3sKPiA+ID4gPiArICAgIHN0cnVjdCB1
c2JyZWRpcmhvc3QgKnVzYnJlZGlyaG9zdDsKPiA+ID4gPiArICAgIHVpbnQ4X3QgKnJlYWRfYnVm
Owo+ID4gPiA+ICsgICAgaW50IHJlYWRfYnVmX3NpemU7Cj4gPiA+ID4gKyAgICBzdHJ1Y3QgdXNi
cmVkaXJmaWx0ZXJfcnVsZSAqcnVsZXM7Cj4gPiA+ID4gKyAgICBpbnQgcnVsZXNfY291bnQ7Cj4g
PiA+ID4gKyAgICBTcGljZVVzYkJhY2tlbmREZXZpY2UgKmF0dGFjaGVkOwo+ID4gPiA+ICsgICAg
U3BpY2VVc2JCYWNrZW5kQ2hhbm5lbEluaXREYXRhIGNoYW5uZWxfZGF0YTsKPiA+ID4gPiArICAg
IEdFcnJvciAqKmVycm9yOwo+ID4gPiA+ICt9Owo+ID4gPiA+ICsKPiA+ID4gPiArLy8gbG9jayBm
dW5jdGlvbnMgZm9yIHVzYnJlZGlyaG9zdCBhbmQgdXNicmVkaXJwYXJzZXIKPiA+ID4gPiArc3Rh
dGljIHZvaWQgKnVzYnJlZGlyX2FsbG9jX2xvY2sodm9pZCkgewo+ID4gPiA+ICsgICAgR011dGV4
ICptdXRleDsKPiA+ID4gPiArCj4gPiA+ID4gKyAgICBtdXRleCA9IGdfbmV3MChHTXV0ZXgsIDEp
Owo+ID4gPiA+ICsgICAgZ19tdXRleF9pbml0KG11dGV4KTsKPiA+ID4gPiArCj4gPiA+ID4gKyAg
ICByZXR1cm4gbXV0ZXg7Cj4gPiA+ID4gK30KPiA+ID4gPiArCj4gPiA+ID4gK3N0YXRpYyB2b2lk
IHVzYnJlZGlyX2ZyZWVfbG9jayh2b2lkICp1c2VyX2RhdGEpIHsKPiA+ID4gPiArICAgIEdNdXRl
eCAqbXV0ZXggPSB1c2VyX2RhdGE7Cj4gPiA+ID4gKwo+ID4gPiA+ICsgICAgZ19tdXRleF9jbGVh
cihtdXRleCk7Cj4gPiA+ID4gKyAgICBnX2ZyZWUobXV0ZXgpOwo+ID4gPiA+ICt9Cj4gPiA+ID4g
Kwo+ID4gPiA+ICtzdGF0aWMgdm9pZCB1c2JyZWRpcl9sb2NrX2xvY2sodm9pZCAqdXNlcl9kYXRh
KSB7Cj4gPiA+ID4gKyAgICBHTXV0ZXggKm11dGV4ID0gdXNlcl9kYXRhOwo+ID4gPiA+ICsKPiA+
ID4gPiArICAgIGdfbXV0ZXhfbG9jayhtdXRleCk7Cj4gPiA+ID4gK30KPiA+ID4gPiArCj4gPiA+
ID4gK3N0YXRpYyB2b2lkIHVzYnJlZGlyX3VubG9ja19sb2NrKHZvaWQgKnVzZXJfZGF0YSkgewo+
ID4gPiA+ICsgICAgR011dGV4ICptdXRleCA9IHVzZXJfZGF0YTsKPiA+ID4gPiArCj4gPiA+ID4g
KyAgICBnX211dGV4X3VubG9jayhtdXRleCk7Cj4gPiA+ID4gK30KPiA+ID4gPiArCj4gPiA+ID4g
K2dib29sZWFuIHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9pc29jaChTcGljZVVzYkJhY2tlbmRE
ZXZpY2UgKmRldikKPiA+ID4gPiArewo+ID4gPiA+ICsgICAgbGlidXNiX2RldmljZSAqbGliZGV2
ID0gZGV2LT5saWJ1c2JfZGV2aWNlOwo+ID4gPiA+ICsgICAgc3RydWN0IGxpYnVzYl9jb25maWdf
ZGVzY3JpcHRvciAqY29uZl9kZXNjOwo+ID4gPiA+ICsgICAgZ2Jvb2xlYW4gaXNvY19mb3VuZCA9
IEZBTFNFOwo+ID4gPiA+ICsgICAgZ2ludCBpLCBqLCBrOwo+ID4gPiA+ICsKPiA+ID4gPiArICAg
IGdfcmV0dXJuX3ZhbF9pZl9mYWlsKGxpYmRldiAhPSBOVUxMLCAwKTsKPiA+ID4gPiArCj4gPiA+
ID4gKyAgICBpZiAobGlidXNiX2dldF9hY3RpdmVfY29uZmlnX2Rlc2NyaXB0b3IobGliZGV2LCAm
Y29uZl9kZXNjKSAhPSAwKSB7Cj4gPiA+ID4gKyAgICAgICAgZ19yZXR1cm5fdmFsX2lmX3JlYWNo
ZWQoMCk7Cj4gPiA+Cj4gPiA+IEEgcHJvcGVyIGRlYnVnL3dhcm5pbmcgbWVzc2FnZSB3b3VsZCBi
ZSBuaWNlLgo+ID4gPgo+ID4gPiA+ICsgICAgfQo+ID4gPiA+ICsKPiA+ID4gPiArICAgIGZvciAo
aSA9IDA7ICFpc29jX2ZvdW5kICYmIGkgPCBjb25mX2Rlc2MtPmJOdW1JbnRlcmZhY2VzOyBpKysp
IHsKPiA+ID4gPiArICAgICAgICBmb3IgKGogPSAwOyAhaXNvY19mb3VuZCAmJiBqIDwgY29uZl9k
ZXNjLT5pbnRlcmZhY2VbaV0ubnVtX2FsdHNldHRpbmc7IGorKykgewo+ID4gPiA+ICsgICAgICAg
ICAgICBmb3IgKGsgPSAwOyAhaXNvY19mb3VuZCAmJiBrIDwgY29uZl9kZXNjLT5pbnRlcmZhY2Vb
aV0uYWx0c2V0dGluZ1tqXS5iTnVtRW5kcG9pbnRzO2srKykgewo+ID4gPiA+ICsgICAgICAgICAg
ICAgICAgZ2ludCBhdHRyaWJ1dGVzID0gY29uZl9kZXNjLT5pbnRlcmZhY2VbaV0uYWx0c2V0dGlu
Z1tqXS5lbmRwb2ludFtrXS5ibUF0dHJpYnV0ZXM7Cj4gPiA+ID4gKyAgICAgICAgICAgICAgICBn
aW50IHR5cGUgPSBhdHRyaWJ1dGVzICYgTElCVVNCX1RSQU5TRkVSX1RZUEVfTUFTSzsKPiA+ID4g
PiArICAgICAgICAgICAgICAgIGlmICh0eXBlID09IExJQlVTQl9UUkFOU0ZFUl9UWVBFX0lTT0NI
Uk9OT1VTKQo+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgIGlzb2NfZm91bmQgPSBUUlVFOwo+
ID4gPgo+ID4gPiBBbHdheXMgb3Blbi9jbG9zZSBicmFjZXMge30gaW4gbmV3IGNvZGUKPiA+ID4K
PiA+ID4gPiArICAgICAgICAgICAgfQo+ID4gPiA+ICsgICAgICAgIH0KPiA+ID4gPiArICAgIH0K
PiA+ID4gPiArCj4gPiA+ID4gKyAgICBsaWJ1c2JfZnJlZV9jb25maWdfZGVzY3JpcHRvcihjb25m
X2Rlc2MpOwo+ID4gPiA+ICsgICAgcmV0dXJuIGlzb2NfZm91bmQ7Cj4gPiA+ID4gK30KPiA+ID4g
PiArCj4gPiA+ID4gK3N0YXRpYyBnYm9vbGVhbiBmaWxsX3VzYl9pbmZvKFNwaWNlVXNiQmFja2Vu
ZERldmljZSAqYmRldikKPiA+ID4gPiArewo+ID4gPiA+ICsgICAgVXNiRGV2aWNlSW5mb3JtYXRp
b24gKmluZm8gPSAmYmRldi0+ZGV2aWNlX2luZm87Cj4gPiA+ID4gKwo+ID4gPiA+ICsgICAgc3Ry
dWN0IGxpYnVzYl9kZXZpY2VfZGVzY3JpcHRvciBkZXNjOwo+ID4gPiA+ICsgICAgbGlidXNiX2Rl
dmljZSAqbGliZGV2ID0gYmRldi0+bGlidXNiX2RldmljZTsKPiA+ID4gPiArICAgIGxpYnVzYl9n
ZXRfZGV2aWNlX2Rlc2NyaXB0b3IobGliZGV2LCAmZGVzYyk7Cj4gPiA+ID4gKyAgICBpbmZvLT5i
dXMgPSBsaWJ1c2JfZ2V0X2J1c19udW1iZXIobGliZGV2KTsKPiA+ID4gPiArICAgIGluZm8tPmFk
ZHJlc3MgPSBsaWJ1c2JfZ2V0X2RldmljZV9hZGRyZXNzKGxpYmRldik7Cj4gPiA+ID4gKyAgICBp
ZiAoaW5mby0+YWRkcmVzcyA9PSAweGZmIHx8IC8qIHJvb3QgaHViIChIQ0QpICovCj4gPiA+ID4g
KyAgICAgICAgaW5mby0+YWRkcmVzcyA8PSAxIHx8IC8qIHJvb3QgaHViIG9yIGJhZCBhZGRyZXNz
ICovCj4gPiA+ID4gKyAgICAgICAgKGRlc2MuYkRldmljZUNsYXNzID09IExJQlVTQl9DTEFTU19I
VUIpIC8qaHViKi8pIHsKPiA+ID4KPiA+ID4gTm90ZSB0aGF0IHRoZXJlIGlzIGEgbWl4IG9mIGNv
bW1lbnQgc3R5bGUgYXMgd2VsbCwgaWYgSSdtIG5vdAo+ID4gPiBtaXN0YWtlbiAvKiBpcyBwcmVm
ZXJyZWQgKi8gb3ZlciAvLyB0aGlzCj4gPiA+Cj4gPiA+ID4gKyAgICAgICAgcmV0dXJuIEZBTFNF
Owo+ID4gPiA+ICsgICAgfQo+ID4gPiA+ICsKPiA+ID4gPiArICAgIGluZm8tPnZpZCA9IGRlc2Mu
aWRWZW5kb3I7Cj4gPiA+ID4gKyAgICBpbmZvLT5waWQgPSBkZXNjLmlkUHJvZHVjdDsKPiA+ID4g
PiArICAgIGluZm8tPmNsYXNzID0gZGVzYy5iRGV2aWNlQ2xhc3M7Cj4gPiA+ID4gKyAgICBpbmZv
LT5zdWJjbGFzcyA9IGRlc2MuYkRldmljZVN1YkNsYXNzOwo+ID4gPiA+ICsgICAgaW5mby0+cHJv
dG9jb2wgPSBkZXNjLmJEZXZpY2VQcm90b2NvbDsKPiA+ID4gPiArCj4gPiA+ID4gKyAgICByZXR1
cm4gVFJVRTsKPiA+ID4gPiArfQo+ID4gPiA+ICsKPiA+ID4gPiArc3RhdGljIFNwaWNlVXNiQmFj
a2VuZERldmljZSAqYWxsb2NhdGVfYmFja2VuZF9kZXZpY2UobGlidXNiX2RldmljZSAqbGliZGV2
KQo+ID4gPiA+ICt7Cj4gPiA+ID4gKyAgICBTcGljZVVzYkJhY2tlbmREZXZpY2UgKmRldiA9IGdf
bmV3MChTcGljZVVzYkJhY2tlbmREZXZpY2UsIDEpOwo+ID4gPiA+ICsgICAgZGV2LT5yZWZfY291
bnQgPSAxOwo+ID4gPiA+ICsgICAgZGV2LT5saWJ1c2JfZGV2aWNlID0gbGliZGV2Owo+ID4gPiA+
ICsgICAgaWYgKCFmaWxsX3VzYl9pbmZvKGRldikpIHsKPiA+ID4gPiArICAgICAgICBnX2ZyZWUo
ZGV2KTsKPiA+ID4gPiArICAgICAgICBkZXYgPSBOVUxMOwo+ID4gPgo+ID4gPiBnX2NsZWFyX3Bv
aW50ZXIoJmRldiwgZ19mcmVlKTsKPiA+ID4KPiA+ID4gPiArICAgIH0KPiA+ID4gPiArICAgIHJl
dHVybiBkZXY7Cj4gPiA+ID4gK30KPiA+ID4gPiArCj4gPiA+ID4gKy8qIE5vdGUgdGhhdCB0aGlz
IGZ1bmN0aW9uIG11c3QgYmUgcmUtZW50cmFudCBzYWZlLCBhcyBpdCBjYW4gZ2V0IGNhbGxlZAo+
ID4gPiA+ICtmcm9tIGJvdGggdGhlIG1haW4gdGhyZWFkIGFzIHdlbGwgYXMgZnJvbSB0aGUgdXNi
IGV2ZW50IGhhbmRsaW5nIHRocmVhZCAqLwo+ID4gPiA+ICtzdGF0aWMgdm9pZCB1c2JyZWRpcl93
cml0ZV9mbHVzaF9jYWxsYmFjayh2b2lkICp1c2VyX2RhdGEpCj4gPiA+ID4gK3sKPiA+ID4gPiAr
ICAgIFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmNoID0gdXNlcl9kYXRhOwo+ID4gPiA+ICsgICAg
Z2Jvb2xlYW4gb2sgPSBjaC0+Y2hhbm5lbF9kYXRhLmlzX2NoYW5uZWxfcmVhZHkoY2gtPmNoYW5u
ZWxfZGF0YS51c2VyX2RhdGEpOwo+ID4gPiA+ICsgICAgaWYgKG9rICYmIGNoLT51c2JyZWRpcmhv
c3QpIHsKPiA+ID4KPiA+ID4gSSdkIG1vdmUgdGhlIGNoLT51c2JyZWRpcmhvc3QgdG8gaXRzIG93
biBjaGVjaywgcHJpb3IgdG8KPiA+ID4gX2lzX2NoYW5uZWxfcmVhZHkoKS4gV2h5IGZsdXNoX2Nh
bGxiYWNrIGNhbiBiZSBjYWxsZWQgd2l0aG91dCBhCj4gPiA+IGNoLT51c2JyZWRpcmhvc3QgYmVp
bmcgc2V0Pwo+ID4gPgo+ID4gPiA+ICsgICAgICAgIFNQSUNFX0RFQlVHKCIlcyBjaCAlcCAtPiB1
c2JyZWRpcmhvc3QiLCBfX0ZVTkNUSU9OX18sIGNoKTsKPiA+ID4gPiArICAgICAgICB1c2JyZWRp
cmhvc3Rfd3JpdGVfZ3Vlc3RfZGF0YShjaC0+dXNicmVkaXJob3N0KTsKPiA+ID4gPiArICAgIH0g
ZWxzZSB7Cj4gPiA+ID4gKyAgICAgICAgU1BJQ0VfREVCVUcoIiVzIGNoICVwIChub3QgcmVhZHkp
IiwgX19GVU5DVElPTl9fLCBjaCk7Cj4gPiA+ID4gKyAgICB9Cj4gPiA+ID4gK30KPiA+ID4gPiAr
Cj4gPiA+ID4gK1NwaWNlVXNiQmFja2VuZCAqc3BpY2VfdXNiX2JhY2tlbmRfbmV3KEdFcnJvciAq
KmVycm9yKQo+ID4gPiA+ICt7Cj4gPiA+ID4gKyAgICBpbnQgcmM7Cj4gPiA+ID4gKyAgICBTcGlj
ZVVzYkJhY2tlbmQgKmJlOwo+ID4gPiA+ICsgICAgU1BJQ0VfREVCVUcoIiVzID4+IiwgX19GVU5D
VElPTl9fKTsKPiA+ID4gPiArICAgIGJlID0gKFNwaWNlVXNiQmFja2VuZCAqKWdfbmV3MChTcGlj
ZVVzYkJhY2tlbmQsIDEpOwo+ID4gPgo+ID4gPiAiUmV0dXJucyBhIHBvaW50ZXIgdG8gdGhlIGFs
bG9jYXRlZCBtZW1vcnksIGNhc3QgdG8gYSBwb2ludGVyIHRvCj4gPiA+IHN0cnVjdF90eXBlKSIg
fiBDYXN0IGlzIG5vdCBuZWVkZWQuCj4gPiA+Cj4gPiA+ID4gKyAgICByYyA9IGxpYnVzYl9pbml0
KCZiZS0+bGlidXNiX2NvbnRleHQpOwo+ID4gPiA+ICsgICAgaWYgKHJjIDwgMCkgewo+ID4gPiA+
ICsgICAgICAgIGNvbnN0IGNoYXIgKmRlc2MgPSBsaWJ1c2JfZXJyb3JfbmFtZShyYyk7Cj4gPiA+
ID4gKyAgICAgICAgZ193YXJuaW5nKCJFcnJvciBpbml0aWFsaXppbmcgTElCVVNCIHN1cHBvcnQ6
ICVzIFslaV0iLCBkZXNjLCByYyk7Cj4gPiA+ID4gKyAgICAgICAgZ19zZXRfZXJyb3IoZXJyb3Is
IFNQSUNFX0NMSUVOVF9FUlJPUiwgU1BJQ0VfQ0xJRU5UX0VSUk9SX0ZBSUxFRCwKPiA+ID4gPiAr
ICAgICAgICAgICAgIkVycm9yIGluaXRpYWxpemluZyBMSUJVU0Igc3VwcG9ydDogJXMgWyVpXSIs
IGRlc2MsIHJjKTsKPiA+ID4gPiArICAgICAgICBnX2ZyZWUoYmUpOwo+ID4gPiA+ICsgICAgICAg
IGJlID0gTlVMTDsKPiA+ID4gPiArICAgIH0gZWxzZSB7Cj4gPiA+ID4gKyNpZmRlZiBHX09TX1dJ
TjMyCj4gPiA+ID4gKyNpZiBMSUJVU0JfQVBJX1ZFUlNJT04gPj0gMHgwMTAwMDEwNgo+ID4gPiA+
ICsgICAgbGlidXNiX3NldF9vcHRpb24oYmUtPmxpYnVzYl9jb250ZXh0LCBMSUJVU0JfT1BUSU9O
X1VTRV9VU0JESyk7Cj4gPiA+Cj4gPiA+IEluZGVudGF0aW9uCj4gPiA+Cj4gPiA+ID4gKyNlbmRp
Zgo+ID4gPiA+ICsjZW5kaWYKPiA+ID4gPiArICAgIH0KPiA+ID4gPiArICAgIFNQSUNFX0RFQlVH
KCIlcyA8PCIsIF9fRlVOQ1RJT05fXyk7Cj4gPiA+ID4gKyAgICByZXR1cm4gYmU7Cj4gPiA+ID4g
K30KPiA+ID4gPiArCj4gPiA+ID4gK2dib29sZWFuIHNwaWNlX3VzYl9iYWNrZW5kX2hhbmRsZV9l
dmVudHMoU3BpY2VVc2JCYWNrZW5kICpiZSkKPiA+ID4gPiArewo+ID4gPiA+ICsgICAgU1BJQ0Vf
REVCVUcoIiVzID4+IiwgX19GVU5DVElPTl9fKTsKPiA+ID4gPiArICAgIGdib29sZWFuIG9rID0g
RkFMU0U7Cj4gPiA+ID4gKyAgICBpZiAoYmUtPmxpYnVzYl9jb250ZXh0KSB7Cj4gPiA+ID4gKyAg
ICAgICAgaW50IHJlcyA9IGxpYnVzYl9oYW5kbGVfZXZlbnRzKGJlLT5saWJ1c2JfY29udGV4dCk7
Cj4gPiA+ID4gKyAgICAgICAgb2sgPSByZXMgPT0gMDsKPiA+ID4gPiArICAgICAgICBpZiAocmVz
ICYmIHJlcyAhPSBMSUJVU0JfRVJST1JfSU5URVJSVVBURUQpIHsKPiA+ID4gPiArICAgICAgICAg
ICAgY29uc3QgY2hhciAqZGVzYyA9IGxpYnVzYl9lcnJvcl9uYW1lKHJlcyk7Cj4gPiA+ID4gKyAg
ICAgICAgICAgIGdfd2FybmluZygiRXJyb3IgaGFuZGxpbmcgVVNCIGV2ZW50czogJXMgWyVpXSIs
IGRlc2MsIHJlcyk7Cj4gPiA+ID4gKyAgICAgICAgICAgIG9rID0gRkFMU0U7Cj4gPiA+ID4gKyAg
ICAgICAgfQo+ID4gPiA+ICsgICAgfQo+ID4gPiA+ICsgICAgU1BJQ0VfREVCVUcoIiVzIDw8ICVk
IiwgX19GVU5DVElPTl9fLCBvayk7Cj4gPiA+ID4gKyAgICByZXR1cm4gb2s7Cj4gPiA+ID4gK30K
PiA+ID4gPiArCj4gPiA+ID4gK3N0YXRpYyBpbnQgTElCVVNCX0NBTEwgaG90cGx1Z19jYWxsYmFj
ayhsaWJ1c2JfY29udGV4dCAqY3R4LAo+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgbGlidXNiX2RldmljZSAqZGV2aWNlLAo+ID4gPiA+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlidXNiX2hvdHBsdWdfZXZlbnQgZXZlbnQs
Cj4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2b2lkICp1
c2VyX2RhdGEpCj4gPiA+ID4gK3sKPiA+ID4gPiArICAgIFNwaWNlVXNiQmFja2VuZCAqYmUgPSAo
U3BpY2VVc2JCYWNrZW5kICopdXNlcl9kYXRhOwo+ID4gPiA+ICsgICAgaWYgKGJlLT5ob3RwbHVn
X2NhbGxiYWNrKSB7Cj4gPiA+ID4gKyAgICAgICAgU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpkZXY7
Cj4gPiA+ID4gKyAgICAgICAgZ2Jvb2xlYW4gdmFsID0gZXZlbnQgPT0gTElCVVNCX0hPVFBMVUdf
RVZFTlRfREVWSUNFX0FSUklWRUQ7Cj4gPiA+ID4gKyAgICAgICAgZGV2ID0gYWxsb2NhdGVfYmFj
a2VuZF9kZXZpY2UoZGV2aWNlKTsKPiA+ID4gPiArICAgICAgICBpZiAoZGV2KSB7Cj4gPiA+ID4g
KyAgICAgICAgICAgIFNQSUNFX0RFQlVHKCJjcmVhdGVkIGRldiAlcCwgdXNibGliIGRldiAlcCIs
IGRldiwgZGV2aWNlKTsKPiA+ID4gPiArICAgICAgICAgICAgbGlidXNiX3JlZl9kZXZpY2UoZGV2
aWNlKTsKPiA+ID4gPiArICAgICAgICAgICAgYmUtPmhvdHBsdWdfY2FsbGJhY2soYmUtPmhvdHBs
dWdfdXNlcl9kYXRhLCBkZXYsIHZhbCk7Cj4gPiA+ID4gKyAgICAgICAgICAgIHNwaWNlX3VzYl9i
YWNrZW5kX2RldmljZV91bnJlZihkZXYpOwo+ID4gPiA+ICsgICAgICAgIH0KPiA+ID4gPiArICAg
IH0KPiA+ID4gPiArICAgIHJldHVybiAwOwo+ID4gPiA+ICt9Cj4gPiA+ID4gKwo+ID4gPiA+ICt2
b2lkIHNwaWNlX3VzYl9iYWNrZW5kX2RlcmVnaXN0ZXJfaG90cGx1ZyhTcGljZVVzYkJhY2tlbmQg
KmJlKQo+ID4gPiA+ICt7Cj4gPiA+ID4gKyAgICBnX3JldHVybl9pZl9mYWlsKGJlICE9IE5VTEwp
Owo+ID4gPiA+ICsgICAgaWYgKGJlLT5ob3RwbHVnX2hhbmRsZSkgewo+ID4gPiA+ICsgICAgICAg
IGxpYnVzYl9ob3RwbHVnX2RlcmVnaXN0ZXJfY2FsbGJhY2soYmUtPmxpYnVzYl9jb250ZXh0LCBi
ZS0+aG90cGx1Z19oYW5kbGUpOwo+ID4gPiA+ICsgICAgICAgIGJlLT5ob3RwbHVnX2hhbmRsZSA9
IDA7Cj4gPiA+ID4gKyAgICB9Cj4gPiA+ID4gKyAgICBiZS0+aG90cGx1Z19jYWxsYmFjayA9IE5V
TEw7Cj4gPiA+ID4gK30KPiA+ID4gPiArCj4gPiA+ID4gK2dib29sZWFuIHNwaWNlX3VzYl9iYWNr
ZW5kX3JlZ2lzdGVyX2hvdHBsdWcoU3BpY2VVc2JCYWNrZW5kICpiZSwKPiA+ID4gPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2b2lkICp1c2VyX2RhdGEsCj4g
PiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNiX2hv
dF9wbHVnX2NhbGxiYWNrIHByb2MpCj4gPiA+ID4gK3sKPiA+ID4gPiArICAgIGludCByYzsKPiA+
ID4gPiArICAgIGdfcmV0dXJuX3ZhbF9pZl9mYWlsKGJlICE9IE5VTEwsIEZBTFNFKTsKPiA+ID4g
PiArCj4gPiA+ID4gKyAgICBiZS0+aG90cGx1Z19jYWxsYmFjayA9IHByb2M7Cj4gPiA+ID4gKyAg
ICBiZS0+aG90cGx1Z191c2VyX2RhdGEgPSB1c2VyX2RhdGE7Cj4gPiA+ID4gKyAgICByYyA9IGxp
YnVzYl9ob3RwbHVnX3JlZ2lzdGVyX2NhbGxiYWNrKGJlLT5saWJ1c2JfY29udGV4dCwKPiA+ID4g
PiArICAgICAgICBMSUJVU0JfSE9UUExVR19FVkVOVF9ERVZJQ0VfQVJSSVZFRCB8IExJQlVTQl9I
T1RQTFVHX0VWRU5UX0RFVklDRV9MRUZULAo+ID4gPiA+ICsgICAgICAgIExJQlVTQl9IT1RQTFVH
X0VOVU1FUkFURSwgTElCVVNCX0hPVFBMVUdfTUFUQ0hfQU5ZLAo+ID4gPiA+ICsgICAgICAgIExJ
QlVTQl9IT1RQTFVHX01BVENIX0FOWSwgTElCVVNCX0hPVFBMVUdfTUFUQ0hfQU5ZLAo+ID4gPiA+
ICsgICAgICAgIGhvdHBsdWdfY2FsbGJhY2ssIGJlLCAmYmUtPmhvdHBsdWdfaGFuZGxlKTsKPiA+
ID4gPiArICAgIGlmIChyYyAhPSBMSUJVU0JfU1VDQ0VTUykgewo+ID4gPiA+ICsgICAgICAgIGNv
bnN0IGNoYXIgKmRlc2MgPSBsaWJ1c2JfZXJyb3JfbmFtZShyYyk7Cj4gPiA+ID4gKyAgICAgICAg
Z193YXJuaW5nKCJFcnJvciBpbml0aWFsaXppbmcgVVNCIGhvdHBsdWcgc3VwcG9ydDogJXMgWyVp
XSIsIGRlc2MsIHJjKTsKPiA+ID4gPiArICAgICAgICBiZS0+aG90cGx1Z19jYWxsYmFjayA9IE5V
TEw7Cj4gPiA+ID4gKyAgICAgICAgcmV0dXJuIEZBTFNFOwo+ID4gPiA+ICsgICAgfQo+ID4gPiA+
ICsgICAgcmV0dXJuIFRSVUU7Cj4gPiA+ID4gK30KPiA+ID4gPiArCj4gPiA+ID4gK3ZvaWQgc3Bp
Y2VfdXNiX2JhY2tlbmRfZGVsZXRlKFNwaWNlVXNiQmFja2VuZCAqYmUpCj4gPiA+ID4gK3sKPiA+
ID4gPiArICAgIGdfcmV0dXJuX2lmX2ZhaWwoYmUgIT0gTlVMTCk7Cj4gPiA+ID4gKyAgICBTUElD
RV9ERUJVRygiJXMgPj4iLCBfX0ZVTkNUSU9OX18pOwo+ID4gPiA+ICsgICAgaWYgKGJlLT5saWJ1
c2JfY29udGV4dCkgewo+ID4gPiA+ICsgICAgICAgIGxpYnVzYl9leGl0KGJlLT5saWJ1c2JfY29u
dGV4dCk7Cj4gPiA+ID4gKyAgICB9Cj4gPiA+ID4gKyAgICBnX2ZyZWUoYmUpOwo+ID4gPiA+ICsg
ICAgU1BJQ0VfREVCVUcoIiVzIDw8IiwgX19GVU5DVElPTl9fKTsKPiA+ID4gPiArfQo+ID4gPiA+
ICsKPiA+ID4gPiArU3BpY2VVc2JCYWNrZW5kRGV2aWNlICoqc3BpY2VfdXNiX2JhY2tlbmRfZ2V0
X2RldmljZV9saXN0KFNwaWNlVXNiQmFja2VuZCAqYmUpCj4gPiA+ID4gK3sKPiA+ID4gPiArICAg
IExPVURfREVCVUcoIiVzID4+IiwgX19GVU5DVElPTl9fKTsKPiA+ID4gPiArICAgIGxpYnVzYl9k
ZXZpY2UgKipkZXZsaXN0ID0gTlVMTCwgKipkZXY7Cj4gPiA+ID4gKyAgICBTcGljZVVzYkJhY2tl
bmREZXZpY2UgKmQsICoqbGlzdDsKPiA+ID4gPiArCj4gPiA+ID4gKyAgICBpbnQgbiA9IDAsIGlu
ZGV4Owo+ID4gPiA+ICsKPiA+ID4gPiArICAgIGlmIChiZSAmJiBiZS0+bGlidXNiX2NvbnRleHQp
IHsKPiA+ID4gPiArICAgICAgICBsaWJ1c2JfZ2V0X2RldmljZV9saXN0KGJlLT5saWJ1c2JfY29u
dGV4dCwgJmRldmxpc3QpOwo+ID4gPiA+ICsgICAgfQo+ID4gPiA+ICsKPiA+ID4gPiArICAgIC8v
IGFkZCBhbGwgdGhlIGxpYnVzYiBkZXZpY2UgdGhhdCBub3QgcHJlc2VudCBpbiBvdXIgbGlzdAo+
ID4gPiA+ICsgICAgZm9yIChkZXYgPSBkZXZsaXN0OyBkZXYgJiYgKmRldjsgZGV2KyspIHsKPiA+
ID4gPiArICAgICAgICBuKys7Cj4gPiA+ID4gKyAgICB9Cj4gPiA+ID4gKwo+ID4gPiA+ICsgICAg
bGlzdCA9IGdfbmV3MChTcGljZVVzYkJhY2tlbmREZXZpY2UqLCBuICsgMSk7Cj4gPiA+ID4gKwo+
ID4gPiA+ICsgICAgaW5kZXggPSAwOwo+ID4gPiA+ICsKPiA+ID4gPiArICAgIGZvciAoZGV2ID0g
ZGV2bGlzdDsgZGV2ICYmICpkZXY7IGRldisrKSB7Cj4gPiA+ID4gKyAgICAgICAgZCA9IGFsbG9j
YXRlX2JhY2tlbmRfZGV2aWNlKCpkZXYpOwo+ID4gPiA+ICsgICAgICAgIGlmICghZCkgewo+ID4g
PiA+ICsgICAgICAgICAgICBsaWJ1c2JfdW5yZWZfZGV2aWNlKCpkZXYpOwo+ID4gPiA+ICsgICAg
ICAgIH0gZWxzZSB7Cj4gPiA+ID4gKyAgICAgICAgICAgIFNQSUNFX0RFQlVHKCJjcmVhdGVkIGRl
diAlcCwgdXNibGliIGRldiAlcCIsIGQsICpkZXYpOwo+ID4gPiA+ICsgICAgICAgICAgICBsaXN0
W2luZGV4KytdID0gZDsKPiA+ID4gPiArICAgICAgICB9Cj4gPiA+ID4gKyAgICB9Cj4gPiA+ID4g
Kwo+ID4gPiA+ICsgICAgaWYgKGRldmxpc3QpIHsKPiA+ID4gPiArICAgICAgICBsaWJ1c2JfZnJl
ZV9kZXZpY2VfbGlzdChkZXZsaXN0LCAwKTsKPiA+ID4gPiArICAgIH0KPiA+ID4gPiArCj4gPiA+
ID4gKyAgICBMT1VEX0RFQlVHKCIlcyA8PCIsIF9fRlVOQ1RJT05fXyk7Cj4gPiA+ID4gKyAgICBy
ZXR1cm4gbGlzdDsKPiA+ID4gPiArfQo+ID4gPiA+ICsKPiA+ID4gPiArZ2Jvb2xlYW4gc3BpY2Vf
dXNiX2JhY2tlbmRfZGV2aWNlX2lzX2h1YihTcGljZVVzYkJhY2tlbmREZXZpY2UgKmRldikKPiA+
ID4gPiArewo+ID4gPiA+ICsgICAgcmV0dXJuIGRldi0+ZGV2aWNlX2luZm8uY2xhc3MgPT0gTElC
VVNCX0NMQVNTX0hVQjsKPiA+ID4gPiArfQo+ID4gPiA+ICsKPiA+ID4gPiArY29uc3QgVXNiRGV2
aWNlSW5mb3JtYXRpb24qIHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9nZXRfaW5mbyhTcGljZVVz
YkJhY2tlbmREZXZpY2UgKmRldikKPiA+ID4gPiArewo+ID4gPiA+ICsgICAgcmV0dXJuICZkZXYt
PmRldmljZV9pbmZvOwo+ID4gPiA+ICt9Cj4gPiA+ID4gKwo+ID4gPiA+ICtnY29uc3Rwb2ludGVy
IHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9nZXRfbGliZGV2KFNwaWNlVXNiQmFja2VuZERldmlj
ZSAqZGV2KQo+ID4gPiA+ICt7Cj4gPiA+ID4gKyAgICByZXR1cm4gZGV2LT5saWJ1c2JfZGV2aWNl
Owo+ID4gPiA+ICt9Cj4gPiA+ID4gKwo+ID4gPiA+ICt2b2lkIHNwaWNlX3VzYl9iYWNrZW5kX2Zy
ZWVfZGV2aWNlX2xpc3QoU3BpY2VVc2JCYWNrZW5kRGV2aWNlICoqZGV2bGlzdCkKPiA+ID4gPiAr
ewo+ID4gPiA+ICsgICAgTE9VRF9ERUJVRygiJXMgPj4iLCBfX0ZVTkNUSU9OX18pOwo+ID4gPiA+
ICsgICAgU3BpY2VVc2JCYWNrZW5kRGV2aWNlICoqZGV2Owo+ID4gPiA+ICsgICAgZm9yIChkZXYg
PSBkZXZsaXN0OyAqZGV2OyBkZXYrKykgewo+ID4gPiA+ICsgICAgICAgIFNwaWNlVXNiQmFja2Vu
ZERldmljZSAqZCA9ICpkZXY7Cj4gPiA+ID4gKyAgICAgICAgc3BpY2VfdXNiX2JhY2tlbmRfZGV2
aWNlX3VucmVmKGQpOwo+ID4gPiA+ICsgICAgfQo+ID4gPiA+ICsgICAgZ19mcmVlKGRldmxpc3Qp
Owo+ID4gPiA+ICsgICAgTE9VRF9ERUJVRygiJXMgPDwiLCBfX0ZVTkNUSU9OX18pOwo+ID4gPiA+
ICt9Cj4gPiA+ID4gKwo+ID4gPiA+ICtTcGljZVVzYkJhY2tlbmREZXZpY2UgKnNwaWNlX3VzYl9i
YWNrZW5kX2RldmljZV9yZWYoU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpkZXYpCj4gPiA+ID4gK3sK
PiA+ID4gPiArICAgIExPVURfREVCVUcoIiVzID4+ICVwIiwgX19GVU5DVElPTl9fLCBkZXYpOwo+
ID4gPiA+ICsgICAgZ19hdG9taWNfaW50X2luYygmZGV2LT5yZWZfY291bnQpOwo+ID4gPiA+ICsg
ICAgcmV0dXJuIGRldjsKPiA+ID4gPiArfQo+ID4gPiA+ICsKPiA+ID4gPiArdm9pZCBzcGljZV91
c2JfYmFja2VuZF9kZXZpY2VfdW5yZWYoU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpkZXYpCj4gPiA+
ID4gK3sKPiA+ID4gPiArICAgIExPVURfREVCVUcoIiVzID4+ICVwKCVkKSIsIF9fRlVOQ1RJT05f
XywgZGV2LCBkZXYtPnJlZl9jb3VudCk7Cj4gPiA+ID4gKyAgICBpZiAoZ19hdG9taWNfaW50X2Rl
Y19hbmRfdGVzdCgmZGV2LT5yZWZfY291bnQpKSB7Cj4gPiA+ID4gKyAgICAgICAgbGlidXNiX3Vu
cmVmX2RldmljZShkZXYtPmxpYnVzYl9kZXZpY2UpOwo+ID4gPiA+ICsgICAgICAgIExPVURfREVC
VUcoIiVzIGZyZWVpbmcgJXAgKGxpYnVzYiAlcCkiLCBfX0ZVTkNUSU9OX18sIGRldiwgZGV2LT5s
aWJ1c2JfZGV2aWNlKTsKPiA+ID4gPiArICAgICAgICBnX2ZyZWUoZGV2KTsKPiA+ID4gPiArICAg
IH0KPiA+ID4gPiArfQo+ID4gPiA+ICsKPiA+ID4gPiAraW50IHNwaWNlX3VzYl9iYWNrZW5kX2Rl
dmljZV9jaGVja19maWx0ZXIoCj4gPiA+ID4gKyAgICBTcGljZVVzYkJhY2tlbmREZXZpY2UgKmRl
diwKPiA+ID4gPiArICAgIGNvbnN0IHN0cnVjdCB1c2JyZWRpcmZpbHRlcl9ydWxlICpydWxlcywK
PiA+ID4gPiArICAgIGludCBjb3VudCkKPiA+ID4gPiArewo+ID4gPiA+ICsgICAgcmV0dXJuIHVz
YnJlZGlyaG9zdF9jaGVja19kZXZpY2VfZmlsdGVyKAo+ID4gPiA+ICsgICAgICAgIHJ1bGVzLCBj
b3VudCwgZGV2LT5saWJ1c2JfZGV2aWNlLCAwKTsKPiA+ID4gPiArfQo+ID4gPiA+ICsKPiA+ID4g
PiArc3RhdGljIGludCB1c2JyZWRpcl9yZWFkX2NhbGxiYWNrKHZvaWQgKnVzZXJfZGF0YSwgdWlu
dDhfdCAqZGF0YSwgaW50IGNvdW50KQo+ID4gPiA+ICt7Cj4gPiA+ID4gKyAgICBTcGljZVVzYkJh
Y2tlbmRDaGFubmVsICpjaCA9IHVzZXJfZGF0YTsKPiA+ID4gPiArCj4gPiA+ID4gKyAgICBjb3Vu
dCA9IE1JTihjaC0+cmVhZF9idWZfc2l6ZSwgY291bnQpOwo+ID4gPiA+ICsKPiA+ID4gPiArICAg
IGlmIChjb3VudCAhPSAwKSB7Cj4gPiA+ID4gKyAgICAgICAgbWVtY3B5KGRhdGEsIGNoLT5yZWFk
X2J1ZiwgY291bnQpOwo+ID4gPiA+ICsgICAgfQo+ID4gPiA+ICsKPiA+ID4gPiArICAgIGNoLT5y
ZWFkX2J1Zl9zaXplIC09IGNvdW50Owo+ID4gPiA+ICsgICAgaWYgKGNoLT5yZWFkX2J1Zl9zaXpl
KSB7Cj4gPiA+ID4gKyAgICAgICAgY2gtPnJlYWRfYnVmICs9IGNvdW50Owo+ID4gPiA+ICsgICAg
fQo+ID4gPiA+ICsgICAgZWxzZSB7Cj4gPiA+ID4gKyAgICAgICAgY2gtPnJlYWRfYnVmID0gTlVM
TDsKPiA+ID4gPiArICAgIH0KPiA+ID4gPiArICAgIFNQSUNFX0RFQlVHKCIlcyBjaCAlcCwgJWQg
Ynl0ZXMiLCBfX0ZVTkNUSU9OX18sIGNoLCBjb3VudCk7Cj4gPiA+ID4gKwo+ID4gPiA+ICsgICAg
cmV0dXJuIGNvdW50Owo+ID4gPiA+ICt9Cj4gPiA+ID4gKwo+ID4gPiA+ICtzdGF0aWMgY29uc3Qg
Y2hhciAqc3RyaXBfdXNicmVkaXJfcHJlZml4KGNvbnN0IGNoYXIgKm1zZykKPiA+ID4gPiArewo+
ID4gPiA+ICsgICAgaWYgKHN0cm5jbXAobXNnLCAidXNicmVkaXJob3N0OiAiLCAxNCkgPT0gMCkg
ewo+ID4gPiA+ICsgICAgICAgIG1zZyArPSAxNDsKPiA+ID4gPiArICAgIH0KPiA+ID4gPiArICAg
IHJldHVybiBtc2c7Cj4gPiA+ID4gK30KPiA+ID4gPiArCj4gPiA+ID4gK3N0YXRpYyB2b2lkIGNo
YW5uZWxfZXJyb3IoU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCAqY2gsIGNvbnN0IGNoYXIgKm1zZykK
PiA+ID4gPiArewo+ID4gPiA+ICsgICAgaWYgKCFjaC0+ZXJyb3IpCj4gPiA+ID4gKyAgICAgICAg
cmV0dXJuOwo+ID4gPiA+ICsgICAgZ19zZXRfZXJyb3JfbGl0ZXJhbChjaC0+ZXJyb3IsIFNQSUNF
X0NMSUVOVF9FUlJPUiwgU1BJQ0VfQ0xJRU5UX0VSUk9SX0ZBSUxFRCwgbXNnKTsKPiA+ID4gPiAr
ICAgIGNoLT5lcnJvciA9IE5VTEw7Cj4gPiA+ID4gK30KPiA+ID4gPiArCj4gPiA+ID4gK3N0YXRp
YyB2b2lkIHVzYnJlZGlyX2xvZyh2b2lkICp1c2VyX2RhdGEsIGludCBsZXZlbCwgY29uc3QgY2hh
ciAqbXNnKQo+ID4gPiA+ICt7Cj4gPiA+ID4gKyAgICBTcGljZVVzYkJhY2tlbmRDaGFubmVsICpj
aCA9IChTcGljZVVzYkJhY2tlbmRDaGFubmVsICopdXNlcl9kYXRhOwo+ID4gPiA+ICsgICAgY29u
c3QgY2hhciAqc3RyaXBwZWRfbXNnID0gc3RyaXBfdXNicmVkaXJfcHJlZml4KG1zZyk7Cj4gPiA+
ID4gKyAgICBzd2l0Y2ggKGxldmVsKSB7Cj4gPiA+ID4gKyAgICBjYXNlIHVzYnJlZGlycGFyc2Vy
X2Vycm9yOgo+ID4gPiA+ICsgICAgICAgIGdfY3JpdGljYWwoIiVzIiwgbXNnKTsKPiA+ID4gPiAr
ICAgICAgICBjaGFubmVsX2Vycm9yKGNoLCBzdHJpcHBlZF9tc2cpOwo+ID4gPiA+ICsgICAgICAg
IGJyZWFrOwo+ID4gPiA+ICsgICAgY2FzZSB1c2JyZWRpcnBhcnNlcl93YXJuaW5nOgo+ID4gPiA+
ICsgICAgICAgIGdfd2FybmluZygiJXMiLCBtc2cpOwo+ID4gPiA+ICsgICAgICAgIGNoYW5uZWxf
ZXJyb3IoY2gsIHN0cmlwcGVkX21zZyk7Cj4gPiA+ID4gKyAgICAgICAgYnJlYWs7Cj4gPiA+ID4g
KyAgICBkZWZhdWx0Ogo+ID4gPiA+ICsgICAgICAgIGJyZWFrOwo+ID4gPiA+ICsgICAgfQo+ID4g
PiA+ICt9Cj4gPiA+ID4gKwo+ID4gPiA+ICtzdGF0aWMgaW50IHVzYnJlZGlyX3dyaXRlX2NhbGxi
YWNrKHZvaWQgKnVzZXJfZGF0YSwgdWludDhfdCAqZGF0YSwgaW50IGNvdW50KQo+ID4gPiA+ICt7
Cj4gPiA+ID4gKyAgICBTcGljZVVzYkJhY2tlbmRDaGFubmVsICpjaCA9IHVzZXJfZGF0YTsKPiA+
ID4gPiArICAgIGludCByZXM7Cj4gPiA+ID4gKyAgICBTUElDRV9ERUJVRygiJXMgY2ggJXAsICVk
IGJ5dGVzIiwgX19GVU5DVElPTl9fLCBjaCwgY291bnQpOwo+ID4gPiA+ICsgICAgcmVzID0gY2gt
PmNoYW5uZWxfZGF0YS53cml0ZV9jYWxsYmFjayhjaC0+Y2hhbm5lbF9kYXRhLnVzZXJfZGF0YSwg
ZGF0YSwgY291bnQpOwo+ID4gPiA+ICsgICAgcmV0dXJuIHJlczsKPiA+ID4gPiArfQo+ID4gPiA+
ICsKPiA+ID4gPiArc3RhdGljIHVpbnQ2NF90IHVzYnJlZGlyX2J1ZmZlcmVkX291dHB1dF9zaXpl
X2NhbGxiYWNrKHZvaWQgKnVzZXJfZGF0YSkKPiA+ID4gPiArewo+ID4gPiA+ICsgICAgU3BpY2VV
c2JCYWNrZW5kQ2hhbm5lbCAqY2ggPSB1c2VyX2RhdGE7Cj4gPiA+ID4gKyAgICByZXR1cm4gY2gt
PmNoYW5uZWxfZGF0YS5nZXRfcXVldWVfc2l6ZShjaC0+Y2hhbm5lbF9kYXRhLnVzZXJfZGF0YSk7
Cj4gPiA+ID4gK30KPiA+ID4gPiArCj4gPiA+ID4gK2ludCBzcGljZV91c2JfYmFja2VuZF9wcm92
aWRlX3JlYWRfZGF0YShTcGljZVVzYkJhY2tlbmRDaGFubmVsICpjaCwgdWludDhfdCAqZGF0YSwg
aW50IGNvdW50KQo+ID4gPiA+ICt7Cj4gPiA+ID4gKyAgICBpbnQgcmVzID0gMDsKPiA+ID4gPiAr
Cj4gPiA+ID4gKyAgICBnX3JldHVybl92YWxfaWZfZmFpbChjaC0+cmVhZF9idWYgPT0gTlVMTCwg
VVNCX1JFRElSX0VSUk9SX1JFQURfUEFSU0UpOwo+ID4gPiA+ICsKPiA+ID4gPiArICAgIGNoLT5y
ZWFkX2J1ZiA9IGRhdGE7Cj4gPiA+ID4gKyAgICBjaC0+cmVhZF9idWZfc2l6ZSA9IGNvdW50Owo+
ID4gPiA+ICsgICAgaWYgKGNoLT51c2JyZWRpcmhvc3QpIHsKPiA+ID4gPiArICAgICAgICByZXMg
PSB1c2JyZWRpcmhvc3RfcmVhZF9ndWVzdF9kYXRhKGNoLT51c2JyZWRpcmhvc3QpOwo+ID4gPiA+
ICsgICAgfSBlbHNlIHsKPiA+ID4gPiArICAgICAgICByZXMgPSBVU0JfUkVESVJfRVJST1JfSU87
Cj4gPiA+ID4gKyAgICB9Cj4gPiA+ID4gKyAgICBzd2l0Y2ggKHJlcykKPiA+ID4gPiArICAgIHsK
PiA+ID4gPiArICAgIGNhc2UgdXNicmVkaXJob3N0X3JlYWRfaW9fZXJyb3I6Cj4gPiA+ID4gKyAg
ICAgICAgcmVzID0gVVNCX1JFRElSX0VSUk9SX0lPOwo+ID4gPiA+ICsgICAgICAgIGJyZWFrOwo+
ID4gPiA+ICsgICAgY2FzZSB1c2JyZWRpcmhvc3RfcmVhZF9wYXJzZV9lcnJvcjoKPiA+ID4gPiAr
ICAgICAgICByZXMgPSBVU0JfUkVESVJfRVJST1JfUkVBRF9QQVJTRTsKPiA+ID4gPiArICAgICAg
ICBicmVhazsKPiA+ID4gPiArICAgIGNhc2UgdXNicmVkaXJob3N0X3JlYWRfZGV2aWNlX3JlamVj
dGVkOgo+ID4gPiA+ICsgICAgICAgIHJlcyA9IFVTQl9SRURJUl9FUlJPUl9ERVZfUkVKRUNURUQ7
Cj4gPiA+ID4gKyAgICAgICAgYnJlYWs7Cj4gPiA+ID4gKyAgICBjYXNlIHVzYnJlZGlyaG9zdF9y
ZWFkX2RldmljZV9sb3N0Ogo+ID4gPiA+ICsgICAgICAgIHJlcyA9IFVTQl9SRURJUl9FUlJPUl9E
RVZfTE9TVDsKPiA+ID4gPiArICAgICAgICBicmVhazsKPiA+ID4gPiArICAgIH0KPiA+ID4gPiAr
ICAgIFNQSUNFX0RFQlVHKCIlcyBjaCAlcCwgJWQgYnl0ZXMsIHJlcyAlZCIsIF9fRlVOQ1RJT05f
XywgY2gsIGNvdW50LCByZXMpOwo+ID4gPiA+ICsKPiA+ID4gPiArICAgIHJldHVybiByZXM7Cj4g
PiA+ID4gK30KPiA+ID4gPiArCj4gPiA+ID4gK3ZvaWQgc3BpY2VfdXNiX2JhY2tlbmRfcmV0dXJu
X3dyaXRlX2RhdGEoU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCAqY2gsIHZvaWQgKmRhdGEpCj4gPiA+
ID4gK3sKPiA+ID4gPiArICAgIGlmIChjaC0+dXNicmVkaXJob3N0KSB7Cj4gPiA+ID4gKyAgICAg
ICAgU1BJQ0VfREVCVUcoIiVzIGNoICVwIiwgX19GVU5DVElPTl9fLCBjaCk7Cj4gPiA+ID4gKyAg
ICAgICAgdXNicmVkaXJob3N0X2ZyZWVfd3JpdGVfYnVmZmVyKGNoLT51c2JyZWRpcmhvc3QsIGRh
dGEpOwo+ID4gPiA+ICsgICAgfSBlbHNlIHsKPiA+ID4gPiArICAgICAgICBTUElDRV9ERUJVRygi
JXMgY2ggJXAgLSBOT0JPRFkgVE8gQ0FMTCIsIF9fRlVOQ1RJT05fXywgY2gpOwo+ID4gPiA+ICsg
ICAgfQo+ID4gPiA+ICt9Cj4gPiA+ID4gKwo+ID4gPiA+ICtnYm9vbGVhbiBzcGljZV91c2JfYmFj
a2VuZF9jaGFubmVsX2F0dGFjaChTcGljZVVzYkJhY2tlbmRDaGFubmVsICpjaCwKPiA+ID4gPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU3BpY2VVc2JCYWNrZW5k
RGV2aWNlICpkZXYsCj4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIEdFcnJvciAqKmVycm9yKQo+ID4gPiA+ICt7Cj4gPiA+ID4gKyAgICBTUElDRV9ERUJV
RygiJXMgPj4gY2ggJXAsIGRldiAlcCAod2FzIGF0dGFjaGVkICVwKSIsIF9fRlVOQ1RJT05fXywg
Y2gsIGRldiwgY2gtPmF0dGFjaGVkKTsKPiA+ID4gPiArICAgIGdib29sZWFuIG9rID0gRkFMU0U7
Cj4gPiA+Cj4gPiA+IEkgdGhpbmsgdGhpcyBvayB2YXJpYWJsZSBpcyBqdXN0IG1ha2luZyB0aGUg
Y29kZSBhIGJpdCBtb3JlCj4gPiA+IGNvbXBsaWNhdGVkLgo+ID4gPgo+ID4gPiA+ICsgICAgaWYg
KCFkZXYpIHsKPiA+ID4gPiArICAgICAgICByZXR1cm4gb2s7Cj4gPiA+ID4gKyAgICB9Cj4gPiA+
Cj4gPiA+IFdoeSBub3QgZ19yZXR1cm5fdmFsX2lmX2ZhaWwoZGV2ICE9IE5VTEwsIEZBTFNFKTsK
PiA+ID4KPiA+ID4gPiArCj4gPiA+ID4gKyAgICBsaWJ1c2JfZGV2aWNlX2hhbmRsZSAqaGFuZGxl
ID0gTlVMTDsKPiA+ID4gPiArICAgIGludCByYyA9IGxpYnVzYl9vcGVuKGRldi0+bGlidXNiX2Rl
dmljZSwgJmhhbmRsZSk7Cj4gPiA+Cj4gPiA+ICAgICBpZiAocmMgIT0gMCkgewo+ID4gPiAgICAg
ICAgIC8qIGVycm9yIHBhcnQgZmlyc3QgKi8KPiA+ID4gICAgIH0KPiA+ID4gICAgIC4uLgo+ID4g
PiAgICAgcmMgPSB1c2JyZWRpcmhvc3Rfc2V0X2RldmljZShjaC0+dXNicmVkaXJob3N0LCBoYW5k
bGUpOwo+ID4gPiAgICAgaWYgKHJjICE9IDApIHsKPiA+ID4gICAgICAgICAvKiBlcnJvciBwYXJ0
IGZpcnN0ICovCj4gPiA+ICAgICB9Cj4gPiA+ICAgICAuLi4KPiA+ID4gICAgIGNoLT5lcnJvciA9
IE5VTEw7Cj4gPiA+ICAgICByZXR1cm4gVFJVRTsKPiA+ID4gIH0KPiA+ID4KPiA+ID4gPiArICAg
IG9rID0gcmMgPT0gMDsKPiA+ID4gPiArICAgIGlmIChvaykgewo+ID4gPiA+ICsgICAgICAgIGNo
LT5lcnJvciA9IGVycm9yOwo+ID4gPiA+ICsgICAgICAgIHJjID0gdXNicmVkaXJob3N0X3NldF9k
ZXZpY2UoY2gtPnVzYnJlZGlyaG9zdCwgaGFuZGxlKTsKPiA+ID4gPiArICAgICAgICBpZiAocmMp
IHsKPiA+ID4gPiArICAgICAgICAgICAgU1BJQ0VfREVCVUcoIiVzIGNoICVwLCBkZXYgJXAgdXNi
cmVkaXJob3N0IGVycm9yICVkIiwgX19GVU5DVElPTl9fLCBjaCwgZGV2LCByYyk7Cj4gPiA+ID4g
KyAgICAgICAgICAgIG9rID0gRkFMU0U7Cj4gPiA+ID4gKyAgICAgICAgfSBlbHNlIHsKPiA+ID4g
PiArICAgICAgICAgICAgY2gtPmF0dGFjaGVkID0gZGV2Owo+ID4gPiA+ICsgICAgICAgICAgICBk
ZXYtPmF0dGFjaGVkX3RvID0gY2g7Cj4gPiA+ID4gKyAgICAgICAgfQo+ID4gPiA+ICsgICAgICAg
IGNoLT5lcnJvciA9IE5VTEw7Cj4gPiA+ID4gKyAgICB9IGVsc2Ugewo+ID4gPiA+ICsgICAgICAg
IGNvbnN0IGNoYXIgKmRlc2MgPSBsaWJ1c2JfZXJyb3JfbmFtZShyYyk7Cj4gPiA+ID4gKyAgICAg
ICAgZ19zZXRfZXJyb3IoZXJyb3IsIFNQSUNFX0NMSUVOVF9FUlJPUiwgU1BJQ0VfQ0xJRU5UX0VS
Uk9SX0ZBSUxFRCwKPiA+ID4gPiArICAgICAgICAgICAiRXJyb3IgbGlidXNiX29wZW46ICVzIFsl
aV0iLCBkZXNjLCByYyk7Cj4gPiA+ID4gKyAgICB9Cj4gPiA+ID4gKwo+ID4gPiA+ICsgICAgcmV0
dXJuIG9rOwo+ID4gPiA+ICt9Cj4gPiA+ID4gKwo+ID4gPiA+ICt2b2lkIHNwaWNlX3VzYl9iYWNr
ZW5kX2NoYW5uZWxfZGV0YWNoKFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmNoKQo+ID4gPiA+ICt7
Cj4gPiA+ID4gKyAgICBTUElDRV9ERUJVRygiJXMgPj4gY2ggJXAsIHdhcyBhdHRhY2hlZCAlcCIs
IF9fRlVOQ1RJT05fXywgY2gsIGNoLT5hdHRhY2hlZCk7Cj4gPiA+ID4gKyAgICBpZiAoIWNoLT5h
dHRhY2hlZCkgewo+ID4gPiA+ICsgICAgICAgIFNQSUNFX0RFQlVHKCIlczogbm90aGluZyB0byBk
ZXRhY2giLCBfX0ZVTkNUSU9OX18pOwo+ID4gPiA+ICsgICAgICAgIHJldHVybjsKPiA+ID4gPiAr
ICAgIH0KPiA+ID4gPiArICAgIGlmIChjaC0+dXNicmVkaXJob3N0KSB7Cj4gPiA+ID4gKyAgICAg
ICAgLy8gaXQgd2lsbCBjYWxsIGxpYnVzYl9jbG9zZSBpbnRlcm5hbGx5Cj4gPiA+ID4gKyAgICAg
ICAgdXNicmVkaXJob3N0X3NldF9kZXZpY2UoY2gtPnVzYnJlZGlyaG9zdCwgTlVMTCk7Cj4gPiA+
ID4gKyAgICB9Cj4gPiA+ID4gKyAgICBTUElDRV9ERUJVRygiJXMgY2ggJXAsIGRldGFjaCBkb25l
IiwgX19GVU5DVElPTl9fLCBjaCk7Cj4gPiA+ID4gKyAgICBjaC0+YXR0YWNoZWQtPmF0dGFjaGVk
X3RvID0gTlVMTDsKPiA+ID4gPiArICAgIGNoLT5hdHRhY2hlZCA9IE5VTEw7Cj4gPiA+ID4gK30K
PiA+ID4gPiArCj4gPiA+ID4gK1NwaWNlVXNiQmFja2VuZENoYW5uZWwgKnNwaWNlX3VzYl9iYWNr
ZW5kX2NoYW5uZWxfbmV3KFNwaWNlVXNiQmFja2VuZCAqYmUsCj4gPiA+ID4gKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IFNwaWNlVXNi
QmFja2VuZENoYW5uZWxJbml0RGF0YSAqaW5pdF9kYXRhKQo+ID4gPiA+ICt7Cj4gPiA+ID4gKyAg
ICBTcGljZVVzYkJhY2tlbmRDaGFubmVsICpjaCA9IGdfbmV3MChTcGljZVVzYkJhY2tlbmRDaGFu
bmVsLCAxKTsKPiA+ID4gPiArICAgIFNQSUNFX0RFQlVHKCIlcyA+PiIsIF9fRlVOQ1RJT05fXyk7
Cj4gPiA+ID4gKyAgICBjaC0+Y2hhbm5lbF9kYXRhID0gKmluaXRfZGF0YTsKPiA+ID4gPiArICAg
IGlmIChiZS0+bGlidXNiX2NvbnRleHQpIHsKPiA+ID4gPiArICAgICAgICBjaC0+dXNicmVkaXJo
b3N0ID0gdXNicmVkaXJob3N0X29wZW5fZnVsbCgKPiA+ID4gPiArICAgICAgICAgICAgYmUtPmxp
YnVzYl9jb250ZXh0LAo+ID4gPiA+ICsgICAgICAgICAgICBOVUxMLAo+ID4gPiA+ICsgICAgICAg
ICAgICB1c2JyZWRpcl9sb2csCj4gPiA+ID4gKyAgICAgICAgICAgIHVzYnJlZGlyX3JlYWRfY2Fs
bGJhY2ssCj4gPiA+ID4gKyAgICAgICAgICAgIHVzYnJlZGlyX3dyaXRlX2NhbGxiYWNrLAo+ID4g
PiA+ICsgICAgICAgICAgICB1c2JyZWRpcl93cml0ZV9mbHVzaF9jYWxsYmFjaywKPiA+ID4gPiAr
ICAgICAgICAgICAgdXNicmVkaXJfYWxsb2NfbG9jaywKPiA+ID4gPiArICAgICAgICAgICAgdXNi
cmVkaXJfbG9ja19sb2NrLAo+ID4gPiA+ICsgICAgICAgICAgICB1c2JyZWRpcl91bmxvY2tfbG9j
aywKPiA+ID4gPiArICAgICAgICAgICAgdXNicmVkaXJfZnJlZV9sb2NrLAo+ID4gPiA+ICsgICAg
ICAgICAgICBjaCwgUEFDS0FHRV9TVFJJTkcsCj4gPiA+ID4gKyAgICAgICAgICAgIHNwaWNlX3V0
aWxfZ2V0X2RlYnVnKCkgPyB1c2JyZWRpcnBhcnNlcl9kZWJ1ZyA6IHVzYnJlZGlycGFyc2VyX3dh
cm5pbmcsCj4gPiA+ID4gKyAgICAgICAgICAgIHVzYnJlZGlyaG9zdF9mbF93cml0ZV9jYl9vd25z
X2J1ZmZlcik7Cj4gPiA+ID4gKyAgICAgICAgZ193YXJuX2lmX2ZhaWwoY2gtPnVzYnJlZGlyaG9z
dCAhPSBOVUxMKTsKPiA+ID4gPiArICAgIH0KPiA+ID4gPiArICAgIGlmIChjaC0+dXNicmVkaXJo
b3N0KSB7Cj4gPiA+ID4gKyAgICAgICAgdXNicmVkaXJob3N0X3NldF9idWZmZXJlZF9vdXRwdXRf
c2l6ZV9jYihjaC0+dXNicmVkaXJob3N0LCB1c2JyZWRpcl9idWZmZXJlZF9vdXRwdXRfc2l6ZV9j
YWxsYmFjayk7Cj4gPiA+ID4gKyAgICB9IGVsc2Ugewo+ID4gPiA+ICsgICAgICAgIGdfZnJlZShj
aCk7Cj4gPiA+ID4gKyAgICAgICAgY2ggPSBOVUxMOwo+ID4gPiA+ICsgICAgfQo+ID4gPiA+ICsK
PiA+ID4gPiArICAgIFNQSUNFX0RFQlVHKCIlcyA8PCAlcCIsIF9fRlVOQ1RJT05fXywgY2gpOwo+
ID4gPiA+ICsgICAgcmV0dXJuIGNoOwo+ID4gPiA+ICt9Cj4gPiA+ID4gKwo+ID4gPiA+ICt2b2lk
IHNwaWNlX3VzYl9iYWNrZW5kX2NoYW5uZWxfdXAoU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCAqY2gp
Cj4gPiA+ID4gK3sKPiA+ID4gPiArICAgIFNQSUNFX0RFQlVHKCIlcyAlcCwgaG9zdCAlcCIsIF9f
RlVOQ1RJT05fXywgY2gsIGNoLT51c2JyZWRpcmhvc3QpOwo+ID4gPiA+ICsgICAgaWYgKGNoLT51
c2JyZWRpcmhvc3QpIHsKPiA+ID4gPiArICAgICAgICB1c2JyZWRpcmhvc3Rfd3JpdGVfZ3Vlc3Rf
ZGF0YShjaC0+dXNicmVkaXJob3N0KTsKPiA+ID4gPiArICAgIH0KPiA+ID4gPiArfQo+ID4gPiA+
ICsKPiA+ID4gPiArdm9pZCBzcGljZV91c2JfYmFja2VuZF9jaGFubmVsX2RlbGV0ZShTcGljZVVz
YkJhY2tlbmRDaGFubmVsICpjaCkKPiA+ID4gPiArewo+ID4gPiA+ICsgICAgU1BJQ0VfREVCVUco
IiVzID4+ICVwIiwgX19GVU5DVElPTl9fLCBjaCk7Cj4gPiA+Cj4gPiA+IFBlcmhhcHMgaWYgKGNo
ID09IE5VTEwpIHsgcmV0dXJuOyB9IGNvdWxkIHJlbW92ZSBzb21lIGNoZWNrcyBvbgo+ID4gPiB0
aGUgY2FsbGVyIHNpZGUuCj4gPiA+Cj4gPiA+ID4gKyAgICBpZiAoY2gtPnVzYnJlZGlyaG9zdCkg
ewo+ID4gPiA+ICsgICAgICAgIHVzYnJlZGlyaG9zdF9jbG9zZShjaC0+dXNicmVkaXJob3N0KTsK
PiA+ID4gPiArICAgIH0KPiA+ID4gPiArCj4gPiA+ID4gKyAgICBpZiAoY2gtPnJ1bGVzKSB7Cj4g
PiA+ID4gKyAgICAgICAgZ19mcmVlKGNoLT5ydWxlcyk7Cj4gPiA+ID4gKyAgICB9Cj4gPiA+ID4g
Kwo+ID4gPiA+ICsgICAgZ19mcmVlKGNoKTsKPiA+ID4gPiArICAgIFNQSUNFX0RFQlVHKCIlcyA8
PCAlcCIsIF9fRlVOQ1RJT05fXywgY2gpOwo+ID4gPiA+ICt9Cj4gPiA+ID4gKwo+ID4gPiA+ICt2
b2lkIHNwaWNlX3VzYl9iYWNrZW5kX2NoYW5uZWxfZ2V0X2d1ZXN0X2ZpbHRlcigKPiA+ID4gPiAr
ICAgIFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmNoLAo+ID4gPiA+ICsgICAgY29uc3Qgc3RydWN0
IHVzYnJlZGlyZmlsdGVyX3J1bGUgKipyLAo+ID4gPiA+ICsgICAgaW50ICpjb3VudCkKPiA+ID4g
PiArewo+ID4gPgo+ID4gPiBQbGVhc2UsIGRvbid0IHVzZXIgcGFyYW1ldGVycyBsaWtlIHRoYXQg
ZXZlbiBpZiBwcmV2aW91cyBjb2RlIHdhcwo+ID4gPiBsaWtlIHRoaXMuIFdlIGhhdmUgNCBleGFt
cGxlcyBvbiBGdW5jdGlvbiBpbmRlbnRhdGlvbiBhbmQgSQo+ID4gPiBwZXJzb25hbGx5IHdvdWxk
IGp1c3Qgc3RpY2sgd2l0aAo+ID4gPgo+ID4gPiAgICAgdm9pZAo+ID4gPiAgICAgc3BpY2VfdXNi
X2JhY2tlbmRfY2hhbm5lbF9nZXRfZ3Vlc3RfZmlsdGVyKFNwaWNlVXNiQmFja2VuZENoYW5uZWwg
KmNoLAo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGNvbnN0IHN0cnVjdCB1c2JyZWRpcmZpbHRlcl9ydWxlICoqciwKPiA+ID4gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgKmNvdW50KQo+ID4gPgo+ID4g
Pgo+ID4gPiA+ICsgICAgaW50IGk7Cj4gPiA+ID4gKyAgICAqciA9IE5VTEw7Cj4gPiA+ID4gKyAg
ICAqY291bnQgPSAwOwo+ID4gPiA+ICsgICAgaWYgKGNoLT51c2JyZWRpcmhvc3QpIHsKPiA+ID4g
PiArICAgICAgICB1c2JyZWRpcmhvc3RfZ2V0X2d1ZXN0X2ZpbHRlcihjaC0+dXNicmVkaXJob3N0
LCByLCBjb3VudCk7Cj4gPiA+ID4gKyAgICB9Cj4gPiA+ID4gKyAgICBpZiAoKnIgPT0gTlVMTCkg
ewo+ID4gPiA+ICsgICAgICAgICpyID0gY2gtPnJ1bGVzOwo+ID4gPiA+ICsgICAgICAgICpjb3Vu
dCA9IGNoLT5ydWxlc19jb3VudDsKPiA+ID4gPiArICAgIH0KPiA+ID4gPiArCj4gPiA+ID4gKyAg
ICBpZiAoKmNvdW50KSB7Cj4gPiA+ID4gKyAgICAgICAgU1BJQ0VfREVCVUcoIiVzIGNoICVwOiAl
ZCBmaWx0ZXJzIiwgX19GVU5DVElPTl9fLCBjaCwgKmNvdW50KTsKPiA+ID4gPiArICAgIH0KPiA+
ID4KPiA+ID4gTm90IHN1cmUgd2h5IHRvIGNoZWNrICpjb3VudCwgMCBpcyBub3QgaW50ZXJlc3Rp
bmcgZmlsdGVyPwo+ID4gPgo+ID4gPiA+ICsgICAgZm9yIChpID0gMDsgaSA8ICpjb3VudDsgaSsr
KSB7Cj4gPiA+ID4gKyAgICAgICAgY29uc3Qgc3RydWN0IHVzYnJlZGlyZmlsdGVyX3J1bGUgKnJh
ID0gKnI7Cj4gPiA+ID4gKyAgICAgICAgU1BJQ0VfREVCVUcoIiVzIGNsYXNzICVkLCAlWDolWCIs
Cj4gPiA+ID4gKyAgICAgICAgICAgIHJhW2ldLmFsbG93ID8gImFsbG93ZWQiIDogImRlbmllZCIs
IHJhW2ldLmRldmljZV9jbGFzcywKPiA+ID4gPiArICAgICAgICAgICAgKHVpbnQzMl90KXJhW2ld
LnZlbmRvcl9pZCwgKHVpbnQzMl90KXJhW2ldLnByb2R1Y3RfaWQpOwo+ID4gPiA+ICsgICAgfQo+
ID4gPiA+ICt9Cj4gPiA+ID4gKwo+ID4gPiA+ICsjZW5kaWYgLy8gVVNCX1JFRElSCj4gPiA+ID4g
ZGlmZiAtLWdpdCBhL3NyYy91c2ItYmFja2VuZC5oIGIvc3JjL3VzYi1iYWNrZW5kLmgKPiA+ID4g
PiBuZXcgZmlsZSBtb2RlIDEwMDY0NAo+ID4gPiA+IGluZGV4IDAwMDAwMDAuLjkxMzc5MTYKPiA+
ID4gPiAtLS0gL2Rldi9udWxsCj4gPiA+ID4gKysrIGIvc3JjL3VzYi1iYWNrZW5kLmgKPiA+ID4g
PiBAQCAtMCwwICsxLDExMCBAQAo+ID4gPiA+ICsvKiAtKi0gTW9kZTogQzsgYy1iYXNpYy1vZmZz
ZXQ6IDQ7IGluZGVudC10YWJzLW1vZGU6IG5pbCAtKi0gKi8KPiA+ID4gPiArLyoKPiA+ID4gPiAr
ICAgIENvcHlyaWdodCAoQykgMjAxOCBSZWQgSGF0LCBJbmMuCj4gPiA+ID4gKwo+ID4gPiA+ICsg
ICAgUmVkIEhhdCBBdXRob3JzOgo+ID4gPiA+ICsgICAgWXVyaSBCZW5kaXRvdmljaDx5YmVuZGl0
b0ByZWRoYXQuY29tPgo+ID4gPiA+ICsKPiA+ID4gPiArICAgIFRoaXMgbGlicmFyeSBpcyBmcmVl
IHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IKPiA+ID4gPiArICAgIG1v
ZGlmeSBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMK
PiA+ID4gPiArICAgIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZv
dW5kYXRpb247IGVpdGhlcgo+ID4gPiA+ICsgICAgdmVyc2lvbiAyLjEgb2YgdGhlIExpY2Vuc2Us
IG9yIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCj4gPiA+ID4gKwo+ID4gPiA+
ICsgICAgVGhpcyBsaWJyYXJ5IGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2ls
bCBiZSB1c2VmdWwsCj4gPiA+ID4gKyAgICBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhv
dXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgo+ID4gPiA+ICsgICAgTUVSQ0hBTlRBQklM
SVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZSBHTlUKPiA+
ID4gPiArICAgIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMu
Cj4gPiA+ID4gKwo+ID4gPiA+ICsgICAgWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBv
ZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYwo+ID4gPiA+ICsgICAgTGljZW5zZSBhbG9u
ZyB3aXRoIHRoaXMgbGlicmFyeTsgaWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNl
bnNlcy8+Lgo+ID4gPiA+ICsqLwo+ID4gPiA+ICsKPiA+ID4gPiArI2lmbmRlZiBfX1NQSUNFX1VT
Ql9CQUNLRU5EX0hfXwo+ID4gPiA+ICsjZGVmaW5lIF9fU1BJQ0VfVVNCX0JBQ0tFTkRfSF9fCj4g
PiA+ID4gKwo+ID4gPiA+ICsjaW5jbHVkZSA8dXNicmVkaXJmaWx0ZXIuaD4KPiA+ID4gPiArI2lu
Y2x1ZGUgInVzYi1kZXZpY2UtbWFuYWdlci5oIgo+ID4gPiA+ICsKPiA+ID4gPiArR19CRUdJTl9E
RUNMUwo+ID4gPiA+ICsKPiA+ID4gPiArdHlwZWRlZiBzdHJ1Y3QgX1NwaWNlVXNiQmFja2VuZCBT
cGljZVVzYkJhY2tlbmQ7Cj4gPiA+ID4gK3R5cGVkZWYgc3RydWN0IF9TcGljZVVzYkJhY2tlbmRE
ZXZpY2UgU3BpY2VVc2JCYWNrZW5kRGV2aWNlOwo+ID4gPiA+ICt0eXBlZGVmIHN0cnVjdCBfU3Bp
Y2VVc2JCYWNrZW5kQ2hhbm5lbCBTcGljZVVzYkJhY2tlbmRDaGFubmVsOwo+ID4gPiA+ICsKPiA+
ID4gPiArdHlwZWRlZiBzdHJ1Y3QgVXNiRGV2aWNlSW5mb3JtYXRpb24KPiA+ID4gPiArewo+ID4g
PiA+ICsgICAgdWludDE2X3QgYnVzOwo+ID4gPiA+ICsgICAgdWludDE2X3QgYWRkcmVzczsKPiA+
ID4gPiArICAgIHVpbnQxNl90IHZpZDsKPiA+ID4gPiArICAgIHVpbnQxNl90IHBpZDsKPiA+ID4g
PiArICAgIHVpbnQ4X3QgY2xhc3M7Cj4gPiA+ID4gKyAgICB1aW50OF90IHN1YmNsYXNzOwo+ID4g
PiA+ICsgICAgdWludDhfdCBwcm90b2NvbDsKPiA+ID4gPiArfSBVc2JEZXZpY2VJbmZvcm1hdGlv
bjsKPiA+ID4gPiArCj4gPiA+ID4gK3R5cGVkZWYgc3RydWN0IFNwaWNlVXNiQmFja2VuZENoYW5u
ZWxJbml0RGF0YQo+ID4gPiA+ICt7Cj4gPiA+ID4gKyAgICB2b2lkICp1c2VyX2RhdGE7Cj4gPiA+
ID4gKyAgICBpbnQgKCp3cml0ZV9jYWxsYmFjaykodm9pZCAqdXNlcl9kYXRhLCB1aW50OF90ICpk
YXRhLCBpbnQgY291bnQpOwo+ID4gPiA+ICsgICAgZ2Jvb2xlYW4gKCppc19jaGFubmVsX3JlYWR5
KSh2b2lkICp1c2VyX2RhdGEpOwo+ID4gPiA+ICsgICAgdWludDY0X3QgKCpnZXRfcXVldWVfc2l6
ZSkodm9pZCAqdXNlcl9kYXRhKTsKPiA+ID4gPiArfSBTcGljZVVzYkJhY2tlbmRDaGFubmVsSW5p
dERhdGE7Cj4gPiA+ID4gKwo+ID4gPiA+ICt0eXBlZGVmIHZvaWQoKnVzYl9ob3RfcGx1Z19jYWxs
YmFjaykodm9pZCAqdXNlcl9kYXRhLCBTcGljZVVzYkJhY2tlbmREZXZpY2UgKmRldiwgZ2Jvb2xl
YW4gYWRkZWQpOwo+ID4gPiA+ICsKPiA+ID4gPiArZW51bSB7Cj4gPiA+ID4gKyAgICBVU0JfUkVE
SVJfRVJST1JfSU8gPSAtMSwKPiA+ID4gPiArICAgIFVTQl9SRURJUl9FUlJPUl9SRUFEX1BBUlNF
ID0gLTIsCj4gPiA+ID4gKyAgICBVU0JfUkVESVJfRVJST1JfREVWX1JFSkVDVEVEID0gLTMsCj4g
PiA+ID4gKyAgICBVU0JfUkVESVJfRVJST1JfREVWX0xPU1QgPSAtNCwKPiA+ID4gPiArfTsKPiA+
ID4gPiArCj4gPiA+ID4gKy8qIFNwaWNlIFVTQiBiYWNrZW5kIEFQSSAqLwo+ID4gPiA+ICsvKiBz
ZXRzIGVycm9yIG9uIGZhaWx1cmUgKi8KPiA+ID4gPiArU3BpY2VVc2JCYWNrZW5kICpzcGljZV91
c2JfYmFja2VuZF9uZXcoR0Vycm9yICoqZXJyb3IpOwo+ID4gPiA+ICt2b2lkIHNwaWNlX3VzYl9i
YWNrZW5kX2RlbGV0ZShTcGljZVVzYkJhY2tlbmQgKmNvbnRleHQpOwo+ID4gPiA+ICsKPiA+ID4g
PiArLyoKPiA+ID4gPiArcmV0dXJucyBuZXdseS1hbGxvY2F0ZWQgbnVsbC10ZXJtaW5hdGVkIGxp
c3Qgb2YKPiA+ID4gPiArU3BpY2VVc2JCYWNrZW5kRGV2aWNlIHBvaW50ZXJzLgo+ID4gPiA+ICtU
aGUgY2FsbGVyIG11c3QgY2FsbCBzcGljZV91c2JfYmFja2VuZF9mcmVlX2RldmljZV9saXN0Cj4g
PiA+ID4gK2FmdGVyIGl0IGZpbmlzaGVzIGxpc3QgcHJvY2Vzc2luZwo+ID4gPiA+ICsqLwo+ID4g
PiA+ICtTcGljZVVzYkJhY2tlbmREZXZpY2UgKipzcGljZV91c2JfYmFja2VuZF9nZXRfZGV2aWNl
X2xpc3QoU3BpY2VVc2JCYWNrZW5kICpiYWNrZW5kKTsKPiA+ID4gPiArdm9pZCBzcGljZV91c2Jf
YmFja2VuZF9mcmVlX2RldmljZV9saXN0KFNwaWNlVXNiQmFja2VuZERldmljZSAqKmRldmxpc3Qp
Owo+ID4gPiA+ICtnYm9vbGVhbiBzcGljZV91c2JfYmFja2VuZF9oYW5kbGVfZXZlbnRzKFNwaWNl
VXNiQmFja2VuZCAqYmUpOwo+ID4gPiA+ICtnYm9vbGVhbiBzcGljZV91c2JfYmFja2VuZF9yZWdp
c3Rlcl9ob3RwbHVnKFNwaWNlVXNiQmFja2VuZCAqYmUsCj4gPiA+ID4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdm9pZCAqdXNlcl9kYXRhLAo+ID4gPiA+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzYl9ob3RfcGx1Z19j
YWxsYmFjayBwcm9jKTsKPiA+ID4gPiArdm9pZCBzcGljZV91c2JfYmFja2VuZF9kZXJlZ2lzdGVy
X2hvdHBsdWcoU3BpY2VVc2JCYWNrZW5kICpiZSk7Cj4gPiA+ID4gKwo+ID4gPiA+ICsvKiBTcGlj
ZSBVU0IgYmFja2VuZCBkZXZpY2UgQVBJICovCj4gPiA+ID4gK2dib29sZWFuIHNwaWNlX3VzYl9i
YWNrZW5kX2RldmljZV9pc19odWIoU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpkZXYpOwo+ID4gPiA+
ICtTcGljZVVzYkJhY2tlbmREZXZpY2UgKnNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9yZWYoU3Bp
Y2VVc2JCYWNrZW5kRGV2aWNlICpkZXYpOwo+ID4gPiA+ICt2b2lkIHNwaWNlX3VzYl9iYWNrZW5k
X2RldmljZV91bnJlZihTcGljZVVzYkJhY2tlbmREZXZpY2UgKmRldik7Cj4gPiA+ID4gK2djb25z
dHBvaW50ZXIgc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX2dldF9saWJkZXYoU3BpY2VVc2JCYWNr
ZW5kRGV2aWNlICpkZXYpOwo+ID4gPiA+ICtjb25zdCBVc2JEZXZpY2VJbmZvcm1hdGlvbiogc3Bp
Y2VfdXNiX2JhY2tlbmRfZGV2aWNlX2dldF9pbmZvKFNwaWNlVXNiQmFja2VuZERldmljZSAqZGV2
KTsKPiA+ID4gPiArZ2Jvb2xlYW4gc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX2lzb2NoKFNwaWNl
VXNiQmFja2VuZERldmljZSAqZGV2KTsKPiA+ID4gPiArLyogcmV0dXJucyAwIGlmIHRoZSBkZXZp
Y2UgcGFzc2VzIHRoZSBmaWx0ZXIgKi8KPiA+ID4gPiAraW50IHNwaWNlX3VzYl9iYWNrZW5kX2Rl
dmljZV9jaGVja19maWx0ZXIoU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpkZXYsCj4gPiA+ID4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0cnVjdCB1c2Jy
ZWRpcmZpbHRlcl9ydWxlICpydWxlcywgaW50IGNvdW50KTsKPiA+ID4gPiArCj4gPiA+ID4gKy8q
IFNwaWNlIFVTQiBiYWNrZW5kIGNoYW5uZWwgQVBJICovCj4gPiA+ID4gK1NwaWNlVXNiQmFja2Vu
ZENoYW5uZWwgKnNwaWNlX3VzYl9iYWNrZW5kX2NoYW5uZWxfbmV3KFNwaWNlVXNiQmFja2VuZCAq
Y29udGV4dCwKPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgY29uc3QgU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbEluaXREYXRhICppbml0
X2RhdGEpOwo+ID4gPiA+ICt2b2lkIHNwaWNlX3VzYl9iYWNrZW5kX2NoYW5uZWxfZGVsZXRlKFNw
aWNlVXNiQmFja2VuZENoYW5uZWwgKmNoKTsKPiA+ID4gPiArLyogcmV0dXJucyAwIGZvciBzdWNj
ZXNzIG9yIGVycm9yIGNvZGUgKi8KPiA+ID4gPiAraW50IHNwaWNlX3VzYl9iYWNrZW5kX3Byb3Zp
ZGVfcmVhZF9kYXRhKFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmNoLCB1aW50OF90ICpkYXRhLCBp
bnQgY291bnQpOwo+ID4gPiA+ICtnYm9vbGVhbiBzcGljZV91c2JfYmFja2VuZF9jaGFubmVsX2F0
dGFjaChTcGljZVVzYkJhY2tlbmRDaGFubmVsICpjaCwKPiA+ID4gPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpkZXYsCj4g
PiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdFcnJvciAq
KmVycm9yKTsKPiA+ID4gPiArdm9pZCBzcGljZV91c2JfYmFja2VuZF9jaGFubmVsX2RldGFjaChT
cGljZVVzYkJhY2tlbmRDaGFubmVsICpjaCk7Cj4gPiA+ID4gK3ZvaWQgc3BpY2VfdXNiX2JhY2tl
bmRfY2hhbm5lbF91cChTcGljZVVzYkJhY2tlbmRDaGFubmVsICpjaCk7Cj4gPiA+ID4gK3ZvaWQg
c3BpY2VfdXNiX2JhY2tlbmRfY2hhbm5lbF9nZXRfZ3Vlc3RfZmlsdGVyKFNwaWNlVXNiQmFja2Vu
ZENoYW5uZWwgKmNoLAo+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBjb25zdCBzdHJ1Y3QgdXNicmVkaXJmaWx0ZXJfcnVsZSAgKipydWxlcywK
PiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
aW50ICpjb3VudCk7Cj4gPiA+ID4gK3ZvaWQgc3BpY2VfdXNiX2JhY2tlbmRfcmV0dXJuX3dyaXRl
X2RhdGEoU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCAqY2gsIHZvaWQgKmRhdGEpOwo+ID4gPiA+ICsK
PiA+ID4gPiArR19FTkRfREVDTFMKPiA+ID4gPiArCj4gPiA+ID4gKyNlbmRpZgo+ID4gPiA+IGRp
ZmYgLS1naXQgYS9zcmMvdXNiLWRldmljZS1tYW5hZ2VyLXByaXYuaCBiL3NyYy91c2ItZGV2aWNl
LW1hbmFnZXItcHJpdi5oCj4gPiA+ID4gaW5kZXggODM4ODRkNy4uMzlhYWYyZiAxMDA2NDQKPiA+
ID4gPiAtLS0gYS9zcmMvdXNiLWRldmljZS1tYW5hZ2VyLXByaXYuaAo+ID4gPiA+ICsrKyBiL3Ny
Yy91c2ItZGV2aWNlLW1hbmFnZXItcHJpdi5oCj4gPiA+ID4gQEAgLTMyLDcgKzMyLDYgQEAgdm9p
ZCBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfc3RvcF9ldmVudF9saXN0ZW5pbmcoCj4gPiA+ID4g
ICAgICBTcGljZVVzYkRldmljZU1hbmFnZXIgKm1hbmFnZXIpOwo+ID4gPiA+Cj4gPiA+ID4gICNp
ZmRlZiBVU0VfVVNCUkVESVIKPiA+ID4gPiAtI2luY2x1ZGUgPGxpYnVzYi5oPgo+ID4gPiA+ICB2
b2lkIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9kZXZpY2VfZXJyb3IoCj4gPiA+ID4gICAgICBT
cGljZVVzYkRldmljZU1hbmFnZXIgKm1hbmFnZXIsIFNwaWNlVXNiRGV2aWNlICpkZXZpY2UsIEdF
cnJvciAqZXJyKTsKPiA+ID4gPgo+ID4gPiA+IGRpZmYgLS1naXQgYS9zcmMvdXNiLWRldmljZS1t
YW5hZ2VyLmMgYi9zcmMvdXNiLWRldmljZS1tYW5hZ2VyLmMKPiA+ID4gPiBpbmRleCBiZDQyMTQy
Li4yYmVlNTVkIDEwMDY0NAo+ID4gPiA+IC0tLSBhL3NyYy91c2ItZGV2aWNlLW1hbmFnZXIuYwo+
ID4gPiA+ICsrKyBiL3NyYy91c2ItZGV2aWNlLW1hbmFnZXIuYwo+ID4gPiA+IEBAIC0yNSwxNSAr
MjUsMTQgQEAKPiA+ID4gPgo+ID4gPiA+ICAjaWZkZWYgVVNFX1VTQlJFRElSCj4gPiA+ID4gICNp
bmNsdWRlIDxlcnJuby5oPgo+ID4gPiA+IC0jaW5jbHVkZSA8bGlidXNiLmg+Cj4gPiA+ID4KPiA+
ID4gPiAgI2lmZGVmIEdfT1NfV0lOMzIKPiA+ID4gPiArI2luY2x1ZGUgPHdpbmRvd3MuaD4KPiA+
ID4gPiAgI2luY2x1ZGUgInVzYmRrX2FwaS5oIgo+ID4gPiA+ICAjaW5jbHVkZSAid2luLXVzYi1k
ZXYuaCIKPiA+ID4gPiAgI2VuZGlmCj4gPiA+ID4KPiA+ID4gPiAgI2luY2x1ZGUgImNoYW5uZWwt
dXNicmVkaXItcHJpdi5oIgo+ID4gPiA+IC0jaW5jbHVkZSAidXNicmVkaXJob3N0LmgiCj4gPiA+
ID4gICNpbmNsdWRlICJ1c2J1dGlsLmgiCj4gPiA+ID4gICNlbmRpZgo+ID4gPiA+Cj4gPiA+ID4g
QEAgLTk0LDcgKzkzLDcgQEAgc3RydWN0IF9TcGljZVVzYkRldmljZU1hbmFnZXJQcml2YXRlIHsK
PiA+ID4gPiAgICAgIGdjaGFyICphdXRvX2Nvbm5lY3RfZmlsdGVyOwo+ID4gPiA+ICAgICAgZ2No
YXIgKnJlZGlyZWN0X29uX2Nvbm5lY3Q7Cj4gPiA+ID4gICNpZmRlZiBVU0VfVVNCUkVESVIKPiA+
ID4gPiAtICAgIGxpYnVzYl9jb250ZXh0ICpjb250ZXh0Owo+ID4gPiA+ICsgICAgU3BpY2VVc2JC
YWNrZW5kICpjb250ZXh0Owo+ID4gPiA+ICAgICAgaW50IGV2ZW50X2xpc3RlbmVyczsKPiA+ID4g
PiAgICAgIEdUaHJlYWQgKmV2ZW50X3RocmVhZDsKPiA+ID4gPiAgICAgIGdpbnQgZXZlbnRfdGhy
ZWFkX3J1bjsKPiA+ID4gPiBAQCAtMTA2LDcgKzEwNSw2IEBAIHN0cnVjdCBfU3BpY2VVc2JEZXZp
Y2VNYW5hZ2VyUHJpdmF0ZSB7Cj4gPiA+ID4gICAgICBHVWRldkNsaWVudCAqdWRldjsKPiA+ID4g
PiAgI2Vsc2UKPiA+ID4gPiAgICAgIGdib29sZWFuIHJlZGlyZWN0aW5nOyAvKiBIYW5kbGVkIGJ5
IEdVZGV2Q2xpZW50IGluIHRoZSBndWRldiBjYXNlICovCj4gPiA+ID4gLSAgICBsaWJ1c2JfaG90
cGx1Z19jYWxsYmFja19oYW5kbGUgaHBfaGFuZGxlOwo+ID4gPiA+ICAjZW5kaWYKPiA+ID4gPiAg
I2lmZGVmIEdfT1NfV0lOMzIKPiA+ID4gPiAgICAgIHVzYmRrX2FwaV93cmFwcGVyICAgICAqdXNi
ZGtfYXBpOwo+ID4gPiA+IEBAIC0xMzYsNyArMTM0LDcgQEAgdHlwZWRlZiBzdHJ1Y3QgX1NwaWNl
VXNiRGV2aWNlSW5mbyB7Cj4gPiA+ID4gICAgICBndWludDE2IHZpZDsKPiA+ID4gPiAgICAgIGd1
aW50MTYgcGlkOwo+ID4gPiA+ICAgICAgZ2Jvb2xlYW4gaXNvY2hyb25vdXM7Cj4gPiA+ID4gLSAg
ICBsaWJ1c2JfZGV2aWNlICpsaWJkZXY7Cj4gPiA+ID4gKyAgICBTcGljZVVzYkJhY2tlbmREZXZp
Y2UgKmJkZXY7Cj4gPiA+ID4gICAgICBnaW50ICAgIHJlZjsKPiA+ID4gPiAgfSBTcGljZVVzYkRl
dmljZUluZm87Cj4gPiA+ID4KPiA+ID4gPiBAQCAtMTQ5LDE5ICsxNDcsMTggQEAgc3RhdGljIHZv
aWQgY2hhbm5lbF9ldmVudChTcGljZUNoYW5uZWwgKmNoYW5uZWwsIFNwaWNlQ2hhbm5lbEV2ZW50
IGV2ZW50LAo+ID4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdwb2ludGVyIHVzZXJf
ZGF0YSk7Cj4gPiA+ID4gICNpZmRlZiBHX09TX1dJTjMyCj4gPiA+ID4gIHN0YXRpYyB2b2lkIHNw
aWNlX3VzYl9kZXZpY2VfbWFuYWdlcl91ZXZlbnRfY2IoR1VkZXZDbGllbnQgICAgICpjbGllbnQs
Cj4gPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
bGlidXNiX2RldmljZSAgICp1ZGV2aWNlLAo+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIFNwaWNlVXNiQmFja2VuZERldmljZSAqdWRldmljZSwK
PiA+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBn
Ym9vbGVhbiAgICAgICAgIGFkZCwKPiA+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBncG9pbnRlciAgICAgICAgIHVzZXJfZGF0YSk7Cj4gPiA+ID4g
ICNlbHNlCj4gPiA+ID4gLXN0YXRpYyBpbnQgc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2hvdHBs
dWdfY2IobGlidXNiX2NvbnRleHQgICAgICAgKmN0eCwKPiA+ID4gPiAtICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWJ1c2JfZGV2aWNlICAgICAgICAqZGV2
aWNlLAo+ID4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGxpYnVzYl9ob3RwbHVnX2V2ZW50ICBldmVudCwKPiA+ID4gPiAtICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2b2lkICAgICAgICAgICAgICAgICAqZGF0
YSk7Cj4gPiA+ID4gK3N0YXRpYyB2b2lkIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9ob3RwbHVn
X2NiKHZvaWQgKnVzZXJfZGF0YSwKPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpkZXYsCj4gPiA+ID4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdib29sZWFu
IGFkZGVkKTsKPiA+ID4gPiAgI2VuZGlmCj4gPiA+ID4gIHN0YXRpYyB2b2lkIHNwaWNlX3VzYl9k
ZXZpY2VfbWFuYWdlcl9jaGVja19yZWRpcl9vbl9jb25uZWN0KAo+ID4gPiA+ICAgICAgU3BpY2VV
c2JEZXZpY2VNYW5hZ2VyICpzZWxmLCBTcGljZUNoYW5uZWwgKmNoYW5uZWwpOwo+ID4gPiA+Cj4g
PiA+ID4gLXN0YXRpYyBTcGljZVVzYkRldmljZUluZm8gKnNwaWNlX3VzYl9kZXZpY2VfbmV3KGxp
YnVzYl9kZXZpY2UgKmxpYmRldik7Cj4gPiA+ID4gK3N0YXRpYyBTcGljZVVzYkRldmljZUluZm8g
KnNwaWNlX3VzYl9kZXZpY2VfbmV3KFNwaWNlVXNiQmFja2VuZERldmljZSAqYmRldik7Cj4gPiA+
ID4gIHN0YXRpYyBTcGljZVVzYkRldmljZSAqc3BpY2VfdXNiX2RldmljZV9yZWYoU3BpY2VVc2JE
ZXZpY2UgKmRldmljZSk7Cj4gPiA+ID4gIHN0YXRpYyB2b2lkIHNwaWNlX3VzYl9kZXZpY2VfdW5y
ZWYoU3BpY2VVc2JEZXZpY2UgKmRldmljZSk7Cj4gPiA+ID4KPiA+ID4gPiBAQCAtMTcwLDEyICsx
NjcsMTIgQEAgc3RhdGljIHZvaWQgX3VzYmRrX2hpZGVyX3VwZGF0ZShTcGljZVVzYkRldmljZU1h
bmFnZXIgKm1hbmFnZXIpOwo+ID4gPiA+ICBzdGF0aWMgdm9pZCBfdXNiZGtfaGlkZXJfY2xlYXIo
U3BpY2VVc2JEZXZpY2VNYW5hZ2VyICptYW5hZ2VyKTsKPiA+ID4gPiAgI2VuZGlmCj4gPiA+ID4K
PiA+ID4gPiAtc3RhdGljIGdib29sZWFuIHNwaWNlX3VzYl9tYW5hZ2VyX2RldmljZV9lcXVhbF9s
aWJkZXYoU3BpY2VVc2JEZXZpY2VNYW5hZ2VyICptYW5hZ2VyLAo+ID4gPiA+IC0gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTcGljZVVzYkRldmlj
ZSAqZGV2aWNlLAo+ID4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBsaWJ1c2JfZGV2aWNlICpsaWJkZXYpOwo+ID4gPiA+IC1zdGF0aWMg
bGlidXNiX2RldmljZSAqCj4gPiA+ID4gLXNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9kZXZpY2Vf
dG9fbGliZGV2KFNwaWNlVXNiRGV2aWNlTWFuYWdlciAqc2VsZiwKPiA+ID4gPiAtICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU3BpY2VVc2JEZXZpY2UgKmRldmljZSk7
Cj4gPiA+ID4gK3N0YXRpYyBnYm9vbGVhbiBzcGljZV91c2JfbWFuYWdlcl9kZXZpY2VfZXF1YWxf
YmRldihTcGljZVVzYkRldmljZU1hbmFnZXIgKm1hbmFnZXIsCj4gPiA+ID4gKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTcGljZVVzYkRldmljZSAq
ZGV2aWNlLAo+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpiZGV2KTsKPiA+ID4gPiArc3RhdGlj
IFNwaWNlVXNiQmFja2VuZERldmljZSAqCj4gPiA+ID4gK3NwaWNlX3VzYl9kZXZpY2VfbWFuYWdl
cl9kZXZpY2VfdG9fYmRldihTcGljZVVzYkRldmljZU1hbmFnZXIgKnNlbGYsCj4gPiA+ID4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTcGljZVVzYkRldmljZSAqZGV2
aWNlKTsKPiA+ID4gPgo+ID4gPiA+ICBzdGF0aWMgdm9pZAo+ID4gPiA+ICBfc3BpY2VfdXNiX2Rl
dmljZV9tYW5hZ2VyX2Nvbm5lY3RfZGV2aWNlX2FzeW5jKFNwaWNlVXNiRGV2aWNlTWFuYWdlciAq
c2VsZiwKPiA+ID4gPiBAQCAtMjc3LDE0ICsyNzQsOSBAQCBzdGF0aWMgZ2Jvb2xlYW4gc3BpY2Vf
dXNiX2RldmljZV9tYW5hZ2VyX2luaXRhYmxlX2luaXQoR0luaXRhYmxlICAqaW5pdGFibGUsCj4g
PiA+ID4gICAgICBHTGlzdCAqaXQ7Cj4gPiA+ID4KPiA+ID4gPiAgI2lmbmRlZiBHX09TX1dJTjMy
Cj4gPiA+ID4gLSAgICBpbnQgcmM7Cj4gPiA+ID4gICAgICAvKiBJbml0aWFsaXplIGxpYnVzYiAq
Lwo+ID4gPiA+IC0gICAgcmMgPSBsaWJ1c2JfaW5pdCgmcHJpdi0+Y29udGV4dCk7Cj4gPiA+ID4g
LSAgICBpZiAocmMgPCAwKSB7Cj4gPiA+ID4gLSAgICAgICAgY29uc3QgY2hhciAqZGVzYyA9IHNw
aWNlX3VzYnV0aWxfbGlidXNiX3N0cmVycm9yKHJjKTsKPiA+ID4gPiAtICAgICAgICBnX3dhcm5p
bmcoIkVycm9yIGluaXRpYWxpemluZyBVU0Igc3VwcG9ydDogJXMgWyVpXSIsIGRlc2MsIHJjKTsK
PiA+ID4gPiAtICAgICAgICBnX3NldF9lcnJvcihlcnIsIFNQSUNFX0NMSUVOVF9FUlJPUiwgU1BJ
Q0VfQ0xJRU5UX0VSUk9SX0ZBSUxFRCwKPiA+ID4gPiAtICAgICAgICAgICAgICAgICAgICAiRXJy
b3IgaW5pdGlhbGl6aW5nIFVTQiBzdXBwb3J0OiAlcyBbJWldIiwgZGVzYywgcmMpOwo+ID4gPiA+
ICsgICAgcHJpdi0+Y29udGV4dCA9IHNwaWNlX3VzYl9iYWNrZW5kX25ldyhlcnIpOwo+ID4gPiA+
ICsgICAgaWYgKCFwcml2LT5jb250ZXh0KSB7Cj4gPiA+ID4gICAgICAgICAgcmV0dXJuIEZBTFNF
Owo+ID4gPiA+ICAgICAgfQo+ID4gPiA+ICAjZW5kaWYKPiA+ID4gPiBAQCAtMzAyLDE2ICsyOTQs
OCBAQCBzdGF0aWMgZ2Jvb2xlYW4gc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2luaXRhYmxlX2lu
aXQoR0luaXRhYmxlICAqaW5pdGFibGUsCj4gPiA+ID4gICAgICAvKiBEbyBjb2xkcGx1ZyAoZGV0
ZWN0aW9uIG9mIGFscmVhZHkgY29ubmVjdGVkIGRldmljZXMpICovCj4gPiA+ID4gICAgICBnX3Vk
ZXZfY2xpZW50X3JlcG9ydF9kZXZpY2VzKHByaXYtPnVkZXYpOwo+ID4gPiA+ICAjZWxzZQo+ID4g
PiA+IC0gICAgcmMgPSBsaWJ1c2JfaG90cGx1Z19yZWdpc3Rlcl9jYWxsYmFjayhwcml2LT5jb250
ZXh0LAo+ID4gPiA+IC0gICAgICAgIExJQlVTQl9IT1RQTFVHX0VWRU5UX0RFVklDRV9BUlJJVkVE
IHwgTElCVVNCX0hPVFBMVUdfRVZFTlRfREVWSUNFX0xFRlQsCj4gPiA+ID4gLSAgICAgICAgTElC
VVNCX0hPVFBMVUdfRU5VTUVSQVRFLCBMSUJVU0JfSE9UUExVR19NQVRDSF9BTlksCj4gPiA+ID4g
LSAgICAgICAgTElCVVNCX0hPVFBMVUdfTUFUQ0hfQU5ZLCBMSUJVU0JfSE9UUExVR19NQVRDSF9B
TlksCj4gPiA+ID4gLSAgICAgICAgc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2hvdHBsdWdfY2Is
IHNlbGYsICZwcml2LT5ocF9oYW5kbGUpOwo+ID4gPiA+IC0gICAgaWYgKHJjIDwgMCkgewo+ID4g
PiA+IC0gICAgICAgIGNvbnN0IGNoYXIgKmRlc2MgPSBzcGljZV91c2J1dGlsX2xpYnVzYl9zdHJl
cnJvcihyYyk7Cj4gPiA+ID4gLSAgICAgICAgZ193YXJuaW5nKCJFcnJvciBpbml0aWFsaXppbmcg
VVNCIGhvdHBsdWcgc3VwcG9ydDogJXMgWyVpXSIsIGRlc2MsIHJjKTsKPiA+ID4gPiAtICAgICAg
ICBnX3NldF9lcnJvcihlcnIsIFNQSUNFX0NMSUVOVF9FUlJPUiwgU1BJQ0VfQ0xJRU5UX0VSUk9S
X0ZBSUxFRCwKPiA+ID4gPiAtICAgICAgICAgICAgICAgICAgIkVycm9yIGluaXRpYWxpemluZyBV
U0IgaG90cGx1ZyBzdXBwb3J0OiAlcyBbJWldIiwgZGVzYywgcmMpOwo+ID4gPiA+ICsgICAgaWYg
KCFzcGljZV91c2JfYmFja2VuZF9yZWdpc3Rlcl9ob3RwbHVnKHByaXYtPmNvbnRleHQsIHNlbGYs
Cj4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Bp
Y2VfdXNiX2RldmljZV9tYW5hZ2VyX2hvdHBsdWdfY2IpKSB7Cj4gPiA+ID4gICAgICAgICAgcmV0
dXJuIEZBTFNFOwo+ID4gPiA+ICAgICAgfQo+ID4gPiA+ICAgICAgc3BpY2VfdXNiX2RldmljZV9t
YW5hZ2VyX3N0YXJ0X2V2ZW50X2xpc3RlbmluZyhzZWxmLCBOVUxMKTsKPiA+ID4gPiBAQCAtMzQy
LDIxICszMjYsMTcgQEAgc3RhdGljIHZvaWQgc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2Rpc3Bv
c2UoR09iamVjdCAqZ29iamVjdCkKPiA+ID4gPiAgICAgIFNwaWNlVXNiRGV2aWNlTWFuYWdlclBy
aXZhdGUgKnByaXYgPSBzZWxmLT5wcml2Owo+ID4gPiA+Cj4gPiA+ID4gICNpZm5kZWYgR19PU19X
SU4zMgo+ID4gPiA+IC0gICAgaWYgKHByaXYtPmhwX2hhbmRsZSkgewo+ID4gPiA+IC0gICAgICAg
IHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9zdG9wX2V2ZW50X2xpc3RlbmluZyhzZWxmKTsKPiA+
ID4gPiAtICAgICAgICBpZiAoZ19hdG9taWNfaW50X2dldCgmcHJpdi0+ZXZlbnRfdGhyZWFkX3J1
bikpIHsKPiA+ID4gPiAtICAgICAgICAgICAgLyogRm9yY2UgdGVybWluYXRpb24gb2YgdGhlIGV2
ZW50IHRocmVhZCBldmVuIGlmIHRoZXJlIHdlcmUgc29tZQo+ID4gPiA+IC0gICAgICAgICAgICAg
KiBtaXNtYXRjaGVkIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl97c3RhcnQsc3RvcH1fZXZlbnRf
bGlzdGVuaW5nCj4gPiA+ID4gLSAgICAgICAgICAgICAqIGNhbGxzLiBPdGhlcndpc2UsIHRoZSB1
c2IgZXZlbnQgdGhyZWFkIHdpbGwgYmUgbGVha2VkLCBhbmQgd2lsbAo+ID4gPiA+IC0gICAgICAg
ICAgICAgKiB0cnkgdG8gdXNlIHRoZSBsaWJ1c2IgY29udGV4dCB3ZSBkZXN0cm95IGluIGZpbmFs
aXplKCksIHdoaWNoIHdvdWxkCj4gPiA+ID4gLSAgICAgICAgICAgICAqIGNhdXNlIGEgY3Jhc2gg
Ki8KPiA+ID4gPiAtICAgICAgICAgICAgIGdfd2Fybl9pZl9yZWFjaGVkKCk7Cj4gPiA+ID4gLSAg
ICAgICAgICAgICBnX2F0b21pY19pbnRfc2V0KCZwcml2LT5ldmVudF90aHJlYWRfcnVuLCBGQUxT
RSk7Cj4gPiA+ID4gLSAgICAgICAgfQo+ID4gPiA+IC0gICAgICAgIC8qIFRoaXMgYWxzbyB3YWtl
cyB1cCB0aGUgbGlidXNiX2hhbmRsZV9ldmVudHMoKSBpbiB0aGUgZXZlbnRfdGhyZWFkICovCj4g
PiA+ID4gLSAgICAgICAgbGlidXNiX2hvdHBsdWdfZGVyZWdpc3Rlcl9jYWxsYmFjayhwcml2LT5j
b250ZXh0LCBwcml2LT5ocF9oYW5kbGUpOwo+ID4gPiA+IC0gICAgICAgIHByaXYtPmhwX2hhbmRs
ZSA9IDA7Cj4gPiA+ID4gKyAgICBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfc3RvcF9ldmVudF9s
aXN0ZW5pbmcoc2VsZik7Cj4gPiA+ID4gKyAgICBpZiAoZ19hdG9taWNfaW50X2dldCgmcHJpdi0+
ZXZlbnRfdGhyZWFkX3J1bikpIHsKPiA+ID4gPiArICAgICAgICAvKiBGb3JjZSB0ZXJtaW5hdGlv
biBvZiB0aGUgZXZlbnQgdGhyZWFkIGV2ZW4gaWYgdGhlcmUgd2VyZSBzb21lCj4gPiA+ID4gKyAg
ICAgICAgICogbWlzbWF0Y2hlZCBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfe3N0YXJ0LHN0b3B9
X2V2ZW50X2xpc3RlbmluZwo+ID4gPiA+ICsgICAgICAgICAqIGNhbGxzLiBPdGhlcndpc2UsIHRo
ZSB1c2IgZXZlbnQgdGhyZWFkIHdpbGwgYmUgbGVha2VkLCBhbmQgd2lsbAo+ID4gPiA+ICsgICAg
ICAgICAqIHRyeSB0byB1c2UgdGhlIGxpYnVzYiBjb250ZXh0IHdlIGRlc3Ryb3kgaW4gZmluYWxp
emUoKSwgd2hpY2ggd291bGQKPiA+ID4gPiArICAgICAgICAgKiBjYXVzZSBhIGNyYXNoICovCj4g
PiA+ID4gKyAgICAgICAgZ193YXJuX2lmX3JlYWNoZWQoKTsKPiA+ID4gPiArICAgICAgICBnX2F0
b21pY19pbnRfc2V0KCZwcml2LT5ldmVudF90aHJlYWRfcnVuLCBGQUxTRSk7Cj4gPiA+ID4gICAg
ICB9Cj4gPiA+ID4gKyAgICBzcGljZV91c2JfYmFja2VuZF9kZXJlZ2lzdGVyX2hvdHBsdWcocHJp
di0+Y29udGV4dCk7Cj4gPiA+ID4gICNlbmRpZgo+ID4gPiA+ICAgICAgaWYgKHByaXYtPmV2ZW50
X3RocmVhZCkgewo+ID4gPiA+ICAgICAgICAgIGdfd2Fybl9pZl9mYWlsKGdfYXRvbWljX2ludF9n
ZXQoJnByaXYtPmV2ZW50X3RocmVhZF9ydW4pID09IEZBTFNFKTsKPiA+ID4gPiBAQCAtMzg2LDcg
KzM2Niw3IEBAIHN0YXRpYyB2b2lkIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9maW5hbGl6ZShH
T2JqZWN0ICpnb2JqZWN0KQo+ID4gPiA+ICAgICAgZ19yZXR1cm5faWZfZmFpbChwcml2LT5ldmVu
dF90aHJlYWQgPT0gTlVMTCk7Cj4gPiA+ID4gICNpZm5kZWYgR19PU19XSU4zMgo+ID4gPiA+ICAg
ICAgaWYgKHByaXYtPmNvbnRleHQpCj4gPiA+ID4gLSAgICAgICAgbGlidXNiX2V4aXQocHJpdi0+
Y29udGV4dCk7Cj4gPiA+ID4gKyAgICAgICAgc3BpY2VfdXNiX2JhY2tlbmRfZGVsZXRlKHByaXYt
PmNvbnRleHQpOwo+ID4gPiA+ICAjZW5kaWYKPiA+ID4gPiAgICAgIGZyZWUocHJpdi0+YXV0b19j
b25uX2ZpbHRlcl9ydWxlcyk7Cj4gPiA+ID4gICAgICBmcmVlKHByaXYtPnJlZGlyZWN0X29uX2Nv
bm5lY3RfcnVsZXMpOwo+ID4gPiA+IEBAIC03MDksMzcgKzY4OSw2IEBAIHN0YXRpYyB2b2lkIHNw
aWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9jbGFzc19pbml0KFNwaWNlVXNiRGV2aWNlTWFuYWdlckNs
YXNzICprbGFzCj4gPiA+ID4gICAgICAgICAgICAgICAgICAgICAgIEdfVFlQRV9FUlJPUik7Cj4g
PiA+ID4gIH0KPiA+ID4gPgo+ID4gPiA+IC0jaWZkZWYgVVNFX1VTQlJFRElSCj4gPiA+ID4gLQo+
ID4gPiA+IC0vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0gKi8KPiA+ID4gPiAtLyogZ3VkZXYgLyBsaWJ1c2IgSGVscGVy
IGZ1bmN0aW9ucyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovCj4gPiA+ID4g
LQo+ID4gPiA+IC1zdGF0aWMgZ2Jvb2xlYW4gc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2dldF9k
ZXZpY2VfZGVzY3JpcHRvcigKPiA+ID4gPiAtICAgIGxpYnVzYl9kZXZpY2UgKmxpYmRldiwKPiA+
ID4gPiAtICAgIHN0cnVjdCBsaWJ1c2JfZGV2aWNlX2Rlc2NyaXB0b3IgKmRlc2MpCj4gPiA+ID4g
LXsKPiA+ID4gPiAtICAgIGludCBlcnJjb2RlOwo+ID4gPiA+IC0gICAgY29uc3QgZ2NoYXIgKmVy
cnN0cjsKPiA+ID4gPiAtCj4gPiA+ID4gLSAgICBnX3JldHVybl92YWxfaWZfZmFpbChsaWJkZXYg
IT0gTlVMTCwgRkFMU0UpOwo+ID4gPiA+IC0gICAgZ19yZXR1cm5fdmFsX2lmX2ZhaWwoZGVzYyAg
ICE9IE5VTEwsIEZBTFNFKTsKPiA+ID4gPiAtCj4gPiA+ID4gLSAgICBlcnJjb2RlID0gbGlidXNi
X2dldF9kZXZpY2VfZGVzY3JpcHRvcihsaWJkZXYsIGRlc2MpOwo+ID4gPiA+IC0gICAgaWYgKGVy
cmNvZGUgPCAwKSB7Cj4gPiA+ID4gLSAgICAgICAgaW50IGJ1cywgYWRkcjsKPiA+ID4gPiAtCj4g
PiA+ID4gLSAgICAgICAgYnVzID0gbGlidXNiX2dldF9idXNfbnVtYmVyKGxpYmRldik7Cj4gPiA+
ID4gLSAgICAgICAgYWRkciA9IGxpYnVzYl9nZXRfZGV2aWNlX2FkZHJlc3MobGliZGV2KTsKPiA+
ID4gPiAtICAgICAgICBlcnJzdHIgPSBzcGljZV91c2J1dGlsX2xpYnVzYl9zdHJlcnJvcihlcnJj
b2RlKTsKPiA+ID4gPiAtICAgICAgICBnX3dhcm5pbmcoImNhbm5vdCBnZXQgZGV2aWNlIGRlc2Ny
aXB0b3IgZm9yICglcCkgJWQuJWQgLS0gJXMoJWQpIiwKPiA+ID4gPiAtICAgICAgICAgICAgICAg
ICAgbGliZGV2LCBidXMsIGFkZHIsIGVycnN0ciwgZXJyY29kZSk7Cj4gPiA+ID4gLSAgICAgICAg
cmV0dXJuIEZBTFNFOwo+ID4gPiA+IC0gICAgfQo+ID4gPiA+IC0gICAgcmV0dXJuIFRSVUU7Cj4g
PiA+ID4gLX0KPiA+ID4gPiAtCj4gPiA+ID4gLSNlbmRpZiAvLyBVU0VfVVNCUkVESVIKPiA+ID4g
PiAtCj4gPiA+ID4gIC8qKgo+ID4gPiA+ICAgKiBzcGljZV91c2JfZGV2aWNlX2dldF9saWJ1c2Jf
ZGV2aWNlOgo+ID4gPiA+ICAgKiBAZGV2aWNlOiAjU3BpY2VVc2JEZXZpY2UgdG8gZ2V0IHRoZSBk
ZXNjcmlwdG9yIGluZm9ybWF0aW9uIG9mCj4gPiA+ID4gQEAgLTc1OCwzMiArNzA3LDEyIEBAIHNw
aWNlX3VzYl9kZXZpY2VfZ2V0X2xpYnVzYl9kZXZpY2UoY29uc3QgU3BpY2VVc2JEZXZpY2UgKmRl
dmljZSBHX0dOVUNfVU5VU0VEKQo+ID4gPiA+Cj4gPiA+ID4gICAgICBnX3JldHVybl92YWxfaWZf
ZmFpbChpbmZvICE9IE5VTEwsIEZBTFNFKTsKPiA+ID4gPgo+ID4gPiA+IC0gICAgcmV0dXJuIGlu
Zm8tPmxpYmRldjsKPiA+ID4gPiArICAgIHJldHVybiBzcGljZV91c2JfYmFja2VuZF9kZXZpY2Vf
Z2V0X2xpYmRldihpbmZvLT5iZGV2KTsKPiA+ID4gPiAgI2VuZGlmCj4gPiA+ID4gICAgICByZXR1
cm4gTlVMTDsKPiA+ID4gPiAgfQo+ID4gPiA+Cj4gPiA+ID4gICNpZmRlZiBVU0VfVVNCUkVESVIK
PiA+ID4gPiAtc3RhdGljIGdib29sZWFuIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9nZXRfbGli
ZGV2X3ZpZF9waWQoCj4gPiA+ID4gLSAgICBsaWJ1c2JfZGV2aWNlICpsaWJkZXYsIGludCAqdmlk
LCBpbnQgKnBpZCkKPiA+ID4gPiAtewo+ID4gPiA+IC0gICAgc3RydWN0IGxpYnVzYl9kZXZpY2Vf
ZGVzY3JpcHRvciBkZXNjOwo+ID4gPiA+IC0KPiA+ID4gPiAtICAgIGdfcmV0dXJuX3ZhbF9pZl9m
YWlsKGxpYmRldiAhPSBOVUxMLCBGQUxTRSk7Cj4gPiA+ID4gLSAgICBnX3JldHVybl92YWxfaWZf
ZmFpbCh2aWQgIT0gTlVMTCwgRkFMU0UpOwo+ID4gPiA+IC0gICAgZ19yZXR1cm5fdmFsX2lmX2Zh
aWwocGlkICE9IE5VTEwsIEZBTFNFKTsKPiA+ID4gPiAtCj4gPiA+ID4gLSAgICAqdmlkID0gKnBp
ZCA9IDA7Cj4gPiA+ID4gLQo+ID4gPiA+IC0gICAgaWYgKCFzcGljZV91c2JfZGV2aWNlX21hbmFn
ZXJfZ2V0X2RldmljZV9kZXNjcmlwdG9yKGxpYmRldiwgJmRlc2MpKSB7Cj4gPiA+ID4gLSAgICAg
ICAgcmV0dXJuIEZBTFNFOwo+ID4gPiA+IC0gICAgfQo+ID4gPiA+IC0gICAgKnZpZCA9IGRlc2Mu
aWRWZW5kb3I7Cj4gPiA+ID4gLSAgICAqcGlkID0gZGVzYy5pZFByb2R1Y3Q7Cj4gPiA+ID4gLQo+
ID4gPiA+IC0gICAgcmV0dXJuIFRSVUU7Cj4gPiA+ID4gLX0KPiA+ID4gPiAtCj4gPiA+ID4gIC8q
IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLSAqLwo+ID4gPiA+ICAvKiBjYWxsYmFja3MgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi8KPiA+ID4gPgo+ID4gPiA+IEBA
IC04OTksMzEgKzgyOCwyNCBAQCBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfZmluZF9kZXZpY2Uo
U3BpY2VVc2JEZXZpY2VNYW5hZ2VyICpzZWxmLAo+ID4gPiA+ICB9Cj4gPiA+ID4KPiA+ID4gPiAg
c3RhdGljIHZvaWQgc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2FkZF9kZXYoU3BpY2VVc2JEZXZp
Y2VNYW5hZ2VyICAqc2VsZiwKPiA+ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgbGlidXNiX2RldmljZSAgICAgICAgICAqbGliZGV2KQo+ID4gPiA+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTcGljZVVzYkJhY2tl
bmREZXZpY2UgICpiZGV2KQo+ID4gPiA+ICB7Cj4gPiA+ID4gICAgICBTcGljZVVzYkRldmljZU1h
bmFnZXJQcml2YXRlICpwcml2ID0gc2VsZi0+cHJpdjsKPiA+ID4gPiAtICAgIHN0cnVjdCBsaWJ1
c2JfZGV2aWNlX2Rlc2NyaXB0b3IgZGVzYzsKPiA+ID4gPiArICAgIGNvbnN0IFVzYkRldmljZUlu
Zm9ybWF0aW9uICpiX2luZm8gPSBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfZ2V0X2luZm8oYmRl
dik7Cj4gPiA+ID4gICAgICBTcGljZVVzYkRldmljZSAqZGV2aWNlOwo+ID4gPiA+Cj4gPiA+ID4g
LSAgICBpZiAoIXNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9nZXRfZGV2aWNlX2Rlc2NyaXB0b3Io
bGliZGV2LCAmZGVzYykpCj4gPiA+ID4gLSAgICAgICAgcmV0dXJuOwo+ID4gPiA+IC0KPiA+ID4g
PiAtICAgIC8qIFNraXAgaHVicyAqLwo+ID4gPiA+IC0gICAgaWYgKGRlc2MuYkRldmljZUNsYXNz
ID09IExJQlVTQl9DTEFTU19IVUIpCj4gPiA+ID4gLSAgICAgICAgcmV0dXJuOwo+ID4gPiA+IC0K
PiA+ID4gPiAgICAgIGlmIChzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfZmluZF9kZXZpY2Uoc2Vs
ZiwKPiA+ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
bGlidXNiX2dldF9idXNfbnVtYmVyKGxpYmRldiksCj4gPiA+ID4gLSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpYnVzYl9nZXRfZGV2aWNlX2FkZHJlc3MobGli
ZGV2KSkpIHsKPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgYl9pbmZvLT5idXMsCj4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGJfaW5mby0+YWRkcmVzcykpIHsKPiA+ID4gPiAgICAgICAgICBTUElD
RV9ERUJVRygiZGV2aWNlIG5vdCBhZGRlZCAlZDolZCAlMDR4OiUwNHgiLAo+ID4gPiA+IC0gICAg
ICAgICAgICAgICAgICAgIGxpYnVzYl9nZXRfYnVzX251bWJlcihsaWJkZXYpLAo+ID4gPiA+IC0g
ICAgICAgICAgICAgICAgICAgIGxpYnVzYl9nZXRfZGV2aWNlX2FkZHJlc3MobGliZGV2KSwKPiA+
ID4gPiAtICAgICAgICAgICAgICAgICAgICBkZXNjLmlkVmVuZG9yLAo+ID4gPiA+IC0gICAgICAg
ICAgICAgICAgICAgIGRlc2MuaWRQcm9kdWN0KTsKPiA+ID4gPiArICAgICAgICAgICAgICAgICAg
ICBiX2luZm8tPmJ1cywKPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICBiX2luZm8tPmFkZHJl
c3MsCj4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgYl9pbmZvLT52aWQsCj4gPiA+ID4gKyAg
ICAgICAgICAgICAgICAgICAgYl9pbmZvLT5waWQpOwo+ID4gPiA+ICAgICAgICAgIHJldHVybjsK
PiA+ID4gPiAgICAgIH0KPiA+ID4gPgo+ID4gPiA+IC0gICAgZGV2aWNlID0gKFNwaWNlVXNiRGV2
aWNlKilzcGljZV91c2JfZGV2aWNlX25ldyhsaWJkZXYpOwo+ID4gPiA+ICsgICAgZGV2aWNlID0g
KFNwaWNlVXNiRGV2aWNlKilzcGljZV91c2JfZGV2aWNlX25ldyhiZGV2KTsKPiA+ID4gPiAgICAg
IGlmICghZGV2aWNlKQo+ID4gPiA+ICAgICAgICAgIHJldHVybjsKPiA+ID4gPgo+ID4gPiA+IEBA
IC05MzUsMTAgKzg1NywxMCBAQCBzdGF0aWMgdm9pZCBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJf
YWRkX2RldihTcGljZVVzYkRldmljZU1hbmFnZXIgICpzZWxmLAo+ID4gPiA+ICAgICAgICAgIGNh
bl9yZWRpcmVjdCA9IHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9jYW5fcmVkaXJlY3RfZGV2aWNl
KAo+ID4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZiwg
ZGV2aWNlLCBOVUxMKTsKPiA+ID4gPgo+ID4gPiA+IC0gICAgICAgIGF1dG9fb2sgPSB1c2JyZWRp
cmhvc3RfY2hlY2tfZGV2aWNlX2ZpbHRlcigKPiA+ID4gPiArICAgICAgICBhdXRvX29rID0gc3Bp
Y2VfdXNiX2JhY2tlbmRfZGV2aWNlX2NoZWNrX2ZpbHRlcigKPiA+ID4gPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGJkZXYsCj4gPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBwcml2LT5hdXRvX2Nvbm5fZmlsdGVyX3J1bGVzLAo+ID4gPiA+IC0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgcHJpdi0+YXV0b19jb25uX2ZpbHRlcl9ydWxlc19jb3VudCwKPiA+ID4gPiAt
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpYmRldiwgMCkgPT0gMDsKPiA+ID4gPiArICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHByaXYtPmF1dG9fY29ubl9maWx0ZXJfcnVsZXNfY291
bnQpID09IDA7Cj4gPiA+ID4KPiA+ID4gPiAgICAgICAgICBpZiAoY2FuX3JlZGlyZWN0ICYmIGF1
dG9fb2spCj4gPiA+ID4gICAgICAgICAgICAgIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9jb25u
ZWN0X2RldmljZV9hc3luYyhzZWxmLAo+ID4gPiA+IEBAIC05NTUsMTUgKzg3NywxNiBAQCBzdGF0
aWMgdm9pZCBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfYWRkX2RldihTcGljZVVzYkRldmljZU1h
bmFnZXIgICpzZWxmLAo+ID4gPiA+ICB9Cj4gPiA+ID4KPiA+ID4gPiAgc3RhdGljIHZvaWQgc3Bp
Y2VfdXNiX2RldmljZV9tYW5hZ2VyX3JlbW92ZV9kZXYoU3BpY2VVc2JEZXZpY2VNYW5hZ2VyICpz
ZWxmLAo+ID4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBndWludCBidXMsIGd1aW50IGFkZHJlc3MpCj4gPiA+ID4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNwaWNlVXNiQmFja2VuZERldmljZSAqYmRl
dikKPiA+ID4gPiAgewo+ID4gPiA+ICAgICAgU3BpY2VVc2JEZXZpY2VNYW5hZ2VyUHJpdmF0ZSAq
cHJpdiA9IHNlbGYtPnByaXY7Cj4gPiA+ID4gICAgICBTcGljZVVzYkRldmljZSAqZGV2aWNlOwo+
ID4gPiA+ICsgICAgY29uc3QgVXNiRGV2aWNlSW5mb3JtYXRpb24gKmJfaW5mbyA9IHNwaWNlX3Vz
Yl9iYWNrZW5kX2RldmljZV9nZXRfaW5mbyhiZGV2KTsKPiA+ID4gPgo+ID4gPiA+IC0gICAgZGV2
aWNlID0gc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2ZpbmRfZGV2aWNlKHNlbGYsIGJ1cywgYWRk
cmVzcyk7Cj4gPiA+ID4gKyAgICBkZXZpY2UgPSBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfZmlu
ZF9kZXZpY2Uoc2VsZiwgYl9pbmZvLT5idXMsIGJfaW5mby0+YWRkcmVzcyk7Cj4gPiA+ID4gICAg
ICBpZiAoIWRldmljZSkgewo+ID4gPiA+ICAgICAgICAgIGdfd2FybmluZygiQ291bGQgbm90IGZp
bmQgVVNCIGRldmljZSB0byByZW1vdmUgIiBERVZfSURfRk1ULAo+ID4gPiA+IC0gICAgICAgICAg
ICAgICAgICBidXMsIGFkZHJlc3MpOwo+ID4gPiA+ICsgICAgICAgICAgICAgICAgICBiX2luZm8t
PmJ1cywgYl9pbmZvLT5hZGRyZXNzKTsKPiA+ID4gPiAgICAgICAgICByZXR1cm47Cj4gPiA+ID4g
ICAgICB9Cj4gPiA+ID4KPiA+ID4gPiBAQCAtOTgyLDI0ICs5MDUsMjIgQEAgc3RhdGljIHZvaWQg
c3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX3JlbW92ZV9kZXYoU3BpY2VVc2JEZXZpY2VNYW5hZ2Vy
ICpzZWxmLAo+ID4gPiA+Cj4gPiA+ID4gICNpZmRlZiBHX09TX1dJTjMyCj4gPiA+ID4gIHN0YXRp
YyB2b2lkIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl91ZXZlbnRfY2IoR1VkZXZDbGllbnQgICAg
ICpjbGllbnQsCj4gPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgbGlidXNiX2RldmljZSAgICpkZXYsCj4gPiA+ID4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpiZGV2
LAo+ID4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGdib29sZWFuICAgICAgICAgYWRkLAo+ID4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGdwb2ludGVyICAgICAgICAgdXNlcl9kYXRhKQo+ID4gPiA+
ICB7Cj4gPiA+ID4gICAgICBTcGljZVVzYkRldmljZU1hbmFnZXIgKnNlbGYgPSBTUElDRV9VU0Jf
REVWSUNFX01BTkFHRVIodXNlcl9kYXRhKTsKPiA+ID4gPgo+ID4gPiA+ICAgICAgaWYgKGFkZCkK
PiA+ID4gPiAtICAgICAgICBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfYWRkX2RldihzZWxmLCBk
ZXYpOwo+ID4gPiA+ICsgICAgICAgIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9hZGRfZGV2KHNl
bGYsIGJkZXYpOwo+ID4gPiA+ICAgICAgZWxzZQo+ID4gPiA+IC0gICAgICAgIHNwaWNlX3VzYl9k
ZXZpY2VfbWFuYWdlcl9yZW1vdmVfZGV2KHNlbGYsCj4gPiA+ID4gLSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlidXNiX2dldF9idXNfbnVtYmVyKGRldiksCj4g
PiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlidXNi
X2dldF9kZXZpY2VfYWRkcmVzcyhkZXYpKTsKPiA+ID4gPiArICAgICAgICBzcGljZV91c2JfZGV2
aWNlX21hbmFnZXJfcmVtb3ZlX2RldihzZWxmLCBiZGV2KTsKPiA+ID4gPiAgfQo+ID4gPiA+ICAj
ZWxzZQo+ID4gPiA+ICBzdHJ1Y3QgaG90cGx1Z19pZGxlX2NiX2FyZ3Mgewo+ID4gPiA+ICAgICAg
U3BpY2VVc2JEZXZpY2VNYW5hZ2VyICpzZWxmOwo+ID4gPiA+IC0gICAgbGlidXNiX2RldmljZSAq
ZGV2aWNlOwo+ID4gPiA+IC0gICAgbGlidXNiX2hvdHBsdWdfZXZlbnQgZXZlbnQ7Cj4gPiA+ID4g
KyAgICBTcGljZVVzYkJhY2tlbmREZXZpY2UgKmRldmljZTsKPiA+ID4gPiArICAgIGdib29sZWFu
ICAgICAgICAgICAgICAgYWRkZWQ7Cj4gPiA+ID4gIH07Cj4gPiA+ID4KPiA+ID4gPiAgc3RhdGlj
IGdib29sZWFuIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9ob3RwbHVnX2lkbGVfY2IoZ3BvaW50
ZXIgdXNlcl9kYXRhKQo+ID4gPiA+IEBAIC0xMDA3LDM2ICs5MjgsMjkgQEAgc3RhdGljIGdib29s
ZWFuIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9ob3RwbHVnX2lkbGVfY2IoZ3BvaW50ZXIgdXNl
cl9kYXRhKQo+ID4gPiA+ICAgICAgc3RydWN0IGhvdHBsdWdfaWRsZV9jYl9hcmdzICphcmdzID0g
dXNlcl9kYXRhOwo+ID4gPiA+ICAgICAgU3BpY2VVc2JEZXZpY2VNYW5hZ2VyICpzZWxmID0gU1BJ
Q0VfVVNCX0RFVklDRV9NQU5BR0VSKGFyZ3MtPnNlbGYpOwo+ID4gPiA+Cj4gPiA+ID4gLSAgICBz
d2l0Y2ggKGFyZ3MtPmV2ZW50KSB7Cj4gPiA+ID4gLSAgICBjYXNlIExJQlVTQl9IT1RQTFVHX0VW
RU5UX0RFVklDRV9BUlJJVkVEOgo+ID4gPiA+ICsgICAgaWYgKGFyZ3MtPmFkZGVkKQo+ID4gPiA+
ICAgICAgICAgIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9hZGRfZGV2KHNlbGYsIGFyZ3MtPmRl
dmljZSk7Cj4gPiA+ID4gLSAgICAgICAgYnJlYWs7Cj4gPiA+ID4gLSAgICBjYXNlIExJQlVTQl9I
T1RQTFVHX0VWRU5UX0RFVklDRV9MRUZUOgo+ID4gPiA+IC0gICAgICAgIHNwaWNlX3VzYl9kZXZp
Y2VfbWFuYWdlcl9yZW1vdmVfZGV2KHNlbGYsCj4gPiA+ID4gLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGxpYnVzYl9nZXRfYnVzX251bWJlcihhcmdzLT5kZXZpY2UpLAo+ID4g
PiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWJ1c2JfZ2V0X2Rldmlj
ZV9hZGRyZXNzKGFyZ3MtPmRldmljZSkpOwo+ID4gPiA+IC0gICAgICAgIGJyZWFrOwo+ID4gPiA+
IC0gICAgfQo+ID4gPiA+IC0gICAgbGlidXNiX3VucmVmX2RldmljZShhcmdzLT5kZXZpY2UpOwo+
ID4gPiA+ICsgICAgZWxzZQo+ID4gPiA+ICsgICAgICAgIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdl
cl9yZW1vdmVfZGV2KHNlbGYsIGFyZ3MtPmRldmljZSk7Cj4gPiA+ID4gKwo+ID4gPiA+ICsgICAg
c3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX3VucmVmKGFyZ3MtPmRldmljZSk7Cj4gPiA+ID4gICAg
ICBnX29iamVjdF91bnJlZihzZWxmKTsKPiA+ID4gPiAgICAgIGdfZnJlZShhcmdzKTsKPiA+ID4g
PiAgICAgIHJldHVybiBGQUxTRTsKPiA+ID4gPiAgfQo+ID4gPiA+Cj4gPiA+ID4gIC8qIENhbiBi
ZSBjYWxsZWQgZnJvbSBib3RoIHRoZSBtYWluLXRocmVhZCBhcyB3ZWxsIGFzIHRoZSBldmVudF90
aHJlYWQgKi8KPiA+ID4gPiAtc3RhdGljIGludCBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfaG90
cGx1Z19jYihsaWJ1c2JfY29udGV4dCAgICAgICAqY3R4LAo+ID4gPiA+IC0gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpYnVzYl9kZXZpY2UgICAgICAgICpk
ZXZpY2UsCj4gPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgbGlidXNiX2hvdHBsdWdfZXZlbnQgIGV2ZW50LAo+ID4gPiA+IC0gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZvaWQgICAgICAgICAgICAgICAgICp1
c2VyX2RhdGEpCj4gPiA+ID4gK3N0YXRpYyB2b2lkIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9o
b3RwbHVnX2NiKHZvaWQgKnVzZXJfZGF0YSwKPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpkZXYsCj4g
PiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdi
b29sZWFuIGFkZGVkKQo+ID4gPiA+ICB7Cj4gPiA+ID4gICAgICBTcGljZVVzYkRldmljZU1hbmFn
ZXIgKnNlbGYgPSBTUElDRV9VU0JfREVWSUNFX01BTkFHRVIodXNlcl9kYXRhKTsKPiA+ID4gPiAg
ICAgIHN0cnVjdCBob3RwbHVnX2lkbGVfY2JfYXJncyAqYXJncyA9IGdfbWFsbG9jMChzaXplb2Yo
KmFyZ3MpKTsKPiA+ID4gPgo+ID4gPiA+ICAgICAgYXJncy0+c2VsZiA9IGdfb2JqZWN0X3JlZihz
ZWxmKTsKPiA+ID4gPiAtICAgIGFyZ3MtPmRldmljZSA9IGxpYnVzYl9yZWZfZGV2aWNlKGRldmlj
ZSk7Cj4gPiA+ID4gLSAgICBhcmdzLT5ldmVudCA9IGV2ZW50Owo+ID4gPiA+ICsgICAgYXJncy0+
ZGV2aWNlID0gc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX3JlZihkZXYpOwo+ID4gPiA+ICsgICAg
YXJncy0+YWRkZWQgPSBhZGRlZDsKPiA+ID4gPiAgICAgIGdfaWRsZV9hZGQoc3BpY2VfdXNiX2Rl
dmljZV9tYW5hZ2VyX2hvdHBsdWdfaWRsZV9jYiwgYXJncyk7Cj4gPiA+ID4gLSAgICByZXR1cm4g
MDsKPiA+ID4gPiAgfQo+ID4gPiA+ICAjZW5kaWYgLy8gVVNFX1VTQlJFRElSCj4gPiA+ID4KPiA+
ID4gPiBAQCAtMTA2MywxMyArOTc3LDkgQEAgc3RhdGljIGdwb2ludGVyIHNwaWNlX3VzYl9kZXZp
Y2VfbWFuYWdlcl91c2JfZXZfdGhyZWFkKGdwb2ludGVyIHVzZXJfZGF0YSkKPiA+ID4gPiAgewo+
ID4gPiA+ICAgICAgU3BpY2VVc2JEZXZpY2VNYW5hZ2VyICpzZWxmID0gU1BJQ0VfVVNCX0RFVklD
RV9NQU5BR0VSKHVzZXJfZGF0YSk7Cj4gPiA+ID4gICAgICBTcGljZVVzYkRldmljZU1hbmFnZXJQ
cml2YXRlICpwcml2ID0gc2VsZi0+cHJpdjsKPiA+ID4gPiAtICAgIGludCByYzsKPiA+ID4gPgo+
ID4gPiA+ICAgICAgd2hpbGUgKGdfYXRvbWljX2ludF9nZXQoJnByaXYtPmV2ZW50X3RocmVhZF9y
dW4pKSB7Cj4gPiA+ID4gLSAgICAgICAgcmMgPSBsaWJ1c2JfaGFuZGxlX2V2ZW50cyhwcml2LT5j
b250ZXh0KTsKPiA+ID4gPiAtICAgICAgICBpZiAocmMgJiYgcmMgIT0gTElCVVNCX0VSUk9SX0lO
VEVSUlVQVEVEKSB7Cj4gPiA+ID4gLSAgICAgICAgICAgIGNvbnN0IGNoYXIgKmRlc2MgPSBzcGlj
ZV91c2J1dGlsX2xpYnVzYl9zdHJlcnJvcihyYyk7Cj4gPiA+ID4gLSAgICAgICAgICAgIGdfd2Fy
bmluZygiRXJyb3IgaGFuZGxpbmcgVVNCIGV2ZW50czogJXMgWyVpXSIsIGRlc2MsIHJjKTsKPiA+
ID4gPiArICAgICAgICBpZiAoIXNwaWNlX3VzYl9iYWNrZW5kX2hhbmRsZV9ldmVudHMocHJpdi0+
Y29udGV4dCkpIHsKPiA+ID4gPiAgICAgICAgICAgICAgYnJlYWs7Cj4gPiA+ID4gICAgICAgICAg
fQo+ID4gPiA+ICAgICAgfQo+ID4gPiA+IEBAIC0xMTIwLDcgKzEwMzAsNyBAQCBzdGF0aWMgdm9p
ZCBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfY2hlY2tfcmVkaXJfb25fY29ubmVjdCgKPiA+ID4g
PiAgICAgIFNwaWNlVXNiRGV2aWNlTWFuYWdlclByaXZhdGUgKnByaXYgPSBzZWxmLT5wcml2Owo+
ID4gPiA+ICAgICAgR1Rhc2sgKnRhc2s7Cj4gPiA+ID4gICAgICBTcGljZVVzYkRldmljZSAqZGV2
aWNlOwo+ID4gPiA+IC0gICAgbGlidXNiX2RldmljZSAqbGliZGV2Owo+ID4gPiA+ICsgICAgU3Bp
Y2VVc2JCYWNrZW5kRGV2aWNlICpiZGV2Owo+ID4gPiA+ICAgICAgZ3VpbnQgaTsKPiA+ID4gPgo+
ID4gPiA+ICAgICAgaWYgKHByaXYtPnJlZGlyZWN0X29uX2Nvbm5lY3QgPT0gTlVMTCkKPiA+ID4g
PiBAQCAtMTEzMiwxMSArMTA0MiwxMSBAQCBzdGF0aWMgdm9pZCBzcGljZV91c2JfZGV2aWNlX21h
bmFnZXJfY2hlY2tfcmVkaXJfb25fY29ubmVjdCgKPiA+ID4gPiAgICAgICAgICBpZiAoc3BpY2Vf
dXNiX2RldmljZV9tYW5hZ2VyX2lzX2RldmljZV9jb25uZWN0ZWQoc2VsZiwgZGV2aWNlKSkKPiA+
ID4gPiAgICAgICAgICAgICAgY29udGludWU7Cj4gPiA+ID4KPiA+ID4gPiAtICAgICAgICBsaWJk
ZXYgPSBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfZGV2aWNlX3RvX2xpYmRldihzZWxmLCBkZXZp
Y2UpOwo+ID4gPiA+IC0gICAgICAgIGlmICh1c2JyZWRpcmhvc3RfY2hlY2tfZGV2aWNlX2ZpbHRl
cigKPiA+ID4gPiArICAgICAgICBiZGV2ID0gc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2Rldmlj
ZV90b19iZGV2KHNlbGYsIGRldmljZSk7Cj4gPiA+ID4gKyAgICAgICAgaWYgKHNwaWNlX3VzYl9i
YWNrZW5kX2RldmljZV9jaGVja19maWx0ZXIoCj4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBiZGV2LAo+ID4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpdi0+
cmVkaXJlY3Rfb25fY29ubmVjdF9ydWxlcywKPiA+ID4gPiAtICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHByaXYtPnJlZGlyZWN0X29uX2Nvbm5lY3RfcnVsZXNfY291bnQsCj4gPiA+ID4gLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBsaWJkZXYsIDApID09IDApIHsKPiA+ID4gPiArICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHByaXYtPnJlZGlyZWN0X29uX2Nvbm5lY3RfcnVsZXNf
Y291bnQpID09IDApIHsKPiA+ID4gPiAgICAgICAgICAgICAgLyogTm90ZTogcmUtdXNlcyBzcGlj
ZV91c2JfZGV2aWNlX21hbmFnZXJfY29ubmVjdF9kZXZpY2VfYXN5bmMncwo+ID4gPiA+ICAgICAg
ICAgICAgICAgICBjb21wbGV0aW9uIGhhbmRsaW5nIGNvZGUhICovCj4gPiA+ID4gICAgICAgICAg
ICAgIHRhc2sgPSBnX3Rhc2tfbmV3KHNlbGYsCj4gPiA+ID4gQEAgLTExNDYsMTQgKzEwNTYsMTQg
QEAgc3RhdGljIHZvaWQgc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2NoZWNrX3JlZGlyX29uX2Nv
bm5lY3QoCj4gPiA+ID4KPiA+ID4gPiAgICAgICAgICAgICAgc3BpY2VfdXNicmVkaXJfY2hhbm5l
bF9jb25uZWN0X2RldmljZV9hc3luYygKPiA+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIFNQSUNFX1VTQlJFRElSX0NIQU5ORUwoY2hhbm5lbCksCj4gPiA+ID4gLSAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBsaWJkZXYsIGRldmljZSwgTlVMTCwKPiA+ID4gPiArICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJkZXYsIGRldmljZSwgTlVMTCwKPiA+ID4gPiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9j
aGFubmVsX2Nvbm5lY3RfY2IsCj4gPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICB0YXNrKTsKPiA+ID4gPiAtICAgICAgICAgICAgbGlidXNiX3VucmVmX2RldmljZShsaWJkZXYp
Owo+ID4gPiA+ICsgICAgICAgICAgICBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfdW5yZWYoYmRl
dik7Cj4gPiA+ID4gICAgICAgICAgICAgIHJldHVybjsgLyogV2UndmUgdGFrZW4gdGhlIGNoYW5u
ZWwhICovCj4gPiA+ID4gICAgICAgICAgfQo+ID4gPiA+Cj4gPiA+ID4gLSAgICAgICAgbGlidXNi
X3VucmVmX2RldmljZShsaWJkZXYpOwo+ID4gPiA+ICsgICAgICAgIHNwaWNlX3VzYl9iYWNrZW5k
X2RldmljZV91bnJlZihiZGV2KTsKPiA+ID4gPiAgICAgIH0KPiA+ID4gPiAgfQo+ID4gPiA+Cj4g
PiA+ID4gQEAgLTExNzcsOCArMTA4Nyw4IEBAIHN0YXRpYyBTcGljZVVzYnJlZGlyQ2hhbm5lbCAq
c3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2dldF9jaGFubmVsX2Zvcl9kZXYoCj4gPiA+ID4gICAg
ICBmb3IgKGkgPSAwOyBpIDwgcHJpdi0+Y2hhbm5lbHMtPmxlbjsgaSsrKSB7Cj4gPiA+ID4gICAg
ICAgICAgU3BpY2VVc2JyZWRpckNoYW5uZWwgKmNoYW5uZWwgPSBnX3B0cl9hcnJheV9pbmRleChw
cml2LT5jaGFubmVscywgaSk7Cj4gPiA+ID4gICAgICAgICAgc3BpY2VfdXNicmVkaXJfY2hhbm5l
bF9sb2NrKGNoYW5uZWwpOwo+ID4gPiA+IC0gICAgICAgIGxpYnVzYl9kZXZpY2UgKmxpYmRldiA9
IHNwaWNlX3VzYnJlZGlyX2NoYW5uZWxfZ2V0X2RldmljZShjaGFubmVsKTsKPiA+ID4gPiAtICAg
ICAgICBpZiAoc3BpY2VfdXNiX21hbmFnZXJfZGV2aWNlX2VxdWFsX2xpYmRldihtYW5hZ2VyLCBk
ZXZpY2UsIGxpYmRldikpIHsKPiA+ID4gPiArICAgICAgICBTcGljZVVzYkJhY2tlbmREZXZpY2Ug
KmJkZXYgPSBzcGljZV91c2JyZWRpcl9jaGFubmVsX2dldF9kZXZpY2UoY2hhbm5lbCk7Cj4gPiA+
ID4gKyAgICAgICAgaWYgKHNwaWNlX3VzYl9tYW5hZ2VyX2RldmljZV9lcXVhbF9iZGV2KG1hbmFn
ZXIsIGRldmljZSwgYmRldikpIHsKPiA+ID4gPiAgICAgICAgICAgICAgc3BpY2VfdXNicmVkaXJf
Y2hhbm5lbF91bmxvY2soY2hhbm5lbCk7Cj4gPiA+ID4gICAgICAgICAgICAgIHJldHVybiBjaGFu
bmVsOwo+ID4gPiA+ICAgICAgICAgIH0KPiA+ID4gPiBAQCAtMTIzNSw5ICsxMTQ1LDkgQEAgR1B0
ckFycmF5KiBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfZ2V0X2RldmljZXNfd2l0aF9maWx0ZXIo
Cj4gPiA+ID4gICAgICAgICAgU3BpY2VVc2JEZXZpY2UgKmRldmljZSA9IGdfcHRyX2FycmF5X2lu
ZGV4KHByaXYtPmRldmljZXMsIGkpOwo+ID4gPiA+Cj4gPiA+ID4gICAgICAgICAgaWYgKHJ1bGVz
KSB7Cj4gPiA+ID4gLSAgICAgICAgICAgIGxpYnVzYl9kZXZpY2UgKmxpYmRldiA9Cj4gPiA+ID4g
LSAgICAgICAgICAgICAgICBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfZGV2aWNlX3RvX2xpYmRl
dihzZWxmLCBkZXZpY2UpOwo+ID4gPiA+IC0gICAgICAgICAgICBpZiAodXNicmVkaXJob3N0X2No
ZWNrX2RldmljZV9maWx0ZXIocnVsZXMsIGNvdW50LCBsaWJkZXYsIDApICE9IDApCj4gPiA+ID4g
KyAgICAgICAgICAgIFNwaWNlVXNiQmFja2VuZERldmljZSAqYmRldiA9Cj4gPiA+ID4gKyAgICAg
ICAgICAgICAgICBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfZGV2aWNlX3RvX2JkZXYoc2VsZiwg
ZGV2aWNlKTsKPiA+ID4gPiArICAgICAgICAgICAgaWYgKHNwaWNlX3VzYl9iYWNrZW5kX2Rldmlj
ZV9jaGVja19maWx0ZXIoYmRldiwgcnVsZXMsIGNvdW50KSAhPSAwKQo+ID4gPiA+ICAgICAgICAg
ICAgICAgICAgY29udGludWU7Cj4gPiA+ID4gICAgICAgICAgfQo+ID4gPiA+ICAgICAgICAgIGdf
cHRyX2FycmF5X2FkZChkZXZpY2VzX2NvcHksIHNwaWNlX3VzYl9kZXZpY2VfcmVmKGRldmljZSkp
Owo+ID4gPiA+IEBAIC0xMzExLDcgKzEyMjEsNyBAQCBfc3BpY2VfdXNiX2RldmljZV9tYW5hZ2Vy
X2Nvbm5lY3RfZGV2aWNlX2FzeW5jKFNwaWNlVXNiRGV2aWNlTWFuYWdlciAqc2VsZiwKPiA+ID4g
PiAgICAgIHRhc2sgPSBnX3Rhc2tfbmV3KHNlbGYsIGNhbmNlbGxhYmxlLCBjYWxsYmFjaywgdXNl
cl9kYXRhKTsKPiA+ID4gPgo+ID4gPiA+ICAgICAgU3BpY2VVc2JEZXZpY2VNYW5hZ2VyUHJpdmF0
ZSAqcHJpdiA9IHNlbGYtPnByaXY7Cj4gPiA+ID4gLSAgICBsaWJ1c2JfZGV2aWNlICpsaWJkZXY7
Cj4gPiA+ID4gKyAgICBTcGljZVVzYkJhY2tlbmREZXZpY2UgKmJkZXY7Cj4gPiA+ID4gICAgICBn
dWludCBpOwo+ID4gPiA+Cj4gPiA+ID4gICAgICBpZiAoc3BpY2VfdXNiX2RldmljZV9tYW5hZ2Vy
X2lzX2RldmljZV9jb25uZWN0ZWQoc2VsZiwgZGV2aWNlKSkgewo+ID4gPiA+IEBAIC0xMzI3LDE0
ICsxMjM3LDE0IEBAIF9zcGljZV91c2JfZGV2aWNlX21hbmFnZXJfY29ubmVjdF9kZXZpY2VfYXN5
bmMoU3BpY2VVc2JEZXZpY2VNYW5hZ2VyICpzZWxmLAo+ID4gPiA+ICAgICAgICAgIGlmIChzcGlj
ZV91c2JyZWRpcl9jaGFubmVsX2dldF9kZXZpY2UoY2hhbm5lbCkpCj4gPiA+ID4gICAgICAgICAg
ICAgIGNvbnRpbnVlOyAvKiBTa2lwIGFscmVhZHkgdXNlZCBjaGFubmVscyAqLwo+ID4gPiA+Cj4g
PiA+ID4gLSAgICAgICAgbGliZGV2ID0gc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2RldmljZV90
b19saWJkZXYoc2VsZiwgZGV2aWNlKTsKPiA+ID4gPiArICAgICAgICBiZGV2ID0gc3BpY2VfdXNi
X2RldmljZV9tYW5hZ2VyX2RldmljZV90b19iZGV2KHNlbGYsIGRldmljZSk7Cj4gPiA+ID4gICAg
ICAgICAgc3BpY2VfdXNicmVkaXJfY2hhbm5lbF9jb25uZWN0X2RldmljZV9hc3luYyhjaGFubmVs
LAo+ID4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWJkZXYsCj4gPiA+
ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJkZXYsCj4gPiA+ID4gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRldmljZSwKPiA+ID4gPiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgY2FuY2VsbGFibGUsCj4gPiA+ID4gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9jaGFubmVsX2Nvbm5l
Y3RfY2IsCj4gPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2spOwo+
ID4gPiA+IC0gICAgICAgIGxpYnVzYl91bnJlZl9kZXZpY2UobGliZGV2KTsKPiA+ID4gPiArICAg
ICAgICBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfdW5yZWYoYmRldik7Cj4gPiA+ID4gICAgICAg
ICAgcmV0dXJuOwo+ID4gPiA+ICAgICAgfQo+ID4gPiA+Cj4gPiA+ID4gQEAgLTE1OTYsMTMgKzE1
MDYsMTQgQEAgc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2Nhbl9yZWRpcmVjdF9kZXZpY2UoU3Bp
Y2VVc2JEZXZpY2VNYW5hZ2VyICAqc2VsZiwKPiA+ID4gPgo+ID4gPiA+ICAgICAgaWYgKGd1ZXN0
X2ZpbHRlcl9ydWxlcykgewo+ID4gPiA+ICAgICAgICAgIGdib29sZWFuIGZpbHRlcl9vazsKPiA+
ID4gPiAtICAgICAgICBsaWJ1c2JfZGV2aWNlICpsaWJkZXY7Cj4gPiA+ID4gLQo+ID4gPiA+IC0g
ICAgICAgIGxpYmRldiA9IHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9kZXZpY2VfdG9fbGliZGV2
KHNlbGYsIGRldmljZSk7Cj4gPiA+ID4gLSAgICAgICAgZmlsdGVyX29rID0gKHVzYnJlZGlyaG9z
dF9jaGVja19kZXZpY2VfZmlsdGVyKAo+ID4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgZ3Vlc3RfZmlsdGVyX3J1bGVzLCBndWVzdF9maWx0ZXJfcnVsZXNfY291bnQsCj4gPiA+ID4g
LSAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWJkZXYsIDApID09IDApOwo+ID4gPiA+IC0g
ICAgICAgIGxpYnVzYl91bnJlZl9kZXZpY2UobGliZGV2KTsKPiA+ID4gPiArICAgICAgICBTcGlj
ZVVzYkJhY2tlbmREZXZpY2UgKmJkZXY7Cj4gPiA+ID4gKwo+ID4gPiA+ICsgICAgICAgIGJkZXYg
PSBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfZGV2aWNlX3RvX2JkZXYoc2VsZiwgZGV2aWNlKTsK
PiA+ID4gPiArICAgICAgICBmaWx0ZXJfb2sgPSAoc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX2No
ZWNrX2ZpbHRlcigKPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJkZXYsCj4g
PiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBndWVzdF9maWx0ZXJfcnVsZXMsCj4g
PiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBndWVzdF9maWx0ZXJfcnVsZXNfY291
bnQpID09IDApOwo+ID4gPiA+ICsgICAgICAgIHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV91bnJl
ZihiZGV2KTsKPiA+ID4gPiAgICAgICAgICBpZiAoIWZpbHRlcl9vaykgewo+ID4gPiA+ICAgICAg
ICAgICAgICBnX3NldF9lcnJvcl9saXRlcmFsKGVyciwgU1BJQ0VfQ0xJRU5UX0VSUk9SLCBTUElD
RV9DTElFTlRfRVJST1JfRkFJTEVELAo+ID4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIF8oIlNvbWUgVVNCIGRldmljZXMgYXJlIGJsb2NrZWQgYnkgaG9zdCBwb2xpY3kiKSk7
Cj4gPiA+ID4gQEAgLTE2OTYsNjAgKzE2MDcsMjcgQEAgZ2NoYXIgKnNwaWNlX3VzYl9kZXZpY2Vf
Z2V0X2Rlc2NyaXB0aW9uKFNwaWNlVXNiRGV2aWNlICpkZXZpY2UsIGNvbnN0IGdjaGFyICpmb3IK
PiA+ID4gPgo+ID4gPiA+Cj4gPiA+ID4gICNpZmRlZiBVU0VfVVNCUkVESVIKPiA+ID4gPiAtc3Rh
dGljIGdib29sZWFuIHByb2JlX2lzb2Nocm9ub3VzX2VuZHBvaW50KGxpYnVzYl9kZXZpY2UgKmxp
YmRldikKPiA+ID4gPiAtewo+ID4gPiA+IC0gICAgc3RydWN0IGxpYnVzYl9jb25maWdfZGVzY3Jp
cHRvciAqY29uZl9kZXNjOwo+ID4gPiA+IC0gICAgZ2Jvb2xlYW4gaXNvY19mb3VuZCA9IEZBTFNF
Owo+ID4gPiA+IC0gICAgZ2ludCBpLCBqLCBrOwo+ID4gPiA+IC0KPiA+ID4gPiAtICAgIGdfcmV0
dXJuX3ZhbF9pZl9mYWlsKGxpYmRldiAhPSBOVUxMLCBGQUxTRSk7Cj4gPiA+ID4gLQo+ID4gPiA+
IC0gICAgaWYgKGxpYnVzYl9nZXRfYWN0aXZlX2NvbmZpZ19kZXNjcmlwdG9yKGxpYmRldiwgJmNv
bmZfZGVzYykgIT0gMCkgewo+ID4gPiA+IC0gICAgICAgIGdfcmV0dXJuX3ZhbF9pZl9yZWFjaGVk
KEZBTFNFKTsKPiA+ID4gPiAtICAgIH0KPiA+ID4gPiAtCj4gPiA+ID4gLSAgICBmb3IgKGkgPSAw
OyAhaXNvY19mb3VuZCAmJiBpIDwgY29uZl9kZXNjLT5iTnVtSW50ZXJmYWNlczsgaSsrKSB7Cj4g
PiA+ID4gLSAgICAgICAgZm9yIChqID0gMDsgIWlzb2NfZm91bmQgJiYgaiA8IGNvbmZfZGVzYy0+
aW50ZXJmYWNlW2ldLm51bV9hbHRzZXR0aW5nOyBqKyspIHsKPiA+ID4gPiAtICAgICAgICAgICAg
Zm9yIChrID0gMDsgIWlzb2NfZm91bmQgJiYgayA8IGNvbmZfZGVzYy0+aW50ZXJmYWNlW2ldLmFs
dHNldHRpbmdbal0uYk51bUVuZHBvaW50cztrKyspIHsKPiA+ID4gPiAtICAgICAgICAgICAgICAg
IGdpbnQgYXR0cmlidXRlcyA9IGNvbmZfZGVzYy0+aW50ZXJmYWNlW2ldLmFsdHNldHRpbmdbal0u
ZW5kcG9pbnRba10uYm1BdHRyaWJ1dGVzOwo+ID4gPiA+IC0gICAgICAgICAgICAgICAgZ2ludCB0
eXBlID0gYXR0cmlidXRlcyAmIExJQlVTQl9UUkFOU0ZFUl9UWVBFX01BU0s7Cj4gPiA+ID4gLSAg
ICAgICAgICAgICAgICBpZiAodHlwZSA9PSBMSUJVU0JfVFJBTlNGRVJfVFlQRV9JU09DSFJPTk9V
UykKPiA+ID4gPiAtICAgICAgICAgICAgICAgICAgICBpc29jX2ZvdW5kID0gVFJVRTsKPiA+ID4g
PiAtICAgICAgICAgICAgfQo+ID4gPiA+IC0gICAgICAgIH0KPiA+ID4gPiAtICAgIH0KPiA+ID4g
PiAtCj4gPiA+ID4gLSAgICBsaWJ1c2JfZnJlZV9jb25maWdfZGVzY3JpcHRvcihjb25mX2Rlc2Mp
Owo+ID4gPiA+IC0gICAgcmV0dXJuIGlzb2NfZm91bmQ7Cj4gPiA+ID4gLX0KPiA+ID4gPiAtCj4g
PiA+ID4gIC8qCj4gPiA+ID4gICAqIFNwaWNlVXNiRGV2aWNlSW5mbwo+ID4gPiA+ICAgKi8KPiA+
ID4gPiAtc3RhdGljIFNwaWNlVXNiRGV2aWNlSW5mbyAqc3BpY2VfdXNiX2RldmljZV9uZXcobGli
dXNiX2RldmljZSAqbGliZGV2KQo+ID4gPiA+ICtzdGF0aWMgU3BpY2VVc2JEZXZpY2VJbmZvICpz
cGljZV91c2JfZGV2aWNlX25ldyhTcGljZVVzYkJhY2tlbmREZXZpY2UgKmJkZXYpCj4gPiA+ID4g
IHsKPiA+ID4gPiAgICAgIFNwaWNlVXNiRGV2aWNlSW5mbyAqaW5mbzsKPiA+ID4gPiAtICAgIGlu
dCB2aWQsIHBpZDsKPiA+ID4gPiAtICAgIGd1aW50OCBidXMsIGFkZHI7Cj4gPiA+ID4gLQo+ID4g
PiA+IC0gICAgZ19yZXR1cm5fdmFsX2lmX2ZhaWwobGliZGV2ICE9IE5VTEwsIE5VTEwpOwo+ID4g
PiA+ICsgICAgY29uc3QgVXNiRGV2aWNlSW5mb3JtYXRpb24gKmJkZXZfaW5mbzsKPiA+ID4gPgo+
ID4gPiA+IC0gICAgYnVzID0gbGlidXNiX2dldF9idXNfbnVtYmVyKGxpYmRldik7Cj4gPiA+ID4g
LSAgICBhZGRyID0gbGlidXNiX2dldF9kZXZpY2VfYWRkcmVzcyhsaWJkZXYpOwo+ID4gPiA+ICsg
ICAgZ19yZXR1cm5fdmFsX2lmX2ZhaWwoYmRldiAhPSBOVUxMLCBOVUxMKTsKPiA+ID4gPgo+ID4g
PiA+IC0gICAgaWYgKCFzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfZ2V0X2xpYmRldl92aWRfcGlk
KGxpYmRldiwgJnZpZCwgJnBpZCkpIHsKPiA+ID4gPiAtICAgICAgICByZXR1cm4gTlVMTDsKPiA+
ID4gPiAtICAgIH0KPiA+ID4gPiArICAgIGJkZXZfaW5mbyA9IHNwaWNlX3VzYl9iYWNrZW5kX2Rl
dmljZV9nZXRfaW5mbyhiZGV2KTsKPiA+ID4gPgo+ID4gPiA+ICAgICAgaW5mbyA9IGdfbmV3MChT
cGljZVVzYkRldmljZUluZm8sIDEpOwo+ID4gPiA+Cj4gPiA+ID4gLSAgICBpbmZvLT5idXNudW0g
ID0gYnVzOwo+ID4gPiA+IC0gICAgaW5mby0+ZGV2YWRkciA9IGFkZHI7Cj4gPiA+ID4gLSAgICBp
bmZvLT52aWQgPSB2aWQ7Cj4gPiA+ID4gLSAgICBpbmZvLT5waWQgPSBwaWQ7Cj4gPiA+ID4gKyAg
ICBpbmZvLT5idXNudW0gID0gYmRldl9pbmZvLT5idXM7Cj4gPiA+ID4gKyAgICBpbmZvLT5kZXZh
ZGRyID0gYmRldl9pbmZvLT5hZGRyZXNzOwo+ID4gPiA+ICsgICAgaW5mby0+dmlkID0gYmRldl9p
bmZvLT52aWQ7Cj4gPiA+ID4gKyAgICBpbmZvLT5waWQgPSBiZGV2X2luZm8tPnBpZDsKPiA+ID4g
PiAgICAgIGluZm8tPnJlZiA9IDE7Cj4gPiA+ID4gLSAgICBpbmZvLT5pc29jaHJvbm91cyA9IHBy
b2JlX2lzb2Nocm9ub3VzX2VuZHBvaW50KGxpYmRldik7Cj4gPiA+ID4gLSAgICBpbmZvLT5saWJk
ZXYgPSBsaWJ1c2JfcmVmX2RldmljZShsaWJkZXYpOwo+ID4gPiA+ICsgICAgaW5mby0+YmRldiA9
IHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9yZWYoYmRldik7Cj4gPiA+ID4gKyAgICBpbmZvLT5p
c29jaHJvbm91cyA9IHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9pc29jaChiZGV2KTsKPiA+ID4g
Pgo+ID4gPiA+ICAgICAgcmV0dXJuIGluZm87Cj4gPiA+ID4gIH0KPiA+ID4gPiBAQCAtMTg4NSwz
NSArMTc2MywzNSBAQCBzdGF0aWMgdm9pZCBzcGljZV91c2JfZGV2aWNlX3VucmVmKFNwaWNlVXNi
RGV2aWNlICpkZXZpY2UpCj4gPiA+ID4KPiA+ID4gPiAgICAgIHJlZl9jb3VudF9pc18wID0gZ19h
dG9taWNfaW50X2RlY19hbmRfdGVzdCgmaW5mby0+cmVmKTsKPiA+ID4gPiAgICAgIGlmIChyZWZf
Y291bnRfaXNfMCkgewo+ID4gPiA+IC0gICAgICAgIGxpYnVzYl91bnJlZl9kZXZpY2UoaW5mby0+
bGliZGV2KTsKPiA+ID4gPiArICAgICAgICBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfdW5yZWYo
aW5mby0+YmRldik7Cj4gPiA+ID4gICAgICAgICAgZ19mcmVlKGluZm8pOwo+ID4gPiA+ICAgICAg
fQo+ID4gPiA+ICB9Cj4gPiA+ID4KPiA+ID4gPiAgc3RhdGljIGdib29sZWFuCj4gPiA+ID4gLXNw
aWNlX3VzYl9tYW5hZ2VyX2RldmljZV9lcXVhbF9saWJkZXYoU3BpY2VVc2JEZXZpY2VNYW5hZ2Vy
ICptYW5hZ2VyLAo+ID4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IFNwaWNlVXNiRGV2aWNlICpkZXZpY2UsCj4gPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgbGlidXNiX2RldmljZSAgKmxpYmRldikKPiA+ID4gPiArc3BpY2VfdXNi
X21hbmFnZXJfZGV2aWNlX2VxdWFsX2JkZXYoU3BpY2VVc2JEZXZpY2VNYW5hZ2VyICptYW5hZ2Vy
LAo+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTcGljZVVzYkRl
dmljZSAqZGV2aWNlLAo+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBTcGljZVVzYkJhY2tlbmREZXZpY2UgKmJkZXYpCj4gPiA+ID4gIHsKPiA+ID4gPiAgICAgIFNw
aWNlVXNiRGV2aWNlSW5mbyAqaW5mbyA9IChTcGljZVVzYkRldmljZUluZm8gKilkZXZpY2U7Cj4g
PiA+ID4KPiA+ID4gPiAtICAgIGlmICgoZGV2aWNlID09IE5VTEwpIHx8IChsaWJkZXYgPT0gTlVM
TCkpCj4gPiA+ID4gKyAgICBpZiAoKGRldmljZSA9PSBOVUxMKSB8fCAoYmRldiA9PSBOVUxMKSkK
PiA+ID4gPiAgICAgICAgICByZXR1cm4gRkFMU0U7Cj4gPiA+ID4KPiA+ID4gPiAtICAgIHJldHVy
biBpbmZvLT5saWJkZXYgPT0gbGliZGV2Owo+ID4gPiA+ICsgICAgcmV0dXJuIGluZm8tPmJkZXYg
PT0gYmRldjsKPiA+ID4gPiAgfQo+ID4gPiA+Cj4gPiA+ID4gIC8qCj4gPiA+ID4gICAqIENhbGxl
ciBtdXN0IGxpYnVzYl91bnJlZl9kZXZpY2UgdGhlIGxpYnVzYl9kZXZpY2UgcmV0dXJuZWQgYnkg
dGhpcyBmdW5jdGlvbi4KPiA+ID4gPiAgICogUmV0dXJucyBhIGxpYnVzYl9kZXZpY2UsIG9yIE5V
TEwgdXBvbiBmYWlsdXJlCj4gPiA+ID4gICAqLwo+ID4gPiA+IC1zdGF0aWMgbGlidXNiX2Rldmlj
ZSAqCj4gPiA+ID4gLXNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9kZXZpY2VfdG9fbGliZGV2KFNw
aWNlVXNiRGV2aWNlTWFuYWdlciAqc2VsZiwKPiA+ID4gPiAtICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgU3BpY2VVc2JEZXZpY2UgKmRldmljZSkKPiA+ID4gPiArc3Rh
dGljIFNwaWNlVXNiQmFja2VuZERldmljZSAqCj4gPiA+ID4gK3NwaWNlX3VzYl9kZXZpY2VfbWFu
YWdlcl9kZXZpY2VfdG9fYmRldihTcGljZVVzYkRldmljZU1hbmFnZXIgKnNlbGYsCj4gPiA+ID4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTcGljZVVzYkRldmljZSAq
ZGV2aWNlKQo+ID4gPiA+ICB7Cj4gPiA+ID4gICAgICAvKiBTaW1wbHkgcmV0dXJuIGEgcmVmIHRv
IHRoZSBjYWNoZWQgbGliZGV2ICovCj4gPiA+ID4gICAgICBTcGljZVVzYkRldmljZUluZm8gKmlu
Zm8gPSAoU3BpY2VVc2JEZXZpY2VJbmZvICopZGV2aWNlOwo+ID4gPiA+Cj4gPiA+ID4gLSAgICBy
ZXR1cm4gbGlidXNiX3JlZl9kZXZpY2UoaW5mby0+bGliZGV2KTsKPiA+ID4gPiArICAgIHJldHVy
biBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfcmVmKGluZm8tPmJkZXYpOwo+ID4gPiA+ICB9Cj4g
PiA+ID4gICNlbmRpZiAvKiBVU0VfVVNCUkVESVIgKi8KPiA+ID4gPiBkaWZmIC0tZ2l0IGEvc3Jj
L3VzYnV0aWwuYyBiL3NyYy91c2J1dGlsLmMKPiA+ID4gPiBpbmRleCA0YWE2ZWY3Li41MDUyZWYz
IDEwMDY0NAo+ID4gPiA+IC0tLSBhL3NyYy91c2J1dGlsLmMKPiA+ID4gPiArKysgYi9zcmMvdXNi
dXRpbC5jCj4gPiA+ID4gQEAgLTU4LDEyICs1OCw2IEBAIHN0YXRpYyBHTXV0ZXggdXNiaWRzX2xv
YWRfbXV0ZXg7Cj4gPiA+ID4gIHN0YXRpYyBpbnQgdXNiaWRzX3ZlbmRvcl9jb3VudCA9IDA7IC8q
IDwgMDogZmFpbGVkLCAwOiBlbXB0eSwgPiAwOiBsb2FkZWQgKi8KPiA+ID4gPiAgc3RhdGljIHVz
Yl92ZW5kb3JfaW5mbyAqdXNiaWRzX3ZlbmRvcl9pbmZvID0gTlVMTDsKPiA+ID4gPgo+ID4gPiA+
IC1HX0dOVUNfSU5URVJOQUwKPiA+ID4gPiAtY29uc3QgY2hhciAqc3BpY2VfdXNidXRpbF9saWJ1
c2Jfc3RyZXJyb3IoZW51bSBsaWJ1c2JfZXJyb3IgZXJyb3JfY29kZSkKPiA+ID4gPiAtewo+ID4g
PiA+IC0gICAgcmV0dXJuIGxpYnVzYl9lcnJvcl9uYW1lKGVycm9yX2NvZGUpOwo+ID4gPiA+IC19
Cj4gPiA+ID4gLQo+ID4gPiA+ICAjaWZkZWYgX19saW51eF9fCj4gPiA+ID4gIC8qIDxTaWdoPiBs
aWJ1c2IgZG9lcyBub3QgYWxsb3cgZ2V0dGluZyB0aGUgbWFudWZhY3R1cmVyIGFuZCBwcm9kdWN0
IHN0cmluZ3MKPiA+ID4gPiAgICAgd2l0aG91dCBvcGVuaW5nIHRoZSBkZXZpY2UsIHNvIGdyYWIg
dGhlbSBkaXJlY3RseSBmcm9tIHN5c2ZzICovCj4gPiA+ID4gZGlmZiAtLWdpdCBhL3NyYy91c2J1
dGlsLmggYi9zcmMvdXNidXRpbC5oCj4gPiA+ID4gaW5kZXggZGU1ZTkyYS4uZDE4ZDY4OCAxMDA2
NDQKPiA+ID4gPiAtLS0gYS9zcmMvdXNidXRpbC5oCj4gPiA+ID4gKysrIGIvc3JjL3VzYnV0aWwu
aAo+ID4gPiA+IEBAIC0yNCwxMSArMjQsOSBAQAo+ID4gPiA+ICAjaW5jbHVkZSA8Z2xpYi5oPgo+
ID4gPiA+Cj4gPiA+ID4gICNpZmRlZiBVU0VfVVNCUkVESVIKPiA+ID4gPiAtI2luY2x1ZGUgPGxp
YnVzYi5oPgo+ID4gPiA+Cj4gPiA+ID4gIEdfQkVHSU5fREVDTFMKPiA+ID4gPgo+ID4gPiA+IC1j
b25zdCBjaGFyICpzcGljZV91c2J1dGlsX2xpYnVzYl9zdHJlcnJvcihlbnVtIGxpYnVzYl9lcnJv
ciBlcnJvcl9jb2RlKTsKPiA+ID4gPiAgdm9pZCBzcGljZV91c2JfdXRpbF9nZXRfZGV2aWNlX3N0
cmluZ3MoaW50IGJ1cywgaW50IGFkZHJlc3MsCj4gPiA+ID4gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGludCB2ZW5kb3JfaWQsIGludCBwcm9kdWN0X2lkLAo+ID4gPiA+
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnY2hhciAqKm1hbnVmYWN0
dXJlciwgZ2NoYXIgKipwcm9kdWN0KTsKPiA+ID4gPiBkaWZmIC0tZ2l0IGEvc3JjL3dpbi11c2It
ZGV2LmMgYi9zcmMvd2luLXVzYi1kZXYuYwo+ID4gPiA+IGluZGV4IGE0ZGZhNzguLmMyYTUxMTUg
MTAwNjQ0Cj4gPiA+ID4gLS0tIGEvc3JjL3dpbi11c2ItZGV2LmMKPiA+ID4gPiArKysgYi9zcmMv
d2luLXVzYi1kZXYuYwo+ID4gPiA+IEBAIC0yMywxMSArMjMsOSBAQAo+ID4gPiA+ICAjaW5jbHVk
ZSAiY29uZmlnLmgiCj4gPiA+ID4KPiA+ID4gPiAgI2luY2x1ZGUgPHdpbmRvd3MuaD4KPiA+ID4g
PiAtI2luY2x1ZGUgPGxpYnVzYi5oPgo+ID4gPiA+ICAjaW5jbHVkZSAid2luLXVzYi1kZXYuaCIK
PiA+ID4gPiAgI2luY2x1ZGUgInNwaWNlLW1hcnNoYWwuaCIKPiA+ID4gPiAgI2luY2x1ZGUgInNw
aWNlLXV0aWwuaCIKPiA+ID4gPiAtI2luY2x1ZGUgInVzYnV0aWwuaCIKPiA+ID4gPgo+ID4gPiA+
ICBlbnVtIHsKPiA+ID4gPiAgICAgIFBST1BfMCwKPiA+ID4gPiBAQCAtMzUsNyArMzMsNyBAQCBl
bnVtIHsKPiA+ID4gPiAgfTsKPiA+ID4gPgo+ID4gPiA+ICBzdHJ1Y3QgX0dVZGV2Q2xpZW50UHJp
dmF0ZSB7Cj4gPiA+ID4gLSAgICBsaWJ1c2JfY29udGV4dCAqY3R4Owo+ID4gPiA+ICsgICAgU3Bp
Y2VVc2JCYWNrZW5kICpjdHg7Cj4gPiA+ID4gICAgICBHTGlzdCAqdWRldl9saXN0Owo+ID4gPiA+
ICAgICAgSFdORCBod25kOwo+ID4gPiA+ICAgICAgZ2Jvb2xlYW4gcmVkaXJlY3Rpbmc7Cj4gPiA+
ID4gQEAgLTY4LDkgKzY2LDcgQEAgc3RhdGljIHZvaWQgZ191ZGV2X2RldmljZV9wcmludF9saXN0
KEdMaXN0ICpsLCBjb25zdCBnY2hhciAqbXNnKTsKPiA+ID4gPiAgI2Vsc2UKPiA+ID4gPiAgc3Rh
dGljIHZvaWQgZ191ZGV2X2RldmljZV9wcmludF9saXN0KEdMaXN0ICpsLCBjb25zdCBnY2hhciAq
bXNnKSB7fQo+ID4gPiA+ICAjZW5kaWYKPiA+ID4gPiAtc3RhdGljIHZvaWQgZ191ZGV2X2Rldmlj
ZV9wcmludChsaWJ1c2JfZGV2aWNlICpkZXYsIGNvbnN0IGdjaGFyICptc2cpOwo+ID4gPiA+IC0K
PiA+ID4gPiAtc3RhdGljIGdib29sZWFuIGdfdWRldl9za2lwX3NlYXJjaChsaWJ1c2JfZGV2aWNl
ICpkZXYpOwo+ID4gPiA+ICtzdGF0aWMgdm9pZCBnX3VkZXZfZGV2aWNlX3ByaW50KFNwaWNlVXNi
QmFja2VuZERldmljZSAqZGV2LCBjb25zdCBnY2hhciAqbXNnKTsKPiA+ID4gPgo+ID4gPiA+ICBH
UXVhcmsgZ191ZGV2X2NsaWVudF9lcnJvcl9xdWFyayh2b2lkKQo+ID4gPiA+ICB7Cj4gPiA+ID4g
QEAgLTg2LDcgKzgyLDcgQEAgR1VkZXZDbGllbnQgKmdfdWRldl9jbGllbnRfbmV3KHZvaWQpCj4g
PiA+ID4gICAgICByZXR1cm4gc2luZ2xldG9uOwo+ID4gPiA+ICB9Cj4gPiA+ID4KPiA+ID4gPiAt
bGlidXNiX2NvbnRleHQgKmdfdWRldl9jbGllbnRfZ2V0X2NvbnRleHQoR1VkZXZDbGllbnQgKmNs
aWVudCkKPiA+ID4gPiArU3BpY2VVc2JCYWNrZW5kICpnX3VkZXZfY2xpZW50X2dldF9jb250ZXh0
KEdVZGV2Q2xpZW50ICpjbGllbnQpCj4gPiA+ID4gIHsKPiA+ID4gPiAgICAgIHJldHVybiBjbGll
bnQtPnByaXYtPmN0eDsKPiA+ID4gPiAgfQo+ID4gPiA+IEBAIC05OSw4ICs5NSw3IEBAIHN0YXRp
YyBzc2l6ZV90Cj4gPiA+ID4gIGdfdWRldl9jbGllbnRfbGlzdF9kZXZpY2VzKEdVZGV2Q2xpZW50
ICpzZWxmLCBHTGlzdCAqKmRldnMsCj4gPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAg
IEdFcnJvciAqKmVyciwgY29uc3QgZ2NoYXIgKm5hbWUpCj4gPiA+ID4gIHsKPiA+ID4gPiAtICAg
IGdzc2l6ZSByYzsKPiA+ID4gPiAtICAgIGxpYnVzYl9kZXZpY2UgKipsdXNiX2xpc3QsICoqZGV2
Owo+ID4gPiA+ICsgICAgU3BpY2VVc2JCYWNrZW5kRGV2aWNlICoqbHVzYl9saXN0LCAqKmRldjsK
PiA+ID4gPiAgICAgIEdVZGV2Q2xpZW50UHJpdmF0ZSAqcHJpdjsKPiA+ID4gPiAgICAgIHNzaXpl
X3QgbjsKPiA+ID4gPgo+ID4gPiA+IEBAIC0xMTEsNDMgKzEwNiwzMyBAQCBnX3VkZXZfY2xpZW50
X2xpc3RfZGV2aWNlcyhHVWRldkNsaWVudCAqc2VsZiwgR0xpc3QgKipkZXZzLAo+ID4gPiA+Cj4g
PiA+ID4gICAgICBnX3JldHVybl92YWxfaWZfZmFpbChzZWxmLT5wcml2LT5jdHggIT0gTlVMTCwg
LTMpOwo+ID4gPiA+Cj4gPiA+ID4gLSAgICByYyA9IGxpYnVzYl9nZXRfZGV2aWNlX2xpc3QocHJp
di0+Y3R4LCAmbHVzYl9saXN0KTsKPiA+ID4gPiAtICAgIGlmIChyYyA8IDApIHsKPiA+ID4gPiAt
ICAgICAgICBjb25zdCBjaGFyICplcnJzdHIgPSBzcGljZV91c2J1dGlsX2xpYnVzYl9zdHJlcnJv
cihyYyk7Cj4gPiA+ID4gLSAgICAgICAgZ193YXJuaW5nKCIlczogbGlidXNiX2dldF9kZXZpY2Vf
bGlzdCBmYWlsZWQgLSAlcyIsIG5hbWUsIGVycnN0cik7Cj4gPiA+ID4gKyAgICBsdXNiX2xpc3Qg
PSBzcGljZV91c2JfYmFja2VuZF9nZXRfZGV2aWNlX2xpc3QocHJpdi0+Y3R4KTsKPiA+ID4gPiAr
ICAgIGlmICghbHVzYl9saXN0KSB7Cj4gPiA+ID4gICAgICAgICAgZ19zZXRfZXJyb3IoZXJyLCBH
X1VERVZfQ0xJRU5UX0VSUk9SLCBHX1VERVZfQ0xJRU5UX0xJQlVTQl9GQUlMRUQsCj4gPiA+ID4g
LSAgICAgICAgICAgICAgICAgICAgIiVzOiBFcnJvciBnZXR0aW5nIGRldmljZSBsaXN0IGZyb20g
bGlidXNiOiAlcyBbJSJHX0dTU0laRV9GT1JNQVQiXSIsCj4gPiA+ID4gLSAgICAgICAgICAgICAg
ICAgICAgbmFtZSwgZXJyc3RyLCByYyk7Cj4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgIiVz
OiBFcnJvciBnZXR0aW5nIFVTQiBkZXZpY2UgbGlzdCIsIG5hbWUpOwo+ID4gPiA+ICAgICAgICAg
IHJldHVybiAtNDsKPiA+ID4gPiAgICAgIH0KPiA+ID4gPgo+ID4gPiA+ICAgICAgbiA9IDA7Cj4g
PiA+ID4gICAgICBmb3IgKGRldiA9IGx1c2JfbGlzdDsgKmRldjsgZGV2KyspIHsKPiA+ID4gPiAt
ICAgICAgICBpZiAoZ191ZGV2X3NraXBfc2VhcmNoKCpkZXYpKSB7Cj4gPiA+ID4gLSAgICAgICAg
ICAgIGNvbnRpbnVlOwo+ID4gPiA+IC0gICAgICAgIH0KPiA+ID4gPiAtICAgICAgICAqZGV2cyA9
IGdfbGlzdF9wcmVwZW5kKCpkZXZzLCBsaWJ1c2JfcmVmX2RldmljZSgqZGV2KSk7Cj4gPiA+ID4g
KyAgICAgICAgKmRldnMgPSBnX2xpc3RfcHJlcGVuZCgqZGV2cywgc3BpY2VfdXNiX2JhY2tlbmRf
ZGV2aWNlX3JlZigqZGV2KSk7Cj4gPiA+ID4gICAgICAgICAgbisrOwo+ID4gPiA+ICAgICAgfQo+
ID4gPiA+IC0gICAgbGlidXNiX2ZyZWVfZGV2aWNlX2xpc3QobHVzYl9saXN0LCAxKTsKPiA+ID4g
PiArICAgIHNwaWNlX3VzYl9iYWNrZW5kX2ZyZWVfZGV2aWNlX2xpc3QobHVzYl9saXN0KTsKPiA+
ID4gPgo+ID4gPiA+ICAgICAgcmV0dXJuIG47Cj4gPiA+ID4gIH0KPiA+ID4gPgo+ID4gPiA+IC1z
dGF0aWMgdm9pZCB1bnJlZmVyZW5jZV9saWJ1c2JfZGV2aWNlKGdwb2ludGVyIGRhdGEpCj4gPiA+
ID4gK3N0YXRpYyB2b2lkIHVucmVmZXJlbmNlX2JhY2tlbmRfZGV2aWNlKGdwb2ludGVyIGRhdGEp
Cj4gPiA+ID4gIHsKPiA+ID4gPiAtICAgIGxpYnVzYl91bnJlZl9kZXZpY2UoKGxpYnVzYl9kZXZp
Y2UgKilkYXRhKTsKPiA+ID4gPiArICAgIHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV91bnJlZigo
U3BpY2VVc2JCYWNrZW5kRGV2aWNlICopZGF0YSk7Cj4gPiA+ID4gIH0KPiA+ID4gPgo+ID4gPiA+
ICBzdGF0aWMgdm9pZCBnX3VkZXZfY2xpZW50X2ZyZWVfZGV2aWNlX2xpc3QoR0xpc3QgKipkZXZz
KQo+ID4gPiA+ICB7Cj4gPiA+ID4gICAgICBnX3JldHVybl9pZl9mYWlsKGRldnMgIT0gTlVMTCk7
Cj4gPiA+ID4gICAgICBpZiAoKmRldnMpIHsKPiA+ID4gPiAtICAgICAgICAvKiB0aGUgdW5yZWZl
cmVuY2VfbGlidXNiX2RldmljZSBtZXRob2QgaXMgcmVxdWlyZWQgYXMKPiA+ID4gPiAtICAgICAg
ICAgKiBsaWJ1c2JfdW5yZWZfZGV2aWNlIGNhbGxpbmcgY29udmVudGlvbiBkaWZmZXJzIGZyb20g
Z2xpYidzCj4gPiA+ID4gLSAgICAgICAgICogc2VlIDU1OGM5NjdlYwo+ID4gPiA+IC0gICAgICAg
ICAqLwo+ID4gPiA+IC0gICAgICAgIGdfbGlzdF9mcmVlX2Z1bGwoKmRldnMsIHVucmVmZXJlbmNl
X2xpYnVzYl9kZXZpY2UpOwo+ID4gPiA+ICsgICAgICAgIGdfbGlzdF9mcmVlX2Z1bGwoKmRldnMs
IHVucmVmZXJlbmNlX2JhY2tlbmRfZGV2aWNlKTsKPiA+ID4gPiAgICAgICAgICAqZGV2cyA9IE5V
TEw7Cj4gPiA+ID4gICAgICB9Cj4gPiA+ID4gIH0KPiA+ID4gPiBAQCAtMTYwLDcgKzE0NSw2IEBA
IGdfdWRldl9jbGllbnRfaW5pdGFibGVfaW5pdChHSW5pdGFibGUgKmluaXRhYmxlLCBHQ2FuY2Vs
bGFibGUgKmNhbmNlbGxhYmxlLAo+ID4gPiA+ICAgICAgR1VkZXZDbGllbnQgKnNlbGY7Cj4gPiA+
ID4gICAgICBHVWRldkNsaWVudFByaXZhdGUgKnByaXY7Cj4gPiA+ID4gICAgICBXTkRDTEFTUyB3
Y2xzOwo+ID4gPiA+IC0gICAgaW50IHJjOwo+ID4gPiA+Cj4gPiA+ID4gICAgICBnX3JldHVybl92
YWxfaWZfZmFpbChHX1VERVZfSVNfQ0xJRU5UKGluaXRhYmxlKSwgRkFMU0UpOwo+ID4gPiA+ICAg
ICAgZ19yZXR1cm5fdmFsX2lmX2ZhaWwoY2FuY2VsbGFibGUgPT0gTlVMTCwgRkFMU0UpOwo+ID4g
PiA+IEBAIC0xNjgsMTQgKzE1MiwxMSBAQCBnX3VkZXZfY2xpZW50X2luaXRhYmxlX2luaXQoR0lu
aXRhYmxlICppbml0YWJsZSwgR0NhbmNlbGxhYmxlICpjYW5jZWxsYWJsZSwKPiA+ID4gPiAgICAg
IHNlbGYgPSBHX1VERVZfQ0xJRU5UKGluaXRhYmxlKTsKPiA+ID4gPiAgICAgIHByaXYgPSBzZWxm
LT5wcml2Owo+ID4gPiA+Cj4gPiA+ID4gLSAgICByYyA9IGxpYnVzYl9pbml0KCZwcml2LT5jdHgp
Owo+ID4gPiA+IC0gICAgaWYgKHJjIDwgMCkgewo+ID4gPiA+IC0gICAgICAgIGNvbnN0IGNoYXIg
KmVycnN0ciA9IHNwaWNlX3VzYnV0aWxfbGlidXNiX3N0cmVycm9yKHJjKTsKPiA+ID4gPiAtICAg
ICAgICBnX3dhcm5pbmcoIkVycm9yIGluaXRpYWxpemluZyBVU0Igc3VwcG9ydDogJXMgWyVpXSIs
IGVycnN0ciwgcmMpOwo+ID4gPiA+IC0gICAgICAgIGdfc2V0X2Vycm9yKGVyciwgR19VREVWX0NM
SUVOVF9FUlJPUiwgR19VREVWX0NMSUVOVF9MSUJVU0JfRkFJTEVELAo+ID4gPiA+IC0gICAgICAg
ICAgICAgICAgICAgICJFcnJvciBpbml0aWFsaXppbmcgVVNCIHN1cHBvcnQ6ICVzIFslaV0iLCBl
cnJzdHIsIHJjKTsKPiA+ID4gPiArICAgIHByaXYtPmN0eCA9IHNwaWNlX3VzYl9iYWNrZW5kX25l
dyhlcnIpOwo+ID4gPiA+ICsgICAgaWYgKCFwcml2LT5jdHgpIHsKPiA+ID4gPiAgICAgICAgICBy
ZXR1cm4gRkFMU0U7Cj4gPiA+ID4gICAgICB9Cj4gPiA+ID4gKwo+ID4gPiA+ICAjaWZkZWYgR19P
U19XSU4zMgo+ID4gPiA+ICAjaWYgTElCVVNCX0FQSV9WRVJTSU9OID49IDB4MDEwMDAxMDYKPiA+
ID4gPiAgICAgIGxpYnVzYl9zZXRfb3B0aW9uKHByaXYtPmN0eCwgTElCVVNCX09QVElPTl9VU0Vf
VVNCREspOwo+ID4gPiA+IEBAIC0yNDgsOSArMjI5LDkgQEAgc3RhdGljIHZvaWQgZ191ZGV2X2Ns
aWVudF9maW5hbGl6ZShHT2JqZWN0ICpnb2JqZWN0KQo+ID4gPiA+ICAgICAgVW5yZWdpc3RlckNs
YXNzKEdfVURFVl9DTElFTlRfV0lOQ0xBU1NfTkFNRSwgTlVMTCk7Cj4gPiA+ID4gICAgICBnX3Vk
ZXZfY2xpZW50X2ZyZWVfZGV2aWNlX2xpc3QoJnByaXYtPnVkZXZfbGlzdCk7Cj4gPiA+ID4KPiA+
ID4gPiAtICAgIC8qIGZyZWUgbGlidXNiIGNvbnRleHQgaW5pdGlhbGl6aW5nIGJ5IGxpYnVzYl9p
bml0KCkgKi8KPiA+ID4gPiArICAgIC8qIGZyZWUgYmFja2VuZCBjb250ZXh0ICovCj4gPiA+ID4g
ICAgICBnX3dhcm5faWZfZmFpbChwcml2LT5jdHggIT0gTlVMTCk7Cj4gPiA+ID4gLSAgICBsaWJ1
c2JfZXhpdChwcml2LT5jdHgpOwo+ID4gPiA+ICsgICAgc3BpY2VfdXNiX2JhY2tlbmRfZGVsZXRl
KHByaXYtPmN0eCk7Cj4gPiA+ID4KPiA+ID4gPiAgICAgIC8qIENoYWluIHVwIHRvIHRoZSBwYXJl
bnQgY2xhc3MgKi8KPiA+ID4gPiAgICAgIGlmIChHX09CSkVDVF9DTEFTUyhnX3VkZXZfY2xpZW50
X3BhcmVudF9jbGFzcyktPmZpbmFsaXplKQo+ID4gPiA+IEBAIC0zNDAsMjAgKzMyMSwxOCBAQCBz
dGF0aWMgdm9pZCBnX3VkZXZfY2xpZW50X2NsYXNzX2luaXQoR1VkZXZDbGllbnRDbGFzcyAqa2xh
c3MpCj4gPiA+ID4gIH0KPiA+ID4gPgo+ID4gPiA+ICAvKiBjb21wYXJpbmcgYnVzOmFkZHIgYW5k
IHZpZDpwaWQgKi8KPiA+ID4gPiAtc3RhdGljIGdpbnQgY29tcGFyZV9saWJ1c2JfZGV2aWNlcyhn
Y29uc3Rwb2ludGVyIGEsIGdjb25zdHBvaW50ZXIgYikKPiA+ID4gPiArc3RhdGljIGdpbnQgY29t
cGFyZV91c2JfZGV2aWNlcyhnY29uc3Rwb2ludGVyIGEsIGdjb25zdHBvaW50ZXIgYikKPiA+ID4g
PiAgewo+ID4gPiA+IC0gICAgbGlidXNiX2RldmljZSAqYV9kZXYgPSAobGlidXNiX2RldmljZSAq
KWE7Cj4gPiA+ID4gLSAgICBsaWJ1c2JfZGV2aWNlICpiX2RldiA9IChsaWJ1c2JfZGV2aWNlICop
YjsKPiA+ID4gPiAtICAgIHN0cnVjdCBsaWJ1c2JfZGV2aWNlX2Rlc2NyaXB0b3IgYV9kZXNjLCBi
X2Rlc2M7Cj4gPiA+ID4gKyAgICBjb25zdCBVc2JEZXZpY2VJbmZvcm1hdGlvbiAqYV9pbmZvLCAq
Yl9pbmZvOwo+ID4gPiA+ICAgICAgZ2Jvb2xlYW4gc2FtZV9idXMsIHNhbWVfYWRkciwgc2FtZV92
aWQsIHNhbWVfcGlkOwo+ID4gPiA+ICsgICAgYV9pbmZvID0gc3BpY2VfdXNiX2JhY2tlbmRfZGV2
aWNlX2dldF9pbmZvKChTcGljZVVzYkJhY2tlbmREZXZpY2UgKilhKTsKPiA+ID4gPiArICAgIGJf
aW5mbyA9IHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9nZXRfaW5mbygoU3BpY2VVc2JCYWNrZW5k
RGV2aWNlICopYik7Cj4gPiA+ID4KPiA+ID4gPiAtICAgIGxpYnVzYl9nZXRfZGV2aWNlX2Rlc2Ny
aXB0b3IoYV9kZXYsICZhX2Rlc2MpOwo+ID4gPiA+IC0gICAgbGlidXNiX2dldF9kZXZpY2VfZGVz
Y3JpcHRvcihiX2RldiwgJmJfZGVzYyk7Cj4gPiA+ID4KPiA+ID4gPiAtICAgIHNhbWVfYnVzID0g
KGxpYnVzYl9nZXRfYnVzX251bWJlcihhX2RldikgPT0gbGlidXNiX2dldF9idXNfbnVtYmVyKGJf
ZGV2KSk7Cj4gPiA+ID4gLSAgICBzYW1lX2FkZHIgPSAobGlidXNiX2dldF9kZXZpY2VfYWRkcmVz
cyhhX2RldikgPT0gbGlidXNiX2dldF9kZXZpY2VfYWRkcmVzcyhiX2RldikpOwo+ID4gPiA+IC0g
ICAgc2FtZV92aWQgPSAoYV9kZXNjLmlkVmVuZG9yID09IGJfZGVzYy5pZFZlbmRvcik7Cj4gPiA+
ID4gLSAgICBzYW1lX3BpZCA9IChhX2Rlc2MuaWRQcm9kdWN0ID09IGJfZGVzYy5pZFByb2R1Y3Qp
Owo+ID4gPiA+ICsgICAgc2FtZV9idXMgPSAoYV9pbmZvLT5idXMgPT0gYl9pbmZvLT5idXMpOwo+
ID4gPiA+ICsgICAgc2FtZV9hZGRyID0gKGFfaW5mby0+YWRkcmVzcyA9PSBiX2luZm8tPmFkZHJl
c3MpOwo+ID4gPiA+ICsgICAgc2FtZV92aWQgPSAoYV9pbmZvLT52aWQgPT0gYl9pbmZvLT52aWQp
Owo+ID4gPiA+ICsgICAgc2FtZV9waWQgPSAoYV9pbmZvLT5waWQgPT0gYl9pbmZvLT5waWQpOwo+
ID4gPiA+Cj4gPiA+ID4gICAgICByZXR1cm4gKHNhbWVfYnVzICYmIHNhbWVfYWRkciAmJiBzYW1l
X3ZpZCAmJiBzYW1lX3BpZCkgPyAwIDogLTE7Cj4gPiA+ID4gIH0KPiA+ID4gPiBAQCAtMzYzLDEy
ICszNDIsMTIgQEAgc3RhdGljIHZvaWQgdXBkYXRlX2RldmljZV9saXN0KEdVZGV2Q2xpZW50ICpz
ZWxmLCBHTGlzdCAqbmV3X2RldmljZV9saXN0KQo+ID4gPiA+ICAgICAgR0xpc3QgKmRldjsKPiA+
ID4gPgo+ID4gPiA+ICAgICAgZm9yIChkZXYgPSBnX2xpc3RfZmlyc3QobmV3X2RldmljZV9saXN0
KTsgZGV2ICE9IE5VTEw7IGRldiA9IGdfbGlzdF9uZXh0KGRldikpIHsKPiA+ID4gPiAtICAgICAg
ICBHTGlzdCAqZm91bmQgPSBnX2xpc3RfZmluZF9jdXN0b20oc2VsZi0+cHJpdi0+dWRldl9saXN0
LCBkZXYtPmRhdGEsIGNvbXBhcmVfbGlidXNiX2RldmljZXMpOwo+ID4gPiA+ICsgICAgICAgIEdM
aXN0ICpmb3VuZCA9IGdfbGlzdF9maW5kX2N1c3RvbShzZWxmLT5wcml2LT51ZGV2X2xpc3QsIGRl
di0+ZGF0YSwgY29tcGFyZV91c2JfZGV2aWNlcyk7Cj4gPiA+ID4gICAgICAgICAgaWYgKGZvdW5k
ICE9IE5VTEwpIHsKPiA+ID4gPiAgICAgICAgICAgICAgLyoga2VlcCBvbGQgZXhpc3RpbmcgbGli
dXNiX2RldmljZSBpbiB0aGUgbmV3IGxpc3QsIHdoZW4KPiA+ID4gPiAgICAgICAgICAgICAgICAg
dXNiLWRldi1tYW5hZ2VyIHdpbGwgbWFpbnRhaW4gaXRzIG93biBsaXN0IG9mIGxpYnVzYl9kZXZp
Y2UsCj4gPiA+ID4gICAgICAgICAgICAgICAgIHRoZXNlIGxpc3RzIHdpbGwgYmUgY29tcGxldGVs
eSBjb25zaXN0ZW50ICovCj4gPiA+ID4gLSAgICAgICAgICAgIGxpYnVzYl9kZXZpY2UgKnRlbXAg
PSBmb3VuZC0+ZGF0YTsKPiA+ID4gPiArICAgICAgICAgICAgU3BpY2VVc2JCYWNrZW5kRGV2aWNl
ICp0ZW1wID0gZm91bmQtPmRhdGE7Cj4gPiA+ID4gICAgICAgICAgICAgIGZvdW5kLT5kYXRhID0g
ZGV2LT5kYXRhOwo+ID4gPiA+ICAgICAgICAgICAgICBkZXYtPmRhdGEgPSB0ZW1wOwo+ID4gPiA+
ICAgICAgICAgIH0KPiA+ID4gPiBAQCAtMzg2LDcgKzM2NSw3IEBAIHN0YXRpYyB2b2lkIG5vdGlm
eV9kZXZfc3RhdGVfY2hhbmdlKEdVZGV2Q2xpZW50ICpzZWxmLAo+ID4gPiA+ICAgICAgR0xpc3Qg
KmRldjsKPiA+ID4gPgo+ID4gPiA+ICAgICAgZm9yIChkZXYgPSBnX2xpc3RfZmlyc3Qob2xkX2xp
c3QpOyBkZXYgIT0gTlVMTDsgZGV2ID0gZ19saXN0X25leHQoZGV2KSkgewo+ID4gPiA+IC0gICAg
ICAgIEdMaXN0ICpmb3VuZCA9IGdfbGlzdF9maW5kX2N1c3RvbShuZXdfbGlzdCwgZGV2LT5kYXRh
LCBjb21wYXJlX2xpYnVzYl9kZXZpY2VzKTsKPiA+ID4gPiArICAgICAgICBHTGlzdCAqZm91bmQg
PSBnX2xpc3RfZmluZF9jdXN0b20obmV3X2xpc3QsIGRldi0+ZGF0YSwgY29tcGFyZV91c2JfZGV2
aWNlcyk7Cj4gPiA+ID4gICAgICAgICAgaWYgKGZvdW5kID09IE5VTEwpIHsKPiA+ID4gPiAgICAg
ICAgICAgICAgZ191ZGV2X2RldmljZV9wcmludChkZXYtPmRhdGEsIGFkZCA/ICJhZGQiIDogInJl
bW92ZSIpOwo+ID4gPiA+ICAgICAgICAgICAgICBnX3NpZ25hbF9lbWl0KHNlbGYsIHNpZ25hbHNb
VUVWRU5UX1NJR05BTF0sIDAsIGRldi0+ZGF0YSwgYWRkKTsKPiA+ID4gPiBAQCAtNDQ3LDI5ICs0
MjYsMTEgQEAgc3RhdGljIHZvaWQgZ191ZGV2X2RldmljZV9wcmludF9saXN0KEdMaXN0ICpsLCBj
b25zdCBnY2hhciAqbXNnKQo+ID4gPiA+ICB9Cj4gPiA+ID4gICNlbmRpZgo+ID4gPiA+Cj4gPiA+
ID4gLXN0YXRpYyB2b2lkIGdfdWRldl9kZXZpY2VfcHJpbnQobGlidXNiX2RldmljZSAqZGV2LCBj
b25zdCBnY2hhciAqbXNnKQo+ID4gPiA+ICtzdGF0aWMgdm9pZCBnX3VkZXZfZGV2aWNlX3ByaW50
KFNwaWNlVXNiQmFja2VuZERldmljZSAqZGV2LCBjb25zdCBnY2hhciAqbXNnKQo+ID4gPiA+ICB7
Cj4gPiA+ID4gLSAgICBzdHJ1Y3QgbGlidXNiX2RldmljZV9kZXNjcmlwdG9yIGRlc2M7Cj4gPiA+
ID4gLQo+ID4gPiA+IC0gICAgbGlidXNiX2dldF9kZXZpY2VfZGVzY3JpcHRvcihkZXYsICZkZXNj
KTsKPiA+ID4gPiArICAgIGNvbnN0IFVzYkRldmljZUluZm9ybWF0aW9uICppbmZvID0gc3BpY2Vf
dXNiX2JhY2tlbmRfZGV2aWNlX2dldF9pbmZvKGRldik7Cj4gPiA+ID4KPiA+ID4gPiAgICAgIFNQ
SUNFX0RFQlVHKCIlczogJWQuJWQgMHglMDR4OjB4JTA0eCBjbGFzcyAlZCIsIG1zZywKPiA+ID4g
PiAtICAgICAgICAgICAgICAgIGxpYnVzYl9nZXRfYnVzX251bWJlcihkZXYpLAo+ID4gPiA+IC0g
ICAgICAgICAgICAgICAgbGlidXNiX2dldF9kZXZpY2VfYWRkcmVzcyhkZXYpLAo+ID4gPiA+IC0g
ICAgICAgICAgICAgICAgZGVzYy5pZFZlbmRvciwgZGVzYy5pZFByb2R1Y3QsIGRlc2MuYkRldmlj
ZUNsYXNzKTsKPiA+ID4gPiAtfQo+ID4gPiA+IC0KPiA+ID4gPiAtc3RhdGljIGdib29sZWFuIGdf
dWRldl9za2lwX3NlYXJjaChsaWJ1c2JfZGV2aWNlICpkZXYpCj4gPiA+ID4gLXsKPiA+ID4gPiAt
ICAgIGdib29sZWFuIHNraXA7Cj4gPiA+ID4gLSAgICB1aW50OF90IGFkZHIgPSBsaWJ1c2JfZ2V0
X2RldmljZV9hZGRyZXNzKGRldik7Cj4gPiA+ID4gLSAgICBzdHJ1Y3QgbGlidXNiX2RldmljZV9k
ZXNjcmlwdG9yIGRlc2M7Cj4gPiA+ID4gLQo+ID4gPiA+IC0gICAgbGlidXNiX2dldF9kZXZpY2Vf
ZGVzY3JpcHRvcihkZXYsICZkZXNjKTsKPiA+ID4gPiAtCj4gPiA+ID4gLSAgICBza2lwID0gKChh
ZGRyID09IDB4ZmYpIHx8ICAvKiByb290IGh1YiAoSENEKSAqLwo+ID4gPiA+IC0gICAgICAgICAg
ICAoYWRkciA9PSAxKSB8fCAvKiByb290IGh1YiBhZGRyICovCj4gPiA+ID4gLSAgICAgICAgICAg
IChkZXNjLmJEZXZpY2VDbGFzcyA9PSBMSUJVU0JfQ0xBU1NfSFVCKSB8fCAvKiBodWIqLwo+ID4g
PiA+IC0gICAgICAgICAgICAoYWRkciA9PSAwKSk7IC8qIGJhZCBhZGRyZXNzICovCj4gPiA+ID4g
LSAgICByZXR1cm4gc2tpcDsKPiA+ID4gPiArICAgICAgICAgICAgICAgIGluZm8tPmJ1cywgaW5m
by0+YWRkcmVzcywKPiA+ID4gPiArICAgICAgICAgICAgICAgIGluZm8tPnZpZCwgaW5mby0+cGlk
LCBpbmZvLT5jbGFzcyk7Cj4gPiA+ID4gIH0KPiA+ID4gPiBkaWZmIC0tZ2l0IGEvc3JjL3dpbi11
c2ItZGV2LmggYi9zcmMvd2luLXVzYi1kZXYuaAo+ID4gPiA+IGluZGV4IGIxYzBlMjcuLmZkZmU3
M2EgMTAwNjQ0Cj4gPiA+ID4gLS0tIGEvc3JjL3dpbi11c2ItZGV2LmgKPiA+ID4gPiArKysgYi9z
cmMvd2luLXVzYi1kZXYuaAo+ID4gPiA+IEBAIC0yMyw2ICsyMyw3IEBACj4gPiA+ID4gICNkZWZp
bmUgX19XSU5fVVNCX0RFVl9IX18KPiA+ID4gPgo+ID4gPiA+ICAjaW5jbHVkZSA8Z2lvL2dpby5o
Pgo+ID4gPiA+ICsjaW5jbHVkZSAidXNiLWJhY2tlbmQuaCIKPiA+ID4gPgo+ID4gPiA+ICBHX0JF
R0lOX0RFQ0xTCj4gPiA+ID4KPiA+ID4gPiBAQCAtNTEsMTIgKzUyLDEyIEBAIHN0cnVjdCBfR1Vk
ZXZDbGllbnRDbGFzcwo+ID4gPiA+ICAgICAgR09iamVjdENsYXNzIHBhcmVudF9jbGFzczsKPiA+
ID4gPgo+ID4gPiA+ICAgICAgLyogc2lnbmFscyAqLwo+ID4gPiA+IC0gICAgdm9pZCAoKnVldmVu
dCkoR1VkZXZDbGllbnQgKmNsaWVudCwgbGlidXNiX2RldmljZSAqZGV2aWNlLCBnYm9vbGVhbiBh
ZGQpOwo+ID4gPiA+ICsgICAgdm9pZCAoKnVldmVudCkoR1VkZXZDbGllbnQgKmNsaWVudCwgU3Bp
Y2VVc2JCYWNrZW5kRGV2aWNlICpkZXZpY2UsIGdib29sZWFuIGFkZCk7Cj4gPiA+ID4gIH07Cj4g
PiA+ID4KPiA+ID4gPiAgR1R5cGUgZ191ZGV2X2NsaWVudF9nZXRfdHlwZSh2b2lkKSBHX0dOVUNf
Q09OU1Q7Cj4gPiA+ID4gIEdVZGV2Q2xpZW50ICpnX3VkZXZfY2xpZW50X25ldyh2b2lkKTsKPiA+
ID4gPiAtbGlidXNiX2NvbnRleHQgKmdfdWRldl9jbGllbnRfZ2V0X2NvbnRleHQoR1VkZXZDbGll
bnQgKmNsaWVudCk7Cj4gPiA+ID4gK1NwaWNlVXNiQmFja2VuZCAqZ191ZGV2X2NsaWVudF9nZXRf
Y29udGV4dChHVWRldkNsaWVudCAqY2xpZW50KTsKPiA+ID4gPiAgdm9pZCBnX3VkZXZfY2xpZW50
X3JlcG9ydF9kZXZpY2VzKEdVZGV2Q2xpZW50ICpjbGllbnQpOwo+ID4gPiA+Cj4gPiA+ID4gIEdR
dWFyayBnX3VkZXZfY2xpZW50X2Vycm9yX3F1YXJrKHZvaWQpOwo+ID4KPiA+IEFsbCBvdGhlciBu
b3RlcyBoYXMgYmVlbiBhZGRyZXNzZWQgKEkgaG9wZSkuCj4gPiBJbmNyZW1lbnRhbCBmaXhlcyB5
b3UgY2FuIHNlZSBhdAo+ID4gaHR0cHM6Ly9naXRsYWIuZnJlZWRlc2t0b3Aub3JnL3l1cmlfYmVu
ZGl0b3ZpY2gvc3BpY2UtZ3RrL2NvbW1pdHMvYmFja2VuZDItaW5jcmVtZW50Cj4gPgo+ID4gPiA+
IC0tCj4gPiA+ID4gMi4xNy4xCj4gPiA+ID4KPiA+ID4gPiBfX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fXwo+ID4gPiA+IFNwaWNlLWRldmVsIG1haWxpbmcgbGlz
dAo+ID4gPiA+IFNwaWNlLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwo+ID4gPiA+IGh0dHBz
Oi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vc3BpY2UtZGV2ZWwKX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KU3BpY2UtZGV2ZWwg
bWFpbGluZyBsaXN0ClNwaWNlLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xp
c3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL3NwaWNlLWRldmVs
