Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 340F311809
	for <lists+spice-devel@lfdr.de>; Thu,  2 May 2019 13:13:51 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 9AFEA893EF;
	Thu,  2 May 2019 11:13:49 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 559B1893EB
 for <spice-devel@lists.freedesktop.org>; Thu,  2 May 2019 11:13:48 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx05.intmail.prod.int.phx2.redhat.com
 [10.5.11.15])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id 00A49356F1
 for <spice-devel@lists.freedesktop.org>; Thu,  2 May 2019 11:13:48 +0000 (UTC)
Received: from fziglio.remote.csb (unknown [10.33.32.3])
 by smtp.corp.redhat.com (Postfix) with ESMTP id 12A4239C1;
 Thu,  2 May 2019 11:13:46 +0000 (UTC)
From: Frediano Ziglio <fziglio@redhat.com>
To: spice-devel@lists.freedesktop.org
Date: Thu,  2 May 2019 12:13:39 +0100
Message-Id: <20190502111339.27405-3-fziglio@redhat.com>
In-Reply-To: <20190502111339.27405-1-fziglio@redhat.com>
References: <20190502111339.27405-1-fziglio@redhat.com>
MIME-Version: 1.0
X-Scanned-By: MIMEDefang 2.79 on 10.5.11.15
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16
 (mx1.redhat.com [10.5.110.30]); Thu, 02 May 2019 11:13:48 +0000 (UTC)
Subject: [Spice-devel] [PATCH spice-streaming-agent v3 2/2] Add support log
 logging statistics from plugins
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

QWxsb3dzIHRoZSBwbHVnaW5zIHRvIGFkZCBpbmZvcm1hdGlvbiB0byB0aGUgbG9nLgoKU2lnbmVk
LW9mZi1ieTogRnJlZGlhbm8gWmlnbGlvIDxmemlnbGlvQHJlZGhhdC5jb20+Ci0tLQogaW5jbHVk
ZS9zcGljZS1zdHJlYW1pbmctYWdlbnQvcGx1Z2luLmhwcCB8ICA3ICsrKysrKy0KIHNyYy9jb25j
cmV0ZS1hZ2VudC5jcHAgICAgICAgICAgICAgICAgICAgfCAyMSArKysrKysrKysrKysrKysrKy0t
LS0KIHNyYy9jb25jcmV0ZS1hZ2VudC5ocHAgICAgICAgICAgICAgICAgICAgfCAgOCArKysrKysr
LQogc3JjL2ZyYW1lLWxvZy5jcHAgICAgICAgICAgICAgICAgICAgICAgICB8IDExICsrKysrKysr
LS0tCiBzcmMvZnJhbWUtbG9nLmhwcCAgICAgICAgICAgICAgICAgICAgICAgIHwgIDIgKysKIHNy
Yy9zcGljZS1zdHJlYW1pbmctYWdlbnQuY3BwICAgICAgICAgICAgfCAgNiArKystLS0KIDYgZmls
ZXMgY2hhbmdlZCwgNDMgaW5zZXJ0aW9ucygrKSwgMTIgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0
IGEvaW5jbHVkZS9zcGljZS1zdHJlYW1pbmctYWdlbnQvcGx1Z2luLmhwcCBiL2luY2x1ZGUvc3Bp
Y2Utc3RyZWFtaW5nLWFnZW50L3BsdWdpbi5ocHAKaW5kZXggM2IyNjVkOS4uODhjYjdmMiAxMDA2
NDQKLS0tIGEvaW5jbHVkZS9zcGljZS1zdHJlYW1pbmctYWdlbnQvcGx1Z2luLmhwcAorKysgYi9p
bmNsdWRlL3NwaWNlLXN0cmVhbWluZy1hZ2VudC9wbHVnaW4uaHBwCkBAIC0yOCw3ICsyOCw3IEBA
IGNsYXNzIEZyYW1lQ2FwdHVyZTsKICAqIHdoZXJlIE1NIGlzIG1ham9yIGFuZCBtbSBpcyB0aGUg
bWlub3IsIGNhbiBiZSBlYXNpbHkgZXhwYW5kZWQKICAqIHVzaW5nIG1vcmUgYml0cyBpbiB0aGUg
ZnV0dXJlCiAgKi8KLWVudW0gQ29uc3RhbnRzIDogdW5zaWduZWQgeyBQbHVnaW5WZXJzaW9uID0g
MHgxMDB1IH07CitlbnVtIENvbnN0YW50cyA6IHVuc2lnbmVkIHsgUGx1Z2luVmVyc2lvbiA9IDB4
MTAxdSB9OwogCiBlbnVtIFJhbmtzIDogdW5zaWduZWQgewogICAgIC8vLyB0aGlzIHBsdWdpbiBz
aG91bGQgbm90IGJlIHVzZWQKQEAgLTExNiw2ICsxMTYsMTEgQEAgcHVibGljOgogICAgICAqIFx0
b2RvIHBhc3Npbmcgb3B0aW9ucyB0byBlbnRyeSBwb2ludCBpbnN0ZWFkPwogICAgICAqLwogICAg
IHZpcnR1YWwgY29uc3QgQ29uZmlndXJlT3B0aW9uKiBPcHRpb25zKCkgY29uc3QgPSAwOworICAg
IC8qIQorICAgICAqIFdyaXRlIHNvbWV0aGluZyBpbiB0aGUgbG9nLgorICAgICAqLworICAgIF9f
YXR0cmlidXRlX18gKChmb3JtYXQgKHByaW50ZiwgMiwgMykpKQorICAgIHZpcnR1YWwgdm9pZCBM
b2dTdGF0KGNvbnN0IGNoYXIqIGZvcm1hdCwgLi4uKSA9IDA7CiB9OwogCiB0eXBlZGVmIGJvb2wg
UGx1Z2luSW5pdEZ1bmMoc3BpY2U6OnN0cmVhbWluZ19hZ2VudDo6QWdlbnQqIGFnZW50KTsKZGlm
ZiAtLWdpdCBhL3NyYy9jb25jcmV0ZS1hZ2VudC5jcHAgYi9zcmMvY29uY3JldGUtYWdlbnQuY3Bw
CmluZGV4IGZiMTQxMmIuLjMzNmJkMDkgMTAwNjQ0Ci0tLSBhL3NyYy9jb25jcmV0ZS1hZ2VudC5j
cHAKKysrIGIvc3JjL2NvbmNyZXRlLWFnZW50LmNwcApAQCAtNSwxMyArNSwxNSBAQAogICovCiAK
ICNpbmNsdWRlIDxjb25maWcuaD4KKyNpbmNsdWRlICJjb25jcmV0ZS1hZ2VudC5ocHAiCisjaW5j
bHVkZSAiZnJhbWUtbG9nLmhwcCIKKwogI2luY2x1ZGUgPGFsZ29yaXRobT4KICNpbmNsdWRlIDxz
eXNsb2cuaD4KICNpbmNsdWRlIDxnbG9iLmg+CiAjaW5jbHVkZSA8ZGxmY24uaD4KICNpbmNsdWRl
IDxzdHJpbmc+Ci0KLSNpbmNsdWRlICJjb25jcmV0ZS1hZ2VudC5ocHAiCisjaW5jbHVkZSA8Y3N0
ZGFyZz4KIAogdXNpbmcgbmFtZXNwYWNlIHNwaWNlOjpzdHJlYW1pbmdfYWdlbnQ7CiAKQEAgLTI1
LDggKzI3LDkgQEAgc3RhdGljIGlubGluZSB1bnNpZ25lZCBNaW5vclZlcnNpb24odW5zaWduZWQg
dmVyc2lvbikKICAgICByZXR1cm4gdmVyc2lvbiAmIDB4ZmZ1OwogfQogCi1Db25jcmV0ZUFnZW50
OjpDb25jcmV0ZUFnZW50KGNvbnN0IHN0ZDo6dmVjdG9yPENvbmNyZXRlQ29uZmlndXJlT3B0aW9u
PiAmb3B0aW9ucyk6Ci0gICAgb3B0aW9ucyhvcHRpb25zKQorQ29uY3JldGVBZ2VudDo6Q29uY3Jl
dGVBZ2VudChjb25zdCBzdGQ6OnZlY3RvcjxDb25jcmV0ZUNvbmZpZ3VyZU9wdGlvbj4gJm9wdGlv
bnMsIEZyYW1lTG9nICpsb2dnZXIpOgorICAgIG9wdGlvbnMob3B0aW9ucyksCisgICAgbG9nZ2Vy
KGxvZ2dlcikKIHsKICAgICB0aGlzLT5vcHRpb25zLnB1c2hfYmFjayhDb25jcmV0ZUNvbmZpZ3Vy
ZU9wdGlvbihudWxscHRyLCBudWxscHRyKSk7CiB9CkBAIC0xNDAsMyArMTQzLDEzIEBAIEZyYW1l
Q2FwdHVyZSAqQ29uY3JldGVBZ2VudDo6R2V0QmVzdEZyYW1lQ2FwdHVyZShjb25zdCBzdGQ6OnNl
dDxTcGljZVZpZGVvQ29kZWNUCiAgICAgfQogICAgIHJldHVybiBudWxscHRyOwogfQorCit2b2lk
IENvbmNyZXRlQWdlbnQ6OkxvZ1N0YXQoY29uc3QgY2hhciogZm9ybWF0LCAuLi4pCit7CisgICAg
aWYgKGxvZ2dlcikgeworICAgICAgICB2YV9saXN0IGFwOworICAgICAgICB2YV9zdGFydChhcCwg
Zm9ybWF0KTsKKyAgICAgICAgbG9nZ2VyLT5sb2dfc3RhdHYoZm9ybWF0LCBhcCk7CisgICAgICAg
IHZhX2VuZChhcCk7CisgICAgfQorfQpkaWZmIC0tZ2l0IGEvc3JjL2NvbmNyZXRlLWFnZW50Lmhw
cCBiL3NyYy9jb25jcmV0ZS1hZ2VudC5ocHAKaW5kZXggMmMyZWJjOC4uNmQxYmUzNSAxMDA2NDQK
LS0tIGEvc3JjL2NvbmNyZXRlLWFnZW50LmhwcAorKysgYi9zcmMvY29uY3JldGUtYWdlbnQuaHBw
CkBAIC0xNCw2ICsxNCw4IEBACiBuYW1lc3BhY2Ugc3BpY2UgewogbmFtZXNwYWNlIHN0cmVhbWlu
Z19hZ2VudCB7CiAKK2NsYXNzIEZyYW1lTG9nOworCiBzdHJ1Y3QgQ29uY3JldGVDb25maWd1cmVP
cHRpb246IENvbmZpZ3VyZU9wdGlvbgogewogICAgIENvbmNyZXRlQ29uZmlndXJlT3B0aW9uKGNv
bnN0IGNoYXIgKm5hbWUsIGNvbnN0IGNoYXIgKnZhbHVlKQpAQCAtMjYsMTYgKzI4LDIwIEBAIHN0
cnVjdCBDb25jcmV0ZUNvbmZpZ3VyZU9wdGlvbjogQ29uZmlndXJlT3B0aW9uCiBjbGFzcyBDb25j
cmV0ZUFnZW50IGZpbmFsIDogcHVibGljIEFnZW50CiB7CiBwdWJsaWM6Ci0gICAgQ29uY3JldGVB
Z2VudChjb25zdCBzdGQ6OnZlY3RvcjxDb25jcmV0ZUNvbmZpZ3VyZU9wdGlvbj4gJm9wdGlvbnMp
OworICAgIENvbmNyZXRlQWdlbnQoY29uc3Qgc3RkOjp2ZWN0b3I8Q29uY3JldGVDb25maWd1cmVP
cHRpb24+ICZvcHRpb25zLAorICAgICAgICAgICAgICAgICAgRnJhbWVMb2cgKmxvZ2dlcj1udWxs
cHRyKTsKICAgICB2b2lkIFJlZ2lzdGVyKGNvbnN0IHN0ZDo6c2hhcmVkX3B0cjxQbHVnaW4+JiBw
bHVnaW4pIG92ZXJyaWRlOwogICAgIGNvbnN0IENvbmZpZ3VyZU9wdGlvbiogT3B0aW9ucygpIGNv
bnN0IG92ZXJyaWRlOwogICAgIHZvaWQgTG9hZFBsdWdpbnMoY29uc3Qgc3RkOjpzdHJpbmcgJmRp
cmVjdG9yeSk7CiAgICAgRnJhbWVDYXB0dXJlICpHZXRCZXN0RnJhbWVDYXB0dXJlKGNvbnN0IHN0
ZDo6c2V0PFNwaWNlVmlkZW9Db2RlY1R5cGU+JiBjb2RlY3MpOworICAgIF9fYXR0cmlidXRlX18g
KChmb3JtYXQgKHByaW50ZiwgMiwgMykpKQorICAgIHZvaWQgTG9nU3RhdChjb25zdCBjaGFyKiBm
b3JtYXQsIC4uLikgb3ZlcnJpZGU7CiBwcml2YXRlOgogICAgIGJvb2wgUGx1Z2luVmVyc2lvbklz
Q29tcGF0aWJsZSh1bnNpZ25lZCBwbHVnaW5WZXJzaW9uKSBjb25zdDsKICAgICB2b2lkIExvYWRQ
bHVnaW4oY29uc3Qgc3RkOjpzdHJpbmcgJnBsdWdpbl9maWxlbmFtZSk7CiAgICAgc3RkOjp2ZWN0
b3I8c3RkOjpzaGFyZWRfcHRyPFBsdWdpbj4+IHBsdWdpbnM7CiAgICAgc3RkOjp2ZWN0b3I8Q29u
Y3JldGVDb25maWd1cmVPcHRpb24+IG9wdGlvbnM7CisgICAgRnJhbWVMb2cgKmNvbnN0IGxvZ2dl
ciA9IG51bGxwdHI7CiB9OwogCiB9fSAvLyBuYW1lc3BhY2Ugc3BpY2U6OnN0cmVhbWluZ19hZ2Vu
dApkaWZmIC0tZ2l0IGEvc3JjL2ZyYW1lLWxvZy5jcHAgYi9zcmMvZnJhbWUtbG9nLmNwcAppbmRl
eCA2MmZmZmMzLi5mNDE2Y2RlIDEwMDY0NAotLS0gYS9zcmMvZnJhbWUtbG9nLmNwcAorKysgYi9z
cmMvZnJhbWUtbG9nLmNwcApAQCAtNDEsMTMgKzQxLDE4IEBAIEZyYW1lTG9nOjp+RnJhbWVMb2co
KQogfQogCiB2b2lkIEZyYW1lTG9nOjpsb2dfc3RhdChjb25zdCBjaGFyKiBmb3JtYXQsIC4uLikK
K3sKKyAgICB2YV9saXN0IGFwOworICAgIHZhX3N0YXJ0KGFwLCBmb3JtYXQpOworICAgIGxvZ19z
dGF0dihmb3JtYXQsIGFwKTsKKyAgICB2YV9lbmQoYXApOworfQorCit2b2lkIEZyYW1lTG9nOjps
b2dfc3RhdHYoY29uc3QgY2hhciogZm9ybWF0LCB2YV9saXN0IGFwKQogewogICAgIGlmIChsb2df
ZmlsZSAmJiAhbG9nX2JpbmFyeSkgewogICAgICAgICBmcHJpbnRmKGxvZ19maWxlLCAiJSIgUFJJ
dTY0ICI6ICIsIGdldF90aW1lKCkpOwotICAgICAgICB2YV9saXN0IGFwOwotICAgICAgICB2YV9z
dGFydChhcCwgZm9ybWF0KTsKICAgICAgICAgdmZwcmludGYobG9nX2ZpbGUsIGZvcm1hdCwgYXAp
OwotICAgICAgICB2YV9lbmQoYXApOwogICAgICAgICBmcHV0YygnXG4nLCBsb2dfZmlsZSk7CiAg
ICAgfQogfQpkaWZmIC0tZ2l0IGEvc3JjL2ZyYW1lLWxvZy5ocHAgYi9zcmMvZnJhbWUtbG9nLmhw
cAppbmRleCA4NTAzMzQ1Li5hMTA0NzIzIDEwMDY0NAotLS0gYS9zcmMvZnJhbWUtbG9nLmhwcAor
KysgYi9zcmMvZnJhbWUtbG9nLmhwcApAQCAtMjQsNiArMjQsOCBAQCBwdWJsaWM6CiAKICAgICBf
X2F0dHJpYnV0ZV9fICgoZm9ybWF0IChwcmludGYsIDIsIDMpKSkKICAgICB2b2lkIGxvZ19zdGF0
KGNvbnN0IGNoYXIqIGZvcm1hdCwgLi4uKTsKKyAgICBfX2F0dHJpYnV0ZV9fICgoZm9ybWF0IChw
cmludGYsIDIsIDApKSkKKyAgICB2b2lkIGxvZ19zdGF0dihjb25zdCBjaGFyKiBmb3JtYXQsIHZh
X2xpc3QgYXApOwogICAgIHZvaWQgbG9nX2ZyYW1lKGNvbnN0IHZvaWQqIGJ1ZmZlciwgc2l6ZV90
IGJ1ZmZlcl9zaXplKTsKIAogICAgIHN0YXRpYyB1aW50NjRfdCBnZXRfdGltZSgpOwpkaWZmIC0t
Z2l0IGEvc3JjL3NwaWNlLXN0cmVhbWluZy1hZ2VudC5jcHAgYi9zcmMvc3BpY2Utc3RyZWFtaW5n
LWFnZW50LmNwcAppbmRleCAwMzlkNjI4Li40OWY1ZGM0IDEwMDY0NAotLS0gYS9zcmMvc3BpY2Ut
c3RyZWFtaW5nLWFnZW50LmNwcAorKysgYi9zcmMvc3BpY2Utc3RyZWFtaW5nLWFnZW50LmNwcApA
QCAtNDAxLDE1ICs0MDEsMTUgQEAgaW50IG1haW4oaW50IGFyZ2MsIGNoYXIqIGFyZ3ZbXSkKICAg
ICByZWdpc3Rlcl9pbnRlcnJ1cHRzKCk7CiAKICAgICB0cnkgewotICAgICAgICBDb25jcmV0ZUFn
ZW50IGFnZW50KG9wdGlvbnMpOworICAgICAgICBGcmFtZUxvZyBmcmFtZV9sb2cobG9nX2ZpbGVu
YW1lLCBsb2dfYmluYXJ5LCBsb2dfZnJhbWVzKTsKKworICAgICAgICBDb25jcmV0ZUFnZW50IGFn
ZW50KG9wdGlvbnMsICZmcmFtZV9sb2cpOwogCiAgICAgICAgIC8vIHJlZ2lzdGVyIGJ1aWx0LWlu
IHBsdWdpbnMKICAgICAgICAgTWpwZWdQbHVnaW46OlJlZ2lzdGVyKCZhZ2VudCk7CiAKICAgICAg
ICAgYWdlbnQuTG9hZFBsdWdpbnMocGx1Z2luc2Rpcik7CiAKLSAgICAgICAgRnJhbWVMb2cgZnJh
bWVfbG9nKGxvZ19maWxlbmFtZSwgbG9nX2JpbmFyeSwgbG9nX2ZyYW1lcyk7Ci0KICAgICAgICAg
Zm9yIChjb25zdCBzdGQ6OnN0cmluZyYgYXJnOiBvbGRfYXJncykgewogICAgICAgICAgICAgZnJh
bWVfbG9nLmxvZ19zdGF0KCJBcmdzOiAlcyIsIGFyZy5jX3N0cigpKTsKICAgICAgICAgfQotLSAK
Mi4yMC4xCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpT
cGljZS1kZXZlbCBtYWlsaW5nIGxpc3QKU3BpY2UtZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3Jn
Cmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vc3BpY2UtZGV2
ZWw=
