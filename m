Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id AFFA048A2E
	for <lists+spice-devel@lfdr.de>; Mon, 17 Jun 2019 19:33:57 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 335A589216;
	Mon, 17 Jun 2019 17:33:56 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mail.codeweavers.com (mail.codeweavers.com [50.203.203.244])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 52B7E89271
 for <spice-devel@lists.freedesktop.org>; Mon, 17 Jun 2019 17:33:54 +0000 (UTC)
Received: from 82-64-54-218.subs.proxad.net ([82.64.54.218] helo=amboise)
 by mail.codeweavers.com with esmtpsa (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.89) (envelope-from <fgouget@free.fr>) id 1hcvWV-00079D-Hk
 for spice-devel@lists.freedesktop.org; Mon, 17 Jun 2019 12:34:28 -0500
Received: from fgouget by amboise with local (Exim 4.92)
 (envelope-from <fgouget@amboise.dolphin>) id 1hcvVv-0008A5-CR
 for spice-devel@lists.freedesktop.org; Mon, 17 Jun 2019 19:33:51 +0200
Date: Mon, 17 Jun 2019 19:33:51 +0200 (CEST)
From: Francois Gouget <fgouget@codeweavers.com>
To: Spice devel <spice-devel@lists.freedesktop.org>
In-Reply-To: <cover.1560790607.git.fgouget@free.fr>
Message-ID: <954d1aa1c8862a72dce84790fa9e1212a72256fd.1560790607.git.fgouget@free.fr>
References: <cover.1560790607.git.fgouget@free.fr>
User-Agent: Alpine 2.21 (DEB 202 2017-01-01)
MIME-Version: 1.0
X-Spam-Score: -103.7
X-Spam-Report: Spam detection software,
 running on the system "mail.codeweavers.com", 
 has NOT identified this incoming email as spam.  The original
 message has been attached to this so you can view it or label
 similar future email.  If you have any questions, see
 the administrator of that system for details.
 Content preview:  The client is in a better position than the server to pick
 the minimum lag needed to compensate for frame arrival time jitter and ensure
 smooth video playback. To do so: - It ignores the lag specified [...] 
 Content analysis details:   (-103.7 points, 5.0 required)
 pts rule name              description
 ---- ---------------------- --------------------------------------------------
 -100 USER_IN_WHITELIST      From: address is in the user's white-list
 -6.0 ALL_TRUSTED            Passed through trusted hosts only via SMTP
 0.0 TVD_RCVD_IP            Message was received from an IP address
 1.0 FREEMAIL_FROM          Sender email is commonly abused enduser mail
 provider (fgouget[at]free.fr)
 1.0 HEADER_FROM_DIFFERENT_DOMAINS From and EnvelopeFrom 2nd level
 mail domains are different
 0.2 FREEMAIL_FORGED_FROMDOMAIN 2nd level domains in From and
 EnvelopeFrom freemail headers are different
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt;
 c=relaxed/relaxed; 
 d=codeweavers.com; s=6377696661; h=Content-Type:MIME-Version:References:
 Message-ID:In-Reply-To:Subject:To:From:Date:Sender:Reply-To:Cc:
 Content-Transfer-Encoding:Content-ID:Content-Description:Resent-Date:
 Resent-From:Resent-Sender:Resent-To:Resent-Cc:Resent-Message-ID:List-Id:
 List-Help:List-Unsubscribe:List-Subscribe:List-Post:List-Owner:List-Archive;
 bh=bBQKJH9duUGEOFNUaDmokikxd8n9pXRH1Y3JFBOltZg=; b=ufK+QkoJkFlHJ1yLJr2zRcAnj
 SQuensqnDRjpXcadA+SRr+4fmdB+Ne6IIxZje5r3FMXwztPCVhu9sa2/Mxxd+SC1wtx15o67HcWTE
 nX0CAgajCncktwn+I8WHDvmLEteu2UIGYSnqzNNo87KCwdIjMmcGhxe4BjRZ2hlU51kMQ=;
Subject: [Spice-devel] [client v2 07/12] channel-display: Minimize the
 stream lag by ignoring the server one
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

VGhlIGNsaWVudCBpcyBpbiBhIGJldHRlciBwb3NpdGlvbiB0aGFuIHRoZSBzZXJ2ZXIgdG8gcGlj
ayB0aGUgbWluaW11bQpsYWcgbmVlZGVkIHRvIGNvbXBlbnNhdGUgZm9yIGZyYW1lIGFycml2YWwg
dGltZSBqaXR0ZXIgYW5kIGVuc3VyZQpzbW9vdGggdmlkZW8gcGxheWJhY2suClRvIGRvIHNvOgot
IEl0IGlnbm9yZXMgdGhlIGxhZyBzcGVjaWZpZWQgYnkgdGhlIHNlcnZlciB0aHJvdWdoIHRoZSBt
bXRpbWUgY2xvY2sKICBhZGp1c3RtZW50cyAoYnV0IHRoaXMgbGFnIGlzIHN0aWxsIHRyYWNrZWQg
Zm9yIHRoZSBzdHJlYW0gcmVwb3J0cykuCi0gSXQgcGVyZm9ybXMgaXRzIG93biBmcmFtZSBtbXRp
bWUgY29udmVyc2lvbiB0byB0aGUgbG9jYWwgbW9ub3RvbmljCiAgY2xvY2sgc3BpY2Vfc2Vzc2lv
bl9nZXRfY2xpZW50X3RpbWUoKSBzaW5jZSB0aGUgc2VydmVyLWNvbnRyb2xsZWQKICBtbXRpbWUg
Y2xvY2sgY2Fubm90IGJlIHJlbGllZCBvbi4gVGhpcyBjb252ZXJzaW9uIHVzZXMgZGF0YSBmcm9t
IGFsbAogIHN0cmVhbXMgYnV0IGlzIGdsb2JhbCBzbyBhbGwgc3RyZWFtcyBpaGF2ZSBhIGNvbW1v
biB0aW1lIHJlZmVyZW5jZS4KLSBUaGlzIGlzIGFsc28gd2hlcmUgbW10aW1lIGNsb2NrIGNoYW5n
ZXMgY2F1c2VkIGJ5IHNlcnZlciBtaWdyYXRpb24KICBhcmUgaGFuZGxlZC4KLSBJdCB0cmFja3Mg
dGhlIG1hcmdpbiBiZXR3ZWVuIHRoZSBjb252ZXJ0ZWQgdGltZS10by1kaXNwbGF5IGZyYW1lCiAg
dGltZXN0YW1wIGFuZCB0aGUgY3VycmVuIHRpbWUgYW5kIGFkZHMgYSBkZWxheSB0byBlbnN1cmUg
dGhpcyBtYXJnaW4KICByZW1haW5zIHBvc2l0aXZlLgotIFRoaXMgZGVsYXkgaW50cm9kdWNlcyB0
aGUgdmlkZW8gc3RyZWFtIGxhZy4gSXQgaXMgY29udGludW91c2x5CiAgYWRqdXN0ZWQgdG8gZWl0
aGVyIGJlIGFzIGxvdyBhcyBwb3NzaWJsZSwgb3IgbWF0Y2ggdGhlIGF1ZGlvCiAgcGxheWJhY2sg
ZGVsYXkgZm9yIHByb3BlciBsaXAgc3luYy4KLSBEZWxheSBhZGp1c3RtZW50cyBhcmUgZ3JhZHVh
bCwgc3BlZWRpbmcgdXAgb3Igc2xvd2luZyBkb3duIHZpZGVvCiAgcGxheWJhY2sgdW50aWwgdGhl
IGF2ZXJhZ2UgbWFyZ2luIG1hdGNoZXMgdGhlIHRhcmdldCBsYWcuCi0gQ2hhbmdlcyBpbiB0aGUg
YXZlcmFnZSBtYXJnaW4gYXJlIHRyYWNrZWQgKHNlZSBtYXJnaW5fc3ByZWFkKSB0bwogIGF2b2lk
IG51ZGdpbmcgdGhlIGRlbGF5IGluIHJlc3BvbnNlIHRvIG1pbm9yIHJhbmRvbSB2YXJpYXRpb25z
LgoKU2lnbmVkLW9mZi1ieTogRnJhbmNvaXMgR291Z2V0IDxmZ291Z2V0QGNvZGV3ZWF2ZXJzLmNv
bT4KLS0tCiBzcmMvY2hhbm5lbC1kaXNwbGF5LWdzdC5jICAgfCAgMjIgKystLS0KIHNyYy9jaGFu
bmVsLWRpc3BsYXktbWpwZWcuYyB8ICAxNCArLS0KIHNyYy9jaGFubmVsLWRpc3BsYXktcHJpdi5o
ICB8ICAxOCArKystCiBzcmMvY2hhbm5lbC1kaXNwbGF5LmMgICAgICAgfCAxNzggKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysrKystLS0tCiBzcmMvc3BpY2Utc2Vzc2lvbi1wcml2LmggICAg
fCAgIDEgKwogc3JjL3NwaWNlLXNlc3Npb24uYyAgICAgICAgIHwgIDQ2ICsrKysrKysrKysKIDYg
ZmlsZXMgY2hhbmdlZCwgMjQwIGluc2VydGlvbnMoKyksIDM5IGRlbGV0aW9ucygtKQoKZGlmZiAt
LWdpdCBhL3NyYy9jaGFubmVsLWRpc3BsYXktZ3N0LmMgYi9zcmMvY2hhbm5lbC1kaXNwbGF5LWdz
dC5jCmluZGV4IDZmY2NmNjIxLi42NzNmNDE3NyAxMDA2NDQKLS0tIGEvc3JjL2NoYW5uZWwtZGlz
cGxheS1nc3QuYworKysgYi9zcmMvY2hhbm5lbC1kaXNwbGF5LWdzdC5jCkBAIC01MCw3ICs1MCw3
IEBAIHR5cGVkZWYgc3RydWN0IFNwaWNlR3N0RGVjb2RlciB7CiAKICAgICAvKiAtLS0tLS0tLS0t
IERlY29kaW5nIGFuZCBkaXNwbGF5IHF1ZXVlcyAtLS0tLS0tLS0tICovCiAKLSAgICB1aW50MzJf
dCBsYXN0X21tX3RpbWU7CisgICAgdWludDMyX3QgbGFzdF9mcmFtZV90aW1lOwogCiAgICAgR011
dGV4IHF1ZXVlc19tdXRleDsKICAgICBHUXVldWUgKmRlY29kaW5nX3F1ZXVlOwpAQCAtMjk3LDgg
KzI5Nyw4IEBAIHN0YXRpYyB2b2lkIHNjaGVkdWxlX2ZyYW1lKFNwaWNlR3N0RGVjb2RlciAqZGVj
b2RlcikKICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICB9CiAKLSAgICAgICAgaWYgKHNwaWNl
X21tdGltZV9kaWZmKGdzdGZyYW1lLT5lbmNvZGVkX2ZyYW1lLT5tbV90aW1lLCBub3cpID49IDAp
IHsKLSAgICAgICAgICAgIGRlY29kZXItPnRpbWVyX2lkID0gZ190aW1lb3V0X2FkZChnc3RmcmFt
ZS0+ZW5jb2RlZF9mcmFtZS0+bW1fdGltZSAtIG5vdywKKyAgICAgICAgaWYgKHNwaWNlX21tdGlt
ZV9kaWZmKGdzdGZyYW1lLT5lbmNvZGVkX2ZyYW1lLT50aW1lLCBub3cpID49IDApIHsKKyAgICAg
ICAgICAgIGRlY29kZXItPnRpbWVyX2lkID0gZ190aW1lb3V0X2FkZChnc3RmcmFtZS0+ZW5jb2Rl
ZF9mcmFtZS0+dGltZSAtIG5vdywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBkaXNwbGF5X2ZyYW1lLCBkZWNvZGVyKTsKICAgICAgICAgfSBlbHNlIGlmIChk
ZWNvZGVyLT5kaXNwbGF5X2ZyYW1lICYmICFkZWNvZGVyLT5wZW5kaW5nX3NhbXBsZXMpIHsKICAg
ICAgICAgICAgIC8qIFN0aWxsIGF0dGVtcHQgdG8gZGlzcGxheSB0aGUgbGVhc3Qgb3V0IG9mIGRh
dGUgZnJhbWUgc28gdGhlCkBAIC0zMDcsOCArMzA3LDggQEAgc3RhdGljIHZvaWQgc2NoZWR1bGVf
ZnJhbWUoU3BpY2VHc3REZWNvZGVyICpkZWNvZGVyKQogICAgICAgICAgICAgZGVjb2Rlci0+dGlt
ZXJfaWQgPSBnX3RpbWVvdXRfYWRkKDAsIGRpc3BsYXlfZnJhbWUsIGRlY29kZXIpOwogICAgICAg
ICB9IGVsc2UgewogICAgICAgICAgICAgU1BJQ0VfREVCVUcoIiVzOiByZW5kZXJpbmcgdG9vIGxh
dGUgYnkgJXUgbXMgKHRzOiAldSwgbW10aW1lOiAldSksIGRyb3BwaW5nIiwKLSAgICAgICAgICAg
ICAgICAgICAgICAgIF9fRlVOQ1RJT05fXywgbm93IC0gZ3N0ZnJhbWUtPmVuY29kZWRfZnJhbWUt
Pm1tX3RpbWUsCi0gICAgICAgICAgICAgICAgICAgICAgICBnc3RmcmFtZS0+ZW5jb2RlZF9mcmFt
ZS0+bW1fdGltZSwgbm93KTsKKyAgICAgICAgICAgICAgICAgICAgICAgIF9fRlVOQ1RJT05fXywg
bm93IC0gZ3N0ZnJhbWUtPmVuY29kZWRfZnJhbWUtPnRpbWUsCisgICAgICAgICAgICAgICAgICAg
ICAgICBnc3RmcmFtZS0+ZW5jb2RlZF9mcmFtZS0+dGltZSwgbm93KTsKICAgICAgICAgICAgIHN0
cmVhbV9kcm9wcGVkX2ZyYW1lX29uX3BsYXliYWNrKGRlY29kZXItPmJhc2Uuc3RyZWFtKTsKICAg
ICAgICAgICAgIGRlY29kZXItPmRpc3BsYXlfZnJhbWUgPSBOVUxMOwogICAgICAgICAgICAgZnJl
ZV9nc3RfZnJhbWUoZ3N0ZnJhbWUpOwpAQCAtNDQ5LDkgKzQ0OSw5IEBAIHNpbmtfZXZlbnRfcHJv
YmUoR3N0UGFkICpwYWQsIEdzdFBhZFByb2JlSW5mbyAqaW5mbywgZ3BvaW50ZXIgZGF0YSkKICAg
ICAgICAgICAgICAqICAgb3IgbW9yZSBmcmFtZSBpbnRlcnZhbHMuCiAgICAgICAgICAgICAgKi8K
ICAgICAgICAgICAgIHJlY29yZChmcmFtZXNfc3RhdHMsCi0gICAgICAgICAgICAgICAgICAgImZy
YW1lIG1tX3RpbWUgJXUgc2l6ZSAldSBjcmVhdGlvbiB0aW1lICUiIFBSSWQ2NAorICAgICAgICAg
ICAgICAgICAgICJmcmFtZSB0aW1lICV1IHNpemUgJXUgY3JlYXRpb24gdGltZSAlIiBQUklkNjQK
ICAgICAgICAgICAgICAgICAgICAiIGRlY29kZWQgdGltZSAlIiBQUklkNjQgIiBxdWV1ZSAldSBi
ZWZvcmUgJXUiLAotICAgICAgICAgICAgICAgICAgIGZyYW1lLT5tbV90aW1lLCBmcmFtZS0+c2l6
ZSwgZnJhbWUtPmNyZWF0aW9uX3RpbWUsIGR1cmF0aW9uLAorICAgICAgICAgICAgICAgICAgIGZy
YW1lLT50aW1lLCBmcmFtZS0+c2l6ZSwgZnJhbWUtPmNyZWF0aW9uX3RpbWUsIGR1cmF0aW9uLAog
ICAgICAgICAgICAgICAgICAgIGRlY29kZXItPmRlY29kaW5nX3F1ZXVlLT5sZW5ndGgsIGdzdGZy
YW1lLT5xdWV1ZV9sZW4pOwogCiAgICAgICAgICAgICBpZiAoIWRlY29kZXItPmFwcHNpbmspIHsK
QEAgLTY4OSwxMyArNjg5LDEzIEBAIHN0YXRpYyBnYm9vbGVhbiBzcGljZV9nc3RfZGVjb2Rlcl9x
dWV1ZV9mcmFtZShWaWRlb0RlY29kZXIgKnZpZGVvX2RlY29kZXIsCiAgICAgICAgIHJldHVybiBU
UlVFOwogICAgIH0KIAotICAgIGlmIChzcGljZV9tbXRpbWVfZGlmZihmcmFtZS0+bW1fdGltZSwg
ZGVjb2Rlci0+bGFzdF9tbV90aW1lKSA8IDApIHsKKyAgICBpZiAoc3BpY2VfbW10aW1lX2RpZmYo
ZnJhbWUtPnRpbWUsIGRlY29kZXItPmxhc3RfZnJhbWVfdGltZSkgPCAwKSB7CiAgICAgICAgIFNQ
SUNFX0RFQlVHKCJuZXctZnJhbWUtdGltZSA8IGxhc3QtZnJhbWUtdGltZSAoJXUgPCAldSk6Igog
ICAgICAgICAgICAgICAgICAgICAiIHJlc2V0dGluZyBzdHJlYW0iLAotICAgICAgICAgICAgICAg
ICAgICBmcmFtZS0+bW1fdGltZSwgZGVjb2Rlci0+bGFzdF9tbV90aW1lKTsKKyAgICAgICAgICAg
ICAgICAgICAgZnJhbWUtPnRpbWUsIGRlY29kZXItPmxhc3RfZnJhbWVfdGltZSk7CiAgICAgICAg
IC8qIExldCBHU3RyZWFtZXIgZGVhbCB3aXRoIHRoZSBmcmFtZSBhbnl3YXkgKi8KICAgICB9Ci0g
ICAgZGVjb2Rlci0+bGFzdF9tbV90aW1lID0gZnJhbWUtPm1tX3RpbWU7CisgICAgZGVjb2Rlci0+
bGFzdF9mcmFtZV90aW1lID0gZnJhbWUtPnRpbWU7CiAKICAgICBpZiAobWFyZ2luIDwgMCAmJgog
ICAgICAgICBkZWNvZGVyLT5iYXNlLmNvZGVjX3R5cGUgPT0gU1BJQ0VfVklERU9fQ09ERUNfVFlQ
RV9NSlBFRykgewpAQCAtNzc4LDcgKzc3OCw3IEBAIFZpZGVvRGVjb2RlciogY3JlYXRlX2dzdHJl
YW1lcl9kZWNvZGVyKGludCBjb2RlY190eXBlLCBkaXNwbGF5X3N0cmVhbSAqc3RyZWFtKQogICAg
ICAgICBkZWNvZGVyLT5iYXNlLnF1ZXVlX2ZyYW1lID0gc3BpY2VfZ3N0X2RlY29kZXJfcXVldWVf
ZnJhbWU7CiAgICAgICAgIGRlY29kZXItPmJhc2UuY29kZWNfdHlwZSA9IGNvZGVjX3R5cGU7CiAg
ICAgICAgIGRlY29kZXItPmJhc2Uuc3RyZWFtID0gc3RyZWFtOwotICAgICAgICBkZWNvZGVyLT5s
YXN0X21tX3RpbWUgPSBzdHJlYW1fZ2V0X3RpbWUoc3RyZWFtKTsKKyAgICAgICAgZGVjb2Rlci0+
bGFzdF9mcmFtZV90aW1lID0gc3RyZWFtX2dldF90aW1lKHN0cmVhbSk7CiAgICAgICAgIGdfbXV0
ZXhfaW5pdCgmZGVjb2Rlci0+cXVldWVzX211dGV4KTsKICAgICAgICAgZGVjb2Rlci0+ZGVjb2Rp
bmdfcXVldWUgPSBnX3F1ZXVlX25ldygpOwogCmRpZmYgLS1naXQgYS9zcmMvY2hhbm5lbC1kaXNw
bGF5LW1qcGVnLmMgYi9zcmMvY2hhbm5lbC1kaXNwbGF5LW1qcGVnLmMKaW5kZXggNjQ3ZDMxYjAu
LmQzYWI3N2M4IDEwMDY0NAotLS0gYS9zcmMvY2hhbm5lbC1kaXNwbGF5LW1qcGVnLmMKKysrIGIv
c3JjL2NoYW5uZWwtZGlzcGxheS1tanBlZy5jCkBAIC0xODEsMTYgKzE4MSwxNiBAQCBzdGF0aWMg
dm9pZCBtanBlZ19kZWNvZGVyX3NjaGVkdWxlKE1KcGVnRGVjb2RlciAqZGVjb2RlcikKICAgICBk
ZWNvZGVyLT5jdXJfZnJhbWUgPSBOVUxMOwogICAgIGRvIHsKICAgICAgICAgaWYgKGZyYW1lKSB7
Ci0gICAgICAgICAgICBpZiAoc3BpY2VfbW10aW1lX2RpZmYodGltZSwgZnJhbWUtPm1tX3RpbWUp
IDw9IDApIHsKLSAgICAgICAgICAgICAgICBndWludDMyIGQgPSBmcmFtZS0+bW1fdGltZSAtIHRp
bWU7CisgICAgICAgICAgICBpZiAoc3BpY2VfbW10aW1lX2RpZmYodGltZSwgZnJhbWUtPnRpbWUp
IDw9IDApIHsKKyAgICAgICAgICAgICAgICBndWludDMyIGQgPSBmcmFtZS0+dGltZSAtIHRpbWU7
CiAgICAgICAgICAgICAgICAgZGVjb2Rlci0+Y3VyX2ZyYW1lID0gZnJhbWU7CiAgICAgICAgICAg
ICAgICAgZGVjb2Rlci0+dGltZXJfaWQgPSBnX3RpbWVvdXRfYWRkKGQsIG1qcGVnX2RlY29kZXJf
ZGVjb2RlX2ZyYW1lLCBkZWNvZGVyKTsKICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAg
ICAgIH0KIAogICAgICAgICAgICAgU1BJQ0VfREVCVUcoIiVzOiByZW5kZXJpbmcgdG9vIGxhdGUg
YnkgJXUgbXMgKHRzOiAldSwgbW10aW1lOiAldSksIGRyb3BwaW5nICIsCi0gICAgICAgICAgICAg
ICAgICAgICAgICBfX0ZVTkNUSU9OX18sIHRpbWUgLSBmcmFtZS0+bW1fdGltZSwKLSAgICAgICAg
ICAgICAgICAgICAgICAgIGZyYW1lLT5tbV90aW1lLCB0aW1lKTsKKyAgICAgICAgICAgICAgICAg
ICAgICAgIF9fRlVOQ1RJT05fXywgdGltZSAtIGZyYW1lLT50aW1lLAorICAgICAgICAgICAgICAg
ICAgICAgICAgZnJhbWUtPnRpbWUsIHRpbWUpOwogICAgICAgICAgICAgc3RyZWFtX2Ryb3BwZWRf
ZnJhbWVfb25fcGxheWJhY2soZGVjb2Rlci0+YmFzZS5zdHJlYW0pOwogICAgICAgICAgICAgc3Bp
Y2VfZnJhbWVfZnJlZShmcmFtZSk7CiAgICAgICAgIH0KQEAgLTIyNiwxMiArMjI2LDEyIEBAIHN0
YXRpYyBnYm9vbGVhbiBtanBlZ19kZWNvZGVyX3F1ZXVlX2ZyYW1lKFZpZGVvRGVjb2RlciAqdmlk
ZW9fZGVjb2RlciwKIAogICAgIGxhc3RfZnJhbWUgPSBnX3F1ZXVlX3BlZWtfdGFpbChkZWNvZGVy
LT5tc2dxKTsKICAgICBpZiAobGFzdF9mcmFtZSkgewotICAgICAgICBpZiAoc3BpY2VfbW10aW1l
X2RpZmYoZnJhbWUtPm1tX3RpbWUsIGxhc3RfZnJhbWUtPm1tX3RpbWUpIDwgMCkgeworICAgICAg
ICBpZiAoc3BpY2VfbW10aW1lX2RpZmYoZnJhbWUtPnRpbWUsIGxhc3RfZnJhbWUtPnRpbWUpIDwg
MCkgewogICAgICAgICAgICAgLyogVGhpcyBzaG91bGQgcmVhbGx5IG5vdCBoYXBwZW4gKi8KICAg
ICAgICAgICAgIFNQSUNFX0RFQlVHKCJuZXctZnJhbWUtdGltZSA8IGxhc3QtZnJhbWUtdGltZSAo
JXUgPCAldSk6IgogICAgICAgICAgICAgICAgICAgICAgICAgIiByZXNldHRpbmcgc3RyZWFtIiwK
LSAgICAgICAgICAgICAgICAgICAgICAgIGZyYW1lLT5tbV90aW1lLAotICAgICAgICAgICAgICAg
ICAgICAgICAgbGFzdF9mcmFtZS0+bW1fdGltZSk7CisgICAgICAgICAgICAgICAgICAgICAgICBm
cmFtZS0+dGltZSwKKyAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RfZnJhbWUtPnRpbWUpOwog
ICAgICAgICAgICAgbWpwZWdfZGVjb2Rlcl9kcm9wX3F1ZXVlKGRlY29kZXIpOwogICAgICAgICB9
CiAgICAgfQpkaWZmIC0tZ2l0IGEvc3JjL2NoYW5uZWwtZGlzcGxheS1wcml2LmggYi9zcmMvY2hh
bm5lbC1kaXNwbGF5LXByaXYuaAppbmRleCA0OTVkZjdhYy4uYmFkZDlkNDIgMTAwNjQ0Ci0tLSBh
L3NyYy9jaGFubmVsLWRpc3BsYXktcHJpdi5oCisrKyBiL3NyYy9jaGFubmVsLWRpc3BsYXktcHJp
di5oCkBAIC0zOSw3ICszOSw3IEBAIHR5cGVkZWYgc3RydWN0IGRpc3BsYXlfc3RyZWFtIGRpc3Bs
YXlfc3RyZWFtOwogCiB0eXBlZGVmIHN0cnVjdCBTcGljZUZyYW1lIFNwaWNlRnJhbWU7CiBzdHJ1
Y3QgU3BpY2VGcmFtZSB7Ci0gICAgdWludDMyX3QgbW1fdGltZTsKKyAgICB1aW50MzJfdCB0aW1l
OwogICAgIFNwaWNlUmVjdCBkZXN0OwogCiAgICAgdWludDhfdCAqZGF0YTsKQEAgLTEyNCw4ICsx
MjQsMjIgQEAgc3RydWN0IGRpc3BsYXlfc3RyZWFtIHsKIAogICAgIFNwaWNlQ2hhbm5lbCAgICAg
ICAgICAgICAgICAqY2hhbm5lbDsKIAotICAgIC8qIHN0YXRzICovCiAgICAgdWludDMyX3QgICAg
ICAgICAgICAgZmlyc3RfZnJhbWVfbW1fdGltZTsKKyAgICB1aW50MzJfdCAgICAgICAgICAgICBs
YXN0X2ZyYW1lX21tX3RpbWU7CisgICAgdWludDMyX3QgICAgICAgICAgICAgbGFzdF9mcmFtZV90
aW1lOworCisgICAgLyogTGFnIG1hbmFnZW1lbnQgKHNlZSBkaXNwbGF5X2hhbmRsZV9zdHJlYW1f
ZGF0YSgpKSAqLworICAgIHVpbnQzMl90ICAgICAgICAgICAgIGRlbGF5OworICAgIHVpbnQzMl90
ICAgICAgICAgICAgIG1hcmdpbl9ldmFsX3N0YXJ0OworICAgIHVpbnQzMl90ICAgICAgICAgICAg
IG1hcmdpbl9ldmFsX2NvdW50OworICAgIGludDMyX3QgICAgICAgICAgICAgIG1pbl9tYXJnaW47
CisgICAgaW50MzJfdCAgICAgICAgICAgICAgbWluX21hcmdpbl9uZXh0OworICAgIGZsb2F0ICAg
ICAgICAgICAgICAgIGF2Z19tYXJnaW47CisgICAgaW50MzJfdCAgICAgICAgICAgICAgbWluX2F2
Z19tYXJnaW47CisgICAgaW50MzJfdCAgICAgICAgICAgICAgbWF4X2F2Z19tYXJnaW47CisgICAg
dWludDMyX3QgICAgICAgICAgICAgbWFyZ2luX3NwcmVhZDsKKworICAgIC8qIHN0YXRzICovCiAg
ICAgdWludDMyX3QgICAgICAgICAgICAgYXJyaXZlX2xhdGVfY291bnQ7CiAgICAgdWludDY0X3Qg
ICAgICAgICAgICAgYXJyaXZlX2xhdGVfdGltZTsKICAgICB1aW50MzJfdCAgICAgICAgICAgICBu
dW1fZHJvcHNfb25fcGxheWJhY2s7CmRpZmYgLS1naXQgYS9zcmMvY2hhbm5lbC1kaXNwbGF5LmMg
Yi9zcmMvY2hhbm5lbC1kaXNwbGF5LmMKaW5kZXggYjI2MzI2ZDYuLjgxNTI0MmRlIDEwMDY0NAot
LS0gYS9zcmMvY2hhbm5lbC1kaXNwbGF5LmMKKysrIGIvc3JjL2NoYW5uZWwtZGlzcGxheS5jCkBA
IC0yMCw2ICsyMCw3IEBACiAjaWZkZWYgSEFWRV9TWVNfVFlQRVNfSAogI2luY2x1ZGUgPHN5cy90
eXBlcy5oPgogI2VuZGlmCisjaW5jbHVkZSA8bWF0aC5oPiAvKiBmb3IgY2VpbGYoKSAqLwogCiAj
aW5jbHVkZSAic3BpY2UtY2xpZW50LmgiCiAjaW5jbHVkZSAic3BpY2UtY29tbW9uLmgiCkBAIC0x
Mzc4LDggKzEzNzksNyBAQCBzdGF0aWMgdWludDMyX3Qgc3BpY2VfbXNnX2luX2ZyYW1lX2RhdGEo
U3BpY2VNc2dJbiAqZnJhbWVfbXNnLCB1aW50OF90ICoqZGF0YSkKIEdfR05VQ19JTlRFUk5BTAog
Z3VpbnQzMiBzdHJlYW1fZ2V0X3RpbWUoZGlzcGxheV9zdHJlYW0gKnN0KQogewotICAgIFNwaWNl
U2Vzc2lvbiAqc2Vzc2lvbiA9IHNwaWNlX2NoYW5uZWxfZ2V0X3Nlc3Npb24oc3QtPmNoYW5uZWwp
OwotICAgIHJldHVybiBzZXNzaW9uID8gc3BpY2Vfc2Vzc2lvbl9nZXRfbW1fdGltZShzZXNzaW9u
KSA6IDA7CisgICAgcmV0dXJuIGdfZ2V0X21vbm90b25pY190aW1lKCkgLyAxMDAwOwogfQogCiAv
KiBjb3JvdXRpbmUgb3IgbWFpbiBjb250ZXh0ICovCkBAIC0xNjQzLDcgKzE2NDMsNyBAQCBzdGF0
aWMgdm9pZCBkaXNwbGF5X3N0cmVhbV9zdGF0c19zYXZlKGRpc3BsYXlfc3RyZWFtICpzdCwKIAog
c3RhdGljIFNwaWNlRnJhbWUgKnNwaWNlX2ZyYW1lX25ldyhkaXNwbGF5X3N0cmVhbSAqc3QsCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNwaWNlTXNnSW4gKmluLAotICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBndWludDMyIGZyYW1lX21tdGltZSkKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3VpbnQzMiBmcmFtZV90aW1lKQogewogICAg
IFNwaWNlRnJhbWUgKmZyYW1lOwogICAgIGd1aW50OCAqZGF0YV9wdHI7CkBAIC0xNjUxLDcgKzE2
NTEsNyBAQCBzdGF0aWMgU3BpY2VGcmFtZSAqc3BpY2VfZnJhbWVfbmV3KGRpc3BsYXlfc3RyZWFt
ICpzdCwKICAgICBndWludDMyIGRhdGFfc2l6ZSA9IHNwaWNlX21zZ19pbl9mcmFtZV9kYXRhKGlu
LCAmZGF0YV9wdHIpOwogCiAgICAgZnJhbWUgPSBnX25ldyhTcGljZUZyYW1lLCAxKTsKLSAgICBm
cmFtZS0+bW1fdGltZSA9IGZyYW1lX21tdGltZTsKKyAgICBmcmFtZS0+dGltZSA9IGZyYW1lX3Rp
bWU7CiAgICAgZnJhbWUtPmRlc3QgPSAqZGVzdF9yZWN0OwogICAgIGZyYW1lLT5kYXRhID0gZGF0
YV9wdHI7CiAgICAgZnJhbWUtPnNpemUgPSBkYXRhX3NpemU7CkBAIC0xNjcyLDQ0ICsxNjcyLDE4
NCBAQCB2b2lkIHNwaWNlX2ZyYW1lX2ZyZWUoU3BpY2VGcmFtZSAqZnJhbWUpCiAgICAgZ19mcmVl
KGZyYW1lKTsKIH0KIAorLyogUGljayBhbiBpbml0aWFsIHZhbHVlIGxpa2VseSB0byBjb3ZlciB0
aGUgbmV0d29yayBqaXR0ZXIgYW5kIG5vdCB0byBjYXVzZQorICogYSBzaWduaWZpY2FudCBsYWcu
IFRoZSBkZWxheSB3aWxsIGJlIGFkanVzdGVkIGZyb20gdGhlcmUuCisgKi8KKyNkZWZpbmUgSU5J
VElBTF9ERUxBWSA0MAorCisvKiBDb2xsZWN0IGRhdGEgb24gYSBsb25nIGVub3VnaCBwZXJpb2Qg
dG8gY2FwdHVyZSByYXJlIGV2ZW50cywgYnV0IHNob3J0CisgKiBlbm91Z2ggc28gdGhhdCB0aGUg
YWxnb3JpdGhtIGlzIHN0aWxsIHJlc3BvbnNpdmUgdG8gY2hhbmdlcy4KKyAqLworI2RlZmluZSBN
QVJHSU5fRVZBTF9USU1FICgxICogMTAwMCkKKworLyogTWFrZSBzdXJlIHdlIGhhdmUgZW5vdWdo
IGRhdGEgcG9pbnRzIGV2ZW4gaWYgdGhlIGZyYW1lcmF0ZSBpcyB2ZXJ5IGxvdy4gKi8KKyNkZWZp
bmUgTUFSR0lOX0VWQUxfQ09VTlQgMjAKKwogLyogY29yb3V0aW5lIGNvbnRleHQgKi8KIHN0YXRp
YyB2b2lkIGRpc3BsYXlfaGFuZGxlX3N0cmVhbV9kYXRhKFNwaWNlQ2hhbm5lbCAqY2hhbm5lbCwg
U3BpY2VNc2dJbiAqaW4pCiB7CisgICAgU3BpY2VTZXNzaW9uICpzZXNzaW9uID0gc3BpY2VfY2hh
bm5lbF9nZXRfc2Vzc2lvbihjaGFubmVsKTsKICAgICBTcGljZURpc3BsYXlDaGFubmVsUHJpdmF0
ZSAqYyA9IFNQSUNFX0RJU1BMQVlfQ0hBTk5FTChjaGFubmVsKS0+cHJpdjsKICAgICBTcGljZVN0
cmVhbURhdGFIZWFkZXIgKm9wID0gc3BpY2VfbXNnX2luX3BhcnNlZChpbik7CiAgICAgZGlzcGxh
eV9zdHJlYW0gKnN0ID0gZ2V0X3N0cmVhbV9ieV9pZChjaGFubmVsLCBvcC0+aWQpOwotICAgIGd1
aW50MzIgbW10aW1lOwotICAgIGludDMyX3QgbWFyZ2luLCBtYXJnaW5fcmVwb3J0OworICAgIGd1
aW50MzIgY3VycmVudF9tbXRpbWUsIGZyYW1lX2ludGVydmFsOworICAgIGd1aW50MzIgc3RyZWFt
X3RpbWUsIGZyYW1lX3RpbWU7CisgICAgZ2ludDMyIG1tdGltZV9tYXJnaW4sIG1hcmdpbjsKICAg
ICBTcGljZUZyYW1lICpmcmFtZTsKIAogICAgIGdfcmV0dXJuX2lmX2ZhaWwoc3QgIT0gTlVMTCk7
Ci0gICAgbW10aW1lID0gc3RyZWFtX2dldF90aW1lKHN0KTsKKworICAgIGN1cnJlbnRfbW10aW1l
ID0gc3BpY2Vfc2Vzc2lvbl9nZXRfbW1fdGltZShzZXNzaW9uKTsKIAogICAgIGlmIChzcGljZV9t
c2dfaW5fdHlwZShpbikgPT0gU1BJQ0VfTVNHX0RJU1BMQVlfU1RSRUFNX0RBVEFfU0laRUQpIHsK
ICAgICAgICAgQ0hBTk5FTF9ERUJVRyhjaGFubmVsLCAic3RyZWFtICV1IGNvbnRhaW5zIHNpemVk
IGRhdGEiLCBvcC0+aWQpOwogICAgIH0KIAorICAgIGZyYW1lX2ludGVydmFsID0gMDsKKyAgICBt
bXRpbWVfbWFyZ2luID0gNDAwOyAvKiBzZXJ2ZXIncyBkZWZhdWx0IG1tX3RpbWUgb2Zmc2V0ICov
CiAgICAgaWYgKG9wLT5tdWx0aV9tZWRpYV90aW1lID09IDApIHsKLSAgICAgICAgZ19jcml0aWNh
bCgiUmVjZWl2ZWQgZnJhbWUgd2l0aCBpbnZhbGlkIDAgdGltZXN0YW1wISBwZXJoYXBzIHdyb25n
IGdyYXBoaWMgZHJpdmVyPyIpOwotICAgICAgICBvcC0+bXVsdGlfbWVkaWFfdGltZSA9IG1tdGlt
ZSArIDEwMDsgLyogd29ya2Fyb3VuZC4uLiAqLwotICAgIH0KKyAgICAgICAgZ19jcml0aWNhbCgi
UmVjZWl2ZWQgZnJhbWUgd2l0aCBpbnZhbGlkIDAgdGltZXN0YW1wISBQZXJoYXBzIHdyb25nIGdy
YXBoaWMgZHJpdmVyPyIpOworICAgICAgICBvcC0+bXVsdGlfbWVkaWFfdGltZSA9IGN1cnJlbnRf
bW10aW1lOyAvKiB3b3JrYXJvdW5kLi4uICovCisgICAgICAgIGZyYW1lX2ludGVydmFsID0gc3Bp
Y2VfbW10aW1lX2RpZmYob3AtPm11bHRpX21lZGlhX3RpbWUsIHN0LT5sYXN0X2ZyYW1lX21tX3Rp
bWUpOworICAgIH0gZWxzZSBpZiAoc3QtPmxhc3RfZnJhbWVfbW1fdGltZSA9PSAwKSB7CisgICAg
ICAgIC8qIEZpcnN0IGZyYW1lIHNvIGZyYW1lX2ludGVydmFsIGlzIHVua25vd24gKi8KKyAgICAg
ICAgbW10aW1lX21hcmdpbiA9IHNwaWNlX21tdGltZV9kaWZmKG9wLT5tdWx0aV9tZWRpYV90aW1l
LCBjdXJyZW50X21tdGltZSk7CisgICAgfSBlbHNlIGlmIChvcC0+bXVsdGlfbWVkaWFfdGltZSA8
IHN0LT5sYXN0X2ZyYW1lX21tX3RpbWUpIHsKKyAgICAgICAgLyogVGhpcyBjYW4gaGFwcGVuIHdo
ZW4gbWlncmF0aW5nIGZyb20gYSBzZXJ2ZXIgd2l0aCBhIGhpZ2ggbW1fdGltZQorICAgICAgICAg
KiAoaS5lLiBoaWdoIHVwdGltZSkgdG8gb25lIHdpdGggYSBsb3cgbW1fdGltZToKKyAgICAgICAg
ICogLSBzZXJ2ZXIgQSBzZW5kcyBhIGZyYW1lIHdpdGggQV9tbV90aW1lCisgICAgICAgICAqIC0g
Y2xpZW50IHJlY2VpdmVzIHRoZSBmcmFtZSBhbmQgc2V0cyBsYXN0X2ZyYW1lX21tX3RpbWUgPSBB
X21tX3RpbWUKKyAgICAgICAgICogLSBzZXJ2ZXIgQiBzZW5kcyBhIGZyYW1lIHdpdGggQl9tbV90
aW1lCisgICAgICAgICAqIC0gY2xpZW50IHJlY2VpdmVzIHNlcnZlciBCJ3MgZnJhbWUgd2l0aCBC
X21tX3RpbWUgPDwgQV9tbV90aW1lCisgICAgICAgICAqIEFsc28gbm90ZSB0aGF0IGFsdGhvdWdo
IHNlcnZlciBCIHdvdWxkIG5vcm1hbGx5IHNlbmQgYW4gbW1fdGltZQorICAgICAgICAgKiByZXNl
dCBtZXNzYWdlLCB0aGVyZSBpcyBubyBndWFyYW50ZWUgaXQgd2lsbCBiZSByZWNlaXZlZCBiZWZv
cmUKKyAgICAgICAgICogc2VydmVyIEIncyBmaXJzdCBmcmFtZSBzbyBpdCdzIG5vdCBtdWNoIGhl
bHAuCisgICAgICAgICAqLworICAgICAgICBTUElDRV9ERUJVRygiJXUgZ290IGFuIG91dCBvZiBv
cmRlciBmcmFtZSAtJXUiLCBvcC0+aWQsCisgICAgICAgICAgICAgICAgICAgIHN0LT5sYXN0X2Zy
YW1lX21tX3RpbWUgLSBvcC0+bXVsdGlfbWVkaWFfdGltZSk7CisgICAgICAgIHN0LT5sYXN0X2Zy
YW1lX21tX3RpbWUgPSBvcC0+bXVsdGlfbWVkaWFfdGltZTsKKyAgICB9IGVsc2UgaWYgKG9wLT5t
dWx0aV9tZWRpYV90aW1lID4gc3QtPmxhc3RfZnJhbWVfbW1fdGltZSArIDEwMDApIHsKKyAgICAg
ICAgLyogU3RyZWFtcyBhcmUgc3VwcG9zZWQgdG8gc2VuZCBhdCBsZWFzdCAxIGZyYW1lIHBlciBz
ZWNvbmQuCisgICAgICAgICAqIFNvIGl0J3MgbW9yZSBsaWtlbHkgdGhhdCB3ZSBnb3QgbWlncmF0
ZWQgZnJvbSBhIHNlcnZlciB3aXRoIGEgbG93CisgICAgICAgICAqIG1tX3RpbWUgKGkuZS4gbG93
IHVwdGltZSkgdG8gb25lIHdpdGggYSBoaWdoIG1tX3RpbWUuIFNlZSB0aGUgY2FzZQorICAgICAg
ICAgKiBhYm92ZSBmb3IgZGV0YWlscy4gSW4gc3VjaCBhIGNhc2Ugc2ltcGx5IHJlaW5pdGlhbGl6
ZSB0aGUgc3RyZWFtLgorICAgICAgICAgKi8KKyAgICAgICAgU1BJQ0VfREVCVUcoIiV1IGdvdCBh
biBhYm5vcm1hbGx5IGxvbmcgbW1fdGltZSBmcmFtZSBpbnRlcnZhbCAldSIsIG9wLT5pZCwKKyAg
ICAgICAgICAgICAgICAgICAgb3AtPm11bHRpX21lZGlhX3RpbWUgLSBzdC0+bGFzdF9mcmFtZV9t
bV90aW1lKTsKKyAgICAgICAgc3QtPmxhc3RfZnJhbWVfdGltZSA9IDA7CisgICAgfSBlbHNlIHsK
KyAgICAgICAgbW10aW1lX21hcmdpbiA9IHNwaWNlX21tdGltZV9kaWZmKG9wLT5tdWx0aV9tZWRp
YV90aW1lLCBjdXJyZW50X21tdGltZSk7CisgICAgICAgIGZyYW1lX2ludGVydmFsID0gc3BpY2Vf
bW10aW1lX2RpZmYob3AtPm11bHRpX21lZGlhX3RpbWUsIHN0LT5sYXN0X2ZyYW1lX21tX3RpbWUp
OworICAgIH0KKyAgICBkaXNwbGF5X3N0cmVhbV9zdGF0c19zYXZlKHN0LCBvcC0+bXVsdGlfbWVk
aWFfdGltZSwgY3VycmVudF9tbXRpbWUpOworICAgIHN0LT5sYXN0X2ZyYW1lX21tX3RpbWUgPSBv
cC0+bXVsdGlfbWVkaWFfdGltZTsKKworICAgIC8qIENvbXB1dGUgdGhlIGxvY2FsIGZyYW1lIG1t
dGltZSAqLworICAgIHN0cmVhbV90aW1lID0gc3RyZWFtX2dldF90aW1lKHN0KTsKKyAgICBmcmFt
ZV90aW1lID0gc3BpY2Vfc2Vzc2lvbl9nZXRfY2xpZW50X3RpbWUoc2Vzc2lvbiwgb3AtPm11bHRp
X21lZGlhX3RpbWUpOworICAgIGd1aW50MzIgdGFyZ2V0X2xhZyA9IHNwaWNlX3Nlc3Npb25fZ2V0
X3BsYXliYWNrX2xhdGVuY3koc2Vzc2lvbik7CisgICAgaWYgKHN0LT5sYXN0X2ZyYW1lX3RpbWUg
PT0gMCkgeworICAgICAgICBtYXJnaW4gPSBzcGljZV9tbXRpbWVfZGlmZihmcmFtZV90aW1lLCBz
dHJlYW1fdGltZSk7CisgICAgICAgIHN0LT5kZWxheSA9IE1BWCh0YXJnZXRfbGFnIC0gbWFyZ2lu
LCBJTklUSUFMX0RFTEFZKTsKKyAgICAgICAgZnJhbWVfdGltZSArPSBzdC0+ZGVsYXk7CisgICAg
ICAgIG1hcmdpbiArPSBzdC0+ZGVsYXk7CisKKyAgICAgICAgc3QtPm1hcmdpbl9ldmFsX3N0YXJ0
ID0gc3RyZWFtX3RpbWU7CisgICAgICAgIHN0LT5tYXJnaW5fZXZhbF9jb3VudCA9IDA7CisgICAg
ICAgIHN0LT5taW5fbWFyZ2luID0gMDsgLyogRm9yY2Ugd2FpdCBiZWZvcmUgcmVkdWNpbmcgdGhl
IGRlbGF5ICovCisgICAgICAgIHN0LT5taW5fbWFyZ2luX25leHQgPSBtYXJnaW47CisgICAgICAg
IHN0LT5hdmdfbWFyZ2luID0gbWFyZ2luOworICAgICAgICBzdC0+bWF4X2F2Z19tYXJnaW4gPSBz
dC0+bWluX2F2Z19tYXJnaW4gPSBtYXJnaW47CisgICAgICAgIHN0LT5tYXJnaW5fc3ByZWFkID0g
c3QtPmRlbGF5OworICAgIH0gZWxzZSB7CisgICAgICAgIGZyYW1lX3RpbWUgPSBNQVgoZnJhbWVf
dGltZSArIHN0LT5kZWxheSwKKyAgICAgICAgICAgICAgICAgICAgICAgICBzdC0+bGFzdF9mcmFt
ZV90aW1lICsgKGZyYW1lX2ludGVydmFsICsgMykgLyA0KTsKKyAgICAgICAgbWFyZ2luID0gc3Bp
Y2VfbW10aW1lX2RpZmYoZnJhbWVfdGltZSwgc3RyZWFtX3RpbWUpOworCisgICAgICAgIC8qIE5v
dGUgdGhhdCB3aGVuIHVzaW5nIGludGVnZXJzIHRoZSBtb3ZpbmcgYXZlcmFnZSBjYW4gc3RhYmls
aXplIHVwIHRvCisgICAgICAgICAqIHdlaWdodC8yLTEgYXdheSBmcm9tIHRoZSB0cnVlIGF2ZXJh
Z2UgKHdoZXJlIHdlaWdodD0xNiBoZXJlKSBkdWUKKyAgICAgICAgICogdG8gdGhlIHJvdW5kaW5n
IGVycm9ycyAoZS5nLiBjb25zaWRlciAxIDE2IDE2Li4uKS4KKyAgICAgICAgICogU28gdXNlIGEg
ZmxvYXQgZm9yIGF2Z19tYXJnaW4uCisgICAgICAgICAqLworICAgICAgICBzdC0+YXZnX21hcmdp
biA9IChzdC0+YXZnX21hcmdpbiAqIDE1ICsgbWFyZ2luKSAvIDE2OworICAgICAgICBpZiAoc3Qt
PmF2Z19tYXJnaW4gPCBzdC0+bWluX2F2Z19tYXJnaW4pIHsKKyAgICAgICAgICAgIHN0LT5taW5f
YXZnX21hcmdpbiA9IHN0LT5hdmdfbWFyZ2luOworICAgICAgICB9IGVsc2UgaWYgKHN0LT5hdmdf
bWFyZ2luID4gc3QtPm1heF9hdmdfbWFyZ2luKSB7CisgICAgICAgICAgICBzdC0+bWF4X2F2Z19t
YXJnaW4gPSBjZWlsZihzdC0+YXZnX21hcmdpbik7CisgICAgICAgIH0KKworICAgICAgICBpZiAo
bWFyZ2luIDwgc3QtPm1pbl9tYXJnaW5fbmV4dCkgeworICAgICAgICAgICAgc3QtPm1pbl9tYXJn
aW5fbmV4dCA9IG1hcmdpbjsKKyAgICAgICAgICAgIC8qIFRha2UgaW50byBhY2NvdW50IHNpZ25z
IHRoYXQgdGhlIHNpdHVhdGlvbiB3b3JzZW5lZCB3aXRob3V0CisgICAgICAgICAgICAgKiBkZWxh
eS4KKyAgICAgICAgICAgICAqLworICAgICAgICAgICAgc3QtPm1pbl9tYXJnaW4gPSBNSU4oc3Qt
Pm1pbl9tYXJnaW4sIHN0LT5taW5fbWFyZ2luX25leHQpOworICAgICAgICB9CiAKLSAgICBtYXJn
aW4gPSBtYXJnaW5fcmVwb3J0ID0gb3AtPm11bHRpX21lZGlhX3RpbWUgLSBtbXRpbWU7Ci0gICAg
aWYgKG1hcmdpbiA+IDApIHsKLSAgICAgICAgU3BpY2VTZXNzaW9uICpzID0gc3BpY2VfY2hhbm5l
bF9nZXRfc2Vzc2lvbihjaGFubmVsKTsKKyAgICAgICAgLyogT25seSByZXBsYWNlIHRoZSBjdXJy
ZW50IG1pbl9tYXJnaW4gYW5kIG1hcmdpbl9zcHJlYWQgZXN0aW1hdGVzIG9uY2UKKyAgICAgICAg
ICogZW5vdWdoIGRhdGEgaGFzIGJlZW4gY29sbGVjdGVkIGZvciB0aGUgKl9uZXh0IHZhbHVlcywg
Ym90aCBpbiB0ZXJtCisgICAgICAgICAqIG9mIGVsYXBzZWQgdGltZSBhbmQgbnVtYmVyIG9mIGZy
YW1lcy4KKyAgICAgICAgICovCisgICAgICAgIHN0LT5tYXJnaW5fZXZhbF9jb3VudCsrOworICAg
ICAgICBpZiAoc3RyZWFtX3RpbWUgLSBzdC0+bWFyZ2luX2V2YWxfc3RhcnQgPiBNQVJHSU5fRVZB
TF9USU1FICYmCisgICAgICAgICAgICBzdC0+bWFyZ2luX2V2YWxfY291bnQgPj0gTUFSR0lOX0VW
QUxfQ09VTlQpIHsKKyAgICAgICAgICAgIHN0LT5taW5fbWFyZ2luID0gc3QtPm1pbl9tYXJnaW5f
bmV4dDsKKworICAgICAgICAgICAgc3QtPm1hcmdpbl9ldmFsX3N0YXJ0ID0gc3RyZWFtX3RpbWU7
CisgICAgICAgICAgICBzdC0+bWFyZ2luX2V2YWxfY291bnQgPSAxOworICAgICAgICAgICAgc3Qt
Pm1pbl9tYXJnaW5fbmV4dCA9IG1hcmdpbjsKKworICAgICAgICAgICAgc3QtPm1hcmdpbl9zcHJl
YWQgPSAoc3QtPm1heF9hdmdfbWFyZ2luIC0gc3QtPm1pbl9hdmdfbWFyZ2luICsgMSkgLyAyOwor
ICAgICAgICAgICAgc3QtPm1pbl9hdmdfbWFyZ2luID0gc3QtPmF2Z19tYXJnaW47CisgICAgICAg
ICAgICBzdC0+bWF4X2F2Z19tYXJnaW4gPSBjZWlsZihzdC0+YXZnX21hcmdpbik7CisgICAgICAg
IH0KIAotICAgICAgICBpZiAoc3QtPnN1cmZhY2UtPnN0cmVhbWluZ19tb2RlICYmICFzcGljZV9z
ZXNzaW9uX2lzX3BsYXliYWNrX2FjdGl2ZShzKSkgewotICAgICAgICAgICAgQ0hBTk5FTF9ERUJV
RyhjaGFubmVsLCAidmlkZW8gbWFyZ2luOiAlZCwgc2V0IHRvIDAgc2luY2UgdGhlcmUgaXMgbm8g
cGxheWJhY2siLCBtYXJnaW4pOwotICAgICAgICAgICAgbWFyZ2luID0gMDsKKyAgICAgICAgaWYg
KG1hcmdpbiA8IDApIHsKKyAgICAgICAgICAgIGdpbnQzMiBudWRnZSA9IC1tYXJnaW47CisgICAg
ICAgICAgICBtYXJnaW4gKz0gbnVkZ2U7CisgICAgICAgICAgICBzdC0+ZGVsYXkgKz0gbnVkZ2U7
CisgICAgICAgICAgICBmcmFtZV90aW1lID0gc3RyZWFtX3RpbWUgKyAoZnJhbWVfaW50ZXJ2YWwg
KyAzKSAvIDQ7CisKKyAgICAgICAgICAgIC8qIFRoZSBkZWxheSBudWRnZSBhbHNvIGltcGFjdHMg
dGhlIG1hcmdpbiBoaXN0b3J5ICovCisgICAgICAgICAgICBzdC0+bWluX21hcmdpbl9uZXh0ICs9
IG51ZGdlOworICAgICAgICAgICAgc3QtPm1pbl9tYXJnaW4gPSBtYXJnaW47CisgICAgICAgICAg
ICBzdC0+YXZnX21hcmdpbiArPSBudWRnZTsKKyAgICAgICAgICAgIHN0LT5taW5fYXZnX21hcmdp
biArPSBudWRnZTsKKyAgICAgICAgICAgIHN0LT5tYXhfYXZnX21hcmdpbiArPSBudWRnZTsKKyAg
ICAgICAgfSBlbHNlIHsKKyAgICAgICAgICAgIC8qIFRyeSB0byBtYXRjaCB0aGUgdGFyZ2V0IGxh
ZyB3aXRob3V0IG1ha2luZyBuZWVkbGVzcyBhZGp1c3RtZW50cworICAgICAgICAgICAgICogZm9y
IG1pbm9yIG9mZnNldHMuCisgICAgICAgICAgICAgKi8KKyAgICAgICAgICAgIGdpbnQzMiBudWRn
ZSA9IDA7CisgICAgICAgICAgICBpZiAoc3QtPmF2Z19tYXJnaW4gKyBzdC0+bWFyZ2luX3NwcmVh
ZCA8IHRhcmdldF9sYWcpIHsKKyAgICAgICAgICAgICAgICBudWRnZSA9IE1JTigoZnJhbWVfaW50
ZXJ2YWwgKyAzKSAvIDQsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0X2xhZyAt
IHN0LT5hdmdfbWFyZ2luKTsKKyAgICAgICAgICAgIH0gZWxzZSBpZiAoc3QtPm1pbl9tYXJnaW4g
PiAwICYmCisgICAgICAgICAgICAgICAgICAgICAgIHN0LT5hdmdfbWFyZ2luICA+IHRhcmdldF9s
YWcgKyBzdC0+bWFyZ2luX3NwcmVhZCkgeworICAgICAgICAgICAgICAgIG51ZGdlID0gLU1JTigo
ZnJhbWVfaW50ZXJ2YWwgKyAzKSAvIDQsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1J
TihzdC0+YXZnX21hcmdpbiAtIHRhcmdldF9sYWcsCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBzdC0+bWluX21hcmdpbikpOworICAgICAgICAgICAgfQorICAgICAgICAgICAgaWYg
KG51ZGdlKSB7CisgICAgICAgICAgICAgICAgc3QtPmRlbGF5ICs9IG51ZGdlOworICAgICAgICAg
ICAgICAgIGZyYW1lX3RpbWUgKz0gbnVkZ2U7CisKKyAgICAgICAgICAgICAgICAvKiBUaGUgZGVs
YXkgbnVkZ2UgYWxzbyBpbXBhY3RzIHRoZSBtYXJnaW4gaGlzdG9yeSAqLworICAgICAgICAgICAg
ICAgIHN0LT5taW5fbWFyZ2luX25leHQgKz0gbnVkZ2U7CisgICAgICAgICAgICAgICAgc3QtPm1p
bl9tYXJnaW4gKz0gbnVkZ2U7CisgICAgICAgICAgICAgICAgc3QtPmF2Z19tYXJnaW4gKz0gbnVk
Z2U7CisgICAgICAgICAgICAgICAgc3QtPm1pbl9hdmdfbWFyZ2luICs9IG51ZGdlOworICAgICAg
ICAgICAgICAgIHN0LT5tYXhfYXZnX21hcmdpbiArPSBudWRnZTsKKyAgICAgICAgICAgIH0KICAg
ICAgICAgfQogICAgIH0KLSAgICBkaXNwbGF5X3N0cmVhbV9zdGF0c19zYXZlKHN0LCBvcC0+bXVs
dGlfbWVkaWFfdGltZSwgbW10aW1lKTsKKyAgICBzdC0+bGFzdF9mcmFtZV90aW1lID0gZnJhbWVf
dGltZTsKIAogICAgIC8qIExldCB0aGUgdmlkZW8gZGVjb2RlciBxdWV1ZSB0aGUgZnJhbWVzIHNv
IGl0IGNhbiBvcHRpbWl6ZSB0aGVpcgogICAgICAqIGRlY29kaW5nIGFuZCBiZXN0IGRlY2lkZSBp
Zi93aGVuIHRvIGRyb3AgdGhlbSB3aGVuIHRoZXkgYXJlIGxhdGUsCiAgICAgICogdGFraW5nIGlu
dG8gYWNjb3VudCB0aGUgaW1wYWN0IG9uIGxhdGVyIGZyYW1lcy4KICAgICAgKi8KLSAgICBmcmFt
ZSA9IHNwaWNlX2ZyYW1lX25ldyhzdCwgaW4sIG9wLT5tdWx0aV9tZWRpYV90aW1lKTsKKyAgICBm
cmFtZSA9IHNwaWNlX2ZyYW1lX25ldyhzdCwgaW4sIGZyYW1lX3RpbWUpOwogICAgIGlmICghc3Qt
PnZpZGVvX2RlY29kZXItPnF1ZXVlX2ZyYW1lKHN0LT52aWRlb19kZWNvZGVyLCBmcmFtZSwgbWFy
Z2luKSkgewogICAgICAgICBkZXN0cm95X3N0cmVhbShjaGFubmVsLCBvcC0+aWQpOwogICAgICAg
ICByZXBvcnRfaW52YWxpZF9zdHJlYW0oY2hhbm5lbCwgb3AtPmlkKTsKQEAgLTE3MTgsNyArMTg1
OCw3IEBAIHN0YXRpYyB2b2lkIGRpc3BsYXlfaGFuZGxlX3N0cmVhbV9kYXRhKFNwaWNlQ2hhbm5l
bCAqY2hhbm5lbCwgU3BpY2VNc2dJbiAqaW4pCiAKICAgICBpZiAoYy0+ZW5hYmxlX2FkYXB0aXZl
X3N0cmVhbWluZykgewogICAgICAgICBkaXNwbGF5X3VwZGF0ZV9zdHJlYW1fcmVwb3J0KFNQSUNF
X0RJU1BMQVlfQ0hBTk5FTChjaGFubmVsKSwgb3AtPmlkLAotICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIG9wLT5tdWx0aV9tZWRpYV90aW1lLCBtYXJnaW5fcmVwb3J0KTsKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcC0+bXVsdGlfbWVkaWFfdGltZSwg
bW10aW1lX21hcmdpbik7CiAgICAgICAgIGlmIChzdC0+cGxheWJhY2tfc3luY19kcm9wc19zZXFf
bGVuID49IFNUUkVBTV9QTEFZQkFDS19TWU5DX0RST1BfU0VRX0xFTl9MSU1JVCkgewogICAgICAg
ICAgICAgc3BpY2Vfc2Vzc2lvbl9zeW5jX3BsYXliYWNrX2xhdGVuY3koc3BpY2VfY2hhbm5lbF9n
ZXRfc2Vzc2lvbihjaGFubmVsKSk7CiAgICAgICAgICAgICBzdC0+cGxheWJhY2tfc3luY19kcm9w
c19zZXFfbGVuID0gMDsKZGlmZiAtLWdpdCBhL3NyYy9zcGljZS1zZXNzaW9uLXByaXYuaCBiL3Ny
Yy9zcGljZS1zZXNzaW9uLXByaXYuaAppbmRleCA2ZWNlN2UwMS4uNzk0ZDg2YTcgMTAwNjQ0Ci0t
LSBhL3NyYy9zcGljZS1zZXNzaW9uLXByaXYuaAorKysgYi9zcmMvc3BpY2Utc2Vzc2lvbi1wcml2
LmgKQEAgLTUwLDYgKzUwLDcgQEAgR1NvY2tldENvbm5lY3Rpb24qIHNwaWNlX3Nlc3Npb25fY2hh
bm5lbF9vcGVuX2hvc3QoU3BpY2VTZXNzaW9uICpzZXNzaW9uLCBTcGljZUMKIHZvaWQgc3BpY2Vf
c2Vzc2lvbl9jaGFubmVsX25ldyhTcGljZVNlc3Npb24gKnNlc3Npb24sIFNwaWNlQ2hhbm5lbCAq
Y2hhbm5lbCk7CiB2b2lkIHNwaWNlX3Nlc3Npb25fY2hhbm5lbF9taWdyYXRlKFNwaWNlU2Vzc2lv
biAqc2Vzc2lvbiwgU3BpY2VDaGFubmVsICpjaGFubmVsKTsKIAorZ3VpbnQzMiBzcGljZV9zZXNz
aW9uX2dldF9jbGllbnRfdGltZShTcGljZVNlc3Npb24gKnNlc3Npb24sIGd1aW50MzIgc3JjX3Rp
bWUpOwogdm9pZCBzcGljZV9zZXNzaW9uX3NldF9tbV90aW1lKFNwaWNlU2Vzc2lvbiAqc2Vzc2lv
biwgZ3VpbnQzMiB0aW1lKTsKIGd1aW50MzIgc3BpY2Vfc2Vzc2lvbl9nZXRfbW1fdGltZShTcGlj
ZVNlc3Npb24gKnNlc3Npb24pOwogCmRpZmYgLS1naXQgYS9zcmMvc3BpY2Utc2Vzc2lvbi5jIGIv
c3JjL3NwaWNlLXNlc3Npb24uYwppbmRleCAwNGJhMTI0YS4uNGU1YTc4MjMgMTAwNjQ0Ci0tLSBh
L3NyYy9zcGljZS1zZXNzaW9uLmMKKysrIGIvc3JjL3NwaWNlLXNlc3Npb24uYwpAQCAtMTAyLDYg
KzEwMiw3IEBAIHN0cnVjdCBfU3BpY2VTZXNzaW9uUHJpdmF0ZSB7CiAgICAgZ3VpbnQgICAgICAg
ICAgICAgY2hhbm5lbHNfZGVzdHJveWluZzsKICAgICBnYm9vbGVhbiAgICAgICAgICBjbGllbnRf
cHJvdmlkZWRfc29ja2V0czsKICAgICBndWludDY0ICAgICAgICAgICBtbV90aW1lX29mZnNldDsK
KyAgICBnaW50NjQgICAgICAgICAgICBjbGllbnRfdGltZV9vZmZzZXQ7CiAgICAgU3BpY2VTZXNz
aW9uICAgICAgKm1pZ3JhdGlvbjsKICAgICBHTGlzdCAgICAgICAgICAgICAqbWlncmF0aW9uX2xl
ZnQ7CiAgICAgU3BpY2VTZXNzaW9uTWlncmF0aW9uIG1pZ3JhdGlvbl9zdGF0ZTsKQEAgLTEyOSw2
ICsxMzAsMTAgQEAgc3RydWN0IF9TcGljZVNlc3Npb25Qcml2YXRlIHsKICAgICBQaG9kYXZTZXJ2
ZXIgICAgICAqd2ViZGF2OwogfTsKIAorLyogSW5pdGlhbGl6ZSB0aGUgY2xpZW50X3RpbWVfb2Zm
c2V0IHRvIGFuIHVubGlrZWx5IHZhbHVlLgorICogU2VlIHNwaWNlX3Nlc3Npb25fZ2V0X2NsaWVu
dF90aW1lKCkuCisgKi8KKyMgZGVmaW5lIFVOU0VUX0NMSUVOVF9USU1FX09GRlNFVCAweGQxY2Vj
YTVlCiAKIC8qKgogICogU0VDVElPTjpzcGljZS1zZXNzaW9uCkBAIC0yOTIsNiArMjk3LDcgQEAg
c3RhdGljIHZvaWQgc3BpY2Vfc2Vzc2lvbl9pbml0KFNwaWNlU2Vzc2lvbiAqc2Vzc2lvbikKICAg
ICBTUElDRV9ERUJVRygiU3VwcG9ydGVkIGNoYW5uZWxzOiAlcyIsIGNoYW5uZWxzKTsKICAgICBn
X2ZyZWUoY2hhbm5lbHMpOwogCisgICAgcy0+Y2xpZW50X3RpbWVfb2Zmc2V0ID0gVU5TRVRfQ0xJ
RU5UX1RJTUVfT0ZGU0VUOwogICAgIHMtPmltYWdlcyA9IGNhY2hlX2ltYWdlX25ldygoR0Rlc3Ry
b3lOb3RpZnkpcGl4bWFuX2ltYWdlX3VucmVmKTsKICAgICBzLT5nbHpfd2luZG93ID0gZ2x6X2Rl
Y29kZXJfd2luZG93X25ldygpOwogICAgIHVwZGF0ZV9wcm94eShzZXNzaW9uLCBOVUxMKTsKQEAg
LTIzODUsNiArMjM5MSw0NiBAQCBpbnQgc3BpY2Vfc2Vzc2lvbl9nZXRfY29ubmVjdGlvbl9pZChT
cGljZVNlc3Npb24gKnNlc3Npb24pCiAgICAgcmV0dXJuIHMtPmNvbm5lY3Rpb25faWQ7CiB9CiAK
K0dfR05VQ19JTlRFUk5BTAorZ3VpbnQzMiBzcGljZV9zZXNzaW9uX2dldF9jbGllbnRfdGltZShT
cGljZVNlc3Npb24gKnNlc3Npb24sIGd1aW50MzIgbW10aW1lKQoreworICAgIGdfcmV0dXJuX3Zh
bF9pZl9mYWlsKFNQSUNFX0lTX1NFU1NJT04oc2Vzc2lvbiksIGdfZ2V0X21vbm90b25pY190aW1l
KCkpOworCisgICAgU3BpY2VTZXNzaW9uUHJpdmF0ZSAqcyA9IHNlc3Npb24tPnByaXY7CisKKyAg
ICBndWludDMyIG5vdyA9IGdfZ2V0X21vbm90b25pY190aW1lKCkgLyAxMDAwOworICAgIGdpbnQ2
NCBuZXdfb2Zmc2V0ID0gbm93IC0gbW10aW1lOworCisgICAgaWYgKHMtPmNsaWVudF90aW1lX29m
ZnNldCA9PSBVTlNFVF9DTElFTlRfVElNRV9PRkZTRVQpIHsKKyAgICAgICAgLyogSW5pdGlhbGl6
ZSB0aGUgdGltZSBvZmZzZXQuCisgICAgICAgICAqIE5vdGUgdGhhdCBVTlNFVF9DTElFTlRfVElN
RV9PRkZTRVQgY2FuIGJlIGFueSB2YWx1ZSBpbmNsdWRpbmcgMAorICAgICAgICAgKiB3aGljaCBp
cyBjb21tb24gb24gbG93LWxhdGVuY3kgTEFOcy4gQnV0IGFuIHVubGlrZWx5IG9uZSBoZWxwcyB3
aGVuCisgICAgICAgICAqIGFkZGluZyBhIHRyYWNlIGluIHRoaXMgY29kZXBhdGguCisgICAgICAg
ICAqLworICAgICAgICBzLT5jbGllbnRfdGltZV9vZmZzZXQgPSBuZXdfb2Zmc2V0OworICAgICAg
ICByZXR1cm4gbm93OworICAgIH0KKyAgICBpZiAobmV3X29mZnNldCA8IHMtPmNsaWVudF90aW1l
X29mZnNldCAtIDEwMDAgfHwKKyAgICAgICAgbmV3X29mZnNldCA+IHMtPmNsaWVudF90aW1lX29m
ZnNldCArIDEwMDApIHsKKyAgICAgICAgLyogVGhlIGNoYW5nZSBpbiBvZmZzZXQgd2FzIGxpa2Vs
eSBjYXVzZWQgYnkgYSBzZXJ2ZXIgbWlncmF0aW9uLgorICAgICAgICAgKiBSZXNldCB0aGUgdGlt
ZSBvZmZzZXQuCisgICAgICAgICAqLworICAgICAgICBzLT5jbGllbnRfdGltZV9vZmZzZXQgPSBu
ZXdfb2Zmc2V0OworICAgICAgICByZXR1cm4gbm93OworICAgIH0KKyAgICBpZiAobmV3X29mZnNl
dCA8IHMtPmNsaWVudF90aW1lX29mZnNldCkgeworICAgICAgICAvKiBUaGUgcHJldmlvdXMgbWVz
c2FnZSB3ZSB1c2VkIHRvIGNvbXB1dGUgdGhlIG9mZnNldCB3YXMgcHJvYmFibHkKKyAgICAgICAg
ICogZGVsYXllZCByZXN1bHRpbmcgaW4gYSB0b28gbGFyZ2Ugb2Zmc2V0LiBFdmVudHVhbGx5IHRo
ZSBvZmZzZXQKKyAgICAgICAgICogc2hvdWxkIHNldHRsZSB0byB0aGUgdHJ1ZSBjbG9jayBvZmZz
ZXQgcGx1cyB0aGUgbmV0d29yayBsYXRlbmN5LAorICAgICAgICAgKiBleGNsdWRpbmcgdGhlIG5l
dHdvcmsgaml0dGVyLgorICAgICAgICAgKi8KKyAgICAgICAgcy0+Y2xpZW50X3RpbWVfb2Zmc2V0
ID0gbmV3X29mZnNldDsKKyAgICAgICAgcmV0dXJuIG5vdzsKKyAgICB9CisKKyAgICByZXR1cm4g
bW10aW1lICsgcy0+Y2xpZW50X3RpbWVfb2Zmc2V0OworfQorCiBHX0dOVUNfSU5URVJOQUwKIGd1
aW50MzIgc3BpY2Vfc2Vzc2lvbl9nZXRfbW1fdGltZShTcGljZVNlc3Npb24gKnNlc3Npb24pCiB7
Ci0tIAoyLjIwLjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fClNwaWNlLWRldmVsIG1haWxpbmcgbGlzdApTcGljZS1kZXZlbEBsaXN0cy5mcmVlZGVza3Rv
cC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9zcGlj
ZS1kZXZlbA==
