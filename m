Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 486C8A4FE0
	for <lists+spice-devel@lfdr.de>; Mon,  2 Sep 2019 09:29:15 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 48EAF892EE;
	Mon,  2 Sep 2019 07:29:13 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 1595F892EE
 for <spice-devel@lists.freedesktop.org>; Mon,  2 Sep 2019 07:29:12 +0000 (UTC)
Received: from mail-wm1-f70.google.com (mail-wm1-f70.google.com
 [209.85.128.70])
 (using TLSv1.2 with cipher ECDHE-RSA-AES128-GCM-SHA256 (128/128 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id 4FE5085543
 for <spice-devel@lists.freedesktop.org>; Mon,  2 Sep 2019 07:29:11 +0000 (UTC)
Received: by mail-wm1-f70.google.com with SMTP id c11so3270700wml.6
 for <spice-devel@lists.freedesktop.org>; Mon, 02 Sep 2019 00:29:11 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:subject:date:message-id:mime-version
 :content-transfer-encoding;
 bh=K/Ju+zA2YvRO0XAiVOuhM9ZtW9ZWeCgfzuqzemF8wmI=;
 b=N2no9T81tKsJj8tjuNxADPjOV+U893Ow/gXRoolZBFf5K80ytjYb4s+qj2SQ9UgYze
 d0nE489huCvvUDyoVUQWDQvQ1TYJhYkRFi/ush26FKDZ9USr2aFh1tI+LKPaYE/8vvMl
 FOseCc3hxL1yKWQDjgrAfi1MkXLhKLQgkNlazGzxI8msT1jwamS5BQfUr1ggNyzLM2ja
 /pIYrlYRj4ApNVnt/n1jnWK72cgaTTWtXBjmM/SywGtLDuSTUNAs/7s0DWxgi79pyYd2
 gE/6KYIL6s3dI9/8kPlLuF1gDYmPvRHBuZBn1ulhamtvPNpJoUTL0Vx+F/Es1TlX+7h5
 u0IA==
X-Gm-Message-State: APjAAAUQBSncUGJKZ2hrk8PzFs9J3oSlVidSeCAe88cknF+VA/kaXDrp
 O5MUjVn/FfF9GbSKALomhso4n5zN5dJ6hMy6SrW5xSTer2Wd3r07V1SvVVcRTxNFvloP2NqquME
 I42wEBWhA5fVRSpxvQ23BrwjSWFWaB0A=
X-Received: by 2002:a05:600c:2144:: with SMTP id
 v4mr34537460wml.146.1567409349761; 
 Mon, 02 Sep 2019 00:29:09 -0700 (PDT)
X-Google-Smtp-Source: APXvYqxSi9rLvEg0oDmwEjK94TOYEsbNy9AFHf48I8Ml0EUetFbsO5KDA/TM5yMvsNeMc9NMkv7Gcw==
X-Received: by 2002:a05:600c:2144:: with SMTP id
 v4mr34537438wml.146.1567409349474; 
 Mon, 02 Sep 2019 00:29:09 -0700 (PDT)
Received: from localhost.localdomain ([2001:861:3440:6a0:2cf1:592d:314d:825])
 by smtp.gmail.com with ESMTPSA id
 f75sm19710719wmf.2.2019.09.02.00.29.07
 for <spice-devel@lists.freedesktop.org>
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Mon, 02 Sep 2019 00:29:08 -0700 (PDT)
From: Kevin Pouget <kpouget@redhat.com>
To: spice-devel@lists.freedesktop.org
Date: Mon,  2 Sep 2019 09:27:57 +0200
Message-Id: <20190902072757.27577-1-kpouget@redhat.com>
X-Mailer: git-send-email 2.21.0
MIME-Version: 1.0
Subject: [Spice-devel] [PATCH] stream-channel: Add preferred video codec
 capability
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

VGhpcyBwYXRjaCBlbmFibGVzIHRoZSBTUElDRV9ESVNQTEFZX0NBUF9QUkVGX1ZJREVPX0NPREVD
X1RZUEUKY2FwYWJpbGl0eSBmb3IgdGhlIHN0cmVhbS1jaGFubmVsLgoKdmlkZW9fc3RyZWFtX3Bh
cnNlX3ByZWZlcnJlZF9jb2RlY3M6IG5ldyBmdW5jdGlvbiBmb3IgcGFyc2luZyB0aGUKU1BJQ0Ug
cHJvdG9jb2wgbWVzc2FnZS4gVGhpcyBjb2RlIHVzZWQgdG8gaW4gaW5zaWRlCmRjY19oYW5kbGVf
cHJlZmVycmVkX3ZpZGVvX2NvZGVjX3R5cGUuCgpzdHJ1Y3QgU3RyZWFtQ2hhbm5lbENsaWVudDo6
Y2xpZW50X3ByZWZlcnJlZF92aWRlb19jb2RlY3M6IG5ldyBmaWVsZC4KClNpZ25lZC1vZmYtYnk6
IEtldmluIFBvdWdldCA8a3BvdWdldEByZWRoYXQuY29tPgotLS0KClRoaXMgcGF0Y2ggYWRkcyB0
aGUgY2xpZW50IHByZWZlcnJlZCB2aWRlbyBjb2RlY3MgY2FwYWJpbGl0eSwgYW5kCnN0b3JlcyB0
aGUgbGlzdCBpbiB0aGUgU3RyZWFtQ2hhbm5lbENsaWVudCBmaWVsZHMsIGJ1dCBkb2Vzbid0IHBh
c3MgaXQKaW4gYW55d2F5IHRvIHRoZSBzdHJlYW1pbmctYWdlbnQuCgpXZSBjYW4gZGVjaWRlIGxh
dGVyIG9uIHdoYXQncyB0aGUgcmlnaHQgdGhpbmcgdG8gZG8gd2l0aCB0aGlzCmxpc3QuIFNlZSB0
aG9zZSBSRkMgcGF0Y2hlcyBmb3IgYSBwb3NzaWJpbGl0eToKCj4gc3RyZWFtLWNoYW5uZWw6IFVz
ZSB0aGUgcHJlZmVycmVkIGNvZGVjIGxpc3QgaW5zdGVhZCBvZiBzdXBwb3J0ZWQKPj4gaHR0cHM6
Ly9wYXRjaHdvcmsuZnJlZWRlc2t0b3Aub3JnL3BhdGNoLzMyMjAzOS8/c2VyaWVzPTY0Nzg3JnJl
dj0zCj4gc3RyZWFtaW5nOiBSZXN0YXJ0IGd1ZXN0IHZpZGVvIHN0cmVhbXMgb24gdmlkZW8tY29k
ZWMgY2hhbmdlcwo+PiBodHRwczovL3BhdGNod29yay5mcmVlZGVza3RvcC5vcmcvcGF0Y2gvMzIy
MDQwLz9zZXJpZXM9NjQ3ODcmcmV2PTMKCi0tLQogc2VydmVyL2RjYy5jICAgICAgICAgICAgfCAz
MCArLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIHNlcnZlci9zdHJlYW0tY2hhbm5lbC5j
IHwgMzkgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrCiBzZXJ2ZXIvdmlk
ZW8tc3RyZWFtLmMgICB8IDM1ICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrCiBz
ZXJ2ZXIvdmlkZW8tc3RyZWFtLmggICB8ICAxICsKIDQgZmlsZXMgY2hhbmdlZCwgNzYgaW5zZXJ0
aW9ucygrKSwgMjkgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvc2VydmVyL2RjYy5jIGIvc2Vy
dmVyL2RjYy5jCmluZGV4IDIxZTg1OThlLi41MzhmMWY1MSAxMDA2NDQKLS0tIGEvc2VydmVyL2Rj
Yy5jCisrKyBiL3NlcnZlci9kY2MuYwpAQCAtMTE1OCwzOCArMTE1OCwxMCBAQCBzdGF0aWMgdm9p
ZCBvbl9kaXNwbGF5X3ZpZGVvX2NvZGVjc191cGRhdGUoR09iamVjdCAqZ29iamVjdCwgR1BhcmFt
U3BlYyAqcHNwZWMsCiBzdGF0aWMgaW50IGRjY19oYW5kbGVfcHJlZmVycmVkX3ZpZGVvX2NvZGVj
X3R5cGUoRGlzcGxheUNoYW5uZWxDbGllbnQgKmRjYywKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBTcGljZU1zZ2NEaXNwbGF5UHJlZmVycmVkVmlkZW9D
b2RlY1R5cGUgKm1zZykKIHsKLSAgICBnaW50IGksIGxlbjsKLSAgICBnaW50IGluZGV4ZXNbU1BJ
Q0VfVklERU9fQ09ERUNfVFlQRV9FTlVNX0VORF07Ci0gICAgR0FycmF5ICpjbGllbnQ7Ci0KICAg
ICBnX3JldHVybl92YWxfaWZfZmFpbChtc2ctPm51bV9vZl9jb2RlY3MgPiAwLCBUUlVFKTsKCi0g
ICAgLyogc2V0IGRlZmF1bHQgdG8gYSBiaWcgYW5kIHBvc2l0aXZlIG51bWJlciAqLwotICAgIG1l
bXNldChpbmRleGVzLCAweDdmLCBzaXplb2YoaW5kZXhlcykpOwotCi0gICAgZm9yIChsZW4gPSAw
LCBpID0gMDsgaSA8IG1zZy0+bnVtX29mX2NvZGVjczsgaSsrKSB7Ci0gICAgICAgIGdpbnQgdmlk
ZW9fY29kZWMgPSBtc2ctPmNvZGVjc1tpXTsKLQotICAgICAgICBpZiAodmlkZW9fY29kZWMgPCBT
UElDRV9WSURFT19DT0RFQ19UWVBFX01KUEVHIHx8Ci0gICAgICAgICAgICB2aWRlb19jb2RlYyA+
PSBTUElDRV9WSURFT19DT0RFQ19UWVBFX0VOVU1fRU5EKSB7Ci0gICAgICAgICAgICBzcGljZV9k
ZWJ1ZygiQ2xpZW50IGhhcyBzZW50IHVua25vd24gdmlkZW8tY29kZWMgKHZhbHVlICVkIGF0IGlu
ZGV4ICVkKS4gIgotICAgICAgICAgICAgICAgICAgICAgICAgIklnbm9yaW5nIGFzIHNlcnZlciBj
YW4ndCBoYW5kbGUgaXQiLAotICAgICAgICAgICAgICAgICAgICAgICAgIHZpZGVvX2NvZGVjLCBp
KTsKLSAgICAgICAgICAgIGNvbnRpbnVlOwotICAgICAgICB9Ci0KLSAgICAgICAgaWYgKGluZGV4
ZXNbdmlkZW9fY29kZWNdIDwgU1BJQ0VfVklERU9fQ09ERUNfVFlQRV9FTlVNX0VORCkgewotICAg
ICAgICAgICAgY29udGludWU7Ci0gICAgICAgIH0KLQotICAgICAgICBsZW4rKzsKLSAgICAgICAg
aW5kZXhlc1t2aWRlb19jb2RlY10gPSBsZW47Ci0gICAgfQotICAgIGNsaWVudCA9IGdfYXJyYXlf
c2l6ZWRfbmV3KEZBTFNFLCBGQUxTRSwgc2l6ZW9mKGdpbnQpLCBTUElDRV9WSURFT19DT0RFQ19U
WVBFX0VOVU1fRU5EKTsKLSAgICBnX2FycmF5X2FwcGVuZF92YWxzKGNsaWVudCwgaW5kZXhlcywg
U1BJQ0VfVklERU9fQ09ERUNfVFlQRV9FTlVNX0VORCk7Ci0KICAgICBnX2NsZWFyX3BvaW50ZXIo
JmRjYy0+cHJpdi0+Y2xpZW50X3ByZWZlcnJlZF92aWRlb19jb2RlY3MsIGdfYXJyYXlfdW5yZWYp
OwotICAgIGRjYy0+cHJpdi0+Y2xpZW50X3ByZWZlcnJlZF92aWRlb19jb2RlY3MgPSBjbGllbnQ7
CisgICAgZGNjLT5wcml2LT5jbGllbnRfcHJlZmVycmVkX3ZpZGVvX2NvZGVjcyA9IHZpZGVvX3N0
cmVhbV9wYXJzZV9wcmVmZXJyZWRfY29kZWNzKG1zZyk7CgogICAgIC8qIE5ldyBjbGllbnQgcHJl
ZmVyZW5jZSAqLwogICAgIGRjY191cGRhdGVfcHJlZmVycmVkX3ZpZGVvX2NvZGVjcyhkY2MpOwpk
aWZmIC0tZ2l0IGEvc2VydmVyL3N0cmVhbS1jaGFubmVsLmMgYi9zZXJ2ZXIvc3RyZWFtLWNoYW5u
ZWwuYwppbmRleCA3OTUzMDE4ZS4uNzQ0OGYyMWUgMTAwNjQ0Ci0tLSBhL3NlcnZlci9zdHJlYW0t
Y2hhbm5lbC5jCisrKyBiL3NlcnZlci9zdHJlYW0tY2hhbm5lbC5jCkBAIC0yMiw2ICsyMiw3IEBA
CiAjaW5jbHVkZSA8c3BpY2Uvc3RyZWFtLWRldmljZS5oPgoKICNpbmNsdWRlICJyZWQtY2hhbm5l
bC1jbGllbnQuaCIKKyNpbmNsdWRlICJyZWQtY2xpZW50LmgiCiAjaW5jbHVkZSAic3RyZWFtLWNo
YW5uZWwuaCIKICNpbmNsdWRlICJyZWRzLmgiCiAjaW5jbHVkZSAiY29tbW9uLWdyYXBoaWNzLWNo
YW5uZWwuaCIKQEAgLTUyLDYgKzUzLDkgQEAgc3RydWN0IFN0cmVhbUNoYW5uZWxDbGllbnQgewog
ICAgIC8qIGN1cnJlbnQgdmlkZW8gc3RyZWFtIGlkLCA8MCBpZiBub3QgaW5pdGlhbGl6ZWQgb3IK
ICAgICAgKiB3ZSBhcmUgbm90IHNlbmRpbmcgYSBzdHJlYW0gKi8KICAgICBpbnQgc3RyZWFtX2lk
OworICAgIC8qIEFycmF5IHdpdGggU1BJQ0VfVklERU9fQ09ERUNfVFlQRV9FTlVNX0VORCBlbGVt
ZW50cywgd2l0aCB0aGUgY2xpZW50CisgICAgICogcHJlZmVyZW5jZSBvcmRlciAoaW5kZXgpIGFz
IHZhbHVlICovCisgICAgR0FycmF5ICpjbGllbnRfcHJlZmVycmVkX3ZpZGVvX2NvZGVjczsKIH07
Cgogc3RydWN0IFN0cmVhbUNoYW5uZWxDbGllbnRDbGFzcyB7CkBAIC0xMTQsMTUgKzExOCwzMCBA
QCB0eXBlZGVmIHN0cnVjdCBTdHJlYW1EYXRhSXRlbSB7CiAjZGVmaW5lIFBSSU1BUllfU1VSRkFD
RV9JRCAwCgogc3RhdGljIHZvaWQgc3RyZWFtX2NoYW5uZWxfY2xpZW50X29uX2Rpc2Nvbm5lY3Qo
UmVkQ2hhbm5lbENsaWVudCAqcmNjKTsKK3N0YXRpYyBib29sCitzdHJlYW1fY2hhbm5lbF9oYW5k
bGVfcHJlZmVycmVkX3ZpZGVvX2NvZGVjX3R5cGUoUmVkQ2hhbm5lbENsaWVudCAqcmNjLAorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNwaWNlTXNnY0Rp
c3BsYXlQcmVmZXJyZWRWaWRlb0NvZGVjVHlwZSAqbXNnKTsKCiBSRUNPUkRFUihzdHJlYW1fY2hh
bm5lbF9kYXRhLCAzMiwgIlN0cmVhbSBjaGFubmVsIGRhdGEgcGFja2V0Iik7Cgorc3RhdGljIHZv
aWQKK3N0cmVhbV9jaGFubmVsX2NsaWVudF9maW5hbGl6ZShHT2JqZWN0ICpvYmplY3QpCit7Cisg
ICAgU3RyZWFtQ2hhbm5lbENsaWVudCAqc2VsZiA9IFNUUkVBTV9DSEFOTkVMX0NMSUVOVChvYmpl
Y3QpOworICAgIGdfY2xlYXJfcG9pbnRlcigmc2VsZi0+Y2xpZW50X3ByZWZlcnJlZF92aWRlb19j
b2RlY3MsIGdfYXJyYXlfdW5yZWYpOworCisgICAgR19PQkpFQ1RfQ0xBU1Moc3RyZWFtX2NoYW5u
ZWxfY2xpZW50X3BhcmVudF9jbGFzcyktPmZpbmFsaXplKG9iamVjdCk7Cit9CisKIHN0YXRpYyB2
b2lkCiBzdHJlYW1fY2hhbm5lbF9jbGllbnRfY2xhc3NfaW5pdChTdHJlYW1DaGFubmVsQ2xpZW50
Q2xhc3MgKmtsYXNzKQogeworICAgIEdPYmplY3RDbGFzcyAqb2JqZWN0X2NsYXNzID0gR19PQkpF
Q1RfQ0xBU1Moa2xhc3MpOworCiAgICAgUmVkQ2hhbm5lbENsaWVudENsYXNzICpjaGFubmVsX2Ns
YXNzID0gUkVEX0NIQU5ORUxfQ0xJRU5UX0NMQVNTKGtsYXNzKTsKCiAgICAgY2hhbm5lbF9jbGFz
cy0+b25fZGlzY29ubmVjdCA9IHN0cmVhbV9jaGFubmVsX2NsaWVudF9vbl9kaXNjb25uZWN0Owor
ICAgIG9iamVjdF9jbGFzcy0+ZmluYWxpemUgPSBzdHJlYW1fY2hhbm5lbF9jbGllbnRfZmluYWxp
emU7CiB9Cgogc3RhdGljIHZvaWQKQEAgLTMyNCw2ICszNDMsOSBAQCBoYW5kbGVfbWVzc2FnZShS
ZWRDaGFubmVsQ2xpZW50ICpyY2MsIHVpbnQxNl90IHR5cGUsIHVpbnQzMl90IHNpemUsIHZvaWQg
Km1zZykKICAgICBjYXNlIFNQSUNFX01TR0NfRElTUExBWV9HTF9EUkFXX0RPTkU6CiAgICAgICAg
IC8qIGNsaWVudCBzaG91bGQgbm90IHNlbmQgdGhpcyBtZXNzYWdlICovCiAgICAgICAgIHJldHVy
biBmYWxzZTsKKyAgICBjYXNlIFNQSUNFX01TR0NfRElTUExBWV9QUkVGRVJSRURfVklERU9fQ09E
RUNfVFlQRToKKyAgICAgICAgcmV0dXJuIHN0cmVhbV9jaGFubmVsX2hhbmRsZV9wcmVmZXJyZWRf
dmlkZW9fY29kZWNfdHlwZShyY2MsCisgICAgICAgICAgICAoU3BpY2VNc2djRGlzcGxheVByZWZl
cnJlZFZpZGVvQ29kZWNUeXBlICopbXNnKTsKICAgICBkZWZhdWx0OgogICAgICAgICByZXR1cm4g
cmVkX2NoYW5uZWxfY2xpZW50X2hhbmRsZV9tZXNzYWdlKHJjYywgdHlwZSwgc2l6ZSwgbXNnKTsK
ICAgICB9CkBAIC0zOTAsNiArNDEyLDIyIEBAIHN0cmVhbV9jaGFubmVsX2dldF9zdXBwb3J0ZWRf
Y29kZWNzKFN0cmVhbUNoYW5uZWwgKmNoYW5uZWwsIHVpbnQ4X3QgKm91dF9jb2RlY3MpCiAgICAg
cmV0dXJuIG51bTsKIH0KCitzdGF0aWMgYm9vbAorc3RyZWFtX2NoYW5uZWxfaGFuZGxlX3ByZWZl
cnJlZF92aWRlb19jb2RlY190eXBlKFJlZENoYW5uZWxDbGllbnQgKnJjYywKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTcGljZU1zZ2NEaXNwbGF5UHJl
ZmVycmVkVmlkZW9Db2RlY1R5cGUgKm1zZykKK3sKKyAgICBTdHJlYW1DaGFubmVsQ2xpZW50ICpz
Y2MgPSBTVFJFQU1fQ0hBTk5FTF9DTElFTlQocmNjKTsKKworICAgIGlmIChtc2ctPm51bV9vZl9j
b2RlY3MgPT0gMCkgeworICAgICAgICByZXR1cm4gdHJ1ZTsKKyAgICB9CisKKyAgICBnX2NsZWFy
X3BvaW50ZXIoJnNjYy0+Y2xpZW50X3ByZWZlcnJlZF92aWRlb19jb2RlY3MsIGdfYXJyYXlfdW5y
ZWYpOworICAgIHNjYy0+Y2xpZW50X3ByZWZlcnJlZF92aWRlb19jb2RlY3MgPSB2aWRlb19zdHJl
YW1fcGFyc2VfcHJlZmVycmVkX2NvZGVjcyhtc2cpOworCisgICAgcmV0dXJuIHRydWU7Cit9CisK
IHN0YXRpYyB2b2lkCiBzdHJlYW1fY2hhbm5lbF9jb25uZWN0KFJlZENoYW5uZWwgKnJlZF9jaGFu
bmVsLCBSZWRDbGllbnQgKnJlZF9jbGllbnQsIFJlZFN0cmVhbSAqc3RyZWFtLAogICAgICAgICAg
ICAgICAgICAgICAgICBpbnQgbWlncmF0aW9uLCBSZWRDaGFubmVsQ2FwYWJpbGl0aWVzICpjYXBz
KQpAQCAtNDQ4LDYgKzQ4Niw3IEBAIHN0cmVhbV9jaGFubmVsX2NvbnN0cnVjdGVkKEdPYmplY3Qg
Km9iamVjdCkKCiAgICAgcmVkX2NoYW5uZWxfc2V0X2NhcChyZWRfY2hhbm5lbCwgU1BJQ0VfRElT
UExBWV9DQVBfTU9OSVRPUlNfQ09ORklHKTsKICAgICByZWRfY2hhbm5lbF9zZXRfY2FwKHJlZF9j
aGFubmVsLCBTUElDRV9ESVNQTEFZX0NBUF9TVFJFQU1fUkVQT1JUKTsKKyAgICByZWRfY2hhbm5l
bF9zZXRfY2FwKHJlZF9jaGFubmVsLCBTUElDRV9ESVNQTEFZX0NBUF9QUkVGX1ZJREVPX0NPREVD
X1RZUEUpOwoKICAgICByZWRzX3JlZ2lzdGVyX2NoYW5uZWwocmVkcywgcmVkX2NoYW5uZWwpOwog
fQpkaWZmIC0tZ2l0IGEvc2VydmVyL3ZpZGVvLXN0cmVhbS5jIGIvc2VydmVyL3ZpZGVvLXN0cmVh
bS5jCmluZGV4IDZhYTg1OWEwLi42NzE0ZDc4MCAxMDA2NDQKLS0tIGEvc2VydmVyL3ZpZGVvLXN0
cmVhbS5jCisrKyBiL3NlcnZlci92aWRlby1zdHJlYW0uYwpAQCAtNDY4LDYgKzQ2OCw0MSBAQCBz
dGF0aWMgYm9vbCB2aWRlb19zdHJlYW1fYWRkX2ZyYW1lKERpc3BsYXlDaGFubmVsICpkaXNwbGF5
LAogICAgIHJldHVybiBGQUxTRTsKIH0KCisvKiBSZXR1cm5zIGFuIGFycmF5IHdpdGggU1BJQ0Vf
VklERU9fQ09ERUNfVFlQRV9FTlVNX0VORCBlbGVtZW50cywKKyAqIHdpdGggdGhlIGNsaWVudCBw
cmVmZXJlbmNlIG9yZGVyIChpbmRleCkgYXMgdmFsdWUgKi8KK0dBcnJheSAqdmlkZW9fc3RyZWFt
X3BhcnNlX3ByZWZlcnJlZF9jb2RlY3MoU3BpY2VNc2djRGlzcGxheVByZWZlcnJlZFZpZGVvQ29k
ZWNUeXBlICptc2cpCit7CisgICAgaW50IGksIGxlbjsKKyAgICBpbnQgaW5kZXhlc1tTUElDRV9W
SURFT19DT0RFQ19UWVBFX0VOVU1fRU5EXTsKKyAgICBHQXJyYXkgKmNsaWVudDsKKworICAgIC8q
IHNldCBkZWZhdWx0IHRvIGEgYmlnIGFuZCBwb3NpdGl2ZSBudW1iZXIgKi8KKyAgICBtZW1zZXQo
aW5kZXhlcywgMHg3Ziwgc2l6ZW9mKGluZGV4ZXMpKTsKKworICAgIGZvciAobGVuID0gMCwgaSA9
IDA7IGkgPCBtc2ctPm51bV9vZl9jb2RlY3M7IGkrKykgeworICAgICAgICBTcGljZVZpZGVvQ29k
ZWNUeXBlIHZpZGVvX2NvZGVjID0gbXNnLT5jb2RlY3NbaV07CisKKyAgICAgICAgaWYgKHZpZGVv
X2NvZGVjIDwgU1BJQ0VfVklERU9fQ09ERUNfVFlQRV9NSlBFRyB8fAorICAgICAgICAgICAgdmlk
ZW9fY29kZWMgPj0gU1BJQ0VfVklERU9fQ09ERUNfVFlQRV9FTlVNX0VORCkgeworICAgICAgICAg
ICAgc3BpY2VfZGVidWcoIkNsaWVudCBoYXMgc2VudCB1bmtub3duIHZpZGVvLWNvZGVjICh2YWx1
ZSAlZCBhdCBpbmRleCAlZCkuICIKKyAgICAgICAgICAgICAgICAgICAgICAgICJJZ25vcmluZyBh
cyBzZXJ2ZXIgY2FuJ3QgaGFuZGxlIGl0IiwKKyAgICAgICAgICAgICAgICAgICAgICAgICB2aWRl
b19jb2RlYywgaSk7CisgICAgICAgICAgICBjb250aW51ZTsKKyAgICAgICAgfQorCisgICAgICAg
IGlmIChpbmRleGVzW3ZpZGVvX2NvZGVjXSA8IFNQSUNFX1ZJREVPX0NPREVDX1RZUEVfRU5VTV9F
TkQpIHsKKyAgICAgICAgICAgIGNvbnRpbnVlOworICAgICAgICB9CisKKyAgICAgICAgbGVuKys7
CisgICAgICAgIGluZGV4ZXNbdmlkZW9fY29kZWNdID0gbGVuOworICAgIH0KKyAgICBjbGllbnQg
PSBnX2FycmF5X3NpemVkX25ldyhGQUxTRSwgRkFMU0UsIHNpemVvZihpbnQpLCBTUElDRV9WSURF
T19DT0RFQ19UWVBFX0VOVU1fRU5EKTsKKyAgICBnX2FycmF5X2FwcGVuZF92YWxzKGNsaWVudCwg
aW5kZXhlcywgU1BJQ0VfVklERU9fQ09ERUNfVFlQRV9FTlVNX0VORCk7CisKKyAgICByZXR1cm4g
Y2xpZW50OworfQorCiAvKiBUT0RPOiBkb2N1bWVudCB0aGUgZGlmZmVyZW5jZSBiZXR3ZWVuIHRo
ZSAyIGZ1bmN0aW9ucyBiZWxvdyAqLwogdm9pZCB2aWRlb19zdHJlYW1fdHJhY2VfdXBkYXRlKERp
c3BsYXlDaGFubmVsICpkaXNwbGF5LCBEcmF3YWJsZSAqZHJhd2FibGUpCiB7CmRpZmYgLS1naXQg
YS9zZXJ2ZXIvdmlkZW8tc3RyZWFtLmggYi9zZXJ2ZXIvdmlkZW8tc3RyZWFtLmgKaW5kZXggNDZi
MDc2ZmQuLjczNDM1NTE1IDEwMDY0NAotLS0gYS9zZXJ2ZXIvdmlkZW8tc3RyZWFtLmgKKysrIGIv
c2VydmVyL3ZpZGVvLXN0cmVhbS5oCkBAIC0xNDcsNiArMTQ3LDcgQEAgdm9pZCB2aWRlb19zdHJl
YW1fZGV0YWNoX2FuZF9zdG9wKERpc3BsYXlDaGFubmVsICpkaXNwbGF5KTsKIHZvaWQgdmlkZW9f
c3RyZWFtX3RyYWNlX2FkZF9kcmF3YWJsZShEaXNwbGF5Q2hhbm5lbCAqZGlzcGxheSwgRHJhd2Fi
bGUgKml0ZW0pOwogdm9pZCB2aWRlb19zdHJlYW1fZGV0YWNoX2JlaGluZChEaXNwbGF5Q2hhbm5l
bCAqZGlzcGxheSwgUVJlZ2lvbiAqcmVnaW9uLAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBEcmF3YWJsZSAqZHJhd2FibGUpOworR0FycmF5ICp2aWRlb19zdHJlYW1fcGFyc2VfcHJl
ZmVycmVkX2NvZGVjcyhTcGljZU1zZ2NEaXNwbGF5UHJlZmVycmVkVmlkZW9Db2RlY1R5cGUgKm1z
Zyk7Cgogdm9pZCB2aWRlb19zdHJlYW1fYWdlbnRfdW5yZWYoRGlzcGxheUNoYW5uZWwgKmRpc3Bs
YXksIFZpZGVvU3RyZWFtQWdlbnQgKmFnZW50KTsKIHZvaWQgdmlkZW9fc3RyZWFtX2FnZW50X3N0
b3AoVmlkZW9TdHJlYW1BZ2VudCAqYWdlbnQpOwotLQoyLjIxLjAKX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX18KU3BpY2UtZGV2ZWwgbWFpbGluZyBsaXN0ClNw
aWNlLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9w
Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL3NwaWNlLWRldmVs
