Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 8D2925541E
	for <lists+spice-devel@lfdr.de>; Tue, 25 Jun 2019 18:12:06 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 00C7A6E179;
	Tue, 25 Jun 2019 16:12:05 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 02A9B6E170
 for <spice-devel@lists.freedesktop.org>; Tue, 25 Jun 2019 16:12:02 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx05.intmail.prod.int.phx2.redhat.com
 [10.5.11.15])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id A0E7030C084B
 for <spice-devel@lists.freedesktop.org>; Tue, 25 Jun 2019 16:12:01 +0000 (UTC)
Received: from fziglio.remote.csb (unknown [10.33.32.4])
 by smtp.corp.redhat.com (Postfix) with ESMTP id D1A1E5D70D;
 Tue, 25 Jun 2019 16:12:00 +0000 (UTC)
From: Frediano Ziglio <fziglio@redhat.com>
To: spice-devel@lists.freedesktop.org
Date: Tue, 25 Jun 2019 17:11:33 +0100
Message-Id: <20190625161147.25211-10-fziglio@redhat.com>
In-Reply-To: <20190625161147.25211-1-fziglio@redhat.com>
References: <20190625161147.25211-1-fziglio@redhat.com>
MIME-Version: 1.0
X-Scanned-By: MIMEDefang 2.79 on 10.5.11.15
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16
 (mx1.redhat.com [10.5.110.46]); Tue, 25 Jun 2019 16:12:01 +0000 (UTC)
Subject: [Spice-devel] [PATCH spice-server 09/23] websocket: Better
 encapsulation
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

TW92ZSB3ZWJzb2NrZXQgc3RydWN0dXJlIGRlY2xhcmF0aW9ucyB0byBDIGZpbGUuCk1ha2Ugc29t
ZSBmdW5jdGlvbnMgc3RhdGljIGFzIG5vdyBub3QgdXNlZCBleHRlcm5hbGx5LgpJbnRyb2R1Y2Ug
YSB3ZWJzb2NrZXRfZnJlZSBmdW5jdGlvbiBmb3Igc3ltbWV0cnkuCgpTaWduZWQtb2ZmLWJ5OiBG
cmVkaWFubyBaaWdsaW8gPGZ6aWdsaW9AcmVkaGF0LmNvbT4KLS0tCiBzZXJ2ZXIvcmVkLXN0cmVh
bS5jIHwgMzEgKystLS0tLS0tLS0tLS0tLS0tLS0tLQogc2VydmVyL3dlYnNvY2tldC5jICB8IDY0
ICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKy0tLQogc2VydmVyL3dl
YnNvY2tldC5oICB8IDMyICsrKy0tLS0tLS0tLS0tLS0tLS0tLS0tCiAzIGZpbGVzIGNoYW5nZWQs
IDY1IGluc2VydGlvbnMoKyksIDYyIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL3NlcnZlci9y
ZWQtc3RyZWFtLmMgYi9zZXJ2ZXIvcmVkLXN0cmVhbS5jCmluZGV4IGZkM2ZkY2VkOC4uMWUwMTAz
YjA4IDEwMDY0NAotLS0gYS9zZXJ2ZXIvcmVkLXN0cmVhbS5jCisrKyBiL3NlcnZlci9yZWQtc3Ry
ZWFtLmMKQEAgLTQzNiw3ICs0MzYsNyBAQCB2b2lkIHJlZF9zdHJlYW1fZnJlZShSZWRTdHJlYW0g
KnMpCiAgICAgICAgIFNTTF9mcmVlKHMtPnByaXYtPnNzbCk7CiAgICAgfQogCi0gICAgZ19mcmVl
KHMtPnByaXYtPndzKTsKKyAgICB3ZWJzb2NrZXRfZnJlZShzLT5wcml2LT53cyk7CiAKICAgICBy
ZWRfc3RyZWFtX3JlbW92ZV93YXRjaChzKTsKICAgICBzb2NrZXRfY2xvc2Uocy0+c29ja2V0KTsK
QEAgLTExODQsMzggKzExODQsMTEgQEAgc3RhdGljIHNzaXplX3Qgc3RyZWFtX3dlYnNvY2tldF93
cml0ZXYoUmVkU3RyZWFtICpzLCBjb25zdCBzdHJ1Y3QgaW92ZWMgKmlvdiwgaW4KICovCiBib29s
IHJlZF9zdHJlYW1faXNfd2Vic29ja2V0KFJlZFN0cmVhbSAqc3RyZWFtLCBjb25zdCB2b2lkICpi
dWYsIHNpemVfdCBsZW4pCiB7Ci0gICAgY2hhciByYnVmWzQwOTZdOwotICAgIGludCByYzsKLQog
ICAgIGlmIChzdHJlYW0tPnByaXYtPndzKSB7CiAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICB9
CiAKLSAgICBtZW1jcHkocmJ1ZiwgYnVmLCBsZW4pOwotICAgIHJjID0gc3RyZWFtLT5wcml2LT5y
ZWFkKHN0cmVhbSwgcmJ1ZiArIGxlbiwgc2l6ZW9mKHJidWYpIC0gbGVuIC0gMSk7Ci0gICAgaWYg
KHJjIDw9IDApIHsKLSAgICAgICAgcmV0dXJuIGZhbHNlOwotICAgIH0KLSAgICBsZW4gKz0gcmM7
Ci0gICAgcmJ1ZltsZW5dID0gMDsKLQotICAgIC8qIFRPRE86ICB0aGlzIGhhcyBhIHRoZW9yZXRp
Y2FsIGZsYXcgYXJvdW5kIHBhY2tldCBidWZmZXJpbmcKLSAgICAgICAgICAgICAgdGhhdCBpcyBu
b3QgbGlrZWx5IHRvIG9jY3VyIGluIHByYWN0aWNlLiAgVGhhdCBpcywKLSAgICAgICAgICAgICAg
dG8gYmUgZnVsbHkgY29ycmVjdCwgd2Ugc2hvdWxkIHJlcGVhdGVkbHkgcmVhZCBieXRlcyB1bnRp
bAotICAgICAgICAgICAgICBlaXRoZXIgd2UgZ2V0IHRoZSBlbmQgb2YgdGhlIEdFVCBoZWFkZXIg
KFxyXG5cclxuKSwgb3IgdW50aWwKLSAgICAgICAgICAgICAgYW4gYW1vdW50IG9mIHRpbWUgaGFz
IHBhc3NlZC4gIEluc3RlYWQsIHdlIGp1c3QgcmVhZCBmb3IKLSAgICAgICAgICAgICAgMTYgYnl0
ZXMsIGFuZCB0aGVuIHJlYWQgdXAgdG8gdGhlIHNpemVvZiByYnVmLiAgU28gaWYgdGhlCi0gICAg
ICAgICAgICAgIEdFVCByZXF1ZXN0IGlzIG9ubHkgcGFydGlhbGx5IGNvbXBsZXRlIGF0IHRoaXMg
cG9pbnQgd2UKLSAgICAgICAgICAgICAgd2lsbCBmYWlsLgotCi0gICAgICAgICAgICAgIEEgdHlw
aWNhbCBHRVQgcmVxdWVzdCBpcyA1MjAgYnl0ZXMsIGFuZCBpdCdzIGRpZmZpY3VsdCB0bwotICAg
ICAgICAgICAgICBpbWFnaW5lIGEgcmVhbCB3b3JsZCBjYXNlIHdoZXJlIHRoYXQgd2lsbCBjb21l
IGluIGZyYWdtZW50ZWQKLSAgICAgICAgICAgICAgc3VjaCB0aGF0IHdlIHRyaWdnZXIgdGhpcyBm
YWlsdXJlLiAgRnVydGhlciwgdGhlIHNwaWNlIHJlZHMKLSAgICAgICAgICAgICAgY29kZSBoYXMg
bm8gcmVhbCBtZWNoYW5pc20gdG8gZG8gdmFyaWFibGUgbGVuZ3RoL3RpbWUgYmFzZWQgcmVhZHMs
Ci0gICAgICAgICAgICAgIHNvIGl0IHNlZW1zIHdpc2VzdCB0byBsaXZlIHdpdGggdGhpcyB0aGVv
cmV0aWNhbCBmbGF3LgotICAgICovCi0KLSAgICBzdHJlYW0tPnByaXYtPndzID0gd2Vic29ja2V0
X25ldyhyYnVmLCBzdHJlYW0sCisgICAgc3RyZWFtLT5wcml2LT53cyA9IHdlYnNvY2tldF9uZXco
YnVmLCBsZW4sIHN0cmVhbSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAo
d2Vic29ja2V0X3JlYWRfY2JfdCkgc3RyZWFtLT5wcml2LT5yZWFkLAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICh3ZWJzb2NrZXRfd3JpdGVfY2JfdCkgc3RyZWFtLT5wcml2
LT53cml0ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAod2Vic29ja2V0
X3dyaXRldl9jYl90KSBzdHJlYW0tPnByaXYtPndyaXRldik7CmRpZmYgLS1naXQgYS9zZXJ2ZXIv
d2Vic29ja2V0LmMgYi9zZXJ2ZXIvd2Vic29ja2V0LmMKaW5kZXggMDNkOTMxMDIzLi4wMWJjZWY4
MmUgMTAwNjQ0Ci0tLSBhL3NlcnZlci93ZWJzb2NrZXQuYworKysgYi9zZXJ2ZXIvd2Vic29ja2V0
LmMKQEAgLTYzLDYgKzYzLDMxIEBACiAKICNkZWZpbmUgV0VCU09DS0VUX0dVSUQgIjI1OEVBRkE1
LUU5MTQtNDdEQS05NUNBLUM1QUIwREM4NUIxMSIKIAorI2RlZmluZSBXRUJTT0NLRVRfTUFYX0hF
QURFUl9TSVpFICgxICsgOSArIDQpCisKK3R5cGVkZWYgc3RydWN0IHsKKyAgICBpbnQgdHlwZTsK
KyAgICBpbnQgbWFza2VkOworICAgIHVpbnQ4X3QgaGVhZGVyW1dFQlNPQ0tFVF9NQVhfSEVBREVS
X1NJWkVdOworICAgIGludCBoZWFkZXJfcG9zOworICAgIGludCBmcmFtZV9yZWFkeToxOworICAg
IHVpbnQ4X3QgbWFza1s0XTsKKyAgICB1aW50NjRfdCByZWxheWVkOworICAgIHVpbnQ2NF90IGV4
cGVjdGVkX2xlbjsKK30gd2Vic29ja2V0X2ZyYW1lX3Q7CisKK3N0cnVjdCBSZWRzV2ViU29ja2V0
IHsKKyAgICBib29sIGNsb3NlZDsKKworICAgIHdlYnNvY2tldF9mcmFtZV90IHJlYWRfZnJhbWU7
CisgICAgdWludDY0X3Qgd3JpdGVfcmVtYWluZGVyOworCisgICAgdm9pZCAqcmF3X3N0cmVhbTsK
KyAgICB3ZWJzb2NrZXRfcmVhZF9jYl90IHJhd19yZWFkOworICAgIHdlYnNvY2tldF93cml0ZV9j
Yl90IHJhd193cml0ZTsKKyAgICB3ZWJzb2NrZXRfd3JpdGV2X2NiX3QgcmF3X3dyaXRldjsKK307
CisKIHN0YXRpYyB2b2lkIHdlYnNvY2tldF9hY2tfY2xvc2Uodm9pZCAqb3BhcXVlLCB3ZWJzb2Nr
ZXRfd3JpdGVfY2JfdCB3cml0ZV9jYik7CiAKIC8qIFBlcmZvcm0gYSBjYXNlIGluc2Vuc2l0aXZl
IHNlYXJjaCBmb3IgbmVlZGxlIGluIGhheXN0YWNrLgpAQCAtNDUzLDcgKzQ3OCw3IEBAIHN0YXRp
YyB2b2lkIHdlYnNvY2tldF9hY2tfY2xvc2Uodm9pZCAqb3BhcXVlLCB3ZWJzb2NrZXRfd3JpdGVf
Y2JfdCB3cml0ZV9jYikKICAgICB3cml0ZV9jYihvcGFxdWUsIGhlYWRlciwgc2l6ZW9mKGhlYWRl
cikpOwogfQogCi1ib29sIHdlYnNvY2tldF9pc19zdGFydChjaGFyICpidWYpCitzdGF0aWMgYm9v
bCB3ZWJzb2NrZXRfaXNfc3RhcnQoY2hhciAqYnVmKQogewogICAgIGlmIChzdHJuY21wKGJ1Ziwg
IkdFVCAiLCA0KSA9PSAwICYmCiAgICAgICAgICAgICAvLyBUT0RPIHN0cmlwLCBkbyBub3QgYXNz
dW1lIGEgc2luZ2xlIHNwYWNlCkBAIC00NjYsNyArNDkxLDcgQEAgYm9vbCB3ZWJzb2NrZXRfaXNf
c3RhcnQoY2hhciAqYnVmKQogICAgIHJldHVybiBmYWxzZTsKIH0KIAotdm9pZCB3ZWJzb2NrZXRf
Y3JlYXRlX3JlcGx5KGNoYXIgKmJ1ZiwgY2hhciAqb3V0YnVmKQorc3RhdGljIHZvaWQgd2Vic29j
a2V0X2NyZWF0ZV9yZXBseShjaGFyICpidWYsIGNoYXIgKm91dGJ1ZikKIHsKICAgICBjaGFyICpr
ZXk7CiAKQEAgLTQ3OSw5ICs1MDQsMzUgQEAgdm9pZCB3ZWJzb2NrZXRfY3JlYXRlX3JlcGx5KGNo
YXIgKmJ1ZiwgY2hhciAqb3V0YnVmKQogICAgIGdfZnJlZShrZXkpOwogfQogCi1SZWRzV2ViU29j
a2V0ICp3ZWJzb2NrZXRfbmV3KGNoYXIgKnJidWYsIHN0cnVjdCBSZWRTdHJlYW0gKnN0cmVhbSwg
d2Vic29ja2V0X3JlYWRfY2JfdCByZWFkX2NiLAorUmVkc1dlYlNvY2tldCAqd2Vic29ja2V0X25l
dyhjb25zdCB2b2lkICpidWYsIHNpemVfdCBsZW4sIHZvaWQgKnN0cmVhbSwgd2Vic29ja2V0X3Jl
YWRfY2JfdCByZWFkX2NiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3ZWJzb2NrZXRf
d3JpdGVfY2JfdCB3cml0ZV9jYiwgd2Vic29ja2V0X3dyaXRldl9jYl90IHdyaXRldl9jYikKIHsK
KyAgICBjaGFyIHJidWZbNDA5Nl07CisKKyAgICBtZW1jcHkocmJ1ZiwgYnVmLCBsZW4pOworICAg
IGludCByYyA9IHJlYWRfY2Ioc3RyZWFtLCByYnVmICsgbGVuLCBzaXplb2YocmJ1ZikgLSBsZW4g
LSAxKTsKKyAgICBpZiAocmMgPD0gMCkgeworICAgICAgICByZXR1cm4gTlVMTDsKKyAgICB9Cisg
ICAgbGVuICs9IHJjOworICAgIHJidWZbbGVuXSA9IDA7CisKKyAgICAvKiBUT0RPOiAgdGhpcyBo
YXMgYSB0aGVvcmV0aWNhbCBmbGF3IGFyb3VuZCBwYWNrZXQgYnVmZmVyaW5nCisgICAgICAgICAg
ICAgIHRoYXQgaXMgbm90IGxpa2VseSB0byBvY2N1ciBpbiBwcmFjdGljZS4gIFRoYXQgaXMsCisg
ICAgICAgICAgICAgIHRvIGJlIGZ1bGx5IGNvcnJlY3QsIHdlIHNob3VsZCByZXBlYXRlZGx5IHJl
YWQgYnl0ZXMgdW50aWwKKyAgICAgICAgICAgICAgZWl0aGVyIHdlIGdldCB0aGUgZW5kIG9mIHRo
ZSBHRVQgaGVhZGVyIChcclxuXHJcbiksIG9yIHVudGlsCisgICAgICAgICAgICAgIGFuIGFtb3Vu
dCBvZiB0aW1lIGhhcyBwYXNzZWQuICBJbnN0ZWFkLCB3ZSBqdXN0IHJlYWQgZm9yCisgICAgICAg
ICAgICAgIDE2IGJ5dGVzLCBhbmQgdGhlbiByZWFkIHVwIHRvIHRoZSBzaXplb2YgcmJ1Zi4gIFNv
IGlmIHRoZQorICAgICAgICAgICAgICBHRVQgcmVxdWVzdCBpcyBvbmx5IHBhcnRpYWxseSBjb21w
bGV0ZSBhdCB0aGlzIHBvaW50IHdlCisgICAgICAgICAgICAgIHdpbGwgZmFpbC4KKworICAgICAg
ICAgICAgICBBIHR5cGljYWwgR0VUIHJlcXVlc3QgaXMgNTIwIGJ5dGVzLCBhbmQgaXQncyBkaWZm
aWN1bHQgdG8KKyAgICAgICAgICAgICAgaW1hZ2luZSBhIHJlYWwgd29ybGQgY2FzZSB3aGVyZSB0
aGF0IHdpbGwgY29tZSBpbiBmcmFnbWVudGVkCisgICAgICAgICAgICAgIHN1Y2ggdGhhdCB3ZSB0
cmlnZ2VyIHRoaXMgZmFpbHVyZS4gIEZ1cnRoZXIsIHRoZSBzcGljZSByZWRzCisgICAgICAgICAg
ICAgIGNvZGUgaGFzIG5vIHJlYWwgbWVjaGFuaXNtIHRvIGRvIHZhcmlhYmxlIGxlbmd0aC90aW1l
IGJhc2VkIHJlYWRzLAorICAgICAgICAgICAgICBzbyBpdCBzZWVtcyB3aXNlc3QgdG8gbGl2ZSB3
aXRoIHRoaXMgdGhlb3JldGljYWwgZmxhdy4KKyAgICAqLworCiAgICAgaWYgKCF3ZWJzb2NrZXRf
aXNfc3RhcnQocmJ1ZikpIHsKICAgICAgICAgcmV0dXJuIE5VTEw7CiAgICAgfQpAQCAtNDg5LDcg
KzU0MCw3IEBAIFJlZHNXZWJTb2NrZXQgKndlYnNvY2tldF9uZXcoY2hhciAqcmJ1Ziwgc3RydWN0
IFJlZFN0cmVhbSAqc3RyZWFtLCB3ZWJzb2NrZXRfcmVhCiAgICAgY2hhciBvdXRidWZbMTAyNF07
CiAKICAgICB3ZWJzb2NrZXRfY3JlYXRlX3JlcGx5KHJidWYsIG91dGJ1Zik7Ci0gICAgaW50IHJj
ID0gd3JpdGVfY2Ioc3RyZWFtLCBvdXRidWYsIHN0cmxlbihvdXRidWYpKTsKKyAgICByYyA9IHdy
aXRlX2NiKHN0cmVhbSwgb3V0YnVmLCBzdHJsZW4ob3V0YnVmKSk7CiAgICAgaWYgKHJjICE9IHN0
cmxlbihvdXRidWYpKSB7CiAgICAgICAgIHJldHVybiBOVUxMOwogICAgIH0KQEAgLTUwMywzICs1
NTQsOCBAQCBSZWRzV2ViU29ja2V0ICp3ZWJzb2NrZXRfbmV3KGNoYXIgKnJidWYsIHN0cnVjdCBS
ZWRTdHJlYW0gKnN0cmVhbSwgd2Vic29ja2V0X3JlYQogCiAgICAgcmV0dXJuIHdzOwogfQorCit2
b2lkIHdlYnNvY2tldF9mcmVlKFJlZHNXZWJTb2NrZXQgKndzKQoreworICAgIGdfZnJlZSh3cyk7
Cit9CmRpZmYgLS1naXQgYS9zZXJ2ZXIvd2Vic29ja2V0LmggYi9zZXJ2ZXIvd2Vic29ja2V0LmgK
aW5kZXggYWI5ZWI4MTI2Li5iNTg2ZTMwMzUgMTAwNjQ0Ci0tLSBhL3NlcnZlci93ZWJzb2NrZXQu
aAorKysgYi9zZXJ2ZXIvd2Vic29ja2V0LmgKQEAgLTE1LDQxICsxNSwxNSBAQAogICogIExpY2Vu
c2UgYWxvbmcgd2l0aCB0aGlzIGxpYnJhcnk7IGlmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5v
cmcvbGljZW5zZXMvPi4KICAqLwogCi0jZGVmaW5lIFdFQlNPQ0tFVF9NQVhfSEVBREVSX1NJWkUg
KDEgKyA5ICsgNCkKLQotc3RydWN0IFJlZFN0cmVhbTsKLQotdHlwZWRlZiBzdHJ1Y3QgewotICAg
IGludCB0eXBlOwotICAgIGludCBtYXNrZWQ7Ci0gICAgdWludDhfdCBoZWFkZXJbV0VCU09DS0VU
X01BWF9IRUFERVJfU0laRV07Ci0gICAgaW50IGhlYWRlcl9wb3M7Ci0gICAgaW50IGZyYW1lX3Jl
YWR5OjE7Ci0gICAgdWludDhfdCBtYXNrWzRdOwotICAgIHVpbnQ2NF90IHJlbGF5ZWQ7Ci0gICAg
dWludDY0X3QgZXhwZWN0ZWRfbGVuOwotfSB3ZWJzb2NrZXRfZnJhbWVfdDsKLQogdHlwZWRlZiBz
c2l6ZV90ICgqd2Vic29ja2V0X3JlYWRfY2JfdCkodm9pZCAqb3BhcXVlLCB2b2lkICpidWYsIHNp
emVfdCBuYnl0ZSk7CiB0eXBlZGVmIHNzaXplX3QgKCp3ZWJzb2NrZXRfd3JpdGVfY2JfdCkodm9p
ZCAqb3BhcXVlLCBjb25zdCB2b2lkICpidWYsIHNpemVfdCBuYnl0ZSk7CiB0eXBlZGVmIHNzaXpl
X3QgKCp3ZWJzb2NrZXRfd3JpdGV2X2NiX3QpKHZvaWQgKm9wYXF1ZSwgc3RydWN0IGlvdmVjICpp
b3YsIGludCBpb3ZjbnQpOwogCi10eXBlZGVmIHN0cnVjdCB7Ci0gICAgaW50IGNsb3NlZDsKLQot
ICAgIHdlYnNvY2tldF9mcmFtZV90IHJlYWRfZnJhbWU7Ci0gICAgdWludDY0X3Qgd3JpdGVfcmVt
YWluZGVyOwotCi0gICAgc3RydWN0IFJlZFN0cmVhbSAqcmF3X3N0cmVhbTsKLSAgICB3ZWJzb2Nr
ZXRfcmVhZF9jYl90IHJhd19yZWFkOwotICAgIHdlYnNvY2tldF93cml0ZV9jYl90IHJhd193cml0
ZTsKLSAgICB3ZWJzb2NrZXRfd3JpdGV2X2NiX3QgcmF3X3dyaXRldjsKLX0gUmVkc1dlYlNvY2tl
dDsKK3R5cGVkZWYgc3RydWN0IFJlZHNXZWJTb2NrZXQgUmVkc1dlYlNvY2tldDsKIAotUmVkc1dl
YlNvY2tldCAqd2Vic29ja2V0X25ldyhjaGFyICpidWYsIHN0cnVjdCBSZWRTdHJlYW0gKnMsIHdl
YnNvY2tldF9yZWFkX2NiX3QgcmVhZF9jYiwKK1JlZHNXZWJTb2NrZXQgKndlYnNvY2tldF9uZXco
Y29uc3Qgdm9pZCAqYnVmLCBzaXplX3QgbGVuLCB2b2lkICpzdHJlYW0sIHdlYnNvY2tldF9yZWFk
X2NiX3QgcmVhZF9jYiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2Vic29ja2V0X3dy
aXRlX2NiX3Qgd3JpdGVfY2IsIHdlYnNvY2tldF93cml0ZXZfY2JfdCB3cml0ZXZfY2IpOwotYm9v
bCB3ZWJzb2NrZXRfaXNfc3RhcnQoY2hhciAqYnVmKTsKLXZvaWQgd2Vic29ja2V0X2NyZWF0ZV9y
ZXBseShjaGFyICpidWYsIGNoYXIgKm91dGJ1Zik7Cit2b2lkIHdlYnNvY2tldF9mcmVlKFJlZHNX
ZWJTb2NrZXQgKndzKTsKIGludCB3ZWJzb2NrZXRfcmVhZChSZWRzV2ViU29ja2V0ICp3cywgdWlu
dDhfdCAqYnVmLCBzaXplX3QgbGVuKTsKIGludCB3ZWJzb2NrZXRfd3JpdGUoUmVkc1dlYlNvY2tl
dCAqd3MsIGNvbnN0IHZvaWQgKmJ1Ziwgc2l6ZV90IGxlbik7CiBpbnQgd2Vic29ja2V0X3dyaXRl
dihSZWRzV2ViU29ja2V0ICp3cywgY29uc3Qgc3RydWN0IGlvdmVjICppb3YsIGludCBpb3ZjbnQp
OwotLSAKMi4yMC4xCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fXwpTcGljZS1kZXZlbCBtYWlsaW5nIGxpc3QKU3BpY2UtZGV2ZWxAbGlzdHMuZnJlZWRlc2t0
b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vc3Bp
Y2UtZGV2ZWw=
