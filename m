Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id E701811821
	for <lists+spice-devel@lfdr.de>; Thu,  2 May 2019 13:28:28 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id D947D89428;
	Thu,  2 May 2019 11:28:26 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 52C7B89428
 for <spice-devel@lists.freedesktop.org>; Thu,  2 May 2019 11:28:25 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx08.intmail.prod.int.phx2.redhat.com
 [10.5.11.23])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id C916B30A3AF1;
 Thu,  2 May 2019 11:28:24 +0000 (UTC)
Received: from colo-mx.corp.redhat.com
 (colo-mx02.intmail.prod.int.phx2.redhat.com [10.5.11.21])
 by smtp.corp.redhat.com (Postfix) with ESMTPS id B852A19C7F;
 Thu,  2 May 2019 11:28:24 +0000 (UTC)
Received: from zmail25.collab.prod.int.phx2.redhat.com
 (zmail25.collab.prod.int.phx2.redhat.com [10.5.83.31])
 by colo-mx.corp.redhat.com (Postfix) with ESMTP id ABF653FB11;
 Thu,  2 May 2019 11:28:24 +0000 (UTC)
Date: Thu, 2 May 2019 07:28:23 -0400 (EDT)
From: Frediano Ziglio <fziglio@redhat.com>
To: Jeremy White <jwhite@codeweavers.com>
Message-ID: <290329248.15999719.1556796503186.JavaMail.zimbra@redhat.com>
In-Reply-To: <20190501161716.15538-2-jwhite@codeweavers.com>
References: <20190501161716.15538-1-jwhite@codeweavers.com>
 <20190501161716.15538-2-jwhite@codeweavers.com>
MIME-Version: 1.0
X-Originating-IP: [10.33.32.3, 10.4.195.2]
Thread-Topic: Apply Spice style to the spice-video-dummy
Thread-Index: D016sUNwC3I30x74/DQ2GcE9IEQj4w==
X-Scanned-By: MIMEDefang 2.84 on 10.5.11.23
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16
 (mx1.redhat.com [10.5.110.43]); Thu, 02 May 2019 11:28:24 +0000 (UTC)
Subject: Re: [Spice-devel] [PATCH v2 x11spice 2/4] Apply Spice style to the
 spice-video-dummy
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: spice-devel@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

Ckkgc3VwcG9zZSBmcm9tIElSQyBjaGF0IHlvdSB1c2VkIGluZGVudCB0b29sLgogCj4gU2lnbmVk
LW9mZi1ieTogSmVyZW15IFdoaXRlIDxqd2hpdGVAY29kZXdlYXZlcnMuY29tPgo+IC0tLQo+ICBz
cGljZS12aWRlby1kdW1teS9zcmMvZHVtbXkuaCAgICAgICAgfCAgIDkgKy0KPiAgc3BpY2Utdmlk
ZW8tZHVtbXkvc3JjL2R1bW15X2N1cnNvci5jIHwgIDQyICstLQo+ICBzcGljZS12aWRlby1kdW1t
eS9zcmMvZHVtbXlfZHJpdmVyLmMgfCA1NTgKPiAgKysrKysrKysrKysrKysrKy0tLS0tLS0tLS0t
LS0tLS0tLS0KPiAgMyBmaWxlcyBjaGFuZ2VkLCAyODEgaW5zZXJ0aW9ucygrKSwgMzI4IGRlbGV0
aW9ucygtKQo+IAo+IGRpZmYgLS1naXQgYS9zcGljZS12aWRlby1kdW1teS9zcmMvZHVtbXkuaCBi
L3NwaWNlLXZpZGVvLWR1bW15L3NyYy9kdW1teS5oCj4gaW5kZXggOGU3YzQzYi4uMGMxNjU5MSAx
MDA2NDQKPiAtLS0gYS9zcGljZS12aWRlby1kdW1teS9zcmMvZHVtbXkuaAo+ICsrKyBiL3NwaWNl
LXZpZGVvLWR1bW15L3NyYy9kdW1teS5oCj4gQEAgLTI5LDE1ICsyOSwxMyBAQCBleHRlcm4gdm9p
ZCBEVU1NWVNob3dDdXJzb3IoU2NybkluZm9QdHIgcFNjcm4pOwo+ICBleHRlcm4gdm9pZCBEVU1N
WUhpZGVDdXJzb3IoU2NybkluZm9QdHIgcFNjcm4pOwo+ICAKPiAgLyogZ2xvYmFscyAqLwo+IC10
eXBlZGVmIHN0cnVjdCBfY29sb3IKPiAtewo+ICt0eXBlZGVmIHN0cnVjdCBfY29sb3Igewo+ICAg
ICAgaW50IHJlZDsKPiAgICAgIGludCBncmVlbjsKPiAgICAgIGludCBibHVlOwo+ICB9IGR1bW15
X2NvbG9yczsKPiAgCj4gLXR5cGVkZWYgc3RydWN0IGR1bW15UmVjCj4gLXsKPiArdHlwZWRlZiBz
dHJ1Y3QgZHVtbXlSZWMgewo+ICAgICAgLyogb3B0aW9ucyAqLwo+ICAgICAgT3B0aW9uSW5mb1B0
ciBPcHRpb25zOwo+ICAgICAgQm9vbCBzd0N1cnNvcjsKPiBAQCAtNTAsMTAgKzQ4LDkgQEAgdHlw
ZWRlZiBzdHJ1Y3QgZHVtbXlSZWMKPiAgICAgIGludCBjdXJzb3JGRywgY3Vyc29yQkc7Cj4gIAo+
ICAgICAgZHVtbXlfY29sb3JzIGNvbG9yc1sxMDI0XTsKPiAtICAgIEJvb2wgICAgICAgICgqQ3Jl
YXRlV2luZG93KSgpIDsgICAgIC8qIHdyYXBwZWQgQ3JlYXRlV2luZG93ICovCj4gKyAgICAgQm9v
bCgqQ3JlYXRlV2luZG93KSAoKTsgICAgLyogd3JhcHBlZCBDcmVhdGVXaW5kb3cgKi8KCkkgd291
bGQgcGVyc29uYWxseSB1c2UgQm9vbCAoKkNyZWF0ZVdpbmRvdykoKTsKCk1heWJlIGluZGVudCBn
b3QgY29uZnVzZWQgYnkgZnVuY3Rpb24gZGVjbGFyYXRpb24/CldlIGRvbid0IHVzdWFsbHkgcHV0
IHNwYWNlKHMpIGJldHdlZW4gZnVuY3Rpb24gYW5kIHBhcmFtZXRlcnMuCgo+ICAgICAgQm9vbCBw
cm9wOwo+ICB9IERVTU1ZUmVjLCAqRFVNTVlQdHI7Cj4gIAo+ICAvKiBUaGUgcHJpdmF0ZXMgb2Yg
dGhlIERVTU1ZIGRyaXZlciAqLwo+ICAjZGVmaW5lIERVTU1ZUFRSKHApCSgoRFVNTVlQdHIpKChw
KS0+ZHJpdmVyUHJpdmF0ZSkpCj4gLQo+IGRpZmYgLS1naXQgYS9zcGljZS12aWRlby1kdW1teS9z
cmMvZHVtbXlfY3Vyc29yLmMKPiBiL3NwaWNlLXZpZGVvLWR1bW15L3NyYy9kdW1teV9jdXJzb3Iu
Ywo+IGluZGV4IGQ3YzY3YzYuLmNjY2U0NDIgMTAwNjQ0Cj4gLS0tIGEvc3BpY2UtdmlkZW8tZHVt
bXkvc3JjL2R1bW15X2N1cnNvci5jCj4gKysrIGIvc3BpY2UtdmlkZW8tZHVtbXkvc3JjL2R1bW15
X2N1cnNvci5jCj4gQEAgLTExLDIyICsxMSwyMCBAQAo+ICAvKiBEcml2ZXIgc3BlY2lmaWMgaGVh
ZGVycyAqLwo+ICAjaW5jbHVkZSAiZHVtbXkuaCIKPiAgCj4gLXN0YXRpYyB2b2lkCj4gLWR1bW15
U2hvd0N1cnNvcihTY3JuSW5mb1B0ciBwU2NybikKPiArc3RhdGljIHZvaWQgZHVtbXlTaG93Q3Vy
c29yKFNjcm5JbmZvUHRyIHBTY3JuKQoKVGhpcyB3YXMgcmVsYXhlZCwgd2UgYWNjZXB0IGJvdGgu
IENhbiB5b3UgdGVsbCB0byBpbmRlbnQKImRvbid0IGNoYW5nZSB0aGlzIiA/Cgo+ICB7Cj4gICAg
ICBEVU1NWVB0ciBkUHRyID0gRFVNTVlQVFIocFNjcm4pOwo+ICAKPiAgICAgIC8qIHR1cm4gY3Vy
c29yIG9uICovCj4gLSAgICBkUHRyLT5EdW1teUhXQ3Vyc29yU2hvd24gPSBUUlVFOwo+ICsgICAg
ZFB0ci0+RHVtbXlIV0N1cnNvclNob3duID0gVFJVRTsKPiAgfQo+ICAKPiAtc3RhdGljIHZvaWQK
PiAtZHVtbXlIaWRlQ3Vyc29yKFNjcm5JbmZvUHRyIHBTY3JuKQo+ICtzdGF0aWMgdm9pZCBkdW1t
eUhpZGVDdXJzb3IoU2NybkluZm9QdHIgcFNjcm4pCj4gIHsKPiAgICAgIERVTU1ZUHRyIGRQdHIg
PSBEVU1NWVBUUihwU2Nybik7Cj4gIAo+ICAgICAgLyoKPiAtICAgICAqIHR1cm4gY3Vyc29yIG9m
Zgo+ICsgICAgICogdHVybiBjdXJzb3Igb2ZmCj4gICAgICAgKgo+ICAgICAgICovCj4gICAgICBk
UHRyLT5EdW1teUhXQ3Vyc29yU2hvd24gPSBGQUxTRTsKPiBAQCAtMzQsOCArMzIsNyBAQCBkdW1t
eUhpZGVDdXJzb3IoU2NybkluZm9QdHIgcFNjcm4pCj4gIAo+ICAjZGVmaW5lIE1BWF9DVVJTIDY0
Cj4gIAo+IC1zdGF0aWMgdm9pZAo+IC1kdW1teVNldEN1cnNvclBvc2l0aW9uKFNjcm5JbmZvUHRy
IHBTY3JuLCBpbnQgeCwgaW50IHkpCj4gK3N0YXRpYyB2b2lkIGR1bW15U2V0Q3Vyc29yUG9zaXRp
b24oU2NybkluZm9QdHIgcFNjcm4sIGludCB4LCBpbnQgeSkKPiAgewo+ICAgICAgRFVNTVlQdHIg
ZFB0ciA9IERVTU1ZUFRSKHBTY3JuKTsKPiAgCj4gQEAgLTQzLDQzICs0MCwzOSBAQCBkdW1teVNl
dEN1cnNvclBvc2l0aW9uKFNjcm5JbmZvUHRyIHBTY3JuLCBpbnQgeCwgaW50IHkpCj4gICAgICBk
UHRyLT5jdXJzb3JZID0geTsKPiAgfQo+ICAKPiAtc3RhdGljIHZvaWQKPiAtZHVtbXlTZXRDdXJz
b3JDb2xvcnMoU2NybkluZm9QdHIgcFNjcm4sIGludCBiZywgaW50IGZnKQo+ICtzdGF0aWMgdm9p
ZCBkdW1teVNldEN1cnNvckNvbG9ycyhTY3JuSW5mb1B0ciBwU2NybiwgaW50IGJnLCBpbnQgZmcp
Cj4gIHsKPiAgICAgIERVTU1ZUHRyIGRQdHIgPSBEVU1NWVBUUihwU2Nybik7Cj4gLQo+ICsKPiAg
ICAgIGRQdHItPmN1cnNvckZHID0gZmc7Cj4gICAgICBkUHRyLT5jdXJzb3JCRyA9IGJnOwo+ICB9
Cj4gIAo+IC1zdGF0aWMgdm9pZAo+IC1kdW1teUxvYWRDdXJzb3JJbWFnZShTY3JuSW5mb1B0ciBw
U2NybiwgdW5zaWduZWQgY2hhciAqc3JjKQo+ICtzdGF0aWMgdm9pZCBkdW1teUxvYWRDdXJzb3JJ
bWFnZShTY3JuSW5mb1B0ciBwU2NybiwgdW5zaWduZWQgY2hhciAqc3JjKQo+ICB7Cj4gIH0KPiAg
Cj4gLXN0YXRpYyBCb29sCj4gLWR1bW15VXNlSFdDdXJzb3IoU2NyZWVuUHRyIHBTY3IsIEN1cnNv
clB0ciBwQ3VycykKPiArc3RhdGljIEJvb2wgZHVtbXlVc2VIV0N1cnNvcihTY3JlZW5QdHIgcFNj
ciwgQ3Vyc29yUHRyIHBDdXJzKQo+ICB7Cj4gICAgICBEVU1NWVB0ciBkUHRyID0gRFVNTVlQVFIo
eGY4NlNjcmVlblRvU2NybihwU2NyKSk7Cj4gLSAgICByZXR1cm4oIWRQdHItPnN3Q3Vyc29yKTsK
PiArICAgIHJldHVybiAoIWRQdHItPnN3Q3Vyc29yKTsKPiAgfQo+ICAKPiAgI2lmIDAKPiAtc3Rh
dGljIHVuc2lnbmVkIGNoYXIqCj4gLWR1bW15UmVhbGl6ZUN1cnNvcih4Zjg2Q3Vyc29ySW5mb1B0
ciBpbmZvUHRyLCBDdXJzb3JQdHIgcEN1cnMpCj4gK3N0YXRpYyB1bnNpZ25lZCBjaGFyICpkdW1t
eVJlYWxpemVDdXJzb3IoeGY4NkN1cnNvckluZm9QdHIgaW5mb1B0ciwKPiBDdXJzb3JQdHIgcEN1
cnMpCj4gIHsKPiAgICAgIHJldHVybiBOVUxMOwo+ICB9Cj4gICNlbmRpZgo+ICAKPiAtQm9vbAo+
IC1EVU1NWUN1cnNvckluaXQoU2NyZWVuUHRyIHBTY3JlZW4pCj4gK0Jvb2wgRFVNTVlDdXJzb3JJ
bml0KFNjcmVlblB0ciBwU2NyZWVuKQo+ICB7Cj4gICAgICBEVU1NWVB0ciBkUHRyID0gRFVNTVlQ
VFIoeGY4NlNjcmVlblRvU2NybihwU2NyZWVuKSk7Cj4gIAo+ICAgICAgeGY4NkN1cnNvckluZm9Q
dHIgaW5mb1B0cjsKPiAgICAgIGluZm9QdHIgPSB4Zjg2Q3JlYXRlQ3Vyc29ySW5mb1JlYygpOwo+
IC0gICAgaWYoIWluZm9QdHIpIHJldHVybiBGQUxTRTsKPiArICAgIGlmICghaW5mb1B0cikKPiAr
ICAgICAgICByZXR1cm4gRkFMU0U7Cj4gIAoKV2hhdCB3ZSB1c3VhbGx5IHdhbnQgaXMgYWx3YXlz
IGJyYWNrZXRzIGZvciBpZiBzbwoKICAgaWYgKCFpbmZvUHRyKSB7CiAgICAgICByZXR1cm4gRkFM
U0U7CiAgIH0KCih0aGlzIHNob3VsZCBiZSBkb2FibGUgdXNpbmcgaW5kZW50LCBub3Qgc3VyZSBo
b3cpLgoKPiAgICAgIGRQdHItPkN1cnNvckluZm8gPSBpbmZvUHRyOwo+ICAKPiBAQCAtOTQsOSAr
ODcsNiBAQCBEVU1NWUN1cnNvckluaXQoU2NyZWVuUHRyIHBTY3JlZW4pCj4gICAgICBpbmZvUHRy
LT5TaG93Q3Vyc29yID0gZHVtbXlTaG93Q3Vyc29yOwo+ICAgICAgaW5mb1B0ci0+VXNlSFdDdXJz
b3IgPSBkdW1teVVzZUhXQ3Vyc29yOwo+ICAvKiAgICAgaW5mb1B0ci0+UmVhbGl6ZUN1cnNvciA9
IGR1bW15UmVhbGl6ZUN1cnNvcjsgKi8KPiAtCj4gLSAgICByZXR1cm4oeGY4NkluaXRDdXJzb3Io
cFNjcmVlbiwgaW5mb1B0cikpOwo+IC19Cj4gLQo+IC0KPiAgCj4gKyAgICByZXR1cm4gKHhmODZJ
bml0Q3Vyc29yKHBTY3JlZW4sIGluZm9QdHIpKTsKCkkgd291bGQgcmVtb3ZlIHRoZSBwYXJlbnRo
ZXNpcywgbGlrZQoKICAgcmV0dXJuIHhmODZJbml0Q3Vyc29yKHBTY3JlZW4sIGluZm9QdHIpOwoK
KG5vdCBzdHJvbmcpCgo+ICt9Cj4gZGlmZiAtLWdpdCBhL3NwaWNlLXZpZGVvLWR1bW15L3NyYy9k
dW1teV9kcml2ZXIuYwo+IGIvc3BpY2UtdmlkZW8tZHVtbXkvc3JjL2R1bW15X2RyaXZlci5jCj4g
aW5kZXggYjRiNDJmNy4uMDY5NjE1MSAxMDA2NDQKPiAtLS0gYS9zcGljZS12aWRlby1kdW1teS9z
cmMvZHVtbXlfZHJpdmVyLmMKPiArKysgYi9zcGljZS12aWRlby1kdW1teS9zcmMvZHVtbXlfZHJp
dmVyLmMKPiBAQCAtNDEsMjMgKzQxLDIxIEBACj4gICNpbmNsdWRlICJzZXJ2ZXJtZC5oIgo+ICAK
PiAgLyogTWFuZGF0b3J5IGZ1bmN0aW9ucyAqLwo+IC1zdGF0aWMgY29uc3QgT3B0aW9uSW5mb1Jl
YyAqCURVTU1ZQXZhaWxhYmxlT3B0aW9ucyhpbnQgY2hpcGlkLCBpbnQgYnVzaWQpOwo+IC1zdGF0
aWMgdm9pZCAgICAgRFVNTVlJZGVudGlmeShpbnQgZmxhZ3MpOwo+IC1zdGF0aWMgQm9vbCAgICAg
RFVNTVlQcm9iZShEcml2ZXJQdHIgZHJ2LCBpbnQgZmxhZ3MpOwo+IC1zdGF0aWMgQm9vbCAgICAg
RFVNTVlQcmVJbml0KFNjcm5JbmZvUHRyIHBTY3JuLCBpbnQgZmxhZ3MpOwo+IC1zdGF0aWMgQm9v
bCAgICAgRFVNTVlTY3JlZW5Jbml0KFNDUkVFTl9JTklUX0FSR1NfREVDTCk7Cj4gLXN0YXRpYyBC
b29sICAgICBEVU1NWUVudGVyVlQoVlRfRlVOQ19BUkdTX0RFQ0wpOwo+IC1zdGF0aWMgdm9pZCAg
ICAgRFVNTVlMZWF2ZVZUKFZUX0ZVTkNfQVJHU19ERUNMKTsKPiAtc3RhdGljIEJvb2wgICAgIERV
TU1ZQ2xvc2VTY3JlZW4oQ0xPU0VfU0NSRUVOX0FSR1NfREVDTCk7Cj4gLXN0YXRpYyBCb29sICAg
ICBEVU1NWUNyZWF0ZVdpbmRvdyhXaW5kb3dQdHIgcFdpbik7Cj4gLXN0YXRpYyB2b2lkICAgICBE
VU1NWUZyZWVTY3JlZW4oRlJFRV9TQ1JFRU5fQVJHU19ERUNMKTsKPiAtc3RhdGljIE1vZGVTdGF0
dXMgRFVNTVlWYWxpZE1vZGUoU0NSTl9BUkdfVFlQRSBhcmcsIERpc3BsYXlNb2RlUHRyIG1vZGUs
Cj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEJvb2wgdmVyYm9zZSwgaW50IGZs
YWdzKTsKPiAtc3RhdGljIEJvb2wJRFVNTVlTYXZlU2NyZWVuKFNjcmVlblB0ciBwU2NyZWVuLCBp
bnQgbW9kZSk7Cj4gK3N0YXRpYyBjb25zdCBPcHRpb25JbmZvUmVjICpEVU1NWUF2YWlsYWJsZU9w
dGlvbnMoaW50IGNoaXBpZCwgaW50IGJ1c2lkKTsKPiArc3RhdGljIHZvaWQgRFVNTVlJZGVudGlm
eShpbnQgZmxhZ3MpOwo+ICtzdGF0aWMgQm9vbCBEVU1NWVByb2JlKERyaXZlclB0ciBkcnYsIGlu
dCBmbGFncyk7Cj4gK3N0YXRpYyBCb29sIERVTU1ZUHJlSW5pdChTY3JuSW5mb1B0ciBwU2Nybiwg
aW50IGZsYWdzKTsKPiArc3RhdGljIEJvb2wgRFVNTVlTY3JlZW5Jbml0KFNDUkVFTl9JTklUX0FS
R1NfREVDTCk7Cj4gK3N0YXRpYyBCb29sIERVTU1ZRW50ZXJWVChWVF9GVU5DX0FSR1NfREVDTCk7
Cj4gK3N0YXRpYyB2b2lkIERVTU1ZTGVhdmVWVChWVF9GVU5DX0FSR1NfREVDTCk7Cj4gK3N0YXRp
YyBCb29sIERVTU1ZQ2xvc2VTY3JlZW4oQ0xPU0VfU0NSRUVOX0FSR1NfREVDTCk7Cj4gK3N0YXRp
YyBCb29sIERVTU1ZQ3JlYXRlV2luZG93KFdpbmRvd1B0ciBwV2luKTsKPiArc3RhdGljIHZvaWQg
RFVNTVlGcmVlU2NyZWVuKEZSRUVfU0NSRUVOX0FSR1NfREVDTCk7Cj4gK3N0YXRpYyBNb2RlU3Rh
dHVzIERVTU1ZVmFsaWRNb2RlKFNDUk5fQVJHX1RZUEUgYXJnLCBEaXNwbGF5TW9kZVB0ciBtb2Rl
LAo+IEJvb2wgdmVyYm9zZSwgaW50IGZsYWdzKTsKPiArc3RhdGljIEJvb2wgRFVNTVlTYXZlU2Ny
ZWVuKFNjcmVlblB0ciBwU2NyZWVuLCBpbnQgbW9kZSk7Cj4gIAo+ICAvKiBJbnRlcm5hbGx5IHVz
ZWQgZnVuY3Rpb25zICovCj4gLXN0YXRpYyBCb29sCWR1bW15RHJpdmVyRnVuYyhTY3JuSW5mb1B0
ciBwU2NybiwgeG9yZ0RyaXZlckZ1bmNPcCBvcCwKPiAtCQkJCXBvaW50ZXIgcHRyKTsKPiArc3Rh
dGljIEJvb2wgZHVtbXlEcml2ZXJGdW5jKFNjcm5JbmZvUHRyIHBTY3JuLCB4b3JnRHJpdmVyRnVu
Y09wIG9wLCBwb2ludGVyCj4gcHRyKTsKPiAgCj4gIAo+ICAvKiBzdGF0aWMgdm9pZCAgICAgRFVN
TVlEaXNwbGF5UG93ZXJNYW5hZ2VtZW50U2V0KFNjcm5JbmZvUHRyIHBTY3JuLCAqLwo+IEBAIC0x
MDEsOCArOTksOCBAQCBfWF9FWFBPUlQgRHJpdmVyUmVjIERVTU1ZID0gewo+ICB9Owo+ICAKPiAg
c3RhdGljIFN5bVRhYlJlYyBEVU1NWUNoaXBzZXRzW10gPSB7Cj4gLSAgICB7IERVTU1ZX0NISVAs
ICAgImR1bW15IiB9LAo+IC0gICAgeyAtMSwJCSBOVUxMIH0KPiArICAgIHtEVU1NWV9DSElQLCAi
ZHVtbXkifSwKPiArICAgIHstMSwgTlVMTH0KPiAgfTsKPiAgCj4gIHR5cGVkZWYgZW51bSB7Cj4g
QEAgLTExMCwyNiArMTA4LDI1IEBAIHR5cGVkZWYgZW51bSB7Cj4gIH0gRFVNTVlPcHRzOwo+ICAK
PiAgc3RhdGljIGNvbnN0IE9wdGlvbkluZm9SZWMgRFVNTVlPcHRpb25zW10gPSB7Cj4gLSAgICB7
IE9QVElPTl9TV19DVVJTT1IsCSJTV2N1cnNvciIsCU9QVFZfQk9PTEVBTiwJezB9LCBGQUxTRSB9
LAo+IC0gICAgeyAtMSwgICAgICAgICAgICAgICAgICBOVUxMLCAgICAgICAgICAgT1BUVl9OT05F
LAl7MH0sIEZBTFNFIH0KPiArICAgIHtPUFRJT05fU1dfQ1VSU09SLCAiU1djdXJzb3IiLCBPUFRW
X0JPT0xFQU4sIHswfSwgRkFMU0V9LAo+ICsgICAgey0xLCBOVUxMLCBPUFRWX05PTkUsIHswfSwg
RkFMU0V9Cj4gIH07Cj4gIAo+ICAjaWZkZWYgWEZyZWU4NkxPQURFUgo+ICAKPiAgc3RhdGljIE1P
RFVMRVNFVFVQUFJPVE8oZHVtbXlTZXR1cCk7Cj4gIAo+IC1zdGF0aWMgWEY4Nk1vZHVsZVZlcnNp
b25JbmZvIGR1bW15VmVyc1JlYyA9Cj4gLXsKPiAtCSJkdW1teSIsCj4gLQlNT0RVTEVWRU5ET1JT
VFJJTkcsCj4gLQlNT0RJTkZPU1RSSU5HMSwKPiAtCU1PRElORk9TVFJJTkcyLAo+IC0JWE9SR19W
RVJTSU9OX0NVUlJFTlQsCj4gLQlEVU1NWV9NQUpPUl9WRVJTSU9OLCBEVU1NWV9NSU5PUl9WRVJT
SU9OLCBEVU1NWV9QQVRDSExFVkVMLAo+IC0JQUJJX0NMQVNTX1ZJREVPRFJWLAo+IC0JQUJJX1ZJ
REVPRFJWX1ZFUlNJT04sCj4gLQlNT0RfQ0xBU1NfVklERU9EUlYsCj4gLQl7MCwwLDAsMH0KPiAr
c3RhdGljIFhGODZNb2R1bGVWZXJzaW9uSW5mbyBkdW1teVZlcnNSZWMgPSB7Cj4gKyAgICAiZHVt
bXkiLAo+ICsgICAgTU9EVUxFVkVORE9SU1RSSU5HLAo+ICsgICAgTU9ESU5GT1NUUklORzEsCj4g
KyAgICBNT0RJTkZPU1RSSU5HMiwKPiArICAgIFhPUkdfVkVSU0lPTl9DVVJSRU5ULAo+ICsgICAg
RFVNTVlfTUFKT1JfVkVSU0lPTiwgRFVNTVlfTUlOT1JfVkVSU0lPTiwgRFVNTVlfUEFUQ0hMRVZF
TCwKPiArICAgIEFCSV9DTEFTU19WSURFT0RSViwKPiArICAgIEFCSV9WSURFT0RSVl9WRVJTSU9O
LAo+ICsgICAgTU9EX0NMQVNTX1ZJREVPRFJWLAo+ICsgICAgezAsIDAsIDAsIDB9Cj4gIH07Cj4g
IAo+ICAvKgo+IEBAIC0xMzgsMzUgKzEzNSwzNSBAQCBzdGF0aWMgWEY4Nk1vZHVsZVZlcnNpb25J
bmZvIGR1bW15VmVyc1JlYyA9Cj4gICAqLwo+ICBfWF9FWFBPUlQgWEY4Nk1vZHVsZURhdGEgZHVt
bXlNb2R1bGVEYXRhID0geyAmZHVtbXlWZXJzUmVjLCBkdW1teVNldHVwLCBOVUxMCj4gIH07Cj4g
IAo+IC1zdGF0aWMgcG9pbnRlcgo+IC1kdW1teVNldHVwKHBvaW50ZXIgbW9kdWxlLCBwb2ludGVy
IG9wdHMsIGludCAqZXJybWFqLCBpbnQgKmVycm1pbikKPiArc3RhdGljIHBvaW50ZXIgZHVtbXlT
ZXR1cChwb2ludGVyIG1vZHVsZSwgcG9pbnRlciBvcHRzLCBpbnQgKmVycm1haiwgaW50Cj4gKmVy
cm1pbikKPiAgewo+ICAgICAgc3RhdGljIEJvb2wgc2V0dXBEb25lID0gRkFMU0U7Cj4gIAo+ICAg
ICAgaWYgKCFzZXR1cERvbmUpIHsKPiAtCXNldHVwRG9uZSA9IFRSVUU7Cj4gKyAgICAgICAgc2V0
dXBEb25lID0gVFJVRTsKPiAgICAgICAgICB4Zjg2QWRkRHJpdmVyKCZEVU1NWSwgbW9kdWxlLCBI
YXZlRHJpdmVyRnVuY3MpOwo+ICAKPiAtCS8qCj4gLQkgKiBNb2R1bGVzIHRoYXQgdGhpcyBkcml2
ZXIgYWx3YXlzIHJlcXVpcmVzIGNhbiBiZSBsb2FkZWQgaGVyZQo+IC0JICogYnkgY2FsbGluZyBM
b2FkU3ViTW9kdWxlKCkuCj4gLQkgKi8KPiAtCj4gLQkvKgo+IC0JICogVGhlIHJldHVybiB2YWx1
ZSBtdXN0IGJlIG5vbi1OVUxMIG9uIHN1Y2Nlc3MgZXZlbiB0aG91Z2ggdGhlcmUKPiAtCSAqIGlz
IG5vIFRlYXJEb3duUHJvYy4KPiAtCSAqLwo+IC0JcmV0dXJuIChwb2ludGVyKTE7Cj4gLSAgICB9
IGVsc2Ugewo+IC0JaWYgKGVycm1haikgKmVycm1haiA9IExEUl9PTkNFT05MWTsKPiAtCXJldHVy
biBOVUxMOwo+ICsgICAgICAgIC8qCj4gKyAgICAgICAgICogTW9kdWxlcyB0aGF0IHRoaXMgZHJp
dmVyIGFsd2F5cyByZXF1aXJlcyBjYW4gYmUgbG9hZGVkIGhlcmUKPiArICAgICAgICAgKiBieSBj
YWxsaW5nIExvYWRTdWJNb2R1bGUoKS4KPiArICAgICAgICAgKi8KPiArCj4gKyAgICAgICAgLyoK
PiArICAgICAgICAgKiBUaGUgcmV0dXJuIHZhbHVlIG11c3QgYmUgbm9uLU5VTEwgb24gc3VjY2Vz
cyBldmVuIHRob3VnaCB0aGVyZQo+ICsgICAgICAgICAqIGlzIG5vIFRlYXJEb3duUHJvYy4KPiAr
ICAgICAgICAgKi8KPiArICAgICAgICByZXR1cm4gKHBvaW50ZXIpIDE7Cj4gKyAgICB9Cj4gKyAg
ICBlbHNlIHsKCldvdWxkIGJlCgogICAgIH0gZWxzZSB7Cgo+ICsgICAgICAgIGlmIChlcnJtYWop
Cj4gKyAgICAgICAgICAgICplcnJtYWogPSBMRFJfT05DRU9OTFk7Cj4gKyAgICAgICAgcmV0dXJu
IE5VTEw7Cj4gICAgICB9Cj4gIH0KPiAgCj4gICNlbmRpZiAvKiBYRnJlZTg2TE9BREVSICovCj4g
IAo+IC1zdGF0aWMgQm9vbAo+IC1EVU1NWUdldFJlYyhTY3JuSW5mb1B0ciBwU2NybikKPiArc3Rh
dGljIEJvb2wgRFVNTVlHZXRSZWMoU2NybkluZm9QdHIgcFNjcm4pCj4gIHsKPiAgICAgIC8qCj4g
ICAgICAgKiBBbGxvY2F0ZSBhIERVTU1ZUmVjLCBhbmQgaG9vayBpdCBpbnRvIHBTY3JuLT5kcml2
ZXJQcml2YXRlLgo+IEBAIC0xNzQsNDEgKzE3MSwzNiBAQCBEVU1NWUdldFJlYyhTY3JuSW5mb1B0
ciBwU2NybikKPiAgICAgICAqIHRoZSBhbGxvY2F0aW9uIGhhcyBhbHJlYWR5IGJlZW4gZG9uZS4K
PiAgICAgICAqLwo+ICAgICAgaWYgKHBTY3JuLT5kcml2ZXJQcml2YXRlICE9IE5VTEwpCj4gLQly
ZXR1cm4gVFJVRTsKPiArICAgICAgICByZXR1cm4gVFJVRTsKPiAgCj4gICAgICBwU2Nybi0+ZHJp
dmVyUHJpdmF0ZSA9IHhuZmNhbGxvYyhzaXplb2YoRFVNTVlSZWMpLCAxKTsKPiAgCj4gICAgICBp
ZiAocFNjcm4tPmRyaXZlclByaXZhdGUgPT0gTlVMTCkKPiAtCXJldHVybiBGQUxTRTsKPiArICAg
ICAgICByZXR1cm4gRkFMU0U7Cj4gICAgICByZXR1cm4gVFJVRTsKPiAgfQo+ICAKPiAtc3RhdGlj
IHZvaWQKPiAtRFVNTVlGcmVlUmVjKFNjcm5JbmZvUHRyIHBTY3JuKQo+ICtzdGF0aWMgdm9pZCBE
VU1NWUZyZWVSZWMoU2NybkluZm9QdHIgcFNjcm4pCj4gIHsKPiAgICAgIGlmIChwU2Nybi0+ZHJp
dmVyUHJpdmF0ZSA9PSBOVUxMKQo+IC0JcmV0dXJuOwo+ICsgICAgICAgIHJldHVybjsKPiAgICAg
IGZyZWUocFNjcm4tPmRyaXZlclByaXZhdGUpOwo+ICAgICAgcFNjcm4tPmRyaXZlclByaXZhdGUg
PSBOVUxMOwo+ICB9Cj4gIAo+IC1zdGF0aWMgY29uc3QgT3B0aW9uSW5mb1JlYyAqCj4gLURVTU1Z
QXZhaWxhYmxlT3B0aW9ucyhpbnQgY2hpcGlkLCBpbnQgYnVzaWQpCj4gK3N0YXRpYyBjb25zdCBP
cHRpb25JbmZvUmVjICpEVU1NWUF2YWlsYWJsZU9wdGlvbnMoaW50IGNoaXBpZCwgaW50IGJ1c2lk
KQo+ICB7Cj4gICAgICByZXR1cm4gRFVNTVlPcHRpb25zOwo+ICB9Cj4gIAo+ICAvKiBNYW5kYXRv
cnkgKi8KPiAtc3RhdGljIHZvaWQKPiAtRFVNTVlJZGVudGlmeShpbnQgZmxhZ3MpCj4gK3N0YXRp
YyB2b2lkIERVTU1ZSWRlbnRpZnkoaW50IGZsYWdzKQo+ICB7Cj4gLSAgICB4Zjg2UHJpbnRDaGlw
c2V0cyhEVU1NWV9OQU1FLCAiRHJpdmVyIGZvciBEdW1teSBjaGlwc2V0cyIsCj4gLQkJCURVTU1Z
Q2hpcHNldHMpOwo+ICsgICAgeGY4NlByaW50Q2hpcHNldHMoRFVNTVlfTkFNRSwgIkRyaXZlciBm
b3IgRHVtbXkgY2hpcHNldHMiLAo+IERVTU1ZQ2hpcHNldHMpOwo+ICB9Cj4gIAo+ICAvKiBNYW5k
YXRvcnkgKi8KPiAtc3RhdGljIEJvb2wKPiAtRFVNTVlQcm9iZShEcml2ZXJQdHIgZHJ2LCBpbnQg
ZmxhZ3MpCj4gK3N0YXRpYyBCb29sIERVTU1ZUHJvYmUoRHJpdmVyUHRyIGRydiwgaW50IGZsYWdz
KQo+ICB7Cj4gICAgICBCb29sIGZvdW5kU2NyZWVuID0gRkFMU0U7Cj4gICAgICBpbnQgbnVtRGV2
U2VjdGlvbnMsIG51bVVzZWQ7Cj4gQEAgLTIxNiw1OCArMjA4LDU1IEBAIERVTU1ZUHJvYmUoRHJp
dmVyUHRyIGRydiwgaW50IGZsYWdzKQo+ICAgICAgaW50IGk7Cj4gIAo+ICAgICAgaWYgKGZsYWdz
ICYgUFJPQkVfREVURUNUKQo+IC0JcmV0dXJuIEZBTFNFOwo+ICsgICAgICAgIHJldHVybiBGQUxT
RTsKPiAgICAgIC8qCj4gICAgICAgKiBGaW5kIHRoZSBjb25maWcgZmlsZSBEZXZpY2Ugc2VjdGlv
bnMgdGhhdCBtYXRjaCB0aGlzCj4gICAgICAgKiBkcml2ZXIsIGFuZCByZXR1cm4gaWYgdGhlcmUg
YXJlIG5vbmUuCj4gICAgICAgKi8KPiAtICAgIGlmICgobnVtRGV2U2VjdGlvbnMgPSB4Zjg2TWF0
Y2hEZXZpY2UoRFVNTVlfRFJJVkVSX05BTUUsCj4gLQkJCQkJICAmZGV2U2VjdGlvbnMpKSA8PSAw
KSB7Cj4gLQlyZXR1cm4gRkFMU0U7Cj4gKyAgICBpZiAoKG51bURldlNlY3Rpb25zID0geGY4Nk1h
dGNoRGV2aWNlKERVTU1ZX0RSSVZFUl9OQU1FLCAmZGV2U2VjdGlvbnMpKQo+IDw9IDApIHsKPiAr
ICAgICAgICByZXR1cm4gRkFMU0U7Cj4gICAgICB9Cj4gIAo+ICAgICAgbnVtVXNlZCA9IG51bURl
dlNlY3Rpb25zOwo+ICAKPiAgICAgIGlmIChudW1Vc2VkID4gMCkgewo+ICAKPiAtCWZvciAoaSA9
IDA7IGkgPCBudW1Vc2VkOyBpKyspIHsKPiAtCSAgICBTY3JuSW5mb1B0ciBwU2NybiA9IE5VTEw7
Cj4gLQkgICAgaW50IGVudGl0eUluZGV4ID0KPiAtCQl4Zjg2Q2xhaW1Ob1Nsb3QoZHJ2LERVTU1Z
X0NISVAsZGV2U2VjdGlvbnNbaV0sVFJVRSk7Cj4gLQkgICAgLyogQWxsb2NhdGUgYSBTY3JuSW5m
b1JlYyBhbmQgY2xhaW0gdGhlIHNsb3QgKi8KPiAtCSAgICBpZiAoKHBTY3JuID0geGY4NkFsbG9j
YXRlU2NyZWVuKGRydiwwICkpKSB7Cj4gLQkJICAgeGY4NkFkZEVudGl0eVRvU2NyZWVuKHBTY3Ju
LGVudGl0eUluZGV4KTsKPiAtCQkgICAgcFNjcm4tPmRyaXZlclZlcnNpb24gPSBEVU1NWV9WRVJT
SU9OOwo+IC0JCSAgICBwU2Nybi0+ZHJpdmVyTmFtZSAgICA9IERVTU1ZX0RSSVZFUl9OQU1FOwo+
IC0JCSAgICBwU2Nybi0+bmFtZSAgICAgICAgICA9IERVTU1ZX05BTUU7Cj4gLQkJICAgIHBTY3Ju
LT5Qcm9iZSAgICAgICAgID0gRFVNTVlQcm9iZTsKPiAtCQkgICAgcFNjcm4tPlByZUluaXQgICAg
ICAgPSBEVU1NWVByZUluaXQ7Cj4gLQkJICAgIHBTY3JuLT5TY3JlZW5Jbml0ICAgID0gRFVNTVlT
Y3JlZW5Jbml0Owo+IC0JCSAgICBwU2Nybi0+U3dpdGNoTW9kZSAgICA9IERVTU1ZU3dpdGNoTW9k
ZTsKPiAtCQkgICAgcFNjcm4tPkFkanVzdEZyYW1lICAgPSBEVU1NWUFkanVzdEZyYW1lOwo+IC0J
CSAgICBwU2Nybi0+RW50ZXJWVCAgICAgICA9IERVTU1ZRW50ZXJWVDsKPiAtCQkgICAgcFNjcm4t
PkxlYXZlVlQgICAgICAgPSBEVU1NWUxlYXZlVlQ7Cj4gLQkJICAgIHBTY3JuLT5GcmVlU2NyZWVu
ICAgID0gRFVNTVlGcmVlU2NyZWVuOwo+IC0JCSAgICBwU2Nybi0+VmFsaWRNb2RlICAgICA9IERV
TU1ZVmFsaWRNb2RlOwo+IC0KPiAtCQkgICAgZm91bmRTY3JlZW4gPSBUUlVFOwo+IC0JICAgIH0K
PiAtCX0KPiAtICAgIH0KPiArICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbnVtVXNlZDsgaSsrKSB7
Cj4gKyAgICAgICAgICAgIFNjcm5JbmZvUHRyIHBTY3JuID0gTlVMTDsKPiArICAgICAgICAgICAg
aW50IGVudGl0eUluZGV4ID0geGY4NkNsYWltTm9TbG90KGRydiwgRFVNTVlfQ0hJUCwKPiBkZXZT
ZWN0aW9uc1tpXSwgVFJVRSk7Cj4gKyAgICAgICAgICAgIC8qIEFsbG9jYXRlIGEgU2NybkluZm9S
ZWMgYW5kIGNsYWltIHRoZSBzbG90ICovCj4gKyAgICAgICAgICAgIGlmICgocFNjcm4gPSB4Zjg2
QWxsb2NhdGVTY3JlZW4oZHJ2LCAwKSkpIHsKPiArICAgICAgICAgICAgICAgIHhmODZBZGRFbnRp
dHlUb1NjcmVlbihwU2NybiwgZW50aXR5SW5kZXgpOwo+ICsgICAgICAgICAgICAgICAgcFNjcm4t
PmRyaXZlclZlcnNpb24gPSBEVU1NWV9WRVJTSU9OOwo+ICsgICAgICAgICAgICAgICAgcFNjcm4t
PmRyaXZlck5hbWUgPSBEVU1NWV9EUklWRVJfTkFNRTsKPiArICAgICAgICAgICAgICAgIHBTY3Ju
LT5uYW1lID0gRFVNTVlfTkFNRTsKPiArICAgICAgICAgICAgICAgIHBTY3JuLT5Qcm9iZSA9IERV
TU1ZUHJvYmU7Cj4gKyAgICAgICAgICAgICAgICBwU2Nybi0+UHJlSW5pdCA9IERVTU1ZUHJlSW5p
dDsKPiArICAgICAgICAgICAgICAgIHBTY3JuLT5TY3JlZW5Jbml0ID0gRFVNTVlTY3JlZW5Jbml0
Owo+ICsgICAgICAgICAgICAgICAgcFNjcm4tPlN3aXRjaE1vZGUgPSBEVU1NWVN3aXRjaE1vZGU7
Cj4gKyAgICAgICAgICAgICAgICBwU2Nybi0+QWRqdXN0RnJhbWUgPSBEVU1NWUFkanVzdEZyYW1l
Owo+ICsgICAgICAgICAgICAgICAgcFNjcm4tPkVudGVyVlQgPSBEVU1NWUVudGVyVlQ7Cj4gKyAg
ICAgICAgICAgICAgICBwU2Nybi0+TGVhdmVWVCA9IERVTU1ZTGVhdmVWVDsKPiArICAgICAgICAg
ICAgICAgIHBTY3JuLT5GcmVlU2NyZWVuID0gRFVNTVlGcmVlU2NyZWVuOwo+ICsgICAgICAgICAg
ICAgICAgcFNjcm4tPlZhbGlkTW9kZSA9IERVTU1ZVmFsaWRNb2RlOwo+ICsKPiArICAgICAgICAg
ICAgICAgIGZvdW5kU2NyZWVuID0gVFJVRTsKPiArICAgICAgICAgICAgfQo+ICsgICAgICAgIH0K
PiArICAgIH0KPiAgCj4gICAgICBmcmVlKGRldlNlY3Rpb25zKTsKPiAgCj4gICAgICByZXR1cm4g
Zm91bmRTY3JlZW47Cj4gIH0KPiAgCj4gLSMgZGVmaW5lIFJFVFVSTiBcCj4gKyNkZWZpbmUgUkVU
VVJOIFwKPiAgICAgIHsgRFVNTVlGcmVlUmVjKHBTY3JuKTtcCj4gIAkJCSAgICByZXR1cm4gRkFM
U0U7XAo+ICAJCQkJCSAgICAgfQo+ICAKPiAgLyogTWFuZGF0b3J5ICovCj4gLUJvb2wKPiAtRFVN
TVlQcmVJbml0KFNjcm5JbmZvUHRyIHBTY3JuLCBpbnQgZmxhZ3MpCj4gK0Jvb2wgRFVNTVlQcmVJ
bml0KFNjcm5JbmZvUHRyIHBTY3JuLCBpbnQgZmxhZ3MpCj4gIHsKPiAgICAgIENsb2NrUmFuZ2VQ
dHIgY2xvY2tSYW5nZXM7Cj4gICAgICBpbnQgaTsKPiBAQCAtMjc1LDEwMyArMjY0LDEwMCBAQCBE
VU1NWVByZUluaXQoU2NybkluZm9QdHIgcFNjcm4sIGludCBmbGFncykKPiAgICAgIGludCBtYXhD
bG9jayA9IDMwMDAwMDsKPiAgICAgIEdEZXZQdHIgZGV2aWNlID0geGY4NkdldEVudGl0eUluZm8o
cFNjcm4tPmVudGl0eUxpc3RbMF0pLT5kZXZpY2U7Cj4gIAo+IC0gICAgaWYgKGZsYWdzICYgUFJP
QkVfREVURUNUKQo+IC0JcmV0dXJuIFRSVUU7Cj4gLQo+ICsgICAgaWYgKGZsYWdzICYgUFJPQkVf
REVURUNUKQo+ICsgICAgICAgIHJldHVybiBUUlVFOwo+ICsKPiAgICAgIC8qIEFsbG9jYXRlIHRo
ZSBEdW1teVJlYyBkcml2ZXJQcml2YXRlICovCj4gICAgICBpZiAoIURVTU1ZR2V0UmVjKHBTY3Ju
KSkgewo+IC0JcmV0dXJuIEZBTFNFOwo+ICsgICAgICAgIHJldHVybiBGQUxTRTsKPiAgICAgIH0K
PiAtCj4gKwo+ICAgICAgZFB0ciA9IERVTU1ZUFRSKHBTY3JuKTsKPiAgCj4gLSAgICBwU2Nybi0+
Y2hpcHNldCA9IChjaGFyICopeGY4NlRva2VuVG9TdHJpbmcoRFVNTVlDaGlwc2V0cywKPiAtCQkJ
CQkgICAgICAgRFVNTVlfQ0hJUCk7Cj4gKyAgICBwU2Nybi0+Y2hpcHNldCA9IChjaGFyICopIHhm
ODZUb2tlblRvU3RyaW5nKERVTU1ZQ2hpcHNldHMsIERVTU1ZX0NISVApOwo+ICAKPiAgICAgIHhm
ODZEcnZNc2cocFNjcm4tPnNjcm5JbmRleCwgWF9JTkZPLCAiQ2hpcHNldCBpcyBhIERVTU1ZXG4i
KTsKPiAtCj4gKwo+ICAgICAgcFNjcm4tPm1vbml0b3IgPSBwU2Nybi0+Y29uZlNjcmVlbi0+bW9u
aXRvcjsKPiAgCj4gLSAgICBpZiAoIXhmODZTZXREZXB0aEJwcChwU2NybiwgMCwgMCwgMCwgIFN1
cHBvcnQyNGJwcEZiIHwgU3VwcG9ydDMyYnBwRmIpKQo+IC0JcmV0dXJuIEZBTFNFOwo+ICsgICAg
aWYgKCF4Zjg2U2V0RGVwdGhCcHAocFNjcm4sIDAsIDAsIDAsIFN1cHBvcnQyNGJwcEZiIHwgU3Vw
cG9ydDMyYnBwRmIpKQo+ICsgICAgICAgIHJldHVybiBGQUxTRTsKPiAgICAgIGVsc2Ugewo+IC0J
LyogQ2hlY2sgdGhhdCB0aGUgcmV0dXJuZWQgZGVwdGggaXMgb25lIHdlIHN1cHBvcnQgKi8KPiAt
CXN3aXRjaCAocFNjcm4tPmRlcHRoKSB7Cj4gLQljYXNlIDg6Cj4gLQljYXNlIDE1Ogo+IC0JY2Fz
ZSAxNjoKPiAtCWNhc2UgMjQ6Cj4gLQljYXNlIDMwOgo+IC0JICAgIGJyZWFrOwo+IC0JZGVmYXVs
dDoKPiAtCSAgICB4Zjg2RHJ2TXNnKHBTY3JuLT5zY3JuSW5kZXgsIFhfRVJST1IsCj4gLQkJICAg
ICAgICJHaXZlbiBkZXB0aCAoJWQpIGlzIG5vdCBzdXBwb3J0ZWQgYnkgdGhpcyBkcml2ZXJcbiIs
Cj4gLQkJICAgICAgIHBTY3JuLT5kZXB0aCk7Cj4gLQkgICAgcmV0dXJuIEZBTFNFOwo+IC0JfQo+
ICsgICAgICAgIC8qIENoZWNrIHRoYXQgdGhlIHJldHVybmVkIGRlcHRoIGlzIG9uZSB3ZSBzdXBw
b3J0ICovCj4gKyAgICAgICAgc3dpdGNoIChwU2Nybi0+ZGVwdGgpIHsKPiArICAgICAgICAgICAg
Y2FzZSA4OgoKV2UgdXN1YWxseSBkb24ndCBpbmRlbnQgY2FzZXMgd2l0aCBzd2l0Y2guCgo+ICsg
ICAgICAgICAgICBjYXNlIDE1Ogo+ICsgICAgICAgICAgICBjYXNlIDE2Ogo+ICsgICAgICAgICAg
ICBjYXNlIDI0Ogo+ICsgICAgICAgICAgICBjYXNlIDMwOgo+ICsgICAgICAgICAgICAgICAgYnJl
YWs7Cj4gKyAgICAgICAgICAgIGRlZmF1bHQ6Cj4gKyAgICAgICAgICAgICAgICB4Zjg2RHJ2TXNn
KHBTY3JuLT5zY3JuSW5kZXgsIFhfRVJST1IsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICJHaXZlbiBkZXB0aCAoJWQpIGlzIG5vdCBzdXBwb3J0ZWQgYnkgdGhpcwo+IGRyaXZlclxuIiwg
cFNjcm4tPmRlcHRoKTsKPiArICAgICAgICAgICAgICAgIHJldHVybiBGQUxTRTsKPiArICAgICAg
ICB9Cj4gICAgICB9Cj4gIAo+ICAgICAgeGY4NlByaW50RGVwdGhCcHAocFNjcm4pOwo+ICAgICAg
aWYgKHBTY3JuLT5kZXB0aCA9PSA4KQo+IC0JcFNjcm4tPnJnYkJpdHMgPSA4Owo+ICsgICAgICAg
IHBTY3JuLT5yZ2JCaXRzID0gODsKPiAgCj4gICAgICAvKiBHZXQgdGhlIGRlcHRoMjQgcGl4bWFw
IGZvcm1hdCAqLwo+ICAgICAgaWYgKHBTY3JuLT5kZXB0aCA9PSAyNCAmJiBwaXgyNGJwcCA9PSAw
KQo+IC0JcGl4MjRicHAgPSB4Zjg2R2V0QnBwRnJvbURlcHRoKHBTY3JuLCAyNCk7Cj4gKyAgICAg
ICAgcGl4MjRicHAgPSB4Zjg2R2V0QnBwRnJvbURlcHRoKHBTY3JuLCAyNCk7Cj4gIAo+ICAgICAg
LyoKPiAgICAgICAqIFRoaXMgbXVzdCBoYXBwZW4gYWZ0ZXIgcFNjcm4tPmRpc3BsYXkgaGFzIGJl
ZW4gc2V0IGJlY2F1c2UKPiAgICAgICAqIHhmODZTZXRXZWlnaHQgcmVmZXJlbmNlcyBpdC4KPiAg
ICAgICAqLwo+ICAgICAgaWYgKHBTY3JuLT5kZXB0aCA+IDgpIHsKPiAtCS8qIFRoZSBkZWZhdWx0
cyBhcmUgT0sgZm9yIHVzICovCj4gLQlyZ2IgemVyb3MgPSB7MCwgMCwgMH07Cj4gLQo+IC0JaWYg
KCF4Zjg2U2V0V2VpZ2h0KHBTY3JuLCB6ZXJvcywgemVyb3MpKSB7Cj4gLQkgICAgcmV0dXJuIEZB
TFNFOwo+IC0JfSBlbHNlIHsKPiAtCSAgICAvKiBYWFggY2hlY2sgdGhhdCB3ZWlnaHQgcmV0dXJu
ZWQgaXMgc3VwcG9ydGVkICovCj4gLQkgICAgOwo+IC0JfQo+ICsgICAgICAgIC8qIFRoZSBkZWZh
dWx0cyBhcmUgT0sgZm9yIHVzICovCj4gKyAgICAgICAgcmdiIHplcm9zID0geyAwLCAwLCAwIH07
Cj4gKwo+ICsgICAgICAgIGlmICgheGY4NlNldFdlaWdodChwU2NybiwgemVyb3MsIHplcm9zKSkg
ewo+ICsgICAgICAgICAgICByZXR1cm4gRkFMU0U7Cj4gKyAgICAgICAgfQo+ICsgICAgICAgIGVs
c2Ugewo+ICsgICAgICAgICAgICAvKiBYWFggY2hlY2sgdGhhdCB3ZWlnaHQgcmV0dXJuZWQgaXMg
c3VwcG9ydGVkICovCj4gKyAgICAgICAgICAgIDsKPiArICAgICAgICB9Cj4gICAgICB9Cj4gIAo+
IC0gICAgaWYgKCF4Zjg2U2V0RGVmYXVsdFZpc3VhbChwU2NybiwgLTEpKQo+IC0JcmV0dXJuIEZB
TFNFOwo+ICsgICAgaWYgKCF4Zjg2U2V0RGVmYXVsdFZpc3VhbChwU2NybiwgLTEpKQo+ICsgICAg
ICAgIHJldHVybiBGQUxTRTsKPiAgCj4gICAgICBpZiAocFNjcm4tPmRlcHRoID4gMSkgewo+IC0J
R2FtbWEgemVyb3MgPSB7MC4wLCAwLjAsIDAuMH07Cj4gKyAgICAgICAgR2FtbWEgemVyb3MgPSB7
IDAuMCwgMC4wLCAwLjAgfTsKPiAgCj4gLQlpZiAoIXhmODZTZXRHYW1tYShwU2NybiwgemVyb3Mp
KQo+IC0JICAgIHJldHVybiBGQUxTRTsKPiArICAgICAgICBpZiAoIXhmODZTZXRHYW1tYShwU2Ny
biwgemVyb3MpKQo+ICsgICAgICAgICAgICByZXR1cm4gRkFMU0U7Cj4gICAgICB9Cj4gIAo+ICAg
ICAgeGY4NkNvbGxlY3RPcHRpb25zKHBTY3JuLCBkZXZpY2UtPm9wdGlvbnMpOwo+ICAgICAgLyog
UHJvY2VzcyB0aGUgb3B0aW9ucyAqLwo+ICAgICAgaWYgKCEoZFB0ci0+T3B0aW9ucyA9IG1hbGxv
YyhzaXplb2YoRFVNTVlPcHRpb25zKSkpKQo+IC0JcmV0dXJuIEZBTFNFOwo+ICsgICAgICAgIHJl
dHVybiBGQUxTRTsKPiAgICAgIG1lbWNweShkUHRyLT5PcHRpb25zLCBEVU1NWU9wdGlvbnMsIHNp
emVvZihEVU1NWU9wdGlvbnMpKTsKPiAgCj4gICAgICB4Zjg2UHJvY2Vzc09wdGlvbnMocFNjcm4t
PnNjcm5JbmRleCwgcFNjcm4tPm9wdGlvbnMsIGRQdHItPk9wdGlvbnMpOwo+ICAKPiAtICAgIHhm
ODZHZXRPcHRWYWxCb29sKGRQdHItPk9wdGlvbnMsIE9QVElPTl9TV19DVVJTT1IsJmRQdHItPnN3
Q3Vyc29yKTsKPiArICAgIHhmODZHZXRPcHRWYWxCb29sKGRQdHItPk9wdGlvbnMsIE9QVElPTl9T
V19DVVJTT1IsICZkUHRyLT5zd0N1cnNvcik7Cj4gIAo+ICAgICAgaWYgKGRldmljZS0+dmlkZW9S
YW0gIT0gMCkgewo+IC0JcFNjcm4tPnZpZGVvUmFtID0gZGV2aWNlLT52aWRlb1JhbTsKPiAtCXhm
ODZEcnZNc2cocFNjcm4tPnNjcm5JbmRleCwgWF9DT05GSUcsICJWaWRlb1JBTTogJWQga0J5dGVc
biIsCj4gLQkJICAgcFNjcm4tPnZpZGVvUmFtKTsKPiAtICAgIH0gZWxzZSB7Cj4gLQlwU2Nybi0+
dmlkZW9SYW0gPSA0MDk2Owo+IC0JeGY4NkRydk1zZyhwU2Nybi0+c2NybkluZGV4LCBYX1BST0JF
RCwgIlZpZGVvUkFNOiAlZCBrQnl0ZVxuIiwKPiAtCQkgICBwU2Nybi0+dmlkZW9SYW0pOwo+ICsg
ICAgICAgIHBTY3JuLT52aWRlb1JhbSA9IGRldmljZS0+dmlkZW9SYW07Cj4gKyAgICAgICAgeGY4
NkRydk1zZyhwU2Nybi0+c2NybkluZGV4LCBYX0NPTkZJRywgIlZpZGVvUkFNOiAlZCBrQnl0ZVxu
IiwKPiBwU2Nybi0+dmlkZW9SYW0pOwo+ICsgICAgfQo+ICsgICAgZWxzZSB7Cj4gKyAgICAgICAg
cFNjcm4tPnZpZGVvUmFtID0gNDA5NjsKPiArICAgICAgICB4Zjg2RHJ2TXNnKHBTY3JuLT5zY3Ju
SW5kZXgsIFhfUFJPQkVELCAiVmlkZW9SQU06ICVkIGtCeXRlXG4iLAo+IHBTY3JuLT52aWRlb1Jh
bSk7Cj4gICAgICB9Cj4gLQo+ICsKPiAgICAgIGlmIChkZXZpY2UtPmRhY1NwZWVkc1swXSAhPSAw
KSB7Cj4gLQltYXhDbG9jayA9IGRldmljZS0+ZGFjU3BlZWRzWzBdOwo+IC0JeGY4NkRydk1zZyhw
U2Nybi0+c2NybkluZGV4LCBYX0NPTkZJRywgIk1heCBDbG9jazogJWQga0h6XG4iLAo+IC0JCSAg
IG1heENsb2NrKTsKPiAtICAgIH0gZWxzZSB7Cj4gLQl4Zjg2RHJ2TXNnKHBTY3JuLT5zY3JuSW5k
ZXgsIFhfUFJPQkVELCAiTWF4IENsb2NrOiAlZCBrSHpcbiIsCj4gLQkJICAgbWF4Q2xvY2spOwo+
ICsgICAgICAgIG1heENsb2NrID0gZGV2aWNlLT5kYWNTcGVlZHNbMF07Cj4gKyAgICAgICAgeGY4
NkRydk1zZyhwU2Nybi0+c2NybkluZGV4LCBYX0NPTkZJRywgIk1heCBDbG9jazogJWQga0h6XG4i
LAo+IG1heENsb2NrKTsKPiArICAgIH0KPiArICAgIGVsc2Ugewo+ICsgICAgICAgIHhmODZEcnZN
c2cocFNjcm4tPnNjcm5JbmRleCwgWF9QUk9CRUQsICJNYXggQ2xvY2s6ICVkIGtIelxuIiwKPiBt
YXhDbG9jayk7Cj4gICAgICB9Cj4gIAo+ICAgICAgcFNjcm4tPnByb2dDbG9jayA9IFRSVUU7Cj4g
QEAgLTM3OSwzOCArMzY1LDM3IEBAIERVTU1ZUHJlSW5pdChTY3JuSW5mb1B0ciBwU2NybiwgaW50
IGZsYWdzKQo+ICAgICAgICogU2V0dXAgdGhlIENsb2NrUmFuZ2VzLCB3aGljaCBkZXNjcmliZSB3
aGF0IGNsb2NrIHJhbmdlcyBhcmUKPiAgICAgICBhdmFpbGFibGUsCj4gICAgICAgKiBhbmQgd2hh
dCBzb3J0IG9mIG1vZGVzIHRoZXkgY2FuIGJlIHVzZWQgZm9yLgo+ICAgICAgICovCj4gLSAgICBj
bG9ja1JhbmdlcyA9IChDbG9ja1JhbmdlUHRyKXhuZmNhbGxvYyhzaXplb2YoQ2xvY2tSYW5nZSks
IDEpOwo+ICsgICAgY2xvY2tSYW5nZXMgPSAoQ2xvY2tSYW5nZVB0cikgeG5mY2FsbG9jKHNpemVv
ZihDbG9ja1JhbmdlKSwgMSk7Cj4gICAgICBjbG9ja1Jhbmdlcy0+bmV4dCA9IE5VTEw7Cj4gICAg
ICBjbG9ja1Jhbmdlcy0+Q2xvY2tNdWxGYWN0b3IgPSAxOwo+IC0gICAgY2xvY2tSYW5nZXMtPm1p
bkNsb2NrID0gMTEwMDA7ICAgLyogZ3Vlc3NlZCDCp8KnwqcgKi8KPiArICAgIGNsb2NrUmFuZ2Vz
LT5taW5DbG9jayA9IDExMDAwOyAgLyogZ3Vlc3NlZCDCp8KnwqcgKi8KPiAgICAgIGNsb2NrUmFu
Z2VzLT5tYXhDbG9jayA9IG1heENsb2NrOwo+IC0gICAgY2xvY2tSYW5nZXMtPmNsb2NrSW5kZXgg
PSAtMTsJCS8qIHByb2dyYW1tYWJsZSAqLwo+IC0gICAgY2xvY2tSYW5nZXMtPmludGVybGFjZUFs
bG93ZWQgPSBUUlVFOwo+ICsgICAgY2xvY2tSYW5nZXMtPmNsb2NrSW5kZXggPSAtMTsgICAvKiBw
cm9ncmFtbWFibGUgKi8KPiArICAgIGNsb2NrUmFuZ2VzLT5pbnRlcmxhY2VBbGxvd2VkID0gVFJV
RTsKPiAgICAgIGNsb2NrUmFuZ2VzLT5kb3VibGVTY2FuQWxsb3dlZCA9IFRSVUU7Cj4gIAo+ICAg
ICAgLyogU3VidHJhY3QgbWVtb3J5IGZvciBIVyBjdXJzb3IgKi8KPiAgCj4gIAo+ICAgICAgewo+
IC0JaW50IGFwZXJ0dXJlU2l6ZSA9IChwU2Nybi0+dmlkZW9SYW0gKiAxMDI0KTsKPiAtCWkgPSB4
Zjg2VmFsaWRhdGVNb2RlcyhwU2NybiwgcFNjcm4tPm1vbml0b3ItPk1vZGVzLAo+IC0JCQkgICAg
ICBwU2Nybi0+ZGlzcGxheS0+bW9kZXMsIGNsb2NrUmFuZ2VzLAo+IC0JCQkgICAgICBOVUxMLCAy
NTYsIERVTU1ZX01BWF9XSURUSCwKPiAtCQkJICAgICAgKDggKiBwU2Nybi0+Yml0c1BlclBpeGVs
KSwKPiAtCQkJICAgICAgMTI4LCBEVU1NWV9NQVhfSEVJR0hULCBwU2Nybi0+ZGlzcGxheS0+dmly
dHVhbFgsCj4gLQkJCSAgICAgIHBTY3JuLT5kaXNwbGF5LT52aXJ0dWFsWSwgYXBlcnR1cmVTaXpl
LAo+IC0JCQkgICAgICBMT09LVVBfQkVTVF9SRUZSRVNIKTsKPiAtCj4gLSAgICAgICBpZiAoaSA9
PSAtMSkKPiAtICAgICAgICAgICBSRVRVUk47Cj4gKyAgICAgICAgaW50IGFwZXJ0dXJlU2l6ZSA9
IChwU2Nybi0+dmlkZW9SYW0gKiAxMDI0KTsKPiArICAgICAgICBpID0geGY4NlZhbGlkYXRlTW9k
ZXMocFNjcm4sIHBTY3JuLT5tb25pdG9yLT5Nb2RlcywKPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgcFNjcm4tPmRpc3BsYXktPm1vZGVzLCBjbG9ja1JhbmdlcywKPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgTlVMTCwgMjU2LCBEVU1NWV9NQVhfV0lEVEgsCj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICg4ICogcFNjcm4tPmJpdHNQZXJQaXhlbCksCj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIDEyOCwgRFVNTVlfTUFYX0hFSUdIVCwKPiBwU2Ny
bi0+ZGlzcGxheS0+dmlydHVhbFgsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBT
Y3JuLT5kaXNwbGF5LT52aXJ0dWFsWSwgYXBlcnR1cmVTaXplLAo+IExPT0tVUF9CRVNUX1JFRlJF
U0gpOwo+ICsKPiArICAgICAgICBpZiAoaSA9PSAtMSkKPiArICAgICAgICAgICAgUkVUVVJOOwo+
ICAgICAgfQo+ICAKPiAgICAgIC8qIFBydW5lIHRoZSBtb2RlcyBtYXJrZWQgYXMgaW52YWxpZCAq
Lwo+ICAgICAgeGY4NlBydW5lRHJpdmVyTW9kZXMocFNjcm4pOwo+ICAKPiAgICAgIGlmIChpID09
IDAgfHwgcFNjcm4tPm1vZGVzID09IE5VTEwpIHsKPiAtCXhmODZEcnZNc2cocFNjcm4tPnNjcm5J
bmRleCwgWF9FUlJPUiwgIk5vIHZhbGlkIG1vZGVzIGZvdW5kXG4iKTsKPiAtCVJFVFVSTjsKPiAr
ICAgICAgICB4Zjg2RHJ2TXNnKHBTY3JuLT5zY3JuSW5kZXgsIFhfRVJST1IsICJObyB2YWxpZCBt
b2RlcyBmb3VuZFxuIik7Cj4gKyAgICAgICAgUkVUVVJOOwo+ICAgICAgfQo+ICAKPiAgICAgIC8q
Cj4gQEAgLTQyMSw4ICs0MDYsOCBAQCBEVU1NWVByZUluaXQoU2NybkluZm9QdHIgcFNjcm4sIGlu
dCBmbGFncykKPiAgICAgICAqIGRyaXZlciBhbmQgaWYgdGhlIGRyaXZlciBkb2Vzbid0IHByb3Zp
ZGUgY29kZSB0byBzZXQgdGhlbS4gIFRoZXkKPiAgICAgICAqIGFyZSBub3QgcHJlLWluaXRpYWxp
c2VkIGF0IGFsbC4KPiAgICAgICAqLwo+IC0gICAgeGY4NlNldENydGNGb3JNb2RlcyhwU2Nybiwg
MCk7Cj4gLQo+ICsgICAgeGY4NlNldENydGNGb3JNb2RlcyhwU2NybiwgMCk7Cj4gKwo+ICAgICAg
LyogU2V0IHRoZSBjdXJyZW50IG1vZGUgdG8gdGhlIGZpcnN0IGluIHRoZSBsaXN0ICovCj4gICAg
ICBwU2Nybi0+Y3VycmVudE1vZGUgPSBwU2Nybi0+bW9kZXM7Cj4gIAo+IEBAIC00MzMsNzMgKzQx
OCw2NiBAQCBEVU1NWVByZUluaXQoU2NybkluZm9QdHIgcFNjcm4sIGludCBmbGFncykKPiAgICAg
IHhmODZTZXREcGkocFNjcm4sIDAsIDApOwo+ICAKPiAgICAgIGlmICh4Zjg2TG9hZFN1Yk1vZHVs
ZShwU2NybiwgImZiIikgPT0gTlVMTCkgewo+IC0JUkVUVVJOOwo+ICsgICAgICAgIFJFVFVSTjsK
PiAgICAgIH0KPiAgCj4gICAgICBpZiAoIWRQdHItPnN3Q3Vyc29yKSB7Cj4gLQlpZiAoIXhmODZM
b2FkU3ViTW9kdWxlKHBTY3JuLCAicmFtZGFjIikpCj4gLQkgICAgUkVUVVJOOwo+ICsgICAgICAg
IGlmICgheGY4NkxvYWRTdWJNb2R1bGUocFNjcm4sICJyYW1kYWMiKSkKPiArICAgICAgICAgICAg
UkVUVVJOOwo+ICAgICAgfQo+IC0KPiArCj4gICAgICAvKiBXZSBoYXZlIG5vIGNvbnRpZ3VvdXMg
cGh5c2ljYWwgZmIgaW4gcGh5c2ljYWwgbWVtb3J5ICovCj4gICAgICBwU2Nybi0+bWVtUGh5c0Jh
c2UgPSAwOwo+ICAgICAgcFNjcm4tPmZiT2Zmc2V0ID0gMDsKPiAgCj4gICAgICByZXR1cm4gVFJV
RTsKPiAgfQo+ICsKPiAgI3VuZGVmIFJFVFVSTgo+ICAKPiAgLyogTWFuZGF0b3J5ICovCj4gLXN0
YXRpYyBCb29sCj4gLURVTU1ZRW50ZXJWVChWVF9GVU5DX0FSR1NfREVDTCkKPiArc3RhdGljIEJv
b2wgRFVNTVlFbnRlclZUKFZUX0ZVTkNfQVJHU19ERUNMKQo+ICB7Cj4gICAgICByZXR1cm4gVFJV
RTsKPiAgfQo+ICAKPiAgLyogTWFuZGF0b3J5ICovCj4gLXN0YXRpYyB2b2lkCj4gLURVTU1ZTGVh
dmVWVChWVF9GVU5DX0FSR1NfREVDTCkKPiArc3RhdGljIHZvaWQgRFVNTVlMZWF2ZVZUKFZUX0ZV
TkNfQVJHU19ERUNMKQo+ICB7Cj4gIH0KPiAgCj4gIHN0YXRpYyB2b2lkCj4gLURVTU1ZTG9hZFBh
bGV0dGUoCj4gLSAgIFNjcm5JbmZvUHRyIHBTY3JuLAo+IC0gICBpbnQgbnVtQ29sb3JzLAo+IC0g
ICBpbnQgKmluZGljZXMsCj4gLSAgIExPQ08gKmNvbG9ycywKPiAtICAgVmlzdWFsUHRyIHBWaXN1
YWwKPiAtKXsKPiAtICAgaW50IGksIGluZGV4LCBzaGlmdCwgR3NoaWZ0Owo+IC0gICBEVU1NWVB0
ciBkUHRyID0gRFVNTVlQVFIocFNjcm4pOwo+IC0KPiAtICAgc3dpdGNoKHBTY3JuLT5kZXB0aCkg
ewo+IC0gICBjYXNlIDE1Ogo+IC0Jc2hpZnQgPSBHc2hpZnQgPSAxOwo+IC0JYnJlYWs7Cj4gLSAg
IGNhc2UgMTY6Cj4gLQlzaGlmdCA9IDA7Cj4gLSAgICAgICAgR3NoaWZ0ID0gMDsKPiAtCWJyZWFr
Owo+IC0gICBkZWZhdWx0Ogo+IC0Jc2hpZnQgPSBHc2hpZnQgPSAwOwo+IC0JYnJlYWs7Cj4gLSAg
IH0KPiAtCj4gLSAgIGZvcihpID0gMDsgaSA8IG51bUNvbG9yczsgaSsrKSB7Cj4gLSAgICAgICBp
bmRleCA9IGluZGljZXNbaV07Cj4gLSAgICAgICBkUHRyLT5jb2xvcnNbaW5kZXhdLnJlZCA9IGNv
bG9yc1tpbmRleF0ucmVkIDw8IHNoaWZ0Owo+IC0gICAgICAgZFB0ci0+Y29sb3JzW2luZGV4XS5n
cmVlbiA9IGNvbG9yc1tpbmRleF0uZ3JlZW4gPDwgR3NoaWZ0Owo+IC0gICAgICAgZFB0ci0+Y29s
b3JzW2luZGV4XS5ibHVlID0gY29sb3JzW2luZGV4XS5ibHVlIDw8IHNoaWZ0Owo+IC0gICB9Cj4g
K0RVTU1ZTG9hZFBhbGV0dGUoU2NybkluZm9QdHIgcFNjcm4sIGludCBudW1Db2xvcnMsIGludCAq
aW5kaWNlcywgTE9DTyAqCj4gY29sb3JzLCBWaXN1YWxQdHIgcFZpc3VhbCkKPiArewo+ICsgICAg
aW50IGksIGluZGV4LCBzaGlmdCwgR3NoaWZ0Owo+ICsgICAgRFVNTVlQdHIgZFB0ciA9IERVTU1Z
UFRSKHBTY3JuKTsKPiArCj4gKyAgICBzd2l0Y2ggKHBTY3JuLT5kZXB0aCkgewo+ICsgICAgICAg
IGNhc2UgMTU6Cj4gKyAgICAgICAgICAgIHNoaWZ0ID0gR3NoaWZ0ID0gMTsKPiArICAgICAgICAg
ICAgYnJlYWs7Cj4gKyAgICAgICAgY2FzZSAxNjoKPiArICAgICAgICAgICAgc2hpZnQgPSAwOwo+
ICsgICAgICAgICAgICBHc2hpZnQgPSAwOwo+ICsgICAgICAgICAgICBicmVhazsKPiArICAgICAg
ICBkZWZhdWx0Ogo+ICsgICAgICAgICAgICBzaGlmdCA9IEdzaGlmdCA9IDA7Cj4gKyAgICAgICAg
ICAgIGJyZWFrOwo+ICsgICAgfQo+ICsKPiArICAgIGZvciAoaSA9IDA7IGkgPCBudW1Db2xvcnM7
IGkrKykgewo+ICsgICAgICAgIGluZGV4ID0gaW5kaWNlc1tpXTsKPiArICAgICAgICBkUHRyLT5j
b2xvcnNbaW5kZXhdLnJlZCA9IGNvbG9yc1tpbmRleF0ucmVkIDw8IHNoaWZ0Owo+ICsgICAgICAg
IGRQdHItPmNvbG9yc1tpbmRleF0uZ3JlZW4gPSBjb2xvcnNbaW5kZXhdLmdyZWVuIDw8IEdzaGlm
dDsKPiArICAgICAgICBkUHRyLT5jb2xvcnNbaW5kZXhdLmJsdWUgPSBjb2xvcnNbaW5kZXhdLmJs
dWUgPDwgc2hpZnQ7Cj4gKyAgICB9Cj4gIAo+ICB9Cj4gIAo+IC1zdGF0aWMgU2NybkluZm9QdHIg
RFVNTVlTY3JuOyAvKiBzdGF0aWMtZ2xvYmFsaXplIGl0ICovCj4gK3N0YXRpYyBTY3JuSW5mb1B0
ciBEVU1NWVNjcm47ICAgLyogc3RhdGljLWdsb2JhbGl6ZSBpdCAqLwo+ICAKPiAgLyogTWFuZGF0
b3J5ICovCj4gLXN0YXRpYyBCb29sCj4gLURVTU1ZU2NyZWVuSW5pdChTQ1JFRU5fSU5JVF9BUkdT
X0RFQ0wpCj4gK3N0YXRpYyBCb29sIERVTU1ZU2NyZWVuSW5pdChTQ1JFRU5fSU5JVF9BUkdTX0RF
Q0wpCj4gIHsKPiAgICAgIFNjcm5JbmZvUHRyIHBTY3JuOwo+ICAgICAgRFVNTVlQdHIgZFB0cjsK
PiBAQCAtNTE3LDEwMiArNDk1LDk4IEBAIERVTU1ZU2NyZWVuSW5pdChTQ1JFRU5fSU5JVF9BUkdT
X0RFQ0wpCj4gIAo+ICAKPiAgICAgIGlmICghKHBpeGVscyA9IG1hbGxvYyhwU2Nybi0+dmlkZW9S
YW0gKiAxMDI0KSkpCj4gLQlyZXR1cm4gRkFMU0U7Cj4gKyAgICAgICAgcmV0dXJuIEZBTFNFOwo+
ICAKPiAgICAgIC8qCj4gICAgICAgKiBSZXNldCB2aXN1YWwgbGlzdC4KPiAgICAgICAqLwo+ICAg
ICAgbWlDbGVhclZpc3VhbFR5cGVzKCk7Cj4gLQo+ICsKPiAgICAgIC8qIFNldHVwIHRoZSB2aXN1
YWxzIHdlIHN1cHBvcnQuICovCj4gLQo+ICsKPiAgICAgIGlmICghbWlTZXRWaXN1YWxUeXBlcyhw
U2Nybi0+ZGVwdGgsCj4gLSAgICAgIAkJICAgICAgbWlHZXREZWZhdWx0VmlzdWFsTWFzayhwU2Ny
bi0+ZGVwdGgpLAo+IC0JCSAgICAgIHBTY3JuLT5yZ2JCaXRzLCBwU2Nybi0+ZGVmYXVsdFZpc3Vh
bCkpCj4gLSAgICAgICAgIHJldHVybiBGQUxTRTsKPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICBtaUdldERlZmF1bHRWaXN1YWxNYXNrKHBTY3JuLT5kZXB0aCksCj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgcFNjcm4tPnJnYkJpdHMsIHBTY3JuLT5kZWZhdWx0VmlzdWFsKSkKPiArICAg
ICAgICByZXR1cm4gRkFMU0U7Cj4gIAo+IC0gICAgaWYgKCFtaVNldFBpeG1hcERlcHRocyAoKSkg
cmV0dXJuIEZBTFNFOwo+ICsgICAgaWYgKCFtaVNldFBpeG1hcERlcHRocygpKQo+ICsgICAgICAg
IHJldHVybiBGQUxTRTsKPiAgCj4gICAgICAvKgo+ICAgICAgICogQ2FsbCB0aGUgZnJhbWVidWZm
ZXIgbGF5ZXIncyBTY3JlZW5Jbml0IGZ1bmN0aW9uLCBhbmQgZmlsbCBpbiBvdGhlcgo+ICAgICAg
ICogcFNjcmVlbiBmaWVsZHMuCj4gICAgICAgKi8KPiAgICAgIHJldCA9IGZiU2NyZWVuSW5pdChw
U2NyZWVuLCBwaXhlbHMsCj4gLQkJCSAgICBwU2Nybi0+dmlydHVhbFgsIHBTY3JuLT52aXJ0dWFs
WSwKPiAtCQkJICAgIHBTY3JuLT54RHBpLCBwU2Nybi0+eURwaSwKPiAtCQkJICAgIHBTY3JuLT5k
aXNwbGF5V2lkdGgsIHBTY3JuLT5iaXRzUGVyUGl4ZWwpOwo+ICsgICAgICAgICAgICAgICAgICAg
ICAgIHBTY3JuLT52aXJ0dWFsWCwgcFNjcm4tPnZpcnR1YWxZLAo+ICsgICAgICAgICAgICAgICAg
ICAgICAgIHBTY3JuLT54RHBpLCBwU2Nybi0+eURwaSwgcFNjcm4tPmRpc3BsYXlXaWR0aCwKPiBw
U2Nybi0+Yml0c1BlclBpeGVsKTsKPiAgICAgIGlmICghcmV0KQo+IC0JcmV0dXJuIEZBTFNFOwo+
ICsgICAgICAgIHJldHVybiBGQUxTRTsKPiAgCj4gICAgICBpZiAocFNjcm4tPmRlcHRoID4gOCkg
ewo+ICAgICAgICAgIC8qIEZpeHVwIFJHQiBvcmRlcmluZyAqLwo+ICAgICAgICAgIHZpc3VhbCA9
IHBTY3JlZW4tPnZpc3VhbHMgKyBwU2NyZWVuLT5udW1WaXN1YWxzOwo+ICAgICAgICAgIHdoaWxl
ICgtLXZpc3VhbCA+PSBwU2NyZWVuLT52aXN1YWxzKSB7Cj4gLQkgICAgaWYgKCh2aXN1YWwtPmNs
YXNzIHwgRHluYW1pY0NsYXNzKSA9PSBEaXJlY3RDb2xvcikgewo+IC0JCXZpc3VhbC0+b2Zmc2V0
UmVkID0gcFNjcm4tPm9mZnNldC5yZWQ7Cj4gLQkJdmlzdWFsLT5vZmZzZXRHcmVlbiA9IHBTY3Ju
LT5vZmZzZXQuZ3JlZW47Cj4gLQkJdmlzdWFsLT5vZmZzZXRCbHVlID0gcFNjcm4tPm9mZnNldC5i
bHVlOwo+IC0JCXZpc3VhbC0+cmVkTWFzayA9IHBTY3JuLT5tYXNrLnJlZDsKPiAtCQl2aXN1YWwt
PmdyZWVuTWFzayA9IHBTY3JuLT5tYXNrLmdyZWVuOwo+IC0JCXZpc3VhbC0+Ymx1ZU1hc2sgPSBw
U2Nybi0+bWFzay5ibHVlOwo+IC0JICAgIH0KPiAtCX0KPiArICAgICAgICAgICAgaWYgKCh2aXN1
YWwtPmNsYXNzIHwgRHluYW1pY0NsYXNzKSA9PSBEaXJlY3RDb2xvcikgewo+ICsgICAgICAgICAg
ICAgICAgdmlzdWFsLT5vZmZzZXRSZWQgPSBwU2Nybi0+b2Zmc2V0LnJlZDsKPiArICAgICAgICAg
ICAgICAgIHZpc3VhbC0+b2Zmc2V0R3JlZW4gPSBwU2Nybi0+b2Zmc2V0LmdyZWVuOwo+ICsgICAg
ICAgICAgICAgICAgdmlzdWFsLT5vZmZzZXRCbHVlID0gcFNjcm4tPm9mZnNldC5ibHVlOwo+ICsg
ICAgICAgICAgICAgICAgdmlzdWFsLT5yZWRNYXNrID0gcFNjcm4tPm1hc2sucmVkOwo+ICsgICAg
ICAgICAgICAgICAgdmlzdWFsLT5ncmVlbk1hc2sgPSBwU2Nybi0+bWFzay5ncmVlbjsKPiArICAg
ICAgICAgICAgICAgIHZpc3VhbC0+Ymx1ZU1hc2sgPSBwU2Nybi0+bWFzay5ibHVlOwo+ICsgICAg
ICAgICAgICB9Cj4gKyAgICAgICAgfQo+ICAgICAgfQo+IC0KPiArCj4gICAgICAvKiBtdXN0IGJl
IGFmdGVyIFJHQiBvcmRlcmluZyBmaXhlZCAqLwo+ICAgICAgZmJQaWN0dXJlSW5pdChwU2NyZWVu
LCAwLCAwKTsKPiAgCj4gICAgICB4Zjg2U2V0QmxhY2tXaGl0ZVBpeGVscyhwU2NyZWVuKTsKPiAg
Cj4gICAgICBpZiAoZFB0ci0+c3dDdXJzb3IpCj4gLQl4Zjg2RHJ2TXNnKHBTY3JuLT5zY3JuSW5k
ZXgsIFhfQ09ORklHLCAiVXNpbmcgU29mdHdhcmUgQ3Vyc29yLlxuIik7Cj4gKyAgICAgICAgeGY4
NkRydk1zZyhwU2Nybi0+c2NybkluZGV4LCBYX0NPTkZJRywgIlVzaW5nIFNvZnR3YXJlIEN1cnNv
ci5cbiIpOwo+ICAKPiAgICAgIHsKPiAgCj4gLQo+IC0JQm94UmVjIEF2YWlsRkJBcmVhOwo+IC0J
aW50IGxpbmVzID0gcFNjcm4tPnZpZGVvUmFtICogMTAyNCAvCj4gLQkgICAgKHBTY3JuLT5kaXNw
bGF5V2lkdGggKiAocFNjcm4tPmJpdHNQZXJQaXhlbCA+PiAzKSk7Cj4gLQlBdmFpbEZCQXJlYS54
MSA9IDA7Cj4gLQlBdmFpbEZCQXJlYS55MSA9IDA7Cj4gLQlBdmFpbEZCQXJlYS54MiA9IHBTY3Ju
LT5kaXNwbGF5V2lkdGg7Cj4gLQlBdmFpbEZCQXJlYS55MiA9IGxpbmVzOwo+IC0JeGY4NkluaXRG
Qk1hbmFnZXIocFNjcmVlbiwgJkF2YWlsRkJBcmVhKTsKPiAtCj4gLQl4Zjg2RHJ2TXNnKHBTY3Ju
LT5zY3JuSW5kZXgsIFhfSU5GTywKPiAtCQkgICAiVXNpbmcgJWkgc2NhbmxpbmVzIG9mIG9mZnNj
cmVlbiBtZW1vcnkgXG4iCj4gLQkJICAgLCBsaW5lcyAtIHBTY3JuLT52aXJ0dWFsWSk7Cj4gKwo+
ICsgICAgICAgIEJveFJlYyBBdmFpbEZCQXJlYTsKPiArICAgICAgICBpbnQgbGluZXMgPSBwU2Ny
bi0+dmlkZW9SYW0gKiAxMDI0IC8gKHBTY3JuLT5kaXNwbGF5V2lkdGggKgo+IChwU2Nybi0+Yml0
c1BlclBpeGVsID4+IDMpKTsKPiArICAgICAgICBBdmFpbEZCQXJlYS54MSA9IDA7Cj4gKyAgICAg
ICAgQXZhaWxGQkFyZWEueTEgPSAwOwo+ICsgICAgICAgIEF2YWlsRkJBcmVhLngyID0gcFNjcm4t
PmRpc3BsYXlXaWR0aDsKPiArICAgICAgICBBdmFpbEZCQXJlYS55MiA9IGxpbmVzOwo+ICsgICAg
ICAgIHhmODZJbml0RkJNYW5hZ2VyKHBTY3JlZW4sICZBdmFpbEZCQXJlYSk7Cj4gKwo+ICsgICAg
ICAgIHhmODZEcnZNc2cocFNjcm4tPnNjcm5JbmRleCwgWF9JTkZPLAo+ICsgICAgICAgICAgICAg
ICAgICAgIlVzaW5nICVpIHNjYW5saW5lcyBvZiBvZmZzY3JlZW4gbWVtb3J5IFxuIiwgbGluZXMg
LQo+IHBTY3JuLT52aXJ0dWFsWSk7Cj4gICAgICB9Cj4gIAo+ICAgICAgeGY4NlNldEJhY2tpbmdT
dG9yZShwU2NyZWVuKTsKPiAgICAgIHhmODZTZXRTaWxrZW5Nb3VzZShwU2NyZWVuKTsKPiAtCj4g
Kwo+ICAgICAgLyogSW5pdGlhbGlzZSBjdXJzb3IgZnVuY3Rpb25zICovCj4gLSAgICBtaURDSW5p
dGlhbGl6ZSAocFNjcmVlbiwgeGY4NkdldFBvaW50ZXJTY3JlZW5GdW5jcygpKTsKPiArICAgIG1p
RENJbml0aWFsaXplKHBTY3JlZW4sIHhmODZHZXRQb2ludGVyU2NyZWVuRnVuY3MoKSk7Cj4gIAo+
ICAKPiAgICAgIGlmICghZFB0ci0+c3dDdXJzb3IpIHsKPiAtICAgICAgLyogSFcgY3Vyc29yIGZ1
bmN0aW9ucyAqLwo+IC0gICAgICBpZiAoIURVTU1ZQ3Vyc29ySW5pdChwU2NyZWVuKSkgewo+IC0J
ICB4Zjg2RHJ2TXNnKHBTY3JuLT5zY3JuSW5kZXgsIFhfRVJST1IsCj4gLQkJICAgICAiSGFyZHdh
cmUgY3Vyc29yIGluaXRpYWxpemF0aW9uIGZhaWxlZFxuIik7Cj4gLQkgIHJldHVybiBGQUxTRTsK
PiAtICAgICAgfQo+ICsgICAgICAgIC8qIEhXIGN1cnNvciBmdW5jdGlvbnMgKi8KPiArICAgICAg
ICBpZiAoIURVTU1ZQ3Vyc29ySW5pdChwU2NyZWVuKSkgewo+ICsgICAgICAgICAgICB4Zjg2RHJ2
TXNnKHBTY3JuLT5zY3JuSW5kZXgsIFhfRVJST1IsICJIYXJkd2FyZSBjdXJzb3IKPiBpbml0aWFs
aXphdGlvbiBmYWlsZWRcbiIpOwo+ICsgICAgICAgICAgICByZXR1cm4gRkFMU0U7Cj4gKyAgICAg
ICAgfQo+ICAgICAgfQo+IC0KPiArCj4gICAgICAvKiBJbml0aWFsaXNlIGRlZmF1bHQgY29sb3Vy
bWFwICovCj4gLSAgICBpZighbWlDcmVhdGVEZWZDb2xvcm1hcChwU2NyZWVuKSkKPiAtCXJldHVy
biBGQUxTRTsKPiArICAgIGlmICghbWlDcmVhdGVEZWZDb2xvcm1hcChwU2NyZWVuKSkKPiArICAg
ICAgICByZXR1cm4gRkFMU0U7Cj4gIAo+ICAgICAgaWYgKCF4Zjg2SGFuZGxlQ29sb3JtYXBzKHBT
Y3JlZW4sIDEwMjQsIHBTY3JuLT5yZ2JCaXRzLAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAg
RFVNTVlMb2FkUGFsZXR0ZSwgTlVMTCwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgIENNQVBf
UEFMRVRURURfVFJVRUNPTE9SCj4gLQkJCSAgICAgfCBDTUFQX1JFTE9BRF9PTl9NT0RFX1NXSVRD
SCkpCj4gLQlyZXR1cm4gRkFMU0U7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRFVN
TVlMb2FkUGFsZXR0ZSwgTlVMTCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDTUFQ
X1BBTEVUVEVEX1RSVUVDT0xPUiB8Cj4gQ01BUF9SRUxPQURfT05fTU9ERV9TV0lUQ0gpKQo+ICsg
ICAgICAgIHJldHVybiBGQUxTRTsKPiAgCj4gICAgICBwU2NyZWVuLT5TYXZlU2NyZWVuID0gRFVN
TVlTYXZlU2NyZWVuOwo+ICAKPiAtCj4gKwo+ICAgICAgLyogV3JhcCB0aGUgY3VycmVudCBDbG9z
ZVNjcmVlbiBmdW5jdGlvbiAqLwo+ICAgICAgZFB0ci0+Q2xvc2VTY3JlZW4gPSBwU2NyZWVuLT5D
bG9zZVNjcmVlbjsKPiAgICAgIHBTY3JlZW4tPkNsb3NlU2NyZWVuID0gRFVNTVlDbG9zZVNjcmVl
bjsKPiBAQCAtNjIzLDI4ICs1OTcsMjUgQEAgRFVNTVlTY3JlZW5Jbml0KFNDUkVFTl9JTklUX0FS
R1NfREVDTCkKPiAgCj4gICAgICAvKiBSZXBvcnQgYW55IHVudXNlZCBvcHRpb25zIChvbmx5IGZv
ciB0aGUgZmlyc3QgZ2VuZXJhdGlvbikgKi8KPiAgICAgIGlmIChzZXJ2ZXJHZW5lcmF0aW9uID09
IDEpIHsKPiAtCXhmODZTaG93VW51c2VkT3B0aW9ucyhwU2Nybi0+c2NybkluZGV4LCBwU2Nybi0+
b3B0aW9ucyk7Cj4gKyAgICAgICAgeGY4NlNob3dVbnVzZWRPcHRpb25zKHBTY3JuLT5zY3JuSW5k
ZXgsIHBTY3JuLT5vcHRpb25zKTsKPiAgICAgIH0KPiAgCj4gICAgICByZXR1cm4gVFJVRTsKPiAg
fQo+ICAKPiAgLyogTWFuZGF0b3J5ICovCj4gLUJvb2wKPiAtRFVNTVlTd2l0Y2hNb2RlKFNXSVRD
SF9NT0RFX0FSR1NfREVDTCkKPiArQm9vbCBEVU1NWVN3aXRjaE1vZGUoU1dJVENIX01PREVfQVJH
U19ERUNMKQo+ICB7Cj4gICAgICByZXR1cm4gVFJVRTsKPiAgfQo+ICAKPiAgLyogTWFuZGF0b3J5
ICovCj4gLXZvaWQKPiAtRFVNTVlBZGp1c3RGcmFtZShBREpVU1RfRlJBTUVfQVJHU19ERUNMKQo+
ICt2b2lkIERVTU1ZQWRqdXN0RnJhbWUoQURKVVNUX0ZSQU1FX0FSR1NfREVDTCkKPiAgewo+ICB9
Cj4gIAo+ICAvKiBNYW5kYXRvcnkgKi8KPiAtc3RhdGljIEJvb2wKPiAtRFVNTVlDbG9zZVNjcmVl
bihDTE9TRV9TQ1JFRU5fQVJHU19ERUNMKQo+ICtzdGF0aWMgQm9vbCBEVU1NWUNsb3NlU2NyZWVu
KENMT1NFX1NDUkVFTl9BUkdTX0RFQ0wpCj4gIHsKPiAgICAgIFNjcm5JbmZvUHRyIHBTY3JuID0g
eGY4NlNjcmVlblRvU2NybihwU2NyZWVuKTsKPiAgICAgIERVTU1ZUHRyIGRQdHIgPSBEVU1NWVBU
UihwU2Nybik7Cj4gQEAgLTY1MiwzOSArNjIzLDM1IEBAIERVTU1ZQ2xvc2VTY3JlZW4oQ0xPU0Vf
U0NSRUVOX0FSR1NfREVDTCkKPiAgICAgIGZyZWUocFNjcmVlbi0+R2V0U2NyZWVuUGl4bWFwKHBT
Y3JlZW4pLT5kZXZQcml2YXRlLnB0cik7Cj4gIAo+ICAgICAgaWYgKGRQdHItPkN1cnNvckluZm8p
Cj4gLQl4Zjg2RGVzdHJveUN1cnNvckluZm9SZWMoZFB0ci0+Q3Vyc29ySW5mbyk7Cj4gKyAgICAg
ICAgeGY4NkRlc3Ryb3lDdXJzb3JJbmZvUmVjKGRQdHItPkN1cnNvckluZm8pOwo+ICAKPiAgICAg
IHBTY3JuLT52dFNlbWEgPSBGQUxTRTsKPiAgICAgIHBTY3JlZW4tPkNsb3NlU2NyZWVuID0gZFB0
ci0+Q2xvc2VTY3JlZW47Cj4gLSAgICByZXR1cm4gKCpwU2NyZWVuLT5DbG9zZVNjcmVlbikoQ0xP
U0VfU0NSRUVOX0FSR1MpOwo+ICsgICAgcmV0dXJuICgqcFNjcmVlbi0+Q2xvc2VTY3JlZW4pIChD
TE9TRV9TQ1JFRU5fQVJHUyk7Cj4gIH0KPiAgCj4gIC8qIE9wdGlvbmFsICovCj4gLXN0YXRpYyB2
b2lkCj4gLURVTU1ZRnJlZVNjcmVlbihGUkVFX1NDUkVFTl9BUkdTX0RFQ0wpCj4gK3N0YXRpYyB2
b2lkIERVTU1ZRnJlZVNjcmVlbihGUkVFX1NDUkVFTl9BUkdTX0RFQ0wpCj4gIHsKPiAgICAgIFND
Uk5fSU5GT19QVFIoYXJnKTsKPiAgICAgIERVTU1ZRnJlZVJlYyhwU2Nybik7Cj4gIH0KPiAgCj4g
LXN0YXRpYyBCb29sCj4gLURVTU1ZU2F2ZVNjcmVlbihTY3JlZW5QdHIgcFNjcmVlbiwgaW50IG1v
ZGUpCj4gK3N0YXRpYyBCb29sIERVTU1ZU2F2ZVNjcmVlbihTY3JlZW5QdHIgcFNjcmVlbiwgaW50
IG1vZGUpCj4gIHsKPiAgICAgIHJldHVybiBUUlVFOwo+ICB9Cj4gIAo+ICAvKiBPcHRpb25hbCAq
Lwo+IC1zdGF0aWMgTW9kZVN0YXR1cwo+IC1EVU1NWVZhbGlkTW9kZShTQ1JOX0FSR19UWVBFIGFy
ZywgRGlzcGxheU1vZGVQdHIgbW9kZSwgQm9vbCB2ZXJib3NlLCBpbnQKPiBmbGFncykKPiArc3Rh
dGljIE1vZGVTdGF0dXMgRFVNTVlWYWxpZE1vZGUoU0NSTl9BUkdfVFlQRSBhcmcsIERpc3BsYXlN
b2RlUHRyIG1vZGUsCj4gQm9vbCB2ZXJib3NlLCBpbnQgZmxhZ3MpCj4gIHsKPiAtICAgIHJldHVy
bihNT0RFX09LKTsKPiArICAgIHJldHVybiAoTU9ERV9PSyk7Cj4gIH0KPiAgCj4gLUF0b20gVkZC
X1BST1AgID0gMDsKPiArQXRvbSBWRkJfUFJPUCA9IDA7Cj4gICNkZWZpbmUgIFZGQl9QUk9QX05B
TUUgICJWRkJfSURFTlQiCj4gIAo+IC1zdGF0aWMgQm9vbAo+IC1EVU1NWUNyZWF0ZVdpbmRvdyhX
aW5kb3dQdHIgcFdpbikKPiArc3RhdGljIEJvb2wgRFVNTVlDcmVhdGVXaW5kb3coV2luZG93UHRy
IHBXaW4pCj4gIHsKPiAgICAgIFNjcmVlblB0ciBwU2NyZWVuID0gcFdpbi0+ZHJhd2FibGUucFNj
cmVlbjsKPiAgICAgIERVTU1ZUHRyIGRQdHIgPSBEVU1NWVBUUihEVU1NWVNjcm4pOwo+IEBAIC02
OTYsMjYgKzY2MywyNiBAQCBEVU1NWUNyZWF0ZVdpbmRvdyhXaW5kb3dQdHIgcFdpbikKPiAgICAg
IGRQdHItPkNyZWF0ZVdpbmRvdyA9IHBTY3JlZW4tPkNyZWF0ZVdpbmRvdzsKPiAgICAgIHBTY3Jl
ZW4tPkNyZWF0ZVdpbmRvdyA9IERVTU1ZQ3JlYXRlV2luZG93Owo+ICAKPiAtICAgIGlmKHJldCAh
PSBUUlVFKQo+IC0JcmV0dXJuKHJldCk7Cj4gLQo+IC0gICAgaWYoZFB0ci0+cHJvcCA9PSBGQUxT
RSkgewo+ICsgICAgaWYgKHJldCAhPSBUUlVFKQo+ICsgICAgICAgIHJldHVybiAocmV0KTsKPiAr
Cj4gKyAgICBpZiAoZFB0ci0+cHJvcCA9PSBGQUxTRSkgewo+ICAjaWYgR0VUX0FCSV9NQUpPUihB
QklfVklERU9EUlZfVkVSU0lPTikgPCA4Cj4gICAgICAgICAgcFdpblJvb3QgPSBXaW5kb3dUYWJs
ZVtEVU1NWVNjcm4tPnBTY3JlZW4tPm15TnVtXTsKPiAgI2Vsc2UKPiAgICAgICAgICBwV2luUm9v
dCA9IERVTU1ZU2Nybi0+cFNjcmVlbi0+cm9vdDsKPiAgI2VuZGlmCj4gLSAgICAgICAgaWYgKCEg
VmFsaWRBdG9tKFZGQl9QUk9QKSkKPiArICAgICAgICBpZiAoIVZhbGlkQXRvbShWRkJfUFJPUCkp
Cj4gICAgICAgICAgICAgIFZGQl9QUk9QID0gTWFrZUF0b20oVkZCX1BST1BfTkFNRSwgc3RybGVu
KFZGQl9QUk9QX05BTUUpLCAxKTsKPiAgCj4gICAgICAgICAgcmV0ID0gZGl4Q2hhbmdlV2luZG93
UHJvcGVydHkoc2VydmVyQ2xpZW50LCBwV2luUm9vdCwgVkZCX1BST1AsCj4gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgWEFfU1RSSU5HLCA4LCBQcm9wTW9kZVJlcGxhY2Us
Cj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGludCk0LCAocG9pbnRl
cikiVFJVRSIsIEZBTFNFKTsKPiAtCWlmKCByZXQgIT0gU3VjY2VzcykKPiAtCQlFcnJvckYoIkNv
dWxkIG5vdCBzZXQgVkZCIHJvb3Qgd2luZG93IHByb3BlcnR5Iik7Cj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgKGludCkgNCwgKHBvaW50ZXIpICJUUlVFIiwgRkFMU0Up
Owo+ICsgICAgICAgIGlmIChyZXQgIT0gU3VjY2VzcykKPiArICAgICAgICAgICAgRXJyb3JGKCJD
b3VsZCBub3Qgc2V0IFZGQiByb290IHdpbmRvdyBwcm9wZXJ0eSIpOwo+ICAgICAgICAgIGRQdHIt
PnByb3AgPSBUUlVFOwo+ICAKPiAtCXJldHVybiBUUlVFOwo+ICsgICAgICAgIHJldHVybiBUUlVF
Owo+ICAgICAgfQo+ICAgICAgcmV0dXJuIFRSVUU7Cj4gIH0KPiBAQCAtNzI0LDE3ICs2OTEsMTYg
QEAgRFVNTVlDcmVhdGVXaW5kb3coV2luZG93UHRyIHBXaW4pCj4gICNkZWZpbmUgSFdfU0tJUF9D
T05TT0xFIDQKPiAgI2VuZGlmCj4gIAo+IC1zdGF0aWMgQm9vbAo+IC1kdW1teURyaXZlckZ1bmMo
U2NybkluZm9QdHIgcFNjcm4sIHhvcmdEcml2ZXJGdW5jT3Agb3AsIHBvaW50ZXIgcHRyKQo+ICtz
dGF0aWMgQm9vbCBkdW1teURyaXZlckZ1bmMoU2NybkluZm9QdHIgcFNjcm4sIHhvcmdEcml2ZXJG
dW5jT3Agb3AsIHBvaW50ZXIKPiBwdHIpCj4gIHsKPiAgICAgIENBUkQzMiAqZmxhZzsKPiAtCj4g
Kwo+ICAgICAgc3dpdGNoIChvcCkgewo+IC0JY2FzZSBHRVRfUkVRVUlSRURfSFdfSU5URVJGQUNF
UzoKPiAtCSAgICBmbGFnID0gKENBUkQzMiopcHRyOwo+IC0JICAgICgqZmxhZykgPSBIV19TS0lQ
X0NPTlNPTEU7Cj4gLQkgICAgcmV0dXJuIFRSVUU7Cj4gLQlkZWZhdWx0Ogo+IC0JICAgIHJldHVy
biBGQUxTRTsKPiArICAgICAgICBjYXNlIEdFVF9SRVFVSVJFRF9IV19JTlRFUkZBQ0VTOgo+ICsg
ICAgICAgICAgICBmbGFnID0gKENBUkQzMiAqKSBwdHI7Cj4gKyAgICAgICAgICAgICgqZmxhZykg
PSBIV19TS0lQX0NPTlNPTEU7Cj4gKyAgICAgICAgICAgIHJldHVybiBUUlVFOwo+ICsgICAgICAg
IGRlZmF1bHQ6Cj4gKyAgICAgICAgICAgIHJldHVybiBGQUxTRTsKPiAgICAgIH0KPiAgfQoKRnJl
ZGlhbm8KX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KU3Bp
Y2UtZGV2ZWwgbWFpbGluZyBsaXN0ClNwaWNlLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpo
dHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL3NwaWNlLWRldmVs
