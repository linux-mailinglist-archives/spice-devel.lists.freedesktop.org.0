Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 3509348A1E
	for <lists+spice-devel@lfdr.de>; Mon, 17 Jun 2019 19:31:57 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 48C6F89268;
	Mon, 17 Jun 2019 17:31:54 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mail.codeweavers.com (mail.codeweavers.com [50.203.203.244])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 2CBB089268
 for <spice-devel@lists.freedesktop.org>; Mon, 17 Jun 2019 17:31:53 +0000 (UTC)
Received: from 82-64-54-218.subs.proxad.net ([82.64.54.218] helo=amboise)
 by mail.codeweavers.com with esmtpsa (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.89) (envelope-from <fgouget@free.fr>) id 1hcvUY-00076y-Ii
 for spice-devel@lists.freedesktop.org; Mon, 17 Jun 2019 12:32:27 -0500
Received: from fgouget by amboise with local (Exim 4.92)
 (envelope-from <fgouget@amboise.dolphin>) id 1hcvTy-000844-Cq
 for spice-devel@lists.freedesktop.org; Mon, 17 Jun 2019 19:31:50 +0200
Date: Mon, 17 Jun 2019 19:31:50 +0200 (CEST)
From: Francois Gouget <fgouget@codeweavers.com>
To: Spice devel <spice-devel@lists.freedesktop.org>
In-Reply-To: <cover.1560790607.git.fgouget@free.fr>
Message-ID: <ead1a35d2f1faaf2508005b74998ec3614b4c90e.1560790607.git.fgouget@free.fr>
References: <cover.1560790607.git.fgouget@free.fr>
User-Agent: Alpine 2.21 (DEB 202 2017-01-01)
MIME-Version: 1.0
X-Spam-Score: -103.7
X-Spam-Report: Spam detection software,
 running on the system "mail.codeweavers.com", 
 has NOT identified this incoming email as spam.  The original
 message has been attached to this so you can view it or label
 similar future email.  If you have any questions, see
 the administrator of that system for details.
 Content preview: By the time schedule_frame() pulls a sample off GStreamer's
 pipeline the frame may have been decoded for hundreds of milliseconds, making
 the decoding time all but meaningless. This patch ensures the [...] 
 Content analysis details:   (-103.7 points, 5.0 required)
 pts rule name              description
 ---- ---------------------- --------------------------------------------------
 -100 USER_IN_WHITELIST      From: address is in the user's white-list
 -6.0 ALL_TRUSTED            Passed through trusted hosts only via SMTP
 0.0 TVD_RCVD_IP            Message was received from an IP address
 1.0 FREEMAIL_FROM          Sender email is commonly abused enduser mail
 provider (fgouget[at]free.fr)
 1.0 HEADER_FROM_DIFFERENT_DOMAINS From and EnvelopeFrom 2nd level
 mail domains are different
 0.2 FREEMAIL_FORGED_FROMDOMAIN 2nd level domains in From and
 EnvelopeFrom freemail headers are different
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt;
 c=relaxed/relaxed; 
 d=codeweavers.com; s=6377696661; h=Content-Type:MIME-Version:References:
 Message-ID:In-Reply-To:Subject:To:From:Date:Sender:Reply-To:Cc:
 Content-Transfer-Encoding:Content-ID:Content-Description:Resent-Date:
 Resent-From:Resent-Sender:Resent-To:Resent-Cc:Resent-Message-ID:List-Id:
 List-Help:List-Unsubscribe:List-Subscribe:List-Post:List-Owner:List-Archive;
 bh=6hfjnlfRKrqA3XP0CQxebKJ99xWCQd2Zo+jTJUkO4zc=; b=Afi6S0bvQ0lksBXlg1MEkdpYk
 /cyEMsN77R93Y0iMWWP+GSoAfHvodV1okWRAcfyPf2tjCTg3TvwJFPrQWQq806warghZcZsXSqrHL
 aifQfnTK/TUOpYN/9S9950pFncNdpXaGhfVSnhsSEuL0FLG2Q7oIP2Z3N1VZfAyY2MSDk=;
Subject: [Spice-devel] [client v2 03/12] gstreamer: Improve the statistics
 collection
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

QnkgdGhlIHRpbWUgc2NoZWR1bGVfZnJhbWUoKSBwdWxscyBhIHNhbXBsZSBvZmYgR1N0cmVhbWVy
J3MgcGlwZWxpbmUgdGhlCmZyYW1lIG1heSBoYXZlIGJlZW4gZGVjb2RlZCBmb3IgaHVuZHJlZHMg
b2YgbWlsbGlzZWNvbmRzLCBtYWtpbmcgdGhlCmRlY29kaW5nIHRpbWUgYWxsIGJ1dCBtZWFuaW5n
bGVzcy4KVGhpcyBwYXRjaCBlbnN1cmVzIHRoZSBzdGF0aXN0aWNzIGFyZSBhbHdheXMgY29sbGVj
dGVkIGJ5CnNpbmtfZXZlbnRfcHJvYmUoKSB3aGljaCBpcyBjYWxsZWQgYXMgc29vbiBhcyB0aGUg
ZGVjb2RlZCBmcmFtZSBpcwphdmFpbGFibGUuCk5vdGUgdGhhdCBldmVuIHNvIHRoZSBkZWNvZGlu
ZyB0aW1lIG1heSBiZSBvdmVyZXN0aW1hdGVkIGFzIHRoZSBmcmFtZQptYXkgaGF2ZSBiZWVuIHdh
aXRpbmcgZm9yIGEgd2hpbGUgaW4gZW5jb2RlZCBmb3JtIGZvciBhIHNwb3QgdG8gYmUgZnJlZWQK
aW4gdGhlIEdTdHJlYW1lciBwaXBlbGluZSdzIHNpbmsgcXVldWUuCgpTaWduZWQtb2ZmLWJ5OiBG
cmFuY29pcyBHb3VnZXQgPGZnb3VnZXRAY29kZXdlYXZlcnMuY29tPgotLS0KCnYyOiBObyBjaGFu
Z2UuCgogc3JjL2NoYW5uZWwtZGlzcGxheS1nc3QuYyB8IDEwNSArKysrKysrKysrKysrKysrKysr
KystLS0tLS0tLS0tLS0tLS0tLQogMSBmaWxlIGNoYW5nZWQsIDU5IGluc2VydGlvbnMoKyksIDQ2
IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL3NyYy9jaGFubmVsLWRpc3BsYXktZ3N0LmMgYi9z
cmMvY2hhbm5lbC1kaXNwbGF5LWdzdC5jCmluZGV4IDkzMDY0NjI1Li5jMmIyNGVhNyAxMDA2NDQK
LS0tIGEvc3JjL2NoYW5uZWwtZGlzcGxheS1nc3QuYworKysgYi9zcmMvY2hhbm5lbC1kaXNwbGF5
LWdzdC5jCkBAIC0xLDYgKzEsNiBAQAogLyogLSotIE1vZGU6IEM7IGMtYmFzaWMtb2Zmc2V0OiA0
OyBpbmRlbnQtdGFicy1tb2RlOiBuaWwgLSotICovCiAvKgotICAgQ29weXJpZ2h0IChDKSAyMDE1
LTIwMTYgQ29kZVdlYXZlcnMsIEluYworICAgQ29weXJpZ2h0IChDKSAyMDE1LTIwMTYsIDIwMTkg
Q29kZVdlYXZlcnMsIEluYwogCiAgICBUaGlzIGxpYnJhcnkgaXMgZnJlZSBzb2Z0d2FyZTsgeW91
IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yCiAgICBtb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1z
IG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCkBAIC0xODUsMTMgKzE4NSwxNiBAQCBz
dGF0aWMgZ2Jvb2xlYW4gZGlzcGxheV9mcmFtZShncG9pbnRlciB2aWRlb19kZWNvZGVyKQogICAg
IHJldHVybiBHX1NPVVJDRV9SRU1PVkU7CiB9CiAKLS8qIEdldCB0aGUgZGVjb2RlZCBmcmFtZSBy
ZWxhdGl2ZSB0byBidWZmZXIgb3IgTlVMTCBpZiBub3QgZm91bmQuCi0gKiBEZXF1ZXVlIHRoZSBm
cmFtZSBmcm9tIGRlY29kaW5nX3F1ZXVlIGFuZCByZXR1cm4gaXQsIGNhbGxlcgotICogaXMgcmVz
cG9uc2libGUgdG8gZnJlZSB0aGUgcG9pbnRlci4KKy8qIFJldHVybnMgdGhlIGRlY29kaW5nIHF1
ZXVlIGVudHJ5IHRoYXQgbWF0Y2hlcyB0aGUgc3BlY2lmaWVkIEdTdHJlYW1lciBidWZmZXIuCisg
KgorICogVGhlIGVudHJ5IGlzIGlkZW50aWZpZWQgYmFzZWQgb24gdGhlIGJ1ZmZlciB0aW1lc3Rh
bXAuIEhvd2V2ZXIgc29tZXRpbWVzCisgKiBHU3RyZWFtZXIgcmV0dXJucyB0aGUgc2FtZSBidWZm
ZXIgdHdpY2UgKGFuZCB0aGUgc2Vjb25kIHRpbWUgdGhlIGVudHJ5IG1heQorICogaGF2ZSBiZWVu
IHJlbW92ZWQgYWxyZWFkeSkgb3IgYnVmZmVycyB0aGF0IGhhdmUgYSBtb2RpZmllZCwgYW5kIHRo
dXMKKyAqIHVucmVjb2duaXphYmxlLCB0aW1lc3RhbXAuIEluIHN1Y2ggY2FzZXMgTlVMTCBpcyBy
ZXR1cm5lZC4KICAqCiAgKiBxdWV1ZXNfbXV0ZXggbXVzdCBiZSBoZWxkLgogICovCi1zdGF0aWMg
U3BpY2VHc3RGcmFtZSAqZ2V0X2RlY29kZWRfZnJhbWUoU3BpY2VHc3REZWNvZGVyICpkZWNvZGVy
LCBHc3RCdWZmZXIgKmJ1ZmZlcikKK3N0YXRpYyBHTGlzdCAqZmluZF9mcmFtZV9lbnRyeShTcGlj
ZUdzdERlY29kZXIgKmRlY29kZXIsIEdzdEJ1ZmZlciAqYnVmZmVyKQogewogICAgIEdzdENsb2Nr
VGltZSBidWZmZXJfdHMgPSBHU1RfQlVGRkVSX1BUUyhidWZmZXIpOwogI2lmIEdTVF9DSEVDS19W
RVJTSU9OKDEsMTQsMCkKQEAgLTIwMyw0OSArMjA2LDM0IEBAIHN0YXRpYyBTcGljZUdzdEZyYW1l
ICpnZXRfZGVjb2RlZF9mcmFtZShTcGljZUdzdERlY29kZXIgKmRlY29kZXIsIEdzdEJ1ZmZlciAq
YnVmCiAgICAgfQogI2VuZGlmCiAKLSAgICAvKiBHc3RyZWFtZXIgc29tZXRpbWVzIHJldHVybnMg
dGhlIHNhbWUgYnVmZmVyIHR3aWNlCi0gICAgICogb3IgYnVmZmVycyB0aGF0IGhhdmUgYSBtb2Rp
ZmllZCwgYW5kIHRodXMgdW5yZWNvZ25pemFibGUsIFBUUy4KLSAgICAgKiBCbGluZGx5IHJlbW92
aW5nIGZyYW1lcyBmcm9tIHRoZSBkZWNvZGluZ19xdWV1ZSB1bnRpbCB3ZSBmaW5kIGEKLSAgICAg
KiBtYXRjaCB3b3VsZCBvbmx5IGVtcHR5IHRoZSBxdWV1ZSwgcmVzdWx0aW5nIGluIGxhdGVyIGJ1
ZmZlcnMgbm90Ci0gICAgICogZmluZGluZyBhIG1hdGNoIGVpdGhlciwgZXRjLiBTbyBjaGVjayB0
aGUgYnVmZmVyIGhhcyBhIG1hdGNoaW5nCi0gICAgICogZnJhbWUgZmlyc3QuCi0gICAgICovCi0g
ICAgU3BpY2VHc3RGcmFtZSAqZ3N0ZnJhbWUgPSBOVUxMOwogICAgIEdMaXN0ICpsID0gZ19xdWV1
ZV9wZWVrX2hlYWRfbGluayhkZWNvZGVyLT5kZWNvZGluZ19xdWV1ZSk7CiAgICAgd2hpbGUgKGwp
IHsKLSAgICAgICAgZ3N0ZnJhbWUgPSBsLT5kYXRhOworICAgICAgICBjb25zdCBTcGljZUdzdEZy
YW1lICpnc3RmcmFtZSA9IGwtPmRhdGE7CiAgICAgICAgIGlmIChnc3RmcmFtZS0+dGltZXN0YW1w
ID09IGJ1ZmZlcl90cykgewotICAgICAgICAgICAgYnJlYWs7CisgICAgICAgICAgICByZXR1cm4g
bDsKICAgICAgICAgfQotICAgICAgICBnc3RmcmFtZSA9IE5VTEw7CiAgICAgICAgIGwgPSBsLT5u
ZXh0OwogICAgIH0KIAotICAgIGlmIChnc3RmcmFtZSAhPSBOVUxMKSB7Ci0gICAgICAgIC8qIE5v
dyB0aGF0IHdlIGtub3cgdGhlcmUgaXMgYSBtYXRjaCwgcmVtb3ZlIGl0IGFuZCB0aGUgb2xkZXIK
LSAgICAgICAgICogZnJhbWVzIGZyb20gdGhlIGRlY29kaW5nIHF1ZXVlICovCi0gICAgICAgIFNw
aWNlR3N0RnJhbWUgKmxhdGVfZnJhbWU7Ci0gICAgICAgIGd1aW50IG51bV9mcmFtZXNfZHJvcHBl
ZCA9IDA7Ci0KLSAgICAgICAgLyogVGhlIEdTdHJlYW1lciBwaXBlbGluZSBkcm9wcGVkIHRoZSBj
b3JyZXNwb25kaW5nIGJ1ZmZlci4gKi8KLSAgICAgICAgd2hpbGUgKChsYXRlX2ZyYW1lID0gZ19x
dWV1ZV9wb3BfaGVhZChkZWNvZGVyLT5kZWNvZGluZ19xdWV1ZSkpICE9IGdzdGZyYW1lKSB7Ci0g
ICAgICAgICAgICBudW1fZnJhbWVzX2Ryb3BwZWQrKzsKLSAgICAgICAgICAgIGZyZWVfZ3N0X2Zy
YW1lKGxhdGVfZnJhbWUpOwotICAgICAgICB9CisgICAgcmV0dXJuIE5VTEw7Cit9CiAKLSAgICAg
ICAgaWYgKG51bV9mcmFtZXNfZHJvcHBlZCAhPSAwKSB7Ci0gICAgICAgICAgICBTUElDRV9ERUJV
RygidGhlIEdTdHJlYW1lciBwaXBlbGluZSBkcm9wcGVkICV1IGZyYW1lcyIsIG51bV9mcmFtZXNf
ZHJvcHBlZCk7Ci0gICAgICAgIH0KKy8qIFBvcHMgdGhlIHF1ZXVlZCBmcmFtZXMgdXAgdG8gYW5k
IGluY2x1ZGluZyB0aGUgc3BlY2lmaWVkIGZyYW1lLgorICogQWxsIGZyYW1lcyBhcmUgZnJlZWQg
ZXhjZXB0IHRoYXQgbGFzdCBmcmFtZSB3aGljaCBiZWxvbmdzIHRvIHRoZSBjYWxsZXIuCisgKiBS
ZXR1cm5zIHRoZSBudW1iZXIgb2YgZnJlZWQgZnJhbWVzLgorICoKKyAqIHF1ZXVlc19tdXRleCBt
dXN0IGJlIGhlbGQuCisgKi8KK3N0YXRpYyBndWludDMyIHBvcF91cF90b19mcmFtZShTcGljZUdz
dERlY29kZXIgKmRlY29kZXIsIGNvbnN0IFNwaWNlR3N0RnJhbWUgKnBvcGZyYW1lKQoreworICAg
IFNwaWNlR3N0RnJhbWUgKmdzdGZyYW1lOworICAgIGd1aW50MzIgZnJlZWQgPSAwOwogCi0gICAg
ICAgIGNvbnN0IFNwaWNlRnJhbWUgKmZyYW1lID0gZ3N0ZnJhbWUtPmVuY29kZWRfZnJhbWU7Ci0g
ICAgICAgIGludDY0X3QgZHVyYXRpb24gPSBnX2dldF9tb25vdG9uaWNfdGltZSgpIC0gZnJhbWUt
PmNyZWF0aW9uX3RpbWU7Ci0gICAgICAgIHJlY29yZChmcmFtZXNfc3RhdHMsCi0gICAgICAgICAg
ICAgICAiZnJhbWUgbW1fdGltZSAldSBzaXplICV1IGNyZWF0aW9uIHRpbWUgJSIgUFJJZDY0Ci0g
ICAgICAgICAgICAgICAiIGRlY29kZWQgdGltZSAlIiBQUklkNjQgIiBxdWV1ZSAldSIsCi0gICAg
ICAgICAgICAgICBmcmFtZS0+bW1fdGltZSwgZnJhbWUtPnNpemUsIGZyYW1lLT5jcmVhdGlvbl90
aW1lLAotICAgICAgICAgICAgICAgZHVyYXRpb24sIGRlY29kZXItPmRlY29kaW5nX3F1ZXVlLT5s
ZW5ndGgpOworICAgIHdoaWxlICgoZ3N0ZnJhbWUgPSBnX3F1ZXVlX3BvcF9oZWFkKGRlY29kZXIt
PmRlY29kaW5nX3F1ZXVlKSkgIT0gcG9wZnJhbWUpIHsKKyAgICAgICAgZnJlZV9nc3RfZnJhbWUo
Z3N0ZnJhbWUpOworICAgICAgICBmcmVlZCsrOwogICAgIH0KLSAgICByZXR1cm4gZ3N0ZnJhbWU7
CisgICAgcmV0dXJuIGZyZWVkOwogfQogCiAvKiBIZWxwZXIgZm9yIHNjaGVkdWxlX2ZyYW1lKCku
CkBAIC0yNjgsOCArMjU2LDE2IEBAIHN0YXRpYyB2b2lkIGZldGNoX3BlbmRpbmdfc2FtcGxlKFNw
aWNlR3N0RGVjb2RlciAqZGVjb2RlcikKICAgICAgICAgICogZmluZGluZyBhIG1hdGNoIGVpdGhl
ciwgZXRjLiBTbyBjaGVjayB0aGUgYnVmZmVyIGhhcyBhIG1hdGNoaW5nCiAgICAgICAgICAqIGZy
YW1lIGZpcnN0LgogICAgICAgICAgKi8KLSAgICAgICAgU3BpY2VHc3RGcmFtZSAqZ3N0ZnJhbWUg
PSBnZXRfZGVjb2RlZF9mcmFtZShkZWNvZGVyLCBidWZmZXIpOwotICAgICAgICBpZiAoZ3N0ZnJh
bWUpIHsKKyAgICAgICAgR0xpc3QgKmwgPSBmaW5kX2ZyYW1lX2VudHJ5KGRlY29kZXIsIGJ1ZmZl
cik7CisgICAgICAgIGlmIChsKSB7CisgICAgICAgICAgICBTcGljZUdzdEZyYW1lICpnc3RmcmFt
ZSA9IGwtPmRhdGE7CisKKyAgICAgICAgICAgIC8qIERlcXVldWUgdGhpcyBhbmQgYW55IGRyb3Bw
ZWQgZnJhbWVzICovCisgICAgICAgICAgICBndWludDMyIGRyb3BwZWQgPSBwb3BfdXBfdG9fZnJh
bWUoZGVjb2RlciwgZ3N0ZnJhbWUpOworICAgICAgICAgICAgaWYgKGRyb3BwZWQpIHsKKyAgICAg
ICAgICAgICAgICBTUElDRV9ERUJVRygidGhlIEdTdHJlYW1lciBwaXBlbGluZSBkcm9wcGVkICV1
IGZyYW1lcyIsIGRyb3BwZWQpOworICAgICAgICAgICAgfQorCiAgICAgICAgICAgICAvKiBUaGUg
ZnJhbWUgaXMgbm93IHJlYWR5IGZvciBkaXNwbGF5ICovCiAgICAgICAgICAgICBnc3RmcmFtZS0+
ZGVjb2RlZF9zYW1wbGUgPSBzYW1wbGU7CiAgICAgICAgICAgICBkZWNvZGVyLT5kaXNwbGF5X2Zy
YW1lID0gZ3N0ZnJhbWU7CkBAIC00MzgsMTAgKzQzNCwyOCBAQCBzaW5rX2V2ZW50X3Byb2JlKEdz
dFBhZCAqcGFkLCBHc3RQYWRQcm9iZUluZm8gKmluZm8sIGdwb2ludGVyIGRhdGEpCiAgICAgaWYg
KGluZm8tPnR5cGUgJiBHU1RfUEFEX1BST0JFX1RZUEVfQlVGRkVSKSB7IC8vIEJ1ZmZlciBhcnJp
dmVkCiAgICAgICAgIEdzdEJ1ZmZlciAqYnVmZmVyID0gR1NUX1BBRF9QUk9CRV9JTkZPX0JVRkZF
UihpbmZvKTsKICAgICAgICAgZ19tdXRleF9sb2NrKCZkZWNvZGVyLT5xdWV1ZXNfbXV0ZXgpOwot
ICAgICAgICBTcGljZUdzdEZyYW1lICpnc3RmcmFtZSA9IGdldF9kZWNvZGVkX2ZyYW1lKGRlY29k
ZXIsIGJ1ZmZlcik7Ci0gICAgICAgIGlmIChnc3RmcmFtZSkgewotICAgICAgICAgICAgZnJlZV9n
c3RfZnJhbWUoZ3N0ZnJhbWUpOworCisgICAgICAgIEdMaXN0ICpsID0gZmluZF9mcmFtZV9lbnRy
eShkZWNvZGVyLCBidWZmZXIpOworICAgICAgICBpZiAobCkgeworICAgICAgICAgICAgU3BpY2VH
c3RGcmFtZSAqZ3N0ZnJhbWUgPSBsLT5kYXRhOworICAgICAgICAgICAgY29uc3QgU3BpY2VGcmFt
ZSAqZnJhbWUgPSBnc3RmcmFtZS0+ZW5jb2RlZF9mcmFtZTsKKyAgICAgICAgICAgIGludDY0X3Qg
ZHVyYXRpb24gPSBnX2dldF9tb25vdG9uaWNfdGltZSgpIC0gZnJhbWUtPmNyZWF0aW9uX3RpbWU7
CisgICAgICAgICAgICByZWNvcmQoZnJhbWVzX3N0YXRzLAorICAgICAgICAgICAgICAgICAgICJm
cmFtZSBtbV90aW1lICV1IHNpemUgJXUgY3JlYXRpb24gdGltZSAlIiBQUklkNjQKKyAgICAgICAg
ICAgICAgICAgICAiIGRlY29kZWQgdGltZSAlIiBQUklkNjQgIiBxdWV1ZSAldSIsCisgICAgICAg
ICAgICAgICAgICAgZnJhbWUtPm1tX3RpbWUsIGZyYW1lLT5zaXplLCBmcmFtZS0+Y3JlYXRpb25f
dGltZSwgZHVyYXRpb24sCisgICAgICAgICAgICAgICAgICAgZGVjb2Rlci0+ZGVjb2RpbmdfcXVl
dWUtPmxlbmd0aCk7CisKKyAgICAgICAgICAgIGlmICghZGVjb2Rlci0+YXBwc2luaykgeworICAg
ICAgICAgICAgICAgIC8qIFRoZSBzaW5rIHdpbGwgZGlzcGxheSB0aGUgZnJhbWUgZGlyZWN0bHkg
c28gdGhpcworICAgICAgICAgICAgICAgICAqIFNwaWNlR3N0RnJhbWUgYW5kIHRob3NlIG9mIGFu
eSBkcm9wcGVkIGZyYW1lIGFyZSBubyBsb25nZXIKKyAgICAgICAgICAgICAgICAgKiBuZWVkZWQu
CisgICAgICAgICAgICAgICAgICovCisgICAgICAgICAgICAgICAgcG9wX3VwX3RvX2ZyYW1lKGRl
Y29kZXIsIGdzdGZyYW1lKTsKKyAgICAgICAgICAgICAgICBmcmVlX2dzdF9mcmFtZShnc3RmcmFt
ZSk7CisgICAgICAgICAgICB9CiAgICAgICAgIH0KKwogICAgICAgICBnX211dGV4X3VubG9jaygm
ZGVjb2Rlci0+cXVldWVzX211dGV4KTsKICAgICB9CiAgICAgcmV0dXJuIEdTVF9QQURfUFJPQkVf
T0s7CkBAIC00NTIsOSArNDY2LDggQEAgc3RhdGljIHZvaWQKIGRlZXBfZWxlbWVudF9hZGRlZF9j
YihHc3RCaW4gKnBpcGVsaW5lLCBHc3RCaW4gKmJpbiwgR3N0RWxlbWVudCAqZWxlbWVudCwKICAg
ICAgICAgICAgICAgICAgICAgICBTcGljZUdzdERlY29kZXIgKmRlY29kZXIpCiB7Ci0gICAgLyog
YXR0YWNoIGEgcHJvYmUgdG8gdGhlIHNpbmsgaW4gY2FzZSB3ZSBkb24ndCBoYXZlIGFwcHNpbmsg
KHRoYXQKLSAgICAgKiBpcyB0aGUgZnJhbWVzIGRvZXMgbm90IGdvIHRvIG5ld19zYW1wbGUgKi8K
LSAgICBpZiAoR1NUX0lTX0JBU0VfU0lOSyhlbGVtZW50KSAmJiBkZWNvZGVyLT5hcHBzaW5rID09
IE5VTEwpIHsKKyAgICAvKiBBdHRhY2ggYSBwcm9iZSB0byB0aGUgc2luayB0byB1cGRhdGUgdGhl
IHN0YXRpc3RpY3MgKi8KKyAgICBpZiAoR1NUX0lTX0JBU0VfU0lOSyhlbGVtZW50KSkgewogICAg
ICAgICBHc3RQYWQgKnBhZCA9IGdzdF9lbGVtZW50X2dldF9zdGF0aWNfcGFkKGVsZW1lbnQsICJz
aW5rIik7CiAgICAgICAgIGdzdF9wYWRfYWRkX3Byb2JlKHBhZCwgR1NUX1BBRF9QUk9CRV9UWVBF
X0JVRkZFUiwgc2lua19ldmVudF9wcm9iZSwgZGVjb2RlciwgTlVMTCk7CiAgICAgICAgIGdzdF9v
YmplY3RfdW5yZWYocGFkKTsKLS0gCjIuMjAuMQoKX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX18KU3BpY2UtZGV2ZWwgbWFpbGluZyBsaXN0ClNwaWNlLWRldmVs
QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWls
bWFuL2xpc3RpbmZvL3NwaWNlLWRldmVs
