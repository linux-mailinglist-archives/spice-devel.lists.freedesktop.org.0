Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id D8FABF30E
	for <lists+spice-devel@lfdr.de>; Tue, 30 Apr 2019 11:34:14 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 4BD468919A;
	Tue, 30 Apr 2019 09:34:13 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 050928919A
 for <spice-devel@lists.freedesktop.org>; Tue, 30 Apr 2019 09:34:12 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx08.intmail.prod.int.phx2.redhat.com
 [10.5.11.23])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id A582681107
 for <spice-devel@lists.freedesktop.org>; Tue, 30 Apr 2019 09:34:11 +0000 (UTC)
Received: from jjanku-t480s.redhat.com (unknown [10.40.205.166])
 by smtp.corp.redhat.com (Postfix) with ESMTP id A4B8219491;
 Tue, 30 Apr 2019 09:34:08 +0000 (UTC)
From: =?UTF-8?q?Jakub=20Jank=C5=AF?= <jjanku@redhat.com>
To: spice-devel@lists.freedesktop.org
Date: Tue, 30 Apr 2019 11:33:39 +0200
Message-Id: <20190430093339.14062-6-jjanku@redhat.com>
In-Reply-To: <20190430093339.14062-1-jjanku@redhat.com>
References: <20190430093339.14062-1-jjanku@redhat.com>
MIME-Version: 1.0
X-Scanned-By: MIMEDefang 2.84 on 10.5.11.23
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16
 (mx1.redhat.com [10.5.110.28]); Tue, 30 Apr 2019 09:34:11 +0000 (UTC)
Subject: [Spice-devel] [vdagent-linux v2 5/5] udscs-server: split
 initialization
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

RGl2aWRlIGNyZWF0aW9uIG9mIHVkc2NzX3NlcnZlciBpbnRvIDIgc3RlcHM6CgoxKSB1ZHNjc19z
ZXJ2ZXJfbmV3KCkKIC0gYWxsb2NhdGVzIG5ldyB1ZHNjc19zZXJ2ZXIgc3RydWN0IGFuZCBpbml0
cyBpdAoKMikgdWRzY3Nfc2VydmVyX2xpc3Rlbl90b19mZCgpLCB1ZHNjc19zZXJ2ZXJfbGlzdGVu
X3RvX2FkZHJlc3MoKQogLSBzdGFydHMgYWNjZXB0aW5nIG5ldyBjb25uZWN0aW9ucwoKUmVtb3Zl
IHVkc2NzX2NyZWF0ZV9zZXJ2ZXIoKSBhbmQgdWRzY3NfY3JlYXRlX3NlcnZlcl9mb3JfZmQoKS4K
ClRoaXMgbWFrZXMgdGhlIGNvZGUgYSBiaXQgc2hvcnRlciBhbmQgbmljZXIuCgpTaWduZWQtb2Zm
LWJ5OiBKYWt1YiBKYW5rxa8gPGpqYW5rdUByZWRoYXQuY29tPgotLS0KIHNyYy91ZHNjcy5jICAg
ICAgICAgICAgIHwgNjMgKysrKysrKysrKystLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0K
IHNyYy91ZHNjcy5oICAgICAgICAgICAgIHwgMjggKysrKysrKysrLS0tLS0tLS0tCiBzcmMvdmRh
Z2VudGQvdmRhZ2VudGQuYyB8IDI0ICsrKysrKy0tLS0tLS0tLS0KIDMgZmlsZXMgY2hhbmdlZCwg
MzggaW5zZXJ0aW9ucygrKSwgNzcgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvc3JjL3Vkc2Nz
LmMgYi9zcmMvdWRzY3MuYwppbmRleCA1Zjc2OWNhLi4xY2E2NzgyIDEwMDY0NAotLS0gYS9zcmMv
dWRzY3MuYworKysgYi9zcmMvdWRzY3MuYwpAQCAtMTcwLDcgKzE3MCw3IEBAIHN0YXRpYyBnYm9v
bGVhbiB1ZHNjc19zZXJ2ZXJfYWNjZXB0X2NiKEdTb2NrZXRTZXJ2aWNlICAgICpzZXJ2aWNlLAog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgR09iamVjdCAgICAgICAgICAg
KnNvdXJjZV9vYmplY3QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBn
cG9pbnRlciAgICAgICAgICAgdXNlcl9kYXRhKTsKIAotc3RhdGljIHN0cnVjdCB1ZHNjc19zZXJ2
ZXIgKnVkc2NzX3NlcnZlcl9uZXcoCitzdHJ1Y3QgdWRzY3Nfc2VydmVyICp1ZHNjc19zZXJ2ZXJf
bmV3KAogICAgIHVkc2NzX2Nvbm5lY3RfY2FsbGJhY2sgY29ubmVjdF9jYWxsYmFjaywKICAgICB1
ZHNjc19yZWFkX2NhbGxiYWNrIHJlYWRfY2FsbGJhY2ssCiAgICAgVkRBZ2VudENvbm5FcnJvckNi
IGVycm9yX2NiLApAQCAtMTkxLDY0ICsxOTEsMzMgQEAgc3RhdGljIHN0cnVjdCB1ZHNjc19zZXJ2
ZXIgKnVkc2NzX3NlcnZlcl9uZXcoCiAgICAgcmV0dXJuIHNlcnZlcjsKIH0KIAotc3RydWN0IHVk
c2NzX3NlcnZlciAqdWRzY3NfY3JlYXRlX3NlcnZlcl9mb3JfZmQoaW50IGZkLAotICAgIHVkc2Nz
X2Nvbm5lY3RfY2FsbGJhY2sgY29ubmVjdF9jYWxsYmFjaywKLSAgICB1ZHNjc19yZWFkX2NhbGxi
YWNrIHJlYWRfY2FsbGJhY2ssCi0gICAgVkRBZ2VudENvbm5FcnJvckNiIGVycm9yX2NiLAotICAg
IGludCBkZWJ1ZykKK3ZvaWQgdWRzY3Nfc2VydmVyX2xpc3Rlbl90b19zb2NrZXQoc3RydWN0IHVk
c2NzX3NlcnZlciAqc2VydmVyLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBn
aW50ICAgICAgICAgICAgICAgICBmZCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgR0Vycm9yICAgICAgICAgICAgICoqZXJyKQogewotICAgIHN0cnVjdCB1ZHNjc19zZXJ2ZXIg
KnNlcnZlcjsKICAgICBHU29ja2V0ICpzb2NrZXQ7Ci0gICAgR0Vycm9yICplcnIgPSBOVUxMOwog
Ci0gICAgc2VydmVyID0gdWRzY3Nfc2VydmVyX25ldyhjb25uZWN0X2NhbGxiYWNrLCByZWFkX2Nh
bGxiYWNrLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JfY2IsIGRlYnVnKTsK
LQotICAgIHNvY2tldCA9IGdfc29ja2V0X25ld19mcm9tX2ZkKGZkLCAmZXJyKTsKLSAgICBpZiAo
ZXJyKQotICAgICAgICBnb3RvIGVycm9yOworICAgIHNvY2tldCA9IGdfc29ja2V0X25ld19mcm9t
X2ZkKGZkLCBlcnIpOworICAgIGlmIChzb2NrZXQgPT0gTlVMTCkKKyAgICAgICAgcmV0dXJuOwog
ICAgIGdfc29ja2V0X2xpc3RlbmVyX2FkZF9zb2NrZXQoR19TT0NLRVRfTElTVEVORVIoc2VydmVy
LT5zZXJ2aWNlKSwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvY2tldCwgTlVM
TCwgJmVycik7CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb2NrZXQsIE5VTEws
IGVycik7CiAgICAgZ19vYmplY3RfdW5yZWYoc29ja2V0KTsKLSAgICBpZiAoZXJyKQotICAgICAg
ICBnb3RvIGVycm9yOwotCi0gICAgcmV0dXJuIHNlcnZlcjsKLWVycm9yOgotICAgIHN5c2xvZyhM
T0dfRVJSLCAiJXM6ICVzIiwgX19mdW5jX18sIGVyci0+bWVzc2FnZSk7Ci0gICAgZ19lcnJvcl9m
cmVlKGVycik7Ci0gICAgdWRzY3NfZGVzdHJveV9zZXJ2ZXIoc2VydmVyKTsKLSAgICByZXR1cm4g
TlVMTDsKIH0KIAotc3RydWN0IHVkc2NzX3NlcnZlciAqdWRzY3NfY3JlYXRlX3NlcnZlcihjb25z
dCBjaGFyICpzb2NrZXRuYW1lLAotICAgIHVkc2NzX2Nvbm5lY3RfY2FsbGJhY2sgY29ubmVjdF9j
YWxsYmFjaywKLSAgICB1ZHNjc19yZWFkX2NhbGxiYWNrIHJlYWRfY2FsbGJhY2ssCi0gICAgVkRB
Z2VudENvbm5FcnJvckNiIGVycm9yX2NiLAotICAgIGludCBkZWJ1ZykKK3ZvaWQgdWRzY3Nfc2Vy
dmVyX2xpc3Rlbl90b19hZGRyZXNzKHN0cnVjdCB1ZHNjc19zZXJ2ZXIgKnNlcnZlciwKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGdjaGFyICAgICAgICAgKmFkZHIs
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBHRXJyb3IgICAgICAgICAgICAg
KiplcnIpCiB7Ci0gICAgc3RydWN0IHVkc2NzX3NlcnZlciAqc2VydmVyOwotICAgIEdTb2NrZXRB
ZGRyZXNzICpzb2NrZXRfYWRkcjsKLSAgICBHRXJyb3IgKmVyciA9IE5VTEw7Ci0KLSAgICBzZXJ2
ZXIgPSB1ZHNjc19zZXJ2ZXJfbmV3KGNvbm5lY3RfY2FsbGJhY2ssIHJlYWRfY2FsbGJhY2ssCi0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcl9jYiwgZGVidWcpOworICAgIEdTb2Nr
ZXRBZGRyZXNzICpzb2NrX2FkZHI7CiAKLSAgICBzb2NrZXRfYWRkciA9IGdfdW5peF9zb2NrZXRf
YWRkcmVzc19uZXcoc29ja2V0bmFtZSk7CisgICAgc29ja19hZGRyID0gZ191bml4X3NvY2tldF9h
ZGRyZXNzX25ldyhhZGRyKTsKICAgICBnX3NvY2tldF9saXN0ZW5lcl9hZGRfYWRkcmVzcyhHX1NP
Q0tFVF9MSVNURU5FUihzZXJ2ZXItPnNlcnZpY2UpLAotICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHNvY2tldF9hZGRyLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHNvY2tfYWRkciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBHX1NPQ0tFVF9U
WVBFX1NUUkVBTSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBHX1NPQ0tFVF9Q
Uk9UT0NPTF9ERUZBVUxULAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5VTEws
IE5VTEwsICZlcnIpOwotICAgIGdfb2JqZWN0X3VucmVmKHNvY2tldF9hZGRyKTsKLSAgICBpZiAo
ZXJyKSB7Ci0gICAgICAgIHN5c2xvZyhMT0dfRVJSLCAiJXM6ICVzIiwgX19mdW5jX18sIGVyci0+
bWVzc2FnZSk7Ci0gICAgICAgIGdfZXJyb3JfZnJlZShlcnIpOwotICAgICAgICB1ZHNjc19kZXN0
cm95X3NlcnZlcihzZXJ2ZXIpOwotICAgICAgICByZXR1cm4gTlVMTDsKLSAgICB9Ci0KLSAgICBy
ZXR1cm4gc2VydmVyOworICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5VTEwsIE5V
TEwsIGVycik7CisgICAgZ19vYmplY3RfdW5yZWYoc29ja19hZGRyKTsKIH0KIAogdm9pZCB1ZHNj
c19zZXJ2ZXJfZGVzdHJveV9jb25uZWN0aW9uKHN0cnVjdCB1ZHNjc19zZXJ2ZXIgKnNlcnZlciwK
ZGlmZiAtLWdpdCBhL3NyYy91ZHNjcy5oIGIvc3JjL3Vkc2NzLmgKaW5kZXggYjJkNzFiNi4uOTMw
MzZiOSAxMDA2NDQKLS0tIGEvc3JjL3Vkc2NzLmgKKysrIGIvc3JjL3Vkc2NzLmgKQEAgLTc1LDMx
ICs3NSwyOSBAQCBzdHJ1Y3QgdWRzY3Nfc2VydmVyOwogICovCiB0eXBlZGVmIHZvaWQgKCp1ZHNj
c19jb25uZWN0X2NhbGxiYWNrKShVZHNjc0Nvbm5lY3Rpb24gKmNvbm4pOwogCi0vKiBDcmVhdGUg
YSBzZXJ2ZXIgZm9yIHRoZSBnaXZlbiBmaWxlIGRlc2NyaXB0b3IuIFRoaXMgYWxsb3dzIHVzIHRv
IHVzZQotICogcHJlLWNvbmZpZ3VyZWQgc29ja2V0cyBmb3IgdXNlIHdpdGggc3lzdGVtZCBzb2Nr
ZXQgYWN0aXZhdGlvbiwgZXRjLgotICoKLSAqIFNlZSB1ZHNjc19jcmVhdGVfc2VydmVyKCkgZm9y
IG1vcmUgaW5mb3JtYXRpb24KLSAqLwotc3RydWN0IHVkc2NzX3NlcnZlciAqdWRzY3NfY3JlYXRl
X3NlcnZlcl9mb3JfZmQoaW50IGZkLAotICAgIHVkc2NzX2Nvbm5lY3RfY2FsbGJhY2sgY29ubmVj
dF9jYWxsYmFjaywKLSAgICB1ZHNjc19yZWFkX2NhbGxiYWNrIHJlYWRfY2FsbGJhY2ssCi0gICAg
VkRBZ2VudENvbm5FcnJvckNiIGVycm9yX2NiLAotICAgIGludCBkZWJ1Zyk7Ci0KLS8qIENyZWF0
ZSB0aGUgdW5peCBkb21haW4gc29ja2V0IHNwZWNpZmllZCBieSBzb2NrZXRuYW1lIGFuZAotICog
c3RhcnQgbGlzdGVuaW5nIG9uIGl0LgotICogT25seSBzb2NrZXRzIGJvdW5kIHRvIGEgcGF0aG5h
bWUgYXJlIHN1cHBvcnRlZC4KKy8qIEluaXRpYWxpemUgYSBuZXcgdWRzY3Nfc2VydmVyIHN0cnVj
dC4KICAqCiAgKiBJZiBkZWJ1ZyBpcyB0cnVlIHRoZW4gdGhlIGV2ZW50cyBvbiB0aGlzIHNvY2tl
dCBhbmQgcmVsYXRlZCBpbmRpdmlkdWFsCiAgKiBjb25uZWN0aW9ucyB3aWxsIGJlIHRyYWNlZC4K
ICAqIFRoaXMgaW5jbHVkZXMgdGhlIGluY29taW5nIGFuZCBvdXRnb2luZyBtZXNzYWdlIG5hbWVz
LgogICovCi1zdHJ1Y3QgdWRzY3Nfc2VydmVyICp1ZHNjc19jcmVhdGVfc2VydmVyKGNvbnN0IGNo
YXIgKnNvY2tldG5hbWUsCitzdHJ1Y3QgdWRzY3Nfc2VydmVyICp1ZHNjc19zZXJ2ZXJfbmV3KAog
ICAgIHVkc2NzX2Nvbm5lY3RfY2FsbGJhY2sgY29ubmVjdF9jYWxsYmFjaywKICAgICB1ZHNjc19y
ZWFkX2NhbGxiYWNrIHJlYWRfY2FsbGJhY2ssCiAgICAgVkRBZ2VudENvbm5FcnJvckNiIGVycm9y
X2NiLAogICAgIGludCBkZWJ1Zyk7CiAKKy8qIFN0YXJ0IGxpc3RlbmluZyBvbiBhIHByZS1jb25m
aWd1cmVkIHNvY2tldCBzcGVjaWZpZWQgYnkgdGhlIGdpdmVuIEBmZC4KKyAqIFRoaXMgY2FuIGJl
IHVzZWQgd2l0aCBzeXN0ZW1kIHNvY2tldCBhY3RpdmF0aW9uLCBldGMuICovCit2b2lkIHVkc2Nz
X3NlcnZlcl9saXN0ZW5fdG9fc29ja2V0KHN0cnVjdCB1ZHNjc19zZXJ2ZXIgKnNlcnZlciwKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2ludCAgICAgICAgICAgICAgICAgZmQs
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdFcnJvciAgICAgICAgICAgICAq
KmVycik7CisKKy8qIENyZWF0ZSBhIG5ldyBzb2NrZXQsIGJpbmQgaXQgdG8gQGFkZHJlc3MgYW5k
IHN0YXJ0IGxpc3RlbmluZyBvbiBpdC4gKi8KK3ZvaWQgdWRzY3Nfc2VydmVyX2xpc3Rlbl90b19h
ZGRyZXNzKHN0cnVjdCB1ZHNjc19zZXJ2ZXIgKnNlcnZlciwKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGNvbnN0IGdjaGFyICAgICAgICAgKmFkZHIsCisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBHRXJyb3IgICAgICAgICAgICAgKiplcnIpOworCiB2b2lk
IHVkc2NzX3NlcnZlcl9kZXN0cm95X2Nvbm5lY3Rpb24oc3RydWN0IHVkc2NzX3NlcnZlciAqc2Vy
dmVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFVkc2NzQ29ubmVjdGlv
biAgICAgKmNvbm4pOwogCmRpZmYgLS1naXQgYS9zcmMvdmRhZ2VudGQvdmRhZ2VudGQuYyBiL3Ny
Yy92ZGFnZW50ZC92ZGFnZW50ZC5jCmluZGV4IDExZjc3ZTguLmZkMTk4OGEgMTAwNjQ0Ci0tLSBh
L3NyYy92ZGFnZW50ZC92ZGFnZW50ZC5jCisrKyBiL3NyYy92ZGFnZW50ZC92ZGFnZW50ZC5jCkBA
IC0xMTUyLDYgKzExNTIsOCBAQCBpbnQgbWFpbihpbnQgYXJnYywgY2hhciAqYXJndltdKQogICAg
IG9wZW5sb2coInNwaWNlLXZkYWdlbnRkIiwgZG9fZGFlbW9uaXplID8gMCA6IExPR19QRVJST1Is
IExPR19VU0VSKTsKIAogICAgIC8qIFNldHVwIGNvbW11bmljYXRpb24gd2l0aCB2ZGFnZW50IHBy
b2Nlc3MoZXMpICovCisgICAgc2VydmVyID0gdWRzY3Nfc2VydmVyX25ldyhhZ2VudF9jb25uZWN0
LCBhZ2VudF9yZWFkX2NvbXBsZXRlLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWdl
bnRfZGlzY29ubmVjdCwgZGVidWcpOwogI2lmZGVmIFdJVEhfU1lTVEVNRF9TT0NLRVRfQUNUSVZB
VElPTgogICAgIGludCBuX2ZkczsKICAgICAvKiB0cnkgdG8gcmV0cmlldmUgcHJlLWNvbmZpZ3Vy
ZWQgc29ja2V0cyBmcm9tIHN5c3RlbWQgKi8KQEAgLTExNjAsMjggKzExNjIsMjAgQEAgaW50IG1h
aW4oaW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSkKICAgICAgICAgc3lzbG9nKExPR19DUklULCAiUmVj
ZWl2ZWQgdG9vIG1hbnkgc29ja2V0cyBmcm9tIHN5c3RlbWQgKCVpKSIsIG5fZmRzKTsKICAgICAg
ICAgcmV0dXJuIDE7CiAgICAgfSBlbHNlIGlmIChuX2ZkcyA9PSAxKSB7Ci0gICAgICAgIHNlcnZl
ciA9IHVkc2NzX2NyZWF0ZV9zZXJ2ZXJfZm9yX2ZkKFNEX0xJU1RFTl9GRFNfU1RBUlQsIGFnZW50
X2Nvbm5lY3QsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFn
ZW50X3JlYWRfY29tcGxldGUsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGFnZW50X2Rpc2Nvbm5lY3QsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGRlYnVnKTsKKyAgICAgICAgdWRzY3Nfc2VydmVyX2xpc3Rlbl90b19zb2Nr
ZXQoc2VydmVyLCBTRF9MSVNURU5fRkRTX1NUQVJULCAmZXJyKTsKICAgICAgICAgb3duX3NvY2tl
dCA9IEZBTFNFOwogICAgIH0gZWxzZQogICAgIC8qIHN5c3RlbWQgc29ja2V0IGFjdGl2YXRpb24g
bm90IGVuYWJsZWQsIGNyZWF0ZSBvdXIgb3duICovCiAjZW5kaWYgLyogV0lUSF9TWVNURU1EX1NP
Q0tFVF9BQ1RJVkFUSU9OICovCiAgICAgewotICAgICAgICBzZXJ2ZXIgPSB1ZHNjc19jcmVhdGVf
c2VydmVyKHZkYWdlbnRkX3NvY2tldCwgYWdlbnRfY29ubmVjdCwKLSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBhZ2VudF9yZWFkX2NvbXBsZXRlLCBhZ2VudF9kaXNjb25uZWN0
LAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlYnVnKTsKKyAgICAgICAg
dWRzY3Nfc2VydmVyX2xpc3Rlbl90b19hZGRyZXNzKHNlcnZlciwgdmRhZ2VudGRfc29ja2V0LCAm
ZXJyKTsKICAgICB9CiAKLSAgICBpZiAoIXNlcnZlcikgewotICAgICAgICBpZiAoZXJybm8gPT0g
RUFERFJJTlVTRSkgewotICAgICAgICAgICAgc3lzbG9nKExPR19DUklULCAiRmF0YWwgdGhlIHNl
cnZlciBzb2NrZXQgJXMgZXhpc3RzIGFscmVhZHkuIERlbGV0ZSBpdD8iLAotICAgICAgICAgICAg
ICAgICAgIHZkYWdlbnRkX3NvY2tldCk7Ci0gICAgICAgIH0gZWxzZSB7Ci0gICAgICAgICAgICBz
eXNsb2coTE9HX0NSSVQsICJGYXRhbCBjb3VsZCBub3QgY3JlYXRlIHRoZSBzZXJ2ZXIgc29ja2V0
ICVzIiwKLSAgICAgICAgICAgICAgICAgICB2ZGFnZW50ZF9zb2NrZXQpOwotICAgICAgICB9Cisg
ICAgaWYgKGVycikgeworICAgICAgICBzeXNsb2coTE9HX0NSSVQsICJGYXRhbCBjb3VsZCBub3Qg
Y3JlYXRlIHRoZSBzZXJ2ZXIgc29ja2V0ICVzOiAlcyIsCisgICAgICAgICAgICAgICAgICAgICAg
ICAgdmRhZ2VudGRfc29ja2V0LCBlcnItPm1lc3NhZ2UpOworICAgICAgICBnX2Vycm9yX2ZyZWUo
ZXJyKTsKKyAgICAgICAgdWRzY3NfZGVzdHJveV9zZXJ2ZXIoc2VydmVyKTsKICAgICAgICAgcmV0
dXJuIDE7CiAgICAgfQogCi0tIAoyLjIwLjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fClNwaWNlLWRldmVsIG1haWxpbmcgbGlzdApTcGljZS1kZXZlbEBs
aXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1h
bi9saXN0aW5mby9zcGljZS1kZXZlbA==
