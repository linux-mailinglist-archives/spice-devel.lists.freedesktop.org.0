Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id CE3C527FF4
	for <lists+spice-devel@lfdr.de>; Thu, 23 May 2019 16:39:21 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 7297489F24;
	Thu, 23 May 2019 14:39:20 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mail-yb1-xb41.google.com (mail-yb1-xb41.google.com
 [IPv6:2607:f8b0:4864:20::b41])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 425C889F24
 for <spice-devel@lists.freedesktop.org>; Thu, 23 May 2019 14:39:19 +0000 (UTC)
Received: by mail-yb1-xb41.google.com with SMTP id a3so2357564ybr.6
 for <spice-devel@lists.freedesktop.org>; Thu, 23 May 2019 07:39:19 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc;
 bh=xx2cLFPImDTKX9cGbfV/OEYE4eKlSy9srb71GekyZoI=;
 b=OBM8NYsCJqBE39e7jG4fW9Fe+58yqO6s94f0xI+3ENUSe5nVqCg/GbqsLJ8+3FkRBm
 zOoej518qbaHQqHfSP2eF3NodOUOaON9nyXW13YluUP7idBy2m4E4rj4EbQmUrBbkNiu
 WcHwQKtXpF5SFmdqiXG6F6K3TpPtuQWStGmqW9F67wJXZGLiZGdYwx971V4hWYg9x+Ma
 nf+mHAXfErBiCEi/Og1SETtQRRYUfXfOpsIyO9IRtL+3XoQ4wRxS/V95ScHMmTXNpNgH
 4gCuXXTMxiaIviQQsSche5o5iayZnEz4K98pdfCUoW/fNrLP4w8KK52gnzRhgH2Ohcmy
 b5eA==
X-Gm-Message-State: APjAAAWGjfog5umlxxlkuY8yB/wqUJAQbKM8IGP1F0iMKUBUP0R91tiO
 PUEVJ6eievGt/VOpGBxvpgKxjqvUPbB0LxDVCKbYaA==
X-Google-Smtp-Source: APXvYqyxdFrI1Lqc+nspnCjBKFhdjVzWEbUig1/gm92PW87yUsvZlfUmAabHVFarOs/dUg8j1Le5VsfDu7COHat4Z1Y=
X-Received: by 2002:a25:d7d0:: with SMTP id
 o199mr11794733ybg.366.1558622357855; 
 Thu, 23 May 2019 07:39:17 -0700 (PDT)
MIME-Version: 1.0
References: <20190521090552.2310-1-victortoso@redhat.com>
 <20190521090552.2310-4-victortoso@redhat.com>
 <20190521104541.3wxlto7erndhvfnv@toolbox>
In-Reply-To: <20190521104541.3wxlto7erndhvfnv@toolbox>
From: Yuri Benditovich <yuri.benditovich@daynix.com>
Date: Thu, 23 May 2019 17:39:02 +0300
Message-ID: <CAOEp5Of=6ouzv2XczVhmTx2pOrRKKrNDLZQV2cYmzadtnCk4MA@mail.gmail.com>
To: Victor Toso <victortoso@redhat.com>
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=daynix-com.20150623.gappssmtp.com; s=20150623;
 h=mime-version:references:in-reply-to:from:date:message-id:subject:to
 :cc;
 bh=xx2cLFPImDTKX9cGbfV/OEYE4eKlSy9srb71GekyZoI=;
 b=b3cDIAgGcd5+oY5EUU9XWVMUFcnqjTYDPYxarzc3BQjMj4vzyGd382SvAccSMgFONV
 gz2PxA4y43JJjKP3FZPylIRV2oe/DEHEKRiYTyoruNCvyuCaEwBzQjPTciofXsoK9SHE
 0am1qXrRixvtOoQ+hIDkUx9pf/MNU3v+FYTJywVKoSFnzFNkzcizHP+L+SIOtqMj/YkX
 t/Jmw7e1jpWCFEmGR9Feh2slxShZOMTl3q/2izxtT3D2k/1TgkK7RRRtwpsI1xjnASTH
 jnZanVR59BKM5Uo3mOxfS3i4VkXwSCrlzqj2vL/LvvuGt08OxBE6QRNOVh9mHyWGZNdQ
 4jwQ==
Subject: Re: [Spice-devel] [spice-gtk v1 3/4] usb-redirection: isolate usage
 of libusb and usbredirhost
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Spice List <spice-devel@lists.freedesktop.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

T24gVHVlLCBNYXkgMjEsIDIwMTkgYXQgMTo0NSBQTSBWaWN0b3IgVG9zbyA8dmljdG9ydG9zb0By
ZWRoYXQuY29tPiB3cm90ZToKPgo+IEhpLAo+Cj4gU28gdGhpcyBpcyB0aGUgY29yZSBvZiB0aGUg
c2VyaWVzIGFuZCB3ZSBoYXZlIGEgbG90IGdvaW5nIG9uCj4gaGVyZS4gVGhlIGdvYWwgb2YgdGhp
cyBlbWFpbCBpcyB0byBzdGFydCBhIGRpc2N1c3Npb24gb24gY3VycmVudAo+IGRlc2lnbiBhbmQg
cHJvcG9zZWQgZGVzaWduIGFuZCB3aGF0IGNhbiBzdGlsbCBiZSBpbXByb3ZlZC4KPgo+IFRvIGJl
IGFibGUgdG8gcHJvdmlkZSBnb29kIGVub3VnaCBmZWVkYmFjayBJIGhhZCB0byBhY3R1YWxseQo+
IHVuZGVyc3RhbmQgYXMgbXVjaCBhcyBwb3NzaWJsZSwgaG93IHRoaW5ncyB3b3JrIHRvZ2V0aGVy
IGFzIHdlCj4gaGF2ZSBzbyBtYW55IGZpbGVzLCBvYmplY3RzIGFuZCByb2xlcyBmb3IgYm90aCB3
aW4gYW5kIGxpbnV4Cj4gYmFzZWQgc3lzdGVtcy4KPgo+IFdoYXQgSSBhY3R1YWxseSBmb3VuZCBh
bmQgZGlzY3Vzc2VkIGEgYml0IHdpdGggRnJlZGlhbm8gaXMgdGhhdAo+IHdlIGNvdWxkIGRvLCBp
biB0aGUgY3VycmVudCBjb2RlLCBhIGJpdCBiZXR0ZXIgb24gZGVzaWduLiBCdXQKPiB0aGlzIHBh
dGNoIHBsYW5zIHRvIGNoYW5nZSBzb21lIG9mIHRoZSBkZXNpZ24gaXRzZWxmIHNvLCB3ZSBoYXZl
Cj4gdHdvIHBvc3NpYmlsaXRpZXM6Cj4KPiAgQS4gcmVmYWN0b3IgZXhpc3RpbmcgY29kZSBhbmQg
cmViYXNlL3Jld29yayB0aGlzIHBhdGNoIHNlcmllcwo+ICBCLiBnZXQgdGhpcyBwYXRjaCBpbiBz
aGFwZSBhbmQgZG8gbW9yZSByZWZhY3RvciBsYXRlcgo+Cj4gSSBzdGFydGVkIHRvIHBsYXkgd2l0
aCBzb21lIHBvc3NpYmxlIGNoYW5nZXMgZm9yIChBKSBsaWtlIFswXSBhbmQKPiBbMV0gYW5kIGlm
IEkgY291bGQgc3BlbmQgMTAwJSB0aW1lIG9uIHRoaXMgSSBtaWdodCBrZWVwIGdvaW5nIGJ1dAo+
IGl0J2xsIGxpa2VseSB0YWtlIGdvb2QgYW1vdW50IG9mIHRpbWUgYW5kIHRlc3Rpbmcgc28gSSdt
IGluY2xpbmVkCj4gdG8gd29yayB3aXRoIHlvdSBvbiAoQikgYXBwcm9hY2guCj4KPiBbMF0gaHR0
cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvYXJjaGl2ZXMvc3BpY2UtZGV2ZWwvMjAxOS1NYXkv
MDQ5MDcxLmh0bWwKPiBbMV0gaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvYXJjaGl2ZXMv
c3BpY2UtZGV2ZWwvMjAxOS1NYXkvMDQ5MDg3Lmh0bWwKPgoKCgo+IFNvLCB3aXRoIHRoaXMgaW50
cm9kdWN0aW9uIGluIG1pbmQsIGxldCdzIGdvLgo+Cj4gT24gVHVlLCBNYXkgMjEsIDIwMTkgYXQg
MDk6MDU6NTFBTSArMDAwMCwgVmljdG9yIFRvc28gd3JvdGU6Cj4gPiBGcm9tOiBZdXJpIEJlbmRp
dG92aWNoIDx5dXJpLmJlbmRpdG92aWNoQGRheW5peC5jb20+Cj4gPgo+ID4gQXMgYSBzdGVwIHRv
d2FyZCBwb3NzaWJpbGl0eSB0byBwcmVzZW50IGVtdWxhdGVkIFVTQiBkZXZpY2VzCj4gPiB0byB0
aGUgZ3Vlc3QsIHdlIHJlbW92ZSB0aGUga25vd2xlZGdlIGFib3V0IGxpYnVzYiBhbmQKPiA+IHVz
YnJlZGlyaG9zdCAod2hpY2ggZGVwZW5kcyBvbiBsaWJ1c2IpIGZyb20gYWxsIHRoZSBtb2R1bGVz
Cj4gPiBhbmQgY29uY2VudHJhdGUgaXQgaW4gb25lICh1c2IgYmFja2VuZCkgd2hpY2ggcHJlc2Vu
dHMKPiA+IGFic3RyYWN0IFVTQiBvYmplY3RzIGFuZCBpbnRlcm5hbCBBUEkgdG8gYWxsIG90aGVy
IG1vZHVsZXMuCj4KPiBUaGlzIGlzIGEgZ29vZCBzdW1tYXJ5IGJ1dCBpdCBkb2VzIHNvIG11Y2gg
aW4gdGVybXMgb2YgY29kZSBhbmQKPiBub3QgbXVjaCBpcyBleHBsYWluZWQgaGVyZSB3aGF0c29l
dmVyLgo+Cj4gT25lIHRoaW5nIHRoYXQgbWFrZXMgbWUgdW5jb21mb3J0YWJsZSB3aXRoIGN1cnJl
bnQgY29kZSBidXQgYWxzbwo+IHN1Z2dlc3RlZCBjb2RlIGNhbiBiZSBleHBsYWluZWQgd2l0aCB0
aGUgZm9sbG93aW5nIHR5cGUgcmVuYW1lczoKPgo+IFt2YXI6IGNvbnRleHRdIGxpYnVzYl9jb250
ZXh0IC0+IFNwaWNlVXNiQmFja2VuZAo+IFt2YXI6IGRldmljZSBdIGxpYnVzYl9kZXZpY2UgIC0+
IFNwaWNlVXNiQmFja2VuZERldmljZQo+IFt2YXI6IGhvc3QgICBdIHVzYnJlZGlyaG9zdCAgIC0+
IFNwaWNlVXNiQmFja2VuZENoYW5uZWwKPgo+IEp1c3QgcmVuYW1pbmcgdGhlIHR5cGVzIGRvbid0
IG1ha2UgYW55dGhpbmcgc2ltcGxlciwgSU1ITyBidXQKPiB3aGF0IEkgcmVhbGx5IHdhbnQgdG8g
ZGlzY3VzcyBpcyBieSBpbnRyb2R1Y2luZyB1c2ItYmFja2VuZCwKPiBjYW4ndCB3ZSByZWR1Y2Ug
c29tZSBvZiB0aGUgY29tcGxleGl0eSwgdGhhdCBpcywgaW5zdGVhZCBvZgo+IGRlYWxpbmcgd2l0
aCAzIHR5cGVzIHdlIGNhbiBpbnRlcmFjdCB3aXRoIHNvbWUgU3BpY2VVc2JCYWNrZWQKPiB0eXBl
IGFsb25lIHRoYXQgc2hvdWxkIGhhbmRsZSBjb250ZXh0L3VzYnJlZGlyaG9zdCBwZXIgZGV2aWNl
PwoKVGhlIHVzYnJlZGlyaG9zdCBvYmplY3Qgc2hhbGwgYmUgY3JlYXRlZCBiZWZvcmUgdGhlIHVz
Yi1yZWRpci1jaGFubmVsIGlzCnVzZWQgZm9yIHJlZGlyZWN0aW9uIG9mIGFueSBzcGVjaWZpYyBk
ZXZpY2UgKHRoZXJlIGlzIGluaXRpYWwgZGF0YQpleGNoYW5nZSB0byBpbnRyb2R1Y2Ugb3B0aW9u
cyBhbmQgZmlsdGVycykuCk9uIG90aGVyIGhhbmQsIFVzYkJhY2tlbmREZXZpY2Ugb2JqZWN0cyBl
eGlzdCByZWdhcmRsZXNzIG9mIHJlZGlyZWN0aW9uCmNoYW5uZWxzIGFuZCByZXByZXNlbnQgZXhp
c3RpbmcgVVNCIGRldmljZXMuClNvLCBjdXJyZW50bHkgSSBkbyBub3Qgc2VlIGhvdyB3ZSBjYW4g
Y29tYmluZSBVc2JCYWNrZW5kQ2hhbm5lbCBhbmQKVXNiQmFja2VuZERldmljZS4KCklmIHlvdSBh
c2sgbXkgb3BpbmlvbiwgSSB3b3VsZCBwcmVmZXIgdG8gcHJpb3JpdGl6ZSB0aGluZ3MgYXM6CjEu
IEluY29ycG9yYXRlIGV4aXN0aW5nIHNlcmllcyBvZiBwYXRjaGVzICh3aGF0IG11c3QgYmUgY2hh
bmdlZCBmb3IgdGhhdD8pCjIuIEFkZCBhYmlsaXR5IG9mIGNkLXNoYXJpbmcKMy4gRGVjaWRlIG9u
IEdVSSByZWxhdGVkIHRvIGNkLXNoYXJpbmcgYW5kIGFkZCBpdAo0LiBSZXZpZXcgdGhlIHBvc3Np
YmlsaXRpZXMgb2YgZGVzaWduIHNpbXBsaWZpY2F0aW9uLgoKPgo+IFNwaWNlVXNiQmFja2VuZCdz
IHR5cGVzIHNob3VsZCBiZSBoYW5kbGluZyBsaWJ1c2JfY29udGV4dCwKPiBsaWJ1c2JfZGV2aWNl
IGFuZCB1c2JyZWRpciBzbyBJIHRha2UgdGhhdCB3aGF0IGNoYW5uZWwtdXNicmVkaXIKPiBtaWdo
dCBuZWVkIGZyb20gZGV2aWNlIGNhbiBiZSByZWR1Y2UgdG8gc29tZSBpbnRlcm5hbCBBUElzIGFu
ZAo+IGV4aXN0aW5nIGZ1bmN0aW9uYWxpdHkgY2FuIGJlIGRyb3BwZWQgaW5zdGVhZCBvZiBoYW5k
bGluZyBhcm91bmQKPiB0aG9zZSBuZXcgd3JhcHBlcnMsIGVnOgo+Cj4gKiBXaGF0J3MgdGhlIHJv
bGUgb2Ygc3BpY2VfdXNicmVkaXJfY2hhbm5lbF9zZXRfY29udGV4dCgpIHdpdGgKPiAgIHRoaXMg
cGF0Y2ggaW4/IENvbW1lbnQgaW4gbGluZSBvbiB0aGUgZnVuY3Rpb24uCj4KPiBJIGRvbid0IGZp
bmQgaXQgY29uc3RydWN0aXZlIGZvciBtZSB0byByZXBseSB0byBhbGwgcGFydHMgb2YgdGhpcwo+
IHBhdGNoIGNvbnNpZGVyaW5nIHRoYXQgSSBoYXZlIGRvdWJ0cyBvbiBob3cgd2Ugc2hvdWxkIGhh
bmRsZSB0aGUKPiBjb2RlIGRlc2lnbiBpdHNlbGYgc28sIG15IHN1Z2dlc3Rpb24gaXM6Cj4KPiAx
KSBJZiB5b3UgbGlrZSBteSBGSVhVUCwgbGV0J3MgbWVyZ2UgdGhhdCBhbmQgcmVtb3ZlIG9uZSBw
YXRjaCA6KQoKTm8gcHJvYmxlbSwgbGV0J3MgbWVyZ2UgaXQuCkkgZG8gbm90IHNlZSB3aHkgaXQg
aXMgYmV0dGVyIHRoYW4gaW5pdGlhbCBvbmUsIGJ1dCBJIGFncmVlIHdpdGggZXZlcnkgdGhpbmcK
dGhhdCBsZXQgdXMgbW92ZSBmb3J3YXJkLgoKPgo+IDIpIExldCdzIGNsYXJpZnkgdGhlIGZ1dHVy
ZSByb2xlcyBvZiBjaGFubmVsLXVzYnJlZGlyLAo+ICAgIHVzYi1kZXZpY2UtbWFuYWdlciBhbmQg
dXNiLWJhY2tlbmQgdHlwZXMuIE5vdGUgdGhhdCB0aGlzIGtpbmQKPiAgICBvZiB0aGluZyBwcm9i
YWJseSBtdXN0IGJlIG9uIGNvbW1pdCBsb2cuCj4KCkkgYWdyZWUgaW4gYWR2YW5jZSB3aXRoIGFu
eSBjaGFuZ2VzL2FkZGl0aW9ucyB0byBjb21taXQgbWVzc2FnZS4KVGhlcmUgYXJlIG5vIGNoYW5n
ZXMgaW4gcm9sZXMgb2YgdGhlc2UgdHlwZXMgLSB0aGUgZ29hbCBvZiBjb21taXQocykgaXMgdG8K
Y29uY2VudHJhdGUgYWxsIHRoZSBrbm93bGVkZ2UgYWJvdXQgbGlidXNiL3VzYnJlZGlyIGluIG9u
ZSBtb2R1bGUgYW5kCm1ha2UgdGhlIGNoYW5nZXMgcmVhZGFibGUuCgo+IDMpIEFncmVlIHdoYXQg
c2hvdWxkIGJlIGlkZWFsIGFuZCB3aGF0IHdlIGNhbiBjb21wcm9taXNlIHRvIGRvCj4gICAgbGF0
ZXIsIHRoYXQgaXMsIHdoYXQgYXJlIHRoZSBuZWNlc3NhcnkgY2hhbmdlcyBpbiB5b3VyIHBhdGNo
ZXMKPiAgICB0byBiZSBtZXJnZWQgc28gd2UgY2FuIGdvIGJhY2sgdG8gKEEpIGJlY2F1c2UgSSdt
IG5vdCByZWFsbHkKPiAgICB0cnlpbmcgdG8gbWFrZSB5b3UgcmVmYWN0b3IgYWxsIHRoZSBjb2Rl
IHlvdXJzZWxmIHdpdGggdGhpcywKPiAgICBqdXN0IGFza2luZyB5b3VyIGhlbHAgd2l0aCBkZXNp
Z24gaXRzZWxmIDspCj4KPiA+IFNpZ25lZC1vZmYtYnk6IFl1cmkgQmVuZGl0b3ZpY2ggPHl1cmku
YmVuZGl0b3ZpY2hAZGF5bml4LmNvbT4KPiA+IC0tLQo+ID4gIHNyYy9NYWtlZmlsZS5hbSAgICAg
ICAgICAgICAgIHwgICAyICsKPiA+ICBzcmMvY2hhbm5lbC11c2JyZWRpci1wcml2LmggICB8ICAg
OSArLQo+ID4gIHNyYy9jaGFubmVsLXVzYnJlZGlyLmMgICAgICAgIHwgMjE2ICsrKy0tLS0tLS0t
LQo+ID4gIHNyYy9tZXNvbi5idWlsZCAgICAgICAgICAgICAgIHwgICAyICsKPiA+ICBzcmMvdXNi
LWJhY2tlbmQuYyAgICAgICAgICAgICB8IDYyMiArKysrKysrKysrKysrKysrKysrKysrKysrKysr
KysrKysrCj4gPiAgc3JjL3VzYi1iYWNrZW5kLmggICAgICAgICAgICAgfCAxMTAgKysrKysrCj4g
PiAgc3JjL3VzYi1kZXZpY2UtbWFuYWdlci1wcml2LmggfCAgIDEgLQo+ID4gIHNyYy91c2ItZGV2
aWNlLW1hbmFnZXIuYyAgICAgIHwgMzM2ICsrKysrKy0tLS0tLS0tLS0tLQo+ID4gIHNyYy91c2J1
dGlsLmggICAgICAgICAgICAgICAgIHwgICAxIC0KPiA+ICBzcmMvd2luLXVzYi1kZXYuYyAgICAg
ICAgICAgICB8IDEwMyArKy0tLS0KPiA+ICBzcmMvd2luLXVzYi1kZXYuaCAgICAgICAgICAgICB8
ICAgNSArLQo+ID4gIDExIGZpbGVzIGNoYW5nZWQsIDkyOSBpbnNlcnRpb25zKCspLCA0NzggZGVs
ZXRpb25zKC0pCj4gPiAgY3JlYXRlIG1vZGUgMTAwNjQ0IHNyYy91c2ItYmFja2VuZC5jCj4gPiAg
Y3JlYXRlIG1vZGUgMTAwNjQ0IHNyYy91c2ItYmFja2VuZC5oCj4gPgo+ID4gZGlmZiAtLWdpdCBh
L3NyYy9NYWtlZmlsZS5hbSBiL3NyYy9NYWtlZmlsZS5hbQo+ID4gaW5kZXggN2E3ZWNiNC4uYmVh
NDEwMCAxMDA2NDQKPiA+IC0tLSBhL3NyYy9NYWtlZmlsZS5hbQo+ID4gKysrIGIvc3JjL01ha2Vm
aWxlLmFtCj4gPiBAQCAtMjY0LDYgKzI2NCw4IEBAIGxpYnNwaWNlX2NsaWVudF9nbGliX2ltcGxf
bGFfU09VUkNFUyA9ICAgICAgICAgICAgICAgICAgICBcCj4gPiAgICAgICBzcGljZS11cmktcHJp
di5oICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCj4gPiAgICAgICB1c2ItZGV2aWNl
LW1hbmFnZXIuYyAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCj4gPiAgICAgICB1c2ItZGV2
aWNlLW1hbmFnZXItcHJpdi5oICAgICAgICAgICAgICAgICAgICAgICBcCj4gPiArICAgICB1c2It
YmFja2VuZC5jICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCj4gPiArICAgICB1
c2ItYmFja2VuZC5oICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCj4gPiAgICAg
ICB1c2J1dGlsLmMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCj4gPiAg
ICAgICB1c2J1dGlsLmggICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCj4g
PiAgICAgICAkKFVTQl9BQ0xfSEVMUEVSX1NSQ1MpICAgICAgICAgICAgICAgICAgICAgICAgICBc
Cj4gPiBkaWZmIC0tZ2l0IGEvc3JjL2NoYW5uZWwtdXNicmVkaXItcHJpdi5oIGIvc3JjL2NoYW5u
ZWwtdXNicmVkaXItcHJpdi5oCj4gPiBpbmRleCAxZWE4YTE5Li5iODIxMTcwIDEwMDY0NAo+ID4g
LS0tIGEvc3JjL2NoYW5uZWwtdXNicmVkaXItcHJpdi5oCj4gPiArKysgYi9zcmMvY2hhbm5lbC11
c2JyZWRpci1wcml2LmgKPiA+IEBAIC0yMyw5ICsyMyw4IEBACj4gPgo+ID4gICNpZmRlZiBVU0Vf
VVNCUkVESVIKPiA+Cj4gPiAtI2luY2x1ZGUgPGxpYnVzYi5oPgo+ID4gLSNpbmNsdWRlIDx1c2Jy
ZWRpcmZpbHRlci5oPgo+ID4gICNpbmNsdWRlICJzcGljZS1jbGllbnQuaCIKPiA+ICsjaW5jbHVk
ZSAidXNiLWJhY2tlbmQuaCIKPiA+Cj4gPiAgR19CRUdJTl9ERUNMUwo+ID4KPiA+IEBAIC0zMyw3
ICszMiw3IEBAIEdfQkVHSU5fREVDTFMKPiA+ICAgICBjb250ZXh0IHNob3VsZCBub3QgYmUgZGVz
dHJveWVkIGJlZm9yZSB0aGUgbGFzdCBkZXZpY2UgaGFzIGJlZW4KPiA+ICAgICBkaXNjb25uZWN0
ZWQgKi8KPiA+ICB2b2lkIHNwaWNlX3VzYnJlZGlyX2NoYW5uZWxfc2V0X2NvbnRleHQoU3BpY2VV
c2JyZWRpckNoYW5uZWwgKmNoYW5uZWwsCj4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGxpYnVzYl9jb250ZXh0ICAgICAgICpjb250ZXh0KTsKPiA+ICsgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU3BpY2VVc2JCYWNrZW5kICAgICAgKmNv
bnRleHQpOwo+ID4KPiA+ICB2b2lkIHNwaWNlX3VzYnJlZGlyX2NoYW5uZWxfZGlzY29ubmVjdF9k
ZXZpY2VfYXN5bmMoU3BpY2VVc2JyZWRpckNoYW5uZWwgKmNoYW5uZWwsCj4gPiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdDYW5jZWxsYWJsZSAq
Y2FuY2VsbGFibGUsCj4gPiBAQCAtNDgsNyArNDcsNyBAQCBnYm9vbGVhbiBzcGljZV91c2JyZWRp
cl9jaGFubmVsX2Rpc2Nvbm5lY3RfZGV2aWNlX2ZpbmlzaChTcGljZVVzYnJlZGlyQ2hhbm5lbCAq
Ywo+ID4gICAgICh0aHJvdWdoIHNwaWNlX2NoYW5uZWxfY29ubmVjdCgpKSwgYmVmb3JlIGNhbGxp
bmcgdGhpcy4gKi8KPiA+ICB2b2lkIHNwaWNlX3VzYnJlZGlyX2NoYW5uZWxfY29ubmVjdF9kZXZp
Y2VfYXN5bmMoCj4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNw
aWNlVXNicmVkaXJDaGFubmVsICpjaGFubmVsLAo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBsaWJ1c2JfZGV2aWNlICAgICAgICAqZGV2aWNlLAo+ID4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTcGljZVVzYkJhY2tlbmREZXZpY2Ug
KmRldmljZSwKPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU3Bp
Y2VVc2JEZXZpY2UgICAgICAgKnNwaWNlX2RldmljZSwKPiA+ICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgR0NhbmNlbGxhYmxlICAgICAgICAgKmNhbmNlbGxhYmxlLAo+
ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBHQXN5bmNSZWFkeUNh
bGxiYWNrICAgY2FsbGJhY2ssCj4gPiBAQCAtNjAsNyArNTksNyBAQCBnYm9vbGVhbiBzcGljZV91
c2JyZWRpcl9jaGFubmVsX2Nvbm5lY3RfZGV2aWNlX2ZpbmlzaCgKPiA+Cj4gPiAgdm9pZCBzcGlj
ZV91c2JyZWRpcl9jaGFubmVsX2Rpc2Nvbm5lY3RfZGV2aWNlKFNwaWNlVXNicmVkaXJDaGFubmVs
ICpjaGFubmVsKTsKPiA+Cj4gPiAtbGlidXNiX2RldmljZSAqc3BpY2VfdXNicmVkaXJfY2hhbm5l
bF9nZXRfZGV2aWNlKFNwaWNlVXNicmVkaXJDaGFubmVsICpjaGFubmVsKTsKPiA+ICtTcGljZVVz
YkJhY2tlbmREZXZpY2UgKnNwaWNlX3VzYnJlZGlyX2NoYW5uZWxfZ2V0X2RldmljZShTcGljZVVz
YnJlZGlyQ2hhbm5lbCAqY2hhbm5lbCk7Cj4gPgo+ID4gIHZvaWQgc3BpY2VfdXNicmVkaXJfY2hh
bm5lbF9sb2NrKFNwaWNlVXNicmVkaXJDaGFubmVsICpjaGFubmVsKTsKPiA+Cj4gPiBkaWZmIC0t
Z2l0IGEvc3JjL2NoYW5uZWwtdXNicmVkaXIuYyBiL3NyYy9jaGFubmVsLXVzYnJlZGlyLmMKPiA+
IGluZGV4IDA3OWE5NzYuLjNlMDgzOGMgMTAwNjQ0Cj4gPiAtLS0gYS9zcmMvY2hhbm5lbC11c2Jy
ZWRpci5jCj4gPiArKysgYi9zcmMvY2hhbm5lbC11c2JyZWRpci5jCj4gPiBAQCAtMjMsNyArMjMs
NiBAQAo+ID4KPiA+ICAjaWZkZWYgVVNFX1VTQlJFRElSCj4gPiAgI2luY2x1ZGUgPGdsaWIvZ2kx
OG4tbGliLmg+Cj4gPiAtI2luY2x1ZGUgPHVzYnJlZGlyaG9zdC5oPgo+ID4gICNpZmRlZiBVU0Vf
TFo0Cj4gPiAgI2luY2x1ZGUgPGx6NC5oPgo+ID4gICNlbmRpZgo+ID4gQEAgLTYzLDE1ICs2Miwx
MiBAQCBlbnVtIFNwaWNlVXNicmVkaXJDaGFubmVsU3RhdGUgewo+ID4gIH07Cj4gPgo+ID4gIHN0
cnVjdCBfU3BpY2VVc2JyZWRpckNoYW5uZWxQcml2YXRlIHsKPiA+IC0gICAgbGlidXNiX2Rldmlj
ZSAqZGV2aWNlOwo+ID4gKyAgICBTcGljZVVzYkJhY2tlbmREZXZpY2UgKmRldmljZTsKPiA+ICAg
ICAgU3BpY2VVc2JEZXZpY2UgKnNwaWNlX2RldmljZTsKPiA+IC0gICAgbGlidXNiX2NvbnRleHQg
KmNvbnRleHQ7Cj4gPiAtICAgIHN0cnVjdCB1c2JyZWRpcmhvc3QgKmhvc3Q7Cj4gPiArICAgIFNw
aWNlVXNiQmFja2VuZCAqY29udGV4dDsKPiA+ICsgICAgU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCAq
aG9zdDsKPiA+ICAgICAgLyogVG8gY2F0Y2ggdXNicmVkaXJob3N0IGVycm9yIG1lc3NhZ2VzIGFu
ZCByZXBvcnQgdGhlbSBhcyBhIEdFcnJvciAqLwo+ID4gICAgICBHRXJyb3IgKipjYXRjaF9lcnJv
cjsKPiA+IC0gICAgLyogRGF0YSBwYXNzZWQgZnJvbSBjaGFubmVsIGhhbmRsZSBtc2cgdG8gdGhl
IHVzYnJlZGlyaG9zdCByZWFkIGNiICovCj4gPiAtICAgIGNvbnN0IHVpbnQ4X3QgKnJlYWRfYnVm
Owo+ID4gLSAgICBpbnQgcmVhZF9idWZfc2l6ZTsKPiA+ICAgICAgZW51bSBTcGljZVVzYnJlZGly
Q2hhbm5lbFN0YXRlIHN0YXRlOwo+ID4gICNpZmRlZiBVU0VfUE9MS0lUCj4gPiAgICAgIEdUYXNr
ICp0YXNrOwo+ID4gQEAgLTg3LDE2ICs4Myw5IEBAIHN0YXRpYyB2b2lkIHNwaWNlX3VzYnJlZGly
X2NoYW5uZWxfZGlzcG9zZShHT2JqZWN0ICpvYmopOwo+ID4gIHN0YXRpYyB2b2lkIHNwaWNlX3Vz
YnJlZGlyX2NoYW5uZWxfZmluYWxpemUoR09iamVjdCAqb2JqKTsKPiA+ICBzdGF0aWMgdm9pZCB1
c2JyZWRpcl9oYW5kbGVfbXNnKFNwaWNlQ2hhbm5lbCAqY2hhbm5lbCwgU3BpY2VNc2dJbiAqaW4p
Owo+ID4KPiA+IC1zdGF0aWMgdm9pZCB1c2JyZWRpcl9sb2codm9pZCAqdXNlcl9kYXRhLCBpbnQg
bGV2ZWwsIGNvbnN0IGNoYXIgKm1zZyk7Cj4gPiAtc3RhdGljIGludCB1c2JyZWRpcl9yZWFkX2Nh
bGxiYWNrKHZvaWQgKnVzZXJfZGF0YSwgdWludDhfdCAqZGF0YSwgaW50IGNvdW50KTsKPiA+ICBz
dGF0aWMgaW50IHVzYnJlZGlyX3dyaXRlX2NhbGxiYWNrKHZvaWQgKnVzZXJfZGF0YSwgdWludDhf
dCAqZGF0YSwgaW50IGNvdW50KTsKPiA+IC1zdGF0aWMgdm9pZCB1c2JyZWRpcl93cml0ZV9mbHVz
aF9jYWxsYmFjayh2b2lkICp1c2VyX2RhdGEpOwo+ID4gLXN0YXRpYyB1aW50NjRfdCB1c2JyZWRp
cl9idWZmZXJlZF9vdXRwdXRfc2l6ZV9jYWxsYmFjayh2b2lkICp1c2VyX2RhdGEpOwo+ID4gLQo+
ID4gLXN0YXRpYyB2b2lkICp1c2JyZWRpcl9hbGxvY19sb2NrKHZvaWQpOwo+ID4gLXN0YXRpYyB2
b2lkIHVzYnJlZGlyX2xvY2tfbG9jayh2b2lkICp1c2VyX2RhdGEpOwo+ID4gLXN0YXRpYyB2b2lk
IHVzYnJlZGlyX3VubG9ja19sb2NrKHZvaWQgKnVzZXJfZGF0YSk7Cj4gPiAtc3RhdGljIHZvaWQg
dXNicmVkaXJfZnJlZV9sb2NrKHZvaWQgKnVzZXJfZGF0YSk7Cj4gPiArc3RhdGljIGdib29sZWFu
IHVzYnJlZGlyX2lzX2NoYW5uZWxfcmVhZHkodm9pZCAqdXNlcl9kYXRhKTsKPiA+ICtzdGF0aWMg
dWludDY0X3QgdXNicmVkaXJfZ2V0X3F1ZXVlX3NpemUodm9pZCAqdXNlcl9kYXRhKTsKPiA+Cj4g
PiAgR19ERUZJTkVfVFlQRV9XSVRIX1BSSVZBVEUoU3BpY2VVc2JyZWRpckNoYW5uZWwsIHNwaWNl
X3VzYnJlZGlyX2NoYW5uZWwsIFNQSUNFX1RZUEVfQ0hBTk5FTCkKPiA+Cj4gPiBAQCAtMTE1LDcg
KzEwNCw3IEBAIHN0YXRpYyB2b2lkIF9jaGFubmVsX3Jlc2V0X2ZpbmlzaChTcGljZVVzYnJlZGly
Q2hhbm5lbCAqY2hhbm5lbCwgZ2Jvb2xlYW4gbWlncmF0Cj4gPgo+ID4gICAgICBzcGljZV91c2Jy
ZWRpcl9jaGFubmVsX2xvY2soY2hhbm5lbCk7Cj4gPgo+ID4gLSAgICB1c2JyZWRpcmhvc3RfY2xv
c2UocHJpdi0+aG9zdCk7Cj4gPiArICAgIHNwaWNlX3VzYl9iYWNrZW5kX2NoYW5uZWxfZGVsZXRl
KHByaXYtPmhvc3QpOwo+ID4gICAgICBwcml2LT5ob3N0ID0gTlVMTDsKPiA+Cj4gPiAgICAgIC8q
IENhbGwgc2V0X2NvbnRleHQgdG8gcmUtY3JlYXRlIHRoZSBob3N0ICovCj4gPiBAQCAtMjIxLDcg
KzIxMCw3IEBAIHN0YXRpYyB2b2lkIHNwaWNlX3VzYnJlZGlyX2NoYW5uZWxfZmluYWxpemUoR09i
amVjdCAqb2JqKQo+ID4gICAgICBTcGljZVVzYnJlZGlyQ2hhbm5lbCAqY2hhbm5lbCA9IFNQSUNF
X1VTQlJFRElSX0NIQU5ORUwob2JqKTsKPiA+Cj4gPiAgICAgIGlmIChjaGFubmVsLT5wcml2LT5o
b3N0KQo+ID4gLSAgICAgICAgdXNicmVkaXJob3N0X2Nsb3NlKGNoYW5uZWwtPnByaXYtPmhvc3Qp
Owo+ID4gKyAgICAgICAgc3BpY2VfdXNiX2JhY2tlbmRfY2hhbm5lbF9kZWxldGUoY2hhbm5lbC0+
cHJpdi0+aG9zdCk7Cj4gPiAgICAgIGdfbXV0ZXhfY2xlYXIoJmNoYW5uZWwtPnByaXYtPmRldmlj
ZV9jb25uZWN0X211dGV4KTsKPiA+Cj4gPiAgICAgIC8qIENoYWluIHVwIHRvIHRoZSBwYXJlbnQg
Y2xhc3MgKi8KPiA+IEBAIC0yNDQsMzAgKzIzMywyMiBAQCBzdGF0aWMgdm9pZCBjaGFubmVsX3Nl
dF9oYW5kbGVycyhTcGljZUNoYW5uZWxDbGFzcyAqa2xhc3MpCj4gPgo+ID4gIEdfR05VQ19JTlRF
Uk5BTAo+ID4gIHZvaWQgc3BpY2VfdXNicmVkaXJfY2hhbm5lbF9zZXRfY29udGV4dChTcGljZVVz
YnJlZGlyQ2hhbm5lbCAqY2hhbm5lbCwKPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgbGlidXNiX2NvbnRleHQgICAgICAgKmNvbnRleHQpCj4gPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNwaWNlVXNiQmFja2VuZCAgICAgICpjb250
ZXh0KQo+ID4gIHsKPiA+ICAgICAgU3BpY2VVc2JyZWRpckNoYW5uZWxQcml2YXRlICpwcml2ID0g
Y2hhbm5lbC0+cHJpdjsKPiA+ICsgICAgU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbEluaXREYXRhIGlu
aXRfZGF0YTsKPiA+ICsgICAgaW5pdF9kYXRhLnVzZXJfZGF0YSA9IGNoYW5uZWw7Cj4gPiArICAg
IGluaXRfZGF0YS5nZXRfcXVldWVfc2l6ZSA9IHVzYnJlZGlyX2dldF9xdWV1ZV9zaXplOwo+ID4g
KyAgICBpbml0X2RhdGEuaXNfY2hhbm5lbF9yZWFkeSA9IHVzYnJlZGlyX2lzX2NoYW5uZWxfcmVh
ZHk7Cj4gPiArICAgIGluaXRfZGF0YS53cml0ZV9jYWxsYmFjayA9IHVzYnJlZGlyX3dyaXRlX2Nh
bGxiYWNrOwo+Cj4gWW91IGNhbiByZW1vdmUgU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbEluaXREYXRh
IGVudGlyZWx5Lgo+IFNwaWNlVXNiQmFja2VuZENoYW5uZWwgc2hvdWxkIHJlbHkgb24gU3BpY2VV
c2JyZWRpckNoYW5uZWwgYnkKPiBjYWxsaW5nIGV4cG9zZWQgaW50ZXJuYWwgQVBJcy4gU28sIGJl
dHRlciB3b3VsZCBiZSB0byBleHBvc2UKPiB0aG9zZSBmdW5jdGlvbnMgYW5kIGNhbGwgdGhlbSBm
cm9tIHVzYi1iYWNrZW5kLmMKPgoKWWVzLCB0aGlzIGlzIHBvc3NpYmxlLCBidXQgSSBwZXJzb25h
bGx5IGRvIG5vdCBsaWtlIHRoaXMgYXBwcm9hY2ggb2YKY3JlYXRpbmcgYWRkaXRpb25hbCBwdWJs
aWMgcHJvY2VkdXJlcyBmb3IgdXNiLXJlZGlyLWNoYW5uZWwgYW5kIG1ha2luZwondXNiIGJhY2tl
bmQnIGNvZGUgdG8gaGF2ZSBhIGtub3dsZWRnZSBhYm91dCB1c2ItcmVkaXItY2hhbm5lbCBhdCBh
bGwuCkZyb20gbXkgUE9WIGV4aXN0aW5nIGNvZGUgaXMgbW9yZSByZWFkYWJsZS4KQnV0IC0gaWYg
eW91IGZpbmQgc3VjaCBjaGFuZ2UgaXMgbWFuZGF0b3J5LCBwbGVhc2UgbGV0IG1lIGtub3cuIE15
IGludGVyZXN0IGlzCnRvIG1ha2UgdGhlIG1lcmdlIG9mIGNoYW5nZXMgZmFzdGVyIGFuZCBzdGFy
dCBzdWJtaXR0aW5nIHBhdGNoZXMKcmVsYXRlZCB0byBjZCBzaGFyaW5nLgoKPiBUaGlzIG1lYW5z
IHRoYXQgdGhpcyBmdW5jdGlvbiB3aWxsIGJlIHJlZHVjZWQgdG8gc29tZXRoaW5nIGxpa2UKPgo+
ICB8IEdfR05VQ19JTlRFUk5BTAo+ICB8IHZvaWQgc3BpY2VfdXNicmVkaXJfY2hhbm5lbF9zZXRf
Y29udGV4dChTcGljZVVzYnJlZGlyQ2hhbm5lbCAqY2hhbm5lbCwKPiAgfCAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgU3BpY2VVc2JCYWNrZW5kICAgICAgKmNvbnRleHQp
Cj4gIHwgewo+ICB8ICAgICAgU3BpY2VVc2JyZWRpckNoYW5uZWxQcml2YXRlICpwcml2ID0gY2hh
bm5lbC0+cHJpdjsKPiAgfAo+ICB8ICAgICAgZ19yZXR1cm5faWZfZmFpbChwcml2LT5ob3N0ID09
IE5VTEwpOwo+ICB8Cj4gIHwgICAgIHByaXYtPmNvbnRleHQgPSBjb250ZXh0Owo+ICB8ICAgICBw
cml2LT5ob3N0ID0gc3BpY2VfdXNiX2JhY2tlbmRfY2hhbm5lbF9uZXcoY29udGV4dCwgY2hhbm5l
bCk7Cj4gIHwgICAgIGlmICghcHJpdi0+aG9zdCkKPiAgfCAgICAgICAgIGdfZXJyb3IoIk91dCBv
ZiBtZW1vcnkgaW5pdGlhbGl6aW5nIHJlZGlyZWN0aW9uIHN1cHBvcnQiKTsKPiAgfAo+ICB8ICNp
ZmRlZiBVU0VfTFo0Cj4gIHwgICAgIHNwaWNlX2NoYW5uZWxfc2V0X2NhcGFiaWxpdHkoY2hhbm5l
bCwgU1BJQ0VfU1BJQ0VWTUNfQ0FQX0RBVEFfQ09NUFJFU1NfTFo0KTsKPiAgfCAjZW5kaWYKPiAg
fCB9Cj4KPiBUaGF0IGlzLCB0aGlzIGNyZWF0ZXMgYSBTcGljZVVzYkJhY2tlbmRDaGFubmVsIGFu
ZCBzdG9yZXMgaXQgaW4KPiBjaGFubmVsLXVzYnJlZGlyIGFuZCBhbHNvIHN0b3JlcyBTcGljZVVz
YkJhY2tlbmQgKGNvbnRleHQpLgo+Cj4gU3BpY2VVc2JCYWNrZW5kIGlzIGJhc2ljYWxseSBub3Qg
dXNlZCBhbnltb3JlLCB3aGljaCBpcyBnb29kCj4gdGhpbmcuIEFsbCBwcmV2aW91cyBsaWJ1c2Jf
Y29udGV4dCByZWxhdGVkIGNvZGUgc2hvdWxkIG5vdyBiZQo+IGhhbmRsZWQgYnkgdXNiLWJhY2tl
bmQuCj4KPiBTbywgSWYgbGlidXNiX2NvbnRleHQgYW5kIHVzYnJlZGlyIGlzIG5vdyBoYW5kbGVk
IGJ5IHVzYi1iYWNrZW5kLAo+IEkgZG9uJ3Qgc2VlIGhvdyB0aGlzIGZ1bmN0aW9uIHNob3VsZCBi
ZSBrZXB0IGluIHRoZSBlbmQuCj4KPiBFYWNoIGNoYW5uZWwtdXNicmVkaXIgbXVzdCBiZSBtYXBw
ZWQgdG8gYSBzaW5nbGUKPiBTcGljZVVzYkJhY2tlbmRDaGFubmVsIG9yIFNwaWNlVXNicmVkaXJE
ZXZpY2UgYW5kIHRoZSB0eXBlCj4gU3BpY2VVc2JCYWNrZW5kIGl0c2VsZiBpcyBub3QgZXZlbiBu
ZWVkZWQgYXJvdW5kCj4gY2hhbm5lbC11c2JyZWRpci4KPgo+IERvZXMgaXQgbWFrZSBzZW5zZSB0
byB5b3U/IEFtIEkgbWlzc2luZyBzb21ldGhpbmcgaGVyZT8KCkluIG9yaWdpbmFsIGNvZGUgb2Yg
dXNiLXJlZGlyLWNoYW5uZWwgdGhlIHByaXYtPmNvbnRleHQgaXMga2VwdCBpbiBjaGFubmVsCm9i
amVjdCBhbmQgdXNlZCB0byByZWNyZWF0ZSB0aGUgY2hhbm5lbCAodXNicmVkaXJob3N0KSBhZnRl
ciBjaGFubmVsIHJlc2V0CihpbmNsdWRpbmcgbWlncmF0aW9uKS4gU3BpY2VVc2JCYWNrZW5kIG9i
amVjdCAocHJpdi0+Y29udGV4dCkgaW4gbW9kaWZpZWQKY29kZSBpcyB1c2VkIGV4YWN0bHkgZm9y
IHRoZSBzYW1lIHB1cnBvc2UuCgo+Cj4gQ2hlZXJzLAo+IFZpY3Rvcgo+Cj4gPiAgICAgIGdfcmV0
dXJuX2lmX2ZhaWwocHJpdi0+aG9zdCA9PSBOVUxMKTsKPiA+Cj4gPiAgICAgIHByaXYtPmNvbnRl
eHQgPSBjb250ZXh0Owo+ID4gLSAgICBwcml2LT5ob3N0ID0gdXNicmVkaXJob3N0X29wZW5fZnVs
bCgKPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQsIE5VTEws
Cj4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2JyZWRpcl9sb2csCj4g
PiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2JyZWRpcl9yZWFkX2NhbGxi
YWNrLAo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNicmVkaXJfd3Jp
dGVfY2FsbGJhY2ssCj4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2Jy
ZWRpcl93cml0ZV9mbHVzaF9jYWxsYmFjaywKPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHVzYnJlZGlyX2FsbG9jX2xvY2ssCj4gPiAtICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB1c2JyZWRpcl9sb2NrX2xvY2ssCj4gPiAtICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICB1c2JyZWRpcl91bmxvY2tfbG9jaywKPiA+IC0gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHVzYnJlZGlyX2ZyZWVfbG9jaywKPiA+IC0gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5uZWwsIFBBQ0tBR0VfU1RSSU5HLAo+ID4gLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BpY2VfdXRpbF9nZXRfZGVidWcoKSA/
IHVzYnJlZGlycGFyc2VyX2RlYnVnIDogdXNicmVkaXJwYXJzZXJfd2FybmluZywKPiA+IC0gICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzYnJlZGlyaG9zdF9mbF93cml0ZV9jYl9v
d25zX2J1ZmZlcik7Cj4gPiArICAgIHByaXYtPmhvc3QgPSBzcGljZV91c2JfYmFja2VuZF9jaGFu
bmVsX25ldyhjb250ZXh0LCAmaW5pdF9kYXRhKTsKPiA+ICAgICAgaWYgKCFwcml2LT5ob3N0KQo+
ID4gLSAgICAgICAgZ19lcnJvcigiT3V0IG9mIG1lbW9yeSBhbGxvY2F0aW5nIHVzYnJlZGlyaG9z
dCIpOwo+ID4gKyAgICAgICAgZ19lcnJvcigiT3V0IG9mIG1lbW9yeSBpbml0aWFsaXppbmcgcmVk
aXJlY3Rpb24gc3VwcG9ydCIpOwo+ID4KPiA+IC0gICAgdXNicmVkaXJob3N0X3NldF9idWZmZXJl
ZF9vdXRwdXRfc2l6ZV9jYihwcml2LT5ob3N0LCB1c2JyZWRpcl9idWZmZXJlZF9vdXRwdXRfc2l6
ZV9jYWxsYmFjayk7Cj4gPiAgI2lmZGVmIFVTRV9MWjQKPiA+ICAgICAgc3BpY2VfY2hhbm5lbF9z
ZXRfY2FwYWJpbGl0eShjaGFubmVsLCBTUElDRV9TUElDRVZNQ19DQVBfREFUQV9DT01QUkVTU19M
WjQpOwo+ID4gICNlbmRpZgo+ID4gQEAgLTI3OCw4ICsyNTksNiBAQCBzdGF0aWMgZ2Jvb2xlYW4g
c3BpY2VfdXNicmVkaXJfY2hhbm5lbF9vcGVuX2RldmljZSgKPiA+ICB7Cj4gPiAgICAgIFNwaWNl
VXNicmVkaXJDaGFubmVsUHJpdmF0ZSAqcHJpdiA9IGNoYW5uZWwtPnByaXY7Cj4gPiAgICAgIFNw
aWNlU2Vzc2lvbiAqc2Vzc2lvbjsKPiA+IC0gICAgbGlidXNiX2RldmljZV9oYW5kbGUgKmhhbmRs
ZSA9IE5VTEw7Cj4gPiAtICAgIGludCByYywgc3RhdHVzOwo+ID4gICAgICBTcGljZVVzYkRldmlj
ZU1hbmFnZXIgKm1hbmFnZXI7Cj4gPgo+ID4gICAgICBnX3JldHVybl92YWxfaWZfZmFpbChwcml2
LT5zdGF0ZSA9PSBTVEFURV9ESVNDT05ORUNURUQKPiA+IEBAIC0yODgsMTkgKzI2NywxMSBAQCBz
dGF0aWMgZ2Jvb2xlYW4gc3BpY2VfdXNicmVkaXJfY2hhbm5lbF9vcGVuX2RldmljZSgKPiA+ICAj
ZW5kaWYKPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgLCBGQUxTRSk7Cj4gPgo+ID4gLSAg
ICByYyA9IGxpYnVzYl9vcGVuKHByaXYtPmRldmljZSwgJmhhbmRsZSk7Cj4gPiAtICAgIGlmIChy
YyAhPSAwKSB7Cj4gPiAtICAgICAgICBnX3NldF9lcnJvcihlcnIsIFNQSUNFX0NMSUVOVF9FUlJP
UiwgU1BJQ0VfQ0xJRU5UX0VSUk9SX0ZBSUxFRCwKPiA+IC0gICAgICAgICAgICAgICAgICAgICJD
b3VsZCBub3Qgb3BlbiB1c2IgZGV2aWNlOiAlcyBbJWldIiwKPiA+IC0gICAgICAgICAgICAgICAg
ICAgIGxpYnVzYl9lcnJvcl9uYW1lKHJjKSwgcmMpOwo+ID4gLSAgICAgICAgcmV0dXJuIEZBTFNF
Owo+ID4gLSAgICB9Cj4gPiAtCj4gPiAtICAgIHByaXYtPmNhdGNoX2Vycm9yID0gZXJyOwo+ID4g
LSAgICBzdGF0dXMgPSB1c2JyZWRpcmhvc3Rfc2V0X2RldmljZShwcml2LT5ob3N0LCBoYW5kbGUp
Owo+ID4gLSAgICBwcml2LT5jYXRjaF9lcnJvciA9IE5VTEw7Cj4gPiAtICAgIGlmIChzdGF0dXMg
IT0gdXNiX3JlZGlyX3N1Y2Nlc3MpIHsKPiA+IC0gICAgICAgIGdfcmV0dXJuX3ZhbF9pZl9mYWls
KGVyciA9PSBOVUxMIHx8ICplcnIgIT0gTlVMTCwgRkFMU0UpOwo+ID4gKyAgICBpZiAoIXNwaWNl
X3VzYl9iYWNrZW5kX2NoYW5uZWxfYXR0YWNoKHByaXYtPmhvc3QsIHByaXYtPmRldmljZSwgZXJy
KSkgewo+ID4gKyAgICAgICAgaWYgKCplcnIgPT0gTlVMTCkgewo+ID4gKyAgICAgICAgICAgIGdf
c2V0X2Vycm9yKGVyciwgU1BJQ0VfQ0xJRU5UX0VSUk9SLCBTUElDRV9DTElFTlRfRVJST1JfRkFJ
TEVELAo+ID4gKyAgICAgICAgICAgICAgICAiRXJyb3IgYXR0YWNoaW5nIGRldmljZTogKG5vIGVy
cm9yIGluZm9ybWF0aW9uKSIpOwo+ID4gKyAgICAgICAgfQo+ID4gICAgICAgICAgcmV0dXJuIEZB
TFNFOwo+ID4gICAgICB9Cj4gPgo+ID4gQEAgLTMxMCw3ICsyODEsNyBAQCBzdGF0aWMgZ2Jvb2xl
YW4gc3BpY2VfdXNicmVkaXJfY2hhbm5lbF9vcGVuX2RldmljZSgKPiA+Cj4gPiAgICAgIHByaXYt
PnVzYl9kZXZpY2VfbWFuYWdlciA9IGdfb2JqZWN0X3JlZihtYW5hZ2VyKTsKPiA+ICAgICAgaWYg
KCFzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfc3RhcnRfZXZlbnRfbGlzdGVuaW5nKHByaXYtPnVz
Yl9kZXZpY2VfbWFuYWdlciwgZXJyKSkgewo+ID4gLSAgICAgICAgdXNicmVkaXJob3N0X3NldF9k
ZXZpY2UocHJpdi0+aG9zdCwgTlVMTCk7Cj4gPiArICAgICAgICBzcGljZV91c2JfYmFja2VuZF9j
aGFubmVsX2RldGFjaChwcml2LT5ob3N0KTsKPiA+ICAgICAgICAgIHJldHVybiBGQUxTRTsKPiA+
ICAgICAgfQo+ID4KPiA+IEBAIC0zNDEsOCArMzEyLDcgQEAgc3RhdGljIHZvaWQgc3BpY2VfdXNi
cmVkaXJfY2hhbm5lbF9vcGVuX2FjbF9jYigKPiA+ICAgICAgICAgIHNwaWNlX3VzYnJlZGlyX2No
YW5uZWxfb3Blbl9kZXZpY2UoY2hhbm5lbCwgJmVycik7Cj4gPiAgICAgIH0KPiA+ICAgICAgaWYg
KGVycikgewo+ID4gLSAgICAgICAgbGlidXNiX3VucmVmX2RldmljZShwcml2LT5kZXZpY2UpOwo+
ID4gLSAgICAgICAgcHJpdi0+ZGV2aWNlID0gTlVMTDsKPiA+ICsgICAgICAgIGdfY2xlYXJfcG9p
bnRlcigmcHJpdi0+ZGV2aWNlLCBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfdW5yZWYpOwo+ID4g
ICAgICAgICAgZ19ib3hlZF9mcmVlKHNwaWNlX3VzYl9kZXZpY2VfZ2V0X3R5cGUoKSwgcHJpdi0+
c3BpY2VfZGV2aWNlKTsKPiA+ICAgICAgICAgIHByaXYtPnNwaWNlX2RldmljZSA9IE5VTEw7Cj4g
PiAgICAgICAgICBwcml2LT5zdGF0ZSAgPSBTVEFURV9ESVNDT05ORUNURUQ7Cj4gPiBAQCAtMzcz
LDggKzM0Myw3IEBAIF9vcGVuX2RldmljZV9hc3luY19jYihHVGFzayAqdGFzaywKPiA+ICAgICAg
c3BpY2VfdXNicmVkaXJfY2hhbm5lbF9sb2NrKGNoYW5uZWwpOwo+ID4KPiA+ICAgICAgaWYgKCFz
cGljZV91c2JyZWRpcl9jaGFubmVsX29wZW5fZGV2aWNlKGNoYW5uZWwsICZlcnIpKSB7Cj4gPiAt
ICAgICAgICBsaWJ1c2JfdW5yZWZfZGV2aWNlKHByaXYtPmRldmljZSk7Cj4gPiAtICAgICAgICBw
cml2LT5kZXZpY2UgPSBOVUxMOwo+ID4gKyAgICAgICAgZ19jbGVhcl9wb2ludGVyKCZwcml2LT5k
ZXZpY2UsIHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV91bnJlZik7Cj4gPiAgICAgICAgICBnX2Jv
eGVkX2ZyZWUoc3BpY2VfdXNiX2RldmljZV9nZXRfdHlwZSgpLCBwcml2LT5zcGljZV9kZXZpY2Up
Owo+ID4gICAgICAgICAgcHJpdi0+c3BpY2VfZGV2aWNlID0gTlVMTDsKPiA+ICAgICAgfQo+ID4g
QEAgLTM5MiwxMyArMzYxLDE2IEBAIF9vcGVuX2RldmljZV9hc3luY19jYihHVGFzayAqdGFzaywK
PiA+ICBHX0dOVUNfSU5URVJOQUwKPiA+ICB2b2lkIHNwaWNlX3VzYnJlZGlyX2NoYW5uZWxfY29u
bmVjdF9kZXZpY2VfYXN5bmMoCj4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgU3BpY2VVc2JyZWRpckNoYW5uZWwgKmNoYW5uZWwsCj4gPiAtICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlidXNiX2RldmljZSAgICAgICAgKmRldmlj
ZSwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTcGljZVVz
YkJhY2tlbmREZXZpY2UgKmRldmljZSwKPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBTcGljZVVzYkRldmljZSAgICAgICAqc3BpY2VfZGV2aWNlLAo+ID4gICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdDYW5jZWxsYWJsZSAgICAg
ICAgICpjYW5jZWxsYWJsZSwKPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBHQXN5bmNSZWFkeUNhbGxiYWNrICAgY2FsbGJhY2ssCj4gPiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3BvaW50ZXIgICAgICAgICAgICAgIHVzZXJf
ZGF0YSkKPiA+ICB7Cj4gPiAgICAgIFNwaWNlVXNicmVkaXJDaGFubmVsUHJpdmF0ZSAqcHJpdiA9
IGNoYW5uZWwtPnByaXY7Cj4gPiArI2lmZGVmIFVTRV9QT0xLSVQKPiA+ICsgICAgY29uc3QgVXNi
RGV2aWNlSW5mb3JtYXRpb24gKmluZm8gPSBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfZ2V0X2lu
Zm8oZGV2aWNlKTsKPiA+ICsjZW5kaWYKPiA+ICAgICAgR1Rhc2sgKnRhc2s7Cj4gPgo+ID4gICAg
ICBnX3JldHVybl9pZl9mYWlsKFNQSUNFX0lTX1VTQlJFRElSX0NIQU5ORUwoY2hhbm5lbCkpOwo+
ID4gQEAgLTQyNSw3ICszOTcsNyBAQCB2b2lkIHNwaWNlX3VzYnJlZGlyX2NoYW5uZWxfY29ubmVj
dF9kZXZpY2VfYXN5bmMoCj4gPiAgICAgICAgICBnb3RvIGRvbmU7Cj4gPiAgICAgIH0KPiA+Cj4g
PiAtICAgIHByaXYtPmRldmljZSA9IGxpYnVzYl9yZWZfZGV2aWNlKGRldmljZSk7Cj4gPiArICAg
IHByaXYtPmRldmljZSA9IHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9yZWYoZGV2aWNlKTsKPiA+
ICAgICAgcHJpdi0+c3BpY2VfZGV2aWNlID0gZ19ib3hlZF9jb3B5KHNwaWNlX3VzYl9kZXZpY2Vf
Z2V0X3R5cGUoKSwKPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNw
aWNlX2RldmljZSk7Cj4gPiAgI2lmZGVmIFVTRV9QT0xLSVQKPiA+IEBAIC00MzUsOCArNDA3LDgg
QEAgdm9pZCBzcGljZV91c2JyZWRpcl9jaGFubmVsX2Nvbm5lY3RfZGV2aWNlX2FzeW5jKAo+ID4g
ICAgICBnX29iamVjdF9zZXQoc3BpY2VfY2hhbm5lbF9nZXRfc2Vzc2lvbihTUElDRV9DSEFOTkVM
KGNoYW5uZWwpKSwKPiA+ICAgICAgICAgICAgICAgICAgICJpbmhpYml0LWtleWJvYXJkLWdyYWIi
LCBUUlVFLCBOVUxMKTsKPiA+ICAgICAgc3BpY2VfdXNiX2FjbF9oZWxwZXJfb3Blbl9hY2xfYXN5
bmMocHJpdi0+YWNsX2hlbHBlciwKPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgbGlidXNiX2dldF9idXNfbnVtYmVyKGRldmljZSksCj4gPiAtICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpYnVzYl9nZXRfZGV2aWNlX2FkZHJlc3MoZGV2
aWNlKSwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5mby0+
YnVzLAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmZvLT5h
ZGRyZXNzLAo+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYW5j
ZWxsYWJsZSwKPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Bp
Y2VfdXNicmVkaXJfY2hhbm5lbF9vcGVuX2FjbF9jYiwKPiA+ICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgY2hhbm5lbCk7Cj4gPiBAQCAtNDk0LDkgKzQ2Niw4IEBAIHZv
aWQgc3BpY2VfdXNicmVkaXJfY2hhbm5lbF9kaXNjb25uZWN0X2RldmljZShTcGljZVVzYnJlZGly
Q2hhbm5lbCAqY2hhbm5lbCkKPiA+ICAgICAgICAgIGdfY2xlYXJfb2JqZWN0KCZwcml2LT51c2Jf
ZGV2aWNlX21hbmFnZXIpOwo+ID4KPiA+ICAgICAgICAgIC8qIFRoaXMgYWxzbyBjbG9zZXMgdGhl
IGxpYnVzYiBoYW5kbGUgd2UgcGFzc2VkIGZyb20gb3Blbl9kZXZpY2UgKi8KPiA+IC0gICAgICAg
IHVzYnJlZGlyaG9zdF9zZXRfZGV2aWNlKHByaXYtPmhvc3QsIE5VTEwpOwo+ID4gLSAgICAgICAg
bGlidXNiX3VucmVmX2RldmljZShwcml2LT5kZXZpY2UpOwo+ID4gLSAgICAgICAgcHJpdi0+ZGV2
aWNlID0gTlVMTDsKPiA+ICsgICAgICAgIHNwaWNlX3VzYl9iYWNrZW5kX2NoYW5uZWxfZGV0YWNo
KHByaXYtPmhvc3QpOwo+ID4gKyAgICAgICAgZ19jbGVhcl9wb2ludGVyKCZwcml2LT5kZXZpY2Us
IHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV91bnJlZik7Cj4gPiAgICAgICAgICBnX2JveGVkX2Zy
ZWUoc3BpY2VfdXNiX2RldmljZV9nZXRfdHlwZSgpLCBwcml2LT5zcGljZV9kZXZpY2UpOwo+ID4g
ICAgICAgICAgcHJpdi0+c3BpY2VfZGV2aWNlID0gTlVMTDsKPiA+ICAgICAgICAgIHByaXYtPnN0
YXRlICA9IFNUQVRFX0RJU0NPTk5FQ1RFRDsKPiA+IEBAIC01NDcsNyArNTE4LDcgQEAgc3BpY2Vf
dXNicmVkaXJfY2hhbm5lbF9nZXRfc3BpY2VfdXNiX2RldmljZShTcGljZVVzYnJlZGlyQ2hhbm5l
bCAqY2hhbm5lbCkKPiA+ICAjZW5kaWYKPiA+Cj4gPiAgR19HTlVDX0lOVEVSTkFMCj4gPiAtbGli
dXNiX2RldmljZSAqc3BpY2VfdXNicmVkaXJfY2hhbm5lbF9nZXRfZGV2aWNlKFNwaWNlVXNicmVk
aXJDaGFubmVsICpjaGFubmVsKQo+ID4gK1NwaWNlVXNiQmFja2VuZERldmljZSAqc3BpY2VfdXNi
cmVkaXJfY2hhbm5lbF9nZXRfZGV2aWNlKFNwaWNlVXNicmVkaXJDaGFubmVsICpjaGFubmVsKQo+
ID4gIHsKPiA+ICAgICAgcmV0dXJuIGNoYW5uZWwtPnByaXYtPmRldmljZTsKPiA+ICB9Cj4gPiBA
QCAtNTYyLDgzICs1MzMsMjQgQEAgdm9pZCBzcGljZV91c2JyZWRpcl9jaGFubmVsX2dldF9ndWVz
dF9maWx0ZXIoCj4gPgo+ID4gICAgICBnX3JldHVybl9pZl9mYWlsKHByaXYtPmhvc3QgIT0gTlVM
TCk7Cj4gPgo+ID4gLSAgICB1c2JyZWRpcmhvc3RfZ2V0X2d1ZXN0X2ZpbHRlcihwcml2LT5ob3N0
LCBydWxlc19yZXQsIHJ1bGVzX2NvdW50X3JldCk7Cj4gPiArICAgIHNwaWNlX3VzYl9iYWNrZW5k
X2NoYW5uZWxfZ2V0X2d1ZXN0X2ZpbHRlcihwcml2LT5ob3N0LCBydWxlc19yZXQsIHJ1bGVzX2Nv
dW50X3JldCk7Cj4gPiAgfQo+ID4KPiA+ICAvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi8KPiA+ICAvKiBjYWxsYmFj
a3MgKGFueSBjb250ZXh0KSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgKi8KPiA+Cj4gPiAtc3RhdGljIHVpbnQ2NF90IHVzYnJlZGlyX2J1ZmZlcmVkX291dHB1dF9z
aXplX2NhbGxiYWNrKHZvaWQgKnVzZXJfZGF0YSkKPiA+ICtzdGF0aWMgdWludDY0X3QgdXNicmVk
aXJfZ2V0X3F1ZXVlX3NpemUodm9pZCAqdXNlcl9kYXRhKQo+ID4gIHsKPiA+ICAgICAgZ19yZXR1
cm5fdmFsX2lmX2ZhaWwoU1BJQ0VfSVNfVVNCUkVESVJfQ0hBTk5FTCh1c2VyX2RhdGEpLCAwKTsK
PiA+ICAgICAgcmV0dXJuIHNwaWNlX2NoYW5uZWxfZ2V0X3F1ZXVlX3NpemUoU1BJQ0VfQ0hBTk5F
TCh1c2VyX2RhdGEpKTsKPiA+ICB9Cj4gPgo+ID4gLS8qIE5vdGUgdGhhdCB0aGlzIGZ1bmN0aW9u
IG11c3QgYmUgcmUtZW50cmFudCBzYWZlLCBhcyBpdCBjYW4gZ2V0IGNhbGxlZAo+ID4gLSAgIGZy
b20gYm90aCB0aGUgbWFpbiB0aHJlYWQgYXMgd2VsbCBhcyBmcm9tIHRoZSB1c2IgZXZlbnQgaGFu
ZGxpbmcgdGhyZWFkICovCj4gPiAtc3RhdGljIHZvaWQgdXNicmVkaXJfd3JpdGVfZmx1c2hfY2Fs
bGJhY2sodm9pZCAqdXNlcl9kYXRhKQo+ID4gK3N0YXRpYyBnYm9vbGVhbiB1c2JyZWRpcl9pc19j
aGFubmVsX3JlYWR5KHZvaWQgKnVzZXJfZGF0YSkKPiA+ICB7Cj4gPiAgICAgIFNwaWNlVXNicmVk
aXJDaGFubmVsICpjaGFubmVsID0gU1BJQ0VfVVNCUkVESVJfQ0hBTk5FTCh1c2VyX2RhdGEpOwo+
ID4gICAgICBTcGljZVVzYnJlZGlyQ2hhbm5lbFByaXZhdGUgKnByaXYgPSBjaGFubmVsLT5wcml2
Owo+ID4gLQo+ID4gLSAgICBpZiAoc3BpY2VfY2hhbm5lbF9nZXRfc3RhdGUoU1BJQ0VfQ0hBTk5F
TChjaGFubmVsKSkgIT0KPiA+IC0gICAgICAgICAgICBTUElDRV9DSEFOTkVMX1NUQVRFX1JFQURZ
KQo+ID4gLSAgICAgICAgcmV0dXJuOwo+ID4gLQo+ID4gLSAgICBpZiAoIXByaXYtPmhvc3QpCj4g
PiAtICAgICAgICByZXR1cm47Cj4gPiAtCj4gPiAtICAgIHVzYnJlZGlyaG9zdF93cml0ZV9ndWVz
dF9kYXRhKHByaXYtPmhvc3QpOwo+ID4gLX0KPiA+IC0KPiA+IC1zdGF0aWMgdm9pZCB1c2JyZWRp
cl9sb2codm9pZCAqdXNlcl9kYXRhLCBpbnQgbGV2ZWwsIGNvbnN0IGNoYXIgKm1zZykKPiA+IC17
Cj4gPiAtICAgIFNwaWNlVXNicmVkaXJDaGFubmVsICpjaGFubmVsID0gdXNlcl9kYXRhOwo+ID4g
LSAgICBTcGljZVVzYnJlZGlyQ2hhbm5lbFByaXZhdGUgKnByaXYgPSBjaGFubmVsLT5wcml2Owo+
ID4gLQo+ID4gLSAgICBpZiAocHJpdi0+Y2F0Y2hfZXJyb3IgJiYgbGV2ZWwgPT0gdXNicmVkaXJw
YXJzZXJfZXJyb3IpIHsKPiA+IC0gICAgICAgIENIQU5ORUxfREVCVUcoY2hhbm5lbCwgIiVzIiwg
bXNnKTsKPiA+IC0gICAgICAgIC8qIFJlbW92ZSAidXNicmVkaXJob3N0OiAiIHByZWZpeCBmcm9t
IHVzYnJlZGlyaG9zdCBtZXNzYWdlcyAqLwo+ID4gLSAgICAgICAgaWYgKHN0cm5jbXAobXNnLCAi
dXNicmVkaXJob3N0OiAiLCAxNCkgPT0gMCkKPiA+IC0gICAgICAgICAgICBnX3NldF9lcnJvcl9s
aXRlcmFsKHByaXYtPmNhdGNoX2Vycm9yLCBTUElDRV9DTElFTlRfRVJST1IsCj4gPiAtICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBTUElDRV9DTElFTlRfRVJST1JfRkFJTEVELCBtc2cg
KyAxNCk7Cj4gPiAtICAgICAgICBlbHNlCj4gPiAtICAgICAgICAgICAgZ19zZXRfZXJyb3JfbGl0
ZXJhbChwcml2LT5jYXRjaF9lcnJvciwgU1BJQ0VfQ0xJRU5UX0VSUk9SLAo+ID4gLSAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgU1BJQ0VfQ0xJRU5UX0VSUk9SX0ZBSUxFRCwgbXNnKTsK
PiA+IC0gICAgICAgIHJldHVybjsKPiA+IC0gICAgfQo+ID4gLQo+ID4gLSAgICBzd2l0Y2ggKGxl
dmVsKSB7Cj4gPiAtICAgICAgICBjYXNlIHVzYnJlZGlycGFyc2VyX2Vycm9yOgo+ID4gLSAgICAg
ICAgICAgIGdfY3JpdGljYWwoIiVzIiwgbXNnKTsKPiA+IC0gICAgICAgICAgICBicmVhazsKPiA+
IC0gICAgICAgIGNhc2UgdXNicmVkaXJwYXJzZXJfd2FybmluZzoKPiA+IC0gICAgICAgICAgICBn
X3dhcm5pbmcoIiVzIiwgbXNnKTsKPiA+IC0gICAgICAgICAgICBicmVhazsKPiA+IC0gICAgICAg
IGRlZmF1bHQ6Cj4gPiAtICAgICAgICAgICAgQ0hBTk5FTF9ERUJVRyhjaGFubmVsLCAiJXMiLCBt
c2cpOwo+ID4gLSAgICB9Cj4gPiAtfQo+ID4gLQo+ID4gLXN0YXRpYyBpbnQgdXNicmVkaXJfcmVh
ZF9jYWxsYmFjayh2b2lkICp1c2VyX2RhdGEsIHVpbnQ4X3QgKmRhdGEsIGludCBjb3VudCkKPiA+
IC17Cj4gPiAtICAgIFNwaWNlVXNicmVkaXJDaGFubmVsICpjaGFubmVsID0gdXNlcl9kYXRhOwo+
ID4gLSAgICBTcGljZVVzYnJlZGlyQ2hhbm5lbFByaXZhdGUgKnByaXYgPSBjaGFubmVsLT5wcml2
Owo+ID4gLQo+ID4gLSAgICBjb3VudCA9IE1JTihwcml2LT5yZWFkX2J1Zl9zaXplLCBjb3VudCk7
Cj4gPiAtCj4gPiAtICAgIGlmIChjb3VudCAhPSAwKSB7Cj4gPiAtICAgICAgICBtZW1jcHkoZGF0
YSwgcHJpdi0+cmVhZF9idWYsIGNvdW50KTsKPiA+IC0gICAgfQo+ID4gLQo+ID4gLSAgICBwcml2
LT5yZWFkX2J1Zl9zaXplIC09IGNvdW50Owo+ID4gLSAgICBpZiAocHJpdi0+cmVhZF9idWZfc2l6
ZSkgewo+ID4gLSAgICAgICAgcHJpdi0+cmVhZF9idWYgKz0gY291bnQ7Cj4gPiAtICAgIH0gZWxz
ZSB7Cj4gPiAtICAgICAgICBwcml2LT5yZWFkX2J1ZiA9IE5VTEw7Cj4gPiAtICAgIH0KPiA+IC0K
PiA+IC0gICAgcmV0dXJuIGNvdW50Owo+ID4gKyAgICByZXR1cm4gcHJpdi0+aG9zdCAhPSBOVUxM
ICYmCj4gPiArICAgICAgICAgICBzcGljZV9jaGFubmVsX2dldF9zdGF0ZShTUElDRV9DSEFOTkVM
KGNoYW5uZWwpKSA9PSBTUElDRV9DSEFOTkVMX1NUQVRFX1JFQURZOwo+ID4gIH0KPiA+Cj4gPiAg
c3RhdGljIHZvaWQgdXNicmVkaXJfZnJlZV93cml0ZV9jYl9kYXRhKHVpbnQ4X3QgKmRhdGEsIHZv
aWQgKnVzZXJfZGF0YSkKPiA+IEBAIC02NDYsNyArNTU4LDcgQEAgc3RhdGljIHZvaWQgdXNicmVk
aXJfZnJlZV93cml0ZV9jYl9kYXRhKHVpbnQ4X3QgKmRhdGEsIHZvaWQgKnVzZXJfZGF0YSkKPiA+
ICAgICAgU3BpY2VVc2JyZWRpckNoYW5uZWwgKmNoYW5uZWwgPSB1c2VyX2RhdGE7Cj4gPiAgICAg
IFNwaWNlVXNicmVkaXJDaGFubmVsUHJpdmF0ZSAqcHJpdiA9IGNoYW5uZWwtPnByaXY7Cj4gPgo+
ID4gLSAgICB1c2JyZWRpcmhvc3RfZnJlZV93cml0ZV9idWZmZXIocHJpdi0+aG9zdCwgZGF0YSk7
Cj4gPiArICAgIHNwaWNlX3VzYl9iYWNrZW5kX3JldHVybl93cml0ZV9kYXRhKHByaXYtPmhvc3Qs
IGRhdGEpOwo+ID4gIH0KPiA+Cj4gPiAgI2lmZGVmIFVTRV9MWjQKPiA+IEBAIC03MTgsNyArNjMw
LDcgQEAgc3RhdGljIGludCB1c2JyZWRpcl93cml0ZV9jYWxsYmFjayh2b2lkICp1c2VyX2RhdGEs
IHVpbnQ4X3QgKmRhdGEsIGludCBjb3VudCkKPiA+Cj4gPiAgI2lmZGVmIFVTRV9MWjQKPiA+ICAg
ICAgaWYgKHRyeV93cml0ZV9jb21wcmVzc19MWjQoY2hhbm5lbCwgZGF0YSwgY291bnQpKSB7Cj4g
PiAtICAgICAgICB1c2JyZWRpcmhvc3RfZnJlZV93cml0ZV9idWZmZXIoY2hhbm5lbC0+cHJpdi0+
aG9zdCwgZGF0YSk7Cj4gPiArICAgICAgICBzcGljZV91c2JfYmFja2VuZF9yZXR1cm5fd3JpdGVf
ZGF0YShjaGFubmVsLT5wcml2LT5ob3N0LCBkYXRhKTsKPiA+ICAgICAgICAgIHJldHVybiBjb3Vu
dDsKPiA+ICAgICAgfQo+ID4gICNlbmRpZgo+ID4gQEAgLTczMSwxNSArNjQzLDYgQEAgc3RhdGlj
IGludCB1c2JyZWRpcl93cml0ZV9jYWxsYmFjayh2b2lkICp1c2VyX2RhdGEsIHVpbnQ4X3QgKmRh
dGEsIGludCBjb3VudCkKPiA+ICAgICAgcmV0dXJuIGNvdW50Owo+ID4gIH0KPiA+Cj4gPiAtc3Rh
dGljIHZvaWQgKnVzYnJlZGlyX2FsbG9jX2xvY2sodm9pZCkgewo+ID4gLSAgICBHTXV0ZXggKm11
dGV4Owo+ID4gLQo+ID4gLSAgICBtdXRleCA9IGdfbmV3MChHTXV0ZXgsIDEpOwo+ID4gLSAgICBn
X211dGV4X2luaXQobXV0ZXgpOwo+ID4gLQo+ID4gLSAgICByZXR1cm4gbXV0ZXg7Cj4gPiAtfQo+
ID4gLQo+ID4gIEdfR05VQ19JTlRFUk5BTAo+ID4gIHZvaWQgc3BpY2VfdXNicmVkaXJfY2hhbm5l
bF9sb2NrKFNwaWNlVXNicmVkaXJDaGFubmVsICpjaGFubmVsKQo+ID4gIHsKPiA+IEBAIC03NTIs
MjUgKzY1NSw2IEBAIHZvaWQgc3BpY2VfdXNicmVkaXJfY2hhbm5lbF91bmxvY2soU3BpY2VVc2Jy
ZWRpckNoYW5uZWwgKmNoYW5uZWwpCj4gPiAgICAgIGdfbXV0ZXhfdW5sb2NrKCZjaGFubmVsLT5w
cml2LT5kZXZpY2VfY29ubmVjdF9tdXRleCk7Cj4gPiAgfQo+ID4KPiA+IC1zdGF0aWMgdm9pZCB1
c2JyZWRpcl9sb2NrX2xvY2sodm9pZCAqdXNlcl9kYXRhKSB7Cj4gPiAtICAgIEdNdXRleCAqbXV0
ZXggPSB1c2VyX2RhdGE7Cj4gPiAtCj4gPiAtICAgIGdfbXV0ZXhfbG9jayhtdXRleCk7Cj4gPiAt
fQo+ID4gLQo+ID4gLXN0YXRpYyB2b2lkIHVzYnJlZGlyX3VubG9ja19sb2NrKHZvaWQgKnVzZXJf
ZGF0YSkgewo+ID4gLSAgICBHTXV0ZXggKm11dGV4ID0gdXNlcl9kYXRhOwo+ID4gLQo+ID4gLSAg
ICBnX211dGV4X3VubG9jayhtdXRleCk7Cj4gPiAtfQo+ID4gLQo+ID4gLXN0YXRpYyB2b2lkIHVz
YnJlZGlyX2ZyZWVfbG9jayh2b2lkICp1c2VyX2RhdGEpIHsKPiA+IC0gICAgR011dGV4ICptdXRl
eCA9IHVzZXJfZGF0YTsKPiA+IC0KPiA+IC0gICAgZ19tdXRleF9jbGVhcihtdXRleCk7Cj4gPiAt
ICAgIGdfZnJlZShtdXRleCk7Cj4gPiAtfQo+ID4gLQo+ID4gIC8qIC0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqLwo+
ID4KPiA+ICB0eXBlZGVmIHN0cnVjdCBkZXZpY2VfZXJyb3JfZGF0YSB7Cj4gPiBAQCAtODA5LDcg
KzY5Myw3IEBAIHN0YXRpYyB2b2lkIHNwaWNlX3VzYnJlZGlyX2NoYW5uZWxfdXAoU3BpY2VDaGFu
bmVsICpjKQo+ID4KPiA+ICAgICAgZ19yZXR1cm5faWZfZmFpbChwcml2LT5ob3N0ICE9IE5VTEwp
Owo+ID4gICAgICAvKiBGbHVzaCBhbnkgcGVuZGluZyB3cml0ZXMgKi8KPiA+IC0gICAgdXNicmVk
aXJob3N0X3dyaXRlX2d1ZXN0X2RhdGEocHJpdi0+aG9zdCk7Cj4gPiArICAgIHNwaWNlX3VzYl9i
YWNrZW5kX2NoYW5uZWxfdXAocHJpdi0+aG9zdCk7Cj4gPiAgfQo+ID4KPiA+ICBzdGF0aWMgaW50
IHRyeV9oYW5kbGVfY29tcHJlc3NlZF9tc2coU3BpY2VNc2dDb21wcmVzc2VkRGF0YSAqY29tcHJl
c3NlZF9kYXRhX21zZywKPiA+IEBAIC04NTksMjYgKzc0MywyMCBAQCBzdGF0aWMgdm9pZCB1c2Jy
ZWRpcl9oYW5kbGVfbXNnKFNwaWNlQ2hhbm5lbCAqYywgU3BpY2VNc2dJbiAqaW4pCj4gPgo+ID4g
ICAgICBnX3JldHVybl9pZl9mYWlsKHByaXYtPmhvc3QgIT0gTlVMTCk7Cj4gPgo+ID4gLSAgICAv
KiBObyByZWN1cnNpb24gYWxsb3dlZCEgKi8KPiA+IC0gICAgZ19yZXR1cm5faWZfZmFpbChwcml2
LT5yZWFkX2J1ZiA9PSBOVUxMKTsKPiA+IC0KPiA+ICAgICAgaWYgKHNwaWNlX21zZ19pbl90eXBl
KGluKSA9PSBTUElDRV9NU0dfU1BJQ0VWTUNfQ09NUFJFU1NFRF9EQVRBKSB7Cj4gPiAgICAgICAg
ICBTcGljZU1zZ0NvbXByZXNzZWREYXRhICpjb21wcmVzc2VkX2RhdGFfbXNnID0gc3BpY2VfbXNn
X2luX3BhcnNlZChpbik7Cj4gPiAgICAgICAgICBpZiAodHJ5X2hhbmRsZV9jb21wcmVzc2VkX21z
Zyhjb21wcmVzc2VkX2RhdGFfbXNnLCAmYnVmLCAmc2l6ZSkpIHsKPiA+IC0gICAgICAgICAgICBw
cml2LT5yZWFkX2J1Zl9zaXplID0gc2l6ZTsKPiA+IC0gICAgICAgICAgICBwcml2LT5yZWFkX2J1
ZiA9IGJ1ZjsKPiA+ICsgICAgICAgICAgICAvKiB1bmNvbXByZXNzZWQgb2sqLwo+ID4gICAgICAg
ICAgfSBlbHNlIHsKPiA+IC0gICAgICAgICAgICByID0gdXNicmVkaXJob3N0X3JlYWRfcGFyc2Vf
ZXJyb3I7Cj4gPiArICAgICAgICAgICAgciA9IFVTQl9SRURJUl9FUlJPUl9SRUFEX1BBUlNFOwo+
ID4gICAgICAgICAgfQo+ID4gICAgICB9IGVsc2UgeyAvKiBSZWd1bGFyIFNQSUNFX01TR19TUElD
RVZNQ19EQVRBIG1zZyAqLwo+ID4gICAgICAgICAgYnVmID0gc3BpY2VfbXNnX2luX3Jhdyhpbiwg
JnNpemUpOwo+ID4gLSAgICAgICAgcHJpdi0+cmVhZF9idWZfc2l6ZSA9IHNpemU7Cj4gPiAtICAg
ICAgICBwcml2LT5yZWFkX2J1ZiA9IGJ1ZjsKPiA+ICAgICAgfQo+ID4KPiA+ICAgICAgc3BpY2Vf
dXNicmVkaXJfY2hhbm5lbF9sb2NrKGNoYW5uZWwpOwo+ID4gICAgICBpZiAociA9PSAwKQo+ID4g
LSAgICAgICAgciA9IHVzYnJlZGlyaG9zdF9yZWFkX2d1ZXN0X2RhdGEocHJpdi0+aG9zdCk7Cj4g
PiArICAgICAgICByID0gc3BpY2VfdXNiX2JhY2tlbmRfcHJvdmlkZV9yZWFkX2RhdGEocHJpdi0+
aG9zdCwgYnVmLCBzaXplKTsKPiA+ICAgICAgaWYgKHIgIT0gMCkgewo+ID4gICAgICAgICAgU3Bp
Y2VVc2JEZXZpY2UgKnNwaWNlX2RldmljZSA9IHByaXYtPnNwaWNlX2RldmljZTsKPiA+ICAgICAg
ICAgIGRldmljZV9lcnJvcl9kYXRhIGVycl9kYXRhOwo+ID4gQEAgLTg5MiwxNiArNzcwLDE2IEBA
IHN0YXRpYyB2b2lkIHVzYnJlZGlyX2hhbmRsZV9tc2coU3BpY2VDaGFubmVsICpjLCBTcGljZU1z
Z0luICppbikKPiA+Cj4gPiAgICAgICAgICBkZXNjID0gc3BpY2VfdXNiX2RldmljZV9nZXRfZGVz
Y3JpcHRpb24oc3BpY2VfZGV2aWNlLCBOVUxMKTsKPiA+ICAgICAgICAgIHN3aXRjaCAocikgewo+
ID4gLSAgICAgICAgY2FzZSB1c2JyZWRpcmhvc3RfcmVhZF9wYXJzZV9lcnJvcjoKPiA+ICsgICAg
ICAgIGNhc2UgVVNCX1JFRElSX0VSUk9SX1JFQURfUEFSU0U6Cj4gPiAgICAgICAgICAgICAgZXJy
ID0gZ19lcnJvcl9uZXcoU1BJQ0VfQ0xJRU5UX0VSUk9SLCBTUElDRV9DTElFTlRfRVJST1JfRkFJ
TEVELAo+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF8oInVzYnJlZGlyIHByb3Rv
Y29sIHBhcnNlIGVycm9yIGZvciAlcyIpLCBkZXNjKTsKPiA+ICAgICAgICAgICAgICBicmVhazsK
PiA+IC0gICAgICAgIGNhc2UgdXNicmVkaXJob3N0X3JlYWRfZGV2aWNlX3JlamVjdGVkOgo+ID4g
KyAgICAgICAgY2FzZSBVU0JfUkVESVJfRVJST1JfREVWX1JFSkVDVEVEOgo+ID4gICAgICAgICAg
ICAgIGVyciA9IGdfZXJyb3JfbmV3KFNQSUNFX0NMSUVOVF9FUlJPUiwKPiA+ICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBTUElDRV9DTElFTlRfRVJST1JfVVNCX0RFVklDRV9SRUpFQ1RF
RCwKPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfKCIlcyByZWplY3RlZCBieSBo
b3N0IiksIGRlc2MpOwo+ID4gICAgICAgICAgICAgIGJyZWFrOwo+ID4gLSAgICAgICAgY2FzZSB1
c2JyZWRpcmhvc3RfcmVhZF9kZXZpY2VfbG9zdDoKPiA+ICsgICAgICAgIGNhc2UgVVNCX1JFRElS
X0VSUk9SX0RFVl9MT1NUOgo+ID4gICAgICAgICAgICAgIGVyciA9IGdfZXJyb3JfbmV3KFNQSUNF
X0NMSUVOVF9FUlJPUiwKPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTUElDRV9D
TElFTlRfRVJST1JfVVNCX0RFVklDRV9MT1NULAo+ID4gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIF8oIiVzIGRpc2Nvbm5lY3RlZCAoZmF0YWwgSU8gZXJyb3IpIiksIGRlc2MpOwo+ID4g
ZGlmZiAtLWdpdCBhL3NyYy9tZXNvbi5idWlsZCBiL3NyYy9tZXNvbi5idWlsZAo+ID4gaW5kZXgg
NTM2NWYwNS4uYTUxZDBhOSAxMDA2NDQKPiA+IC0tLSBhL3NyYy9tZXNvbi5idWlsZAo+ID4gKysr
IGIvc3JjL21lc29uLmJ1aWxkCj4gPiBAQCAtMTIxLDYgKzEyMSw4IEBAIHNwaWNlX2NsaWVudF9n
bGliX3NvdXJjZXMgPSBbCj4gPiAgICAndXNiLWRldmljZS1tYW5hZ2VyLXByaXYuaCcsCj4gPiAg
ICAndXNidXRpbC5jJywKPiA+ICAgICd1c2J1dGlsLmgnLAo+ID4gKyAgJ3VzYi1iYWNrZW5kLmMn
LAo+ID4gKyAgJ3VzYi1iYWNrZW5kLmgnLAo+ID4gICAgJ3ZtY3N0cmVhbS5jJywKPiA+ICAgICd2
bWNzdHJlYW0uaCcsCj4gPiAgXQo+ID4gZGlmZiAtLWdpdCBhL3NyYy91c2ItYmFja2VuZC5jIGIv
c3JjL3VzYi1iYWNrZW5kLmMKPiA+IG5ldyBmaWxlIG1vZGUgMTAwNjQ0Cj4gPiBpbmRleCAwMDAw
MDAwLi42NzVlYjYyCj4gPiAtLS0gL2Rldi9udWxsCj4gPiArKysgYi9zcmMvdXNiLWJhY2tlbmQu
Ywo+ID4gQEAgLTAsMCArMSw2MjIgQEAKPiA+ICsvKiAtKi0gTW9kZTogQzsgYy1iYXNpYy1vZmZz
ZXQ6IDQ7IGluZGVudC10YWJzLW1vZGU6IG5pbCAtKi0gKi8KPiA+ICsvKgo+ID4gKyAgICBDb3B5
cmlnaHQgKEMpIDIwMTItMjAxOCBSZWQgSGF0LCBJbmMuCj4gPiArCj4gPiArICAgIFJlZCBIYXQg
QXV0aG9yczoKPiA+ICsgICAgWXVyaSBCZW5kaXRvdmljaDx5YmVuZGl0b0ByZWRoYXQuY29tPgo+
ID4gKyAgICBIYW5zIGRlIEdvZWRlIDxoZGVnb2VkZUByZWRoYXQuY29tPgo+ID4gKwo+ID4gKyAg
ICBUaGlzIGxpYnJhcnkgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQg
YW5kL29yCj4gPiArICAgIG1vZGlmeSBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBMZXNz
ZXIgR2VuZXJhbCBQdWJsaWMKPiA+ICsgICAgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkgdGhlIEZy
ZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyCj4gPiArICAgIHZlcnNpb24gMi4xIG9mIHRo
ZSBMaWNlbnNlLCBvciAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgo+ID4gKwo+
ID4gKyAgICBUaGlzIGxpYnJhcnkgaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3
aWxsIGJlIHVzZWZ1bCwKPiA+ICsgICAgYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0
IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKPiA+ICsgICAgTUVSQ0hBTlRBQklMSVRZIG9y
IEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZSBHTlUKPiA+ICsgICAg
TGVzc2VyIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KPiA+ICsKPiA+
ICsgICAgWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIExlc3NlciBH
ZW5lcmFsIFB1YmxpYwo+ID4gKyAgICBMaWNlbnNlIGFsb25nIHdpdGggdGhpcyBsaWJyYXJ5OyBp
ZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCj4gPiArKi8KPiA+ICsK
PiA+ICsjaW5jbHVkZSAiY29uZmlnLmgiCj4gPiArCj4gPiArI2lmZGVmIFVTRV9VU0JSRURJUgo+
ID4gKwo+ID4gKyNpbmNsdWRlIDxnbGliLW9iamVjdC5oPgo+ID4gKyNpbmNsdWRlIDxpbnR0eXBl
cy5oPgo+ID4gKyNpbmNsdWRlIDxnaW8vZ2lvLmg+Cj4gPiArI2luY2x1ZGUgPGVycm5vLmg+Cj4g
PiArI2luY2x1ZGUgPGxpYnVzYi5oPgo+ID4gKyNpbmNsdWRlIDxzdHJpbmcuaD4KPiA+ICsjaW5j
bHVkZSA8ZmNudGwuaD4KPiA+ICsjaW5jbHVkZSAidXNicmVkaXJob3N0LmgiCj4gPiArI2luY2x1
ZGUgInVzYnJlZGlycGFyc2VyLmgiCj4gPiArI2luY2x1ZGUgInNwaWNlLXV0aWwuaCIKPiA+ICsj
aW5jbHVkZSAidXNiLWJhY2tlbmQuaCIKPiA+ICsKPiA+ICsvLyNkZWZpbmUgTE9VRF9ERUJVRyBT
UElDRV9ERUJVRwo+ID4gKyNkZWZpbmUgTE9VRF9ERUJVRyh4LCAuLi4pCj4gPiArCj4gPiArc3Ry
dWN0IF9TcGljZVVzYkJhY2tlbmREZXZpY2UKPiA+ICt7Cj4gPiArICAgIGxpYnVzYl9kZXZpY2Ug
KmxpYnVzYl9kZXZpY2U7Cj4gPiArICAgIGdpbnQgcmVmX2NvdW50Owo+ID4gKyAgICBTcGljZVVz
YkJhY2tlbmRDaGFubmVsICphdHRhY2hlZF90bzsKPiA+ICsgICAgVXNiRGV2aWNlSW5mb3JtYXRp
b24gZGV2aWNlX2luZm87Cj4gPiArfTsKPiA+ICsKPiA+ICtzdHJ1Y3QgX1NwaWNlVXNiQmFja2Vu
ZAo+ID4gK3sKPiA+ICsgICAgbGlidXNiX2NvbnRleHQgKmxpYnVzYl9jb250ZXh0Owo+ID4gKyAg
ICB1c2JfaG90X3BsdWdfY2FsbGJhY2sgaG90cGx1Z19jYWxsYmFjazsKPiA+ICsgICAgdm9pZCAq
aG90cGx1Z191c2VyX2RhdGE7Cj4gPiArICAgIGxpYnVzYl9ob3RwbHVnX2NhbGxiYWNrX2hhbmRs
ZSBob3RwbHVnX2hhbmRsZTsKPiA+ICt9Owo+ID4gKwo+ID4gK3N0cnVjdCBfU3BpY2VVc2JCYWNr
ZW5kQ2hhbm5lbAo+ID4gK3sKPiA+ICsgICAgc3RydWN0IHVzYnJlZGlyaG9zdCAqdXNicmVkaXJo
b3N0Owo+ID4gKyAgICB1aW50OF90ICpyZWFkX2J1ZjsKPiA+ICsgICAgaW50IHJlYWRfYnVmX3Np
emU7Cj4gPiArICAgIHN0cnVjdCB1c2JyZWRpcmZpbHRlcl9ydWxlICpydWxlczsKPiA+ICsgICAg
aW50IHJ1bGVzX2NvdW50Owo+ID4gKyAgICBTcGljZVVzYkJhY2tlbmREZXZpY2UgKmF0dGFjaGVk
Owo+ID4gKyAgICBTcGljZVVzYkJhY2tlbmRDaGFubmVsSW5pdERhdGEgY2hhbm5lbF9kYXRhOwo+
ID4gKyAgICBHRXJyb3IgKiplcnJvcjsKPiA+ICt9Owo+ID4gKwo+ID4gKy8vIGxvY2sgZnVuY3Rp
b25zIGZvciB1c2JyZWRpcmhvc3QgYW5kIHVzYnJlZGlycGFyc2VyCj4gPiArc3RhdGljIHZvaWQg
KnVzYnJlZGlyX2FsbG9jX2xvY2sodm9pZCkgewo+ID4gKyAgICBHTXV0ZXggKm11dGV4Owo+ID4g
Kwo+ID4gKyAgICBtdXRleCA9IGdfbmV3MChHTXV0ZXgsIDEpOwo+ID4gKyAgICBnX211dGV4X2lu
aXQobXV0ZXgpOwo+ID4gKwo+ID4gKyAgICByZXR1cm4gbXV0ZXg7Cj4gPiArfQo+ID4gKwo+ID4g
K3N0YXRpYyB2b2lkIHVzYnJlZGlyX2ZyZWVfbG9jayh2b2lkICp1c2VyX2RhdGEpIHsKPiA+ICsg
ICAgR011dGV4ICptdXRleCA9IHVzZXJfZGF0YTsKPiA+ICsKPiA+ICsgICAgZ19tdXRleF9jbGVh
cihtdXRleCk7Cj4gPiArICAgIGdfZnJlZShtdXRleCk7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRp
YyB2b2lkIHVzYnJlZGlyX2xvY2tfbG9jayh2b2lkICp1c2VyX2RhdGEpIHsKPiA+ICsgICAgR011
dGV4ICptdXRleCA9IHVzZXJfZGF0YTsKPiA+ICsKPiA+ICsgICAgZ19tdXRleF9sb2NrKG11dGV4
KTsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIHZvaWQgdXNicmVkaXJfdW5sb2NrX2xvY2sodm9p
ZCAqdXNlcl9kYXRhKSB7Cj4gPiArICAgIEdNdXRleCAqbXV0ZXggPSB1c2VyX2RhdGE7Cj4gPiAr
Cj4gPiArICAgIGdfbXV0ZXhfdW5sb2NrKG11dGV4KTsKPiA+ICt9Cj4gPiArCj4gPiArZ2Jvb2xl
YW4gc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX2lzb2NoKFNwaWNlVXNiQmFja2VuZERldmljZSAq
ZGV2KQo+ID4gK3sKPiA+ICsgICAgbGlidXNiX2RldmljZSAqbGliZGV2ID0gZGV2LT5saWJ1c2Jf
ZGV2aWNlOwo+ID4gKyAgICBzdHJ1Y3QgbGlidXNiX2NvbmZpZ19kZXNjcmlwdG9yICpjb25mX2Rl
c2M7Cj4gPiArICAgIGdib29sZWFuIGlzb2NfZm91bmQgPSBGQUxTRTsKPiA+ICsgICAgZ2ludCBp
LCBqLCBrOwo+ID4gKwo+ID4gKyAgICBnX3JldHVybl92YWxfaWZfZmFpbChsaWJkZXYgIT0gTlVM
TCwgMCk7Cj4gPiArCj4gPiArICAgIGlmIChsaWJ1c2JfZ2V0X2FjdGl2ZV9jb25maWdfZGVzY3Jp
cHRvcihsaWJkZXYsICZjb25mX2Rlc2MpICE9IDApIHsKPiA+ICsgICAgICAgIGdfcmV0dXJuX3Zh
bF9pZl9yZWFjaGVkKDApOwo+ID4gKyAgICB9Cj4gPiArCj4gPiArICAgIGZvciAoaSA9IDA7ICFp
c29jX2ZvdW5kICYmIGkgPCBjb25mX2Rlc2MtPmJOdW1JbnRlcmZhY2VzOyBpKyspIHsKPiA+ICsg
ICAgICAgIGZvciAoaiA9IDA7ICFpc29jX2ZvdW5kICYmIGogPCBjb25mX2Rlc2MtPmludGVyZmFj
ZVtpXS5udW1fYWx0c2V0dGluZzsgaisrKSB7Cj4gPiArICAgICAgICAgICAgZm9yIChrID0gMDsg
IWlzb2NfZm91bmQgJiYgayA8IGNvbmZfZGVzYy0+aW50ZXJmYWNlW2ldLmFsdHNldHRpbmdbal0u
Yk51bUVuZHBvaW50cztrKyspIHsKPiA+ICsgICAgICAgICAgICAgICAgZ2ludCBhdHRyaWJ1dGVz
ID0gY29uZl9kZXNjLT5pbnRlcmZhY2VbaV0uYWx0c2V0dGluZ1tqXS5lbmRwb2ludFtrXS5ibUF0
dHJpYnV0ZXM7Cj4gPiArICAgICAgICAgICAgICAgIGdpbnQgdHlwZSA9IGF0dHJpYnV0ZXMgJiBM
SUJVU0JfVFJBTlNGRVJfVFlQRV9NQVNLOwo+ID4gKyAgICAgICAgICAgICAgICBpZiAodHlwZSA9
PSBMSUJVU0JfVFJBTlNGRVJfVFlQRV9JU09DSFJPTk9VUykKPiA+ICsgICAgICAgICAgICAgICAg
ICAgIGlzb2NfZm91bmQgPSBUUlVFOwo+ID4gKyAgICAgICAgICAgIH0KPiA+ICsgICAgICAgIH0K
PiA+ICsgICAgfQo+ID4gKwo+ID4gKyAgICBsaWJ1c2JfZnJlZV9jb25maWdfZGVzY3JpcHRvcihj
b25mX2Rlc2MpOwo+ID4gKyAgICByZXR1cm4gaXNvY19mb3VuZDsKPiA+ICt9Cj4gPiArCj4gPiAr
c3RhdGljIGdib29sZWFuIGZpbGxfdXNiX2luZm8oU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpiZGV2
KQo+ID4gK3sKPiA+ICsgICAgVXNiRGV2aWNlSW5mb3JtYXRpb24gKmluZm8gPSAmYmRldi0+ZGV2
aWNlX2luZm87Cj4gPiArCj4gPiArICAgIHN0cnVjdCBsaWJ1c2JfZGV2aWNlX2Rlc2NyaXB0b3Ig
ZGVzYzsKPiA+ICsgICAgbGlidXNiX2RldmljZSAqbGliZGV2ID0gYmRldi0+bGlidXNiX2Rldmlj
ZTsKPiA+ICsgICAgbGlidXNiX2dldF9kZXZpY2VfZGVzY3JpcHRvcihsaWJkZXYsICZkZXNjKTsK
PiA+ICsgICAgaW5mby0+YnVzID0gbGlidXNiX2dldF9idXNfbnVtYmVyKGxpYmRldik7Cj4gPiAr
ICAgIGluZm8tPmFkZHJlc3MgPSBsaWJ1c2JfZ2V0X2RldmljZV9hZGRyZXNzKGxpYmRldik7Cj4g
PiArICAgIGlmIChpbmZvLT5hZGRyZXNzID09IDB4ZmYgfHwgLyogcm9vdCBodWIgKEhDRCkgKi8K
PiA+ICsgICAgICAgIGluZm8tPmFkZHJlc3MgPD0gMSB8fCAvKiByb290IGh1YiBvciBiYWQgYWRk
cmVzcyAqLwo+ID4gKyAgICAgICAgKGRlc2MuYkRldmljZUNsYXNzID09IExJQlVTQl9DTEFTU19I
VUIpIC8qaHViKi8pIHsKPiA+ICsgICAgICAgIHJldHVybiBGQUxTRTsKPiA+ICsgICAgfQo+ID4g
Kwo+ID4gKyAgICBpbmZvLT52aWQgPSBkZXNjLmlkVmVuZG9yOwo+ID4gKyAgICBpbmZvLT5waWQg
PSBkZXNjLmlkUHJvZHVjdDsKPiA+ICsgICAgaW5mby0+Y2xhc3MgPSBkZXNjLmJEZXZpY2VDbGFz
czsKPiA+ICsgICAgaW5mby0+c3ViY2xhc3MgPSBkZXNjLmJEZXZpY2VTdWJDbGFzczsKPiA+ICsg
ICAgaW5mby0+cHJvdG9jb2wgPSBkZXNjLmJEZXZpY2VQcm90b2NvbDsKPiA+ICsKPiA+ICsgICAg
cmV0dXJuIFRSVUU7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyBTcGljZVVzYkJhY2tlbmREZXZp
Y2UgKmFsbG9jYXRlX2JhY2tlbmRfZGV2aWNlKGxpYnVzYl9kZXZpY2UgKmxpYmRldikKPiA+ICt7
Cj4gPiArICAgIFNwaWNlVXNiQmFja2VuZERldmljZSAqZGV2ID0gZ19uZXcwKFNwaWNlVXNiQmFj
a2VuZERldmljZSwgMSk7Cj4gPiArICAgIGRldi0+cmVmX2NvdW50ID0gMTsKPiA+ICsgICAgZGV2
LT5saWJ1c2JfZGV2aWNlID0gbGliZGV2Owo+ID4gKyAgICBpZiAoIWZpbGxfdXNiX2luZm8oZGV2
KSkgewo+ID4gKyAgICAgICAgZ19mcmVlKGRldik7Cj4gPiArICAgICAgICBkZXYgPSBOVUxMOwo+
ID4gKyAgICB9Cj4gPiArICAgIHJldHVybiBkZXY7Cj4gPiArfQo+ID4gKwo+ID4gKy8qIE5vdGUg
dGhhdCB0aGlzIGZ1bmN0aW9uIG11c3QgYmUgcmUtZW50cmFudCBzYWZlLCBhcyBpdCBjYW4gZ2V0
IGNhbGxlZAo+ID4gK2Zyb20gYm90aCB0aGUgbWFpbiB0aHJlYWQgYXMgd2VsbCBhcyBmcm9tIHRo
ZSB1c2IgZXZlbnQgaGFuZGxpbmcgdGhyZWFkICovCj4gPiArc3RhdGljIHZvaWQgdXNicmVkaXJf
d3JpdGVfZmx1c2hfY2FsbGJhY2sodm9pZCAqdXNlcl9kYXRhKQo+ID4gK3sKPiA+ICsgICAgU3Bp
Y2VVc2JCYWNrZW5kQ2hhbm5lbCAqY2ggPSB1c2VyX2RhdGE7Cj4gPiArICAgIGdib29sZWFuIG9r
ID0gY2gtPmNoYW5uZWxfZGF0YS5pc19jaGFubmVsX3JlYWR5KGNoLT5jaGFubmVsX2RhdGEudXNl
cl9kYXRhKTsKPiA+ICsgICAgaWYgKG9rICYmIGNoLT51c2JyZWRpcmhvc3QpIHsKPiA+ICsgICAg
ICAgIFNQSUNFX0RFQlVHKCIlcyBjaCAlcCAtPiB1c2JyZWRpcmhvc3QiLCBfX0ZVTkNUSU9OX18s
IGNoKTsKPiA+ICsgICAgICAgIHVzYnJlZGlyaG9zdF93cml0ZV9ndWVzdF9kYXRhKGNoLT51c2Jy
ZWRpcmhvc3QpOwo+ID4gKyAgICB9IGVsc2Ugewo+ID4gKyAgICAgICAgU1BJQ0VfREVCVUcoIiVz
IGNoICVwIChub3QgcmVhZHkpIiwgX19GVU5DVElPTl9fLCBjaCk7Cj4gPiArICAgIH0KPiA+ICt9
Cj4gPiArCj4gPiArU3BpY2VVc2JCYWNrZW5kICpzcGljZV91c2JfYmFja2VuZF9uZXcoR0Vycm9y
ICoqZXJyb3IpCj4gPiArewo+ID4gKyAgICBpbnQgcmM7Cj4gPiArICAgIFNwaWNlVXNiQmFja2Vu
ZCAqYmU7Cj4gPiArICAgIFNQSUNFX0RFQlVHKCIlcyA+PiIsIF9fRlVOQ1RJT05fXyk7Cj4gPiAr
ICAgIGJlID0gKFNwaWNlVXNiQmFja2VuZCAqKWdfbmV3MChTcGljZVVzYkJhY2tlbmQsIDEpOwo+
ID4gKyAgICByYyA9IGxpYnVzYl9pbml0KCZiZS0+bGlidXNiX2NvbnRleHQpOwo+ID4gKyAgICBp
ZiAocmMgPCAwKSB7Cj4gPiArICAgICAgICBjb25zdCBjaGFyICpkZXNjID0gbGlidXNiX2Vycm9y
X25hbWUocmMpOwo+ID4gKyAgICAgICAgZ193YXJuaW5nKCJFcnJvciBpbml0aWFsaXppbmcgTElC
VVNCIHN1cHBvcnQ6ICVzIFslaV0iLCBkZXNjLCByYyk7Cj4gPiArICAgICAgICBnX3NldF9lcnJv
cihlcnJvciwgU1BJQ0VfQ0xJRU5UX0VSUk9SLCBTUElDRV9DTElFTlRfRVJST1JfRkFJTEVELAo+
ID4gKyAgICAgICAgICAgICJFcnJvciBpbml0aWFsaXppbmcgTElCVVNCIHN1cHBvcnQ6ICVzIFsl
aV0iLCBkZXNjLCByYyk7Cj4gPiArICAgICAgICBnX2ZyZWUoYmUpOwo+ID4gKyAgICAgICAgYmUg
PSBOVUxMOwo+ID4gKyAgICB9IGVsc2Ugewo+ID4gKyNpZmRlZiBHX09TX1dJTjMyCj4gPiArI2lm
IExJQlVTQl9BUElfVkVSU0lPTiA+PSAweDAxMDAwMTA2Cj4gPiArICAgIGxpYnVzYl9zZXRfb3B0
aW9uKGJlLT5saWJ1c2JfY29udGV4dCwgTElCVVNCX09QVElPTl9VU0VfVVNCREspOwo+ID4gKyNl
bmRpZgo+ID4gKyNlbmRpZgo+ID4gKyAgICB9Cj4gPiArICAgIFNQSUNFX0RFQlVHKCIlcyA8PCIs
IF9fRlVOQ1RJT05fXyk7Cj4gPiArICAgIHJldHVybiBiZTsKPiA+ICt9Cj4gPiArCj4gPiArZ2Jv
b2xlYW4gc3BpY2VfdXNiX2JhY2tlbmRfaGFuZGxlX2V2ZW50cyhTcGljZVVzYkJhY2tlbmQgKmJl
KQo+ID4gK3sKPiA+ICsgICAgU1BJQ0VfREVCVUcoIiVzID4+IiwgX19GVU5DVElPTl9fKTsKPiA+
ICsgICAgZ2Jvb2xlYW4gb2sgPSBGQUxTRTsKPiA+ICsgICAgaWYgKGJlLT5saWJ1c2JfY29udGV4
dCkgewo+ID4gKyAgICAgICAgaW50IHJlcyA9IGxpYnVzYl9oYW5kbGVfZXZlbnRzKGJlLT5saWJ1
c2JfY29udGV4dCk7Cj4gPiArICAgICAgICBvayA9IHJlcyA9PSAwOwo+ID4gKyAgICAgICAgaWYg
KHJlcyAmJiByZXMgIT0gTElCVVNCX0VSUk9SX0lOVEVSUlVQVEVEKSB7Cj4gPiArICAgICAgICAg
ICAgY29uc3QgY2hhciAqZGVzYyA9IGxpYnVzYl9lcnJvcl9uYW1lKHJlcyk7Cj4gPiArICAgICAg
ICAgICAgZ193YXJuaW5nKCJFcnJvciBoYW5kbGluZyBVU0IgZXZlbnRzOiAlcyBbJWldIiwgZGVz
YywgcmVzKTsKPiA+ICsgICAgICAgICAgICBvayA9IEZBTFNFOwo+ID4gKyAgICAgICAgfQo+ID4g
KyAgICB9Cj4gPiArICAgIFNQSUNFX0RFQlVHKCIlcyA8PCAlZCIsIF9fRlVOQ1RJT05fXywgb2sp
Owo+ID4gKyAgICByZXR1cm4gb2s7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyBpbnQgTElCVVNC
X0NBTEwgaG90cGx1Z19jYWxsYmFjayhsaWJ1c2JfY29udGV4dCAqY3R4LAo+ID4gKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWJ1c2JfZGV2aWNlICpkZXZpY2UsCj4g
PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpYnVzYl9ob3RwbHVn
X2V2ZW50IGV2ZW50LAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICB2b2lkICp1c2VyX2RhdGEpCj4gPiArewo+ID4gKyAgICBTcGljZVVzYkJhY2tlbmQgKmJlID0g
KFNwaWNlVXNiQmFja2VuZCAqKXVzZXJfZGF0YTsKPiA+ICsgICAgaWYgKGJlLT5ob3RwbHVnX2Nh
bGxiYWNrKSB7Cj4gPiArICAgICAgICBTcGljZVVzYkJhY2tlbmREZXZpY2UgKmRldjsKPiA+ICsg
ICAgICAgIGdib29sZWFuIHZhbCA9IGV2ZW50ID09IExJQlVTQl9IT1RQTFVHX0VWRU5UX0RFVklD
RV9BUlJJVkVEOwo+ID4gKyAgICAgICAgZGV2ID0gYWxsb2NhdGVfYmFja2VuZF9kZXZpY2UoZGV2
aWNlKTsKPiA+ICsgICAgICAgIGlmIChkZXYpIHsKPiA+ICsgICAgICAgICAgICBTUElDRV9ERUJV
RygiY3JlYXRlZCBkZXYgJXAsIHVzYmxpYiBkZXYgJXAiLCBkZXYsIGRldmljZSk7Cj4gPiArICAg
ICAgICAgICAgbGlidXNiX3JlZl9kZXZpY2UoZGV2aWNlKTsKPiA+ICsgICAgICAgICAgICBiZS0+
aG90cGx1Z19jYWxsYmFjayhiZS0+aG90cGx1Z191c2VyX2RhdGEsIGRldiwgdmFsKTsKPiA+ICsg
ICAgICAgICAgICBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfdW5yZWYoZGV2KTsKPiA+ICsgICAg
ICAgIH0KPiA+ICsgICAgfQo+ID4gKyAgICByZXR1cm4gMDsKPiA+ICt9Cj4gPiArCj4gPiArdm9p
ZCBzcGljZV91c2JfYmFja2VuZF9kZXJlZ2lzdGVyX2hvdHBsdWcoU3BpY2VVc2JCYWNrZW5kICpi
ZSkKPiA+ICt7Cj4gPiArICAgIGdfcmV0dXJuX2lmX2ZhaWwoYmUgIT0gTlVMTCk7Cj4gPiArICAg
IGlmIChiZS0+aG90cGx1Z19oYW5kbGUpIHsKPiA+ICsgICAgICAgIGxpYnVzYl9ob3RwbHVnX2Rl
cmVnaXN0ZXJfY2FsbGJhY2soYmUtPmxpYnVzYl9jb250ZXh0LCBiZS0+aG90cGx1Z19oYW5kbGUp
Owo+ID4gKyAgICAgICAgYmUtPmhvdHBsdWdfaGFuZGxlID0gMDsKPiA+ICsgICAgfQo+ID4gKyAg
ICBiZS0+aG90cGx1Z19jYWxsYmFjayA9IE5VTEw7Cj4gPiArfQo+ID4gKwo+ID4gK2dib29sZWFu
IHNwaWNlX3VzYl9iYWNrZW5kX3JlZ2lzdGVyX2hvdHBsdWcoU3BpY2VVc2JCYWNrZW5kICpiZSwK
PiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZvaWQgKnVz
ZXJfZGF0YSwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHVzYl9ob3RfcGx1Z19jYWxsYmFjayBwcm9jKQo+ID4gK3sKPiA+ICsgICAgaW50IHJjOwo+ID4g
KyAgICBnX3JldHVybl92YWxfaWZfZmFpbChiZSAhPSBOVUxMLCBGQUxTRSk7Cj4gPiArCj4gPiAr
ICAgIGJlLT5ob3RwbHVnX2NhbGxiYWNrID0gcHJvYzsKPiA+ICsgICAgYmUtPmhvdHBsdWdfdXNl
cl9kYXRhID0gdXNlcl9kYXRhOwo+ID4gKyAgICByYyA9IGxpYnVzYl9ob3RwbHVnX3JlZ2lzdGVy
X2NhbGxiYWNrKGJlLT5saWJ1c2JfY29udGV4dCwKPiA+ICsgICAgICAgIExJQlVTQl9IT1RQTFVH
X0VWRU5UX0RFVklDRV9BUlJJVkVEIHwgTElCVVNCX0hPVFBMVUdfRVZFTlRfREVWSUNFX0xFRlQs
Cj4gPiArICAgICAgICBMSUJVU0JfSE9UUExVR19FTlVNRVJBVEUsIExJQlVTQl9IT1RQTFVHX01B
VENIX0FOWSwKPiA+ICsgICAgICAgIExJQlVTQl9IT1RQTFVHX01BVENIX0FOWSwgTElCVVNCX0hP
VFBMVUdfTUFUQ0hfQU5ZLAo+ID4gKyAgICAgICAgaG90cGx1Z19jYWxsYmFjaywgYmUsICZiZS0+
aG90cGx1Z19oYW5kbGUpOwo+ID4gKyAgICBpZiAocmMgIT0gTElCVVNCX1NVQ0NFU1MpIHsKPiA+
ICsgICAgICAgIGNvbnN0IGNoYXIgKmRlc2MgPSBsaWJ1c2JfZXJyb3JfbmFtZShyYyk7Cj4gPiAr
ICAgICAgICBnX3dhcm5pbmcoIkVycm9yIGluaXRpYWxpemluZyBVU0IgaG90cGx1ZyBzdXBwb3J0
OiAlcyBbJWldIiwgZGVzYywgcmMpOwo+ID4gKyAgICAgICAgYmUtPmhvdHBsdWdfY2FsbGJhY2sg
PSBOVUxMOwo+ID4gKyAgICAgICAgcmV0dXJuIEZBTFNFOwo+ID4gKyAgICB9Cj4gPiArICAgIHJl
dHVybiBUUlVFOwo+ID4gK30KPiA+ICsKPiA+ICt2b2lkIHNwaWNlX3VzYl9iYWNrZW5kX2RlbGV0
ZShTcGljZVVzYkJhY2tlbmQgKmJlKQo+ID4gK3sKPiA+ICsgICAgZ19yZXR1cm5faWZfZmFpbChi
ZSAhPSBOVUxMKTsKPiA+ICsgICAgU1BJQ0VfREVCVUcoIiVzID4+IiwgX19GVU5DVElPTl9fKTsK
PiA+ICsgICAgaWYgKGJlLT5saWJ1c2JfY29udGV4dCkgewo+ID4gKyAgICAgICAgbGlidXNiX2V4
aXQoYmUtPmxpYnVzYl9jb250ZXh0KTsKPiA+ICsgICAgfQo+ID4gKyAgICBnX2ZyZWUoYmUpOwo+
ID4gKyAgICBTUElDRV9ERUJVRygiJXMgPDwiLCBfX0ZVTkNUSU9OX18pOwo+ID4gK30KPiA+ICsK
PiA+ICtTcGljZVVzYkJhY2tlbmREZXZpY2UgKipzcGljZV91c2JfYmFja2VuZF9nZXRfZGV2aWNl
X2xpc3QoU3BpY2VVc2JCYWNrZW5kICpiZSkKPiA+ICt7Cj4gPiArICAgIExPVURfREVCVUcoIiVz
ID4+IiwgX19GVU5DVElPTl9fKTsKPiA+ICsgICAgbGlidXNiX2RldmljZSAqKmRldmxpc3QgPSBO
VUxMLCAqKmRldjsKPiA+ICsgICAgU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpkLCAqKmxpc3Q7Cj4g
PiArCj4gPiArICAgIGludCBuID0gMCwgaW5kZXg7Cj4gPiArCj4gPiArICAgIGlmIChiZSAmJiBi
ZS0+bGlidXNiX2NvbnRleHQpIHsKPiA+ICsgICAgICAgIGxpYnVzYl9nZXRfZGV2aWNlX2xpc3Qo
YmUtPmxpYnVzYl9jb250ZXh0LCAmZGV2bGlzdCk7Cj4gPiArICAgIH0KPiA+ICsKPiA+ICsgICAg
Ly8gYWRkIGFsbCB0aGUgbGlidXNiIGRldmljZSB0aGF0IG5vdCBwcmVzZW50IGluIG91ciBsaXN0
Cj4gPiArICAgIGZvciAoZGV2ID0gZGV2bGlzdDsgZGV2ICYmICpkZXY7IGRldisrKSB7Cj4gPiAr
ICAgICAgICBuKys7Cj4gPiArICAgIH0KPiA+ICsKPiA+ICsgICAgbGlzdCA9IGdfbmV3MChTcGlj
ZVVzYkJhY2tlbmREZXZpY2UqLCBuICsgMSk7Cj4gPiArCj4gPiArICAgIGluZGV4ID0gMDsKPiA+
ICsKPiA+ICsgICAgZm9yIChkZXYgPSBkZXZsaXN0OyBkZXYgJiYgKmRldjsgZGV2KyspIHsKPiA+
ICsgICAgICAgIGQgPSBhbGxvY2F0ZV9iYWNrZW5kX2RldmljZSgqZGV2KTsKPiA+ICsgICAgICAg
IGlmICghZCkgewo+ID4gKyAgICAgICAgICAgIGxpYnVzYl91bnJlZl9kZXZpY2UoKmRldik7Cj4g
PiArICAgICAgICB9IGVsc2Ugewo+ID4gKyAgICAgICAgICAgIFNQSUNFX0RFQlVHKCJjcmVhdGVk
IGRldiAlcCwgdXNibGliIGRldiAlcCIsIGQsICpkZXYpOwo+ID4gKyAgICAgICAgICAgIGxpc3Rb
aW5kZXgrK10gPSBkOwo+ID4gKyAgICAgICAgfQo+ID4gKyAgICB9Cj4gPiArCj4gPiArICAgIGlm
IChkZXZsaXN0KSB7Cj4gPiArICAgICAgICBsaWJ1c2JfZnJlZV9kZXZpY2VfbGlzdChkZXZsaXN0
LCAwKTsKPiA+ICsgICAgfQo+ID4gKwo+ID4gKyAgICBMT1VEX0RFQlVHKCIlcyA8PCIsIF9fRlVO
Q1RJT05fXyk7Cj4gPiArICAgIHJldHVybiBsaXN0Owo+ID4gK30KPiA+ICsKPiA+ICtnYm9vbGVh
biBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfaXNfaHViKFNwaWNlVXNiQmFja2VuZERldmljZSAq
ZGV2KQo+ID4gK3sKPiA+ICsgICAgcmV0dXJuIGRldi0+ZGV2aWNlX2luZm8uY2xhc3MgPT0gTElC
VVNCX0NMQVNTX0hVQjsKPiA+ICt9Cj4gPiArCj4gPiArY29uc3QgVXNiRGV2aWNlSW5mb3JtYXRp
b24qIHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9nZXRfaW5mbyhTcGljZVVzYkJhY2tlbmREZXZp
Y2UgKmRldikKPiA+ICt7Cj4gPiArICAgIHJldHVybiAmZGV2LT5kZXZpY2VfaW5mbzsKPiA+ICt9
Cj4gPiArCj4gPiArZ2NvbnN0cG9pbnRlciBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfZ2V0X2xp
YmRldihTcGljZVVzYkJhY2tlbmREZXZpY2UgKmRldikKPiA+ICt7Cj4gPiArICAgIHJldHVybiBk
ZXYtPmxpYnVzYl9kZXZpY2U7Cj4gPiArfQo+ID4gKwo+ID4gK3ZvaWQgc3BpY2VfdXNiX2JhY2tl
bmRfZnJlZV9kZXZpY2VfbGlzdChTcGljZVVzYkJhY2tlbmREZXZpY2UgKipkZXZsaXN0KQo+ID4g
K3sKPiA+ICsgICAgTE9VRF9ERUJVRygiJXMgPj4iLCBfX0ZVTkNUSU9OX18pOwo+ID4gKyAgICBT
cGljZVVzYkJhY2tlbmREZXZpY2UgKipkZXY7Cj4gPiArICAgIGZvciAoZGV2ID0gZGV2bGlzdDsg
KmRldjsgZGV2KyspIHsKPiA+ICsgICAgICAgIFNwaWNlVXNiQmFja2VuZERldmljZSAqZCA9ICpk
ZXY7Cj4gPiArICAgICAgICBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfdW5yZWYoZCk7Cj4gPiAr
ICAgIH0KPiA+ICsgICAgZ19mcmVlKGRldmxpc3QpOwo+ID4gKyAgICBMT1VEX0RFQlVHKCIlcyA8
PCIsIF9fRlVOQ1RJT05fXyk7Cj4gPiArfQo+ID4gKwo+ID4gK1NwaWNlVXNiQmFja2VuZERldmlj
ZSAqc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX3JlZihTcGljZVVzYkJhY2tlbmREZXZpY2UgKmRl
dikKPiA+ICt7Cj4gPiArICAgIExPVURfREVCVUcoIiVzID4+ICVwIiwgX19GVU5DVElPTl9fLCBk
ZXYpOwo+ID4gKyAgICBnX2F0b21pY19pbnRfaW5jKCZkZXYtPnJlZl9jb3VudCk7Cj4gPiArICAg
IHJldHVybiBkZXY7Cj4gPiArfQo+ID4gKwo+ID4gK3ZvaWQgc3BpY2VfdXNiX2JhY2tlbmRfZGV2
aWNlX3VucmVmKFNwaWNlVXNiQmFja2VuZERldmljZSAqZGV2KQo+ID4gK3sKPiA+ICsgICAgTE9V
RF9ERUJVRygiJXMgPj4gJXAoJWQpIiwgX19GVU5DVElPTl9fLCBkZXYsIGRldi0+cmVmX2NvdW50
KTsKPiA+ICsgICAgaWYgKGdfYXRvbWljX2ludF9kZWNfYW5kX3Rlc3QoJmRldi0+cmVmX2NvdW50
KSkgewo+ID4gKyAgICAgICAgbGlidXNiX3VucmVmX2RldmljZShkZXYtPmxpYnVzYl9kZXZpY2Up
Owo+ID4gKyAgICAgICAgTE9VRF9ERUJVRygiJXMgZnJlZWluZyAlcCAobGlidXNiICVwKSIsIF9f
RlVOQ1RJT05fXywgZGV2LCBkZXYtPmxpYnVzYl9kZXZpY2UpOwo+ID4gKyAgICAgICAgZ19mcmVl
KGRldik7Cj4gPiArICAgIH0KPiA+ICt9Cj4gPiArCj4gPiAraW50IHNwaWNlX3VzYl9iYWNrZW5k
X2RldmljZV9jaGVja19maWx0ZXIoCj4gPiArICAgIFNwaWNlVXNiQmFja2VuZERldmljZSAqZGV2
LAo+ID4gKyAgICBjb25zdCBzdHJ1Y3QgdXNicmVkaXJmaWx0ZXJfcnVsZSAqcnVsZXMsCj4gPiAr
ICAgIGludCBjb3VudCkKPiA+ICt7Cj4gPiArICAgIHJldHVybiB1c2JyZWRpcmhvc3RfY2hlY2tf
ZGV2aWNlX2ZpbHRlcigKPiA+ICsgICAgICAgIHJ1bGVzLCBjb3VudCwgZGV2LT5saWJ1c2JfZGV2
aWNlLCAwKTsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIGludCB1c2JyZWRpcl9yZWFkX2NhbGxi
YWNrKHZvaWQgKnVzZXJfZGF0YSwgdWludDhfdCAqZGF0YSwgaW50IGNvdW50KQo+ID4gK3sKPiA+
ICsgICAgU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCAqY2ggPSB1c2VyX2RhdGE7Cj4gPiArCj4gPiAr
ICAgIGNvdW50ID0gTUlOKGNoLT5yZWFkX2J1Zl9zaXplLCBjb3VudCk7Cj4gPiArCj4gPiArICAg
IGlmIChjb3VudCAhPSAwKSB7Cj4gPiArICAgICAgICBtZW1jcHkoZGF0YSwgY2gtPnJlYWRfYnVm
LCBjb3VudCk7Cj4gPiArICAgIH0KPiA+ICsKPiA+ICsgICAgY2gtPnJlYWRfYnVmX3NpemUgLT0g
Y291bnQ7Cj4gPiArICAgIGlmIChjaC0+cmVhZF9idWZfc2l6ZSkgewo+ID4gKyAgICAgICAgY2gt
PnJlYWRfYnVmICs9IGNvdW50Owo+ID4gKyAgICB9Cj4gPiArICAgIGVsc2Ugewo+ID4gKyAgICAg
ICAgY2gtPnJlYWRfYnVmID0gTlVMTDsKPiA+ICsgICAgfQo+ID4gKyAgICBTUElDRV9ERUJVRygi
JXMgY2ggJXAsICVkIGJ5dGVzIiwgX19GVU5DVElPTl9fLCBjaCwgY291bnQpOwo+ID4gKwo+ID4g
KyAgICByZXR1cm4gY291bnQ7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyBjb25zdCBjaGFyICpz
dHJpcF91c2JyZWRpcl9wcmVmaXgoY29uc3QgY2hhciAqbXNnKQo+ID4gK3sKPiA+ICsgICAgaWYg
KHN0cm5jbXAobXNnLCAidXNicmVkaXJob3N0OiAiLCAxNCkgPT0gMCkgewo+ID4gKyAgICAgICAg
bXNnICs9IDE0Owo+ID4gKyAgICB9Cj4gPiArICAgIHJldHVybiBtc2c7Cj4gPiArfQo+ID4gKwo+
ID4gK3N0YXRpYyB2b2lkIGNoYW5uZWxfZXJyb3IoU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCAqY2gs
IGNvbnN0IGNoYXIgKm1zZykKPiA+ICt7Cj4gPiArICAgIGlmICghY2gtPmVycm9yKQo+ID4gKyAg
ICAgICAgcmV0dXJuOwo+ID4gKyAgICBnX3NldF9lcnJvcl9saXRlcmFsKGNoLT5lcnJvciwgU1BJ
Q0VfQ0xJRU5UX0VSUk9SLCBTUElDRV9DTElFTlRfRVJST1JfRkFJTEVELCBtc2cpOwo+ID4gKyAg
ICBjaC0+ZXJyb3IgPSBOVUxMOwo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgdm9pZCB1c2JyZWRp
cl9sb2codm9pZCAqdXNlcl9kYXRhLCBpbnQgbGV2ZWwsIGNvbnN0IGNoYXIgKm1zZykKPiA+ICt7
Cj4gPiArICAgIFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmNoID0gKFNwaWNlVXNiQmFja2VuZENo
YW5uZWwgKil1c2VyX2RhdGE7Cj4gPiArICAgIGNvbnN0IGNoYXIgKnN0cmlwcGVkX21zZyA9IHN0
cmlwX3VzYnJlZGlyX3ByZWZpeChtc2cpOwo+ID4gKyAgICBzd2l0Y2ggKGxldmVsKSB7Cj4gPiAr
ICAgIGNhc2UgdXNicmVkaXJwYXJzZXJfZXJyb3I6Cj4gPiArICAgICAgICBnX2NyaXRpY2FsKCIl
cyIsIG1zZyk7Cj4gPiArICAgICAgICBjaGFubmVsX2Vycm9yKGNoLCBzdHJpcHBlZF9tc2cpOwo+
ID4gKyAgICAgICAgYnJlYWs7Cj4gPiArICAgIGNhc2UgdXNicmVkaXJwYXJzZXJfd2FybmluZzoK
PiA+ICsgICAgICAgIGdfd2FybmluZygiJXMiLCBtc2cpOwo+ID4gKyAgICAgICAgY2hhbm5lbF9l
cnJvcihjaCwgc3RyaXBwZWRfbXNnKTsKPiA+ICsgICAgICAgIGJyZWFrOwo+ID4gKyAgICBkZWZh
dWx0Ogo+ID4gKyAgICAgICAgYnJlYWs7Cj4gPiArICAgIH0KPiA+ICt9Cj4gPiArCj4gPiArc3Rh
dGljIGludCB1c2JyZWRpcl93cml0ZV9jYWxsYmFjayh2b2lkICp1c2VyX2RhdGEsIHVpbnQ4X3Qg
KmRhdGEsIGludCBjb3VudCkKPiA+ICt7Cj4gPiArICAgIFNwaWNlVXNiQmFja2VuZENoYW5uZWwg
KmNoID0gdXNlcl9kYXRhOwo+ID4gKyAgICBpbnQgcmVzOwo+ID4gKyAgICBTUElDRV9ERUJVRygi
JXMgY2ggJXAsICVkIGJ5dGVzIiwgX19GVU5DVElPTl9fLCBjaCwgY291bnQpOwo+ID4gKyAgICBy
ZXMgPSBjaC0+Y2hhbm5lbF9kYXRhLndyaXRlX2NhbGxiYWNrKGNoLT5jaGFubmVsX2RhdGEudXNl
cl9kYXRhLCBkYXRhLCBjb3VudCk7Cj4gPiArICAgIHJldHVybiByZXM7Cj4gPiArfQo+ID4gKwo+
ID4gK3N0YXRpYyB1aW50NjRfdCB1c2JyZWRpcl9idWZmZXJlZF9vdXRwdXRfc2l6ZV9jYWxsYmFj
ayh2b2lkICp1c2VyX2RhdGEpCj4gPiArewo+ID4gKyAgICBTcGljZVVzYkJhY2tlbmRDaGFubmVs
ICpjaCA9IHVzZXJfZGF0YTsKPiA+ICsgICAgcmV0dXJuIGNoLT5jaGFubmVsX2RhdGEuZ2V0X3F1
ZXVlX3NpemUoY2gtPmNoYW5uZWxfZGF0YS51c2VyX2RhdGEpOwo+ID4gK30KPiA+ICsKPiA+ICtp
bnQgc3BpY2VfdXNiX2JhY2tlbmRfcHJvdmlkZV9yZWFkX2RhdGEoU3BpY2VVc2JCYWNrZW5kQ2hh
bm5lbCAqY2gsIHVpbnQ4X3QgKmRhdGEsIGludCBjb3VudCkKPiA+ICt7Cj4gPiArICAgIGludCBy
ZXMgPSAwOwo+ID4gKwo+ID4gKyAgICBnX3JldHVybl92YWxfaWZfZmFpbChjaC0+cmVhZF9idWYg
PT0gTlVMTCwgVVNCX1JFRElSX0VSUk9SX1JFQURfUEFSU0UpOwo+ID4gKwo+ID4gKyAgICBjaC0+
cmVhZF9idWYgPSBkYXRhOwo+ID4gKyAgICBjaC0+cmVhZF9idWZfc2l6ZSA9IGNvdW50Owo+ID4g
KyAgICBpZiAoY2gtPnVzYnJlZGlyaG9zdCkgewo+ID4gKyAgICAgICAgcmVzID0gdXNicmVkaXJo
b3N0X3JlYWRfZ3Vlc3RfZGF0YShjaC0+dXNicmVkaXJob3N0KTsKPiA+ICsgICAgfSBlbHNlIHsK
PiA+ICsgICAgICAgIHJlcyA9IFVTQl9SRURJUl9FUlJPUl9JTzsKPiA+ICsgICAgfQo+ID4gKyAg
ICBzd2l0Y2ggKHJlcykKPiA+ICsgICAgewo+ID4gKyAgICBjYXNlIHVzYnJlZGlyaG9zdF9yZWFk
X2lvX2Vycm9yOgo+ID4gKyAgICAgICAgcmVzID0gVVNCX1JFRElSX0VSUk9SX0lPOwo+ID4gKyAg
ICAgICAgYnJlYWs7Cj4gPiArICAgIGNhc2UgdXNicmVkaXJob3N0X3JlYWRfcGFyc2VfZXJyb3I6
Cj4gPiArICAgICAgICByZXMgPSBVU0JfUkVESVJfRVJST1JfUkVBRF9QQVJTRTsKPiA+ICsgICAg
ICAgIGJyZWFrOwo+ID4gKyAgICBjYXNlIHVzYnJlZGlyaG9zdF9yZWFkX2RldmljZV9yZWplY3Rl
ZDoKPiA+ICsgICAgICAgIHJlcyA9IFVTQl9SRURJUl9FUlJPUl9ERVZfUkVKRUNURUQ7Cj4gPiAr
ICAgICAgICBicmVhazsKPiA+ICsgICAgY2FzZSB1c2JyZWRpcmhvc3RfcmVhZF9kZXZpY2VfbG9z
dDoKPiA+ICsgICAgICAgIHJlcyA9IFVTQl9SRURJUl9FUlJPUl9ERVZfTE9TVDsKPiA+ICsgICAg
ICAgIGJyZWFrOwo+ID4gKyAgICB9Cj4gPiArICAgIFNQSUNFX0RFQlVHKCIlcyBjaCAlcCwgJWQg
Ynl0ZXMsIHJlcyAlZCIsIF9fRlVOQ1RJT05fXywgY2gsIGNvdW50LCByZXMpOwo+ID4gKwo+ID4g
KyAgICByZXR1cm4gcmVzOwo+ID4gK30KPiA+ICsKPiA+ICt2b2lkIHNwaWNlX3VzYl9iYWNrZW5k
X3JldHVybl93cml0ZV9kYXRhKFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmNoLCB2b2lkICpkYXRh
KQo+ID4gK3sKPiA+ICsgICAgaWYgKGNoLT51c2JyZWRpcmhvc3QpIHsKPiA+ICsgICAgICAgIFNQ
SUNFX0RFQlVHKCIlcyBjaCAlcCIsIF9fRlVOQ1RJT05fXywgY2gpOwo+ID4gKyAgICAgICAgdXNi
cmVkaXJob3N0X2ZyZWVfd3JpdGVfYnVmZmVyKGNoLT51c2JyZWRpcmhvc3QsIGRhdGEpOwo+ID4g
KyAgICB9IGVsc2Ugewo+ID4gKyAgICAgICAgU1BJQ0VfREVCVUcoIiVzIGNoICVwIC0gTk9CT0RZ
IFRPIENBTEwiLCBfX0ZVTkNUSU9OX18sIGNoKTsKPiA+ICsgICAgfQo+ID4gK30KPiA+ICsKPiA+
ICtnYm9vbGVhbiBzcGljZV91c2JfYmFja2VuZF9jaGFubmVsX2F0dGFjaChTcGljZVVzYkJhY2tl
bmRDaGFubmVsICpjaCwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBTcGljZVVzYkJhY2tlbmREZXZpY2UgKmRldiwKPiA+ICsgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBHRXJyb3IgKiplcnJvcikKPiA+ICt7Cj4gPiArICAgIFNQ
SUNFX0RFQlVHKCIlcyA+PiBjaCAlcCwgZGV2ICVwICh3YXMgYXR0YWNoZWQgJXApIiwgX19GVU5D
VElPTl9fLCBjaCwgZGV2LCBjaC0+YXR0YWNoZWQpOwo+ID4gKyAgICBnYm9vbGVhbiBvayA9IEZB
TFNFOwo+ID4gKyAgICBpZiAoIWRldikgewo+ID4gKyAgICAgICAgcmV0dXJuIG9rOwo+ID4gKyAg
ICB9Cj4gPiArCj4gPiArICAgIGxpYnVzYl9kZXZpY2VfaGFuZGxlICpoYW5kbGUgPSBOVUxMOwo+
ID4gKyAgICBpbnQgcmMgPSBsaWJ1c2Jfb3BlbihkZXYtPmxpYnVzYl9kZXZpY2UsICZoYW5kbGUp
Owo+ID4gKyAgICBvayA9IHJjID09IDA7Cj4gPiArICAgIGlmIChvaykgewo+ID4gKyAgICAgICAg
Y2gtPmVycm9yID0gZXJyb3I7Cj4gPiArICAgICAgICByYyA9IHVzYnJlZGlyaG9zdF9zZXRfZGV2
aWNlKGNoLT51c2JyZWRpcmhvc3QsIGhhbmRsZSk7Cj4gPiArICAgICAgICBpZiAocmMpIHsKPiA+
ICsgICAgICAgICAgICBTUElDRV9ERUJVRygiJXMgY2ggJXAsIGRldiAlcCB1c2JyZWRpcmhvc3Qg
ZXJyb3IgJWQiLCBfX0ZVTkNUSU9OX18sIGNoLCBkZXYsIHJjKTsKPiA+ICsgICAgICAgICAgICBv
ayA9IEZBTFNFOwo+ID4gKyAgICAgICAgfSBlbHNlIHsKPiA+ICsgICAgICAgICAgICBjaC0+YXR0
YWNoZWQgPSBkZXY7Cj4gPiArICAgICAgICAgICAgZGV2LT5hdHRhY2hlZF90byA9IGNoOwo+ID4g
KyAgICAgICAgfQo+ID4gKyAgICAgICAgY2gtPmVycm9yID0gTlVMTDsKPiA+ICsgICAgfSBlbHNl
IHsKPiA+ICsgICAgICAgIGNvbnN0IGNoYXIgKmRlc2MgPSBsaWJ1c2JfZXJyb3JfbmFtZShyYyk7
Cj4gPiArICAgICAgICBnX3NldF9lcnJvcihlcnJvciwgU1BJQ0VfQ0xJRU5UX0VSUk9SLCBTUElD
RV9DTElFTlRfRVJST1JfRkFJTEVELAo+ID4gKyAgICAgICAgICAgIkVycm9yIGxpYnVzYl9vcGVu
OiAlcyBbJWldIiwgZGVzYywgcmMpOwo+ID4gKyAgICB9Cj4gPiArCj4gPiArICAgIHJldHVybiBv
azsKPiA+ICt9Cj4gPiArCj4gPiArdm9pZCBzcGljZV91c2JfYmFja2VuZF9jaGFubmVsX2RldGFj
aChTcGljZVVzYkJhY2tlbmRDaGFubmVsICpjaCkKPiA+ICt7Cj4gPiArICAgIFNQSUNFX0RFQlVH
KCIlcyA+PiBjaCAlcCwgd2FzIGF0dGFjaGVkICVwIiwgX19GVU5DVElPTl9fLCBjaCwgY2gtPmF0
dGFjaGVkKTsKPiA+ICsgICAgaWYgKCFjaC0+YXR0YWNoZWQpIHsKPiA+ICsgICAgICAgIFNQSUNF
X0RFQlVHKCIlczogbm90aGluZyB0byBkZXRhY2giLCBfX0ZVTkNUSU9OX18pOwo+ID4gKyAgICAg
ICAgcmV0dXJuOwo+ID4gKyAgICB9Cj4gPiArICAgIGlmIChjaC0+dXNicmVkaXJob3N0KSB7Cj4g
PiArICAgICAgICAvLyBpdCB3aWxsIGNhbGwgbGlidXNiX2Nsb3NlIGludGVybmFsbHkKPiA+ICsg
ICAgICAgIHVzYnJlZGlyaG9zdF9zZXRfZGV2aWNlKGNoLT51c2JyZWRpcmhvc3QsIE5VTEwpOwo+
ID4gKyAgICB9Cj4gPiArICAgIFNQSUNFX0RFQlVHKCIlcyBjaCAlcCwgZGV0YWNoIGRvbmUiLCBf
X0ZVTkNUSU9OX18sIGNoKTsKPiA+ICsgICAgY2gtPmF0dGFjaGVkLT5hdHRhY2hlZF90byA9IE5V
TEw7Cj4gPiArICAgIGNoLT5hdHRhY2hlZCA9IE5VTEw7Cj4gPiArfQo+ID4gKwo+ID4gK1NwaWNl
VXNiQmFja2VuZENoYW5uZWwgKnNwaWNlX3VzYl9iYWNrZW5kX2NoYW5uZWxfbmV3KFNwaWNlVXNi
QmFja2VuZCAqYmUsCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgY29uc3QgU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbEluaXREYXRhICppbml0
X2RhdGEpCj4gPiArewo+ID4gKyAgICBTcGljZVVzYkJhY2tlbmRDaGFubmVsICpjaCA9IGdfbmV3
MChTcGljZVVzYkJhY2tlbmRDaGFubmVsLCAxKTsKPiA+ICsgICAgU1BJQ0VfREVCVUcoIiVzID4+
IiwgX19GVU5DVElPTl9fKTsKPiA+ICsgICAgY2gtPmNoYW5uZWxfZGF0YSA9ICppbml0X2RhdGE7
Cj4gPiArICAgIGlmIChiZS0+bGlidXNiX2NvbnRleHQpIHsKPiA+ICsgICAgICAgIGNoLT51c2Jy
ZWRpcmhvc3QgPSB1c2JyZWRpcmhvc3Rfb3Blbl9mdWxsKAo+ID4gKyAgICAgICAgICAgIGJlLT5s
aWJ1c2JfY29udGV4dCwKPiA+ICsgICAgICAgICAgICBOVUxMLAo+ID4gKyAgICAgICAgICAgIHVz
YnJlZGlyX2xvZywKPiA+ICsgICAgICAgICAgICB1c2JyZWRpcl9yZWFkX2NhbGxiYWNrLAo+ID4g
KyAgICAgICAgICAgIHVzYnJlZGlyX3dyaXRlX2NhbGxiYWNrLAo+ID4gKyAgICAgICAgICAgIHVz
YnJlZGlyX3dyaXRlX2ZsdXNoX2NhbGxiYWNrLAo+ID4gKyAgICAgICAgICAgIHVzYnJlZGlyX2Fs
bG9jX2xvY2ssCj4gPiArICAgICAgICAgICAgdXNicmVkaXJfbG9ja19sb2NrLAo+ID4gKyAgICAg
ICAgICAgIHVzYnJlZGlyX3VubG9ja19sb2NrLAo+ID4gKyAgICAgICAgICAgIHVzYnJlZGlyX2Zy
ZWVfbG9jaywKPiA+ICsgICAgICAgICAgICBjaCwgUEFDS0FHRV9TVFJJTkcsCj4gPiArICAgICAg
ICAgICAgc3BpY2VfdXRpbF9nZXRfZGVidWcoKSA/IHVzYnJlZGlycGFyc2VyX2RlYnVnIDogdXNi
cmVkaXJwYXJzZXJfd2FybmluZywKPiA+ICsgICAgICAgICAgICB1c2JyZWRpcmhvc3RfZmxfd3Jp
dGVfY2Jfb3duc19idWZmZXIpOwo+ID4gKyAgICAgICAgZ193YXJuX2lmX2ZhaWwoY2gtPnVzYnJl
ZGlyaG9zdCAhPSBOVUxMKTsKPiA+ICsgICAgfQo+ID4gKyAgICBpZiAoY2gtPnVzYnJlZGlyaG9z
dCkgewo+ID4gKyAgICAgICAgdXNicmVkaXJob3N0X3NldF9idWZmZXJlZF9vdXRwdXRfc2l6ZV9j
YihjaC0+dXNicmVkaXJob3N0LCB1c2JyZWRpcl9idWZmZXJlZF9vdXRwdXRfc2l6ZV9jYWxsYmFj
ayk7Cj4gPiArICAgIH0gZWxzZSB7Cj4gPiArICAgICAgICBnX2ZyZWUoY2gpOwo+ID4gKyAgICAg
ICAgY2ggPSBOVUxMOwo+ID4gKyAgICB9Cj4gPiArCj4gPiArICAgIFNQSUNFX0RFQlVHKCIlcyA8
PCAlcCIsIF9fRlVOQ1RJT05fXywgY2gpOwo+ID4gKyAgICByZXR1cm4gY2g7Cj4gPiArfQo+ID4g
Kwo+ID4gK3ZvaWQgc3BpY2VfdXNiX2JhY2tlbmRfY2hhbm5lbF91cChTcGljZVVzYkJhY2tlbmRD
aGFubmVsICpjaCkKPiA+ICt7Cj4gPiArICAgIFNQSUNFX0RFQlVHKCIlcyAlcCwgaG9zdCAlcCIs
IF9fRlVOQ1RJT05fXywgY2gsIGNoLT51c2JyZWRpcmhvc3QpOwo+ID4gKyAgICBpZiAoY2gtPnVz
YnJlZGlyaG9zdCkgewo+ID4gKyAgICAgICAgdXNicmVkaXJob3N0X3dyaXRlX2d1ZXN0X2RhdGEo
Y2gtPnVzYnJlZGlyaG9zdCk7Cj4gPiArICAgIH0KPiA+ICt9Cj4gPiArCj4gPiArdm9pZCBzcGlj
ZV91c2JfYmFja2VuZF9jaGFubmVsX2RlbGV0ZShTcGljZVVzYkJhY2tlbmRDaGFubmVsICpjaCkK
PiA+ICt7Cj4gPiArICAgIFNQSUNFX0RFQlVHKCIlcyA+PiAlcCIsIF9fRlVOQ1RJT05fXywgY2gp
Owo+ID4gKyAgICBpZiAoY2gtPnVzYnJlZGlyaG9zdCkgewo+ID4gKyAgICAgICAgdXNicmVkaXJo
b3N0X2Nsb3NlKGNoLT51c2JyZWRpcmhvc3QpOwo+ID4gKyAgICB9Cj4gPiArCj4gPiArICAgIGlm
IChjaC0+cnVsZXMpIHsKPiA+ICsgICAgICAgIGdfZnJlZShjaC0+cnVsZXMpOwo+ID4gKyAgICB9
Cj4gPiArCj4gPiArICAgIGdfZnJlZShjaCk7Cj4gPiArICAgIFNQSUNFX0RFQlVHKCIlcyA8PCAl
cCIsIF9fRlVOQ1RJT05fXywgY2gpOwo+ID4gK30KPiA+ICsKPiA+ICt2b2lkIHNwaWNlX3VzYl9i
YWNrZW5kX2NoYW5uZWxfZ2V0X2d1ZXN0X2ZpbHRlcigKPiA+ICsgICAgU3BpY2VVc2JCYWNrZW5k
Q2hhbm5lbCAqY2gsCj4gPiArICAgIGNvbnN0IHN0cnVjdCB1c2JyZWRpcmZpbHRlcl9ydWxlICoq
ciwKPiA+ICsgICAgaW50ICpjb3VudCkKPiA+ICt7Cj4gPiArICAgIGludCBpOwo+ID4gKyAgICAq
ciA9IE5VTEw7Cj4gPiArICAgICpjb3VudCA9IDA7Cj4gPiArICAgIGlmIChjaC0+dXNicmVkaXJo
b3N0KSB7Cj4gPiArICAgICAgICB1c2JyZWRpcmhvc3RfZ2V0X2d1ZXN0X2ZpbHRlcihjaC0+dXNi
cmVkaXJob3N0LCByLCBjb3VudCk7Cj4gPiArICAgIH0KPiA+ICsgICAgaWYgKCpyID09IE5VTEwp
IHsKPiA+ICsgICAgICAgICpyID0gY2gtPnJ1bGVzOwo+ID4gKyAgICAgICAgKmNvdW50ID0gY2gt
PnJ1bGVzX2NvdW50Owo+ID4gKyAgICB9Cj4gPiArCj4gPiArICAgIGlmICgqY291bnQpIHsKPiA+
ICsgICAgICAgIFNQSUNFX0RFQlVHKCIlcyBjaCAlcDogJWQgZmlsdGVycyIsIF9fRlVOQ1RJT05f
XywgY2gsICpjb3VudCk7Cj4gPiArICAgIH0KPiA+ICsgICAgZm9yIChpID0gMDsgaSA8ICpjb3Vu
dDsgaSsrKSB7Cj4gPiArICAgICAgICBjb25zdCBzdHJ1Y3QgdXNicmVkaXJmaWx0ZXJfcnVsZSAq
cmEgPSAqcjsKPiA+ICsgICAgICAgIFNQSUNFX0RFQlVHKCIlcyBjbGFzcyAlZCwgJVg6JVgiLAo+
ID4gKyAgICAgICAgICAgIHJhW2ldLmFsbG93ID8gImFsbG93ZWQiIDogImRlbmllZCIsIHJhW2ld
LmRldmljZV9jbGFzcywKPiA+ICsgICAgICAgICAgICAodWludDMyX3QpcmFbaV0udmVuZG9yX2lk
LCAodWludDMyX3QpcmFbaV0ucHJvZHVjdF9pZCk7Cj4gPiArICAgIH0KPiA+ICt9Cj4gPiArCj4g
PiArI2VuZGlmIC8vIFVTQl9SRURJUgo+ID4gZGlmZiAtLWdpdCBhL3NyYy91c2ItYmFja2VuZC5o
IGIvc3JjL3VzYi1iYWNrZW5kLmgKPiA+IG5ldyBmaWxlIG1vZGUgMTAwNjQ0Cj4gPiBpbmRleCAw
MDAwMDAwLi45MTM3OTE2Cj4gPiAtLS0gL2Rldi9udWxsCj4gPiArKysgYi9zcmMvdXNiLWJhY2tl
bmQuaAo+ID4gQEAgLTAsMCArMSwxMTAgQEAKPiA+ICsvKiAtKi0gTW9kZTogQzsgYy1iYXNpYy1v
ZmZzZXQ6IDQ7IGluZGVudC10YWJzLW1vZGU6IG5pbCAtKi0gKi8KPiA+ICsvKgo+ID4gKyAgICBD
b3B5cmlnaHQgKEMpIDIwMTggUmVkIEhhdCwgSW5jLgo+ID4gKwo+ID4gKyAgICBSZWQgSGF0IEF1
dGhvcnM6Cj4gPiArICAgIFl1cmkgQmVuZGl0b3ZpY2g8eWJlbmRpdG9AcmVkaGF0LmNvbT4KPiA+
ICsKPiA+ICsgICAgVGhpcyBsaWJyYXJ5IGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0
cmlidXRlIGl0IGFuZC9vcgo+ID4gKyAgICBtb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRo
ZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCj4gPiArICAgIExpY2Vuc2UgYXMgcHVibGlzaGVk
IGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlcgo+ID4gKyAgICB2ZXJzaW9u
IDIuMSBvZiB0aGUgTGljZW5zZSwgb3IgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lv
bi4KPiA+ICsKPiA+ICsgICAgVGhpcyBsaWJyYXJ5IGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3Bl
IHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCj4gPiArICAgIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5U
WTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCj4gPiArICAgIE1FUkNIQU5U
QUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUgR05V
Cj4gPiArICAgIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMu
Cj4gPiArCj4gPiArICAgIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdO
VSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKPiA+ICsgICAgTGljZW5zZSBhbG9uZyB3aXRoIHRoaXMg
bGlicmFyeTsgaWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+Lgo+ID4g
KyovCj4gPiArCj4gPiArI2lmbmRlZiBfX1NQSUNFX1VTQl9CQUNLRU5EX0hfXwo+ID4gKyNkZWZp
bmUgX19TUElDRV9VU0JfQkFDS0VORF9IX18KPiA+ICsKPiA+ICsjaW5jbHVkZSA8dXNicmVkaXJm
aWx0ZXIuaD4KPiA+ICsjaW5jbHVkZSAidXNiLWRldmljZS1tYW5hZ2VyLmgiCj4gPiArCj4gPiAr
R19CRUdJTl9ERUNMUwo+ID4gKwo+ID4gK3R5cGVkZWYgc3RydWN0IF9TcGljZVVzYkJhY2tlbmQg
U3BpY2VVc2JCYWNrZW5kOwo+ID4gK3R5cGVkZWYgc3RydWN0IF9TcGljZVVzYkJhY2tlbmREZXZp
Y2UgU3BpY2VVc2JCYWNrZW5kRGV2aWNlOwo+ID4gK3R5cGVkZWYgc3RydWN0IF9TcGljZVVzYkJh
Y2tlbmRDaGFubmVsIFNwaWNlVXNiQmFja2VuZENoYW5uZWw7Cj4gPiArCj4gPiArdHlwZWRlZiBz
dHJ1Y3QgVXNiRGV2aWNlSW5mb3JtYXRpb24KPiA+ICt7Cj4gPiArICAgIHVpbnQxNl90IGJ1czsK
PiA+ICsgICAgdWludDE2X3QgYWRkcmVzczsKPiA+ICsgICAgdWludDE2X3QgdmlkOwo+ID4gKyAg
ICB1aW50MTZfdCBwaWQ7Cj4gPiArICAgIHVpbnQ4X3QgY2xhc3M7Cj4gPiArICAgIHVpbnQ4X3Qg
c3ViY2xhc3M7Cj4gPiArICAgIHVpbnQ4X3QgcHJvdG9jb2w7Cj4gPiArfSBVc2JEZXZpY2VJbmZv
cm1hdGlvbjsKPiA+ICsKPiA+ICt0eXBlZGVmIHN0cnVjdCBTcGljZVVzYkJhY2tlbmRDaGFubmVs
SW5pdERhdGEKPiA+ICt7Cj4gPiArICAgIHZvaWQgKnVzZXJfZGF0YTsKPiA+ICsgICAgaW50ICgq
d3JpdGVfY2FsbGJhY2spKHZvaWQgKnVzZXJfZGF0YSwgdWludDhfdCAqZGF0YSwgaW50IGNvdW50
KTsKPiA+ICsgICAgZ2Jvb2xlYW4gKCppc19jaGFubmVsX3JlYWR5KSh2b2lkICp1c2VyX2RhdGEp
Owo+ID4gKyAgICB1aW50NjRfdCAoKmdldF9xdWV1ZV9zaXplKSh2b2lkICp1c2VyX2RhdGEpOwo+
ID4gK30gU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbEluaXREYXRhOwo+ID4gKwo+ID4gK3R5cGVkZWYg
dm9pZCgqdXNiX2hvdF9wbHVnX2NhbGxiYWNrKSh2b2lkICp1c2VyX2RhdGEsIFNwaWNlVXNiQmFj
a2VuZERldmljZSAqZGV2LCBnYm9vbGVhbiBhZGRlZCk7Cj4gPiArCj4gPiArZW51bSB7Cj4gPiAr
ICAgIFVTQl9SRURJUl9FUlJPUl9JTyA9IC0xLAo+ID4gKyAgICBVU0JfUkVESVJfRVJST1JfUkVB
RF9QQVJTRSA9IC0yLAo+ID4gKyAgICBVU0JfUkVESVJfRVJST1JfREVWX1JFSkVDVEVEID0gLTMs
Cj4gPiArICAgIFVTQl9SRURJUl9FUlJPUl9ERVZfTE9TVCA9IC00LAo+ID4gK307Cj4gPiArCj4g
PiArLyogU3BpY2UgVVNCIGJhY2tlbmQgQVBJICovCj4gPiArLyogc2V0cyBlcnJvciBvbiBmYWls
dXJlICovCj4gPiArU3BpY2VVc2JCYWNrZW5kICpzcGljZV91c2JfYmFja2VuZF9uZXcoR0Vycm9y
ICoqZXJyb3IpOwo+ID4gK3ZvaWQgc3BpY2VfdXNiX2JhY2tlbmRfZGVsZXRlKFNwaWNlVXNiQmFj
a2VuZCAqY29udGV4dCk7Cj4gPiArCj4gPiArLyoKPiA+ICtyZXR1cm5zIG5ld2x5LWFsbG9jYXRl
ZCBudWxsLXRlcm1pbmF0ZWQgbGlzdCBvZgo+ID4gK1NwaWNlVXNiQmFja2VuZERldmljZSBwb2lu
dGVycy4KPiA+ICtUaGUgY2FsbGVyIG11c3QgY2FsbCBzcGljZV91c2JfYmFja2VuZF9mcmVlX2Rl
dmljZV9saXN0Cj4gPiArYWZ0ZXIgaXQgZmluaXNoZXMgbGlzdCBwcm9jZXNzaW5nCj4gPiArKi8K
PiA+ICtTcGljZVVzYkJhY2tlbmREZXZpY2UgKipzcGljZV91c2JfYmFja2VuZF9nZXRfZGV2aWNl
X2xpc3QoU3BpY2VVc2JCYWNrZW5kICpiYWNrZW5kKTsKPiA+ICt2b2lkIHNwaWNlX3VzYl9iYWNr
ZW5kX2ZyZWVfZGV2aWNlX2xpc3QoU3BpY2VVc2JCYWNrZW5kRGV2aWNlICoqZGV2bGlzdCk7Cj4g
PiArZ2Jvb2xlYW4gc3BpY2VfdXNiX2JhY2tlbmRfaGFuZGxlX2V2ZW50cyhTcGljZVVzYkJhY2tl
bmQgKmJlKTsKPiA+ICtnYm9vbGVhbiBzcGljZV91c2JfYmFja2VuZF9yZWdpc3Rlcl9ob3RwbHVn
KFNwaWNlVXNiQmFja2VuZCAqYmUsCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB2b2lkICp1c2VyX2RhdGEsCj4gPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICB1c2JfaG90X3BsdWdfY2FsbGJhY2sgcHJvYyk7Cj4gPiAr
dm9pZCBzcGljZV91c2JfYmFja2VuZF9kZXJlZ2lzdGVyX2hvdHBsdWcoU3BpY2VVc2JCYWNrZW5k
ICpiZSk7Cj4gPiArCj4gPiArLyogU3BpY2UgVVNCIGJhY2tlbmQgZGV2aWNlIEFQSSAqLwo+ID4g
K2dib29sZWFuIHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9pc19odWIoU3BpY2VVc2JCYWNrZW5k
RGV2aWNlICpkZXYpOwo+ID4gK1NwaWNlVXNiQmFja2VuZERldmljZSAqc3BpY2VfdXNiX2JhY2tl
bmRfZGV2aWNlX3JlZihTcGljZVVzYkJhY2tlbmREZXZpY2UgKmRldik7Cj4gPiArdm9pZCBzcGlj
ZV91c2JfYmFja2VuZF9kZXZpY2VfdW5yZWYoU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpkZXYpOwo+
ID4gK2djb25zdHBvaW50ZXIgc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX2dldF9saWJkZXYoU3Bp
Y2VVc2JCYWNrZW5kRGV2aWNlICpkZXYpOwo+ID4gK2NvbnN0IFVzYkRldmljZUluZm9ybWF0aW9u
KiBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfZ2V0X2luZm8oU3BpY2VVc2JCYWNrZW5kRGV2aWNl
ICpkZXYpOwo+ID4gK2dib29sZWFuIHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9pc29jaChTcGlj
ZVVzYkJhY2tlbmREZXZpY2UgKmRldik7Cj4gPiArLyogcmV0dXJucyAwIGlmIHRoZSBkZXZpY2Ug
cGFzc2VzIHRoZSBmaWx0ZXIgKi8KPiA+ICtpbnQgc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX2No
ZWNrX2ZpbHRlcihTcGljZVVzYkJhY2tlbmREZXZpY2UgKmRldiwKPiA+ICsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJ1Y3QgdXNicmVkaXJmaWx0ZXJf
cnVsZSAqcnVsZXMsIGludCBjb3VudCk7Cj4gPiArCj4gPiArLyogU3BpY2UgVVNCIGJhY2tlbmQg
Y2hhbm5lbCBBUEkgKi8KPiA+ICtTcGljZVVzYkJhY2tlbmRDaGFubmVsICpzcGljZV91c2JfYmFj
a2VuZF9jaGFubmVsX25ldyhTcGljZVVzYkJhY2tlbmQgKmNvbnRleHQsCj4gPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgU3BpY2VV
c2JCYWNrZW5kQ2hhbm5lbEluaXREYXRhICppbml0X2RhdGEpOwo+ID4gK3ZvaWQgc3BpY2VfdXNi
X2JhY2tlbmRfY2hhbm5lbF9kZWxldGUoU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCAqY2gpOwo+ID4g
Ky8qIHJldHVybnMgMCBmb3Igc3VjY2VzcyBvciBlcnJvciBjb2RlICovCj4gPiAraW50IHNwaWNl
X3VzYl9iYWNrZW5kX3Byb3ZpZGVfcmVhZF9kYXRhKFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmNo
LCB1aW50OF90ICpkYXRhLCBpbnQgY291bnQpOwo+ID4gK2dib29sZWFuIHNwaWNlX3VzYl9iYWNr
ZW5kX2NoYW5uZWxfYXR0YWNoKFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmNoLAo+ID4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNwaWNlVXNiQmFja2VuZERldmlj
ZSAqZGV2LAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdF
cnJvciAqKmVycm9yKTsKPiA+ICt2b2lkIHNwaWNlX3VzYl9iYWNrZW5kX2NoYW5uZWxfZGV0YWNo
KFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmNoKTsKPiA+ICt2b2lkIHNwaWNlX3VzYl9iYWNrZW5k
X2NoYW5uZWxfdXAoU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCAqY2gpOwo+ID4gK3ZvaWQgc3BpY2Vf
dXNiX2JhY2tlbmRfY2hhbm5lbF9nZXRfZ3Vlc3RfZmlsdGVyKFNwaWNlVXNiQmFja2VuZENoYW5u
ZWwgKmNoLAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGNvbnN0IHN0cnVjdCB1c2JyZWRpcmZpbHRlcl9ydWxlICAqKnJ1bGVzLAo+ID4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCAqY291bnQpOwo+
ID4gK3ZvaWQgc3BpY2VfdXNiX2JhY2tlbmRfcmV0dXJuX3dyaXRlX2RhdGEoU3BpY2VVc2JCYWNr
ZW5kQ2hhbm5lbCAqY2gsIHZvaWQgKmRhdGEpOwo+ID4gKwo+ID4gK0dfRU5EX0RFQ0xTCj4gPiAr
Cj4gPiArI2VuZGlmCj4gPiBkaWZmIC0tZ2l0IGEvc3JjL3VzYi1kZXZpY2UtbWFuYWdlci1wcml2
LmggYi9zcmMvdXNiLWRldmljZS1tYW5hZ2VyLXByaXYuaAo+ID4gaW5kZXggODM4ODRkNy4uMzlh
YWYyZiAxMDA2NDQKPiA+IC0tLSBhL3NyYy91c2ItZGV2aWNlLW1hbmFnZXItcHJpdi5oCj4gPiAr
KysgYi9zcmMvdXNiLWRldmljZS1tYW5hZ2VyLXByaXYuaAo+ID4gQEAgLTMyLDcgKzMyLDYgQEAg
dm9pZCBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfc3RvcF9ldmVudF9saXN0ZW5pbmcoCj4gPiAg
ICAgIFNwaWNlVXNiRGV2aWNlTWFuYWdlciAqbWFuYWdlcik7Cj4gPgo+ID4gICNpZmRlZiBVU0Vf
VVNCUkVESVIKPiA+IC0jaW5jbHVkZSA8bGlidXNiLmg+Cj4gPiAgdm9pZCBzcGljZV91c2JfZGV2
aWNlX21hbmFnZXJfZGV2aWNlX2Vycm9yKAo+ID4gICAgICBTcGljZVVzYkRldmljZU1hbmFnZXIg
Km1hbmFnZXIsIFNwaWNlVXNiRGV2aWNlICpkZXZpY2UsIEdFcnJvciAqZXJyKTsKPiA+Cj4gPiBk
aWZmIC0tZ2l0IGEvc3JjL3VzYi1kZXZpY2UtbWFuYWdlci5jIGIvc3JjL3VzYi1kZXZpY2UtbWFu
YWdlci5jCj4gPiBpbmRleCBjMWRmOTc3Li4yYmVlNTVkIDEwMDY0NAo+ID4gLS0tIGEvc3JjL3Vz
Yi1kZXZpY2UtbWFuYWdlci5jCj4gPiArKysgYi9zcmMvdXNiLWRldmljZS1tYW5hZ2VyLmMKPiA+
IEBAIC0yNSwxNSArMjUsMTQgQEAKPiA+Cj4gPiAgI2lmZGVmIFVTRV9VU0JSRURJUgo+ID4gICNp
bmNsdWRlIDxlcnJuby5oPgo+ID4gLSNpbmNsdWRlIDxsaWJ1c2IuaD4KPiA+Cj4gPiAgI2lmZGVm
IEdfT1NfV0lOMzIKPiA+ICsjaW5jbHVkZSA8d2luZG93cy5oPgo+ID4gICNpbmNsdWRlICJ1c2Jk
a19hcGkuaCIKPiA+ICAjaW5jbHVkZSAid2luLXVzYi1kZXYuaCIKPiA+ICAjZW5kaWYKPiA+Cj4g
PiAgI2luY2x1ZGUgImNoYW5uZWwtdXNicmVkaXItcHJpdi5oIgo+ID4gLSNpbmNsdWRlICJ1c2Jy
ZWRpcmhvc3QuaCIKPiA+ICAjaW5jbHVkZSAidXNidXRpbC5oIgo+ID4gICNlbmRpZgo+ID4KPiA+
IEBAIC05NCw3ICs5Myw3IEBAIHN0cnVjdCBfU3BpY2VVc2JEZXZpY2VNYW5hZ2VyUHJpdmF0ZSB7
Cj4gPiAgICAgIGdjaGFyICphdXRvX2Nvbm5lY3RfZmlsdGVyOwo+ID4gICAgICBnY2hhciAqcmVk
aXJlY3Rfb25fY29ubmVjdDsKPiA+ICAjaWZkZWYgVVNFX1VTQlJFRElSCj4gPiAtICAgIGxpYnVz
Yl9jb250ZXh0ICpjb250ZXh0Owo+ID4gKyAgICBTcGljZVVzYkJhY2tlbmQgKmNvbnRleHQ7Cj4g
PiAgICAgIGludCBldmVudF9saXN0ZW5lcnM7Cj4gPiAgICAgIEdUaHJlYWQgKmV2ZW50X3RocmVh
ZDsKPiA+ICAgICAgZ2ludCBldmVudF90aHJlYWRfcnVuOwo+ID4gQEAgLTEwNiw3ICsxMDUsNiBA
QCBzdHJ1Y3QgX1NwaWNlVXNiRGV2aWNlTWFuYWdlclByaXZhdGUgewo+ID4gICAgICBHVWRldkNs
aWVudCAqdWRldjsKPiA+ICAjZWxzZQo+ID4gICAgICBnYm9vbGVhbiByZWRpcmVjdGluZzsgLyog
SGFuZGxlZCBieSBHVWRldkNsaWVudCBpbiB0aGUgZ3VkZXYgY2FzZSAqLwo+ID4gLSAgICBsaWJ1
c2JfaG90cGx1Z19jYWxsYmFja19oYW5kbGUgaHBfaGFuZGxlOwo+ID4gICNlbmRpZgo+ID4gICNp
ZmRlZiBHX09TX1dJTjMyCj4gPiAgICAgIHVzYmRrX2FwaV93cmFwcGVyICAgICAqdXNiZGtfYXBp
Owo+ID4gQEAgLTEzNiw3ICsxMzQsNyBAQCB0eXBlZGVmIHN0cnVjdCBfU3BpY2VVc2JEZXZpY2VJ
bmZvIHsKPiA+ICAgICAgZ3VpbnQxNiB2aWQ7Cj4gPiAgICAgIGd1aW50MTYgcGlkOwo+ID4gICAg
ICBnYm9vbGVhbiBpc29jaHJvbm91czsKPiA+IC0gICAgbGlidXNiX2RldmljZSAqbGliZGV2Owo+
ID4gKyAgICBTcGljZVVzYkJhY2tlbmREZXZpY2UgKmJkZXY7Cj4gPiAgICAgIGdpbnQgICAgcmVm
Owo+ID4gIH0gU3BpY2VVc2JEZXZpY2VJbmZvOwo+ID4KPiA+IEBAIC0xNDksMTkgKzE0NywxOCBA
QCBzdGF0aWMgdm9pZCBjaGFubmVsX2V2ZW50KFNwaWNlQ2hhbm5lbCAqY2hhbm5lbCwgU3BpY2VD
aGFubmVsRXZlbnQgZXZlbnQsCj4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICBncG9pbnRl
ciB1c2VyX2RhdGEpOwo+ID4gICNpZmRlZiBHX09TX1dJTjMyCj4gPiAgc3RhdGljIHZvaWQgc3Bp
Y2VfdXNiX2RldmljZV9tYW5hZ2VyX3VldmVudF9jYihHVWRldkNsaWVudCAgICAgKmNsaWVudCwK
PiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpYnVz
Yl9kZXZpY2UgICAqdWRldmljZSwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIFNwaWNlVXNiQmFja2VuZERldmljZSAqdWRldmljZSwKPiA+ICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdib29sZWFuICAgICAg
ICAgYWRkLAo+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgZ3BvaW50ZXIgICAgICAgICB1c2VyX2RhdGEpOwo+ID4gICNlbHNlCj4gPiAtc3RhdGljIGlu
dCBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfaG90cGx1Z19jYihsaWJ1c2JfY29udGV4dCAgICAg
ICAqY3R4LAo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgbGlidXNiX2RldmljZSAgICAgICAgKmRldmljZSwKPiA+IC0gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpYnVzYl9ob3RwbHVnX2V2ZW50ICBldmVudCwK
PiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZvaWQg
ICAgICAgICAgICAgICAgICpkYXRhKTsKPiA+ICtzdGF0aWMgdm9pZCBzcGljZV91c2JfZGV2aWNl
X21hbmFnZXJfaG90cGx1Z19jYih2b2lkICp1c2VyX2RhdGEsCj4gPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpk
ZXYsCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
Z2Jvb2xlYW4gYWRkZWQpOwo+ID4gICNlbmRpZgo+ID4gIHN0YXRpYyB2b2lkIHNwaWNlX3VzYl9k
ZXZpY2VfbWFuYWdlcl9jaGVja19yZWRpcl9vbl9jb25uZWN0KAo+ID4gICAgICBTcGljZVVzYkRl
dmljZU1hbmFnZXIgKnNlbGYsIFNwaWNlQ2hhbm5lbCAqY2hhbm5lbCk7Cj4gPgo+ID4gLXN0YXRp
YyBTcGljZVVzYkRldmljZUluZm8gKnNwaWNlX3VzYl9kZXZpY2VfbmV3KGxpYnVzYl9kZXZpY2Ug
KmxpYmRldik7Cj4gPiArc3RhdGljIFNwaWNlVXNiRGV2aWNlSW5mbyAqc3BpY2VfdXNiX2Rldmlj
ZV9uZXcoU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpiZGV2KTsKPiA+ICBzdGF0aWMgU3BpY2VVc2JE
ZXZpY2UgKnNwaWNlX3VzYl9kZXZpY2VfcmVmKFNwaWNlVXNiRGV2aWNlICpkZXZpY2UpOwo+ID4g
IHN0YXRpYyB2b2lkIHNwaWNlX3VzYl9kZXZpY2VfdW5yZWYoU3BpY2VVc2JEZXZpY2UgKmRldmlj
ZSk7Cj4gPgo+ID4gQEAgLTE3MCwxMiArMTY3LDEyIEBAIHN0YXRpYyB2b2lkIF91c2Jka19oaWRl
cl91cGRhdGUoU3BpY2VVc2JEZXZpY2VNYW5hZ2VyICptYW5hZ2VyKTsKPiA+ICBzdGF0aWMgdm9p
ZCBfdXNiZGtfaGlkZXJfY2xlYXIoU3BpY2VVc2JEZXZpY2VNYW5hZ2VyICptYW5hZ2VyKTsKPiA+
ICAjZW5kaWYKPiA+Cj4gPiAtc3RhdGljIGdib29sZWFuIHNwaWNlX3VzYl9tYW5hZ2VyX2Rldmlj
ZV9lcXVhbF9saWJkZXYoU3BpY2VVc2JEZXZpY2VNYW5hZ2VyICptYW5hZ2VyLAo+ID4gLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNwaWNlVXNi
RGV2aWNlICpkZXZpY2UsCj4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgbGlidXNiX2RldmljZSAqbGliZGV2KTsKPiA+IC1zdGF0aWMgbGli
dXNiX2RldmljZSAqCj4gPiAtc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2RldmljZV90b19saWJk
ZXYoU3BpY2VVc2JEZXZpY2VNYW5hZ2VyICpzZWxmLAo+ID4gLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIFNwaWNlVXNiRGV2aWNlICpkZXZpY2UpOwo+ID4gK3N0YXRp
YyBnYm9vbGVhbiBzcGljZV91c2JfbWFuYWdlcl9kZXZpY2VfZXF1YWxfYmRldihTcGljZVVzYkRl
dmljZU1hbmFnZXIgKm1hbmFnZXIsCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIFNwaWNlVXNiRGV2aWNlICpkZXZpY2UsCj4gPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNwaWNlVXNiQmFj
a2VuZERldmljZSAqYmRldik7Cj4gPiArc3RhdGljIFNwaWNlVXNiQmFja2VuZERldmljZSAqCj4g
PiArc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2RldmljZV90b19iZGV2KFNwaWNlVXNiRGV2aWNl
TWFuYWdlciAqc2VsZiwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgU3BpY2VVc2JEZXZpY2UgKmRldmljZSk7Cj4gPgo+ID4gIHN0YXRpYyB2b2lkCj4gPiAgX3Nw
aWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9jb25uZWN0X2RldmljZV9hc3luYyhTcGljZVVzYkRldmlj
ZU1hbmFnZXIgKnNlbGYsCj4gPiBAQCAtMjc3LDE0ICsyNzQsOSBAQCBzdGF0aWMgZ2Jvb2xlYW4g
c3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2luaXRhYmxlX2luaXQoR0luaXRhYmxlICAqaW5pdGFi
bGUsCj4gPiAgICAgIEdMaXN0ICppdDsKPiA+Cj4gPiAgI2lmbmRlZiBHX09TX1dJTjMyCj4gPiAt
ICAgIGludCByYzsKPiA+ICAgICAgLyogSW5pdGlhbGl6ZSBsaWJ1c2IgKi8KPiA+IC0gICAgcmMg
PSBsaWJ1c2JfaW5pdCgmcHJpdi0+Y29udGV4dCk7Cj4gPiAtICAgIGlmIChyYyA8IDApIHsKPiA+
IC0gICAgICAgIGNvbnN0IGNoYXIgKmRlc2MgPSBsaWJ1c2JfZXJyb3JfbmFtZShyYyk7Cj4gPiAt
ICAgICAgICBnX3dhcm5pbmcoIkVycm9yIGluaXRpYWxpemluZyBVU0Igc3VwcG9ydDogJXMgWyVp
XSIsIGRlc2MsIHJjKTsKPiA+IC0gICAgICAgIGdfc2V0X2Vycm9yKGVyciwgU1BJQ0VfQ0xJRU5U
X0VSUk9SLCBTUElDRV9DTElFTlRfRVJST1JfRkFJTEVELAo+ID4gLSAgICAgICAgICAgICAgICAg
ICAgIkVycm9yIGluaXRpYWxpemluZyBVU0Igc3VwcG9ydDogJXMgWyVpXSIsIGRlc2MsIHJjKTsK
PiA+ICsgICAgcHJpdi0+Y29udGV4dCA9IHNwaWNlX3VzYl9iYWNrZW5kX25ldyhlcnIpOwo+ID4g
KyAgICBpZiAoIXByaXYtPmNvbnRleHQpIHsKPiA+ICAgICAgICAgIHJldHVybiBGQUxTRTsKPiA+
ICAgICAgfQo+ID4gICNlbmRpZgo+ID4gQEAgLTMwMiwxNiArMjk0LDggQEAgc3RhdGljIGdib29s
ZWFuIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9pbml0YWJsZV9pbml0KEdJbml0YWJsZSAgKmlu
aXRhYmxlLAo+ID4gICAgICAvKiBEbyBjb2xkcGx1ZyAoZGV0ZWN0aW9uIG9mIGFscmVhZHkgY29u
bmVjdGVkIGRldmljZXMpICovCj4gPiAgICAgIGdfdWRldl9jbGllbnRfcmVwb3J0X2RldmljZXMo
cHJpdi0+dWRldik7Cj4gPiAgI2Vsc2UKPiA+IC0gICAgcmMgPSBsaWJ1c2JfaG90cGx1Z19yZWdp
c3Rlcl9jYWxsYmFjayhwcml2LT5jb250ZXh0LAo+ID4gLSAgICAgICAgTElCVVNCX0hPVFBMVUdf
RVZFTlRfREVWSUNFX0FSUklWRUQgfCBMSUJVU0JfSE9UUExVR19FVkVOVF9ERVZJQ0VfTEVGVCwK
PiA+IC0gICAgICAgIExJQlVTQl9IT1RQTFVHX0VOVU1FUkFURSwgTElCVVNCX0hPVFBMVUdfTUFU
Q0hfQU5ZLAo+ID4gLSAgICAgICAgTElCVVNCX0hPVFBMVUdfTUFUQ0hfQU5ZLCBMSUJVU0JfSE9U
UExVR19NQVRDSF9BTlksCj4gPiAtICAgICAgICBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfaG90
cGx1Z19jYiwgc2VsZiwgJnByaXYtPmhwX2hhbmRsZSk7Cj4gPiAtICAgIGlmIChyYyA8IDApIHsK
PiA+IC0gICAgICAgIGNvbnN0IGNoYXIgKmRlc2MgPSBsaWJ1c2JfZXJyb3JfbmFtZShyYyk7Cj4g
PiAtICAgICAgICBnX3dhcm5pbmcoIkVycm9yIGluaXRpYWxpemluZyBVU0IgaG90cGx1ZyBzdXBw
b3J0OiAlcyBbJWldIiwgZGVzYywgcmMpOwo+ID4gLSAgICAgICAgZ19zZXRfZXJyb3IoZXJyLCBT
UElDRV9DTElFTlRfRVJST1IsIFNQSUNFX0NMSUVOVF9FUlJPUl9GQUlMRUQsCj4gPiAtICAgICAg
ICAgICAgICAgICAgIkVycm9yIGluaXRpYWxpemluZyBVU0IgaG90cGx1ZyBzdXBwb3J0OiAlcyBb
JWldIiwgZGVzYywgcmMpOwo+ID4gKyAgICBpZiAoIXNwaWNlX3VzYl9iYWNrZW5kX3JlZ2lzdGVy
X2hvdHBsdWcocHJpdi0+Y29udGV4dCwgc2VsZiwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9ob3RwbHVnX2Ni
KSkgewo+ID4gICAgICAgICAgcmV0dXJuIEZBTFNFOwo+ID4gICAgICB9Cj4gPiAgICAgIHNwaWNl
X3VzYl9kZXZpY2VfbWFuYWdlcl9zdGFydF9ldmVudF9saXN0ZW5pbmcoc2VsZiwgTlVMTCk7Cj4g
PiBAQCAtMzQyLDIxICszMjYsMTcgQEAgc3RhdGljIHZvaWQgc3BpY2VfdXNiX2RldmljZV9tYW5h
Z2VyX2Rpc3Bvc2UoR09iamVjdCAqZ29iamVjdCkKPiA+ICAgICAgU3BpY2VVc2JEZXZpY2VNYW5h
Z2VyUHJpdmF0ZSAqcHJpdiA9IHNlbGYtPnByaXY7Cj4gPgo+ID4gICNpZm5kZWYgR19PU19XSU4z
Mgo+ID4gLSAgICBpZiAocHJpdi0+aHBfaGFuZGxlKSB7Cj4gPiAtICAgICAgICBzcGljZV91c2Jf
ZGV2aWNlX21hbmFnZXJfc3RvcF9ldmVudF9saXN0ZW5pbmcoc2VsZik7Cj4gPiAtICAgICAgICBp
ZiAoZ19hdG9taWNfaW50X2dldCgmcHJpdi0+ZXZlbnRfdGhyZWFkX3J1bikpIHsKPiA+IC0gICAg
ICAgICAgICAvKiBGb3JjZSB0ZXJtaW5hdGlvbiBvZiB0aGUgZXZlbnQgdGhyZWFkIGV2ZW4gaWYg
dGhlcmUgd2VyZSBzb21lCj4gPiAtICAgICAgICAgICAgICogbWlzbWF0Y2hlZCBzcGljZV91c2Jf
ZGV2aWNlX21hbmFnZXJfe3N0YXJ0LHN0b3B9X2V2ZW50X2xpc3RlbmluZwo+ID4gLSAgICAgICAg
ICAgICAqIGNhbGxzLiBPdGhlcndpc2UsIHRoZSB1c2IgZXZlbnQgdGhyZWFkIHdpbGwgYmUgbGVh
a2VkLCBhbmQgd2lsbAo+ID4gLSAgICAgICAgICAgICAqIHRyeSB0byB1c2UgdGhlIGxpYnVzYiBj
b250ZXh0IHdlIGRlc3Ryb3kgaW4gZmluYWxpemUoKSwgd2hpY2ggd291bGQKPiA+IC0gICAgICAg
ICAgICAgKiBjYXVzZSBhIGNyYXNoICovCj4gPiAtICAgICAgICAgICAgIGdfd2Fybl9pZl9yZWFj
aGVkKCk7Cj4gPiAtICAgICAgICAgICAgIGdfYXRvbWljX2ludF9zZXQoJnByaXYtPmV2ZW50X3Ro
cmVhZF9ydW4sIEZBTFNFKTsKPiA+IC0gICAgICAgIH0KPiA+IC0gICAgICAgIC8qIFRoaXMgYWxz
byB3YWtlcyB1cCB0aGUgbGlidXNiX2hhbmRsZV9ldmVudHMoKSBpbiB0aGUgZXZlbnRfdGhyZWFk
ICovCj4gPiAtICAgICAgICBsaWJ1c2JfaG90cGx1Z19kZXJlZ2lzdGVyX2NhbGxiYWNrKHByaXYt
PmNvbnRleHQsIHByaXYtPmhwX2hhbmRsZSk7Cj4gPiAtICAgICAgICBwcml2LT5ocF9oYW5kbGUg
PSAwOwo+ID4gKyAgICBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfc3RvcF9ldmVudF9saXN0ZW5p
bmcoc2VsZik7Cj4gPiArICAgIGlmIChnX2F0b21pY19pbnRfZ2V0KCZwcml2LT5ldmVudF90aHJl
YWRfcnVuKSkgewo+ID4gKyAgICAgICAgLyogRm9yY2UgdGVybWluYXRpb24gb2YgdGhlIGV2ZW50
IHRocmVhZCBldmVuIGlmIHRoZXJlIHdlcmUgc29tZQo+ID4gKyAgICAgICAgICogbWlzbWF0Y2hl
ZCBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfe3N0YXJ0LHN0b3B9X2V2ZW50X2xpc3RlbmluZwo+
ID4gKyAgICAgICAgICogY2FsbHMuIE90aGVyd2lzZSwgdGhlIHVzYiBldmVudCB0aHJlYWQgd2ls
bCBiZSBsZWFrZWQsIGFuZCB3aWxsCj4gPiArICAgICAgICAgKiB0cnkgdG8gdXNlIHRoZSBsaWJ1
c2IgY29udGV4dCB3ZSBkZXN0cm95IGluIGZpbmFsaXplKCksIHdoaWNoIHdvdWxkCj4gPiArICAg
ICAgICAgKiBjYXVzZSBhIGNyYXNoICovCj4gPiArICAgICAgICBnX3dhcm5faWZfcmVhY2hlZCgp
Owo+ID4gKyAgICAgICAgZ19hdG9taWNfaW50X3NldCgmcHJpdi0+ZXZlbnRfdGhyZWFkX3J1biwg
RkFMU0UpOwo+ID4gICAgICB9Cj4gPiArICAgIHNwaWNlX3VzYl9iYWNrZW5kX2RlcmVnaXN0ZXJf
aG90cGx1Zyhwcml2LT5jb250ZXh0KTsKPiA+ICAjZW5kaWYKPiA+ICAgICAgaWYgKHByaXYtPmV2
ZW50X3RocmVhZCkgewo+ID4gICAgICAgICAgZ193YXJuX2lmX2ZhaWwoZ19hdG9taWNfaW50X2dl
dCgmcHJpdi0+ZXZlbnRfdGhyZWFkX3J1bikgPT0gRkFMU0UpOwo+ID4gQEAgLTM4Niw3ICszNjYs
NyBAQCBzdGF0aWMgdm9pZCBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfZmluYWxpemUoR09iamVj
dCAqZ29iamVjdCkKPiA+ICAgICAgZ19yZXR1cm5faWZfZmFpbChwcml2LT5ldmVudF90aHJlYWQg
PT0gTlVMTCk7Cj4gPiAgI2lmbmRlZiBHX09TX1dJTjMyCj4gPiAgICAgIGlmIChwcml2LT5jb250
ZXh0KQo+ID4gLSAgICAgICAgbGlidXNiX2V4aXQocHJpdi0+Y29udGV4dCk7Cj4gPiArICAgICAg
ICBzcGljZV91c2JfYmFja2VuZF9kZWxldGUocHJpdi0+Y29udGV4dCk7Cj4gPiAgI2VuZGlmCj4g
PiAgICAgIGZyZWUocHJpdi0+YXV0b19jb25uX2ZpbHRlcl9ydWxlcyk7Cj4gPiAgICAgIGZyZWUo
cHJpdi0+cmVkaXJlY3Rfb25fY29ubmVjdF9ydWxlcyk7Cj4gPiBAQCAtNzA5LDM3ICs2ODksNiBA
QCBzdGF0aWMgdm9pZCBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfY2xhc3NfaW5pdChTcGljZVVz
YkRldmljZU1hbmFnZXJDbGFzcyAqa2xhcwo+ID4gICAgICAgICAgICAgICAgICAgICAgIEdfVFlQ
RV9FUlJPUik7Cj4gPiAgfQo+ID4KPiA+IC0jaWZkZWYgVVNFX1VTQlJFRElSCj4gPiAtCj4gPiAt
LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tICovCj4gPiAtLyogZ3VkZXYgLyBsaWJ1c2IgSGVscGVyIGZ1bmN0aW9ucyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovCj4gPiAtCj4gPiAtc3RhdGljIGdi
b29sZWFuIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9nZXRfZGV2aWNlX2Rlc2NyaXB0b3IoCj4g
PiAtICAgIGxpYnVzYl9kZXZpY2UgKmxpYmRldiwKPiA+IC0gICAgc3RydWN0IGxpYnVzYl9kZXZp
Y2VfZGVzY3JpcHRvciAqZGVzYykKPiA+IC17Cj4gPiAtICAgIGludCBlcnJjb2RlOwo+ID4gLSAg
ICBjb25zdCBnY2hhciAqZXJyc3RyOwo+ID4gLQo+ID4gLSAgICBnX3JldHVybl92YWxfaWZfZmFp
bChsaWJkZXYgIT0gTlVMTCwgRkFMU0UpOwo+ID4gLSAgICBnX3JldHVybl92YWxfaWZfZmFpbChk
ZXNjICAgIT0gTlVMTCwgRkFMU0UpOwo+ID4gLQo+ID4gLSAgICBlcnJjb2RlID0gbGlidXNiX2dl
dF9kZXZpY2VfZGVzY3JpcHRvcihsaWJkZXYsIGRlc2MpOwo+ID4gLSAgICBpZiAoZXJyY29kZSA8
IDApIHsKPiA+IC0gICAgICAgIGludCBidXMsIGFkZHI7Cj4gPiAtCj4gPiAtICAgICAgICBidXMg
PSBsaWJ1c2JfZ2V0X2J1c19udW1iZXIobGliZGV2KTsKPiA+IC0gICAgICAgIGFkZHIgPSBsaWJ1
c2JfZ2V0X2RldmljZV9hZGRyZXNzKGxpYmRldik7Cj4gPiAtICAgICAgICBlcnJzdHIgPSBsaWJ1
c2JfZXJyb3JfbmFtZShlcnJjb2RlKTsKPiA+IC0gICAgICAgIGdfd2FybmluZygiY2Fubm90IGdl
dCBkZXZpY2UgZGVzY3JpcHRvciBmb3IgKCVwKSAlZC4lZCAtLSAlcyglZCkiLAo+ID4gLSAgICAg
ICAgICAgICAgICAgIGxpYmRldiwgYnVzLCBhZGRyLCBlcnJzdHIsIGVycmNvZGUpOwo+ID4gLSAg
ICAgICAgcmV0dXJuIEZBTFNFOwo+ID4gLSAgICB9Cj4gPiAtICAgIHJldHVybiBUUlVFOwo+ID4g
LX0KPiA+IC0KPiA+IC0jZW5kaWYgLy8gVVNFX1VTQlJFRElSCj4gPiAtCj4gPiAgLyoqCj4gPiAg
ICogc3BpY2VfdXNiX2RldmljZV9nZXRfbGlidXNiX2RldmljZToKPiA+ICAgKiBAZGV2aWNlOiAj
U3BpY2VVc2JEZXZpY2UgdG8gZ2V0IHRoZSBkZXNjcmlwdG9yIGluZm9ybWF0aW9uIG9mCj4gPiBA
QCAtNzU4LDMyICs3MDcsMTIgQEAgc3BpY2VfdXNiX2RldmljZV9nZXRfbGlidXNiX2RldmljZShj
b25zdCBTcGljZVVzYkRldmljZSAqZGV2aWNlIEdfR05VQ19VTlVTRUQpCj4gPgo+ID4gICAgICBn
X3JldHVybl92YWxfaWZfZmFpbChpbmZvICE9IE5VTEwsIEZBTFNFKTsKPiA+Cj4gPiAtICAgIHJl
dHVybiBpbmZvLT5saWJkZXY7Cj4gPiArICAgIHJldHVybiBzcGljZV91c2JfYmFja2VuZF9kZXZp
Y2VfZ2V0X2xpYmRldihpbmZvLT5iZGV2KTsKPiA+ICAjZW5kaWYKPiA+ICAgICAgcmV0dXJuIE5V
TEw7Cj4gPiAgfQo+ID4KPiA+ICAjaWZkZWYgVVNFX1VTQlJFRElSCj4gPiAtc3RhdGljIGdib29s
ZWFuIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9nZXRfbGliZGV2X3ZpZF9waWQoCj4gPiAtICAg
IGxpYnVzYl9kZXZpY2UgKmxpYmRldiwgaW50ICp2aWQsIGludCAqcGlkKQo+ID4gLXsKPiA+IC0g
ICAgc3RydWN0IGxpYnVzYl9kZXZpY2VfZGVzY3JpcHRvciBkZXNjOwo+ID4gLQo+ID4gLSAgICBn
X3JldHVybl92YWxfaWZfZmFpbChsaWJkZXYgIT0gTlVMTCwgRkFMU0UpOwo+ID4gLSAgICBnX3Jl
dHVybl92YWxfaWZfZmFpbCh2aWQgIT0gTlVMTCwgRkFMU0UpOwo+ID4gLSAgICBnX3JldHVybl92
YWxfaWZfZmFpbChwaWQgIT0gTlVMTCwgRkFMU0UpOwo+ID4gLQo+ID4gLSAgICAqdmlkID0gKnBp
ZCA9IDA7Cj4gPiAtCj4gPiAtICAgIGlmICghc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2dldF9k
ZXZpY2VfZGVzY3JpcHRvcihsaWJkZXYsICZkZXNjKSkgewo+ID4gLSAgICAgICAgcmV0dXJuIEZB
TFNFOwo+ID4gLSAgICB9Cj4gPiAtICAgICp2aWQgPSBkZXNjLmlkVmVuZG9yOwo+ID4gLSAgICAq
cGlkID0gZGVzYy5pZFByb2R1Y3Q7Cj4gPiAtCj4gPiAtICAgIHJldHVybiBUUlVFOwo+ID4gLX0K
PiA+IC0KPiA+ICAvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi8KPiA+ICAvKiBjYWxsYmFja3MgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi8KPiA+Cj4gPiBA
QCAtODk5LDMxICs4MjgsMjQgQEAgc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2ZpbmRfZGV2aWNl
KFNwaWNlVXNiRGV2aWNlTWFuYWdlciAqc2VsZiwKPiA+ICB9Cj4gPgo+ID4gIHN0YXRpYyB2b2lk
IHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9hZGRfZGV2KFNwaWNlVXNiRGV2aWNlTWFuYWdlciAg
KnNlbGYsCj4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
bGlidXNiX2RldmljZSAgICAgICAgICAqbGliZGV2KQo+ID4gKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIFNwaWNlVXNiQmFja2VuZERldmljZSAgKmJkZXYpCj4g
PiAgewo+ID4gICAgICBTcGljZVVzYkRldmljZU1hbmFnZXJQcml2YXRlICpwcml2ID0gc2VsZi0+
cHJpdjsKPiA+IC0gICAgc3RydWN0IGxpYnVzYl9kZXZpY2VfZGVzY3JpcHRvciBkZXNjOwo+ID4g
KyAgICBjb25zdCBVc2JEZXZpY2VJbmZvcm1hdGlvbiAqYl9pbmZvID0gc3BpY2VfdXNiX2JhY2tl
bmRfZGV2aWNlX2dldF9pbmZvKGJkZXYpOwo+ID4gICAgICBTcGljZVVzYkRldmljZSAqZGV2aWNl
Owo+ID4KPiA+IC0gICAgaWYgKCFzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfZ2V0X2RldmljZV9k
ZXNjcmlwdG9yKGxpYmRldiwgJmRlc2MpKQo+ID4gLSAgICAgICAgcmV0dXJuOwo+ID4gLQo+ID4g
LSAgICAvKiBTa2lwIGh1YnMgKi8KPiA+IC0gICAgaWYgKGRlc2MuYkRldmljZUNsYXNzID09IExJ
QlVTQl9DTEFTU19IVUIpCj4gPiAtICAgICAgICByZXR1cm47Cj4gPiAtCj4gPiAgICAgIGlmIChz
cGljZV91c2JfZGV2aWNlX21hbmFnZXJfZmluZF9kZXZpY2Uoc2VsZiwKPiA+IC0gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWJ1c2JfZ2V0X2J1c19udW1iZXIo
bGliZGV2KSwKPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBsaWJ1c2JfZ2V0X2RldmljZV9hZGRyZXNzKGxpYmRldikpKSB7Cj4gPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYl9pbmZvLT5idXMsCj4gPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYl9pbmZvLT5hZGRyZXNzKSkg
ewo+ID4gICAgICAgICAgU1BJQ0VfREVCVUcoImRldmljZSBub3QgYWRkZWQgJWQ6JWQgJTA0eDol
MDR4IiwKPiA+IC0gICAgICAgICAgICAgICAgICAgIGxpYnVzYl9nZXRfYnVzX251bWJlcihsaWJk
ZXYpLAo+ID4gLSAgICAgICAgICAgICAgICAgICAgbGlidXNiX2dldF9kZXZpY2VfYWRkcmVzcyhs
aWJkZXYpLAo+ID4gLSAgICAgICAgICAgICAgICAgICAgZGVzYy5pZFZlbmRvciwKPiA+IC0gICAg
ICAgICAgICAgICAgICAgIGRlc2MuaWRQcm9kdWN0KTsKPiA+ICsgICAgICAgICAgICAgICAgICAg
IGJfaW5mby0+YnVzLAo+ID4gKyAgICAgICAgICAgICAgICAgICAgYl9pbmZvLT5hZGRyZXNzLAo+
ID4gKyAgICAgICAgICAgICAgICAgICAgYl9pbmZvLT52aWQsCj4gPiArICAgICAgICAgICAgICAg
ICAgICBiX2luZm8tPnBpZCk7Cj4gPiAgICAgICAgICByZXR1cm47Cj4gPiAgICAgIH0KPiA+Cj4g
PiAtICAgIGRldmljZSA9IChTcGljZVVzYkRldmljZSopc3BpY2VfdXNiX2RldmljZV9uZXcobGli
ZGV2KTsKPiA+ICsgICAgZGV2aWNlID0gKFNwaWNlVXNiRGV2aWNlKilzcGljZV91c2JfZGV2aWNl
X25ldyhiZGV2KTsKPiA+ICAgICAgaWYgKCFkZXZpY2UpCj4gPiAgICAgICAgICByZXR1cm47Cj4g
Pgo+ID4gQEAgLTkzNSwxMCArODU3LDEwIEBAIHN0YXRpYyB2b2lkIHNwaWNlX3VzYl9kZXZpY2Vf
bWFuYWdlcl9hZGRfZGV2KFNwaWNlVXNiRGV2aWNlTWFuYWdlciAgKnNlbGYsCj4gPiAgICAgICAg
ICBjYW5fcmVkaXJlY3QgPSBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfY2FuX3JlZGlyZWN0X2Rl
dmljZSgKPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZiwg
ZGV2aWNlLCBOVUxMKTsKPiA+Cj4gPiAtICAgICAgICBhdXRvX29rID0gdXNicmVkaXJob3N0X2No
ZWNrX2RldmljZV9maWx0ZXIoCj4gPiArICAgICAgICBhdXRvX29rID0gc3BpY2VfdXNiX2JhY2tl
bmRfZGV2aWNlX2NoZWNrX2ZpbHRlcigKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
YmRldiwKPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpdi0+YXV0b19jb25uX2Zp
bHRlcl9ydWxlcywKPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpdi0+YXV0b19j
b25uX2ZpbHRlcl9ydWxlc19jb3VudCwKPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAg
bGliZGV2LCAwKSA9PSAwOwo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcml2LT5h
dXRvX2Nvbm5fZmlsdGVyX3J1bGVzX2NvdW50KSA9PSAwOwo+ID4KPiA+ICAgICAgICAgIGlmIChj
YW5fcmVkaXJlY3QgJiYgYXV0b19vaykKPiA+ICAgICAgICAgICAgICBzcGljZV91c2JfZGV2aWNl
X21hbmFnZXJfY29ubmVjdF9kZXZpY2VfYXN5bmMoc2VsZiwKPiA+IEBAIC05NTUsMTUgKzg3Nywx
NiBAQCBzdGF0aWMgdm9pZCBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfYWRkX2RldihTcGljZVVz
YkRldmljZU1hbmFnZXIgICpzZWxmLAo+ID4gIH0KPiA+Cj4gPiAgc3RhdGljIHZvaWQgc3BpY2Vf
dXNiX2RldmljZV9tYW5hZ2VyX3JlbW92ZV9kZXYoU3BpY2VVc2JEZXZpY2VNYW5hZ2VyICpzZWxm
LAo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGd1
aW50IGJ1cywgZ3VpbnQgYWRkcmVzcykKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBTcGljZVVzYkJhY2tlbmREZXZpY2UgKmJkZXYpCj4gPiAgewo+
ID4gICAgICBTcGljZVVzYkRldmljZU1hbmFnZXJQcml2YXRlICpwcml2ID0gc2VsZi0+cHJpdjsK
PiA+ICAgICAgU3BpY2VVc2JEZXZpY2UgKmRldmljZTsKPiA+ICsgICAgY29uc3QgVXNiRGV2aWNl
SW5mb3JtYXRpb24gKmJfaW5mbyA9IHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9nZXRfaW5mbyhi
ZGV2KTsKPiA+Cj4gPiAtICAgIGRldmljZSA9IHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9maW5k
X2RldmljZShzZWxmLCBidXMsIGFkZHJlc3MpOwo+ID4gKyAgICBkZXZpY2UgPSBzcGljZV91c2Jf
ZGV2aWNlX21hbmFnZXJfZmluZF9kZXZpY2Uoc2VsZiwgYl9pbmZvLT5idXMsIGJfaW5mby0+YWRk
cmVzcyk7Cj4gPiAgICAgIGlmICghZGV2aWNlKSB7Cj4gPiAgICAgICAgICBnX3dhcm5pbmcoIkNv
dWxkIG5vdCBmaW5kIFVTQiBkZXZpY2UgdG8gcmVtb3ZlICIgREVWX0lEX0ZNVCwKPiA+IC0gICAg
ICAgICAgICAgICAgICBidXMsIGFkZHJlc3MpOwo+ID4gKyAgICAgICAgICAgICAgICAgIGJfaW5m
by0+YnVzLCBiX2luZm8tPmFkZHJlc3MpOwo+ID4gICAgICAgICAgcmV0dXJuOwo+ID4gICAgICB9
Cj4gPgo+ID4gQEAgLTk4MiwyNCArOTA1LDIyIEBAIHN0YXRpYyB2b2lkIHNwaWNlX3VzYl9kZXZp
Y2VfbWFuYWdlcl9yZW1vdmVfZGV2KFNwaWNlVXNiRGV2aWNlTWFuYWdlciAqc2VsZiwKPiA+Cj4g
PiAgI2lmZGVmIEdfT1NfV0lOMzIKPiA+ICBzdGF0aWMgdm9pZCBzcGljZV91c2JfZGV2aWNlX21h
bmFnZXJfdWV2ZW50X2NiKEdVZGV2Q2xpZW50ICAgICAqY2xpZW50LAo+ID4gLSAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlidXNiX2RldmljZSAgICpkZXYs
Cj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTcGlj
ZVVzYkJhY2tlbmREZXZpY2UgKmJkZXYsCj4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBnYm9vbGVhbiAgICAgICAgIGFkZCwKPiA+ICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdwb2ludGVyICAgICAgICAgdXNl
cl9kYXRhKQo+ID4gIHsKPiA+ICAgICAgU3BpY2VVc2JEZXZpY2VNYW5hZ2VyICpzZWxmID0gU1BJ
Q0VfVVNCX0RFVklDRV9NQU5BR0VSKHVzZXJfZGF0YSk7Cj4gPgo+ID4gICAgICBpZiAoYWRkKQo+
ID4gLSAgICAgICAgc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2FkZF9kZXYoc2VsZiwgZGV2KTsK
PiA+ICsgICAgICAgIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9hZGRfZGV2KHNlbGYsIGJkZXYp
Owo+ID4gICAgICBlbHNlCj4gPiAtICAgICAgICBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfcmVt
b3ZlX2RldihzZWxmLAo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgbGlidXNiX2dldF9idXNfbnVtYmVyKGRldiksCj4gPiAtICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBsaWJ1c2JfZ2V0X2RldmljZV9hZGRyZXNzKGRldikp
Owo+ID4gKyAgICAgICAgc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX3JlbW92ZV9kZXYoc2VsZiwg
YmRldik7Cj4gPiAgfQo+ID4gICNlbHNlCj4gPiAgc3RydWN0IGhvdHBsdWdfaWRsZV9jYl9hcmdz
IHsKPiA+ICAgICAgU3BpY2VVc2JEZXZpY2VNYW5hZ2VyICpzZWxmOwo+ID4gLSAgICBsaWJ1c2Jf
ZGV2aWNlICpkZXZpY2U7Cj4gPiAtICAgIGxpYnVzYl9ob3RwbHVnX2V2ZW50IGV2ZW50Owo+ID4g
KyAgICBTcGljZVVzYkJhY2tlbmREZXZpY2UgKmRldmljZTsKPiA+ICsgICAgZ2Jvb2xlYW4gICAg
ICAgICAgICAgICBhZGRlZDsKPiA+ICB9Owo+ID4KPiA+ICBzdGF0aWMgZ2Jvb2xlYW4gc3BpY2Vf
dXNiX2RldmljZV9tYW5hZ2VyX2hvdHBsdWdfaWRsZV9jYihncG9pbnRlciB1c2VyX2RhdGEpCj4g
PiBAQCAtMTAwNywzNiArOTI4LDI5IEBAIHN0YXRpYyBnYm9vbGVhbiBzcGljZV91c2JfZGV2aWNl
X21hbmFnZXJfaG90cGx1Z19pZGxlX2NiKGdwb2ludGVyIHVzZXJfZGF0YSkKPiA+ICAgICAgc3Ry
dWN0IGhvdHBsdWdfaWRsZV9jYl9hcmdzICphcmdzID0gdXNlcl9kYXRhOwo+ID4gICAgICBTcGlj
ZVVzYkRldmljZU1hbmFnZXIgKnNlbGYgPSBTUElDRV9VU0JfREVWSUNFX01BTkFHRVIoYXJncy0+
c2VsZik7Cj4gPgo+ID4gLSAgICBzd2l0Y2ggKGFyZ3MtPmV2ZW50KSB7Cj4gPiAtICAgIGNhc2Ug
TElCVVNCX0hPVFBMVUdfRVZFTlRfREVWSUNFX0FSUklWRUQ6Cj4gPiArICAgIGlmIChhcmdzLT5h
ZGRlZCkKPiA+ICAgICAgICAgIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9hZGRfZGV2KHNlbGYs
IGFyZ3MtPmRldmljZSk7Cj4gPiAtICAgICAgICBicmVhazsKPiA+IC0gICAgY2FzZSBMSUJVU0Jf
SE9UUExVR19FVkVOVF9ERVZJQ0VfTEVGVDoKPiA+IC0gICAgICAgIHNwaWNlX3VzYl9kZXZpY2Vf
bWFuYWdlcl9yZW1vdmVfZGV2KHNlbGYsCj4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgbGlidXNiX2dldF9idXNfbnVtYmVyKGFyZ3MtPmRldmljZSksCj4gPiAtICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlidXNiX2dldF9kZXZpY2VfYWRkcmVzcyhh
cmdzLT5kZXZpY2UpKTsKPiA+IC0gICAgICAgIGJyZWFrOwo+ID4gLSAgICB9Cj4gPiAtICAgIGxp
YnVzYl91bnJlZl9kZXZpY2UoYXJncy0+ZGV2aWNlKTsKPiA+ICsgICAgZWxzZQo+ID4gKyAgICAg
ICAgc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX3JlbW92ZV9kZXYoc2VsZiwgYXJncy0+ZGV2aWNl
KTsKPiA+ICsKPiA+ICsgICAgc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX3VucmVmKGFyZ3MtPmRl
dmljZSk7Cj4gPiAgICAgIGdfb2JqZWN0X3VucmVmKHNlbGYpOwo+ID4gICAgICBnX2ZyZWUoYXJn
cyk7Cj4gPiAgICAgIHJldHVybiBGQUxTRTsKPiA+ICB9Cj4gPgo+ID4gIC8qIENhbiBiZSBjYWxs
ZWQgZnJvbSBib3RoIHRoZSBtYWluLXRocmVhZCBhcyB3ZWxsIGFzIHRoZSBldmVudF90aHJlYWQg
Ki8KPiA+IC1zdGF0aWMgaW50IHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9ob3RwbHVnX2NiKGxp
YnVzYl9jb250ZXh0ICAgICAgICpjdHgsCj4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBsaWJ1c2JfZGV2aWNlICAgICAgICAqZGV2aWNlLAo+ID4gLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlidXNiX2hvdHBs
dWdfZXZlbnQgIGV2ZW50LAo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgdm9pZCAgICAgICAgICAgICAgICAgKnVzZXJfZGF0YSkKPiA+ICtzdGF0aWMg
dm9pZCBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfaG90cGx1Z19jYih2b2lkICp1c2VyX2RhdGEs
Cj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU3Bp
Y2VVc2JCYWNrZW5kRGV2aWNlICpkZXYsCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgZ2Jvb2xlYW4gYWRkZWQpCj4gPiAgewo+ID4gICAgICBTcGlj
ZVVzYkRldmljZU1hbmFnZXIgKnNlbGYgPSBTUElDRV9VU0JfREVWSUNFX01BTkFHRVIodXNlcl9k
YXRhKTsKPiA+ICAgICAgc3RydWN0IGhvdHBsdWdfaWRsZV9jYl9hcmdzICphcmdzID0gZ19tYWxs
b2MwKHNpemVvZigqYXJncykpOwo+ID4KPiA+ICAgICAgYXJncy0+c2VsZiA9IGdfb2JqZWN0X3Jl
ZihzZWxmKTsKPiA+IC0gICAgYXJncy0+ZGV2aWNlID0gbGlidXNiX3JlZl9kZXZpY2UoZGV2aWNl
KTsKPiA+IC0gICAgYXJncy0+ZXZlbnQgPSBldmVudDsKPiA+ICsgICAgYXJncy0+ZGV2aWNlID0g
c3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX3JlZihkZXYpOwo+ID4gKyAgICBhcmdzLT5hZGRlZCA9
IGFkZGVkOwo+ID4gICAgICBnX2lkbGVfYWRkKHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9ob3Rw
bHVnX2lkbGVfY2IsIGFyZ3MpOwo+ID4gLSAgICByZXR1cm4gMDsKPiA+ICB9Cj4gPiAgI2VuZGlm
IC8vIFVTRV9VU0JSRURJUgo+ID4KPiA+IEBAIC0xMDYzLDEzICs5NzcsOSBAQCBzdGF0aWMgZ3Bv
aW50ZXIgc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX3VzYl9ldl90aHJlYWQoZ3BvaW50ZXIgdXNl
cl9kYXRhKQo+ID4gIHsKPiA+ICAgICAgU3BpY2VVc2JEZXZpY2VNYW5hZ2VyICpzZWxmID0gU1BJ
Q0VfVVNCX0RFVklDRV9NQU5BR0VSKHVzZXJfZGF0YSk7Cj4gPiAgICAgIFNwaWNlVXNiRGV2aWNl
TWFuYWdlclByaXZhdGUgKnByaXYgPSBzZWxmLT5wcml2Owo+ID4gLSAgICBpbnQgcmM7Cj4gPgo+
ID4gICAgICB3aGlsZSAoZ19hdG9taWNfaW50X2dldCgmcHJpdi0+ZXZlbnRfdGhyZWFkX3J1bikp
IHsKPiA+IC0gICAgICAgIHJjID0gbGlidXNiX2hhbmRsZV9ldmVudHMocHJpdi0+Y29udGV4dCk7
Cj4gPiAtICAgICAgICBpZiAocmMgJiYgcmMgIT0gTElCVVNCX0VSUk9SX0lOVEVSUlVQVEVEKSB7
Cj4gPiAtICAgICAgICAgICAgY29uc3QgY2hhciAqZGVzYyA9IGxpYnVzYl9lcnJvcl9uYW1lKHJj
KTsKPiA+IC0gICAgICAgICAgICBnX3dhcm5pbmcoIkVycm9yIGhhbmRsaW5nIFVTQiBldmVudHM6
ICVzIFslaV0iLCBkZXNjLCByYyk7Cj4gPiArICAgICAgICBpZiAoIXNwaWNlX3VzYl9iYWNrZW5k
X2hhbmRsZV9ldmVudHMocHJpdi0+Y29udGV4dCkpIHsKPiA+ICAgICAgICAgICAgICBicmVhazsK
PiA+ICAgICAgICAgIH0KPiA+ICAgICAgfQo+ID4gQEAgLTExMjAsNyArMTAzMCw3IEBAIHN0YXRp
YyB2b2lkIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9jaGVja19yZWRpcl9vbl9jb25uZWN0KAo+
ID4gICAgICBTcGljZVVzYkRldmljZU1hbmFnZXJQcml2YXRlICpwcml2ID0gc2VsZi0+cHJpdjsK
PiA+ICAgICAgR1Rhc2sgKnRhc2s7Cj4gPiAgICAgIFNwaWNlVXNiRGV2aWNlICpkZXZpY2U7Cj4g
PiAtICAgIGxpYnVzYl9kZXZpY2UgKmxpYmRldjsKPiA+ICsgICAgU3BpY2VVc2JCYWNrZW5kRGV2
aWNlICpiZGV2Owo+ID4gICAgICBndWludCBpOwo+ID4KPiA+ICAgICAgaWYgKHByaXYtPnJlZGly
ZWN0X29uX2Nvbm5lY3QgPT0gTlVMTCkKPiA+IEBAIC0xMTMyLDExICsxMDQyLDExIEBAIHN0YXRp
YyB2b2lkIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9jaGVja19yZWRpcl9vbl9jb25uZWN0KAo+
ID4gICAgICAgICAgaWYgKHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9pc19kZXZpY2VfY29ubmVj
dGVkKHNlbGYsIGRldmljZSkpCj4gPiAgICAgICAgICAgICAgY29udGludWU7Cj4gPgo+ID4gLSAg
ICAgICAgbGliZGV2ID0gc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2RldmljZV90b19saWJkZXYo
c2VsZiwgZGV2aWNlKTsKPiA+IC0gICAgICAgIGlmICh1c2JyZWRpcmhvc3RfY2hlY2tfZGV2aWNl
X2ZpbHRlcigKPiA+ICsgICAgICAgIGJkZXYgPSBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfZGV2
aWNlX3RvX2JkZXYoc2VsZiwgZGV2aWNlKTsKPiA+ICsgICAgICAgIGlmIChzcGljZV91c2JfYmFj
a2VuZF9kZXZpY2VfY2hlY2tfZmlsdGVyKAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBiZGV2LAo+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcml2LT5yZWRpcmVjdF9v
bl9jb25uZWN0X3J1bGVzLAo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcml2LT5y
ZWRpcmVjdF9vbl9jb25uZWN0X3J1bGVzX2NvdW50LAo+ID4gLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBsaWJkZXYsIDApID09IDApIHsKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgcHJpdi0+cmVkaXJlY3Rfb25fY29ubmVjdF9ydWxlc19jb3VudCkgPT0gMCkgewo+ID4gICAg
ICAgICAgICAgIC8qIE5vdGU6IHJlLXVzZXMgc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2Nvbm5l
Y3RfZGV2aWNlX2FzeW5jJ3MKPiA+ICAgICAgICAgICAgICAgICBjb21wbGV0aW9uIGhhbmRsaW5n
IGNvZGUhICovCj4gPiAgICAgICAgICAgICAgdGFzayA9IGdfdGFza19uZXcoc2VsZiwKPiA+IEBA
IC0xMTQ2LDE0ICsxMDU2LDE0IEBAIHN0YXRpYyB2b2lkIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdl
cl9jaGVja19yZWRpcl9vbl9jb25uZWN0KAo+ID4KPiA+ICAgICAgICAgICAgICBzcGljZV91c2Jy
ZWRpcl9jaGFubmVsX2Nvbm5lY3RfZGV2aWNlX2FzeW5jKAo+ID4gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBTUElDRV9VU0JSRURJUl9DSEFOTkVMKGNoYW5uZWwpLAo+ID4gLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBsaWJkZXYsIGRldmljZSwgTlVMTCwKPiA+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgYmRldiwgZGV2aWNlLCBOVUxMLAo+ID4gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfY2hhbm5l
bF9jb25uZWN0X2NiLAo+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrKTsK
PiA+IC0gICAgICAgICAgICBsaWJ1c2JfdW5yZWZfZGV2aWNlKGxpYmRldik7Cj4gPiArICAgICAg
ICAgICAgc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX3VucmVmKGJkZXYpOwo+ID4gICAgICAgICAg
ICAgIHJldHVybjsgLyogV2UndmUgdGFrZW4gdGhlIGNoYW5uZWwhICovCj4gPiAgICAgICAgICB9
Cj4gPgo+ID4gLSAgICAgICAgbGlidXNiX3VucmVmX2RldmljZShsaWJkZXYpOwo+ID4gKyAgICAg
ICAgc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX3VucmVmKGJkZXYpOwo+ID4gICAgICB9Cj4gPiAg
fQo+ID4KPiA+IEBAIC0xMTc3LDggKzEwODcsOCBAQCBzdGF0aWMgU3BpY2VVc2JyZWRpckNoYW5u
ZWwgKnNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9nZXRfY2hhbm5lbF9mb3JfZGV2KAo+ID4gICAg
ICBmb3IgKGkgPSAwOyBpIDwgcHJpdi0+Y2hhbm5lbHMtPmxlbjsgaSsrKSB7Cj4gPiAgICAgICAg
ICBTcGljZVVzYnJlZGlyQ2hhbm5lbCAqY2hhbm5lbCA9IGdfcHRyX2FycmF5X2luZGV4KHByaXYt
PmNoYW5uZWxzLCBpKTsKPiA+ICAgICAgICAgIHNwaWNlX3VzYnJlZGlyX2NoYW5uZWxfbG9jayhj
aGFubmVsKTsKPiA+IC0gICAgICAgIGxpYnVzYl9kZXZpY2UgKmxpYmRldiA9IHNwaWNlX3VzYnJl
ZGlyX2NoYW5uZWxfZ2V0X2RldmljZShjaGFubmVsKTsKPiA+IC0gICAgICAgIGlmIChzcGljZV91
c2JfbWFuYWdlcl9kZXZpY2VfZXF1YWxfbGliZGV2KG1hbmFnZXIsIGRldmljZSwgbGliZGV2KSkg
ewo+ID4gKyAgICAgICAgU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpiZGV2ID0gc3BpY2VfdXNicmVk
aXJfY2hhbm5lbF9nZXRfZGV2aWNlKGNoYW5uZWwpOwo+ID4gKyAgICAgICAgaWYgKHNwaWNlX3Vz
Yl9tYW5hZ2VyX2RldmljZV9lcXVhbF9iZGV2KG1hbmFnZXIsIGRldmljZSwgYmRldikpIHsKPiA+
ICAgICAgICAgICAgICBzcGljZV91c2JyZWRpcl9jaGFubmVsX3VubG9jayhjaGFubmVsKTsKPiA+
ICAgICAgICAgICAgICByZXR1cm4gY2hhbm5lbDsKPiA+ICAgICAgICAgIH0KPiA+IEBAIC0xMjM1
LDkgKzExNDUsOSBAQCBHUHRyQXJyYXkqIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9nZXRfZGV2
aWNlc193aXRoX2ZpbHRlcigKPiA+ICAgICAgICAgIFNwaWNlVXNiRGV2aWNlICpkZXZpY2UgPSBn
X3B0cl9hcnJheV9pbmRleChwcml2LT5kZXZpY2VzLCBpKTsKPiA+Cj4gPiAgICAgICAgICBpZiAo
cnVsZXMpIHsKPiA+IC0gICAgICAgICAgICBsaWJ1c2JfZGV2aWNlICpsaWJkZXYgPQo+ID4gLSAg
ICAgICAgICAgICAgICBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfZGV2aWNlX3RvX2xpYmRldihz
ZWxmLCBkZXZpY2UpOwo+ID4gLSAgICAgICAgICAgIGlmICh1c2JyZWRpcmhvc3RfY2hlY2tfZGV2
aWNlX2ZpbHRlcihydWxlcywgY291bnQsIGxpYmRldiwgMCkgIT0gMCkKPiA+ICsgICAgICAgICAg
ICBTcGljZVVzYkJhY2tlbmREZXZpY2UgKmJkZXYgPQo+ID4gKyAgICAgICAgICAgICAgICBzcGlj
ZV91c2JfZGV2aWNlX21hbmFnZXJfZGV2aWNlX3RvX2JkZXYoc2VsZiwgZGV2aWNlKTsKPiA+ICsg
ICAgICAgICAgICBpZiAoc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX2NoZWNrX2ZpbHRlcihiZGV2
LCBydWxlcywgY291bnQpICE9IDApCj4gPiAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwo+ID4g
ICAgICAgICAgfQo+ID4gICAgICAgICAgZ19wdHJfYXJyYXlfYWRkKGRldmljZXNfY29weSwgc3Bp
Y2VfdXNiX2RldmljZV9yZWYoZGV2aWNlKSk7Cj4gPiBAQCAtMTMxMSw3ICsxMjIxLDcgQEAgX3Nw
aWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9jb25uZWN0X2RldmljZV9hc3luYyhTcGljZVVzYkRldmlj
ZU1hbmFnZXIgKnNlbGYsCj4gPiAgICAgIHRhc2sgPSBnX3Rhc2tfbmV3KHNlbGYsIGNhbmNlbGxh
YmxlLCBjYWxsYmFjaywgdXNlcl9kYXRhKTsKPiA+Cj4gPiAgICAgIFNwaWNlVXNiRGV2aWNlTWFu
YWdlclByaXZhdGUgKnByaXYgPSBzZWxmLT5wcml2Owo+ID4gLSAgICBsaWJ1c2JfZGV2aWNlICps
aWJkZXY7Cj4gPiArICAgIFNwaWNlVXNiQmFja2VuZERldmljZSAqYmRldjsKPiA+ICAgICAgZ3Vp
bnQgaTsKPiA+Cj4gPiAgICAgIGlmIChzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfaXNfZGV2aWNl
X2Nvbm5lY3RlZChzZWxmLCBkZXZpY2UpKSB7Cj4gPiBAQCAtMTMyNywxNCArMTIzNywxNCBAQCBf
c3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2Nvbm5lY3RfZGV2aWNlX2FzeW5jKFNwaWNlVXNiRGV2
aWNlTWFuYWdlciAqc2VsZiwKPiA+ICAgICAgICAgIGlmIChzcGljZV91c2JyZWRpcl9jaGFubmVs
X2dldF9kZXZpY2UoY2hhbm5lbCkpCj4gPiAgICAgICAgICAgICAgY29udGludWU7IC8qIFNraXAg
YWxyZWFkeSB1c2VkIGNoYW5uZWxzICovCj4gPgo+ID4gLSAgICAgICAgbGliZGV2ID0gc3BpY2Vf
dXNiX2RldmljZV9tYW5hZ2VyX2RldmljZV90b19saWJkZXYoc2VsZiwgZGV2aWNlKTsKPiA+ICsg
ICAgICAgIGJkZXYgPSBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfZGV2aWNlX3RvX2JkZXYoc2Vs
ZiwgZGV2aWNlKTsKPiA+ICAgICAgICAgIHNwaWNlX3VzYnJlZGlyX2NoYW5uZWxfY29ubmVjdF9k
ZXZpY2VfYXN5bmMoY2hhbm5lbCwKPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBsaWJkZXYsCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmRldiwKPiA+
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXZpY2UsCj4gPiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgY2FuY2VsbGFibGUsCj4gPiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2NoYW5uZWxfY29ubmVj
dF9jYiwKPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrKTsKPiA+IC0g
ICAgICAgIGxpYnVzYl91bnJlZl9kZXZpY2UobGliZGV2KTsKPiA+ICsgICAgICAgIHNwaWNlX3Vz
Yl9iYWNrZW5kX2RldmljZV91bnJlZihiZGV2KTsKPiA+ICAgICAgICAgIHJldHVybjsKPiA+ICAg
ICAgfQo+ID4KPiA+IEBAIC0xNTk2LDEzICsxNTA2LDE0IEBAIHNwaWNlX3VzYl9kZXZpY2VfbWFu
YWdlcl9jYW5fcmVkaXJlY3RfZGV2aWNlKFNwaWNlVXNiRGV2aWNlTWFuYWdlciAgKnNlbGYsCj4g
Pgo+ID4gICAgICBpZiAoZ3Vlc3RfZmlsdGVyX3J1bGVzKSB7Cj4gPiAgICAgICAgICBnYm9vbGVh
biBmaWx0ZXJfb2s7Cj4gPiAtICAgICAgICBsaWJ1c2JfZGV2aWNlICpsaWJkZXY7Cj4gPiAtCj4g
PiAtICAgICAgICBsaWJkZXYgPSBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfZGV2aWNlX3RvX2xp
YmRldihzZWxmLCBkZXZpY2UpOwo+ID4gLSAgICAgICAgZmlsdGVyX29rID0gKHVzYnJlZGlyaG9z
dF9jaGVja19kZXZpY2VfZmlsdGVyKAo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICBn
dWVzdF9maWx0ZXJfcnVsZXMsIGd1ZXN0X2ZpbHRlcl9ydWxlc19jb3VudCwKPiA+IC0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgbGliZGV2LCAwKSA9PSAwKTsKPiA+IC0gICAgICAgIGxpYnVz
Yl91bnJlZl9kZXZpY2UobGliZGV2KTsKPiA+ICsgICAgICAgIFNwaWNlVXNiQmFja2VuZERldmlj
ZSAqYmRldjsKPiA+ICsKPiA+ICsgICAgICAgIGJkZXYgPSBzcGljZV91c2JfZGV2aWNlX21hbmFn
ZXJfZGV2aWNlX3RvX2JkZXYoc2VsZiwgZGV2aWNlKTsKPiA+ICsgICAgICAgIGZpbHRlcl9vayA9
IChzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfY2hlY2tfZmlsdGVyKAo+ID4gKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBiZGV2LAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBn
dWVzdF9maWx0ZXJfcnVsZXMsCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgIGd1ZXN0
X2ZpbHRlcl9ydWxlc19jb3VudCkgPT0gMCk7Cj4gPiArICAgICAgICBzcGljZV91c2JfYmFja2Vu
ZF9kZXZpY2VfdW5yZWYoYmRldik7Cj4gPiAgICAgICAgICBpZiAoIWZpbHRlcl9vaykgewo+ID4g
ICAgICAgICAgICAgIGdfc2V0X2Vycm9yX2xpdGVyYWwoZXJyLCBTUElDRV9DTElFTlRfRVJST1Is
IFNQSUNFX0NMSUVOVF9FUlJPUl9GQUlMRUQsCj4gPiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBfKCJTb21lIFVTQiBkZXZpY2VzIGFyZSBibG9ja2VkIGJ5IGhvc3QgcG9saWN5Iikp
Owo+ID4gQEAgLTE2OTYsNjAgKzE2MDcsMjcgQEAgZ2NoYXIgKnNwaWNlX3VzYl9kZXZpY2VfZ2V0
X2Rlc2NyaXB0aW9uKFNwaWNlVXNiRGV2aWNlICpkZXZpY2UsIGNvbnN0IGdjaGFyICpmb3IKPiA+
Cj4gPgo+ID4gICNpZmRlZiBVU0VfVVNCUkVESVIKPiA+IC1zdGF0aWMgZ2Jvb2xlYW4gcHJvYmVf
aXNvY2hyb25vdXNfZW5kcG9pbnQobGlidXNiX2RldmljZSAqbGliZGV2KQo+ID4gLXsKPiA+IC0g
ICAgc3RydWN0IGxpYnVzYl9jb25maWdfZGVzY3JpcHRvciAqY29uZl9kZXNjOwo+ID4gLSAgICBn
Ym9vbGVhbiBpc29jX2ZvdW5kID0gRkFMU0U7Cj4gPiAtICAgIGdpbnQgaSwgaiwgazsKPiA+IC0K
PiA+IC0gICAgZ19yZXR1cm5fdmFsX2lmX2ZhaWwobGliZGV2ICE9IE5VTEwsIEZBTFNFKTsKPiA+
IC0KPiA+IC0gICAgaWYgKGxpYnVzYl9nZXRfYWN0aXZlX2NvbmZpZ19kZXNjcmlwdG9yKGxpYmRl
diwgJmNvbmZfZGVzYykgIT0gMCkgewo+ID4gLSAgICAgICAgZ19yZXR1cm5fdmFsX2lmX3JlYWNo
ZWQoRkFMU0UpOwo+ID4gLSAgICB9Cj4gPiAtCj4gPiAtICAgIGZvciAoaSA9IDA7ICFpc29jX2Zv
dW5kICYmIGkgPCBjb25mX2Rlc2MtPmJOdW1JbnRlcmZhY2VzOyBpKyspIHsKPiA+IC0gICAgICAg
IGZvciAoaiA9IDA7ICFpc29jX2ZvdW5kICYmIGogPCBjb25mX2Rlc2MtPmludGVyZmFjZVtpXS5u
dW1fYWx0c2V0dGluZzsgaisrKSB7Cj4gPiAtICAgICAgICAgICAgZm9yIChrID0gMDsgIWlzb2Nf
Zm91bmQgJiYgayA8IGNvbmZfZGVzYy0+aW50ZXJmYWNlW2ldLmFsdHNldHRpbmdbal0uYk51bUVu
ZHBvaW50cztrKyspIHsKPiA+IC0gICAgICAgICAgICAgICAgZ2ludCBhdHRyaWJ1dGVzID0gY29u
Zl9kZXNjLT5pbnRlcmZhY2VbaV0uYWx0c2V0dGluZ1tqXS5lbmRwb2ludFtrXS5ibUF0dHJpYnV0
ZXM7Cj4gPiAtICAgICAgICAgICAgICAgIGdpbnQgdHlwZSA9IGF0dHJpYnV0ZXMgJiBMSUJVU0Jf
VFJBTlNGRVJfVFlQRV9NQVNLOwo+ID4gLSAgICAgICAgICAgICAgICBpZiAodHlwZSA9PSBMSUJV
U0JfVFJBTlNGRVJfVFlQRV9JU09DSFJPTk9VUykKPiA+IC0gICAgICAgICAgICAgICAgICAgIGlz
b2NfZm91bmQgPSBUUlVFOwo+ID4gLSAgICAgICAgICAgIH0KPiA+IC0gICAgICAgIH0KPiA+IC0g
ICAgfQo+ID4gLQo+ID4gLSAgICBsaWJ1c2JfZnJlZV9jb25maWdfZGVzY3JpcHRvcihjb25mX2Rl
c2MpOwo+ID4gLSAgICByZXR1cm4gaXNvY19mb3VuZDsKPiA+IC19Cj4gPiAtCj4gPiAgLyoKPiA+
ICAgKiBTcGljZVVzYkRldmljZUluZm8KPiA+ICAgKi8KPiA+IC1zdGF0aWMgU3BpY2VVc2JEZXZp
Y2VJbmZvICpzcGljZV91c2JfZGV2aWNlX25ldyhsaWJ1c2JfZGV2aWNlICpsaWJkZXYpCj4gPiAr
c3RhdGljIFNwaWNlVXNiRGV2aWNlSW5mbyAqc3BpY2VfdXNiX2RldmljZV9uZXcoU3BpY2VVc2JC
YWNrZW5kRGV2aWNlICpiZGV2KQo+ID4gIHsKPiA+ICAgICAgU3BpY2VVc2JEZXZpY2VJbmZvICpp
bmZvOwo+ID4gLSAgICBpbnQgdmlkLCBwaWQ7Cj4gPiAtICAgIGd1aW50OCBidXMsIGFkZHI7Cj4g
PiAtCj4gPiAtICAgIGdfcmV0dXJuX3ZhbF9pZl9mYWlsKGxpYmRldiAhPSBOVUxMLCBOVUxMKTsK
PiA+ICsgICAgY29uc3QgVXNiRGV2aWNlSW5mb3JtYXRpb24gKmJkZXZfaW5mbzsKPiA+Cj4gPiAt
ICAgIGJ1cyA9IGxpYnVzYl9nZXRfYnVzX251bWJlcihsaWJkZXYpOwo+ID4gLSAgICBhZGRyID0g
bGlidXNiX2dldF9kZXZpY2VfYWRkcmVzcyhsaWJkZXYpOwo+ID4gKyAgICBnX3JldHVybl92YWxf
aWZfZmFpbChiZGV2ICE9IE5VTEwsIE5VTEwpOwo+ID4KPiA+IC0gICAgaWYgKCFzcGljZV91c2Jf
ZGV2aWNlX21hbmFnZXJfZ2V0X2xpYmRldl92aWRfcGlkKGxpYmRldiwgJnZpZCwgJnBpZCkpIHsK
PiA+IC0gICAgICAgIHJldHVybiBOVUxMOwo+ID4gLSAgICB9Cj4gPiArICAgIGJkZXZfaW5mbyA9
IHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9nZXRfaW5mbyhiZGV2KTsKPiA+Cj4gPiAgICAgIGlu
Zm8gPSBnX25ldzAoU3BpY2VVc2JEZXZpY2VJbmZvLCAxKTsKPiA+Cj4gPiAtICAgIGluZm8tPmJ1
c251bSAgPSBidXM7Cj4gPiAtICAgIGluZm8tPmRldmFkZHIgPSBhZGRyOwo+ID4gLSAgICBpbmZv
LT52aWQgPSB2aWQ7Cj4gPiAtICAgIGluZm8tPnBpZCA9IHBpZDsKPiA+ICsgICAgaW5mby0+YnVz
bnVtICA9IGJkZXZfaW5mby0+YnVzOwo+ID4gKyAgICBpbmZvLT5kZXZhZGRyID0gYmRldl9pbmZv
LT5hZGRyZXNzOwo+ID4gKyAgICBpbmZvLT52aWQgPSBiZGV2X2luZm8tPnZpZDsKPiA+ICsgICAg
aW5mby0+cGlkID0gYmRldl9pbmZvLT5waWQ7Cj4gPiAgICAgIGluZm8tPnJlZiA9IDE7Cj4gPiAt
ICAgIGluZm8tPmlzb2Nocm9ub3VzID0gcHJvYmVfaXNvY2hyb25vdXNfZW5kcG9pbnQobGliZGV2
KTsKPiA+IC0gICAgaW5mby0+bGliZGV2ID0gbGlidXNiX3JlZl9kZXZpY2UobGliZGV2KTsKPiA+
ICsgICAgaW5mby0+YmRldiA9IHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9yZWYoYmRldik7Cj4g
PiArICAgIGluZm8tPmlzb2Nocm9ub3VzID0gc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX2lzb2No
KGJkZXYpOwo+ID4KPiA+ICAgICAgcmV0dXJuIGluZm87Cj4gPiAgfQo+ID4gQEAgLTE4ODUsMzUg
KzE3NjMsMzUgQEAgc3RhdGljIHZvaWQgc3BpY2VfdXNiX2RldmljZV91bnJlZihTcGljZVVzYkRl
dmljZSAqZGV2aWNlKQo+ID4KPiA+ICAgICAgcmVmX2NvdW50X2lzXzAgPSBnX2F0b21pY19pbnRf
ZGVjX2FuZF90ZXN0KCZpbmZvLT5yZWYpOwo+ID4gICAgICBpZiAocmVmX2NvdW50X2lzXzApIHsK
PiA+IC0gICAgICAgIGxpYnVzYl91bnJlZl9kZXZpY2UoaW5mby0+bGliZGV2KTsKPiA+ICsgICAg
ICAgIHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV91bnJlZihpbmZvLT5iZGV2KTsKPiA+ICAgICAg
ICAgIGdfZnJlZShpbmZvKTsKPiA+ICAgICAgfQo+ID4gIH0KPiA+Cj4gPiAgc3RhdGljIGdib29s
ZWFuCj4gPiAtc3BpY2VfdXNiX21hbmFnZXJfZGV2aWNlX2VxdWFsX2xpYmRldihTcGljZVVzYkRl
dmljZU1hbmFnZXIgKm1hbmFnZXIsCj4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBTcGljZVVzYkRldmljZSAqZGV2aWNlLAo+ID4gLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgbGlidXNiX2RldmljZSAgKmxpYmRldikKPiA+ICtzcGljZV91c2Jf
bWFuYWdlcl9kZXZpY2VfZXF1YWxfYmRldihTcGljZVVzYkRldmljZU1hbmFnZXIgKm1hbmFnZXIs
Cj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU3BpY2VVc2JEZXZpY2Ug
KmRldmljZSwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTcGljZVVz
YkJhY2tlbmREZXZpY2UgKmJkZXYpCj4gPiAgewo+ID4gICAgICBTcGljZVVzYkRldmljZUluZm8g
KmluZm8gPSAoU3BpY2VVc2JEZXZpY2VJbmZvICopZGV2aWNlOwo+ID4KPiA+IC0gICAgaWYgKChk
ZXZpY2UgPT0gTlVMTCkgfHwgKGxpYmRldiA9PSBOVUxMKSkKPiA+ICsgICAgaWYgKChkZXZpY2Ug
PT0gTlVMTCkgfHwgKGJkZXYgPT0gTlVMTCkpCj4gPiAgICAgICAgICByZXR1cm4gRkFMU0U7Cj4g
Pgo+ID4gLSAgICByZXR1cm4gaW5mby0+bGliZGV2ID09IGxpYmRldjsKPiA+ICsgICAgcmV0dXJu
IGluZm8tPmJkZXYgPT0gYmRldjsKPiA+ICB9Cj4gPgo+ID4gIC8qCj4gPiAgICogQ2FsbGVyIG11
c3QgbGlidXNiX3VucmVmX2RldmljZSB0aGUgbGlidXNiX2RldmljZSByZXR1cm5lZCBieSB0aGlz
IGZ1bmN0aW9uLgo+ID4gICAqIFJldHVybnMgYSBsaWJ1c2JfZGV2aWNlLCBvciBOVUxMIHVwb24g
ZmFpbHVyZQo+ID4gICAqLwo+ID4gLXN0YXRpYyBsaWJ1c2JfZGV2aWNlICoKPiA+IC1zcGljZV91
c2JfZGV2aWNlX21hbmFnZXJfZGV2aWNlX3RvX2xpYmRldihTcGljZVVzYkRldmljZU1hbmFnZXIg
KnNlbGYsCj4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU3Bp
Y2VVc2JEZXZpY2UgKmRldmljZSkKPiA+ICtzdGF0aWMgU3BpY2VVc2JCYWNrZW5kRGV2aWNlICoK
PiA+ICtzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfZGV2aWNlX3RvX2JkZXYoU3BpY2VVc2JEZXZp
Y2VNYW5hZ2VyICpzZWxmLAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBTcGljZVVzYkRldmljZSAqZGV2aWNlKQo+ID4gIHsKPiA+ICAgICAgLyogU2ltcGx5IHJl
dHVybiBhIHJlZiB0byB0aGUgY2FjaGVkIGxpYmRldiAqLwo+ID4gICAgICBTcGljZVVzYkRldmlj
ZUluZm8gKmluZm8gPSAoU3BpY2VVc2JEZXZpY2VJbmZvICopZGV2aWNlOwo+ID4KPiA+IC0gICAg
cmV0dXJuIGxpYnVzYl9yZWZfZGV2aWNlKGluZm8tPmxpYmRldik7Cj4gPiArICAgIHJldHVybiBz
cGljZV91c2JfYmFja2VuZF9kZXZpY2VfcmVmKGluZm8tPmJkZXYpOwo+ID4gIH0KPiA+ICAjZW5k
aWYgLyogVVNFX1VTQlJFRElSICovCj4gPiBkaWZmIC0tZ2l0IGEvc3JjL3VzYnV0aWwuaCBiL3Ny
Yy91c2J1dGlsLmgKPiA+IGluZGV4IDUwZTM5NDkuLmQxOGQ2ODggMTAwNjQ0Cj4gPiAtLS0gYS9z
cmMvdXNidXRpbC5oCj4gPiArKysgYi9zcmMvdXNidXRpbC5oCj4gPiBAQCAtMjQsNyArMjQsNiBA
QAo+ID4gICNpbmNsdWRlIDxnbGliLmg+Cj4gPgo+ID4gICNpZmRlZiBVU0VfVVNCUkVESVIKPiA+
IC0jaW5jbHVkZSA8bGlidXNiLmg+Cj4gPgo+ID4gIEdfQkVHSU5fREVDTFMKPiA+Cj4gPiBkaWZm
IC0tZ2l0IGEvc3JjL3dpbi11c2ItZGV2LmMgYi9zcmMvd2luLXVzYi1kZXYuYwo+ID4gaW5kZXgg
Y2U1OTliOS4uYzJhNTExNSAxMDA2NDQKPiA+IC0tLSBhL3NyYy93aW4tdXNiLWRldi5jCj4gPiAr
KysgYi9zcmMvd2luLXVzYi1kZXYuYwo+ID4gQEAgLTIzLDExICsyMyw5IEBACj4gPiAgI2luY2x1
ZGUgImNvbmZpZy5oIgo+ID4KPiA+ICAjaW5jbHVkZSA8d2luZG93cy5oPgo+ID4gLSNpbmNsdWRl
IDxsaWJ1c2IuaD4KPiA+ICAjaW5jbHVkZSAid2luLXVzYi1kZXYuaCIKPiA+ICAjaW5jbHVkZSAi
c3BpY2UtbWFyc2hhbC5oIgo+ID4gICNpbmNsdWRlICJzcGljZS11dGlsLmgiCj4gPiAtI2luY2x1
ZGUgInVzYnV0aWwuaCIKPiA+Cj4gPiAgZW51bSB7Cj4gPiAgICAgIFBST1BfMCwKPiA+IEBAIC0z
NSw3ICszMyw3IEBAIGVudW0gewo+ID4gIH07Cj4gPgo+ID4gIHN0cnVjdCBfR1VkZXZDbGllbnRQ
cml2YXRlIHsKPiA+IC0gICAgbGlidXNiX2NvbnRleHQgKmN0eDsKPiA+ICsgICAgU3BpY2VVc2JC
YWNrZW5kICpjdHg7Cj4gPiAgICAgIEdMaXN0ICp1ZGV2X2xpc3Q7Cj4gPiAgICAgIEhXTkQgaHdu
ZDsKPiA+ICAgICAgZ2Jvb2xlYW4gcmVkaXJlY3Rpbmc7Cj4gPiBAQCAtNjgsOSArNjYsNyBAQCBz
dGF0aWMgdm9pZCBnX3VkZXZfZGV2aWNlX3ByaW50X2xpc3QoR0xpc3QgKmwsIGNvbnN0IGdjaGFy
ICptc2cpOwo+ID4gICNlbHNlCj4gPiAgc3RhdGljIHZvaWQgZ191ZGV2X2RldmljZV9wcmludF9s
aXN0KEdMaXN0ICpsLCBjb25zdCBnY2hhciAqbXNnKSB7fQo+ID4gICNlbmRpZgo+ID4gLXN0YXRp
YyB2b2lkIGdfdWRldl9kZXZpY2VfcHJpbnQobGlidXNiX2RldmljZSAqZGV2LCBjb25zdCBnY2hh
ciAqbXNnKTsKPiA+IC0KPiA+IC1zdGF0aWMgZ2Jvb2xlYW4gZ191ZGV2X3NraXBfc2VhcmNoKGxp
YnVzYl9kZXZpY2UgKmRldik7Cj4gPiArc3RhdGljIHZvaWQgZ191ZGV2X2RldmljZV9wcmludChT
cGljZVVzYkJhY2tlbmREZXZpY2UgKmRldiwgY29uc3QgZ2NoYXIgKm1zZyk7Cj4gPgo+ID4gIEdR
dWFyayBnX3VkZXZfY2xpZW50X2Vycm9yX3F1YXJrKHZvaWQpCj4gPiAgewo+ID4gQEAgLTg2LDcg
KzgyLDcgQEAgR1VkZXZDbGllbnQgKmdfdWRldl9jbGllbnRfbmV3KHZvaWQpCj4gPiAgICAgIHJl
dHVybiBzaW5nbGV0b247Cj4gPiAgfQo+ID4KPiA+IC1saWJ1c2JfY29udGV4dCAqZ191ZGV2X2Ns
aWVudF9nZXRfY29udGV4dChHVWRldkNsaWVudCAqY2xpZW50KQo+ID4gK1NwaWNlVXNiQmFja2Vu
ZCAqZ191ZGV2X2NsaWVudF9nZXRfY29udGV4dChHVWRldkNsaWVudCAqY2xpZW50KQo+ID4gIHsK
PiA+ICAgICAgcmV0dXJuIGNsaWVudC0+cHJpdi0+Y3R4Owo+ID4gIH0KPiA+IEBAIC05OSw4ICs5
NSw3IEBAIHN0YXRpYyBzc2l6ZV90Cj4gPiAgZ191ZGV2X2NsaWVudF9saXN0X2RldmljZXMoR1Vk
ZXZDbGllbnQgKnNlbGYsIEdMaXN0ICoqZGV2cywKPiA+ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBHRXJyb3IgKiplcnIsIGNvbnN0IGdjaGFyICpuYW1lKQo+ID4gIHsKPiA+IC0gICAgZ3Nz
aXplIHJjOwo+ID4gLSAgICBsaWJ1c2JfZGV2aWNlICoqbHVzYl9saXN0LCAqKmRldjsKPiA+ICsg
ICAgU3BpY2VVc2JCYWNrZW5kRGV2aWNlICoqbHVzYl9saXN0LCAqKmRldjsKPiA+ICAgICAgR1Vk
ZXZDbGllbnRQcml2YXRlICpwcml2Owo+ID4gICAgICBzc2l6ZV90IG47Cj4gPgo+ID4gQEAgLTEx
MSw0MyArMTA2LDMzIEBAIGdfdWRldl9jbGllbnRfbGlzdF9kZXZpY2VzKEdVZGV2Q2xpZW50ICpz
ZWxmLCBHTGlzdCAqKmRldnMsCj4gPgo+ID4gICAgICBnX3JldHVybl92YWxfaWZfZmFpbChzZWxm
LT5wcml2LT5jdHggIT0gTlVMTCwgLTMpOwo+ID4KPiA+IC0gICAgcmMgPSBsaWJ1c2JfZ2V0X2Rl
dmljZV9saXN0KHByaXYtPmN0eCwgJmx1c2JfbGlzdCk7Cj4gPiAtICAgIGlmIChyYyA8IDApIHsK
PiA+IC0gICAgICAgIGNvbnN0IGNoYXIgKmVycnN0ciA9IGxpYnVzYl9lcnJvcl9uYW1lKHJjKTsK
PiA+IC0gICAgICAgIGdfd2FybmluZygiJXM6IGxpYnVzYl9nZXRfZGV2aWNlX2xpc3QgZmFpbGVk
IC0gJXMiLCBuYW1lLCBlcnJzdHIpOwo+ID4gKyAgICBsdXNiX2xpc3QgPSBzcGljZV91c2JfYmFj
a2VuZF9nZXRfZGV2aWNlX2xpc3QocHJpdi0+Y3R4KTsKPiA+ICsgICAgaWYgKCFsdXNiX2xpc3Qp
IHsKPiA+ICAgICAgICAgIGdfc2V0X2Vycm9yKGVyciwgR19VREVWX0NMSUVOVF9FUlJPUiwgR19V
REVWX0NMSUVOVF9MSUJVU0JfRkFJTEVELAo+ID4gLSAgICAgICAgICAgICAgICAgICAgIiVzOiBF
cnJvciBnZXR0aW5nIGRldmljZSBsaXN0IGZyb20gbGlidXNiOiAlcyBbJSJHX0dTU0laRV9GT1JN
QVQiXSIsCj4gPiAtICAgICAgICAgICAgICAgICAgICBuYW1lLCBlcnJzdHIsIHJjKTsKPiA+ICsg
ICAgICAgICAgICAgICAgICAgICIlczogRXJyb3IgZ2V0dGluZyBVU0IgZGV2aWNlIGxpc3QiLCBu
YW1lKTsKPiA+ICAgICAgICAgIHJldHVybiAtNDsKPiA+ICAgICAgfQo+ID4KPiA+ICAgICAgbiA9
IDA7Cj4gPiAgICAgIGZvciAoZGV2ID0gbHVzYl9saXN0OyAqZGV2OyBkZXYrKykgewo+ID4gLSAg
ICAgICAgaWYgKGdfdWRldl9za2lwX3NlYXJjaCgqZGV2KSkgewo+ID4gLSAgICAgICAgICAgIGNv
bnRpbnVlOwo+ID4gLSAgICAgICAgfQo+ID4gLSAgICAgICAgKmRldnMgPSBnX2xpc3RfcHJlcGVu
ZCgqZGV2cywgbGlidXNiX3JlZl9kZXZpY2UoKmRldikpOwo+ID4gKyAgICAgICAgKmRldnMgPSBn
X2xpc3RfcHJlcGVuZCgqZGV2cywgc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX3JlZigqZGV2KSk7
Cj4gPiAgICAgICAgICBuKys7Cj4gPiAgICAgIH0KPiA+IC0gICAgbGlidXNiX2ZyZWVfZGV2aWNl
X2xpc3QobHVzYl9saXN0LCAxKTsKPiA+ICsgICAgc3BpY2VfdXNiX2JhY2tlbmRfZnJlZV9kZXZp
Y2VfbGlzdChsdXNiX2xpc3QpOwo+ID4KPiA+ICAgICAgcmV0dXJuIG47Cj4gPiAgfQo+ID4KPiA+
IC1zdGF0aWMgdm9pZCB1bnJlZmVyZW5jZV9saWJ1c2JfZGV2aWNlKGdwb2ludGVyIGRhdGEpCj4g
PiArc3RhdGljIHZvaWQgdW5yZWZlcmVuY2VfYmFja2VuZF9kZXZpY2UoZ3BvaW50ZXIgZGF0YSkK
PiA+ICB7Cj4gPiAtICAgIGxpYnVzYl91bnJlZl9kZXZpY2UoKGxpYnVzYl9kZXZpY2UgKilkYXRh
KTsKPiA+ICsgICAgc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX3VucmVmKChTcGljZVVzYkJhY2tl
bmREZXZpY2UgKilkYXRhKTsKPiA+ICB9Cj4gPgo+ID4gIHN0YXRpYyB2b2lkIGdfdWRldl9jbGll
bnRfZnJlZV9kZXZpY2VfbGlzdChHTGlzdCAqKmRldnMpCj4gPiAgewo+ID4gICAgICBnX3JldHVy
bl9pZl9mYWlsKGRldnMgIT0gTlVMTCk7Cj4gPiAgICAgIGlmICgqZGV2cykgewo+ID4gLSAgICAg
ICAgLyogdGhlIHVucmVmZXJlbmNlX2xpYnVzYl9kZXZpY2UgbWV0aG9kIGlzIHJlcXVpcmVkIGFz
Cj4gPiAtICAgICAgICAgKiBsaWJ1c2JfdW5yZWZfZGV2aWNlIGNhbGxpbmcgY29udmVudGlvbiBk
aWZmZXJzIGZyb20gZ2xpYidzCj4gPiAtICAgICAgICAgKiBzZWUgNTU4Yzk2N2VjCj4gPiAtICAg
ICAgICAgKi8KPiA+IC0gICAgICAgIGdfbGlzdF9mcmVlX2Z1bGwoKmRldnMsIHVucmVmZXJlbmNl
X2xpYnVzYl9kZXZpY2UpOwo+ID4gKyAgICAgICAgZ19saXN0X2ZyZWVfZnVsbCgqZGV2cywgdW5y
ZWZlcmVuY2VfYmFja2VuZF9kZXZpY2UpOwo+ID4gICAgICAgICAgKmRldnMgPSBOVUxMOwo+ID4g
ICAgICB9Cj4gPiAgfQo+ID4gQEAgLTE2MCw3ICsxNDUsNiBAQCBnX3VkZXZfY2xpZW50X2luaXRh
YmxlX2luaXQoR0luaXRhYmxlICppbml0YWJsZSwgR0NhbmNlbGxhYmxlICpjYW5jZWxsYWJsZSwK
PiA+ICAgICAgR1VkZXZDbGllbnQgKnNlbGY7Cj4gPiAgICAgIEdVZGV2Q2xpZW50UHJpdmF0ZSAq
cHJpdjsKPiA+ICAgICAgV05EQ0xBU1Mgd2NsczsKPiA+IC0gICAgaW50IHJjOwo+ID4KPiA+ICAg
ICAgZ19yZXR1cm5fdmFsX2lmX2ZhaWwoR19VREVWX0lTX0NMSUVOVChpbml0YWJsZSksIEZBTFNF
KTsKPiA+ICAgICAgZ19yZXR1cm5fdmFsX2lmX2ZhaWwoY2FuY2VsbGFibGUgPT0gTlVMTCwgRkFM
U0UpOwo+ID4gQEAgLTE2OCwxNCArMTUyLDExIEBAIGdfdWRldl9jbGllbnRfaW5pdGFibGVfaW5p
dChHSW5pdGFibGUgKmluaXRhYmxlLCBHQ2FuY2VsbGFibGUgKmNhbmNlbGxhYmxlLAo+ID4gICAg
ICBzZWxmID0gR19VREVWX0NMSUVOVChpbml0YWJsZSk7Cj4gPiAgICAgIHByaXYgPSBzZWxmLT5w
cml2Owo+ID4KPiA+IC0gICAgcmMgPSBsaWJ1c2JfaW5pdCgmcHJpdi0+Y3R4KTsKPiA+IC0gICAg
aWYgKHJjIDwgMCkgewo+ID4gLSAgICAgICAgY29uc3QgY2hhciAqZXJyc3RyID0gbGlidXNiX2Vy
cm9yX25hbWUocmMpOwo+ID4gLSAgICAgICAgZ193YXJuaW5nKCJFcnJvciBpbml0aWFsaXppbmcg
VVNCIHN1cHBvcnQ6ICVzIFslaV0iLCBlcnJzdHIsIHJjKTsKPiA+IC0gICAgICAgIGdfc2V0X2Vy
cm9yKGVyciwgR19VREVWX0NMSUVOVF9FUlJPUiwgR19VREVWX0NMSUVOVF9MSUJVU0JfRkFJTEVE
LAo+ID4gLSAgICAgICAgICAgICAgICAgICAgIkVycm9yIGluaXRpYWxpemluZyBVU0Igc3VwcG9y
dDogJXMgWyVpXSIsIGVycnN0ciwgcmMpOwo+ID4gKyAgICBwcml2LT5jdHggPSBzcGljZV91c2Jf
YmFja2VuZF9uZXcoZXJyKTsKPiA+ICsgICAgaWYgKCFwcml2LT5jdHgpIHsKPiA+ICAgICAgICAg
IHJldHVybiBGQUxTRTsKPiA+ICAgICAgfQo+ID4gKwo+ID4gICNpZmRlZiBHX09TX1dJTjMyCj4g
PiAgI2lmIExJQlVTQl9BUElfVkVSU0lPTiA+PSAweDAxMDAwMTA2Cj4gPiAgICAgIGxpYnVzYl9z
ZXRfb3B0aW9uKHByaXYtPmN0eCwgTElCVVNCX09QVElPTl9VU0VfVVNCREspOwo+ID4gQEAgLTI0
OCw5ICsyMjksOSBAQCBzdGF0aWMgdm9pZCBnX3VkZXZfY2xpZW50X2ZpbmFsaXplKEdPYmplY3Qg
KmdvYmplY3QpCj4gPiAgICAgIFVucmVnaXN0ZXJDbGFzcyhHX1VERVZfQ0xJRU5UX1dJTkNMQVNT
X05BTUUsIE5VTEwpOwo+ID4gICAgICBnX3VkZXZfY2xpZW50X2ZyZWVfZGV2aWNlX2xpc3QoJnBy
aXYtPnVkZXZfbGlzdCk7Cj4gPgo+ID4gLSAgICAvKiBmcmVlIGxpYnVzYiBjb250ZXh0IGluaXRp
YWxpemluZyBieSBsaWJ1c2JfaW5pdCgpICovCj4gPiArICAgIC8qIGZyZWUgYmFja2VuZCBjb250
ZXh0ICovCj4gPiAgICAgIGdfd2Fybl9pZl9mYWlsKHByaXYtPmN0eCAhPSBOVUxMKTsKPiA+IC0g
ICAgbGlidXNiX2V4aXQocHJpdi0+Y3R4KTsKPiA+ICsgICAgc3BpY2VfdXNiX2JhY2tlbmRfZGVs
ZXRlKHByaXYtPmN0eCk7Cj4gPgo+ID4gICAgICAvKiBDaGFpbiB1cCB0byB0aGUgcGFyZW50IGNs
YXNzICovCj4gPiAgICAgIGlmIChHX09CSkVDVF9DTEFTUyhnX3VkZXZfY2xpZW50X3BhcmVudF9j
bGFzcyktPmZpbmFsaXplKQo+ID4gQEAgLTM0MCwyMCArMzIxLDE4IEBAIHN0YXRpYyB2b2lkIGdf
dWRldl9jbGllbnRfY2xhc3NfaW5pdChHVWRldkNsaWVudENsYXNzICprbGFzcykKPiA+ICB9Cj4g
Pgo+ID4gIC8qIGNvbXBhcmluZyBidXM6YWRkciBhbmQgdmlkOnBpZCAqLwo+ID4gLXN0YXRpYyBn
aW50IGNvbXBhcmVfbGlidXNiX2RldmljZXMoZ2NvbnN0cG9pbnRlciBhLCBnY29uc3Rwb2ludGVy
IGIpCj4gPiArc3RhdGljIGdpbnQgY29tcGFyZV91c2JfZGV2aWNlcyhnY29uc3Rwb2ludGVyIGEs
IGdjb25zdHBvaW50ZXIgYikKPiA+ICB7Cj4gPiAtICAgIGxpYnVzYl9kZXZpY2UgKmFfZGV2ID0g
KGxpYnVzYl9kZXZpY2UgKilhOwo+ID4gLSAgICBsaWJ1c2JfZGV2aWNlICpiX2RldiA9IChsaWJ1
c2JfZGV2aWNlICopYjsKPiA+IC0gICAgc3RydWN0IGxpYnVzYl9kZXZpY2VfZGVzY3JpcHRvciBh
X2Rlc2MsIGJfZGVzYzsKPiA+ICsgICAgY29uc3QgVXNiRGV2aWNlSW5mb3JtYXRpb24gKmFfaW5m
bywgKmJfaW5mbzsKPiA+ICAgICAgZ2Jvb2xlYW4gc2FtZV9idXMsIHNhbWVfYWRkciwgc2FtZV92
aWQsIHNhbWVfcGlkOwo+ID4gKyAgICBhX2luZm8gPSBzcGljZV91c2JfYmFja2VuZF9kZXZpY2Vf
Z2V0X2luZm8oKFNwaWNlVXNiQmFja2VuZERldmljZSAqKWEpOwo+ID4gKyAgICBiX2luZm8gPSBz
cGljZV91c2JfYmFja2VuZF9kZXZpY2VfZ2V0X2luZm8oKFNwaWNlVXNiQmFja2VuZERldmljZSAq
KWIpOwo+ID4KPiA+IC0gICAgbGlidXNiX2dldF9kZXZpY2VfZGVzY3JpcHRvcihhX2RldiwgJmFf
ZGVzYyk7Cj4gPiAtICAgIGxpYnVzYl9nZXRfZGV2aWNlX2Rlc2NyaXB0b3IoYl9kZXYsICZiX2Rl
c2MpOwo+ID4KPiA+IC0gICAgc2FtZV9idXMgPSAobGlidXNiX2dldF9idXNfbnVtYmVyKGFfZGV2
KSA9PSBsaWJ1c2JfZ2V0X2J1c19udW1iZXIoYl9kZXYpKTsKPiA+IC0gICAgc2FtZV9hZGRyID0g
KGxpYnVzYl9nZXRfZGV2aWNlX2FkZHJlc3MoYV9kZXYpID09IGxpYnVzYl9nZXRfZGV2aWNlX2Fk
ZHJlc3MoYl9kZXYpKTsKPiA+IC0gICAgc2FtZV92aWQgPSAoYV9kZXNjLmlkVmVuZG9yID09IGJf
ZGVzYy5pZFZlbmRvcik7Cj4gPiAtICAgIHNhbWVfcGlkID0gKGFfZGVzYy5pZFByb2R1Y3QgPT0g
Yl9kZXNjLmlkUHJvZHVjdCk7Cj4gPiArICAgIHNhbWVfYnVzID0gKGFfaW5mby0+YnVzID09IGJf
aW5mby0+YnVzKTsKPiA+ICsgICAgc2FtZV9hZGRyID0gKGFfaW5mby0+YWRkcmVzcyA9PSBiX2lu
Zm8tPmFkZHJlc3MpOwo+ID4gKyAgICBzYW1lX3ZpZCA9IChhX2luZm8tPnZpZCA9PSBiX2luZm8t
PnZpZCk7Cj4gPiArICAgIHNhbWVfcGlkID0gKGFfaW5mby0+cGlkID09IGJfaW5mby0+cGlkKTsK
PiA+Cj4gPiAgICAgIHJldHVybiAoc2FtZV9idXMgJiYgc2FtZV9hZGRyICYmIHNhbWVfdmlkICYm
IHNhbWVfcGlkKSA/IDAgOiAtMTsKPiA+ICB9Cj4gPiBAQCAtMzYzLDEyICszNDIsMTIgQEAgc3Rh
dGljIHZvaWQgdXBkYXRlX2RldmljZV9saXN0KEdVZGV2Q2xpZW50ICpzZWxmLCBHTGlzdCAqbmV3
X2RldmljZV9saXN0KQo+ID4gICAgICBHTGlzdCAqZGV2Owo+ID4KPiA+ICAgICAgZm9yIChkZXYg
PSBnX2xpc3RfZmlyc3QobmV3X2RldmljZV9saXN0KTsgZGV2ICE9IE5VTEw7IGRldiA9IGdfbGlz
dF9uZXh0KGRldikpIHsKPiA+IC0gICAgICAgIEdMaXN0ICpmb3VuZCA9IGdfbGlzdF9maW5kX2N1
c3RvbShzZWxmLT5wcml2LT51ZGV2X2xpc3QsIGRldi0+ZGF0YSwgY29tcGFyZV9saWJ1c2JfZGV2
aWNlcyk7Cj4gPiArICAgICAgICBHTGlzdCAqZm91bmQgPSBnX2xpc3RfZmluZF9jdXN0b20oc2Vs
Zi0+cHJpdi0+dWRldl9saXN0LCBkZXYtPmRhdGEsIGNvbXBhcmVfdXNiX2RldmljZXMpOwo+ID4g
ICAgICAgICAgaWYgKGZvdW5kICE9IE5VTEwpIHsKPiA+ICAgICAgICAgICAgICAvKiBrZWVwIG9s
ZCBleGlzdGluZyBsaWJ1c2JfZGV2aWNlIGluIHRoZSBuZXcgbGlzdCwgd2hlbgo+ID4gICAgICAg
ICAgICAgICAgIHVzYi1kZXYtbWFuYWdlciB3aWxsIG1haW50YWluIGl0cyBvd24gbGlzdCBvZiBs
aWJ1c2JfZGV2aWNlLAo+ID4gICAgICAgICAgICAgICAgIHRoZXNlIGxpc3RzIHdpbGwgYmUgY29t
cGxldGVseSBjb25zaXN0ZW50ICovCj4gPiAtICAgICAgICAgICAgbGlidXNiX2RldmljZSAqdGVt
cCA9IGZvdW5kLT5kYXRhOwo+ID4gKyAgICAgICAgICAgIFNwaWNlVXNiQmFja2VuZERldmljZSAq
dGVtcCA9IGZvdW5kLT5kYXRhOwo+ID4gICAgICAgICAgICAgIGZvdW5kLT5kYXRhID0gZGV2LT5k
YXRhOwo+ID4gICAgICAgICAgICAgIGRldi0+ZGF0YSA9IHRlbXA7Cj4gPiAgICAgICAgICB9Cj4g
PiBAQCAtMzg2LDcgKzM2NSw3IEBAIHN0YXRpYyB2b2lkIG5vdGlmeV9kZXZfc3RhdGVfY2hhbmdl
KEdVZGV2Q2xpZW50ICpzZWxmLAo+ID4gICAgICBHTGlzdCAqZGV2Owo+ID4KPiA+ICAgICAgZm9y
IChkZXYgPSBnX2xpc3RfZmlyc3Qob2xkX2xpc3QpOyBkZXYgIT0gTlVMTDsgZGV2ID0gZ19saXN0
X25leHQoZGV2KSkgewo+ID4gLSAgICAgICAgR0xpc3QgKmZvdW5kID0gZ19saXN0X2ZpbmRfY3Vz
dG9tKG5ld19saXN0LCBkZXYtPmRhdGEsIGNvbXBhcmVfbGlidXNiX2RldmljZXMpOwo+ID4gKyAg
ICAgICAgR0xpc3QgKmZvdW5kID0gZ19saXN0X2ZpbmRfY3VzdG9tKG5ld19saXN0LCBkZXYtPmRh
dGEsIGNvbXBhcmVfdXNiX2RldmljZXMpOwo+ID4gICAgICAgICAgaWYgKGZvdW5kID09IE5VTEwp
IHsKPiA+ICAgICAgICAgICAgICBnX3VkZXZfZGV2aWNlX3ByaW50KGRldi0+ZGF0YSwgYWRkID8g
ImFkZCIgOiAicmVtb3ZlIik7Cj4gPiAgICAgICAgICAgICAgZ19zaWduYWxfZW1pdChzZWxmLCBz
aWduYWxzW1VFVkVOVF9TSUdOQUxdLCAwLCBkZXYtPmRhdGEsIGFkZCk7Cj4gPiBAQCAtNDQ3LDI5
ICs0MjYsMTEgQEAgc3RhdGljIHZvaWQgZ191ZGV2X2RldmljZV9wcmludF9saXN0KEdMaXN0ICps
LCBjb25zdCBnY2hhciAqbXNnKQo+ID4gIH0KPiA+ICAjZW5kaWYKPiA+Cj4gPiAtc3RhdGljIHZv
aWQgZ191ZGV2X2RldmljZV9wcmludChsaWJ1c2JfZGV2aWNlICpkZXYsIGNvbnN0IGdjaGFyICpt
c2cpCj4gPiArc3RhdGljIHZvaWQgZ191ZGV2X2RldmljZV9wcmludChTcGljZVVzYkJhY2tlbmRE
ZXZpY2UgKmRldiwgY29uc3QgZ2NoYXIgKm1zZykKPiA+ICB7Cj4gPiAtICAgIHN0cnVjdCBsaWJ1
c2JfZGV2aWNlX2Rlc2NyaXB0b3IgZGVzYzsKPiA+IC0KPiA+IC0gICAgbGlidXNiX2dldF9kZXZp
Y2VfZGVzY3JpcHRvcihkZXYsICZkZXNjKTsKPiA+ICsgICAgY29uc3QgVXNiRGV2aWNlSW5mb3Jt
YXRpb24gKmluZm8gPSBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfZ2V0X2luZm8oZGV2KTsKPiA+
Cj4gPiAgICAgIFNQSUNFX0RFQlVHKCIlczogJWQuJWQgMHglMDR4OjB4JTA0eCBjbGFzcyAlZCIs
IG1zZywKPiA+IC0gICAgICAgICAgICAgICAgbGlidXNiX2dldF9idXNfbnVtYmVyKGRldiksCj4g
PiAtICAgICAgICAgICAgICAgIGxpYnVzYl9nZXRfZGV2aWNlX2FkZHJlc3MoZGV2KSwKPiA+IC0g
ICAgICAgICAgICAgICAgZGVzYy5pZFZlbmRvciwgZGVzYy5pZFByb2R1Y3QsIGRlc2MuYkRldmlj
ZUNsYXNzKTsKPiA+IC19Cj4gPiAtCj4gPiAtc3RhdGljIGdib29sZWFuIGdfdWRldl9za2lwX3Nl
YXJjaChsaWJ1c2JfZGV2aWNlICpkZXYpCj4gPiAtewo+ID4gLSAgICBnYm9vbGVhbiBza2lwOwo+
ID4gLSAgICB1aW50OF90IGFkZHIgPSBsaWJ1c2JfZ2V0X2RldmljZV9hZGRyZXNzKGRldik7Cj4g
PiAtICAgIHN0cnVjdCBsaWJ1c2JfZGV2aWNlX2Rlc2NyaXB0b3IgZGVzYzsKPiA+IC0KPiA+IC0g
ICAgbGlidXNiX2dldF9kZXZpY2VfZGVzY3JpcHRvcihkZXYsICZkZXNjKTsKPiA+IC0KPiA+IC0g
ICAgc2tpcCA9ICgoYWRkciA9PSAweGZmKSB8fCAgLyogcm9vdCBodWIgKEhDRCkgKi8KPiA+IC0g
ICAgICAgICAgICAoYWRkciA9PSAxKSB8fCAvKiByb290IGh1YiBhZGRyICovCj4gPiAtICAgICAg
ICAgICAgKGRlc2MuYkRldmljZUNsYXNzID09IExJQlVTQl9DTEFTU19IVUIpIHx8IC8qIGh1Yiov
Cj4gPiAtICAgICAgICAgICAgKGFkZHIgPT0gMCkpOyAvKiBiYWQgYWRkcmVzcyAqLwo+ID4gLSAg
ICByZXR1cm4gc2tpcDsKPiA+ICsgICAgICAgICAgICAgICAgaW5mby0+YnVzLCBpbmZvLT5hZGRy
ZXNzLAo+ID4gKyAgICAgICAgICAgICAgICBpbmZvLT52aWQsIGluZm8tPnBpZCwgaW5mby0+Y2xh
c3MpOwo+ID4gIH0KPiA+IGRpZmYgLS1naXQgYS9zcmMvd2luLXVzYi1kZXYuaCBiL3NyYy93aW4t
dXNiLWRldi5oCj4gPiBpbmRleCBiMWMwZTI3Li5mZGZlNzNhIDEwMDY0NAo+ID4gLS0tIGEvc3Jj
L3dpbi11c2ItZGV2LmgKPiA+ICsrKyBiL3NyYy93aW4tdXNiLWRldi5oCj4gPiBAQCAtMjMsNiAr
MjMsNyBAQAo+ID4gICNkZWZpbmUgX19XSU5fVVNCX0RFVl9IX18KPiA+Cj4gPiAgI2luY2x1ZGUg
PGdpby9naW8uaD4KPiA+ICsjaW5jbHVkZSAidXNiLWJhY2tlbmQuaCIKPiA+Cj4gPiAgR19CRUdJ
Tl9ERUNMUwo+ID4KPiA+IEBAIC01MSwxMiArNTIsMTIgQEAgc3RydWN0IF9HVWRldkNsaWVudENs
YXNzCj4gPiAgICAgIEdPYmplY3RDbGFzcyBwYXJlbnRfY2xhc3M7Cj4gPgo+ID4gICAgICAvKiBz
aWduYWxzICovCj4gPiAtICAgIHZvaWQgKCp1ZXZlbnQpKEdVZGV2Q2xpZW50ICpjbGllbnQsIGxp
YnVzYl9kZXZpY2UgKmRldmljZSwgZ2Jvb2xlYW4gYWRkKTsKPiA+ICsgICAgdm9pZCAoKnVldmVu
dCkoR1VkZXZDbGllbnQgKmNsaWVudCwgU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpkZXZpY2UsIGdi
b29sZWFuIGFkZCk7Cj4gPiAgfTsKPiA+Cj4gPiAgR1R5cGUgZ191ZGV2X2NsaWVudF9nZXRfdHlw
ZSh2b2lkKSBHX0dOVUNfQ09OU1Q7Cj4gPiAgR1VkZXZDbGllbnQgKmdfdWRldl9jbGllbnRfbmV3
KHZvaWQpOwo+ID4gLWxpYnVzYl9jb250ZXh0ICpnX3VkZXZfY2xpZW50X2dldF9jb250ZXh0KEdV
ZGV2Q2xpZW50ICpjbGllbnQpOwo+ID4gK1NwaWNlVXNiQmFja2VuZCAqZ191ZGV2X2NsaWVudF9n
ZXRfY29udGV4dChHVWRldkNsaWVudCAqY2xpZW50KTsKPiA+ICB2b2lkIGdfdWRldl9jbGllbnRf
cmVwb3J0X2RldmljZXMoR1VkZXZDbGllbnQgKmNsaWVudCk7Cj4gPgo+ID4gIEdRdWFyayBnX3Vk
ZXZfY2xpZW50X2Vycm9yX3F1YXJrKHZvaWQpOwo+ID4gLS0KPiA+IDIuMjAuMQo+ID4KPiA+IF9f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCj4gPiBTcGljZS1k
ZXZlbCBtYWlsaW5nIGxpc3QKPiA+IFNwaWNlLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwo+
ID4gaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9zcGljZS1k
ZXZlbAo+IF9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCj4g
U3BpY2UtZGV2ZWwgbWFpbGluZyBsaXN0Cj4gU3BpY2UtZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Au
b3JnCj4gaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9zcGlj
ZS1kZXZlbApfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpT
cGljZS1kZXZlbCBtYWlsaW5nIGxpc3QKU3BpY2UtZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3Jn
Cmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vc3BpY2UtZGV2
ZWw=
