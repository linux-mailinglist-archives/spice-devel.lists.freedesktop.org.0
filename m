Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id A96391247A
	for <lists+spice-devel@lfdr.de>; Fri,  3 May 2019 00:12:21 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 665D3898BC;
	Thu,  2 May 2019 22:12:16 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mail.codeweavers.com (mail.codeweavers.com [50.203.203.244])
 by gabe.freedesktop.org (Postfix) with ESMTPS id A7248898A3
 for <spice-devel@lists.freedesktop.org>; Thu,  2 May 2019 22:12:14 +0000 (UTC)
Received: from jwhite.mn.codeweavers.com ([10.69.137.101])
 by mail.codeweavers.com with esmtpsa (TLS1.2:ECDHE_RSA_AES_128_GCM_SHA256:128)
 (Exim 4.89) (envelope-from <jwhite@codeweavers.com>)
 id 1hMJwv-00084k-FS
 for spice-devel@lists.freedesktop.org; Thu, 02 May 2019 17:13:05 -0500
From: Jeremy White <jwhite@codeweavers.com>
To: spice-devel@lists.freedesktop.org
Date: Thu,  2 May 2019 17:12:09 -0500
Message-Id: <20190502221211.25575-3-jwhite@codeweavers.com>
X-Mailer: git-send-email 2.11.0
In-Reply-To: <20190502221211.25575-1-jwhite@codeweavers.com>
References: <20190502221211.25575-1-jwhite@codeweavers.com>
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt;
 c=relaxed/relaxed; 
 d=codeweavers.com; s=6377696661; h=References:In-Reply-To:Message-Id:Date:
 Subject:To:From:Sender:Reply-To:Cc:MIME-Version:Content-Type:
 Content-Transfer-Encoding:Content-ID:Content-Description:Resent-Date:
 Resent-From:Resent-Sender:Resent-To:Resent-Cc:Resent-Message-ID:List-Id:
 List-Help:List-Unsubscribe:List-Subscribe:List-Post:List-Owner:List-Archive;
 bh=ngNs3thfYf+oIEGUId+9CQfBF1VtAu+jOimyqE8ELmM=; b=I9DgcKfQbQHFC3UwTPDL6Pn19
 Fdxl94VMKfz8dWulxKkM3uI8L/HQyfyD4bkvsnlsMN1VImXCnib2437kvjl/Gh2oVUvkalmOWHn2t
 ZkPetWEJkKvaPFhG2ky4i2/vGDDpIqh4w22ygmLtZEPw195Hp75Qr3+7mF7qgzMlmOMj8=;
Subject: [Spice-devel] [PATCH v3 x11spice 3/5] Initial set of revisions to
 the dummy driver to add DRI and Present.
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

VGhpcyBtYWtlcyB0aGUgZHVtbXkgZHJpdmVyIHNpbWlsYXIgdG8gdGhlIG1vZGUgc2V0dGluZyBk
cml2ZXIuCgpUaGlzIHdvcmsgd2FzIGRvbmUgYnkgSGVucmkgVmVyYmVldCwgd2hpY2ggd2FzIGlu
IHR1cm4gYmFzZWQgaGVhdmlseSBvbgp0aGUgWG9yZyBtb2Rlc2V0dGluZyBkcml2ZXIuCgpTaWdu
ZWQtb2ZmLWJ5OiBKZXJlbXkgV2hpdGUgPGp3aGl0ZUBjb2Rld2VhdmVycy5jb20+Ci0tLQp2Mjog
QXBwbHkgU3BpY2Ugc3R5bGUKdjM6IFJlZmluZSBTcGljZSBzdHlsZSwgZGlzYWJsZSBjb25zb2xl
IGtleWJvYXJkIGFuZCBtb3VzZSBpbiBkZWZhdWx0CiAgICB4b3JnLmNvbmYsIHNoYXJlIGFuIGlu
bGluZSBmdW5jdGlvbiB0byByZXR1cm4gbWljcm9zZWNvbmRzLAogICAgbW9yZSB2aXNpYmx5IGRp
c2FibGUgZ2xhbW9yIHdoZW4gdGhlIHJlbmRlciBub2RlIGlzIHVuYXZhaWxhYmxlLAogICAgbGVh
dmUgZHVtbXkuaCBhcyBkdW1teS5oCi0tLQogc3BpY2UtdmlkZW8tZHVtbXkvLmdpdGlnbm9yZSAg
ICAgICAgICAgICAgICAgICAgICAgfCAgIDkgKwogc3BpY2UtdmlkZW8tZHVtbXkvUkVBRE1FLm1k
ICAgICAgICAgICAgICAgICAgICAgICAgfCAgMTUgKy0KIHNwaWNlLXZpZGVvLWR1bW15L2NvbmZp
Z3VyZS5hYyAgICAgICAgICAgICAgICAgICAgIHwgIDEyICstCiBzcGljZS12aWRlby1kdW1teS9z
cGljZWR1bW15LmNvbmYgICAgICAgICAgICAgICAgICB8ICAzMCArKysKIHNwaWNlLXZpZGVvLWR1
bW15L3NyYy9NYWtlZmlsZS5hbSAgICAgICAgICAgICAgICAgIHwgIDE2ICstCiBzcGljZS12aWRl
by1kdW1teS9zcmMvZHJpMi5jICAgICAgICAgICAgICAgICAgICAgICB8IDI5MSArKysrKysrKysr
KysrKysrKysrKysKIHNwaWNlLXZpZGVvLWR1bW15L3NyYy9kdW1teS5oICAgICAgICAgICAgICAg
ICAgICAgIHwgIDIxICsrCiBzcGljZS12aWRlby1kdW1teS9zcmMvcHJlc2VudC5jICAgICAgICAg
ICAgICAgICAgICB8IDEwMiArKysrKysrKwogLi4uL3NyYy97ZHVtbXlfZHJpdmVyLmMgPT4gc3Bp
Y2VkdW1teV9kcml2ZXIuY30gICAgfCAgODQgKysrKystCiA5IGZpbGVzIGNoYW5nZWQsIDU0OSBp
bnNlcnRpb25zKCspLCAzMSBkZWxldGlvbnMoLSkKIGNyZWF0ZSBtb2RlIDEwMDY0NCBzcGljZS12
aWRlby1kdW1teS8uZ2l0aWdub3JlCiBjcmVhdGUgbW9kZSAxMDA2NDQgc3BpY2UtdmlkZW8tZHVt
bXkvc3BpY2VkdW1teS5jb25mCiBjcmVhdGUgbW9kZSAxMDA2NDQgc3BpY2UtdmlkZW8tZHVtbXkv
c3JjL2RyaTIuYwogY3JlYXRlIG1vZGUgMTAwNjQ0IHNwaWNlLXZpZGVvLWR1bW15L3NyYy9wcmVz
ZW50LmMKIHJlbmFtZSBzcGljZS12aWRlby1kdW1teS9zcmMve2R1bW15X2RyaXZlci5jID0+IHNw
aWNlZHVtbXlfZHJpdmVyLmN9ICg4NyUpCgpkaWZmIC0tZ2l0IGEvc3BpY2UtdmlkZW8tZHVtbXkv
LmdpdGlnbm9yZSBiL3NwaWNlLXZpZGVvLWR1bW15Ly5naXRpZ25vcmUKbmV3IGZpbGUgbW9kZSAx
MDA2NDQKaW5kZXggMDAwMDAwMC4uOWI0YjExZgotLS0gL2Rldi9udWxsCisrKyBiL3NwaWNlLXZp
ZGVvLWR1bW15Ly5naXRpZ25vcmUKQEAgLTAsMCArMSw5IEBACitjb25maWcuaAorY29uZmlnLmgu
aW4KK2xpYnRvb2wKK2x0bWFpbi5zaAorc3RhbXAtaDEKK3NyYy8ubGlicworKi5vCisqLmxvCisq
LmxhCmRpZmYgLS1naXQgYS9zcGljZS12aWRlby1kdW1teS9SRUFETUUubWQgYi9zcGljZS12aWRl
by1kdW1teS9SRUFETUUubWQKaW5kZXggMmE4NGJjMy4uM2U3N2U0ZCAxMDA2NDQKLS0tIGEvc3Bp
Y2UtdmlkZW8tZHVtbXkvUkVBRE1FLm1kCisrKyBiL3NwaWNlLXZpZGVvLWR1bW15L1JFQURNRS5t
ZApAQCAtMSwxOCArMSwxNSBAQAoteGY4Ni12aWRlby1kdW1teSAtIHZpcnR1YWwvb2Zmc2NyZWVu
IGZyYW1lIGJ1ZmZlciBkcml2ZXIgZm9yIHRoZSBYb3JnIFggc2VydmVyCitzcGljZS12aWRlby1k
dW1teSAtIHZpcnR1YWwvb2Zmc2NyZWVuIGZyYW1lIGJ1ZmZlciBkcml2ZXIgZm9yIHRoZSBYb3Jn
IFggc2VydmVyCiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIAogQWxsIHF1ZXN0aW9ucyByZWdhcmRp
bmcgdGhpcyBzb2Z0d2FyZSBzaG91bGQgYmUgZGlyZWN0ZWQgYXQgdGhlCi1Yb3JnIG1haWxpbmcg
bGlzdDoKK3NwaWNlLWRldmVsIG1haWxpbmcgbGlzdDoKIAotICBodHRwczovL2xpc3RzLngub3Jn
L21haWxtYW4vbGlzdGluZm8veG9yZworICBodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9t
YWlsbWFuL2xpc3RpbmZvL3NwaWNlLWRldmVsCiAKLVRoZSBtYXN0ZXIgZGV2ZWxvcG1lbnQgY29k
ZSByZXBvc2l0b3J5IGNhbiBiZSBmb3VuZCBhdDoKK1RoaXMgZHJpdmVyIG9yaWdpbmF0ZWQgd2l0
aCB0aGUgZHVtbXkgZHJpdmVyIGZyb206CiAKICAgaHR0cHM6Ly9naXRsYWIuZnJlZWRlc2t0b3Au
b3JnL3hvcmcvZHJpdmVyL3hmODYtdmlkZW8tZHVtbXkKIAotUGxlYXNlIHN1Ym1pdCBidWcgcmVw
b3J0cyBhbmQgcmVxdWVzdHMgdG8gbWVyZ2UgcGF0Y2hlcyB0aGVyZS4KLQotRm9yIHBhdGNoIHN1
Ym1pc3Npb24gaW5zdHJ1Y3Rpb25zLCBzZWU6Ci0KLSAgaHR0cHM6Ly93d3cueC5vcmcvd2lraS9E
ZXZlbG9wbWVudC9Eb2N1bWVudGF0aW9uL1N1Ym1pdHRpbmdQYXRjaGVzCithbmQgbW9kaWZpZWQg
dG8gYmUgc2ltaWxhciB0byB0aGUgbW9kZSBzZXR0aW5nIGRyaXZlcjoKIAorICBodHRwczovL2dp
dGxhYi5mcmVlZGVza3RvcC5vcmcveG9yZy94c2VydmVyL3RyZWUvbWFzdGVyL2h3L3hmcmVlODYv
ZHJpdmVycy9tb2Rlc2V0dGluZwpkaWZmIC0tZ2l0IGEvc3BpY2UtdmlkZW8tZHVtbXkvY29uZmln
dXJlLmFjIGIvc3BpY2UtdmlkZW8tZHVtbXkvY29uZmlndXJlLmFjCmluZGV4IDJjYTAzMjcuLmU4
NWI3ZTUgMTAwNjQ0Ci0tLSBhL3NwaWNlLXZpZGVvLWR1bW15L2NvbmZpZ3VyZS5hYworKysgYi9z
cGljZS12aWRlby1kdW1teS9jb25maWd1cmUuYWMKQEAgLTIyLDEwICsyMiwxMCBAQAogCiAjIElu
aXRpYWxpemUgQXV0b2NvbmYKIEFDX1BSRVJFUShbMi42MF0pCi1BQ19JTklUKFt4Zjg2LXZpZGVv
LWR1bW15XSwKLSAgICAgICAgWzAuMy44XSwKLSAgICAgICAgW2h0dHBzOi8vZ2l0bGFiLmZyZWVk
ZXNrdG9wLm9yZy94b3JnL2RyaXZlci94Zjg2LXZpZGVvLWR1bW15L2lzc3Vlc10sCi0gICAgICAg
IFt4Zjg2LXZpZGVvLWR1bW15XSkKK0FDX0lOSVQoW3NwaWNlLXZpZGVvLWR1bW15XSwKKyAgICAg
ICAgWzEuMV0sCisgICAgICAgIFtodHRwczovL2dpdGxhYi5mcmVlZGVza3RvcC5vcmcvc3BpY2Uv
eDExc3BpY2UvaXNzdWVzXSwKKyAgICAgICAgW3NwaWNlLXZpZGVvLWR1bW15XSkKIEFDX0NPTkZJ
R19TUkNESVIoW01ha2VmaWxlLmFtXSkKIEFDX0NPTkZJR19IRUFERVJTKFtjb25maWcuaF0pCiBB
Q19DT05GSUdfQVVYX0RJUiguKQpAQCAtNjEsMTAgKzYxLDYgQEAgUEtHX0NIRUNLX01PRFVMRVMo
WE9SRywgW3hvcmctc2VydmVyID49IDEuNC45OS45MDFdIHhwcm90byBmb250c3Byb3RvICRSRVFV
SVJFRF8KIAogIyBDaGVja3MgZm9yIGxpYnJhcmllcy4KIAotCi1EUklWRVJfTkFNRT1kdW1teQot
QUNfU1VCU1QoW0RSSVZFUl9OQU1FXSkKLQogQUNfQ09ORklHX0ZJTEVTKFsKICAgICAgICAgICAg
ICAgICBNYWtlZmlsZQogICAgICAgICAgICAgICAgIHNyYy9NYWtlZmlsZQpkaWZmIC0tZ2l0IGEv
c3BpY2UtdmlkZW8tZHVtbXkvc3BpY2VkdW1teS5jb25mIGIvc3BpY2UtdmlkZW8tZHVtbXkvc3Bp
Y2VkdW1teS5jb25mCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAuLmFkMjAxNmMK
LS0tIC9kZXYvbnVsbAorKysgYi9zcGljZS12aWRlby1kdW1teS9zcGljZWR1bW15LmNvbmYKQEAg
LTAsMCArMSwzMCBAQAorU2VjdGlvbiAiRGV2aWNlIgorICAgIElkZW50aWZpZXIgIlNwaWNlRHVt
bXkiCisgICAgRHJpdmVyICJzcGljZWR1bW15IgorICAgICMgVGhlIFNXY3Vyc29yIG9wdGlvbiBl
bmFibGVzIGEgc29mdHdhcmUgY3Vyc29yLiAgRGVmYXVsdCBmYWxzZS4KKyAgICAjT3B0aW9uICJT
V2N1cnNvciIgImZhbHNlIgorICAgICMgQWNjZWxNZXRob2QgY2FuIGJlIGdsYW1vciAodGhlIGRl
ZmF1bHQpLCBvciBub25lLgorICAgICNPcHRpb24gIkFjY2VsTWV0aG9kIiAiZ2xhbW9yIgorICAg
ICMga21zZGV2IHNwZWNpZmllcyB3aGljaCBmcmFtZWJ1ZmZlciBkZXZpY2UgdG8gdXNlLCBkZWZh
dWx0IC9kZXYvZHJpL3JlbmRlckQxMjgKKyAgICAjT3B0aW9uICJrbXNkZXYiICIvZGV2L2RyaS9y
ZW5kZXJEMTI4IgorICAgIFZpZGVvUmFtIDE2Mzg0CitFbmRTZWN0aW9uCisKK1NlY3Rpb24gIklu
cHV0RGV2aWNlIgorICAgIElkZW50aWZpZXIgImR1bW15X21vdXNlIgorICAgIE9wdGlvbiAiQ29y
ZVBvaW50ZXIiICJ0cnVlIgorICAgIERyaXZlciAidm9pZCIKK0VuZFNlY3Rpb24KKworU2VjdGlv
biAiSW5wdXREZXZpY2UiCisgICAgSWRlbnRpZmllciAiZHVtbXlfa2V5Ym9hcmQiCisgICAgT3B0
aW9uICJDb3JlS2V5Ym9hcmQiICJ0cnVlIgorICAgIERyaXZlciAidm9pZCIKK0VuZFNlY3Rpb24K
KworU2VjdGlvbiAiU2NyZWVuIgorICAgIElkZW50aWZpZXIgIlNwaWNlRHVtbXkiCisgICAgU3Vi
U2VjdGlvbiAiRGlzcGxheSIKKyAgICAgICAgVmlydHVhbCAxOTIwIDEyMDAKKyAgICBFbmRTdWJT
ZWN0aW9uCitFbmRTZWN0aW9uCmRpZmYgLS1naXQgYS9zcGljZS12aWRlby1kdW1teS9zcmMvTWFr
ZWZpbGUuYW0gYi9zcGljZS12aWRlby1kdW1teS9zcmMvTWFrZWZpbGUuYW0KaW5kZXggYzBkODJl
MC4uNmJlZmE0NiAxMDA2NDQKLS0tIGEvc3BpY2UtdmlkZW8tZHVtbXkvc3JjL01ha2VmaWxlLmFt
CisrKyBiL3NwaWNlLXZpZGVvLWR1bW15L3NyYy9NYWtlZmlsZS5hbQpAQCAtMjcsMTMgKzI3LDE1
IEBACiAKIEFNX0NGTEFHUyA9ICQoWE9SR19DRkxBR1MpICQoUENJQUNDRVNTX0NGTEFHUykKIAot
ZHVtbXlfZHJ2X2xhX0xUTElCUkFSSUVTID0gZHVtbXlfZHJ2LmxhCi1kdW1teV9kcnZfbGFfTERG
TEFHUyA9IC1tb2R1bGUgLWF2b2lkLXZlcnNpb24KLWR1bW15X2Rydl9sYV9MSUJBREQgPSAkKFhP
UkdfTElCUykKLWR1bW15X2Rydl9sYWRpciA9IEBtb2R1bGVkaXJAL2RyaXZlcnMKK3NwaWNlZHVt
bXlfZHJ2X2xhX0xUTElCUkFSSUVTID0gc3BpY2VkdW1teV9kcnYubGEKK3NwaWNlZHVtbXlfZHJ2
X2xhX0xERkxBR1MgPSAtbW9kdWxlIC1hdm9pZC12ZXJzaW9uCitzcGljZWR1bW15X2Rydl9sYV9M
SUJBREQgPSAkKFhPUkdfTElCUykKK3NwaWNlZHVtbXlfZHJ2X2xhZGlyID0gQG1vZHVsZWRpckAv
ZHJpdmVycwogCi1kdW1teV9kcnZfbGFfU09VUkNFUyA9IFwKK3NwaWNlZHVtbXlfZHJ2X2xhX1NP
VVJDRVMgPSBcCiAgICAgICAgICBjb21wYXQtYXBpLmggXAorICAgICAgICAgZHJpMi5jIFwKICAg
ICAgICAgIGR1bW15X2N1cnNvci5jIFwKLSAgICAgICAgIGR1bW15X2RyaXZlci5jIFwKLSAgICAg
ICAgIGR1bW15LmgKKyAgICAgICAgIHNwaWNlZHVtbXlfZHJpdmVyLmMgXAorICAgICAgICAgZHVt
bXkuaCBcCisgICAgICAgICBwcmVzZW50LmMKZGlmZiAtLWdpdCBhL3NwaWNlLXZpZGVvLWR1bW15
L3NyYy9kcmkyLmMgYi9zcGljZS12aWRlby1kdW1teS9zcmMvZHJpMi5jCm5ldyBmaWxlIG1vZGUg
MTAwNjQ0CmluZGV4IDAwMDAwMDAuLjc1OTc0OWMKLS0tIC9kZXYvbnVsbAorKysgYi9zcGljZS12
aWRlby1kdW1teS9zcmMvZHJpMi5jCkBAIC0wLDAgKzEsMjkxIEBACisvKgorICogQ29weXJpZ2h0
IDIwMTkgSGVucmkgVmVyYmVldAorICoKKyAqIFBlcm1pc3Npb24gdG8gdXNlLCBjb3B5LCBtb2Rp
ZnksIGRpc3RyaWJ1dGUsIGFuZCBzZWxsIHRoaXMgc29mdHdhcmUgYW5kIGl0cworICogZG9jdW1l
bnRhdGlvbiBmb3IgYW55IHB1cnBvc2UgaXMgaGVyZWJ5IGdyYW50ZWQgd2l0aG91dCBmZWUsIHBy
b3ZpZGVkIHRoYXQKKyAqIHRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFwcGVhciBpbiBhbGwg
Y29waWVzIGFuZCB0aGF0IGJvdGggdGhhdCBjb3B5cmlnaHQKKyAqIG5vdGljZSBhbmQgdGhpcyBw
ZXJtaXNzaW9uIG5vdGljZSBhcHBlYXIgaW4gc3VwcG9ydGluZyBkb2N1bWVudGF0aW9uLCBhbmQK
KyAqIHRoYXQgdGhlIG5hbWUgb2YgdGhlIGNvcHlyaWdodCBob2xkZXJzIG5vdCBiZSB1c2VkIGlu
IGFkdmVydGlzaW5nIG9yCisgKiBwdWJsaWNpdHkgcGVydGFpbmluZyB0byBkaXN0cmlidXRpb24g
b2YgdGhlIHNvZnR3YXJlIHdpdGhvdXQgc3BlY2lmaWMsCisgKiB3cml0dGVuIHByaW9yIHBlcm1p
c3Npb24uICBUaGUgY29weXJpZ2h0IGhvbGRlcnMgbWFrZSBubyByZXByZXNlbnRhdGlvbnMKKyAq
IGFib3V0IHRoZSBzdWl0YWJpbGl0eSBvZiB0aGlzIHNvZnR3YXJlIGZvciBhbnkgcHVycG9zZS4g
IEl0IGlzIHByb3ZpZGVkICJhcworICogaXMiIHdpdGhvdXQgZXhwcmVzcyBvciBpbXBsaWVkIHdh
cnJhbnR5LgorICoKKyAqIFRIRSBDT1BZUklHSFQgSE9MREVSUyBESVNDTEFJTSBBTEwgV0FSUkFO
VElFUyBXSVRIIFJFR0FSRCBUTyBUSElTIFNPRlRXQVJFLAorICogSU5DTFVESU5HIEFMTCBJTVBM
SUVEIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZIEFORCBGSVRORVNTLCBJTiBOTworICog
RVZFTlQgU0hBTEwgVEhFIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIFNQRUNJ
QUwsIElORElSRUNUIE9SCisgKiBDT05TRVFVRU5USUFMIERBTUFHRVMgT1IgQU5ZIERBTUFHRVMg
V0hBVFNPRVZFUiBSRVNVTFRJTkcgRlJPTSBMT1NTIE9GIFVTRSwKKyAqIERBVEEgT1IgUFJPRklU
UywgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIE5FR0xJR0VOQ0UgT1IgT1RIRVIK
KyAqIFRPUlRJT1VTIEFDVElPTiwgQVJJU0lORyBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRI
IFRIRSBVU0UgT1IgUEVSRk9STUFOQ0UKKyAqIE9GIFRISVMgU09GVFdBUkUuCisgKi8KKworI2lm
ZGVmIEhBVkVfQ09ORklHX0gKKyNpbmNsdWRlICJjb25maWcuaCIKKyNlbmRpZgorCisjaW5jbHVk
ZSAiZHVtbXkuaCIKKyNpbmNsdWRlICJkcmkyLmgiCisjaW5jbHVkZSAieGY4NmRybS5oIgorCitz
dHJ1Y3QgZHVtbXlfZHJpMl9idWZmZXJfcHJpdmF0ZSB7CisgICAgUGl4bWFwUmVjICpwaXhtYXA7
Cit9OworCitzdGF0aWMgUGl4bWFwUmVjICoKK2R1bW15X2dldF9kcmF3YWJsZV9waXhtYXAoRHJh
d2FibGVSZWMgKiBkcmF3YWJsZSkKK3sKKyAgICBjb25zdCBTY3JlZW5SZWMgKnNjcmVlbiA9IGRy
YXdhYmxlLT5wU2NyZWVuOworCisgICAgaWYgKGRyYXdhYmxlLT50eXBlID09IERSQVdBQkxFX1BJ
WE1BUCkKKyAgICAgICAgcmV0dXJuIChQaXhtYXBSZWMgKikgZHJhd2FibGU7CisgICAgZWxzZQor
ICAgICAgICByZXR1cm4gc2NyZWVuLT5HZXRXaW5kb3dQaXhtYXAoKFdpbmRvd1JlYyAqKSBkcmF3
YWJsZSk7Cit9CisKK3N0YXRpYyBEUkkyQnVmZmVyMlJlYyAqCitkdW1teV9kcmkyX2NyZWF0ZV9i
dWZmZXIyKFNjcmVlblJlYyAqIHNjcmVlbiwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgRHJh
d2FibGVSZWMgKiBkcmF3YWJsZSwgdW5zaWduZWQgaW50IGF0dGFjaG1lbnQsIHVuc2lnbmVkIGlu
dCBmb3JtYXQpCit7CisgICAgY29uc3QgU2NybkluZm9SZWMgKnNjcm4gPSB4Zjg2U2NyZWVuVG9T
Y3JuKHNjcmVlbik7CisgICAgc3RydWN0IGR1bW15X2RyaTJfYnVmZmVyX3ByaXZhdGUgKnByaXZh
dGU7CisgICAgRFJJMkJ1ZmZlcjJSZWMgKmJ1ZmZlcjsKKyAgICBQaXhtYXBSZWMgKnBpeG1hcDsK
KyAgICBDQVJEMTYgcGl0Y2g7CisgICAgQ0FSRDMyIHNpemU7CisKKyAgICBpZiAoIShidWZmZXIg
PSBjYWxsb2MoMSwgc2l6ZW9mKCpidWZmZXIpKSkpCisgICAgICAgIHJldHVybiBOVUxMOworCisg
ICAgaWYgKCEocHJpdmF0ZSA9IGNhbGxvYygxLCBzaXplb2YoKnByaXZhdGUpKSkpIHsKKyAgICAg
ICAgZnJlZShidWZmZXIpOworICAgICAgICByZXR1cm4gTlVMTDsKKyAgICB9CisKKyAgICBwaXht
YXAgPSBOVUxMOworICAgIGlmIChhdHRhY2htZW50ID09IERSSTJCdWZmZXJGcm9udExlZnQpIHsK
KyAgICAgICAgcGl4bWFwID0gZHVtbXlfZ2V0X2RyYXdhYmxlX3BpeG1hcChkcmF3YWJsZSk7Cisg
ICAgICAgIGlmIChwaXhtYXAgJiYgcGl4bWFwLT5kcmF3YWJsZS5wU2NyZWVuICE9IHNjcmVlbikK
KyAgICAgICAgICAgIHBpeG1hcCA9IE5VTEw7CisgICAgICAgIGlmIChwaXhtYXApCisgICAgICAg
ICAgICArK3BpeG1hcC0+cmVmY250OworICAgIH0KKworICAgIGlmICghcGl4bWFwKSB7CisgICAg
ICAgIHN3aXRjaCAoYXR0YWNobWVudCkgeworICAgICAgICBjYXNlIERSSTJCdWZmZXJBY2N1bToK
KyAgICAgICAgY2FzZSBEUkkyQnVmZmVyQmFja0xlZnQ6CisgICAgICAgIGNhc2UgRFJJMkJ1ZmZl
ckJhY2tSaWdodDoKKyAgICAgICAgY2FzZSBEUkkyQnVmZmVyRmFrZUZyb250TGVmdDoKKyAgICAg
ICAgY2FzZSBEUkkyQnVmZmVyRmFrZUZyb250UmlnaHQ6CisgICAgICAgIGNhc2UgRFJJMkJ1ZmZl
ckZyb250TGVmdDoKKyAgICAgICAgY2FzZSBEUkkyQnVmZmVyRnJvbnRSaWdodDoKKyAgICAgICAg
ICAgIGJyZWFrOworCisgICAgICAgIGNhc2UgRFJJMkJ1ZmZlclN0ZW5jaWw6CisgICAgICAgIGNh
c2UgRFJJMkJ1ZmZlckRlcHRoOgorICAgICAgICBjYXNlIERSSTJCdWZmZXJEZXB0aFN0ZW5jaWw6
CisgICAgICAgIGNhc2UgRFJJMkJ1ZmZlckhpejoKKyAgICAgICAgZGVmYXVsdDoKKyAgICAgICAg
ICAgIHhmODZEcnZNc2coc2Nybi0+c2NybkluZGV4LCBYX1dBUk5JTkcsCisgICAgICAgICAgICAg
ICAgICAgICAgICJSZXF1ZXN0IGZvciBEUkkyIGJ1ZmZlciBhdHRhY2htZW50ICUjeCB1bnN1cHBv
cnRlZC5cbiIsIGF0dGFjaG1lbnQpOworICAgICAgICAgICAgZnJlZShwcml2YXRlKTsKKyAgICAg
ICAgICAgIGZyZWUoYnVmZmVyKTsKKyAgICAgICAgICAgIHJldHVybiBOVUxMOworICAgICAgICB9
CisKKyAgICAgICAgaWYgKCEocGl4bWFwID0gc2NyZWVuLT5DcmVhdGVQaXhtYXAoc2NyZWVuLCBk
cmF3YWJsZS0+d2lkdGgsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGRyYXdhYmxlLT5oZWlnaHQsIGZvcm1hdCA/IGZvcm1hdCA6IGRyYXdhYmxlLT5kZXB0aCwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMCkpKSB7CisgICAg
ICAgICAgICBmcmVlKHByaXZhdGUpOworICAgICAgICAgICAgZnJlZShidWZmZXIpOworICAgICAg
ICAgICAgcmV0dXJuIE5VTEw7CisgICAgICAgIH0KKyAgICB9CisKKyAgICBidWZmZXItPmF0dGFj
aG1lbnQgPSBhdHRhY2htZW50OworICAgIGJ1ZmZlci0+Y3BwID0gcGl4bWFwLT5kcmF3YWJsZS5i
aXRzUGVyUGl4ZWwgLyA4OworICAgIGJ1ZmZlci0+Zm9ybWF0ID0gZm9ybWF0OworICAgIGJ1ZmZl
ci0+ZmxhZ3MgPSAwOworCisgICAgYnVmZmVyLT5uYW1lID0gZ2xhbW9yX25hbWVfZnJvbV9waXht
YXAocGl4bWFwLCAmcGl0Y2gsICZzaXplKTsKKyAgICBidWZmZXItPnBpdGNoID0gcGl0Y2g7Cisg
ICAgaWYgKGJ1ZmZlci0+bmFtZSA9PSAtMSkgeworICAgICAgICB4Zjg2RHJ2TXNnKHNjcm4tPnNj
cm5JbmRleCwgWF9FUlJPUiwgIkZhaWxlZCB0byBnZXQgRFJJMiBuYW1lIGZvciBwaXhtYXAuXG4i
KTsKKyAgICAgICAgc2NyZWVuLT5EZXN0cm95UGl4bWFwKHBpeG1hcCk7CisgICAgICAgIGZyZWUo
cHJpdmF0ZSk7CisgICAgICAgIGZyZWUoYnVmZmVyKTsKKyAgICAgICAgcmV0dXJuIE5VTEw7Cisg
ICAgfQorCisgICAgYnVmZmVyLT5kcml2ZXJQcml2YXRlID0gcHJpdmF0ZTsKKyAgICBwcml2YXRl
LT5waXhtYXAgPSBwaXhtYXA7CisKKyAgICByZXR1cm4gYnVmZmVyOworfQorCitzdGF0aWMgRFJJ
MkJ1ZmZlcjJSZWMgKgorZHVtbXlfZHJpMl9jcmVhdGVfYnVmZmVyKERyYXdhYmxlUmVjICogZHJh
d2FibGUsIHVuc2lnbmVkIGludCBhdHRhY2htZW50LCB1bnNpZ25lZCBpbnQgZm9ybWF0KQorewor
ICAgIHJldHVybiBkdW1teV9kcmkyX2NyZWF0ZV9idWZmZXIyKGRyYXdhYmxlLT5wU2NyZWVuLCBk
cmF3YWJsZSwgYXR0YWNobWVudCwgZm9ybWF0KTsKK30KKworc3RhdGljIHZvaWQKK2R1bW15X2Ry
aTJfZGVzdHJveV9idWZmZXIyKFNjcmVlblJlYyAqIHVudXNlZCwgRHJhd2FibGVSZWMgKiB1bnVz
ZWQyLCBEUkkyQnVmZmVyMlJlYyAqIGJ1ZmZlcikKK3sKKyAgICBzdHJ1Y3QgZHVtbXlfZHJpMl9i
dWZmZXJfcHJpdmF0ZSAqcHJpdmF0ZTsKKyAgICBjb25zdCBTY3JlZW5SZWMgKnNjcmVlbjsKKwor
ICAgIGlmICghYnVmZmVyKQorICAgICAgICByZXR1cm47CisKKyAgICBpZiAoIShwcml2YXRlID0g
YnVmZmVyLT5kcml2ZXJQcml2YXRlKSkgeworICAgICAgICBmcmVlKGJ1ZmZlcik7CisgICAgICAg
IHJldHVybjsKKyAgICB9CisKKyAgICBzY3JlZW4gPSBwcml2YXRlLT5waXhtYXAtPmRyYXdhYmxl
LnBTY3JlZW47CisgICAgc2NyZWVuLT5EZXN0cm95UGl4bWFwKHByaXZhdGUtPnBpeG1hcCk7Cisg
ICAgZnJlZShwcml2YXRlKTsKKyAgICBmcmVlKGJ1ZmZlcik7Cit9CisKK3N0YXRpYyB2b2lkCitk
dW1teV9kcmkyX2Rlc3Ryb3lfYnVmZmVyKERyYXdhYmxlUmVjICogZHJhd2FibGUsIERSSTJCdWZm
ZXIyUmVjICogYnVmZmVyKQoreworICAgIGR1bW15X2RyaTJfZGVzdHJveV9idWZmZXIyKE5VTEws
IGRyYXdhYmxlLCBidWZmZXIpOworfQorCitzdGF0aWMgdm9pZAorZHVtbXlfZHJpMl9jb3B5X3Jl
Z2lvbjIoU2NyZWVuUmVjICogc2NyZWVuLCBEcmF3YWJsZVJlYyAqIGRyYXdhYmxlLAorICAgICAg
ICAgICAgICAgICAgICAgICAgUmVnaW9uUmVjICogcmVnaW9uLCBEUkkyQnVmZmVyUmVjICogZHN0
X2J1ZmZlciwgRFJJMkJ1ZmZlclJlYyAqIHNyY19idWZmZXIpCit7CisgICAgY29uc3Qgc3RydWN0
IGR1bW15X2RyaTJfYnVmZmVyX3ByaXZhdGUgKnNyY19wcml2ID0gc3JjX2J1ZmZlci0+ZHJpdmVy
UHJpdmF0ZTsKKyAgICBjb25zdCBzdHJ1Y3QgZHVtbXlfZHJpMl9idWZmZXJfcHJpdmF0ZSAqZHN0
X3ByaXYgPSBkc3RfYnVmZmVyLT5kcml2ZXJQcml2YXRlOworICAgIGludCBvZmZfeCA9IDAsIG9m
Zl95ID0gMDsKKyAgICBCb29sIHRyYW5zbGF0ZSA9IEZBTFNFOworICAgIERyYXdhYmxlUmVjICpz
cmMsICpkc3Q7CisgICAgUmVnaW9uUmVjICpjbGlwX3JlZ2lvbjsKKyAgICBHQyAqZ2M7CisKKyAg
ICBzcmMgPSAoc3JjX2J1ZmZlci0+YXR0YWNobWVudCA9PSBEUkkyQnVmZmVyRnJvbnRMZWZ0KSA/
IGRyYXdhYmxlIDogJnNyY19wcml2LT5waXhtYXAtPmRyYXdhYmxlOworICAgIGRzdCA9IChkc3Rf
YnVmZmVyLT5hdHRhY2htZW50ID09IERSSTJCdWZmZXJGcm9udExlZnQpID8gZHJhd2FibGUgOiAm
ZHN0X3ByaXYtPnBpeG1hcC0+ZHJhd2FibGU7CisKKyAgICBpZiAoZHN0X2J1ZmZlci0+YXR0YWNo
bWVudCA9PSBEUkkyQnVmZmVyRnJvbnRMZWZ0ICYmIGRyYXdhYmxlLT5wU2NyZWVuICE9IHNjcmVl
bikgeworICAgICAgICBpZiAoIShkc3QgPSBEUkkyVXBkYXRlUHJpbWUoZHJhd2FibGUsIGRzdF9i
dWZmZXIpKSkKKyAgICAgICAgICAgIHJldHVybjsKKyAgICAgICAgaWYgKGRzdCAhPSBkcmF3YWJs
ZSkKKyAgICAgICAgICAgIHRyYW5zbGF0ZSA9IFRSVUU7CisgICAgfQorCisgICAgaWYgKHRyYW5z
bGF0ZSAmJiBkcmF3YWJsZS0+dHlwZSA9PSBEUkFXQUJMRV9XSU5ET1cpIHsKKyAgICAgICAgY29u
c3QgUGl4bWFwUmVjICpwaXhtYXAgPSBkdW1teV9nZXRfZHJhd2FibGVfcGl4bWFwKGRyYXdhYmxl
KTsKKyAgICAgICAgb2ZmX3ggPSAtcGl4bWFwLT5zY3JlZW5feDsKKyAgICAgICAgb2ZmX3kgPSAt
cGl4bWFwLT5zY3JlZW5feTsKKyAgICAgICAgb2ZmX3ggKz0gZHJhd2FibGUtPng7CisgICAgICAg
IG9mZl95ICs9IGRyYXdhYmxlLT55OworICAgIH0KKworICAgIGlmICghKGdjID0gR2V0U2NyYXRj
aEdDKGRzdC0+ZGVwdGgsIHNjcmVlbikpKQorICAgICAgICByZXR1cm47CisKKyAgICBjbGlwX3Jl
Z2lvbiA9IFJFR0lPTl9DUkVBVEUoc2NyZWVuLCBOVUxMLCAwKTsKKyAgICBSRUdJT05fQ09QWShz
Y3JlZW4sIGNsaXBfcmVnaW9uLCByZWdpb24pOworICAgIGlmICh0cmFuc2xhdGUpCisgICAgICAg
IFJFR0lPTl9UUkFOU0xBVEUoc2NyZWVuLCBjbGlwX3JlZ2lvbiwgb2ZmX3gsIG9mZl95KTsKKyAg
ICBnYy0+ZnVuY3MtPkNoYW5nZUNsaXAoZ2MsIENUX1JFR0lPTiwgY2xpcF9yZWdpb24sIDApOwor
ICAgIFZhbGlkYXRlR0MoZHN0LCBnYyk7CisKKyAgICBnYy0+b3BzLT5Db3B5QXJlYShzcmMsIGRz
dCwgZ2MsIDAsIDAsIGRyYXdhYmxlLT53aWR0aCwgZHJhd2FibGUtPmhlaWdodCwgb2ZmX3gsIG9m
Zl95KTsKKworICAgIEZyZWVTY3JhdGNoR0MoZ2MpOworfQorCitzdGF0aWMgdm9pZAorZHVtbXlf
ZHJpMl9jb3B5X3JlZ2lvbihEcmF3YWJsZVJlYyAqIGRyYXdhYmxlLCBSZWdpb25SZWMgKiByZWdp
b24sCisgICAgICAgICAgICAgICAgICAgICAgIERSSTJCdWZmZXJSZWMgKiBkc3RfYnVmZmVyLCBE
UkkyQnVmZmVyUmVjICogc3JjX2J1ZmZlcikKK3sKKyAgICBkdW1teV9kcmkyX2NvcHlfcmVnaW9u
MihkcmF3YWJsZS0+cFNjcmVlbiwgZHJhd2FibGUsIHJlZ2lvbiwgZHN0X2J1ZmZlciwgc3JjX2J1
ZmZlcik7Cit9CisKK3N0YXRpYyBpbnQKK2R1bW15X2RyaTJfZ2V0X21zYyhEcmF3YWJsZVJlYyAq
IGRyYXdhYmxlLCBDQVJENjQgKiB1c3QsIENBUkQ2NCAqIG1zYykKK3sKKyAgICAqdXN0ID0gZHVt
bXlfZ2V0dGltZV91cygpOworICAgICptc2MgPSAwOworCisgICAgcmV0dXJuIFRSVUU7Cit9CisK
K3N0YXRpYyBpbnQKK2R1bW15X2RyaTJfc2NoZWR1bGVfd2FpdF9tc2MoQ2xpZW50UmVjICogY2xp
ZW50LCBEcmF3YWJsZVJlYyAqIGRyYXdhYmxlLAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBDQVJENjQgdGFyZ2V0X21zYywgQ0FSRDY0IGRpdmlzb3IsIENBUkQ2NCByZW1haW5kZXIpCit7
CisgICAgRFJJMldhaXRNU0NDb21wbGV0ZShjbGllbnQsIGRyYXdhYmxlLCB0YXJnZXRfbXNjLCAw
LCAwKTsKKworICAgIHJldHVybiBUUlVFOworfQorCitzdGF0aWMgaW50CitkdW1teV9kcmkyX3Nj
aGVkdWxlX3N3YXAoQ2xpZW50UmVjICogY2xpZW50LCBEcmF3YWJsZVJlYyAqIGRyYXdhYmxlLAor
ICAgICAgICAgICAgICAgICAgICAgICAgIERSSTJCdWZmZXJSZWMgKiBmcm9udCwgRFJJMkJ1ZmZl
clJlYyAqIGJhY2ssCisgICAgICAgICAgICAgICAgICAgICAgICAgQ0FSRDY0ICogdGFyZ2V0X21z
YywgQ0FSRDY0IGRpdmlzb3IsIENBUkQ2NCByZW1haW5kZXIsCisgICAgICAgICAgICAgICAgICAg
ICAgICAgRFJJMlN3YXBFdmVudFB0ciBmdW5jLCB2b2lkICpkYXRhKQoreworICAgIFJlZ2lvblJl
YyByZWdpb247CisgICAgQm94UmVjIGJveDsKKworICAgIGJveC54MSA9IDA7CisgICAgYm94Lnkx
ID0gMDsKKyAgICBib3gueDIgPSBkcmF3YWJsZS0+d2lkdGg7CisgICAgYm94LnkyID0gZHJhd2Fi
bGUtPmhlaWdodDsKKyAgICBSZWdpb25Jbml0KCZyZWdpb24sICZib3gsIDApOworCisgICAgZHVt
bXlfZHJpMl9jb3B5X3JlZ2lvbihkcmF3YWJsZSwgJnJlZ2lvbiwgZnJvbnQsIGJhY2spOworICAg
IERSSTJTd2FwQ29tcGxldGUoY2xpZW50LCBkcmF3YWJsZSwgMCwgMCwgMCwgRFJJMl9CTElUX0NP
TVBMRVRFLCBmdW5jLCBkYXRhKTsKKyAgICAqdGFyZ2V0X21zYyA9IDA7CisKKyAgICByZXR1cm4g
VFJVRTsKK30KKworQm9vbAorZHVtbXlfZHJpMl9zY3JlZW5faW5pdChTY3JlZW5SZWMgKiBzY3Jl
ZW4pCit7CisgICAgY29uc3QgU2NybkluZm9SZWMgKnNjcm4gPSB4Zjg2U2NyZWVuVG9TY3JuKHNj
cmVlbik7CisgICAgY29uc3QgRFVNTVlSZWMgKmR1bW15ID0gc2Nybi0+ZHJpdmVyUHJpdmF0ZTsK
KyAgICBEUkkySW5mb1JlYyBpbmZvOworCisgICAgaWYgKCFnbGFtb3Jfc3VwcG9ydHNfcGl4bWFw
X2ltcG9ydF9leHBvcnQoc2NyZWVuKSkKKyAgICAgICAgeGY4NkRydk1zZyhzY3JuLT5zY3JuSW5k
ZXgsIFhfV0FSTklORywKKyAgICAgICAgICAgICAgICAgICAiRFJJMjogZ2xhbW9yIGxhY2tzIHN1
cHBvcnQgZm9yIHBpeG1hcCBpbXBvcnQvZXhwb3J0XG4iKTsKKworICAgIGlmICgheGY4NkxvYWRl
ckNoZWNrU3ltYm9sKCJEUkkyVmVyc2lvbiIpKQorICAgICAgICByZXR1cm4gRkFMU0U7CisKKyAg
ICBtZW1zZXQoJmluZm8sIDAsIHNpemVvZihpbmZvKSk7CisgICAgaW5mby5mZCA9IGR1bW15LT5m
ZDsKKyAgICBpbmZvLmRyaXZlck5hbWUgPSBOVUxMOworICAgIGluZm8uZGV2aWNlTmFtZSA9IGRy
bUdldERldmljZU5hbWVGcm9tRmQyKGR1bW15LT5mZCk7CisKKyAgICBpbmZvLnZlcnNpb24gPSA5
OworICAgIGluZm8uQ3JlYXRlQnVmZmVyID0gZHVtbXlfZHJpMl9jcmVhdGVfYnVmZmVyOworICAg
IGluZm8uRGVzdHJveUJ1ZmZlciA9IGR1bW15X2RyaTJfZGVzdHJveV9idWZmZXI7CisgICAgaW5m
by5Db3B5UmVnaW9uID0gZHVtbXlfZHJpMl9jb3B5X3JlZ2lvbjsKKyAgICBpbmZvLlNjaGVkdWxl
U3dhcCA9IGR1bW15X2RyaTJfc2NoZWR1bGVfc3dhcDsKKyAgICBpbmZvLkdldE1TQyA9IGR1bW15
X2RyaTJfZ2V0X21zYzsKKyAgICBpbmZvLlNjaGVkdWxlV2FpdE1TQyA9IGR1bW15X2RyaTJfc2No
ZWR1bGVfd2FpdF9tc2M7CisgICAgaW5mby5DcmVhdGVCdWZmZXIyID0gZHVtbXlfZHJpMl9jcmVh
dGVfYnVmZmVyMjsKKyAgICBpbmZvLkRlc3Ryb3lCdWZmZXIyID0gZHVtbXlfZHJpMl9kZXN0cm95
X2J1ZmZlcjI7CisgICAgaW5mby5Db3B5UmVnaW9uMiA9IGR1bW15X2RyaTJfY29weV9yZWdpb24y
OworCisgICAgaW5mby5udW1Ecml2ZXJzID0gMDsKKyAgICBpbmZvLmRyaXZlck5hbWVzID0gTlVM
TDsKKworICAgIHJldHVybiBEUkkyU2NyZWVuSW5pdChzY3JlZW4sICZpbmZvKTsKK30KKwordm9p
ZAorZHVtbXlfZHJpMl9jbG9zZV9zY3JlZW4oU2NyZWVuUmVjICogc2NyZWVuKQoreworICAgIERS
STJDbG9zZVNjcmVlbihzY3JlZW4pOworfQpkaWZmIC0tZ2l0IGEvc3BpY2UtdmlkZW8tZHVtbXkv
c3JjL2R1bW15LmggYi9zcGljZS12aWRlby1kdW1teS9zcmMvZHVtbXkuaAppbmRleCA2NTcxMGVm
Li5kOGNhYzgzIDEwMDY0NAotLS0gYS9zcGljZS12aWRlby1kdW1teS9zcmMvZHVtbXkuaAorKysg
Yi9zcGljZS12aWRlby1kdW1teS9zcmMvZHVtbXkuaApAQCAtMTMsNiArMTMsOSBAQAogCiAjaW5j
bHVkZSAiY29tcGF0LWFwaS5oIgogCisjZGVmaW5lIEdMQU1PUl9GT1JfWE9SRyAxCisjaW5jbHVk
ZSAiZ2xhbW9yLmgiCisKIC8qIFN1cHBvcnRlZCBjaGlwc2V0cyAqLwogdHlwZWRlZiBlbnVtIHsK
ICAgICBEVU1NWV9DSElQCkBAIC0yOCw2ICszMSwxMCBAQCBleHRlcm4gQm9vbCBEVU1NWUN1cnNv
ckluaXQoU2NyZWVuUHRyIHBTY3JuKTsKIGV4dGVybiB2b2lkIERVTU1ZU2hvd0N1cnNvcihTY3Ju
SW5mb1B0ciBwU2Nybik7CiBleHRlcm4gdm9pZCBEVU1NWUhpZGVDdXJzb3IoU2NybkluZm9QdHIg
cFNjcm4pOwogCit2b2lkIGR1bW15X2RyaTJfY2xvc2Vfc2NyZWVuKFNjcmVlblJlYyAqIHNjcmVl
bik7CitCb29sIGR1bW15X2RyaTJfc2NyZWVuX2luaXQoU2NyZWVuUmVjICogc2NyZWVuKTsKK0Jv
b2wgZHVtbXlfcHJlc2VudF9zY3JlZW5faW5pdChTY3JlZW5SZWMgKiBzY3JlZW4pOworCiAvKiBn
bG9iYWxzICovCiB0eXBlZGVmIHN0cnVjdCBfY29sb3IgewogICAgIGludCByZWQ7CkBAIC01MCw3
ICs1NywyMSBAQCB0eXBlZGVmIHN0cnVjdCBkdW1teVJlYyB7CiAgICAgZHVtbXlfY29sb3JzIGNv
bG9yc1sxMDI0XTsKICAgICBCb29sICgqQ3JlYXRlV2luZG93KSAoKTsgICAgLyogd3JhcHBlZCBD
cmVhdGVXaW5kb3cgKi8KICAgICBCb29sIHByb3A7CisKKyAgICBCb29sIGdsYW1vcjsKKyAgICBp
bnQgZmQ7CiB9IERVTU1ZUmVjLCAqRFVNTVlQdHI7CiAKIC8qIFRoZSBwcml2YXRlcyBvZiB0aGUg
RFVNTVkgZHJpdmVyICovCiAjZGVmaW5lIERVTU1ZUFRSKHApCSgoRFVNTVlQdHIpKChwKS0+ZHJp
dmVyUHJpdmF0ZSkpCisKK3N0YXRpYyBpbmxpbmUgdWludDY0X3QKK2R1bW15X2dldHRpbWVfdXMo
dm9pZCkKK3sKKyAgICBzdHJ1Y3QgdGltZXNwZWMgdHY7CisKKyAgICBpZiAoY2xvY2tfZ2V0dGlt
ZShDTE9DS19NT05PVE9OSUMsICZ0dikpCisgICAgICAgIHJldHVybiAwOworCisgICAgcmV0dXJu
ICh1aW50NjRfdCkgdHYudHZfc2VjICogMTAwMDAwMCArIHR2LnR2X25zZWMgLyAxMDAwOworfQpk
aWZmIC0tZ2l0IGEvc3BpY2UtdmlkZW8tZHVtbXkvc3JjL3ByZXNlbnQuYyBiL3NwaWNlLXZpZGVv
LWR1bW15L3NyYy9wcmVzZW50LmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMC4u
ODFmY2M1YgotLS0gL2Rldi9udWxsCisrKyBiL3NwaWNlLXZpZGVvLWR1bW15L3NyYy9wcmVzZW50
LmMKQEAgLTAsMCArMSwxMDIgQEAKKy8qCisgKiBDb3B5cmlnaHQgMjAxOSBIZW5yaSBWZXJiZWV0
CisgKgorICogUGVybWlzc2lvbiB0byB1c2UsIGNvcHksIG1vZGlmeSwgZGlzdHJpYnV0ZSwgYW5k
IHNlbGwgdGhpcyBzb2Z0d2FyZSBhbmQgaXRzCisgKiBkb2N1bWVudGF0aW9uIGZvciBhbnkgcHVy
cG9zZSBpcyBoZXJlYnkgZ3JhbnRlZCB3aXRob3V0IGZlZSwgcHJvdmlkZWQgdGhhdAorICogdGhl
IGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYXBwZWFyIGluIGFsbCBjb3BpZXMgYW5kIHRoYXQgYm90
aCB0aGF0IGNvcHlyaWdodAorICogbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIGFw
cGVhciBpbiBzdXBwb3J0aW5nIGRvY3VtZW50YXRpb24sIGFuZAorICogdGhhdCB0aGUgbmFtZSBv
ZiB0aGUgY29weXJpZ2h0IGhvbGRlcnMgbm90IGJlIHVzZWQgaW4gYWR2ZXJ0aXNpbmcgb3IKKyAq
IHB1YmxpY2l0eSBwZXJ0YWluaW5nIHRvIGRpc3RyaWJ1dGlvbiBvZiB0aGUgc29mdHdhcmUgd2l0
aG91dCBzcGVjaWZpYywKKyAqIHdyaXR0ZW4gcHJpb3IgcGVybWlzc2lvbi4gIFRoZSBjb3B5cmln
aHQgaG9sZGVycyBtYWtlIG5vIHJlcHJlc2VudGF0aW9ucworICogYWJvdXQgdGhlIHN1aXRhYmls
aXR5IG9mIHRoaXMgc29mdHdhcmUgZm9yIGFueSBwdXJwb3NlLiAgSXQgaXMgcHJvdmlkZWQgImFz
CisgKiBpcyIgd2l0aG91dCBleHByZXNzIG9yIGltcGxpZWQgd2FycmFudHkuCisgKgorICogVEhF
IENPUFlSSUdIVCBIT0xERVJTIERJU0NMQUlNIEFMTCBXQVJSQU5USUVTIFdJVEggUkVHQVJEIFRP
IFRISVMgU09GVFdBUkUsCisgKiBJTkNMVURJTkcgQUxMIElNUExJRUQgV0FSUkFOVElFUyBPRiBN
RVJDSEFOVEFCSUxJVFkgQU5EIEZJVE5FU1MsIElOIE5PCisgKiBFVkVOVCBTSEFMTCBUSEUgQ09Q
WVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgU1BFQ0lBTCwgSU5ESVJFQ1QgT1IKKyAq
IENPTlNFUVVFTlRJQUwgREFNQUdFUyBPUiBBTlkgREFNQUdFUyBXSEFUU09FVkVSIFJFU1VMVElO
RyBGUk9NIExPU1MgT0YgVVNFLAorICogREFUQSBPUiBQUk9GSVRTLCBXSEVUSEVSIElOIEFOIEFD
VElPTiBPRiBDT05UUkFDVCwgTkVHTElHRU5DRSBPUiBPVEhFUgorICogVE9SVElPVVMgQUNUSU9O
LCBBUklTSU5HIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFVTRSBPUiBQRVJGT1JN
QU5DRQorICogT0YgVEhJUyBTT0ZUV0FSRS4KKyAqLworCisjaWZkZWYgSEFWRV9DT05GSUdfSAor
I2luY2x1ZGUgImNvbmZpZy5oIgorI2VuZGlmCisKKyNpbmNsdWRlICJkdW1teS5oIgorI2luY2x1
ZGUgInByZXNlbnQuaCIKKworc3RhdGljIFJSQ3J0Y1JlYyAqCitkdW1teV9wcmVzZW50X2dldF9j
cnRjKFdpbmRvd1JlYyAqIHdpbmRvdykKK3sKKyAgICByZXR1cm4gTlVMTDsKK30KKworc3RhdGlj
IGludAorZHVtbXlfcHJlc2VudF9nZXRfdXN0X21zYyhSUkNydGNSZWMgKiBjcnRjLCBDQVJENjQg
KiB1c3QsIENBUkQ2NCAqIG1zYykKK3sKKyAgICAqdXN0ID0gZHVtbXlfZ2V0dGltZV91cygpOwor
ICAgICptc2MgPSAwOworCisgICAgcmV0dXJuIFN1Y2Nlc3M7Cit9CisKK3N0YXRpYyBpbnQKK2R1
bW15X3ByZXNlbnRfcXVldWVfdmJsYW5rKFJSQ3J0Y1JlYyAqIGNydGMsIHVpbnQ2NF90IGV2ZW50
X2lkLCB1aW50NjRfdCBtc2MpCit7CisgICAgcHJlc2VudF9ldmVudF9ub3RpZnkoZXZlbnRfaWQs
IGR1bW15X2dldHRpbWVfdXMoKSwgbXNjKTsKKworICAgIHJldHVybiBTdWNjZXNzOworfQorCitz
dGF0aWMgdm9pZAorZHVtbXlfcHJlc2VudF9hYm9ydF92YmxhbmsoUlJDcnRjUmVjICogY3J0Yywg
dWludDY0X3QgZXZlbnRfaWQsIHVpbnQ2NF90IG1zYykKK3sKK30KKworc3RhdGljIHZvaWQKK2R1
bW15X3ByZXNlbnRfZmx1c2goV2luZG93UmVjICogd2luZG93KQoreworICAgIGdsYW1vcl9ibG9j
a19oYW5kbGVyKHdpbmRvdy0+ZHJhd2FibGUucFNjcmVlbik7Cit9CisKK3N0YXRpYyBCb29sCitk
dW1teV9wcmVzZW50X2NoZWNrX2ZsaXAoUlJDcnRjUmVjICogY3J0YywgV2luZG93UmVjICogd2lu
ZG93LCBQaXhtYXBSZWMgKiBwaXhtYXAsIEJvb2wgc3luY19mbGlwKQoreworICAgIHJldHVybiBG
QUxTRTsKK30KKworc3RhdGljIEJvb2wKK2R1bW15X3ByZXNlbnRfZmxpcChSUkNydGNSZWMgKiBj
cnRjLCB1aW50NjRfdCBldmVudF9pZCwKKyAgICAgICAgICAgICAgICAgICB1aW50NjRfdCB0YXJn
ZXRfbXNjLCBQaXhtYXBSZWMgKiBwaXhtYXAsIEJvb2wgc3luY19mbGlwKQoreworICAgIHJldHVy
biBGQUxTRTsKK30KKworc3RhdGljIHZvaWQKK2R1bW15X3ByZXNlbnRfdW5mbGlwKFNjcmVlblJl
YyAqIHNjcmVlbiwgdWludDY0X3QgZXZlbnRfaWQpCit7CisgICAgcHJlc2VudF9ldmVudF9ub3Rp
ZnkoZXZlbnRfaWQsIDAsIDApOworfQorCitCb29sCitkdW1teV9wcmVzZW50X3NjcmVlbl9pbml0
KFNjcmVlblJlYyAqIHNjcmVlbikKK3sKKyAgICBzdGF0aWMgc3RydWN0IHByZXNlbnRfc2NyZWVu
X2luZm8gcHJlc2VudF9zY3JlZW5faW5mbyA9IHsKKyAgICAgICAgLnZlcnNpb24gPSBQUkVTRU5U
X1NDUkVFTl9JTkZPX1ZFUlNJT04sCisKKyAgICAgICAgLmdldF9jcnRjID0gZHVtbXlfcHJlc2Vu
dF9nZXRfY3J0YywKKyAgICAgICAgLmdldF91c3RfbXNjID0gZHVtbXlfcHJlc2VudF9nZXRfdXN0
X21zYywKKyAgICAgICAgLnF1ZXVlX3ZibGFuayA9IGR1bW15X3ByZXNlbnRfcXVldWVfdmJsYW5r
LAorICAgICAgICAuYWJvcnRfdmJsYW5rID0gZHVtbXlfcHJlc2VudF9hYm9ydF92YmxhbmssCisg
ICAgICAgIC5mbHVzaCA9IGR1bW15X3ByZXNlbnRfZmx1c2gsCisKKyAgICAgICAgLmNhcGFiaWxp
dGllcyA9IFByZXNlbnRDYXBhYmlsaXR5Tm9uZSwKKyAgICAgICAgLmNoZWNrX2ZsaXAgPSBkdW1t
eV9wcmVzZW50X2NoZWNrX2ZsaXAsCisgICAgICAgIC5mbGlwID0gZHVtbXlfcHJlc2VudF9mbGlw
LAorICAgICAgICAudW5mbGlwID0gZHVtbXlfcHJlc2VudF91bmZsaXAsCisgICAgfTsKKworICAg
IHJldHVybiBwcmVzZW50X3NjcmVlbl9pbml0KHNjcmVlbiwgJnByZXNlbnRfc2NyZWVuX2luZm8p
OworfQpkaWZmIC0tZ2l0IGEvc3BpY2UtdmlkZW8tZHVtbXkvc3JjL2R1bW15X2RyaXZlci5jIGIv
c3BpY2UtdmlkZW8tZHVtbXkvc3JjL3NwaWNlZHVtbXlfZHJpdmVyLmMKc2ltaWxhcml0eSBpbmRl
eCA4NyUKcmVuYW1lIGZyb20gc3BpY2UtdmlkZW8tZHVtbXkvc3JjL2R1bW15X2RyaXZlci5jCnJl
bmFtZSB0byBzcGljZS12aWRlby1kdW1teS9zcmMvc3BpY2VkdW1teV9kcml2ZXIuYwppbmRleCA0
NmNkZTkwLi45YjM4YjIxIDEwMDY0NAotLS0gYS9zcGljZS12aWRlby1kdW1teS9zcmMvZHVtbXlf
ZHJpdmVyLmMKKysrIGIvc3BpY2UtdmlkZW8tZHVtbXkvc3JjL3NwaWNlZHVtbXlfZHJpdmVyLmMK
QEAgLTMzLDYgKzMzLDggQEAKICAqIERyaXZlciBkYXRhIHN0cnVjdHVyZXMuCiAgKi8KICNpbmNs
dWRlICJkdW1teS5oIgorI2luY2x1ZGUgPGZjbnRsLmg+CisjaW5jbHVkZSA8ZXJybm8uaD4KIAog
LyogVGhlc2UgbmVlZCB0byBiZSBjaGVja2VkICovCiAjaW5jbHVkZSA8WDExL1guaD4KQEAgLTYy
LDggKzY0LDggQEAgc3RhdGljIEJvb2wgZHVtbXlEcml2ZXJGdW5jKFNjcm5JbmZvUHRyIHBTY3Ju
LCB4b3JnRHJpdmVyRnVuY09wIG9wLCBwb2ludGVyIHB0cikKIC8qIAkJCQlpbnQgUG93ZXJNYW5h
Z2VtZW50TW9kZSwgaW50IGZsYWdzKTsgKi8KIAogI2RlZmluZSBEVU1NWV9WRVJTSU9OIDQwMDAK
LSNkZWZpbmUgRFVNTVlfTkFNRSAiRFVNTVkiCi0jZGVmaW5lIERVTU1ZX0RSSVZFUl9OQU1FICJk
dW1teSIKKyNkZWZpbmUgRFVNTVlfTkFNRSAiU1BJQ0VEVU1NWSIKKyNkZWZpbmUgRFVNTVlfRFJJ
VkVSX05BTUUgInNwaWNlZHVtbXkiCiAKICNkZWZpbmUgRFVNTVlfTUFKT1JfVkVSU0lPTiBQQUNL
QUdFX1ZFUlNJT05fTUFKT1IKICNkZWZpbmUgRFVNTVlfTUlOT1JfVkVSU0lPTiBQQUNLQUdFX1ZF
UlNJT05fTUlOT1IKQEAgLTk5LDE2ICsxMDEsMjAgQEAgX1hfRVhQT1JUIERyaXZlclJlYyBEVU1N
WSA9IHsKIH07CiAKIHN0YXRpYyBTeW1UYWJSZWMgRFVNTVlDaGlwc2V0c1tdID0gewotICAgIHtE
VU1NWV9DSElQLCAiZHVtbXkifSwKKyAgICB7RFVNTVlfQ0hJUCwgInNwaWNlZHVtbXkifSwKICAg
ICB7LTEsIE5VTEx9CiB9OwogCiB0eXBlZGVmIGVudW0gewotICAgIE9QVElPTl9TV19DVVJTT1IK
KyAgICBPUFRJT05fU1dfQ1VSU09SLAorICAgIE9QVElPTl9ERVZJQ0VfUEFUSCwKKyAgICBPUFRJ
T05fQUNDRUxfTUVUSE9ELAogfSBEVU1NWU9wdHM7CiAKIHN0YXRpYyBjb25zdCBPcHRpb25JbmZv
UmVjIERVTU1ZT3B0aW9uc1tdID0gewogICAgIHtPUFRJT05fU1dfQ1VSU09SLCAiU1djdXJzb3Ii
LCBPUFRWX0JPT0xFQU4sIHswfSwgRkFMU0V9LAorICAgIHtPUFRJT05fREVWSUNFX1BBVEgsICJr
bXNkZXYiLCBPUFRWX1NUUklORywgezB9LCBGQUxTRX0sCisgICAge09QVElPTl9BQ0NFTF9NRVRI
T0QsICJBY2NlbE1ldGhvZCIsIE9QVFZfU1RSSU5HLCB7MH0sIEZBTFNFfSwKICAgICB7LTEsIE5V
TEwsIE9QVFZfTk9ORSwgezB9LCBGQUxTRX0KIH07CiAKQEAgLTExNyw3ICsxMjMsNyBAQCBzdGF0
aWMgY29uc3QgT3B0aW9uSW5mb1JlYyBEVU1NWU9wdGlvbnNbXSA9IHsKIHN0YXRpYyBNT0RVTEVT
RVRVUFBST1RPKGR1bW15U2V0dXApOwogCiBzdGF0aWMgWEY4Nk1vZHVsZVZlcnNpb25JbmZvIGR1
bW15VmVyc1JlYyA9IHsKLSAgICAiZHVtbXkiLAorICAgICJzcGljZWR1bW15IiwKICAgICBNT0RV
TEVWRU5ET1JTVFJJTkcsCiAgICAgTU9ESU5GT1NUUklORzEsCiAgICAgTU9ESU5GT1NUUklORzIs
CkBAIC0xMzMsNyArMTM5LDcgQEAgc3RhdGljIFhGODZNb2R1bGVWZXJzaW9uSW5mbyBkdW1teVZl
cnNSZWMgPSB7CiAgKiBUaGlzIGlzIHRoZSBtb2R1bGUgaW5pdCBkYXRhLgogICogSXRzIG5hbWUg
aGFzIHRvIGJlIHRoZSBkcml2ZXIgbmFtZSBmb2xsb3dlZCBieSBNb2R1bGVEYXRhCiAgKi8KLV9Y
X0VYUE9SVCBYRjg2TW9kdWxlRGF0YSBkdW1teU1vZHVsZURhdGEgPSB7ICZkdW1teVZlcnNSZWMs
IGR1bW15U2V0dXAsIE5VTEwgfTsKK19YX0VYUE9SVCBYRjg2TW9kdWxlRGF0YSBzcGljZWR1bW15
TW9kdWxlRGF0YSA9IHsgJmR1bW15VmVyc1JlYywgZHVtbXlTZXR1cCwgTlVMTCB9OwogCiBzdGF0
aWMgcG9pbnRlcgogZHVtbXlTZXR1cChwb2ludGVyIG1vZHVsZSwgcG9pbnRlciBvcHRzLCBpbnQg
KmVycm1haiwgaW50ICplcnJtaW4pCkBAIC0yMDAsNyArMjA2LDcgQEAgRFVNTVlBdmFpbGFibGVP
cHRpb25zKGludCBjaGlwaWQsIGludCBidXNpZCkKIHN0YXRpYyB2b2lkCiBEVU1NWUlkZW50aWZ5
KGludCBmbGFncykKIHsKLSAgICB4Zjg2UHJpbnRDaGlwc2V0cyhEVU1NWV9OQU1FLCAiRHJpdmVy
IGZvciBEdW1teSBjaGlwc2V0cyIsIERVTU1ZQ2hpcHNldHMpOworICAgIHhmODZQcmludENoaXBz
ZXRzKERVTU1ZX05BTUUsICJTcGljZSBEcml2ZXIgZm9yIER1bW15IGNoaXBzZXRzIiwgRFVNTVlD
aGlwc2V0cyk7CiB9CiAKIC8qIE1hbmRhdG9yeSAqLwpAQCAtMjU1LDYgKzI2MSw1MCBAQCBEVU1N
WVByb2JlKERyaXZlclB0ciBkcnYsIGludCBmbGFncykKICAgICByZXR1cm4gZm91bmRTY3JlZW47
CiB9CiAKK3N0YXRpYyBpbnQKK2R1bW15X29wZW5fcmVuZGVyX25vZGUoY29uc3QgU2NybkluZm9S
ZWMgKiBzY3JuKQoreworICAgIGNvbnN0IERVTU1ZUmVjICpkdW1teSA9IHNjcm4tPmRyaXZlclBy
aXZhdGU7CisgICAgY29uc3QgY2hhciAqZGV2aWNlX3BhdGg7CisgICAgaW50IGZkOworCisgICAg
aWYgKCEoZGV2aWNlX3BhdGggPSB4Zjg2R2V0T3B0VmFsU3RyaW5nKGR1bW15LT5PcHRpb25zLCBP
UFRJT05fREVWSUNFX1BBVEgpKSkKKyAgICAgICAgZGV2aWNlX3BhdGggPSAiL2Rldi9kcmkvcmVu
ZGVyRDEyOCI7CisgICAgaWYgKChmZCA9IG9wZW4oZGV2aWNlX3BhdGgsIE9fUkRXUiwgMCkpID09
IC0xKQorICAgICAgICB4Zjg2RHJ2TXNnKHNjcm4tPnNjcm5JbmRleCwgWF9FUlJPUiwgIm9wZW4g
JXM6ICVzXG4iLCBkZXZpY2VfcGF0aCwgc3RyZXJyb3IoZXJybm8pKTsKKyAgICBlbHNlCisgICAg
ICAgIHhmODZEcnZNc2coc2Nybi0+c2NybkluZGV4LCBYX0NPTkZJRywgIlVzaW5nICVzLlxuIiwg
ZGV2aWNlX3BhdGgpOworCisgICAgcmV0dXJuIGZkOworfQorCitzdGF0aWMgQm9vbAorZHVtbXlf
ZW5hYmxlX2dsYW1vcihTY3JuSW5mb1JlYyAqIHNjcm4pCit7CisgICAgY29uc3QgRFVNTVlSZWMg
KmR1bW15ID0gc2Nybi0+ZHJpdmVyUHJpdmF0ZTsKKyAgICBjb25zdCBjaGFyICphY2NlbF9tZXRo
b2Q7CisKKyAgICBpZiAoKChhY2NlbF9tZXRob2QgPSB4Zjg2R2V0T3B0VmFsU3RyaW5nKGR1bW15
LT5PcHRpb25zLCBPUFRJT05fQUNDRUxfTUVUSE9EKSkKKyAgICAgICAgJiYgc3RyY21wKGFjY2Vs
X21ldGhvZCwgImdsYW1vciIpKSB8fCBkdW1teS0+ZmQgPT0gLTEpIHsKKyAgICAgICAgeGY4NkRy
dk1zZyhzY3JuLT5zY3JuSW5kZXgsIFhfQ09ORklHLCAiR2xhbW9yIGRpc2FibGVkLlxuIik7Cisg
ICAgICAgIHJldHVybiBGQUxTRTsKKyAgICB9CisKKyAgICBpZiAoIXhmODZMb2FkU3ViTW9kdWxl
KHNjcm4sIEdMQU1PUl9FR0xfTU9EVUxFX05BTUUpKSB7CisgICAgICAgIHhmODZEcnZNc2coc2Ny
bi0+c2NybkluZGV4LCBYX0VSUk9SLCAiRmFpbGVkIHRvIGxvYWQgZ2xhbW9yIG1vZHVsZS5cbiIp
OworICAgICAgICByZXR1cm4gRkFMU0U7CisgICAgfQorCisgICAgaWYgKCFnbGFtb3JfZWdsX2lu
aXQoc2NybiwgZHVtbXktPmZkKSkgeworICAgICAgICB4Zjg2RHJ2TXNnKHNjcm4tPnNjcm5JbmRl
eCwgWF9FUlJPUiwgIkdsYW1vciBpbml0aWFsaXNhdGlvbiBmYWlsZWQuXG4iKTsKKyAgICAgICAg
cmV0dXJuIEZBTFNFOworICAgIH0KKworICAgIHhmODZEcnZNc2coc2Nybi0+c2NybkluZGV4LCBY
X0lORk8sICJHbGFtb3IgaW5pdGlhbGlzZWQuXG4iKTsKKworICAgIHJldHVybiBUUlVFOworfQor
CiAjZGVmaW5lIFJFVFVSTiBcCiAgICAgeyBEVU1NWUZyZWVSZWMocFNjcm4pO1wKIAkJCSAgICBy
ZXR1cm4gRkFMU0U7XApAQCAtMzQ4LDYgKzM5OCw5IEBAIERVTU1ZUHJlSW5pdChTY3JuSW5mb1B0
ciBwU2NybiwgaW50IGZsYWdzKQogCiAgICAgeGY4NkdldE9wdFZhbEJvb2woZFB0ci0+T3B0aW9u
cywgT1BUSU9OX1NXX0NVUlNPUiwgJmRQdHItPnN3Q3Vyc29yKTsKIAorICAgIGRQdHItPmZkID0g
ZHVtbXlfb3Blbl9yZW5kZXJfbm9kZShwU2Nybik7CisgICAgZFB0ci0+Z2xhbW9yID0gZHVtbXlf
ZW5hYmxlX2dsYW1vcihwU2Nybik7CisKICAgICBpZiAoZGV2aWNlLT52aWRlb1JhbSAhPSAwKSB7
CiAgICAgICAgIHBTY3JuLT52aWRlb1JhbSA9IGRldmljZS0+dmlkZW9SYW07CiAgICAgICAgIHhm
ODZEcnZNc2cocFNjcm4tPnNjcm5JbmRleCwgWF9DT05GSUcsICJWaWRlb1JBTTogJWQga0J5dGVc
biIsIHBTY3JuLT52aWRlb1JhbSk7CkBAIC01NDYsNiArNTk5LDEyIEBAIERVTU1ZU2NyZWVuSW5p
dChTQ1JFRU5fSU5JVF9BUkdTX0RFQ0wpCiAgICAgLyogbXVzdCBiZSBhZnRlciBSR0Igb3JkZXJp
bmcgZml4ZWQgKi8KICAgICBmYlBpY3R1cmVJbml0KHBTY3JlZW4sIDAsIDApOwogCisgICAgaWYg
KGRQdHItPmdsYW1vciAmJiAhZ2xhbW9yX2luaXQocFNjcmVlbiwgR0xBTU9SX1VTRV9FR0xfU0NS
RUVOKSkgeworICAgICAgICB4Zjg2RHJ2TXNnKHBTY3JuLT5zY3JuSW5kZXgsIFhfRVJST1IsCisg
ICAgICAgICAgICAgICAgICAgIkZhaWxlZCB0byBpbml0aWFsaXNlIGdsYW1vciBhdCBTY3JlZW5J
bml0KCkgdGltZS5cbiIpOworICAgICAgICByZXR1cm4gRkFMU0U7CisgICAgfQorCiAgICAgeGY4
NlNldEJsYWNrV2hpdGVQaXhlbHMocFNjcmVlbik7CiAKICAgICBpZiAoZFB0ci0+c3dDdXJzb3Ip
CkBAIC02MDEsNiArNjYwLDE0IEBAIERVTU1ZU2NyZWVuSW5pdChTQ1JFRU5fSU5JVF9BUkdTX0RF
Q0wpCiAgICAgZFB0ci0+Q3JlYXRlV2luZG93ID0gcFNjcmVlbi0+Q3JlYXRlV2luZG93OwogICAg
IHBTY3JlZW4tPkNyZWF0ZVdpbmRvdyA9IERVTU1ZQ3JlYXRlV2luZG93OwogCisgICAgaWYgKGRQ
dHItPmdsYW1vcikgeworICAgICAgICBpZiAoIWR1bW15X2RyaTJfc2NyZWVuX2luaXQocFNjcmVl
bikpCisgICAgICAgICAgICB4Zjg2RHJ2TXNnKHBTY3JuLT5zY3JuSW5kZXgsIFhfRVJST1IsICJG
YWlsZWQgdG8gaW5pdGlhbGlzZSB0aGUgRFJJMiBleHRlbnNpb24uXG4iKTsKKworICAgICAgICBp
ZiAoIWR1bW15X3ByZXNlbnRfc2NyZWVuX2luaXQocFNjcmVlbikpCisgICAgICAgICAgICB4Zjg2
RHJ2TXNnKHBTY3JuLT5zY3JuSW5kZXgsIFhfRVJST1IsICJGYWlsZWQgdG8gaW5pdGlhbGlzZSB0
aGUgUHJlc2VudCBleHRlbnNpb24uXG4iKTsKKyAgICB9CisKICAgICAvKiBSZXBvcnQgYW55IHVu
dXNlZCBvcHRpb25zIChvbmx5IGZvciB0aGUgZmlyc3QgZ2VuZXJhdGlvbikgKi8KICAgICBpZiAo
c2VydmVyR2VuZXJhdGlvbiA9PSAxKSB7CiAgICAgICAgIHhmODZTaG93VW51c2VkT3B0aW9ucyhw
U2Nybi0+c2NybkluZGV4LCBwU2Nybi0+b3B0aW9ucyk7CkBAIC02MjksNiArNjk2LDkgQEAgRFVN
TVlDbG9zZVNjcmVlbihDTE9TRV9TQ1JFRU5fQVJHU19ERUNMKQogICAgIFNjcm5JbmZvUHRyIHBT
Y3JuID0geGY4NlNjcmVlblRvU2NybihwU2NyZWVuKTsKICAgICBEVU1NWVB0ciBkUHRyID0gRFVN
TVlQVFIocFNjcm4pOwogCisgICAgaWYgKGRQdHItPmdsYW1vcikKKyAgICAgICAgZHVtbXlfZHJp
Ml9jbG9zZV9zY3JlZW4ocFNjcmVlbik7CisKICAgICBmcmVlKHBTY3JlZW4tPkdldFNjcmVlblBp
eG1hcChwU2NyZWVuKS0+ZGV2UHJpdmF0ZS5wdHIpOwogCiAgICAgaWYgKGRQdHItPkN1cnNvcklu
Zm8pCi0tIAoyLjExLjAKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fClNwaWNlLWRldmVsIG1haWxpbmcgbGlzdApTcGljZS1kZXZlbEBsaXN0cy5mcmVlZGVz
a3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9z
cGljZS1kZXZlbA==
