Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 91FE849C16
	for <lists+spice-devel@lfdr.de>; Tue, 18 Jun 2019 10:35:47 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 1ACF289D9B;
	Tue, 18 Jun 2019 08:35:46 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id A8DAC89D9A
 for <spice-devel@lists.freedesktop.org>; Tue, 18 Jun 2019 08:35:44 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx07.intmail.prod.int.phx2.redhat.com
 [10.5.11.22])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id 4784B223864
 for <spice-devel@lists.freedesktop.org>; Tue, 18 Jun 2019 08:35:44 +0000 (UTC)
Received: from lub.tlv (dhcp-4-88.tlv.redhat.com [10.35.4.88])
 by smtp.corp.redhat.com (Postfix) with ESMTPS id 7C9311001DCC;
 Tue, 18 Jun 2019 08:35:43 +0000 (UTC)
To: Frediano Ziglio <fziglio@redhat.com>, spice-devel@lists.freedesktop.org
References: <20190603112214.15093-1-fziglio@redhat.com>
From: Uri Lublin <uril@redhat.com>
Organization: Red Hat
Message-ID: <4aea164c-ba16-3649-4bc4-de49e8a847bb@redhat.com>
Date: Tue, 18 Jun 2019 11:35:41 +0300
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.7.0
MIME-Version: 1.0
In-Reply-To: <20190603112214.15093-1-fziglio@redhat.com>
Content-Language: en-US
X-Scanned-By: MIMEDefang 2.84 on 10.5.11.22
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16
 (mx1.redhat.com [10.5.110.39]); Tue, 18 Jun 2019 08:35:44 +0000 (UTC)
Subject: Re: [Spice-devel] [PATCH spice-server 1/3] Use SPICE_CONTAINEROF to
 avoid some possible alignment warnings on MIPS
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Reply-To: uril@redhat.com
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

T24gNi8zLzE5IDI6MjIgUE0sIEZyZWRpYW5vIFppZ2xpbyB3cm90ZToKPiBUaGlzIHBhdGNoIGNh
bWUgZnJvbSBzb21lIGV4cGVyaW1lbnRzIHVzaW5nIGFuIGVtdWxhdGVkIE1JUFMgbWFjaGluZS4K
PiBPbiBzdWNoIGFyY2hpdGVjdHVyZSBkdWUgdG8gbm90IHN1cHBvcnRpbmcgYWxpZ25tZW50IGFj
Y2VzcyB0aGUKPiBjb21waWxlciBpcyBtb3JlIHN0cmljdCBhYm91dCBjb252ZXJzaW9uIGNvbXBs
YWluaW5nIHdpdGggc29tZQo+IHBvaW50ZXIgY2FzdHMuIFVzZSBkaWZmZXJlbnQgY29udmVyc2lv
biB0byBhdm9pZCB0aGVzZSB3YXJuaW5ncy4KPiAKPiBTaWduZWQtb2ZmLWJ5OiBGcmVkaWFubyBa
aWdsaW8gPGZ6aWdsaW9AcmVkaGF0LmNvbT4KCkFjay4KCkknbSBub3Qgc3VyZSB0aGlzIHBhdGNo
IHJlYWxseSAiZml4ZXMiIGFsaWdubWVudCwgZXNwZWNpYWxseQp3aGVuIHRoZSBmaWVsZCBpcyB0
aGUgZmlyc3Qgb25lID09IG9mZnNldCBpcyAwLCBidXQgaXQgbWFrZXMKdGhlIGNvbXBpbGVyIGhh
cHB5IGFuZCBpdCdzIGNvcnJlY3QKClVyaS4KCj4gLS0tCj4gICBzZXJ2ZXIvY2FjaGUtaXRlbS50
bXBsLmMgfCAgMyArKy0KPiAgIHNlcnZlci9kY2MuYyAgICAgICAgICAgICB8ICA0ICsrLS0KPiAg
IHNlcnZlci9pbWFnZS1jYWNoZS5jICAgICB8ICA1ICsrKy0tCj4gICBzZXJ2ZXIvaW1hZ2UtZW5j
b2RlcnMuYyAgfCAyNiArKysrKysrKysrKysrLS0tLS0tLS0tLS0tLQo+ICAgc2VydmVyL21qcGVn
LWVuY29kZXIuYyAgIHwgMTIgKysrKysrLS0tLS0tCj4gICBzZXJ2ZXIvcGl4bWFwLWNhY2hlLmMg
ICAgfCAgMiArLQo+ICAgNiBmaWxlcyBjaGFuZ2VkLCAyNyBpbnNlcnRpb25zKCspLCAyNSBkZWxl
dGlvbnMoLSkKPiAKPiBkaWZmIC0tZ2l0IGEvc2VydmVyL2NhY2hlLWl0ZW0udG1wbC5jIGIvc2Vy
dmVyL2NhY2hlLWl0ZW0udG1wbC5jCj4gaW5kZXggZjExOWE5ZWU0Li44ZTE4ZjliMWIgMTAwNjQ0
Cj4gLS0tIGEvc2VydmVyL2NhY2hlLWl0ZW0udG1wbC5jCj4gKysrIGIvc2VydmVyL2NhY2hlLWl0
ZW0udG1wbC5jCj4gQEAgLTg5LDcgKzg5LDggQEAgc3RhdGljIGludCBGVU5DX05BTUUoYWRkKShD
SEFOTkVMQ0xJRU5UICpjaGFubmVsX2NsaWVudCwgdWludDY0X3QgaWQsIHNpemVfdCBzaXoKPiAg
ICAgICBjaGFubmVsX2NsaWVudC0+cHJpdi0+VkFSX05BTUUoYXZhaWxhYmxlKSAtPSBzaXplOwo+
ICAgICAgIFNQSUNFX1ZFUklGWShTUElDRV9PRkZTRVRPRihSZWRDYWNoZUl0ZW0sIHUuY2FjaGVf
ZGF0YS5scnVfbGluaykgPT0gMCk7Cj4gICAgICAgd2hpbGUgKGNoYW5uZWxfY2xpZW50LT5wcml2
LT5WQVJfTkFNRShhdmFpbGFibGUpIDwgMCkgewo+IC0gICAgICAgIFJlZENhY2hlSXRlbSAqdGFp
bCA9IChSZWRDYWNoZUl0ZW0gKilyaW5nX2dldF90YWlsKCZjaGFubmVsX2NsaWVudC0+cHJpdi0+
VkFSX05BTUUobHJ1KSk7Cj4gKyAgICAgICAgUmVkQ2FjaGVJdGVtICp0YWlsID0gU1BJQ0VfQ09O
VEFJTkVST0YocmluZ19nZXRfdGFpbCgmY2hhbm5lbF9jbGllbnQtPnByaXYtPlZBUl9OQU1FKGxy
dSkpLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgUmVkQ2FjaGVJdGVtLCB1LmNhY2hlX2RhdGEubHJ1X2xpbmspOwo+ICAgICAg
ICAgICBpZiAoIXRhaWwpIHsKPiAgICAgICAgICAgICAgIGNoYW5uZWxfY2xpZW50LT5wcml2LT5W
QVJfTkFNRShhdmFpbGFibGUpICs9IHNpemU7Cj4gICAgICAgICAgICAgICBnX2ZyZWUoaXRlbSk7
Cj4gZGlmZiAtLWdpdCBhL3NlcnZlci9kY2MuYyBiL3NlcnZlci9kY2MuYwo+IGluZGV4IGFjYzFj
YTM4Yy4uNzFkMDliNzdmIDEwMDY0NAo+IC0tLSBhL3NlcnZlci9kY2MuYwo+ICsrKyBiL3NlcnZl
ci9kY2MuYwo+IEBAIC05NjgsOCArOTY4LDggQEAgYm9vbCBkY2NfcGl4bWFwX2NhY2hlX3VubG9j
a2VkX2FkZChEaXNwbGF5Q2hhbm5lbENsaWVudCAqZGNjLCB1aW50NjRfdCBpZCwKPiAgICAgICAg
ICAgTmV3Q2FjaGVJdGVtICoqbm93Owo+ICAgCj4gICAgICAgICAgIFNQSUNFX1ZFUklGWShTUElD
RV9PRkZTRVRPRihOZXdDYWNoZUl0ZW0sIGxydV9saW5rKSA9PSAwKTsKPiAtICAgICAgICBpZiAo
ISh0YWlsID0gKE5ld0NhY2hlSXRlbSAqKXJpbmdfZ2V0X3RhaWwoJmNhY2hlLT5scnUpKSB8fAo+
IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWls
LT5zeW5jW2RjYy0+cHJpdi0+aWRdID09IHNlcmlhbCkgewo+ICsgICAgICAgIGlmICghKHRhaWwg
PSBTUElDRV9DT05UQUlORVJPRihyaW5nX2dldF90YWlsKCZjYWNoZS0+bHJ1KSwgTmV3Q2FjaGVJ
dGVtLCBscnVfbGluaykpIHx8Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgdGFpbC0+c3luY1tkY2MtPnByaXYtPmlkXSA9PSBzZXJpYWwpIHsK
PiAgICAgICAgICAgICAgIGNhY2hlLT5hdmFpbGFibGUgKz0gc2l6ZTsKPiAgICAgICAgICAgICAg
IGdfZnJlZShpdGVtKTsKPiAgICAgICAgICAgICAgIHJldHVybiBGQUxTRTsKPiBkaWZmIC0tZ2l0
IGEvc2VydmVyL2ltYWdlLWNhY2hlLmMgYi9zZXJ2ZXIvaW1hZ2UtY2FjaGUuYwo+IGluZGV4IDJj
YTRkNGI2Ny4uNDg4MWY0ZDkyIDEwMDY0NAo+IC0tLSBhL3NlcnZlci9pbWFnZS1jYWNoZS5jCj4g
KysrIGIvc2VydmVyL2ltYWdlLWNhY2hlLmMKPiBAQCAtNzgsNyArNzgsOCBAQCBzdGF0aWMgdm9p
ZCBpbWFnZV9jYWNoZV9wdXQoU3BpY2VJbWFnZUNhY2hlICpzcGljZV9jYWNoZSwgdWludDY0X3Qg
aWQsIHBpeG1hbl9pbQo+ICAgI2lmbmRlZiBJTUFHRV9DQUNIRV9BR0UKPiAgICAgICBpZiAoY2Fj
aGUtPm51bV9pdGVtcyA9PSBJTUFHRV9DQUNIRV9NQVhfSVRFTVMpIHsKPiAgICAgICAgICAgU1BJ
Q0VfVkVSSUZZKFNQSUNFX09GRlNFVE9GKEltYWdlQ2FjaGVJdGVtLCBscnVfbGluaykgPT0gMCk7
Cj4gLSAgICAgICAgSW1hZ2VDYWNoZUl0ZW0gKnRhaWwgPSAoSW1hZ2VDYWNoZUl0ZW0gKilyaW5n
X2dldF90YWlsKCZjYWNoZS0+bHJ1KTsKPiArICAgICAgICBJbWFnZUNhY2hlSXRlbSAqdGFpbCA9
Cj4gKyAgICAgICAgICAgIFNQSUNFX0NPTlRBSU5FUk9GKHJpbmdfZ2V0X3RhaWwoJmNhY2hlLT5s
cnUpLCBJbWFnZUNhY2hlSXRlbSwgbHJ1X2xpbmspOwo+ICAgICAgICAgICBzcGljZV9hc3NlcnQo
dGFpbCk7Cj4gICAgICAgICAgIGltYWdlX2NhY2hlX3JlbW92ZShjYWNoZSwgdGFpbCk7Cj4gICAg
ICAgfQo+IEBAIC0xMzMsNyArMTM0LDcgQEAgdm9pZCBpbWFnZV9jYWNoZV9yZXNldChJbWFnZUNh
Y2hlICpjYWNoZSkKPiAgICAgICBJbWFnZUNhY2hlSXRlbSAqaXRlbTsKPiAgIAo+ICAgICAgIFNQ
SUNFX1ZFUklGWShTUElDRV9PRkZTRVRPRihJbWFnZUNhY2hlSXRlbSwgbHJ1X2xpbmspID09IDAp
Owo+IC0gICAgd2hpbGUgKChpdGVtID0gKEltYWdlQ2FjaGVJdGVtICopcmluZ19nZXRfaGVhZCgm
Y2FjaGUtPmxydSkpKSB7Cj4gKyAgICB3aGlsZSAoKGl0ZW0gPSBTUElDRV9DT05UQUlORVJPRihy
aW5nX2dldF9oZWFkKCZjYWNoZS0+bHJ1KSwgSW1hZ2VDYWNoZUl0ZW0sIGxydV9saW5rKSkpIHsK
PiAgICAgICAgICAgaW1hZ2VfY2FjaGVfcmVtb3ZlKGNhY2hlLCBpdGVtKTsKPiAgICAgICB9Cj4g
ICAjaWZkZWYgSU1BR0VfQ0FDSEVfQUdFCj4gZGlmZiAtLWdpdCBhL3NlcnZlci9pbWFnZS1lbmNv
ZGVycy5jIGIvc2VydmVyL2ltYWdlLWVuY29kZXJzLmMKPiBpbmRleCAzMDZjNmRjYTYuLmQ0ZDQ4
NmMzNiAxMDA2NDQKPiAtLS0gYS9zZXJ2ZXIvaW1hZ2UtZW5jb2RlcnMuYwo+ICsrKyBiL3NlcnZl
ci9pbWFnZS1lbmNvZGVycy5jCj4gQEAgLTg5LDcgKzg5LDcgQEAgc3RhdGljIHZvaWQgaW1hZ2Vf
ZW5jb2RlcnNfcmVsZWFzZV9nbHooSW1hZ2VFbmNvZGVycyAqZW5jKTsKPiAgIHN0YXRpYyBTUElD
RV9HTlVDX05PUkVUVVJOIFNQSUNFX0dOVUNfUFJJTlRGKDIsIDMpIHZvaWQKPiAgIHF1aWNfdXNy
X2Vycm9yKFF1aWNVc3JDb250ZXh0ICp1c3IsIGNvbnN0IGNoYXIgKmZtdCwgLi4uKQo+ICAgewo+
IC0gICAgRW5jb2RlckRhdGEgKnVzcl9kYXRhID0gJigoKFF1aWNEYXRhICopdXNyKS0+ZGF0YSk7
Cj4gKyAgICBFbmNvZGVyRGF0YSAqdXNyX2RhdGEgPSAmKFNQSUNFX0NPTlRBSU5FUk9GKHVzciwg
UXVpY0RhdGEsIHVzciktPmRhdGEpOwo+ICAgICAgIHZhX2xpc3QgYXA7Cj4gICAgICAgY2hhciBt
ZXNzYWdlX2J1ZltFTkNPREVSX01FU1NBR0VfU0laRV07Cj4gICAKPiBAQCAtMTA0LDcgKzEwNCw3
IEBAIHF1aWNfdXNyX2Vycm9yKFF1aWNVc3JDb250ZXh0ICp1c3IsIGNvbnN0IGNoYXIgKmZtdCwg
Li4uKQo+ICAgc3RhdGljIFNQSUNFX0dOVUNfTk9SRVRVUk4gU1BJQ0VfR05VQ19QUklOVEYoMiwg
Mykgdm9pZAo+ICAgbHpfdXNyX2Vycm9yKEx6VXNyQ29udGV4dCAqdXNyLCBjb25zdCBjaGFyICpm
bXQsIC4uLikKPiAgIHsKPiAtICAgIEVuY29kZXJEYXRhICp1c3JfZGF0YSA9ICYoKChMekRhdGEg
Kil1c3IpLT5kYXRhKTsKPiArICAgIEVuY29kZXJEYXRhICp1c3JfZGF0YSA9ICYoU1BJQ0VfQ09O
VEFJTkVST0YodXNyLCBMekRhdGEsIHVzciktPmRhdGEpOwo+ICAgICAgIHZhX2xpc3QgYXA7Cj4g
ICAgICAgY2hhciBtZXNzYWdlX2J1ZltFTkNPREVSX01FU1NBR0VfU0laRV07Cj4gICAKPiBAQCAt
MjMzLDI1ICsyMzMsMjUgQEAgc3RhdGljIGludCBlbmNvZGVyX3Vzcl9tb3JlX3NwYWNlKEVuY29k
ZXJEYXRhICplbmNfZGF0YSwgdWludDhfdCAqKmlvX3B0cikKPiAgIAo+ICAgc3RhdGljIGludCBx
dWljX3Vzcl9tb3JlX3NwYWNlKFF1aWNVc3JDb250ZXh0ICp1c3IsIHVpbnQzMl90ICoqaW9fcHRy
LCBpbnQgcm93c19jb21wbGV0ZWQpCj4gICB7Cj4gLSAgICBFbmNvZGVyRGF0YSAqdXNyX2RhdGEg
PSAmKCgoUXVpY0RhdGEgKil1c3IpLT5kYXRhKTsKPiArICAgIEVuY29kZXJEYXRhICp1c3JfZGF0
YSA9ICYoU1BJQ0VfQ09OVEFJTkVST0YodXNyLCBRdWljRGF0YSwgdXNyKS0+ZGF0YSk7Cj4gICAg
ICAgcmV0dXJuIGVuY29kZXJfdXNyX21vcmVfc3BhY2UodXNyX2RhdGEsICh1aW50OF90ICoqKWlv
X3B0cikgLyBzaXplb2YodWludDMyX3QpOwo+ICAgfQo+ICAgCj4gICBzdGF0aWMgaW50IGx6X3Vz
cl9tb3JlX3NwYWNlKEx6VXNyQ29udGV4dCAqdXNyLCB1aW50OF90ICoqaW9fcHRyKQo+ICAgewo+
IC0gICAgRW5jb2RlckRhdGEgKnVzcl9kYXRhID0gJigoKEx6RGF0YSAqKXVzciktPmRhdGEpOwo+
ICsgICAgRW5jb2RlckRhdGEgKnVzcl9kYXRhID0gJihTUElDRV9DT05UQUlORVJPRih1c3IsIEx6
RGF0YSwgdXNyKS0+ZGF0YSk7Cj4gICAgICAgcmV0dXJuIGVuY29kZXJfdXNyX21vcmVfc3BhY2Uo
dXNyX2RhdGEsIGlvX3B0cik7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyBpbnQgZ2x6X3Vzcl9tb3Jl
X3NwYWNlKEdsekVuY29kZXJVc3JDb250ZXh0ICp1c3IsIHVpbnQ4X3QgKippb19wdHIpCj4gICB7
Cj4gLSAgICBFbmNvZGVyRGF0YSAqdXNyX2RhdGEgPSAmKCgoR2x6RGF0YSAqKXVzciktPmRhdGEp
Owo+ICsgICAgRW5jb2RlckRhdGEgKnVzcl9kYXRhID0gJihTUElDRV9DT05UQUlORVJPRih1c3Is
IEdsekRhdGEsIHVzciktPmRhdGEpOwo+ICAgICAgIHJldHVybiBlbmNvZGVyX3Vzcl9tb3JlX3Nw
YWNlKHVzcl9kYXRhLCBpb19wdHIpOwo+ICAgfQo+ICAgCj4gICBzdGF0aWMgaW50IGpwZWdfdXNy
X21vcmVfc3BhY2UoSnBlZ0VuY29kZXJVc3JDb250ZXh0ICp1c3IsIHVpbnQ4X3QgKippb19wdHIp
Cj4gICB7Cj4gLSAgICBFbmNvZGVyRGF0YSAqdXNyX2RhdGEgPSAmKCgoSnBlZ0RhdGEgKil1c3Ip
LT5kYXRhKTsKPiArICAgIEVuY29kZXJEYXRhICp1c3JfZGF0YSA9ICYoU1BJQ0VfQ09OVEFJTkVS
T0YodXNyLCBKcGVnRGF0YSwgdXNyKS0+ZGF0YSk7Cj4gICAgICAgcmV0dXJuIGVuY29kZXJfdXNy
X21vcmVfc3BhY2UodXNyX2RhdGEsIGlvX3B0cik7Cj4gICB9Cj4gICAKPiBAQCAtMjY1LDcgKzI2
NSw3IEBAIHN0YXRpYyBpbnQgbHo0X3Vzcl9tb3JlX3NwYWNlKEx6NEVuY29kZXJVc3JDb250ZXh0
ICp1c3IsIHVpbnQ4X3QgKippb19wdHIpCj4gICAKPiAgIHN0YXRpYyBpbnQgemxpYl91c3JfbW9y
ZV9zcGFjZShabGliRW5jb2RlclVzckNvbnRleHQgKnVzciwgdWludDhfdCAqKmlvX3B0cikKPiAg
IHsKPiAtICAgIEVuY29kZXJEYXRhICp1c3JfZGF0YSA9ICYoKChabGliRGF0YSAqKXVzciktPmRh
dGEpOwo+ICsgICAgRW5jb2RlckRhdGEgKnVzcl9kYXRhID0gJihTUElDRV9DT05UQUlORVJPRih1
c3IsIFpsaWJEYXRhLCB1c3IpLT5kYXRhKTsKPiAgICAgICByZXR1cm4gZW5jb2Rlcl91c3JfbW9y
ZV9zcGFjZSh1c3JfZGF0YSwgaW9fcHRyKTsKPiAgIH0KPiAgIAo+IEBAIC0zMDEsMjUgKzMwMSwy
NSBAQCBzdGF0aWMgaW5saW5lIGludCBlbmNvZGVyX3Vzcl9tb3JlX2xpbmVzKEVuY29kZXJEYXRh
ICplbmNfZGF0YSwgdWludDhfdCAqKmxpbmVzKQo+ICAgCj4gICBzdGF0aWMgaW50IHF1aWNfdXNy
X21vcmVfbGluZXMoUXVpY1VzckNvbnRleHQgKnVzciwgdWludDhfdCAqKmxpbmVzKQo+ICAgewo+
IC0gICAgRW5jb2RlckRhdGEgKnVzcl9kYXRhID0gJigoKFF1aWNEYXRhICopdXNyKS0+ZGF0YSk7
Cj4gKyAgICBFbmNvZGVyRGF0YSAqdXNyX2RhdGEgPSAmKFNQSUNFX0NPTlRBSU5FUk9GKHVzciwg
UXVpY0RhdGEsIHVzciktPmRhdGEpOwo+ICAgICAgIHJldHVybiBlbmNvZGVyX3Vzcl9tb3JlX2xp
bmVzKHVzcl9kYXRhLCBsaW5lcyk7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyBpbnQgbHpfdXNyX21v
cmVfbGluZXMoTHpVc3JDb250ZXh0ICp1c3IsIHVpbnQ4X3QgKipsaW5lcykKPiAgIHsKPiAtICAg
IEVuY29kZXJEYXRhICp1c3JfZGF0YSA9ICYoKChMekRhdGEgKil1c3IpLT5kYXRhKTsKPiArICAg
IEVuY29kZXJEYXRhICp1c3JfZGF0YSA9ICYoU1BJQ0VfQ09OVEFJTkVST0YodXNyLCBMekRhdGEs
IHVzciktPmRhdGEpOwo+ICAgICAgIHJldHVybiBlbmNvZGVyX3Vzcl9tb3JlX2xpbmVzKHVzcl9k
YXRhLCBsaW5lcyk7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyBpbnQgZ2x6X3Vzcl9tb3JlX2xpbmVz
KEdsekVuY29kZXJVc3JDb250ZXh0ICp1c3IsIHVpbnQ4X3QgKipsaW5lcykKPiAgIHsKPiAtICAg
IEVuY29kZXJEYXRhICp1c3JfZGF0YSA9ICYoKChHbHpEYXRhICopdXNyKS0+ZGF0YSk7Cj4gKyAg
ICBFbmNvZGVyRGF0YSAqdXNyX2RhdGEgPSAmKFNQSUNFX0NPTlRBSU5FUk9GKHVzciwgR2x6RGF0
YSwgdXNyKS0+ZGF0YSk7Cj4gICAgICAgcmV0dXJuIGVuY29kZXJfdXNyX21vcmVfbGluZXModXNy
X2RhdGEsIGxpbmVzKTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIGludCBqcGVnX3Vzcl9tb3JlX2xp
bmVzKEpwZWdFbmNvZGVyVXNyQ29udGV4dCAqdXNyLCB1aW50OF90ICoqbGluZXMpCj4gICB7Cj4g
LSAgICBFbmNvZGVyRGF0YSAqdXNyX2RhdGEgPSAmKCgoSnBlZ0RhdGEgKil1c3IpLT5kYXRhKTsK
PiArICAgIEVuY29kZXJEYXRhICp1c3JfZGF0YSA9ICYoU1BJQ0VfQ09OVEFJTkVST0YodXNyLCBK
cGVnRGF0YSwgdXNyKS0+ZGF0YSk7Cj4gICAgICAgcmV0dXJuIGVuY29kZXJfdXNyX21vcmVfbGlu
ZXModXNyX2RhdGEsIGxpbmVzKTsKPiAgIH0KPiAgIAo+IEBAIC0zMzMsNyArMzMzLDcgQEAgc3Rh
dGljIGludCBsejRfdXNyX21vcmVfbGluZXMoTHo0RW5jb2RlclVzckNvbnRleHQgKnVzciwgdWlu
dDhfdCAqKmxpbmVzKQo+ICAgCj4gICBzdGF0aWMgaW50IHpsaWJfdXNyX21vcmVfaW5wdXQoWmxp
YkVuY29kZXJVc3JDb250ZXh0ICp1c3IsIHVpbnQ4X3QqKiBpbnB1dCkKPiAgIHsKPiAtICAgIEVu
Y29kZXJEYXRhICp1c3JfZGF0YSA9ICYoKChabGliRGF0YSAqKXVzciktPmRhdGEpOwo+ICsgICAg
RW5jb2RlckRhdGEgKnVzcl9kYXRhID0gJihTUElDRV9DT05UQUlORVJPRih1c3IsIFpsaWJEYXRh
LCB1c3IpLT5kYXRhKTsKPiAgICAgICBpbnQgYnVmX3NpemU7Cj4gICAKPiAgICAgICBpZiAoIXVz
cl9kYXRhLT51LmNvbXByZXNzZWRfZGF0YS5uZXh0KSB7Cj4gQEAgLTM4Niw3ICszODYsNyBAQCBz
dGF0aWMgdm9pZCBpbWFnZV9lbmNvZGVyc19pbml0X2x6KEltYWdlRW5jb2RlcnMgKmVuYykKPiAg
IAo+ICAgc3RhdGljIHZvaWQgZ2x6X3Vzcl9mcmVlX2ltYWdlKEdsekVuY29kZXJVc3JDb250ZXh0
ICp1c3IsIEdselVzckltYWdlQ29udGV4dCAqaW1hZ2UpCj4gICB7Cj4gLSAgICBHbHpEYXRhICps
el9kYXRhID0gKEdsekRhdGEgKil1c3I7Cj4gKyAgICBHbHpEYXRhICpsel9kYXRhID0gU1BJQ0Vf
Q09OVEFJTkVST0YodXNyLCBHbHpEYXRhLCB1c3IpOwo+ICAgICAgIEdsekRyYXdhYmxlSW5zdGFu
Y2VJdGVtICpnbHpfZHJhd2FibGVfaW5zdGFuY2UgPSAoR2x6RHJhd2FibGVJbnN0YW5jZUl0ZW0g
KilpbWFnZTsKPiAgICAgICBJbWFnZUVuY29kZXJzICpkcmF3YWJsZV9lbmMgPSBnbHpfZHJhd2Fi
bGVfaW5zdGFuY2UtPmdsel9kcmF3YWJsZS0+ZW5jb2RlcnM7Cj4gICAgICAgSW1hZ2VFbmNvZGVy
cyAqdGhpc19lbmMgPSBTUElDRV9DT05UQUlORVJPRihsel9kYXRhLCBJbWFnZUVuY29kZXJzLCBn
bHpfZGF0YSk7Cj4gZGlmZiAtLWdpdCBhL3NlcnZlci9tanBlZy1lbmNvZGVyLmMgYi9zZXJ2ZXIv
bWpwZWctZW5jb2Rlci5jCj4gaW5kZXggNGEwMmU3YzhiLi5lNjI5YWRhZTQgMTAwNjQ0Cj4gLS0t
IGEvc2VydmVyL21qcGVnLWVuY29kZXIuYwo+ICsrKyBiL3NlcnZlci9tanBlZy1lbmNvZGVyLmMK
PiBAQCAtMjA2LDcgKzIwNiw3IEBAIHN0YXRpYyBNSnBlZ1ZpZGVvQnVmZmVyKiBjcmVhdGVfbWpw
ZWdfdmlkZW9fYnVmZmVyKHZvaWQpCj4gICAKPiAgIHN0YXRpYyB2b2lkIG1qcGVnX2VuY29kZXJf
ZGVzdHJveShWaWRlb0VuY29kZXIgKnZpZGVvX2VuY29kZXIpCj4gICB7Cj4gLSAgICBNSnBlZ0Vu
Y29kZXIgKmVuY29kZXIgPSAoTUpwZWdFbmNvZGVyKil2aWRlb19lbmNvZGVyOwo+ICsgICAgTUpw
ZWdFbmNvZGVyICplbmNvZGVyID0gU1BJQ0VfQ09OVEFJTkVST0YodmlkZW9fZW5jb2RlciwgTUpw
ZWdFbmNvZGVyLCBiYXNlKTsKPiAgICAgICBnX2ZyZWUoZW5jb2Rlci0+Y2luZm8uZGVzdCk7Cj4g
ICAgICAganBlZ19kZXN0cm95X2NvbXByZXNzKCZlbmNvZGVyLT5jaW5mbyk7Cj4gICAgICAgZ19m
cmVlKGVuY29kZXItPnJvdyk7Cj4gQEAgLTkzMSw3ICs5MzEsNyBAQCBzdGF0aWMgaW50IG1qcGVn
X2VuY29kZXJfZW5jb2RlX2ZyYW1lKFZpZGVvRW5jb2RlciAqdmlkZW9fZW5jb2RlciwKPiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3BvaW50ZXIgYml0bWFwX29wYXF1
ZSwKPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVmlkZW9CdWZmZXIg
KipvdXRidWYpCj4gICB7Cj4gLSAgICBNSnBlZ0VuY29kZXIgKmVuY29kZXIgPSAoTUpwZWdFbmNv
ZGVyKil2aWRlb19lbmNvZGVyOwo+ICsgICAgTUpwZWdFbmNvZGVyICplbmNvZGVyID0gU1BJQ0Vf
Q09OVEFJTkVST0YodmlkZW9fZW5jb2RlciwgTUpwZWdFbmNvZGVyLCBiYXNlKTsKPiAgICAgICBN
SnBlZ1ZpZGVvQnVmZmVyICpidWZmZXIgPSBjcmVhdGVfbWpwZWdfdmlkZW9fYnVmZmVyKCk7Cj4g
ICAgICAgaWYgKCFidWZmZXIpIHsKPiAgICAgICAgICAgcmV0dXJuIFZJREVPX0VOQ09ERVJfRlJB
TUVfVU5TVVBQT1JURUQ7Cj4gQEAgLTExOTEsNyArMTE5MSw3IEBAIHN0YXRpYyB2b2lkIG1qcGVn
X2VuY29kZXJfY2xpZW50X3N0cmVhbV9yZXBvcnQoVmlkZW9FbmNvZGVyICp2aWRlb19lbmNvZGVy
LAo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQz
Ml90IGVuZF9mcmFtZV9kZWxheSwKPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgdWludDMyX3QgYXVkaW9fZGVsYXkpCj4gICB7Cj4gLSAgICBNSnBlZ0Vu
Y29kZXIgKmVuY29kZXIgPSAoTUpwZWdFbmNvZGVyKil2aWRlb19lbmNvZGVyOwo+ICsgICAgTUpw
ZWdFbmNvZGVyICplbmNvZGVyID0gU1BJQ0VfQ09OVEFJTkVST0YodmlkZW9fZW5jb2RlciwgTUpw
ZWdFbmNvZGVyLCBiYXNlKTsKPiAgICAgICBNSnBlZ0VuY29kZXJSYXRlQ29udHJvbCAqcmF0ZV9j
b250cm9sID0gJmVuY29kZXItPnJhdGVfY29udHJvbDsKPiAgICAgICBNSnBlZ0VuY29kZXJDbGll
bnRTdGF0ZSAqY2xpZW50X3N0YXRlID0gJnJhdGVfY29udHJvbC0+Y2xpZW50X3N0YXRlOwo+ICAg
ICAgIHVpbnQ2NF90IGF2Z19lbmNfc2l6ZSA9IDA7Cj4gQEAgLTEyODksNyArMTI4OSw3IEBAIHN0
YXRpYyB2b2lkIG1qcGVnX2VuY29kZXJfY2xpZW50X3N0cmVhbV9yZXBvcnQoVmlkZW9FbmNvZGVy
ICp2aWRlb19lbmNvZGVyLAo+ICAgCj4gICBzdGF0aWMgdm9pZCBtanBlZ19lbmNvZGVyX25vdGlm
eV9zZXJ2ZXJfZnJhbWVfZHJvcChWaWRlb0VuY29kZXIgKnZpZGVvX2VuY29kZXIpCj4gICB7Cj4g
LSAgICBNSnBlZ0VuY29kZXIgKmVuY29kZXIgPSAoTUpwZWdFbmNvZGVyKil2aWRlb19lbmNvZGVy
Owo+ICsgICAgTUpwZWdFbmNvZGVyICplbmNvZGVyID0gU1BJQ0VfQ09OVEFJTkVST0YodmlkZW9f
ZW5jb2RlciwgTUpwZWdFbmNvZGVyLCBiYXNlKTsKPiAgICAgICBlbmNvZGVyLT5yYXRlX2NvbnRy
b2wuc2VydmVyX3N0YXRlLm51bV9mcmFtZXNfZHJvcHBlZCsrOwo+ICAgICAgIG1qcGVnX2VuY29k
ZXJfcHJvY2Vzc19zZXJ2ZXJfZHJvcHMoZW5jb2Rlcik7Cj4gICB9Cj4gQEAgLTEzMjgsMTQgKzEz
MjgsMTQgQEAgc3RhdGljIHZvaWQgbWpwZWdfZW5jb2Rlcl9wcm9jZXNzX3NlcnZlcl9kcm9wcyhN
SnBlZ0VuY29kZXIgKmVuY29kZXIpCj4gICAKPiAgIHN0YXRpYyB1aW50NjRfdCBtanBlZ19lbmNv
ZGVyX2dldF9iaXRfcmF0ZShWaWRlb0VuY29kZXIgKnZpZGVvX2VuY29kZXIpCj4gICB7Cj4gLSAg
ICBNSnBlZ0VuY29kZXIgKmVuY29kZXIgPSAoTUpwZWdFbmNvZGVyKil2aWRlb19lbmNvZGVyOwo+
ICsgICAgTUpwZWdFbmNvZGVyICplbmNvZGVyID0gU1BJQ0VfQ09OVEFJTkVST0YodmlkZW9fZW5j
b2RlciwgTUpwZWdFbmNvZGVyLCBiYXNlKTsKPiAgICAgICByZXR1cm4gZW5jb2Rlci0+cmF0ZV9j
b250cm9sLmJ5dGVfcmF0ZSAqIDg7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyB2b2lkIG1qcGVnX2Vu
Y29kZXJfZ2V0X3N0YXRzKFZpZGVvRW5jb2RlciAqdmlkZW9fZW5jb2RlciwKPiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZpZGVvRW5jb2RlclN0YXRzICpzdGF0cykKPiAg
IHsKPiAtICAgIE1KcGVnRW5jb2RlciAqZW5jb2RlciA9IChNSnBlZ0VuY29kZXIqKXZpZGVvX2Vu
Y29kZXI7Cj4gKyAgICBNSnBlZ0VuY29kZXIgKmVuY29kZXIgPSBTUElDRV9DT05UQUlORVJPRih2
aWRlb19lbmNvZGVyLCBNSnBlZ0VuY29kZXIsIGJhc2UpOwo+ICAgICAgIHNwaWNlX2Fzc2VydChl
bmNvZGVyICE9IE5VTEwgJiYgc3RhdHMgIT0gTlVMTCk7Cj4gICAgICAgc3RhdHMtPnN0YXJ0aW5n
X2JpdF9yYXRlID0gZW5jb2Rlci0+c3RhcnRpbmdfYml0X3JhdGU7Cj4gICAgICAgc3RhdHMtPmN1
cl9iaXRfcmF0ZSA9IG1qcGVnX2VuY29kZXJfZ2V0X2JpdF9yYXRlKHZpZGVvX2VuY29kZXIpOwo+
IGRpZmYgLS1naXQgYS9zZXJ2ZXIvcGl4bWFwLWNhY2hlLmMgYi9zZXJ2ZXIvcGl4bWFwLWNhY2hl
LmMKPiBpbmRleCA0ODlmZTBiZjYuLjQ5NjU5ZWE0MSAxMDA2NDQKPiAtLS0gYS9zZXJ2ZXIvcGl4
bWFwLWNhY2hlLmMKPiArKysgYi9zZXJ2ZXIvcGl4bWFwLWNhY2hlLmMKPiBAQCAtNDUsNyArNDUs
NyBAQCB2b2lkIHBpeG1hcF9jYWNoZV9jbGVhcihQaXhtYXBDYWNoZSAqY2FjaGUpCj4gICAgICAg
fQo+ICAgCj4gICAgICAgU1BJQ0VfVkVSSUZZKFNQSUNFX09GRlNFVE9GKE5ld0NhY2hlSXRlbSwg
bHJ1X2xpbmspID09IDApOwo+IC0gICAgd2hpbGUgKChpdGVtID0gKE5ld0NhY2hlSXRlbSAqKXJp
bmdfZ2V0X2hlYWQoJmNhY2hlLT5scnUpKSkgewo+ICsgICAgd2hpbGUgKChpdGVtID0gU1BJQ0Vf
Q09OVEFJTkVST0YocmluZ19nZXRfaGVhZCgmY2FjaGUtPmxydSksIE5ld0NhY2hlSXRlbSwgbHJ1
X2xpbmspKSkgewo+ICAgICAgICAgICByaW5nX3JlbW92ZSgmaXRlbS0+bHJ1X2xpbmspOwo+ICAg
ICAgICAgICBnX2ZyZWUoaXRlbSk7Cj4gICAgICAgfQo+IAoKX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX18KU3BpY2UtZGV2ZWwgbWFpbGluZyBsaXN0ClNwaWNl
LWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9y
Zy9tYWlsbWFuL2xpc3RpbmZvL3NwaWNlLWRldmVs
