Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 258F28D43A
	for <lists+spice-devel@lfdr.de>; Wed, 14 Aug 2019 15:08:55 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 5C49B6E1F4;
	Wed, 14 Aug 2019 13:08:53 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 1509D6E1F4
 for <spice-devel@lists.freedesktop.org>; Wed, 14 Aug 2019 13:08:52 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx03.intmail.prod.int.phx2.redhat.com
 [10.5.11.13])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id AA4BCE8B1A
 for <spice-devel@lists.freedesktop.org>; Wed, 14 Aug 2019 13:08:51 +0000 (UTC)
Received: from colo-mx.corp.redhat.com
 (colo-mx01.intmail.prod.int.phx2.redhat.com [10.5.11.20])
 by smtp.corp.redhat.com (Postfix) with ESMTPS id A1A2D81C0D
 for <spice-devel@lists.freedesktop.org>; Wed, 14 Aug 2019 13:08:51 +0000 (UTC)
Received: from zmail25.collab.prod.int.phx2.redhat.com
 (zmail25.collab.prod.int.phx2.redhat.com [10.5.83.31])
 by colo-mx.corp.redhat.com (Postfix) with ESMTP id 993FD18089C8;
 Wed, 14 Aug 2019 13:08:51 +0000 (UTC)
Date: Wed, 14 Aug 2019 09:08:51 -0400 (EDT)
From: Frediano Ziglio <fziglio@redhat.com>
To: Kevin Pouget <kpouget@redhat.com>
Message-ID: <829772421.5808891.1565788131423.JavaMail.zimbra@redhat.com>
In-Reply-To: <20190806153453.20616-2-kpouget@redhat.com>
References: <20190806153453.20616-1-kpouget@redhat.com>
 <20190806153453.20616-2-kpouget@redhat.com>
MIME-Version: 1.0
X-Originating-IP: [10.40.205.155, 10.4.195.15]
Thread-Topic: stream-channel: Add preferred video codec capability
Thread-Index: r0Cb3f1VrdcJhO/RDzcVei976sal4Q==
X-Scanned-By: MIMEDefang 2.79 on 10.5.11.13
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16
 (mx1.redhat.com [10.5.110.38]); Wed, 14 Aug 2019 13:08:51 +0000 (UTC)
Subject: Re: [Spice-devel] [RFC spice-server 1/3] stream-channel: Add
 preferred video codec capability
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: spice-devel@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

PiAKPiBUaGlzIHBhdGNoIGVuYWJsZXMgdGhlIFNQSUNFX0RJU1BMQVlfQ0FQX1BSRUZfVklERU9f
Q09ERUNfVFlQRQo+IGNhcGFiaWxpdHkgZm9yIHRoZSBzdHJlYW0tY2hhbm5lbC4KPiAKPiB2aWRl
b19zdHJlYW1fcGFyc2VfcHJlZmVycmVkX2NvZGVjczogbmV3IGZ1bmN0aW9uIGZvciBwYXJzaW5n
IHRoZQo+IFNQSUNFIHByb3RvY29sIG1lc3NhZ2UuIFRoaXMgY29kZSB1c2VkIHRvIGJlIGluc2lk
ZQo+IGRjY19oYW5kbGVfcHJlZmVycmVkX3ZpZGVvX2NvZGVjX3R5cGUuCj4gCj4gc3RydWN0IFN0
cmVhbUNoYW5uZWxDbGllbnQ6OmNsaWVudF9wcmVmZXJyZWRfdmlkZW9fY29kZWNzOiBuZXcgZmll
bGQuCj4gCj4gU2lnbmVkLW9mZi1ieTogS2V2aW4gUG91Z2V0IDxrcG91Z2V0QHJlZGhhdC5jb20+
Cj4gLS0tCj4gIHNlcnZlci9kY2MuYyAgICAgICAgICAgIHwgMzAgKy0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tCj4gIHNlcnZlci9zdHJlYW0tY2hhbm5lbC5jIHwgNDAgKysrKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKwo+ICBzZXJ2ZXIvdmlkZW8tc3RyZWFtLmMgICB8
IDM2ICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKwo+ICBzZXJ2ZXIvdmlkZW8t
c3RyZWFtLmggICB8ICAxICsKPiAgNCBmaWxlcyBjaGFuZ2VkLCA3OCBpbnNlcnRpb25zKCspLCAy
OSBkZWxldGlvbnMoLSkKPiAKPiBkaWZmIC0tZ2l0IGEvc2VydmVyL2RjYy5jIGIvc2VydmVyL2Rj
Yy5jCj4gaW5kZXggMjFlODU5OGUuLjUzOGYxZjUxIDEwMDY0NAo+IC0tLSBhL3NlcnZlci9kY2Mu
Ywo+ICsrKyBiL3NlcnZlci9kY2MuYwo+IEBAIC0xMTU4LDM4ICsxMTU4LDEwIEBAIHN0YXRpYyB2
b2lkIG9uX2Rpc3BsYXlfdmlkZW9fY29kZWNzX3VwZGF0ZShHT2JqZWN0Cj4gKmdvYmplY3QsIEdQ
YXJhbVNwZWMgKnBzcGVjLAo+ICBzdGF0aWMgaW50IGRjY19oYW5kbGVfcHJlZmVycmVkX3ZpZGVv
X2NvZGVjX3R5cGUoRGlzcGxheUNoYW5uZWxDbGllbnQgKmRjYywKPiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNwaWNlTXNnY0Rpc3BsYXlQcmVmZXJy
ZWRWaWRlb0NvZGVjVHlwZQo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgKm1zZykKPiAgewo+IC0gICAgZ2ludCBpLCBsZW47Cj4gLSAgICBnaW50IGlu
ZGV4ZXNbU1BJQ0VfVklERU9fQ09ERUNfVFlQRV9FTlVNX0VORF07Cj4gLSAgICBHQXJyYXkgKmNs
aWVudDsKPiAtCj4gICAgICBnX3JldHVybl92YWxfaWZfZmFpbChtc2ctPm51bV9vZl9jb2RlY3Mg
PiAwLCBUUlVFKTsKPiAKPiAtICAgIC8qIHNldCBkZWZhdWx0IHRvIGEgYmlnIGFuZCBwb3NpdGl2
ZSBudW1iZXIgKi8KPiAtICAgIG1lbXNldChpbmRleGVzLCAweDdmLCBzaXplb2YoaW5kZXhlcykp
Owo+IC0KPiAtICAgIGZvciAobGVuID0gMCwgaSA9IDA7IGkgPCBtc2ctPm51bV9vZl9jb2RlY3M7
IGkrKykgewo+IC0gICAgICAgIGdpbnQgdmlkZW9fY29kZWMgPSBtc2ctPmNvZGVjc1tpXTsKPiAt
Cj4gLSAgICAgICAgaWYgKHZpZGVvX2NvZGVjIDwgU1BJQ0VfVklERU9fQ09ERUNfVFlQRV9NSlBF
RyB8fAo+IC0gICAgICAgICAgICB2aWRlb19jb2RlYyA+PSBTUElDRV9WSURFT19DT0RFQ19UWVBF
X0VOVU1fRU5EKSB7Cj4gLSAgICAgICAgICAgIHNwaWNlX2RlYnVnKCJDbGllbnQgaGFzIHNlbnQg
dW5rbm93biB2aWRlby1jb2RlYyAodmFsdWUgJWQgYXQKPiBpbmRleCAlZCkuICIKPiAtICAgICAg
ICAgICAgICAgICAgICAgICAgIklnbm9yaW5nIGFzIHNlcnZlciBjYW4ndCBoYW5kbGUgaXQiLAo+
IC0gICAgICAgICAgICAgICAgICAgICAgICAgdmlkZW9fY29kZWMsIGkpOwo+IC0gICAgICAgICAg
ICBjb250aW51ZTsKPiAtICAgICAgICB9Cj4gLQo+IC0gICAgICAgIGlmIChpbmRleGVzW3ZpZGVv
X2NvZGVjXSA8IFNQSUNFX1ZJREVPX0NPREVDX1RZUEVfRU5VTV9FTkQpIHsKPiAtICAgICAgICAg
ICAgY29udGludWU7Cj4gLSAgICAgICAgfQo+IC0KPiAtICAgICAgICBsZW4rKzsKPiAtICAgICAg
ICBpbmRleGVzW3ZpZGVvX2NvZGVjXSA9IGxlbjsKPiAtICAgIH0KPiAtICAgIGNsaWVudCA9IGdf
YXJyYXlfc2l6ZWRfbmV3KEZBTFNFLCBGQUxTRSwgc2l6ZW9mKGdpbnQpLAo+IFNQSUNFX1ZJREVP
X0NPREVDX1RZUEVfRU5VTV9FTkQpOwo+IC0gICAgZ19hcnJheV9hcHBlbmRfdmFscyhjbGllbnQs
IGluZGV4ZXMsIFNQSUNFX1ZJREVPX0NPREVDX1RZUEVfRU5VTV9FTkQpOwo+IC0KPiAgICAgIGdf
Y2xlYXJfcG9pbnRlcigmZGNjLT5wcml2LT5jbGllbnRfcHJlZmVycmVkX3ZpZGVvX2NvZGVjcywK
PiAgICAgIGdfYXJyYXlfdW5yZWYpOwo+IC0gICAgZGNjLT5wcml2LT5jbGllbnRfcHJlZmVycmVk
X3ZpZGVvX2NvZGVjcyA9IGNsaWVudDsKPiArICAgIGRjYy0+cHJpdi0+Y2xpZW50X3ByZWZlcnJl
ZF92aWRlb19jb2RlY3MgPQo+IHZpZGVvX3N0cmVhbV9wYXJzZV9wcmVmZXJyZWRfY29kZWNzKG1z
Zyk7Cj4gCj4gICAgICAvKiBOZXcgY2xpZW50IHByZWZlcmVuY2UgKi8KPiAgICAgIGRjY191cGRh
dGVfcHJlZmVycmVkX3ZpZGVvX2NvZGVjcyhkY2MpOwo+IGRpZmYgLS1naXQgYS9zZXJ2ZXIvc3Ry
ZWFtLWNoYW5uZWwuYyBiL3NlcnZlci9zdHJlYW0tY2hhbm5lbC5jCj4gaW5kZXggNzk1MzAxOGUu
LmZhNDgwNGYxIDEwMDY0NAo+IC0tLSBhL3NlcnZlci9zdHJlYW0tY2hhbm5lbC5jCj4gKysrIGIv
c2VydmVyL3N0cmVhbS1jaGFubmVsLmMKPiBAQCAtMjIsNiArMjIsNyBAQAo+ICAjaW5jbHVkZSA8
c3BpY2Uvc3RyZWFtLWRldmljZS5oPgo+IAo+ICAjaW5jbHVkZSAicmVkLWNoYW5uZWwtY2xpZW50
LmgiCj4gKyNpbmNsdWRlICJyZWQtY2xpZW50LmgiCgpXaHkgcmVkLWNsaWVudCA/PyBTaG91bGQg
bm90IGJlIHZpZGVvLXN0cmVhbS5oID8KCj4gICNpbmNsdWRlICJzdHJlYW0tY2hhbm5lbC5oIgo+
ICAjaW5jbHVkZSAicmVkcy5oIgo+ICAjaW5jbHVkZSAiY29tbW9uLWdyYXBoaWNzLWNoYW5uZWwu
aCIKPiBAQCAtNTIsNiArNTMsOSBAQCBzdHJ1Y3QgU3RyZWFtQ2hhbm5lbENsaWVudCB7Cj4gICAg
ICAvKiBjdXJyZW50IHZpZGVvIHN0cmVhbSBpZCwgPDAgaWYgbm90IGluaXRpYWxpemVkIG9yCj4g
ICAgICAgKiB3ZSBhcmUgbm90IHNlbmRpbmcgYSBzdHJlYW0gKi8KPiAgICAgIGludCBzdHJlYW1f
aWQ7Cj4gKyAgICAvKiBBcnJheSB3aXRoIFNQSUNFX1ZJREVPX0NPREVDX1RZUEVfRU5VTV9FTkQg
ZWxlbWVudHMsIHdpdGggdGhlIGNsaWVudAo+ICsgICAgICogcHJlZmVyZW5jZSBvcmRlciAoaW5k
ZXgpIGFzIHZhbHVlICovCj4gKyAgICBHQXJyYXkgKmNsaWVudF9wcmVmZXJyZWRfdmlkZW9fY29k
ZWNzOwoKSSB0aGluayB0aGF0IGN1cnJlbnRseSBhIHN0YXRpYyBhcnJheSB0YWtlcyBsZXNzIHNw
YWNlLCBidXQgaXQncyBqdXN0IG15CnBhcmFub2lhLgoKPiAgfTsKPiAKPiAgc3RydWN0IFN0cmVh
bUNoYW5uZWxDbGllbnRDbGFzcyB7Cj4gQEAgLTExNCw2ICsxMTgsOCBAQCB0eXBlZGVmIHN0cnVj
dCBTdHJlYW1EYXRhSXRlbSB7Cj4gICNkZWZpbmUgUFJJTUFSWV9TVVJGQUNFX0lEIDAKPiAKPiAg
c3RhdGljIHZvaWQgc3RyZWFtX2NoYW5uZWxfY2xpZW50X29uX2Rpc2Nvbm5lY3QoUmVkQ2hhbm5l
bENsaWVudCAqcmNjKTsKPiArc3RhdGljIGJvb2wKPiBzdHJlYW1fY2hhbm5lbF9oYW5kbGVfcHJl
ZmVycmVkX3ZpZGVvX2NvZGVjX3R5cGUoUmVkQ2hhbm5lbENsaWVudCAqcmNjLAo+ICsKPiBTcGlj
ZU1zZ2NEaXNwbGF5UHJlZmVycmVkVmlkZW9Db2RlY1R5cGUKPiAqbXNnKTsKPiAKCk1pbm9yOiBO
b3QgY29ycmVjdGx5IGluZGVudGVkCgo+ICBSRUNPUkRFUihzdHJlYW1fY2hhbm5lbF9kYXRhLCAz
MiwgIlN0cmVhbSBjaGFubmVsIGRhdGEgcGFja2V0Iik7Cj4gCj4gQEAgLTMyNCw2ICszMzAsMTAg
QEAgaGFuZGxlX21lc3NhZ2UoUmVkQ2hhbm5lbENsaWVudCAqcmNjLCB1aW50MTZfdCB0eXBlLAo+
IHVpbnQzMl90IHNpemUsIHZvaWQgKm1zZykKPiAgICAgIGNhc2UgU1BJQ0VfTVNHQ19ESVNQTEFZ
X0dMX0RSQVdfRE9ORToKPiAgICAgICAgICAvKiBjbGllbnQgc2hvdWxkIG5vdCBzZW5kIHRoaXMg
bWVzc2FnZSAqLwo+ICAgICAgICAgIHJldHVybiBmYWxzZTsKPiArICAgIGNhc2UgU1BJQ0VfTVNH
Q19ESVNQTEFZX1BSRUZFUlJFRF9WSURFT19DT0RFQ19UWVBFOgo+ICsgICAgICAgIHJldHVybiBz
dHJlYW1fY2hhbm5lbF9oYW5kbGVfcHJlZmVycmVkX3ZpZGVvX2NvZGVjX3R5cGUocmNjLAo+ICsg
ICAgICAgICAgICAoU3BpY2VNc2djRGlzcGxheVByZWZlcnJlZFZpZGVvQ29kZWNUeXBlICopbXNn
KTsKPiArICAgICAgICByZXR1cm4gZmFsc2U7CgpTZWNvbmQgcmV0dXJuIGFmdGVyIGEgcmV0dXJu
IGlzIG5vdCBtdWNoIHVzZWZ1bCwgc29tZSBjb2RlIGFuYWx5c2Vycwpjb3VsZCBhbHNvIGNvbXBs
YWluIGFib3V0IGl0LgoKPiAgICAgIGRlZmF1bHQ6Cj4gICAgICAgICAgcmV0dXJuIHJlZF9jaGFu
bmVsX2NsaWVudF9oYW5kbGVfbWVzc2FnZShyY2MsIHR5cGUsIHNpemUsIG1zZyk7Cj4gICAgICB9
Cj4gQEAgLTM5MCw2ICs0MDAsMjAgQEAgc3RyZWFtX2NoYW5uZWxfZ2V0X3N1cHBvcnRlZF9jb2Rl
Y3MoU3RyZWFtQ2hhbm5lbAo+ICpjaGFubmVsLCB1aW50OF90ICpvdXRfY29kZWNzKQo+ICAgICAg
cmV0dXJuIG51bTsKPiAgfQo+IAo+ICtzdGF0aWMgYm9vbAo+ICtzdHJlYW1fY2hhbm5lbF9oYW5k
bGVfcHJlZmVycmVkX3ZpZGVvX2NvZGVjX3R5cGUoUmVkQ2hhbm5lbENsaWVudCAqcmNjLAo+ICsK
PiBTcGljZU1zZ2NEaXNwbGF5UHJlZmVycmVkVmlkZW9Db2RlY1R5cGUKPiAqbXNnKQo+ICt7Cj4g
KyAgICBTdHJlYW1DaGFubmVsQ2xpZW50ICpzY2MgPSBTVFJFQU1fQ0hBTk5FTF9DTElFTlQocmNj
KTsKPiArCj4gKyAgICBnX3JldHVybl92YWxfaWZfZmFpbChtc2ctPm51bV9vZl9jb2RlY3MgPiAw
LCBUUlVFKTsKCkkga25vdyBpdCdzIG5vdCBhIHJlZ3Jlc3Npb24sIGJ1dCBkb2N1bWVudCBmb3Ig
Z19yZXR1cm5fdmFsX2lmX2ZhaWwgc3RhdGVzCiJWZXJpZmllcyB0aGF0IHRoZSBleHByZXNzaW9u
IGV4cHIgLCB1c3VhbGx5IHJlcHJlc2VudGluZyBhIHByZWNvbmRpdGlvbiwgZXZhbHVhdGVzIHRv
IFRSVUUiCmJ1dCB0aGlzIGlzIG5vdCBhIHByZWNvbmRpdGlvbiwgdGhpcyBpcyBjaGVja2luZyBh
IHZhbHVlIGZyb20gbmV0d29yay4KCj4gKwo+ICsgICAgZ19jbGVhcl9wb2ludGVyKCZzY2MtPmNs
aWVudF9wcmVmZXJyZWRfdmlkZW9fY29kZWNzLCBnX2FycmF5X3VucmVmKTsKPiArICAgIHNjYy0+
Y2xpZW50X3ByZWZlcnJlZF92aWRlb19jb2RlY3MgPQo+IHZpZGVvX3N0cmVhbV9wYXJzZV9wcmVm
ZXJyZWRfY29kZWNzKG1zZyk7Cj4gKwo+ICsgICAgcmV0dXJuIFRSVUU7CgpJIHdvdWxkIHVzZSB0
cnVlL2ZhbHNlIHdpdGggYm9vbAoKPiArfQo+ICsKPiAgc3RhdGljIHZvaWQKPiAgc3RyZWFtX2No
YW5uZWxfY29ubmVjdChSZWRDaGFubmVsICpyZWRfY2hhbm5lbCwgUmVkQ2xpZW50ICpyZWRfY2xp
ZW50LAo+ICBSZWRTdHJlYW0gKnN0cmVhbSwKPiAgICAgICAgICAgICAgICAgICAgICAgICBpbnQg
bWlncmF0aW9uLCBSZWRDaGFubmVsQ2FwYWJpbGl0aWVzICpjYXBzKQo+IEBAIC00NDgsMTAgKzQ3
MiwyNSBAQCBzdHJlYW1fY2hhbm5lbF9jb25zdHJ1Y3RlZChHT2JqZWN0ICpvYmplY3QpCj4gCj4g
ICAgICByZWRfY2hhbm5lbF9zZXRfY2FwKHJlZF9jaGFubmVsLCBTUElDRV9ESVNQTEFZX0NBUF9N
T05JVE9SU19DT05GSUcpOwo+ICAgICAgcmVkX2NoYW5uZWxfc2V0X2NhcChyZWRfY2hhbm5lbCwg
U1BJQ0VfRElTUExBWV9DQVBfU1RSRUFNX1JFUE9SVCk7Cj4gKyAgICByZWRfY2hhbm5lbF9zZXRf
Y2FwKHJlZF9jaGFubmVsLAo+IFNQSUNFX0RJU1BMQVlfQ0FQX1BSRUZfVklERU9fQ09ERUNfVFlQ
RSk7Cj4gCj4gICAgICByZWRzX3JlZ2lzdGVyX2NoYW5uZWwocmVkcywgcmVkX2NoYW5uZWwpOwo+
ICB9Cj4gCj4gK3N0YXRpYyB2b2lkCj4gK3N0cmVhbV9jaGFubmVsX2ZpbmFsaXplKEdPYmplY3Qg
Km9iamVjdCkKPiArewo+ICsgICAgU3RyZWFtQ2hhbm5lbCAqc2VsZiA9IFNUUkVBTV9DSEFOTkVM
KG9iamVjdCk7Cj4gKyAgICBSZWRDaGFubmVsQ2xpZW50ICpyY2M7Cj4gKwo+ICsgICAgRk9SRUFD
SF9DTElFTlQoc2VsZiwgcmNjKSB7Cj4gKyAgICAgICAgU3RyZWFtQ2hhbm5lbENsaWVudCAqc2Nj
ID0gU1RSRUFNX0NIQU5ORUxfQ0xJRU5UKHJjYyk7Cj4gKyAgICAgICAgZ19jbGVhcl9wb2ludGVy
KCZzY2MtPmNsaWVudF9wcmVmZXJyZWRfdmlkZW9fY29kZWNzLCBnX2FycmF5X3VucmVmKTsKPiAr
ICAgIH0KCkVhY2ggb2JqZWN0IHNob3VsZCBmcmVlIGl0c2VsZiwgdGhpcyBzaG91bGQgYmUgaW4K
c3RyZWFtX2NoYW5uZWxfY2xpZW50X2ZpbmFsaXplLCBvdGhlcndpc2UgY29kZSB3aWxsIGxlYWsg
d2hlbiBjbGllbnQgZGlzY29ubmVjdHMuCgo+ICsKPiArICAgIEdfT0JKRUNUX0NMQVNTKHN0cmVh
bV9jaGFubmVsX3BhcmVudF9jbGFzcyktPmZpbmFsaXplKG9iamVjdCk7Cj4gK30KPiArCj4gIHN0
YXRpYyB2b2lkCj4gIHN0cmVhbV9jaGFubmVsX2NsYXNzX2luaXQoU3RyZWFtQ2hhbm5lbENsYXNz
ICprbGFzcykKPiAgewo+IEBAIC00NTksNiArNDk4LDcgQEAgc3RyZWFtX2NoYW5uZWxfY2xhc3Nf
aW5pdChTdHJlYW1DaGFubmVsQ2xhc3MgKmtsYXNzKQo+ICAgICAgUmVkQ2hhbm5lbENsYXNzICpj
aGFubmVsX2NsYXNzID0gUkVEX0NIQU5ORUxfQ0xBU1Moa2xhc3MpOwo+IAo+ICAgICAgb2JqZWN0
X2NsYXNzLT5jb25zdHJ1Y3RlZCA9IHN0cmVhbV9jaGFubmVsX2NvbnN0cnVjdGVkOwo+ICsgICAg
b2JqZWN0X2NsYXNzLT5maW5hbGl6ZSA9IHN0cmVhbV9jaGFubmVsX2ZpbmFsaXplOwo+IAo+ICAg
ICAgY2hhbm5lbF9jbGFzcy0+cGFyc2VyID0KPiAgICAgIHNwaWNlX2dldF9jbGllbnRfY2hhbm5l
bF9wYXJzZXIoU1BJQ0VfQ0hBTk5FTF9ESVNQTEFZLCBOVUxMKTsKPiAgICAgIGNoYW5uZWxfY2xh
c3MtPmhhbmRsZV9tZXNzYWdlID0gaGFuZGxlX21lc3NhZ2U7Cj4gZGlmZiAtLWdpdCBhL3NlcnZl
ci92aWRlby1zdHJlYW0uYyBiL3NlcnZlci92aWRlby1zdHJlYW0uYwo+IGluZGV4IDZhYTg1OWEw
Li5hNjFjOGFiMiAxMDA2NDQKPiAtLS0gYS9zZXJ2ZXIvdmlkZW8tc3RyZWFtLmMKPiArKysgYi9z
ZXJ2ZXIvdmlkZW8tc3RyZWFtLmMKPiBAQCAtMjAsNiArMjAsNyBAQAo+ICAjaW5jbHVkZSAiZGlz
cGxheS1jaGFubmVsLXByaXZhdGUuaCIKPiAgI2luY2x1ZGUgIm1haW4tY2hhbm5lbC1jbGllbnQu
aCIKPiAgI2luY2x1ZGUgInJlZC1jbGllbnQuaCIKPiArI2luY2x1ZGUgInN0cmVhbS1jaGFubmVs
LmgiCj4gCgpXaHkgdGhpcz8KCj4gICNkZWZpbmUgRlBTX1RFU1RfSU5URVJWQUwgMQo+ICAjZGVm
aW5lIEZPUkVBQ0hfU1RSRUFNUyhkaXNwbGF5LCBpdGVtKSAgICAgICAgICAgICAgICAgIFwKPiBA
QCAtNDY4LDYgKzQ2OSw0MSBAQCBzdGF0aWMgYm9vbCB2aWRlb19zdHJlYW1fYWRkX2ZyYW1lKERp
c3BsYXlDaGFubmVsCj4gKmRpc3BsYXksCj4gICAgICByZXR1cm4gRkFMU0U7Cj4gIH0KPiAKPiAr
LyogUmV0dXJucyBhbiBhcnJheSB3aXRoIFNQSUNFX1ZJREVPX0NPREVDX1RZUEVfRU5VTV9FTkQg
ZWxlbWVudHMsCj4gKyAqIHdpdGggdGhlIGNsaWVudCBwcmVmZXJlbmNlIG9yZGVyIChpbmRleCkg
YXMgdmFsdWUgKi8KPiArR0FycmF5Cj4gKnZpZGVvX3N0cmVhbV9wYXJzZV9wcmVmZXJyZWRfY29k
ZWNzKFNwaWNlTXNnY0Rpc3BsYXlQcmVmZXJyZWRWaWRlb0NvZGVjVHlwZQo+ICptc2cpCj4gK3sK
PiArICAgIGdpbnQgaSwgbGVuOwoKZ25vdCBnYSBnYmlnIGdmdW4gZ29mIGdhbGwgZ3RoZXNlIGdn
IGdzdHJpbmdzCgo+ICsgICAgZ2ludCBpbmRleGVzW1NQSUNFX1ZJREVPX0NPREVDX1RZUEVfRU5V
TV9FTkRdOwo+ICsgICAgR0FycmF5ICpjbGllbnQ7Cj4gKwo+ICsgICAgLyogc2V0IGRlZmF1bHQg
dG8gYSBiaWcgYW5kIHBvc2l0aXZlIG51bWJlciAqLwo+ICsgICAgbWVtc2V0KGluZGV4ZXMsIDB4
N2YsIHNpemVvZihpbmRleGVzKSk7Cj4gKwo+ICsgICAgZm9yIChsZW4gPSAwLCBpID0gMDsgaSA8
IG1zZy0+bnVtX29mX2NvZGVjczsgaSsrKSB7Cj4gKyAgICAgICAgZ2ludCB2aWRlb19jb2RlYyA9
IG1zZy0+Y29kZWNzW2ldOwo+ICsKPiArICAgICAgICBpZiAodmlkZW9fY29kZWMgPCBTUElDRV9W
SURFT19DT0RFQ19UWVBFX01KUEVHIHx8Cj4gKyAgICAgICAgICAgIHZpZGVvX2NvZGVjID49IFNQ
SUNFX1ZJREVPX0NPREVDX1RZUEVfRU5VTV9FTkQpIHsKPiArICAgICAgICAgICAgc3BpY2VfZGVi
dWcoIkNsaWVudCBoYXMgc2VudCB1bmtub3duIHZpZGVvLWNvZGVjICh2YWx1ZSAlZCBhdAo+IGlu
ZGV4ICVkKS4gIgo+ICsgICAgICAgICAgICAgICAgICAgICAgICAiSWdub3JpbmcgYXMgc2VydmVy
IGNhbid0IGhhbmRsZSBpdCIsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICB2aWRlb19jb2Rl
YywgaSk7Cj4gKyAgICAgICAgICAgIGNvbnRpbnVlOwo+ICsgICAgICAgIH0KPiArCj4gKyAgICAg
ICAgaWYgKGluZGV4ZXNbdmlkZW9fY29kZWNdIDwgU1BJQ0VfVklERU9fQ09ERUNfVFlQRV9FTlVN
X0VORCkgewo+ICsgICAgICAgICAgICBjb250aW51ZTsKPiArICAgICAgICB9Cj4gKwo+ICsgICAg
ICAgIGxlbisrOwo+ICsgICAgICAgIGluZGV4ZXNbdmlkZW9fY29kZWNdID0gbGVuOwo+ICsgICAg
fQo+ICsgICAgY2xpZW50ID0gZ19hcnJheV9zaXplZF9uZXcoRkFMU0UsIEZBTFNFLCBzaXplb2Yo
Z2ludCksCj4gU1BJQ0VfVklERU9fQ09ERUNfVFlQRV9FTlVNX0VORCk7Cj4gKyAgICBnX2FycmF5
X2FwcGVuZF92YWxzKGNsaWVudCwgaW5kZXhlcywgU1BJQ0VfVklERU9fQ09ERUNfVFlQRV9FTlVN
X0VORCk7Cj4gKwo+ICsgICAgcmV0dXJuIGNsaWVudDsKPiArfQo+ICsKPiAgLyogVE9ETzogZG9j
dW1lbnQgdGhlIGRpZmZlcmVuY2UgYmV0d2VlbiB0aGUgMiBmdW5jdGlvbnMgYmVsb3cgKi8KPiAg
dm9pZCB2aWRlb19zdHJlYW1fdHJhY2VfdXBkYXRlKERpc3BsYXlDaGFubmVsICpkaXNwbGF5LCBE
cmF3YWJsZSAqZHJhd2FibGUpCj4gIHsKPiBkaWZmIC0tZ2l0IGEvc2VydmVyL3ZpZGVvLXN0cmVh
bS5oIGIvc2VydmVyL3ZpZGVvLXN0cmVhbS5oCj4gaW5kZXggNDZiMDc2ZmQuLjczNDM1NTE1IDEw
MDY0NAo+IC0tLSBhL3NlcnZlci92aWRlby1zdHJlYW0uaAo+ICsrKyBiL3NlcnZlci92aWRlby1z
dHJlYW0uaAo+IEBAIC0xNDcsNiArMTQ3LDcgQEAgdm9pZCB2aWRlb19zdHJlYW1fZGV0YWNoX2Fu
ZF9zdG9wKERpc3BsYXlDaGFubmVsCj4gKmRpc3BsYXkpOwo+ICB2b2lkIHZpZGVvX3N0cmVhbV90
cmFjZV9hZGRfZHJhd2FibGUoRGlzcGxheUNoYW5uZWwgKmRpc3BsYXksIERyYXdhYmxlCj4gICpp
dGVtKTsKPiAgdm9pZCB2aWRlb19zdHJlYW1fZGV0YWNoX2JlaGluZChEaXNwbGF5Q2hhbm5lbCAq
ZGlzcGxheSwgUVJlZ2lvbiAqcmVnaW9uLAo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIERyYXdhYmxlICpkcmF3YWJsZSk7Cj4gK0dBcnJheQo+ICp2aWRlb19zdHJlYW1fcGFyc2Vf
cHJlZmVycmVkX2NvZGVjcyhTcGljZU1zZ2NEaXNwbGF5UHJlZmVycmVkVmlkZW9Db2RlY1R5cGUK
PiAqbXNnKTsKPiAKPiAgdm9pZCB2aWRlb19zdHJlYW1fYWdlbnRfdW5yZWYoRGlzcGxheUNoYW5u
ZWwgKmRpc3BsYXksIFZpZGVvU3RyZWFtQWdlbnQKPiAgKmFnZW50KTsKPiAgdm9pZCB2aWRlb19z
dHJlYW1fYWdlbnRfc3RvcChWaWRlb1N0cmVhbUFnZW50ICphZ2VudCk7CgpGcmVkaWFubwpfX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpTcGljZS1kZXZlbCBt
YWlsaW5nIGxpc3QKU3BpY2UtZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlz
dHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vc3BpY2UtZGV2ZWw=
