Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id A7DFDAA4D3
	for <lists+spice-devel@lfdr.de>; Thu,  5 Sep 2019 15:43:02 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 3B17C6E0E0;
	Thu,  5 Sep 2019 13:43:01 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 75C4D6E0E2
 for <spice-devel@lists.freedesktop.org>; Thu,  5 Sep 2019 13:43:00 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx06.intmail.prod.int.phx2.redhat.com
 [10.5.11.16])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id 2002710C030D;
 Thu,  5 Sep 2019 13:43:00 +0000 (UTC)
Received: from fziglio.remote.csb (unknown [10.33.32.10])
 by smtp.corp.redhat.com (Postfix) with ESMTP id 53CAB4DA01;
 Thu,  5 Sep 2019 13:42:58 +0000 (UTC)
From: Frediano Ziglio <fziglio@redhat.com>
To: spice-devel@lists.freedesktop.org
Date: Thu,  5 Sep 2019 14:42:28 +0100
Message-Id: <20190905134241.28873-6-fziglio@redhat.com>
In-Reply-To: <20190905134241.28873-1-fziglio@redhat.com>
References: <20190905134241.28873-1-fziglio@redhat.com>
MIME-Version: 1.0
X-Scanned-By: MIMEDefang 2.79 on 10.5.11.16
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.6.2
 (mx1.redhat.com [10.5.110.65]); Thu, 05 Sep 2019 13:43:00 +0000 (UTC)
Subject: [Spice-devel] [PATCH spice-gtk v6 05/18] usb-redir: add files for
 SCSI and USB MSC implementation
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Alexander Nezhinsky <anezhins@redhat.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

RnJvbTogWXVyaSBCZW5kaXRvdmljaCA8eXVyaS5iZW5kaXRvdmljaEBkYXluaXguY29tPgoKRmls
ZXMgYWRkZWQgd2l0aG91dCBpbmNsdWRpbmcgdGhlbSBpbiBjb21waWxhdGlvbi4KVGhleSBjb250
YWluIGltcGxlbWVudGF0aW9uIG9mIFNDU0kgY29tbWFuZHMgZm9yIGxvZ2ljYWwKdW5pdHMgb2Yg
bWFzcy1zdG9yYWdlIGRldmljZSBjbGFzcyBhbmQgVVNCIGJ1bGstb25seQptYXNzLXN0b3JhZ2Ug
ZGV2aWNlIHByb3RvY29sLgoKU2lnbmVkLW9mZi1ieTogQWxleGFuZGVyIE5lemhpbnNreTxhbmV6
aGluc0ByZWRoYXQuY29tPgpTaWduZWQtb2ZmLWJ5OiBZdXJpIEJlbmRpdG92aWNoIDx5dXJpLmJl
bmRpdG92aWNoQGRheW5peC5jb20+CkFja2VkLWJ5OiBGcmVkaWFubyBaaWdsaW8gPGZ6aWdsaW9A
cmVkaGF0LmNvbT4KLS0tCiBzcmMvY2Qtc2NzaS1kZXYtcGFyYW1zLmggfCAgIDQ2ICsKIHNyYy9j
ZC1zY3NpLmMgICAgICAgICAgICB8IDI3NDAgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr
KysrKysrKysKIHNyYy9jZC1zY3NpLmggICAgICAgICAgICB8ICAxMTcgKysKIHNyYy9jZC11c2It
YnVsay1tc2QuYyAgICB8ICA1NDMgKysrKysrKysKIHNyYy9jZC11c2ItYnVsay1tc2QuaCAgICB8
ICAxMzEgKysKIHNyYy9zY3NpLWNvbnN0YW50cy5oICAgICB8ICAzMjEgKysrKysKIDYgZmlsZXMg
Y2hhbmdlZCwgMzg5OCBpbnNlcnRpb25zKCspCiBjcmVhdGUgbW9kZSAxMDA2NDQgc3JjL2NkLXNj
c2ktZGV2LXBhcmFtcy5oCiBjcmVhdGUgbW9kZSAxMDA2NDQgc3JjL2NkLXNjc2kuYwogY3JlYXRl
IG1vZGUgMTAwNjQ0IHNyYy9jZC1zY3NpLmgKIGNyZWF0ZSBtb2RlIDEwMDY0NCBzcmMvY2QtdXNi
LWJ1bGstbXNkLmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBzcmMvY2QtdXNiLWJ1bGstbXNkLmgKIGNy
ZWF0ZSBtb2RlIDEwMDY0NCBzcmMvc2NzaS1jb25zdGFudHMuaAoKZGlmZiAtLWdpdCBhL3NyYy9j
ZC1zY3NpLWRldi1wYXJhbXMuaCBiL3NyYy9jZC1zY3NpLWRldi1wYXJhbXMuaApuZXcgZmlsZSBt
b2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMC4uMzQ0ZjcyMGMKLS0tIC9kZXYvbnVsbAorKysgYi9z
cmMvY2Qtc2NzaS1kZXYtcGFyYW1zLmgKQEAgLTAsMCArMSw0NiBAQAorLyogLSotIE1vZGU6IEM7
IGMtYmFzaWMtb2Zmc2V0OiA0OyBpbmRlbnQtdGFicy1tb2RlOiBuaWwgLSotICovCisvKgorICAg
Q0QgU0NTSSBkZXZpY2UgcGFyYW1ldGVycworCisgICBDb3B5cmlnaHQgKEMpIDIwMTggUmVkIEhh
dCwgSW5jLgorCisgICBSZWQgSGF0IEF1dGhvcnM6CisgICBBbGV4YW5kZXIgTmV6aGluc2t5PGFu
ZXpoaW5zQHJlZGhhdC5jb20+CisKKyAgIFRoaXMgbGlicmFyeSBpcyBmcmVlIHNvZnR3YXJlOyB5
b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IKKyAgIG1vZGlmeSBpdCB1bmRlciB0aGUgdGVy
bXMgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKKyAgIExpY2Vuc2UgYXMgcHVibGlz
aGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlcgorICAgdmVyc2lvbiAy
LjEgb2YgdGhlIExpY2Vuc2UsIG9yIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24u
CisKKyAgIFRoaXMgbGlicmFyeSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdp
bGwgYmUgdXNlZnVsLAorICAgYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4g
dGhlIGltcGxpZWQgd2FycmFudHkgb2YKKyAgIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZP
UiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUgR05VCisgICBMZXNzZXIgR2VuZXJhbCBQ
dWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgorCisgICBZb3Ugc2hvdWxkIGhhdmUgcmVj
ZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCisgICBMaWNlbnNl
IGFsb25nIHdpdGggdGhpcyBsaWJyYXJ5OyBpZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3Jn
L2xpY2Vuc2VzLz4uCisqLworCisjcHJhZ21hIG9uY2UKKworI2luY2x1ZGUgPGdpby9naW8uaD4K
KwordHlwZWRlZiBzdHJ1Y3QgQ2RTY3NpRGV2aWNlUGFyYW1ldGVycyB7CisgICAgY29uc3QgY2hh
ciAqdmVuZG9yOworICAgIGNvbnN0IGNoYXIgKnByb2R1Y3Q7CisgICAgY29uc3QgY2hhciAqdmVy
c2lvbjsKKyAgICBjb25zdCBjaGFyICpzZXJpYWw7Cit9IENkU2NzaURldmljZVBhcmFtZXRlcnM7
CisKK3R5cGVkZWYgc3RydWN0IENkU2NzaURldmljZUluZm8geworICAgIENkU2NzaURldmljZVBh
cmFtZXRlcnMgcGFyYW1ldGVyczsKKyAgICB1aW50MzJfdCBzdGFydGVkICAgIDogMTsKKyAgICB1
aW50MzJfdCBsb2NrZWQgICAgIDogMTsKKyAgICB1aW50MzJfdCBsb2FkZWQgICAgIDogMTsKK30g
Q2RTY3NpRGV2aWNlSW5mbzsKKwordHlwZWRlZiBzdHJ1Y3QgQ2RTY3NpTWVkaWFQYXJhbWV0ZXJz
IHsKKyAgICBHRmlsZUlucHV0U3RyZWFtICpzdHJlYW07CisgICAgdWludDY0X3Qgc2l6ZTsKKyAg
ICB1aW50MzJfdCBibG9ja19zaXplOworfSBDZFNjc2lNZWRpYVBhcmFtZXRlcnM7CmRpZmYgLS1n
aXQgYS9zcmMvY2Qtc2NzaS5jIGIvc3JjL2NkLXNjc2kuYwpuZXcgZmlsZSBtb2RlIDEwMDY0NApp
bmRleCAwMDAwMDAwMC4uMjU4NDJiM2IKLS0tIC9kZXYvbnVsbAorKysgYi9zcmMvY2Qtc2NzaS5j
CkBAIC0wLDAgKzEsMjc0MCBAQAorLyogLSotIE1vZGU6IEM7IGMtYmFzaWMtb2Zmc2V0OiA0OyBp
bmRlbnQtdGFicy1tb2RlOiBuaWwgLSotICovCisvKgorICAgQ0QgZGV2aWNlIGVtdWxhdGlvbiAt
IFNDU0kgZW5naW5lCisKKyAgIENvcHlyaWdodCAoQykgMjAxOCBSZWQgSGF0LCBJbmMuCisKKyAg
IFJlZCBIYXQgQXV0aG9yczoKKyAgIEFsZXhhbmRlciBOZXpoaW5za3k8YW5lemhpbnNAcmVkaGF0
LmNvbT4KKworICAgVGhpcyBsaWJyYXJ5IGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0
cmlidXRlIGl0IGFuZC9vcgorICAgbW9kaWZ5IGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05V
IExlc3NlciBHZW5lcmFsIFB1YmxpYworICAgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkgdGhlIEZy
ZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyCisgICB2ZXJzaW9uIDIuMSBvZiB0aGUgTGlj
ZW5zZSwgb3IgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4KKworICAgVGhpcyBs
aWJyYXJ5IGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWws
CisgICBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3
YXJyYW50eSBvZgorICAgTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxB
UiBQVVJQT1NFLiAgU2VlIHRoZSBHTlUKKyAgIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNl
IGZvciBtb3JlIGRldGFpbHMuCisKKyAgIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkg
b2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKKyAgIExpY2Vuc2UgYWxvbmcgd2l0aCB0
aGlzIGxpYnJhcnk7IGlmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4K
KyovCisKKyNpbmNsdWRlICJjb25maWcuaCIKKyNpbmNsdWRlICJzcGljZS90eXBlcy5oIgorI2lu
Y2x1ZGUgInNwaWNlLWNvbW1vbi5oIgorI2luY2x1ZGUgInNwaWNlLXV0aWwuaCIKKyNpbmNsdWRl
ICJjZC1zY3NpLmgiCisKKyNpZmRlZiBVU0VfVVNCUkVESVIKKworI2RlZmluZSBTUElDRV9FUlJP
UihmbXQsIC4uLikgXAorICAgIGRvIHsgU1BJQ0VfREVCVUcoImRldi1zY3NpIGVycm9yOiAiIGZt
dCAsICMjIF9fVkFfQVJHU19fKTsgfSB3aGlsZSAoMCkKKworI2RlZmluZSBGSVhFRF9TRU5TRV9D
VVJSRU5UIDB4NzAKKyNkZWZpbmUgRklYRURfU0VOU0VfTEVOIDE4CisKKyNkZWZpbmUgTUFYX0xV
TlMgICAzMgorCit0eXBlZGVmIGVudW0gQ2RTY3NpUG93ZXJDb25kaXRpb24geworICAgIENEX1ND
U0lfUE9XRVJfU1RPUFBFRCwKKyAgICBDRF9TQ1NJX1BPV0VSX0FDVElWRSwKKyAgICBDRF9TQ1NJ
X1BPV0VSX0lETEUsCisgICAgQ0RfU0NTSV9QT1dFUl9TVEFOREJZCit9IENkU2NzaVBvd2VyQ29u
ZGl0aW9uOworCit0eXBlZGVmIHN0cnVjdCBTY3NpU2hvcnRTZW5zZSB7CisgICAgdWludDhfdCBr
ZXk7CisgICAgdWludDhfdCBhc2M7CisgICAgdWludDhfdCBhc2NxOworICAgIGNvbnN0IGNoYXIg
KmRlc2NyOworfSBTY3NpU2hvcnRTZW5zZTsKKworI2RlZmluZSBDRF9NRURJQV9FVkVOVF9OT19D
SEFOR0UgICAgICAgICAgICAweDAKKyNkZWZpbmUgQ0RfTUVESUFfRVZFTlRfRUpFQ1RfUkVRICAg
ICAgICAgICAgMHgxIC8qIHVzZXIgcmVxdWVzdCAobWVjaGFuaWNhbCBzd2l0Y2gpIHRvCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBlamVjdCB0aGUg
bWVkaWEgKi8KKyNkZWZpbmUgQ0RfTUVESUFfRVZFTlRfTkVXX01FRElBICAgICAgICAgICAgMHgy
IC8qIG5ldyBtZWRpYSByZWNlaXZlZCAqLworI2RlZmluZSBDRF9NRURJQV9FVkVOVF9NRURJQV9S
RU1PVkFMICAgICAgICAweDMgLyogbWVkaWEgcmVtb3ZlZCAqLworI2RlZmluZSBDRF9NRURJQV9F
VkVOVF9NRURJQV9DSEFOR0VEICAgICAgICAweDQgLyogdXNlciByZXF1ZXN0IHRvIGxvYWQgbmV3
IG1lZGlhICovCisjZGVmaW5lIENEX01FRElBX0VWRU5UX0JHX0ZPUk1BVF9DT01QTEVURSAgIDB4
NQorI2RlZmluZSBDRF9NRURJQV9FVkVOVF9CR19GT1JNQVRfUkVTVEFSVCAgICAweDYKKworI2Rl
ZmluZSBDRF9QT1dFUl9FVkVOVF9OT19DSEFOR0UgICAgICAgICAgICAweDAKKyNkZWZpbmUgQ0Rf
UE9XRVJfRVZFTlRfQ0hBTkdFX1NVQ0NFU1MgICAgICAgMHgxCisjZGVmaW5lIENEX1BPV0VSX0VW
RU5UX0NIQU5HRV9GQUxFRCAgICAgICAgIDB4MgorCit0eXBlZGVmIHN0cnVjdCBDZFNjc2lMVSB7
CisgICAgQ2RTY3NpVGFyZ2V0ICp0Z3Q7CisgICAgdWludDMyX3QgbHVuOworCisgICAgZ2Jvb2xl
YW4gcmVhbGl6ZWQ7CisgICAgZ2Jvb2xlYW4gcmVtb3ZhYmxlOworICAgIGdib29sZWFuIGxvYWRl
ZDsKKyAgICBnYm9vbGVhbiBwcmV2ZW50X21lZGlhX3JlbW92YWw7CisgICAgZ2Jvb2xlYW4gY2Rf
cm9tOworCisgICAgQ2RTY3NpUG93ZXJDb25kaXRpb24gcG93ZXJfY29uZDsKKyAgICB1aW50MzJf
dCBwb3dlcl9ldmVudDsKKyAgICB1aW50MzJfdCBtZWRpYV9ldmVudDsKKworICAgIHVpbnQzMl90
IGNsYWltX3ZlcnNpb247CisKKyAgICB1aW50NjRfdCBzaXplOworICAgIHVpbnQzMl90IGJsb2Nr
X3NpemU7CisgICAgdWludDMyX3QgbnVtX2Jsb2NrczsKKworICAgIGNoYXIgKnZlbmRvcjsKKyAg
ICBjaGFyICpwcm9kdWN0OworICAgIGNoYXIgKnZlcnNpb247CisgICAgY2hhciAqc2VyaWFsOwor
CisgICAgR0ZpbGVJbnB1dFN0cmVhbSAqc3RyZWFtOworCisgICAgU2NzaVNob3J0U2Vuc2Ugc2hv
cnRfc2Vuc2U7IC8qIGN1cnJlbnRseSBoZWxkIHNlbnNlIG9mIHRoZSBzY3NpIGRldmljZSAqLwor
ICAgIHVpbnQ4X3QgZml4ZWRfc2Vuc2VbRklYRURfU0VOU0VfTEVOXTsKK30gQ2RTY3NpTFU7CisK
K3R5cGVkZWYgZW51bSBDZFNjc2lUYXJnZXRTdGF0ZSB7CisgICAgQ0RfU0NTSV9UR1RfU1RBVEVf
UlVOTklORywKKyAgICBDRF9TQ1NJX1RHVF9TVEFURV9SRVNFVCwKK30gQ2RTY3NpVGFyZ2V0U3Rh
dGU7CisKK3N0cnVjdCBDZFNjc2lUYXJnZXQgeworICAgIHZvaWQgKnVzZXJfZGF0YTsKKworICAg
IENkU2NzaVRhcmdldFN0YXRlIHN0YXRlOworICAgIENkU2NzaVJlcXVlc3QgKmN1cl9yZXE7Cisg
ICAgR0NhbmNlbGxhYmxlICpjYW5jZWxsYWJsZTsKKworICAgIHVpbnQzMl90IG1heF9sdW5zOwor
ICAgIENkU2NzaUxVIHVuaXRzW01BWF9MVU5TXTsKK307CisKK3N0YXRpYyBjb25zdCBjaGFyKiBz
Y3NpX2NtZF9uYW1lWzI1Nl07CisKKy8qIFByZWRlZmluZWQgc2Vuc2UgY29kZXMgKi8KKworY29u
c3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9OT19TRU5TRSA9IHsKKyAgICAua2V5ID0gTk9f
U0VOU0UgLCAuYXNjID0gMHgwMCAsIC5hc2NxID0gMHgwMCwKKyAgICAuZGVzY3IgPSAiIgorfTsK
KworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9OT1RfUkVBRFlfQ0FVU0VfTk9UX1JF
UE9SVEFCTEUgPSB7CisgICAgLmtleSA9IE5PVF9SRUFEWSwgLmFzYyA9IDB4MDQsIC5hc2NxID0g
MHgwMCwKKyAgICAuZGVzY3IgPSAiQ0FVU0UgTk9UIFJFUE9SVEFCTEUiCit9OworCitjb25zdCBT
Y3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX0JFQ09NSU5HX1JFQURZID0geworICAgIC5rZXkgPSBO
T1RfUkVBRFksIC5hc2MgPSAweDA0LCAuYXNjcSA9IDB4MDEsCisgICAgLmRlc2NyID0gIklOIFBS
T0NFU1MgT0YgQkVDT01JTkcgUkVBRFkiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5z
ZV9jb2RlX0lOSVRfQ01EX1JFUVVJUkVEID0geworICAgIC5rZXkgPSBOT1RfUkVBRFksIC5hc2Mg
PSAweDA0LCAuYXNjcSA9IDB4MDIsCisgICAgLmRlc2NyID0gIklOSVRJQUxJWklORyBDT01NQU5E
IFJFUVVJUkVEIgorfTsKKworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9JTlRFUlZF
TlRJT05fUkVRVUlSRUQgPSB7CisgICAgLmtleSA9IE5PVF9SRUFEWSwgLmFzYyA9IDB4MDQsIC5h
c2NxID0gMHgwMywKKyAgICAuZGVzY3IgPSAiTUFOVUFMIElOVEVSVkVOVElPTiBSRVFVSVJFRCIK
K307CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNlIHNlbnNlX2NvZGVfTk9UX1JFQURZX05PX01FRElV
TSA9IHsKKyAgICAua2V5ID0gTk9UX1JFQURZLCAuYXNjID0gMHgzYSwgLmFzY3EgPSAweDAwLAor
ICAgIC5kZXNjciA9ICJNRURJVU0gTk9UIFBSRVNFTlQiCit9OworCitjb25zdCBTY3NpU2hvcnRT
ZW5zZSBzZW5zZV9jb2RlX05PVF9SRUFEWV9OT19NRURJVU1fVFJBWV9DTE9TRUQgPSB7CisgICAg
LmtleSA9IE5PVF9SRUFEWSwgLmFzYyA9IDB4M2EsIC5hc2NxID0gMHgwMSwKKyAgICAuZGVzY3Ig
PSAiTUVESVVNIE5PVCBQUkVTRU5UIC0gVFJBWSBDTE9TRUQiCit9OworCitjb25zdCBTY3NpU2hv
cnRTZW5zZSBzZW5zZV9jb2RlX05PVF9SRUFEWV9OT19NRURJVU1fVFJBWV9PUEVOID0geworICAg
IC5rZXkgPSBOT1RfUkVBRFksIC5hc2MgPSAweDNhLCAuYXNjcSA9IDB4MDIsCisgICAgLmRlc2Ny
ID0gIk1FRElVTSBOT1QgUFJFU0VOVCAtIFRSQVkgT1BFTiIKK307CisKK2NvbnN0IFNjc2lTaG9y
dFNlbnNlIHNlbnNlX2NvZGVfVEFSR0VUX0ZBSUxVUkUgPSB7CisgICAgLmtleSA9IEhBUkRXQVJF
X0VSUk9SLCAuYXNjID0gMHg0NCwgLmFzY3EgPSAweDAwLAorICAgIC5kZXNjciA9ICJJTlRFUk5B
TCBUQVJHRVQgRkFJTFVSRSIKK307CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNlIHNlbnNlX2NvZGVf
SU5WQUxJRF9PUENPREUgPSB7CisgICAgLmtleSA9IElMTEVHQUxfUkVRVUVTVCwgLmFzYyA9IDB4
MjAsIC5hc2NxID0gMHgwMCwKKyAgICAuZGVzY3IgPSAiSU5WQUxJRCBDT01NQU5EIE9QRVJBVElP
TiBDT0RFIgorfTsKKworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9MQkFfT1VUX09G
X1JBTkdFID0geworICAgIC5rZXkgPSBJTExFR0FMX1JFUVVFU1QsIC5hc2MgPSAweDIxLCAuYXNj
cSA9IDB4MDAsCisgICAgLmRlc2NyID0gIkxPR0lDQUwgQkxPQ0sgQUREUkVTUyBPVVQgT0YgUkFO
R0UiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX0lOVkFMSURfQ0RCX0ZJ
RUxEID0geworICAgIC5rZXkgPSBJTExFR0FMX1JFUVVFU1QsIC5hc2MgPSAweDI0LCAuYXNjcSA9
IDB4MDAsCisgICAgLmRlc2NyID0gIklOVkFMSUQgRklFTEQgSU4gQ0RCIgorfTsKKworY29uc3Qg
U2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9JTlZBTElEX1BBUkFNX0ZJRUxEID0geworICAgIC5r
ZXkgPSBJTExFR0FMX1JFUVVFU1QsIC5hc2MgPSAweDI2LCAuYXNjcSA9IDB4MDAsCisgICAgLmRl
c2NyID0gIklOVkFMSUQgRklFTEQgSU4gUEFSQU1FVEVSIExJU1QiCit9OworCitjb25zdCBTY3Np
U2hvcnRTZW5zZSBzZW5zZV9jb2RlX0lOVkFMSURfUEFSQU1fTEVOID0geworICAgIC5rZXkgPSBJ
TExFR0FMX1JFUVVFU1QsIC5hc2MgPSAweDFhLCAuYXNjcSA9IDB4MDAsCisgICAgLmRlc2NyID0g
IlBBUkFNRVRFUiBMSVNUIExFTkdUSCBFUlJPUiIKK307CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNl
IHNlbnNlX2NvZGVfTFVOX05PVF9TVVBQT1JURUQgPSB7CisgICAgLmtleSA9IElMTEVHQUxfUkVR
VUVTVCwgLmFzYyA9IDB4MjUsIC5hc2NxID0gMHgwMCwKKyAgICAuZGVzY3IgPSAiTE9HSUNBTCBV
TklUIE5PVCBTVVBQT1JURUQiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2Rl
X1NBVklOR19QQVJBTVNfTk9UX1NVUFBPUlRFRCA9IHsKKyAgICAua2V5ID0gSUxMRUdBTF9SRVFV
RVNULCAuYXNjID0gMHgzOSwgLmFzY3EgPSAweDAwLAorICAgIC5kZXNjciA9ICJTQVZJTkcgUEFS
QU1FVEVSUyBOT1QgU1VQUE9SVEVEIgorfTsKKworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2Vf
Y29kZV9JTkNPTVBBVElCTEVfTUVESVVNID0geworICAgIC5rZXkgPSBJTExFR0FMX1JFUVVFU1Qs
IC5hc2MgPSAweDMwLCAuYXNjcSA9IDB4MDAsCisgICAgLmRlc2NyID0gIklOQ09NUEFUSUJMRSBN
RURJVU0gSU5TVEFMTEVEIgorfTsKKworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9N
RURJVU1fUkVNT1ZBTF9QUkVWRU5URUQgPSB7CisgICAgLmtleSA9IElMTEVHQUxfUkVRVUVTVCwg
LmFzYyA9IDB4NTMsIC5hc2NxID0gMHgwMiwKKyAgICAuZGVzY3IgPSAiTUVESVVNIFJFTU9WQUwg
UFJFVkVOVEVEIgorfTsKKworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9QQVJBTUVU
RVJTX0NIQU5HRUQgPSB7CisgICAgLmtleSA9IFVOSVRfQVRURU5USU9OLCAuYXNjID0gMHgyYSwg
LmFzY3EgPSAweDAwLAorICAgIC5kZXNjciA9ICJQQVJBTUVURVJTIENIQU5HRUQiCit9OworCitj
b25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX1BPV0VSX09OX1JFU0VUID0geworICAgIC5r
ZXkgPSBVTklUX0FUVEVOVElPTiwgLmFzYyA9IDB4MjksIC5hc2NxID0gMHgwMCwKKyAgICAuZGVz
Y3IgPSAiUE9XRVIgT04sIFJFU0VULCBPUiBCVVMgREVWSUNFIFJFU0VUIgorfTsKKworY29uc3Qg
U2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9TQ1NJX0JVU19SRVNFVCA9IHsKKyAgICAua2V5ID0g
VU5JVF9BVFRFTlRJT04sIC5hc2MgPSAweDI5LCAuYXNjcSA9IDB4MDIsCisgICAgLmRlc2NyID0g
IlNDU0kgQlVTIFJFU0VUIgorfTsKKworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9V
QV9OT19NRURJVU0gPSB7CisgICAgLmtleSA9IFVOSVRfQVRURU5USU9OLCAuYXNjID0gMHgzYSwg
LmFzY3EgPSAweDAwLAorICAgIC5kZXNjciA9ICJNRURJVU0gTk9UIFBSRVNFTlQiCit9OworCitj
b25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX01FRElVTV9DSEFOR0VEID0geworICAgIC5r
ZXkgPSBVTklUX0FUVEVOVElPTiwgLmFzYyA9IDB4MjgsIC5hc2NxID0gMHgwMCwKKyAgICAuZGVz
Y3IgPSAiTUVESVVNIENIQU5HRUQiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9j
b2RlX1JFUE9SVEVEX0xVTlNfQ0hBTkdFRCA9IHsKKyAgICAua2V5ID0gVU5JVF9BVFRFTlRJT04s
IC5hc2MgPSAweDNmLCAuYXNjcSA9IDB4MGUsCisgICAgLmRlc2NyID0gIlJFUE9SVEVEIExVTlMg
Q0hBTkdFRCIKK307CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNlIHNlbnNlX2NvZGVfREVWSUNFX0lO
VEVSTkFMX1JFU0VUID0geworICAgIC5rZXkgPSBVTklUX0FUVEVOVElPTiwgLmFzYyA9IDB4Mjks
IC5hc2NxID0gMHgwNCwKKyAgICAuZGVzY3IgPSAiREVWSUNFIElOVEVSTkFMIFJFU0VUIgorfTsK
KworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9VTklUX0FUVEVOVElPTl9NRURJVU1f
UkVNT1ZBTF9SRVFVRVNUID0geworICAgIC5rZXkgPSBVTklUX0FUVEVOVElPTiwgLmFzYyA9IDB4
NWEsIC5hc2NxID0gMHgwMSwKKyAgICAuZGVzY3IgPSAiT1BFUkFUT1IgTUVESVVNIFJFTU9WQUwg
UkVRVUVTVCIKK307CisKK3N0YXRpYyBpbmxpbmUgZ2Jvb2xlYW4gY2Rfc2NzaV9vcGNvZGVfdWFf
c3VwcmVzcyh1aW50MzJfdCBvcGNvZGUpCit7CisgICAgc3dpdGNoIChvcGNvZGUpIHsKKyAgICBj
YXNlIElOUVVJUlk6CisgICAgY2FzZSBSRVBPUlRfTFVOUzoKKyAgICBjYXNlIEdFVF9DT05GSUdV
UkFUSU9OOgorICAgIGNhc2UgR0VUX0VWRU5UX1NUQVRVU19OT1RJRklDQVRJT046CisgICAgY2Fz
ZSBSRVFVRVNUX1NFTlNFOgorICAgICAgICByZXR1cm4gVFJVRTsKKyAgICBkZWZhdWx0OgorICAg
ICAgICByZXR1cm4gRkFMU0U7CisgICAgfQorfQorCitzdGF0aWMgaW5saW5lIGNvbnN0IGNoYXIg
KkNkU2NzaVJlcVN0YXRlX3N0cihDZFNjc2lSZXFTdGF0ZSBzdGF0ZSkKK3sKKyAgICBzd2l0Y2go
c3RhdGUpIHsKKyAgICBjYXNlIFNDU0lfUkVRX0lETEU6CisgICAgICAgIHJldHVybiAiSURMRSI7
CisgICAgY2FzZSBTQ1NJX1JFUV9SVU5OSU5HOgorICAgICAgICByZXR1cm4gIlJVTk5JTkciOwor
ICAgIGNhc2UgU0NTSV9SRVFfQ09NUExFVEU6CisgICAgICAgIHJldHVybiAiQ09NUExFVEUiOwor
ICAgIGNhc2UgU0NTSV9SRVFfQ0FOQ0VMRUQ6CisgICAgICAgIHJldHVybiAiQ0FOQ0VMRUQiOwor
ICAgIGRlZmF1bHQ6CisgICAgICAgIHJldHVybiAiSUxMRUdBTCI7CisgICAgfQorfQorCitzdGF0
aWMgY29uc3QgY2hhciAqY2Rfc2NzaV9zZW5zZV9rZXlfZGVzY3IodWludDhfdCBzZW5zZV9rZXkp
Cit7CisgICAgc3dpdGNoKHNlbnNlX2tleSkgeworICAgIGNhc2UgTk9fU0VOU0U6CisgICAgICAg
IHJldHVybiAiTk8gU0VOU0UiOworICAgIGNhc2UgUkVDT1ZFUkVEX0VSUk9SOgorICAgICAgICBy
ZXR1cm4gIlJFQ09WRVJFRCBFUlJPUiI7CisgICAgY2FzZSBOT1RfUkVBRFk6CisgICAgICAgIHJl
dHVybiAiTFVOIE5PVCBSRUFEWSI7CisgICAgY2FzZSBNRURJVU1fRVJST1I6CisgICAgICAgIHJl
dHVybiAiTUVESVVNIEVSUk9SIjsKKyAgICBjYXNlIEhBUkRXQVJFX0VSUk9SOgorICAgICAgICBy
ZXR1cm4gIkhBUkRXQVJFIEVSUk9SIjsKKyAgICBjYXNlIElMTEVHQUxfUkVRVUVTVDoKKyAgICAg
ICAgcmV0dXJuICJJTExFR0FMIFJFUVVFU1QiOworICAgIGNhc2UgVU5JVF9BVFRFTlRJT046Cisg
ICAgICAgIHJldHVybiAiVU5JVCBBVFRFTlRJT04iOworICAgIGNhc2UgQkxBTktfQ0hFQ0s6Cisg
ICAgICAgIHJldHVybiAiQkxBTksgQ0hFQ0siOworICAgIGNhc2UgQUJPUlRFRF9DT01NQU5EOgor
ICAgICAgICByZXR1cm4gIkFCT1JURUQgQ09NTUFORCI7CisgICAgZGVmYXVsdDoKKyAgICAgICAg
cmV0dXJuICI/Pz8iOworICAgIH0KK30KK3N0YXRpYyB1aW50MzJfdCBjZF9zY3NpX2J1aWxkX2Zp
eGVkX3NlbnNlKHVpbnQ4X3QgKmJ1ZiwgY29uc3QgU2NzaVNob3J0U2Vuc2UgKnNob3J0X3NlbnNl
KQoreworICAgIG1lbXNldChidWYsIDAsIEZJWEVEX1NFTlNFX0xFTik7CisKKyAgICBidWZbMF0g
PSBGSVhFRF9TRU5TRV9DVVJSRU5UOworICAgIGJ1ZlsyXSA9IHNob3J0X3NlbnNlLT5rZXk7Cisg
ICAgYnVmWzddID0gMTA7CisgICAgYnVmWzEyXSA9IHNob3J0X3NlbnNlLT5hc2M7CisgICAgYnVm
WzEzXSA9IHNob3J0X3NlbnNlLT5hc2NxOworCisgICAgcmV0dXJuIEZJWEVEX1NFTlNFX0xFTjsK
K30KKworc3RhdGljIGlubGluZSB2b2lkIGNkX3Njc2lfcmVxX2luaXQoQ2RTY3NpUmVxdWVzdCAq
cmVxKQoreworICAgIHJlcS0+cmVxX3N0YXRlID0gU0NTSV9SRVFfSURMRTsKKyAgICByZXEtPnhm
ZXJfZGlyID0gU0NTSV9YRkVSX05PTkU7CisgICAgcmVxLT5wcml2X2RhdGEgPSBOVUxMOworICAg
IHJlcS0+aW5fbGVuID0gMDsKKyAgICByZXEtPnN0YXR1cyA9IEdPT0Q7Cit9CisKK3N0YXRpYyBp
bmxpbmUgdm9pZCBjZF9zY3NpX2Rldl9zZW5zZV9yZXNldChDZFNjc2lMVSAqZGV2KQoreworICAg
IG1lbXNldCgmZGV2LT5zaG9ydF9zZW5zZSwgMCwgc2l6ZW9mKGRldi0+c2hvcnRfc2Vuc2UpKTsK
KyAgICBjZF9zY3NpX2J1aWxkX2ZpeGVkX3NlbnNlKGRldi0+Zml4ZWRfc2Vuc2UsICZkZXYtPnNo
b3J0X3NlbnNlKTsKK30KKworc3RhdGljIGlubGluZSB2b2lkIGNkX3Njc2lfZGV2X3NlbnNlX3Nl
dChDZFNjc2lMVSAqZGV2LCBjb25zdCBTY3NpU2hvcnRTZW5zZSAqc2hvcnRfc2Vuc2UpCit7Cisg
ICAgaWYgKHNob3J0X3NlbnNlICE9IE5VTEwpIHsKKyAgICAgICAgLyogY29weSBzaG9ydCBzZW5z
ZSBhbmQgZ2VuZXJhdGUgZnVsbCBzZW5zZSBpbiBmaXhlZCBmb3JtYXQgKi8KKyAgICAgICAgZGV2
LT5zaG9ydF9zZW5zZSA9ICpzaG9ydF9zZW5zZTsKKyAgICAgICAgY2Rfc2NzaV9idWlsZF9maXhl
ZF9zZW5zZShkZXYtPmZpeGVkX3NlbnNlLCBzaG9ydF9zZW5zZSk7CisgICAgfQorfQorCitzdGF0
aWMgaW5saW5lIHZvaWQgY2Rfc2NzaV9kZXZfc2Vuc2Vfc2V0X3Bvd2VyX29uKENkU2NzaUxVICpk
ZXYpCit7CisgICAgY2Rfc2NzaV9kZXZfc2Vuc2Vfc2V0KGRldiwgJnNlbnNlX2NvZGVfUE9XRVJf
T05fUkVTRVQpOworfQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19j
b25kKENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgU2NzaVNob3J0U2Vuc2UgKnNob3J0X3Nl
bnNlKQoreworICAgIHJlcS0+cmVxX3N0YXRlID0gU0NTSV9SRVFfQ09NUExFVEU7CisgICAgcmVx
LT5zdGF0dXMgPSBDSEVDS19DT05ESVRJT047CisgICAgcmVxLT5pbl9sZW4gPSAwOworCisgICAg
Y2Rfc2NzaV9kZXZfc2Vuc2Vfc2V0KGRldiwgc2hvcnRfc2Vuc2UpOworCisgICAgU1BJQ0VfREVC
VUcoIkNIRUNLX0NPTkQsIHJlcXVlc3QgbHVuOiV1IgorICAgICAgICAgICAgICAgICIgb3A6IDB4
JTAyeCwgcGVuZGluZyBzZW5zZTogMHglMDJ4ICUwMnggJTAyeCAtICVzLCAlcyIsCisgICAgICAg
ICAgICAgICAgZGV2LT5sdW4sICh1aW50MzJfdClyZXEtPmNkYlswXSwKKyAgICAgICAgICAgICAg
ICAodWludDMyX3QpZGV2LT5zaG9ydF9zZW5zZS5rZXksCisgICAgICAgICAgICAgICAgKHVpbnQz
Ml90KWRldi0+c2hvcnRfc2Vuc2UuYXNjLAorICAgICAgICAgICAgICAgICh1aW50MzJfdClkZXYt
PnNob3J0X3NlbnNlLmFzY3EsCisgICAgICAgICAgICAgICAgY2Rfc2NzaV9zZW5zZV9rZXlfZGVz
Y3IoZGV2LT5zaG9ydF9zZW5zZS5rZXkpLAorICAgICAgICAgICAgICAgIGRldi0+c2hvcnRfc2Vu
c2UuZGVzY3IpOworfQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKENk
U2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICByZXEtPnJlcV9zdGF0ZSA9
IFNDU0lfUkVRX0NPTVBMRVRFOworICAgIHJlcS0+c3RhdHVzID0gR09PRDsKK30KKworLyogU0NT
SSBUYXJnZXQgKi8KKworU1BJQ0VfQ09OU1RSVUNUT1JfRlVOQyhjZF9zY3NpX2NtZF9uYW1lc19p
bml0KQoreworICAgIHVpbnQzMl90IG9wY29kZTsKKworICAgIGZvciAob3Bjb2RlID0gMDsgb3Bj
b2RlIDwgMjU2OyBvcGNvZGUrKykgeworICAgICAgICBzY3NpX2NtZF9uYW1lW29wY29kZV0gPSAi
VU5TVVBQT1JURUQiOworICAgIH0KKworICAgIHNjc2lfY21kX25hbWVbUkVQT1JUX0xVTlNdID0g
IlJFUE9SVCBMVU5TIjsKKyAgICBzY3NpX2NtZF9uYW1lW1RFU1RfVU5JVF9SRUFEWV0gPSAiVEVT
VCBVTklUIFJFQURZIjsKKyAgICBzY3NpX2NtZF9uYW1lW0lOUVVJUlldID0gIklOUVVJUlkiOwor
ICAgIHNjc2lfY21kX25hbWVbUkVRVUVTVF9TRU5TRV0gPSAiUkVRVUVTVCBTRU5TRSI7CisgICAg
c2NzaV9jbWRfbmFtZVtSRUFEXzZdID0gIlJFQUQoNikiOworICAgIHNjc2lfY21kX25hbWVbUkVB
RF8xMF0gPSAiUkVBRCgxMCkiOworICAgIHNjc2lfY21kX25hbWVbUkVBRF8xMl0gPSAiUkVBRCgx
MikiOworICAgIHNjc2lfY21kX25hbWVbUkVBRF8xNl0gPSAiUkVBRCgxNikiOworICAgIHNjc2lf
Y21kX25hbWVbUkVBRF9DQVBBQ0lUWV8xMF0gPSAiUkVBRCBDQVBBQ0lUWSgxMCkiOworICAgIHNj
c2lfY21kX25hbWVbUkVBRF9UT0NdID0gIlJFQUQgVE9DIjsKKyAgICBzY3NpX2NtZF9uYW1lW0dF
VF9FVkVOVF9TVEFUVVNfTk9USUZJQ0FUSU9OXSA9ICJHRVQgRVZFTlQvU1RBVFVTIE5PVElGSUNB
VElPTiI7CisgICAgc2NzaV9jbWRfbmFtZVtSRUFEX0RJU0NfSU5GT1JNQVRJT05dID0gIlJFQUQg
RElTQyBJTkZPIjsKKyAgICBzY3NpX2NtZF9uYW1lW1JFQURfVFJBQ0tfSU5GT1JNQVRJT05dID0g
IlJFQUQgVFJBQ0sgSU5GTyI7CisgICAgc2NzaV9jbWRfbmFtZVtNT0RFX1NFTlNFXzEwXSA9ICJN
T0RFIFNFTlNFKDEwKSI7CisgICAgc2NzaV9jbWRfbmFtZVtNT0RFX1NFTEVDVF0gPSAiTU9ERSBT
RUxFQ1QoNikiOworICAgIHNjc2lfY21kX25hbWVbTU9ERV9TRUxFQ1RfMTBdID0gIk1PREUgU0VM
RUNUKDEwKSI7CisgICAgc2NzaV9jbWRfbmFtZVtHRVRfQ09ORklHVVJBVElPTl0gPSAiR0VUIENP
TkZJR1VSQVRJT04iOworICAgIHNjc2lfY21kX25hbWVbQUxMT1dfTUVESVVNX1JFTU9WQUxdID0g
IlBSRVZFTlQgQUxMT1cgTUVESVVNIFJFTU9WQUwiOworICAgIHNjc2lfY21kX25hbWVbTU1DX1NF
TkRfRVZFTlRdID0gIlNFTkQgRVZFTlQiOworICAgIHNjc2lfY21kX25hbWVbTU1DX1JFUE9SVF9L
RVldID0gIlJFUE9SVCBLRVkiOworICAgIHNjc2lfY21kX25hbWVbTU1DX1NFTkRfS0VZXSA9ICJT
RU5EX0tFWSI7CisgICAgc2NzaV9jbWRfbmFtZVtTVEFSVF9TVE9QXSA9ICJTVEFSVCBTVE9QIFVO
SVQiOworICAgIHNjc2lfY21kX25hbWVbTU1DX0dFVF9QRVJGT1JNQU5DRV0gPSAiR0VUIFBFUkZP
Uk1BTkNFIjsKKyAgICBzY3NpX2NtZF9uYW1lW01NQ19NRUNIQU5JU01fU1RBVFVTXSA9ICJNRUNI
QU5JU00gU1RBVFVTIjsKK30KKworQ2RTY3NpVGFyZ2V0ICpjZF9zY3NpX3RhcmdldF9hbGxvYyh2
b2lkICp0YXJnZXRfdXNlcl9kYXRhLCB1aW50MzJfdCBtYXhfbHVucykKK3sKKyAgICBDZFNjc2lU
YXJnZXQgKnN0OworCisgICAgaWYgKG1heF9sdW5zID09IDAgfHwgbWF4X2x1bnMgPiBNQVhfTFVO
UykgeworICAgICAgICBTUElDRV9FUlJPUigiQWxsb2MsIGlsbGVnYWwgbWF4X2x1bnM6JXUiLCBt
YXhfbHVucyk7CisgICAgICAgIHJldHVybiBOVUxMOworICAgIH0KKworICAgIHN0ID0gZ19tYWxs
b2MwKHNpemVvZigqc3QpKTsKKworICAgIHN0LT51c2VyX2RhdGEgPSB0YXJnZXRfdXNlcl9kYXRh
OworICAgIHN0LT5zdGF0ZSA9IENEX1NDU0lfVEdUX1NUQVRFX1JVTk5JTkc7CisgICAgc3QtPmN1
cl9yZXEgPSBOVUxMOworICAgIHN0LT5jYW5jZWxsYWJsZSA9IGdfY2FuY2VsbGFibGVfbmV3KCk7
CisgICAgc3QtPm1heF9sdW5zID0gbWF4X2x1bnM7CisKKyAgICByZXR1cm4gc3Q7Cit9CisKK3Zv
aWQgY2Rfc2NzaV90YXJnZXRfZnJlZShDZFNjc2lUYXJnZXQgKnN0KQoreworICAgIHVpbnQzMl90
IGx1bjsKKworICAgIGNkX3Njc2lfdGFyZ2V0X3Jlc2V0KHN0KTsKKyAgICBmb3IgKGx1biA9IDA7
IGx1biA8IHN0LT5tYXhfbHVuczsgbHVuKyspIHsKKyAgICAgICAgQ2RTY3NpTFUgKnVuaXQgPSAm
c3QtPnVuaXRzW2x1bl07CisgICAgICAgIGlmICh1bml0LT5yZWFsaXplZCkgeworICAgICAgICAg
ICAgY2Rfc2NzaV9kZXZfdW5yZWFsaXplKHN0LCBsdW4pOworICAgICAgICB9CisgICAgICAgIGdf
Y2xlYXJfb2JqZWN0KCZ1bml0LT5zdHJlYW0pOworICAgIH0KKyAgICBnX2NsZWFyX29iamVjdCgm
c3QtPmNhbmNlbGxhYmxlKTsKKyAgICBnX2ZyZWUoc3QpOworfQorCisvKiBTQ1NJIERldmljZSAq
LworCitzdGF0aWMgaW5saW5lIGdib29sZWFuIGNkX3Njc2lfdGFyZ2V0X2x1bl9sZWdhbChjb25z
dCBDZFNjc2lUYXJnZXQgKnN0LCB1aW50MzJfdCBsdW4pCit7CisgICAgcmV0dXJuIChsdW4gPCBz
dC0+bWF4X2x1bnMpID8gVFJVRSA6IEZBTFNFOworfQorCitzdGF0aWMgaW5saW5lIGdib29sZWFu
IGNkX3Njc2lfdGFyZ2V0X2x1bl9yZWFsaXplZChjb25zdCBDZFNjc2lUYXJnZXQgKnN0LCB1aW50
MzJfdCBsdW4pCit7CisgICAgcmV0dXJuIHN0LT51bml0c1tsdW5dLnJlYWxpemVkOworfQorCitp
bnQgY2Rfc2NzaV9kZXZfcmVhbGl6ZShDZFNjc2lUYXJnZXQgKnN0LCB1aW50MzJfdCBsdW4sCisg
ICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBDZFNjc2lEZXZpY2VQYXJhbWV0ZXJzICpkZXZf
cGFyYW1zKQoreworICAgIENkU2NzaUxVICpkZXY7CisKKyAgICBpZiAoIWNkX3Njc2lfdGFyZ2V0
X2x1bl9sZWdhbChzdCwgbHVuKSkgeworICAgICAgICBTUElDRV9FUlJPUigiUmVhbGl6ZSwgaWxs
ZWdhbCBsdW46JXUiLCBsdW4pOworICAgICAgICByZXR1cm4gLTE7CisgICAgfQorICAgIGlmIChj
ZF9zY3NpX3RhcmdldF9sdW5fcmVhbGl6ZWQoc3QsIGx1bikpIHsKKyAgICAgICAgU1BJQ0VfRVJS
T1IoIlJlYWxpemUsIGFscmVhZHkgcmVhbGl6ZWQgbHVuOiV1IiwgbHVuKTsKKyAgICAgICAgcmV0
dXJuIC0xOworICAgIH0KKyAgICBkZXYgPSAmc3QtPnVuaXRzW2x1bl07CisKKyAgICBtZW1zZXQo
ZGV2LCAwLCBzaXplb2YoKmRldikpOworICAgIGRldi0+dGd0ID0gc3Q7CisgICAgZGV2LT5sdW4g
PSBsdW47CisKKyAgICBkZXYtPnJlYWxpemVkID0gVFJVRTsKKyAgICBkZXYtPnJlbW92YWJsZSA9
IFRSVUU7CisgICAgZGV2LT5sb2FkZWQgPSBGQUxTRTsKKyAgICBkZXYtPnByZXZlbnRfbWVkaWFf
cmVtb3ZhbCA9IEZBTFNFOworICAgIGRldi0+Y2Rfcm9tID0gRkFMU0U7CisKKyAgICBkZXYtPnBv
d2VyX2NvbmQgPSBDRF9TQ1NJX1BPV0VSX0FDVElWRTsKKyAgICBkZXYtPnBvd2VyX2V2ZW50ID0g
Q0RfUE9XRVJfRVZFTlRfTk9fQ0hBTkdFOworICAgIGRldi0+bWVkaWFfZXZlbnQgPSBDRF9NRURJ
QV9FVkVOVF9OT19DSEFOR0U7CisKKyAgICBkZXYtPmNsYWltX3ZlcnNpb24gPSAzOyAvKiAwIDog
bm9uZTsgMiwzLDUgOiBTUEMvTU1DLXggKi8KKworICAgIGRldi0+dmVuZG9yID0gZ19zdHJkdXAo
ZGV2X3BhcmFtcy0+dmVuZG9yKTsKKyAgICBkZXYtPnByb2R1Y3QgPSBnX3N0cmR1cChkZXZfcGFy
YW1zLT5wcm9kdWN0KTsKKyAgICBkZXYtPnZlcnNpb24gPSBnX3N0cmR1cChkZXZfcGFyYW1zLT52
ZXJzaW9uKTsKKyAgICBkZXYtPnNlcmlhbCA9IGdfc3RyZHVwKGRldl9wYXJhbXMtPnNlcmlhbCk7
CisKKyAgICBjZF9zY3NpX2Rldl9zZW5zZV9zZXRfcG93ZXJfb24oZGV2KTsKKworICAgIFNQSUNF
X0RFQlVHKCJSZWFsaXplIGx1bjoldSBiczoldSBWUjpbJXNdIFBUOlslc10gdmVyOlslc10gU05b
JXNdIiwKKyAgICAgICAgICAgICAgICBsdW4sIGRldi0+YmxvY2tfc2l6ZSwgZGV2LT52ZW5kb3Is
CisgICAgICAgICAgICAgICAgZGV2LT5wcm9kdWN0LCBkZXYtPnZlcnNpb24sIGRldi0+c2VyaWFs
KTsKKyAgICByZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9sdV9tZWRpYV9yZXNl
dChDZFNjc2lMVSAqZGV2KQoreworICAgIC8qIG1lZGlhX2V2ZW50IGlzIG5vdCBzZXQgaGVyZSwg
YXMgaXQgZGVwZW5kcyBvbiB0aGUgY29udGV4dCAqLworICAgIGdfY2xlYXJfb2JqZWN0KCZkZXYt
PnN0cmVhbSk7CisgICAgZGV2LT5zaXplID0gMDsKKyAgICBkZXYtPmJsb2NrX3NpemUgPSAwOwor
ICAgIGRldi0+bnVtX2Jsb2NrcyA9IDA7Cit9CisKK2ludCBjZF9zY3NpX2Rldl9sb2NrKENkU2Nz
aVRhcmdldCAqc3QsIHVpbnQzMl90IGx1biwgZ2Jvb2xlYW4gbG9jaykKK3sKKyAgICBDZFNjc2lM
VSAqZGV2OworCisgICAgaWYgKCFjZF9zY3NpX3RhcmdldF9sdW5fbGVnYWwoc3QsIGx1bikpIHsK
KyAgICAgICAgU1BJQ0VfRVJST1IoIkxvY2ssIGlsbGVnYWwgbHVuOiV1IiwgbHVuKTsKKyAgICAg
ICAgcmV0dXJuIC0xOworICAgIH0KKyAgICBpZiAoIWNkX3Njc2lfdGFyZ2V0X2x1bl9yZWFsaXpl
ZChzdCwgbHVuKSkgeworICAgICAgICBTUElDRV9FUlJPUigiTG9jaywgdW5yZWFsaXplZCBsdW46
JXUiLCBsdW4pOworICAgICAgICByZXR1cm4gLTE7CisgICAgfQorICAgIGRldiA9ICZzdC0+dW5p
dHNbbHVuXTsKKyAgICBkZXYtPnByZXZlbnRfbWVkaWFfcmVtb3ZhbCA9IGxvY2s7CisgICAgU1BJ
Q0VfREVCVUcoImx1bjoldSAlc2xvY2siLCBsdW4sIGxvY2sgPyAidW4iIDoiIik7CisgICAgcmV0
dXJuIDA7Cit9CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfbHVfbG9hZChDZFNjc2lMVSAqZGV2LAor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IENkU2NzaU1lZGlhUGFyYW1ldGVycyAq
bWVkaWFfcGFyYW1zKQoreworICAgIGlmIChtZWRpYV9wYXJhbXMgIT0gTlVMTCkgeworICAgICAg
ICBkZXYtPm1lZGlhX2V2ZW50ID0gQ0RfTUVESUFfRVZFTlRfTkVXX01FRElBOworICAgICAgICBk
ZXYtPnN0cmVhbSA9IGdfb2JqZWN0X3JlZihtZWRpYV9wYXJhbXMtPnN0cmVhbSk7CisgICAgICAg
IGRldi0+c2l6ZSA9IG1lZGlhX3BhcmFtcy0+c2l6ZTsKKyAgICAgICAgZGV2LT5ibG9ja19zaXpl
ID0gbWVkaWFfcGFyYW1zLT5ibG9ja19zaXplOworICAgICAgICBkZXYtPm51bV9ibG9ja3MgPSBt
ZWRpYV9wYXJhbXMtPnNpemUgLyBtZWRpYV9wYXJhbXMtPmJsb2NrX3NpemU7CisgICAgICAgIGRl
di0+bG9hZGVkID0gVFJVRTsKKyAgICB9IGVsc2UgeworICAgICAgICBkZXYtPm1lZGlhX2V2ZW50
ID0gQ0RfTUVESUFfRVZFTlRfTUVESUFfUkVNT1ZBTDsKKyAgICAgICAgY2Rfc2NzaV9sdV9tZWRp
YV9yZXNldChkZXYpOworICAgICAgICBkZXYtPmxvYWRlZCA9IEZBTFNFOworICAgIH0KK30KKwor
c3RhdGljIHZvaWQgY2Rfc2NzaV9sdV91bmxvYWQoQ2RTY3NpTFUgKmRldikKK3sKKyAgICBkZXYt
Pm1lZGlhX2V2ZW50ID0gQ0RfTUVESUFfRVZFTlRfTUVESUFfUkVNT1ZBTDsKKyAgICBjZF9zY3Np
X2x1X21lZGlhX3Jlc2V0KGRldik7CisgICAgZGV2LT5sb2FkZWQgPSBGQUxTRTsKK30KKworaW50
IGNkX3Njc2lfZGV2X2xvYWQoQ2RTY3NpVGFyZ2V0ICpzdCwgdWludDMyX3QgbHVuLAorICAgICAg
ICAgICAgICAgICAgICAgY29uc3QgQ2RTY3NpTWVkaWFQYXJhbWV0ZXJzICptZWRpYV9wYXJhbXMp
Cit7CisgICAgQ2RTY3NpTFUgKmRldjsKKworICAgIGlmICghY2Rfc2NzaV90YXJnZXRfbHVuX2xl
Z2FsKHN0LCBsdW4pKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJMb2FkLCBpbGxlZ2FsIGx1bjol
dSIsIGx1bik7CisgICAgICAgIHJldHVybiAtMTsKKyAgICB9CisgICAgaWYgKCFjZF9zY3NpX3Rh
cmdldF9sdW5fcmVhbGl6ZWQoc3QsIGx1bikpIHsKKyAgICAgICAgU1BJQ0VfRVJST1IoIkxvYWQs
IHVucmVhbGl6ZWQgbHVuOiV1IiwgbHVuKTsKKyAgICAgICAgcmV0dXJuIC0xOworICAgIH0KKyAg
ICBkZXYgPSAmc3QtPnVuaXRzW2x1bl07CisKKyAgICBjZF9zY3NpX2x1X2xvYWQoZGV2LCBtZWRp
YV9wYXJhbXMpOworICAgIGRldi0+cG93ZXJfY29uZCA9IENEX1NDU0lfUE9XRVJfQUNUSVZFOwor
ICAgIGRldi0+cG93ZXJfZXZlbnQgPSBDRF9QT1dFUl9FVkVOVF9DSEFOR0VfU1VDQ0VTUzsKKwor
ICAgIGNkX3Njc2lfZGV2X3NlbnNlX3NldChkZXYsICZzZW5zZV9jb2RlX01FRElVTV9DSEFOR0VE
KTsKKworICAgIFNQSUNFX0RFQlVHKCJMb2FkIGx1bjoldSBzaXplOiUiIEdfR1VJTlQ2NF9GT1JN
QVQKKyAgICAgICAgICAgICAgICAiIGJsa19zejoldSBudW1fYmxvY2tzOiV1IiwKKyAgICAgICAg
ICAgICAgICBsdW4sIGRldi0+c2l6ZSwgZGV2LT5ibG9ja19zaXplLCBkZXYtPm51bV9ibG9ja3Mp
OworICAgIHJldHVybiAwOworfQorCitpbnQgY2Rfc2NzaV9kZXZfZ2V0X2luZm8oQ2RTY3NpVGFy
Z2V0ICpzdCwgdWludDMyX3QgbHVuLCBDZFNjc2lEZXZpY2VJbmZvICpsdW5faW5mbykKK3sKKyAg
ICBDZFNjc2lMVSAqZGV2OworCisgICAgaWYgKCFjZF9zY3NpX3RhcmdldF9sdW5fbGVnYWwoc3Qs
IGx1bikpIHsKKyAgICAgICAgU1BJQ0VfRVJST1IoIkxvYWQsIGlsbGVnYWwgbHVuOiV1IiwgbHVu
KTsKKyAgICAgICAgcmV0dXJuIC0xOworICAgIH0KKyAgICBpZiAoIWNkX3Njc2lfdGFyZ2V0X2x1
bl9yZWFsaXplZChzdCwgbHVuKSkgeworICAgICAgICBTUElDRV9FUlJPUigiTG9hZCwgdW5yZWFs
aXplZCBsdW46JXUiLCBsdW4pOworICAgICAgICByZXR1cm4gLTE7CisgICAgfQorICAgIGRldiA9
ICZzdC0+dW5pdHNbbHVuXTsKKworICAgIGx1bl9pbmZvLT5zdGFydGVkID0gZGV2LT5wb3dlcl9j
b25kID09IENEX1NDU0lfUE9XRVJfQUNUSVZFOworICAgIGx1bl9pbmZvLT5sb2NrZWQgPSBkZXYt
PnByZXZlbnRfbWVkaWFfcmVtb3ZhbDsKKyAgICBsdW5faW5mby0+bG9hZGVkID0gZGV2LT5sb2Fk
ZWQ7CisKKyAgICBsdW5faW5mby0+cGFyYW1ldGVycy52ZW5kb3IgPSBkZXYtPnZlbmRvcjsKKyAg
ICBsdW5faW5mby0+cGFyYW1ldGVycy5wcm9kdWN0ID0gZGV2LT5wcm9kdWN0OworICAgIGx1bl9p
bmZvLT5wYXJhbWV0ZXJzLnZlcnNpb24gPSBkZXYtPnZlcnNpb247CisgICAgbHVuX2luZm8tPnBh
cmFtZXRlcnMuc2VyaWFsID0gZGV2LT5zZXJpYWw7CisKKyAgICByZXR1cm4gMDsKK30KKworaW50
IGNkX3Njc2lfZGV2X3VubG9hZChDZFNjc2lUYXJnZXQgKnN0LCB1aW50MzJfdCBsdW4pCit7Cisg
ICAgQ2RTY3NpTFUgKmRldjsKKworICAgIGlmICghY2Rfc2NzaV90YXJnZXRfbHVuX2xlZ2FsKHN0
LCBsdW4pKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJVbmxvYWQsIGlsbGVnYWwgbHVuOiV1Iiwg
bHVuKTsKKyAgICAgICAgcmV0dXJuIC0xOworICAgIH0KKyAgICBpZiAoIWNkX3Njc2lfdGFyZ2V0
X2x1bl9yZWFsaXplZChzdCwgbHVuKSkgeworICAgICAgICBTUElDRV9FUlJPUigiVW5sb2FkLCB1
bnJlYWxpemVkIGx1bjoldSIsIGx1bik7CisgICAgICAgIHJldHVybiAtMTsKKyAgICB9CisgICAg
ZGV2ID0gJnN0LT51bml0c1tsdW5dOworICAgIGlmICghZGV2LT5sb2FkZWQpIHsKKyAgICAgICAg
U1BJQ0VfRVJST1IoIlVubG9hZCwgbHVuOiV1IG5vdCBsb2FkZWQgeWV0IiwgbHVuKTsKKyAgICAg
ICAgcmV0dXJuIDA7CisgICAgfQorICAgIGlmIChkZXYtPnByZXZlbnRfbWVkaWFfcmVtb3ZhbCkg
eworICAgICAgICBTUElDRV9FUlJPUigiVW5sb2FkLCBsdW46JXUgcHJldmVudF9tZWRpYV9yZW1v
dmFsIHNldCIsIGx1bik7CisgICAgICAgIHJldHVybiAtMTsKKyAgICB9CisKKyAgICBjZF9zY3Np
X2x1X3VubG9hZChkZXYpOworICAgIGRldi0+cG93ZXJfY29uZCA9IENEX1NDU0lfUE9XRVJfU1RP
UFBFRDsKKyAgICBkZXYtPnBvd2VyX2V2ZW50ID0gQ0RfUE9XRVJfRVZFTlRfQ0hBTkdFX1NVQ0NF
U1M7CisKKyAgICBjZF9zY3NpX2Rldl9zZW5zZV9zZXQoZGV2LCAmc2Vuc2VfY29kZV9VQV9OT19N
RURJVU0pOworCisgICAgU1BJQ0VfREVCVUcoIlVubG9hZCBsdW46JXUiLCBsdW4pOworICAgIHJl
dHVybiAwOworfQorCitpbnQgY2Rfc2NzaV9kZXZfdW5yZWFsaXplKENkU2NzaVRhcmdldCAqc3Qs
IHVpbnQzMl90IGx1bikKK3sKKyAgICBDZFNjc2lMVSAqZGV2OworCisgICAgaWYgKCFjZF9zY3Np
X3RhcmdldF9sdW5fbGVnYWwoc3QsIGx1bikpIHsKKyAgICAgICAgU1BJQ0VfRVJST1IoIlVucmVh
bGl6ZSwgaWxsZWdhbCBsdW46JXUiLCBsdW4pOworICAgICAgICByZXR1cm4gLTE7CisgICAgfQor
ICAgIGlmICghY2Rfc2NzaV90YXJnZXRfbHVuX3JlYWxpemVkKHN0LCBsdW4pKSB7CisgICAgICAg
IFNQSUNFX0VSUk9SKCJVbnJlYWxpemUsIGFic2VudCBsdW46JXUiLCBsdW4pOworICAgICAgICBy
ZXR1cm4gLTE7CisgICAgfQorICAgIGRldiA9ICZzdC0+dW5pdHNbbHVuXTsKKworICAgIGdfY2xl
YXJfcG9pbnRlcigmZGV2LT52ZW5kb3IsIGdfZnJlZSk7CisgICAgZ19jbGVhcl9wb2ludGVyKCZk
ZXYtPnByb2R1Y3QsIGdfZnJlZSk7CisgICAgZ19jbGVhcl9wb2ludGVyKCZkZXYtPnZlcnNpb24s
IGdfZnJlZSk7CisgICAgZ19jbGVhcl9wb2ludGVyKCZkZXYtPnNlcmlhbCwgZ19mcmVlKTsKKwor
ICAgIGdfY2xlYXJfb2JqZWN0KCZkZXYtPnN0cmVhbSk7CisKKyAgICBkZXYtPmxvYWRlZCA9IEZB
TFNFOworICAgIGRldi0+cmVhbGl6ZWQgPSBGQUxTRTsKKyAgICBkZXYtPnBvd2VyX2NvbmQgPSBD
RF9TQ1NJX1BPV0VSX1NUT1BQRUQ7CisKKyAgICBTUElDRV9ERUJVRygiVW5yZWFsaXplIGx1bjol
dSIsIGx1bik7CisgICAgcmV0dXJuIDA7Cit9CisKK2ludCBjZF9zY3NpX2Rldl9yZXNldChDZFNj
c2lUYXJnZXQgKnN0LCB1aW50MzJfdCBsdW4pCit7CisgICAgQ2RTY3NpTFUgKmRldjsKKworICAg
IGlmICghY2Rfc2NzaV90YXJnZXRfbHVuX2xlZ2FsKHN0LCBsdW4pKSB7CisgICAgICAgIFNQSUNF
X0VSUk9SKCJEZXZpY2UgcmVzZXQsIGlsbGVnYWwgbHVuOiV1IiwgbHVuKTsKKyAgICAgICAgcmV0
dXJuIC0xOworICAgIH0KKyAgICBpZiAoIWNkX3Njc2lfdGFyZ2V0X2x1bl9yZWFsaXplZChzdCwg
bHVuKSkgeworICAgICAgICBTUElDRV9FUlJPUigiRGV2aWNlIHJlc2V0LCBhYnNlbnQgbHVuOiV1
IiwgbHVuKTsKKyAgICAgICAgcmV0dXJuIC0xOworICAgIH0KKyAgICBkZXYgPSAmc3QtPnVuaXRz
W2x1bl07CisKKyAgICAvKiBpZiB3ZSByZXNldCB0aGUgJ3ByZXZlbnQnIGZsYWcgd2UgY2FuJ3Qg
Y3JlYXRlCisgICAgICogdGhlIHVuaXQgdGhhdCBpcyBsb2NrZWQgZnJvbSB0aGUgYmVnaW5uaW5n
LCBzbworICAgICAqIHdlIGtlZXAgdGhpcyBmbGFnIGFzIHBlcnNpc3RlbnQgb3ZlciByZXNldHMK
KyAgICAgKi8KKyAgICAvKiBkZXYtPnByZXZlbnRfbWVkaWFfcmVtb3ZhbCA9IEZBTFNFOyAqLwor
ICAgIGRldi0+cG93ZXJfY29uZCA9IENEX1NDU0lfUE9XRVJfQUNUSVZFOworICAgIGRldi0+cG93
ZXJfZXZlbnQgPSBDRF9QT1dFUl9FVkVOVF9DSEFOR0VfU1VDQ0VTUzsKKyAgICBjZF9zY3NpX2Rl
dl9zZW5zZV9zZXRfcG93ZXJfb24oZGV2KTsKKworICAgIFNQSUNFX0RFQlVHKCJEZXZpY2UgcmVz
ZXQgbHVuOiV1IiwgbHVuKTsKKyAgICByZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQgY2Rfc2Nz
aV90YXJnZXRfZG9fcmVzZXQoQ2RTY3NpVGFyZ2V0ICpzdCkKK3sKKyAgICB1aW50MzJfdCBsdW47
CisKKyAgICBmb3IgKGx1biA9IDA7IGx1biA8IHN0LT5tYXhfbHVuczsgbHVuKyspIHsKKyAgICAg
ICAgaWYgKHN0LT51bml0c1tsdW5dLnJlYWxpemVkKSB7CisgICAgICAgICAgICBjZF9zY3NpX2Rl
dl9yZXNldChzdCwgbHVuKTsKKyAgICAgICAgfQorICAgIH0KKworICAgIFNQSUNFX0RFQlVHKCJU
YXJnZXQgcmVzZXQgY29tcGxldGUiKTsKKyAgICBzdC0+c3RhdGUgPSBDRF9TQ1NJX1RHVF9TVEFU
RV9SVU5OSU5HOworICAgIGNkX3Njc2lfdGFyZ2V0X3Jlc2V0X2NvbXBsZXRlKHN0LT51c2VyX2Rh
dGEpOworfQorCitpbnQgY2Rfc2NzaV90YXJnZXRfcmVzZXQoQ2RTY3NpVGFyZ2V0ICpzdCkKK3sK
KyAgICBpZiAoc3QtPnN0YXRlID09IENEX1NDU0lfVEdUX1NUQVRFX1JFU0VUKSB7CisgICAgICAg
IFNQSUNFX0RFQlVHKCJUYXJnZXQgYWxyZWFkeSBpbiByZXNldCIpOworICAgICAgICByZXR1cm4g
LTE7CisgICAgfQorCisgICAgc3QtPnN0YXRlID0gQ0RfU0NTSV9UR1RfU1RBVEVfUkVTRVQ7CisK
KyAgICBpZiAoc3QtPmN1cl9yZXEgIT0gTlVMTCkgeworICAgICAgICBjZF9zY3NpX2Rldl9yZXF1
ZXN0X2NhbmNlbChzdCwgc3QtPmN1cl9yZXEpOworICAgICAgICBpZiAoc3QtPmN1cl9yZXEgIT0g
TlVMTCkgeworICAgICAgICAgICAgU1BJQ0VfREVCVUcoIlRhcmdldCByZXNldCBpbiBwcm9ncmVz
cy4uLiIpOworICAgICAgICAgICAgcmV0dXJuIDA7CisgICAgICAgIH0KKyAgICB9CisKKyAgICBj
ZF9zY3NpX3RhcmdldF9kb19yZXNldChzdCk7CisgICAgcmV0dXJuIDA7Cit9CisKK0NkU2NzaVJl
cVN0YXRlIGNkX3Njc2lfZ2V0X3JlcV9zdGF0ZShDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAg
cmV0dXJuIHJlcS0+cmVxX3N0YXRlOworfQorCitzdGF0aWMgdm9pZCBzdHJwYWRjcHkoY2hhciAq
YnVmLCBpbnQgYnVmX3NpemUsIGNvbnN0IGNoYXIgKnN0ciwgY2hhciBwYWQpCit7CisgICAgaW50
IGxlbiA9IHN0cm5sZW4oc3RyLCBidWZfc2l6ZSk7CisgICAgbWVtY3B5KGJ1Ziwgc3RyLCBsZW4p
OworICAgIG1lbXNldChidWYgKyBsZW4sIHBhZCwgYnVmX3NpemUgLSBsZW4pOworfQorCisvKiBT
Q1NJIENEQiAqLworCitzdGF0aWMgdW5zaWduZWQgaW50IHNjc2lfY2RiX2xlbmd0aChjb25zdCB1
aW50OF90ICpjZGIpCit7CisgICAgdW5zaWduZWQgaW50IGNkYl9sZW47CisKKyAgICBzd2l0Y2gg
KGNkYlswXSA+PiA1KSB7CisgICAgY2FzZSAwOgorICAgICAgICBjZGJfbGVuID0gNjsKKyAgICAg
ICAgYnJlYWs7CisgICAgY2FzZSAxOgorICAgIGNhc2UgMjoKKyAgICAgICAgY2RiX2xlbiA9IDEw
OworICAgICAgICBicmVhazsKKyAgICBjYXNlIDQ6CisgICAgICAgIGNkYl9sZW4gPSAxNjsKKyAg
ICAgICAgYnJlYWs7CisgICAgY2FzZSA1OgorICAgICAgICBjZGJfbGVuID0gMTI7CisgICAgICAg
IGJyZWFrOworICAgIGRlZmF1bHQ6CisgICAgICAgIGNkYl9sZW4gPSAwOworICAgIH0KKyAgICBy
ZXR1cm4gY2RiX2xlbjsKK30KKworc3RhdGljIHVpbnQ2NF90IHNjc2lfY2RiX2xiYShjb25zdCB1
aW50OF90ICpjZGIsIGludCBjZGJfbGVuKQoreworICAgIHVpbnQ2NF90IGxiYTsKKworICAgIHN3
aXRjaCAoY2RiX2xlbikgeworICAgIGNhc2UgNjoKKyAgICAgICAgbGJhID0gKCgodWludDY0X3Qp
KGNkYlsxXSAmIDB4MWYpKSA8PCAxNikgfAorICAgICAgICAgICAgICAoKCh1aW50NjRfdCljZGJb
Ml0pIDw8IDgpIHwKKyAgICAgICAgICAgICAgICgodWludDY0X3QpY2RiWzNdKTsKKyAgICAgICAg
YnJlYWs7CisgICAgY2FzZSAxMDoKKyAgICBjYXNlIDEyOgorICAgICAgICBsYmEgPSAoKCh1aW50
NjRfdCljZGJbMl0pIDw8IDI0KSB8CisgICAgICAgICAgICAgICgoKHVpbnQ2NF90KWNkYlszXSkg
PDwgMTYpIHwKKyAgICAgICAgICAgICAgKCgodWludDY0X3QpY2RiWzRdKSA8PCA4KSAgfAorICAg
ICAgICAgICAgICAgKCh1aW50NjRfdCljZGJbNV0pOworICAgICAgICBicmVhazsKKyAgICBjYXNl
IDE2OgorICAgICAgICBsYmEgPSAoKCh1aW50NjRfdCljZGJbMl0pIDw8IDU2KSB8CisgICAgICAg
ICAgICAgICgoKHVpbnQ2NF90KWNkYlszXSkgPDwgNDgpIHwKKyAgICAgICAgICAgICAgKCgodWlu
dDY0X3QpY2RiWzRdKSA8PCA0MCkgfAorICAgICAgICAgICAgICAoKCh1aW50NjRfdCljZGJbNV0p
IDw8IDMyKSB8CisgICAgICAgICAgICAgICgoKHVpbnQ2NF90KWNkYls2XSkgPDwgMjQpIHwKKyAg
ICAgICAgICAgICAgKCgodWludDY0X3QpY2RiWzddKSA8PCAxNikgfAorICAgICAgICAgICAgICAo
KCh1aW50NjRfdCljZGJbOF0pIDw8IDgpICB8CisgICAgICAgICAgICAgICAoKHVpbnQ2NF90KWNk
Yls5XSk7CisgICAgICAgIGJyZWFrOworICAgIGRlZmF1bHQ6CisgICAgICAgIGxiYSA9IDA7Cisg
ICAgfQorICAgIHJldHVybiBsYmE7Cit9CisKK3N0YXRpYyB1aW50MzJfdCBzY3NpX2NkYl94ZmVy
X2xlbmd0aChjb25zdCB1aW50OF90ICpjZGIsIGludCBjZGJfbGVuKQoreworICAgIHVpbnQzMl90
IGxlbjsKKworICAgIHN3aXRjaCAoY2RiX2xlbikgeworICAgIGNhc2UgNjoKKyAgICAgICAgbGVu
ID0gKHVpbnQzMl90KWNkYls0XTsKKyAgICAgICAgaWYgKGxlbiA9PSAwKQorICAgICAgICAgICAg
bGVuID0gMjU2OworICAgICAgICBicmVhazsKKyAgICBjYXNlIDEwOgorICAgICAgICBsZW4gPSAo
KCh1aW50MzJfdCljZGJbN10pIDw8IDgpIHwKKyAgICAgICAgICAgICAgICgodWludDMyX3QpY2Ri
WzhdKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSAxMjoKKyAgICAgICAgbGVuID0gKCgodWlu
dDMyX3QpY2RiWzZdKSA8PCAyNCkgfAorICAgICAgICAgICAgICAoKCh1aW50MzJfdCljZGJbN10p
IDw8IDE2KSB8CisgICAgICAgICAgICAgICgoKHVpbnQzMl90KWNkYls4XSkgPDwgOCkgIHwKKyAg
ICAgICAgICAgICAgICgodWludDMyX3QpY2RiWzldKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2Fz
ZSAxNjoKKyAgICAgICAgbGVuID0gKCgodWludDMyX3QpY2RiWzEwXSkgPDwgMjQpIHwKKyAgICAg
ICAgICAgICAgKCgodWludDMyX3QpY2RiWzExXSkgPDwgMTYpIHwKKyAgICAgICAgICAgICAgKCgo
dWludDMyX3QpY2RiWzEyXSkgPDwgOCkgIHwKKyAgICAgICAgICAgICAgICgodWludDMyX3QpY2Ri
WzEzXSk7CisgICAgICAgIGJyZWFrOworICAgIGRlZmF1bHQ6CisgICAgICAgIGxlbiA9IDA7Cisg
ICAgICAgIGJyZWFrOworICAgIH0KKyAgICByZXR1cm4gbGVuOworfQorCisvKiBTQ1NJIGNvbW1h
bmRzICovCisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX3Rlc3RfdW5pdF9yZWFkeShDZFNjc2lM
VSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgcmVxLT54ZmVyX2RpciA9IFNDU0lf
WEZFUl9OT05FOworICAgIHJlcS0+aW5fbGVuID0gMDsKKworICAgIGlmIChkZXYtPmxvYWRlZCkg
eworICAgICAgICBpZiAoZGV2LT5wb3dlcl9jb25kICE9IENEX1NDU0lfUE9XRVJfU1RPUFBFRCkg
eworICAgICAgICAgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfZ29vZChkZXYsIHJlcSk7CisgICAg
ICAgIH0gZWxzZSB7CisgICAgICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25k
KGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTklUX0NNRF9SRVFVSVJFRCk7CisgICAgICAgIH0KKyAg
ICB9IGVsc2UgeworICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwg
cmVxLCAmc2Vuc2VfY29kZV9OT1RfUkVBRFlfTk9fTUVESVVNKTsKKyAgICB9Cit9CisKK3N0YXRp
YyB2b2lkIGNkX3Njc2lfY21kX3JlcXVlc3Rfc2Vuc2UoQ2RTY3NpTFUgKmRldiwgQ2RTY3NpUmVx
dWVzdCAqcmVxKQoreworICAgIHJlcS0+eGZlcl9kaXIgPSBTQ1NJX1hGRVJfRlJPTV9ERVY7CisK
KyAgICByZXEtPnJlcV9sZW4gPSByZXEtPmNkYls0XTsKKyAgICByZXEtPmluX2xlbiA9IE1JTihy
ZXEtPnJlcV9sZW4sIHNpemVvZihkZXYtPmZpeGVkX3NlbnNlKSk7CisKKyAgICBpZiAoZGV2LT5z
aG9ydF9zZW5zZS5rZXkgIT0gTk9fU0VOU0UpIHsKKyAgICAgICAgU1BJQ0VfREVCVUcoIiVzLCBs
dW46JXUgcmVwb3J0ZWQgc2Vuc2U6IDB4JTAyeCAlMDJ4ICUwMnggLSAlcywgJXMiLAorICAgICAg
ICAgICAgICAgICAgICBfX0ZVTkNUSU9OX18sIHJlcS0+bHVuLAorICAgICAgICAgICAgICAgICAg
ICBkZXYtPnNob3J0X3NlbnNlLmtleSwgZGV2LT5zaG9ydF9zZW5zZS5hc2MsIGRldi0+c2hvcnRf
c2Vuc2UuYXNjcSwKKyAgICAgICAgICAgICAgICAgICAgY2Rfc2NzaV9zZW5zZV9rZXlfZGVzY3Io
ZGV2LT5zaG9ydF9zZW5zZS5rZXkpLAorICAgICAgICAgICAgICAgICAgICBkZXYtPnNob3J0X3Nl
bnNlLmRlc2NyKTsKKyAgICB9CisgICAgbWVtY3B5KHJlcS0+YnVmLCBkZXYtPmZpeGVkX3NlbnNl
LCBzaXplb2YoZGV2LT5maXhlZF9zZW5zZSkpOworICAgIGNkX3Njc2lfZGV2X3NlbnNlX3Jlc2V0
KGRldik7IC8qIGNsZWFyIHJlcG9ydGVkIHNlbnNlICovCisKKyAgICBjZF9zY3NpX2NtZF9jb21w
bGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRfcmVwb3J0
X2x1bnMoQ2RTY3NpVGFyZ2V0ICpzdCwgQ2RTY3NpTFUgKmRldiwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICB1aW50OF90ICpv
dXRfYnVmID0gcmVxLT5idWY7CisgICAgdWludDMyX3QgbWF4X2x1bnMgPSBzdC0+bWF4X2x1bnM7
CisgICAgdWludDMyX3QgYnVmbGVuID0gODsgLyogaGVhZGVyIGxlbmd0aCAqLworICAgIHVpbnQz
Ml90IGx1bjsKKworICAgIHJlcS0+cmVxX2xlbiA9IHNjc2lfY2RiX3hmZXJfbGVuZ3RoKHJlcS0+
Y2RiLCAxMik7CisgICAgcmVxLT54ZmVyX2RpciA9IFNDU0lfWEZFUl9GUk9NX0RFVjsKKworICAg
IC8qIGNoZWNrIFNFTEVDVCBSRVBPUlQgZmllbGQgKi8KKyAgICBpZiAocmVxLT5jZGJbMl0gPT0g
MHgwMSkgeworICAgICAgICAvKiBvbmx5IHdlbGwga25vd24gbG9naWNhbCB1bml0cyAqLworICAg
ICAgICBtYXhfbHVucyA9IDA7CisgICAgfQorCisgICAgbWVtc2V0KG91dF9idWYsIDAsIDgpOwor
CisgICAgZm9yIChsdW4gPSAwOyBsdW4gPCBtYXhfbHVuczsgbHVuKyspIHsKKyAgICAgICAgaWYg
KHN0LT51bml0c1tsdW5dLnJlYWxpemVkKSB7CisgICAgICAgICAgICBvdXRfYnVmW2J1Zmxlbisr
XSA9IDA7CisgICAgICAgICAgICBvdXRfYnVmW2J1ZmxlbisrXSA9ICh1aW50OF90KShsdW4pOwor
ICAgICAgICAgICAgbWVtc2V0KCZvdXRfYnVmW2J1Zmxlbl0sIDAsIDYpOworICAgICAgICAgICAg
YnVmbGVuICs9IDY7CisgICAgICAgIH0KKyAgICB9CisKKyAgICAvKiBmaWxsIExVTiBMSVNUIExF
TkdUSCAqLworICAgIG91dF9idWZbMF0gPSAodWludDhfdCkoKGJ1Zmxlbi04KSA+PiAyNCk7Cisg
ICAgb3V0X2J1ZlsxXSA9ICh1aW50OF90KSgoYnVmbGVuLTgpID4+IDE2KTsKKyAgICBvdXRfYnVm
WzJdID0gKHVpbnQ4X3QpKChidWZsZW4tOCkgPj4gOCk7CisgICAgb3V0X2J1ZlszXSA9ICh1aW50
OF90KSgoYnVmbGVuLTgpKTsKKworICAgIHJlcS0+aW5fbGVuID0gYnVmbGVuOworICAgIGNkX3Nj
c2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2LCByZXEpOworfQorCisjZGVmaW5lIFNDU0lfTUFYX0lO
UVVJUllfTEVOICAgICAgICAyNTYKKyNkZWZpbmUgU0NTSV9NQVhfTU9ERV9MRU4gICAgICAgICAg
IDI1NgorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9pbnF1aXJ5X3ZwZF9ub19sdW4oQ2RTY3Np
TFUgKmRldiwgQ2RTY3NpUmVxdWVzdCAqcmVxLAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHVpbnQzMl90IHBlcmlmX3F1YWwpCit7CisgICAgdWludDhfdCAqb3V0
YnVmID0gcmVxLT5idWY7CisgICAgdWludDhfdCBwYWdlX2NvZGUgPSByZXEtPmNkYlsyXTsKKyAg
ICB1aW50MzJfdCByZXNwX2xlbiA9IDQ7CisKKyAgICBvdXRidWZbMF0gPSAocGVyaWZfcXVhbCA8
PCA1KSB8IFRZUEVfUk9NOworICAgIG91dGJ1ZlsxXSA9IHBhZ2VfY29kZSA7IC8qIHRoaXMgcGFn
ZSAqLworICAgIG91dGJ1ZlsyXSA9IDB4MDA7IC8qIHBhZ2UgbGVuZ3RoIE1TQiAqLworICAgIG91
dGJ1ZlszXSA9IDB4MDA7IC8qIHBhZ2UgbGVuZ3RoIExTQiAtIG5vIG1vcmUgZGF0YSAqLworCisg
ICAgcmVxLT5pbl9sZW4gPSBNSU4ocmVxLT5yZXFfbGVuLCByZXNwX2xlbik7CisKKyAgICBTUElD
RV9ERUJVRygiaW5xdWlyeV92cGQsIHVuc3VwcG9ydGVkIGx1bjoldSIKKyAgICAgICAgICAgICAg
ICAiIHBlcmlmX3F1YWw6MHgleCByZXNwX2xlbjogJSIgR19HVUlOVDY0X0ZPUk1BVCwKKyAgICAg
ICAgICAgICAgICByZXEtPmx1biwgcGVyaWZfcXVhbCwgcmVxLT5pbl9sZW4pOworCisgICAgY2Rf
c2NzaV9jbWRfY29tcGxldGVfZ29vZChkZXYsIHJlcSk7Cit9CisKK3N0YXRpYyB2b2lkIGNkX3Nj
c2lfY21kX2lucXVpcnlfdnBkKENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sK
KyAgICB1aW50OF90ICpvdXRidWYgPSByZXEtPmJ1ZjsKKyAgICB1aW50OF90IHBhZ2VfY29kZSA9
IHJlcS0+Y2RiWzJdOworICAgIGludCBidWZsZW4gPSA0OworICAgIGludCBzdGFydCA9IDQ7CisK
KyAgICBvdXRidWZbMF0gPSBUWVBFX1JPTTsKKyAgICBvdXRidWZbMV0gPSBwYWdlX2NvZGUgOyAv
KiB0aGlzIHBhZ2UgKi8KKyAgICBvdXRidWZbMl0gPSAweDAwOyAvKiBwYWdlIGxlbmd0aCBNU0Ig
Ki8KKyAgICBvdXRidWZbM10gPSAweDAwOyAvKiBwYWdlIGxlbmd0aCBMU0IsIHRvIHdyaXRlIGxh
dGVyICovCisKKyAgICBzd2l0Y2ggKHBhZ2VfY29kZSkgeworICAgIGNhc2UgMHgwMDogLyogU3Vw
cG9ydGVkIHBhZ2UgY29kZXMsIG1hbmRhdG9yeSAqLworICAgIHsKKyAgICAgICAgb3V0YnVmW2J1
ZmxlbisrXSA9IDB4MDA7IC8vIGxpc3Qgb2Ygc3VwcG9ydGVkIHBhZ2VzICh0aGlzIHBhZ2UpCisg
ICAgICAgIGlmIChkZXYtPnNlcmlhbCkgeworICAgICAgICAgICAgb3V0YnVmW2J1ZmxlbisrXSA9
IDB4ODA7IC8vIHVuaXQgc2VyaWFsIG51bWJlcgorICAgICAgICB9CisgICAgICAgIG91dGJ1Zlti
dWZsZW4rK10gPSAweDgzOyAvLyBkZXZpY2UgaWRlbnRpZmljYXRpb24KKworICAgICAgICBTUElD
RV9ERUJVRygiSW5xdWlyeSBFVlBEW1N1cHBvcnRlZCBwYWdlc10gbHVuOiV1IgorICAgICAgICAg
ICAgICAgICAgICAiIHJlcV9sZW46ICUiIEdfR1VJTlQ2NF9GT1JNQVQgIiByZXNwX2xlbjogJWQi
LAorICAgICAgICAgICAgICAgICAgICByZXEtPmx1biwgcmVxLT5yZXFfbGVuLCBidWZsZW4pOwor
ICAgICAgICBicmVhazsKKyAgICB9CisgICAgY2FzZSAweDgwOiAvKiBEZXZpY2Ugc2VyaWFsIG51
bWJlciwgb3B0aW9uYWwgKi8KKyAgICB7CisgICAgICAgIGludCBzZXJpYWxfbGVuOworCisgICAg
ICAgIHNlcmlhbF9sZW4gPSBzdHJsZW4oZGV2LT5zZXJpYWwpOworICAgICAgICBpZiAoc2VyaWFs
X2xlbiA+IDM2KSB7CisgICAgICAgICAgICBzZXJpYWxfbGVuID0gMzY7CisgICAgICAgIH0KKyAg
ICAgICAgbWVtY3B5KG91dGJ1ZitidWZsZW4sIGRldi0+c2VyaWFsLCBzZXJpYWxfbGVuKTsKKyAg
ICAgICAgYnVmbGVuICs9IHNlcmlhbF9sZW47CisKKyAgICAgICAgU1BJQ0VfREVCVUcoIklucXVp
cnkgRVZQRFtTZXJpYWwgbnVtXSBsdW46JXUiCisgICAgICAgICAgICAgICAgICAgICIgcmVxX2xl
bjogJSIgR19HVUlOVDY0X0ZPUk1BVCAiIHJlc3BfbGVuOiAlZCIsCisgICAgICAgICAgICAgICAg
ICAgIHJlcS0+bHVuLCByZXEtPnJlcV9sZW4sIGJ1Zmxlbik7CisgICAgICAgIGJyZWFrOworICAg
IH0KKyAgICBjYXNlIDB4ODM6IC8qIERldmljZSBpZGVudGlmaWNhdGlvbiBwYWdlLCBtYW5kYXRv
cnkgKi8KKyAgICB7CisgICAgICAgIGludCBzZXJpYWxfbGVuID0gc3RybGVuKGRldi0+c2VyaWFs
KTsKKyAgICAgICAgaW50IG1heF9sZW4gPSAyMDsKKworICAgICAgICBpZiAoc2VyaWFsX2xlbiA+
IG1heF9sZW4pIHsKKyAgICAgICAgICAgIHNlcmlhbF9sZW4gPSBtYXhfbGVuOworICAgICAgICB9
CisKKyAgICAgICAgb3V0YnVmW2J1ZmxlbisrXSA9IDB4MjsgLy8gQVNDSUkKKyAgICAgICAgb3V0
YnVmW2J1ZmxlbisrXSA9IDA7ICAgLy8gbm90IG9mZmljaWFsbHkgYXNzaWduZWQKKyAgICAgICAg
b3V0YnVmW2J1ZmxlbisrXSA9IDA7ICAgLy8gcmVzZXJ2ZWQKKyAgICAgICAgb3V0YnVmW2J1Zmxl
bisrXSA9IHNlcmlhbF9sZW47IC8vIGxlbmd0aCBvZiBkYXRhIGZvbGxvd2luZworCisgICAgICAg
IG1lbWNweShvdXRidWYrYnVmbGVuLCBkZXYtPnNlcmlhbCwgc2VyaWFsX2xlbik7CisgICAgICAg
IGJ1ZmxlbiArPSBzZXJpYWxfbGVuOworCisgICAgICAgIFNQSUNFX0RFQlVHKCJJbnF1aXJ5IEVW
UERbRGV2aWNlIGlkXSBsdW46JXUiCisgICAgICAgICAgICAgICAgICAgICIgcmVxX2xlbjogJSIg
R19HVUlOVDY0X0ZPUk1BVCAiIHJlc3BfbGVuOiAlZCIsCisgICAgICAgICAgICAgICAgICAgIHJl
cS0+bHVuLCByZXEtPnJlcV9sZW4sIGJ1Zmxlbik7CisgICAgICAgIGJyZWFrOworICAgIH0KKwor
ICAgIGRlZmF1bHQ6CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2
LCByZXEsICZzZW5zZV9jb2RlX0lOVkFMSURfQ0RCX0ZJRUxEKTsKKyAgICAgICAgU1BJQ0VfREVC
VUcoImlucXVpcnlfc3RhbmRhcmQsIGx1bjoldSBpbnZhbGlkIHBhZ2VfY29kZTogJTAyeCIsCisg
ICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuLCAoaW50KXBhZ2VfY29kZSk7CisgICAgICAgIHJl
dHVybjsKKyAgICB9CisKKyAgICAvKiBkb25lIHdpdGggRVZQRCAqLworICAgIGdfYXNzZXJ0KGJ1
ZmxlbiAtIHN0YXJ0IDw9IDI1NSk7CisgICAgb3V0YnVmWzNdID0gYnVmbGVuIC0gc3RhcnQ7IC8q
IHBhZ2UgbGVuZ3RoIExTQiAqLworCisgICAgcmVxLT5pbl9sZW4gPSBidWZsZW47CisgICAgY2Rf
c2NzaV9jbWRfY29tcGxldGVfZ29vZChkZXYsIHJlcSk7Cit9CisKKyNkZWZpbmUgSU5RVUlSWV9T
VEFOREFSRF9MRU5fTUlOICAgICAgICAgICAgMzYKKyNkZWZpbmUgSU5RVUlSWV9TVEFOREFSRF9M
RU4gICAgICAgICAgICAgICAgOTYKKyNkZWZpbmUgSU5RVUlSWV9TVEFOREFSRF9MRU5fTk9fVkVS
ICAgICAgICAgNTcKKworI2RlZmluZSBQRVJJRl9RVUFMSUZJRVJfQ09OTkVDVEVEICAgICAgICAg
ICAweDAwCisjZGVmaW5lIFBFUklGX1FVQUxJRklFUl9OT1RfQ09OTkVDVEVEICAgICAgIDB4MDEK
KyNkZWZpbmUgUEVSSUZfUVVBTElGSUVSX1VOU1VQUE9SVEVEICAgICAgICAgMHgwMworCisjZGVm
aW5lIElOUVVJUllfUkVNT1ZBQkxFX01FRElVTSAgICAgICAgICAgIDB4ODAKKworI2RlZmluZSBJ
TlFVSVJZX1ZFUlNJT05fTk9ORSAgICAgICAgICAgICAgICAweDAwCisjZGVmaW5lIElOUVVJUllf
VkVSU0lPTl9TUEMzICAgICAgICAgICAgICAgIDB4MDUKKworLyogYnl0ZSAzICovCisjZGVmaW5l
IElOUVVJUllfUkVTUF9ISVNVUCAgICAgICAgICAgICAgICAgICgweDAxIDw8IDQpCisjZGVmaW5l
IElOUVVJUllfUkVTUF9OT1JNX0FDQSAgICAgICAgICAgICAgICgweDAxIDw8IDUpCisjZGVmaW5l
IElOUVVJUllfUkVTUF9EQVRBX0ZPUk1BVF9TUEMzICAgICAgIDB4MDIKKworI2RlZmluZSBJTlFV
SVJZX1ZFUlNJT05fREVTQ19TQU0yICAgICAgICAgICAweDA0MAorI2RlZmluZSBJTlFVSVJZX1ZF
UlNJT05fREVTQ19TUEMzICAgICAgICAgICAweDMwMAorI2RlZmluZSBJTlFVSVJZX1ZFUlNJT05f
REVTQ19NTUMzICAgICAgICAgICAweDJBMAorI2RlZmluZSBJTlFVSVJZX1ZFUlNJT05fREVTQ19T
QkMyICAgICAgICAgICAweDMyMAorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9pbnF1aXJ5X3N0
YW5kYXJkX25vX2x1bihDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEsCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCBwZXJpZl9x
dWFsKQoreworICAgIHVpbnQ4X3QgKm91dGJ1ZiA9IHJlcS0+YnVmOworICAgIHVpbnQzMl90IHJl
c3BfbGVuID0gSU5RVUlSWV9TVEFOREFSRF9MRU5fTUlOOworCisgICAgbWVtc2V0KHJlcS0+YnVm
LCAwLCBJTlFVSVJZX1NUQU5EQVJEX0xFTl9NSU4pOworCisgICAgb3V0YnVmWzBdID0gKHBlcmlm
X3F1YWwgPDwgNSkgfCBUWVBFX1JPTTsKKyAgICBvdXRidWZbMl0gPSBJTlFVSVJZX1ZFUlNJT05f
Tk9ORTsKKyAgICBvdXRidWZbM10gPSBJTlFVSVJZX1JFU1BfREFUQV9GT1JNQVRfU1BDMzsKKwor
ICAgIG91dGJ1Zls0XSA9IHJlc3BfbGVuIC0gNDsgLyogYWRkaXRpb25hbCBsZW5ndGgsIGFmdGVy
IGhlYWRlciAqLworCisgICAgcmVxLT5pbl9sZW4gPSBNSU4ocmVxLT5yZXFfbGVuLCByZXNwX2xl
bik7CisKKyAgICBTUElDRV9ERUJVRygiaW5xdWlyeV9zdGFuZGFyZCwgdW5zdXBwb3J0ZWQgbHVu
OiV1IHBlcmlmX3F1YWw6MHgleCAiCisgICAgICAgICAgICAgICAgImlucXVpcnlfbGVuOiAldSBy
ZXNwX2xlbjogJSIgR19HVUlOVDY0X0ZPUk1BVCwKKyAgICAgICAgICAgICAgICByZXEtPmx1biwg
cGVyaWZfcXVhbCwgcmVzcF9sZW4sIHJlcS0+aW5fbGVuKTsKKworICAgIGNkX3Njc2lfY21kX2Nv
bXBsZXRlX2dvb2QoZGV2LCByZXEpOworfQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9pbnF1
aXJ5X3N0YW5kYXJkKENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICB1
aW50OF90ICpvdXRidWYgPSByZXEtPmJ1ZjsKKyAgICB1aW50MzJfdCByZXNwX2xlbiA9CisgICAg
ICAgIChkZXYtPmNsYWltX3ZlcnNpb24gPT0gMCkgPyBJTlFVSVJZX1NUQU5EQVJEX0xFTl9OT19W
RVIgOiBJTlFVSVJZX1NUQU5EQVJEX0xFTjsKKworICAgIG91dGJ1ZlswXSA9IChQRVJJRl9RVUFM
SUZJRVJfQ09OTkVDVEVEIDw8IDUpIHwgVFlQRV9ST007CisgICAgb3V0YnVmWzFdID0gKGRldi0+
cmVtb3ZhYmxlKSA/IElOUVVJUllfUkVNT1ZBQkxFX01FRElVTSA6IDA7CisgICAgb3V0YnVmWzJd
ID0gKGRldi0+Y2xhaW1fdmVyc2lvbiA9PSAwKSA/IElOUVVJUllfVkVSU0lPTl9OT05FIDogSU5R
VUlSWV9WRVJTSU9OX1NQQzM7CisgICAgb3V0YnVmWzNdID0gSU5RVUlSWV9SRVNQX05PUk1fQUNB
IHwgSU5RVUlSWV9SRVNQX0hJU1VQIHwgSU5RVUlSWV9SRVNQX0RBVEFfRk9STUFUX1NQQzM7CisK
KyAgICBvdXRidWZbNF0gPSByZXNwX2xlbiAtIDQ7IC8qIGFkZGl0aW9uYWwgbGVuZ3RoLCBhZnRl
ciBoZWFkZXIgKi8KKworICAgIC8qIChvdXRidWZbNiw3XSA9IDApIG1lYW5zIGFsc28ge0JRdWU9
MCxDbWRRdWU9MH0gLSBubyBxdWV1ZWluZyBhdCBhbGwgKi8KKworICAgIHN0cnBhZGNweSgoY2hh
ciAqKSAmb3V0YnVmWzhdLCA4LCBkZXYtPnZlbmRvciwgJyAnKTsKKyAgICBzdHJwYWRjcHkoKGNo
YXIgKikgJm91dGJ1ZlsxNl0sIDE2LCBkZXYtPnByb2R1Y3QsICcgJyk7CisgICAgbWVtY3B5KCZv
dXRidWZbMzJdLCBkZXYtPnZlcnNpb24sIE1JTig0LCBzdHJsZW4oZGV2LT52ZXJzaW9uKSkpOwor
CisgICAgaWYgKGRldi0+Y2xhaW1fdmVyc2lvbiA+IDApIHsKKyAgICAgICAgLyogbm93IHN1cHBv
cnRpbmcgb25seSAzICovCisgICAgICAgIG91dGJ1Zls1OF0gPSAoSU5RVUlSWV9WRVJTSU9OX0RF
U0NfU0FNMiA+PiA4KSAmIDB4ZmY7CisgICAgICAgIG91dGJ1Zls1OV0gPSBJTlFVSVJZX1ZFUlNJ
T05fREVTQ19TQU0yICYgMHhmZjsKKworICAgICAgICBvdXRidWZbNjBdID0gKElOUVVJUllfVkVS
U0lPTl9ERVNDX1NQQzMgPj4gOCkgJiAweGZmOworICAgICAgICBvdXRidWZbNjFdID0gSU5RVUlS
WV9WRVJTSU9OX0RFU0NfU1BDMyAmIDB4ZmY7CisKKyAgICAgICAgb3V0YnVmWzYyXSA9IChJTlFV
SVJZX1ZFUlNJT05fREVTQ19NTUMzID4+IDgpICYgMHhmZjsKKyAgICAgICAgb3V0YnVmWzYzXSA9
IElOUVVJUllfVkVSU0lPTl9ERVNDX01NQzMgJiAweGZmOworCisgICAgICAgIG91dGJ1Zls2NF0g
PSAoSU5RVUlSWV9WRVJTSU9OX0RFU0NfU0JDMiA+PiA4KSAmIDB4ZmY7CisgICAgICAgIG91dGJ1
Zls2NV0gPSBJTlFVSVJZX1ZFUlNJT05fREVTQ19TQkMyICYgMHhmZjsKKyAgICB9CisKKyAgICBy
ZXEtPmluX2xlbiA9IE1JTihyZXEtPnJlcV9sZW4sIHJlc3BfbGVuKTsKKworICAgIFNQSUNFX0RF
QlVHKCJpbnF1aXJ5X3N0YW5kYXJkLCBsdW46JXUiCisgICAgICAgICAgICAgICAgIiBpbnF1aXJ5
X2xlbjogJXUgcmVzcF9sZW46ICUiIEdfR1VJTlQ2NF9GT1JNQVQsCisgICAgICAgICAgICAgICAg
cmVxLT5sdW4sIHJlc3BfbGVuLCByZXEtPmluX2xlbik7CisKKyAgICBjZF9zY3NpX2NtZF9jb21w
bGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworI2RlZmluZSBDRF9JTlFVSVJZX0ZMQUdfRVZQRCAg
ICAgICAgICAgICAgICAweDAxCisjZGVmaW5lIENEX0lOUVVJUllfRkxBR19DTURfRFQgICAgICAg
ICAgICAgIDB4MDIKKworc3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRfaW5xdWlyeShDZFNjc2lMVSAq
ZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgZ2Jvb2xlYW4gZXZwZCwgY21kX2RhdGE7
CisKKyAgICByZXEtPnhmZXJfZGlyID0gU0NTSV9YRkVSX0ZST01fREVWOworCisgICAgZXZwZCA9
IChyZXEtPmNkYlsxXSAmIENEX0lOUVVJUllfRkxBR19FVlBEKSA/IFRSVUUgOiBGQUxTRTsKKyAg
ICBjbWRfZGF0YSA9IChyZXEtPmNkYlsxXSAmIENEX0lOUVVJUllfRkxBR19DTURfRFQpID8gVFJV
RSA6IEZBTFNFOworCisgICAgaWYgKGNtZF9kYXRhKSB7CisgICAgICAgIFNQSUNFX0RFQlVHKCJp
bnF1aXJ5LCBsdW46JXUgQ21kRFQgYml0IHNldCAtIHVuc3VwcG9ydGVkLCAiCisgICAgICAgICAg
ICAgICAgICAgICJjZGJbMV06MHglMDJ4IGNkYlsxXToweCUwMngiLAorICAgICAgICAgICAgICAg
ICAgICByZXEtPmx1biwgKGludClyZXEtPmNkYlsxXSwgKGludClyZXEtPmNkYlsyXSk7CisgICAg
ICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2Rl
X0lOVkFMSURfQ0RCX0ZJRUxEKTsKKyAgICAgICAgcmV0dXJuOworICAgIH0KKworICAgIHJlcS0+
cmVxX2xlbiA9IHJlcS0+Y2RiWzRdIHwgKHJlcS0+Y2RiWzNdIDw8IDgpOworICAgIG1lbXNldChy
ZXEtPmJ1ZiwgMCwgcmVxLT5yZXFfbGVuKTsKKworICAgIGlmIChldnBkKSB7IC8qIGVuYWJsZSB2
aXRhbCBwcm9kdWN0IGRhdGEgKi8KKyAgICAgICAgY2Rfc2NzaV9jbWRfaW5xdWlyeV92cGQoZGV2
LCByZXEpOworICAgIH0gZWxzZSB7IC8qIHN0YW5kYXJkIGlucXVpcnkgZGF0YSAqLworICAgICAg
ICBpZiAocmVxLT5jZGJbMl0gIT0gMCkgeworICAgICAgICAgICAgU1BJQ0VfREVCVUcoImlucXVp
cnlfc3RhbmRhcmQsIGx1bjoldSBub24temVybyBwYWdlIGNvZGU6ICUwMngiLAorICAgICAgICAg
ICAgICAgICAgICAgICAgcmVxLT5sdW4sIChpbnQpcmVxLT5jZGJbMl0pOworICAgICAgICAgICAg
Y2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfSU5W
QUxJRF9DREJfRklFTEQpOworICAgICAgICAgICAgcmV0dXJuOworICAgICAgICB9CisgICAgICAg
IGNkX3Njc2lfY21kX2lucXVpcnlfc3RhbmRhcmQoZGV2LCByZXEpOworICAgIH0KK30KKworc3Rh
dGljIHZvaWQgY2Rfc2NzaV9jbWRfcmVhZF9jYXBhY2l0eShDZFNjc2lMVSAqZGV2LCBDZFNjc2lS
ZXF1ZXN0ICpyZXEpCit7CisgICAgdWludDMyX3QgbGFzdF9ibGsgPSBkZXYtPm51bV9ibG9ja3Mg
LSAxOworICAgIHVpbnQzMl90IGJsa19zaXplID0gZGV2LT5ibG9ja19zaXplOworICAgIHVpbnQz
Ml90ICpsYXN0X2Jsa19vdXQgPSAodWludDMyX3QgKilyZXEtPmJ1ZjsKKyAgICB1aW50MzJfdCAq
YmxrX3NpemVfb3V0ID0gKHVpbnQzMl90ICopKHJlcS0+YnVmICsgNCk7CisKKyAgICByZXEtPnhm
ZXJfZGlyID0gU0NTSV9YRkVSX0ZST01fREVWOworICAgIHJlcS0+cmVxX2xlbiA9IDg7CisKKyAg
ICAqbGFzdF9ibGtfb3V0ID0gaHRvYmUzMihsYXN0X2Jsayk7CisgICAgKmJsa19zaXplX291dCA9
IGh0b2JlMzIoYmxrX3NpemUpOworCisgICAgU1BJQ0VfREVCVUcoIlJlYWQgY2FwYWNpdHksIGx1
bjoldSBsYXN0X2JsazogJXUgYmxrX3N6OiAldSIsCisgICAgICAgICAgICAgICAgcmVxLT5sdW4s
IGxhc3RfYmxrLCBibGtfc2l6ZSk7CisKKyAgICByZXEtPmluX2xlbiA9IDg7CisgICAgY2Rfc2Nz
aV9jbWRfY29tcGxldGVfZ29vZChkZXYsIHJlcSk7Cit9CisKKyNkZWZpbmUgUkRJX1RZUEVfU1RB
TkRBUkQgICAgICAgICAgIDAgLyogU3RhbmRhcmQgRGlzYyBJbmZvcm1hdGlvbiAqLworI2RlZmlu
ZSBSRElfVFlQRV9UUkFDS19SRVNPVVJDRVMgICAgMSAvKiBUcmFjayBSZXNvdXJjZXMgSW5mb3Jt
YXRpb24gKi8KKyNkZWZpbmUgUkRJX1RZUEVfUE9XX1JFU09VUkNFUyAgICAgIDIgLyogUE9XIFJl
c291cmNlcyBJbmZvcm1hdGlvbiAqLworCisjZGVmaW5lIFJESV9TVEFOREFSRF9MRU4gICAgICAg
ICAgICAzNAorCisjZGVmaW5lIFJESV9FUkFaQUJMRSAgICAgICAgICAgICAgICAoMHgwMSA8PCA0
KQorI2RlZmluZSBSRElfTk9OX0VSQVpBQkxFICAgICAgICAgICAgKDB4MDAgPDwgNCkKKworI2Rl
ZmluZSBSRElfU0VTU0lPTl9FTVBUWSAgICAgICAgICAgKDB4MDAgPDwgMikKKyNkZWZpbmUgUkRJ
X1NFU1NJT05fSU5DT01QTEVURSAgICAgICgweDAxIDw8IDIpCisjZGVmaW5lIFJESV9TRVNTSU9O
X0RBTUFHRUQgICAgICAgICAoMHgwMiA8PCAyKQorI2RlZmluZSBSRElfU0VTU0lPTl9DT01QTEVU
RSAgICAgICAgKDB4MDMgPDwgMikKKworI2RlZmluZSBSRElfRElTQ19FTVBUWSAgICAgICAgICAg
ICAgMHgwMAorI2RlZmluZSBSRElfRElTQ19JTkNPTVBMRVRFICAgICAgICAgMHgwMQorI2RlZmlu
ZSBSRElfRElTQ19DT01QTEVURSAgICAgICAgICAgMHgwMgorI2RlZmluZSBSRElfRElTQ19SQU5E
T01fV1IgICAgICAgICAgMHgwMworCisjZGVmaW5lIFJESV9ESVNDX1BNQV9UWVBFX0NEX1JPTSAg
ICAweDAwCisjZGVmaW5lIFJESV9ESVNDX1BNQV9UWVBFX0NESSAgICAgICAweDEwCisjZGVmaW5l
IFJESV9ESVNDX1BNQV9UWVBFX0REQ0QgICAgICAweDIwCisjZGVmaW5lIFJESV9ESVNDX1BNQV9U
WVBFX1VOREVGSU5FRCAweEZGCisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX2dldF9yZWFkX2Rp
c2NfaW5mb3JtYXRpb24oQ2RTY3NpTFUgKmRldiwgQ2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAg
IHVpbnQ4X3QgKm91dGJ1ZiA9IHJlcS0+YnVmOworICAgIHVpbnQzMl90IGRhdGFfdHlwZTsKKyAg
ICB1aW50MzJfdCBmaXJzdF90cmFjayA9IDE7CisgICAgdWludDMyX3QgbGFzdF90cmFjayA9IDE7
CisgICAgdWludDMyX3QgbnVtX3Nlc3Npb25zID0gMTsKKworICAgIHJlcS0+eGZlcl9kaXIgPSBT
Q1NJX1hGRVJfRlJPTV9ERVY7CisKKyAgICBkYXRhX3R5cGUgPSByZXEtPmNkYlsxXSAmIDB4NzsK
KyAgICBpZiAoZGF0YV90eXBlICE9IFJESV9UWVBFX1NUQU5EQVJEKSB7CisgICAgICAgIFNQSUNF
X0RFQlVHKCJyZWFkX2Rpc2NfaW5mb3JtYXRpb24sIGx1bjoldSIKKyAgICAgICAgICAgICAgICAg
ICAgIiB1bnN1cHBvcnRlZCBkYXRhIHR5cGU6ICUwMngiLAorICAgICAgICAgICAgICAgICAgICBy
ZXEtPmx1biwgZGF0YV90eXBlKTsKKyAgICAgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tf
Y29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfSU5WQUxJRF9DREJfRklFTEQpOworICAgICAgICBy
ZXR1cm47CisgICAgfQorCisgICAgcmVxLT5yZXFfbGVuID0gKHJlcS0+Y2RiWzddIDw8IDgpIHwg
cmVxLT5jZGJbOF07CisgICAgcmVxLT5pbl9sZW4gPSBNSU4ocmVxLT5yZXFfbGVuLCBSRElfU1RB
TkRBUkRfTEVOKTsKKworICAgIG1lbXNldChvdXRidWYsIDAsIFJESV9TVEFOREFSRF9MRU4pOwor
ICAgIG91dGJ1ZlsxXSA9IFJESV9TVEFOREFSRF9MRU4gLSAyOyAvKiBsZW5ndGggZXhjbHVkaW5n
IHRoZSBjb3VudGVyIGl0c2VsZiAqLworICAgIG91dGJ1ZlsyXSA9IFJESV9OT05fRVJBWkFCTEUg
fCBSRElfU0VTU0lPTl9DT01QTEVURSB8IFJESV9ESVNDX0NPTVBMRVRFOworICAgIG91dGJ1Zlsz
XSA9IGZpcnN0X3RyYWNrOyAvKiBvbiBkaXNrICovCisgICAgb3V0YnVmWzRdID0gbnVtX3Nlc3Np
b25zICYgMHhmZjsgLyogbHNiICovCisgICAgb3V0YnVmWzVdID0gZmlyc3RfdHJhY2sgJiAweGZm
OyAvKiBpbiBsYXN0IHNlc3NvbiwgbHNiICovCisgICAgb3V0YnVmWzZdID0gbGFzdF90cmFjayAm
IDB4ZmY7IC8qIGluIGxhc3Qgc2Vzc29uLCBsc2IgKi8KKyAgICBvdXRidWZbOF0gPSBSRElfRElT
Q19QTUFfVFlQRV9DRF9ST007CisgICAgb3V0YnVmWzldID0gKG51bV9zZXNzaW9ucyA+PiA4KSAm
IDB4ZmY7IC8qIG1zYiAqLworICAgIG91dGJ1ZlsxMF0gPSAoZmlyc3RfdHJhY2sgPj4gOCkgJiAw
eGZmOyAvKiBpbiBsYXN0IHNlc3NvbiwgbHNiICovCisgICAgb3V0YnVmWzExXSA9IChsYXN0X3Ry
YWNrID4+IDgpICYgMHhmZjsgLyogaW4gbGFzdCBzZXNzb24sIGxzYiAqLworCisgICAgU1BJQ0Vf
REVCVUcoInJlYWRfZGlzY19pbmZvcm1hdGlvbiwgbHVuOiV1IGxlbjogJSIgR19HVUlOVDY0X0ZP
Uk1BVCwKKyAgICAgICAgICAgICAgICByZXEtPmx1biwgcmVxLT5pbl9sZW4pOworCisgICAgY2Rf
c2NzaV9jbWRfY29tcGxldGVfZ29vZChkZXYsIHJlcSk7Cit9CisKKyNkZWZpbmUgUlRJX0FERFJf
VFlQRV9MQkEgICAgICAgICAgIDB4MDAKKyNkZWZpbmUgUlRJX0FERFJfVFlQRV9UUkFDS19OVU0g
ICAgIDB4MDEKKyNkZWZpbmUgUlRJX0FERFJfVFlQRV9TRVNTSU9OX05VTSAgIDB4MDIKKworI2Rl
ZmluZSBSVElfVFJBQ0tfTlVNX0xFQURfSU4gICAgICAgMHgwMAorI2RlZmluZSBSVElfVFJBQ0tf
TlVNX0lOVklTSUJMRSAgICAgMHhmZgorCisjZGVmaW5lIFRJQl9MRU4gICAgICAgICAgICAgICAg
ICAgICAweDM2CisKKyNkZWZpbmUgVElCX1RSQUNLX01PREVfQ0QgICAgICAgICAgIDB4MDQKKyNk
ZWZpbmUgVElCX0RBVEFfTU9ERV9JU09fMTAxNDkgICAgIDB4MDEKKworI2RlZmluZSBUSUJfTFJB
X1ZBTElEICAgICAgICAgICAgICAgKDB4MDEgPDwgMSkKKworc3RhdGljIHZvaWQgY2Rfc2NzaV9j
bWRfZ2V0X3JlYWRfdHJhY2tfaW5mb3JtYXRpb24oQ2RTY3NpTFUgKmRldiwgQ2RTY3NpUmVxdWVz
dCAqcmVxKQoreworICAgIHVpbnQ4X3QgKm91dGJ1ZiA9IHJlcS0+YnVmOworICAgIHVpbnQzMl90
IHRyYWNrX3NpemUgPSBkZXYtPm51bV9ibG9ja3M7CisgICAgdWludDMyX3QgbGFzdF9hZGRyID0g
dHJhY2tfc2l6ZSAtIDE7CisgICAgdWludDMyX3QgdHJhY2tfbnVtID0gMTsKKyAgICB1aW50MzJf
dCBzZXNzaW9uX251bSA9IDE7CisgICAgdWludDMyX3QgYWRkcl90eXBlOworICAgIHVpbnQzMl90
IGFkZHJfbnVtOworCisgICAgcmVxLT54ZmVyX2RpciA9IFNDU0lfWEZFUl9GUk9NX0RFVjsKKwor
ICAgIGFkZHJfdHlwZSA9IHJlcS0+Y2RiWzFdICYgMHgzOworICAgIGFkZHJfbnVtID0gKHJlcS0+
Y2RiWzJdIDw8IDI0KSB8IChyZXEtPmNkYlszXSA8PCAxNikgfAorICAgICAgICAgICAgICAgKHJl
cS0+Y2RiWzRdIDw8IDgpIHwgcmVxLT5jZGJbNV07CisKKyAgICBzd2l0Y2ggKGFkZHJfdHlwZSkg
eworICAgIGNhc2UgUlRJX0FERFJfVFlQRV9MQkE6CisgICAgICAgIGlmIChhZGRyX251bSA+IGxh
c3RfYWRkcikgeworICAgICAgICAgICAgU1BJQ0VfREVCVUcoInJlYWRfdHJhY2tfaW5mb3JtYXRp
b24sIGx1bjoldSIKKyAgICAgICAgICAgICAgICAgICAgICAgICIgYWRkcl90eXBlIExCQTogJXUi
CisgICAgICAgICAgICAgICAgICAgICAgICAiIGludmFsaWQgTEJBOiAldSIsCisgICAgICAgICAg
ICAgICAgICAgICAgICByZXEtPmx1biwgYWRkcl90eXBlLCBhZGRyX251bSk7CisgICAgICAgICAg
ICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9J
TlZBTElEX0NEQl9GSUVMRCk7CisgICAgICAgICAgICByZXR1cm47CisgICAgICAgIH0KKyAgICAg
ICAgYnJlYWs7CisgICAgY2FzZSBSVElfQUREUl9UWVBFX1RSQUNLX05VTToKKyAgICAgICAgaWYg
KGFkZHJfbnVtICE9IHRyYWNrX251bSkgeworICAgICAgICAgICAgU1BJQ0VfREVCVUcoInJlYWRf
dHJhY2tfaW5mb3JtYXRpb24sIGx1bjoldSIKKyAgICAgICAgICAgICAgICAgICAgICAgICIgYWRk
cl90eXBlIHRyYWNrOiAldSIKKyAgICAgICAgICAgICAgICAgICAgICAgICIgaW52YWxpZCB0cmFj
azogJXUiLAorICAgICAgICAgICAgICAgICAgICAgICAgcmVxLT5sdW4sIGFkZHJfdHlwZSwgYWRk
cl9udW0pOworICAgICAgICAgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYs
IHJlcSwgJnNlbnNlX2NvZGVfSU5WQUxJRF9DREJfRklFTEQpOworICAgICAgICAgICAgcmV0dXJu
OworICAgICAgICB9CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgUlRJX0FERFJfVFlQRV9TRVNT
SU9OX05VTToKKyAgICAgICAgaWYgKGFkZHJfbnVtICE9IHNlc3Npb25fbnVtKSB7CisgICAgICAg
ICAgICBTUElDRV9ERUJVRygicmVhZF90cmFja19pbmZvcm1hdGlvbiwgbHVuOiV1IgorICAgICAg
ICAgICAgICAgICAgICAgICAgIiBhZGRyX3R5cGUgc2Vzc2lvbjogJXUiCisgICAgICAgICAgICAg
ICAgICAgICAgICAiIGludmFsaWQgc2Vzc2lvbjogJXUiLAorICAgICAgICAgICAgICAgICAgICAg
ICAgcmVxLT5sdW4sIGFkZHJfdHlwZSwgYWRkcl9udW0pOworICAgICAgICAgICAgY2Rfc2NzaV9j
bWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfSU5WQUxJRF9DREJf
RklFTEQpOworICAgICAgICAgICAgcmV0dXJuOworICAgICAgICB9CisgICAgICAgIGJyZWFrOwor
ICAgIGRlZmF1bHQ6CisgICAgICAgIFNQSUNFX0RFQlVHKCJyZWFkX3RyYWNrX2luZm9ybWF0aW9u
LCBsdW46JXUiCisgICAgICAgICAgICAgICAgICAgICIgaW52YWxpZCBhZGRyX3R5cGU6ICV1Igor
ICAgICAgICAgICAgICAgICAgICAiIGFkZHJfbnVtOiAldSIsCisgICAgICAgICAgICAgICAgICAg
IHJlcS0+bHVuLCBhZGRyX3R5cGUsIGFkZHJfbnVtKTsKKyAgICAgICAgY2Rfc2NzaV9jbWRfY29t
cGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfSU5WQUxJRF9DREJfRklFTEQp
OworICAgICAgICByZXR1cm47CisgICAgfQorCisgICAgcmVxLT5yZXFfbGVuID0gKHJlcS0+Y2Ri
WzddIDw8IDgpIHwgcmVxLT5jZGJbOF07CisgICAgcmVxLT5pbl9sZW4gPSBNSU4ocmVxLT5yZXFf
bGVuLCBUSUJfTEVOKTsKKworICAgIG1lbXNldChvdXRidWYsIDAsIFRJQl9MRU4pOworICAgIG91
dGJ1ZlsxXSA9IFRJQl9MRU4gLSAyOworICAgIG91dGJ1ZlsyXSA9IHNlc3Npb25fbnVtOworICAg
IG91dGJ1ZlszXSA9IHRyYWNrX251bTsKKyAgICBvdXRidWZbNV0gPSBUSUJfVFJBQ0tfTU9ERV9D
RCAmIDB4MGY7CisgICAgb3V0YnVmWzZdID0gVElCX0RBVEFfTU9ERV9JU09fMTAxNDkgJiAweDBm
OworICAgIG91dGJ1Zls3XSA9IFRJQl9MUkFfVkFMSUQ7CisKKyAgICAvKiBUcmFjayBzaXplICov
CisgICAgb3V0YnVmWzI0XSA9ICh0cmFja19zaXplID4+IDI0KSAmIDB4ZmY7CisgICAgb3V0YnVm
WzI1XSA9ICh0cmFja19zaXplID4+IDE2KSAmIDB4ZmY7CisgICAgb3V0YnVmWzI2XSA9ICh0cmFj
a19zaXplID4+IDgpICYgMHhmZjsKKyAgICBvdXRidWZbMjddID0gKHRyYWNrX3NpemUpICYgMHhm
ZjsKKworICAgIC8qIExhc3QgcmVjb3JkZWQgYWRkcmVzcyAqLworICAgIG91dGJ1ZlsyOF0gPSAo
bGFzdF9hZGRyID4+IDI0KSAmIDB4ZmY7CisgICAgb3V0YnVmWzI5XSA9IChsYXN0X2FkZHIgPj4g
MTYpICYgMHhmZjsKKyAgICBvdXRidWZbMzBdID0gKGxhc3RfYWRkciA+PiA4KSAmIDB4ZmY7Cisg
ICAgb3V0YnVmWzMxXSA9IChsYXN0X2FkZHIpICYgMHhmZjsKKworICAgIFNQSUNFX0RFQlVHKCJy
ZWFkX3RyYWNrX2luZm9ybWF0aW9uLCBsdW46JXUiCisgICAgICAgICAgICAgICAgImFkZHJfdHlw
ZTogJXUgYWRkcl9udW06ICV1IiwKKyAgICAgICAgICAgICAgICByZXEtPmx1biwgYWRkcl90eXBl
LCBhZGRyX251bSk7CisKKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsK
K30KKworI2RlZmluZSBSRUFEX1RPQ19UUkFDS19ERVNDX0xFTiAgICAgOAorI2RlZmluZSBSRUFE
X1RPQ19SRVNQX0xFTiAgICAgICAgICAgKDQgKyAyKlJFQURfVE9DX1RSQUNLX0RFU0NfTEVOKQor
CitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9yZWFkX3RvYyhDZFNjc2lMVSAqZGV2LCBDZFNjc2lS
ZXF1ZXN0ICpyZXEpCit7CisgICAgdWludDhfdCAqb3V0YnVmID0gcmVxLT5idWY7CisgICAgdWlu
dDMyX3QgbXNmLCBmb3JtYXQsIHRyYWNrX251bTsKKyAgICB1aW50MzJfdCBsYXN0X2JsayA9IGRl
di0+bnVtX2Jsb2NrcyAtIDE7CisKKyAgICByZXEtPnhmZXJfZGlyID0gU0NTSV9YRkVSX0ZST01f
REVWOworCisgICAgbXNmID0gKHJlcS0+Y2RiWzFdID4+IDEpICYgMHgxOworICAgIGZvcm1hdCA9
IHJlcS0+Y2RiWzJdICYgMHhmOworICAgIHRyYWNrX251bSA9IHJlcS0+Y2RiWzZdOworCisgICAg
cmVxLT5yZXFfbGVuID0gKHJlcS0+Y2RiWzddIDw8IDgpIHwgcmVxLT5jZGJbOF07CisgICAgcmVx
LT5pbl9sZW4gPSBNSU4ocmVxLT5yZXFfbGVuLCBSRUFEX1RPQ19SRVNQX0xFTik7CisKKyAgICBt
ZW1zZXQob3V0YnVmLCAwLCBSRUFEX1RPQ19SRVNQX0xFTik7CisgICAgb3V0YnVmWzFdID0gUkVB
RF9UT0NfUkVTUF9MRU4gLSAyOyAvKiBsZW5ndGggZXhjbHVkaW5nIHRoZSBjb3VudGVyIGl0c2Vs
ZiAqLworICAgIG91dGJ1ZlsyXSA9IDE7IC8qIGZpcnN0IHRyYWNrL3Nlc3Npb24gKi8KKyAgICBv
dXRidWZbM10gPSAxOyAvKiBsYXN0IHRyYWNrL3Nlc3Npb24gKi8KKworICAgIG91dGJ1Zls1XSA9
IDB4MDQ7IC8qIERhdGEgQ0QsIG5vIFEtc3ViY2hhbm5lbCAqLworICAgIG91dGJ1Zls2XSA9IDB4
MDE7IC8qIFRyYWNrIG51bWJlciAqLworICAgIG91dGJ1ZlsxMF0gPSBtc2YgPyAweDAyIDogMHgw
OworCisgICAgb3V0YnVmWzEzXSA9IDB4MDQ7IC8qIERhdGEgQ0QsIG5vIFEtc3ViY2hhbm5lbCAq
LworICAgIG91dGJ1ZlsxNF0gPSAweGFhOyAvKiBUcmFjayBudW1iZXIgKi8KKyAgICBpZiAobXNm
KSB7CisgICAgICAgIGxhc3RfYmxrID0gMHhmZjMwMDAwMDsKKyAgICB9CisgICAgb3V0YnVmWzE2
XSA9IGxhc3RfYmxrID4+IDI0OworICAgIG91dGJ1ZlsxN10gPSBsYXN0X2JsayA+PiAxNjsKKyAg
ICBvdXRidWZbMThdID0gbGFzdF9ibGsgPj4gODsKKyAgICBvdXRidWZbMTldID0gbGFzdF9ibGs7
CisKKyAgICBTUElDRV9ERUJVRygicmVhZF90b2MsIGx1bjoldSBsZW46ICUiIEdfR1VJTlQ2NF9G
T1JNQVQKKyAgICAgICAgICAgICAgICAiIG1zZjogJXggZm9ybWF0OiAweCUwMnggdHJhY2svc2Vz
c2lvbjogMHglMDJ4IiwKKyAgICAgICAgICAgICAgICByZXEtPmx1biwgcmVxLT5pbl9sZW4sIG1z
ZiwgZm9ybWF0LCB0cmFja19udW0pOworCisgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfZ29vZChk
ZXYsIHJlcSk7Cit9CisKKyNkZWZpbmUgQ0RfTU9ERV9QQVJBTV82X0xFTl9IRUFERVIgICAgICAg
ICAgICAgIDQKKyNkZWZpbmUgQ0RfTU9ERV9QQVJBTV8xMF9MRU5fSEVBREVSICAgICAgICAgICAg
IDgKKworI2RlZmluZSBDRF9NT0RFX1BBR0VfTEVOX1JXX0VSUk9SICAgICAgICAgICAgICAgMTIK
Kworc3RhdGljIHVpbnQzMl90IGNkX3Njc2lfYWRkX21vZGVfcGFnZV9yd19lcnJvcl9yZWNvdmVy
eShDZFNjc2lMVSAqZGV2LCB1aW50OF90ICpvdXRidWYpCit7CisgICAgdWludDMyX3QgcGFnZV9s
ZW4gPSBDRF9NT0RFX1BBR0VfTEVOX1JXX0VSUk9SOworCisgICAgb3V0YnVmWzBdID0gTU9ERV9Q
QUdFX1JfV19FUlJPUjsKKyAgICBvdXRidWZbMV0gPSBDRF9NT0RFX1BBR0VfTEVOX1JXX0VSUk9S
IC0gMjsKKyAgICBvdXRidWZbM10gPSAxOyAvKiByZWFkIHJldHJ5IGNvdW50ICovCisKKyAgICBy
ZXR1cm4gcGFnZV9sZW47Cit9CisKKyNkZWZpbmUgQ0RfTU9ERV9QQUdFX0xFTl9QT1dFUiAgICAg
ICAgICAgICAgICAgIDEyCisKK3N0YXRpYyB1aW50MzJfdCBjZF9zY3NpX2FkZF9tb2RlX3BhZ2Vf
cG93ZXJfY29uZGl0aW9uKENkU2NzaUxVICpkZXYsIHVpbnQ4X3QgKm91dGJ1ZikKK3sKKyAgICB1
aW50MzJfdCBwYWdlX2xlbiA9IENEX01PREVfUEFHRV9MRU5fUE9XRVI7CisKKyAgICBvdXRidWZb
MF0gPSBNT0RFX1BBR0VfUE9XRVI7CisgICAgb3V0YnVmWzFdID0gQ0RfTU9ERV9QQUdFX0xFTl9Q
T1dFUiAtIDI7CisKKyAgICByZXR1cm4gcGFnZV9sZW47Cit9CisKKyNkZWZpbmUgQ0RfTU9ERV9Q
QUdFX0xFTl9GQVVMVF9GQUlMICAgICAgICAgICAgIDEyCisjZGVmaW5lIENEX01PREVfUEFHRV9G
QVVMVF9GQUlMX0ZMQUdfUEVSRiAgICAgICAweDgwCisKK3N0YXRpYyB1aW50MzJfdCBjZF9zY3Np
X2FkZF9tb2RlX3BhZ2VfZmF1bHRfcmVwb3J0aW5nKENkU2NzaUxVICpkZXYsIHVpbnQ4X3QgKm91
dGJ1ZikKK3sKKyAgICB1aW50MzJfdCBwYWdlX2xlbiA9IENEX01PREVfUEFHRV9MRU5fRkFVTFRf
RkFJTDsKKworICAgIG91dGJ1ZlswXSA9IE1PREVfUEFHRV9GQVVMVF9GQUlMOworICAgIG91dGJ1
ZlsxXSA9IENEX01PREVfUEFHRV9MRU5fRkFVTFRfRkFJTCAtIDI7CisgICAgb3V0YnVmWzJdIHw9
IENEX01PREVfUEFHRV9GQVVMVF9GQUlMX0ZMQUdfUEVSRjsKKworICAgIHJldHVybiBwYWdlX2xl
bjsKK30KKworI2RlZmluZSBDRF9NT0RFX1BBR0VfTEVOX0NBUFNfTUVDSF9TVEFUVVNfUk8gICAg
MjYKKy8qIGJ5dGUgMiAqLworI2RlZmluZSBDRF9NT0RFX1BBR0VfQ0FQU19DRF9SX1JFQUQgICAg
ICAgICAgICAgMHgwMQorI2RlZmluZSBDRF9NT0RFX1BBR0VfQ0FQU19DRF9SV19SRUFEICAgICAg
ICAgICAgKDB4MDEgPDwgMSkKKyNkZWZpbmUgQ0RfTU9ERV9QQUdFX0NBUFNfRFZEX1JPTV9SRUFE
ICAgICAgICAgICgweDAxIDw8IDMpCisjZGVmaW5lIENEX01PREVfUEFHRV9DQVBTX0RWRF9SX1JF
QUQgICAgICAgICAgICAoMHgwMSA8PCA0KQorI2RlZmluZSBDRF9NT0RFX1BBR0VfQ0FQU19EVkRf
UkFNX1JFQUQgICAgICAgICAgKDB4MDEgPDwgNSkKKy8qIGJ5dGUgNiAqLworI2RlZmluZSBDRF9N
T0RFX1BBR0VfQ0FQU19MT0NLX1NVUFBPUlQgICAgICAgICAgKDB4MDEpCisjZGVmaW5lIENEX01P
REVfUEFHRV9DQVBTX0xPQ0tfU1RBVEUgICAgICAgICAgICAoMHgwMSA8PCAxKQorI2RlZmluZSBD
RF9NT0RFX1BBR0VfQ0FQU19QUkVWRU5UX0pVTVBFUiAgICAgICAgKDB4MDEgPDwgMikKKyNkZWZp
bmUgQ0RfTU9ERV9QQUdFX0NBUFNfRUpFQ1QgICAgICAgICAgICAgICAgICgweDAxIDw8IDMpCisj
ZGVmaW5lIENEX01PREVfUEFHRV9DQVBTX0xPQURJTkdfVFJBWSAgICAgICAgICAoMHgwMSA8PCA1
KQorCitzdGF0aWMgdWludDMyX3QgY2Rfc2NzaV9hZGRfbW9kZV9wYWdlX2NhcHNfbWVjaF9zdGF0
dXMoQ2RTY3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVmKQoreworICAgIHVpbnQzMl90IHBhZ2Vf
bGVuID0gQ0RfTU9ERV9QQUdFX0xFTl9DQVBTX01FQ0hfU1RBVFVTX1JPOyAvKiBubyB3cml0ZSAq
LworCisgICAgb3V0YnVmWzBdID0gTU9ERV9QQUdFX0NBUFNfTUVDSF9TVEFUVVM7CisgICAgb3V0
YnVmWzFdID0gcGFnZV9sZW47CisgICAgb3V0YnVmWzJdID0gQ0RfTU9ERV9QQUdFX0NBUFNfQ0Rf
Ul9SRUFEIHwgQ0RfTU9ERV9QQUdFX0NBUFNfQ0RfUldfUkVBRCB8CisgICAgICAgICAgICAgICAg
Q0RfTU9ERV9QQUdFX0NBUFNfRFZEX1JPTV9SRUFEIHwgQ0RfTU9ERV9QQUdFX0NBUFNfRFZEX1Jf
UkVBRCB8CisgICAgICAgICAgICAgICAgQ0RfTU9ERV9QQUdFX0NBUFNfRFZEX1JBTV9SRUFEOwor
ICAgIG91dGJ1Zls2XSA9IENEX01PREVfUEFHRV9DQVBTX0xPQURJTkdfVFJBWSB8IENEX01PREVf
UEFHRV9DQVBTX0VKRUNUIHwKKyAgICAgICAgICAgICAgICBDRF9NT0RFX1BBR0VfQ0FQU19MT0NL
X1NVUFBPUlQ7CisgICAgaWYgKGRldi0+cHJldmVudF9tZWRpYV9yZW1vdmFsKSB7CisgICAgICAg
IG91dGJ1Zls2XSB8PSBDRF9NT0RFX1BBR0VfQ0FQU19MT0NLX1NUQVRFOworICAgIH0KKworICAg
IHJldHVybiBwYWdlX2xlbjsKK30KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRfbW9kZV9zZW5z
ZV8xMChDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgdWludDhfdCAq
b3V0YnVmID0gcmVxLT5idWY7CisgICAgaW50IGxvbmdfbGJhLCBkYmQsIHBhZ2UsIHN1Yl9wYWdl
LCBwYzsKKyAgICB1aW50MzJfdCByZXNwX2xlbiA9IENEX01PREVfUEFSQU1fMTBfTEVOX0hFQURF
UjsKKworICAgIHJlcS0+eGZlcl9kaXIgPSBTQ1NJX1hGRVJfRlJPTV9ERVY7CisKKyAgICBsb25n
X2xiYSA9IChyZXEtPmNkYlsxXSA+PiA0KSAmIDB4MTsKKyAgICBkYmQgPSAocmVxLT5jZGJbMV0g
Pj4gMykgJiAweDE7CisgICAgcGFnZSA9IHJlcS0+Y2RiWzJdICYgMHgzZjsKKyAgICBwYyA9IHJl
cS0+Y2RiWzJdID4+IDY7CisgICAgc3ViX3BhZ2UgPSByZXEtPmNkYlszXTsKKworICAgIHJlcS0+
cmVxX2xlbiA9IChyZXEtPmNkYls3XSA8PCA4KSB8IHJlcS0+Y2RiWzhdOworCisgICAgbWVtc2V0
KG91dGJ1ZiwgMCwgcmVxLT5yZXFfbGVuKTsKKyAgICBvdXRidWZbMl0gPSAgMDsgLyogbWVkaXVt
IHR5cGUgKi8KKworICAgIHN3aXRjaCAocGFnZSkgeworICAgIGNhc2UgTU9ERV9QQUdFX1JfV19F
UlJPUjoKKyAgICAgICAgLyogUmVhZC9Xcml0ZSBFcnJvciBSZWNvdmVyeSAqLworICAgICAgICBy
ZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9tb2RlX3BhZ2VfcndfZXJyb3JfcmVjb3ZlcnkoZGV2LCBv
dXRidWYgKyByZXNwX2xlbik7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgTU9ERV9QQUdFX1BP
V0VSOgorICAgICAgICAvKiBQb3dlciBDb25kaXN0aW9ucyAqLworICAgICAgICByZXNwX2xlbiAr
PSBjZF9zY3NpX2FkZF9tb2RlX3BhZ2VfcG93ZXJfY29uZGl0aW9uKGRldiwgb3V0YnVmICsgcmVz
cF9sZW4pOworICAgICAgICBicmVhazsKKyAgICBjYXNlIE1PREVfUEFHRV9GQVVMVF9GQUlMOgor
ICAgICAgICAvKiBGYXVsdCAvIEZhaWx1cmUgUmVwb3J0aW5nIENvbnRyb2wgKi8KKyAgICAgICAg
cmVzcF9sZW4gKz0gY2Rfc2NzaV9hZGRfbW9kZV9wYWdlX2ZhdWx0X3JlcG9ydGluZyhkZXYsIG91
dGJ1ZiArIHJlc3BfbGVuKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBNT0RFX1BBR0VfQ0FQ
U19NRUNIX1NUQVRVUzoKKyAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9hZGRfbW9kZV9wYWdl
X2NhcHNfbWVjaF9zdGF0dXMoZGV2LCBvdXRidWYgKyByZXNwX2xlbik7CisgICAgICAgIGJyZWFr
OworCisgICAgLyogbm90IGltcGxlbWVudGVkICovCisgICAgY2FzZSBNT0RFX1BBR0VfV1JJVEVf
UEFSQU1FVEVSOiAvKiBXcml0ZXIgUGFyYW1ldGVycyAqLworICAgIGNhc2UgTU9ERV9QQUdFX01S
VzoKKyAgICBjYXNlIE1PREVfUEFHRV9NUldfVkVORE9SOiAvKiBNUlcgKE1vdW50IFJhaW5pZXIg
UmUtd3JpdGFibGUgRGlza3MgKi8KKyAgICBjYXNlIE1PREVfUEFHRV9DRF9ERVZJQ0U6IC8qIENE
IERldmljZSBwYXJhbWV0ZXJzICovCisgICAgY2FzZSBNT0RFX1BBR0VfVE9fUFJPVEVDVDogLyog
VGltZS1vdXQgYW5kIFByb3RlY3QgKi8KKyAgICBkZWZhdWx0OgorICAgICAgICBTUElDRV9ERUJV
RygibW9kZV9zZW5zZV8xMCwgbHVuOiV1IgorICAgICAgICAgICAgICAgICAgICAiIHBhZ2UgMHgl
eCBub3QgaW1wbGVtZW50ZWQiLAorICAgICAgICAgICAgICAgICAgICByZXEtPmx1biwgKHVuc2ln
bmVkKXBhZ2UpOworICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwg
cmVxLCAmc2Vuc2VfY29kZV9JTlZBTElEX0NEQl9GSUVMRCk7CisgICAgICAgIHJldHVybjsKKyAg
ICB9CisKKyAgICBvdXRidWZbMF0gPSAoKHJlc3BfbGVuIC0gMikgPj4gOCkgJiAweGZmOworICAg
IG91dGJ1ZlsxXSA9IChyZXNwX2xlbiAtIDIpICYgMHhmZjsKKworICAgIHJlcS0+aW5fbGVuID0g
TUlOKHJlcS0+cmVxX2xlbiwgcmVzcF9sZW4pOworCisgICAgU1BJQ0VfREVCVUcoIm1vZGVfc2Vu
c2VfMTAsIGx1bjoldSIKKyAgICAgICAgICAgICAgICAiIGxvbmdfbGJhICVkLCBkYmQgJWQsIHBh
Z2UgJWQsIHN1Yl9wYWdlICVkLCBwYyAlZDsgIgorICAgICAgICAgICAgICAgICJyZXNwX2xlbiAl
dSIsCisgICAgICAgICAgICAgICAgcmVxLT5sdW4sIGxvbmdfbGJhLCBkYmQsIHBhZ2UsIHN1Yl9w
YWdlLCBwYywgcmVzcF9sZW4pOworCisgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfZ29vZChkZXYs
IHJlcSk7Cit9CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX21vZGVfc2VsZWN0XzYoQ2RTY3Np
TFUgKmRldiwgQ2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAgIHVpbnQ4X3QgKmJsb2NrX2Rlc2Nf
ZGF0YSwgKm1vZGVfZGF0YTsKKyAgICB1aW50MzJfdCBwYWdlX2Zvcm1hdCwgc2F2ZV9wYWdlcywg
bGlzdF9sZW47IC8qIGNkYiAqLworICAgIHVpbnQzMl90IG51bV9ibG9ja3MgPSAwLCBibG9ja19s
ZW4gPSAwOyAvKiBibG9jayBkZXNjcmlwdG9yICovCisgICAgdWludDMyX3QgbW9kZV9sZW4sIG1l
ZGl1bV90eXBlLCBkZXZfcGFyYW0sIGJsb2NrX2Rlc2NfbGVuOyAvKiBtb2RlIHBhcmFtIGhlYWRl
ciAqLworICAgIHVpbnQzMl90IHBhZ2VfbnVtID0gMCwgcGFnZV9sZW4gPSAwOyAvKiBtb2RlIHBh
Z2UgKi8KKworICAgIHBhZ2VfZm9ybWF0ID0gKHJlcS0+Y2RiWzFdID4+IDQpICYgMHgxOworICAg
IHNhdmVfcGFnZXMgPSByZXEtPmNkYlsxXSAmIDB4MTsKKyAgICBsaXN0X2xlbiA9IHJlcS0+Y2Ri
WzRdOworCisgICAgaWYgKGxpc3RfbGVuID4gcmVxLT5idWZfbGVuKSB7CisgICAgICAgIFNQSUNF
X0RFQlVHKCJtb2RlX3NlbGVjdF82LCBsdW46JXUiCisgICAgICAgICAgICAgICAgICAgICIgcGY6
JXUgc3A6JXUiCisgICAgICAgICAgICAgICAgICAgICIgbGlzdF9sZW46JXUgZXhjZWVkcyBkYXRh
X2xlbjoldSIsCisgICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBwYWdlX2Zvcm1hdCwgc2F2
ZV9wYWdlcywgbGlzdF9sZW4sIHJlcS0+YnVmX2xlbik7CisgICAgICAgIGNkX3Njc2lfY21kX2Nv
bXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX0lOVkFMSURfUEFSQU1fTEVO
KTsKKyAgICAgICAgcmV0dXJuOworICAgIH0KKworICAgIG1vZGVfbGVuID0gcmVxLT5idWZbMF07
CisgICAgbWVkaXVtX3R5cGUgPSByZXEtPmJ1ZlsxXTsKKyAgICBkZXZfcGFyYW0gPSByZXEtPmJ1
ZlsyXTsKKyAgICBibG9ja19kZXNjX2xlbiA9IHJlcS0+YnVmWzNdOworCisgICAgaWYgKGJsb2Nr
X2Rlc2NfbGVuKSB7CisgICAgICAgIGJsb2NrX2Rlc2NfZGF0YSA9ICZyZXEtPmJ1ZltDRF9NT0RF
X1BBUkFNXzZfTEVOX0hFQURFUl07CisgICAgICAgIG51bV9ibG9ja3MgPSAoYmxvY2tfZGVzY19k
YXRhWzNdIDw8IDE2KSB8IChibG9ja19kZXNjX2RhdGFbMl0gPDwgOCkgfCBibG9ja19kZXNjX2Rh
dGFbM107CisgICAgICAgIGJsb2NrX2xlbiA9IChibG9ja19kZXNjX2RhdGFbNV0gPDwgMTYpIHwg
KGJsb2NrX2Rlc2NfZGF0YVs2XSA8PCA4KSB8IGJsb2NrX2Rlc2NfZGF0YVs3XTsKKyAgICB9CisK
KyAgICBpZiAobW9kZV9sZW4pIHsKKyAgICAgICAgbW9kZV9kYXRhID0gJnJlcS0+YnVmW0NEX01P
REVfUEFSQU1fNl9MRU5fSEVBREVSXTsKKyAgICAgICAgaWYgKGJsb2NrX2Rlc2NfbGVuKSB7Cisg
ICAgICAgICAgICBtb2RlX2RhdGEgKz0gYmxvY2tfZGVzY19sZW47CisgICAgICAgIH0KKyAgICAg
ICAgcGFnZV9udW0gPSBtb2RlX2RhdGFbMF0gJiAweDNmOworICAgICAgICBwYWdlX2xlbiA9IG1v
ZGVfZGF0YVsxXTsKKyAgICB9CisKKyAgICBTUElDRV9ERUJVRygibW9kZV9zZWxlY3RfNiwgbHVu
OiV1IgorICAgICAgICAgICAgICAgICIgcGY6JXUgc3A6JXUgbGlzdF9sZW46JXUgZGF0YV9sZW46
JXUiCisgICAgICAgICAgICAgICAgIiBtb2RlX2xlbjoldSBtZWRpdW06JXUgZGV2X3BhcmFtOiV1
IGJsa19kZXNjX2xlbjoldSIKKyAgICAgICAgICAgICAgICAiIG51bV9ibG9ja3M6JXUgYmxvY2tf
bGVuOiV1IgorICAgICAgICAgICAgICAgICIgcGFnZV9udW06JXUgcGFnZV9sZW46JXUiLAorICAg
ICAgICAgICAgICAgIHJlcS0+bHVuLCBwYWdlX2Zvcm1hdCwgc2F2ZV9wYWdlcywgbGlzdF9sZW4s
IHJlcS0+YnVmX2xlbiwKKyAgICAgICAgICAgICAgICBtb2RlX2xlbiwgbWVkaXVtX3R5cGUsIGRl
dl9wYXJhbSwgYmxvY2tfZGVzY19sZW4sCisgICAgICAgICAgICAgICAgbnVtX2Jsb2NrcywgYmxv
Y2tfbGVuLAorICAgICAgICAgICAgICAgIHBhZ2VfbnVtLCBwYWdlX2xlbik7CisKKyAgICBjZF9z
Y3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworc3RhdGljIHZvaWQgY2Rfc2Nz
aV9jbWRfbW9kZV9zZWxlY3RfMTAoQ2RTY3NpTFUgKmRldiwgQ2RTY3NpUmVxdWVzdCAqcmVxKQor
eworICAgIHVpbnQzMl90IHBhZ2VfZm9ybWF0LCBzYXZlX3BhZ2VzLCBsaXN0X2xlbjsKKworICAg
IHBhZ2VfZm9ybWF0ID0gKHJlcS0+Y2RiWzFdID4+IDQpICYgMHgxOworICAgIHNhdmVfcGFnZXMg
PSByZXEtPmNkYlsxXSAmIDB4MTsKKyAgICBsaXN0X2xlbiA9IChyZXEtPmNkYls3XSA8PCA4KSB8
IHJlcS0+Y2RiWzhdOworCisgICAgaWYgKGxpc3RfbGVuID4gcmVxLT5idWZfbGVuKSB7CisgICAg
ICAgIFNQSUNFX0RFQlVHKCJtb2RlX3NlbGVjdF8xMCwgbHVuOiV1IHBmOiV1IHNwOiV1IgorICAg
ICAgICAgICAgICAgICAgICAiIGxpc3RfbGVuOiV1IGV4Y2VlZHMgZGF0YV9sZW46JXUiLAorICAg
ICAgICAgICAgICAgICAgICByZXEtPmx1biwgcGFnZV9mb3JtYXQsIHNhdmVfcGFnZXMsIGxpc3Rf
bGVuLCByZXEtPmJ1Zl9sZW4pOworICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19j
b25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZBTElEX1BBUkFNX0xFTik7CisgICAgICAgIHJl
dHVybjsKKyAgICB9CisKKyAgICBTUElDRV9ERUJVRygibW9kZV9zZWxlY3RfMTAsIGx1bjoldSBw
ZjoldSBzcDoldSIKKyAgICAgICAgICAgICAgICAiIGxpc3RfbGVuOiV1IGRhdGFfbGVuOiV1IiwK
KyAgICAgICAgICAgICAgICByZXEtPmx1biwgcGFnZV9mb3JtYXQsIHNhdmVfcGFnZXMsIGxpc3Rf
bGVuLCByZXEtPmJ1Zl9sZW4pOworCisgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfZ29vZChkZXYs
IHJlcSk7Cit9CisKKyNkZWZpbmUgQ0RfRkVBVFVSRV9IRUFERVJfTEVOICAgICAgICAgICAgICAg
OAorI2RlZmluZSBDRF9GRUFUVVJFX0RFU0NfTEVOICAgICAgICAgICAgICAgICA0CisKKyNkZWZp
bmUgQ0RfUFJPRklMRV9ERVNDX0xFTiAgICAgICAgICAgICAgICAgNAorI2RlZmluZSBDRF9QUk9G
SUxFX0NVUlJFTlQgICAgICAgICAgICAgICAgICAweDAxCisKKy8qIFByb2ZpbGVzIExpc3QgKi8K
KyNkZWZpbmUgQ0RfRkVBVFVSRV9OVU1fUFJPRklMRVNfTElTVCAgICAgICAgMHgwMAorLyogQ29y
ZSAtIEJhc2ljIEZ1bmN0aW9uYWxpdHkgKi8KKyNkZWZpbmUgQ0RfRkVBVFVSRV9OVU1fQ09SRSAg
ICAgICAgICAgICAgICAgMHgwMQorLyogTW9ycGhpbmcgLSBUaGUgZGV2aWNlIGNoYW5nZXMgaXRz
IGJlaGF2aW9yIGR1ZSB0byBleHRlcm5hbCBldmVudHMgKi8KKyNkZWZpbmUgQ0RfRkVBVFVSRV9O
VU1fTU9SUEggICAgICAgICAgICAgICAgMHgwMgorLyogUmVtb3ZhYmxlIE1lZGl1bSAtIFRoZSBt
ZWRpdW0gbWF5IGJlIHJlbW92ZWQgZnJvbSB0aGUgZGV2aWNlICovCisjZGVmaW5lIENEX0ZFQVRV
UkVfTlVNX1JFTU9WQUJMRSAgICAgICAgICAgIDB4MDMKKy8qIFJhbmRvbSBSZWFkYWJsZSAtIFBQ
PTEgUmVhZCBhYmlsaXR5IGZvciBzdG9yYWdlIGRldmljZXMgd2l0aCByYW5kb20gYWRkcmVzc2lu
ZyAqLworI2RlZmluZSBDRF9GRUFUVVJFX05VTV9SQU5ET01fUkVBRCAgICAgICAgICAweDEwCisv
KiBDRCBSZWFkIC0gVGhlIGFiaWxpdHkgdG8gcmVhZCBDRCBzcGVjaWZpYyBzdHJ1Y3R1cmVzICov
CisjZGVmaW5lIENEX0ZFQVRVUkVfTlVNX0NEX1JFQUQgICAgICAgICAgICAgIDB4MUUKKy8qIERW
RCBSZWFkIC0gVGhlIGFiaWxpdHkgdG8gcmVhZCBEVkQgc3BlY2lmaWMgc3RydWN0dXJlcyAqLwor
I2RlZmluZSBDRF9GRUFUVVJFX05VTV9EVkRfUkVBRCAgICAgICAgICAgICAweDFGCisvKiBQb3dl
ciBNYW5hZ2VtZW50IC0gSW5pdGlhdG9yIGFuZCBkZXZpY2UgZGlyZWN0ZWQgcG93ZXIgbWFuYWdl
bWVudCAqLworI2RlZmluZSBDRF9GRUFUVVJFX05VTV9QT1dFUl9NTkdUICAgICAgICAgICAweDEw
MAorLyogVGltZW91dCAqLworI2RlZmluZSBDRF9GRUFUVVJFX05VTV9USU1FT1VUICAgICAgICAg
ICAgICAweDEwNQorCisjZGVmaW5lIENEX0ZFQVRVUkVfUkVRX0FMTCAgICAgICAgICAgICAgICAg
IDAKKyNkZWZpbmUgQ0RfRkVBVFVSRV9SRVFfQ1VSUkVOVCAgICAgICAgICAgICAgMQorI2RlZmlu
ZSBDRF9GRUFUVVJFX1JFUV9TSU5HTEUgICAgICAgICAgICAgICAyCisKKyNkZWZpbmUgQ0RfRkVB
VFVSRV9DVVJSRU5UICAgICAgICAgICAgICAgICAgMHgwMQorI2RlZmluZSBDRF9GRUFUVVJFX1BF
UlNJU1RFTlQgICAgICAgICAgICAgICAweDAyCisKKyNkZWZpbmUgQ0RfRkVBVFVSRV9WRVJTSU9O
XzEgICAgICAgICAgICAgICAgKDB4MDEgPDwgMikKKworI2RlZmluZSBDRF9GRUFUVVJFX1BIWVNf
SUZfU0NTSSAgICAgICAgICAgICAweDAxCisKKyNkZWZpbmUgQ0RfRkVBVFVSRV9SRU1PVkFCTEVf
TE9BRElOR19UUkFZICAgKDB4MDEgPDwgNSkKKyNkZWZpbmUgQ0RfRkVBVFVSRV9SRU1PVkFCTEVf
RUpFQ1QgICAgICAgICAgKDB4MDEgPDwgMykKKyNkZWZpbmUgQ0RfRkVBVFVSRV9SRU1PVkFCTEVf
Tk9fUFJWTlRfSk1QUiAgKDB4MDEgPDwgMikKKyNkZWZpbmUgQ0RfRkVBVFVSRV9SRU1PVkFCTEVf
TE9DSyAgICAgICAgICAgKDB4MDEpCisKK3N0YXRpYyBnYm9vbGVhbiBjZF9zY3NpX2ZlYXR1cmVf
cmVwb3J0YWJsZSh1aW50MzJfdCBmZWF0dXJlLCB1aW50MzJfdCBzdGFydF9mZWF0dXJlLAorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IHJlcV90eXBl
KQoreworICAgIHJldHVybiAocmVxX3R5cGUgPT0gQ0RfRkVBVFVSRV9SRVFfU0lOR0xFICYmIHN0
YXJ0X2ZlYXR1cmUgPT0gZmVhdHVyZSkgfHwKKyAgICAgICAgICAgKGZlYXR1cmUgPj0gc3RhcnRf
ZmVhdHVyZSk7Cit9CisKK3N0YXRpYyB1aW50MzJfdCBjZF9zY3NpX2FkZF9mZWF0dXJlX3Byb2Zp
bGVzX2xpc3QoQ2RTY3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVmLAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCBzdGFydF9mZWF0dXJl
LCB1aW50MzJfdCByZXFfdHlwZSkKK3sKKyAgICB1aW50OF90ICpwcm9maWxlID0gb3V0YnVmICsg
Q0RfRkVBVFVSRV9ERVNDX0xFTjsKKyAgICB1aW50MzJfdCBmZWF0dXJlX2xlbiA9IENEX0ZFQVRV
UkVfREVTQ19MRU47CisgICAgdWludDMyX3QgYWRkX2xlbiwgcHJvZmlsZV9udW07CisKKyAgICBp
ZiAoIWNkX3Njc2lfZmVhdHVyZV9yZXBvcnRhYmxlKENEX0ZFQVRVUkVfTlVNX1BST0ZJTEVTX0xJ
U1QsIHN0YXJ0X2ZlYXR1cmUsIHJlcV90eXBlKSkgeworICAgICAgICByZXR1cm4gMDsKKyAgICB9
CisgICAgLyogZmVhdHVyZSBkZXNjcmlwdG9yIGhlYWRlciAqLworICAgIG91dGJ1ZlswXSA9IChD
RF9GRUFUVVJFX05VTV9QUk9GSUxFU19MSVNUID4+IDgpICYgMHhmZjsKKyAgICBvdXRidWZbMV0g
PSBDRF9GRUFUVVJFX05VTV9QUk9GSUxFU19MSVNUICYgMHhmZjsKKyAgICBvdXRidWZbMl0gPSBD
RF9GRUFUVVJFX1BFUlNJU1RFTlQgfCBDRF9GRUFUVVJFX0NVUlJFTlQ7CisKKyAgICAvKiBEVkQt
Uk9NIHByb2ZpbGUgZGVzY3JpcHRvciAqLworICAgIGFkZF9sZW4gPSBDRF9QUk9GSUxFX0RFU0Nf
TEVOOyAvKiBzdGFydCB3aXRoIHNpbmdsZSBwcm9maWxlLCBhZGQgbGF0ZXIgKi8KKyAgICBwcm9m
aWxlX251bSA9IE1NQ19QUk9GSUxFX0RWRF9ST007CisKKyAgICBwcm9maWxlWzBdID0gKHByb2Zp
bGVfbnVtID4+IDgpICYgMHhmZjsgLyogZmVhdHVyZSBjb2RlICovCisgICAgcHJvZmlsZVsxXSA9
IHByb2ZpbGVfbnVtICYgMHhmZjsKKyAgICBwcm9maWxlWzJdID0gKCFkZXYtPmNkX3JvbSkgPyBD
RF9QUk9GSUxFX0NVUlJFTlQgOiAwOworCisgICAgLyogbmV4dCBwcm9maWxlICovCisgICAgYWRk
X2xlbiArPSBDRF9QUk9GSUxFX0RFU0NfTEVOOworICAgIHByb2ZpbGUgKz0gQ0RfUFJPRklMRV9E
RVNDX0xFTjsKKworICAgIC8qIENELVJPTSBwcm9maWxlIGRlc2NyaXB0b3IgKi8KKyAgICBwcm9m
aWxlX251bSA9IE1NQ19QUk9GSUxFX0NEX1JPTTsKKyAgICBwcm9maWxlWzBdID0gKHByb2ZpbGVf
bnVtID4+IDgpICYgMHhmZjsKKyAgICBwcm9maWxlWzFdID0gcHJvZmlsZV9udW0gJiAweGZmOwor
ICAgIHByb2ZpbGVbMl0gPSBkZXYtPmNkX3JvbSA/IENEX1BST0ZJTEVfQ1VSUkVOVCA6IDA7CisK
KyAgICBvdXRidWZbM10gPSBhZGRfbGVuOworICAgIGZlYXR1cmVfbGVuICs9IGFkZF9sZW47CisK
KyAgICByZXR1cm4gZmVhdHVyZV9sZW47Cit9CisKKyNkZWZpbmUgQ0RfRkVBVFVSRV9DT1JFX1BI
WVNfUFJPRklMRV9MRU4gICAgNAorCitzdGF0aWMgdWludDMyX3QgY2Rfc2NzaV9hZGRfZmVhdHVy
ZV9jb3JlKENkU2NzaUxVICpkZXYsIHVpbnQ4X3QgKm91dGJ1ZiwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyX3Qgc3RhcnRfZmVhdHVyZSwgdWludDMyX3Qg
cmVxX3R5cGUpCit7CisgICAgdWludDhfdCAqcHJvZmlsZSA9IG91dGJ1ZiArIENEX0ZFQVRVUkVf
REVTQ19MRU47CisgICAgdWludDMyX3QgZmVhdHVyZV9sZW4gPSBDRF9GRUFUVVJFX0RFU0NfTEVO
ICsgQ0RfRkVBVFVSRV9DT1JFX1BIWVNfUFJPRklMRV9MRU47CisKKyAgICBpZiAoIWNkX3Njc2lf
ZmVhdHVyZV9yZXBvcnRhYmxlKENEX0ZFQVRVUkVfTlVNX0NPUkUsIHN0YXJ0X2ZlYXR1cmUsIHJl
cV90eXBlKSkgeworICAgICAgICByZXR1cm4gMDsKKyAgICB9CisgICAgb3V0YnVmWzBdID0gKENE
X0ZFQVRVUkVfTlVNX0NPUkUgPj4gOCkgJiAweGZmOworICAgIG91dGJ1ZlsxXSA9IENEX0ZFQVRV
UkVfTlVNX0NPUkUgJiAweGZmOworICAgIG91dGJ1ZlsyXSA9IENEX0ZFQVRVUkVfUEVSU0lTVEVO
VCB8IENEX0ZFQVRVUkVfQ1VSUkVOVDsKKyAgICBvdXRidWZbM10gPSBDRF9GRUFUVVJFX0NPUkVf
UEhZU19QUk9GSUxFX0xFTjsKKworICAgIHByb2ZpbGVbM10gPSBDRF9GRUFUVVJFX1BIWVNfSUZf
U0NTSTsKKworICAgIHJldHVybiBmZWF0dXJlX2xlbjsKK30KKworI2RlZmluZSBDRF9GRUFUVVJF
X01PUlBIX1BST0dJTEVfTEVOICAgIDQKKyNkZWZpbmUgQ0RfRkVBVFVSRV9NT1JQSF9BU1lOQ19F
VkVOVFMgICAweDAxCisKK3N0YXRpYyB1aW50MzJfdCBjZF9zY3NpX2FkZF9mZWF0dXJlX21vcnBo
KENkU2NzaUxVICpkZXYsIHVpbnQ4X3QgKm91dGJ1ZiwKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IHN0YXJ0X2ZlYXR1cmUsIHVpbnQzMl90IHJlcV90
eXBlKQoreworICAgIHVpbnQ4X3QgKnByb2ZpbGUgPSBvdXRidWYgKyBDRF9GRUFUVVJFX0RFU0Nf
TEVOOworICAgIHVpbnQzMl90IGZlYXR1cmVfbGVuID0gQ0RfRkVBVFVSRV9ERVNDX0xFTiArIENE
X0ZFQVRVUkVfTU9SUEhfUFJPR0lMRV9MRU47CisKKyAgICBpZiAoIWNkX3Njc2lfZmVhdHVyZV9y
ZXBvcnRhYmxlKENEX0ZFQVRVUkVfTlVNX01PUlBILCBzdGFydF9mZWF0dXJlLCByZXFfdHlwZSkp
IHsKKyAgICAgICAgcmV0dXJuIDA7CisgICAgfQorICAgIG91dGJ1ZlsxXSA9IENEX0ZFQVRVUkVf
TlVNX01PUlBIOworICAgIG91dGJ1ZlsyXSA9IENEX0ZFQVRVUkVfUEVSU0lTVEVOVCB8IENEX0ZF
QVRVUkVfQ1VSUkVOVDsKKyAgICBvdXRidWZbM10gPSBDRF9GRUFUVVJFX01PUlBIX1BST0dJTEVf
TEVOOworCisgICAgcHJvZmlsZVswXSA9IENEX0ZFQVRVUkVfTU9SUEhfQVNZTkNfRVZFTlRTOwor
CisgICAgcmV0dXJuIGZlYXR1cmVfbGVuOworfQorCisjZGVmaW5lIENEX0ZFQVRVUkVfUkVNT1ZB
QkxFX1BST0ZJTEVfTEVOICAgIDQKKworc3RhdGljIHVpbnQzMl90IGNkX3Njc2lfYWRkX2ZlYXR1
cmVfcmVtb3ZhYmxlKENkU2NzaUxVICpkZXYsIHVpbnQ4X3QgKm91dGJ1ZiwKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCBzdGFydF9mZWF0dXJl
LCB1aW50MzJfdCByZXFfdHlwZSkKK3sKKyAgICB1aW50OF90ICpwcm9maWxlID0gb3V0YnVmICsg
Q0RfRkVBVFVSRV9ERVNDX0xFTjsKKyAgICB1aW50MzJfdCBmZWF0dXJlX2xlbiA9IENEX0ZFQVRV
UkVfREVTQ19MRU4gKyBDRF9GRUFUVVJFX1JFTU9WQUJMRV9QUk9GSUxFX0xFTjsKKworICAgIGlm
ICghY2Rfc2NzaV9mZWF0dXJlX3JlcG9ydGFibGUoQ0RfRkVBVFVSRV9OVU1fUkVNT1ZBQkxFLCBz
dGFydF9mZWF0dXJlLCByZXFfdHlwZSkpIHsKKyAgICAgICAgcmV0dXJuIDA7CisgICAgfQorICAg
IG91dGJ1ZlsxXSA9IENEX0ZFQVRVUkVfTlVNX1JFTU9WQUJMRTsKKyAgICBvdXRidWZbMl0gPSBD
RF9GRUFUVVJFX1BFUlNJU1RFTlQgfCBDRF9GRUFUVVJFX0NVUlJFTlQ7CisgICAgb3V0YnVmWzNd
ID0gQ0RfRkVBVFVSRV9SRU1PVkFCTEVfUFJPRklMRV9MRU47CisKKyAgICBwcm9maWxlWzBdID0g
Q0RfRkVBVFVSRV9SRU1PVkFCTEVfTk9fUFJWTlRfSk1QUjsKKyAgICBpZiAoZGV2LT5yZW1vdmFi
bGUpIHsKKyAgICAgICAgcHJvZmlsZVswXSB8PSAoQ0RfRkVBVFVSRV9SRU1PVkFCTEVfTE9BRElO
R19UUkFZIHwgQ0RfRkVBVFVSRV9SRU1PVkFCTEVfRUpFQ1QpOworICAgIH0KKworICAgIHJldHVy
biBmZWF0dXJlX2xlbjsKK30KKworI2RlZmluZSBDRF9GRUFUVVJFX1JBTkRPTV9SRUFEX1BST0ZJ
TEVfTEVOICAgIDgKKworc3RhdGljIHVpbnQzMl90IGNkX3Njc2lfYWRkX2ZlYXR1cmVfcmFuZG9t
X3JlYWQoQ2RTY3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVmLAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyX3Qgc3RhcnRfZmVhdHVyZSwgdWlu
dDMyX3QgcmVxX3R5cGUpCit7CisgICAgdWludDhfdCAqcHJvZmlsZSA9IG91dGJ1ZiArIENEX0ZF
QVRVUkVfREVTQ19MRU47CisgICAgdWludDMyX3QgZmVhdHVyZV9sZW4gPSBDRF9GRUFUVVJFX0RF
U0NfTEVOICsgQ0RfRkVBVFVSRV9SQU5ET01fUkVBRF9QUk9GSUxFX0xFTjsKKworICAgIGlmICgh
Y2Rfc2NzaV9mZWF0dXJlX3JlcG9ydGFibGUoQ0RfRkVBVFVSRV9OVU1fUkFORE9NX1JFQUQsIHN0
YXJ0X2ZlYXR1cmUsIHJlcV90eXBlKSkgeworICAgICAgICByZXR1cm4gMDsKKyAgICB9CisgICAg
b3V0YnVmWzBdID0gKENEX0ZFQVRVUkVfTlVNX1JBTkRPTV9SRUFEID4+IDgpICYgMHhmZjsKKyAg
ICBvdXRidWZbMV0gPSBDRF9GRUFUVVJFX05VTV9SQU5ET01fUkVBRCAmIDB4ZmY7CisgICAgb3V0
YnVmWzJdID0gQ0RfRkVBVFVSRV9QRVJTSVNURU5UIHwgQ0RfRkVBVFVSRV9DVVJSRU5UOworICAg
IG91dGJ1ZlszXSA9IENEX0ZFQVRVUkVfUkFORE9NX1JFQURfUFJPRklMRV9MRU47CisKKyAgICBw
cm9maWxlWzBdID0gKGRldi0+YmxvY2tfc2l6ZSA+PiAyNCkgJiAweGZmOworICAgIHByb2ZpbGVb
MV0gPSAoZGV2LT5ibG9ja19zaXplID4+IDE2KSAmIDB4ZmY7CisgICAgcHJvZmlsZVsyXSA9IChk
ZXYtPmJsb2NrX3NpemUgPj4gOCkgJiAweGZmOworICAgIHByb2ZpbGVbM10gPSAoZGV2LT5ibG9j
a19zaXplKSAmIDB4ZmY7CisgICAgcHJvZmlsZVs1XSA9IChkZXYtPmNkX3JvbSkgPyAweDAxIDog
MHgxMDsgLyogbG9naWNhbCBibG9ja3MgcGVyIHJlYWRhYmxlIHVuaXQgKi8KKworICAgIHJldHVy
biBmZWF0dXJlX2xlbjsKK30KKworI2RlZmluZSBDRF9GRUFUVVJFX0NEX1JFQURfUFJPRklMRV9M
RU4gICAgNAorCitzdGF0aWMgdWludDMyX3QgY2Rfc2NzaV9hZGRfZmVhdHVyZV9jZF9yZWFkKENk
U2NzaUxVICpkZXYsIHVpbnQ4X3QgKm91dGJ1ZiwKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgdWludDMyX3Qgc3RhcnRfZmVhdHVyZSwgdWludDMyX3QgcmVxX3R5
cGUpCit7CisgICAgdWludDhfdCAqcHJvZmlsZSA9IG91dGJ1ZiArIENEX0ZFQVRVUkVfREVTQ19M
RU47CisgICAgdWludDMyX3QgZmVhdHVyZV9sZW4gPSBDRF9GRUFUVVJFX0RFU0NfTEVOICsgQ0Rf
RkVBVFVSRV9DRF9SRUFEX1BST0ZJTEVfTEVOOworCisgICAgaWYgKCFjZF9zY3NpX2ZlYXR1cmVf
cmVwb3J0YWJsZShDRF9GRUFUVVJFX05VTV9DRF9SRUFELCBzdGFydF9mZWF0dXJlLCByZXFfdHlw
ZSkpIHsKKyAgICAgICAgcmV0dXJuIDA7CisgICAgfQorICAgIG91dGJ1ZlswXSA9IChDRF9GRUFU
VVJFX05VTV9DRF9SRUFEID4+IDgpICYgMHhmZjsKKyAgICBvdXRidWZbMV0gPSAoQ0RfRkVBVFVS
RV9OVU1fQ0RfUkVBRCkgJiAweGZmOworICAgIG91dGJ1ZlsyXSA9IENEX0ZFQVRVUkVfVkVSU0lP
Tl8xIHwgQ0RfRkVBVFVSRV9QRVJTSVNURU5UIHwgQ0RfRkVBVFVSRV9DVVJSRU5UOworICAgIG91
dGJ1ZlszXSA9IENEX0ZFQVRVUkVfQ0RfUkVBRF9QUk9GSUxFX0xFTjsKKworICAgIHByb2ZpbGVb
MF0gPSAwOyAvKiBDMiBFcnJvcnMsIENELVRleHQgbm90IHN1cHBvcnRlICovCisKKyAgICByZXR1
cm4gZmVhdHVyZV9sZW47Cit9CisKKyNkZWZpbmUgQ0RfRkVBVFVSRV9EVkRfUkVBRF9QUk9GSUxF
X0xFTiAgICAwCisKK3N0YXRpYyB1aW50MzJfdCBjZF9zY3NpX2FkZF9mZWF0dXJlX2R2ZF9yZWFk
KENkU2NzaUxVICpkZXYsIHVpbnQ4X3QgKm91dGJ1ZiwKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IHN0YXJ0X2ZlYXR1cmUsIHVpbnQzMl90IHJl
cV90eXBlKQoreworICAgIHVpbnQzMl90IGZlYXR1cmVfbGVuID0gQ0RfRkVBVFVSRV9ERVNDX0xF
TiArIENEX0ZFQVRVUkVfRFZEX1JFQURfUFJPRklMRV9MRU47CisKKyAgICBpZiAoIWNkX3Njc2lf
ZmVhdHVyZV9yZXBvcnRhYmxlKENEX0ZFQVRVUkVfTlVNX0NEX1JFQUQsIHN0YXJ0X2ZlYXR1cmUs
IHJlcV90eXBlKSkgeworICAgICAgICByZXR1cm4gMDsKKyAgICB9CisgICAgb3V0YnVmWzBdID0g
KENEX0ZFQVRVUkVfTlVNX0RWRF9SRUFEID4+IDgpICYgMHhmZjsKKyAgICBvdXRidWZbMV0gPSAo
Q0RfRkVBVFVSRV9OVU1fRFZEX1JFQUQpICYgMHhmZjsKKyAgICBvdXRidWZbMl0gPSBDRF9GRUFU
VVJFX1ZFUlNJT05fMSB8IENEX0ZFQVRVUkVfUEVSU0lTVEVOVCB8IENEX0ZFQVRVUkVfQ1VSUkVO
VDsKKyAgICBvdXRidWZbM10gPSBDRF9GRUFUVVJFX0RWRF9SRUFEX1BST0ZJTEVfTEVOOworCisg
ICAgcmV0dXJuIGZlYXR1cmVfbGVuOworfQorCisjZGVmaW5lIENEX0ZFQVRVUkVfUE9XRVJfTU5H
VF9QUk9GSUxFX0xFTiAgICAwCisKK3N0YXRpYyB1aW50MzJfdCBjZF9zY3NpX2FkZF9mZWF0dXJl
X3Bvd2VyX21nbXQoQ2RTY3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVmLAorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCBzdGFydF9mZWF0dXJl
LCB1aW50MzJfdCByZXFfdHlwZSkKK3sKKyAgICB1aW50MzJfdCBmZWF0dXJlX2xlbiA9IENEX0ZF
QVRVUkVfREVTQ19MRU4gKyBDRF9GRUFUVVJFX1BPV0VSX01OR1RfUFJPRklMRV9MRU47CisKKyAg
ICBpZiAoIWNkX3Njc2lfZmVhdHVyZV9yZXBvcnRhYmxlKENEX0ZFQVRVUkVfTlVNX1BPV0VSX01O
R1QsIHN0YXJ0X2ZlYXR1cmUsIHJlcV90eXBlKSkgeworICAgICAgICByZXR1cm4gMDsKKyAgICB9
CisgICAgb3V0YnVmWzBdID0gKENEX0ZFQVRVUkVfTlVNX1BPV0VSX01OR1QgPj4gOCkgJiAweGZm
OworICAgIG91dGJ1ZlsxXSA9IChDRF9GRUFUVVJFX05VTV9QT1dFUl9NTkdUKSAmIDB4ZmY7Cisg
ICAgb3V0YnVmWzJdID0gQ0RfRkVBVFVSRV9QRVJTSVNURU5UIHwgQ0RfRkVBVFVSRV9DVVJSRU5U
OworICAgIG91dGJ1ZlszXSA9IENEX0ZFQVRVUkVfUE9XRVJfTU5HVF9QUk9GSUxFX0xFTjsKKwor
ICAgIHJldHVybiBmZWF0dXJlX2xlbjsKK30KKworI2RlZmluZSBDRF9GRUFUVVJFX1RJTUVPVVRf
UFJPRklMRV9MRU4gICAgMAorCitzdGF0aWMgdWludDMyX3QgY2Rfc2NzaV9hZGRfZmVhdHVyZV90
aW1lb3V0KENkU2NzaUxVICpkZXYsIHVpbnQ4X3QgKm91dGJ1ZiwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyX3Qgc3RhcnRfZmVhdHVyZSwgdWludDMy
X3QgcmVxX3R5cGUpCit7CisgICAgdWludDMyX3QgZmVhdHVyZV9sZW4gPSBDRF9GRUFUVVJFX0RF
U0NfTEVOICsgQ0RfRkVBVFVSRV9USU1FT1VUX1BST0ZJTEVfTEVOOworCisgICAgaWYgKCFjZF9z
Y3NpX2ZlYXR1cmVfcmVwb3J0YWJsZShDRF9GRUFUVVJFX05VTV9USU1FT1VULCBzdGFydF9mZWF0
dXJlLCByZXFfdHlwZSkpIHsKKyAgICAgICAgcmV0dXJuIDA7CisgICAgfQorICAgIG91dGJ1Zlsw
XSA9IChDRF9GRUFUVVJFX05VTV9USU1FT1VUID4+IDgpICYgMHhmZjsKKyAgICBvdXRidWZbMV0g
PSBDRF9GRUFUVVJFX05VTV9USU1FT1VUICYgMHhmZjsKKyAgICBvdXRidWZbMl0gPSBDRF9GRUFU
VVJFX1BFUlNJU1RFTlQgfCBDRF9GRUFUVVJFX0NVUlJFTlQ7CisgICAgb3V0YnVmWzNdID0gQ0Rf
RkVBVFVSRV9USU1FT1VUX1BST0ZJTEVfTEVOOworCisgICAgcmV0dXJuIGZlYXR1cmVfbGVuOwor
fQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9nZXRfY29uZmlndXJhdGlvbihDZFNjc2lMVSAq
ZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgdWludDhfdCAqb3V0YnVmID0gcmVxLT5i
dWY7CisgICAgdWludDMyX3QgcHJvZmlsZV9udW0gPSAoIWRldi0+Y2Rfcm9tKSA/IE1NQ19QUk9G
SUxFX0RWRF9ST00gOiBNTUNfUFJPRklMRV9DRF9ST007CisgICAgdWludDMyX3QgcmVxX3R5cGUs
IHN0YXJ0X2ZlYXR1cmUsIHJlc3BfbGVuOworCisgICAgcmVxLT54ZmVyX2RpciA9IFNDU0lfWEZF
Ul9GUk9NX0RFVjsKKworICAgIHJlcV90eXBlID0gcmVxLT5jZGJbMV0gJiAweDM7CisgICAgc3Rh
cnRfZmVhdHVyZSA9IChyZXEtPmNkYlsyXSA8PCA4KSB8IHJlcS0+Y2RiWzNdOworICAgIHJlcS0+
cmVxX2xlbiA9IChyZXEtPmNkYls3XSA8PCA4KSB8IHJlcS0+Y2RiWzhdOworCisgICAgbWVtc2V0
KG91dGJ1ZiwgMCwgcmVxLT5yZXFfbGVuKTsKKworICAgIC8qIGF0IGxlYXN0IEZlYXR1cmUgSGVh
ZGVyIHNob3VsZCBiZSBwcmVzZW50LCB0byBiZSBmaWxsZWQgbGF0ZXIgKi8KKyAgICByZXNwX2xl
biA9IENEX0ZFQVRVUkVfSEVBREVSX0xFTjsKKworICAgIHN3aXRjaCAocmVxX3R5cGUpIHsKKyAg
ICBjYXNlIENEX0ZFQVRVUkVfUkVRX0FMTDoKKyAgICBjYXNlIENEX0ZFQVRVUkVfUkVRX0NVUlJF
TlQ6CisgICAgICAgIHJlc3BfbGVuICs9IGNkX3Njc2lfYWRkX2ZlYXR1cmVfcHJvZmlsZXNfbGlz
dChkZXYsIG91dGJ1ZiArIHJlc3BfbGVuLCBzdGFydF9mZWF0dXJlLAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxX3R5cGUpOworICAgICAg
ICByZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9mZWF0dXJlX2NvcmUoZGV2LCBvdXRidWYgKyByZXNw
X2xlbiwgc3RhcnRfZmVhdHVyZSwgcmVxX3R5cGUpOworICAgICAgICByZXNwX2xlbiArPSBjZF9z
Y3NpX2FkZF9mZWF0dXJlX21vcnBoKGRldiwgb3V0YnVmICsgcmVzcF9sZW4sIHN0YXJ0X2ZlYXR1
cmUsIHJlcV90eXBlKTsKKyAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9hZGRfZmVhdHVyZV9y
ZW1vdmFibGUoZGV2LCBvdXRidWYgKyByZXNwX2xlbiwgc3RhcnRfZmVhdHVyZSwgcmVxX3R5cGUp
OworICAgICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9mZWF0dXJlX3JhbmRvbV9yZWFkKGRl
diwgb3V0YnVmICsgcmVzcF9sZW4sIHN0YXJ0X2ZlYXR1cmUsCisgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxX3R5cGUpOworICAgICAgICByZXNw
X2xlbiArPSBjZF9zY3NpX2FkZF9mZWF0dXJlX2NkX3JlYWQoZGV2LCBvdXRidWYgKyByZXNwX2xl
biwgc3RhcnRfZmVhdHVyZSwgcmVxX3R5cGUpOworICAgICAgICByZXNwX2xlbiArPSBjZF9zY3Np
X2FkZF9mZWF0dXJlX2R2ZF9yZWFkKGRldiwgb3V0YnVmICsgcmVzcF9sZW4sIHN0YXJ0X2ZlYXR1
cmUsIHJlcV90eXBlKTsKKyAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9hZGRfZmVhdHVyZV9w
b3dlcl9tZ210KGRldiwgb3V0YnVmICsgcmVzcF9sZW4sIHN0YXJ0X2ZlYXR1cmUsIHJlcV90eXBl
KTsKKyAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9hZGRfZmVhdHVyZV90aW1lb3V0KGRldiwg
b3V0YnVmICsgcmVzcF9sZW4sIHN0YXJ0X2ZlYXR1cmUsIHJlcV90eXBlKTsKKyAgICAgICAgYnJl
YWs7CisgICAgY2FzZSBDRF9GRUFUVVJFX1JFUV9TSU5HTEU6CisgICAgICAgIHN3aXRjaCAoc3Rh
cnRfZmVhdHVyZSkgeworICAgICAgICBjYXNlIENEX0ZFQVRVUkVfTlVNX0NPUkU6CisgICAgICAg
ICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9mZWF0dXJlX2NvcmUoZGV2LCBvdXRidWYgKyBy
ZXNwX2xlbiwgc3RhcnRfZmVhdHVyZSwgcmVxX3R5cGUpOworICAgICAgICAgICAgYnJlYWs7Cisg
ICAgICAgIGNhc2UgQ0RfRkVBVFVSRV9OVU1fTU9SUEg6CisgICAgICAgICAgICByZXNwX2xlbiAr
PSBjZF9zY3NpX2FkZF9mZWF0dXJlX21vcnBoKGRldiwgb3V0YnVmICsgcmVzcF9sZW4sIHN0YXJ0
X2ZlYXR1cmUsIHJlcV90eXBlKTsKKyAgICAgICAgICAgIGJyZWFrOworICAgICAgICBjYXNlIENE
X0ZFQVRVUkVfTlVNX1JFTU9WQUJMRToKKyAgICAgICAgICAgIHJlc3BfbGVuICs9IGNkX3Njc2lf
YWRkX2ZlYXR1cmVfcmVtb3ZhYmxlKGRldiwgb3V0YnVmICsgcmVzcF9sZW4sIHN0YXJ0X2ZlYXR1
cmUsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICByZXFfdHlwZSk7CisgICAgICAgICAgICBicmVhazsKKyAgICAgICAgY2FzZSBDRF9GRUFUVVJF
X05VTV9SQU5ET01fUkVBRDoKKyAgICAgICAgICAgIHJlc3BfbGVuICs9IGNkX3Njc2lfYWRkX2Zl
YXR1cmVfcmFuZG9tX3JlYWQoZGV2LCBvdXRidWYgKyByZXNwX2xlbiwgc3RhcnRfZmVhdHVyZSwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
cmVxX3R5cGUpOworICAgICAgICAgICAgYnJlYWs7CisgICAgICAgIGNhc2UgQ0RfRkVBVFVSRV9O
VU1fQ0RfUkVBRDoKKyAgICAgICAgICAgIHJlc3BfbGVuICs9IGNkX3Njc2lfYWRkX2ZlYXR1cmVf
Y2RfcmVhZChkZXYsIG91dGJ1ZiArIHJlc3BfbGVuLCBzdGFydF9mZWF0dXJlLAorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcV90eXBlKTsKKyAg
ICAgICAgICAgIGJyZWFrOworICAgICAgICBjYXNlIENEX0ZFQVRVUkVfTlVNX0RWRF9SRUFEOgor
ICAgICAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9hZGRfZmVhdHVyZV9kdmRfcmVhZChkZXYs
IG91dGJ1ZiArIHJlc3BfbGVuLCBzdGFydF9mZWF0dXJlLAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXFfdHlwZSk7CisgICAgICAgICAgICBi
cmVhazsKKyAgICAgICAgY2FzZSBDRF9GRUFUVVJFX05VTV9QT1dFUl9NTkdUOgorICAgICAgICAg
ICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9hZGRfZmVhdHVyZV9wb3dlcl9tZ210KGRldiwgb3V0YnVm
ICsgcmVzcF9sZW4sIHN0YXJ0X2ZlYXR1cmUsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxX3R5cGUpOworICAgICAgICAgICAgYnJlYWs7
CisgICAgICAgIGNhc2UgQ0RfRkVBVFVSRV9OVU1fVElNRU9VVDoKKyAgICAgICAgICAgIHJlc3Bf
bGVuICs9IGNkX3Njc2lfYWRkX2ZlYXR1cmVfdGltZW91dChkZXYsIG91dGJ1ZiArIHJlc3BfbGVu
LCBzdGFydF9mZWF0dXJlLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHJlcV90eXBlKTsKKyAgICAgICAgICAgIGJyZWFrOworICAgICAgICBkZWZh
dWx0OgorICAgICAgICAgICAgYnJlYWs7CisgICAgICAgIH0KKyAgICAgICAgYnJlYWs7CisKKyAg
ICBkZWZhdWx0OgorICAgICAgICBTUElDRV9ERUJVRygiZ2V0X2NvbmZpZ3VyYXRpb24sIGx1bjol
dSBpbnZhbGlkIHJ0OiV1IHN0YXJ0X2Y6JXUiLAorICAgICAgICAgICAgICAgICAgICByZXEtPmx1
biwgcmVxX3R5cGUsIHN0YXJ0X2ZlYXR1cmUpOworICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0
ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZBTElEX0NEQl9GSUVMRCk7Cisg
ICAgICAgIHJldHVybjsKKyAgICB9CisKKyAgICAvKiBzZXQgdG90YWwgZGF0YSBsZW4gKi8KKyAg
ICBvdXRidWZbMF0gPSAocmVzcF9sZW4gPj4gMjQpICYgMHhmZjsKKyAgICBvdXRidWZbMV0gPSAo
cmVzcF9sZW4gPj4gMTYpICYgMHhmZjsKKyAgICBvdXRidWZbMl0gPSAocmVzcF9sZW4gPj4gOCkg
JiAweGZmOworICAgIG91dGJ1ZlszXSA9IHJlc3BfbGVuICYgMHhmZjsKKworICAgIC8qIHJlcG9y
dCBjdXJyZW50IHByb2ZpbGUgbnVtICovCisgICAgb3V0YnVmWzZdID0gKHByb2ZpbGVfbnVtID4+
IDgpICYgMHhmZjsKKyAgICBvdXRidWZbN10gPSBwcm9maWxlX251bSAmIDB4ZmY7CisKKyAgICBy
ZXEtPmluX2xlbiA9IE1JTihyZXEtPnJlcV9sZW4sIHJlc3BfbGVuKTsKKworICAgIFNQSUNFX0RF
QlVHKCJnZXRfY29uZmlndXJhdGlvbiwgbHVuOiV1IHJ0OiV1IHN0YXJ0X2Y6JXUgcmVzcF9sZW46
JXUiLAorICAgICAgICAgICAgICAgIHJlcS0+bHVuLCByZXFfdHlwZSwgc3RhcnRfZmVhdHVyZSwg
cmVzcF9sZW4pOworCisgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfZ29vZChkZXYsIHJlcSk7Cit9
CisKKyNkZWZpbmUgQ0RfR0VUX0VWRU5UX1NUQVRVU19JTU1FRCAgICAgICAgICAgIDB4MDEKKwor
I2RlZmluZSBDRF9HRVRfRVZFTlRfSEVBREVSX05PX0VWRU5UX0FWQUlMICAoMHgwMSA8PCA3KQor
I2RlZmluZSBDRF9HRVRfRVZFTlRfSEVBREVSX0xFTiAgICAgICAgICAgICA0CisKKyNkZWZpbmUg
Q0RfR0VUX0VWRU5UX0NMQVNTX05PTkUgICAgICAgICAgICAgKDB4MDApCisjZGVmaW5lIENEX0dF
VF9FVkVOVF9DTEFTU19PUEVSX0NIQU5HRSAgICAgICgweDAxKQorI2RlZmluZSBDRF9HRVRfRVZF
TlRfQ0xBU1NfUE9XRVJfTUdNVCAgICAgICAoMHgwMikKKyNkZWZpbmUgQ0RfR0VUX0VWRU5UX0NM
QVNTX0VYVEVSTkFMX1JFUSAgICAgKDB4MDMpCisjZGVmaW5lIENEX0dFVF9FVkVOVF9DTEFTU19N
RURJQSAgICAgICAgICAgICgweDA0KQorI2RlZmluZSBDRF9HRVRfRVZFTlRfQ0xBU1NfTVVMVElf
SU5JVElBVE9SICAoMHgwNSkKKyNkZWZpbmUgQ0RfR0VUX0VWRU5UX0NMQVNTX0RFVl9CVVNZICAg
ICAgICAgKDB4MDYpCisKKyNkZWZpbmUgQ0RfR0VUX0VWRU5UX0xFTl9NRURJQSAgICAgICAgICAg
ICAgNAorCisjZGVmaW5lIENEX01FRElBX1NUQVRVU19NRURJQV9QUkVTRU5UICAgICAgIDB4MQor
I2RlZmluZSBDRF9NRURJQV9TVEFUVVNfVFJBWV9PUEVOICAgICAgICAgICAweDIKKworc3RhdGlj
IHVpbnQzMl90IGNkX3Njc2lfY21kX2dldF9ldmVudF9yZXNwX2FkZF9tZWRpYShDZFNjc2lMVSAq
ZGV2LCB1aW50OF90ICpvdXRidWYpCit7CisgICAgb3V0YnVmWzBdID0gKHVpbnQ4X3QpZGV2LT5t
ZWRpYV9ldmVudCAmIDB4MGY7CisgICAgb3V0YnVmWzFdID0gKHVpbnQ4X3QpKChkZXYtPmxvYWRl
ZCA/IDAgOiBDRF9NRURJQV9TVEFUVVNfVFJBWV9PUEVOKSB8CisgICAgICAgICAgICAgICAgICAg
ICAgICAgIChkZXYtPnN0cmVhbSAhPSBOVUxMID8gQ0RfTUVESUFfU1RBVFVTX01FRElBX1BSRVNF
TlQgOiAwKSk7CisKKyAgICBkZXYtPm1lZGlhX2V2ZW50ID0gQ0RfTUVESUFfRVZFTlRfTk9fQ0hB
TkdFOyAvKiByZXNldCB0aGUgZXZlbnQgKi8KKyAgICByZXR1cm4gQ0RfR0VUX0VWRU5UX0xFTl9N
RURJQTsKK30KKworI2RlZmluZSBDRF9HRVRfRVZFTlRfTEVOX1BPV0VSICAgICAgICAgICAgICA0
CisKKyNkZWZpbmUgQ0RfUE9XRVJfU1RBVFVTX0FDVElWRSAgICAgICAgICAgICAgMHgxCisjZGVm
aW5lIENEX1BPV0VSX1NUQVRVU19JRExFICAgICAgICAgICAgICAgIDB4MgorCitzdGF0aWMgdWlu
dDMyX3QgY2Rfc2NzaV9jbWRfZ2V0X2V2ZW50X3Jlc3BfYWRkX3Bvd2VyKENkU2NzaUxVICpkZXYs
IHVpbnQ4X3QgKm91dGJ1ZikKK3sKKyAgICBvdXRidWZbMF0gPSAodWludDhfdClkZXYtPnBvd2Vy
X2V2ZW50ICYgMHgwZjsKKyAgICBvdXRidWZbMV0gPSAodWludDhfdCkoKGRldi0+cG93ZXJfY29u
ZCA9PSBDRF9TQ1NJX1BPV0VSX0FDVElWRSkgPworICAgICAgICAgICAgICAgICAgICAgICAgICAg
Q0RfUE9XRVJfU1RBVFVTX0FDVElWRSA6IENEX1BPV0VSX1NUQVRVU19JRExFKTsKKworICAgIGRl
di0+cG93ZXJfZXZlbnQgPSBDRF9QT1dFUl9FVkVOVF9OT19DSEFOR0U7IC8qIHJlc2V0IHRoZSBl
dmVudCAqLworICAgIHJldHVybiBDRF9HRVRfRVZFTlRfTEVOX1BPV0VSOworfQorCitzdGF0aWMg
dm9pZCBjZF9zY3NpX2NtZF9nZXRfZXZlbnRfc3RhdHVzX25vdGlmaWNhdGlvbihDZFNjc2lMVSAq
ZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgdWludDhfdCAqb3V0YnVmID0gcmVxLT5i
dWY7CisgICAgdWludDMyX3QgcmVzcF9sZW4gPSBDRF9HRVRfRVZFTlRfSEVBREVSX0xFTjsKKyAg
ICBjb25zdCB1aW50MzJfdCBwb3dlcl9jbGFzc19tYXNrID0gKDB4MDEgPDwgQ0RfR0VUX0VWRU5U
X0NMQVNTX1BPV0VSX01HTVQpOworICAgIGNvbnN0IHVpbnQzMl90IG1lZGlhX2NsYXNzX21hc2sg
PSAoMHgwMSA8PCBDRF9HRVRfRVZFTlRfQ0xBU1NfTUVESUEpOworICAgIHVpbnQzMl90IGNsYXNz
ZXNfc3VwcG9ydGVkID0gIHBvd2VyX2NsYXNzX21hc2sgfCBtZWRpYV9jbGFzc19tYXNrOworICAg
IHVpbnQzMl90IGltbWVkLCBjbGFzc2VzX3JlcXVlc3RlZDsKKworICAgIHJlcS0+eGZlcl9kaXIg
PSBTQ1NJX1hGRVJfRlJPTV9ERVY7CisKKyAgICBpbW1lZCA9IHJlcS0+Y2RiWzFdICYgQ0RfR0VU
X0VWRU5UX1NUQVRVU19JTU1FRDsKKyAgICBjbGFzc2VzX3JlcXVlc3RlZCA9IHJlcS0+Y2RiWzRd
OworICAgIHJlcS0+cmVxX2xlbiA9IChyZXEtPmNkYls3XSA8PCA4KSB8IHJlcS0+Y2RiWzhdOwor
CisgICAgaWYgKCFpbW1lZCkgeworICAgICAgICBTUElDRV9ERUJVRygiZ2V0X2V2ZW50X3N0YXR1
c19ub3RpZmljYXRpb24sIGx1bjoldSIKKyAgICAgICAgICAgICAgICAiIGltbTowIGNsYXNzX3Jl
cTolMDJ4LCBOb24taW1tZWRpYXRlIChhc3luYykgbW9kZSB1bnN1cHBvcnRlZCIsCisgICAgICAg
ICAgICAgICAgcmVxLT5sdW4sIGNsYXNzZXNfcmVxdWVzdGVkKTsKKyAgICAgICAgY2Rfc2NzaV9j
bWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfSU5WQUxJRF9DREJf
RklFTEQpOworICAgICAgICByZXR1cm47CisgICAgfQorCisgICAgbWVtc2V0KG91dGJ1ZiwgMCwg
cmVxLT5yZXFfbGVuKTsKKyAgICBpZiAoKGNsYXNzZXNfc3VwcG9ydGVkICYgY2xhc3Nlc19yZXF1
ZXN0ZWQpICE9IDApIHsKKyAgICAgICAgaWYgKGNsYXNzZXNfcmVxdWVzdGVkICYgcG93ZXJfY2xh
c3NfbWFzaykgeworICAgICAgICAgICAgb3V0YnVmWzJdID0gQ0RfR0VUX0VWRU5UX0NMQVNTX1BP
V0VSX01HTVQ7CisgICAgICAgICAgICBvdXRidWZbM10gPSAodWludDhfdClwb3dlcl9jbGFzc19t
YXNrOworCisgICAgICAgICAgICBTUElDRV9ERUJVRygiZ2V0X2V2ZW50X3N0YXR1c19ub3RpZmlj
YXRpb24sIGx1bjoldSIKKyAgICAgICAgICAgICAgICAgICAgICAgICIgaW1tOiV1IGNsYXNzX3Jl
cToweCUwMnggY2xhc3Nfc3VwOjB4JTAyeCIKKyAgICAgICAgICAgICAgICAgICAgICAgICIgcG93
ZXJfZXZlbnQ6MHglMDJ4IHBvd2VyX2NvbmQ6MHglMDJ4IiwKKyAgICAgICAgICAgICAgICAgICAg
ICAgIHJlcS0+bHVuLCBpbW1lZCwgY2xhc3Nlc19yZXF1ZXN0ZWQsIGNsYXNzZXNfc3VwcG9ydGVk
LAorICAgICAgICAgICAgICAgICAgICAgICAgZGV2LT5wb3dlcl9ldmVudCwgZGV2LT5wb3dlcl9j
b25kKTsKKworICAgICAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9jbWRfZ2V0X2V2ZW50X3Jl
c3BfYWRkX3Bvd2VyKGRldiwgb3V0YnVmICsgcmVzcF9sZW4pOworICAgICAgICB9IGVsc2UgaWYg
KGNsYXNzZXNfcmVxdWVzdGVkICYgbWVkaWFfY2xhc3NfbWFzaykgeworICAgICAgICAgICAgb3V0
YnVmWzJdID0gQ0RfR0VUX0VWRU5UX0NMQVNTX01FRElBOworICAgICAgICAgICAgb3V0YnVmWzNd
ID0gKHVpbnQ4X3QpbWVkaWFfY2xhc3NfbWFzazsKKworICAgICAgICAgICAgU1BJQ0VfREVCVUco
ImdldF9ldmVudF9zdGF0dXNfbm90aWZpY2F0aW9uLCBsdW46JXUiCisgICAgICAgICAgICAgICAg
ICAgICAgICAiIGltbToldSBjbGFzc19yZXE6MHglMDJ4IGNsYXNzX3N1cDoweCUwMngiCisgICAg
ICAgICAgICAgICAgICAgICAgICAiIG1lZGlhX2V2ZW50OjB4JTAyeCBsb2FkZWQ6ICVkIiwKKyAg
ICAgICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBpbW1lZCwgY2xhc3Nlc19yZXF1ZXN0ZWQs
IGNsYXNzZXNfc3VwcG9ydGVkLAorICAgICAgICAgICAgICAgICAgICAgICAgZGV2LT5tZWRpYV9l
dmVudCwgZGV2LT5sb2FkZWQpOworCisgICAgICAgICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2Nt
ZF9nZXRfZXZlbnRfcmVzcF9hZGRfbWVkaWEoZGV2LCBvdXRidWYgKyByZXNwX2xlbik7CisgICAg
ICAgIH0KKyAgICB9IGVsc2UgeworICAgICAgICBvdXRidWZbMl0gPSBDRF9HRVRfRVZFTlRfSEVB
REVSX05PX0VWRU5UX0FWQUlMIHwgQ0RfR0VUX0VWRU5UX0NMQVNTX05PTkU7CisKKyAgICAgICAg
U1BJQ0VfREVCVUcoImdldF9ldmVudF9zdGF0dXNfbm90aWZpY2F0aW9uLCBsdW46JXUiCisgICAg
ICAgICAgICAgICAgICAgICIgaW1tOiV1IGNsYXNzX3JlcToweCUwMnggY2xhc3Nfc3VwOjB4JTAy
eCIKKyAgICAgICAgICAgICAgICAgICAgIiBub25lIG9mIHJlcXVlc3RlZCBldmVudHMgc3VwcG9y
dGVkIiwKKyAgICAgICAgICAgICAgICAgICAgcmVxLT5sdW4sIGltbWVkLCBjbGFzc2VzX3JlcXVl
c3RlZCwgY2xhc3Nlc19zdXBwb3J0ZWQpOworICAgIH0KKyAgICBvdXRidWZbMV0gPSAodWludDhf
dCkocmVzcF9sZW4gLSAyKTsgLyogRXZlbnQgRGF0YSBMZW5ndGggTFNCLCBsZW5ndGggZXhjbHVk
aW5nIHRoZQorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBmaWVs
ZCBpdHNlbGYgKi8KKyAgICBvdXRidWZbM10gPSAodWludDhfdCljbGFzc2VzX3N1cHBvcnRlZDsK
KworICAgIHJlcS0+aW5fbGVuID0gTUlOKHJlcS0+cmVxX2xlbiwgcmVzcF9sZW4pOworICAgIGNk
X3Njc2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2LCByZXEpOworfQorCisjZGVmaW5lIENEX0VYVF9S
RVFfRVZFTlRfRk9STUFUX05PX0NIRyAgICAgICAgICAweDAwCisjZGVmaW5lIENEX0VYVF9SRVFf
RVZFTlRfRk9STUFUX0xVX0tFWV9ET1dOICAgICAweDAxCisjZGVmaW5lIENEX0VYVF9SRVFfRVZF
TlRfRk9STUFUX0xVX0tFWV9VUCAgICAgICAweDAyCisjZGVmaW5lIENEX0VYVF9SRVFfRVZFTlRf
Rk9STUFUX1JFUV9OT1RJRlkgICAgICAweDAzCisKKyNkZWZpbmUgQ0RfRVhUX1JFUV9TVEFUVVNf
UkVBRFkgICAgICAgICAgICAgICAgIDB4MDAKKyNkZWZpbmUgQ0RfRVhUX1JFUV9TVEFUVVNfT1RI
RVJfUFJFVkVOVCAgICAgICAgIDB4MDEKKworI2RlZmluZSBDRF9FWFRfUkVRX0NPREVfTk9fUkVR
VUVTVCAgICAgICAgICAgICAgMHgwMAorI2RlZmluZSBDRF9FWFRfUkVRX0NPREVfT1ZFUlJVTiAg
ICAgICAgICAgICAgICAgMHgwMQorI2RlZmluZSBDRF9FWFRfUkVRX0NPREVfUExBWSAgICAgICAg
ICAgICAgICAgICAgMHgxMDEKKyNkZWZpbmUgQ0RfRVhUX1JFUV9DT0RFX1JFV0lORCAgICAgICAg
ICAgICAgICAgIDB4MTAyCisjZGVmaW5lIENEX0VYVF9SRVFfQ09ERV9GQVNUX0ZXICAgICAgICAg
ICAgICAgICAweDEwMworI2RlZmluZSBDRF9FWFRfUkVRX0NPREVfUEFVU0UgICAgICAgICAgICAg
ICAgICAgMHgxMDQKKyNkZWZpbmUgQ0RfRVhUX1JFUV9DT0RFX1NUT1AgICAgICAgICAgICAgICAg
ICAgIDB4MTA2CisjZGVmaW5lIENEX0VYVF9SRVFfQ09ERV9BU0NJSV9CQVNFICAgICAgICAgICAg
ICAweDIwMCAvKiBTQ1NJSSB2YWx1ZSBpcyBMU0IgKi8KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9j
bWRfc2VuZF9ldmVudChDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAg
dWludDhfdCAqcGFyYW0sICpldmVudDsKKyAgICB1aW50MzJfdCBpbW1lZCwgcGFyYW1fbGlzdF9s
ZW47CisgICAgdWludDMyX3QgZXZlbnRfcGFyYW1fbGVuLCBub3RpZmljYXRpb25fY2xhc3M7Cisg
ICAgdWludDMyX3QgZXh0X3JlcV9ldmVudCwgZXh0X3JlcV9zdGF0dXMsIHBlcnNfcHJldmVudCwg
ZXh0X3JlcV9jb2RlOworCisgICAgcmVxLT54ZmVyX2RpciA9IFNDU0lfWEZFUl9UT19ERVY7CisK
KyAgICBpbW1lZCA9IHJlcS0+Y2RiWzFdICYgMHgwMTsKKyAgICBwYXJhbV9saXN0X2xlbiA9IChy
ZXEtPmNkYls4XSA8PCA4KSB8IHJlcS0+Y2RiWzldOworCisgICAgaWYgKHJlcS0+YnVmX2xlbiA8
IHBhcmFtX2xpc3RfbGVuKSB7CisgICAgICAgIFNQSUNFX0RFQlVHKCJzZW5kX2V2ZW50LCBsdW46
JXUgaW52YWxpZCBwYXJhbSBsaXN0IGxlbjoweCV4LCBidWZfbGVuOjB4JXgiLAorICAgICAgICAg
ICAgICAgICAgICByZXEtPmx1biwgcGFyYW1fbGlzdF9sZW4sIHJlcS0+YnVmX2xlbik7CisgICAg
ICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2Rl
X0lOVkFMSURfUEFSQU1fTEVOKTsKKyAgICAgICAgcmV0dXJuOworICAgIH0KKyAgICBwYXJhbSA9
IHJlcS0+YnVmOworICAgIGV2ZW50X3BhcmFtX2xlbiA9IChwYXJhbVswXSA8PCA4KSB8IHBhcmFt
WzFdOworCisgICAgbm90aWZpY2F0aW9uX2NsYXNzID0gcGFyYW1bMl0gJiAweDA3OworICAgIGlm
IChub3RpZmljYXRpb25fY2xhc3MgIT0gQ0RfR0VUX0VWRU5UX0NMQVNTX0VYVEVSTkFMX1JFUSkg
eworICAgICAgICBTUElDRV9ERUJVRygic2VuZF9ldmVudCwgbHVuOiV1IGludmFsaWQgbm90aWZp
Y2F0aW9uIGNsYXNzOjB4JXgiLAorICAgICAgICAgICAgICAgICAgICByZXEtPmx1biwgbm90aWZp
Y2F0aW9uX2NsYXNzKTsKKyAgICAgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChk
ZXYsIHJlcSwgJnNlbnNlX2NvZGVfSU5WQUxJRF9DREJfRklFTEQpOworICAgICAgICByZXR1cm47
CisgICAgfQorCisgICAgZXZlbnQgPSBwYXJhbSArIENEX0dFVF9FVkVOVF9IRUFERVJfTEVOOwor
ICAgIGV4dF9yZXFfZXZlbnQgPSBldmVudFswXSAmIDB4ZmY7CisgICAgZXh0X3JlcV9zdGF0dXMg
PSBldmVudFsxXSAmIDB4MGY7CisgICAgcGVyc19wcmV2ZW50ID0gZXZlbnRbMV0gJiAweDgwOwor
ICAgIGV4dF9yZXFfY29kZSA9IChldmVudFsyXSA8PCA4KSB8IGV2ZW50WzNdOworCisgICAgU1BJ
Q0VfREVCVUcoInNlbmRfZXZlbnQsIGx1bjoweCV1IGltbWVkOiV1IHBhcmFtX2xlbjoldSIKKyAg
ICAgICAgICAgICAgICAiIGV4dF9yZXFfZXZlbnQ6MHgleCBleHRfcmVxX3N0YXR1czoweCV4Igor
ICAgICAgICAgICAgICAgICIgcGVyc19wcmV2ZW50OjB4JXggZXh0X3JlcV9jb2RlOjB4JXgiLAor
ICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBpbW1lZCwgZXZlbnRfcGFyYW1fbGVuLCBleHRfcmVx
X2V2ZW50LAorICAgICAgICAgICAgICAgIGV4dF9yZXFfc3RhdHVzLCBwZXJzX3ByZXZlbnQsIGV4
dF9yZXFfY29kZSk7CisKKyAgICAvKiBUb0RvOiBwcm9jZXNzIHRoZSBldmVudCAqLworCisgICAg
Y2Rfc2NzaV9jbWRfY29tcGxldGVfZ29vZChkZXYsIHJlcSk7Cit9CisKKyNkZWZpbmUgQ0RfTUVE
SVVNX1JFTU9WQUxfUkVRX0FMTE9XICAgICAgICAgICAgICAgICAweDAwCisjZGVmaW5lIENEX01F
RElVTV9SRU1PVkFMX1JFUV9QUkVWRU5UICAgICAgICAgICAgICAgMHgwMQorI2RlZmluZSBDRF9N
RURJVU1fUkVNT1ZBTF9SRVFfQUxMT1dfQ0hBTkdFUiAgICAgICAgIDB4MDIKKyNkZWZpbmUgQ0Rf
TUVESVVNX1JFTU9WQUxfUkVRX1BSRVZFTlRfQ0hBTkdFUiAgICAgICAweDAzCisKK3N0YXRpYyB2
b2lkIGNkX3Njc2lfY21kX2FsbG93X21lZGl1bV9yZW1vdmFsKENkU2NzaUxVICpkZXYsIENkU2Nz
aVJlcXVlc3QgKnJlcSkKK3sKKyAgICB1aW50MzJfdCBwcmV2ZW50OworCisgICAgcmVxLT54ZmVy
X2RpciA9IFNDU0lfWEZFUl9GUk9NX0RFVjsKKworICAgIHByZXZlbnQgPSByZXEtPmNkYls0XSAm
IDB4MDM7CisgICAgZGV2LT5wcmV2ZW50X21lZGlhX3JlbW92YWwgPSAocHJldmVudCA9PSBDRF9N
RURJVU1fUkVNT1ZBTF9SRVFfUFJFVkVOVCB8fAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHByZXZlbnQgPT0gQ0RfTUVESVVNX1JFTU9WQUxfUkVRX1BSRVZFTlRfQ0hBTkdFUik7
CisgICAgcmVxLT5pbl9sZW4gPSAwOworCisgICAgU1BJQ0VfREVCVUcoImFsbG93X21lZGl1bV9y
ZW1vdmFsLCBsdW46JXUgcHJldmVudCBmaWVsZDo6MHglMDJ4IGZsYWc6JWQiLAorICAgICAgICAg
ICAgICAgIHJlcS0+bHVuLCBwcmV2ZW50LCBkZXYtPnByZXZlbnRfbWVkaWFfcmVtb3ZhbCk7CisK
KyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworc3RhdGljIHZv
aWQgY2Rfc2NzaV9jbWRfcmVwb3J0X2tleShDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpy
ZXEpCit7CisgICAgU1BJQ0VfREVCVUcoInJlcG9ydF9rZXkgLSBjb250ZW50IHByb3RlY3Rpb24g
dW5zdXBwb3J0ZWQsIGx1bjoldSIsIHJlcS0+bHVuKTsKKyAgICByZXEtPnhmZXJfZGlyID0gU0NT
SV9YRkVSX05PTkU7CisgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJl
cSwgJnNlbnNlX2NvZGVfSU5WQUxJRF9PUENPREUpOworfQorCitzdGF0aWMgdm9pZCBjZF9zY3Np
X2NtZF9zZW5kX2tleShDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAg
U1BJQ0VfREVCVUcoInNlbmRfa2V5IC0gY29udGVudCBwcm90ZWN0aW9uIHVuc3VwcG9ydGVkLCBs
dW46JXUiLCByZXEtPmx1bik7CisgICAgcmVxLT54ZmVyX2RpciA9IFNDU0lfWEZFUl9OT05FOwor
ICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2Rl
X0lOVkFMSURfT1BDT0RFKTsKK30KKworLyogYnl0ZSAxICovCisjZGVmaW5lIENEX1NUQVJUX1NU
T1BfRkxBR19JTU1FRCAgICAgICAgICAgICAgICAgICAgMHgwMQorCisvKiBieXRlIDQgKi8KKyNk
ZWZpbmUgQ0RfU1RBUlRfU1RPUF9GTEFHX1NUQVJUICAgICAgICAgICAgICAgICAgICAweDAxCisj
ZGVmaW5lIENEX1NUQVJUX1NUT1BfRkxBR19MT0VKICAgICAgICAgICAgICAgICAgICAgMHgwMgor
CisvKiBQT1dFUiBDT05ESVRJT04gZmllbGQgdmFsdWVzICovCisjZGVmaW5lIENEX1NUQVJUX1NU
T1BfUE9XRVJfQ09ORF9TVEFSVF9WQUxJRCAgICAgICAgMHgwMAorI2RlZmluZSBDRF9TVEFSVF9T
VE9QX1BPV0VSX0NPTkRfQUNUSVZFICAgICAgICAgICAgIDB4MDEKKyNkZWZpbmUgQ0RfU1RBUlRf
U1RPUF9QT1dFUl9DT05EX0lETEUgICAgICAgICAgICAgICAweDAyCisjZGVmaW5lIENEX1NUQVJU
X1NUT1BfUE9XRVJfQ09ORF9TVEFOREJZICAgICAgICAgICAgMHgwMworI2RlZmluZSBDRF9TVEFS
VF9TVE9QX1BPV0VSX0NPTkRfTFVfQ09OVFJPTCAgICAgICAgIDB4MDcKKyNkZWZpbmUgQ0RfU1RB
UlRfU1RPUF9QT1dFUl9DT05EX0ZPUkNFX0lETEVfMCAgICAgICAweDBhCisjZGVmaW5lIENEX1NU
QVJUX1NUT1BfUE9XRVJfQ09ORF9GT1JDRV9TVEFOREJZXzAgICAgMHgwYgorCitzdGF0aWMgaW5s
aW5lIGNvbnN0IGNoYXIgKmNkX3Njc2lfc3RhcnRfc3RvcF9wb3dlcl9jb25kX25hbWUodWludDMy
X3QgcG93ZXJfY29uZCkKK3sKKyAgICBzd2l0Y2ggKHBvd2VyX2NvbmQpIHsKKyAgICBjYXNlIENE
X1NUQVJUX1NUT1BfUE9XRVJfQ09ORF9TVEFSVF9WQUxJRDoKKyAgICAgICAgcmV0dXJuICJTVEFS
VF9WQUxJRCI7CisgICAgY2FzZSBDRF9TVEFSVF9TVE9QX1BPV0VSX0NPTkRfQUNUSVZFOgorICAg
ICAgICByZXR1cm4gIkFDVElWRSI7CisgICAgY2FzZSBDRF9TVEFSVF9TVE9QX1BPV0VSX0NPTkRf
SURMRToKKyAgICAgICAgcmV0dXJuICJJRExFIjsKKyAgICBjYXNlIENEX1NUQVJUX1NUT1BfUE9X
RVJfQ09ORF9TVEFOREJZOgorICAgICAgICByZXR1cm4gIlNUQU5EQlkiOworICAgIGNhc2UgQ0Rf
U1RBUlRfU1RPUF9QT1dFUl9DT05EX0xVX0NPTlRST0w6CisgICAgICAgIHJldHVybiAiTFVfQ09O
VFJPTCI7CisgICAgY2FzZSBDRF9TVEFSVF9TVE9QX1BPV0VSX0NPTkRfRk9SQ0VfSURMRV8wOgor
ICAgICAgICByZXR1cm4gIkZPUkNFX0lETEVfMCI7CisgICAgY2FzZSBDRF9TVEFSVF9TVE9QX1BP
V0VSX0NPTkRfRk9SQ0VfU1RBTkRCWV8wOgorICAgICAgICByZXR1cm4gIkZPUkNFX1NUQU5EQllf
MCI7CisgICAgZGVmYXVsdDoKKyAgICAgICAgcmV0dXJuICJSRVNFUlZFRCI7CisgICAgfQorfQor
CitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9zdGFydF9zdG9wX3VuaXQoQ2RTY3NpTFUgKmRldiwg
Q2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAgIGdib29sZWFuIGltbWVkLCBzdGFydCwgbG9hZF9l
amVjdDsKKyAgICB1aW50MzJfdCBwb3dlcl9jb25kOworCisgICAgcmVxLT54ZmVyX2RpciA9IFND
U0lfWEZFUl9OT05FOworICAgIHJlcS0+aW5fbGVuID0gMDsKKworICAgIGltbWVkID0gKHJlcS0+
Y2RiWzFdICYgQ0RfU1RBUlRfU1RPUF9GTEFHX0lNTUVEKSA/IFRSVUUgOiBGQUxTRTsKKyAgICBz
dGFydCA9IChyZXEtPmNkYls0XSAmIENEX1NUQVJUX1NUT1BfRkxBR19TVEFSVCkgPyBUUlVFIDog
RkFMU0U7CisgICAgbG9hZF9lamVjdCA9IChyZXEtPmNkYls0XSAmIENEX1NUQVJUX1NUT1BfRkxB
R19MT0VKKSA/IFRSVUUgOiBGQUxTRTsKKyAgICBwb3dlcl9jb25kID0gcmVxLT5jZGJbNF0gPj4g
NDsKKworICAgIFNQSUNFX0RFQlVHKCJzdGFydF9zdG9wX3VuaXQsIGx1bjoweCV1IgorICAgICAg
ICAgICAgICAgICIgaW1tZWQ6JWQgc3RhcnQ6JWQgbG9hZF9lamVjdDolZCBwb3dlcl9jb25kOjB4
JXgoJXMpIiwKKyAgICAgICAgICAgICAgICByZXEtPmx1biwgaW1tZWQsIHN0YXJ0LCBsb2FkX2Vq
ZWN0LCBwb3dlcl9jb25kLAorICAgICAgICAgICAgICAgIGNkX3Njc2lfc3RhcnRfc3RvcF9wb3dl
cl9jb25kX25hbWUocG93ZXJfY29uZCkpOworCisgICAgc3dpdGNoIChwb3dlcl9jb25kKSB7Cisg
ICAgY2FzZSBDRF9TVEFSVF9TVE9QX1BPV0VSX0NPTkRfU1RBUlRfVkFMSUQ6CisgICAgICAgIGlm
ICghc3RhcnQpIHsgLyogc3RvcCB0aGUgdW5pdCAqLworICAgICAgICAgICAgaWYgKGxvYWRfZWpl
Y3QpIHsgLyogZWplY3QgbWVkaXVtICovCisgICAgICAgICAgICAgICAgaWYgKGRldi0+cHJldmVu
dF9tZWRpYV9yZW1vdmFsKSB7CisgICAgICAgICAgICAgICAgICAgIFNQSUNFX0RFQlVHKCJzdGFy
dF9zdG9wX3VuaXQsIGx1bjoweCV1IgorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAi
IHByZXZlbnRfbWVkaWFfcmVtb3ZhbCBzZXQsIGVqZWN0IGZhaWxlZCIsIHJlcS0+bHVuKTsKKyAg
ICAgICAgICAgICAgICAgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJl
cSwgJnNlbnNlX2NvZGVfTUVESVVNX1JFTU9WQUxfUFJFVkVOVEVEKTsKKyAgICAgICAgICAgICAg
ICAgICAgcmV0dXJuOworICAgICAgICAgICAgICAgIH0KKyAgICAgICAgICAgICAgICBTUElDRV9E
RUJVRygic3RhcnRfc3RvcF91bml0LCBsdW46MHgldSBlamVjdCIsIHJlcS0+bHVuKTsKKyAgICAg
ICAgICAgICAgICBjZF9zY3NpX2x1X3VubG9hZChkZXYpOworICAgICAgICAgICAgICAgIGNkX3Nj
c2lfZGV2X2NoYW5nZWQoZGV2LT50Z3QtPnVzZXJfZGF0YSwgcmVxLT5sdW4pOworICAgICAgICAg
ICAgfQorICAgICAgICAgICAgZGV2LT5wb3dlcl9jb25kID0gQ0RfU0NTSV9QT1dFUl9TVE9QUEVE
OworICAgICAgICAgICAgU1BJQ0VfREVCVUcoInN0YXJ0X3N0b3BfdW5pdCwgbHVuOjB4JXUgc3Rv
cHBlZCIsIHJlcS0+bHVuKTsKKyAgICAgICAgfSBlbHNlIHsgLyogc3RhcnQgdGhlIHVuaXQgKi8K
KyAgICAgICAgICAgIGRldi0+cG93ZXJfY29uZCA9IENEX1NDU0lfUE9XRVJfQUNUSVZFOworICAg
ICAgICAgICAgU1BJQ0VfREVCVUcoInN0YXJ0X3N0b3BfdW5pdCwgbHVuOjB4JXUgc3RhcnRlZCIs
IHJlcS0+bHVuKTsKKworICAgICAgICAgICAgaWYgKGxvYWRfZWplY3QpIHsgLyogbG9hZCBtZWRp
dW0gKi8KKyAgICAgICAgICAgICAgICBTUElDRV9ERUJVRygic3RhcnRfc3RvcF91bml0LCBsdW46
MHgldSBsb2FkIHdpdGggbm8gbWVkaWEiLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJl
cS0+bHVuKTsKKyAgICAgICAgICAgICAgICBjZF9zY3NpX2x1X2xvYWQoZGV2LCBOVUxMKTsKKyAg
ICAgICAgICAgICAgICBjZF9zY3NpX2Rldl9jaGFuZ2VkKGRldi0+dGd0LT51c2VyX2RhdGEsIHJl
cS0+bHVuKTsKKyAgICAgICAgICAgIH0KKyAgICAgICAgfQorICAgICAgICBicmVhazsKKyAgICBj
YXNlIENEX1NUQVJUX1NUT1BfUE9XRVJfQ09ORF9BQ1RJVkU6CisgICAgICAgIC8qIG5vdCBlcnJv
ciB0byBzcGVjaWZ5IHRyYW5zaXRpb24gdG8gdGhlIGN1cnJlbnQgcG93ZXIgY29uZGl0aW9uICov
CisgICAgICAgIGRldi0+cG93ZXJfY29uZCA9IENEX1NDU0lfUE9XRVJfQUNUSVZFOworICAgICAg
ICBTUElDRV9ERUJVRygic3RhcnRfc3RvcF91bml0LCBsdW46MHgldSBhY3RpdmUiLCByZXEtPmx1
bik7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgQ0RfU1RBUlRfU1RPUF9QT1dFUl9DT05EX0lE
TEU6CisgICAgY2FzZSBDRF9TVEFSVF9TVE9QX1BPV0VSX0NPTkRfRk9SQ0VfSURMRV8wOgorICAg
ICAgICBkZXYtPnBvd2VyX2NvbmQgPSBDRF9TQ1NJX1BPV0VSX0lETEU7CisgICAgICAgIFNQSUNF
X0RFQlVHKCJzdGFydF9zdG9wX3VuaXQsIGx1bjoweCV1IGlkbGUiLCByZXEtPmx1bik7CisgICAg
ICAgIGJyZWFrOworICAgIGNhc2UgQ0RfU1RBUlRfU1RPUF9QT1dFUl9DT05EX1NUQU5EQlk6Cisg
ICAgY2FzZSBDRF9TVEFSVF9TVE9QX1BPV0VSX0NPTkRfRk9SQ0VfU1RBTkRCWV8wOgorICAgICAg
ICBkZXYtPnBvd2VyX2NvbmQgPSBDRF9TQ1NJX1BPV0VSX1NUQU5EQlk7CisgICAgICAgIFNQSUNF
X0RFQlVHKCJzdGFydF9zdG9wX3VuaXQsIGx1bjoweCV1IHN0YW5kYnkiLCByZXEtPmx1bik7Cisg
ICAgICAgIGJyZWFrOworICAgIGNhc2UgQ0RfU1RBUlRfU1RPUF9QT1dFUl9DT05EX0xVX0NPTlRS
T0w6CisgICAgICAgIGJyZWFrOworICAgIGRlZmF1bHQ6CisgICAgICAgIGNkX3Njc2lfY21kX2Nv
bXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX0lOVkFMSURfQ0RCX0ZJRUxE
KTsKKyAgICAgICAgcmV0dXJuOworICAgIH0KKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29k
KGRldiwgcmVxKTsKK30KKworI2RlZmluZSBDRF9QRVJGX1RZUEVfUEVSRk9STUFOQ0UgICAgICAg
ICAgICAgICAgMHgwMAorI2RlZmluZSBDRF9QRVJGX1RZUEVfVU5VU0FCTEVfQVJFQSAgICAgICAg
ICAgICAgMHgwMQorI2RlZmluZSBDRF9QRVJGX1RZUEVfREVGRUNUX1NUQVRVUyAgICAgICAgICAg
ICAgMHgwMgorI2RlZmluZSBDRF9QRVJGX1RZUEVfV1JJVEVfU1BFRUQgICAgICAgICAgICAgICAg
MHgwMworCisjZGVmaW5lIENEX1BFUkZfSEVBREVSX0xFTiAgICAgICAgICAgICAgICAgICAgICA4
CisKKyNkZWZpbmUgQ0RfUEVSRl9UWVBFX1BFUkZPUk1BTkNFX0RFU0NSX0xFTiAgICAgIDE2CisK
KyNkZWZpbmUgQ0RfUEVSRl9UWVBFX1BFUkZPUk1BTkNFX1JFUE9SVF9OT01JTkFMIDB4MDAKKyNk
ZWZpbmUgQ0RfUEVSRl9UWVBFX1BFUkZPUk1BTkNFX1JFUE9SVF9BTEwgICAgIDB4MDEKKyNkZWZp
bmUgQ0RfUEVSRl9UWVBFX1BFUkZPUk1BTkNFX1JFUE9SVF9FWENFUFQgIDB4MTAKKworCitzdGF0
aWMgdm9pZCBjZF9zY3NpX2dldF9wZXJmb3JtYW5jZV9yZXNwX2VtcHR5KENkU2NzaUxVICpkZXYs
IENkU2NzaVJlcXVlc3QgKnJlcSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgdWludDMyX3QgdHlwZSwgdWludDMyX3QgZGF0YV90eXBlLAorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCBtYXhfbnVtX2Rl
c2NyKQoreworICAgIHVpbnQ4X3QgKm91dGJ1ZiA9IHJlcS0+YnVmOworICAgIHVpbnQzMl90IHdy
aXRlID0gKGRhdGFfdHlwZSA+PiAyKSAmIDB4MDE7CisKKyAgICBtZW1zZXQob3V0YnVmLCAwLCBD
RF9QRVJGX0hFQURFUl9MRU4pOworICAgIGlmICh3cml0ZSkgeworICAgICAgICBvdXRidWZbNF0g
PSAweDAyOworICAgIH0KKyAgICByZXEtPmluX2xlbiA9IENEX1BFUkZfSEVBREVSX0xFTjsKKwor
ICAgIFNQSUNFX0RFQlVHKCJnZXRfcGVyZm9ybWFuY2UsIGx1bjoldSIKKyAgICAgICAgICAgICAg
ICAiIHR5cGU6MHgleCBkYXRhX3R5cGU6MHgleCAtIHNlbmRpbmcgZW1wdHkgcmVzcG9uc2UiLAor
ICAgICAgICAgICAgICAgIHJlcS0+bHVuLCB0eXBlLCBkYXRhX3R5cGUpOworCisgICAgY2Rfc2Nz
aV9jbWRfY29tcGxldGVfZ29vZChkZXYsIHJlcSk7Cit9CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lf
Z2V0X3BlcmZvcm1hbmNlX3Jlc3BfcGVyZm9ybWFuY2UoQ2RTY3NpTFUgKmRldiwgQ2RTY3NpUmVx
dWVzdCAqcmVxLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB1aW50MzJfdCBzdGFydF9sYmEsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IGRhdGFfdHlwZSwKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyX3QgbWF4X251
bV9kZXNjcikKK3sKKyAgICB1aW50OF90ICpvdXRidWYgPSByZXEtPmJ1ZiwgKnBlcmZfZGVzYzsK
KyAgICB1aW50MzJfdCByZXNwX2xlbiA9IENEX1BFUkZfSEVBREVSX0xFTiArCisgICAgICAgICAg
ICAgICAgICAgICAgICBDRF9QRVJGX1RZUEVfUEVSRk9STUFOQ0VfREVTQ1JfTEVOOworICAgIHVp
bnQzMl90IHBlcmZfZGF0YV9sZW4gPSByZXNwX2xlbiAtIDQ7IC8qIG5vdCBpbmNsLiBQZXJmIERh
dGEgTGVuZ3RoICovCisgICAgdWludDMyX3QgcGVyZl9rYiA9IDEwMDAwOworICAgIHVpbnQzMl90
IGVuZF9sYmEgPSBkZXYtPm51bV9ibG9ja3MgLSAxOworICAgIHVpbnQzMl90IGV4Y2VwdCwgd3Jp
dGUsIHRvbGVyYW5jZTsKKworICAgIGV4Y2VwdCA9IGRhdGFfdHlwZSAmIDB4MDM7CisgICAgaWYg
KGV4Y2VwdCAhPSBDRF9QRVJGX1RZUEVfUEVSRk9STUFOQ0VfUkVQT1JUX0FMTCkgeworICAgICAg
ICBzdGFydF9sYmEgPSAwOworICAgIH0KKyAgICB3cml0ZSA9IChkYXRhX3R5cGUgPj4gMikgJiAw
eDAxOworICAgIHRvbGVyYW5jZSA9IChkYXRhX3R5cGUgPj4gMykgJiAweDAzOworCisgICAgU1BJ
Q0VfREVCVUcoImdldF9wZXJmb3JtYW5jZSwgbHVuOiV1IgorICAgICAgICAgICAgICAgICIgcGVy
Zm9ybWFuY2UgdHlwZToweDAwIGRhdGFfdHlwZToweCV4IgorICAgICAgICAgICAgICAgICIgZXhj
ZXB0OjB4JXggd3JpdGU6MHgleCB0b2xlcmFuY2U6MHgleCIKKyAgICAgICAgICAgICAgICAiIG1h
eF9udW06JXUiLAorICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBkYXRhX3R5cGUsIGV4Y2VwdCwg
d3JpdGUsCisgICAgICAgICAgICAgICAgdG9sZXJhbmNlLCBtYXhfbnVtX2Rlc2NyKTsKKworICAg
IGlmICh3cml0ZSkgeworICAgICAgICBTUElDRV9ERUJVRygiZ2V0X3BlcmZvcm1hbmNlLCBsdW46
JXUiCisgICAgICAgICAgICAgICAgICAgICIgcGVyZm9ybWFuY2UgdHlwZToweDAwIGRhdGFfdHlw
ZToweCV4IC0gd3JpdGUgdW5zdXBwb3J0ZWQiLAorICAgICAgICAgICAgICAgICAgICByZXEtPmx1
biwgZGF0YV90eXBlKTsKKyAgICAgICAgY2Rfc2NzaV9nZXRfcGVyZm9ybWFuY2VfcmVzcF9lbXB0
eShkZXYsIHJlcSwgQ0RfUEVSRl9UWVBFX1BFUkZPUk1BTkNFLAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFfdHlwZSwgbWF4X251bV9kZXNjcik7CisgICAg
ICAgIHJldHVybjsKKyAgICB9CisKKyAgICBtZW1zZXQob3V0YnVmLCAwLCByZXNwX2xlbik7CisK
KyAgICBvdXRidWZbMF0gPSAocGVyZl9kYXRhX2xlbiA+PiAyNCkgJiAweGZmOworICAgIG91dGJ1
ZlsxXSA9IChwZXJmX2RhdGFfbGVuID4+IDE2KSAmIDB4ZmY7CisgICAgb3V0YnVmWzJdID0gKHBl
cmZfZGF0YV9sZW4gPj4gOCkgJiAweGZmOworICAgIG91dGJ1ZlszXSA9IHBlcmZfZGF0YV9sZW4g
JiAweGZmOworCisgICAgcGVyZl9kZXNjID0gb3V0YnVmICsgQ0RfUEVSRl9IRUFERVJfTEVOOwor
CisgICAgcGVyZl9kZXNjWzBdID0gKHN0YXJ0X2xiYSA+PiAyNCkgJiAweGZmOworICAgIHBlcmZf
ZGVzY1sxXSA9IChzdGFydF9sYmEgPj4gMTYpICYgMHhmZjsKKyAgICBwZXJmX2Rlc2NbMl0gPSAo
c3RhcnRfbGJhID4+IDgpICYgMHhmZjsKKyAgICBwZXJmX2Rlc2NbM10gPSBzdGFydF9sYmEgJiAw
eGZmOworCisgICAgcGVyZl9kZXNjWzRdID0gKHBlcmZfa2IgPj4gMjQpICYgMHhmZjsKKyAgICBw
ZXJmX2Rlc2NbNV0gPSAocGVyZl9rYiA+PiAxNikgJiAweGZmOworICAgIHBlcmZfZGVzY1s2XSA9
IChwZXJmX2tiID4+IDgpICYgMHhmZjsKKyAgICBwZXJmX2Rlc2NbN10gPSBwZXJmX2tiICYgMHhm
ZjsKKworICAgIHBlcmZfZGVzY1s4XSA9IChlbmRfbGJhID4+IDI0KSAmIDB4ZmY7CisgICAgcGVy
Zl9kZXNjWzldID0gKGVuZF9sYmEgPj4gMTYpICYgMHhmZjsKKyAgICBwZXJmX2Rlc2NbMTBdID0g
KGVuZF9sYmEgPj4gOCkgJiAweGZmOworICAgIHBlcmZfZGVzY1sxMV0gPSBlbmRfbGJhICYgMHhm
ZjsKKworICAgIHBlcmZfZGVzY1sxMl0gPSAocGVyZl9rYiA+PiAyNCkgJiAweGZmOworICAgIHBl
cmZfZGVzY1sxM10gPSAocGVyZl9rYiA+PiAxNikgJiAweGZmOworICAgIHBlcmZfZGVzY1sxNF0g
PSAocGVyZl9rYiA+PiA4KSAmIDB4ZmY7CisgICAgcGVyZl9kZXNjWzE1XSA9IHBlcmZfa2IgJiAw
eGZmOworCisgICAgcmVxLT5yZXFfbGVuID0gQ0RfUEVSRl9IRUFERVJfTEVOICsKKyAgICAgICAg
ICAgICAgICAgICAobWF4X251bV9kZXNjciAqIENEX1BFUkZfVFlQRV9QRVJGT1JNQU5DRV9ERVND
Ul9MRU4pOworCisgICAgcmVxLT5pbl9sZW4gPSBNSU4ocmVxLT5yZXFfbGVuLCByZXNwX2xlbik7
CisKKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworc3RhdGlj
IHZvaWQgY2Rfc2NzaV9jbWRfZ2V0X3BlcmZvcm1hbmNlKENkU2NzaUxVICpkZXYsIENkU2NzaVJl
cXVlc3QgKnJlcSkKK3sKKyAgICB1aW50MzJfdCBkYXRhX3R5cGUsIG1heF9udW1fZGVzY3IsIHN0
YXJ0X2xiYSwgdHlwZTsKKworICAgIHJlcS0+eGZlcl9kaXIgPSBTQ1NJX1hGRVJfRlJPTV9ERVY7
CisKKyAgICBkYXRhX3R5cGUgPSByZXEtPmNkYlsxXSAmIDB4MGY7CisgICAgc3RhcnRfbGJhID0g
KHJlcS0+Y2RiWzJdIDw8IDI0KSB8CisgICAgICAgICAgICAgICAgKHJlcS0+Y2RiWzNdIDw8IDE2
KSB8CisgICAgICAgICAgICAgICAgKHJlcS0+Y2RiWzRdIDw8IDgpIHwKKyAgICAgICAgICAgICAg
ICAgcmVxLT5jZGJbNV07CisgICAgbWF4X251bV9kZXNjciA9IChyZXEtPmNkYls4XSA8PCA4KSB8
IHJlcS0+Y2RiWzldOworICAgIHR5cGUgPSByZXEtPmNkYlsxMF07CisKKyAgICBzd2l0Y2ggKHR5
cGUpIHsKKyAgICBjYXNlIENEX1BFUkZfVFlQRV9QRVJGT1JNQU5DRToKKyAgICAgICAgY2Rfc2Nz
aV9nZXRfcGVyZm9ybWFuY2VfcmVzcF9wZXJmb3JtYW5jZShkZXYsIHJlcSwgc3RhcnRfbGJhLAor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFfdHlw
ZSwgbWF4X251bV9kZXNjcik7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgQ0RfUEVSRl9UWVBF
X1VOVVNBQkxFX0FSRUE6IC8qIG5vdCB3cml0YWJsZSAqLworICAgIGNhc2UgQ0RfUEVSRl9UWVBF
X0RFRkVDVF9TVEFUVVM6IC8qIG5vdCByZXN0cmljdGVkIG92ZXJ3cml0ZSBtZWRpYSAqLworICAg
IGNhc2UgQ0RfUEVSRl9UWVBFX1dSSVRFX1NQRUVEOiAvKiB1bnN1cHBvcnRlZCwgaXJyZWxldmFu
dCAqLworICAgIGRlZmF1bHQ6CisgICAgICAgIFNQSUNFX0RFQlVHKCJnZXRfcGVyZm9ybWFuY2Us
IGx1bjoldSIKKyAgICAgICAgICAgICAgICAgICAgIiB1bnN1cHBvcnRlZCB0eXBlOjB4JXgiCisg
ICAgICAgICAgICAgICAgICAgICIgZGF0YV90eXBlOjB4JXggbWF4X251bToldSIsCisgICAgICAg
ICAgICAgICAgICAgIHJlcS0+bHVuLCB0eXBlLCBkYXRhX3R5cGUsIG1heF9udW1fZGVzY3IpOwor
ICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2Vf
Y29kZV9JTlZBTElEX0NEQl9GSUVMRCk7CisgICAgICAgIHJldHVybjsKKyAgICB9Cit9CisKKyNk
ZWZpbmUgQ0RfTUVDSEFOSVNNX1NUQVRVU19IRFJfTEVOICAgICA4CisKKy8qIGJ5dGUgMCAqLwor
I2RlZmluZSBDRF9DSEFOR0VSX0ZBVUxUX0ZMQUcgICAgICAgICAgIDB4ODAKKworI2RlZmluZSBD
RF9DSEFOR0VSX1JFQURZICAgICAgICAgICAgICAgIDB4MDAKKyNkZWZpbmUgQ0RfQ0hBTkdFUl9M
T0FESU5HICAgICAgICAgICAgICAweDAxCisjZGVmaW5lIENEX0NIQU5HRVJfVU5MT0FESU5HICAg
ICAgICAgICAgMHgwMgorI2RlZmluZSBDRF9DSEFOR0VSX0lOSVRJQUxJWklORyAgICAgICAgIDB4
MDMKKworLyogYnl0ZSAxICovCisjZGVmaW5lIENEX0NIQU5HRVJfRE9PUl9PUEVOX0ZMQUcgICAg
ICAgMHgxMAorCisjZGVmaW5lIENEX01FQ0hBTklTTV9TVEFURV9JRExFICAgICAgICAgMHgwMAor
I2RlZmluZSBDRF9NRUNIQU5JU01fU1RBVEVfUExBWUlORyAgICAgIDB4MDEKKyNkZWZpbmUgQ0Rf
TUVDSEFOSVNNX1NUQVRFX1NDQU5OSU5HICAgICAweDAyCisvKiBBQ1RJVkU6IHdpdGggSW5pdGlh
dG9yLCBDb21wb3NpdGUgb3IgT3RoZXIgcG9ydHMKKyAgKGkuZS4gUkVBRCwgUExBWSBDRCwgU0NB
TiBkdXJpbmcgUExBWSBDRCkgKi8KKyNkZWZpbmUgQ0RfTUVDSEFOSVNNX1NUQVRFX0FDVElWRSAg
ICAgICAweDAzCisjZGVmaW5lIENEX01FQ0hBTklTTV9TVEFURV9OT19JTkZPICAgICAgMHgwNwor
CisvKiBzbG90cyAqLworI2RlZmluZSBDRF9NRUNIQU5JU01fU1RBVFVTX1NMT1RfTEVOICAgIDQK
KworI2RlZmluZSBDRF9NRUNIQU5JU01fU0xPVF9ESVNLX0NIQU5HRUQgIDB4MDEKKyNkZWZpbmUg
Q0RfTUVDSEFOSVNNX1NMT1RfRElTS19QUkVTRU5UICAweDgwCisjZGVmaW5lIENEX01FQ0hBTklT
TV9TTE9UX0RJU0tfQ1dQX1YgICAgMHgwMgorI2RlZmluZSBDRF9NRUNIQU5JU01fU0xPVF9ESVNL
X0NXUCAgICAgIDB4MDEKKworc3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRfbWVjaGFuaXNtX3N0YXR1
cyhDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgdWludDhfdCAqb3V0
YnVmID0gcmVxLT5idWY7CisgICAgdWludDMyX3QgcmVzcF9sZW4gPSBDRF9NRUNIQU5JU01fU1RB
VFVTX0hEUl9MRU47CisKKyAgICByZXEtPnhmZXJfZGlyID0gU0NTSV9YRkVSX0ZST01fREVWOwor
CisgICAgcmVxLT5yZXFfbGVuID0gKHJlcS0+Y2RiWzhdIDw8IDgpIHwgcmVxLT5jZGJbOV07Cisg
ICAgbWVtc2V0KG91dGJ1ZiwgMCwgcmVxLT5yZXFfbGVuKTsKKworICAgIC8qIEZvciBub24tY2hh
bmdlciBkZXZpY2VzIHRoZSBjdXJlbnQgc2xvdCBudW1iZXIgZmllbGQgaXMgcmVzZXJ2ZWQsIHNl
dCBvbmx5IHN0YXR1cyAqLworICAgIG91dGJ1ZlswXSB8PSAoQ0RfQ0hBTkdFUl9SRUFEWSA8PCA1
KTsKKworICAgIG91dGJ1ZlsxXSB8PSAoIWRldi0+bG9hZGVkKSA/IENEX0NIQU5HRVJfRE9PUl9P
UEVOX0ZMQUcgOiAwOworICAgIG91dGJ1ZlsxXSB8PSAoZGV2LT5wb3dlcl9jb25kID09IENEX1BP
V0VSX1NUQVRVU19BQ1RJVkUpID8KKyAgICAgICAgICAgICAgICAgKENEX01FQ0hBTklTTV9TVEFU
RV9BQ1RJVkUgPDwgNSkgOiAoQ0RfTUVDSEFOSVNNX1NUQVRFX0lETEUgPDwgNSk7CisKKyAgICAv
KiBGb3Igbm9uLWNoYW5nZXIgZGV2aWNlcyB0aGUgbnVtYmVyIG9mIHNsb3QgdGFibGVzIHJldHVy
bmVkIHNoYWxsIGJlIHplcm8sIHNvIHdlIGxlYXZlCisgICAgICAgYm90aCAnTnVtYmVyIG9mIFNs
b3RzIEF2YWlsYWJsZScgYW5kICdMZW5ndGggb2YgU2xvdCBUYWJsZScgZmllbGRzIGFzIHplcm9z
ICovCisKKyAgICByZXEtPmluX2xlbiA9IE1JTihyZXEtPnJlcV9sZW4sIHJlc3BfbGVuKTsKKwor
ICAgIFNQSUNFX0RFQlVHKCJtZWNoYW5pc21fc3RhdHVzLCBsdW46JXUiLCByZXEtPmx1bik7CisK
KyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworc3RhdGljIHZv
aWQgY2Rfc2NzaV9yZWFkX2FzeW5jX2NvbXBsZXRlKEdPYmplY3QgKnNyY19vYmplY3QsCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgR0FzeW5jUmVzdWx0ICpyZXN1bHQs
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3BvaW50ZXIgdXNlcl9k
YXRhKQoreworICAgIEdGaWxlSW5wdXRTdHJlYW0gKnN0cmVhbSA9IEdfRklMRV9JTlBVVF9TVFJF
QU0oc3JjX29iamVjdCk7CisgICAgQ2RTY3NpUmVxdWVzdCAqcmVxID0gKENkU2NzaVJlcXVlc3Qg
Kil1c2VyX2RhdGE7CisgICAgQ2RTY3NpVGFyZ2V0ICpzdCA9IChDZFNjc2lUYXJnZXQgKilyZXEt
PnByaXZfZGF0YTsKKyAgICBDZFNjc2lMVSAqZGV2ID0gJnN0LT51bml0c1tyZXEtPmx1bl07Cisg
ICAgR0Vycm9yICplcnJvciA9IE5VTEw7CisgICAgZ3NpemUgYnl0ZXNfcmVhZDsKKyAgICBnYm9v
bGVhbiBmaW5pc2hlZDsKKworICAgIHJlcS0+cmVxX3N0YXRlID0gU0NTSV9SRVFfQ09NUExFVEU7
CisgICAgcmVxLT5jYW5jZWxfaWQgPSAwOworCisvLyAgICBnX2Fzc2VydChzdHJlYW0gPT0gZGV2
LT5zdHJlYW0pOworICAgIGlmIChzdHJlYW0gIT0gZGV2LT5zdHJlYW0pIHsKKyAgICAgICAgdWlu
dDMyX3Qgb3Bjb2RlID0gKHVpbnQzMl90KXJlcS0+Y2RiWzBdOworICAgICAgICBTUElDRV9ERUJV
RygicmVhZF9hc3luY19jb21wbGV0ZSBCQUQgU1RSRUFNLCBsdW46ICV1IgorICAgICAgICAgICAg
ICAgICAgICAiIHJlcTogJSIgR19HVUlOVDY0X0ZPUk1BVCAiIG9wOiAweCUwMngiLAorICAgICAg
ICAgICAgICAgICAgICByZXEtPmx1biwgcmVxLT5yZXFfbGVuLCBvcGNvZGUpOworICAgICAgICBj
ZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9UQVJH
RVRfRkFJTFVSRSk7CisgICAgICAgIGNkX3Njc2lfZGV2X3JlcXVlc3RfY29tcGxldGUoc3QtPnVz
ZXJfZGF0YSwgcmVxKTsKKyAgICAgICAgcmV0dXJuOworICAgIH0KKworICAgIGJ5dGVzX3JlYWQg
PSBnX2lucHV0X3N0cmVhbV9yZWFkX2ZpbmlzaChHX0lOUFVUX1NUUkVBTShzdHJlYW0pLCByZXN1
bHQsICZlcnJvcik7CisgICAgZmluaXNoZWQgPSBieXRlc19yZWFkID4gMDsKKyAgICBpZiAoZmlu
aXNoZWQpIHsKKyAgICAgICAgU1BJQ0VfREVCVUcoInJlYWRfYXN5bmNfY29tcGxldGUsIGx1bjog
JXUiCisgICAgICAgICAgICAgICAgICAgICIgZmluaXNoZWQ6ICVkIGJ5dGVzX3JlYWQ6ICUiIEdf
R1VJTlQ2NF9GT1JNQVQKKyAgICAgICAgICAgICAgICAgICAgIiByZXE6ICUiICBHX0dVSU5UNjRf
Rk9STUFULAorICAgICAgICAgICAgICAgICAgICByZXEtPmx1biwgZmluaXNoZWQsICh1aW50NjRf
dClieXRlc19yZWFkLCByZXEtPnJlcV9sZW4pOworCisgICAgICAgIHJlcS0+aW5fbGVuID0gTUlO
KGJ5dGVzX3JlYWQsIHJlcS0+cmVxX2xlbik7CisgICAgICAgIHJlcS0+c3RhdHVzID0gR09PRDsK
KyAgICB9IGVsc2UgeworICAgICAgICBpZiAoZXJyb3IgIT0gTlVMTCkgeworICAgICAgICAgICAg
U1BJQ0VfRVJST1IoImdfaW5wdXRfc3RyZWFtX3JlYWRfZmluaXNoIGZhaWxlZDogJXMiLCBlcnJv
ci0+bWVzc2FnZSk7CisgICAgICAgICAgICBnX2NsZWFyX2Vycm9yICgmZXJyb3IpOworICAgICAg
ICB9IGVsc2UgeworICAgICAgICAgICAgU1BJQ0VfRVJST1IoImdfaW5wdXRfc3RyZWFtX3JlYWRf
ZmluaXNoIGZhaWxlZCAobm8gZXJyIHByb3ZpZGVkKSIpOworICAgICAgICB9CisgICAgICAgIHJl
cS0+aW5fbGVuID0gMDsKKyAgICAgICAgcmVxLT5zdGF0dXMgPSBHT09EOworICAgIH0KKyAgICBj
ZF9zY3NpX2Rldl9yZXF1ZXN0X2NvbXBsZXRlKHN0LT51c2VyX2RhdGEsIHJlcSk7Cit9CisKK3N0
YXRpYyB2b2lkIGNkX3Njc2lfcmVhZF9hc3luY19jYW5jZWxlZChHQ2FuY2VsbGFibGUgKmNhbmNl
bGxhYmxlLCBncG9pbnRlciB1c2VyX2RhdGEpCit7CisgICAgQ2RTY3NpUmVxdWVzdCAqcmVxID0g
KENkU2NzaVJlcXVlc3QgKil1c2VyX2RhdGE7CisgICAgQ2RTY3NpVGFyZ2V0ICpzdCA9IChDZFNj
c2lUYXJnZXQgKilyZXEtPnByaXZfZGF0YTsKKworICAgIGdfYXNzZXJ0KGNhbmNlbGxhYmxlID09
IHN0LT5jYW5jZWxsYWJsZSk7CisgICAgZ19jYW5jZWxsYWJsZV9kaXNjb25uZWN0KGNhbmNlbGxh
YmxlLCByZXEtPmNhbmNlbF9pZCk7CisgICAgcmVxLT5jYW5jZWxfaWQgPSAwOworCisgICAgcmVx
LT5yZXFfc3RhdGUgPQorICAgICAgICAoc3QtPnN0YXRlID09IENEX1NDU0lfVEdUX1NUQVRFX1JV
Tk5JTkcpID8gU0NTSV9SRVFfQ0FOQ0VMRUQgOiBTQ1NJX1JFUV9ESVNQT1NFRDsKKyAgICByZXEt
PmluX2xlbiA9IDA7CisgICAgcmVxLT5zdGF0dXMgPSBHT09EOworCisgICAgY2Rfc2NzaV9kZXZf
cmVxdWVzdF9jb21wbGV0ZShzdC0+dXNlcl9kYXRhLCByZXEpOworfQorCitzdGF0aWMgaW50IGNk
X3Njc2lfcmVhZF9hc3luY19zdGFydChDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEp
Cit7CisgICAgQ2RTY3NpVGFyZ2V0ICpzdCA9IGRldi0+dGd0OworICAgIEdGaWxlSW5wdXRTdHJl
YW0gKnN0cmVhbSA9IGRldi0+c3RyZWFtOworCisgICAgU1BJQ0VfREVCVUcoInJlYWRfYXN5bmNf
c3RhcnQsIGx1bjoldSIKKyAgICAgICAgICAgICAgICAiIGxiYTogJSIgR19HVUlOVDY0X0ZPUk1B
VCAiIG9mZnNldDogJSIgR19HVUlOVDY0X0ZPUk1BVAorICAgICAgICAgICAgICAgICIgY250OiAl
IiBHX0dVSU5UNjRfRk9STUFUICIgbGVuOiAlIiBHX0dVSU5UNjRfRk9STUFULAorICAgICAgICAg
ICAgICAgIHJlcS0+bHVuLCByZXEtPmxiYSwgcmVxLT5vZmZzZXQsIHJlcS0+Y291bnQsIHJlcS0+
cmVxX2xlbik7CisKKyAgICByZXEtPmNhbmNlbF9pZCA9IGdfY2FuY2VsbGFibGVfY29ubmVjdChz
dC0+Y2FuY2VsbGFibGUsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgR19DQUxMQkFDSyhjZF9zY3NpX3JlYWRfYXN5bmNfY2FuY2VsZWQpLAorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcSwgLyogZGF0YSAqLworICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5VTEwpOyAvKiBkYXRhIGRlc3Ryb3kg
Y2IgKi8KKyAgICBpZiAocmVxLT5jYW5jZWxfaWQgPT0gMCkgeworICAgICAgICAvKiBhbHJlYWR5
IGNhbmNlbGVkICovCisgICAgICAgIHJldHVybiAtMTsKKyAgICB9CisKKyAgICBnX3NlZWthYmxl
X3NlZWsoR19TRUVLQUJMRShzdHJlYW0pLAorICAgICAgICAgICAgICAgICAgICByZXEtPm9mZnNl
dCwKKyAgICAgICAgICAgICAgICAgICAgR19TRUVLX1NFVCwKKyAgICAgICAgICAgICAgICAgICAg
TlVMTCwgLyogY2FuY2VsbGFibGUgKi8KKyAgICAgICAgICAgICAgICAgICAgTlVMTCk7IC8qIGVy
cm9yICovCisKKyAgICBnX2lucHV0X3N0cmVhbV9yZWFkX2FzeW5jKEdfSU5QVVRfU1RSRUFNKHN0
cmVhbSksCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXEtPmJ1ZiwgLyogYnVmZmVy
IHRvIGZpbGwgKi8KKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcS0+cmVxX2xlbiwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdfUFJJT1JJVFlfREVGQVVMVCwKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHN0LT5jYW5jZWxsYWJsZSwKKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGNkX3Njc2lfcmVhZF9hc3luY19jb21wbGV0ZSwKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIChncG9pbnRlcilyZXEpOyAvKiBjYWxsYmFjayBhcmd1bWVudCAq
LworICAgIHJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9yZWFkKENkU2Nz
aUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICBpZiAoZGV2LT5wb3dlcl9jb25k
ID09IENEX1NDU0lfUE9XRVJfU1RPUFBFRCkgeworICAgICAgICBTUElDRV9ERUJVRygicmVhZCwg
bHVuOiAldSBpcyBzdG9wcGVkIiwgcmVxLT5sdW4pOworICAgICAgICBjZF9zY3NpX2NtZF9jb21w
bGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTklUX0NNRF9SRVFVSVJFRCk7
CisgICAgICAgIHJldHVybjsKKyAgICB9IGVsc2UgaWYgKCFkZXYtPmxvYWRlZCB8fCBkZXYtPnN0
cmVhbSA9PSBOVUxMKSB7CisgICAgICAgIFNQSUNFX0RFQlVHKCJyZWFkLCBsdW46ICV1IGlzIG5v
dCBsb2FkZWQiLCByZXEtPmx1bik7CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNr
X2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX05PVF9SRUFEWV9OT19NRURJVU0pOworICAgICAg
ICByZXR1cm47CisgICAgfQorCisgICAgcmVxLT5jZGJfbGVuID0gc2NzaV9jZGJfbGVuZ3RoKHJl
cS0+Y2RiKTsKKworICAgIHJlcS0+bGJhID0gc2NzaV9jZGJfbGJhKHJlcS0+Y2RiLCByZXEtPmNk
Yl9sZW4pOworICAgIHJlcS0+b2Zmc2V0ID0gcmVxLT5sYmEgKiBkZXYtPmJsb2NrX3NpemU7CisK
KyAgICByZXEtPmNvdW50ID0gc2NzaV9jZGJfeGZlcl9sZW5ndGgocmVxLT5jZGIsIHJlcS0+Y2Ri
X2xlbik7IC8qIHhmZXIgaW4gYmxvY2tzICovCisgICAgcmVxLT5yZXFfbGVuID0gKHVpbnQ2NF90
KSByZXEtPmNvdW50ICogZGV2LT5ibG9ja19zaXplOworCisgICAgY2Rfc2NzaV9yZWFkX2FzeW5j
X3N0YXJ0KGRldiwgcmVxKTsKK30KKwordm9pZCBjZF9zY3NpX2Rldl9yZXF1ZXN0X3N1Ym1pdChD
ZFNjc2lUYXJnZXQgKnN0LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgdWludDMyX3QgbHVu
ID0gcmVxLT5sdW47CisgICAgdWludDMyX3Qgb3Bjb2RlID0gKHVpbnQzMl90KXJlcS0+Y2RiWzBd
OworICAgIGNvbnN0IGNoYXIgKmNtZF9uYW1lID0gc2NzaV9jbWRfbmFtZVtvcGNvZGVdOworICAg
IENkU2NzaUxVICpkZXYgPSAmc3QtPnVuaXRzW2x1bl07CisKKyAgICBTUElDRV9ERUJVRygicmVx
dWVzdF9zdWJtaXQsIGx1bjogJXUgb3A6IDB4JTAyeCAlcyIsIGx1biwgb3Bjb2RlLCBjbWRfbmFt
ZSk7CisKKyAgICBpZiAoc3QtPmN1cl9yZXEgIT0gTlVMTCkgeworICAgICAgICBTUElDRV9FUlJP
UigicmVxdWVzdF9zdWJtaXQsIHJlcXVlc3Qgbm90IGlkbGUiKTsKKyAgICAgICAgY2Rfc2NzaV9j
bWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfVEFSR0VUX0ZBSUxV
UkUpOworICAgICAgICBnb3RvIGRvbmU7CisgICAgfQorICAgIGlmIChyZXEtPnJlcV9zdGF0ZSAh
PSBTQ1NJX1JFUV9JRExFKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJyZXF1ZXN0X3N1Ym1pdCwg
cHJldiByZXF1ZXN0IG91dHN0YW5kaW5nIik7CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRl
X2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX1RBUkdFVF9GQUlMVVJFKTsKKyAgICAg
ICAgZ290byBkb25lOworICAgIH0KKyAgICByZXEtPnJlcV9zdGF0ZSA9IFNDU0lfUkVRX1JVTk5J
Tkc7CisgICAgc3QtPmN1cl9yZXEgPSByZXE7CisKKyAgICAvKiBJTlFVSVJZIHNob3VsZCBzZW5k
IHJlc3BvbnNlIGV2ZW4gZm9yIG5vbi1leGlzdGluZyBMVU5zICovCisgICAgaWYgKCFjZF9zY3Np
X3RhcmdldF9sdW5fbGVnYWwoc3QsIGx1bikpIHsKKyAgICAgICAgU1BJQ0VfRVJST1IoInJlcXVl
c3Rfc3VibWl0LCBpbGxlZ2FsIGx1bjoldSIsIGx1bik7CisgICAgICAgIGlmIChvcGNvZGUgPT0g
SU5RVUlSWSkgeworICAgICAgICAgICAgaWYgKHJlcS0+Y2RiWzFdICYgMHgxKSB7CisgICAgICAg
ICAgICAgICAgY2Rfc2NzaV9jbWRfaW5xdWlyeV92cGRfbm9fbHVuKGRldiwgcmVxLCBQRVJJRl9R
VUFMSUZJRVJfVU5TVVBQT1JURUQpOworICAgICAgICAgICAgfSBlbHNlIHsKKyAgICAgICAgICAg
ICAgICBjZF9zY3NpX2NtZF9pbnF1aXJ5X3N0YW5kYXJkX25vX2x1bihkZXYsIHJlcSwgUEVSSUZf
UVVBTElGSUVSX1VOU1VQUE9SVEVEKTsKKyAgICAgICAgICAgIH0KKyAgICAgICAgfSBlbHNlIHsK
KyAgICAgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZz
ZW5zZV9jb2RlX0xVTl9OT1RfU1VQUE9SVEVEKTsKKyAgICAgICAgfQorICAgICAgICBnb3RvIGRv
bmU7CisgICAgfQorICAgIGlmICghY2Rfc2NzaV90YXJnZXRfbHVuX3JlYWxpemVkKHN0LCBsdW4p
KSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJyZXF1ZXN0X3N1Ym1pdCwgYWJzZW50IGx1bjoldSIs
IGx1bik7CisgICAgICAgIGlmIChvcGNvZGUgPT0gSU5RVUlSWSkgeworICAgICAgICAgICAgaWYg
KHJlcS0+Y2RiWzFdICYgMHgxKSB7CisgICAgICAgICAgICAgICAgY2Rfc2NzaV9jbWRfaW5xdWly
eV92cGRfbm9fbHVuKGRldiwgcmVxLCBQRVJJRl9RVUFMSUZJRVJfTk9UX0NPTk5FQ1RFRCk7Cisg
ICAgICAgICAgICB9IGVsc2UgeworICAgICAgICAgICAgICAgIGNkX3Njc2lfY21kX2lucXVpcnlf
c3RhbmRhcmRfbm9fbHVuKGRldiwgcmVxLCBQRVJJRl9RVUFMSUZJRVJfTk9UX0NPTk5FQ1RFRCk7
CisgICAgICAgICAgICB9CisgICAgICAgIH0gZWxzZSB7CisgICAgICAgICAgICBjZF9zY3NpX2Nt
ZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9MVU5fTk9UX1NVUFBP
UlRFRCk7CisgICAgICAgIH0KKyAgICAgICAgZ290byBkb25lOworICAgIH0KKworICAgIGlmIChk
ZXYtPnNob3J0X3NlbnNlLmtleSAhPSBOT19TRU5TRSkgeworICAgICAgICBnYm9vbGVhbiBwZW5k
aW5nX3NlbnNlID0gVFJVRTsKKyAgICAgICAgaWYgKGRldi0+c2hvcnRfc2Vuc2Uua2V5ID09IFVO
SVRfQVRURU5USU9OKSB7CisgICAgICAgICAgICBpZiAoY2Rfc2NzaV9vcGNvZGVfdWFfc3VwcmVz
cyhvcGNvZGUpKSB7CisgICAgICAgICAgICAgICAgcGVuZGluZ19zZW5zZSA9IEZBTFNFOyAvKiBV
QSBzdXByZXNzZWQgKi8KKyAgICAgICAgICAgIH0KKyAgICAgICAgfSBlbHNlIGlmIChvcGNvZGUg
PT0gUkVRVUVTVF9TRU5TRSkgeworICAgICAgICAgICAgcGVuZGluZ19zZW5zZSA9IEZBTFNFOyAv
KiBzZW5zZSByZXR1cm5lZCBhcyBkYXRhICovCisgICAgICAgIH0KKyAgICAgICAgaWYgKHBlbmRp
bmdfc2Vuc2UpIHsKKyAgICAgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQo
ZGV2LCByZXEsIE5VTEwpOyAvKiBzZW5zZSBhbHJlYWR5IHNldCAqLworICAgICAgICAgICAgZ290
byBkb25lOworICAgICAgICB9CisgICAgfQorCisgICAgLyogc2F2ZSB0aGUgdGFyZ2V0IHRvIGJl
IHVzZWQgaW4gY2FsbGJhY2tzIHdoZXJlIG9ubHkgcmVxIGlzIHBhc3NlZCAqLworICAgIHJlcS0+
cHJpdl9kYXRhID0gKHZvaWQgKilzdDsKKworICAgIHJlcS0+cmVxX2xlbiA9IDA7CisKKyAgICBz
d2l0Y2ggKG9wY29kZSkgeworICAgIGNhc2UgUkVQT1JUX0xVTlM6CisgICAgICAgIGNkX3Njc2lf
Y21kX3JlcG9ydF9sdW5zKHN0LCBkZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2Ug
VEVTVF9VTklUX1JFQURZOgorICAgICAgICBjZF9zY3NpX2NtZF90ZXN0X3VuaXRfcmVhZHkoZGV2
LCByZXEpOworICAgICAgICBicmVhazsKKyAgICBjYXNlIElOUVVJUlk6CisgICAgICAgIGNkX3Nj
c2lfY21kX2lucXVpcnkoZGV2LCByZXEpOworICAgICAgICBicmVhazsKKyAgICBjYXNlIFJFUVVF
U1RfU0VOU0U6CisgICAgICAgIGNkX3Njc2lfY21kX3JlcXVlc3Rfc2Vuc2UoZGV2LCByZXEpOwor
ICAgICAgICBicmVhazsKKyAgICBjYXNlIFJFQURfNjoKKyAgICBjYXNlIFJFQURfMTA6CisgICAg
Y2FzZSBSRUFEXzEyOgorICAgIGNhc2UgUkVBRF8xNjoKKyAgICAgICAgY2Rfc2NzaV9jbWRfcmVh
ZChkZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgUkVBRF9DQVBBQ0lUWV8xMDoK
KyAgICAgICAgY2Rfc2NzaV9jbWRfcmVhZF9jYXBhY2l0eShkZXYsIHJlcSk7CisgICAgICAgIGJy
ZWFrOworICAgIGNhc2UgUkVBRF9UT0M6CisgICAgICAgIGNkX3Njc2lfY21kX3JlYWRfdG9jKGRl
diwgcmVxKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBHRVRfRVZFTlRfU1RBVFVTX05PVElG
SUNBVElPTjoKKyAgICAgICAgY2Rfc2NzaV9jbWRfZ2V0X2V2ZW50X3N0YXR1c19ub3RpZmljYXRp
b24oZGV2LCByZXEpOworICAgICAgICBicmVhazsKKyAgICBjYXNlIFJFQURfRElTQ19JTkZPUk1B
VElPTjoKKyAgICAgICAgY2Rfc2NzaV9jbWRfZ2V0X3JlYWRfZGlzY19pbmZvcm1hdGlvbihkZXYs
IHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgUkVBRF9UUkFDS19JTkZPUk1BVElPTjoK
KyAgICAgICAgY2Rfc2NzaV9jbWRfZ2V0X3JlYWRfdHJhY2tfaW5mb3JtYXRpb24oZGV2LCByZXEp
OworICAgICAgICBicmVhazsKKyAgICBjYXNlIE1PREVfU0VOU0VfMTA6CisgICAgICAgIGNkX3Nj
c2lfY21kX21vZGVfc2Vuc2VfMTAoZGV2LCByZXEpOworICAgICAgICBicmVhazsKKyAgICBjYXNl
IE1PREVfU0VMRUNUOgorICAgICAgICBjZF9zY3NpX2NtZF9tb2RlX3NlbGVjdF82KGRldiwgcmVx
KTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBNT0RFX1NFTEVDVF8xMDoKKyAgICAgICAgY2Rf
c2NzaV9jbWRfbW9kZV9zZWxlY3RfMTAoZGV2LCByZXEpOworICAgICAgICBicmVhazsKKyAgICBj
YXNlIEdFVF9DT05GSUdVUkFUSU9OOgorICAgICAgICBjZF9zY3NpX2NtZF9nZXRfY29uZmlndXJh
dGlvbihkZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgQUxMT1dfTUVESVVNX1JF
TU9WQUw6CisgICAgICAgIGNkX3Njc2lfY21kX2FsbG93X21lZGl1bV9yZW1vdmFsKGRldiwgcmVx
KTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBNTUNfU0VORF9FVkVOVDoKKyAgICAgICAgY2Rf
c2NzaV9jbWRfc2VuZF9ldmVudChkZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2Ug
TU1DX1JFUE9SVF9LRVk6CisgICAgICAgIGNkX3Njc2lfY21kX3JlcG9ydF9rZXkoZGV2LCByZXEp
OworICAgICAgICBicmVhazsKKyAgICBjYXNlIE1NQ19TRU5EX0tFWToKKyAgICAgICAgY2Rfc2Nz
aV9jbWRfc2VuZF9rZXkoZGV2LCByZXEpOworICAgICAgICBicmVhazsKKyAgICBjYXNlIFNUQVJU
X1NUT1A6CisgICAgICAgIGNkX3Njc2lfY21kX3N0YXJ0X3N0b3BfdW5pdChkZXYsIHJlcSk7Cisg
ICAgICAgIGJyZWFrOworICAgIGNhc2UgTU1DX0dFVF9QRVJGT1JNQU5DRToKKyAgICAgICAgY2Rf
c2NzaV9jbWRfZ2V0X3BlcmZvcm1hbmNlKGRldiwgcmVxKTsKKyAgICAgICAgYnJlYWs7CisgICAg
Y2FzZSBNTUNfTUVDSEFOSVNNX1NUQVRVUzoKKyAgICAgICAgY2Rfc2NzaV9jbWRfbWVjaGFuaXNt
X3N0YXR1cyhkZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGRlZmF1bHQ6CisgICAgICAg
IGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX0lO
VkFMSURfT1BDT0RFKTsKKyAgICAgICAgYnJlYWs7CisgICAgfQorCisgICAgaWYgKHJlcS0+cmVx
X2xlbiA+IElOVDMyX01BWCkgeworICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19j
b25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZBTElEX0NEQl9GSUVMRCk7CisgICAgICAgIGdv
dG8gZG9uZTsKKyAgICB9CisKK2RvbmU6CisgICAgU1BJQ0VfREVCVUcoInJlcXVlc3Rfc3VibWl0
IGRvbmUsIGx1bjogJXUiCisgICAgICAgICAgICAgICAgIiBvcDogMHglMDJ4ICVzLCBzdGF0ZTog
JXMgc3RhdHVzOiAldSBsZW46ICUiIEdfR1VJTlQ2NF9GT1JNQVQsCisgICAgICAgICAgICAgICAg
bHVuLCBvcGNvZGUsIGNtZF9uYW1lLCBDZFNjc2lSZXFTdGF0ZV9zdHIocmVxLT5yZXFfc3RhdGUp
LCByZXEtPnN0YXR1cywKKyAgICAgICAgICAgICAgICByZXEtPmluX2xlbik7CisKKyAgICBpZiAo
cmVxLT5yZXFfc3RhdGUgPT0gU0NTSV9SRVFfQ09NUExFVEUpIHsKKyAgICAgICAgY2Rfc2NzaV9k
ZXZfcmVxdWVzdF9jb21wbGV0ZShzdC0+dXNlcl9kYXRhLCByZXEpOworICAgIH0KK30KKwordm9p
ZCBjZF9zY3NpX2Rldl9yZXF1ZXN0X2NhbmNlbChDZFNjc2lUYXJnZXQgKnN0LCBDZFNjc2lSZXF1
ZXN0ICpyZXEpCit7CisgICAgaWYgKHN0LT5jdXJfcmVxID09IHJlcSkgeworICAgICAgICBpZiAo
cmVxLT5yZXFfc3RhdGUgPT0gU0NTSV9SRVFfUlVOTklORykgeworICAgICAgICAgICAgU1BJQ0Vf
REVCVUcoInJlcXVlc3RfY2FuY2VsOiBsdW46ICV1IgorICAgICAgICAgICAgICAgICAgICAgICAg
ICIgb3A6IDB4JTAyeCBsZW46ICUiIEdfR1VJTlQ2NF9GT1JNQVQsCisgICAgICAgICAgICAgICAg
ICAgICAgICByZXEtPmx1biwgKHVuc2lnbmVkIGludClyZXEtPmNkYlswXSwgcmVxLT5yZXFfbGVu
KTsKKyAgICAgICAgICAgIGdfY2FuY2VsbGFibGVfY2FuY2VsKHN0LT5jYW5jZWxsYWJsZSk7Cisg
ICAgICAgIH0gZWxzZSB7CisgICAgICAgICAgICBTUElDRV9ERUJVRygicmVxdWVzdF9jYW5jZWw6
IHJlcXVlc3QgaXMgbm90IHJ1bm5pbmciKTsKKyAgICAgICAgfQorICAgIH0gZWxzZSB7CisgICAg
ICAgIFNQSUNFX0RFQlVHKCJyZXF1ZXN0X2NhbmNlbDogb3RoZXIgcmVxdWVzdCBpcyBvdXRzdGFu
ZGluZyIpOworICAgIH0KK30KKwordm9pZCBjZF9zY3NpX2Rldl9yZXF1ZXN0X3JlbGVhc2UoQ2RT
Y3NpVGFyZ2V0ICpzdCwgQ2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAgIHN0LT5jdXJfcmVxID0g
TlVMTDsKKyAgICBjZF9zY3NpX3JlcV9pbml0KHJlcSk7CisKKyAgICBpZiAoc3QtPnN0YXRlID09
IENEX1NDU0lfVEdUX1NUQVRFX1JFU0VUKSB7CisgICAgICAgIGNkX3Njc2lfdGFyZ2V0X2RvX3Jl
c2V0KHN0KTsKKyAgICB9Cit9CisKKyNlbmRpZiAvKiBVU0VfVVNCUkVESVIgKi8KZGlmZiAtLWdp
dCBhL3NyYy9jZC1zY3NpLmggYi9zcmMvY2Qtc2NzaS5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0Cmlu
ZGV4IDAwMDAwMDAwLi44NmU5NTFiOAotLS0gL2Rldi9udWxsCisrKyBiL3NyYy9jZC1zY3NpLmgK
QEAgLTAsMCArMSwxMTcgQEAKKy8qIC0qLSBNb2RlOiBDOyBjLWJhc2ljLW9mZnNldDogNDsgaW5k
ZW50LXRhYnMtbW9kZTogbmlsIC0qLSAqLworLyoKKyAgIENEIGRldmljZSBlbXVsYXRpb24gLSBT
Q1NJIGVuZ2luZQorCisgICBDb3B5cmlnaHQgKEMpIDIwMTggUmVkIEhhdCwgSW5jLgorCisgICBS
ZWQgSGF0IEF1dGhvcnM6CisgICBBbGV4YW5kZXIgTmV6aGluc2t5PGFuZXpoaW5zQHJlZGhhdC5j
b20+CisKKyAgIFRoaXMgbGlicmFyeSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJp
YnV0ZSBpdCBhbmQvb3IKKyAgIG1vZGlmeSBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBM
ZXNzZXIgR2VuZXJhbCBQdWJsaWMKKyAgIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVl
IFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlcgorICAgdmVyc2lvbiAyLjEgb2YgdGhlIExpY2Vu
c2UsIG9yIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCisKKyAgIFRoaXMgbGli
cmFyeSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAor
ICAgYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2Fy
cmFudHkgb2YKKyAgIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIg
UFVSUE9TRS4gIFNlZSB0aGUgR05VCisgICBMZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBm
b3IgbW9yZSBkZXRhaWxzLgorCisgICBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9m
IHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCisgICBMaWNlbnNlIGFsb25nIHdpdGggdGhp
cyBsaWJyYXJ5OyBpZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCisq
LworCisjcHJhZ21hIG9uY2UKKworI2luY2x1ZGUgImNkLXNjc2ktZGV2LXBhcmFtcy5oIgorI2lu
Y2x1ZGUgImNkLXVzYi1idWxrLW1zZC5oIgorI2luY2x1ZGUgInNjc2ktY29uc3RhbnRzLmgiCisK
KyNpZiBkZWZpbmVkKEdfT1NfV0lOMzIpCisjaW5jbHVkZSA8d2luc29jazIuaD4KKyNpbmNsdWRl
IDx3aW5kb3dzLmg+CisvKiBXaW5kb3dzIGlzIGFsd2F5cyBMRSBhdCB0aGUgbW9tZW50ICovCisj
ZGVmaW5lIGxlMzJ0b2goeCkgICAgICAgICAgKHgpCisjZGVmaW5lIGh0b2xlMzIoeCkgICAgICAg
ICAgKHgpCisjZGVmaW5lIGh0b2JlMzIoeCkgICAgICAgICAgaHRvbmwoeCkKKyNlbmRpZgorCit0
eXBlZGVmIGVudW0gU2NzaVhmZXJEaXIgeworICAgIFNDU0lfWEZFUl9OT05FID0gMCwgIC8qIFRF
U1RfVU5JVF9SRUFEWSwgLi4uICAgICAgICAgICAqLworICAgIFNDU0lfWEZFUl9GUk9NX0RFViwg
IC8qIFJFQUQsIElOUVVJUlksIE1PREVfU0VOU0UsIC4uLiAqLworICAgIFNDU0lfWEZFUl9UT19E
RVYsICAgIC8qIFdSSVRFLCBNT0RFX1NFTEVDVCwgLi4uICAgICAgICAqLworfSBTY3NpWGZlckRp
cjsKKworI2RlZmluZSBTQ1NJX0NEQl9CVUZfU0laRSAgIDE2CisKK3R5cGVkZWYgZW51bSBDZFNj
c2lSZXFTdGF0ZSB7CisgICAgU0NTSV9SRVFfSURMRSA9IDAsCisgICAgU0NTSV9SRVFfUlVOTklO
RywKKyAgICBTQ1NJX1JFUV9DT01QTEVURSwKKyAgICBTQ1NJX1JFUV9DQU5DRUxFRCwKKyAgICBT
Q1NJX1JFUV9ESVNQT1NFRCwKK30gQ2RTY3NpUmVxU3RhdGU7CisKK3R5cGVkZWYgc3RydWN0IENk
U2NzaVJlcXVlc3QgeworICAgIC8qIHJlcXVlc3QgKi8KKyAgICB1aW50OF90IGNkYltTQ1NJX0NE
Ql9CVUZfU0laRV07CisgICAgdWludDMyX3QgY2RiX2xlbjsKKworICAgIHVpbnQzMl90IGx1bjsK
KworICAgIHVpbnQ4X3QgKmJ1ZjsKKyAgICB1aW50MzJfdCBidWZfbGVuOworCisgICAgLyogaW50
ZXJuYWwgKi8KKyAgICBDZFNjc2lSZXFTdGF0ZSByZXFfc3RhdGU7CisgICAgU2NzaVhmZXJEaXIg
eGZlcl9kaXI7CisgICAgdWludDY0X3QgY2FuY2VsX2lkOworICAgIHZvaWQgKnByaXZfZGF0YTsK
KworICAgIHVpbnQ2NF90IGxiYTsgLyogb2Zmc2V0IGluIGxvZ2ljYWwgYmxvY2tzIGlmIHJlbGV2
YW50ICovCisgICAgdWludDY0X3QgY291bnQ7IC8qIGNvdW50IGluIGxvZ2ljYWwgYmxvY2tzICov
CisKKyAgICB1aW50NjRfdCBvZmZzZXQ7IC8qIHNjc2kgY2RiIG9mZnNldCwgbm9ybWFsaXplZCB0
byBieXRlcyAqLworICAgIHVpbnQ2NF90IHJlcV9sZW47IC8qIHNjc2kgY2RiIHJlcXVlc3QgbGVu
Z3RoLCBub3JtYWxpemVkIHRvIGJ5dGVzICovCisKKyAgICAvKiByZXN1bHQgKi8KKyAgICB1aW50
NjRfdCBpbl9sZW47IC8qIGxlbmd0aCBvZiBkYXRhIGFjdHVhbGx5IGF2YWlsYWJsZSBhZnRlciBy
ZWFkICovCisgICAgdWludDMyX3Qgc3RhdHVzOyAvKiBTQ1NJIHN0YXR1cyBjb2RlICovCisKK30g
Q2RTY3NpUmVxdWVzdDsKKworQ2RTY3NpUmVxU3RhdGUgY2Rfc2NzaV9nZXRfcmVxX3N0YXRlKENk
U2NzaVJlcXVlc3QgKnJlcSk7CisKKy8qIFNDU0kgdGFyZ2V0L2RldmljZSBBUEkgKi8KK3R5cGVk
ZWYgc3RydWN0IENkU2NzaVRhcmdldCBDZFNjc2lUYXJnZXQ7CisKKy8qIHRvIGJlIHVzZWQgaW4g
Y2FsbGJhY2tzICovCitDZFNjc2lUYXJnZXQgKmNkX3Njc2lfdGFyZ2V0X2FsbG9jKHZvaWQgKnRh
cmdldF91c2VyX2RhdGEsIHVpbnQzMl90IG1heF9sdW5zKTsKK3ZvaWQgY2Rfc2NzaV90YXJnZXRf
ZnJlZShDZFNjc2lUYXJnZXQgKnNjc2lfdGFyZ2V0KTsKKworaW50IGNkX3Njc2lfZGV2X3JlYWxp
emUoQ2RTY3NpVGFyZ2V0ICpzY3NpX3RhcmdldCwgdWludDMyX3QgbHVuLAorICAgICAgICAgICAg
ICAgICAgICAgICAgY29uc3QgQ2RTY3NpRGV2aWNlUGFyYW1ldGVycyAqZGV2X3BhcmFtcyk7Citp
bnQgY2Rfc2NzaV9kZXZfdW5yZWFsaXplKENkU2NzaVRhcmdldCAqc2NzaV90YXJnZXQsIHVpbnQz
Ml90IGx1bik7CisKK2ludCBjZF9zY3NpX2Rldl9sb2NrKENkU2NzaVRhcmdldCAqc2NzaV90YXJn
ZXQsIHVpbnQzMl90IGx1biwgZ2Jvb2xlYW4gbG9jayk7CitpbnQgY2Rfc2NzaV9kZXZfbG9hZChD
ZFNjc2lUYXJnZXQgKnNjc2lfdGFyZ2V0LCB1aW50MzJfdCBsdW4sCisgICAgICAgICAgICAgICAg
ICAgICBjb25zdCBDZFNjc2lNZWRpYVBhcmFtZXRlcnMgKm1lZGlhX3BhcmFtcyk7CitpbnQgY2Rf
c2NzaV9kZXZfZ2V0X2luZm8oQ2RTY3NpVGFyZ2V0ICpzY3NpX3RhcmdldCwgdWludDMyX3QgbHVu
LCBDZFNjc2lEZXZpY2VJbmZvICpsdW5faW5mbyk7CitpbnQgY2Rfc2NzaV9kZXZfdW5sb2FkKENk
U2NzaVRhcmdldCAqc2NzaV90YXJnZXQsIHVpbnQzMl90IGx1bik7CisKK3ZvaWQgY2Rfc2NzaV9k
ZXZfcmVxdWVzdF9zdWJtaXQoQ2RTY3NpVGFyZ2V0ICpzY3NpX3RhcmdldCwgQ2RTY3NpUmVxdWVz
dCAqcmVxdWVzdCk7Cit2b2lkIGNkX3Njc2lfZGV2X3JlcXVlc3RfY2FuY2VsKENkU2NzaVRhcmdl
dCAqc2NzaV90YXJnZXQsIENkU2NzaVJlcXVlc3QgKnJlcXVlc3QpOwordm9pZCBjZF9zY3NpX2Rl
dl9yZXF1ZXN0X3JlbGVhc2UoQ2RTY3NpVGFyZ2V0ICpzY3NpX3RhcmdldCwgQ2RTY3NpUmVxdWVz
dCAqcmVxdWVzdCk7CisKK2ludCBjZF9zY3NpX2Rldl9yZXNldChDZFNjc2lUYXJnZXQgKnNjc2lf
dGFyZ2V0LCB1aW50MzJfdCBsdW4pOworCitpbnQgY2Rfc2NzaV90YXJnZXRfcmVzZXQoQ2RTY3Np
VGFyZ2V0ICpzY3NpX3RhcmdldCk7CisKKy8qIENhbGxiYWNrcworICogVGhlc2UgY2FsbGJhY2tz
IGFyZSB1c2VkIGJ5IHVwcGVyIGxheWVyIHRvIGltcGxlbWVudCBzcGVjaWZpYyBTQ1NJCisgKiB0
YXJnZXQgZGV2aWNlcy4KKyAqLwordm9pZCBjZF9zY3NpX2Rldl9yZXF1ZXN0X2NvbXBsZXRlKHZv
aWQgKnRhcmdldF91c2VyX2RhdGEsIENkU2NzaVJlcXVlc3QgKnJlcXVlc3QpOwordm9pZCBjZF9z
Y3NpX2Rldl9jaGFuZ2VkKHZvaWQgKnRhcmdldF91c2VyX2RhdGEsIHVpbnQzMl90IGx1bik7Cit2
b2lkIGNkX3Njc2lfZGV2X3Jlc2V0X2NvbXBsZXRlKHZvaWQgKnRhcmdldF91c2VyX2RhdGEsIHVp
bnQzMl90IGx1bik7Cit2b2lkIGNkX3Njc2lfdGFyZ2V0X3Jlc2V0X2NvbXBsZXRlKHZvaWQgKnRh
cmdldF91c2VyX2RhdGEpOwpkaWZmIC0tZ2l0IGEvc3JjL2NkLXVzYi1idWxrLW1zZC5jIGIvc3Jj
L2NkLXVzYi1idWxrLW1zZC5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwLi41
ZDk1ZGFjNwotLS0gL2Rldi9udWxsCisrKyBiL3NyYy9jZC11c2ItYnVsay1tc2QuYwpAQCAtMCww
ICsxLDU0MyBAQAorLyogLSotIE1vZGU6IEM7IGMtYmFzaWMtb2Zmc2V0OiA0OyBpbmRlbnQtdGFi
cy1tb2RlOiBuaWwgLSotICovCisvKgorICAgIFVTQiBDRCBEZXZpY2UgZW11bGF0aW9uIC0gRGF0
YSBCdWxrIHRyYW5zZmVycyAtIE1hc3MgU3RvcmFnZSBEZXZpY2UKKworICAgIENvcHlyaWdodCAo
QykgMjAxOCBSZWQgSGF0LCBJbmMuCisKKyAgICBSZWQgSGF0IEF1dGhvcnM6CisgICAgQWxleGFu
ZGVyIE5lemhpbnNreTxhbmV6aGluc0ByZWRoYXQuY29tPgorCisgICAgVGhpcyBsaWJyYXJ5IGlz
IGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vcgorICAgIG1vZGlm
eSBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKKyAg
ICBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBl
aXRoZXIKKyAgICB2ZXJzaW9uIDIuMSBvZiB0aGUgTGljZW5zZSwgb3IgKGF0IHlvdXIgb3B0aW9u
KSBhbnkgbGF0ZXIgdmVyc2lvbi4KKworICAgIFRoaXMgbGlicmFyeSBpcyBkaXN0cmlidXRlZCBp
biB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAorICAgIGJ1dCBXSVRIT1VUIEFOWSBX
QVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCisgICAgTUVSQ0hB
TlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZSBH
TlUKKyAgICBMZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgor
CisgICAgWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIExlc3NlciBH
ZW5lcmFsIFB1YmxpYworICAgIExpY2Vuc2UgYWxvbmcgd2l0aCB0aGlzIGxpYnJhcnk7IGlmIG5v
dCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4KKyovCisKKyNpbmNsdWRlICJj
b25maWcuaCIKKyNpbmNsdWRlICJzcGljZS90eXBlcy5oIgorI2luY2x1ZGUgInNwaWNlLWNvbW1v
bi5oIgorI2luY2x1ZGUgInNwaWNlLXV0aWwuaCIKKyNpbmNsdWRlICJjZC11c2ItYnVsay1tc2Qu
aCIKKyNpbmNsdWRlICJjZC1zY3NpLmgiCisKKyNpZmRlZiBVU0VfVVNCUkVESVIKKworI2RlZmlu
ZSBTUElDRV9FUlJPUihmbXQsIC4uLikgXAorICAgIGRvIHsgU1BJQ0VfREVCVUcoInVzYi1tc2Qg
ZXJyb3I6ICIgZm10ICwgIyMgX19WQV9BUkdTX18pOyB9IHdoaWxlICgwKQorCit0eXBlZGVmIGVu
dW0gVXNiQ2RTdGF0ZSB7CisgICAgVVNCX0NEX1NUQVRFX0lOSVQsIC8qIE5vdCByZWFkeSAqLwor
ICAgIFVTQl9DRF9TVEFURV9DQlcsIC8qIFdhaXRpbmcgZm9yIENvbW1hbmQgQmxvY2sgKi8KKyAg
ICBVU0JfQ0RfU1RBVEVfREFUQU9VVCwgLyogVHJhbnNmZXIgZGF0YSB0byBkZXZpY2UgKi8KKyAg
ICBVU0JfQ0RfU1RBVEVfREFUQUlOLCAvKiBUcmFuc2ZlciBkYXRhIGZyb20gZGV2aWNlICovCisg
ICAgVVNCX0NEX1NUQVRFX1pFUk9fREFUQUlOLCAvKiBOZWVkIHRvIHNlbmQgemVybyBidWxrLWlu
IGJlZm9yZSBzdGF0dXMgKi8KKyAgICBVU0JfQ0RfU1RBVEVfQ1NXLCAvKiBTZW5kIENvbW1hbmQg
U3RhdHVzICovCisgICAgVVNCX0NEX1NUQVRFX0RFVklDRV9SRVNFVCwgLyogcmVzZXQgb2YgYSBz
aW5nbGUgZGV2aWNlICovCisgICAgVVNCX0NEX1NUQVRFX1RBUkdFVF9SRVNFVCAvKiByZXNldCBv
ZiBlbnRpcmUgdGFyZ2V0ICovCit9IFVzYkNkU3RhdGU7CisKKy8qIFVTQiBNU0QgQ29tbWFuZCBC
bG9jayBXcmFwcGVyICovCitzdHJ1Y3QgX19hdHRyaWJ1dGVfXygoX19wYWNrZWRfXykpIFVzYkNk
Q0JXIHsKKyAgICB1aW50MzJfdCBzaWc7CisgICAgdWludDMyX3QgdGFnOworICAgIHVpbnQzMl90
IGV4cF9kYXRhX2xlbjsgLyogZXhwZWN0ZWQgZGF0YSB4ZmVyIGxlbmd0aCBmb3IgdGhlIHJlcXVl
c3QgKi8KKyAgICB1aW50OF90IGZsYWdzOworICAgIHVpbnQ4X3QgbHVuOworICAgIHVpbnQ4X3Qg
Y21kX2xlbjsgLyogYWN0dWFsIGxlbmd0aCBvZiB0aGUgc2NzaSBjb21tYW5kIHRoYXQgZm9sbG93
cyAqLworICAgIHVpbnQ4X3QgY21kWzE2XTsgLyogc2NzaSBjb21tYW5kIHRvIHBlcmZvcm0gKi8K
K307CisKKy8qIFVTQiBNU0QgQ29tbWFuZCBTdGF0dXMgV3JhcHBlciAqLworc3RydWN0IF9fYXR0
cmlidXRlX18oKF9fcGFja2VkX18pKSBVc2JDZENTVyB7CisgICAgdWludDMyX3Qgc2lnOworICAg
IHVpbnQzMl90IHRhZzsKKyAgICB1aW50MzJfdCByZXNpZHVlOworICAgIHVpbnQ4X3Qgc3RhdHVz
OworfTsKKworLyogVXNiQ2RDU1c6OnN0YXR1cyAqLwordHlwZWRlZiBlbnVtIFVzYk1zZFN0YXR1
cyB7CisgICAgVVNCX01TRF9TVEFUVVNfR09PRCA9IDAsCisgICAgVVNCX01TRF9TVEFUVVNfRkFJ
TEVEID0gMSwKKyAgICBVU0JfTVNEX1NUQVRVU19QSEFTRV9FUlIgPSAyLAorfSBVc2JNc2RTdGF0
dXM7CisKK3R5cGVkZWYgc3RydWN0IFVzYkNkQnVsa01zZFJlcXVlc3QgeworICAgIENkU2NzaVJl
cXVlc3Qgc2NzaV9yZXE7CisKKyAgICB1aW50MzJfdCBsdW47CisgICAgdWludDMyX3QgdXNiX3Jl
cV9sZW47IC8qIGxlbmd0aCBvZiBkYXRhIHJlcXVlc3RlZCBieSB1c2IgKi8KKyAgICB1aW50MzJf
dCBzY3NpX2luX2xlbjsgLyogbGVuZ3RoIG9mIGRhdGEgcmV0dXJuZWQgYnkgc2NzaSBsaW1pdGVk
IGJ5IHVzYiByZXF1ZXN0ICovCisKKyAgICB1aW50MzJfdCB4ZmVyX2xlbjsgLyogbGVuZ3RoIG9m
IGRhdGEgdHJhbnNmZXJlZCB1bnRpbCBub3cgKi8KKyAgICB1aW50MzJfdCBidWxrX2luX2xlbjsg
LyogbGVuZ3RoIG9mIHRoZSBsYXN0IHBvc3Rwb25lZCBidWxrLWluIHJlcXVlc3QgKi8KKworICAg
IHN0cnVjdCBVc2JDZENTVyBjc3c7IC8qIHVzYiBzdGF0dXMgaGVhZGVyICovCit9IFVzYkNkQnVs
a01zZFJlcXVlc3Q7CisKK3R5cGVkZWYgc3RydWN0IFVzYkNkQnVsa01zZERldmljZSB7CisgICAg
VXNiQ2RTdGF0ZSBzdGF0ZTsKKyAgICBDZFNjc2lUYXJnZXQgKnNjc2lfdGFyZ2V0OyAvKiBzY3Np
IGhhbmRsZSAqLworICAgIHZvaWQgKnVzYl91c2VyX2RhdGE7IC8qIHVzZWQgaW4gY2FsbGJhY2tz
IHRvIHVzYiAqLworICAgIFVzYkNkQnVsa01zZFJlcXVlc3QgdXNiX3JlcTsgLyogbm93IHN1cHBv
cnRpbmcgYSBzaW5nbGUgY21kICovCisgICAgdWludDhfdCAqZGF0YV9idWY7CisgICAgdWludDMy
X3QgZGF0YV9idWZfbGVuOworfSBVc2JDZEJ1bGtNc2REZXZpY2U7CisKK3N0YXRpYyBpbmxpbmUg
Y29uc3QgY2hhciAqdXNiX2NkX3N0YXRlX3N0cihVc2JDZFN0YXRlIHN0YXRlKQoreworICAgIHN3
aXRjaCAoc3RhdGUpIHsKKyAgICBjYXNlIFVTQl9DRF9TVEFURV9JTklUOgorICAgICAgICByZXR1
cm4gIklOSVQiOworICAgIGNhc2UgVVNCX0NEX1NUQVRFX0NCVzoKKyAgICAgICAgcmV0dXJuICJD
QlciOworICAgIGNhc2UgVVNCX0NEX1NUQVRFX0RBVEFPVVQ6CisgICAgICAgIHJldHVybiAiREFU
QU9VVCI7CisgICAgY2FzZSBVU0JfQ0RfU1RBVEVfREFUQUlOOgorICAgICAgICByZXR1cm4gIkRB
VEFJTiI7CisgICAgY2FzZSBVU0JfQ0RfU1RBVEVfWkVST19EQVRBSU46CisgICAgICAgIHJldHVy
biAiWkVST19EQVRBSU4iOworICAgIGNhc2UgVVNCX0NEX1NUQVRFX0NTVzoKKyAgICAgICAgcmV0
dXJuICJDU1ciOworICAgIGNhc2UgVVNCX0NEX1NUQVRFX0RFVklDRV9SRVNFVDoKKyAgICAgICAg
cmV0dXJuICJERVZfUkVTRVQiOworICAgIGNhc2UgVVNCX0NEX1NUQVRFX1RBUkdFVF9SRVNFVDoK
KyAgICAgICAgcmV0dXJuICJUR1RfUkVTRVQiOworICAgIGRlZmF1bHQ6CisgICAgICAgIHJldHVy
biAiSUxMRUdBTCI7CisgICAgfQorfQorCitzdGF0aWMgdm9pZCBjZF91c2JfYnVsa19tc2Rfc2V0
X3N0YXRlKFVzYkNkQnVsa01zZERldmljZSAqY2QsIFVzYkNkU3RhdGUgc3RhdGUpCit7CisgICAg
U1BJQ0VfREVCVUcoIlN0YXRlICVzIC0+ICVzIiwgdXNiX2NkX3N0YXRlX3N0cihjZC0+c3RhdGUp
LCB1c2JfY2Rfc3RhdGVfc3RyKHN0YXRlKSk7CisgICAgY2QtPnN0YXRlID0gc3RhdGU7Cit9CisK
K1VzYkNkQnVsa01zZERldmljZSAqY2RfdXNiX2J1bGtfbXNkX2FsbG9jKHZvaWQgKnVzYl91c2Vy
X2RhdGEsIHVpbnQzMl90IG1heF9sdW5zKQoreworICAgIFVzYkNkQnVsa01zZERldmljZSAqY2Qg
PSBnX25ldzAoVXNiQ2RCdWxrTXNkRGV2aWNlLCAxKTsKKworICAgIGNkLT5kYXRhX2J1Zl9sZW4g
PSAyNTYgKiAxMDI0OworICAgIGNkLT5kYXRhX2J1ZiA9IGdfbWFsbG9jKGNkLT5kYXRhX2J1Zl9s
ZW4pOworCisgICAgY2QtPnNjc2lfdGFyZ2V0ID0gY2Rfc2NzaV90YXJnZXRfYWxsb2MoY2QsIG1h
eF9sdW5zKTsKKyAgICBpZiAoY2QtPnNjc2lfdGFyZ2V0ID09IE5VTEwpIHsKKyAgICAgICAgZ19m
cmVlKGNkLT5kYXRhX2J1Zik7CisgICAgICAgIGdfZnJlZShjZCk7CisgICAgICAgIHJldHVybiBO
VUxMOworICAgIH0KKyAgICBjZF91c2JfYnVsa19tc2Rfc2V0X3N0YXRlKGNkLCBVU0JfQ0RfU1RB
VEVfSU5JVCk7CisgICAgY2QtPnVzYl91c2VyX2RhdGEgPSB1c2JfdXNlcl9kYXRhOworCisgICAg
U1BJQ0VfREVCVUcoIkFsbG9jLCBtYXhfbHVuczoldSIsIG1heF9sdW5zKTsKKyAgICByZXR1cm4g
Y2Q7Cit9CisKK2ludCBjZF91c2JfYnVsa19tc2RfcmVhbGl6ZShVc2JDZEJ1bGtNc2REZXZpY2Ug
KmNkLCB1aW50MzJfdCBsdW4sCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgQ2RT
Y3NpRGV2aWNlUGFyYW1ldGVycyAqZGV2X3BhcmFtcykKK3sKKyAgICBDZFNjc2lEZXZpY2VQYXJh
bWV0ZXJzIHNjc2lfZGV2X3BhcmFtczsKKyAgICBpbnQgcmM7CisKKyAgICBzY3NpX2Rldl9wYXJh
bXMudmVuZG9yID0gZGV2X3BhcmFtcy0+dmVuZG9yID8gOiAiU1BJQ0UiOworICAgIHNjc2lfZGV2
X3BhcmFtcy5wcm9kdWN0ID0gZGV2X3BhcmFtcy0+cHJvZHVjdCA/IDogIlVTQi1DRCI7CisgICAg
c2NzaV9kZXZfcGFyYW1zLnZlcnNpb24gPSBkZXZfcGFyYW1zLT52ZXJzaW9uID8gOiAiMC4xIjsK
KyAgICBzY3NpX2Rldl9wYXJhbXMuc2VyaWFsID0gZGV2X3BhcmFtcy0+c2VyaWFsID8gOiAiMTIz
NDU2IjsKKworICAgIHJjID0gY2Rfc2NzaV9kZXZfcmVhbGl6ZShjZC0+c2NzaV90YXJnZXQsIGx1
biwgJnNjc2lfZGV2X3BhcmFtcyk7CisgICAgaWYgKHJjICE9IDApIHsKKyAgICAgICAgU1BJQ0Vf
RVJST1IoIkZhaWxlZCB0byByZWFsaXplIGx1bjoldSIsIGx1bik7CisgICAgICAgIHJldHVybiBy
YzsKKyAgICB9CisKKyAgICBpZiAoY2QtPnN0YXRlID09IFVTQl9DRF9TVEFURV9JTklUKSB7Cisg
ICAgICAgIC8qIHdhaXQgbmV4dCByZXF1ZXN0ICovCisgICAgICAgIGNkX3VzYl9idWxrX21zZF9z
ZXRfc3RhdGUoY2QsIFVTQl9DRF9TVEFURV9DQlcpOworICAgICAgICBjZF9zY3NpX2Rldl9yZXF1
ZXN0X3JlbGVhc2UoY2QtPnNjc2lfdGFyZ2V0LCAmY2QtPnVzYl9yZXEuc2NzaV9yZXEpOworICAg
IH0KKworICAgIFNQSUNFX0RFQlVHKCJSZWFsaXplIE9LIGx1bjoldSIsIGx1bik7CisgICAgcmV0
dXJuIDA7Cit9CisKK2ludCBjZF91c2JfYnVsa19tc2RfbG9jayhVc2JDZEJ1bGtNc2REZXZpY2Ug
KmNkLCB1aW50MzJfdCBsdW4sIGdib29sZWFuIGxvY2spCit7CisgICAgaW50IHJjOworCisgICAg
cmMgPSBjZF9zY3NpX2Rldl9sb2NrKGNkLT5zY3NpX3RhcmdldCwgbHVuLCBsb2NrKTsKKyAgICBp
ZiAocmMgIT0gMCkgeworICAgICAgICBTUElDRV9FUlJPUigiRmFpbGVkIHRvIGxvY2sgbHVuOiV1
IiwgbHVuKTsKKyAgICAgICAgcmV0dXJuIHJjOworICAgIH0KKworICAgIFNQSUNFX0RFQlVHKCJM
b2NrIE9LIGx1bjoldSIsIGx1bik7CisgICAgcmV0dXJuIDA7Cit9CisKK2ludCBjZF91c2JfYnVs
a19tc2RfbG9hZChVc2JDZEJ1bGtNc2REZXZpY2UgKmNkLCB1aW50MzJfdCBsdW4sCisgICAgICAg
ICAgICAgICAgICAgICAgICAgY29uc3QgQ2RTY3NpTWVkaWFQYXJhbWV0ZXJzICptZWRpYV9wYXJh
bXMpCit7CisgICAgaW50IHJjOworCisgICAgcmMgPSBjZF9zY3NpX2Rldl9sb2FkKGNkLT5zY3Np
X3RhcmdldCwgbHVuLCBtZWRpYV9wYXJhbXMpOworICAgIGlmIChyYyAhPSAwKSB7CisgICAgICAg
IFNQSUNFX0VSUk9SKCJGYWlsZWQgdG8gbG9hZCBsdW46JXUiLCBsdW4pOworICAgICAgICByZXR1
cm4gcmM7CisgICAgfQorCisgICAgU1BJQ0VfREVCVUcoIkxvYWQgT0sgbHVuOiV1IiwgbHVuKTsK
KyAgICByZXR1cm4gMDsKK30KKworaW50IGNkX3VzYl9idWxrX21zZF9nZXRfaW5mbyhVc2JDZEJ1
bGtNc2REZXZpY2UgKmNkLCB1aW50MzJfdCBsdW4sIENkU2NzaURldmljZUluZm8gKmx1bl9pbmZv
KQoreworICAgIGludCByYzsKKworICAgIHJjID0gY2Rfc2NzaV9kZXZfZ2V0X2luZm8oY2QtPnNj
c2lfdGFyZ2V0LCBsdW4sIGx1bl9pbmZvKTsKKyAgICBpZiAocmMgIT0gMCkgeworICAgICAgICBT
UElDRV9FUlJPUigiRmFpbGVkIHRvIGdldCBpbmZvIGx1bjoldSIsIGx1bik7CisgICAgICAgIHJl
dHVybiByYzsKKyAgICB9CisKKyAgICByZXR1cm4gMDsKK30KKworaW50IGNkX3VzYl9idWxrX21z
ZF91bmxvYWQoVXNiQ2RCdWxrTXNkRGV2aWNlICpjZCwgdWludDMyX3QgbHVuKQoreworICAgIGlu
dCByYzsKKworICAgIHJjID0gY2Rfc2NzaV9kZXZfdW5sb2FkKGNkLT5zY3NpX3RhcmdldCwgbHVu
KTsKKyAgICBpZiAocmMgIT0gMCkgeworICAgICAgICBTUElDRV9FUlJPUigiRmFpbGVkIHRvIHVu
bG9hZCBsdW46JXUiLCBsdW4pOworICAgICAgICByZXR1cm4gcmM7CisgICAgfQorCisgICAgU1BJ
Q0VfREVCVUcoIlVubG9hZCBPSyBsdW46JXUiLCBsdW4pOworICAgIHJldHVybiAwOworfQorCitp
bnQgY2RfdXNiX2J1bGtfbXNkX3VucmVhbGl6ZShVc2JDZEJ1bGtNc2REZXZpY2UgKmNkLCB1aW50
MzJfdCBsdW4pCit7CisgICAgaW50IHJjOworCisgICAgcmMgPSBjZF9zY3NpX2Rldl91bnJlYWxp
emUoY2QtPnNjc2lfdGFyZ2V0LCBsdW4pOworICAgIGlmIChyYyAhPSAwKSB7CisgICAgICAgIFNQ
SUNFX0VSUk9SKCJVbnJlYWxpemUgbHVuOiV1IiwgbHVuKTsKKyAgICAgICAgcmV0dXJuIHJjOwor
ICAgIH0KKworICAgIFNQSUNFX0RFQlVHKCJVbnJlYWxpemUgbHVuOiV1IiwgbHVuKTsKKyAgICBy
ZXR1cm4gMDsKK30KKwordm9pZCBjZF91c2JfYnVsa19tc2RfZnJlZShVc2JDZEJ1bGtNc2REZXZp
Y2UgKmNkKQoreworICAgIGNkX3Njc2lfdGFyZ2V0X2ZyZWUoY2QtPnNjc2lfdGFyZ2V0KTsKKyAg
ICBnX2ZyZWUoY2QtPmRhdGFfYnVmKTsKKyAgICBnX2ZyZWUoY2QpOworCisgICAgU1BJQ0VfREVC
VUcoIkZyZWUiKTsKK30KKworaW50IGNkX3VzYl9idWxrX21zZF9yZXNldChVc2JDZEJ1bGtNc2RE
ZXZpY2UgKmNkKQoreworICAgIGNkX3Njc2lfdGFyZ2V0X3Jlc2V0KGNkLT5zY3NpX3RhcmdldCk7
CisgICAgY2RfdXNiX2J1bGtfbXNkX3NldF9zdGF0ZShjZCwgVVNCX0NEX1NUQVRFX0NCVyk7CisK
KyAgICBTUElDRV9ERUJVRygiUmVzZXQiKTsKKyAgICByZXR1cm4gMDsKK30KKworc3RhdGljIGlu
dCBwYXJzZV91c2JfbXNkX2NtZChVc2JDZEJ1bGtNc2REZXZpY2UgKmNkLCB1aW50OF90ICpidWYs
IHVpbnQzMl90IGNid19sZW4pCit7CisgICAgc3RydWN0IFVzYkNkQ0JXICpjYncgPSAoc3RydWN0
IFVzYkNkQ0JXICopYnVmOworICAgIFVzYkNkQnVsa01zZFJlcXVlc3QgKnVzYl9yZXEgPSAmY2Qt
PnVzYl9yZXE7CisgICAgQ2RTY3NpUmVxdWVzdCAqc2NzaV9yZXEgPSAmdXNiX3JlcS0+c2NzaV9y
ZXE7CisKKyAgICBpZiAoY2J3X2xlbiAhPSBzaXplb2YoKmNidykpIHsKKyAgICAgICAgU1BJQ0Vf
RVJST1IoIkNNRDogQmFkIENCVyBzaXplOiV1IiwgY2J3X2xlbik7CisgICAgICAgIHJldHVybiAt
MTsKKyAgICB9CisgICAgaWYgKGxlMzJ0b2goY2J3LT5zaWcpICE9IDB4NDM0MjUzNTUpIHsgLyog
TVNEIGNvbW1hbmQgc2lnbmF0dXJlICovCisgICAgICAgIFNQSUNFX0VSUk9SKCJDTUQ6IEJhZCBD
Qlcgc2lnbmF0dXJlOiUwOHgiLCBsZTMydG9oKGNidy0+c2lnKSk7CisgICAgICAgIHJldHVybiAt
MTsKKyAgICB9CisgICAgY29uc3QgdWludDhfdCBjbWRfbGVuID0gY2J3LT5jbWRfbGVuICYgMHgx
RjsKKyAgICBpZiAoY21kX2xlbiA8IDEgfHwgY21kX2xlbiA+IDE2KSB7CisgICAgICAgIFNQSUNF
X0VSUk9SKCJDTUQ6IEJhZCBDQlcgY29tbWFuZCBsZW46JTA4eCIsIGNtZF9sZW4pOworICAgICAg
ICByZXR1cm4gLTE7CisgICAgfQorCisgICAgdXNiX3JlcS0+bHVuID0gY2J3LT5sdW47CisgICAg
dXNiX3JlcS0+dXNiX3JlcV9sZW4gPSBsZTMydG9oKGNidy0+ZXhwX2RhdGFfbGVuKTsKKworICAg
IHVzYl9yZXEtPnNjc2lfaW5fbGVuID0gMDsgLyogbm8gZGF0YSBmcm9tIHNjc2kgeWV0ICovCisg
ICAgdXNiX3JlcS0+eGZlcl9sZW4gPSAwOyAvKiBubyBidWxrcyB0cmFuc2ZlcmVkIHlldCAqLwor
ICAgIHVzYl9yZXEtPmJ1bGtfaW5fbGVuID0gMDsgLyogbm8gYnVsay1pbiByZXF1ZXN0cyB5ZXQg
Ki8KKworICAgIGlmICh1c2JfcmVxLT51c2JfcmVxX2xlbiA9PSAwKSB7CisgICAgICAgIGNkX3Vz
Yl9idWxrX21zZF9zZXRfc3RhdGUoY2QsIFVTQl9DRF9TVEFURV9DU1cpOyAvKiBubyBkYXRhIC0g
cmV0dXJuIHN0YXR1cyAqLworICAgICAgICBzY3NpX3JlcS0+YnVmID0gTlVMTDsKKyAgICAgICAg
c2NzaV9yZXEtPmJ1Zl9sZW4gPSAwOworICAgIH0gZWxzZSBpZiAoY2J3LT5mbGFncyAmIDB4ODAp
IHsKKyAgICAgICAgY2RfdXNiX2J1bGtfbXNkX3NldF9zdGF0ZShjZCwgVVNCX0NEX1NUQVRFX0RB
VEFJTik7IC8qIHJlYWQgY29tbWFuZCAqLworICAgICAgICBzY3NpX3JlcS0+YnVmID0gY2QtPmRh
dGFfYnVmOworICAgICAgICBzY3NpX3JlcS0+YnVmX2xlbiA9IGNkLT5kYXRhX2J1Zl9sZW47Cisg
ICAgfSBlbHNlIHsKKyAgICAgICAgY2RfdXNiX2J1bGtfbXNkX3NldF9zdGF0ZShjZCwgVVNCX0NE
X1NUQVRFX0RBVEFPVVQpOyAvKiB3cml0ZSBjb21tYW5kICovCisgICAgICAgIHNjc2lfcmVxLT5i
dWYgPSBOVUxMOworICAgICAgICBzY3NpX3JlcS0+YnVmX2xlbiA9IDA7CisgICAgfQorCisgICAg
c2NzaV9yZXEtPmNkYl9sZW4gPSBjbWRfbGVuOworICAgIGdfYXNzZXJ0KHNjc2lfcmVxLT5jZGJf
bGVuIDw9IHNpemVvZihzY3NpX3JlcS0+Y2RiKSk7CisgICAgbWVtY3B5KHNjc2lfcmVxLT5jZGIs
IGNidy0+Y21kLCBzY3NpX3JlcS0+Y2RiX2xlbik7CisKKyAgICBzY3NpX3JlcS0+bHVuID0gdXNi
X3JlcS0+bHVuOworCisgICAgU1BJQ0VfREVCVUcoIkNNRCBsdW46JXUgdGFnOiUjeCBmbGFnczol
MDh4ICIKKyAgICAgICAgICAgICAgICAiY2RiX2xlbjoldSByZXFfbGVuOiV1IiwKKyAgICAgICAg
ICAgICAgICB1c2JfcmVxLT5sdW4sIGxlMzJ0b2goY2J3LT50YWcpLCBjYnctPmZsYWdzLAorICAg
ICAgICAgICAgICAgIHNjc2lfcmVxLT5jZGJfbGVuLCB1c2JfcmVxLT51c2JfcmVxX2xlbik7CisK
KyAgICAvKiBwcmVwYXJlIHN0YXR1cyAtIENTVyAqLworICAgIHVzYl9yZXEtPmNzdy5zaWcgPSBo
dG9sZTMyKDB4NTM0MjUzNTUpOworICAgIHVzYl9yZXEtPmNzdy50YWcgPSBjYnctPnRhZzsKKyAg
ICB1c2JfcmVxLT5jc3cucmVzaWR1ZSA9IDA7CisgICAgdXNiX3JlcS0+Y3N3LnN0YXR1cyA9ICh1
aW50OF90KVVTQl9NU0RfU1RBVFVTX0dPT0Q7CisKKyAgICByZXR1cm4gMDsKK30KKworc3RhdGlj
IHZvaWQgdXNiX2NkX2NtZF9kb25lKFVzYkNkQnVsa01zZERldmljZSAqY2QpCit7CisgICAgVXNi
Q2RCdWxrTXNkUmVxdWVzdCAqdXNiX3JlcSA9ICZjZC0+dXNiX3JlcTsKKyAgICBDZFNjc2lSZXF1
ZXN0ICpzY3NpX3JlcSA9ICZ1c2JfcmVxLT5zY3NpX3JlcTsKKworICAgIGNkX3VzYl9idWxrX21z
ZF9zZXRfc3RhdGUoY2QsIFVTQl9DRF9TVEFURV9DQlcpOyAvKiBDb21tYW5kIG5leHQgKi8KKyAg
ICBjZF9zY3NpX2Rldl9yZXF1ZXN0X3JlbGVhc2UoY2QtPnNjc2lfdGFyZ2V0LCBzY3NpX3JlcSk7
Cit9CisKK3N0YXRpYyB2b2lkIHVzYl9jZF9zZW5kX3N0YXR1cyhVc2JDZEJ1bGtNc2REZXZpY2Ug
KmNkKQoreworICAgIFVzYkNkQnVsa01zZFJlcXVlc3QgKnVzYl9yZXEgPSAmY2QtPnVzYl9yZXE7
CisKKyAgICBTUElDRV9ERUJVRygiQ29tbWFuZCBDU1cgdGFnOjB4JXggbXNkX3N0YXR1czolZCBs
ZW46JSIgR19HVUlOVDY0X0ZPUk1BVCwKKyAgICAgICAgICAgICAgICBsZTMydG9oKHVzYl9yZXEt
PmNzdy50YWcpLCAoaW50KXVzYl9yZXEtPmNzdy5zdGF0dXMsIHNpemVvZih1c2JfcmVxLT5jc3cp
KTsKKworICAgIHVzYl9jZF9jbWRfZG9uZShjZCk7CisKKyAgICBnX2Fzc2VydCh1c2JfcmVxLT5j
c3cuc2lnID09IGh0b2xlMzIoMHg1MzQyNTM1NSkpOworICAgIGNkX3VzYl9idWxrX21zZF9yZWFk
X2NvbXBsZXRlKGNkLT51c2JfdXNlcl9kYXRhLAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICh1aW50OF90ICopJnVzYl9yZXEtPmNzdywgc2l6ZW9mKHVzYl9yZXEtPmNzdyksCisg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQlVMS19TVEFUVVNfR09PRCk7Cit9CisK
K3N0YXRpYyB2b2lkIHVzYl9jZF9zZW5kX2NhbmNlbGVkKFVzYkNkQnVsa01zZERldmljZSAqY2Qp
Cit7CisgICAgVXNiQ2RCdWxrTXNkUmVxdWVzdCAqdXNiX3JlcSA9ICZjZC0+dXNiX3JlcTsKKwor
ICAgIFNQSUNFX0RFQlVHKCJDYW5jZWxlZCBjbWQgdGFnOjB4JXgsIGxlbjolIiBHX0dVSU5UNjRf
Rk9STUFULAorICAgICAgICAgICAgICAgIGxlMzJ0b2godXNiX3JlcS0+Y3N3LnRhZyksIHNpemVv
Zih1c2JfcmVxLT5jc3cpKTsKKworICAgIHVzYl9jZF9jbWRfZG9uZShjZCk7CisKKyAgICBjZF91
c2JfYnVsa19tc2RfcmVhZF9jb21wbGV0ZShjZC0+dXNiX3VzZXJfZGF0YSwKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBOVUxMLCAwLAorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIEJVTEtfU1RBVFVTX0NBTkNFTEVEKTsKK30KKworc3RhdGljIHZvaWQgdXNiX2Nk
X3NlbmRfZGF0YV9pbihVc2JDZEJ1bGtNc2REZXZpY2UgKmNkLCB1aW50MzJfdCBtYXhfbGVuKQor
eworICAgIFVzYkNkQnVsa01zZFJlcXVlc3QgKnVzYl9yZXEgPSAmY2QtPnVzYl9yZXE7CisgICAg
Q2RTY3NpUmVxdWVzdCAqc2NzaV9yZXEgPSAmdXNiX3JlcS0+c2NzaV9yZXE7CisgICAgdWludDhf
dCAqYnVmID0gKCh1aW50OF90ICopc2NzaV9yZXEtPmJ1ZikgKyB1c2JfcmVxLT54ZmVyX2xlbjsK
KyAgICB1aW50MzJfdCBhdmFpbF9sZW4gPSB1c2JfcmVxLT5zY3NpX2luX2xlbiAtIHVzYl9yZXEt
PnhmZXJfbGVuOworICAgIHVpbnQzMl90IHNlbmRfbGVuID0gTUlOKGF2YWlsX2xlbiwgbWF4X2xl
bik7CisKKyAgICBTUElDRV9ERUJVRygiRGF0YS1pbiBjbWQgdGFnIDB4JXgsIHJlbWFpbnMgJXUi
CisgICAgICAgICAgICAgICAgIiwgcmVxdWVzdGVkICV1LCBzZW5kICV1IiwKKyAgICAgICAgICAg
ICAgICB1c2JfcmVxLT5jc3cudGFnLCBhdmFpbF9sZW4sIG1heF9sZW4sIHNlbmRfbGVuKTsKKwor
ICAgIGdfYXNzZXJ0KG1heF9sZW4gPD0gdXNiX3JlcS0+dXNiX3JlcV9sZW4pOworCisgICAgY2Rf
dXNiX2J1bGtfbXNkX3JlYWRfY29tcGxldGUoY2QtPnVzYl91c2VyX2RhdGEsCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgYnVmLCBzZW5kX2xlbiwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBCVUxLX1NUQVRVU19HT09EKTsKKworICAgIGlmIChzY3NpX3JlcS0+
c3RhdHVzID09IEdPT0QpIHsKKyAgICAgICAgdXNiX3JlcS0+eGZlcl9sZW4gKz0gc2VuZF9sZW47
CisgICAgICAgIGlmICh1c2JfcmVxLT54ZmVyX2xlbiA9PSB1c2JfcmVxLT5zY3NpX2luX2xlbikg
eworICAgICAgICAgICAgLyogYWxsIGRhdGEgZm9yIHRoaXMgYnVsayBoYXMgYmVlbiB0cmFuc2Zl
cnJlZCAqLworICAgICAgICAgICAgaWYgKHVzYl9yZXEtPnNjc2lfaW5fbGVuID09IHVzYl9yZXEt
PnVzYl9yZXFfbGVuIHx8IC8qIHJlcSBmdWxseSBzYXRpc2ZpZWQgKi8KKyAgICAgICAgICAgICAg
ICBzZW5kX2xlbiA8IG1heF9sZW4pIHsgLyogcGFydGlhbCBidWxrIC0gbm8gbW9yZSBkYXRhICov
CisgICAgICAgICAgICAgICAgY2RfdXNiX2J1bGtfbXNkX3NldF9zdGF0ZShjZCwgVVNCX0NEX1NU
QVRFX0NTVyk7CisgICAgICAgICAgICB9IGVsc2UgeworICAgICAgICAgICAgICAgIC8qIHBhcnRp
YWwgY21kIGRhdGEgZnVsbGZpbGxlZCBlbnRpcmUgdnVsay1pbiByZXF1ZXN0ICovCisgICAgICAg
ICAgICAgICAgY2RfdXNiX2J1bGtfbXNkX3NldF9zdGF0ZShjZCwgVVNCX0NEX1NUQVRFX1pFUk9f
REFUQUlOKTsKKyAgICAgICAgICAgIH0KKyAgICAgICAgfQorICAgIH0gZWxzZSB7IC8qIGNtZCBm
YWlsZWQgLSBubyBtb3JlIGRhdGEgKi8KKyAgICAgICAgY2RfdXNiX2J1bGtfbXNkX3NldF9zdGF0
ZShjZCwgVVNCX0NEX1NUQVRFX0NTVyk7CisgICAgfQorfQorCitpbnQgY2RfdXNiX2J1bGtfbXNk
X3JlYWQoVXNiQ2RCdWxrTXNkRGV2aWNlICpjZCwgdWludDMyX3QgbWF4X2xlbikKK3sKKyAgICBV
c2JDZEJ1bGtNc2RSZXF1ZXN0ICp1c2JfcmVxID0gJmNkLT51c2JfcmVxOworICAgIENkU2NzaVJl
cXVlc3QgKnNjc2lfcmVxID0gJnVzYl9yZXEtPnNjc2lfcmVxOworCisgICAgU1BJQ0VfREVCVUco
Im1zZF9yZWFkLCBzdGF0ZTogJXMsIGxlbiAldSIsCisgICAgICAgICAgICAgICAgdXNiX2NkX3N0
YXRlX3N0cihjZC0+c3RhdGUpLCBtYXhfbGVuKTsKKworICAgIHN3aXRjaCAoY2QtPnN0YXRlKSB7
CisgICAgY2FzZSBVU0JfQ0RfU1RBVEVfQ1NXOiAvKiBDb21tYW5kIFN0YXR1cyAqLworICAgICAg
ICBpZiAobWF4X2xlbiA8IDEzKSB7CisgICAgICAgICAgICBnb3RvIGZhaWw7CisgICAgICAgIH0K
KyAgICAgICAgaWYgKGNkX3Njc2lfZ2V0X3JlcV9zdGF0ZShzY3NpX3JlcSkgPT0gU0NTSV9SRVFf
Q09NUExFVEUpIHsKKyAgICAgICAgICAgIHVzYl9jZF9zZW5kX3N0YXR1cyhjZCk7CisgICAgICAg
IH0gZWxzZSB7CisgICAgICAgICAgICB1c2JfcmVxLT5idWxrX2luX2xlbiArPSBtYXhfbGVuOwor
ICAgICAgICAgICAgU1BJQ0VfREVCVUcoIm1zZF9yZWFkIENTVywgcmVxIGluY29tcGxldGUsIGFk
ZGVkIGxlbiAldSIKKyAgICAgICAgICAgICAgICAgICAgICAgICIgc2F2ZWQgbGVuICV1IiwKKyAg
ICAgICAgICAgICAgICAgICAgICAgIG1heF9sZW4sIHVzYl9yZXEtPmJ1bGtfaW5fbGVuKTsKKyAg
ICAgICAgfQorICAgICAgICBicmVhazsKKworICAgIGNhc2UgVVNCX0NEX1NUQVRFX0RBVEFJTjog
LyogQnVsayBEYXRhLUlOICovCisgICAgICAgIGlmIChjZF9zY3NpX2dldF9yZXFfc3RhdGUoc2Nz
aV9yZXEpID09IFNDU0lfUkVRX0NPTVBMRVRFKSB7CisgICAgICAgICAgICB1c2JfY2Rfc2VuZF9k
YXRhX2luKGNkLCBtYXhfbGVuKTsKKyAgICAgICAgfSBlbHNlIHsKKyAgICAgICAgICAgIHVzYl9y
ZXEtPmJ1bGtfaW5fbGVuICs9IG1heF9sZW47CisgICAgICAgICAgICBTUElDRV9ERUJVRygibXNk
X3JlYWQgREFUQUlOLCByZXEgaW5jb21wbGV0ZSwgYWRkZWQgbGVuICV1IHNhdmVkIGxlbiAldSIs
CisgICAgICAgICAgICAgICAgICAgICAgICBtYXhfbGVuLCB1c2JfcmVxLT5idWxrX2luX2xlbik7
CisgICAgICAgIH0KKyAgICAgICAgYnJlYWs7CisKKyAgICBjYXNlIFVTQl9DRF9TVEFURV9aRVJP
X0RBVEFJTjoKKyAgICAgICAgY2RfdXNiX2J1bGtfbXNkX3JlYWRfY29tcGxldGUoY2QtPnVzYl91
c2VyX2RhdGEsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5VTEwsIDAs
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEJVTEtfU1RBVFVTX0dPT0Qp
OworICAgICAgICBjZF91c2JfYnVsa19tc2Rfc2V0X3N0YXRlKGNkLCBVU0JfQ0RfU1RBVEVfQ1NX
KTsgLyogU3RhdHVzIG5leHQgKi8KKyAgICAgICAgYnJlYWs7CisKKyAgICBkZWZhdWx0OgorICAg
ICAgICBTUElDRV9FUlJPUigiVW5leHBlY3RlZCByZWFkIHN0YXRlOiAlcywgbGVuICV1IiwKKyAg
ICAgICAgICAgICAgICAgICAgdXNiX2NkX3N0YXRlX3N0cihjZC0+c3RhdGUpLCBtYXhfbGVuKTsK
KyAgICAgICAgZ290byBmYWlsOworICAgIH0KKyAgICByZXR1cm4gMDsKKworZmFpbDoKKyAgICBy
ZXR1cm4gLTE7Cit9CisKK3ZvaWQgY2Rfc2NzaV9kZXZfcmVxdWVzdF9jb21wbGV0ZSh2b2lkICp0
YXJnZXRfdXNlcl9kYXRhLCBDZFNjc2lSZXF1ZXN0ICpzY3NpX3JlcSkKK3sKKyAgICBVc2JDZEJ1
bGtNc2REZXZpY2UgKmNkID0gKFVzYkNkQnVsa01zZERldmljZSAqKXRhcmdldF91c2VyX2RhdGE7
CisgICAgVXNiQ2RCdWxrTXNkUmVxdWVzdCAqdXNiX3JlcSA9ICZjZC0+dXNiX3JlcTsKKworICAg
IGdfYXNzZXJ0KHNjc2lfcmVxID09ICZ1c2JfcmVxLT5zY3NpX3JlcSk7CisKKyAgICBpZiAoc2Nz
aV9yZXEtPnJlcV9zdGF0ZSA9PSBTQ1NJX1JFUV9DT01QTEVURSkgeworCisgICAgICAgIHVzYl9y
ZXEtPnNjc2lfaW5fbGVuID0gKHNjc2lfcmVxLT5pbl9sZW4gPD0gdXNiX3JlcS0+dXNiX3JlcV9s
ZW4pID8KKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NzaV9yZXEtPmluX2xlbiA6
IHVzYl9yZXEtPnVzYl9yZXFfbGVuOworCisgICAgICAgIC8qIHByZXBhcmUgQ1NXICovCisgICAg
ICAgIGlmICh1c2JfcmVxLT51c2JfcmVxX2xlbiA+IHVzYl9yZXEtPnNjc2lfaW5fbGVuKSB7Cisg
ICAgICAgICAgICB1c2JfcmVxLT5jc3cucmVzaWR1ZSA9IGh0b2xlMzIodXNiX3JlcS0+dXNiX3Jl
cV9sZW4gLSB1c2JfcmVxLT5zY3NpX2luX2xlbik7CisgICAgICAgIH0KKyAgICAgICAgaWYgKHNj
c2lfcmVxLT5zdGF0dXMgIT0gR09PRCkgeworICAgICAgICAgICAgdXNiX3JlcS0+Y3N3LnN0YXR1
cyA9ICh1aW50OF90KVVTQl9NU0RfU1RBVFVTX0ZBSUxFRDsKKyAgICAgICAgfQorCisgICAgICAg
IGlmICh1c2JfcmVxLT5idWxrX2luX2xlbikgeworICAgICAgICAgICAgLyogYnVsay1pbiByZXF1
ZXN0IGFycml2ZWQgd2hpbGUgc2NzaSB3YXMgc3RpbGwgcnVubmluZyAqLworICAgICAgICAgICAg
aWYgKGNkLT5zdGF0ZSA9PSBVU0JfQ0RfU1RBVEVfREFUQUlOKSB7CisgICAgICAgICAgICAgICAg
dXNiX2NkX3NlbmRfZGF0YV9pbihjZCwgdXNiX3JlcS0+YnVsa19pbl9sZW4pOworICAgICAgICAg
ICAgfSBlbHNlIGlmIChjZC0+c3RhdGUgPT0gVVNCX0NEX1NUQVRFX0NTVykgeworICAgICAgICAg
ICAgICAgIHVzYl9jZF9zZW5kX3N0YXR1cyhjZCk7CisgICAgICAgICAgICB9CisgICAgICAgICAg
ICB1c2JfcmVxLT5idWxrX2luX2xlbiA9IDA7CisgICAgICAgIH0KKyAgICB9IGVsc2UgaWYgKHNj
c2lfcmVxLT5yZXFfc3RhdGUgPT0gU0NTSV9SRVFfQ0FOQ0VMRUQpIHsKKyAgICAgICAgdXNiX2Nk
X3NlbmRfY2FuY2VsZWQoY2QpOworICAgIH0gZWxzZSB7CisgICAgICAgIGdfYXNzZXJ0KHNjc2lf
cmVxLT5yZXFfc3RhdGUgPT0gU0NTSV9SRVFfRElTUE9TRUQpOworICAgICAgICBTUElDRV9ERUJV
RygiRGlzcG9zZWQgY21kIHRhZzoweCV4LCBsZW46JSIgR19HVUlOVDY0X0ZPUk1BVCwKKyAgICAg
ICAgICAgICAgICBsZTMydG9oKHVzYl9yZXEtPmNzdy50YWcpLCBzaXplb2YodXNiX3JlcS0+Y3N3
KSk7CisgICAgICAgIHVzYl9jZF9jbWRfZG9uZShjZCk7CisgICAgfQorfQorCitpbnQgY2RfdXNi
X2J1bGtfbXNkX2NhbmNlbF9yZWFkKFVzYkNkQnVsa01zZERldmljZSAqY2QpCit7CisgICAgVXNi
Q2RCdWxrTXNkUmVxdWVzdCAqdXNiX3JlcSA9ICZjZC0+dXNiX3JlcTsKKyAgICBDZFNjc2lSZXF1
ZXN0ICpzY3NpX3JlcSA9ICZ1c2JfcmVxLT5zY3NpX3JlcTsKKworICAgIGNkX3Njc2lfZGV2X3Jl
cXVlc3RfY2FuY2VsKGNkLT5zY3NpX3RhcmdldCwgc2NzaV9yZXEpOworICAgIHJldHVybiAwOwor
fQorCitpbnQgY2RfdXNiX2J1bGtfbXNkX3dyaXRlKFVzYkNkQnVsa01zZERldmljZSAqY2QsIHVp
bnQ4X3QgKmJ1Zl9vdXQsIHVpbnQzMl90IGJ1Zl9vdXRfbGVuKQoreworICAgIHN3aXRjaCAoY2Qt
PnN0YXRlKSB7CisgICAgY2FzZSBVU0JfQ0RfU1RBVEVfQ0JXOiAvKiBDb21tYW5kIEJsb2NrICov
CisgICAgICAgIHBhcnNlX3VzYl9tc2RfY21kKGNkLCBidWZfb3V0LCBidWZfb3V0X2xlbik7Cisg
ICAgICAgIGlmIChjZC0+c3RhdGUgPT0gVVNCX0NEX1NUQVRFX0RBVEFJTiB8fCBjZC0+c3RhdGUg
PT0gVVNCX0NEX1NUQVRFX0NTVykgeworICAgICAgICAgICAgY2Rfc2NzaV9kZXZfcmVxdWVzdF9z
dWJtaXQoY2QtPnNjc2lfdGFyZ2V0LCAmY2QtPnVzYl9yZXEuc2NzaV9yZXEpOworICAgICAgICB9
CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgVVNCX0NEX1NUQVRFX0RBVEFPVVQ6IC8qIERhdGEt
T3V0IGZvciBhIFdyaXRlIGNtZCAqLworICAgICAgICBjZC0+dXNiX3JlcS5zY3NpX3JlcS5idWYg
PSBidWZfb3V0OworICAgICAgICBjZC0+dXNiX3JlcS5zY3NpX3JlcS5idWZfbGVuID0gYnVmX291
dF9sZW47CisgICAgICAgIGNkX3Njc2lfZGV2X3JlcXVlc3Rfc3VibWl0KGNkLT5zY3NpX3Rhcmdl
dCwgJmNkLT51c2JfcmVxLnNjc2lfcmVxKTsKKyAgICAgICAgY2RfdXNiX2J1bGtfbXNkX3NldF9z
dGF0ZShjZCwgVVNCX0NEX1NUQVRFX0NTVyk7IC8qIFN0YXR1cyBuZXh0ICovCisgICAgICAgIGJy
ZWFrOworICAgIGRlZmF1bHQ6CisgICAgICAgIFNQSUNFX0RFQlVHKCJVbmV4cGVjdGVkIHdyaXRl
IHN0YXRlOiAlcywgbGVuICV1IiwKKyAgICAgICAgICAgICAgICAgICAgdXNiX2NkX3N0YXRlX3N0
cihjZC0+c3RhdGUpLCBidWZfb3V0X2xlbik7CisgICAgICAgIGdvdG8gZmFpbDsKKyAgICB9Cisg
ICAgcmV0dXJuIDA7CisKK2ZhaWw6CisgICAgcmV0dXJuIC0xOworfQorCit2b2lkIGNkX3Njc2lf
ZGV2X3Jlc2V0X2NvbXBsZXRlKHZvaWQgKnRhcmdldF91c2VyX2RhdGEsIHVpbnQzMl90IGx1bikK
K3sKKyAgICBVc2JDZEJ1bGtNc2REZXZpY2UgKmNkID0gKFVzYkNkQnVsa01zZERldmljZSAqKXRh
cmdldF91c2VyX2RhdGE7CisKKyAgICBpZiAoY2QtPnN0YXRlID09IFVTQl9DRF9TVEFURV9ERVZJ
Q0VfUkVTRVQpIHsKKyAgICAgICAgY2RfdXNiX2J1bGtfbXNkX3NldF9zdGF0ZShjZCwgVVNCX0NE
X1NUQVRFX0NCVyk7CisgICAgICAgIGNkX3VzYl9idWxrX21zZF9yZXNldF9jb21wbGV0ZShjZC0+
dXNiX3VzZXJfZGF0YSwgMCk7CisgICAgfQorfQorCit2b2lkIGNkX3Njc2lfdGFyZ2V0X3Jlc2V0
X2NvbXBsZXRlKHZvaWQgKnRhcmdldF91c2VyX2RhdGEpCit7CisgICAgVXNiQ2RCdWxrTXNkRGV2
aWNlICpjZCA9IChVc2JDZEJ1bGtNc2REZXZpY2UgKil0YXJnZXRfdXNlcl9kYXRhOworICAgIGNk
X3VzYl9idWxrX21zZF9zZXRfc3RhdGUoY2QsIFVTQl9DRF9TVEFURV9JTklUKTsKK30KKwordm9p
ZCBjZF9zY3NpX2Rldl9jaGFuZ2VkKHZvaWQgKnRhcmdldF91c2VyX2RhdGEsIHVpbnQzMl90IGx1
bikKK3sKKyAgICBVc2JDZEJ1bGtNc2REZXZpY2UgKmNkID0gKFVzYkNkQnVsa01zZERldmljZSAq
KXRhcmdldF91c2VyX2RhdGE7CisgICAgU1BJQ0VfREVCVUcoIkRldmljZSBjaGFuZ2VkLCBzdGF0
ZTogJXMgbHVuOiAldSIsCisgICAgICAgICAgICAgICAgdXNiX2NkX3N0YXRlX3N0cihjZC0+c3Rh
dGUpLCBsdW4pOworICAgIGNkX3VzYl9idWxrX21zZF9sdW5fY2hhbmdlZChjZC0+dXNiX3VzZXJf
ZGF0YSwgbHVuKTsKK30KKworI2VuZGlmIC8qIFVTRV9VU0JSRURJUiAqLwpkaWZmIC0tZ2l0IGEv
c3JjL2NkLXVzYi1idWxrLW1zZC5oIGIvc3JjL2NkLXVzYi1idWxrLW1zZC5oCm5ldyBmaWxlIG1v
ZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwLi5jMTY1YzE4NwotLS0gL2Rldi9udWxsCisrKyBiL3Ny
Yy9jZC11c2ItYnVsay1tc2QuaApAQCAtMCwwICsxLDEzMSBAQAorLyogLSotIE1vZGU6IEM7IGMt
YmFzaWMtb2Zmc2V0OiA0OyBpbmRlbnQtdGFicy1tb2RlOiBuaWwgLSotICovCisvKgorICAgIENv
cHlyaWdodCAoQykgMjAxOCBSZWQgSGF0LCBJbmMuCisKKyAgICBSZWQgSGF0IEF1dGhvcnM6Cisg
ICAgQWxleGFuZGVyIE5lemhpbnNreTxhbmV6aGluc0ByZWRoYXQuY29tPgorCisgICAgVGhpcyBs
aWJyYXJ5IGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vcgor
ICAgIG1vZGlmeSBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQ
dWJsaWMKKyAgICBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3Vu
ZGF0aW9uOyBlaXRoZXIKKyAgICB2ZXJzaW9uIDIuMSBvZiB0aGUgTGljZW5zZSwgb3IgKGF0IHlv
dXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4KKworICAgIFRoaXMgbGlicmFyeSBpcyBkaXN0
cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAorICAgIGJ1dCBXSVRI
T1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCisg
ICAgTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAg
U2VlIHRoZSBHTlUKKyAgICBMZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBk
ZXRhaWxzLgorCisgICAgWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05V
IExlc3NlciBHZW5lcmFsIFB1YmxpYworICAgIExpY2Vuc2UgYWxvbmcgd2l0aCB0aGlzIGxpYnJh
cnk7IGlmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4KKyovCisKKyNw
cmFnbWEgb25jZQorCisjaW5jbHVkZSA8Z2lvL2dpby5oPgorCisjaW5jbHVkZSAiY2Qtc2NzaS1k
ZXYtcGFyYW1zLmgiCisKK0dfQkVHSU5fREVDTFMKKwordHlwZWRlZiBlbnVtIENkVXNiQnVsa1N0
YXR1cyB7CisgICAgQlVMS19TVEFUVVNfR09PRCA9IDAsCisgICAgQlVMS19TVEFUVVNfRVJST1Is
CisgICAgQlVMS19TVEFUVVNfQ0FOQ0VMRUQsCisgICAgQlVMS19TVEFUVVNfU1RBTEwsCit9IENk
VXNiQnVsa1N0YXR1czsKKwordHlwZWRlZiBzdHJ1Y3QgVXNiQ2RCdWxrTXNkRGV2aWNlIFVzYkNk
QnVsa01zZERldmljZTsKKworLyogVVNCIGJhY2tlbmQgY2FsbGJhY2tzICovCisKKy8qIGNhbGxl
ZCBvbiBjb21wbGV0ZWQgcmVhZCBkYXRhIGJ1bGsgdHJhbnNmZXIKKyAqIHVzZXJfZGF0YSAtIHVz
ZXJfZGF0YSBpbiB1bml0IHBhcmFtZXRlcnMgc3RydWN0dXJlCisgKiBzdGF0dXMgLSBidWxrIHN0
YXR1cyBjb2RlCisgKi8KK3ZvaWQgY2RfdXNiX2J1bGtfbXNkX3JlYWRfY29tcGxldGUodm9pZCAq
dXNlcl9kYXRhLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50OF90ICpk
YXRhLCB1aW50MzJfdCBsZW5ndGgsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IENkVXNiQnVsa1N0YXR1cyBzdGF0dXMpOworCisvKiBjYWxsZWQgd2hlbiBzdGF0ZSBvZiBkZXZp
Y2UncyB1bml0IGNoYW5nZWQgdG8gc2lnbmFsIEdVSSBjb21wb25lbnQKKyAqICB1c2VyX2RhdGEg
LSB1c2VyX2RhdGEgaW4gdW5pdCBwYXJhbWV0ZXJzIHN0cnVjdHVyZQorICovCit2b2lkIGNkX3Vz
Yl9idWxrX21zZF9sdW5fY2hhbmdlZCh2b2lkICp1c2VyX2RhdGEsIHVpbnQzMl90IGx1bik7CisK
Ky8qIGNhbGxlZCBvbiBjb21wbGV0ZWQgZGV2aWNlIHJlc2V0CisgKiB1c2VyX2RhdGEgLSB1c2Vy
X2RhdGEgaW4gdW5pdCBwYXJhbWV0ZXJzIHN0cnVjdHVyZQorICogc3RhdHVzIC0gZXJyb3IgY29k
ZQorICovCit2b2lkIGNkX3VzYl9idWxrX21zZF9yZXNldF9jb21wbGV0ZSh2b2lkICp1c2VyX2Rh
dGEsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgc3RhdHVzKTsKKwor
LyogTVNEIGJhY2tlbmQgYXBpICovCisKKy8qIGFsbG9jYXRlIG5ldyBkZXZpY2UgZGVzY3JpcHRv
ciAqLworVXNiQ2RCdWxrTXNkRGV2aWNlICpjZF91c2JfYnVsa19tc2RfYWxsb2Modm9pZCAqdXNl
cl9kYXRhLCB1aW50MzJfdCBtYXhfbHVuKTsKKworLyogZnJlZSBkZXZpY2UgZGVzY3JpcHRvciAq
Lwordm9pZCBjZF91c2JfYnVsa19tc2RfZnJlZShVc2JDZEJ1bGtNc2REZXZpY2UgKmRldmljZSk7
CisKKy8qIGNvbmZpZ3VyZSBhIG5ldyBMb2dpY2FsIFVuaXQgdG8gYmUgcmVwcmVzZW4gdGVkIGJ5
IHRoZSBkZXZpY2UKKyAqICByZXR1cm5zOiBlcnJvciBjb2RlCisgKi8KK2ludCBjZF91c2JfYnVs
a19tc2RfcmVhbGl6ZShVc2JDZEJ1bGtNc2REZXZpY2UgKmRldmljZSwgdWludDMyX3QgbHVuLAor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IENkU2NzaURldmljZVBhcmFtZXRlcnMg
KmRldl9wYXJhbXMpOworCisvKiBsb2NrIHRoZSBkZXZpY2UsIHByZXZlbnQgdW5sb2FkaW5nCisg
KiByZXR1cm5zOiBlcnJvciBjb2RlCisgKi8KK2ludCBjZF91c2JfYnVsa19tc2RfbG9jayhVc2JD
ZEJ1bGtNc2REZXZpY2UgKmRldmljZSwgdWludDMyX3QgbHVuLCBnYm9vbGVhbiBsb2NrKTsKKwor
LyogbG9hZCBuZXcgbWVkaWEsIGlmIGFscmVhZHkgbG9hZGVkLCBzaW11bGF0ZSBtZWRpYSBjaGFu
Z2UKKyAqIHJldHVybnM6IGVycm9yIGNvZGUKKyAqLworaW50IGNkX3VzYl9idWxrX21zZF9sb2Fk
KFVzYkNkQnVsa01zZERldmljZSAqZGV2aWNlLCB1aW50MzJfdCBsdW4sCisgICAgICAgICAgICAg
ICAgICAgICAgICAgY29uc3QgQ2RTY3NpTWVkaWFQYXJhbWV0ZXJzICptZWRpYV9wYXJhbXMpOwor
CisvKiBxdWVyeSB1bml0IHBhcmFtZXRlcnMgYW5kIHN0YXR1cworICogcmV0dXJuczogZXJyb3Ig
Y29kZQorICovCitpbnQgY2RfdXNiX2J1bGtfbXNkX2dldF9pbmZvKFVzYkNkQnVsa01zZERldmlj
ZSAqZGV2aWNlLCB1aW50MzJfdCBsdW4sCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENk
U2NzaURldmljZUluZm8gKmx1bl9pbmZvKTsKKworLyogdW5sb2FkIHRoZSBtZWRpYQorICogcmV0
dXJuczogZXJyb3IgY29kZQorICovCitpbnQgY2RfdXNiX2J1bGtfbXNkX3VubG9hZChVc2JDZEJ1
bGtNc2REZXZpY2UgKmRldmljZSwgdWludDMyX3QgbHVuKTsKKworLyogZGV0YWNoIGEgTG9naWNh
bCBVbml0CisgKiByZXR1cm5zOiBlcnJvciBjb2RlCisgKi8KK2ludCBjZF91c2JfYnVsa19tc2Rf
dW5yZWFsaXplKFVzYkNkQnVsa01zZERldmljZSAqZGV2aWNlLCB1aW50MzJfdCBsdW4pOworCisv
KiByZXNldCB0aGUgZGV2aWNlIGluc3RhbmNlOyBjYW5jZWwgYWxsIElPIG9wcywgcmVzZXQgc3Rh
dGUKKyAqIHJldHVybnM6IGVycm9yIGNvZGUKKyAqLworaW50IGNkX3VzYl9idWxrX21zZF9yZXNl
dChVc2JDZEJ1bGtNc2REZXZpY2UgKmRldmljZSk7CisKKworLyogcGVyZm9ybSBhIHdyaXRlIGRh
dGEgYnVsayB0cmFuc2ZlcgorICogZGF0YV9sZW4gLSBsZW5ndGggb2YgYXZhaWxhYmxlIGRhdGEg
dG8gd3JpdGUKKyAqIHJldHVybnM6IGVycm9yIGNvZGUKKyAqLworaW50IGNkX3VzYl9idWxrX21z
ZF93cml0ZShVc2JDZEJ1bGtNc2REZXZpY2UqZGV2aWNlLCB1aW50OF90ICpidWYsIHVpbnQzMl90
IGRhdGFfbGVuKTsKKworCisvKiBwZXJmb3JtIGEgcmVhZCBkYXRhIGJ1bGsgdHJhbnNmZXIKKyAq
IG1heF9sZW4gLSBsZW5ndGggb2YgYXZhaWxhYmxlIGJ1ZmZlciB0byBmaWxsCisgKiBJZiBkYXRh
IGF2YWlsYWJsZSBpbW1lZGlhdGVseSwgc2hvdWxkIGNhbGwgY2RfdXNiX2J1bGtfbXNkX3JlYWRf
Y29tcGxldGUoKQorICogICBhbmQgcmV0dXJuIHN1Y2Nlc3MKKyAqIElmIGZhdGFsIGVycm9yIGRl
dGVjdGVkIGltbWVkaWF0ZWx5LCBzaG91bGQgY2FsbCBjZF91c2JfYnVsa19tc2RfcmVhZF9jb21w
bGV0ZSgpCisgKiAgIHdpdGggZXJyb3IgY29kZSBhbmQgcmV0dXJuIHN1Y2Nlc3MKKyAqCisgKiBy
ZXR1cm5zOiAwIC0gc3VjY2VzcywgLTEgLSBlcnJvcgorICovCitpbnQgY2RfdXNiX2J1bGtfbXNk
X3JlYWQoVXNiQ2RCdWxrTXNkRGV2aWNlICpkZXZpY2UsIHVpbnQzMl90IG1heF9sZW4pOworCisv
KiBjYW5jZWxzIHBlbmRpbmcgcmVhZCBkYXRhIGJ1bGsgdHJhbnNmZXIKKyAqIHJldHVybnM6IGVy
cm9yIGNvZGUKKyAqLworaW50IGNkX3VzYl9idWxrX21zZF9jYW5jZWxfcmVhZChVc2JDZEJ1bGtN
c2REZXZpY2UgKmRldmljZSk7CisKK0dfRU5EX0RFQ0xTCmRpZmYgLS1naXQgYS9zcmMvc2NzaS1j
b25zdGFudHMuaCBiL3NyYy9zY3NpLWNvbnN0YW50cy5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0Cmlu
ZGV4IDAwMDAwMDAwLi5hNmQzNGE2NQotLS0gL2Rldi9udWxsCisrKyBiL3NyYy9zY3NpLWNvbnN0
YW50cy5oCkBAIC0wLDAgKzEsMzIxIEBACisvKiAtKi0gTW9kZTogQzsgYy1iYXNpYy1vZmZzZXQ6
IDQ7IGluZGVudC10YWJzLW1vZGU6IG5pbCAtKi0gKi8KKy8qCisgICBDb3B5cmlnaHQgKEMpIDIw
MTggUmVkIEhhdCwgSW5jLgorICAgQmFzZWQgb24gdGhlIEdMaWIgaGVhZGVyCisKKyAgIFRoaXMg
bGlicmFyeSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IK
KyAgIG1vZGlmeSBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQ
dWJsaWMKKyAgIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5k
YXRpb247IGVpdGhlcgorICAgdmVyc2lvbiAyLjEgb2YgdGhlIExpY2Vuc2UsIG9yIChhdCB5b3Vy
IG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCisKKyAgIFRoaXMgbGlicmFyeSBpcyBkaXN0cmli
dXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAorICAgYnV0IFdJVEhPVVQg
QU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKKyAgIE1F
UkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0
aGUgR05VCisgICBMZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxz
LgorCisgICBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgTGVzc2Vy
IEdlbmVyYWwgUHVibGljCisgICBMaWNlbnNlIGFsb25nIHdpdGggdGhpcyBsaWJyYXJ5OyBpZiBu
b3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCisqLworCisjcHJhZ21hIG9u
Y2UKKworLyoKKyAqICAgICAgU0NTSSBvcGNvZGVzCisgKi8KKworI2RlZmluZSBURVNUX1VOSVRf
UkVBRFkgICAgICAgMHgwMAorI2RlZmluZSBSRVdJTkQgICAgICAgICAgICAgICAgMHgwMQorI2Rl
ZmluZSBSRVFVRVNUX1NFTlNFICAgICAgICAgMHgwMworI2RlZmluZSBGT1JNQVRfVU5JVCAgICAg
ICAgICAgMHgwNAorI2RlZmluZSBSRUFEX0JMT0NLX0xJTUlUUyAgICAgMHgwNQorI2RlZmluZSBJ
TklUSUFMSVpFX0VMRU1FTlRfU1RBVFVTIDB4MDcKKyNkZWZpbmUgUkVBU1NJR05fQkxPQ0tTXyAg
ICAgIDB4MDcKKyNkZWZpbmUgUkVBRF82ICAgICAgICAgICAgICAgIDB4MDgKKyNkZWZpbmUgV1JJ
VEVfNiAgICAgICAgICAgICAgIDB4MGEKKyNkZWZpbmUgU0VUX0NBUEFDSVRZICAgICAgICAgIDB4
MGIKKyNkZWZpbmUgUkVBRF9SRVZFUlNFICAgICAgICAgIDB4MGYKKyNkZWZpbmUgV1JJVEVfRklM
RU1BUktTICAgICAgIDB4MTAKKyNkZWZpbmUgU1BBQ0UgICAgICAgICAgICAgICAgIDB4MTEKKyNk
ZWZpbmUgSU5RVUlSWSAgICAgICAgICAgICAgIDB4MTIKKyNkZWZpbmUgUkVDT1ZFUl9CVUZGRVJF
RF9EQVRBIDB4MTQKKyNkZWZpbmUgTU9ERV9TRUxFQ1QgICAgICAgICAgIDB4MTUKKyNkZWZpbmUg
UkVTRVJWRSAgICAgICAgICAgICAgIDB4MTYKKyNkZWZpbmUgUkVMRUFTRSAgICAgICAgICAgICAg
IDB4MTcKKyNkZWZpbmUgQ09QWSAgICAgICAgICAgICAgICAgIDB4MTgKKyNkZWZpbmUgRVJBU0Ug
ICAgICAgICAgICAgICAgIDB4MTkKKyNkZWZpbmUgTU9ERV9TRU5TRSAgICAgICAgICAgIDB4MWEK
KyNkZWZpbmUgTE9BRF9VTkxPQUQgICAgICAgICAgIDB4MWIKKyNkZWZpbmUgU0NBTiAgICAgICAg
ICAgICAgICAgIDB4MWIKKyNkZWZpbmUgU1RBUlRfU1RPUCAgICAgICAgICAgIDB4MWIKKyNkZWZp
bmUgUkVDRUlWRV9ESUFHTk9TVElDICAgIDB4MWMKKyNkZWZpbmUgU0VORF9ESUFHTk9TVElDICAg
ICAgIDB4MWQKKyNkZWZpbmUgQUxMT1dfTUVESVVNX1JFTU9WQUwgIDB4MWUKKyNkZWZpbmUgU0VU
X1dJTkRPVyAgICAgICAgICAgIDB4MjQKKyNkZWZpbmUgUkVBRF9DQVBBQ0lUWV8xMCAgICAgIDB4
MjUKKyNkZWZpbmUgR0VUX1dJTkRPVyAgICAgICAgICAgIDB4MjUKKyNkZWZpbmUgUkVBRF8xMCAg
ICAgICAgICAgICAgIDB4MjgKKyNkZWZpbmUgV1JJVEVfMTAgICAgICAgICAgICAgIDB4MmEKKyNk
ZWZpbmUgU0VORCAgICAgICAgICAgICAgICAgIDB4MmEKKyNkZWZpbmUgU0VFS18xMCAgICAgICAg
ICAgICAgIDB4MmIKKyNkZWZpbmUgTE9DQVRFXzEwICAgICAgICAgICAgIDB4MmIKKyNkZWZpbmUg
UE9TSVRJT05fVE9fRUxFTUVOVCAgIDB4MmIKKyNkZWZpbmUgV1JJVEVfVkVSSUZZXzEwICAgICAg
IDB4MmUKKyNkZWZpbmUgVkVSSUZZXzEwICAgICAgICAgICAgIDB4MmYKKyNkZWZpbmUgU0VBUkNI
X0hJR0ggICAgICAgICAgIDB4MzAKKyNkZWZpbmUgU0VBUkNIX0VRVUFMICAgICAgICAgIDB4MzEK
KyNkZWZpbmUgT0JKRUNUX1BPU0lUSU9OICAgICAgIDB4MzEKKyNkZWZpbmUgU0VBUkNIX0xPVyAg
ICAgICAgICAgIDB4MzIKKyNkZWZpbmUgU0VUX0xJTUlUUyAgICAgICAgICAgIDB4MzMKKyNkZWZp
bmUgUFJFX0ZFVENIICAgICAgICAgICAgIDB4MzQKKyNkZWZpbmUgUkVBRF9QT1NJVElPTiAgICAg
ICAgIDB4MzQKKyNkZWZpbmUgR0VUX0RBVEFfQlVGRkVSX1NUQVRVUyAweDM0CisjZGVmaW5lIFNZ
TkNIUk9OSVpFX0NBQ0hFICAgICAweDM1CisjZGVmaW5lIExPQ0tfVU5MT0NLX0NBQ0hFICAgICAw
eDM2CisjZGVmaW5lIElOSVRJQUxJWkVfRUxFTUVOVF9TVEFUVVNfV0lUSF9SQU5HRSAweDM3Cisj
ZGVmaW5lIFJFQURfREVGRUNUX0RBVEEgICAgICAweDM3CisjZGVmaW5lIE1FRElVTV9TQ0FOICAg
ICAgICAgICAweDM4CisjZGVmaW5lIENPTVBBUkUgICAgICAgICAgICAgICAweDM5CisjZGVmaW5l
IENPUFlfVkVSSUZZICAgICAgICAgICAweDNhCisjZGVmaW5lIFdSSVRFX0JVRkZFUiAgICAgICAg
ICAweDNiCisjZGVmaW5lIFJFQURfQlVGRkVSICAgICAgICAgICAweDNjCisjZGVmaW5lIFVQREFU
RV9CTE9DSyAgICAgICAgICAweDNkCisjZGVmaW5lIFJFQURfTE9OR18xMCAgICAgICAgICAweDNl
CisjZGVmaW5lIFdSSVRFX0xPTkdfMTAgICAgICAgICAweDNmCisjZGVmaW5lIENIQU5HRV9ERUZJ
TklUSU9OICAgICAweDQwCisjZGVmaW5lIFdSSVRFX1NBTUVfMTAgICAgICAgICAweDQxCisjZGVm
aW5lIFVOTUFQICAgICAgICAgICAgICAgICAweDQyCisjZGVmaW5lIFJFQURfVE9DICAgICAgICAg
ICAgICAweDQzCisjZGVmaW5lIFJFUE9SVF9ERU5TSVRZX1NVUFBPUlQgMHg0NAorI2RlZmluZSBH
RVRfQ09ORklHVVJBVElPTiAgICAgMHg0NgorI2RlZmluZSBTQU5JVElaRSAgICAgICAgICAgICAg
MHg0OAorI2RlZmluZSBHRVRfRVZFTlRfU1RBVFVTX05PVElGSUNBVElPTiAweDRhCisjZGVmaW5l
IExPR19TRUxFQ1QgICAgICAgICAgICAweDRjCisjZGVmaW5lIExPR19TRU5TRSAgICAgICAgICAg
ICAweDRkCisjZGVmaW5lIFJFQURfRElTQ19JTkZPUk1BVElPTiAweDUxCisjZGVmaW5lIFJFQURf
VFJBQ0tfSU5GT1JNQVRJT04gMHg1MgorI2RlZmluZSBSRVNFUlZFX1RSQUNLICAgICAgICAgMHg1
MworI2RlZmluZSBNT0RFX1NFTEVDVF8xMCAgICAgICAgMHg1NQorI2RlZmluZSBSRVNFUlZFXzEw
ICAgICAgICAgICAgMHg1NgorI2RlZmluZSBSRUxFQVNFXzEwICAgICAgICAgICAgMHg1NworI2Rl
ZmluZSBNT0RFX1NFTlNFXzEwICAgICAgICAgMHg1YQorI2RlZmluZSBTRU5EX0NVRV9TSEVFVCAg
ICAgICAgMHg1ZAorI2RlZmluZSBQRVJTSVNURU5UX1JFU0VSVkVfSU4gMHg1ZQorI2RlZmluZSBQ
RVJTSVNURU5UX1JFU0VSVkVfT1VUIDB4NWYKKyNkZWZpbmUgVkFSTEVOR1RIX0NEQiAgICAgICAg
IDB4N2YKKyNkZWZpbmUgV1JJVEVfRklMRU1BUktTXzE2ICAgIDB4ODAKKyNkZWZpbmUgUkVBRF9S
RVZFUlNFXzE2ICAgICAgIDB4ODEKKyNkZWZpbmUgQUxMT1dfT1ZFUldSSVRFICAgICAgIDB4ODIK
KyNkZWZpbmUgRVhURU5ERURfQ09QWSAgICAgICAgIDB4ODMKKyNkZWZpbmUgQVRBX1BBU1NUSFJP
VUdIXzE2ICAgIDB4ODUKKyNkZWZpbmUgQUNDRVNTX0NPTlRST0xfSU4gICAgIDB4ODYKKyNkZWZp
bmUgQUNDRVNTX0NPTlRST0xfT1VUICAgIDB4ODcKKyNkZWZpbmUgUkVBRF8xNiAgICAgICAgICAg
ICAgIDB4ODgKKyNkZWZpbmUgQ09NUEFSRV9BTkRfV1JJVEUgICAgIDB4ODkKKyNkZWZpbmUgV1JJ
VEVfMTYgICAgICAgICAgICAgIDB4OGEKKyNkZWZpbmUgV1JJVEVfVkVSSUZZXzE2ICAgICAgIDB4
OGUKKyNkZWZpbmUgVkVSSUZZXzE2ICAgICAgICAgICAgIDB4OGYKKyNkZWZpbmUgUFJFX0ZFVENI
XzE2ICAgICAgICAgIDB4OTAKKyNkZWZpbmUgU1BBQ0VfMTYgICAgICAgICAgICAgIDB4OTEKKyNk
ZWZpbmUgU1lOQ0hST05JWkVfQ0FDSEVfMTYgIDB4OTEKKyNkZWZpbmUgTE9DQVRFXzE2ICAgICAg
ICAgICAgIDB4OTIKKyNkZWZpbmUgV1JJVEVfU0FNRV8xNiAgICAgICAgIDB4OTMKKyNkZWZpbmUg
RVJBU0VfMTYgICAgICAgICAgICAgIDB4OTMKKyNkZWZpbmUgU0VSVklDRV9BQ1RJT05fSU5fMTYg
IDB4OWUKKyNkZWZpbmUgV1JJVEVfTE9OR18xNiAgICAgICAgIDB4OWYKKyNkZWZpbmUgUkVQT1JU
X0xVTlMgICAgICAgICAgIDB4YTAKKyNkZWZpbmUgQVRBX1BBU1NUSFJPVUdIXzEyICAgIDB4YTEK
KyNkZWZpbmUgTUFJTlRFTkFOQ0VfSU4gICAgICAgIDB4YTMKKyNkZWZpbmUgTUFJTlRFTkFOQ0Vf
T1VUICAgICAgIDB4YTQKKyNkZWZpbmUgTU9WRV9NRURJVU0gICAgICAgICAgIDB4YTUKKyNkZWZp
bmUgRVhDSEFOR0VfTUVESVVNICAgICAgIDB4YTYKKyNkZWZpbmUgU0VUX1JFQURfQUhFQUQgICAg
ICAgIDB4YTcKKyNkZWZpbmUgUkVBRF8xMiAgICAgICAgICAgICAgIDB4YTgKKyNkZWZpbmUgV1JJ
VEVfMTIgICAgICAgICAgICAgIDB4YWEKKyNkZWZpbmUgU0VSVklDRV9BQ1RJT05fSU5fMTIgIDB4
YWIKKyNkZWZpbmUgRVJBU0VfMTIgICAgICAgICAgICAgIDB4YWMKKyNkZWZpbmUgV1JJVEVfVkVS
SUZZXzEyICAgICAgIDB4YWUKKyNkZWZpbmUgVkVSSUZZXzEyICAgICAgICAgICAgIDB4YWYKKyNk
ZWZpbmUgU0VBUkNIX0hJR0hfMTIgICAgICAgIDB4YjAKKyNkZWZpbmUgU0VBUkNIX0VRVUFMXzEy
ICAgICAgIDB4YjEKKyNkZWZpbmUgU0VBUkNIX0xPV18xMiAgICAgICAgIDB4YjIKKyNkZWZpbmUg
UkVBRF9FTEVNRU5UX1NUQVRVUyAgIDB4YjgKKyNkZWZpbmUgU0VORF9WT0xVTUVfVEFHICAgICAg
IDB4YjYKKworLyogTU1DLXNwZWNpZmljIG9wY29kZSBhc3NpZ25tZW50ICovCisjZGVmaW5lIE1N
Q19TRU5EX0VWRU5UICAgICAgICAgIDB4YTIKKyNkZWZpbmUgTU1DX1NFTkRfS0VZICAgICAgICAg
ICAgMHhhMworI2RlZmluZSBNTUNfUkVQT1JUX0tFWSAgICAgICAgICAweGE0CisjZGVmaW5lIE1N
Q19HRVRfUEVSRk9STUFOQ0UgICAgIDB4YWMKKyNkZWZpbmUgTU1DX1JFQURfRFZEX1NUUlVDVFVS
RSAgMHhhZAorI2RlZmluZSBNTUNfUkVBRF9ERUZFQ1RfREFUQV8xMiAweGI3CisjZGVmaW5lIE1N
Q19TRVRfQ0RfU1BFRUQgICAgICAgIDB4YmIKKyNkZWZpbmUgTU1DX01FQ0hBTklTTV9TVEFUVVMg
ICAgMHhiZAorI2RlZmluZSBNTUNfUkVBRF9DRCAgICAgICAgICAgICAweGJlCisjZGVmaW5lIE1N
Q19TRU5EX0RWRF9TVFJVQ1RVUkUgIDB4YmYKKworLyoKKyAqIFNFUlZJQ0UgQUNUSU9OIElOIHN1
YmNvZGVzCisgKi8KKyNkZWZpbmUgU0FJX1JFQURfQ0FQQUNJVFlfMTYgIDB4MTAKKworLyoKKyAq
IFJFQUQgUE9TSVRJT04gc2VydmljZSBhY3Rpb24gY29kZXMKKyAqLworI2RlZmluZSBTSE9SVF9G
T1JNX0JMT0NLX0lEICAweDAwCisjZGVmaW5lIFNIT1JUX0ZPUk1fVkVORE9SX1NQRUNJRklDIDB4
MDEKKyNkZWZpbmUgTE9OR19GT1JNICAgICAgICAgICAgMHgwNgorI2RlZmluZSBFWFRFTkRFRF9G
T1JNICAgICAgICAweDA4CisKKy8qCisgKiAgU0FNIFN0YXR1cyBjb2RlcworICovCisKKyNkZWZp
bmUgR09PRCAgICAgICAgICAgICAgICAgMHgwMAorI2RlZmluZSBDSEVDS19DT05ESVRJT04gICAg
ICAweDAyCisjZGVmaW5lIENPTkRJVElPTl9HT09EICAgICAgIDB4MDQKKyNkZWZpbmUgQlVTWSAg
ICAgICAgICAgICAgICAgMHgwOAorI2RlZmluZSBJTlRFUk1FRElBVEVfR09PRCAgICAweDEwCisj
ZGVmaW5lIElOVEVSTUVESUFURV9DX0dPT0QgIDB4MTQKKyNkZWZpbmUgUkVTRVJWQVRJT05fQ09O
RkxJQ1QgMHgxOAorI2RlZmluZSBDT01NQU5EX1RFUk1JTkFURUQgICAweDIyCisjZGVmaW5lIFRB
U0tfU0VUX0ZVTEwgICAgICAgIDB4MjgKKyNkZWZpbmUgQUNBX0FDVElWRSAgICAgICAgICAgMHgz
MAorI2RlZmluZSBUQVNLX0FCT1JURUQgICAgICAgICAweDQwCisKKyNkZWZpbmUgU1RBVFVTX01B
U0sgICAgICAgICAgMHgzZQorCisvKgorICogIFNFTlNFIEtFWVMKKyAqLworCisjZGVmaW5lIE5P
X1NFTlNFICAgICAgICAgICAgMHgwMAorI2RlZmluZSBSRUNPVkVSRURfRVJST1IgICAgIDB4MDEK
KyNkZWZpbmUgTk9UX1JFQURZICAgICAgICAgICAweDAyCisjZGVmaW5lIE1FRElVTV9FUlJPUiAg
ICAgICAgMHgwMworI2RlZmluZSBIQVJEV0FSRV9FUlJPUiAgICAgIDB4MDQKKyNkZWZpbmUgSUxM
RUdBTF9SRVFVRVNUICAgICAweDA1CisjZGVmaW5lIFVOSVRfQVRURU5USU9OICAgICAgMHgwNgor
I2RlZmluZSBEQVRBX1BST1RFQ1QgICAgICAgIDB4MDcKKyNkZWZpbmUgQkxBTktfQ0hFQ0sgICAg
ICAgICAweDA4CisjZGVmaW5lIENPUFlfQUJPUlRFRCAgICAgICAgMHgwYQorI2RlZmluZSBBQk9S
VEVEX0NPTU1BTkQgICAgIDB4MGIKKyNkZWZpbmUgVk9MVU1FX09WRVJGTE9XICAgICAweDBkCisj
ZGVmaW5lIE1JU0NPTVBBUkUgICAgICAgICAgMHgwZQorCisKKy8qCisgKiAgREVWSUNFIFRZUEVT
CisgKi8KKworI2RlZmluZSBUWVBFX0RJU0sgICAgICAgICAgIDB4MDAKKyNkZWZpbmUgVFlQRV9U
QVBFICAgICAgICAgICAweDAxCisjZGVmaW5lIFRZUEVfUFJJTlRFUiAgICAgICAgMHgwMgorI2Rl
ZmluZSBUWVBFX1BST0NFU1NPUiAgICAgIDB4MDMgICAgLyogSFAgc2Nhbm5lcnMgdXNlIHRoaXMg
Ki8KKyNkZWZpbmUgVFlQRV9XT1JNICAgICAgICAgICAweDA0ICAgIC8qIFRyZWF0ZWQgYXMgUk9N
IGJ5IG91ciBzeXN0ZW0gKi8KKyNkZWZpbmUgVFlQRV9ST00gICAgICAgICAgICAweDA1CisjZGVm
aW5lIFRZUEVfU0NBTk5FUiAgICAgICAgMHgwNgorI2RlZmluZSBUWVBFX01PRCAgICAgICAgICAg
IDB4MDcgICAgLyogTWFnbmV0by1vcHRpY2FsIGRpc2sgLQorCQkJCSAgICAgKiAtIHRyZWF0ZWQg
YXMgVFlQRV9ESVNLICovCisjZGVmaW5lIFRZUEVfTUVESVVNX0NIQU5HRVIgMHgwOAorI2RlZmlu
ZSBUWVBFX1NUT1JBR0VfQVJSQVkgIDB4MGMgICAgLyogU3RvcmFnZSBhcnJheSBkZXZpY2UgKi8K
KyNkZWZpbmUgVFlQRV9FTkNMT1NVUkUgICAgICAweDBkICAgIC8qIEVuY2xvc3VyZSBTZXJ2aWNl
cyBEZXZpY2UgKi8KKyNkZWZpbmUgVFlQRV9SQkMgICAgICAgICAgICAweDBlICAgIC8qIFNpbXBs
aWZpZWQgRGlyZWN0LUFjY2VzcyBEZXZpY2UgKi8KKyNkZWZpbmUgVFlQRV9PU0QgICAgICAgICAg
ICAweDExICAgIC8qIE9iamVjdC1zdG9yYWdlIERldmljZSAqLworI2RlZmluZSBUWVBFX1dMVU4g
ICAgICAgICAgIDB4MWUgICAgLyogV2VsbCBrbm93biBMVU4gKi8KKyNkZWZpbmUgVFlQRV9OT1Rf
UFJFU0VOVCAgICAweDFmCisjZGVmaW5lIFRZUEVfSU5BQ1RJVkUgICAgICAgMHgyMAorI2RlZmlu
ZSBUWVBFX05PX0xVTiAgICAgICAgIDB4N2YKKworLyogTW9kZSBwYWdlIGNvZGVzIGZvciBtb2Rl
IHNlbnNlL3NldCAqLworI2RlZmluZSBNT0RFX1BBR0VfUl9XX0VSUk9SICAgICAgICAgICAgICAg
ICAgIDB4MDEKKyNkZWZpbmUgTU9ERV9QQUdFX01SVyAgICAgICAgICAgICAgICAgICAgICAgICAw
eDAzCisjZGVmaW5lIE1PREVfUEFHRV9IRF9HRU9NRVRSWSAgICAgICAgICAgICAgICAgMHgwNAor
I2RlZmluZSBNT0RFX1BBR0VfRkxFWElCTEVfRElTS19HRU9NRVRSWSAgICAgIDB4MDUgLyogU0JD
ICovCisjZGVmaW5lIE1PREVfUEFHRV9XUklURV9QQVJBTUVURVIgICAgICAgICAgICAgMHgwNSAv
KiBNTUMgKi8KKyNkZWZpbmUgTU9ERV9QQUdFX0NBQ0hJTkcgICAgICAgICAgICAgICAgICAgICAw
eDA4CisjZGVmaW5lIE1PREVfUEFHRV9DRF9ERVZJQ0UgICAgICAgICAgICAgICAgICAgMHgwZAor
I2RlZmluZSBNT0RFX1BBR0VfQVVESU9fQ1RMICAgICAgICAgICAgICAgICAgIDB4MGUKKyNkZWZp
bmUgTU9ERV9QQUdFX1BPV0VSICAgICAgICAgICAgICAgICAgICAgICAweDFhCisjZGVmaW5lIE1P
REVfUEFHRV9GQVVMVF9GQUlMICAgICAgICAgICAgICAgICAgMHgxYworI2RlZmluZSBNT0RFX1BB
R0VfVE9fUFJPVEVDVCAgICAgICAgICAgICAgICAgIDB4MWQKKyNkZWZpbmUgTU9ERV9QQUdFX0NB
UFNfTUVDSF9TVEFUVVMgICAgICAgICAgICAweDJhCisjZGVmaW5lIE1PREVfUEFHRV9NUldfVkVO
RE9SICAgICAgICAgICAgICAgICAgMHgyQworI2RlZmluZSBNT0RFX1BBR0VfQUxMUyAgICAgICAg
ICAgICAgICAgICAgICAgIDB4M2YKKy8qIE5vdCBpbiBNdC4gRnVqaSwgYnV0IGluIEFUQVBJIDIu
NiAtLSBkZXByZWNhdGVkIG5vdyBpbiBmYXZvcgorICogb2YgTU9ERV9QQUdFX1NFTlNFX1BPV0VS
ICovCisjZGVmaW5lIE1PREVfUEFHRV9DRFJPTSAgICAgICAgICAgICAgICAgICAgICAgMHgwZAor
CisjZGVmaW5lIE1PREVfUEFHRV9DRFJPTSAgICAgICAgICAgICAgICAgICAgICAgMHgwZAorCisv
KiBFdmVudCBub3RpZmljYXRpb24gY2xhc3NlcyBmb3IgR0VUIEVWRU5UIFNUQVRVUyBOT1RJRklD
QVRJT04gKi8KKyNkZWZpbmUgR0VTTl9OT19FVkVOVFMgICAgICAgICAgICAgICAgMAorI2RlZmlu
ZSBHRVNOX09QRVJBVElPTkFMX0NIQU5HRSAgICAgICAxCisjZGVmaW5lIEdFU05fUE9XRVJfTUFO
QUdFTUVOVCAgICAgICAgIDIKKyNkZWZpbmUgR0VTTl9FWFRFUk5BTF9SRVFVRVNUICAgICAgICAg
MworI2RlZmluZSBHRVNOX01FRElBICAgICAgICAgICAgICAgICAgICA0CisjZGVmaW5lIEdFU05f
TVVMVElQTEVfSE9TVFMgICAgICAgICAgIDUKKyNkZWZpbmUgR0VTTl9ERVZJQ0VfQlVTWSAgICAg
ICAgICAgICAgNgorCisvKiBFdmVudCBjb2RlcyBmb3IgTUVESUEgZXZlbnQgc3RhdHVzIG5vdGlm
aWNhdGlvbiAqLworI2RlZmluZSBNRUNfTk9fQ0hBTkdFICAgICAgICAgICAgICAgICAwCisjZGVm
aW5lIE1FQ19FSkVDVF9SRVFVRVNURUQgICAgICAgICAgIDEKKyNkZWZpbmUgTUVDX05FV19NRURJ
QSAgICAgICAgICAgICAgICAgMgorI2RlZmluZSBNRUNfTUVESUFfUkVNT1ZBTCAgICAgICAgICAg
ICAzIC8qIG9ubHkgZm9yIG1lZGlhIGNoYW5nZXJzICovCisjZGVmaW5lIE1FQ19NRURJQV9DSEFO
R0VEICAgICAgICAgICAgIDQgLyogb25seSBmb3IgbWVkaWEgY2hhbmdlcnMgKi8KKyNkZWZpbmUg
TUVDX0JHX0ZPUk1BVF9DT01QTEVURUQgICAgICAgNSAvKiBNUlcgb3IgRFZEK1JXIGIvZyBmb3Jt
YXQgY29tcGxldGVkICovCisjZGVmaW5lIE1FQ19CR19GT1JNQVRfUkVTVEFSVEVEICAgICAgIDYg
LyogTVJXIG9yIERWRCtSVyBiL2cgZm9ybWF0IHJlc3RhcnRlZCAqLworCisjZGVmaW5lIE1TX1RS
QVlfT1BFTiAgICAgICAgICAgICAgICAgIDEKKyNkZWZpbmUgTVNfTUVESUFfUFJFU0VOVCAgICAg
ICAgICAgICAgMgorCisvKgorICogQmFzZWQgb24gdmFsdWVzIGZyb20gPGxpbnV4L2Nkcm9tLmg+
IGJ1dCBleHRlbmRpbmcgQ0RfTUlOUworICogdG8gdGhlIG1heGltdW0gY29tbW9uIHNpemUgYWxs
b3dlZCBieSB0aGUgT3JhbmdlJ3MgQm9vayBBVElQCisgKgorICogOTAgYW5kIDk5IG1pbiBDRHMg
YXJlIGFsc28gYXZhaWxhYmxlIGJ1dCB1c2luZyB0aGVtIGFzIHRoZQorICogdXBwZXIgbGltaXQg
cmVkdWNlcyB0aGUgZWZmZWN0aXZlbmVzcyBvZiB0aGUgaGV1cmlzdGljIHRvCisgKiBkZXRlY3Qg
RFZEcyBidXJuZWQgdG8gbGVzcyB0aGFuIDI1JSBvZiB0aGVpciBtYXhpbXVtIGNhcGFjaXR5Cisg
Ki8KKworLyogU29tZSBnZW5lcmFsbHkgdXNlZnVsIENELVJPTSBpbmZvcm1hdGlvbiAqLworI2Rl
ZmluZSBDRF9NSU5TICAgICAgICAgICAgICAgICAgICAgICA4MCAvKiBtYXguIG1pbnV0ZXMgcGVy
IENEICovCisjZGVmaW5lIENEX1NFQ1MgICAgICAgICAgICAgICAgICAgICAgIDYwIC8qIHNlY29u
ZHMgcGVyIG1pbnV0ZSAqLworI2RlZmluZSBDRF9GUkFNRVMgICAgICAgICAgICAgICAgICAgICA3
NSAvKiBmcmFtZXMgcGVyIHNlY29uZCAqLworI2RlZmluZSBDRF9GUkFNRVNJWkUgICAgICAgICAg
ICAgICAgMjA0OCAvKiBieXRlcyBwZXIgZnJhbWUsICJjb29rZWQiIG1vZGUgKi8KKyNkZWZpbmUg
Q0RfTUFYX0JZVEVTICAgICAgIChDRF9NSU5TICogQ0RfU0VDUyAqIENEX0ZSQU1FUyAqIENEX0ZS
QU1FU0laRSkKKyNkZWZpbmUgQ0RfTUFYX1NFQ1RPUlMgICAgIChDRF9NQVhfQllURVMgLyA1MTIp
CisKKy8qCisgKiBUaGUgTU1DIHZhbHVlcyBhcmUgbm90IElERSBzcGVjaWZpYyBhbmQgbWlnaHQg
bmVlZCB0byBiZSBtb3ZlZAorICogdG8gYSBjb21tb24gaGVhZGVyIGlmIHRoZXkgYXJlIGFsc28g
bmVlZGVkIGZvciB0aGUgU0NTSSBlbXVsYXRpb24KKyAqLworCisvKiBQcm9maWxlIGxpc3QgZnJv
bSBNTUMtNiByZXZpc2lvbiAxIHRhYmxlIDkxICovCisjZGVmaW5lIE1NQ19QUk9GSUxFX05PTkUg
ICAgICAgICAgICAgICAgMHgwMDAwCisjZGVmaW5lIE1NQ19QUk9GSUxFX0NEX1JPTSAgICAgICAg
ICAgICAgMHgwMDA4CisjZGVmaW5lIE1NQ19QUk9GSUxFX0NEX1IgICAgICAgICAgICAgICAgMHgw
MDA5CisjZGVmaW5lIE1NQ19QUk9GSUxFX0NEX1JXICAgICAgICAgICAgICAgMHgwMDBBCisjZGVm
aW5lIE1NQ19QUk9GSUxFX0RWRF9ST00gICAgICAgICAgICAgMHgwMDEwCisjZGVmaW5lIE1NQ19Q
Uk9GSUxFX0RWRF9SX1NSICAgICAgICAgICAgMHgwMDExCisjZGVmaW5lIE1NQ19QUk9GSUxFX0RW
RF9SQU0gICAgICAgICAgICAgMHgwMDEyCisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9SV19STyAg
ICAgICAgICAgMHgwMDEzCisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9SV19TUiAgICAgICAgICAg
MHgwMDE0CisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9SX0RMX1NSICAgICAgICAgMHgwMDE1Cisj
ZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9SX0RMX0pSICAgICAgICAgMHgwMDE2CisjZGVmaW5lIE1N
Q19QUk9GSUxFX0RWRF9SV19ETCAgICAgICAgICAgMHgwMDE3CisjZGVmaW5lIE1NQ19QUk9GSUxF
X0RWRF9ERFIgICAgICAgICAgICAgMHgwMDE4CisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9QTFVT
X1JXICAgICAgICAgMHgwMDFBCisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9QTFVTX1IgICAgICAg
ICAgMHgwMDFCCisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9QTFVTX1JXX0RMICAgICAgMHgwMDJB
CisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9QTFVTX1JfREwgICAgICAgMHgwMDJCCisjZGVmaW5l
IE1NQ19QUk9GSUxFX0JEX1JPTSAgICAgICAgICAgICAgMHgwMDQwCisjZGVmaW5lIE1NQ19QUk9G
SUxFX0JEX1JfU1JNICAgICAgICAgICAgMHgwMDQxCisjZGVmaW5lIE1NQ19QUk9GSUxFX0JEX1Jf
UlJNICAgICAgICAgICAgMHgwMDQyCisjZGVmaW5lIE1NQ19QUk9GSUxFX0JEX1JFICAgICAgICAg
ICAgICAgMHgwMDQzCisjZGVmaW5lIE1NQ19QUk9GSUxFX0hERFZEX1JPTSAgICAgICAgICAgMHgw
MDUwCisjZGVmaW5lIE1NQ19QUk9GSUxFX0hERFZEX1IgICAgICAgICAgICAgMHgwMDUxCisjZGVm
aW5lIE1NQ19QUk9GSUxFX0hERFZEX1JBTSAgICAgICAgICAgMHgwMDUyCisjZGVmaW5lIE1NQ19Q
Uk9GSUxFX0hERFZEX1JXICAgICAgICAgICAgMHgwMDUzCisjZGVmaW5lIE1NQ19QUk9GSUxFX0hE
RFZEX1JfREwgICAgICAgICAgMHgwMDU4CisjZGVmaW5lIE1NQ19QUk9GSUxFX0hERFZEX1JXX0RM
ICAgICAgICAgMHgwMDVBCisjZGVmaW5lIE1NQ19QUk9GSUxFX0lOVkFMSUQgICAgICAgICAgICAg
MHhGRkZGCi0tIAoyLjIwLjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fClNwaWNlLWRldmVsIG1haWxpbmcgbGlzdApTcGljZS1kZXZlbEBsaXN0cy5mcmVl
ZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5m
by9zcGljZS1kZXZlbA==
