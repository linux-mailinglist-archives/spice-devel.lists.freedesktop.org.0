Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 4C2F089A9F
	for <lists+spice-devel@lfdr.de>; Mon, 12 Aug 2019 11:57:49 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id B07CE6E4D4;
	Mon, 12 Aug 2019 09:57:46 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mail-wm1-x344.google.com (mail-wm1-x344.google.com
 [IPv6:2a00:1450:4864:20::344])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 59AA56E4D4
 for <spice-devel@lists.freedesktop.org>; Mon, 12 Aug 2019 09:57:45 +0000 (UTC)
Received: by mail-wm1-x344.google.com with SMTP id s3so11579005wms.2
 for <spice-devel@lists.freedesktop.org>; Mon, 12 Aug 2019 02:57:45 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references;
 bh=Log/kE2PF2KL5vaqeK5vqrsNXdWHOuTs7sNprx2hBvE=;
 b=l24VtQkPWRRKLP+C+uN9lhqdnDTnr4YDLAMJsuwGN0eFcLx4aQMHhTmXyzh7lZn4g7
 PC92PCxR8qghLXkVKHu1c99K4vlsA4eTfRMpoMByP5KKo3FLOTeHTLTTGMuE+vgPOA7J
 MpaDWzkTPCgnivJyaYPIImrhOvoqNibMYZsRIoO8GqJM9OtYGoOR99ouCVrOUNXOwCqu
 opMIsjaY5wYU7dzWcS9w7H+Xz7ZNxx3JDnN72DRcANHuhMoAzq2Ejd+RSsx5Qmg+PwlM
 RB9NkXJF2peb7EUyK10sI3tVvDbELUzW6u2Mgvx+a4fxRp3+02Q8NeJEorYDiGm5ed7c
 lnxg==
X-Gm-Message-State: APjAAAVpkmjsC7IT3cYeDYRQ1GPuW4U2zUXpmn6W673whPOsOHxZiRiX
 shzAf6im/xt28fKNeoXGxqD0scP0b4g=
X-Google-Smtp-Source: APXvYqziLISmZSlo3DXrIVqVyNQzlEdAV4J4UD02cYCXG75w+lfUiPJeFs6E5d0RItOzYxRMJiU6eQ==
X-Received: by 2002:a7b:cc09:: with SMTP id f9mr27668873wmh.68.1565603863661; 
 Mon, 12 Aug 2019 02:57:43 -0700 (PDT)
Received: from f2.redhat.com (bzq-79-182-115-245.red.bezeqint.net.
 [79.182.115.245])
 by smtp.gmail.com with ESMTPSA id g14sm11930659wrb.38.2019.08.12.02.57.42
 (version=TLS1_2 cipher=ECDHE-RSA-CHACHA20-POLY1305 bits=256/256);
 Mon, 12 Aug 2019 02:57:42 -0700 (PDT)
From: Yuri Benditovich <yuri.benditovich@daynix.com>
To: spice-devel@lists.freedesktop.org
Date: Mon, 12 Aug 2019 12:57:21 +0300
Message-Id: <20190812095729.32692-2-yuri.benditovich@daynix.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20190812095729.32692-1-yuri.benditovich@daynix.com>
References: <20190812095729.32692-1-yuri.benditovich@daynix.com>
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=daynix-com.20150623.gappssmtp.com; s=20150623;
 h=from:to:cc:subject:date:message-id:in-reply-to:references;
 bh=Log/kE2PF2KL5vaqeK5vqrsNXdWHOuTs7sNprx2hBvE=;
 b=NoWTkIBxrkKpYhorTCMOlmeN+rlGuQPV3mYzR73SB7SDB8B+jACqjWuCq1uSJraNOg
 7ujDq849hISAb1XIOvt2D6GNGpuJlKNKbzIyGidfAagxVdC9nTmwbK1fASd6CY1BT/E4
 pwiMKij/vectgWdDLmy5gEfTWKe1ZDYZhYT6cjTxSTq2FaANFZaD/ueE4VCDvbgWX4kl
 D0zVQtXwiH8bNscLUWAAi/C0c0Grpw2aRpEQ6+qULAXlOieNvMJzyIbl67ilLwBXY/UO
 kOZ0IsbfjvNssqM2M+5nAIEwgEORkZLWA84236xUKrb//lAvOFfDzuaVQVPXh9WSx4zV
 T6nQ==
Subject: [Spice-devel] [spice-gtk v3 1/9] usb-redir: define interfaces to
 support emulated devices
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: yan@daynix.com
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

U3BpY2VVc2JCYWNrZW5kRGV2aWNlIHN0cnVjdHVyZSBpcyBleHRlbmRlZCB0byBzdXBwb3J0CmFk
ZGl0aW9uYWwga2luZCBvZiBkZXZpY2UgdGhhdCBpcyBlbXVsYXRlZCBieSBTcGljZS1HVEsKYW5k
IG5vdCBwcmVzZW50IGxvY2FsbHkgKGFuZCBkb2VzIG5vdCBoYXZlIGxpYnVzYl9kZXZpY2UpLApz
dWNoIGRldmljZSBoYXMgaW5zdGVhZCBwb2ludGVyIHRvIFNwaWNlVXNiRW11bGF0ZWREZXZpY2UK
YWJzdHJhY3Qgc3RydWN0dXJlLiBTcGVjaWZpYyBpbXBsZW1lbnRhdGlvbiBvZiBzdWNoIGRldmlj
ZQpkZXBlbmRzIG9uIGl0cyBkZXZpY2UgdHlwZS4gSW1wbGVtZW50YXRpb24gbW9kdWxlIHdpbGwg
ZGVmaW5lCmNvbnN0cnVjdG9yIGZvciBzcGVjaWZpYyBkZXZpY2UgdHlwZS4KRGV2aWNlIHN0cnVj
dHVyZSBpcyBhYnN0cmFjdCBidXQgYWx3YXlzIHN0YXJ0cyBmcm9tIHRhYmxlIG9mCnZpcnR1YWwg
ZnVuY3Rpb25zIHJlcXVpcmVkIHRvIHJlZGlyZWN0IHN1Y2ggdmlydHVhbCBkZXZpY2UuCgpTaWdu
ZWQtb2ZmLWJ5OiBZdXJpIEJlbmRpdG92aWNoIDx5dXJpLmJlbmRpdG92aWNoQGRheW5peC5jb20+
Ci0tLQogc3JjL21lc29uLmJ1aWxkICAgICB8ICAgMSArCiBzcmMvdXNiLWJhY2tlbmQuYyAgIHwg
MTAzICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKystCiBzcmMvdXNi
LWJhY2tlbmQuaCAgIHwgICAzICsrCiBzcmMvdXNiLWVtdWxhdGlvbi5oIHwgIDg4ICsrKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysKIDQgZmlsZXMgY2hhbmdlZCwgMTkzIGluc2Vy
dGlvbnMoKyksIDIgZGVsZXRpb25zKC0pCiBjcmVhdGUgbW9kZSAxMDA2NDQgc3JjL3VzYi1lbXVs
YXRpb24uaAoKZGlmZiAtLWdpdCBhL3NyYy9tZXNvbi5idWlsZCBiL3NyYy9tZXNvbi5idWlsZApp
bmRleCBiNGE2ODcwLi5mZTE5YzE2IDEwMDY0NAotLS0gYS9zcmMvbWVzb24uYnVpbGQKKysrIGIv
c3JjL21lc29uLmJ1aWxkCkBAIC0xMjIsNiArMTIyLDcgQEAgc3BpY2VfY2xpZW50X2dsaWJfc291
cmNlcyA9IFsKICAgJ3VzYnV0aWwuYycsCiAgICd1c2J1dGlsLmgnLAogICAndXNiLWJhY2tlbmQu
YycsCisgICd1c2ItZW11bGF0aW9uLmgnLAogICAndXNiLWJhY2tlbmQuaCcsCiAgICd2bWNzdHJl
YW0uYycsCiAgICd2bWNzdHJlYW0uaCcsCmRpZmYgLS1naXQgYS9zcmMvdXNiLWJhY2tlbmQuYyBi
L3NyYy91c2ItYmFja2VuZC5jCmluZGV4IDlhYzg1OTUuLmRlMmI1NWUgMTAwNjQ0Ci0tLSBhL3Ny
Yy91c2ItYmFja2VuZC5jCisrKyBiL3NyYy91c2ItYmFja2VuZC5jCkBAIC0zOSw2ICszOSw3IEBA
CiAjaW5jbHVkZSAidXNicmVkaXJwYXJzZXIuaCIKICNpbmNsdWRlICJzcGljZS11dGlsLmgiCiAj
aW5jbHVkZSAidXNiLWJhY2tlbmQuaCIKKyNpbmNsdWRlICJ1c2ItZW11bGF0aW9uLmgiCiAjaW5j
bHVkZSAiY2hhbm5lbC11c2JyZWRpci1wcml2LmgiCiAjaW5jbHVkZSAic3BpY2UtY2hhbm5lbC1w
cml2LmgiCiAKQEAgLTQ2LDcgKzQ3LDEwIEBACiAKIHN0cnVjdCBfU3BpY2VVc2JCYWNrZW5kRGV2
aWNlCiB7CisgICAgLyogUG9pbnRlciB0byBkZXZpY2UuIEVpdGhlciByZWFsIGRldmljZSAobGli
dXNiX2RldmljZSkKKyAgICAgKiBvciBlbXVsYXRlZCBvbmUgKGVkZXYpICovCiAgICAgbGlidXNi
X2RldmljZSAqbGlidXNiX2RldmljZTsKKyAgICBTcGljZVVzYkVtdWxhdGVkRGV2aWNlICplZGV2
OwogICAgIGdpbnQgcmVmX2NvdW50OwogICAgIFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmF0dGFj
aGVkX3RvOwogICAgIFVzYkRldmljZUluZm9ybWF0aW9uIGRldmljZV9pbmZvOwpAQCAtNjYsNiAr
NzAsMTAgQEAgc3RydWN0IF9TcGljZVVzYkJhY2tlbmQKICAgICBsaWJ1c2JfZGV2aWNlICoqbGli
dXNiX2RldmljZV9saXN0OwogICAgIGdpbnQgcmVkaXJlY3Rpbmc7CiAjZW5kaWYKKworICAgIC8q
IE1hc2sgb2YgYWxsb2NhdGVkIGRldmljZSwgYSBzcGVjaWZpYyBiaXQgc2V0IHRvIDEgdG8gaW5k
aWNhdGUgdGhhdCB0aGUgZGV2aWNlIGF0CisgICAgICogdGhhdCBhZGRyZXNzIGlzIGFsbG9jYXRl
ZCAqLworICAgIHVpbnQzMl90IG93bl9kZXZpY2VzX21hc2s7CiB9OwogCiBzdHJ1Y3QgX1NwaWNl
VXNiQmFja2VuZENoYW5uZWwKQEAgLTQwOCw2ICs0MTYsOCBAQCBTcGljZVVzYkJhY2tlbmQgKnNw
aWNlX3VzYl9iYWNrZW5kX25ldyhHRXJyb3IgKiplcnJvcikKICAgICAgICAgbGlidXNiX3NldF9v
cHRpb24oYmUtPmxpYnVzYl9jb250ZXh0LCBMSUJVU0JfT1BUSU9OX1VTRV9VU0JESyk7CiAjZW5k
aWYKICNlbmRpZgorICAgICAgICAvKiBleGNsdWRlIGFkZHJlc3NlcyAwIChyZXNlcnZlZCkgYW5k
IDEgKHJvb3QgaHViKSAqLworICAgICAgICBiZS0+b3duX2RldmljZXNfbWFzayA9IDM7CiAgICAg
fQogICAgIFNQSUNFX0RFQlVHKCIlcyA8PCIsIF9fRlVOQ1RJT05fXyk7CiAgICAgcmV0dXJuIGJl
OwpAQCAtNTI0LDggKzUzNCwxMyBAQCB2b2lkIHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV91bnJl
ZihTcGljZVVzYkJhY2tlbmREZXZpY2UgKmRldikKIHsKICAgICBMT1VEX0RFQlVHKCIlcyA+PiAl
cCglZCkiLCBfX0ZVTkNUSU9OX18sIGRldiwgZGV2LT5yZWZfY291bnQpOwogICAgIGlmIChnX2F0
b21pY19pbnRfZGVjX2FuZF90ZXN0KCZkZXYtPnJlZl9jb3VudCkpIHsKLSAgICAgICAgbGlidXNi
X3VucmVmX2RldmljZShkZXYtPmxpYnVzYl9kZXZpY2UpOwotICAgICAgICBMT1VEX0RFQlVHKCIl
cyBmcmVlaW5nICVwIChsaWJ1c2IgJXApIiwgX19GVU5DVElPTl9fLCBkZXYsIGRldi0+bGlidXNi
X2RldmljZSk7CisgICAgICAgIGlmIChkZXYtPmxpYnVzYl9kZXZpY2UpIHsKKyAgICAgICAgICAg
IGxpYnVzYl91bnJlZl9kZXZpY2UoZGV2LT5saWJ1c2JfZGV2aWNlKTsKKyAgICAgICAgICAgIExP
VURfREVCVUcoIiVzIGZyZWVpbmcgJXAgKGxpYnVzYiAlcCkiLCBfX0ZVTkNUSU9OX18sIGRldiwg
ZGV2LT5saWJ1c2JfZGV2aWNlKTsKKyAgICAgICAgfQorICAgICAgICBpZiAoZGV2LT5lZGV2KSB7
CisgICAgICAgICAgICBkZXZpY2Vfb3BzKGRldi0+ZWRldiktPnVucmVhbGl6ZShkZXYtPmVkZXYp
OworICAgICAgICB9CiAgICAgICAgIGdfZnJlZShkZXYpOwogICAgIH0KIH0KQEAgLTgyNCw0ICs4
MzksODggQEAgc3BpY2VfdXNiX2JhY2tlbmRfY2hhbm5lbF9nZXRfZ3Vlc3RfZmlsdGVyKFNwaWNl
VXNiQmFja2VuZENoYW5uZWwgKmNoLAogICAgIH0KIH0KIAordm9pZCBzcGljZV91c2JfYmFja2Vu
ZF9kZXZpY2VfcmVwb3J0X2NoYW5nZShTcGljZVVzYkJhY2tlbmQgKmJlLAorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTcGljZVVzYkJhY2tlbmREZXZpY2UgKmRl
dikKK3sKKyAgICBnY2hhciAqZGVzYzsKKyAgICBnX3JldHVybl9pZl9mYWlsKGRldiAmJiBkZXYt
PmVkZXYpOworCisgICAgZGVzYyA9IGRldmljZV9vcHMoZGV2LT5lZGV2KS0+Z2V0X3Byb2R1Y3Rf
ZGVzY3JpcHRpb24oZGV2LT5lZGV2KTsKKyAgICBTUElDRV9ERUJVRygiJXM6ICVzIiwgX19GVU5D
VElPTl9fLCBkZXNjKTsKKyAgICBnX2ZyZWUoZGVzYyk7Cit9CisKK3ZvaWQgc3BpY2VfdXNiX2Jh
Y2tlbmRfZGV2aWNlX2VqZWN0KFNwaWNlVXNiQmFja2VuZCAqYmUsIFNwaWNlVXNiQmFja2VuZERl
dmljZSAqZGV2KQoreworICAgIGdfcmV0dXJuX2lmX2ZhaWwoZGV2KTsKKworICAgIGlmIChkZXYt
PmVkZXYpIHsKKyAgICAgICAgYmUtPm93bl9kZXZpY2VzX21hc2sgJj0gfigxIDw8IGRldi0+ZGV2
aWNlX2luZm8uYWRkcmVzcyk7CisgICAgfQorICAgIGlmIChiZS0+aG90cGx1Z19jYWxsYmFjaykg
eworICAgICAgICBiZS0+aG90cGx1Z19jYWxsYmFjayhiZS0+aG90cGx1Z191c2VyX2RhdGEsIGRl
diwgRkFMU0UpOworICAgIH0KK30KKworZ2Jvb2xlYW4KK3NwaWNlX3VzYl9iYWNrZW5kX2NyZWF0
ZV9lbXVsYXRlZF9kZXZpY2UoU3BpY2VVc2JCYWNrZW5kICpiZSwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgU3BpY2VVc2JFbXVsYXRlZERldmljZUNyZWF0ZSBjcmVh
dGVfcHJvYywKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdm9pZCAq
Y3JlYXRlX3BhcmFtcywKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
R0Vycm9yICoqZXJyKQoreworICAgIFNwaWNlVXNiRW11bGF0ZWREZXZpY2UgKmVkZXY7CisgICAg
U3BpY2VVc2JCYWNrZW5kRGV2aWNlICpkZXY7CisgICAgc3RydWN0IGxpYnVzYl9kZXZpY2VfZGVz
Y3JpcHRvciAqZGVzYzsKKyAgICB1aW50MTZfdCBkZXZpY2VfZGVzY19zaXplOworICAgIHVpbnQ4
X3QgYWRkcmVzcyA9IDA7CisKKyAgICBpZiAoYmUtPm93bl9kZXZpY2VzX21hc2sgPT0gMHhmZmZm
ZmZmZikgeworICAgICAgICBnX3NldF9lcnJvcihlcnIsIFNQSUNFX0NMSUVOVF9FUlJPUiwgU1BJ
Q0VfQ0xJRU5UX0VSUk9SX0ZBSUxFRCwKKyAgICAgICAgICAgICAgICAgICAgXygiY2FuJ3QgY3Jl
YXRlIGRldmljZSAtIGxpbWl0IHJlYWNoZWQiKSk7CisgICAgICAgIHJldHVybiBGQUxTRTsKKyAg
ICB9CisgICAgZm9yIChhZGRyZXNzID0gMDsgYWRkcmVzcyA8IDMyOyArK2FkZHJlc3MpIHsKKyAg
ICAgICAgaWYgKH5iZS0+b3duX2RldmljZXNfbWFzayAmICgxIDw8IGFkZHJlc3MpKSB7CisgICAg
ICAgICAgICBicmVhazsKKyAgICAgICAgfQorICAgIH0KKworICAgIGRldiA9IGdfbmV3MChTcGlj
ZVVzYkJhY2tlbmREZXZpY2UsIDEpOworICAgIGRldi0+ZGV2aWNlX2luZm8uYnVzID0gQlVTX05V
TUJFUl9GT1JfRU1VTEFURURfVVNCOworICAgIGRldi0+ZGV2aWNlX2luZm8uYWRkcmVzcyA9IGFk
ZHJlc3M7CisgICAgZGV2LT5yZWZfY291bnQgPSAxOworCisgICAgZGV2LT5lZGV2ID0gZWRldiA9
IGNyZWF0ZV9wcm9jKGJlLCBkZXYsIGNyZWF0ZV9wYXJhbXMsIGVycik7CisgICAgaWYgKGVkZXYg
PT0gTlVMTCkgeworICAgICAgICBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfdW5yZWYoZGV2KTsK
KyAgICAgICAgcmV0dXJuIEZBTFNFOworICAgIH0KKworICAgIGlmICghZGV2aWNlX29wcyhlZGV2
KS0+Z2V0X2Rlc2NyaXB0b3IoZWRldiwgTElCVVNCX0RUX0RFVklDRSwgMCwKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICh2b2lkICoqKSZkZXNjLCAmZGV2aWNlX2Rl
c2Nfc2l6ZSkKKyAgICAgICAgfHwgZGV2aWNlX2Rlc2Nfc2l6ZSAhPSBzaXplb2YoKmRlc2MpKSB7
CisKKyAgICAgICAgc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX3VucmVmKGRldik7CisgICAgICAg
IGdfc2V0X2Vycm9yKGVyciwgU1BJQ0VfQ0xJRU5UX0VSUk9SLCBTUElDRV9DTElFTlRfRVJST1Jf
RkFJTEVELAorICAgICAgICAgICAgICAgICAgICBfKCJjYW4ndCBjcmVhdGUgZGV2aWNlIC0gaW50
ZXJuYWwgZXJyb3IiKSk7CisgICAgICAgIHJldHVybiBGQUxTRTsKKyAgICB9CisKKyAgICBiZS0+
b3duX2RldmljZXNfbWFzayB8PSAxIDw8IGFkZHJlc3M7CisKKyAgICBkZXYtPmRldmljZV9pbmZv
LnZpZCA9IGRlc2MtPmlkVmVuZG9yOworICAgIGRldi0+ZGV2aWNlX2luZm8ucGlkID0gZGVzYy0+
aWRQcm9kdWN0OworICAgIGRldi0+ZGV2aWNlX2luZm8uYmNkVVNCID0gZGVzYy0+YmNkVVNCOwor
ICAgIGRldi0+ZGV2aWNlX2luZm8uY2xhc3MgPSBkZXNjLT5iRGV2aWNlQ2xhc3M7CisgICAgZGV2
LT5kZXZpY2VfaW5mby5zdWJjbGFzcyA9IGRlc2MtPmJEZXZpY2VTdWJDbGFzczsKKyAgICBkZXYt
PmRldmljZV9pbmZvLnByb3RvY29sID0gZGVzYy0+YkRldmljZVByb3RvY29sOworCisgICAgaWYg
KGJlLT5ob3RwbHVnX2NhbGxiYWNrKSB7CisgICAgICAgIGJlLT5ob3RwbHVnX2NhbGxiYWNrKGJl
LT5ob3RwbHVnX3VzZXJfZGF0YSwgZGV2LCBUUlVFKTsKKyAgICB9CisgICAgc3BpY2VfdXNiX2Jh
Y2tlbmRfZGV2aWNlX3VucmVmKGRldik7CisKKyAgICByZXR1cm4gVFJVRTsKK30KKwogI2VuZGlm
IC8qIFVTQl9SRURJUiAqLwpkaWZmIC0tZ2l0IGEvc3JjL3VzYi1iYWNrZW5kLmggYi9zcmMvdXNi
LWJhY2tlbmQuaAppbmRleCA2NmUxM2Y1Li5jZDNmZjA5IDEwMDY0NAotLS0gYS9zcmMvdXNiLWJh
Y2tlbmQuaAorKysgYi9zcmMvdXNiLWJhY2tlbmQuaApAQCAtMzAsMTIgKzMwLDE1IEBAIHR5cGVk
ZWYgc3RydWN0IF9TcGljZVVzYkJhY2tlbmQgU3BpY2VVc2JCYWNrZW5kOwogdHlwZWRlZiBzdHJ1
Y3QgX1NwaWNlVXNiQmFja2VuZERldmljZSBTcGljZVVzYkJhY2tlbmREZXZpY2U7CiB0eXBlZGVm
IHN0cnVjdCBfU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCBTcGljZVVzYkJhY2tlbmRDaGFubmVsOwog
CisjZGVmaW5lIEJVU19OVU1CRVJfRk9SX0VNVUxBVEVEX1VTQiBHX01BWFVJTlQxNgorCiB0eXBl
ZGVmIHN0cnVjdCBVc2JEZXZpY2VJbmZvcm1hdGlvbgogewogICAgIHVpbnQxNl90IGJ1czsKICAg
ICB1aW50MTZfdCBhZGRyZXNzOwogICAgIHVpbnQxNl90IHZpZDsKICAgICB1aW50MTZfdCBwaWQ7
CisgICAgdWludDE2X3QgYmNkVVNCOwogICAgIHVpbnQ4X3QgY2xhc3M7CiAgICAgdWludDhfdCBz
dWJjbGFzczsKICAgICB1aW50OF90IHByb3RvY29sOwpkaWZmIC0tZ2l0IGEvc3JjL3VzYi1lbXVs
YXRpb24uaCBiL3NyYy91c2ItZW11bGF0aW9uLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXgg
MDAwMDAwMC4uYWMzZDhlMAotLS0gL2Rldi9udWxsCisrKyBiL3NyYy91c2ItZW11bGF0aW9uLmgK
QEAgLTAsMCArMSw4OCBAQAorLyogLSotIE1vZGU6IEM7IGMtYmFzaWMtb2Zmc2V0OiA0OyBpbmRl
bnQtdGFicy1tb2RlOiBuaWwgLSotICovCisvKgorICAgIENvcHlyaWdodCAoQykgMjAxOSBSZWQg
SGF0LCBJbmMuCisKKyAgICBSZWQgSGF0IEF1dGhvcnM6CisgICAgWXVyaSBCZW5kaXRvdmljaDx5
YmVuZGl0b0ByZWRoYXQuY29tPgorCisgICAgVGhpcyBsaWJyYXJ5IGlzIGZyZWUgc29mdHdhcmU7
IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vcgorICAgIG1vZGlmeSBpdCB1bmRlciB0aGUg
dGVybXMgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKKyAgICBMaWNlbnNlIGFzIHB1
Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIKKyAgICB2ZXJz
aW9uIDIuMSBvZiB0aGUgTGljZW5zZSwgb3IgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVy
c2lvbi4KKworICAgIFRoaXMgbGlicmFyeSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0
IGl0IHdpbGwgYmUgdXNlZnVsLAorICAgIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91
dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCisgICAgTUVSQ0hBTlRBQklMSVRZIG9yIEZJ
VE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZSBHTlUKKyAgICBMZXNzZXIg
R2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgorCisgICAgWW91IHNob3Vs
ZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYwor
ICAgIExpY2Vuc2UgYWxvbmcgd2l0aCB0aGlzIGxpYnJhcnk7IGlmIG5vdCwgc2VlIDxodHRwOi8v
d3d3LmdudS5vcmcvbGljZW5zZXMvPi4KKyovCisKKyNwcmFnbWEgb25jZQorCisjaW5jbHVkZSAi
dXNicmVkaXJwYXJzZXIuaCIKKyNpbmNsdWRlICJ1c2ItYmFja2VuZC5oIgorCit0eXBlZGVmIHN0
cnVjdCBTcGljZVVzYkVtdWxhdGVkRGV2aWNlIFNwaWNlVXNiRW11bGF0ZWREZXZpY2U7Cit0eXBl
ZGVmIFNwaWNlVXNiRW11bGF0ZWREZXZpY2UqCisoKlNwaWNlVXNiRW11bGF0ZWREZXZpY2VDcmVh
dGUpKFNwaWNlVXNiQmFja2VuZCAqYmUsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IFNwaWNlVXNiQmFja2VuZERldmljZSAqcGFyZW50LAorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB2b2lkICpjcmVhdGVfcGFyYW1zLAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBHRXJyb3IgKiplcnIpOworCisvKgorICAgIGZ1bmN0aW9uIHRhYmxlIGZvciBlbXVsYXRl
ZCBVU0IgZGV2aWNlCisgICAgbXVzdCBiZSBmaXJzdCBtZW1iZXIgb2YgZGV2aWNlIHN0cnVjdHVy
ZQorICAgIGFsbCBmdW5jdGlvbnMgYXJlIG1hbmRhdG9yeSBmb3IgaW1wbGVtZW50YXRpb24KKyov
Cit0eXBlZGVmIHN0cnVjdCBVc2JEZXZpY2VPcHMgeworICAgIGdib29sZWFuICgqZ2V0X2Rlc2Ny
aXB0b3IpKFNwaWNlVXNiRW11bGF0ZWREZXZpY2UgKmRldmljZSwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB1aW50OF90IHR5cGUsIHVpbnQ4X3QgaW5kZXgsCisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgdm9pZCAqKmJ1ZmZlciwgdWludDE2X3QgKnNpemUpOworICAgIGdj
aGFyICogKCpnZXRfcHJvZHVjdF9kZXNjcmlwdGlvbikoU3BpY2VVc2JFbXVsYXRlZERldmljZSAq
ZGV2aWNlKTsKKyAgICB2b2lkICgqYXR0YWNoKShTcGljZVVzYkVtdWxhdGVkRGV2aWNlICpkZXZp
Y2UsIHN0cnVjdCB1c2JyZWRpcnBhcnNlciAqcGFyc2VyKTsKKyAgICB2b2lkICgqcmVzZXQpKFNw
aWNlVXNiRW11bGF0ZWREZXZpY2UgKmRldmljZSk7CisgICAgLyoKKyAgICAgICAgcHJvY2Vzc2lu
ZyBpcyBzeW5jaHJvbm91cywgZGVmYXVsdCA9IHN0YWxsOgorICAgICAgICAtIHJldHVybiBzdWNj
ZXNzIHdpdGhvdXQgZGF0YTogc2V0IHN0YXR1cyB0byAwCisgICAgICAgIC0gcmV0dXJuIGVycm9y
IC0gc2V0IHN0YXR1cyB0byBlcnJvcgorICAgICAgICAtIHJldHVybiBzdWNjZXNzIHdpdGggZGF0
YSAtIHNldCBzdGF0dXMgdG8gMCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHNldCBidWZmZXIgdG8gc29tZSBidWZmZXIKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHNldCBsZW5ndGggdG8gb3V0IGxlbgorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgdHJ1bmNhdGlvbiBpcyBhdXRvbWF0aWMKKyAgICAqLworICAgIHZvaWQgKCpjb250
cm9sX3JlcXVlc3QpKFNwaWNlVXNiRW11bGF0ZWREZXZpY2UgKmRldmljZSwKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICB1aW50OF90ICpkYXRhLCBpbnQgZGF0YV9sZW4sCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgc3RydWN0IHVzYl9yZWRpcl9jb250cm9sX3BhY2tldF9oZWFkZXIg
KmgsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgdm9pZCAqKmJ1ZmZlcik7CisgICAgLyoK
KyAgICAgICAgcHJvY2Vzc2luZyBpcyBzeW5jaHJvbm91czoKKyAgICAgICAgLSBzZXQgaC0+c3Rh
dHVzIHRvIHJlc3VsdGluZyBzdGF0dXMsIGRlZmF1bHQgPSBzdGFsbAorICAgICovCisgICAgdm9p
ZCAoKmJ1bGtfb3V0X3JlcXVlc3QpKFNwaWNlVXNiRW11bGF0ZWREZXZpY2UgKmRldmljZSwKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDhfdCBlcCwgdWludDhfdCAqZGF0YSwgaW50
IGRhdGFfbGVuLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50OF90ICpzdGF0dXMp
OworICAgIC8qCisgICAgICAgIGlmIHJldHVybnMgdHJ1ZSwgcHJvY2Vzc2luZyBpcyBhc3luY2hy
b25vdXMKKyAgICAgICAgb3RoZXJ3aXNlIGhlYWRlciBjb250YWlucyBlcnJvciBzdGF0dXMKKyAg
ICAqLworICAgIGdib29sZWFuICgqYnVsa19pbl9yZXF1ZXN0KShTcGljZVVzYkVtdWxhdGVkRGV2
aWNlICpkZXZpY2UsIHVpbnQ2NF90IGlkLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0
cnVjdCB1c2JfcmVkaXJfYnVsa19wYWNrZXRfaGVhZGVyICpidWxrX2hlYWRlcik7CisgICAgdm9p
ZCAoKmNhbmNlbF9yZXF1ZXN0KShTcGljZVVzYkVtdWxhdGVkRGV2aWNlICpkZXZpY2UsIHVpbnQ2
NF90IGlkKTsKKyAgICB2b2lkICgqZGV0YWNoKShTcGljZVVzYkVtdWxhdGVkRGV2aWNlICpkZXZp
Y2UpOworICAgIHZvaWQgKCp1bnJlYWxpemUpKFNwaWNlVXNiRW11bGF0ZWREZXZpY2UgKmRldmlj
ZSk7Cit9IFVzYkRldmljZU9wczsKKworc3RhdGljIGlubGluZSBjb25zdCBVc2JEZXZpY2VPcHMg
KmRldmljZV9vcHMoU3BpY2VVc2JFbXVsYXRlZERldmljZSAqZGV2KQoreworICAgIHJldHVybiAo
Y29uc3QgVXNiRGV2aWNlT3BzICopZGV2OworfQorCitnYm9vbGVhbgorc3BpY2VfdXNiX2JhY2tl
bmRfY3JlYXRlX2VtdWxhdGVkX2RldmljZShTcGljZVVzYkJhY2tlbmQgKmJlLAorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTcGljZVVzYkVtdWxhdGVkRGV2aWNlQ3Jl
YXRlIGNyZWF0ZV9wcm9jLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICB2b2lkICpjcmVhdGVfcGFyYW1zLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBHRXJyb3IgKiplcnIpOwordm9pZCBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfZWpl
Y3QoU3BpY2VVc2JCYWNrZW5kICpiZSwgU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpkZXZpY2UpOwor
dm9pZCBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfcmVwb3J0X2NoYW5nZShTcGljZVVzYkJhY2tl
bmQgKmJlLCBTcGljZVVzYkJhY2tlbmREZXZpY2UgKmRldmljZSk7Ci0tIAoyLjE3LjEKCl9fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClNwaWNlLWRldmVsIG1h
aWxpbmcgbGlzdApTcGljZS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0
cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9zcGljZS1kZXZlbA==
