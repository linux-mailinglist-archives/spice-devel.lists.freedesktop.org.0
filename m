Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id D2DFD89AA9
	for <lists+spice-devel@lfdr.de>; Mon, 12 Aug 2019 11:57:57 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 66C8C6E4EC;
	Mon, 12 Aug 2019 09:57:55 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mail-wr1-x42d.google.com (mail-wr1-x42d.google.com
 [IPv6:2a00:1450:4864:20::42d])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 36D736E4EA
 for <spice-devel@lists.freedesktop.org>; Mon, 12 Aug 2019 09:57:53 +0000 (UTC)
Received: by mail-wr1-x42d.google.com with SMTP id r1so4923245wrl.7
 for <spice-devel@lists.freedesktop.org>; Mon, 12 Aug 2019 02:57:53 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references;
 bh=bX2rrq/kN2jQYogOcsNNZ0Ak204KE80j9B5q+h8S7zk=;
 b=Z//VR7IbcfrHv87ITurNHK8EzftMGdq8so5P/tRCpO1KrDFBMsCeScWCVPl4N8ZJo+
 i90IcDmG+yJ0GcUj5q/+MJ1J34RnxM1LhRTJnUf/h5ZgctBHAN2/9eClnk/2dVbik6bC
 N8Hlgzo11+otr3BFBJzJyZi97wP1V2D8S/Qkslss8JgU3pOq6wOM14KB9za1qrHYnp3w
 chssIAZB62pnvlUcMkhtC7m8A3MECOdGY/BVMvypcsyd7iCSbS6nr3Jw20RT3l0xovZm
 XR/2LeX7NDFywtoR0WRj+CgfI3VTsAWPflKWFf42qnKjS1SuRuhZ3xKHJ/gxwvy7UUmO
 +1qg==
X-Gm-Message-State: APjAAAVla+YmgP11IH7OXw2Ey3BNPp1mRX9vp5uJ8kN/7RvHPtEnh71c
 xBemTOCCl8wNo4WXTj25n+1CNAUeRhY=
X-Google-Smtp-Source: APXvYqxqM+ipswpUEmf09HoNL7CJ4oa4EDEo/l6gxn0FDf7tNphq9Dci6FG1psrvvWvAReGxXq/jHA==
X-Received: by 2002:a05:6000:4f:: with SMTP id
 k15mr20340475wrx.221.1565603869785; 
 Mon, 12 Aug 2019 02:57:49 -0700 (PDT)
Received: from f2.redhat.com (bzq-79-182-115-245.red.bezeqint.net.
 [79.182.115.245])
 by smtp.gmail.com with ESMTPSA id g14sm11930659wrb.38.2019.08.12.02.57.48
 (version=TLS1_2 cipher=ECDHE-RSA-CHACHA20-POLY1305 bits=256/256);
 Mon, 12 Aug 2019 02:57:49 -0700 (PDT)
From: Yuri Benditovich <yuri.benditovich@daynix.com>
To: spice-devel@lists.freedesktop.org
Date: Mon, 12 Aug 2019 12:57:26 +0300
Message-Id: <20190812095729.32692-7-yuri.benditovich@daynix.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20190812095729.32692-1-yuri.benditovich@daynix.com>
References: <20190812095729.32692-1-yuri.benditovich@daynix.com>
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=daynix-com.20150623.gappssmtp.com; s=20150623;
 h=from:to:cc:subject:date:message-id:in-reply-to:references;
 bh=bX2rrq/kN2jQYogOcsNNZ0Ak204KE80j9B5q+h8S7zk=;
 b=vtCzQCbKRK0wv3xPGGSzl85+TdxQM5asJDexezqGXBA3VFOvTjKyLnpJppzmxcVVxr
 TWVBXuEJUXYtmQbh9R72d+9x6bxRuCi/Aop/s0/aov3nXj7MCQu7DhY4bgtWXaJH7jWd
 rwt5y1wFnjl1zhGqJeYsvSt+avAaL1rjQGq4p0atNJqYOhd4qYplvmSMXxntszjqoMHl
 vEbh1h+zRpqiq2WdGNvdxIfGiVF3xHIq15QtUqYzkIkq3kogszVFtUGvDlabcX91FiZI
 EqlV+hKDjrCbPq/YgGuixDYA6+QAA+g03IUCiuodix9pe16ZCChByP1zbnhAi6RreaUE
 cNqg==
Subject: [Spice-devel] [spice-gtk v3 6/9] usb-redir: add files for SCSI and
 USB MSC implementation
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: yan@daynix.com
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

RmlsZXMgYWRkZWQgd2l0aG91dCBpbmNsdWRpbmcgdGhlbSBpbiBjb21waWxhdGlvbi4KVGhleSBj
b250YWluIGltcGxlbWVudGF0aW9uIG9mIFNDU0kgY29tbWFuZHMgZm9yIGxvZ2ljYWwKdW5pdHMg
b2YgbWFzcy1zdG9yYWdlIGRldmljZSBjbGFzcyBhbmQgVVNCIGJ1bGstb25seQptYXNzLXN0b3Jh
Z2UgZGV2aWNlIHByb3RvY29sLgoKU2lnbmVkLW9mZi1ieTogQWxleGFuZGVyIE5lemhpbnNreTxh
bmV6aGluc0ByZWRoYXQuY29tPgpTaWduZWQtb2ZmLWJ5OiBZdXJpIEJlbmRpdG92aWNoIDx5dXJp
LmJlbmRpdG92aWNoQGRheW5peC5jb20+Ci0tLQogc3JjL2NkLXNjc2ktZGV2LXBhcmFtcy5oIHwg
ICA0OSArCiBzcmMvY2Qtc2NzaS5jICAgICAgICAgICAgfCAyNzQwICsrKysrKysrKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysrCiBzcmMvY2Qtc2NzaS5oICAgICAgICAgICAgfCAgMTIwICsr
CiBzcmMvY2QtdXNiLWJ1bGstbXNkLmMgICAgfCAgNTQ0ICsrKysrKysrCiBzcmMvY2QtdXNiLWJ1
bGstbXNkLmggICAgfCAgMTM0ICsrCiBzcmMvc2NzaS1jb25zdGFudHMuaCAgICAgfCAgMzI0ICsr
KysrCiA2IGZpbGVzIGNoYW5nZWQsIDM5MTEgaW5zZXJ0aW9ucygrKQogY3JlYXRlIG1vZGUgMTAw
NjQ0IHNyYy9jZC1zY3NpLWRldi1wYXJhbXMuaAogY3JlYXRlIG1vZGUgMTAwNjQ0IHNyYy9jZC1z
Y3NpLmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBzcmMvY2Qtc2NzaS5oCiBjcmVhdGUgbW9kZSAxMDA2
NDQgc3JjL2NkLXVzYi1idWxrLW1zZC5jCiBjcmVhdGUgbW9kZSAxMDA2NDQgc3JjL2NkLXVzYi1i
dWxrLW1zZC5oCiBjcmVhdGUgbW9kZSAxMDA2NDQgc3JjL3Njc2ktY29uc3RhbnRzLmgKCmRpZmYg
LS1naXQgYS9zcmMvY2Qtc2NzaS1kZXYtcGFyYW1zLmggYi9zcmMvY2Qtc2NzaS1kZXYtcGFyYW1z
LmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMC4uYjQ4MGJjZAotLS0gL2Rldi9u
dWxsCisrKyBiL3NyYy9jZC1zY3NpLWRldi1wYXJhbXMuaApAQCAtMCwwICsxLDQ5IEBACisvKiAt
Ki0gTW9kZTogQzsgYy1iYXNpYy1vZmZzZXQ6IDQ7IGluZGVudC10YWJzLW1vZGU6IG5pbCAtKi0g
Ki8KKy8qCisgICBDRCBTQ1NJIGRldmljZSBwYXJhbWV0ZXJzCisKKyAgIENvcHlyaWdodCAoQykg
MjAxOCBSZWQgSGF0LCBJbmMuCisKKyAgIFJlZCBIYXQgQXV0aG9yczoKKyAgIEFsZXhhbmRlciBO
ZXpoaW5za3k8YW5lemhpbnNAcmVkaGF0LmNvbT4KKworICAgVGhpcyBsaWJyYXJ5IGlzIGZyZWUg
c29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vcgorICAgbW9kaWZ5IGl0IHVu
ZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYworICAgTGljZW5z
ZSBhcyBwdWJsaXNoZWQgYnkgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyCisg
ICB2ZXJzaW9uIDIuMSBvZiB0aGUgTGljZW5zZSwgb3IgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0
ZXIgdmVyc2lvbi4KKworICAgVGhpcyBsaWJyYXJ5IGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3Bl
IHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCisgICBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdp
dGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgorICAgTUVSQ0hBTlRBQklMSVRZIG9y
IEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZSBHTlUKKyAgIExlc3Nl
ciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCisKKyAgIFlvdSBzaG91
bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMK
KyAgIExpY2Vuc2UgYWxvbmcgd2l0aCB0aGlzIGxpYnJhcnk7IGlmIG5vdCwgc2VlIDxodHRwOi8v
d3d3LmdudS5vcmcvbGljZW5zZXMvPi4KKyovCisKKyNpZm5kZWYgU1BJQ0VfR1RLX0NEX1NDU0lf
REVWX1BBUkFNU19IXworI2RlZmluZSBTUElDRV9HVEtfQ0RfU0NTSV9ERVZfUEFSQU1TX0hfCisK
KyNpbmNsdWRlIDxnaW8vZ2lvLmg+CisKK3R5cGVkZWYgc3RydWN0IENkU2NzaURldmljZVBhcmFt
ZXRlcnMgeworICAgIGNvbnN0IGNoYXIgKnZlbmRvcjsKKyAgICBjb25zdCBjaGFyICpwcm9kdWN0
OworICAgIGNvbnN0IGNoYXIgKnZlcnNpb247CisgICAgY29uc3QgY2hhciAqc2VyaWFsOworfSBD
ZFNjc2lEZXZpY2VQYXJhbWV0ZXJzOworCit0eXBlZGVmIHN0cnVjdCBDZFNjc2lEZXZpY2VJbmZv
IHsKKyAgICBDZFNjc2lEZXZpY2VQYXJhbWV0ZXJzIHBhcmFtZXRlcnM7CisgICAgdWludDMyX3Qg
c3RhcnRlZCAgICA6IDE7CisgICAgdWludDMyX3QgbG9ja2VkICAgICA6IDE7CisgICAgdWludDMy
X3QgbG9hZGVkICAgICA6IDE7Cit9IENkU2NzaURldmljZUluZm87CisKK3R5cGVkZWYgc3RydWN0
IENkU2NzaU1lZGlhUGFyYW1ldGVycyB7CisgICAgR0ZpbGVJbnB1dFN0cmVhbSAqc3RyZWFtOwor
ICAgIHVpbnQ2NF90IHNpemU7CisgICAgdWludDMyX3QgYmxvY2tfc2l6ZTsKK30gQ2RTY3NpTWVk
aWFQYXJhbWV0ZXJzOworCisjZW5kaWYgLyogU1BJQ0VfR1RLX0NEX1NDU0lfREVWX1BBUkFNU19I
XyAqLwpkaWZmIC0tZ2l0IGEvc3JjL2NkLXNjc2kuYyBiL3NyYy9jZC1zY3NpLmMKbmV3IGZpbGUg
bW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMC4uMjU4NDJiMwotLS0gL2Rldi9udWxsCisrKyBiL3Ny
Yy9jZC1zY3NpLmMKQEAgLTAsMCArMSwyNzQwIEBACisvKiAtKi0gTW9kZTogQzsgYy1iYXNpYy1v
ZmZzZXQ6IDQ7IGluZGVudC10YWJzLW1vZGU6IG5pbCAtKi0gKi8KKy8qCisgICBDRCBkZXZpY2Ug
ZW11bGF0aW9uIC0gU0NTSSBlbmdpbmUKKworICAgQ29weXJpZ2h0IChDKSAyMDE4IFJlZCBIYXQs
IEluYy4KKworICAgUmVkIEhhdCBBdXRob3JzOgorICAgQWxleGFuZGVyIE5lemhpbnNreTxhbmV6
aGluc0ByZWRoYXQuY29tPgorCisgICBUaGlzIGxpYnJhcnkgaXMgZnJlZSBzb2Z0d2FyZTsgeW91
IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yCisgICBtb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1z
IG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCisgICBMaWNlbnNlIGFzIHB1Ymxpc2hl
ZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIKKyAgIHZlcnNpb24gMi4x
IG9mIHRoZSBMaWNlbnNlLCBvciAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgor
CisgICBUaGlzIGxpYnJhcnkgaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxs
IGJlIHVzZWZ1bCwKKyAgIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRo
ZSBpbXBsaWVkIHdhcnJhbnR5IG9mCisgICBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1Ig
QSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlIEdOVQorICAgTGVzc2VyIEdlbmVyYWwgUHVi
bGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KKworICAgWW91IHNob3VsZCBoYXZlIHJlY2Vp
dmVkIGEgY29weSBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYworICAgTGljZW5zZSBh
bG9uZyB3aXRoIHRoaXMgbGlicmFyeTsgaWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9s
aWNlbnNlcy8+LgorKi8KKworI2luY2x1ZGUgImNvbmZpZy5oIgorI2luY2x1ZGUgInNwaWNlL3R5
cGVzLmgiCisjaW5jbHVkZSAic3BpY2UtY29tbW9uLmgiCisjaW5jbHVkZSAic3BpY2UtdXRpbC5o
IgorI2luY2x1ZGUgImNkLXNjc2kuaCIKKworI2lmZGVmIFVTRV9VU0JSRURJUgorCisjZGVmaW5l
IFNQSUNFX0VSUk9SKGZtdCwgLi4uKSBcCisgICAgZG8geyBTUElDRV9ERUJVRygiZGV2LXNjc2kg
ZXJyb3I6ICIgZm10ICwgIyMgX19WQV9BUkdTX18pOyB9IHdoaWxlICgwKQorCisjZGVmaW5lIEZJ
WEVEX1NFTlNFX0NVUlJFTlQgMHg3MAorI2RlZmluZSBGSVhFRF9TRU5TRV9MRU4gMTgKKworI2Rl
ZmluZSBNQVhfTFVOUyAgIDMyCisKK3R5cGVkZWYgZW51bSBDZFNjc2lQb3dlckNvbmRpdGlvbiB7
CisgICAgQ0RfU0NTSV9QT1dFUl9TVE9QUEVELAorICAgIENEX1NDU0lfUE9XRVJfQUNUSVZFLAor
ICAgIENEX1NDU0lfUE9XRVJfSURMRSwKKyAgICBDRF9TQ1NJX1BPV0VSX1NUQU5EQlkKK30gQ2RT
Y3NpUG93ZXJDb25kaXRpb247CisKK3R5cGVkZWYgc3RydWN0IFNjc2lTaG9ydFNlbnNlIHsKKyAg
ICB1aW50OF90IGtleTsKKyAgICB1aW50OF90IGFzYzsKKyAgICB1aW50OF90IGFzY3E7CisgICAg
Y29uc3QgY2hhciAqZGVzY3I7Cit9IFNjc2lTaG9ydFNlbnNlOworCisjZGVmaW5lIENEX01FRElB
X0VWRU5UX05PX0NIQU5HRSAgICAgICAgICAgIDB4MAorI2RlZmluZSBDRF9NRURJQV9FVkVOVF9F
SkVDVF9SRVEgICAgICAgICAgICAweDEgLyogdXNlciByZXF1ZXN0IChtZWNoYW5pY2FsIHN3aXRj
aCkgdG8KKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAq
IGVqZWN0IHRoZSBtZWRpYSAqLworI2RlZmluZSBDRF9NRURJQV9FVkVOVF9ORVdfTUVESUEgICAg
ICAgICAgICAweDIgLyogbmV3IG1lZGlhIHJlY2VpdmVkICovCisjZGVmaW5lIENEX01FRElBX0VW
RU5UX01FRElBX1JFTU9WQUwgICAgICAgIDB4MyAvKiBtZWRpYSByZW1vdmVkICovCisjZGVmaW5l
IENEX01FRElBX0VWRU5UX01FRElBX0NIQU5HRUQgICAgICAgIDB4NCAvKiB1c2VyIHJlcXVlc3Qg
dG8gbG9hZCBuZXcgbWVkaWEgKi8KKyNkZWZpbmUgQ0RfTUVESUFfRVZFTlRfQkdfRk9STUFUX0NP
TVBMRVRFICAgMHg1CisjZGVmaW5lIENEX01FRElBX0VWRU5UX0JHX0ZPUk1BVF9SRVNUQVJUICAg
IDB4NgorCisjZGVmaW5lIENEX1BPV0VSX0VWRU5UX05PX0NIQU5HRSAgICAgICAgICAgIDB4MAor
I2RlZmluZSBDRF9QT1dFUl9FVkVOVF9DSEFOR0VfU1VDQ0VTUyAgICAgICAweDEKKyNkZWZpbmUg
Q0RfUE9XRVJfRVZFTlRfQ0hBTkdFX0ZBTEVEICAgICAgICAgMHgyCisKK3R5cGVkZWYgc3RydWN0
IENkU2NzaUxVIHsKKyAgICBDZFNjc2lUYXJnZXQgKnRndDsKKyAgICB1aW50MzJfdCBsdW47CisK
KyAgICBnYm9vbGVhbiByZWFsaXplZDsKKyAgICBnYm9vbGVhbiByZW1vdmFibGU7CisgICAgZ2Jv
b2xlYW4gbG9hZGVkOworICAgIGdib29sZWFuIHByZXZlbnRfbWVkaWFfcmVtb3ZhbDsKKyAgICBn
Ym9vbGVhbiBjZF9yb207CisKKyAgICBDZFNjc2lQb3dlckNvbmRpdGlvbiBwb3dlcl9jb25kOwor
ICAgIHVpbnQzMl90IHBvd2VyX2V2ZW50OworICAgIHVpbnQzMl90IG1lZGlhX2V2ZW50OworCisg
ICAgdWludDMyX3QgY2xhaW1fdmVyc2lvbjsKKworICAgIHVpbnQ2NF90IHNpemU7CisgICAgdWlu
dDMyX3QgYmxvY2tfc2l6ZTsKKyAgICB1aW50MzJfdCBudW1fYmxvY2tzOworCisgICAgY2hhciAq
dmVuZG9yOworICAgIGNoYXIgKnByb2R1Y3Q7CisgICAgY2hhciAqdmVyc2lvbjsKKyAgICBjaGFy
ICpzZXJpYWw7CisKKyAgICBHRmlsZUlucHV0U3RyZWFtICpzdHJlYW07CisKKyAgICBTY3NpU2hv
cnRTZW5zZSBzaG9ydF9zZW5zZTsgLyogY3VycmVudGx5IGhlbGQgc2Vuc2Ugb2YgdGhlIHNjc2kg
ZGV2aWNlICovCisgICAgdWludDhfdCBmaXhlZF9zZW5zZVtGSVhFRF9TRU5TRV9MRU5dOworfSBD
ZFNjc2lMVTsKKwordHlwZWRlZiBlbnVtIENkU2NzaVRhcmdldFN0YXRlIHsKKyAgICBDRF9TQ1NJ
X1RHVF9TVEFURV9SVU5OSU5HLAorICAgIENEX1NDU0lfVEdUX1NUQVRFX1JFU0VULAorfSBDZFNj
c2lUYXJnZXRTdGF0ZTsKKworc3RydWN0IENkU2NzaVRhcmdldCB7CisgICAgdm9pZCAqdXNlcl9k
YXRhOworCisgICAgQ2RTY3NpVGFyZ2V0U3RhdGUgc3RhdGU7CisgICAgQ2RTY3NpUmVxdWVzdCAq
Y3VyX3JlcTsKKyAgICBHQ2FuY2VsbGFibGUgKmNhbmNlbGxhYmxlOworCisgICAgdWludDMyX3Qg
bWF4X2x1bnM7CisgICAgQ2RTY3NpTFUgdW5pdHNbTUFYX0xVTlNdOworfTsKKworc3RhdGljIGNv
bnN0IGNoYXIqIHNjc2lfY21kX25hbWVbMjU2XTsKKworLyogUHJlZGVmaW5lZCBzZW5zZSBjb2Rl
cyAqLworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX05PX1NFTlNFID0geworICAg
IC5rZXkgPSBOT19TRU5TRSAsIC5hc2MgPSAweDAwICwgLmFzY3EgPSAweDAwLAorICAgIC5kZXNj
ciA9ICIiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX05PVF9SRUFEWV9D
QVVTRV9OT1RfUkVQT1JUQUJMRSA9IHsKKyAgICAua2V5ID0gTk9UX1JFQURZLCAuYXNjID0gMHgw
NCwgLmFzY3EgPSAweDAwLAorICAgIC5kZXNjciA9ICJDQVVTRSBOT1QgUkVQT1JUQUJMRSIKK307
CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNlIHNlbnNlX2NvZGVfQkVDT01JTkdfUkVBRFkgPSB7Cisg
ICAgLmtleSA9IE5PVF9SRUFEWSwgLmFzYyA9IDB4MDQsIC5hc2NxID0gMHgwMSwKKyAgICAuZGVz
Y3IgPSAiSU4gUFJPQ0VTUyBPRiBCRUNPTUlORyBSRUFEWSIKK307CisKK2NvbnN0IFNjc2lTaG9y
dFNlbnNlIHNlbnNlX2NvZGVfSU5JVF9DTURfUkVRVUlSRUQgPSB7CisgICAgLmtleSA9IE5PVF9S
RUFEWSwgLmFzYyA9IDB4MDQsIC5hc2NxID0gMHgwMiwKKyAgICAuZGVzY3IgPSAiSU5JVElBTEla
SU5HIENPTU1BTkQgUkVRVUlSRUQiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9j
b2RlX0lOVEVSVkVOVElPTl9SRVFVSVJFRCA9IHsKKyAgICAua2V5ID0gTk9UX1JFQURZLCAuYXNj
ID0gMHgwNCwgLmFzY3EgPSAweDAzLAorICAgIC5kZXNjciA9ICJNQU5VQUwgSU5URVJWRU5USU9O
IFJFUVVJUkVEIgorfTsKKworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9OT1RfUkVB
RFlfTk9fTUVESVVNID0geworICAgIC5rZXkgPSBOT1RfUkVBRFksIC5hc2MgPSAweDNhLCAuYXNj
cSA9IDB4MDAsCisgICAgLmRlc2NyID0gIk1FRElVTSBOT1QgUFJFU0VOVCIKK307CisKK2NvbnN0
IFNjc2lTaG9ydFNlbnNlIHNlbnNlX2NvZGVfTk9UX1JFQURZX05PX01FRElVTV9UUkFZX0NMT1NF
RCA9IHsKKyAgICAua2V5ID0gTk9UX1JFQURZLCAuYXNjID0gMHgzYSwgLmFzY3EgPSAweDAxLAor
ICAgIC5kZXNjciA9ICJNRURJVU0gTk9UIFBSRVNFTlQgLSBUUkFZIENMT1NFRCIKK307CisKK2Nv
bnN0IFNjc2lTaG9ydFNlbnNlIHNlbnNlX2NvZGVfTk9UX1JFQURZX05PX01FRElVTV9UUkFZX09Q
RU4gPSB7CisgICAgLmtleSA9IE5PVF9SRUFEWSwgLmFzYyA9IDB4M2EsIC5hc2NxID0gMHgwMiwK
KyAgICAuZGVzY3IgPSAiTUVESVVNIE5PVCBQUkVTRU5UIC0gVFJBWSBPUEVOIgorfTsKKworY29u
c3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9UQVJHRVRfRkFJTFVSRSA9IHsKKyAgICAua2V5
ID0gSEFSRFdBUkVfRVJST1IsIC5hc2MgPSAweDQ0LCAuYXNjcSA9IDB4MDAsCisgICAgLmRlc2Ny
ID0gIklOVEVSTkFMIFRBUkdFVCBGQUlMVVJFIgorfTsKKworY29uc3QgU2NzaVNob3J0U2Vuc2Ug
c2Vuc2VfY29kZV9JTlZBTElEX09QQ09ERSA9IHsKKyAgICAua2V5ID0gSUxMRUdBTF9SRVFVRVNU
LCAuYXNjID0gMHgyMCwgLmFzY3EgPSAweDAwLAorICAgIC5kZXNjciA9ICJJTlZBTElEIENPTU1B
TkQgT1BFUkFUSU9OIENPREUiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2Rl
X0xCQV9PVVRfT0ZfUkFOR0UgPSB7CisgICAgLmtleSA9IElMTEVHQUxfUkVRVUVTVCwgLmFzYyA9
IDB4MjEsIC5hc2NxID0gMHgwMCwKKyAgICAuZGVzY3IgPSAiTE9HSUNBTCBCTE9DSyBBRERSRVNT
IE9VVCBPRiBSQU5HRSIKK307CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNlIHNlbnNlX2NvZGVfSU5W
QUxJRF9DREJfRklFTEQgPSB7CisgICAgLmtleSA9IElMTEVHQUxfUkVRVUVTVCwgLmFzYyA9IDB4
MjQsIC5hc2NxID0gMHgwMCwKKyAgICAuZGVzY3IgPSAiSU5WQUxJRCBGSUVMRCBJTiBDREIiCit9
OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX0lOVkFMSURfUEFSQU1fRklFTEQg
PSB7CisgICAgLmtleSA9IElMTEVHQUxfUkVRVUVTVCwgLmFzYyA9IDB4MjYsIC5hc2NxID0gMHgw
MCwKKyAgICAuZGVzY3IgPSAiSU5WQUxJRCBGSUVMRCBJTiBQQVJBTUVURVIgTElTVCIKK307CisK
K2NvbnN0IFNjc2lTaG9ydFNlbnNlIHNlbnNlX2NvZGVfSU5WQUxJRF9QQVJBTV9MRU4gPSB7Cisg
ICAgLmtleSA9IElMTEVHQUxfUkVRVUVTVCwgLmFzYyA9IDB4MWEsIC5hc2NxID0gMHgwMCwKKyAg
ICAuZGVzY3IgPSAiUEFSQU1FVEVSIExJU1QgTEVOR1RIIEVSUk9SIgorfTsKKworY29uc3QgU2Nz
aVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9MVU5fTk9UX1NVUFBPUlRFRCA9IHsKKyAgICAua2V5ID0g
SUxMRUdBTF9SRVFVRVNULCAuYXNjID0gMHgyNSwgLmFzY3EgPSAweDAwLAorICAgIC5kZXNjciA9
ICJMT0dJQ0FMIFVOSVQgTk9UIFNVUFBPUlRFRCIKK307CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNl
IHNlbnNlX2NvZGVfU0FWSU5HX1BBUkFNU19OT1RfU1VQUE9SVEVEID0geworICAgIC5rZXkgPSBJ
TExFR0FMX1JFUVVFU1QsIC5hc2MgPSAweDM5LCAuYXNjcSA9IDB4MDAsCisgICAgLmRlc2NyID0g
IlNBVklORyBQQVJBTUVURVJTIE5PVCBTVVBQT1JURUQiCit9OworCitjb25zdCBTY3NpU2hvcnRT
ZW5zZSBzZW5zZV9jb2RlX0lOQ09NUEFUSUJMRV9NRURJVU0gPSB7CisgICAgLmtleSA9IElMTEVH
QUxfUkVRVUVTVCwgLmFzYyA9IDB4MzAsIC5hc2NxID0gMHgwMCwKKyAgICAuZGVzY3IgPSAiSU5D
T01QQVRJQkxFIE1FRElVTSBJTlNUQUxMRUQiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBz
ZW5zZV9jb2RlX01FRElVTV9SRU1PVkFMX1BSRVZFTlRFRCA9IHsKKyAgICAua2V5ID0gSUxMRUdB
TF9SRVFVRVNULCAuYXNjID0gMHg1MywgLmFzY3EgPSAweDAyLAorICAgIC5kZXNjciA9ICJNRURJ
VU0gUkVNT1ZBTCBQUkVWRU5URUQiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9j
b2RlX1BBUkFNRVRFUlNfQ0hBTkdFRCA9IHsKKyAgICAua2V5ID0gVU5JVF9BVFRFTlRJT04sIC5h
c2MgPSAweDJhLCAuYXNjcSA9IDB4MDAsCisgICAgLmRlc2NyID0gIlBBUkFNRVRFUlMgQ0hBTkdF
RCIKK307CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNlIHNlbnNlX2NvZGVfUE9XRVJfT05fUkVTRVQg
PSB7CisgICAgLmtleSA9IFVOSVRfQVRURU5USU9OLCAuYXNjID0gMHgyOSwgLmFzY3EgPSAweDAw
LAorICAgIC5kZXNjciA9ICJQT1dFUiBPTiwgUkVTRVQsIE9SIEJVUyBERVZJQ0UgUkVTRVQiCit9
OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX1NDU0lfQlVTX1JFU0VUID0gewor
ICAgIC5rZXkgPSBVTklUX0FUVEVOVElPTiwgLmFzYyA9IDB4MjksIC5hc2NxID0gMHgwMiwKKyAg
ICAuZGVzY3IgPSAiU0NTSSBCVVMgUkVTRVQiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBz
ZW5zZV9jb2RlX1VBX05PX01FRElVTSA9IHsKKyAgICAua2V5ID0gVU5JVF9BVFRFTlRJT04sIC5h
c2MgPSAweDNhLCAuYXNjcSA9IDB4MDAsCisgICAgLmRlc2NyID0gIk1FRElVTSBOT1QgUFJFU0VO
VCIKK307CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNlIHNlbnNlX2NvZGVfTUVESVVNX0NIQU5HRUQg
PSB7CisgICAgLmtleSA9IFVOSVRfQVRURU5USU9OLCAuYXNjID0gMHgyOCwgLmFzY3EgPSAweDAw
LAorICAgIC5kZXNjciA9ICJNRURJVU0gQ0hBTkdFRCIKK307CisKK2NvbnN0IFNjc2lTaG9ydFNl
bnNlIHNlbnNlX2NvZGVfUkVQT1JURURfTFVOU19DSEFOR0VEID0geworICAgIC5rZXkgPSBVTklU
X0FUVEVOVElPTiwgLmFzYyA9IDB4M2YsIC5hc2NxID0gMHgwZSwKKyAgICAuZGVzY3IgPSAiUkVQ
T1JURUQgTFVOUyBDSEFOR0VEIgorfTsKKworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29k
ZV9ERVZJQ0VfSU5URVJOQUxfUkVTRVQgPSB7CisgICAgLmtleSA9IFVOSVRfQVRURU5USU9OLCAu
YXNjID0gMHgyOSwgLmFzY3EgPSAweDA0LAorICAgIC5kZXNjciA9ICJERVZJQ0UgSU5URVJOQUwg
UkVTRVQiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX1VOSVRfQVRURU5U
SU9OX01FRElVTV9SRU1PVkFMX1JFUVVFU1QgPSB7CisgICAgLmtleSA9IFVOSVRfQVRURU5USU9O
LCAuYXNjID0gMHg1YSwgLmFzY3EgPSAweDAxLAorICAgIC5kZXNjciA9ICJPUEVSQVRPUiBNRURJ
VU0gUkVNT1ZBTCBSRVFVRVNUIgorfTsKKworc3RhdGljIGlubGluZSBnYm9vbGVhbiBjZF9zY3Np
X29wY29kZV91YV9zdXByZXNzKHVpbnQzMl90IG9wY29kZSkKK3sKKyAgICBzd2l0Y2ggKG9wY29k
ZSkgeworICAgIGNhc2UgSU5RVUlSWToKKyAgICBjYXNlIFJFUE9SVF9MVU5TOgorICAgIGNhc2Ug
R0VUX0NPTkZJR1VSQVRJT046CisgICAgY2FzZSBHRVRfRVZFTlRfU1RBVFVTX05PVElGSUNBVElP
TjoKKyAgICBjYXNlIFJFUVVFU1RfU0VOU0U6CisgICAgICAgIHJldHVybiBUUlVFOworICAgIGRl
ZmF1bHQ6CisgICAgICAgIHJldHVybiBGQUxTRTsKKyAgICB9Cit9CisKK3N0YXRpYyBpbmxpbmUg
Y29uc3QgY2hhciAqQ2RTY3NpUmVxU3RhdGVfc3RyKENkU2NzaVJlcVN0YXRlIHN0YXRlKQorewor
ICAgIHN3aXRjaChzdGF0ZSkgeworICAgIGNhc2UgU0NTSV9SRVFfSURMRToKKyAgICAgICAgcmV0
dXJuICJJRExFIjsKKyAgICBjYXNlIFNDU0lfUkVRX1JVTk5JTkc6CisgICAgICAgIHJldHVybiAi
UlVOTklORyI7CisgICAgY2FzZSBTQ1NJX1JFUV9DT01QTEVURToKKyAgICAgICAgcmV0dXJuICJD
T01QTEVURSI7CisgICAgY2FzZSBTQ1NJX1JFUV9DQU5DRUxFRDoKKyAgICAgICAgcmV0dXJuICJD
QU5DRUxFRCI7CisgICAgZGVmYXVsdDoKKyAgICAgICAgcmV0dXJuICJJTExFR0FMIjsKKyAgICB9
Cit9CisKK3N0YXRpYyBjb25zdCBjaGFyICpjZF9zY3NpX3NlbnNlX2tleV9kZXNjcih1aW50OF90
IHNlbnNlX2tleSkKK3sKKyAgICBzd2l0Y2goc2Vuc2Vfa2V5KSB7CisgICAgY2FzZSBOT19TRU5T
RToKKyAgICAgICAgcmV0dXJuICJOTyBTRU5TRSI7CisgICAgY2FzZSBSRUNPVkVSRURfRVJST1I6
CisgICAgICAgIHJldHVybiAiUkVDT1ZFUkVEIEVSUk9SIjsKKyAgICBjYXNlIE5PVF9SRUFEWToK
KyAgICAgICAgcmV0dXJuICJMVU4gTk9UIFJFQURZIjsKKyAgICBjYXNlIE1FRElVTV9FUlJPUjoK
KyAgICAgICAgcmV0dXJuICJNRURJVU0gRVJST1IiOworICAgIGNhc2UgSEFSRFdBUkVfRVJST1I6
CisgICAgICAgIHJldHVybiAiSEFSRFdBUkUgRVJST1IiOworICAgIGNhc2UgSUxMRUdBTF9SRVFV
RVNUOgorICAgICAgICByZXR1cm4gIklMTEVHQUwgUkVRVUVTVCI7CisgICAgY2FzZSBVTklUX0FU
VEVOVElPTjoKKyAgICAgICAgcmV0dXJuICJVTklUIEFUVEVOVElPTiI7CisgICAgY2FzZSBCTEFO
S19DSEVDSzoKKyAgICAgICAgcmV0dXJuICJCTEFOSyBDSEVDSyI7CisgICAgY2FzZSBBQk9SVEVE
X0NPTU1BTkQ6CisgICAgICAgIHJldHVybiAiQUJPUlRFRCBDT01NQU5EIjsKKyAgICBkZWZhdWx0
OgorICAgICAgICByZXR1cm4gIj8/PyI7CisgICAgfQorfQorc3RhdGljIHVpbnQzMl90IGNkX3Nj
c2lfYnVpbGRfZml4ZWRfc2Vuc2UodWludDhfdCAqYnVmLCBjb25zdCBTY3NpU2hvcnRTZW5zZSAq
c2hvcnRfc2Vuc2UpCit7CisgICAgbWVtc2V0KGJ1ZiwgMCwgRklYRURfU0VOU0VfTEVOKTsKKwor
ICAgIGJ1ZlswXSA9IEZJWEVEX1NFTlNFX0NVUlJFTlQ7CisgICAgYnVmWzJdID0gc2hvcnRfc2Vu
c2UtPmtleTsKKyAgICBidWZbN10gPSAxMDsKKyAgICBidWZbMTJdID0gc2hvcnRfc2Vuc2UtPmFz
YzsKKyAgICBidWZbMTNdID0gc2hvcnRfc2Vuc2UtPmFzY3E7CisKKyAgICByZXR1cm4gRklYRURf
U0VOU0VfTEVOOworfQorCitzdGF0aWMgaW5saW5lIHZvaWQgY2Rfc2NzaV9yZXFfaW5pdChDZFNj
c2lSZXF1ZXN0ICpyZXEpCit7CisgICAgcmVxLT5yZXFfc3RhdGUgPSBTQ1NJX1JFUV9JRExFOwor
ICAgIHJlcS0+eGZlcl9kaXIgPSBTQ1NJX1hGRVJfTk9ORTsKKyAgICByZXEtPnByaXZfZGF0YSA9
IE5VTEw7CisgICAgcmVxLT5pbl9sZW4gPSAwOworICAgIHJlcS0+c3RhdHVzID0gR09PRDsKK30K
Kworc3RhdGljIGlubGluZSB2b2lkIGNkX3Njc2lfZGV2X3NlbnNlX3Jlc2V0KENkU2NzaUxVICpk
ZXYpCit7CisgICAgbWVtc2V0KCZkZXYtPnNob3J0X3NlbnNlLCAwLCBzaXplb2YoZGV2LT5zaG9y
dF9zZW5zZSkpOworICAgIGNkX3Njc2lfYnVpbGRfZml4ZWRfc2Vuc2UoZGV2LT5maXhlZF9zZW5z
ZSwgJmRldi0+c2hvcnRfc2Vuc2UpOworfQorCitzdGF0aWMgaW5saW5lIHZvaWQgY2Rfc2NzaV9k
ZXZfc2Vuc2Vfc2V0KENkU2NzaUxVICpkZXYsIGNvbnN0IFNjc2lTaG9ydFNlbnNlICpzaG9ydF9z
ZW5zZSkKK3sKKyAgICBpZiAoc2hvcnRfc2Vuc2UgIT0gTlVMTCkgeworICAgICAgICAvKiBjb3B5
IHNob3J0IHNlbnNlIGFuZCBnZW5lcmF0ZSBmdWxsIHNlbnNlIGluIGZpeGVkIGZvcm1hdCAqLwor
ICAgICAgICBkZXYtPnNob3J0X3NlbnNlID0gKnNob3J0X3NlbnNlOworICAgICAgICBjZF9zY3Np
X2J1aWxkX2ZpeGVkX3NlbnNlKGRldi0+Zml4ZWRfc2Vuc2UsIHNob3J0X3NlbnNlKTsKKyAgICB9
Cit9CisKK3N0YXRpYyBpbmxpbmUgdm9pZCBjZF9zY3NpX2Rldl9zZW5zZV9zZXRfcG93ZXJfb24o
Q2RTY3NpTFUgKmRldikKK3sKKyAgICBjZF9zY3NpX2Rldl9zZW5zZV9zZXQoZGV2LCAmc2Vuc2Vf
Y29kZV9QT1dFUl9PTl9SRVNFVCk7Cit9CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX2NvbXBs
ZXRlX2NoZWNrX2NvbmQoQ2RTY3NpTFUgKmRldiwgQ2RTY3NpUmVxdWVzdCAqcmVxLAorICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBTY3NpU2hvcnRTZW5z
ZSAqc2hvcnRfc2Vuc2UpCit7CisgICAgcmVxLT5yZXFfc3RhdGUgPSBTQ1NJX1JFUV9DT01QTEVU
RTsKKyAgICByZXEtPnN0YXR1cyA9IENIRUNLX0NPTkRJVElPTjsKKyAgICByZXEtPmluX2xlbiA9
IDA7CisKKyAgICBjZF9zY3NpX2Rldl9zZW5zZV9zZXQoZGV2LCBzaG9ydF9zZW5zZSk7CisKKyAg
ICBTUElDRV9ERUJVRygiQ0hFQ0tfQ09ORCwgcmVxdWVzdCBsdW46JXUiCisgICAgICAgICAgICAg
ICAgIiBvcDogMHglMDJ4LCBwZW5kaW5nIHNlbnNlOiAweCUwMnggJTAyeCAlMDJ4IC0gJXMsICVz
IiwKKyAgICAgICAgICAgICAgICBkZXYtPmx1biwgKHVpbnQzMl90KXJlcS0+Y2RiWzBdLAorICAg
ICAgICAgICAgICAgICh1aW50MzJfdClkZXYtPnNob3J0X3NlbnNlLmtleSwKKyAgICAgICAgICAg
ICAgICAodWludDMyX3QpZGV2LT5zaG9ydF9zZW5zZS5hc2MsCisgICAgICAgICAgICAgICAgKHVp
bnQzMl90KWRldi0+c2hvcnRfc2Vuc2UuYXNjcSwKKyAgICAgICAgICAgICAgICBjZF9zY3NpX3Nl
bnNlX2tleV9kZXNjcihkZXYtPnNob3J0X3NlbnNlLmtleSksCisgICAgICAgICAgICAgICAgZGV2
LT5zaG9ydF9zZW5zZS5kZXNjcik7Cit9CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX2NvbXBs
ZXRlX2dvb2QoQ2RTY3NpTFUgKmRldiwgQ2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAgIHJlcS0+
cmVxX3N0YXRlID0gU0NTSV9SRVFfQ09NUExFVEU7CisgICAgcmVxLT5zdGF0dXMgPSBHT09EOwor
fQorCisvKiBTQ1NJIFRhcmdldCAqLworCitTUElDRV9DT05TVFJVQ1RPUl9GVU5DKGNkX3Njc2lf
Y21kX25hbWVzX2luaXQpCit7CisgICAgdWludDMyX3Qgb3Bjb2RlOworCisgICAgZm9yIChvcGNv
ZGUgPSAwOyBvcGNvZGUgPCAyNTY7IG9wY29kZSsrKSB7CisgICAgICAgIHNjc2lfY21kX25hbWVb
b3Bjb2RlXSA9ICJVTlNVUFBPUlRFRCI7CisgICAgfQorCisgICAgc2NzaV9jbWRfbmFtZVtSRVBP
UlRfTFVOU10gPSAiUkVQT1JUIExVTlMiOworICAgIHNjc2lfY21kX25hbWVbVEVTVF9VTklUX1JF
QURZXSA9ICJURVNUIFVOSVQgUkVBRFkiOworICAgIHNjc2lfY21kX25hbWVbSU5RVUlSWV0gPSAi
SU5RVUlSWSI7CisgICAgc2NzaV9jbWRfbmFtZVtSRVFVRVNUX1NFTlNFXSA9ICJSRVFVRVNUIFNF
TlNFIjsKKyAgICBzY3NpX2NtZF9uYW1lW1JFQURfNl0gPSAiUkVBRCg2KSI7CisgICAgc2NzaV9j
bWRfbmFtZVtSRUFEXzEwXSA9ICJSRUFEKDEwKSI7CisgICAgc2NzaV9jbWRfbmFtZVtSRUFEXzEy
XSA9ICJSRUFEKDEyKSI7CisgICAgc2NzaV9jbWRfbmFtZVtSRUFEXzE2XSA9ICJSRUFEKDE2KSI7
CisgICAgc2NzaV9jbWRfbmFtZVtSRUFEX0NBUEFDSVRZXzEwXSA9ICJSRUFEIENBUEFDSVRZKDEw
KSI7CisgICAgc2NzaV9jbWRfbmFtZVtSRUFEX1RPQ10gPSAiUkVBRCBUT0MiOworICAgIHNjc2lf
Y21kX25hbWVbR0VUX0VWRU5UX1NUQVRVU19OT1RJRklDQVRJT05dID0gIkdFVCBFVkVOVC9TVEFU
VVMgTk9USUZJQ0FUSU9OIjsKKyAgICBzY3NpX2NtZF9uYW1lW1JFQURfRElTQ19JTkZPUk1BVElP
Tl0gPSAiUkVBRCBESVNDIElORk8iOworICAgIHNjc2lfY21kX25hbWVbUkVBRF9UUkFDS19JTkZP
Uk1BVElPTl0gPSAiUkVBRCBUUkFDSyBJTkZPIjsKKyAgICBzY3NpX2NtZF9uYW1lW01PREVfU0VO
U0VfMTBdID0gIk1PREUgU0VOU0UoMTApIjsKKyAgICBzY3NpX2NtZF9uYW1lW01PREVfU0VMRUNU
XSA9ICJNT0RFIFNFTEVDVCg2KSI7CisgICAgc2NzaV9jbWRfbmFtZVtNT0RFX1NFTEVDVF8xMF0g
PSAiTU9ERSBTRUxFQ1QoMTApIjsKKyAgICBzY3NpX2NtZF9uYW1lW0dFVF9DT05GSUdVUkFUSU9O
XSA9ICJHRVQgQ09ORklHVVJBVElPTiI7CisgICAgc2NzaV9jbWRfbmFtZVtBTExPV19NRURJVU1f
UkVNT1ZBTF0gPSAiUFJFVkVOVCBBTExPVyBNRURJVU0gUkVNT1ZBTCI7CisgICAgc2NzaV9jbWRf
bmFtZVtNTUNfU0VORF9FVkVOVF0gPSAiU0VORCBFVkVOVCI7CisgICAgc2NzaV9jbWRfbmFtZVtN
TUNfUkVQT1JUX0tFWV0gPSAiUkVQT1JUIEtFWSI7CisgICAgc2NzaV9jbWRfbmFtZVtNTUNfU0VO
RF9LRVldID0gIlNFTkRfS0VZIjsKKyAgICBzY3NpX2NtZF9uYW1lW1NUQVJUX1NUT1BdID0gIlNU
QVJUIFNUT1AgVU5JVCI7CisgICAgc2NzaV9jbWRfbmFtZVtNTUNfR0VUX1BFUkZPUk1BTkNFXSA9
ICJHRVQgUEVSRk9STUFOQ0UiOworICAgIHNjc2lfY21kX25hbWVbTU1DX01FQ0hBTklTTV9TVEFU
VVNdID0gIk1FQ0hBTklTTSBTVEFUVVMiOworfQorCitDZFNjc2lUYXJnZXQgKmNkX3Njc2lfdGFy
Z2V0X2FsbG9jKHZvaWQgKnRhcmdldF91c2VyX2RhdGEsIHVpbnQzMl90IG1heF9sdW5zKQorewor
ICAgIENkU2NzaVRhcmdldCAqc3Q7CisKKyAgICBpZiAobWF4X2x1bnMgPT0gMCB8fCBtYXhfbHVu
cyA+IE1BWF9MVU5TKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJBbGxvYywgaWxsZWdhbCBtYXhf
bHVuczoldSIsIG1heF9sdW5zKTsKKyAgICAgICAgcmV0dXJuIE5VTEw7CisgICAgfQorCisgICAg
c3QgPSBnX21hbGxvYzAoc2l6ZW9mKCpzdCkpOworCisgICAgc3QtPnVzZXJfZGF0YSA9IHRhcmdl
dF91c2VyX2RhdGE7CisgICAgc3QtPnN0YXRlID0gQ0RfU0NTSV9UR1RfU1RBVEVfUlVOTklORzsK
KyAgICBzdC0+Y3VyX3JlcSA9IE5VTEw7CisgICAgc3QtPmNhbmNlbGxhYmxlID0gZ19jYW5jZWxs
YWJsZV9uZXcoKTsKKyAgICBzdC0+bWF4X2x1bnMgPSBtYXhfbHVuczsKKworICAgIHJldHVybiBz
dDsKK30KKwordm9pZCBjZF9zY3NpX3RhcmdldF9mcmVlKENkU2NzaVRhcmdldCAqc3QpCit7Cisg
ICAgdWludDMyX3QgbHVuOworCisgICAgY2Rfc2NzaV90YXJnZXRfcmVzZXQoc3QpOworICAgIGZv
ciAobHVuID0gMDsgbHVuIDwgc3QtPm1heF9sdW5zOyBsdW4rKykgeworICAgICAgICBDZFNjc2lM
VSAqdW5pdCA9ICZzdC0+dW5pdHNbbHVuXTsKKyAgICAgICAgaWYgKHVuaXQtPnJlYWxpemVkKSB7
CisgICAgICAgICAgICBjZF9zY3NpX2Rldl91bnJlYWxpemUoc3QsIGx1bik7CisgICAgICAgIH0K
KyAgICAgICAgZ19jbGVhcl9vYmplY3QoJnVuaXQtPnN0cmVhbSk7CisgICAgfQorICAgIGdfY2xl
YXJfb2JqZWN0KCZzdC0+Y2FuY2VsbGFibGUpOworICAgIGdfZnJlZShzdCk7Cit9CisKKy8qIFND
U0kgRGV2aWNlICovCisKK3N0YXRpYyBpbmxpbmUgZ2Jvb2xlYW4gY2Rfc2NzaV90YXJnZXRfbHVu
X2xlZ2FsKGNvbnN0IENkU2NzaVRhcmdldCAqc3QsIHVpbnQzMl90IGx1bikKK3sKKyAgICByZXR1
cm4gKGx1biA8IHN0LT5tYXhfbHVucykgPyBUUlVFIDogRkFMU0U7Cit9CisKK3N0YXRpYyBpbmxp
bmUgZ2Jvb2xlYW4gY2Rfc2NzaV90YXJnZXRfbHVuX3JlYWxpemVkKGNvbnN0IENkU2NzaVRhcmdl
dCAqc3QsIHVpbnQzMl90IGx1bikKK3sKKyAgICByZXR1cm4gc3QtPnVuaXRzW2x1bl0ucmVhbGl6
ZWQ7Cit9CisKK2ludCBjZF9zY3NpX2Rldl9yZWFsaXplKENkU2NzaVRhcmdldCAqc3QsIHVpbnQz
Ml90IGx1biwKKyAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IENkU2NzaURldmljZVBhcmFt
ZXRlcnMgKmRldl9wYXJhbXMpCit7CisgICAgQ2RTY3NpTFUgKmRldjsKKworICAgIGlmICghY2Rf
c2NzaV90YXJnZXRfbHVuX2xlZ2FsKHN0LCBsdW4pKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJS
ZWFsaXplLCBpbGxlZ2FsIGx1bjoldSIsIGx1bik7CisgICAgICAgIHJldHVybiAtMTsKKyAgICB9
CisgICAgaWYgKGNkX3Njc2lfdGFyZ2V0X2x1bl9yZWFsaXplZChzdCwgbHVuKSkgeworICAgICAg
ICBTUElDRV9FUlJPUigiUmVhbGl6ZSwgYWxyZWFkeSByZWFsaXplZCBsdW46JXUiLCBsdW4pOwor
ICAgICAgICByZXR1cm4gLTE7CisgICAgfQorICAgIGRldiA9ICZzdC0+dW5pdHNbbHVuXTsKKwor
ICAgIG1lbXNldChkZXYsIDAsIHNpemVvZigqZGV2KSk7CisgICAgZGV2LT50Z3QgPSBzdDsKKyAg
ICBkZXYtPmx1biA9IGx1bjsKKworICAgIGRldi0+cmVhbGl6ZWQgPSBUUlVFOworICAgIGRldi0+
cmVtb3ZhYmxlID0gVFJVRTsKKyAgICBkZXYtPmxvYWRlZCA9IEZBTFNFOworICAgIGRldi0+cHJl
dmVudF9tZWRpYV9yZW1vdmFsID0gRkFMU0U7CisgICAgZGV2LT5jZF9yb20gPSBGQUxTRTsKKwor
ICAgIGRldi0+cG93ZXJfY29uZCA9IENEX1NDU0lfUE9XRVJfQUNUSVZFOworICAgIGRldi0+cG93
ZXJfZXZlbnQgPSBDRF9QT1dFUl9FVkVOVF9OT19DSEFOR0U7CisgICAgZGV2LT5tZWRpYV9ldmVu
dCA9IENEX01FRElBX0VWRU5UX05PX0NIQU5HRTsKKworICAgIGRldi0+Y2xhaW1fdmVyc2lvbiA9
IDM7IC8qIDAgOiBub25lOyAyLDMsNSA6IFNQQy9NTUMteCAqLworCisgICAgZGV2LT52ZW5kb3Ig
PSBnX3N0cmR1cChkZXZfcGFyYW1zLT52ZW5kb3IpOworICAgIGRldi0+cHJvZHVjdCA9IGdfc3Ry
ZHVwKGRldl9wYXJhbXMtPnByb2R1Y3QpOworICAgIGRldi0+dmVyc2lvbiA9IGdfc3RyZHVwKGRl
dl9wYXJhbXMtPnZlcnNpb24pOworICAgIGRldi0+c2VyaWFsID0gZ19zdHJkdXAoZGV2X3BhcmFt
cy0+c2VyaWFsKTsKKworICAgIGNkX3Njc2lfZGV2X3NlbnNlX3NldF9wb3dlcl9vbihkZXYpOwor
CisgICAgU1BJQ0VfREVCVUcoIlJlYWxpemUgbHVuOiV1IGJzOiV1IFZSOlslc10gUFQ6WyVzXSB2
ZXI6WyVzXSBTTlslc10iLAorICAgICAgICAgICAgICAgIGx1biwgZGV2LT5ibG9ja19zaXplLCBk
ZXYtPnZlbmRvciwKKyAgICAgICAgICAgICAgICBkZXYtPnByb2R1Y3QsIGRldi0+dmVyc2lvbiwg
ZGV2LT5zZXJpYWwpOworICAgIHJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2x1
X21lZGlhX3Jlc2V0KENkU2NzaUxVICpkZXYpCit7CisgICAgLyogbWVkaWFfZXZlbnQgaXMgbm90
IHNldCBoZXJlLCBhcyBpdCBkZXBlbmRzIG9uIHRoZSBjb250ZXh0ICovCisgICAgZ19jbGVhcl9v
YmplY3QoJmRldi0+c3RyZWFtKTsKKyAgICBkZXYtPnNpemUgPSAwOworICAgIGRldi0+YmxvY2tf
c2l6ZSA9IDA7CisgICAgZGV2LT5udW1fYmxvY2tzID0gMDsKK30KKworaW50IGNkX3Njc2lfZGV2
X2xvY2soQ2RTY3NpVGFyZ2V0ICpzdCwgdWludDMyX3QgbHVuLCBnYm9vbGVhbiBsb2NrKQorewor
ICAgIENkU2NzaUxVICpkZXY7CisKKyAgICBpZiAoIWNkX3Njc2lfdGFyZ2V0X2x1bl9sZWdhbChz
dCwgbHVuKSkgeworICAgICAgICBTUElDRV9FUlJPUigiTG9jaywgaWxsZWdhbCBsdW46JXUiLCBs
dW4pOworICAgICAgICByZXR1cm4gLTE7CisgICAgfQorICAgIGlmICghY2Rfc2NzaV90YXJnZXRf
bHVuX3JlYWxpemVkKHN0LCBsdW4pKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJMb2NrLCB1bnJl
YWxpemVkIGx1bjoldSIsIGx1bik7CisgICAgICAgIHJldHVybiAtMTsKKyAgICB9CisgICAgZGV2
ID0gJnN0LT51bml0c1tsdW5dOworICAgIGRldi0+cHJldmVudF9tZWRpYV9yZW1vdmFsID0gbG9j
azsKKyAgICBTUElDRV9ERUJVRygibHVuOiV1ICVzbG9jayIsIGx1biwgbG9jayA/ICJ1biIgOiIi
KTsKKyAgICByZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9sdV9sb2FkKENkU2Nz
aUxVICpkZXYsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgQ2RTY3NpTWVkaWFQ
YXJhbWV0ZXJzICptZWRpYV9wYXJhbXMpCit7CisgICAgaWYgKG1lZGlhX3BhcmFtcyAhPSBOVUxM
KSB7CisgICAgICAgIGRldi0+bWVkaWFfZXZlbnQgPSBDRF9NRURJQV9FVkVOVF9ORVdfTUVESUE7
CisgICAgICAgIGRldi0+c3RyZWFtID0gZ19vYmplY3RfcmVmKG1lZGlhX3BhcmFtcy0+c3RyZWFt
KTsKKyAgICAgICAgZGV2LT5zaXplID0gbWVkaWFfcGFyYW1zLT5zaXplOworICAgICAgICBkZXYt
PmJsb2NrX3NpemUgPSBtZWRpYV9wYXJhbXMtPmJsb2NrX3NpemU7CisgICAgICAgIGRldi0+bnVt
X2Jsb2NrcyA9IG1lZGlhX3BhcmFtcy0+c2l6ZSAvIG1lZGlhX3BhcmFtcy0+YmxvY2tfc2l6ZTsK
KyAgICAgICAgZGV2LT5sb2FkZWQgPSBUUlVFOworICAgIH0gZWxzZSB7CisgICAgICAgIGRldi0+
bWVkaWFfZXZlbnQgPSBDRF9NRURJQV9FVkVOVF9NRURJQV9SRU1PVkFMOworICAgICAgICBjZF9z
Y3NpX2x1X21lZGlhX3Jlc2V0KGRldik7CisgICAgICAgIGRldi0+bG9hZGVkID0gRkFMU0U7Cisg
ICAgfQorfQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2x1X3VubG9hZChDZFNjc2lMVSAqZGV2KQor
eworICAgIGRldi0+bWVkaWFfZXZlbnQgPSBDRF9NRURJQV9FVkVOVF9NRURJQV9SRU1PVkFMOwor
ICAgIGNkX3Njc2lfbHVfbWVkaWFfcmVzZXQoZGV2KTsKKyAgICBkZXYtPmxvYWRlZCA9IEZBTFNF
OworfQorCitpbnQgY2Rfc2NzaV9kZXZfbG9hZChDZFNjc2lUYXJnZXQgKnN0LCB1aW50MzJfdCBs
dW4sCisgICAgICAgICAgICAgICAgICAgICBjb25zdCBDZFNjc2lNZWRpYVBhcmFtZXRlcnMgKm1l
ZGlhX3BhcmFtcykKK3sKKyAgICBDZFNjc2lMVSAqZGV2OworCisgICAgaWYgKCFjZF9zY3NpX3Rh
cmdldF9sdW5fbGVnYWwoc3QsIGx1bikpIHsKKyAgICAgICAgU1BJQ0VfRVJST1IoIkxvYWQsIGls
bGVnYWwgbHVuOiV1IiwgbHVuKTsKKyAgICAgICAgcmV0dXJuIC0xOworICAgIH0KKyAgICBpZiAo
IWNkX3Njc2lfdGFyZ2V0X2x1bl9yZWFsaXplZChzdCwgbHVuKSkgeworICAgICAgICBTUElDRV9F
UlJPUigiTG9hZCwgdW5yZWFsaXplZCBsdW46JXUiLCBsdW4pOworICAgICAgICByZXR1cm4gLTE7
CisgICAgfQorICAgIGRldiA9ICZzdC0+dW5pdHNbbHVuXTsKKworICAgIGNkX3Njc2lfbHVfbG9h
ZChkZXYsIG1lZGlhX3BhcmFtcyk7CisgICAgZGV2LT5wb3dlcl9jb25kID0gQ0RfU0NTSV9QT1dF
Ul9BQ1RJVkU7CisgICAgZGV2LT5wb3dlcl9ldmVudCA9IENEX1BPV0VSX0VWRU5UX0NIQU5HRV9T
VUNDRVNTOworCisgICAgY2Rfc2NzaV9kZXZfc2Vuc2Vfc2V0KGRldiwgJnNlbnNlX2NvZGVfTUVE
SVVNX0NIQU5HRUQpOworCisgICAgU1BJQ0VfREVCVUcoIkxvYWQgbHVuOiV1IHNpemU6JSIgR19H
VUlOVDY0X0ZPUk1BVAorICAgICAgICAgICAgICAgICIgYmxrX3N6OiV1IG51bV9ibG9ja3M6JXUi
LAorICAgICAgICAgICAgICAgIGx1biwgZGV2LT5zaXplLCBkZXYtPmJsb2NrX3NpemUsIGRldi0+
bnVtX2Jsb2Nrcyk7CisgICAgcmV0dXJuIDA7Cit9CisKK2ludCBjZF9zY3NpX2Rldl9nZXRfaW5m
byhDZFNjc2lUYXJnZXQgKnN0LCB1aW50MzJfdCBsdW4sIENkU2NzaURldmljZUluZm8gKmx1bl9p
bmZvKQoreworICAgIENkU2NzaUxVICpkZXY7CisKKyAgICBpZiAoIWNkX3Njc2lfdGFyZ2V0X2x1
bl9sZWdhbChzdCwgbHVuKSkgeworICAgICAgICBTUElDRV9FUlJPUigiTG9hZCwgaWxsZWdhbCBs
dW46JXUiLCBsdW4pOworICAgICAgICByZXR1cm4gLTE7CisgICAgfQorICAgIGlmICghY2Rfc2Nz
aV90YXJnZXRfbHVuX3JlYWxpemVkKHN0LCBsdW4pKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJM
b2FkLCB1bnJlYWxpemVkIGx1bjoldSIsIGx1bik7CisgICAgICAgIHJldHVybiAtMTsKKyAgICB9
CisgICAgZGV2ID0gJnN0LT51bml0c1tsdW5dOworCisgICAgbHVuX2luZm8tPnN0YXJ0ZWQgPSBk
ZXYtPnBvd2VyX2NvbmQgPT0gQ0RfU0NTSV9QT1dFUl9BQ1RJVkU7CisgICAgbHVuX2luZm8tPmxv
Y2tlZCA9IGRldi0+cHJldmVudF9tZWRpYV9yZW1vdmFsOworICAgIGx1bl9pbmZvLT5sb2FkZWQg
PSBkZXYtPmxvYWRlZDsKKworICAgIGx1bl9pbmZvLT5wYXJhbWV0ZXJzLnZlbmRvciA9IGRldi0+
dmVuZG9yOworICAgIGx1bl9pbmZvLT5wYXJhbWV0ZXJzLnByb2R1Y3QgPSBkZXYtPnByb2R1Y3Q7
CisgICAgbHVuX2luZm8tPnBhcmFtZXRlcnMudmVyc2lvbiA9IGRldi0+dmVyc2lvbjsKKyAgICBs
dW5faW5mby0+cGFyYW1ldGVycy5zZXJpYWwgPSBkZXYtPnNlcmlhbDsKKworICAgIHJldHVybiAw
OworfQorCitpbnQgY2Rfc2NzaV9kZXZfdW5sb2FkKENkU2NzaVRhcmdldCAqc3QsIHVpbnQzMl90
IGx1bikKK3sKKyAgICBDZFNjc2lMVSAqZGV2OworCisgICAgaWYgKCFjZF9zY3NpX3RhcmdldF9s
dW5fbGVnYWwoc3QsIGx1bikpIHsKKyAgICAgICAgU1BJQ0VfRVJST1IoIlVubG9hZCwgaWxsZWdh
bCBsdW46JXUiLCBsdW4pOworICAgICAgICByZXR1cm4gLTE7CisgICAgfQorICAgIGlmICghY2Rf
c2NzaV90YXJnZXRfbHVuX3JlYWxpemVkKHN0LCBsdW4pKSB7CisgICAgICAgIFNQSUNFX0VSUk9S
KCJVbmxvYWQsIHVucmVhbGl6ZWQgbHVuOiV1IiwgbHVuKTsKKyAgICAgICAgcmV0dXJuIC0xOwor
ICAgIH0KKyAgICBkZXYgPSAmc3QtPnVuaXRzW2x1bl07CisgICAgaWYgKCFkZXYtPmxvYWRlZCkg
eworICAgICAgICBTUElDRV9FUlJPUigiVW5sb2FkLCBsdW46JXUgbm90IGxvYWRlZCB5ZXQiLCBs
dW4pOworICAgICAgICByZXR1cm4gMDsKKyAgICB9CisgICAgaWYgKGRldi0+cHJldmVudF9tZWRp
YV9yZW1vdmFsKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJVbmxvYWQsIGx1bjoldSBwcmV2ZW50
X21lZGlhX3JlbW92YWwgc2V0IiwgbHVuKTsKKyAgICAgICAgcmV0dXJuIC0xOworICAgIH0KKwor
ICAgIGNkX3Njc2lfbHVfdW5sb2FkKGRldik7CisgICAgZGV2LT5wb3dlcl9jb25kID0gQ0RfU0NT
SV9QT1dFUl9TVE9QUEVEOworICAgIGRldi0+cG93ZXJfZXZlbnQgPSBDRF9QT1dFUl9FVkVOVF9D
SEFOR0VfU1VDQ0VTUzsKKworICAgIGNkX3Njc2lfZGV2X3NlbnNlX3NldChkZXYsICZzZW5zZV9j
b2RlX1VBX05PX01FRElVTSk7CisKKyAgICBTUElDRV9ERUJVRygiVW5sb2FkIGx1bjoldSIsIGx1
bik7CisgICAgcmV0dXJuIDA7Cit9CisKK2ludCBjZF9zY3NpX2Rldl91bnJlYWxpemUoQ2RTY3Np
VGFyZ2V0ICpzdCwgdWludDMyX3QgbHVuKQoreworICAgIENkU2NzaUxVICpkZXY7CisKKyAgICBp
ZiAoIWNkX3Njc2lfdGFyZ2V0X2x1bl9sZWdhbChzdCwgbHVuKSkgeworICAgICAgICBTUElDRV9F
UlJPUigiVW5yZWFsaXplLCBpbGxlZ2FsIGx1bjoldSIsIGx1bik7CisgICAgICAgIHJldHVybiAt
MTsKKyAgICB9CisgICAgaWYgKCFjZF9zY3NpX3RhcmdldF9sdW5fcmVhbGl6ZWQoc3QsIGx1bikp
IHsKKyAgICAgICAgU1BJQ0VfRVJST1IoIlVucmVhbGl6ZSwgYWJzZW50IGx1bjoldSIsIGx1bik7
CisgICAgICAgIHJldHVybiAtMTsKKyAgICB9CisgICAgZGV2ID0gJnN0LT51bml0c1tsdW5dOwor
CisgICAgZ19jbGVhcl9wb2ludGVyKCZkZXYtPnZlbmRvciwgZ19mcmVlKTsKKyAgICBnX2NsZWFy
X3BvaW50ZXIoJmRldi0+cHJvZHVjdCwgZ19mcmVlKTsKKyAgICBnX2NsZWFyX3BvaW50ZXIoJmRl
di0+dmVyc2lvbiwgZ19mcmVlKTsKKyAgICBnX2NsZWFyX3BvaW50ZXIoJmRldi0+c2VyaWFsLCBn
X2ZyZWUpOworCisgICAgZ19jbGVhcl9vYmplY3QoJmRldi0+c3RyZWFtKTsKKworICAgIGRldi0+
bG9hZGVkID0gRkFMU0U7CisgICAgZGV2LT5yZWFsaXplZCA9IEZBTFNFOworICAgIGRldi0+cG93
ZXJfY29uZCA9IENEX1NDU0lfUE9XRVJfU1RPUFBFRDsKKworICAgIFNQSUNFX0RFQlVHKCJVbnJl
YWxpemUgbHVuOiV1IiwgbHVuKTsKKyAgICByZXR1cm4gMDsKK30KKworaW50IGNkX3Njc2lfZGV2
X3Jlc2V0KENkU2NzaVRhcmdldCAqc3QsIHVpbnQzMl90IGx1bikKK3sKKyAgICBDZFNjc2lMVSAq
ZGV2OworCisgICAgaWYgKCFjZF9zY3NpX3RhcmdldF9sdW5fbGVnYWwoc3QsIGx1bikpIHsKKyAg
ICAgICAgU1BJQ0VfRVJST1IoIkRldmljZSByZXNldCwgaWxsZWdhbCBsdW46JXUiLCBsdW4pOwor
ICAgICAgICByZXR1cm4gLTE7CisgICAgfQorICAgIGlmICghY2Rfc2NzaV90YXJnZXRfbHVuX3Jl
YWxpemVkKHN0LCBsdW4pKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJEZXZpY2UgcmVzZXQsIGFi
c2VudCBsdW46JXUiLCBsdW4pOworICAgICAgICByZXR1cm4gLTE7CisgICAgfQorICAgIGRldiA9
ICZzdC0+dW5pdHNbbHVuXTsKKworICAgIC8qIGlmIHdlIHJlc2V0IHRoZSAncHJldmVudCcgZmxh
ZyB3ZSBjYW4ndCBjcmVhdGUKKyAgICAgKiB0aGUgdW5pdCB0aGF0IGlzIGxvY2tlZCBmcm9tIHRo
ZSBiZWdpbm5pbmcsIHNvCisgICAgICogd2Uga2VlcCB0aGlzIGZsYWcgYXMgcGVyc2lzdGVudCBv
dmVyIHJlc2V0cworICAgICAqLworICAgIC8qIGRldi0+cHJldmVudF9tZWRpYV9yZW1vdmFsID0g
RkFMU0U7ICovCisgICAgZGV2LT5wb3dlcl9jb25kID0gQ0RfU0NTSV9QT1dFUl9BQ1RJVkU7Cisg
ICAgZGV2LT5wb3dlcl9ldmVudCA9IENEX1BPV0VSX0VWRU5UX0NIQU5HRV9TVUNDRVNTOworICAg
IGNkX3Njc2lfZGV2X3NlbnNlX3NldF9wb3dlcl9vbihkZXYpOworCisgICAgU1BJQ0VfREVCVUco
IkRldmljZSByZXNldCBsdW46JXUiLCBsdW4pOworICAgIHJldHVybiAwOworfQorCitzdGF0aWMg
dm9pZCBjZF9zY3NpX3RhcmdldF9kb19yZXNldChDZFNjc2lUYXJnZXQgKnN0KQoreworICAgIHVp
bnQzMl90IGx1bjsKKworICAgIGZvciAobHVuID0gMDsgbHVuIDwgc3QtPm1heF9sdW5zOyBsdW4r
KykgeworICAgICAgICBpZiAoc3QtPnVuaXRzW2x1bl0ucmVhbGl6ZWQpIHsKKyAgICAgICAgICAg
IGNkX3Njc2lfZGV2X3Jlc2V0KHN0LCBsdW4pOworICAgICAgICB9CisgICAgfQorCisgICAgU1BJ
Q0VfREVCVUcoIlRhcmdldCByZXNldCBjb21wbGV0ZSIpOworICAgIHN0LT5zdGF0ZSA9IENEX1ND
U0lfVEdUX1NUQVRFX1JVTk5JTkc7CisgICAgY2Rfc2NzaV90YXJnZXRfcmVzZXRfY29tcGxldGUo
c3QtPnVzZXJfZGF0YSk7Cit9CisKK2ludCBjZF9zY3NpX3RhcmdldF9yZXNldChDZFNjc2lUYXJn
ZXQgKnN0KQoreworICAgIGlmIChzdC0+c3RhdGUgPT0gQ0RfU0NTSV9UR1RfU1RBVEVfUkVTRVQp
IHsKKyAgICAgICAgU1BJQ0VfREVCVUcoIlRhcmdldCBhbHJlYWR5IGluIHJlc2V0Iik7CisgICAg
ICAgIHJldHVybiAtMTsKKyAgICB9CisKKyAgICBzdC0+c3RhdGUgPSBDRF9TQ1NJX1RHVF9TVEFU
RV9SRVNFVDsKKworICAgIGlmIChzdC0+Y3VyX3JlcSAhPSBOVUxMKSB7CisgICAgICAgIGNkX3Nj
c2lfZGV2X3JlcXVlc3RfY2FuY2VsKHN0LCBzdC0+Y3VyX3JlcSk7CisgICAgICAgIGlmIChzdC0+
Y3VyX3JlcSAhPSBOVUxMKSB7CisgICAgICAgICAgICBTUElDRV9ERUJVRygiVGFyZ2V0IHJlc2V0
IGluIHByb2dyZXNzLi4uIik7CisgICAgICAgICAgICByZXR1cm4gMDsKKyAgICAgICAgfQorICAg
IH0KKworICAgIGNkX3Njc2lfdGFyZ2V0X2RvX3Jlc2V0KHN0KTsKKyAgICByZXR1cm4gMDsKK30K
KworQ2RTY3NpUmVxU3RhdGUgY2Rfc2NzaV9nZXRfcmVxX3N0YXRlKENkU2NzaVJlcXVlc3QgKnJl
cSkKK3sKKyAgICByZXR1cm4gcmVxLT5yZXFfc3RhdGU7Cit9CisKK3N0YXRpYyB2b2lkIHN0cnBh
ZGNweShjaGFyICpidWYsIGludCBidWZfc2l6ZSwgY29uc3QgY2hhciAqc3RyLCBjaGFyIHBhZCkK
K3sKKyAgICBpbnQgbGVuID0gc3RybmxlbihzdHIsIGJ1Zl9zaXplKTsKKyAgICBtZW1jcHkoYnVm
LCBzdHIsIGxlbik7CisgICAgbWVtc2V0KGJ1ZiArIGxlbiwgcGFkLCBidWZfc2l6ZSAtIGxlbik7
Cit9CisKKy8qIFNDU0kgQ0RCICovCisKK3N0YXRpYyB1bnNpZ25lZCBpbnQgc2NzaV9jZGJfbGVu
Z3RoKGNvbnN0IHVpbnQ4X3QgKmNkYikKK3sKKyAgICB1bnNpZ25lZCBpbnQgY2RiX2xlbjsKKwor
ICAgIHN3aXRjaCAoY2RiWzBdID4+IDUpIHsKKyAgICBjYXNlIDA6CisgICAgICAgIGNkYl9sZW4g
PSA2OworICAgICAgICBicmVhazsKKyAgICBjYXNlIDE6CisgICAgY2FzZSAyOgorICAgICAgICBj
ZGJfbGVuID0gMTA7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgNDoKKyAgICAgICAgY2RiX2xl
biA9IDE2OworICAgICAgICBicmVhazsKKyAgICBjYXNlIDU6CisgICAgICAgIGNkYl9sZW4gPSAx
MjsKKyAgICAgICAgYnJlYWs7CisgICAgZGVmYXVsdDoKKyAgICAgICAgY2RiX2xlbiA9IDA7Cisg
ICAgfQorICAgIHJldHVybiBjZGJfbGVuOworfQorCitzdGF0aWMgdWludDY0X3Qgc2NzaV9jZGJf
bGJhKGNvbnN0IHVpbnQ4X3QgKmNkYiwgaW50IGNkYl9sZW4pCit7CisgICAgdWludDY0X3QgbGJh
OworCisgICAgc3dpdGNoIChjZGJfbGVuKSB7CisgICAgY2FzZSA2OgorICAgICAgICBsYmEgPSAo
KCh1aW50NjRfdCkoY2RiWzFdICYgMHgxZikpIDw8IDE2KSB8CisgICAgICAgICAgICAgICgoKHVp
bnQ2NF90KWNkYlsyXSkgPDwgOCkgfAorICAgICAgICAgICAgICAgKCh1aW50NjRfdCljZGJbM10p
OworICAgICAgICBicmVhazsKKyAgICBjYXNlIDEwOgorICAgIGNhc2UgMTI6CisgICAgICAgIGxi
YSA9ICgoKHVpbnQ2NF90KWNkYlsyXSkgPDwgMjQpIHwKKyAgICAgICAgICAgICAgKCgodWludDY0
X3QpY2RiWzNdKSA8PCAxNikgfAorICAgICAgICAgICAgICAoKCh1aW50NjRfdCljZGJbNF0pIDw8
IDgpICB8CisgICAgICAgICAgICAgICAoKHVpbnQ2NF90KWNkYls1XSk7CisgICAgICAgIGJyZWFr
OworICAgIGNhc2UgMTY6CisgICAgICAgIGxiYSA9ICgoKHVpbnQ2NF90KWNkYlsyXSkgPDwgNTYp
IHwKKyAgICAgICAgICAgICAgKCgodWludDY0X3QpY2RiWzNdKSA8PCA0OCkgfAorICAgICAgICAg
ICAgICAoKCh1aW50NjRfdCljZGJbNF0pIDw8IDQwKSB8CisgICAgICAgICAgICAgICgoKHVpbnQ2
NF90KWNkYls1XSkgPDwgMzIpIHwKKyAgICAgICAgICAgICAgKCgodWludDY0X3QpY2RiWzZdKSA8
PCAyNCkgfAorICAgICAgICAgICAgICAoKCh1aW50NjRfdCljZGJbN10pIDw8IDE2KSB8CisgICAg
ICAgICAgICAgICgoKHVpbnQ2NF90KWNkYls4XSkgPDwgOCkgIHwKKyAgICAgICAgICAgICAgICgo
dWludDY0X3QpY2RiWzldKTsKKyAgICAgICAgYnJlYWs7CisgICAgZGVmYXVsdDoKKyAgICAgICAg
bGJhID0gMDsKKyAgICB9CisgICAgcmV0dXJuIGxiYTsKK30KKworc3RhdGljIHVpbnQzMl90IHNj
c2lfY2RiX3hmZXJfbGVuZ3RoKGNvbnN0IHVpbnQ4X3QgKmNkYiwgaW50IGNkYl9sZW4pCit7Cisg
ICAgdWludDMyX3QgbGVuOworCisgICAgc3dpdGNoIChjZGJfbGVuKSB7CisgICAgY2FzZSA2Ogor
ICAgICAgICBsZW4gPSAodWludDMyX3QpY2RiWzRdOworICAgICAgICBpZiAobGVuID09IDApCisg
ICAgICAgICAgICBsZW4gPSAyNTY7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgMTA6CisgICAg
ICAgIGxlbiA9ICgoKHVpbnQzMl90KWNkYls3XSkgPDwgOCkgfAorICAgICAgICAgICAgICAgKCh1
aW50MzJfdCljZGJbOF0pOworICAgICAgICBicmVhazsKKyAgICBjYXNlIDEyOgorICAgICAgICBs
ZW4gPSAoKCh1aW50MzJfdCljZGJbNl0pIDw8IDI0KSB8CisgICAgICAgICAgICAgICgoKHVpbnQz
Ml90KWNkYls3XSkgPDwgMTYpIHwKKyAgICAgICAgICAgICAgKCgodWludDMyX3QpY2RiWzhdKSA8
PCA4KSAgfAorICAgICAgICAgICAgICAgKCh1aW50MzJfdCljZGJbOV0pOworICAgICAgICBicmVh
azsKKyAgICBjYXNlIDE2OgorICAgICAgICBsZW4gPSAoKCh1aW50MzJfdCljZGJbMTBdKSA8PCAy
NCkgfAorICAgICAgICAgICAgICAoKCh1aW50MzJfdCljZGJbMTFdKSA8PCAxNikgfAorICAgICAg
ICAgICAgICAoKCh1aW50MzJfdCljZGJbMTJdKSA8PCA4KSAgfAorICAgICAgICAgICAgICAgKCh1
aW50MzJfdCljZGJbMTNdKTsKKyAgICAgICAgYnJlYWs7CisgICAgZGVmYXVsdDoKKyAgICAgICAg
bGVuID0gMDsKKyAgICAgICAgYnJlYWs7CisgICAgfQorICAgIHJldHVybiBsZW47Cit9CisKKy8q
IFNDU0kgY29tbWFuZHMgKi8KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRfdGVzdF91bml0X3Jl
YWR5KENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICByZXEtPnhmZXJf
ZGlyID0gU0NTSV9YRkVSX05PTkU7CisgICAgcmVxLT5pbl9sZW4gPSAwOworCisgICAgaWYgKGRl
di0+bG9hZGVkKSB7CisgICAgICAgIGlmIChkZXYtPnBvd2VyX2NvbmQgIT0gQ0RfU0NTSV9QT1dF
Ul9TVE9QUEVEKSB7CisgICAgICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwg
cmVxKTsKKyAgICAgICAgfSBlbHNlIHsKKyAgICAgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRl
X2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX0lOSVRfQ01EX1JFUVVJUkVEKTsKKyAg
ICAgICAgfQorICAgIH0gZWxzZSB7CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNr
X2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX05PVF9SRUFEWV9OT19NRURJVU0pOworICAgIH0K
K30KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRfcmVxdWVzdF9zZW5zZShDZFNjc2lMVSAqZGV2
LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgcmVxLT54ZmVyX2RpciA9IFNDU0lfWEZFUl9G
Uk9NX0RFVjsKKworICAgIHJlcS0+cmVxX2xlbiA9IHJlcS0+Y2RiWzRdOworICAgIHJlcS0+aW5f
bGVuID0gTUlOKHJlcS0+cmVxX2xlbiwgc2l6ZW9mKGRldi0+Zml4ZWRfc2Vuc2UpKTsKKworICAg
IGlmIChkZXYtPnNob3J0X3NlbnNlLmtleSAhPSBOT19TRU5TRSkgeworICAgICAgICBTUElDRV9E
RUJVRygiJXMsIGx1bjoldSByZXBvcnRlZCBzZW5zZTogMHglMDJ4ICUwMnggJTAyeCAtICVzLCAl
cyIsCisgICAgICAgICAgICAgICAgICAgIF9fRlVOQ1RJT05fXywgcmVxLT5sdW4sCisgICAgICAg
ICAgICAgICAgICAgIGRldi0+c2hvcnRfc2Vuc2Uua2V5LCBkZXYtPnNob3J0X3NlbnNlLmFzYywg
ZGV2LT5zaG9ydF9zZW5zZS5hc2NxLAorICAgICAgICAgICAgICAgICAgICBjZF9zY3NpX3NlbnNl
X2tleV9kZXNjcihkZXYtPnNob3J0X3NlbnNlLmtleSksCisgICAgICAgICAgICAgICAgICAgIGRl
di0+c2hvcnRfc2Vuc2UuZGVzY3IpOworICAgIH0KKyAgICBtZW1jcHkocmVxLT5idWYsIGRldi0+
Zml4ZWRfc2Vuc2UsIHNpemVvZihkZXYtPmZpeGVkX3NlbnNlKSk7CisgICAgY2Rfc2NzaV9kZXZf
c2Vuc2VfcmVzZXQoZGV2KTsgLyogY2xlYXIgcmVwb3J0ZWQgc2Vuc2UgKi8KKworICAgIGNkX3Nj
c2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2LCByZXEpOworfQorCitzdGF0aWMgdm9pZCBjZF9zY3Np
X2NtZF9yZXBvcnRfbHVucyhDZFNjc2lUYXJnZXQgKnN0LCBDZFNjc2lMVSAqZGV2LAorICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAg
IHVpbnQ4X3QgKm91dF9idWYgPSByZXEtPmJ1ZjsKKyAgICB1aW50MzJfdCBtYXhfbHVucyA9IHN0
LT5tYXhfbHVuczsKKyAgICB1aW50MzJfdCBidWZsZW4gPSA4OyAvKiBoZWFkZXIgbGVuZ3RoICov
CisgICAgdWludDMyX3QgbHVuOworCisgICAgcmVxLT5yZXFfbGVuID0gc2NzaV9jZGJfeGZlcl9s
ZW5ndGgocmVxLT5jZGIsIDEyKTsKKyAgICByZXEtPnhmZXJfZGlyID0gU0NTSV9YRkVSX0ZST01f
REVWOworCisgICAgLyogY2hlY2sgU0VMRUNUIFJFUE9SVCBmaWVsZCAqLworICAgIGlmIChyZXEt
PmNkYlsyXSA9PSAweDAxKSB7CisgICAgICAgIC8qIG9ubHkgd2VsbCBrbm93biBsb2dpY2FsIHVu
aXRzICovCisgICAgICAgIG1heF9sdW5zID0gMDsKKyAgICB9CisKKyAgICBtZW1zZXQob3V0X2J1
ZiwgMCwgOCk7CisKKyAgICBmb3IgKGx1biA9IDA7IGx1biA8IG1heF9sdW5zOyBsdW4rKykgewor
ICAgICAgICBpZiAoc3QtPnVuaXRzW2x1bl0ucmVhbGl6ZWQpIHsKKyAgICAgICAgICAgIG91dF9i
dWZbYnVmbGVuKytdID0gMDsKKyAgICAgICAgICAgIG91dF9idWZbYnVmbGVuKytdID0gKHVpbnQ4
X3QpKGx1bik7CisgICAgICAgICAgICBtZW1zZXQoJm91dF9idWZbYnVmbGVuXSwgMCwgNik7Cisg
ICAgICAgICAgICBidWZsZW4gKz0gNjsKKyAgICAgICAgfQorICAgIH0KKworICAgIC8qIGZpbGwg
TFVOIExJU1QgTEVOR1RIICovCisgICAgb3V0X2J1ZlswXSA9ICh1aW50OF90KSgoYnVmbGVuLTgp
ID4+IDI0KTsKKyAgICBvdXRfYnVmWzFdID0gKHVpbnQ4X3QpKChidWZsZW4tOCkgPj4gMTYpOwor
ICAgIG91dF9idWZbMl0gPSAodWludDhfdCkoKGJ1Zmxlbi04KSA+PiA4KTsKKyAgICBvdXRfYnVm
WzNdID0gKHVpbnQ4X3QpKChidWZsZW4tOCkpOworCisgICAgcmVxLT5pbl9sZW4gPSBidWZsZW47
CisgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfZ29vZChkZXYsIHJlcSk7Cit9CisKKyNkZWZpbmUg
U0NTSV9NQVhfSU5RVUlSWV9MRU4gICAgICAgIDI1NgorI2RlZmluZSBTQ1NJX01BWF9NT0RFX0xF
TiAgICAgICAgICAgMjU2CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX2lucXVpcnlfdnBkX25v
X2x1bihDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEsCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyX3QgcGVyaWZfcXVhbCkKK3sKKyAgICB1
aW50OF90ICpvdXRidWYgPSByZXEtPmJ1ZjsKKyAgICB1aW50OF90IHBhZ2VfY29kZSA9IHJlcS0+
Y2RiWzJdOworICAgIHVpbnQzMl90IHJlc3BfbGVuID0gNDsKKworICAgIG91dGJ1ZlswXSA9IChw
ZXJpZl9xdWFsIDw8IDUpIHwgVFlQRV9ST007CisgICAgb3V0YnVmWzFdID0gcGFnZV9jb2RlIDsg
LyogdGhpcyBwYWdlICovCisgICAgb3V0YnVmWzJdID0gMHgwMDsgLyogcGFnZSBsZW5ndGggTVNC
ICovCisgICAgb3V0YnVmWzNdID0gMHgwMDsgLyogcGFnZSBsZW5ndGggTFNCIC0gbm8gbW9yZSBk
YXRhICovCisKKyAgICByZXEtPmluX2xlbiA9IE1JTihyZXEtPnJlcV9sZW4sIHJlc3BfbGVuKTsK
KworICAgIFNQSUNFX0RFQlVHKCJpbnF1aXJ5X3ZwZCwgdW5zdXBwb3J0ZWQgbHVuOiV1IgorICAg
ICAgICAgICAgICAgICIgcGVyaWZfcXVhbDoweCV4IHJlc3BfbGVuOiAlIiBHX0dVSU5UNjRfRk9S
TUFULAorICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBwZXJpZl9xdWFsLCByZXEtPmluX2xlbik7
CisKKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworc3RhdGlj
IHZvaWQgY2Rfc2NzaV9jbWRfaW5xdWlyeV92cGQoQ2RTY3NpTFUgKmRldiwgQ2RTY3NpUmVxdWVz
dCAqcmVxKQoreworICAgIHVpbnQ4X3QgKm91dGJ1ZiA9IHJlcS0+YnVmOworICAgIHVpbnQ4X3Qg
cGFnZV9jb2RlID0gcmVxLT5jZGJbMl07CisgICAgaW50IGJ1ZmxlbiA9IDQ7CisgICAgaW50IHN0
YXJ0ID0gNDsKKworICAgIG91dGJ1ZlswXSA9IFRZUEVfUk9NOworICAgIG91dGJ1ZlsxXSA9IHBh
Z2VfY29kZSA7IC8qIHRoaXMgcGFnZSAqLworICAgIG91dGJ1ZlsyXSA9IDB4MDA7IC8qIHBhZ2Ug
bGVuZ3RoIE1TQiAqLworICAgIG91dGJ1ZlszXSA9IDB4MDA7IC8qIHBhZ2UgbGVuZ3RoIExTQiwg
dG8gd3JpdGUgbGF0ZXIgKi8KKworICAgIHN3aXRjaCAocGFnZV9jb2RlKSB7CisgICAgY2FzZSAw
eDAwOiAvKiBTdXBwb3J0ZWQgcGFnZSBjb2RlcywgbWFuZGF0b3J5ICovCisgICAgeworICAgICAg
ICBvdXRidWZbYnVmbGVuKytdID0gMHgwMDsgLy8gbGlzdCBvZiBzdXBwb3J0ZWQgcGFnZXMgKHRo
aXMgcGFnZSkKKyAgICAgICAgaWYgKGRldi0+c2VyaWFsKSB7CisgICAgICAgICAgICBvdXRidWZb
YnVmbGVuKytdID0gMHg4MDsgLy8gdW5pdCBzZXJpYWwgbnVtYmVyCisgICAgICAgIH0KKyAgICAg
ICAgb3V0YnVmW2J1ZmxlbisrXSA9IDB4ODM7IC8vIGRldmljZSBpZGVudGlmaWNhdGlvbgorCisg
ICAgICAgIFNQSUNFX0RFQlVHKCJJbnF1aXJ5IEVWUERbU3VwcG9ydGVkIHBhZ2VzXSBsdW46JXUi
CisgICAgICAgICAgICAgICAgICAgICIgcmVxX2xlbjogJSIgR19HVUlOVDY0X0ZPUk1BVCAiIHJl
c3BfbGVuOiAlZCIsCisgICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuLCByZXEtPnJlcV9sZW4s
IGJ1Zmxlbik7CisgICAgICAgIGJyZWFrOworICAgIH0KKyAgICBjYXNlIDB4ODA6IC8qIERldmlj
ZSBzZXJpYWwgbnVtYmVyLCBvcHRpb25hbCAqLworICAgIHsKKyAgICAgICAgaW50IHNlcmlhbF9s
ZW47CisKKyAgICAgICAgc2VyaWFsX2xlbiA9IHN0cmxlbihkZXYtPnNlcmlhbCk7CisgICAgICAg
IGlmIChzZXJpYWxfbGVuID4gMzYpIHsKKyAgICAgICAgICAgIHNlcmlhbF9sZW4gPSAzNjsKKyAg
ICAgICAgfQorICAgICAgICBtZW1jcHkob3V0YnVmK2J1ZmxlbiwgZGV2LT5zZXJpYWwsIHNlcmlh
bF9sZW4pOworICAgICAgICBidWZsZW4gKz0gc2VyaWFsX2xlbjsKKworICAgICAgICBTUElDRV9E
RUJVRygiSW5xdWlyeSBFVlBEW1NlcmlhbCBudW1dIGx1bjoldSIKKyAgICAgICAgICAgICAgICAg
ICAgIiByZXFfbGVuOiAlIiBHX0dVSU5UNjRfRk9STUFUICIgcmVzcF9sZW46ICVkIiwKKyAgICAg
ICAgICAgICAgICAgICAgcmVxLT5sdW4sIHJlcS0+cmVxX2xlbiwgYnVmbGVuKTsKKyAgICAgICAg
YnJlYWs7CisgICAgfQorICAgIGNhc2UgMHg4MzogLyogRGV2aWNlIGlkZW50aWZpY2F0aW9uIHBh
Z2UsIG1hbmRhdG9yeSAqLworICAgIHsKKyAgICAgICAgaW50IHNlcmlhbF9sZW4gPSBzdHJsZW4o
ZGV2LT5zZXJpYWwpOworICAgICAgICBpbnQgbWF4X2xlbiA9IDIwOworCisgICAgICAgIGlmIChz
ZXJpYWxfbGVuID4gbWF4X2xlbikgeworICAgICAgICAgICAgc2VyaWFsX2xlbiA9IG1heF9sZW47
CisgICAgICAgIH0KKworICAgICAgICBvdXRidWZbYnVmbGVuKytdID0gMHgyOyAvLyBBU0NJSQor
ICAgICAgICBvdXRidWZbYnVmbGVuKytdID0gMDsgICAvLyBub3Qgb2ZmaWNpYWxseSBhc3NpZ25l
ZAorICAgICAgICBvdXRidWZbYnVmbGVuKytdID0gMDsgICAvLyByZXNlcnZlZAorICAgICAgICBv
dXRidWZbYnVmbGVuKytdID0gc2VyaWFsX2xlbjsgLy8gbGVuZ3RoIG9mIGRhdGEgZm9sbG93aW5n
CisKKyAgICAgICAgbWVtY3B5KG91dGJ1ZitidWZsZW4sIGRldi0+c2VyaWFsLCBzZXJpYWxfbGVu
KTsKKyAgICAgICAgYnVmbGVuICs9IHNlcmlhbF9sZW47CisKKyAgICAgICAgU1BJQ0VfREVCVUco
IklucXVpcnkgRVZQRFtEZXZpY2UgaWRdIGx1bjoldSIKKyAgICAgICAgICAgICAgICAgICAgIiBy
ZXFfbGVuOiAlIiBHX0dVSU5UNjRfRk9STUFUICIgcmVzcF9sZW46ICVkIiwKKyAgICAgICAgICAg
ICAgICAgICAgcmVxLT5sdW4sIHJlcS0+cmVxX2xlbiwgYnVmbGVuKTsKKyAgICAgICAgYnJlYWs7
CisgICAgfQorCisgICAgZGVmYXVsdDoKKyAgICAgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfY2hl
Y2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfSU5WQUxJRF9DREJfRklFTEQpOworICAgICAg
ICBTUElDRV9ERUJVRygiaW5xdWlyeV9zdGFuZGFyZCwgbHVuOiV1IGludmFsaWQgcGFnZV9jb2Rl
OiAlMDJ4IiwKKyAgICAgICAgICAgICAgICAgICAgcmVxLT5sdW4sIChpbnQpcGFnZV9jb2RlKTsK
KyAgICAgICAgcmV0dXJuOworICAgIH0KKworICAgIC8qIGRvbmUgd2l0aCBFVlBEICovCisgICAg
Z19hc3NlcnQoYnVmbGVuIC0gc3RhcnQgPD0gMjU1KTsKKyAgICBvdXRidWZbM10gPSBidWZsZW4g
LSBzdGFydDsgLyogcGFnZSBsZW5ndGggTFNCICovCisKKyAgICByZXEtPmluX2xlbiA9IGJ1Zmxl
bjsKKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworI2RlZmlu
ZSBJTlFVSVJZX1NUQU5EQVJEX0xFTl9NSU4gICAgICAgICAgICAzNgorI2RlZmluZSBJTlFVSVJZ
X1NUQU5EQVJEX0xFTiAgICAgICAgICAgICAgICA5NgorI2RlZmluZSBJTlFVSVJZX1NUQU5EQVJE
X0xFTl9OT19WRVIgICAgICAgICA1NworCisjZGVmaW5lIFBFUklGX1FVQUxJRklFUl9DT05ORUNU
RUQgICAgICAgICAgIDB4MDAKKyNkZWZpbmUgUEVSSUZfUVVBTElGSUVSX05PVF9DT05ORUNURUQg
ICAgICAgMHgwMQorI2RlZmluZSBQRVJJRl9RVUFMSUZJRVJfVU5TVVBQT1JURUQgICAgICAgICAw
eDAzCisKKyNkZWZpbmUgSU5RVUlSWV9SRU1PVkFCTEVfTUVESVVNICAgICAgICAgICAgMHg4MAor
CisjZGVmaW5lIElOUVVJUllfVkVSU0lPTl9OT05FICAgICAgICAgICAgICAgIDB4MDAKKyNkZWZp
bmUgSU5RVUlSWV9WRVJTSU9OX1NQQzMgICAgICAgICAgICAgICAgMHgwNQorCisvKiBieXRlIDMg
Ki8KKyNkZWZpbmUgSU5RVUlSWV9SRVNQX0hJU1VQICAgICAgICAgICAgICAgICAgKDB4MDEgPDwg
NCkKKyNkZWZpbmUgSU5RVUlSWV9SRVNQX05PUk1fQUNBICAgICAgICAgICAgICAgKDB4MDEgPDwg
NSkKKyNkZWZpbmUgSU5RVUlSWV9SRVNQX0RBVEFfRk9STUFUX1NQQzMgICAgICAgMHgwMgorCisj
ZGVmaW5lIElOUVVJUllfVkVSU0lPTl9ERVNDX1NBTTIgICAgICAgICAgIDB4MDQwCisjZGVmaW5l
IElOUVVJUllfVkVSU0lPTl9ERVNDX1NQQzMgICAgICAgICAgIDB4MzAwCisjZGVmaW5lIElOUVVJ
UllfVkVSU0lPTl9ERVNDX01NQzMgICAgICAgICAgIDB4MkEwCisjZGVmaW5lIElOUVVJUllfVkVS
U0lPTl9ERVNDX1NCQzIgICAgICAgICAgIDB4MzIwCisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21k
X2lucXVpcnlfc3RhbmRhcmRfbm9fbHVuKENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJl
cSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQz
Ml90IHBlcmlmX3F1YWwpCit7CisgICAgdWludDhfdCAqb3V0YnVmID0gcmVxLT5idWY7CisgICAg
dWludDMyX3QgcmVzcF9sZW4gPSBJTlFVSVJZX1NUQU5EQVJEX0xFTl9NSU47CisKKyAgICBtZW1z
ZXQocmVxLT5idWYsIDAsIElOUVVJUllfU1RBTkRBUkRfTEVOX01JTik7CisKKyAgICBvdXRidWZb
MF0gPSAocGVyaWZfcXVhbCA8PCA1KSB8IFRZUEVfUk9NOworICAgIG91dGJ1ZlsyXSA9IElOUVVJ
UllfVkVSU0lPTl9OT05FOworICAgIG91dGJ1ZlszXSA9IElOUVVJUllfUkVTUF9EQVRBX0ZPUk1B
VF9TUEMzOworCisgICAgb3V0YnVmWzRdID0gcmVzcF9sZW4gLSA0OyAvKiBhZGRpdGlvbmFsIGxl
bmd0aCwgYWZ0ZXIgaGVhZGVyICovCisKKyAgICByZXEtPmluX2xlbiA9IE1JTihyZXEtPnJlcV9s
ZW4sIHJlc3BfbGVuKTsKKworICAgIFNQSUNFX0RFQlVHKCJpbnF1aXJ5X3N0YW5kYXJkLCB1bnN1
cHBvcnRlZCBsdW46JXUgcGVyaWZfcXVhbDoweCV4ICIKKyAgICAgICAgICAgICAgICAiaW5xdWly
eV9sZW46ICV1IHJlc3BfbGVuOiAlIiBHX0dVSU5UNjRfRk9STUFULAorICAgICAgICAgICAgICAg
IHJlcS0+bHVuLCBwZXJpZl9xdWFsLCByZXNwX2xlbiwgcmVxLT5pbl9sZW4pOworCisgICAgY2Rf
c2NzaV9jbWRfY29tcGxldGVfZ29vZChkZXYsIHJlcSk7Cit9CisKK3N0YXRpYyB2b2lkIGNkX3Nj
c2lfY21kX2lucXVpcnlfc3RhbmRhcmQoQ2RTY3NpTFUgKmRldiwgQ2RTY3NpUmVxdWVzdCAqcmVx
KQoreworICAgIHVpbnQ4X3QgKm91dGJ1ZiA9IHJlcS0+YnVmOworICAgIHVpbnQzMl90IHJlc3Bf
bGVuID0KKyAgICAgICAgKGRldi0+Y2xhaW1fdmVyc2lvbiA9PSAwKSA/IElOUVVJUllfU1RBTkRB
UkRfTEVOX05PX1ZFUiA6IElOUVVJUllfU1RBTkRBUkRfTEVOOworCisgICAgb3V0YnVmWzBdID0g
KFBFUklGX1FVQUxJRklFUl9DT05ORUNURUQgPDwgNSkgfCBUWVBFX1JPTTsKKyAgICBvdXRidWZb
MV0gPSAoZGV2LT5yZW1vdmFibGUpID8gSU5RVUlSWV9SRU1PVkFCTEVfTUVESVVNIDogMDsKKyAg
ICBvdXRidWZbMl0gPSAoZGV2LT5jbGFpbV92ZXJzaW9uID09IDApID8gSU5RVUlSWV9WRVJTSU9O
X05PTkUgOiBJTlFVSVJZX1ZFUlNJT05fU1BDMzsKKyAgICBvdXRidWZbM10gPSBJTlFVSVJZX1JF
U1BfTk9STV9BQ0EgfCBJTlFVSVJZX1JFU1BfSElTVVAgfCBJTlFVSVJZX1JFU1BfREFUQV9GT1JN
QVRfU1BDMzsKKworICAgIG91dGJ1Zls0XSA9IHJlc3BfbGVuIC0gNDsgLyogYWRkaXRpb25hbCBs
ZW5ndGgsIGFmdGVyIGhlYWRlciAqLworCisgICAgLyogKG91dGJ1Zls2LDddID0gMCkgbWVhbnMg
YWxzbyB7QlF1ZT0wLENtZFF1ZT0wfSAtIG5vIHF1ZXVlaW5nIGF0IGFsbCAqLworCisgICAgc3Ry
cGFkY3B5KChjaGFyICopICZvdXRidWZbOF0sIDgsIGRldi0+dmVuZG9yLCAnICcpOworICAgIHN0
cnBhZGNweSgoY2hhciAqKSAmb3V0YnVmWzE2XSwgMTYsIGRldi0+cHJvZHVjdCwgJyAnKTsKKyAg
ICBtZW1jcHkoJm91dGJ1ZlszMl0sIGRldi0+dmVyc2lvbiwgTUlOKDQsIHN0cmxlbihkZXYtPnZl
cnNpb24pKSk7CisKKyAgICBpZiAoZGV2LT5jbGFpbV92ZXJzaW9uID4gMCkgeworICAgICAgICAv
KiBub3cgc3VwcG9ydGluZyBvbmx5IDMgKi8KKyAgICAgICAgb3V0YnVmWzU4XSA9IChJTlFVSVJZ
X1ZFUlNJT05fREVTQ19TQU0yID4+IDgpICYgMHhmZjsKKyAgICAgICAgb3V0YnVmWzU5XSA9IElO
UVVJUllfVkVSU0lPTl9ERVNDX1NBTTIgJiAweGZmOworCisgICAgICAgIG91dGJ1Zls2MF0gPSAo
SU5RVUlSWV9WRVJTSU9OX0RFU0NfU1BDMyA+PiA4KSAmIDB4ZmY7CisgICAgICAgIG91dGJ1Zls2
MV0gPSBJTlFVSVJZX1ZFUlNJT05fREVTQ19TUEMzICYgMHhmZjsKKworICAgICAgICBvdXRidWZb
NjJdID0gKElOUVVJUllfVkVSU0lPTl9ERVNDX01NQzMgPj4gOCkgJiAweGZmOworICAgICAgICBv
dXRidWZbNjNdID0gSU5RVUlSWV9WRVJTSU9OX0RFU0NfTU1DMyAmIDB4ZmY7CisKKyAgICAgICAg
b3V0YnVmWzY0XSA9IChJTlFVSVJZX1ZFUlNJT05fREVTQ19TQkMyID4+IDgpICYgMHhmZjsKKyAg
ICAgICAgb3V0YnVmWzY1XSA9IElOUVVJUllfVkVSU0lPTl9ERVNDX1NCQzIgJiAweGZmOworICAg
IH0KKworICAgIHJlcS0+aW5fbGVuID0gTUlOKHJlcS0+cmVxX2xlbiwgcmVzcF9sZW4pOworCisg
ICAgU1BJQ0VfREVCVUcoImlucXVpcnlfc3RhbmRhcmQsIGx1bjoldSIKKyAgICAgICAgICAgICAg
ICAiIGlucXVpcnlfbGVuOiAldSByZXNwX2xlbjogJSIgR19HVUlOVDY0X0ZPUk1BVCwKKyAgICAg
ICAgICAgICAgICByZXEtPmx1biwgcmVzcF9sZW4sIHJlcS0+aW5fbGVuKTsKKworICAgIGNkX3Nj
c2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2LCByZXEpOworfQorCisjZGVmaW5lIENEX0lOUVVJUllf
RkxBR19FVlBEICAgICAgICAgICAgICAgIDB4MDEKKyNkZWZpbmUgQ0RfSU5RVUlSWV9GTEFHX0NN
RF9EVCAgICAgICAgICAgICAgMHgwMgorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9pbnF1aXJ5
KENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICBnYm9vbGVhbiBldnBk
LCBjbWRfZGF0YTsKKworICAgIHJlcS0+eGZlcl9kaXIgPSBTQ1NJX1hGRVJfRlJPTV9ERVY7CisK
KyAgICBldnBkID0gKHJlcS0+Y2RiWzFdICYgQ0RfSU5RVUlSWV9GTEFHX0VWUEQpID8gVFJVRSA6
IEZBTFNFOworICAgIGNtZF9kYXRhID0gKHJlcS0+Y2RiWzFdICYgQ0RfSU5RVUlSWV9GTEFHX0NN
RF9EVCkgPyBUUlVFIDogRkFMU0U7CisKKyAgICBpZiAoY21kX2RhdGEpIHsKKyAgICAgICAgU1BJ
Q0VfREVCVUcoImlucXVpcnksIGx1bjoldSBDbWREVCBiaXQgc2V0IC0gdW5zdXBwb3J0ZWQsICIK
KyAgICAgICAgICAgICAgICAgICAgImNkYlsxXToweCUwMnggY2RiWzFdOjB4JTAyeCIsCisgICAg
ICAgICAgICAgICAgICAgIHJlcS0+bHVuLCAoaW50KXJlcS0+Y2RiWzFdLCAoaW50KXJlcS0+Y2Ri
WzJdKTsKKyAgICAgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwg
JnNlbnNlX2NvZGVfSU5WQUxJRF9DREJfRklFTEQpOworICAgICAgICByZXR1cm47CisgICAgfQor
CisgICAgcmVxLT5yZXFfbGVuID0gcmVxLT5jZGJbNF0gfCAocmVxLT5jZGJbM10gPDwgOCk7Cisg
ICAgbWVtc2V0KHJlcS0+YnVmLCAwLCByZXEtPnJlcV9sZW4pOworCisgICAgaWYgKGV2cGQpIHsg
LyogZW5hYmxlIHZpdGFsIHByb2R1Y3QgZGF0YSAqLworICAgICAgICBjZF9zY3NpX2NtZF9pbnF1
aXJ5X3ZwZChkZXYsIHJlcSk7CisgICAgfSBlbHNlIHsgLyogc3RhbmRhcmQgaW5xdWlyeSBkYXRh
ICovCisgICAgICAgIGlmIChyZXEtPmNkYlsyXSAhPSAwKSB7CisgICAgICAgICAgICBTUElDRV9E
RUJVRygiaW5xdWlyeV9zdGFuZGFyZCwgbHVuOiV1IG5vbi16ZXJvIHBhZ2UgY29kZTogJTAyeCIs
CisgICAgICAgICAgICAgICAgICAgICAgICByZXEtPmx1biwgKGludClyZXEtPmNkYlsyXSk7Cisg
ICAgICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vu
c2VfY29kZV9JTlZBTElEX0NEQl9GSUVMRCk7CisgICAgICAgICAgICByZXR1cm47CisgICAgICAg
IH0KKyAgICAgICAgY2Rfc2NzaV9jbWRfaW5xdWlyeV9zdGFuZGFyZChkZXYsIHJlcSk7CisgICAg
fQorfQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9yZWFkX2NhcGFjaXR5KENkU2NzaUxVICpk
ZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICB1aW50MzJfdCBsYXN0X2JsayA9IGRldi0+
bnVtX2Jsb2NrcyAtIDE7CisgICAgdWludDMyX3QgYmxrX3NpemUgPSBkZXYtPmJsb2NrX3NpemU7
CisgICAgdWludDMyX3QgKmxhc3RfYmxrX291dCA9ICh1aW50MzJfdCAqKXJlcS0+YnVmOworICAg
IHVpbnQzMl90ICpibGtfc2l6ZV9vdXQgPSAodWludDMyX3QgKikocmVxLT5idWYgKyA0KTsKKwor
ICAgIHJlcS0+eGZlcl9kaXIgPSBTQ1NJX1hGRVJfRlJPTV9ERVY7CisgICAgcmVxLT5yZXFfbGVu
ID0gODsKKworICAgICpsYXN0X2Jsa19vdXQgPSBodG9iZTMyKGxhc3RfYmxrKTsKKyAgICAqYmxr
X3NpemVfb3V0ID0gaHRvYmUzMihibGtfc2l6ZSk7CisKKyAgICBTUElDRV9ERUJVRygiUmVhZCBj
YXBhY2l0eSwgbHVuOiV1IGxhc3RfYmxrOiAldSBibGtfc3o6ICV1IiwKKyAgICAgICAgICAgICAg
ICByZXEtPmx1biwgbGFzdF9ibGssIGJsa19zaXplKTsKKworICAgIHJlcS0+aW5fbGVuID0gODsK
KyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworI2RlZmluZSBS
RElfVFlQRV9TVEFOREFSRCAgICAgICAgICAgMCAvKiBTdGFuZGFyZCBEaXNjIEluZm9ybWF0aW9u
ICovCisjZGVmaW5lIFJESV9UWVBFX1RSQUNLX1JFU09VUkNFUyAgICAxIC8qIFRyYWNrIFJlc291
cmNlcyBJbmZvcm1hdGlvbiAqLworI2RlZmluZSBSRElfVFlQRV9QT1dfUkVTT1VSQ0VTICAgICAg
MiAvKiBQT1cgUmVzb3VyY2VzIEluZm9ybWF0aW9uICovCisKKyNkZWZpbmUgUkRJX1NUQU5EQVJE
X0xFTiAgICAgICAgICAgIDM0CisKKyNkZWZpbmUgUkRJX0VSQVpBQkxFICAgICAgICAgICAgICAg
ICgweDAxIDw8IDQpCisjZGVmaW5lIFJESV9OT05fRVJBWkFCTEUgICAgICAgICAgICAoMHgwMCA8
PCA0KQorCisjZGVmaW5lIFJESV9TRVNTSU9OX0VNUFRZICAgICAgICAgICAoMHgwMCA8PCAyKQor
I2RlZmluZSBSRElfU0VTU0lPTl9JTkNPTVBMRVRFICAgICAgKDB4MDEgPDwgMikKKyNkZWZpbmUg
UkRJX1NFU1NJT05fREFNQUdFRCAgICAgICAgICgweDAyIDw8IDIpCisjZGVmaW5lIFJESV9TRVNT
SU9OX0NPTVBMRVRFICAgICAgICAoMHgwMyA8PCAyKQorCisjZGVmaW5lIFJESV9ESVNDX0VNUFRZ
ICAgICAgICAgICAgICAweDAwCisjZGVmaW5lIFJESV9ESVNDX0lOQ09NUExFVEUgICAgICAgICAw
eDAxCisjZGVmaW5lIFJESV9ESVNDX0NPTVBMRVRFICAgICAgICAgICAweDAyCisjZGVmaW5lIFJE
SV9ESVNDX1JBTkRPTV9XUiAgICAgICAgICAweDAzCisKKyNkZWZpbmUgUkRJX0RJU0NfUE1BX1RZ
UEVfQ0RfUk9NICAgIDB4MDAKKyNkZWZpbmUgUkRJX0RJU0NfUE1BX1RZUEVfQ0RJICAgICAgIDB4
MTAKKyNkZWZpbmUgUkRJX0RJU0NfUE1BX1RZUEVfRERDRCAgICAgIDB4MjAKKyNkZWZpbmUgUkRJ
X0RJU0NfUE1BX1RZUEVfVU5ERUZJTkVEIDB4RkYKKworc3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRf
Z2V0X3JlYWRfZGlzY19pbmZvcm1hdGlvbihDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpy
ZXEpCit7CisgICAgdWludDhfdCAqb3V0YnVmID0gcmVxLT5idWY7CisgICAgdWludDMyX3QgZGF0
YV90eXBlOworICAgIHVpbnQzMl90IGZpcnN0X3RyYWNrID0gMTsKKyAgICB1aW50MzJfdCBsYXN0
X3RyYWNrID0gMTsKKyAgICB1aW50MzJfdCBudW1fc2Vzc2lvbnMgPSAxOworCisgICAgcmVxLT54
ZmVyX2RpciA9IFNDU0lfWEZFUl9GUk9NX0RFVjsKKworICAgIGRhdGFfdHlwZSA9IHJlcS0+Y2Ri
WzFdICYgMHg3OworICAgIGlmIChkYXRhX3R5cGUgIT0gUkRJX1RZUEVfU1RBTkRBUkQpIHsKKyAg
ICAgICAgU1BJQ0VfREVCVUcoInJlYWRfZGlzY19pbmZvcm1hdGlvbiwgbHVuOiV1IgorICAgICAg
ICAgICAgICAgICAgICAiIHVuc3VwcG9ydGVkIGRhdGEgdHlwZTogJTAyeCIsCisgICAgICAgICAg
ICAgICAgICAgIHJlcS0+bHVuLCBkYXRhX3R5cGUpOworICAgICAgICBjZF9zY3NpX2NtZF9jb21w
bGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZBTElEX0NEQl9GSUVMRCk7
CisgICAgICAgIHJldHVybjsKKyAgICB9CisKKyAgICByZXEtPnJlcV9sZW4gPSAocmVxLT5jZGJb
N10gPDwgOCkgfCByZXEtPmNkYls4XTsKKyAgICByZXEtPmluX2xlbiA9IE1JTihyZXEtPnJlcV9s
ZW4sIFJESV9TVEFOREFSRF9MRU4pOworCisgICAgbWVtc2V0KG91dGJ1ZiwgMCwgUkRJX1NUQU5E
QVJEX0xFTik7CisgICAgb3V0YnVmWzFdID0gUkRJX1NUQU5EQVJEX0xFTiAtIDI7IC8qIGxlbmd0
aCBleGNsdWRpbmcgdGhlIGNvdW50ZXIgaXRzZWxmICovCisgICAgb3V0YnVmWzJdID0gUkRJX05P
Tl9FUkFaQUJMRSB8IFJESV9TRVNTSU9OX0NPTVBMRVRFIHwgUkRJX0RJU0NfQ09NUExFVEU7Cisg
ICAgb3V0YnVmWzNdID0gZmlyc3RfdHJhY2s7IC8qIG9uIGRpc2sgKi8KKyAgICBvdXRidWZbNF0g
PSBudW1fc2Vzc2lvbnMgJiAweGZmOyAvKiBsc2IgKi8KKyAgICBvdXRidWZbNV0gPSBmaXJzdF90
cmFjayAmIDB4ZmY7IC8qIGluIGxhc3Qgc2Vzc29uLCBsc2IgKi8KKyAgICBvdXRidWZbNl0gPSBs
YXN0X3RyYWNrICYgMHhmZjsgLyogaW4gbGFzdCBzZXNzb24sIGxzYiAqLworICAgIG91dGJ1Zls4
XSA9IFJESV9ESVNDX1BNQV9UWVBFX0NEX1JPTTsKKyAgICBvdXRidWZbOV0gPSAobnVtX3Nlc3Np
b25zID4+IDgpICYgMHhmZjsgLyogbXNiICovCisgICAgb3V0YnVmWzEwXSA9IChmaXJzdF90cmFj
ayA+PiA4KSAmIDB4ZmY7IC8qIGluIGxhc3Qgc2Vzc29uLCBsc2IgKi8KKyAgICBvdXRidWZbMTFd
ID0gKGxhc3RfdHJhY2sgPj4gOCkgJiAweGZmOyAvKiBpbiBsYXN0IHNlc3NvbiwgbHNiICovCisK
KyAgICBTUElDRV9ERUJVRygicmVhZF9kaXNjX2luZm9ybWF0aW9uLCBsdW46JXUgbGVuOiAlIiBH
X0dVSU5UNjRfRk9STUFULAorICAgICAgICAgICAgICAgIHJlcS0+bHVuLCByZXEtPmluX2xlbik7
CisKKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworI2RlZmlu
ZSBSVElfQUREUl9UWVBFX0xCQSAgICAgICAgICAgMHgwMAorI2RlZmluZSBSVElfQUREUl9UWVBF
X1RSQUNLX05VTSAgICAgMHgwMQorI2RlZmluZSBSVElfQUREUl9UWVBFX1NFU1NJT05fTlVNICAg
MHgwMgorCisjZGVmaW5lIFJUSV9UUkFDS19OVU1fTEVBRF9JTiAgICAgICAweDAwCisjZGVmaW5l
IFJUSV9UUkFDS19OVU1fSU5WSVNJQkxFICAgICAweGZmCisKKyNkZWZpbmUgVElCX0xFTiAgICAg
ICAgICAgICAgICAgICAgIDB4MzYKKworI2RlZmluZSBUSUJfVFJBQ0tfTU9ERV9DRCAgICAgICAg
ICAgMHgwNAorI2RlZmluZSBUSUJfREFUQV9NT0RFX0lTT18xMDE0OSAgICAgMHgwMQorCisjZGVm
aW5lIFRJQl9MUkFfVkFMSUQgICAgICAgICAgICAgICAoMHgwMSA8PCAxKQorCitzdGF0aWMgdm9p
ZCBjZF9zY3NpX2NtZF9nZXRfcmVhZF90cmFja19pbmZvcm1hdGlvbihDZFNjc2lMVSAqZGV2LCBD
ZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgdWludDhfdCAqb3V0YnVmID0gcmVxLT5idWY7Cisg
ICAgdWludDMyX3QgdHJhY2tfc2l6ZSA9IGRldi0+bnVtX2Jsb2NrczsKKyAgICB1aW50MzJfdCBs
YXN0X2FkZHIgPSB0cmFja19zaXplIC0gMTsKKyAgICB1aW50MzJfdCB0cmFja19udW0gPSAxOwor
ICAgIHVpbnQzMl90IHNlc3Npb25fbnVtID0gMTsKKyAgICB1aW50MzJfdCBhZGRyX3R5cGU7Cisg
ICAgdWludDMyX3QgYWRkcl9udW07CisKKyAgICByZXEtPnhmZXJfZGlyID0gU0NTSV9YRkVSX0ZS
T01fREVWOworCisgICAgYWRkcl90eXBlID0gcmVxLT5jZGJbMV0gJiAweDM7CisgICAgYWRkcl9u
dW0gPSAocmVxLT5jZGJbMl0gPDwgMjQpIHwgKHJlcS0+Y2RiWzNdIDw8IDE2KSB8CisgICAgICAg
ICAgICAgICAocmVxLT5jZGJbNF0gPDwgOCkgfCByZXEtPmNkYls1XTsKKworICAgIHN3aXRjaCAo
YWRkcl90eXBlKSB7CisgICAgY2FzZSBSVElfQUREUl9UWVBFX0xCQToKKyAgICAgICAgaWYgKGFk
ZHJfbnVtID4gbGFzdF9hZGRyKSB7CisgICAgICAgICAgICBTUElDRV9ERUJVRygicmVhZF90cmFj
a19pbmZvcm1hdGlvbiwgbHVuOiV1IgorICAgICAgICAgICAgICAgICAgICAgICAgIiBhZGRyX3R5
cGUgTEJBOiAldSIKKyAgICAgICAgICAgICAgICAgICAgICAgICIgaW52YWxpZCBMQkE6ICV1IiwK
KyAgICAgICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBhZGRyX3R5cGUsIGFkZHJfbnVtKTsK
KyAgICAgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZz
ZW5zZV9jb2RlX0lOVkFMSURfQ0RCX0ZJRUxEKTsKKyAgICAgICAgICAgIHJldHVybjsKKyAgICAg
ICAgfQorICAgICAgICBicmVhazsKKyAgICBjYXNlIFJUSV9BRERSX1RZUEVfVFJBQ0tfTlVNOgor
ICAgICAgICBpZiAoYWRkcl9udW0gIT0gdHJhY2tfbnVtKSB7CisgICAgICAgICAgICBTUElDRV9E
RUJVRygicmVhZF90cmFja19pbmZvcm1hdGlvbiwgbHVuOiV1IgorICAgICAgICAgICAgICAgICAg
ICAgICAgIiBhZGRyX3R5cGUgdHJhY2s6ICV1IgorICAgICAgICAgICAgICAgICAgICAgICAgIiBp
bnZhbGlkIHRyYWNrOiAldSIsCisgICAgICAgICAgICAgICAgICAgICAgICByZXEtPmx1biwgYWRk
cl90eXBlLCBhZGRyX251bSk7CisgICAgICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVj
a19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZBTElEX0NEQl9GSUVMRCk7CisgICAgICAg
ICAgICByZXR1cm47CisgICAgICAgIH0KKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBSVElfQURE
Ul9UWVBFX1NFU1NJT05fTlVNOgorICAgICAgICBpZiAoYWRkcl9udW0gIT0gc2Vzc2lvbl9udW0p
IHsKKyAgICAgICAgICAgIFNQSUNFX0RFQlVHKCJyZWFkX3RyYWNrX2luZm9ybWF0aW9uLCBsdW46
JXUiCisgICAgICAgICAgICAgICAgICAgICAgICAiIGFkZHJfdHlwZSBzZXNzaW9uOiAldSIKKyAg
ICAgICAgICAgICAgICAgICAgICAgICIgaW52YWxpZCBzZXNzaW9uOiAldSIsCisgICAgICAgICAg
ICAgICAgICAgICAgICByZXEtPmx1biwgYWRkcl90eXBlLCBhZGRyX251bSk7CisgICAgICAgICAg
ICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9J
TlZBTElEX0NEQl9GSUVMRCk7CisgICAgICAgICAgICByZXR1cm47CisgICAgICAgIH0KKyAgICAg
ICAgYnJlYWs7CisgICAgZGVmYXVsdDoKKyAgICAgICAgU1BJQ0VfREVCVUcoInJlYWRfdHJhY2tf
aW5mb3JtYXRpb24sIGx1bjoldSIKKyAgICAgICAgICAgICAgICAgICAgIiBpbnZhbGlkIGFkZHJf
dHlwZTogJXUiCisgICAgICAgICAgICAgICAgICAgICIgYWRkcl9udW06ICV1IiwKKyAgICAgICAg
ICAgICAgICAgICAgcmVxLT5sdW4sIGFkZHJfdHlwZSwgYWRkcl9udW0pOworICAgICAgICBjZF9z
Y3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZBTElE
X0NEQl9GSUVMRCk7CisgICAgICAgIHJldHVybjsKKyAgICB9CisKKyAgICByZXEtPnJlcV9sZW4g
PSAocmVxLT5jZGJbN10gPDwgOCkgfCByZXEtPmNkYls4XTsKKyAgICByZXEtPmluX2xlbiA9IE1J
TihyZXEtPnJlcV9sZW4sIFRJQl9MRU4pOworCisgICAgbWVtc2V0KG91dGJ1ZiwgMCwgVElCX0xF
Tik7CisgICAgb3V0YnVmWzFdID0gVElCX0xFTiAtIDI7CisgICAgb3V0YnVmWzJdID0gc2Vzc2lv
bl9udW07CisgICAgb3V0YnVmWzNdID0gdHJhY2tfbnVtOworICAgIG91dGJ1Zls1XSA9IFRJQl9U
UkFDS19NT0RFX0NEICYgMHgwZjsKKyAgICBvdXRidWZbNl0gPSBUSUJfREFUQV9NT0RFX0lTT18x
MDE0OSAmIDB4MGY7CisgICAgb3V0YnVmWzddID0gVElCX0xSQV9WQUxJRDsKKworICAgIC8qIFRy
YWNrIHNpemUgKi8KKyAgICBvdXRidWZbMjRdID0gKHRyYWNrX3NpemUgPj4gMjQpICYgMHhmZjsK
KyAgICBvdXRidWZbMjVdID0gKHRyYWNrX3NpemUgPj4gMTYpICYgMHhmZjsKKyAgICBvdXRidWZb
MjZdID0gKHRyYWNrX3NpemUgPj4gOCkgJiAweGZmOworICAgIG91dGJ1ZlsyN10gPSAodHJhY2tf
c2l6ZSkgJiAweGZmOworCisgICAgLyogTGFzdCByZWNvcmRlZCBhZGRyZXNzICovCisgICAgb3V0
YnVmWzI4XSA9IChsYXN0X2FkZHIgPj4gMjQpICYgMHhmZjsKKyAgICBvdXRidWZbMjldID0gKGxh
c3RfYWRkciA+PiAxNikgJiAweGZmOworICAgIG91dGJ1ZlszMF0gPSAobGFzdF9hZGRyID4+IDgp
ICYgMHhmZjsKKyAgICBvdXRidWZbMzFdID0gKGxhc3RfYWRkcikgJiAweGZmOworCisgICAgU1BJ
Q0VfREVCVUcoInJlYWRfdHJhY2tfaW5mb3JtYXRpb24sIGx1bjoldSIKKyAgICAgICAgICAgICAg
ICAiYWRkcl90eXBlOiAldSBhZGRyX251bTogJXUiLAorICAgICAgICAgICAgICAgIHJlcS0+bHVu
LCBhZGRyX3R5cGUsIGFkZHJfbnVtKTsKKworICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2dvb2Qo
ZGV2LCByZXEpOworfQorCisjZGVmaW5lIFJFQURfVE9DX1RSQUNLX0RFU0NfTEVOICAgICA4Cisj
ZGVmaW5lIFJFQURfVE9DX1JFU1BfTEVOICAgICAgICAgICAoNCArIDIqUkVBRF9UT0NfVFJBQ0tf
REVTQ19MRU4pCisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX3JlYWRfdG9jKENkU2NzaUxVICpk
ZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICB1aW50OF90ICpvdXRidWYgPSByZXEtPmJ1
ZjsKKyAgICB1aW50MzJfdCBtc2YsIGZvcm1hdCwgdHJhY2tfbnVtOworICAgIHVpbnQzMl90IGxh
c3RfYmxrID0gZGV2LT5udW1fYmxvY2tzIC0gMTsKKworICAgIHJlcS0+eGZlcl9kaXIgPSBTQ1NJ
X1hGRVJfRlJPTV9ERVY7CisKKyAgICBtc2YgPSAocmVxLT5jZGJbMV0gPj4gMSkgJiAweDE7Cisg
ICAgZm9ybWF0ID0gcmVxLT5jZGJbMl0gJiAweGY7CisgICAgdHJhY2tfbnVtID0gcmVxLT5jZGJb
Nl07CisKKyAgICByZXEtPnJlcV9sZW4gPSAocmVxLT5jZGJbN10gPDwgOCkgfCByZXEtPmNkYls4
XTsKKyAgICByZXEtPmluX2xlbiA9IE1JTihyZXEtPnJlcV9sZW4sIFJFQURfVE9DX1JFU1BfTEVO
KTsKKworICAgIG1lbXNldChvdXRidWYsIDAsIFJFQURfVE9DX1JFU1BfTEVOKTsKKyAgICBvdXRi
dWZbMV0gPSBSRUFEX1RPQ19SRVNQX0xFTiAtIDI7IC8qIGxlbmd0aCBleGNsdWRpbmcgdGhlIGNv
dW50ZXIgaXRzZWxmICovCisgICAgb3V0YnVmWzJdID0gMTsgLyogZmlyc3QgdHJhY2svc2Vzc2lv
biAqLworICAgIG91dGJ1ZlszXSA9IDE7IC8qIGxhc3QgdHJhY2svc2Vzc2lvbiAqLworCisgICAg
b3V0YnVmWzVdID0gMHgwNDsgLyogRGF0YSBDRCwgbm8gUS1zdWJjaGFubmVsICovCisgICAgb3V0
YnVmWzZdID0gMHgwMTsgLyogVHJhY2sgbnVtYmVyICovCisgICAgb3V0YnVmWzEwXSA9IG1zZiA/
IDB4MDIgOiAweDA7CisKKyAgICBvdXRidWZbMTNdID0gMHgwNDsgLyogRGF0YSBDRCwgbm8gUS1z
dWJjaGFubmVsICovCisgICAgb3V0YnVmWzE0XSA9IDB4YWE7IC8qIFRyYWNrIG51bWJlciAqLwor
ICAgIGlmIChtc2YpIHsKKyAgICAgICAgbGFzdF9ibGsgPSAweGZmMzAwMDAwOworICAgIH0KKyAg
ICBvdXRidWZbMTZdID0gbGFzdF9ibGsgPj4gMjQ7CisgICAgb3V0YnVmWzE3XSA9IGxhc3RfYmxr
ID4+IDE2OworICAgIG91dGJ1ZlsxOF0gPSBsYXN0X2JsayA+PiA4OworICAgIG91dGJ1ZlsxOV0g
PSBsYXN0X2JsazsKKworICAgIFNQSUNFX0RFQlVHKCJyZWFkX3RvYywgbHVuOiV1IGxlbjogJSIg
R19HVUlOVDY0X0ZPUk1BVAorICAgICAgICAgICAgICAgICIgbXNmOiAleCBmb3JtYXQ6IDB4JTAy
eCB0cmFjay9zZXNzaW9uOiAweCUwMngiLAorICAgICAgICAgICAgICAgIHJlcS0+bHVuLCByZXEt
PmluX2xlbiwgbXNmLCBmb3JtYXQsIHRyYWNrX251bSk7CisKKyAgICBjZF9zY3NpX2NtZF9jb21w
bGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworI2RlZmluZSBDRF9NT0RFX1BBUkFNXzZfTEVOX0hF
QURFUiAgICAgICAgICAgICAgNAorI2RlZmluZSBDRF9NT0RFX1BBUkFNXzEwX0xFTl9IRUFERVIg
ICAgICAgICAgICAgOAorCisjZGVmaW5lIENEX01PREVfUEFHRV9MRU5fUldfRVJST1IgICAgICAg
ICAgICAgICAxMgorCitzdGF0aWMgdWludDMyX3QgY2Rfc2NzaV9hZGRfbW9kZV9wYWdlX3J3X2Vy
cm9yX3JlY292ZXJ5KENkU2NzaUxVICpkZXYsIHVpbnQ4X3QgKm91dGJ1ZikKK3sKKyAgICB1aW50
MzJfdCBwYWdlX2xlbiA9IENEX01PREVfUEFHRV9MRU5fUldfRVJST1I7CisKKyAgICBvdXRidWZb
MF0gPSBNT0RFX1BBR0VfUl9XX0VSUk9SOworICAgIG91dGJ1ZlsxXSA9IENEX01PREVfUEFHRV9M
RU5fUldfRVJST1IgLSAyOworICAgIG91dGJ1ZlszXSA9IDE7IC8qIHJlYWQgcmV0cnkgY291bnQg
Ki8KKworICAgIHJldHVybiBwYWdlX2xlbjsKK30KKworI2RlZmluZSBDRF9NT0RFX1BBR0VfTEVO
X1BPV0VSICAgICAgICAgICAgICAgICAgMTIKKworc3RhdGljIHVpbnQzMl90IGNkX3Njc2lfYWRk
X21vZGVfcGFnZV9wb3dlcl9jb25kaXRpb24oQ2RTY3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVm
KQoreworICAgIHVpbnQzMl90IHBhZ2VfbGVuID0gQ0RfTU9ERV9QQUdFX0xFTl9QT1dFUjsKKwor
ICAgIG91dGJ1ZlswXSA9IE1PREVfUEFHRV9QT1dFUjsKKyAgICBvdXRidWZbMV0gPSBDRF9NT0RF
X1BBR0VfTEVOX1BPV0VSIC0gMjsKKworICAgIHJldHVybiBwYWdlX2xlbjsKK30KKworI2RlZmlu
ZSBDRF9NT0RFX1BBR0VfTEVOX0ZBVUxUX0ZBSUwgICAgICAgICAgICAgMTIKKyNkZWZpbmUgQ0Rf
TU9ERV9QQUdFX0ZBVUxUX0ZBSUxfRkxBR19QRVJGICAgICAgIDB4ODAKKworc3RhdGljIHVpbnQz
Ml90IGNkX3Njc2lfYWRkX21vZGVfcGFnZV9mYXVsdF9yZXBvcnRpbmcoQ2RTY3NpTFUgKmRldiwg
dWludDhfdCAqb3V0YnVmKQoreworICAgIHVpbnQzMl90IHBhZ2VfbGVuID0gQ0RfTU9ERV9QQUdF
X0xFTl9GQVVMVF9GQUlMOworCisgICAgb3V0YnVmWzBdID0gTU9ERV9QQUdFX0ZBVUxUX0ZBSUw7
CisgICAgb3V0YnVmWzFdID0gQ0RfTU9ERV9QQUdFX0xFTl9GQVVMVF9GQUlMIC0gMjsKKyAgICBv
dXRidWZbMl0gfD0gQ0RfTU9ERV9QQUdFX0ZBVUxUX0ZBSUxfRkxBR19QRVJGOworCisgICAgcmV0
dXJuIHBhZ2VfbGVuOworfQorCisjZGVmaW5lIENEX01PREVfUEFHRV9MRU5fQ0FQU19NRUNIX1NU
QVRVU19STyAgICAyNgorLyogYnl0ZSAyICovCisjZGVmaW5lIENEX01PREVfUEFHRV9DQVBTX0NE
X1JfUkVBRCAgICAgICAgICAgICAweDAxCisjZGVmaW5lIENEX01PREVfUEFHRV9DQVBTX0NEX1JX
X1JFQUQgICAgICAgICAgICAoMHgwMSA8PCAxKQorI2RlZmluZSBDRF9NT0RFX1BBR0VfQ0FQU19E
VkRfUk9NX1JFQUQgICAgICAgICAgKDB4MDEgPDwgMykKKyNkZWZpbmUgQ0RfTU9ERV9QQUdFX0NB
UFNfRFZEX1JfUkVBRCAgICAgICAgICAgICgweDAxIDw8IDQpCisjZGVmaW5lIENEX01PREVfUEFH
RV9DQVBTX0RWRF9SQU1fUkVBRCAgICAgICAgICAoMHgwMSA8PCA1KQorLyogYnl0ZSA2ICovCisj
ZGVmaW5lIENEX01PREVfUEFHRV9DQVBTX0xPQ0tfU1VQUE9SVCAgICAgICAgICAoMHgwMSkKKyNk
ZWZpbmUgQ0RfTU9ERV9QQUdFX0NBUFNfTE9DS19TVEFURSAgICAgICAgICAgICgweDAxIDw8IDEp
CisjZGVmaW5lIENEX01PREVfUEFHRV9DQVBTX1BSRVZFTlRfSlVNUEVSICAgICAgICAoMHgwMSA8
PCAyKQorI2RlZmluZSBDRF9NT0RFX1BBR0VfQ0FQU19FSkVDVCAgICAgICAgICAgICAgICAgKDB4
MDEgPDwgMykKKyNkZWZpbmUgQ0RfTU9ERV9QQUdFX0NBUFNfTE9BRElOR19UUkFZICAgICAgICAg
ICgweDAxIDw8IDUpCisKK3N0YXRpYyB1aW50MzJfdCBjZF9zY3NpX2FkZF9tb2RlX3BhZ2VfY2Fw
c19tZWNoX3N0YXR1cyhDZFNjc2lMVSAqZGV2LCB1aW50OF90ICpvdXRidWYpCit7CisgICAgdWlu
dDMyX3QgcGFnZV9sZW4gPSBDRF9NT0RFX1BBR0VfTEVOX0NBUFNfTUVDSF9TVEFUVVNfUk87IC8q
IG5vIHdyaXRlICovCisKKyAgICBvdXRidWZbMF0gPSBNT0RFX1BBR0VfQ0FQU19NRUNIX1NUQVRV
UzsKKyAgICBvdXRidWZbMV0gPSBwYWdlX2xlbjsKKyAgICBvdXRidWZbMl0gPSBDRF9NT0RFX1BB
R0VfQ0FQU19DRF9SX1JFQUQgfCBDRF9NT0RFX1BBR0VfQ0FQU19DRF9SV19SRUFEIHwKKyAgICAg
ICAgICAgICAgICBDRF9NT0RFX1BBR0VfQ0FQU19EVkRfUk9NX1JFQUQgfCBDRF9NT0RFX1BBR0Vf
Q0FQU19EVkRfUl9SRUFEIHwKKyAgICAgICAgICAgICAgICBDRF9NT0RFX1BBR0VfQ0FQU19EVkRf
UkFNX1JFQUQ7CisgICAgb3V0YnVmWzZdID0gQ0RfTU9ERV9QQUdFX0NBUFNfTE9BRElOR19UUkFZ
IHwgQ0RfTU9ERV9QQUdFX0NBUFNfRUpFQ1QgfAorICAgICAgICAgICAgICAgIENEX01PREVfUEFH
RV9DQVBTX0xPQ0tfU1VQUE9SVDsKKyAgICBpZiAoZGV2LT5wcmV2ZW50X21lZGlhX3JlbW92YWwp
IHsKKyAgICAgICAgb3V0YnVmWzZdIHw9IENEX01PREVfUEFHRV9DQVBTX0xPQ0tfU1RBVEU7Cisg
ICAgfQorCisgICAgcmV0dXJuIHBhZ2VfbGVuOworfQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2Nt
ZF9tb2RlX3NlbnNlXzEwKENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAg
ICB1aW50OF90ICpvdXRidWYgPSByZXEtPmJ1ZjsKKyAgICBpbnQgbG9uZ19sYmEsIGRiZCwgcGFn
ZSwgc3ViX3BhZ2UsIHBjOworICAgIHVpbnQzMl90IHJlc3BfbGVuID0gQ0RfTU9ERV9QQVJBTV8x
MF9MRU5fSEVBREVSOworCisgICAgcmVxLT54ZmVyX2RpciA9IFNDU0lfWEZFUl9GUk9NX0RFVjsK
KworICAgIGxvbmdfbGJhID0gKHJlcS0+Y2RiWzFdID4+IDQpICYgMHgxOworICAgIGRiZCA9IChy
ZXEtPmNkYlsxXSA+PiAzKSAmIDB4MTsKKyAgICBwYWdlID0gcmVxLT5jZGJbMl0gJiAweDNmOwor
ICAgIHBjID0gcmVxLT5jZGJbMl0gPj4gNjsKKyAgICBzdWJfcGFnZSA9IHJlcS0+Y2RiWzNdOwor
CisgICAgcmVxLT5yZXFfbGVuID0gKHJlcS0+Y2RiWzddIDw8IDgpIHwgcmVxLT5jZGJbOF07CisK
KyAgICBtZW1zZXQob3V0YnVmLCAwLCByZXEtPnJlcV9sZW4pOworICAgIG91dGJ1ZlsyXSA9ICAw
OyAvKiBtZWRpdW0gdHlwZSAqLworCisgICAgc3dpdGNoIChwYWdlKSB7CisgICAgY2FzZSBNT0RF
X1BBR0VfUl9XX0VSUk9SOgorICAgICAgICAvKiBSZWFkL1dyaXRlIEVycm9yIFJlY292ZXJ5ICov
CisgICAgICAgIHJlc3BfbGVuICs9IGNkX3Njc2lfYWRkX21vZGVfcGFnZV9yd19lcnJvcl9yZWNv
dmVyeShkZXYsIG91dGJ1ZiArIHJlc3BfbGVuKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBN
T0RFX1BBR0VfUE9XRVI6CisgICAgICAgIC8qIFBvd2VyIENvbmRpc3Rpb25zICovCisgICAgICAg
IHJlc3BfbGVuICs9IGNkX3Njc2lfYWRkX21vZGVfcGFnZV9wb3dlcl9jb25kaXRpb24oZGV2LCBv
dXRidWYgKyByZXNwX2xlbik7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgTU9ERV9QQUdFX0ZB
VUxUX0ZBSUw6CisgICAgICAgIC8qIEZhdWx0IC8gRmFpbHVyZSBSZXBvcnRpbmcgQ29udHJvbCAq
LworICAgICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9tb2RlX3BhZ2VfZmF1bHRfcmVwb3J0
aW5nKGRldiwgb3V0YnVmICsgcmVzcF9sZW4pOworICAgICAgICBicmVhazsKKyAgICBjYXNlIE1P
REVfUEFHRV9DQVBTX01FQ0hfU1RBVFVTOgorICAgICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2Fk
ZF9tb2RlX3BhZ2VfY2Fwc19tZWNoX3N0YXR1cyhkZXYsIG91dGJ1ZiArIHJlc3BfbGVuKTsKKyAg
ICAgICAgYnJlYWs7CisKKyAgICAvKiBub3QgaW1wbGVtZW50ZWQgKi8KKyAgICBjYXNlIE1PREVf
UEFHRV9XUklURV9QQVJBTUVURVI6IC8qIFdyaXRlciBQYXJhbWV0ZXJzICovCisgICAgY2FzZSBN
T0RFX1BBR0VfTVJXOgorICAgIGNhc2UgTU9ERV9QQUdFX01SV19WRU5ET1I6IC8qIE1SVyAoTW91
bnQgUmFpbmllciBSZS13cml0YWJsZSBEaXNrcyAqLworICAgIGNhc2UgTU9ERV9QQUdFX0NEX0RF
VklDRTogLyogQ0QgRGV2aWNlIHBhcmFtZXRlcnMgKi8KKyAgICBjYXNlIE1PREVfUEFHRV9UT19Q
Uk9URUNUOiAvKiBUaW1lLW91dCBhbmQgUHJvdGVjdCAqLworICAgIGRlZmF1bHQ6CisgICAgICAg
IFNQSUNFX0RFQlVHKCJtb2RlX3NlbnNlXzEwLCBsdW46JXUiCisgICAgICAgICAgICAgICAgICAg
ICIgcGFnZSAweCV4IG5vdCBpbXBsZW1lbnRlZCIsCisgICAgICAgICAgICAgICAgICAgIHJlcS0+
bHVuLCAodW5zaWduZWQpcGFnZSk7CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNr
X2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX0lOVkFMSURfQ0RCX0ZJRUxEKTsKKyAgICAgICAg
cmV0dXJuOworICAgIH0KKworICAgIG91dGJ1ZlswXSA9ICgocmVzcF9sZW4gLSAyKSA+PiA4KSAm
IDB4ZmY7CisgICAgb3V0YnVmWzFdID0gKHJlc3BfbGVuIC0gMikgJiAweGZmOworCisgICAgcmVx
LT5pbl9sZW4gPSBNSU4ocmVxLT5yZXFfbGVuLCByZXNwX2xlbik7CisKKyAgICBTUElDRV9ERUJV
RygibW9kZV9zZW5zZV8xMCwgbHVuOiV1IgorICAgICAgICAgICAgICAgICIgbG9uZ19sYmEgJWQs
IGRiZCAlZCwgcGFnZSAlZCwgc3ViX3BhZ2UgJWQsIHBjICVkOyAiCisgICAgICAgICAgICAgICAg
InJlc3BfbGVuICV1IiwKKyAgICAgICAgICAgICAgICByZXEtPmx1biwgbG9uZ19sYmEsIGRiZCwg
cGFnZSwgc3ViX3BhZ2UsIHBjLCByZXNwX2xlbik7CisKKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0
ZV9nb29kKGRldiwgcmVxKTsKK30KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRfbW9kZV9zZWxl
Y3RfNihDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgdWludDhfdCAq
YmxvY2tfZGVzY19kYXRhLCAqbW9kZV9kYXRhOworICAgIHVpbnQzMl90IHBhZ2VfZm9ybWF0LCBz
YXZlX3BhZ2VzLCBsaXN0X2xlbjsgLyogY2RiICovCisgICAgdWludDMyX3QgbnVtX2Jsb2NrcyA9
IDAsIGJsb2NrX2xlbiA9IDA7IC8qIGJsb2NrIGRlc2NyaXB0b3IgKi8KKyAgICB1aW50MzJfdCBt
b2RlX2xlbiwgbWVkaXVtX3R5cGUsIGRldl9wYXJhbSwgYmxvY2tfZGVzY19sZW47IC8qIG1vZGUg
cGFyYW0gaGVhZGVyICovCisgICAgdWludDMyX3QgcGFnZV9udW0gPSAwLCBwYWdlX2xlbiA9IDA7
IC8qIG1vZGUgcGFnZSAqLworCisgICAgcGFnZV9mb3JtYXQgPSAocmVxLT5jZGJbMV0gPj4gNCkg
JiAweDE7CisgICAgc2F2ZV9wYWdlcyA9IHJlcS0+Y2RiWzFdICYgMHgxOworICAgIGxpc3RfbGVu
ID0gcmVxLT5jZGJbNF07CisKKyAgICBpZiAobGlzdF9sZW4gPiByZXEtPmJ1Zl9sZW4pIHsKKyAg
ICAgICAgU1BJQ0VfREVCVUcoIm1vZGVfc2VsZWN0XzYsIGx1bjoldSIKKyAgICAgICAgICAgICAg
ICAgICAgIiBwZjoldSBzcDoldSIKKyAgICAgICAgICAgICAgICAgICAgIiBsaXN0X2xlbjoldSBl
eGNlZWRzIGRhdGFfbGVuOiV1IiwKKyAgICAgICAgICAgICAgICAgICAgcmVxLT5sdW4sIHBhZ2Vf
Zm9ybWF0LCBzYXZlX3BhZ2VzLCBsaXN0X2xlbiwgcmVxLT5idWZfbGVuKTsKKyAgICAgICAgY2Rf
c2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfSU5WQUxJ
RF9QQVJBTV9MRU4pOworICAgICAgICByZXR1cm47CisgICAgfQorCisgICAgbW9kZV9sZW4gPSBy
ZXEtPmJ1ZlswXTsKKyAgICBtZWRpdW1fdHlwZSA9IHJlcS0+YnVmWzFdOworICAgIGRldl9wYXJh
bSA9IHJlcS0+YnVmWzJdOworICAgIGJsb2NrX2Rlc2NfbGVuID0gcmVxLT5idWZbM107CisKKyAg
ICBpZiAoYmxvY2tfZGVzY19sZW4pIHsKKyAgICAgICAgYmxvY2tfZGVzY19kYXRhID0gJnJlcS0+
YnVmW0NEX01PREVfUEFSQU1fNl9MRU5fSEVBREVSXTsKKyAgICAgICAgbnVtX2Jsb2NrcyA9IChi
bG9ja19kZXNjX2RhdGFbM10gPDwgMTYpIHwgKGJsb2NrX2Rlc2NfZGF0YVsyXSA8PCA4KSB8IGJs
b2NrX2Rlc2NfZGF0YVszXTsKKyAgICAgICAgYmxvY2tfbGVuID0gKGJsb2NrX2Rlc2NfZGF0YVs1
XSA8PCAxNikgfCAoYmxvY2tfZGVzY19kYXRhWzZdIDw8IDgpIHwgYmxvY2tfZGVzY19kYXRhWzdd
OworICAgIH0KKworICAgIGlmIChtb2RlX2xlbikgeworICAgICAgICBtb2RlX2RhdGEgPSAmcmVx
LT5idWZbQ0RfTU9ERV9QQVJBTV82X0xFTl9IRUFERVJdOworICAgICAgICBpZiAoYmxvY2tfZGVz
Y19sZW4pIHsKKyAgICAgICAgICAgIG1vZGVfZGF0YSArPSBibG9ja19kZXNjX2xlbjsKKyAgICAg
ICAgfQorICAgICAgICBwYWdlX251bSA9IG1vZGVfZGF0YVswXSAmIDB4M2Y7CisgICAgICAgIHBh
Z2VfbGVuID0gbW9kZV9kYXRhWzFdOworICAgIH0KKworICAgIFNQSUNFX0RFQlVHKCJtb2RlX3Nl
bGVjdF82LCBsdW46JXUiCisgICAgICAgICAgICAgICAgIiBwZjoldSBzcDoldSBsaXN0X2xlbjol
dSBkYXRhX2xlbjoldSIKKyAgICAgICAgICAgICAgICAiIG1vZGVfbGVuOiV1IG1lZGl1bToldSBk
ZXZfcGFyYW06JXUgYmxrX2Rlc2NfbGVuOiV1IgorICAgICAgICAgICAgICAgICIgbnVtX2Jsb2Nr
czoldSBibG9ja19sZW46JXUiCisgICAgICAgICAgICAgICAgIiBwYWdlX251bToldSBwYWdlX2xl
bjoldSIsCisgICAgICAgICAgICAgICAgcmVxLT5sdW4sIHBhZ2VfZm9ybWF0LCBzYXZlX3BhZ2Vz
LCBsaXN0X2xlbiwgcmVxLT5idWZfbGVuLAorICAgICAgICAgICAgICAgIG1vZGVfbGVuLCBtZWRp
dW1fdHlwZSwgZGV2X3BhcmFtLCBibG9ja19kZXNjX2xlbiwKKyAgICAgICAgICAgICAgICBudW1f
YmxvY2tzLCBibG9ja19sZW4sCisgICAgICAgICAgICAgICAgcGFnZV9udW0sIHBhZ2VfbGVuKTsK
KworICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2LCByZXEpOworfQorCitzdGF0aWMg
dm9pZCBjZF9zY3NpX2NtZF9tb2RlX3NlbGVjdF8xMChDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1
ZXN0ICpyZXEpCit7CisgICAgdWludDMyX3QgcGFnZV9mb3JtYXQsIHNhdmVfcGFnZXMsIGxpc3Rf
bGVuOworCisgICAgcGFnZV9mb3JtYXQgPSAocmVxLT5jZGJbMV0gPj4gNCkgJiAweDE7CisgICAg
c2F2ZV9wYWdlcyA9IHJlcS0+Y2RiWzFdICYgMHgxOworICAgIGxpc3RfbGVuID0gKHJlcS0+Y2Ri
WzddIDw8IDgpIHwgcmVxLT5jZGJbOF07CisKKyAgICBpZiAobGlzdF9sZW4gPiByZXEtPmJ1Zl9s
ZW4pIHsKKyAgICAgICAgU1BJQ0VfREVCVUcoIm1vZGVfc2VsZWN0XzEwLCBsdW46JXUgcGY6JXUg
c3A6JXUiCisgICAgICAgICAgICAgICAgICAgICIgbGlzdF9sZW46JXUgZXhjZWVkcyBkYXRhX2xl
bjoldSIsCisgICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBwYWdlX2Zvcm1hdCwgc2F2ZV9w
YWdlcywgbGlzdF9sZW4sIHJlcS0+YnVmX2xlbik7CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBs
ZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX0lOVkFMSURfUEFSQU1fTEVOKTsK
KyAgICAgICAgcmV0dXJuOworICAgIH0KKworICAgIFNQSUNFX0RFQlVHKCJtb2RlX3NlbGVjdF8x
MCwgbHVuOiV1IHBmOiV1IHNwOiV1IgorICAgICAgICAgICAgICAgICIgbGlzdF9sZW46JXUgZGF0
YV9sZW46JXUiLAorICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBwYWdlX2Zvcm1hdCwgc2F2ZV9w
YWdlcywgbGlzdF9sZW4sIHJlcS0+YnVmX2xlbik7CisKKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0
ZV9nb29kKGRldiwgcmVxKTsKK30KKworI2RlZmluZSBDRF9GRUFUVVJFX0hFQURFUl9MRU4gICAg
ICAgICAgICAgICA4CisjZGVmaW5lIENEX0ZFQVRVUkVfREVTQ19MRU4gICAgICAgICAgICAgICAg
IDQKKworI2RlZmluZSBDRF9QUk9GSUxFX0RFU0NfTEVOICAgICAgICAgICAgICAgICA0CisjZGVm
aW5lIENEX1BST0ZJTEVfQ1VSUkVOVCAgICAgICAgICAgICAgICAgIDB4MDEKKworLyogUHJvZmls
ZXMgTGlzdCAqLworI2RlZmluZSBDRF9GRUFUVVJFX05VTV9QUk9GSUxFU19MSVNUICAgICAgICAw
eDAwCisvKiBDb3JlIC0gQmFzaWMgRnVuY3Rpb25hbGl0eSAqLworI2RlZmluZSBDRF9GRUFUVVJF
X05VTV9DT1JFICAgICAgICAgICAgICAgICAweDAxCisvKiBNb3JwaGluZyAtIFRoZSBkZXZpY2Ug
Y2hhbmdlcyBpdHMgYmVoYXZpb3IgZHVlIHRvIGV4dGVybmFsIGV2ZW50cyAqLworI2RlZmluZSBD
RF9GRUFUVVJFX05VTV9NT1JQSCAgICAgICAgICAgICAgICAweDAyCisvKiBSZW1vdmFibGUgTWVk
aXVtIC0gVGhlIG1lZGl1bSBtYXkgYmUgcmVtb3ZlZCBmcm9tIHRoZSBkZXZpY2UgKi8KKyNkZWZp
bmUgQ0RfRkVBVFVSRV9OVU1fUkVNT1ZBQkxFICAgICAgICAgICAgMHgwMworLyogUmFuZG9tIFJl
YWRhYmxlIC0gUFA9MSBSZWFkIGFiaWxpdHkgZm9yIHN0b3JhZ2UgZGV2aWNlcyB3aXRoIHJhbmRv
bSBhZGRyZXNzaW5nICovCisjZGVmaW5lIENEX0ZFQVRVUkVfTlVNX1JBTkRPTV9SRUFEICAgICAg
ICAgIDB4MTAKKy8qIENEIFJlYWQgLSBUaGUgYWJpbGl0eSB0byByZWFkIENEIHNwZWNpZmljIHN0
cnVjdHVyZXMgKi8KKyNkZWZpbmUgQ0RfRkVBVFVSRV9OVU1fQ0RfUkVBRCAgICAgICAgICAgICAg
MHgxRQorLyogRFZEIFJlYWQgLSBUaGUgYWJpbGl0eSB0byByZWFkIERWRCBzcGVjaWZpYyBzdHJ1
Y3R1cmVzICovCisjZGVmaW5lIENEX0ZFQVRVUkVfTlVNX0RWRF9SRUFEICAgICAgICAgICAgIDB4
MUYKKy8qIFBvd2VyIE1hbmFnZW1lbnQgLSBJbml0aWF0b3IgYW5kIGRldmljZSBkaXJlY3RlZCBw
b3dlciBtYW5hZ2VtZW50ICovCisjZGVmaW5lIENEX0ZFQVRVUkVfTlVNX1BPV0VSX01OR1QgICAg
ICAgICAgIDB4MTAwCisvKiBUaW1lb3V0ICovCisjZGVmaW5lIENEX0ZFQVRVUkVfTlVNX1RJTUVP
VVQgICAgICAgICAgICAgIDB4MTA1CisKKyNkZWZpbmUgQ0RfRkVBVFVSRV9SRVFfQUxMICAgICAg
ICAgICAgICAgICAgMAorI2RlZmluZSBDRF9GRUFUVVJFX1JFUV9DVVJSRU5UICAgICAgICAgICAg
ICAxCisjZGVmaW5lIENEX0ZFQVRVUkVfUkVRX1NJTkdMRSAgICAgICAgICAgICAgIDIKKworI2Rl
ZmluZSBDRF9GRUFUVVJFX0NVUlJFTlQgICAgICAgICAgICAgICAgICAweDAxCisjZGVmaW5lIENE
X0ZFQVRVUkVfUEVSU0lTVEVOVCAgICAgICAgICAgICAgIDB4MDIKKworI2RlZmluZSBDRF9GRUFU
VVJFX1ZFUlNJT05fMSAgICAgICAgICAgICAgICAoMHgwMSA8PCAyKQorCisjZGVmaW5lIENEX0ZF
QVRVUkVfUEhZU19JRl9TQ1NJICAgICAgICAgICAgIDB4MDEKKworI2RlZmluZSBDRF9GRUFUVVJF
X1JFTU9WQUJMRV9MT0FESU5HX1RSQVkgICAoMHgwMSA8PCA1KQorI2RlZmluZSBDRF9GRUFUVVJF
X1JFTU9WQUJMRV9FSkVDVCAgICAgICAgICAoMHgwMSA8PCAzKQorI2RlZmluZSBDRF9GRUFUVVJF
X1JFTU9WQUJMRV9OT19QUlZOVF9KTVBSICAoMHgwMSA8PCAyKQorI2RlZmluZSBDRF9GRUFUVVJF
X1JFTU9WQUJMRV9MT0NLICAgICAgICAgICAoMHgwMSkKKworc3RhdGljIGdib29sZWFuIGNkX3Nj
c2lfZmVhdHVyZV9yZXBvcnRhYmxlKHVpbnQzMl90IGZlYXR1cmUsIHVpbnQzMl90IHN0YXJ0X2Zl
YXR1cmUsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDMy
X3QgcmVxX3R5cGUpCit7CisgICAgcmV0dXJuIChyZXFfdHlwZSA9PSBDRF9GRUFUVVJFX1JFUV9T
SU5HTEUgJiYgc3RhcnRfZmVhdHVyZSA9PSBmZWF0dXJlKSB8fAorICAgICAgICAgICAoZmVhdHVy
ZSA+PSBzdGFydF9mZWF0dXJlKTsKK30KKworc3RhdGljIHVpbnQzMl90IGNkX3Njc2lfYWRkX2Zl
YXR1cmVfcHJvZmlsZXNfbGlzdChDZFNjc2lMVSAqZGV2LCB1aW50OF90ICpvdXRidWYsCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IHN0
YXJ0X2ZlYXR1cmUsIHVpbnQzMl90IHJlcV90eXBlKQoreworICAgIHVpbnQ4X3QgKnByb2ZpbGUg
PSBvdXRidWYgKyBDRF9GRUFUVVJFX0RFU0NfTEVOOworICAgIHVpbnQzMl90IGZlYXR1cmVfbGVu
ID0gQ0RfRkVBVFVSRV9ERVNDX0xFTjsKKyAgICB1aW50MzJfdCBhZGRfbGVuLCBwcm9maWxlX251
bTsKKworICAgIGlmICghY2Rfc2NzaV9mZWF0dXJlX3JlcG9ydGFibGUoQ0RfRkVBVFVSRV9OVU1f
UFJPRklMRVNfTElTVCwgc3RhcnRfZmVhdHVyZSwgcmVxX3R5cGUpKSB7CisgICAgICAgIHJldHVy
biAwOworICAgIH0KKyAgICAvKiBmZWF0dXJlIGRlc2NyaXB0b3IgaGVhZGVyICovCisgICAgb3V0
YnVmWzBdID0gKENEX0ZFQVRVUkVfTlVNX1BST0ZJTEVTX0xJU1QgPj4gOCkgJiAweGZmOworICAg
IG91dGJ1ZlsxXSA9IENEX0ZFQVRVUkVfTlVNX1BST0ZJTEVTX0xJU1QgJiAweGZmOworICAgIG91
dGJ1ZlsyXSA9IENEX0ZFQVRVUkVfUEVSU0lTVEVOVCB8IENEX0ZFQVRVUkVfQ1VSUkVOVDsKKwor
ICAgIC8qIERWRC1ST00gcHJvZmlsZSBkZXNjcmlwdG9yICovCisgICAgYWRkX2xlbiA9IENEX1BS
T0ZJTEVfREVTQ19MRU47IC8qIHN0YXJ0IHdpdGggc2luZ2xlIHByb2ZpbGUsIGFkZCBsYXRlciAq
LworICAgIHByb2ZpbGVfbnVtID0gTU1DX1BST0ZJTEVfRFZEX1JPTTsKKworICAgIHByb2ZpbGVb
MF0gPSAocHJvZmlsZV9udW0gPj4gOCkgJiAweGZmOyAvKiBmZWF0dXJlIGNvZGUgKi8KKyAgICBw
cm9maWxlWzFdID0gcHJvZmlsZV9udW0gJiAweGZmOworICAgIHByb2ZpbGVbMl0gPSAoIWRldi0+
Y2Rfcm9tKSA/IENEX1BST0ZJTEVfQ1VSUkVOVCA6IDA7CisKKyAgICAvKiBuZXh0IHByb2ZpbGUg
Ki8KKyAgICBhZGRfbGVuICs9IENEX1BST0ZJTEVfREVTQ19MRU47CisgICAgcHJvZmlsZSArPSBD
RF9QUk9GSUxFX0RFU0NfTEVOOworCisgICAgLyogQ0QtUk9NIHByb2ZpbGUgZGVzY3JpcHRvciAq
LworICAgIHByb2ZpbGVfbnVtID0gTU1DX1BST0ZJTEVfQ0RfUk9NOworICAgIHByb2ZpbGVbMF0g
PSAocHJvZmlsZV9udW0gPj4gOCkgJiAweGZmOworICAgIHByb2ZpbGVbMV0gPSBwcm9maWxlX251
bSAmIDB4ZmY7CisgICAgcHJvZmlsZVsyXSA9IGRldi0+Y2Rfcm9tID8gQ0RfUFJPRklMRV9DVVJS
RU5UIDogMDsKKworICAgIG91dGJ1ZlszXSA9IGFkZF9sZW47CisgICAgZmVhdHVyZV9sZW4gKz0g
YWRkX2xlbjsKKworICAgIHJldHVybiBmZWF0dXJlX2xlbjsKK30KKworI2RlZmluZSBDRF9GRUFU
VVJFX0NPUkVfUEhZU19QUk9GSUxFX0xFTiAgICA0CisKK3N0YXRpYyB1aW50MzJfdCBjZF9zY3Np
X2FkZF9mZWF0dXJlX2NvcmUoQ2RTY3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVmLAorICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCBzdGFydF9mZWF0dXJl
LCB1aW50MzJfdCByZXFfdHlwZSkKK3sKKyAgICB1aW50OF90ICpwcm9maWxlID0gb3V0YnVmICsg
Q0RfRkVBVFVSRV9ERVNDX0xFTjsKKyAgICB1aW50MzJfdCBmZWF0dXJlX2xlbiA9IENEX0ZFQVRV
UkVfREVTQ19MRU4gKyBDRF9GRUFUVVJFX0NPUkVfUEhZU19QUk9GSUxFX0xFTjsKKworICAgIGlm
ICghY2Rfc2NzaV9mZWF0dXJlX3JlcG9ydGFibGUoQ0RfRkVBVFVSRV9OVU1fQ09SRSwgc3RhcnRf
ZmVhdHVyZSwgcmVxX3R5cGUpKSB7CisgICAgICAgIHJldHVybiAwOworICAgIH0KKyAgICBvdXRi
dWZbMF0gPSAoQ0RfRkVBVFVSRV9OVU1fQ09SRSA+PiA4KSAmIDB4ZmY7CisgICAgb3V0YnVmWzFd
ID0gQ0RfRkVBVFVSRV9OVU1fQ09SRSAmIDB4ZmY7CisgICAgb3V0YnVmWzJdID0gQ0RfRkVBVFVS
RV9QRVJTSVNURU5UIHwgQ0RfRkVBVFVSRV9DVVJSRU5UOworICAgIG91dGJ1ZlszXSA9IENEX0ZF
QVRVUkVfQ09SRV9QSFlTX1BST0ZJTEVfTEVOOworCisgICAgcHJvZmlsZVszXSA9IENEX0ZFQVRV
UkVfUEhZU19JRl9TQ1NJOworCisgICAgcmV0dXJuIGZlYXR1cmVfbGVuOworfQorCisjZGVmaW5l
IENEX0ZFQVRVUkVfTU9SUEhfUFJPR0lMRV9MRU4gICAgNAorI2RlZmluZSBDRF9GRUFUVVJFX01P
UlBIX0FTWU5DX0VWRU5UUyAgIDB4MDEKKworc3RhdGljIHVpbnQzMl90IGNkX3Njc2lfYWRkX2Zl
YXR1cmVfbW9ycGgoQ2RTY3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVmLAorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyX3Qgc3RhcnRfZmVhdHVyZSwgdWlu
dDMyX3QgcmVxX3R5cGUpCit7CisgICAgdWludDhfdCAqcHJvZmlsZSA9IG91dGJ1ZiArIENEX0ZF
QVRVUkVfREVTQ19MRU47CisgICAgdWludDMyX3QgZmVhdHVyZV9sZW4gPSBDRF9GRUFUVVJFX0RF
U0NfTEVOICsgQ0RfRkVBVFVSRV9NT1JQSF9QUk9HSUxFX0xFTjsKKworICAgIGlmICghY2Rfc2Nz
aV9mZWF0dXJlX3JlcG9ydGFibGUoQ0RfRkVBVFVSRV9OVU1fTU9SUEgsIHN0YXJ0X2ZlYXR1cmUs
IHJlcV90eXBlKSkgeworICAgICAgICByZXR1cm4gMDsKKyAgICB9CisgICAgb3V0YnVmWzFdID0g
Q0RfRkVBVFVSRV9OVU1fTU9SUEg7CisgICAgb3V0YnVmWzJdID0gQ0RfRkVBVFVSRV9QRVJTSVNU
RU5UIHwgQ0RfRkVBVFVSRV9DVVJSRU5UOworICAgIG91dGJ1ZlszXSA9IENEX0ZFQVRVUkVfTU9S
UEhfUFJPR0lMRV9MRU47CisKKyAgICBwcm9maWxlWzBdID0gQ0RfRkVBVFVSRV9NT1JQSF9BU1lO
Q19FVkVOVFM7CisKKyAgICByZXR1cm4gZmVhdHVyZV9sZW47Cit9CisKKyNkZWZpbmUgQ0RfRkVB
VFVSRV9SRU1PVkFCTEVfUFJPRklMRV9MRU4gICAgNAorCitzdGF0aWMgdWludDMyX3QgY2Rfc2Nz
aV9hZGRfZmVhdHVyZV9yZW1vdmFibGUoQ2RTY3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVmLAor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IHN0
YXJ0X2ZlYXR1cmUsIHVpbnQzMl90IHJlcV90eXBlKQoreworICAgIHVpbnQ4X3QgKnByb2ZpbGUg
PSBvdXRidWYgKyBDRF9GRUFUVVJFX0RFU0NfTEVOOworICAgIHVpbnQzMl90IGZlYXR1cmVfbGVu
ID0gQ0RfRkVBVFVSRV9ERVNDX0xFTiArIENEX0ZFQVRVUkVfUkVNT1ZBQkxFX1BST0ZJTEVfTEVO
OworCisgICAgaWYgKCFjZF9zY3NpX2ZlYXR1cmVfcmVwb3J0YWJsZShDRF9GRUFUVVJFX05VTV9S
RU1PVkFCTEUsIHN0YXJ0X2ZlYXR1cmUsIHJlcV90eXBlKSkgeworICAgICAgICByZXR1cm4gMDsK
KyAgICB9CisgICAgb3V0YnVmWzFdID0gQ0RfRkVBVFVSRV9OVU1fUkVNT1ZBQkxFOworICAgIG91
dGJ1ZlsyXSA9IENEX0ZFQVRVUkVfUEVSU0lTVEVOVCB8IENEX0ZFQVRVUkVfQ1VSUkVOVDsKKyAg
ICBvdXRidWZbM10gPSBDRF9GRUFUVVJFX1JFTU9WQUJMRV9QUk9GSUxFX0xFTjsKKworICAgIHBy
b2ZpbGVbMF0gPSBDRF9GRUFUVVJFX1JFTU9WQUJMRV9OT19QUlZOVF9KTVBSOworICAgIGlmIChk
ZXYtPnJlbW92YWJsZSkgeworICAgICAgICBwcm9maWxlWzBdIHw9IChDRF9GRUFUVVJFX1JFTU9W
QUJMRV9MT0FESU5HX1RSQVkgfCBDRF9GRUFUVVJFX1JFTU9WQUJMRV9FSkVDVCk7CisgICAgfQor
CisgICAgcmV0dXJuIGZlYXR1cmVfbGVuOworfQorCisjZGVmaW5lIENEX0ZFQVRVUkVfUkFORE9N
X1JFQURfUFJPRklMRV9MRU4gICAgOAorCitzdGF0aWMgdWludDMyX3QgY2Rfc2NzaV9hZGRfZmVh
dHVyZV9yYW5kb21fcmVhZChDZFNjc2lMVSAqZGV2LCB1aW50OF90ICpvdXRidWYsCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCBzdGFydF9m
ZWF0dXJlLCB1aW50MzJfdCByZXFfdHlwZSkKK3sKKyAgICB1aW50OF90ICpwcm9maWxlID0gb3V0
YnVmICsgQ0RfRkVBVFVSRV9ERVNDX0xFTjsKKyAgICB1aW50MzJfdCBmZWF0dXJlX2xlbiA9IENE
X0ZFQVRVUkVfREVTQ19MRU4gKyBDRF9GRUFUVVJFX1JBTkRPTV9SRUFEX1BST0ZJTEVfTEVOOwor
CisgICAgaWYgKCFjZF9zY3NpX2ZlYXR1cmVfcmVwb3J0YWJsZShDRF9GRUFUVVJFX05VTV9SQU5E
T01fUkVBRCwgc3RhcnRfZmVhdHVyZSwgcmVxX3R5cGUpKSB7CisgICAgICAgIHJldHVybiAwOwor
ICAgIH0KKyAgICBvdXRidWZbMF0gPSAoQ0RfRkVBVFVSRV9OVU1fUkFORE9NX1JFQUQgPj4gOCkg
JiAweGZmOworICAgIG91dGJ1ZlsxXSA9IENEX0ZFQVRVUkVfTlVNX1JBTkRPTV9SRUFEICYgMHhm
ZjsKKyAgICBvdXRidWZbMl0gPSBDRF9GRUFUVVJFX1BFUlNJU1RFTlQgfCBDRF9GRUFUVVJFX0NV
UlJFTlQ7CisgICAgb3V0YnVmWzNdID0gQ0RfRkVBVFVSRV9SQU5ET01fUkVBRF9QUk9GSUxFX0xF
TjsKKworICAgIHByb2ZpbGVbMF0gPSAoZGV2LT5ibG9ja19zaXplID4+IDI0KSAmIDB4ZmY7Cisg
ICAgcHJvZmlsZVsxXSA9IChkZXYtPmJsb2NrX3NpemUgPj4gMTYpICYgMHhmZjsKKyAgICBwcm9m
aWxlWzJdID0gKGRldi0+YmxvY2tfc2l6ZSA+PiA4KSAmIDB4ZmY7CisgICAgcHJvZmlsZVszXSA9
IChkZXYtPmJsb2NrX3NpemUpICYgMHhmZjsKKyAgICBwcm9maWxlWzVdID0gKGRldi0+Y2Rfcm9t
KSA/IDB4MDEgOiAweDEwOyAvKiBsb2dpY2FsIGJsb2NrcyBwZXIgcmVhZGFibGUgdW5pdCAqLwor
CisgICAgcmV0dXJuIGZlYXR1cmVfbGVuOworfQorCisjZGVmaW5lIENEX0ZFQVRVUkVfQ0RfUkVB
RF9QUk9GSUxFX0xFTiAgICA0CisKK3N0YXRpYyB1aW50MzJfdCBjZF9zY3NpX2FkZF9mZWF0dXJl
X2NkX3JlYWQoQ2RTY3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVmLAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCBzdGFydF9mZWF0dXJlLCB1aW50
MzJfdCByZXFfdHlwZSkKK3sKKyAgICB1aW50OF90ICpwcm9maWxlID0gb3V0YnVmICsgQ0RfRkVB
VFVSRV9ERVNDX0xFTjsKKyAgICB1aW50MzJfdCBmZWF0dXJlX2xlbiA9IENEX0ZFQVRVUkVfREVT
Q19MRU4gKyBDRF9GRUFUVVJFX0NEX1JFQURfUFJPRklMRV9MRU47CisKKyAgICBpZiAoIWNkX3Nj
c2lfZmVhdHVyZV9yZXBvcnRhYmxlKENEX0ZFQVRVUkVfTlVNX0NEX1JFQUQsIHN0YXJ0X2ZlYXR1
cmUsIHJlcV90eXBlKSkgeworICAgICAgICByZXR1cm4gMDsKKyAgICB9CisgICAgb3V0YnVmWzBd
ID0gKENEX0ZFQVRVUkVfTlVNX0NEX1JFQUQgPj4gOCkgJiAweGZmOworICAgIG91dGJ1ZlsxXSA9
IChDRF9GRUFUVVJFX05VTV9DRF9SRUFEKSAmIDB4ZmY7CisgICAgb3V0YnVmWzJdID0gQ0RfRkVB
VFVSRV9WRVJTSU9OXzEgfCBDRF9GRUFUVVJFX1BFUlNJU1RFTlQgfCBDRF9GRUFUVVJFX0NVUlJF
TlQ7CisgICAgb3V0YnVmWzNdID0gQ0RfRkVBVFVSRV9DRF9SRUFEX1BST0ZJTEVfTEVOOworCisg
ICAgcHJvZmlsZVswXSA9IDA7IC8qIEMyIEVycm9ycywgQ0QtVGV4dCBub3Qgc3VwcG9ydGUgKi8K
KworICAgIHJldHVybiBmZWF0dXJlX2xlbjsKK30KKworI2RlZmluZSBDRF9GRUFUVVJFX0RWRF9S
RUFEX1BST0ZJTEVfTEVOICAgIDAKKworc3RhdGljIHVpbnQzMl90IGNkX3Njc2lfYWRkX2ZlYXR1
cmVfZHZkX3JlYWQoQ2RTY3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVmLAorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyX3Qgc3RhcnRfZmVhdHVyZSwg
dWludDMyX3QgcmVxX3R5cGUpCit7CisgICAgdWludDMyX3QgZmVhdHVyZV9sZW4gPSBDRF9GRUFU
VVJFX0RFU0NfTEVOICsgQ0RfRkVBVFVSRV9EVkRfUkVBRF9QUk9GSUxFX0xFTjsKKworICAgIGlm
ICghY2Rfc2NzaV9mZWF0dXJlX3JlcG9ydGFibGUoQ0RfRkVBVFVSRV9OVU1fQ0RfUkVBRCwgc3Rh
cnRfZmVhdHVyZSwgcmVxX3R5cGUpKSB7CisgICAgICAgIHJldHVybiAwOworICAgIH0KKyAgICBv
dXRidWZbMF0gPSAoQ0RfRkVBVFVSRV9OVU1fRFZEX1JFQUQgPj4gOCkgJiAweGZmOworICAgIG91
dGJ1ZlsxXSA9IChDRF9GRUFUVVJFX05VTV9EVkRfUkVBRCkgJiAweGZmOworICAgIG91dGJ1Zlsy
XSA9IENEX0ZFQVRVUkVfVkVSU0lPTl8xIHwgQ0RfRkVBVFVSRV9QRVJTSVNURU5UIHwgQ0RfRkVB
VFVSRV9DVVJSRU5UOworICAgIG91dGJ1ZlszXSA9IENEX0ZFQVRVUkVfRFZEX1JFQURfUFJPRklM
RV9MRU47CisKKyAgICByZXR1cm4gZmVhdHVyZV9sZW47Cit9CisKKyNkZWZpbmUgQ0RfRkVBVFVS
RV9QT1dFUl9NTkdUX1BST0ZJTEVfTEVOICAgIDAKKworc3RhdGljIHVpbnQzMl90IGNkX3Njc2lf
YWRkX2ZlYXR1cmVfcG93ZXJfbWdtdChDZFNjc2lMVSAqZGV2LCB1aW50OF90ICpvdXRidWYsCisg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IHN0
YXJ0X2ZlYXR1cmUsIHVpbnQzMl90IHJlcV90eXBlKQoreworICAgIHVpbnQzMl90IGZlYXR1cmVf
bGVuID0gQ0RfRkVBVFVSRV9ERVNDX0xFTiArIENEX0ZFQVRVUkVfUE9XRVJfTU5HVF9QUk9GSUxF
X0xFTjsKKworICAgIGlmICghY2Rfc2NzaV9mZWF0dXJlX3JlcG9ydGFibGUoQ0RfRkVBVFVSRV9O
VU1fUE9XRVJfTU5HVCwgc3RhcnRfZmVhdHVyZSwgcmVxX3R5cGUpKSB7CisgICAgICAgIHJldHVy
biAwOworICAgIH0KKyAgICBvdXRidWZbMF0gPSAoQ0RfRkVBVFVSRV9OVU1fUE9XRVJfTU5HVCA+
PiA4KSAmIDB4ZmY7CisgICAgb3V0YnVmWzFdID0gKENEX0ZFQVRVUkVfTlVNX1BPV0VSX01OR1Qp
ICYgMHhmZjsKKyAgICBvdXRidWZbMl0gPSBDRF9GRUFUVVJFX1BFUlNJU1RFTlQgfCBDRF9GRUFU
VVJFX0NVUlJFTlQ7CisgICAgb3V0YnVmWzNdID0gQ0RfRkVBVFVSRV9QT1dFUl9NTkdUX1BST0ZJ
TEVfTEVOOworCisgICAgcmV0dXJuIGZlYXR1cmVfbGVuOworfQorCisjZGVmaW5lIENEX0ZFQVRV
UkVfVElNRU9VVF9QUk9GSUxFX0xFTiAgICAwCisKK3N0YXRpYyB1aW50MzJfdCBjZF9zY3NpX2Fk
ZF9mZWF0dXJlX3RpbWVvdXQoQ2RTY3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVmLAorICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCBzdGFydF9mZWF0
dXJlLCB1aW50MzJfdCByZXFfdHlwZSkKK3sKKyAgICB1aW50MzJfdCBmZWF0dXJlX2xlbiA9IENE
X0ZFQVRVUkVfREVTQ19MRU4gKyBDRF9GRUFUVVJFX1RJTUVPVVRfUFJPRklMRV9MRU47CisKKyAg
ICBpZiAoIWNkX3Njc2lfZmVhdHVyZV9yZXBvcnRhYmxlKENEX0ZFQVRVUkVfTlVNX1RJTUVPVVQs
IHN0YXJ0X2ZlYXR1cmUsIHJlcV90eXBlKSkgeworICAgICAgICByZXR1cm4gMDsKKyAgICB9Cisg
ICAgb3V0YnVmWzBdID0gKENEX0ZFQVRVUkVfTlVNX1RJTUVPVVQgPj4gOCkgJiAweGZmOworICAg
IG91dGJ1ZlsxXSA9IENEX0ZFQVRVUkVfTlVNX1RJTUVPVVQgJiAweGZmOworICAgIG91dGJ1Zlsy
XSA9IENEX0ZFQVRVUkVfUEVSU0lTVEVOVCB8IENEX0ZFQVRVUkVfQ1VSUkVOVDsKKyAgICBvdXRi
dWZbM10gPSBDRF9GRUFUVVJFX1RJTUVPVVRfUFJPRklMRV9MRU47CisKKyAgICByZXR1cm4gZmVh
dHVyZV9sZW47Cit9CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX2dldF9jb25maWd1cmF0aW9u
KENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICB1aW50OF90ICpvdXRi
dWYgPSByZXEtPmJ1ZjsKKyAgICB1aW50MzJfdCBwcm9maWxlX251bSA9ICghZGV2LT5jZF9yb20p
ID8gTU1DX1BST0ZJTEVfRFZEX1JPTSA6IE1NQ19QUk9GSUxFX0NEX1JPTTsKKyAgICB1aW50MzJf
dCByZXFfdHlwZSwgc3RhcnRfZmVhdHVyZSwgcmVzcF9sZW47CisKKyAgICByZXEtPnhmZXJfZGly
ID0gU0NTSV9YRkVSX0ZST01fREVWOworCisgICAgcmVxX3R5cGUgPSByZXEtPmNkYlsxXSAmIDB4
MzsKKyAgICBzdGFydF9mZWF0dXJlID0gKHJlcS0+Y2RiWzJdIDw8IDgpIHwgcmVxLT5jZGJbM107
CisgICAgcmVxLT5yZXFfbGVuID0gKHJlcS0+Y2RiWzddIDw8IDgpIHwgcmVxLT5jZGJbOF07CisK
KyAgICBtZW1zZXQob3V0YnVmLCAwLCByZXEtPnJlcV9sZW4pOworCisgICAgLyogYXQgbGVhc3Qg
RmVhdHVyZSBIZWFkZXIgc2hvdWxkIGJlIHByZXNlbnQsIHRvIGJlIGZpbGxlZCBsYXRlciAqLwor
ICAgIHJlc3BfbGVuID0gQ0RfRkVBVFVSRV9IRUFERVJfTEVOOworCisgICAgc3dpdGNoIChyZXFf
dHlwZSkgeworICAgIGNhc2UgQ0RfRkVBVFVSRV9SRVFfQUxMOgorICAgIGNhc2UgQ0RfRkVBVFVS
RV9SRVFfQ1VSUkVOVDoKKyAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9hZGRfZmVhdHVyZV9w
cm9maWxlc19saXN0KGRldiwgb3V0YnVmICsgcmVzcF9sZW4sIHN0YXJ0X2ZlYXR1cmUsCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXFfdHlw
ZSk7CisgICAgICAgIHJlc3BfbGVuICs9IGNkX3Njc2lfYWRkX2ZlYXR1cmVfY29yZShkZXYsIG91
dGJ1ZiArIHJlc3BfbGVuLCBzdGFydF9mZWF0dXJlLCByZXFfdHlwZSk7CisgICAgICAgIHJlc3Bf
bGVuICs9IGNkX3Njc2lfYWRkX2ZlYXR1cmVfbW9ycGgoZGV2LCBvdXRidWYgKyByZXNwX2xlbiwg
c3RhcnRfZmVhdHVyZSwgcmVxX3R5cGUpOworICAgICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2Fk
ZF9mZWF0dXJlX3JlbW92YWJsZShkZXYsIG91dGJ1ZiArIHJlc3BfbGVuLCBzdGFydF9mZWF0dXJl
LCByZXFfdHlwZSk7CisgICAgICAgIHJlc3BfbGVuICs9IGNkX3Njc2lfYWRkX2ZlYXR1cmVfcmFu
ZG9tX3JlYWQoZGV2LCBvdXRidWYgKyByZXNwX2xlbiwgc3RhcnRfZmVhdHVyZSwKKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXFfdHlwZSk7Cisg
ICAgICAgIHJlc3BfbGVuICs9IGNkX3Njc2lfYWRkX2ZlYXR1cmVfY2RfcmVhZChkZXYsIG91dGJ1
ZiArIHJlc3BfbGVuLCBzdGFydF9mZWF0dXJlLCByZXFfdHlwZSk7CisgICAgICAgIHJlc3BfbGVu
ICs9IGNkX3Njc2lfYWRkX2ZlYXR1cmVfZHZkX3JlYWQoZGV2LCBvdXRidWYgKyByZXNwX2xlbiwg
c3RhcnRfZmVhdHVyZSwgcmVxX3R5cGUpOworICAgICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2Fk
ZF9mZWF0dXJlX3Bvd2VyX21nbXQoZGV2LCBvdXRidWYgKyByZXNwX2xlbiwgc3RhcnRfZmVhdHVy
ZSwgcmVxX3R5cGUpOworICAgICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9mZWF0dXJlX3Rp
bWVvdXQoZGV2LCBvdXRidWYgKyByZXNwX2xlbiwgc3RhcnRfZmVhdHVyZSwgcmVxX3R5cGUpOwor
ICAgICAgICBicmVhazsKKyAgICBjYXNlIENEX0ZFQVRVUkVfUkVRX1NJTkdMRToKKyAgICAgICAg
c3dpdGNoIChzdGFydF9mZWF0dXJlKSB7CisgICAgICAgIGNhc2UgQ0RfRkVBVFVSRV9OVU1fQ09S
RToKKyAgICAgICAgICAgIHJlc3BfbGVuICs9IGNkX3Njc2lfYWRkX2ZlYXR1cmVfY29yZShkZXYs
IG91dGJ1ZiArIHJlc3BfbGVuLCBzdGFydF9mZWF0dXJlLCByZXFfdHlwZSk7CisgICAgICAgICAg
ICBicmVhazsKKyAgICAgICAgY2FzZSBDRF9GRUFUVVJFX05VTV9NT1JQSDoKKyAgICAgICAgICAg
IHJlc3BfbGVuICs9IGNkX3Njc2lfYWRkX2ZlYXR1cmVfbW9ycGgoZGV2LCBvdXRidWYgKyByZXNw
X2xlbiwgc3RhcnRfZmVhdHVyZSwgcmVxX3R5cGUpOworICAgICAgICAgICAgYnJlYWs7CisgICAg
ICAgIGNhc2UgQ0RfRkVBVFVSRV9OVU1fUkVNT1ZBQkxFOgorICAgICAgICAgICAgcmVzcF9sZW4g
Kz0gY2Rfc2NzaV9hZGRfZmVhdHVyZV9yZW1vdmFibGUoZGV2LCBvdXRidWYgKyByZXNwX2xlbiwg
c3RhcnRfZmVhdHVyZSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHJlcV90eXBlKTsKKyAgICAgICAgICAgIGJyZWFrOworICAgICAgICBjYXNl
IENEX0ZFQVRVUkVfTlVNX1JBTkRPTV9SRUFEOgorICAgICAgICAgICAgcmVzcF9sZW4gKz0gY2Rf
c2NzaV9hZGRfZmVhdHVyZV9yYW5kb21fcmVhZChkZXYsIG91dGJ1ZiArIHJlc3BfbGVuLCBzdGFy
dF9mZWF0dXJlLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICByZXFfdHlwZSk7CisgICAgICAgICAgICBicmVhazsKKyAgICAgICAgY2FzZSBD
RF9GRUFUVVJFX05VTV9DRF9SRUFEOgorICAgICAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9h
ZGRfZmVhdHVyZV9jZF9yZWFkKGRldiwgb3V0YnVmICsgcmVzcF9sZW4sIHN0YXJ0X2ZlYXR1cmUs
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVx
X3R5cGUpOworICAgICAgICAgICAgYnJlYWs7CisgICAgICAgIGNhc2UgQ0RfRkVBVFVSRV9OVU1f
RFZEX1JFQUQ6CisgICAgICAgICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9mZWF0dXJlX2R2
ZF9yZWFkKGRldiwgb3V0YnVmICsgcmVzcF9sZW4sIHN0YXJ0X2ZlYXR1cmUsCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcV90eXBlKTsKKyAg
ICAgICAgICAgIGJyZWFrOworICAgICAgICBjYXNlIENEX0ZFQVRVUkVfTlVNX1BPV0VSX01OR1Q6
CisgICAgICAgICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9mZWF0dXJlX3Bvd2VyX21nbXQo
ZGV2LCBvdXRidWYgKyByZXNwX2xlbiwgc3RhcnRfZmVhdHVyZSwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXFfdHlwZSk7CisgICAgICAg
ICAgICBicmVhazsKKyAgICAgICAgY2FzZSBDRF9GRUFUVVJFX05VTV9USU1FT1VUOgorICAgICAg
ICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9hZGRfZmVhdHVyZV90aW1lb3V0KGRldiwgb3V0YnVm
ICsgcmVzcF9sZW4sIHN0YXJ0X2ZlYXR1cmUsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgcmVxX3R5cGUpOworICAgICAgICAgICAgYnJlYWs7Cisg
ICAgICAgIGRlZmF1bHQ6CisgICAgICAgICAgICBicmVhazsKKyAgICAgICAgfQorICAgICAgICBi
cmVhazsKKworICAgIGRlZmF1bHQ6CisgICAgICAgIFNQSUNFX0RFQlVHKCJnZXRfY29uZmlndXJh
dGlvbiwgbHVuOiV1IGludmFsaWQgcnQ6JXUgc3RhcnRfZjoldSIsCisgICAgICAgICAgICAgICAg
ICAgIHJlcS0+bHVuLCByZXFfdHlwZSwgc3RhcnRfZmVhdHVyZSk7CisgICAgICAgIGNkX3Njc2lf
Y21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX0lOVkFMSURfQ0RC
X0ZJRUxEKTsKKyAgICAgICAgcmV0dXJuOworICAgIH0KKworICAgIC8qIHNldCB0b3RhbCBkYXRh
IGxlbiAqLworICAgIG91dGJ1ZlswXSA9IChyZXNwX2xlbiA+PiAyNCkgJiAweGZmOworICAgIG91
dGJ1ZlsxXSA9IChyZXNwX2xlbiA+PiAxNikgJiAweGZmOworICAgIG91dGJ1ZlsyXSA9IChyZXNw
X2xlbiA+PiA4KSAmIDB4ZmY7CisgICAgb3V0YnVmWzNdID0gcmVzcF9sZW4gJiAweGZmOworCisg
ICAgLyogcmVwb3J0IGN1cnJlbnQgcHJvZmlsZSBudW0gKi8KKyAgICBvdXRidWZbNl0gPSAocHJv
ZmlsZV9udW0gPj4gOCkgJiAweGZmOworICAgIG91dGJ1Zls3XSA9IHByb2ZpbGVfbnVtICYgMHhm
ZjsKKworICAgIHJlcS0+aW5fbGVuID0gTUlOKHJlcS0+cmVxX2xlbiwgcmVzcF9sZW4pOworCisg
ICAgU1BJQ0VfREVCVUcoImdldF9jb25maWd1cmF0aW9uLCBsdW46JXUgcnQ6JXUgc3RhcnRfZjol
dSByZXNwX2xlbjoldSIsCisgICAgICAgICAgICAgICAgcmVxLT5sdW4sIHJlcV90eXBlLCBzdGFy
dF9mZWF0dXJlLCByZXNwX2xlbik7CisKKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRl
diwgcmVxKTsKK30KKworI2RlZmluZSBDRF9HRVRfRVZFTlRfU1RBVFVTX0lNTUVEICAgICAgICAg
ICAgMHgwMQorCisjZGVmaW5lIENEX0dFVF9FVkVOVF9IRUFERVJfTk9fRVZFTlRfQVZBSUwgICgw
eDAxIDw8IDcpCisjZGVmaW5lIENEX0dFVF9FVkVOVF9IRUFERVJfTEVOICAgICAgICAgICAgIDQK
KworI2RlZmluZSBDRF9HRVRfRVZFTlRfQ0xBU1NfTk9ORSAgICAgICAgICAgICAoMHgwMCkKKyNk
ZWZpbmUgQ0RfR0VUX0VWRU5UX0NMQVNTX09QRVJfQ0hBTkdFICAgICAgKDB4MDEpCisjZGVmaW5l
IENEX0dFVF9FVkVOVF9DTEFTU19QT1dFUl9NR01UICAgICAgICgweDAyKQorI2RlZmluZSBDRF9H
RVRfRVZFTlRfQ0xBU1NfRVhURVJOQUxfUkVRICAgICAoMHgwMykKKyNkZWZpbmUgQ0RfR0VUX0VW
RU5UX0NMQVNTX01FRElBICAgICAgICAgICAgKDB4MDQpCisjZGVmaW5lIENEX0dFVF9FVkVOVF9D
TEFTU19NVUxUSV9JTklUSUFUT1IgICgweDA1KQorI2RlZmluZSBDRF9HRVRfRVZFTlRfQ0xBU1Nf
REVWX0JVU1kgICAgICAgICAoMHgwNikKKworI2RlZmluZSBDRF9HRVRfRVZFTlRfTEVOX01FRElB
ICAgICAgICAgICAgICA0CisKKyNkZWZpbmUgQ0RfTUVESUFfU1RBVFVTX01FRElBX1BSRVNFTlQg
ICAgICAgMHgxCisjZGVmaW5lIENEX01FRElBX1NUQVRVU19UUkFZX09QRU4gICAgICAgICAgIDB4
MgorCitzdGF0aWMgdWludDMyX3QgY2Rfc2NzaV9jbWRfZ2V0X2V2ZW50X3Jlc3BfYWRkX21lZGlh
KENkU2NzaUxVICpkZXYsIHVpbnQ4X3QgKm91dGJ1ZikKK3sKKyAgICBvdXRidWZbMF0gPSAodWlu
dDhfdClkZXYtPm1lZGlhX2V2ZW50ICYgMHgwZjsKKyAgICBvdXRidWZbMV0gPSAodWludDhfdCko
KGRldi0+bG9hZGVkID8gMCA6IENEX01FRElBX1NUQVRVU19UUkFZX09QRU4pIHwKKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgKGRldi0+c3RyZWFtICE9IE5VTEwgPyBDRF9NRURJQV9TVEFUVVNf
TUVESUFfUFJFU0VOVCA6IDApKTsKKworICAgIGRldi0+bWVkaWFfZXZlbnQgPSBDRF9NRURJQV9F
VkVOVF9OT19DSEFOR0U7IC8qIHJlc2V0IHRoZSBldmVudCAqLworICAgIHJldHVybiBDRF9HRVRf
RVZFTlRfTEVOX01FRElBOworfQorCisjZGVmaW5lIENEX0dFVF9FVkVOVF9MRU5fUE9XRVIgICAg
ICAgICAgICAgIDQKKworI2RlZmluZSBDRF9QT1dFUl9TVEFUVVNfQUNUSVZFICAgICAgICAgICAg
ICAweDEKKyNkZWZpbmUgQ0RfUE9XRVJfU1RBVFVTX0lETEUgICAgICAgICAgICAgICAgMHgyCisK
K3N0YXRpYyB1aW50MzJfdCBjZF9zY3NpX2NtZF9nZXRfZXZlbnRfcmVzcF9hZGRfcG93ZXIoQ2RT
Y3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVmKQoreworICAgIG91dGJ1ZlswXSA9ICh1aW50OF90
KWRldi0+cG93ZXJfZXZlbnQgJiAweDBmOworICAgIG91dGJ1ZlsxXSA9ICh1aW50OF90KSgoZGV2
LT5wb3dlcl9jb25kID09IENEX1NDU0lfUE9XRVJfQUNUSVZFKSA/CisgICAgICAgICAgICAgICAg
ICAgICAgICAgICBDRF9QT1dFUl9TVEFUVVNfQUNUSVZFIDogQ0RfUE9XRVJfU1RBVFVTX0lETEUp
OworCisgICAgZGV2LT5wb3dlcl9ldmVudCA9IENEX1BPV0VSX0VWRU5UX05PX0NIQU5HRTsgLyog
cmVzZXQgdGhlIGV2ZW50ICovCisgICAgcmV0dXJuIENEX0dFVF9FVkVOVF9MRU5fUE9XRVI7Cit9
CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX2dldF9ldmVudF9zdGF0dXNfbm90aWZpY2F0aW9u
KENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICB1aW50OF90ICpvdXRi
dWYgPSByZXEtPmJ1ZjsKKyAgICB1aW50MzJfdCByZXNwX2xlbiA9IENEX0dFVF9FVkVOVF9IRUFE
RVJfTEVOOworICAgIGNvbnN0IHVpbnQzMl90IHBvd2VyX2NsYXNzX21hc2sgPSAoMHgwMSA8PCBD
RF9HRVRfRVZFTlRfQ0xBU1NfUE9XRVJfTUdNVCk7CisgICAgY29uc3QgdWludDMyX3QgbWVkaWFf
Y2xhc3NfbWFzayA9ICgweDAxIDw8IENEX0dFVF9FVkVOVF9DTEFTU19NRURJQSk7CisgICAgdWlu
dDMyX3QgY2xhc3Nlc19zdXBwb3J0ZWQgPSAgcG93ZXJfY2xhc3NfbWFzayB8IG1lZGlhX2NsYXNz
X21hc2s7CisgICAgdWludDMyX3QgaW1tZWQsIGNsYXNzZXNfcmVxdWVzdGVkOworCisgICAgcmVx
LT54ZmVyX2RpciA9IFNDU0lfWEZFUl9GUk9NX0RFVjsKKworICAgIGltbWVkID0gcmVxLT5jZGJb
MV0gJiBDRF9HRVRfRVZFTlRfU1RBVFVTX0lNTUVEOworICAgIGNsYXNzZXNfcmVxdWVzdGVkID0g
cmVxLT5jZGJbNF07CisgICAgcmVxLT5yZXFfbGVuID0gKHJlcS0+Y2RiWzddIDw8IDgpIHwgcmVx
LT5jZGJbOF07CisKKyAgICBpZiAoIWltbWVkKSB7CisgICAgICAgIFNQSUNFX0RFQlVHKCJnZXRf
ZXZlbnRfc3RhdHVzX25vdGlmaWNhdGlvbiwgbHVuOiV1IgorICAgICAgICAgICAgICAgICIgaW1t
OjAgY2xhc3NfcmVxOiUwMngsIE5vbi1pbW1lZGlhdGUgKGFzeW5jKSBtb2RlIHVuc3VwcG9ydGVk
IiwKKyAgICAgICAgICAgICAgICByZXEtPmx1biwgY2xhc3Nlc19yZXF1ZXN0ZWQpOworICAgICAg
ICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9J
TlZBTElEX0NEQl9GSUVMRCk7CisgICAgICAgIHJldHVybjsKKyAgICB9CisKKyAgICBtZW1zZXQo
b3V0YnVmLCAwLCByZXEtPnJlcV9sZW4pOworICAgIGlmICgoY2xhc3Nlc19zdXBwb3J0ZWQgJiBj
bGFzc2VzX3JlcXVlc3RlZCkgIT0gMCkgeworICAgICAgICBpZiAoY2xhc3Nlc19yZXF1ZXN0ZWQg
JiBwb3dlcl9jbGFzc19tYXNrKSB7CisgICAgICAgICAgICBvdXRidWZbMl0gPSBDRF9HRVRfRVZF
TlRfQ0xBU1NfUE9XRVJfTUdNVDsKKyAgICAgICAgICAgIG91dGJ1ZlszXSA9ICh1aW50OF90KXBv
d2VyX2NsYXNzX21hc2s7CisKKyAgICAgICAgICAgIFNQSUNFX0RFQlVHKCJnZXRfZXZlbnRfc3Rh
dHVzX25vdGlmaWNhdGlvbiwgbHVuOiV1IgorICAgICAgICAgICAgICAgICAgICAgICAgIiBpbW06
JXUgY2xhc3NfcmVxOjB4JTAyeCBjbGFzc19zdXA6MHglMDJ4IgorICAgICAgICAgICAgICAgICAg
ICAgICAgIiBwb3dlcl9ldmVudDoweCUwMnggcG93ZXJfY29uZDoweCUwMngiLAorICAgICAgICAg
ICAgICAgICAgICAgICAgcmVxLT5sdW4sIGltbWVkLCBjbGFzc2VzX3JlcXVlc3RlZCwgY2xhc3Nl
c19zdXBwb3J0ZWQsCisgICAgICAgICAgICAgICAgICAgICAgICBkZXYtPnBvd2VyX2V2ZW50LCBk
ZXYtPnBvd2VyX2NvbmQpOworCisgICAgICAgICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2NtZF9n
ZXRfZXZlbnRfcmVzcF9hZGRfcG93ZXIoZGV2LCBvdXRidWYgKyByZXNwX2xlbik7CisgICAgICAg
IH0gZWxzZSBpZiAoY2xhc3Nlc19yZXF1ZXN0ZWQgJiBtZWRpYV9jbGFzc19tYXNrKSB7CisgICAg
ICAgICAgICBvdXRidWZbMl0gPSBDRF9HRVRfRVZFTlRfQ0xBU1NfTUVESUE7CisgICAgICAgICAg
ICBvdXRidWZbM10gPSAodWludDhfdCltZWRpYV9jbGFzc19tYXNrOworCisgICAgICAgICAgICBT
UElDRV9ERUJVRygiZ2V0X2V2ZW50X3N0YXR1c19ub3RpZmljYXRpb24sIGx1bjoldSIKKyAgICAg
ICAgICAgICAgICAgICAgICAgICIgaW1tOiV1IGNsYXNzX3JlcToweCUwMnggY2xhc3Nfc3VwOjB4
JTAyeCIKKyAgICAgICAgICAgICAgICAgICAgICAgICIgbWVkaWFfZXZlbnQ6MHglMDJ4IGxvYWRl
ZDogJWQiLAorICAgICAgICAgICAgICAgICAgICAgICAgcmVxLT5sdW4sIGltbWVkLCBjbGFzc2Vz
X3JlcXVlc3RlZCwgY2xhc3Nlc19zdXBwb3J0ZWQsCisgICAgICAgICAgICAgICAgICAgICAgICBk
ZXYtPm1lZGlhX2V2ZW50LCBkZXYtPmxvYWRlZCk7CisKKyAgICAgICAgICAgIHJlc3BfbGVuICs9
IGNkX3Njc2lfY21kX2dldF9ldmVudF9yZXNwX2FkZF9tZWRpYShkZXYsIG91dGJ1ZiArIHJlc3Bf
bGVuKTsKKyAgICAgICAgfQorICAgIH0gZWxzZSB7CisgICAgICAgIG91dGJ1ZlsyXSA9IENEX0dF
VF9FVkVOVF9IRUFERVJfTk9fRVZFTlRfQVZBSUwgfCBDRF9HRVRfRVZFTlRfQ0xBU1NfTk9ORTsK
KworICAgICAgICBTUElDRV9ERUJVRygiZ2V0X2V2ZW50X3N0YXR1c19ub3RpZmljYXRpb24sIGx1
bjoldSIKKyAgICAgICAgICAgICAgICAgICAgIiBpbW06JXUgY2xhc3NfcmVxOjB4JTAyeCBjbGFz
c19zdXA6MHglMDJ4IgorICAgICAgICAgICAgICAgICAgICAiIG5vbmUgb2YgcmVxdWVzdGVkIGV2
ZW50cyBzdXBwb3J0ZWQiLAorICAgICAgICAgICAgICAgICAgICByZXEtPmx1biwgaW1tZWQsIGNs
YXNzZXNfcmVxdWVzdGVkLCBjbGFzc2VzX3N1cHBvcnRlZCk7CisgICAgfQorICAgIG91dGJ1Zlsx
XSA9ICh1aW50OF90KShyZXNwX2xlbiAtIDIpOyAvKiBFdmVudCBEYXRhIExlbmd0aCBMU0IsIGxl
bmd0aCBleGNsdWRpbmcgdGhlCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAqIGZpZWxkIGl0c2VsZiAqLworICAgIG91dGJ1ZlszXSA9ICh1aW50OF90KWNsYXNzZXNf
c3VwcG9ydGVkOworCisgICAgcmVxLT5pbl9sZW4gPSBNSU4ocmVxLT5yZXFfbGVuLCByZXNwX2xl
bik7CisgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfZ29vZChkZXYsIHJlcSk7Cit9CisKKyNkZWZp
bmUgQ0RfRVhUX1JFUV9FVkVOVF9GT1JNQVRfTk9fQ0hHICAgICAgICAgIDB4MDAKKyNkZWZpbmUg
Q0RfRVhUX1JFUV9FVkVOVF9GT1JNQVRfTFVfS0VZX0RPV04gICAgIDB4MDEKKyNkZWZpbmUgQ0Rf
RVhUX1JFUV9FVkVOVF9GT1JNQVRfTFVfS0VZX1VQICAgICAgIDB4MDIKKyNkZWZpbmUgQ0RfRVhU
X1JFUV9FVkVOVF9GT1JNQVRfUkVRX05PVElGWSAgICAgIDB4MDMKKworI2RlZmluZSBDRF9FWFRf
UkVRX1NUQVRVU19SRUFEWSAgICAgICAgICAgICAgICAgMHgwMAorI2RlZmluZSBDRF9FWFRfUkVR
X1NUQVRVU19PVEhFUl9QUkVWRU5UICAgICAgICAgMHgwMQorCisjZGVmaW5lIENEX0VYVF9SRVFf
Q09ERV9OT19SRVFVRVNUICAgICAgICAgICAgICAweDAwCisjZGVmaW5lIENEX0VYVF9SRVFfQ09E
RV9PVkVSUlVOICAgICAgICAgICAgICAgICAweDAxCisjZGVmaW5lIENEX0VYVF9SRVFfQ09ERV9Q
TEFZICAgICAgICAgICAgICAgICAgICAweDEwMQorI2RlZmluZSBDRF9FWFRfUkVRX0NPREVfUkVX
SU5EICAgICAgICAgICAgICAgICAgMHgxMDIKKyNkZWZpbmUgQ0RfRVhUX1JFUV9DT0RFX0ZBU1Rf
RlcgICAgICAgICAgICAgICAgIDB4MTAzCisjZGVmaW5lIENEX0VYVF9SRVFfQ09ERV9QQVVTRSAg
ICAgICAgICAgICAgICAgICAweDEwNAorI2RlZmluZSBDRF9FWFRfUkVRX0NPREVfU1RPUCAgICAg
ICAgICAgICAgICAgICAgMHgxMDYKKyNkZWZpbmUgQ0RfRVhUX1JFUV9DT0RFX0FTQ0lJX0JBU0Ug
ICAgICAgICAgICAgIDB4MjAwIC8qIFNDU0lJIHZhbHVlIGlzIExTQiAqLworCitzdGF0aWMgdm9p
ZCBjZF9zY3NpX2NtZF9zZW5kX2V2ZW50KENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJl
cSkKK3sKKyAgICB1aW50OF90ICpwYXJhbSwgKmV2ZW50OworICAgIHVpbnQzMl90IGltbWVkLCBw
YXJhbV9saXN0X2xlbjsKKyAgICB1aW50MzJfdCBldmVudF9wYXJhbV9sZW4sIG5vdGlmaWNhdGlv
bl9jbGFzczsKKyAgICB1aW50MzJfdCBleHRfcmVxX2V2ZW50LCBleHRfcmVxX3N0YXR1cywgcGVy
c19wcmV2ZW50LCBleHRfcmVxX2NvZGU7CisKKyAgICByZXEtPnhmZXJfZGlyID0gU0NTSV9YRkVS
X1RPX0RFVjsKKworICAgIGltbWVkID0gcmVxLT5jZGJbMV0gJiAweDAxOworICAgIHBhcmFtX2xp
c3RfbGVuID0gKHJlcS0+Y2RiWzhdIDw8IDgpIHwgcmVxLT5jZGJbOV07CisKKyAgICBpZiAocmVx
LT5idWZfbGVuIDwgcGFyYW1fbGlzdF9sZW4pIHsKKyAgICAgICAgU1BJQ0VfREVCVUcoInNlbmRf
ZXZlbnQsIGx1bjoldSBpbnZhbGlkIHBhcmFtIGxpc3QgbGVuOjB4JXgsIGJ1Zl9sZW46MHgleCIs
CisgICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBwYXJhbV9saXN0X2xlbiwgcmVxLT5idWZf
bGVuKTsKKyAgICAgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwg
JnNlbnNlX2NvZGVfSU5WQUxJRF9QQVJBTV9MRU4pOworICAgICAgICByZXR1cm47CisgICAgfQor
ICAgIHBhcmFtID0gcmVxLT5idWY7CisgICAgZXZlbnRfcGFyYW1fbGVuID0gKHBhcmFtWzBdIDw8
IDgpIHwgcGFyYW1bMV07CisKKyAgICBub3RpZmljYXRpb25fY2xhc3MgPSBwYXJhbVsyXSAmIDB4
MDc7CisgICAgaWYgKG5vdGlmaWNhdGlvbl9jbGFzcyAhPSBDRF9HRVRfRVZFTlRfQ0xBU1NfRVhU
RVJOQUxfUkVRKSB7CisgICAgICAgIFNQSUNFX0RFQlVHKCJzZW5kX2V2ZW50LCBsdW46JXUgaW52
YWxpZCBub3RpZmljYXRpb24gY2xhc3M6MHgleCIsCisgICAgICAgICAgICAgICAgICAgIHJlcS0+
bHVuLCBub3RpZmljYXRpb25fY2xhc3MpOworICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9j
aGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZBTElEX0NEQl9GSUVMRCk7CisgICAg
ICAgIHJldHVybjsKKyAgICB9CisKKyAgICBldmVudCA9IHBhcmFtICsgQ0RfR0VUX0VWRU5UX0hF
QURFUl9MRU47CisgICAgZXh0X3JlcV9ldmVudCA9IGV2ZW50WzBdICYgMHhmZjsKKyAgICBleHRf
cmVxX3N0YXR1cyA9IGV2ZW50WzFdICYgMHgwZjsKKyAgICBwZXJzX3ByZXZlbnQgPSBldmVudFsx
XSAmIDB4ODA7CisgICAgZXh0X3JlcV9jb2RlID0gKGV2ZW50WzJdIDw8IDgpIHwgZXZlbnRbM107
CisKKyAgICBTUElDRV9ERUJVRygic2VuZF9ldmVudCwgbHVuOjB4JXUgaW1tZWQ6JXUgcGFyYW1f
bGVuOiV1IgorICAgICAgICAgICAgICAgICIgZXh0X3JlcV9ldmVudDoweCV4IGV4dF9yZXFfc3Rh
dHVzOjB4JXgiCisgICAgICAgICAgICAgICAgIiBwZXJzX3ByZXZlbnQ6MHgleCBleHRfcmVxX2Nv
ZGU6MHgleCIsCisgICAgICAgICAgICAgICAgcmVxLT5sdW4sIGltbWVkLCBldmVudF9wYXJhbV9s
ZW4sIGV4dF9yZXFfZXZlbnQsCisgICAgICAgICAgICAgICAgZXh0X3JlcV9zdGF0dXMsIHBlcnNf
cHJldmVudCwgZXh0X3JlcV9jb2RlKTsKKworICAgIC8qIFRvRG86IHByb2Nlc3MgdGhlIGV2ZW50
ICovCisKKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworI2Rl
ZmluZSBDRF9NRURJVU1fUkVNT1ZBTF9SRVFfQUxMT1cgICAgICAgICAgICAgICAgIDB4MDAKKyNk
ZWZpbmUgQ0RfTUVESVVNX1JFTU9WQUxfUkVRX1BSRVZFTlQgICAgICAgICAgICAgICAweDAxCisj
ZGVmaW5lIENEX01FRElVTV9SRU1PVkFMX1JFUV9BTExPV19DSEFOR0VSICAgICAgICAgMHgwMgor
I2RlZmluZSBDRF9NRURJVU1fUkVNT1ZBTF9SRVFfUFJFVkVOVF9DSEFOR0VSICAgICAgIDB4MDMK
Kworc3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRfYWxsb3dfbWVkaXVtX3JlbW92YWwoQ2RTY3NpTFUg
KmRldiwgQ2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAgIHVpbnQzMl90IHByZXZlbnQ7CisKKyAg
ICByZXEtPnhmZXJfZGlyID0gU0NTSV9YRkVSX0ZST01fREVWOworCisgICAgcHJldmVudCA9IHJl
cS0+Y2RiWzRdICYgMHgwMzsKKyAgICBkZXYtPnByZXZlbnRfbWVkaWFfcmVtb3ZhbCA9IChwcmV2
ZW50ID09IENEX01FRElVTV9SRU1PVkFMX1JFUV9QUkVWRU5UIHx8CisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgcHJldmVudCA9PSBDRF9NRURJVU1fUkVNT1ZBTF9SRVFfUFJFVkVO
VF9DSEFOR0VSKTsKKyAgICByZXEtPmluX2xlbiA9IDA7CisKKyAgICBTUElDRV9ERUJVRygiYWxs
b3dfbWVkaXVtX3JlbW92YWwsIGx1bjoldSBwcmV2ZW50IGZpZWxkOjoweCUwMnggZmxhZzolZCIs
CisgICAgICAgICAgICAgICAgcmVxLT5sdW4sIHByZXZlbnQsIGRldi0+cHJldmVudF9tZWRpYV9y
ZW1vdmFsKTsKKworICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2LCByZXEpOworfQor
CitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9yZXBvcnRfa2V5KENkU2NzaUxVICpkZXYsIENkU2Nz
aVJlcXVlc3QgKnJlcSkKK3sKKyAgICBTUElDRV9ERUJVRygicmVwb3J0X2tleSAtIGNvbnRlbnQg
cHJvdGVjdGlvbiB1bnN1cHBvcnRlZCwgbHVuOiV1IiwgcmVxLT5sdW4pOworICAgIHJlcS0+eGZl
cl9kaXIgPSBTQ1NJX1hGRVJfTk9ORTsKKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19j
b25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZBTElEX09QQ09ERSk7Cit9CisKK3N0YXRpYyB2
b2lkIGNkX3Njc2lfY21kX3NlbmRfa2V5KENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJl
cSkKK3sKKyAgICBTUElDRV9ERUJVRygic2VuZF9rZXkgLSBjb250ZW50IHByb3RlY3Rpb24gdW5z
dXBwb3J0ZWQsIGx1bjoldSIsIHJlcS0+bHVuKTsKKyAgICByZXEtPnhmZXJfZGlyID0gU0NTSV9Y
RkVSX05PTkU7CisgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwg
JnNlbnNlX2NvZGVfSU5WQUxJRF9PUENPREUpOworfQorCisvKiBieXRlIDEgKi8KKyNkZWZpbmUg
Q0RfU1RBUlRfU1RPUF9GTEFHX0lNTUVEICAgICAgICAgICAgICAgICAgICAweDAxCisKKy8qIGJ5
dGUgNCAqLworI2RlZmluZSBDRF9TVEFSVF9TVE9QX0ZMQUdfU1RBUlQgICAgICAgICAgICAgICAg
ICAgIDB4MDEKKyNkZWZpbmUgQ0RfU1RBUlRfU1RPUF9GTEFHX0xPRUogICAgICAgICAgICAgICAg
ICAgICAweDAyCisKKy8qIFBPV0VSIENPTkRJVElPTiBmaWVsZCB2YWx1ZXMgKi8KKyNkZWZpbmUg
Q0RfU1RBUlRfU1RPUF9QT1dFUl9DT05EX1NUQVJUX1ZBTElEICAgICAgICAweDAwCisjZGVmaW5l
IENEX1NUQVJUX1NUT1BfUE9XRVJfQ09ORF9BQ1RJVkUgICAgICAgICAgICAgMHgwMQorI2RlZmlu
ZSBDRF9TVEFSVF9TVE9QX1BPV0VSX0NPTkRfSURMRSAgICAgICAgICAgICAgIDB4MDIKKyNkZWZp
bmUgQ0RfU1RBUlRfU1RPUF9QT1dFUl9DT05EX1NUQU5EQlkgICAgICAgICAgICAweDAzCisjZGVm
aW5lIENEX1NUQVJUX1NUT1BfUE9XRVJfQ09ORF9MVV9DT05UUk9MICAgICAgICAgMHgwNworI2Rl
ZmluZSBDRF9TVEFSVF9TVE9QX1BPV0VSX0NPTkRfRk9SQ0VfSURMRV8wICAgICAgIDB4MGEKKyNk
ZWZpbmUgQ0RfU1RBUlRfU1RPUF9QT1dFUl9DT05EX0ZPUkNFX1NUQU5EQllfMCAgICAweDBiCisK
K3N0YXRpYyBpbmxpbmUgY29uc3QgY2hhciAqY2Rfc2NzaV9zdGFydF9zdG9wX3Bvd2VyX2NvbmRf
bmFtZSh1aW50MzJfdCBwb3dlcl9jb25kKQoreworICAgIHN3aXRjaCAocG93ZXJfY29uZCkgewor
ICAgIGNhc2UgQ0RfU1RBUlRfU1RPUF9QT1dFUl9DT05EX1NUQVJUX1ZBTElEOgorICAgICAgICBy
ZXR1cm4gIlNUQVJUX1ZBTElEIjsKKyAgICBjYXNlIENEX1NUQVJUX1NUT1BfUE9XRVJfQ09ORF9B
Q1RJVkU6CisgICAgICAgIHJldHVybiAiQUNUSVZFIjsKKyAgICBjYXNlIENEX1NUQVJUX1NUT1Bf
UE9XRVJfQ09ORF9JRExFOgorICAgICAgICByZXR1cm4gIklETEUiOworICAgIGNhc2UgQ0RfU1RB
UlRfU1RPUF9QT1dFUl9DT05EX1NUQU5EQlk6CisgICAgICAgIHJldHVybiAiU1RBTkRCWSI7Cisg
ICAgY2FzZSBDRF9TVEFSVF9TVE9QX1BPV0VSX0NPTkRfTFVfQ09OVFJPTDoKKyAgICAgICAgcmV0
dXJuICJMVV9DT05UUk9MIjsKKyAgICBjYXNlIENEX1NUQVJUX1NUT1BfUE9XRVJfQ09ORF9GT1JD
RV9JRExFXzA6CisgICAgICAgIHJldHVybiAiRk9SQ0VfSURMRV8wIjsKKyAgICBjYXNlIENEX1NU
QVJUX1NUT1BfUE9XRVJfQ09ORF9GT1JDRV9TVEFOREJZXzA6CisgICAgICAgIHJldHVybiAiRk9S
Q0VfU1RBTkRCWV8wIjsKKyAgICBkZWZhdWx0OgorICAgICAgICByZXR1cm4gIlJFU0VSVkVEIjsK
KyAgICB9Cit9CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX3N0YXJ0X3N0b3BfdW5pdChDZFNj
c2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgZ2Jvb2xlYW4gaW1tZWQsIHN0
YXJ0LCBsb2FkX2VqZWN0OworICAgIHVpbnQzMl90IHBvd2VyX2NvbmQ7CisKKyAgICByZXEtPnhm
ZXJfZGlyID0gU0NTSV9YRkVSX05PTkU7CisgICAgcmVxLT5pbl9sZW4gPSAwOworCisgICAgaW1t
ZWQgPSAocmVxLT5jZGJbMV0gJiBDRF9TVEFSVF9TVE9QX0ZMQUdfSU1NRUQpID8gVFJVRSA6IEZB
TFNFOworICAgIHN0YXJ0ID0gKHJlcS0+Y2RiWzRdICYgQ0RfU1RBUlRfU1RPUF9GTEFHX1NUQVJU
KSA/IFRSVUUgOiBGQUxTRTsKKyAgICBsb2FkX2VqZWN0ID0gKHJlcS0+Y2RiWzRdICYgQ0RfU1RB
UlRfU1RPUF9GTEFHX0xPRUopID8gVFJVRSA6IEZBTFNFOworICAgIHBvd2VyX2NvbmQgPSByZXEt
PmNkYls0XSA+PiA0OworCisgICAgU1BJQ0VfREVCVUcoInN0YXJ0X3N0b3BfdW5pdCwgbHVuOjB4
JXUiCisgICAgICAgICAgICAgICAgIiBpbW1lZDolZCBzdGFydDolZCBsb2FkX2VqZWN0OiVkIHBv
d2VyX2NvbmQ6MHgleCglcykiLAorICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBpbW1lZCwgc3Rh
cnQsIGxvYWRfZWplY3QsIHBvd2VyX2NvbmQsCisgICAgICAgICAgICAgICAgY2Rfc2NzaV9zdGFy
dF9zdG9wX3Bvd2VyX2NvbmRfbmFtZShwb3dlcl9jb25kKSk7CisKKyAgICBzd2l0Y2ggKHBvd2Vy
X2NvbmQpIHsKKyAgICBjYXNlIENEX1NUQVJUX1NUT1BfUE9XRVJfQ09ORF9TVEFSVF9WQUxJRDoK
KyAgICAgICAgaWYgKCFzdGFydCkgeyAvKiBzdG9wIHRoZSB1bml0ICovCisgICAgICAgICAgICBp
ZiAobG9hZF9lamVjdCkgeyAvKiBlamVjdCBtZWRpdW0gKi8KKyAgICAgICAgICAgICAgICBpZiAo
ZGV2LT5wcmV2ZW50X21lZGlhX3JlbW92YWwpIHsKKyAgICAgICAgICAgICAgICAgICAgU1BJQ0Vf
REVCVUcoInN0YXJ0X3N0b3BfdW5pdCwgbHVuOjB4JXUiCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICIgcHJldmVudF9tZWRpYV9yZW1vdmFsIHNldCwgZWplY3QgZmFpbGVkIiwgcmVx
LT5sdW4pOworICAgICAgICAgICAgICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19j
b25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9NRURJVU1fUkVNT1ZBTF9QUkVWRU5URUQpOworICAg
ICAgICAgICAgICAgICAgICByZXR1cm47CisgICAgICAgICAgICAgICAgfQorICAgICAgICAgICAg
ICAgIFNQSUNFX0RFQlVHKCJzdGFydF9zdG9wX3VuaXQsIGx1bjoweCV1IGVqZWN0IiwgcmVxLT5s
dW4pOworICAgICAgICAgICAgICAgIGNkX3Njc2lfbHVfdW5sb2FkKGRldik7CisgICAgICAgICAg
ICAgICAgY2Rfc2NzaV9kZXZfY2hhbmdlZChkZXYtPnRndC0+dXNlcl9kYXRhLCByZXEtPmx1bik7
CisgICAgICAgICAgICB9CisgICAgICAgICAgICBkZXYtPnBvd2VyX2NvbmQgPSBDRF9TQ1NJX1BP
V0VSX1NUT1BQRUQ7CisgICAgICAgICAgICBTUElDRV9ERUJVRygic3RhcnRfc3RvcF91bml0LCBs
dW46MHgldSBzdG9wcGVkIiwgcmVxLT5sdW4pOworICAgICAgICB9IGVsc2UgeyAvKiBzdGFydCB0
aGUgdW5pdCAqLworICAgICAgICAgICAgZGV2LT5wb3dlcl9jb25kID0gQ0RfU0NTSV9QT1dFUl9B
Q1RJVkU7CisgICAgICAgICAgICBTUElDRV9ERUJVRygic3RhcnRfc3RvcF91bml0LCBsdW46MHgl
dSBzdGFydGVkIiwgcmVxLT5sdW4pOworCisgICAgICAgICAgICBpZiAobG9hZF9lamVjdCkgeyAv
KiBsb2FkIG1lZGl1bSAqLworICAgICAgICAgICAgICAgIFNQSUNFX0RFQlVHKCJzdGFydF9zdG9w
X3VuaXQsIGx1bjoweCV1IGxvYWQgd2l0aCBubyBtZWRpYSIsCisgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgcmVxLT5sdW4pOworICAgICAgICAgICAgICAgIGNkX3Njc2lfbHVfbG9hZChkZXYs
IE5VTEwpOworICAgICAgICAgICAgICAgIGNkX3Njc2lfZGV2X2NoYW5nZWQoZGV2LT50Z3QtPnVz
ZXJfZGF0YSwgcmVxLT5sdW4pOworICAgICAgICAgICAgfQorICAgICAgICB9CisgICAgICAgIGJy
ZWFrOworICAgIGNhc2UgQ0RfU1RBUlRfU1RPUF9QT1dFUl9DT05EX0FDVElWRToKKyAgICAgICAg
Lyogbm90IGVycm9yIHRvIHNwZWNpZnkgdHJhbnNpdGlvbiB0byB0aGUgY3VycmVudCBwb3dlciBj
b25kaXRpb24gKi8KKyAgICAgICAgZGV2LT5wb3dlcl9jb25kID0gQ0RfU0NTSV9QT1dFUl9BQ1RJ
VkU7CisgICAgICAgIFNQSUNFX0RFQlVHKCJzdGFydF9zdG9wX3VuaXQsIGx1bjoweCV1IGFjdGl2
ZSIsIHJlcS0+bHVuKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBDRF9TVEFSVF9TVE9QX1BP
V0VSX0NPTkRfSURMRToKKyAgICBjYXNlIENEX1NUQVJUX1NUT1BfUE9XRVJfQ09ORF9GT1JDRV9J
RExFXzA6CisgICAgICAgIGRldi0+cG93ZXJfY29uZCA9IENEX1NDU0lfUE9XRVJfSURMRTsKKyAg
ICAgICAgU1BJQ0VfREVCVUcoInN0YXJ0X3N0b3BfdW5pdCwgbHVuOjB4JXUgaWRsZSIsIHJlcS0+
bHVuKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBDRF9TVEFSVF9TVE9QX1BPV0VSX0NPTkRf
U1RBTkRCWToKKyAgICBjYXNlIENEX1NUQVJUX1NUT1BfUE9XRVJfQ09ORF9GT1JDRV9TVEFOREJZ
XzA6CisgICAgICAgIGRldi0+cG93ZXJfY29uZCA9IENEX1NDU0lfUE9XRVJfU1RBTkRCWTsKKyAg
ICAgICAgU1BJQ0VfREVCVUcoInN0YXJ0X3N0b3BfdW5pdCwgbHVuOjB4JXUgc3RhbmRieSIsIHJl
cS0+bHVuKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBDRF9TVEFSVF9TVE9QX1BPV0VSX0NP
TkRfTFVfQ09OVFJPTDoKKyAgICAgICAgYnJlYWs7CisgICAgZGVmYXVsdDoKKyAgICAgICAgY2Rf
c2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfSU5WQUxJ
RF9DREJfRklFTEQpOworICAgICAgICByZXR1cm47CisgICAgfQorICAgIGNkX3Njc2lfY21kX2Nv
bXBsZXRlX2dvb2QoZGV2LCByZXEpOworfQorCisjZGVmaW5lIENEX1BFUkZfVFlQRV9QRVJGT1JN
QU5DRSAgICAgICAgICAgICAgICAweDAwCisjZGVmaW5lIENEX1BFUkZfVFlQRV9VTlVTQUJMRV9B
UkVBICAgICAgICAgICAgICAweDAxCisjZGVmaW5lIENEX1BFUkZfVFlQRV9ERUZFQ1RfU1RBVFVT
ICAgICAgICAgICAgICAweDAyCisjZGVmaW5lIENEX1BFUkZfVFlQRV9XUklURV9TUEVFRCAgICAg
ICAgICAgICAgICAweDAzCisKKyNkZWZpbmUgQ0RfUEVSRl9IRUFERVJfTEVOICAgICAgICAgICAg
ICAgICAgICAgIDgKKworI2RlZmluZSBDRF9QRVJGX1RZUEVfUEVSRk9STUFOQ0VfREVTQ1JfTEVO
ICAgICAgMTYKKworI2RlZmluZSBDRF9QRVJGX1RZUEVfUEVSRk9STUFOQ0VfUkVQT1JUX05PTUlO
QUwgMHgwMAorI2RlZmluZSBDRF9QRVJGX1RZUEVfUEVSRk9STUFOQ0VfUkVQT1JUX0FMTCAgICAg
MHgwMQorI2RlZmluZSBDRF9QRVJGX1RZUEVfUEVSRk9STUFOQ0VfUkVQT1JUX0VYQ0VQVCAgMHgx
MAorCisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfZ2V0X3BlcmZvcm1hbmNlX3Jlc3BfZW1wdHkoQ2RT
Y3NpTFUgKmRldiwgQ2RTY3NpUmVxdWVzdCAqcmVxLAorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCB0eXBlLCB1aW50MzJfdCBkYXRhX3R5cGUs
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90
IG1heF9udW1fZGVzY3IpCit7CisgICAgdWludDhfdCAqb3V0YnVmID0gcmVxLT5idWY7CisgICAg
dWludDMyX3Qgd3JpdGUgPSAoZGF0YV90eXBlID4+IDIpICYgMHgwMTsKKworICAgIG1lbXNldChv
dXRidWYsIDAsIENEX1BFUkZfSEVBREVSX0xFTik7CisgICAgaWYgKHdyaXRlKSB7CisgICAgICAg
IG91dGJ1Zls0XSA9IDB4MDI7CisgICAgfQorICAgIHJlcS0+aW5fbGVuID0gQ0RfUEVSRl9IRUFE
RVJfTEVOOworCisgICAgU1BJQ0VfREVCVUcoImdldF9wZXJmb3JtYW5jZSwgbHVuOiV1IgorICAg
ICAgICAgICAgICAgICIgdHlwZToweCV4IGRhdGFfdHlwZToweCV4IC0gc2VuZGluZyBlbXB0eSBy
ZXNwb25zZSIsCisgICAgICAgICAgICAgICAgcmVxLT5sdW4sIHR5cGUsIGRhdGFfdHlwZSk7CisK
KyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworc3RhdGljIHZv
aWQgY2Rfc2NzaV9nZXRfcGVyZm9ybWFuY2VfcmVzcF9wZXJmb3JtYW5jZShDZFNjc2lMVSAqZGV2
LCBDZFNjc2lSZXF1ZXN0ICpyZXEsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IHN0YXJ0X2xiYSwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyX3QgZGF0YV90eXBlLAor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50
MzJfdCBtYXhfbnVtX2Rlc2NyKQoreworICAgIHVpbnQ4X3QgKm91dGJ1ZiA9IHJlcS0+YnVmLCAq
cGVyZl9kZXNjOworICAgIHVpbnQzMl90IHJlc3BfbGVuID0gQ0RfUEVSRl9IRUFERVJfTEVOICsK
KyAgICAgICAgICAgICAgICAgICAgICAgIENEX1BFUkZfVFlQRV9QRVJGT1JNQU5DRV9ERVNDUl9M
RU47CisgICAgdWludDMyX3QgcGVyZl9kYXRhX2xlbiA9IHJlc3BfbGVuIC0gNDsgLyogbm90IGlu
Y2wuIFBlcmYgRGF0YSBMZW5ndGggKi8KKyAgICB1aW50MzJfdCBwZXJmX2tiID0gMTAwMDA7Cisg
ICAgdWludDMyX3QgZW5kX2xiYSA9IGRldi0+bnVtX2Jsb2NrcyAtIDE7CisgICAgdWludDMyX3Qg
ZXhjZXB0LCB3cml0ZSwgdG9sZXJhbmNlOworCisgICAgZXhjZXB0ID0gZGF0YV90eXBlICYgMHgw
MzsKKyAgICBpZiAoZXhjZXB0ICE9IENEX1BFUkZfVFlQRV9QRVJGT1JNQU5DRV9SRVBPUlRfQUxM
KSB7CisgICAgICAgIHN0YXJ0X2xiYSA9IDA7CisgICAgfQorICAgIHdyaXRlID0gKGRhdGFfdHlw
ZSA+PiAyKSAmIDB4MDE7CisgICAgdG9sZXJhbmNlID0gKGRhdGFfdHlwZSA+PiAzKSAmIDB4MDM7
CisKKyAgICBTUElDRV9ERUJVRygiZ2V0X3BlcmZvcm1hbmNlLCBsdW46JXUiCisgICAgICAgICAg
ICAgICAgIiBwZXJmb3JtYW5jZSB0eXBlOjB4MDAgZGF0YV90eXBlOjB4JXgiCisgICAgICAgICAg
ICAgICAgIiBleGNlcHQ6MHgleCB3cml0ZToweCV4IHRvbGVyYW5jZToweCV4IgorICAgICAgICAg
ICAgICAgICIgbWF4X251bToldSIsCisgICAgICAgICAgICAgICAgcmVxLT5sdW4sIGRhdGFfdHlw
ZSwgZXhjZXB0LCB3cml0ZSwKKyAgICAgICAgICAgICAgICB0b2xlcmFuY2UsIG1heF9udW1fZGVz
Y3IpOworCisgICAgaWYgKHdyaXRlKSB7CisgICAgICAgIFNQSUNFX0RFQlVHKCJnZXRfcGVyZm9y
bWFuY2UsIGx1bjoldSIKKyAgICAgICAgICAgICAgICAgICAgIiBwZXJmb3JtYW5jZSB0eXBlOjB4
MDAgZGF0YV90eXBlOjB4JXggLSB3cml0ZSB1bnN1cHBvcnRlZCIsCisgICAgICAgICAgICAgICAg
ICAgIHJlcS0+bHVuLCBkYXRhX3R5cGUpOworICAgICAgICBjZF9zY3NpX2dldF9wZXJmb3JtYW5j
ZV9yZXNwX2VtcHR5KGRldiwgcmVxLCBDRF9QRVJGX1RZUEVfUEVSRk9STUFOQ0UsCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YV90eXBlLCBtYXhfbnVtX2Rl
c2NyKTsKKyAgICAgICAgcmV0dXJuOworICAgIH0KKworICAgIG1lbXNldChvdXRidWYsIDAsIHJl
c3BfbGVuKTsKKworICAgIG91dGJ1ZlswXSA9IChwZXJmX2RhdGFfbGVuID4+IDI0KSAmIDB4ZmY7
CisgICAgb3V0YnVmWzFdID0gKHBlcmZfZGF0YV9sZW4gPj4gMTYpICYgMHhmZjsKKyAgICBvdXRi
dWZbMl0gPSAocGVyZl9kYXRhX2xlbiA+PiA4KSAmIDB4ZmY7CisgICAgb3V0YnVmWzNdID0gcGVy
Zl9kYXRhX2xlbiAmIDB4ZmY7CisKKyAgICBwZXJmX2Rlc2MgPSBvdXRidWYgKyBDRF9QRVJGX0hF
QURFUl9MRU47CisKKyAgICBwZXJmX2Rlc2NbMF0gPSAoc3RhcnRfbGJhID4+IDI0KSAmIDB4ZmY7
CisgICAgcGVyZl9kZXNjWzFdID0gKHN0YXJ0X2xiYSA+PiAxNikgJiAweGZmOworICAgIHBlcmZf
ZGVzY1syXSA9IChzdGFydF9sYmEgPj4gOCkgJiAweGZmOworICAgIHBlcmZfZGVzY1szXSA9IHN0
YXJ0X2xiYSAmIDB4ZmY7CisKKyAgICBwZXJmX2Rlc2NbNF0gPSAocGVyZl9rYiA+PiAyNCkgJiAw
eGZmOworICAgIHBlcmZfZGVzY1s1XSA9IChwZXJmX2tiID4+IDE2KSAmIDB4ZmY7CisgICAgcGVy
Zl9kZXNjWzZdID0gKHBlcmZfa2IgPj4gOCkgJiAweGZmOworICAgIHBlcmZfZGVzY1s3XSA9IHBl
cmZfa2IgJiAweGZmOworCisgICAgcGVyZl9kZXNjWzhdID0gKGVuZF9sYmEgPj4gMjQpICYgMHhm
ZjsKKyAgICBwZXJmX2Rlc2NbOV0gPSAoZW5kX2xiYSA+PiAxNikgJiAweGZmOworICAgIHBlcmZf
ZGVzY1sxMF0gPSAoZW5kX2xiYSA+PiA4KSAmIDB4ZmY7CisgICAgcGVyZl9kZXNjWzExXSA9IGVu
ZF9sYmEgJiAweGZmOworCisgICAgcGVyZl9kZXNjWzEyXSA9IChwZXJmX2tiID4+IDI0KSAmIDB4
ZmY7CisgICAgcGVyZl9kZXNjWzEzXSA9IChwZXJmX2tiID4+IDE2KSAmIDB4ZmY7CisgICAgcGVy
Zl9kZXNjWzE0XSA9IChwZXJmX2tiID4+IDgpICYgMHhmZjsKKyAgICBwZXJmX2Rlc2NbMTVdID0g
cGVyZl9rYiAmIDB4ZmY7CisKKyAgICByZXEtPnJlcV9sZW4gPSBDRF9QRVJGX0hFQURFUl9MRU4g
KworICAgICAgICAgICAgICAgICAgIChtYXhfbnVtX2Rlc2NyICogQ0RfUEVSRl9UWVBFX1BFUkZP
Uk1BTkNFX0RFU0NSX0xFTik7CisKKyAgICByZXEtPmluX2xlbiA9IE1JTihyZXEtPnJlcV9sZW4s
IHJlc3BfbGVuKTsKKworICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2LCByZXEpOwor
fQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9nZXRfcGVyZm9ybWFuY2UoQ2RTY3NpTFUgKmRl
diwgQ2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAgIHVpbnQzMl90IGRhdGFfdHlwZSwgbWF4X251
bV9kZXNjciwgc3RhcnRfbGJhLCB0eXBlOworCisgICAgcmVxLT54ZmVyX2RpciA9IFNDU0lfWEZF
Ul9GUk9NX0RFVjsKKworICAgIGRhdGFfdHlwZSA9IHJlcS0+Y2RiWzFdICYgMHgwZjsKKyAgICBz
dGFydF9sYmEgPSAocmVxLT5jZGJbMl0gPDwgMjQpIHwKKyAgICAgICAgICAgICAgICAocmVxLT5j
ZGJbM10gPDwgMTYpIHwKKyAgICAgICAgICAgICAgICAocmVxLT5jZGJbNF0gPDwgOCkgfAorICAg
ICAgICAgICAgICAgICByZXEtPmNkYls1XTsKKyAgICBtYXhfbnVtX2Rlc2NyID0gKHJlcS0+Y2Ri
WzhdIDw8IDgpIHwgcmVxLT5jZGJbOV07CisgICAgdHlwZSA9IHJlcS0+Y2RiWzEwXTsKKworICAg
IHN3aXRjaCAodHlwZSkgeworICAgIGNhc2UgQ0RfUEVSRl9UWVBFX1BFUkZPUk1BTkNFOgorICAg
ICAgICBjZF9zY3NpX2dldF9wZXJmb3JtYW5jZV9yZXNwX3BlcmZvcm1hbmNlKGRldiwgcmVxLCBz
dGFydF9sYmEsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgZGF0YV90eXBlLCBtYXhfbnVtX2Rlc2NyKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBD
RF9QRVJGX1RZUEVfVU5VU0FCTEVfQVJFQTogLyogbm90IHdyaXRhYmxlICovCisgICAgY2FzZSBD
RF9QRVJGX1RZUEVfREVGRUNUX1NUQVRVUzogLyogbm90IHJlc3RyaWN0ZWQgb3ZlcndyaXRlIG1l
ZGlhICovCisgICAgY2FzZSBDRF9QRVJGX1RZUEVfV1JJVEVfU1BFRUQ6IC8qIHVuc3VwcG9ydGVk
LCBpcnJlbGV2YW50ICovCisgICAgZGVmYXVsdDoKKyAgICAgICAgU1BJQ0VfREVCVUcoImdldF9w
ZXJmb3JtYW5jZSwgbHVuOiV1IgorICAgICAgICAgICAgICAgICAgICAiIHVuc3VwcG9ydGVkIHR5
cGU6MHgleCIKKyAgICAgICAgICAgICAgICAgICAgIiBkYXRhX3R5cGU6MHgleCBtYXhfbnVtOiV1
IiwKKyAgICAgICAgICAgICAgICAgICAgcmVxLT5sdW4sIHR5cGUsIGRhdGFfdHlwZSwgbWF4X251
bV9kZXNjcik7CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCBy
ZXEsICZzZW5zZV9jb2RlX0lOVkFMSURfQ0RCX0ZJRUxEKTsKKyAgICAgICAgcmV0dXJuOworICAg
IH0KK30KKworI2RlZmluZSBDRF9NRUNIQU5JU01fU1RBVFVTX0hEUl9MRU4gICAgIDgKKworLyog
Ynl0ZSAwICovCisjZGVmaW5lIENEX0NIQU5HRVJfRkFVTFRfRkxBRyAgICAgICAgICAgMHg4MAor
CisjZGVmaW5lIENEX0NIQU5HRVJfUkVBRFkgICAgICAgICAgICAgICAgMHgwMAorI2RlZmluZSBD
RF9DSEFOR0VSX0xPQURJTkcgICAgICAgICAgICAgIDB4MDEKKyNkZWZpbmUgQ0RfQ0hBTkdFUl9V
TkxPQURJTkcgICAgICAgICAgICAweDAyCisjZGVmaW5lIENEX0NIQU5HRVJfSU5JVElBTElaSU5H
ICAgICAgICAgMHgwMworCisvKiBieXRlIDEgKi8KKyNkZWZpbmUgQ0RfQ0hBTkdFUl9ET09SX09Q
RU5fRkxBRyAgICAgICAweDEwCisKKyNkZWZpbmUgQ0RfTUVDSEFOSVNNX1NUQVRFX0lETEUgICAg
ICAgICAweDAwCisjZGVmaW5lIENEX01FQ0hBTklTTV9TVEFURV9QTEFZSU5HICAgICAgMHgwMQor
I2RlZmluZSBDRF9NRUNIQU5JU01fU1RBVEVfU0NBTk5JTkcgICAgIDB4MDIKKy8qIEFDVElWRTog
d2l0aCBJbml0aWF0b3IsIENvbXBvc2l0ZSBvciBPdGhlciBwb3J0cworICAoaS5lLiBSRUFELCBQ
TEFZIENELCBTQ0FOIGR1cmluZyBQTEFZIENEKSAqLworI2RlZmluZSBDRF9NRUNIQU5JU01fU1RB
VEVfQUNUSVZFICAgICAgIDB4MDMKKyNkZWZpbmUgQ0RfTUVDSEFOSVNNX1NUQVRFX05PX0lORk8g
ICAgICAweDA3CisKKy8qIHNsb3RzICovCisjZGVmaW5lIENEX01FQ0hBTklTTV9TVEFUVVNfU0xP
VF9MRU4gICAgNAorCisjZGVmaW5lIENEX01FQ0hBTklTTV9TTE9UX0RJU0tfQ0hBTkdFRCAgMHgw
MQorI2RlZmluZSBDRF9NRUNIQU5JU01fU0xPVF9ESVNLX1BSRVNFTlQgIDB4ODAKKyNkZWZpbmUg
Q0RfTUVDSEFOSVNNX1NMT1RfRElTS19DV1BfViAgICAweDAyCisjZGVmaW5lIENEX01FQ0hBTklT
TV9TTE9UX0RJU0tfQ1dQICAgICAgMHgwMQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9tZWNo
YW5pc21fc3RhdHVzKENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICB1
aW50OF90ICpvdXRidWYgPSByZXEtPmJ1ZjsKKyAgICB1aW50MzJfdCByZXNwX2xlbiA9IENEX01F
Q0hBTklTTV9TVEFUVVNfSERSX0xFTjsKKworICAgIHJlcS0+eGZlcl9kaXIgPSBTQ1NJX1hGRVJf
RlJPTV9ERVY7CisKKyAgICByZXEtPnJlcV9sZW4gPSAocmVxLT5jZGJbOF0gPDwgOCkgfCByZXEt
PmNkYls5XTsKKyAgICBtZW1zZXQob3V0YnVmLCAwLCByZXEtPnJlcV9sZW4pOworCisgICAgLyog
Rm9yIG5vbi1jaGFuZ2VyIGRldmljZXMgdGhlIGN1cmVudCBzbG90IG51bWJlciBmaWVsZCBpcyBy
ZXNlcnZlZCwgc2V0IG9ubHkgc3RhdHVzICovCisgICAgb3V0YnVmWzBdIHw9IChDRF9DSEFOR0VS
X1JFQURZIDw8IDUpOworCisgICAgb3V0YnVmWzFdIHw9ICghZGV2LT5sb2FkZWQpID8gQ0RfQ0hB
TkdFUl9ET09SX09QRU5fRkxBRyA6IDA7CisgICAgb3V0YnVmWzFdIHw9IChkZXYtPnBvd2VyX2Nv
bmQgPT0gQ0RfUE9XRVJfU1RBVFVTX0FDVElWRSkgPworICAgICAgICAgICAgICAgICAoQ0RfTUVD
SEFOSVNNX1NUQVRFX0FDVElWRSA8PCA1KSA6IChDRF9NRUNIQU5JU01fU1RBVEVfSURMRSA8PCA1
KTsKKworICAgIC8qIEZvciBub24tY2hhbmdlciBkZXZpY2VzIHRoZSBudW1iZXIgb2Ygc2xvdCB0
YWJsZXMgcmV0dXJuZWQgc2hhbGwgYmUgemVybywgc28gd2UgbGVhdmUKKyAgICAgICBib3RoICdO
dW1iZXIgb2YgU2xvdHMgQXZhaWxhYmxlJyBhbmQgJ0xlbmd0aCBvZiBTbG90IFRhYmxlJyBmaWVs
ZHMgYXMgemVyb3MgKi8KKworICAgIHJlcS0+aW5fbGVuID0gTUlOKHJlcS0+cmVxX2xlbiwgcmVz
cF9sZW4pOworCisgICAgU1BJQ0VfREVCVUcoIm1lY2hhbmlzbV9zdGF0dXMsIGx1bjoldSIsIHJl
cS0+bHVuKTsKKworICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2LCByZXEpOworfQor
CitzdGF0aWMgdm9pZCBjZF9zY3NpX3JlYWRfYXN5bmNfY29tcGxldGUoR09iamVjdCAqc3JjX29i
amVjdCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBHQXN5bmNSZXN1
bHQgKnJlc3VsdCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBncG9p
bnRlciB1c2VyX2RhdGEpCit7CisgICAgR0ZpbGVJbnB1dFN0cmVhbSAqc3RyZWFtID0gR19GSUxF
X0lOUFVUX1NUUkVBTShzcmNfb2JqZWN0KTsKKyAgICBDZFNjc2lSZXF1ZXN0ICpyZXEgPSAoQ2RT
Y3NpUmVxdWVzdCAqKXVzZXJfZGF0YTsKKyAgICBDZFNjc2lUYXJnZXQgKnN0ID0gKENkU2NzaVRh
cmdldCAqKXJlcS0+cHJpdl9kYXRhOworICAgIENkU2NzaUxVICpkZXYgPSAmc3QtPnVuaXRzW3Jl
cS0+bHVuXTsKKyAgICBHRXJyb3IgKmVycm9yID0gTlVMTDsKKyAgICBnc2l6ZSBieXRlc19yZWFk
OworICAgIGdib29sZWFuIGZpbmlzaGVkOworCisgICAgcmVxLT5yZXFfc3RhdGUgPSBTQ1NJX1JF
UV9DT01QTEVURTsKKyAgICByZXEtPmNhbmNlbF9pZCA9IDA7CisKKy8vICAgIGdfYXNzZXJ0KHN0
cmVhbSA9PSBkZXYtPnN0cmVhbSk7CisgICAgaWYgKHN0cmVhbSAhPSBkZXYtPnN0cmVhbSkgewor
ICAgICAgICB1aW50MzJfdCBvcGNvZGUgPSAodWludDMyX3QpcmVxLT5jZGJbMF07CisgICAgICAg
IFNQSUNFX0RFQlVHKCJyZWFkX2FzeW5jX2NvbXBsZXRlIEJBRCBTVFJFQU0sIGx1bjogJXUiCisg
ICAgICAgICAgICAgICAgICAgICIgcmVxOiAlIiBHX0dVSU5UNjRfRk9STUFUICIgb3A6IDB4JTAy
eCIsCisgICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuLCByZXEtPnJlcV9sZW4sIG9wY29kZSk7
CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5z
ZV9jb2RlX1RBUkdFVF9GQUlMVVJFKTsKKyAgICAgICAgY2Rfc2NzaV9kZXZfcmVxdWVzdF9jb21w
bGV0ZShzdC0+dXNlcl9kYXRhLCByZXEpOworICAgICAgICByZXR1cm47CisgICAgfQorCisgICAg
Ynl0ZXNfcmVhZCA9IGdfaW5wdXRfc3RyZWFtX3JlYWRfZmluaXNoKEdfSU5QVVRfU1RSRUFNKHN0
cmVhbSksIHJlc3VsdCwgJmVycm9yKTsKKyAgICBmaW5pc2hlZCA9IGJ5dGVzX3JlYWQgPiAwOwor
ICAgIGlmIChmaW5pc2hlZCkgeworICAgICAgICBTUElDRV9ERUJVRygicmVhZF9hc3luY19jb21w
bGV0ZSwgbHVuOiAldSIKKyAgICAgICAgICAgICAgICAgICAgIiBmaW5pc2hlZDogJWQgYnl0ZXNf
cmVhZDogJSIgR19HVUlOVDY0X0ZPUk1BVAorICAgICAgICAgICAgICAgICAgICAiIHJlcTogJSIg
IEdfR1VJTlQ2NF9GT1JNQVQsCisgICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBmaW5pc2hl
ZCwgKHVpbnQ2NF90KWJ5dGVzX3JlYWQsIHJlcS0+cmVxX2xlbik7CisKKyAgICAgICAgcmVxLT5p
bl9sZW4gPSBNSU4oYnl0ZXNfcmVhZCwgcmVxLT5yZXFfbGVuKTsKKyAgICAgICAgcmVxLT5zdGF0
dXMgPSBHT09EOworICAgIH0gZWxzZSB7CisgICAgICAgIGlmIChlcnJvciAhPSBOVUxMKSB7Cisg
ICAgICAgICAgICBTUElDRV9FUlJPUigiZ19pbnB1dF9zdHJlYW1fcmVhZF9maW5pc2ggZmFpbGVk
OiAlcyIsIGVycm9yLT5tZXNzYWdlKTsKKyAgICAgICAgICAgIGdfY2xlYXJfZXJyb3IgKCZlcnJv
cik7CisgICAgICAgIH0gZWxzZSB7CisgICAgICAgICAgICBTUElDRV9FUlJPUigiZ19pbnB1dF9z
dHJlYW1fcmVhZF9maW5pc2ggZmFpbGVkIChubyBlcnIgcHJvdmlkZWQpIik7CisgICAgICAgIH0K
KyAgICAgICAgcmVxLT5pbl9sZW4gPSAwOworICAgICAgICByZXEtPnN0YXR1cyA9IEdPT0Q7Cisg
ICAgfQorICAgIGNkX3Njc2lfZGV2X3JlcXVlc3RfY29tcGxldGUoc3QtPnVzZXJfZGF0YSwgcmVx
KTsKK30KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9yZWFkX2FzeW5jX2NhbmNlbGVkKEdDYW5jZWxs
YWJsZSAqY2FuY2VsbGFibGUsIGdwb2ludGVyIHVzZXJfZGF0YSkKK3sKKyAgICBDZFNjc2lSZXF1
ZXN0ICpyZXEgPSAoQ2RTY3NpUmVxdWVzdCAqKXVzZXJfZGF0YTsKKyAgICBDZFNjc2lUYXJnZXQg
KnN0ID0gKENkU2NzaVRhcmdldCAqKXJlcS0+cHJpdl9kYXRhOworCisgICAgZ19hc3NlcnQoY2Fu
Y2VsbGFibGUgPT0gc3QtPmNhbmNlbGxhYmxlKTsKKyAgICBnX2NhbmNlbGxhYmxlX2Rpc2Nvbm5l
Y3QoY2FuY2VsbGFibGUsIHJlcS0+Y2FuY2VsX2lkKTsKKyAgICByZXEtPmNhbmNlbF9pZCA9IDA7
CisKKyAgICByZXEtPnJlcV9zdGF0ZSA9CisgICAgICAgIChzdC0+c3RhdGUgPT0gQ0RfU0NTSV9U
R1RfU1RBVEVfUlVOTklORykgPyBTQ1NJX1JFUV9DQU5DRUxFRCA6IFNDU0lfUkVRX0RJU1BPU0VE
OworICAgIHJlcS0+aW5fbGVuID0gMDsKKyAgICByZXEtPnN0YXR1cyA9IEdPT0Q7CisKKyAgICBj
ZF9zY3NpX2Rldl9yZXF1ZXN0X2NvbXBsZXRlKHN0LT51c2VyX2RhdGEsIHJlcSk7Cit9CisKK3N0
YXRpYyBpbnQgY2Rfc2NzaV9yZWFkX2FzeW5jX3N0YXJ0KENkU2NzaUxVICpkZXYsIENkU2NzaVJl
cXVlc3QgKnJlcSkKK3sKKyAgICBDZFNjc2lUYXJnZXQgKnN0ID0gZGV2LT50Z3Q7CisgICAgR0Zp
bGVJbnB1dFN0cmVhbSAqc3RyZWFtID0gZGV2LT5zdHJlYW07CisKKyAgICBTUElDRV9ERUJVRygi
cmVhZF9hc3luY19zdGFydCwgbHVuOiV1IgorICAgICAgICAgICAgICAgICIgbGJhOiAlIiBHX0dV
SU5UNjRfRk9STUFUICIgb2Zmc2V0OiAlIiBHX0dVSU5UNjRfRk9STUFUCisgICAgICAgICAgICAg
ICAgIiBjbnQ6ICUiIEdfR1VJTlQ2NF9GT1JNQVQgIiBsZW46ICUiIEdfR1VJTlQ2NF9GT1JNQVQs
CisgICAgICAgICAgICAgICAgcmVxLT5sdW4sIHJlcS0+bGJhLCByZXEtPm9mZnNldCwgcmVxLT5j
b3VudCwgcmVxLT5yZXFfbGVuKTsKKworICAgIHJlcS0+Y2FuY2VsX2lkID0gZ19jYW5jZWxsYWJs
ZV9jb25uZWN0KHN0LT5jYW5jZWxsYWJsZSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBHX0NBTExCQUNLKGNkX3Njc2lfcmVhZF9hc3luY19jYW5jZWxlZCksCisg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxLCAvKiBkYXRhICov
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTlVMTCk7IC8qIGRh
dGEgZGVzdHJveSBjYiAqLworICAgIGlmIChyZXEtPmNhbmNlbF9pZCA9PSAwKSB7CisgICAgICAg
IC8qIGFscmVhZHkgY2FuY2VsZWQgKi8KKyAgICAgICAgcmV0dXJuIC0xOworICAgIH0KKworICAg
IGdfc2Vla2FibGVfc2VlayhHX1NFRUtBQkxFKHN0cmVhbSksCisgICAgICAgICAgICAgICAgICAg
IHJlcS0+b2Zmc2V0LAorICAgICAgICAgICAgICAgICAgICBHX1NFRUtfU0VULAorICAgICAgICAg
ICAgICAgICAgICBOVUxMLCAvKiBjYW5jZWxsYWJsZSAqLworICAgICAgICAgICAgICAgICAgICBO
VUxMKTsgLyogZXJyb3IgKi8KKworICAgIGdfaW5wdXRfc3RyZWFtX3JlYWRfYXN5bmMoR19JTlBV
VF9TVFJFQU0oc3RyZWFtKSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcS0+YnVm
LCAvKiBidWZmZXIgdG8gZmlsbCAqLworICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVx
LT5yZXFfbGVuLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgR19QUklPUklUWV9ERUZB
VUxULAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3QtPmNhbmNlbGxhYmxlLAorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgY2Rfc2NzaV9yZWFkX2FzeW5jX2NvbXBsZXRlLAor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGdwb2ludGVyKXJlcSk7IC8qIGNhbGxiYWNr
IGFyZ3VtZW50ICovCisgICAgcmV0dXJuIDA7Cit9CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21k
X3JlYWQoQ2RTY3NpTFUgKmRldiwgQ2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAgIGlmIChkZXYt
PnBvd2VyX2NvbmQgPT0gQ0RfU0NTSV9QT1dFUl9TVE9QUEVEKSB7CisgICAgICAgIFNQSUNFX0RF
QlVHKCJyZWFkLCBsdW46ICV1IGlzIHN0b3BwZWQiLCByZXEtPmx1bik7CisgICAgICAgIGNkX3Nj
c2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX0lOSVRfQ01E
X1JFUVVJUkVEKTsKKyAgICAgICAgcmV0dXJuOworICAgIH0gZWxzZSBpZiAoIWRldi0+bG9hZGVk
IHx8IGRldi0+c3RyZWFtID09IE5VTEwpIHsKKyAgICAgICAgU1BJQ0VfREVCVUcoInJlYWQsIGx1
bjogJXUgaXMgbm90IGxvYWRlZCIsIHJlcS0+bHVuKTsKKyAgICAgICAgY2Rfc2NzaV9jbWRfY29t
cGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfTk9UX1JFQURZX05PX01FRElV
TSk7CisgICAgICAgIHJldHVybjsKKyAgICB9CisKKyAgICByZXEtPmNkYl9sZW4gPSBzY3NpX2Nk
Yl9sZW5ndGgocmVxLT5jZGIpOworCisgICAgcmVxLT5sYmEgPSBzY3NpX2NkYl9sYmEocmVxLT5j
ZGIsIHJlcS0+Y2RiX2xlbik7CisgICAgcmVxLT5vZmZzZXQgPSByZXEtPmxiYSAqIGRldi0+Ymxv
Y2tfc2l6ZTsKKworICAgIHJlcS0+Y291bnQgPSBzY3NpX2NkYl94ZmVyX2xlbmd0aChyZXEtPmNk
YiwgcmVxLT5jZGJfbGVuKTsgLyogeGZlciBpbiBibG9ja3MgKi8KKyAgICByZXEtPnJlcV9sZW4g
PSAodWludDY0X3QpIHJlcS0+Y291bnQgKiBkZXYtPmJsb2NrX3NpemU7CisKKyAgICBjZF9zY3Np
X3JlYWRfYXN5bmNfc3RhcnQoZGV2LCByZXEpOworfQorCit2b2lkIGNkX3Njc2lfZGV2X3JlcXVl
c3Rfc3VibWl0KENkU2NzaVRhcmdldCAqc3QsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICB1
aW50MzJfdCBsdW4gPSByZXEtPmx1bjsKKyAgICB1aW50MzJfdCBvcGNvZGUgPSAodWludDMyX3Qp
cmVxLT5jZGJbMF07CisgICAgY29uc3QgY2hhciAqY21kX25hbWUgPSBzY3NpX2NtZF9uYW1lW29w
Y29kZV07CisgICAgQ2RTY3NpTFUgKmRldiA9ICZzdC0+dW5pdHNbbHVuXTsKKworICAgIFNQSUNF
X0RFQlVHKCJyZXF1ZXN0X3N1Ym1pdCwgbHVuOiAldSBvcDogMHglMDJ4ICVzIiwgbHVuLCBvcGNv
ZGUsIGNtZF9uYW1lKTsKKworICAgIGlmIChzdC0+Y3VyX3JlcSAhPSBOVUxMKSB7CisgICAgICAg
IFNQSUNFX0VSUk9SKCJyZXF1ZXN0X3N1Ym1pdCwgcmVxdWVzdCBub3QgaWRsZSIpOworICAgICAg
ICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9U
QVJHRVRfRkFJTFVSRSk7CisgICAgICAgIGdvdG8gZG9uZTsKKyAgICB9CisgICAgaWYgKHJlcS0+
cmVxX3N0YXRlICE9IFNDU0lfUkVRX0lETEUpIHsKKyAgICAgICAgU1BJQ0VfRVJST1IoInJlcXVl
c3Rfc3VibWl0LCBwcmV2IHJlcXVlc3Qgb3V0c3RhbmRpbmciKTsKKyAgICAgICAgY2Rfc2NzaV9j
bWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfVEFSR0VUX0ZBSUxV
UkUpOworICAgICAgICBnb3RvIGRvbmU7CisgICAgfQorICAgIHJlcS0+cmVxX3N0YXRlID0gU0NT
SV9SRVFfUlVOTklORzsKKyAgICBzdC0+Y3VyX3JlcSA9IHJlcTsKKworICAgIC8qIElOUVVJUlkg
c2hvdWxkIHNlbmQgcmVzcG9uc2UgZXZlbiBmb3Igbm9uLWV4aXN0aW5nIExVTnMgKi8KKyAgICBp
ZiAoIWNkX3Njc2lfdGFyZ2V0X2x1bl9sZWdhbChzdCwgbHVuKSkgeworICAgICAgICBTUElDRV9F
UlJPUigicmVxdWVzdF9zdWJtaXQsIGlsbGVnYWwgbHVuOiV1IiwgbHVuKTsKKyAgICAgICAgaWYg
KG9wY29kZSA9PSBJTlFVSVJZKSB7CisgICAgICAgICAgICBpZiAocmVxLT5jZGJbMV0gJiAweDEp
IHsKKyAgICAgICAgICAgICAgICBjZF9zY3NpX2NtZF9pbnF1aXJ5X3ZwZF9ub19sdW4oZGV2LCBy
ZXEsIFBFUklGX1FVQUxJRklFUl9VTlNVUFBPUlRFRCk7CisgICAgICAgICAgICB9IGVsc2Ugewor
ICAgICAgICAgICAgICAgIGNkX3Njc2lfY21kX2lucXVpcnlfc3RhbmRhcmRfbm9fbHVuKGRldiwg
cmVxLCBQRVJJRl9RVUFMSUZJRVJfVU5TVVBQT1JURUQpOworICAgICAgICAgICAgfQorICAgICAg
ICB9IGVsc2UgeworICAgICAgICAgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChk
ZXYsIHJlcSwgJnNlbnNlX2NvZGVfTFVOX05PVF9TVVBQT1JURUQpOworICAgICAgICB9CisgICAg
ICAgIGdvdG8gZG9uZTsKKyAgICB9CisgICAgaWYgKCFjZF9zY3NpX3RhcmdldF9sdW5fcmVhbGl6
ZWQoc3QsIGx1bikpIHsKKyAgICAgICAgU1BJQ0VfRVJST1IoInJlcXVlc3Rfc3VibWl0LCBhYnNl
bnQgbHVuOiV1IiwgbHVuKTsKKyAgICAgICAgaWYgKG9wY29kZSA9PSBJTlFVSVJZKSB7CisgICAg
ICAgICAgICBpZiAocmVxLT5jZGJbMV0gJiAweDEpIHsKKyAgICAgICAgICAgICAgICBjZF9zY3Np
X2NtZF9pbnF1aXJ5X3ZwZF9ub19sdW4oZGV2LCByZXEsIFBFUklGX1FVQUxJRklFUl9OT1RfQ09O
TkVDVEVEKTsKKyAgICAgICAgICAgIH0gZWxzZSB7CisgICAgICAgICAgICAgICAgY2Rfc2NzaV9j
bWRfaW5xdWlyeV9zdGFuZGFyZF9ub19sdW4oZGV2LCByZXEsIFBFUklGX1FVQUxJRklFUl9OT1Rf
Q09OTkVDVEVEKTsKKyAgICAgICAgICAgIH0KKyAgICAgICAgfSBlbHNlIHsKKyAgICAgICAgICAg
IGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX0xV
Tl9OT1RfU1VQUE9SVEVEKTsKKyAgICAgICAgfQorICAgICAgICBnb3RvIGRvbmU7CisgICAgfQor
CisgICAgaWYgKGRldi0+c2hvcnRfc2Vuc2Uua2V5ICE9IE5PX1NFTlNFKSB7CisgICAgICAgIGdi
b29sZWFuIHBlbmRpbmdfc2Vuc2UgPSBUUlVFOworICAgICAgICBpZiAoZGV2LT5zaG9ydF9zZW5z
ZS5rZXkgPT0gVU5JVF9BVFRFTlRJT04pIHsKKyAgICAgICAgICAgIGlmIChjZF9zY3NpX29wY29k
ZV91YV9zdXByZXNzKG9wY29kZSkpIHsKKyAgICAgICAgICAgICAgICBwZW5kaW5nX3NlbnNlID0g
RkFMU0U7IC8qIFVBIHN1cHJlc3NlZCAqLworICAgICAgICAgICAgfQorICAgICAgICB9IGVsc2Ug
aWYgKG9wY29kZSA9PSBSRVFVRVNUX1NFTlNFKSB7CisgICAgICAgICAgICBwZW5kaW5nX3NlbnNl
ID0gRkFMU0U7IC8qIHNlbnNlIHJldHVybmVkIGFzIGRhdGEgKi8KKyAgICAgICAgfQorICAgICAg
ICBpZiAocGVuZGluZ19zZW5zZSkgeworICAgICAgICAgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVf
Y2hlY2tfY29uZChkZXYsIHJlcSwgTlVMTCk7IC8qIHNlbnNlIGFscmVhZHkgc2V0ICovCisgICAg
ICAgICAgICBnb3RvIGRvbmU7CisgICAgICAgIH0KKyAgICB9CisKKyAgICAvKiBzYXZlIHRoZSB0
YXJnZXQgdG8gYmUgdXNlZCBpbiBjYWxsYmFja3Mgd2hlcmUgb25seSByZXEgaXMgcGFzc2VkICov
CisgICAgcmVxLT5wcml2X2RhdGEgPSAodm9pZCAqKXN0OworCisgICAgcmVxLT5yZXFfbGVuID0g
MDsKKworICAgIHN3aXRjaCAob3Bjb2RlKSB7CisgICAgY2FzZSBSRVBPUlRfTFVOUzoKKyAgICAg
ICAgY2Rfc2NzaV9jbWRfcmVwb3J0X2x1bnMoc3QsIGRldiwgcmVxKTsKKyAgICAgICAgYnJlYWs7
CisgICAgY2FzZSBURVNUX1VOSVRfUkVBRFk6CisgICAgICAgIGNkX3Njc2lfY21kX3Rlc3RfdW5p
dF9yZWFkeShkZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgSU5RVUlSWToKKyAg
ICAgICAgY2Rfc2NzaV9jbWRfaW5xdWlyeShkZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOworICAg
IGNhc2UgUkVRVUVTVF9TRU5TRToKKyAgICAgICAgY2Rfc2NzaV9jbWRfcmVxdWVzdF9zZW5zZShk
ZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgUkVBRF82OgorICAgIGNhc2UgUkVB
RF8xMDoKKyAgICBjYXNlIFJFQURfMTI6CisgICAgY2FzZSBSRUFEXzE2OgorICAgICAgICBjZF9z
Y3NpX2NtZF9yZWFkKGRldiwgcmVxKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBSRUFEX0NB
UEFDSVRZXzEwOgorICAgICAgICBjZF9zY3NpX2NtZF9yZWFkX2NhcGFjaXR5KGRldiwgcmVxKTsK
KyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBSRUFEX1RPQzoKKyAgICAgICAgY2Rfc2NzaV9jbWRf
cmVhZF90b2MoZGV2LCByZXEpOworICAgICAgICBicmVhazsKKyAgICBjYXNlIEdFVF9FVkVOVF9T
VEFUVVNfTk9USUZJQ0FUSU9OOgorICAgICAgICBjZF9zY3NpX2NtZF9nZXRfZXZlbnRfc3RhdHVz
X25vdGlmaWNhdGlvbihkZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgUkVBRF9E
SVNDX0lORk9STUFUSU9OOgorICAgICAgICBjZF9zY3NpX2NtZF9nZXRfcmVhZF9kaXNjX2luZm9y
bWF0aW9uKGRldiwgcmVxKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBSRUFEX1RSQUNLX0lO
Rk9STUFUSU9OOgorICAgICAgICBjZF9zY3NpX2NtZF9nZXRfcmVhZF90cmFja19pbmZvcm1hdGlv
bihkZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgTU9ERV9TRU5TRV8xMDoKKyAg
ICAgICAgY2Rfc2NzaV9jbWRfbW9kZV9zZW5zZV8xMChkZXYsIHJlcSk7CisgICAgICAgIGJyZWFr
OworICAgIGNhc2UgTU9ERV9TRUxFQ1Q6CisgICAgICAgIGNkX3Njc2lfY21kX21vZGVfc2VsZWN0
XzYoZGV2LCByZXEpOworICAgICAgICBicmVhazsKKyAgICBjYXNlIE1PREVfU0VMRUNUXzEwOgor
ICAgICAgICBjZF9zY3NpX2NtZF9tb2RlX3NlbGVjdF8xMChkZXYsIHJlcSk7CisgICAgICAgIGJy
ZWFrOworICAgIGNhc2UgR0VUX0NPTkZJR1VSQVRJT046CisgICAgICAgIGNkX3Njc2lfY21kX2dl
dF9jb25maWd1cmF0aW9uKGRldiwgcmVxKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBBTExP
V19NRURJVU1fUkVNT1ZBTDoKKyAgICAgICAgY2Rfc2NzaV9jbWRfYWxsb3dfbWVkaXVtX3JlbW92
YWwoZGV2LCByZXEpOworICAgICAgICBicmVhazsKKyAgICBjYXNlIE1NQ19TRU5EX0VWRU5UOgor
ICAgICAgICBjZF9zY3NpX2NtZF9zZW5kX2V2ZW50KGRldiwgcmVxKTsKKyAgICAgICAgYnJlYWs7
CisgICAgY2FzZSBNTUNfUkVQT1JUX0tFWToKKyAgICAgICAgY2Rfc2NzaV9jbWRfcmVwb3J0X2tl
eShkZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgTU1DX1NFTkRfS0VZOgorICAg
ICAgICBjZF9zY3NpX2NtZF9zZW5kX2tleShkZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOworICAg
IGNhc2UgU1RBUlRfU1RPUDoKKyAgICAgICAgY2Rfc2NzaV9jbWRfc3RhcnRfc3RvcF91bml0KGRl
diwgcmVxKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBNTUNfR0VUX1BFUkZPUk1BTkNFOgor
ICAgICAgICBjZF9zY3NpX2NtZF9nZXRfcGVyZm9ybWFuY2UoZGV2LCByZXEpOworICAgICAgICBi
cmVhazsKKyAgICBjYXNlIE1NQ19NRUNIQU5JU01fU1RBVFVTOgorICAgICAgICBjZF9zY3NpX2Nt
ZF9tZWNoYW5pc21fc3RhdHVzKGRldiwgcmVxKTsKKyAgICAgICAgYnJlYWs7CisgICAgZGVmYXVs
dDoKKyAgICAgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNl
bnNlX2NvZGVfSU5WQUxJRF9PUENPREUpOworICAgICAgICBicmVhazsKKyAgICB9CisKKyAgICBp
ZiAocmVxLT5yZXFfbGVuID4gSU5UMzJfTUFYKSB7CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBs
ZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX0lOVkFMSURfQ0RCX0ZJRUxEKTsK
KyAgICAgICAgZ290byBkb25lOworICAgIH0KKworZG9uZToKKyAgICBTUElDRV9ERUJVRygicmVx
dWVzdF9zdWJtaXQgZG9uZSwgbHVuOiAldSIKKyAgICAgICAgICAgICAgICAiIG9wOiAweCUwMngg
JXMsIHN0YXRlOiAlcyBzdGF0dXM6ICV1IGxlbjogJSIgR19HVUlOVDY0X0ZPUk1BVCwKKyAgICAg
ICAgICAgICAgICBsdW4sIG9wY29kZSwgY21kX25hbWUsIENkU2NzaVJlcVN0YXRlX3N0cihyZXEt
PnJlcV9zdGF0ZSksIHJlcS0+c3RhdHVzLAorICAgICAgICAgICAgICAgIHJlcS0+aW5fbGVuKTsK
KworICAgIGlmIChyZXEtPnJlcV9zdGF0ZSA9PSBTQ1NJX1JFUV9DT01QTEVURSkgeworICAgICAg
ICBjZF9zY3NpX2Rldl9yZXF1ZXN0X2NvbXBsZXRlKHN0LT51c2VyX2RhdGEsIHJlcSk7CisgICAg
fQorfQorCit2b2lkIGNkX3Njc2lfZGV2X3JlcXVlc3RfY2FuY2VsKENkU2NzaVRhcmdldCAqc3Qs
IENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICBpZiAoc3QtPmN1cl9yZXEgPT0gcmVxKSB7Cisg
ICAgICAgIGlmIChyZXEtPnJlcV9zdGF0ZSA9PSBTQ1NJX1JFUV9SVU5OSU5HKSB7CisgICAgICAg
ICAgICBTUElDRV9ERUJVRygicmVxdWVzdF9jYW5jZWw6IGx1bjogJXUiCisgICAgICAgICAgICAg
ICAgICAgICAgICAgIiBvcDogMHglMDJ4IGxlbjogJSIgR19HVUlOVDY0X0ZPUk1BVCwKKyAgICAg
ICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuLCAodW5zaWduZWQgaW50KXJlcS0+Y2RiWzBdLCBy
ZXEtPnJlcV9sZW4pOworICAgICAgICAgICAgZ19jYW5jZWxsYWJsZV9jYW5jZWwoc3QtPmNhbmNl
bGxhYmxlKTsKKyAgICAgICAgfSBlbHNlIHsKKyAgICAgICAgICAgIFNQSUNFX0RFQlVHKCJyZXF1
ZXN0X2NhbmNlbDogcmVxdWVzdCBpcyBub3QgcnVubmluZyIpOworICAgICAgICB9CisgICAgfSBl
bHNlIHsKKyAgICAgICAgU1BJQ0VfREVCVUcoInJlcXVlc3RfY2FuY2VsOiBvdGhlciByZXF1ZXN0
IGlzIG91dHN0YW5kaW5nIik7CisgICAgfQorfQorCit2b2lkIGNkX3Njc2lfZGV2X3JlcXVlc3Rf
cmVsZWFzZShDZFNjc2lUYXJnZXQgKnN0LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgc3Qt
PmN1cl9yZXEgPSBOVUxMOworICAgIGNkX3Njc2lfcmVxX2luaXQocmVxKTsKKworICAgIGlmIChz
dC0+c3RhdGUgPT0gQ0RfU0NTSV9UR1RfU1RBVEVfUkVTRVQpIHsKKyAgICAgICAgY2Rfc2NzaV90
YXJnZXRfZG9fcmVzZXQoc3QpOworICAgIH0KK30KKworI2VuZGlmIC8qIFVTRV9VU0JSRURJUiAq
LwpkaWZmIC0tZ2l0IGEvc3JjL2NkLXNjc2kuaCBiL3NyYy9jZC1zY3NpLmgKbmV3IGZpbGUgbW9k
ZSAxMDA2NDQKaW5kZXggMDAwMDAwMC4uYzA1OGE2NgotLS0gL2Rldi9udWxsCisrKyBiL3NyYy9j
ZC1zY3NpLmgKQEAgLTAsMCArMSwxMjAgQEAKKy8qIC0qLSBNb2RlOiBDOyBjLWJhc2ljLW9mZnNl
dDogNDsgaW5kZW50LXRhYnMtbW9kZTogbmlsIC0qLSAqLworLyoKKyAgIENEIGRldmljZSBlbXVs
YXRpb24gLSBTQ1NJIGVuZ2luZQorCisgICBDb3B5cmlnaHQgKEMpIDIwMTggUmVkIEhhdCwgSW5j
LgorCisgICBSZWQgSGF0IEF1dGhvcnM6CisgICBBbGV4YW5kZXIgTmV6aGluc2t5PGFuZXpoaW5z
QHJlZGhhdC5jb20+CisKKyAgIFRoaXMgbGlicmFyeSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2Fu
IHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IKKyAgIG1vZGlmeSBpdCB1bmRlciB0aGUgdGVybXMgb2Yg
dGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKKyAgIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5
IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlcgorICAgdmVyc2lvbiAyLjEgb2Yg
dGhlIExpY2Vuc2UsIG9yIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCisKKyAg
IFRoaXMgbGlicmFyeSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUg
dXNlZnVsLAorICAgYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGlt
cGxpZWQgd2FycmFudHkgb2YKKyAgIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBB
UlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUgR05VCisgICBMZXNzZXIgR2VuZXJhbCBQdWJsaWMg
TGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgorCisgICBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQg
YSBjb3B5IG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCisgICBMaWNlbnNlIGFsb25n
IHdpdGggdGhpcyBsaWJyYXJ5OyBpZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vu
c2VzLz4uCisqLworCisjaWZuZGVmIFNQSUNFX0dUS19DRF9TQ1NJX0hfXworI2RlZmluZSBTUElD
RV9HVEtfQ0RfU0NTSV9IX18KKworI2luY2x1ZGUgImNkLXNjc2ktZGV2LXBhcmFtcy5oIgorI2lu
Y2x1ZGUgImNkLXVzYi1idWxrLW1zZC5oIgorI2luY2x1ZGUgInNjc2ktY29uc3RhbnRzLmgiCisK
KyNpZiBkZWZpbmVkKEdfT1NfV0lOMzIpCisjaW5jbHVkZSA8d2luc29jazIuaD4KKyNpbmNsdWRl
IDx3aW5kb3dzLmg+CisvKiBXaW5kb3dzIGlzIGFsd2F5cyBMRSBhdCB0aGUgbW9tZW50ICovCisj
ZGVmaW5lIGxlMzJ0b2goeCkgICAgICAgICAgKHgpCisjZGVmaW5lIGh0b2xlMzIoeCkgICAgICAg
ICAgKHgpCisjZGVmaW5lIGh0b2JlMzIoeCkgICAgICAgICAgaHRvbmwoeCkKKyNlbmRpZgorCit0
eXBlZGVmIGVudW0gU2NzaVhmZXJEaXIgeworICAgIFNDU0lfWEZFUl9OT05FID0gMCwgIC8qIFRF
U1RfVU5JVF9SRUFEWSwgLi4uICAgICAgICAgICAqLworICAgIFNDU0lfWEZFUl9GUk9NX0RFViwg
IC8qIFJFQUQsIElOUVVJUlksIE1PREVfU0VOU0UsIC4uLiAqLworICAgIFNDU0lfWEZFUl9UT19E
RVYsICAgIC8qIFdSSVRFLCBNT0RFX1NFTEVDVCwgLi4uICAgICAgICAqLworfSBTY3NpWGZlckRp
cjsKKworI2RlZmluZSBTQ1NJX0NEQl9CVUZfU0laRSAgIDE2CisKK3R5cGVkZWYgZW51bSBDZFNj
c2lSZXFTdGF0ZSB7CisgICAgU0NTSV9SRVFfSURMRSA9IDAsCisgICAgU0NTSV9SRVFfUlVOTklO
RywKKyAgICBTQ1NJX1JFUV9DT01QTEVURSwKKyAgICBTQ1NJX1JFUV9DQU5DRUxFRCwKKyAgICBT
Q1NJX1JFUV9ESVNQT1NFRCwKK30gQ2RTY3NpUmVxU3RhdGU7CisKK3R5cGVkZWYgc3RydWN0IENk
U2NzaVJlcXVlc3QgeworICAgIC8qIHJlcXVlc3QgKi8KKyAgICB1aW50OF90IGNkYltTQ1NJX0NE
Ql9CVUZfU0laRV07CisgICAgdWludDMyX3QgY2RiX2xlbjsKKworICAgIHVpbnQzMl90IGx1bjsK
KworICAgIHVpbnQ4X3QgKmJ1ZjsKKyAgICB1aW50MzJfdCBidWZfbGVuOworCisgICAgLyogaW50
ZXJuYWwgKi8KKyAgICBDZFNjc2lSZXFTdGF0ZSByZXFfc3RhdGU7CisgICAgU2NzaVhmZXJEaXIg
eGZlcl9kaXI7CisgICAgdWludDY0X3QgY2FuY2VsX2lkOworICAgIHZvaWQgKnByaXZfZGF0YTsK
KworICAgIHVpbnQ2NF90IGxiYTsgLyogb2Zmc2V0IGluIGxvZ2ljYWwgYmxvY2tzIGlmIHJlbGV2
YW50ICovCisgICAgdWludDY0X3QgY291bnQ7IC8qIGNvdW50IGluIGxvZ2ljYWwgYmxvY2tzICov
CisKKyAgICB1aW50NjRfdCBvZmZzZXQ7IC8qIHNjc2kgY2RiIG9mZnNldCwgbm9ybWFsaXplZCB0
byBieXRlcyAqLworICAgIHVpbnQ2NF90IHJlcV9sZW47IC8qIHNjc2kgY2RiIHJlcXVlc3QgbGVu
Z3RoLCBub3JtYWxpemVkIHRvIGJ5dGVzICovCisKKyAgICAvKiByZXN1bHQgKi8KKyAgICB1aW50
NjRfdCBpbl9sZW47IC8qIGxlbmd0aCBvZiBkYXRhIGFjdHVhbGx5IGF2YWlsYWJsZSBhZnRlciBy
ZWFkICovCisgICAgdWludDMyX3Qgc3RhdHVzOyAvKiBTQ1NJIHN0YXR1cyBjb2RlICovCisKK30g
Q2RTY3NpUmVxdWVzdDsKKworQ2RTY3NpUmVxU3RhdGUgY2Rfc2NzaV9nZXRfcmVxX3N0YXRlKENk
U2NzaVJlcXVlc3QgKnJlcSk7CisKKy8qIFNDU0kgdGFyZ2V0L2RldmljZSBBUEkgKi8KK3R5cGVk
ZWYgc3RydWN0IENkU2NzaVRhcmdldCBDZFNjc2lUYXJnZXQ7CisKKy8qIHRvIGJlIHVzZWQgaW4g
Y2FsbGJhY2tzICovCitDZFNjc2lUYXJnZXQgKmNkX3Njc2lfdGFyZ2V0X2FsbG9jKHZvaWQgKnRh
cmdldF91c2VyX2RhdGEsIHVpbnQzMl90IG1heF9sdW5zKTsKK3ZvaWQgY2Rfc2NzaV90YXJnZXRf
ZnJlZShDZFNjc2lUYXJnZXQgKnNjc2lfdGFyZ2V0KTsKKworaW50IGNkX3Njc2lfZGV2X3JlYWxp
emUoQ2RTY3NpVGFyZ2V0ICpzY3NpX3RhcmdldCwgdWludDMyX3QgbHVuLAorICAgICAgICAgICAg
ICAgICAgICAgICAgY29uc3QgQ2RTY3NpRGV2aWNlUGFyYW1ldGVycyAqZGV2X3BhcmFtcyk7Citp
bnQgY2Rfc2NzaV9kZXZfdW5yZWFsaXplKENkU2NzaVRhcmdldCAqc2NzaV90YXJnZXQsIHVpbnQz
Ml90IGx1bik7CisKK2ludCBjZF9zY3NpX2Rldl9sb2NrKENkU2NzaVRhcmdldCAqc2NzaV90YXJn
ZXQsIHVpbnQzMl90IGx1biwgZ2Jvb2xlYW4gbG9jayk7CitpbnQgY2Rfc2NzaV9kZXZfbG9hZChD
ZFNjc2lUYXJnZXQgKnNjc2lfdGFyZ2V0LCB1aW50MzJfdCBsdW4sCisgICAgICAgICAgICAgICAg
ICAgICBjb25zdCBDZFNjc2lNZWRpYVBhcmFtZXRlcnMgKm1lZGlhX3BhcmFtcyk7CitpbnQgY2Rf
c2NzaV9kZXZfZ2V0X2luZm8oQ2RTY3NpVGFyZ2V0ICpzY3NpX3RhcmdldCwgdWludDMyX3QgbHVu
LCBDZFNjc2lEZXZpY2VJbmZvICpsdW5faW5mbyk7CitpbnQgY2Rfc2NzaV9kZXZfdW5sb2FkKENk
U2NzaVRhcmdldCAqc2NzaV90YXJnZXQsIHVpbnQzMl90IGx1bik7CisKK3ZvaWQgY2Rfc2NzaV9k
ZXZfcmVxdWVzdF9zdWJtaXQoQ2RTY3NpVGFyZ2V0ICpzY3NpX3RhcmdldCwgQ2RTY3NpUmVxdWVz
dCAqcmVxdWVzdCk7Cit2b2lkIGNkX3Njc2lfZGV2X3JlcXVlc3RfY2FuY2VsKENkU2NzaVRhcmdl
dCAqc2NzaV90YXJnZXQsIENkU2NzaVJlcXVlc3QgKnJlcXVlc3QpOwordm9pZCBjZF9zY3NpX2Rl
dl9yZXF1ZXN0X3JlbGVhc2UoQ2RTY3NpVGFyZ2V0ICpzY3NpX3RhcmdldCwgQ2RTY3NpUmVxdWVz
dCAqcmVxdWVzdCk7CisKK2ludCBjZF9zY3NpX2Rldl9yZXNldChDZFNjc2lUYXJnZXQgKnNjc2lf
dGFyZ2V0LCB1aW50MzJfdCBsdW4pOworCitpbnQgY2Rfc2NzaV90YXJnZXRfcmVzZXQoQ2RTY3Np
VGFyZ2V0ICpzY3NpX3RhcmdldCk7CisKKy8qIENhbGxiYWNrcworICogVGhlc2UgY2FsbGJhY2tz
IGFyZSB1c2VkIGJ5IHVwcGVyIGxheWVyIHRvIGltcGxlbWVudCBzcGVjaWZpYyBTQ1NJCisgKiB0
YXJnZXQgZGV2aWNlcy4KKyAqLwordm9pZCBjZF9zY3NpX2Rldl9yZXF1ZXN0X2NvbXBsZXRlKHZv
aWQgKnRhcmdldF91c2VyX2RhdGEsIENkU2NzaVJlcXVlc3QgKnJlcXVlc3QpOwordm9pZCBjZF9z
Y3NpX2Rldl9jaGFuZ2VkKHZvaWQgKnRhcmdldF91c2VyX2RhdGEsIHVpbnQzMl90IGx1bik7Cit2
b2lkIGNkX3Njc2lfZGV2X3Jlc2V0X2NvbXBsZXRlKHZvaWQgKnRhcmdldF91c2VyX2RhdGEsIHVp
bnQzMl90IGx1bik7Cit2b2lkIGNkX3Njc2lfdGFyZ2V0X3Jlc2V0X2NvbXBsZXRlKHZvaWQgKnRh
cmdldF91c2VyX2RhdGEpOworCisjZW5kaWYgLyogU1BJQ0VfR1RLX0NEX1NDU0lfSF9fICovCmRp
ZmYgLS1naXQgYS9zcmMvY2QtdXNiLWJ1bGstbXNkLmMgYi9zcmMvY2QtdXNiLWJ1bGstbXNkLmMK
bmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMC4uNDllMDFlYgotLS0gL2Rldi9udWxs
CisrKyBiL3NyYy9jZC11c2ItYnVsay1tc2QuYwpAQCAtMCwwICsxLDU0NCBAQAorLyogLSotIE1v
ZGU6IEM7IGMtYmFzaWMtb2Zmc2V0OiA0OyBpbmRlbnQtdGFicy1tb2RlOiBuaWwgLSotICovCisv
KgorICAgIFVTQiBDRCBEZXZpY2UgZW11bGF0aW9uIC0gRGF0YSBCdWxrIHRyYW5zZmVycyAtIE1h
c3MgU3RvcmFnZSBEZXZpY2UKKworICAgIENvcHlyaWdodCAoQykgMjAxOCBSZWQgSGF0LCBJbmMu
CisKKyAgICBSZWQgSGF0IEF1dGhvcnM6CisgICAgQWxleGFuZGVyIE5lemhpbnNreTxhbmV6aGlu
c0ByZWRoYXQuY29tPgorCisgICAgVGhpcyBsaWJyYXJ5IGlzIGZyZWUgc29mdHdhcmU7IHlvdSBj
YW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vcgorICAgIG1vZGlmeSBpdCB1bmRlciB0aGUgdGVybXMg
b2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKKyAgICBMaWNlbnNlIGFzIHB1Ymxpc2hl
ZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIKKyAgICB2ZXJzaW9uIDIu
MSBvZiB0aGUgTGljZW5zZSwgb3IgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4K
KworICAgIFRoaXMgbGlicmFyeSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdp
bGwgYmUgdXNlZnVsLAorICAgIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVu
IHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCisgICAgTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1Mg
Rk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZSBHTlUKKyAgICBMZXNzZXIgR2VuZXJh
bCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgorCisgICAgWW91IHNob3VsZCBoYXZl
IHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYworICAgIExp
Y2Vuc2UgYWxvbmcgd2l0aCB0aGlzIGxpYnJhcnk7IGlmIG5vdCwgc2VlIDxodHRwOi8vd3d3Lmdu
dS5vcmcvbGljZW5zZXMvPi4KKyovCisKKyNpbmNsdWRlICJjb25maWcuaCIKKyNpbmNsdWRlICJz
cGljZS90eXBlcy5oIgorI2luY2x1ZGUgInNwaWNlLWNvbW1vbi5oIgorI2luY2x1ZGUgInNwaWNl
LXV0aWwuaCIKKyNpbmNsdWRlICJjZC11c2ItYnVsay1tc2QuaCIKKyNpbmNsdWRlICJjZC1zY3Np
LmgiCisKKyNpZmRlZiBVU0VfVVNCUkVESVIKKworI2RlZmluZSBTUElDRV9FUlJPUihmbXQsIC4u
LikgXAorICAgIGRvIHsgU1BJQ0VfREVCVUcoInVzYi1tc2QgZXJyb3I6ICIgZm10ICwgIyMgX19W
QV9BUkdTX18pOyB9IHdoaWxlICgwKQorCit0eXBlZGVmIGVudW0gVXNiQ2RTdGF0ZSB7CisgICAg
VVNCX0NEX1NUQVRFX0lOSVQsIC8qIE5vdCByZWFkeSAqLworICAgIFVTQl9DRF9TVEFURV9DQlcs
IC8qIFdhaXRpbmcgZm9yIENvbW1hbmQgQmxvY2sgKi8KKyAgICBVU0JfQ0RfU1RBVEVfREFUQU9V
VCwgLyogVHJhbnNmZXIgZGF0YSB0byBkZXZpY2UgKi8KKyAgICBVU0JfQ0RfU1RBVEVfREFUQUlO
LCAvKiBUcmFuc2ZlciBkYXRhIGZyb20gZGV2aWNlICovCisgICAgVVNCX0NEX1NUQVRFX1pFUk9f
REFUQUlOLCAvKiBOZWVkIHRvIHNlbmQgemVybyBidWxrLWluIGJlZm9yZSBzdGF0dXMgKi8KKyAg
ICBVU0JfQ0RfU1RBVEVfQ1NXLCAvKiBTZW5kIENvbW1hbmQgU3RhdHVzICovCisgICAgVVNCX0NE
X1NUQVRFX0RFVklDRV9SRVNFVCwgLyogcmVzZXQgb2YgYSBzaW5nbGUgZGV2aWNlICovCisgICAg
VVNCX0NEX1NUQVRFX1RBUkdFVF9SRVNFVCAvKiByZXNldCBvZiBlbnRpcmUgdGFyZ2V0ICovCit9
IFVzYkNkU3RhdGU7CisKKy8qIFVTQiBNU0QgQ29tbWFuZCBCbG9jayBXcmFwcGVyICovCitzdHJ1
Y3QgX19hdHRyaWJ1dGVfXygoX19wYWNrZWRfXykpIFVzYkNkQ0JXIHsKKyAgICB1aW50MzJfdCBz
aWc7CisgICAgdWludDMyX3QgdGFnOworICAgIHVpbnQzMl90IGV4cF9kYXRhX2xlbjsgLyogZXhw
ZWN0ZWQgZGF0YSB4ZmVyIGxlbmd0aCBmb3IgdGhlIHJlcXVlc3QgKi8KKyAgICB1aW50OF90IGZs
YWdzOworICAgIHVpbnQ4X3QgbHVuOworICAgIHVpbnQ4X3QgY21kX2xlbjsgLyogYWN0dWFsIGxl
bmd0aCBvZiB0aGUgc2NzaSBjb21tYW5kIHRoYXQgZm9sbG93cyAqLworICAgIHVpbnQ4X3QgY21k
WzE2XTsgLyogc2NzaSBjb21tYW5kIHRvIHBlcmZvcm0gKi8KK307CisKKy8qIFVTQiBNU0QgQ29t
bWFuZCBTdGF0dXMgV3JhcHBlciAqLworc3RydWN0IF9fYXR0cmlidXRlX18oKF9fcGFja2VkX18p
KSBVc2JDZENTVyB7CisgICAgdWludDMyX3Qgc2lnOworICAgIHVpbnQzMl90IHRhZzsKKyAgICB1
aW50MzJfdCByZXNpZHVlOworICAgIHVpbnQ4X3Qgc3RhdHVzOworfTsKKworLyogVXNiQ2RDU1c6
OnN0YXR1cyAqLwordHlwZWRlZiBlbnVtIFVzYk1zZFN0YXR1cyB7CisgICAgVVNCX01TRF9TVEFU
VVNfR09PRCA9IDAsCisgICAgVVNCX01TRF9TVEFUVVNfRkFJTEVEID0gMSwKKyAgICBVU0JfTVNE
X1NUQVRVU19QSEFTRV9FUlIgPSAyLAorfSBVc2JNc2RTdGF0dXM7CisKK3R5cGVkZWYgc3RydWN0
IFVzYkNkQnVsa01zZFJlcXVlc3QgeworICAgIENkU2NzaVJlcXVlc3Qgc2NzaV9yZXE7CisKKyAg
ICB1aW50MzJfdCBsdW47CisgICAgdWludDMyX3QgdXNiX3JlcV9sZW47IC8qIGxlbmd0aCBvZiBk
YXRhIHJlcXVlc3RlZCBieSB1c2IgKi8KKyAgICB1aW50MzJfdCBzY3NpX2luX2xlbjsgLyogbGVu
Z3RoIG9mIGRhdGEgcmV0dXJuZWQgYnkgc2NzaSBsaW1pdGVkIGJ5IHVzYiByZXF1ZXN0ICovCisK
KyAgICB1aW50MzJfdCB4ZmVyX2xlbjsgLyogbGVuZ3RoIG9mIGRhdGEgdHJhbnNmZXJlZCB1bnRp
bCBub3cgKi8KKyAgICB1aW50MzJfdCBidWxrX2luX2xlbjsgLyogbGVuZ3RoIG9mIHRoZSBsYXN0
IHBvc3Rwb25lZCBidWxrLWluIHJlcXVlc3QgKi8KKworICAgIHN0cnVjdCBVc2JDZENTVyBjc3c7
IC8qIHVzYiBzdGF0dXMgaGVhZGVyICovCit9IFVzYkNkQnVsa01zZFJlcXVlc3Q7CisKK3R5cGVk
ZWYgc3RydWN0IFVzYkNkQnVsa01zZERldmljZSB7CisgICAgVXNiQ2RTdGF0ZSBzdGF0ZTsKKyAg
ICBDZFNjc2lUYXJnZXQgKnNjc2lfdGFyZ2V0OyAvKiBzY3NpIGhhbmRsZSAqLworICAgIHZvaWQg
KnVzYl91c2VyX2RhdGE7IC8qIHVzZWQgaW4gY2FsbGJhY2tzIHRvIHVzYiAqLworICAgIFVzYkNk
QnVsa01zZFJlcXVlc3QgdXNiX3JlcTsgLyogbm93IHN1cHBvcnRpbmcgYSBzaW5nbGUgY21kICov
CisgICAgdWludDhfdCAqZGF0YV9idWY7CisgICAgdWludDMyX3QgZGF0YV9idWZfbGVuOworfSBV
c2JDZEJ1bGtNc2REZXZpY2U7CisKK3N0YXRpYyBpbmxpbmUgY29uc3QgY2hhciAqdXNiX2NkX3N0
YXRlX3N0cihVc2JDZFN0YXRlIHN0YXRlKQoreworICAgIHN3aXRjaCAoc3RhdGUpIHsKKyAgICBj
YXNlIFVTQl9DRF9TVEFURV9JTklUOgorICAgICAgICByZXR1cm4gIklOSVQiOworICAgIGNhc2Ug
VVNCX0NEX1NUQVRFX0NCVzoKKyAgICAgICAgcmV0dXJuICJDQlciOworICAgIGNhc2UgVVNCX0NE
X1NUQVRFX0RBVEFPVVQ6CisgICAgICAgIHJldHVybiAiREFUQU9VVCI7CisgICAgY2FzZSBVU0Jf
Q0RfU1RBVEVfREFUQUlOOgorICAgICAgICByZXR1cm4gIkRBVEFJTiI7CisgICAgY2FzZSBVU0Jf
Q0RfU1RBVEVfWkVST19EQVRBSU46CisgICAgICAgIHJldHVybiAiWkVST19EQVRBSU4iOworICAg
IGNhc2UgVVNCX0NEX1NUQVRFX0NTVzoKKyAgICAgICAgcmV0dXJuICJDU1ciOworICAgIGNhc2Ug
VVNCX0NEX1NUQVRFX0RFVklDRV9SRVNFVDoKKyAgICAgICAgcmV0dXJuICJERVZfUkVTRVQiOwor
ICAgIGNhc2UgVVNCX0NEX1NUQVRFX1RBUkdFVF9SRVNFVDoKKyAgICAgICAgcmV0dXJuICJUR1Rf
UkVTRVQiOworICAgIGRlZmF1bHQ6CisgICAgICAgIHJldHVybiAiSUxMRUdBTCI7CisgICAgfQor
fQorCitzdGF0aWMgdm9pZCBjZF91c2JfYnVsa19tc2Rfc2V0X3N0YXRlKFVzYkNkQnVsa01zZERl
dmljZSAqY2QsIFVzYkNkU3RhdGUgc3RhdGUpCit7CisgICAgU1BJQ0VfREVCVUcoIlN0YXRlICVz
IC0+ICVzIiwgdXNiX2NkX3N0YXRlX3N0cihjZC0+c3RhdGUpLCB1c2JfY2Rfc3RhdGVfc3RyKHN0
YXRlKSk7CisgICAgY2QtPnN0YXRlID0gc3RhdGU7Cit9CisKK1VzYkNkQnVsa01zZERldmljZSAq
Y2RfdXNiX2J1bGtfbXNkX2FsbG9jKHZvaWQgKnVzYl91c2VyX2RhdGEsIHVpbnQzMl90IG1heF9s
dW5zKQoreworICAgIFVzYkNkQnVsa01zZERldmljZSAqY2QgPSBnX25ldzAoVXNiQ2RCdWxrTXNk
RGV2aWNlLCAxKTsKKworICAgIGNkLT5kYXRhX2J1Zl9sZW4gPSAyNTYgKiAxMDI0OworICAgIGNk
LT5kYXRhX2J1ZiA9IGdfbWFsbG9jKGNkLT5kYXRhX2J1Zl9sZW4pOworCisgICAgY2QtPnNjc2lf
dGFyZ2V0ID0gY2Rfc2NzaV90YXJnZXRfYWxsb2MoY2QsIG1heF9sdW5zKTsKKyAgICBpZiAoY2Qt
PnNjc2lfdGFyZ2V0ID09IE5VTEwpIHsKKyAgICAgICAgZ19mcmVlKGNkLT5kYXRhX2J1Zik7Cisg
ICAgICAgIGdfZnJlZShjZCk7CisgICAgICAgIHJldHVybiBOVUxMOworICAgIH0KKyAgICBjZF91
c2JfYnVsa19tc2Rfc2V0X3N0YXRlKGNkLCBVU0JfQ0RfU1RBVEVfSU5JVCk7CisgICAgY2QtPnVz
Yl91c2VyX2RhdGEgPSB1c2JfdXNlcl9kYXRhOworCisgICAgU1BJQ0VfREVCVUcoIkFsbG9jLCBt
YXhfbHVuczolIiBHX0dVSU5UMzJfRk9STUFULCBtYXhfbHVucyk7CisgICAgcmV0dXJuIGNkOwor
fQorCitpbnQgY2RfdXNiX2J1bGtfbXNkX3JlYWxpemUoVXNiQ2RCdWxrTXNkRGV2aWNlICpjZCwg
dWludDMyX3QgbHVuLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IENkU2NzaURl
dmljZVBhcmFtZXRlcnMgKmRldl9wYXJhbXMpCit7CisgICAgQ2RTY3NpRGV2aWNlUGFyYW1ldGVy
cyBzY3NpX2Rldl9wYXJhbXM7CisgICAgaW50IHJjOworCisgICAgc2NzaV9kZXZfcGFyYW1zLnZl
bmRvciA9IGRldl9wYXJhbXMtPnZlbmRvciA/IDogIlNQSUNFIjsKKyAgICBzY3NpX2Rldl9wYXJh
bXMucHJvZHVjdCA9IGRldl9wYXJhbXMtPnByb2R1Y3QgPyA6ICJVU0ItQ0QiOworICAgIHNjc2lf
ZGV2X3BhcmFtcy52ZXJzaW9uID0gZGV2X3BhcmFtcy0+dmVyc2lvbiA/IDogIjAuMSI7CisgICAg
c2NzaV9kZXZfcGFyYW1zLnNlcmlhbCA9IGRldl9wYXJhbXMtPnNlcmlhbCA/IDogIjEyMzQ1NiI7
CisKKyAgICByYyA9IGNkX3Njc2lfZGV2X3JlYWxpemUoY2QtPnNjc2lfdGFyZ2V0LCBsdW4sICZz
Y3NpX2Rldl9wYXJhbXMpOworICAgIGlmIChyYyAhPSAwKSB7CisgICAgICAgIFNQSUNFX0VSUk9S
KCJGYWlsZWQgdG8gcmVhbGl6ZSBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCwgbHVuKTsKKyAgICAg
ICAgcmV0dXJuIHJjOworICAgIH0KKworICAgIGlmIChjZC0+c3RhdGUgPT0gVVNCX0NEX1NUQVRF
X0lOSVQpIHsKKyAgICAgICAgLyogd2FpdCBuZXh0IHJlcXVlc3QgKi8KKyAgICAgICAgY2RfdXNi
X2J1bGtfbXNkX3NldF9zdGF0ZShjZCwgVVNCX0NEX1NUQVRFX0NCVyk7CisgICAgICAgIGNkX3Nj
c2lfZGV2X3JlcXVlc3RfcmVsZWFzZShjZC0+c2NzaV90YXJnZXQsICZjZC0+dXNiX3JlcS5zY3Np
X3JlcSk7CisgICAgfQorCisgICAgU1BJQ0VfREVCVUcoIlJlYWxpemUgT0sgbHVuOiUiIEdfR1VJ
TlQzMl9GT1JNQVQsIGx1bik7CisgICAgcmV0dXJuIDA7Cit9CisKK2ludCBjZF91c2JfYnVsa19t
c2RfbG9jayhVc2JDZEJ1bGtNc2REZXZpY2UgKmNkLCB1aW50MzJfdCBsdW4sIGdib29sZWFuIGxv
Y2spCit7CisgICAgaW50IHJjOworCisgICAgcmMgPSBjZF9zY3NpX2Rldl9sb2NrKGNkLT5zY3Np
X3RhcmdldCwgbHVuLCBsb2NrKTsKKyAgICBpZiAocmMgIT0gMCkgeworICAgICAgICBTUElDRV9F
UlJPUigiRmFpbGVkIHRvIGxvY2sgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQsIGx1bik7CisgICAg
ICAgIHJldHVybiByYzsKKyAgICB9CisKKyAgICBTUElDRV9ERUJVRygiTG9jayBPSyBsdW46JSIg
R19HVUlOVDMyX0ZPUk1BVCwgbHVuKTsKKyAgICByZXR1cm4gMDsKK30KKworaW50IGNkX3VzYl9i
dWxrX21zZF9sb2FkKFVzYkNkQnVsa01zZERldmljZSAqY2QsIHVpbnQzMl90IGx1biwKKyAgICAg
ICAgICAgICAgICAgICAgICAgICBjb25zdCBDZFNjc2lNZWRpYVBhcmFtZXRlcnMgKm1lZGlhX3Bh
cmFtcykKK3sKKyAgICBpbnQgcmM7CisKKyAgICByYyA9IGNkX3Njc2lfZGV2X2xvYWQoY2QtPnNj
c2lfdGFyZ2V0LCBsdW4sIG1lZGlhX3BhcmFtcyk7CisgICAgaWYgKHJjICE9IDApIHsKKyAgICAg
ICAgU1BJQ0VfRVJST1IoIkZhaWxlZCB0byBsb2FkIGx1bjolIiBHX0dVSU5UMzJfRk9STUFULCBs
dW4pOworICAgICAgICByZXR1cm4gcmM7CisgICAgfQorCisgICAgU1BJQ0VfREVCVUcoIkxvYWQg
T0sgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQsIGx1bik7CisgICAgcmV0dXJuIDA7Cit9CisKK2lu
dCBjZF91c2JfYnVsa19tc2RfZ2V0X2luZm8oVXNiQ2RCdWxrTXNkRGV2aWNlICpjZCwgdWludDMy
X3QgbHVuLCBDZFNjc2lEZXZpY2VJbmZvICpsdW5faW5mbykKK3sKKyAgICBpbnQgcmM7CisKKyAg
ICByYyA9IGNkX3Njc2lfZGV2X2dldF9pbmZvKGNkLT5zY3NpX3RhcmdldCwgbHVuLCBsdW5faW5m
byk7CisgICAgaWYgKHJjICE9IDApIHsKKyAgICAgICAgU1BJQ0VfRVJST1IoIkZhaWxlZCB0byBn
ZXQgaW5mbyBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCwgbHVuKTsKKyAgICAgICAgcmV0dXJuIHJj
OworICAgIH0KKworICAgIHJldHVybiAwOworfQorCitpbnQgY2RfdXNiX2J1bGtfbXNkX3VubG9h
ZChVc2JDZEJ1bGtNc2REZXZpY2UgKmNkLCB1aW50MzJfdCBsdW4pCit7CisgICAgaW50IHJjOwor
CisgICAgcmMgPSBjZF9zY3NpX2Rldl91bmxvYWQoY2QtPnNjc2lfdGFyZ2V0LCBsdW4pOworICAg
IGlmIChyYyAhPSAwKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJGYWlsZWQgdG8gdW5sb2FkIGx1
bjolIiBHX0dVSU5UMzJfRk9STUFULCBsdW4pOworICAgICAgICByZXR1cm4gcmM7CisgICAgfQor
CisgICAgU1BJQ0VfREVCVUcoIlVubG9hZCBPSyBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCwgbHVu
KTsKKyAgICByZXR1cm4gMDsKK30KKworaW50IGNkX3VzYl9idWxrX21zZF91bnJlYWxpemUoVXNi
Q2RCdWxrTXNkRGV2aWNlICpjZCwgdWludDMyX3QgbHVuKQoreworICAgIGludCByYzsKKworICAg
IHJjID0gY2Rfc2NzaV9kZXZfdW5yZWFsaXplKGNkLT5zY3NpX3RhcmdldCwgbHVuKTsKKyAgICBp
ZiAocmMgIT0gMCkgeworICAgICAgICBTUElDRV9FUlJPUigiVW5yZWFsaXplIGx1bjolIiBHX0dV
SU5UMzJfRk9STUFULCBsdW4pOworICAgICAgICByZXR1cm4gcmM7CisgICAgfQorCisgICAgU1BJ
Q0VfREVCVUcoIlVucmVhbGl6ZSBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCwgbHVuKTsKKyAgICBy
ZXR1cm4gMDsKK30KKwordm9pZCBjZF91c2JfYnVsa19tc2RfZnJlZShVc2JDZEJ1bGtNc2REZXZp
Y2UgKmNkKQoreworICAgIGNkX3Njc2lfdGFyZ2V0X2ZyZWUoY2QtPnNjc2lfdGFyZ2V0KTsKKyAg
ICBnX2ZyZWUoY2QtPmRhdGFfYnVmKTsKKyAgICBnX2ZyZWUoY2QpOworCisgICAgU1BJQ0VfREVC
VUcoIkZyZWUiKTsKK30KKworaW50IGNkX3VzYl9idWxrX21zZF9yZXNldChVc2JDZEJ1bGtNc2RE
ZXZpY2UgKmNkKQoreworICAgIGNkX3Njc2lfdGFyZ2V0X3Jlc2V0KGNkLT5zY3NpX3RhcmdldCk7
CisgICAgY2RfdXNiX2J1bGtfbXNkX3NldF9zdGF0ZShjZCwgVVNCX0NEX1NUQVRFX0NCVyk7CisK
KyAgICBTUElDRV9ERUJVRygiUmVzZXQiKTsKKyAgICByZXR1cm4gMDsKK30KKworc3RhdGljIGlu
dCBwYXJzZV91c2JfbXNkX2NtZChVc2JDZEJ1bGtNc2REZXZpY2UgKmNkLCB1aW50OF90ICpidWYs
IHVpbnQzMl90IGNid19sZW4pCit7CisgICAgc3RydWN0IFVzYkNkQ0JXICpjYncgPSAoc3RydWN0
IFVzYkNkQ0JXICopYnVmOworICAgIFVzYkNkQnVsa01zZFJlcXVlc3QgKnVzYl9yZXEgPSAmY2Qt
PnVzYl9yZXE7CisgICAgQ2RTY3NpUmVxdWVzdCAqc2NzaV9yZXEgPSAmdXNiX3JlcS0+c2NzaV9y
ZXE7CisKKyAgICBpZiAoY2J3X2xlbiAhPSBzaXplb2YoKmNidykpIHsKKyAgICAgICAgU1BJQ0Vf
RVJST1IoIkNNRDogQmFkIENCVyBzaXplOiUiIEdfR1VJTlQzMl9GT1JNQVQsIGNid19sZW4pOwor
ICAgICAgICByZXR1cm4gLTE7CisgICAgfQorICAgIGlmIChsZTMydG9oKGNidy0+c2lnKSAhPSAw
eDQzNDI1MzU1KSB7IC8qIE1TRCBjb21tYW5kIHNpZ25hdHVyZSAqLworICAgICAgICBTUElDRV9F
UlJPUigiQ01EOiBCYWQgQ0JXIHNpZ25hdHVyZTolMDh4IiwgbGUzMnRvaChjYnctPnNpZykpOwor
ICAgICAgICByZXR1cm4gLTE7CisgICAgfQorICAgIGNvbnN0IHVpbnQ4X3QgY21kX2xlbiA9IGNi
dy0+Y21kX2xlbiAmIDB4MUY7CisgICAgaWYgKGNtZF9sZW4gPCAxIHx8IGNtZF9sZW4gPiAxNikg
eworICAgICAgICBTUElDRV9FUlJPUigiQ01EOiBCYWQgQ0JXIGNvbW1hbmQgbGVuOiUwOHgiLCBj
bWRfbGVuKTsKKyAgICAgICAgcmV0dXJuIC0xOworICAgIH0KKworICAgIHVzYl9yZXEtPmx1biA9
IGNidy0+bHVuOworICAgIHVzYl9yZXEtPnVzYl9yZXFfbGVuID0gbGUzMnRvaChjYnctPmV4cF9k
YXRhX2xlbik7CisKKyAgICB1c2JfcmVxLT5zY3NpX2luX2xlbiA9IDA7IC8qIG5vIGRhdGEgZnJv
bSBzY3NpIHlldCAqLworICAgIHVzYl9yZXEtPnhmZXJfbGVuID0gMDsgLyogbm8gYnVsa3MgdHJh
bnNmZXJlZCB5ZXQgKi8KKyAgICB1c2JfcmVxLT5idWxrX2luX2xlbiA9IDA7IC8qIG5vIGJ1bGst
aW4gcmVxdWVzdHMgeWV0ICovCisKKyAgICBpZiAodXNiX3JlcS0+dXNiX3JlcV9sZW4gPT0gMCkg
eworICAgICAgICBjZF91c2JfYnVsa19tc2Rfc2V0X3N0YXRlKGNkLCBVU0JfQ0RfU1RBVEVfQ1NX
KTsgLyogbm8gZGF0YSAtIHJldHVybiBzdGF0dXMgKi8KKyAgICAgICAgc2NzaV9yZXEtPmJ1ZiA9
IE5VTEw7CisgICAgICAgIHNjc2lfcmVxLT5idWZfbGVuID0gMDsKKyAgICB9IGVsc2UgaWYgKGNi
dy0+ZmxhZ3MgJiAweDgwKSB7CisgICAgICAgIGNkX3VzYl9idWxrX21zZF9zZXRfc3RhdGUoY2Qs
IFVTQl9DRF9TVEFURV9EQVRBSU4pOyAvKiByZWFkIGNvbW1hbmQgKi8KKyAgICAgICAgc2NzaV9y
ZXEtPmJ1ZiA9IGNkLT5kYXRhX2J1ZjsKKyAgICAgICAgc2NzaV9yZXEtPmJ1Zl9sZW4gPSBjZC0+
ZGF0YV9idWZfbGVuOworICAgIH0gZWxzZSB7CisgICAgICAgIGNkX3VzYl9idWxrX21zZF9zZXRf
c3RhdGUoY2QsIFVTQl9DRF9TVEFURV9EQVRBT1VUKTsgLyogd3JpdGUgY29tbWFuZCAqLworICAg
ICAgICBzY3NpX3JlcS0+YnVmID0gTlVMTDsKKyAgICAgICAgc2NzaV9yZXEtPmJ1Zl9sZW4gPSAw
OworICAgIH0KKworICAgIHNjc2lfcmVxLT5jZGJfbGVuID0gY21kX2xlbjsKKyAgICBnX2Fzc2Vy
dChzY3NpX3JlcS0+Y2RiX2xlbiA8PSBzaXplb2Yoc2NzaV9yZXEtPmNkYikpOworICAgIG1lbWNw
eShzY3NpX3JlcS0+Y2RiLCBjYnctPmNtZCwgc2NzaV9yZXEtPmNkYl9sZW4pOworCisgICAgc2Nz
aV9yZXEtPmx1biA9IHVzYl9yZXEtPmx1bjsKKworICAgIFNQSUNFX0RFQlVHKCJDTUQgbHVuOiUi
IEdfR1VJTlQzMl9GT1JNQVQgIiB0YWc6JSN4IGZsYWdzOiUwOHggIgorICAgICAgICAiY2RiX2xl
bjolIiBHX0dVSU5UMzJfRk9STUFUICIgcmVxX2xlbjolIiBHX0dVSU5UMzJfRk9STUFULAorICAg
ICAgICB1c2JfcmVxLT5sdW4sIGxlMzJ0b2goY2J3LT50YWcpLCBjYnctPmZsYWdzLAorICAgICAg
ICBzY3NpX3JlcS0+Y2RiX2xlbiwgdXNiX3JlcS0+dXNiX3JlcV9sZW4pOworCisgICAgLyogcHJl
cGFyZSBzdGF0dXMgLSBDU1cgKi8KKyAgICB1c2JfcmVxLT5jc3cuc2lnID0gaHRvbGUzMigweDUz
NDI1MzU1KTsKKyAgICB1c2JfcmVxLT5jc3cudGFnID0gY2J3LT50YWc7CisgICAgdXNiX3JlcS0+
Y3N3LnJlc2lkdWUgPSAwOworICAgIHVzYl9yZXEtPmNzdy5zdGF0dXMgPSAodWludDhfdClVU0Jf
TVNEX1NUQVRVU19HT09EOworCisgICAgcmV0dXJuIDA7Cit9CisKK3N0YXRpYyB2b2lkIHVzYl9j
ZF9jbWRfZG9uZShVc2JDZEJ1bGtNc2REZXZpY2UgKmNkKQoreworICAgIFVzYkNkQnVsa01zZFJl
cXVlc3QgKnVzYl9yZXEgPSAmY2QtPnVzYl9yZXE7CisgICAgQ2RTY3NpUmVxdWVzdCAqc2NzaV9y
ZXEgPSAmdXNiX3JlcS0+c2NzaV9yZXE7CisKKyAgICBjZF91c2JfYnVsa19tc2Rfc2V0X3N0YXRl
KGNkLCBVU0JfQ0RfU1RBVEVfQ0JXKTsgLyogQ29tbWFuZCBuZXh0ICovCisgICAgY2Rfc2NzaV9k
ZXZfcmVxdWVzdF9yZWxlYXNlKGNkLT5zY3NpX3RhcmdldCwgc2NzaV9yZXEpOworfQorCitzdGF0
aWMgdm9pZCB1c2JfY2Rfc2VuZF9zdGF0dXMoVXNiQ2RCdWxrTXNkRGV2aWNlICpjZCkKK3sKKyAg
ICBVc2JDZEJ1bGtNc2RSZXF1ZXN0ICp1c2JfcmVxID0gJmNkLT51c2JfcmVxOworCisgICAgU1BJ
Q0VfREVCVUcoIkNvbW1hbmQgQ1NXIHRhZzoweCV4IG1zZF9zdGF0dXM6JWQgbGVuOiUiIEdfR1VJ
TlQ2NF9GT1JNQVQsCisgICAgICAgICAgICAgICAgbGUzMnRvaCh1c2JfcmVxLT5jc3cudGFnKSwg
KGludCl1c2JfcmVxLT5jc3cuc3RhdHVzLCBzaXplb2YodXNiX3JlcS0+Y3N3KSk7CisKKyAgICB1
c2JfY2RfY21kX2RvbmUoY2QpOworCisgICAgZ19hc3NlcnQodXNiX3JlcS0+Y3N3LnNpZyA9PSBo
dG9sZTMyKDB4NTM0MjUzNTUpKTsKKyAgICBjZF91c2JfYnVsa19tc2RfcmVhZF9jb21wbGV0ZShj
ZC0+dXNiX3VzZXJfZGF0YSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAodWlu
dDhfdCAqKSZ1c2JfcmVxLT5jc3csIHNpemVvZih1c2JfcmVxLT5jc3cpLAorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIEJVTEtfU1RBVFVTX0dPT0QpOworfQorCitzdGF0aWMgdm9p
ZCB1c2JfY2Rfc2VuZF9jYW5jZWxlZChVc2JDZEJ1bGtNc2REZXZpY2UgKmNkKQoreworICAgIFVz
YkNkQnVsa01zZFJlcXVlc3QgKnVzYl9yZXEgPSAmY2QtPnVzYl9yZXE7CisKKyAgICBTUElDRV9E
RUJVRygiQ2FuY2VsZWQgY21kIHRhZzoweCV4LCBsZW46JSIgR19HVUlOVDY0X0ZPUk1BVCwKKyAg
ICAgICAgICAgICAgICBsZTMydG9oKHVzYl9yZXEtPmNzdy50YWcpLCBzaXplb2YodXNiX3JlcS0+
Y3N3KSk7CisKKyAgICB1c2JfY2RfY21kX2RvbmUoY2QpOworCisgICAgY2RfdXNiX2J1bGtfbXNk
X3JlYWRfY29tcGxldGUoY2QtPnVzYl91c2VyX2RhdGEsCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgTlVMTCwgMCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBC
VUxLX1NUQVRVU19DQU5DRUxFRCk7Cit9CisKK3N0YXRpYyB2b2lkIHVzYl9jZF9zZW5kX2RhdGFf
aW4oVXNiQ2RCdWxrTXNkRGV2aWNlICpjZCwgdWludDMyX3QgbWF4X2xlbikKK3sKKyAgICBVc2JD
ZEJ1bGtNc2RSZXF1ZXN0ICp1c2JfcmVxID0gJmNkLT51c2JfcmVxOworICAgIENkU2NzaVJlcXVl
c3QgKnNjc2lfcmVxID0gJnVzYl9yZXEtPnNjc2lfcmVxOworICAgIHVpbnQ4X3QgKmJ1ZiA9ICgo
dWludDhfdCAqKXNjc2lfcmVxLT5idWYpICsgdXNiX3JlcS0+eGZlcl9sZW47CisgICAgdWludDMy
X3QgYXZhaWxfbGVuID0gdXNiX3JlcS0+c2NzaV9pbl9sZW4gLSB1c2JfcmVxLT54ZmVyX2xlbjsK
KyAgICB1aW50MzJfdCBzZW5kX2xlbiA9IE1JTihhdmFpbF9sZW4sIG1heF9sZW4pOworCisgICAg
U1BJQ0VfREVCVUcoIkRhdGEtaW4gY21kIHRhZyAweCV4LCByZW1haW5zICUiIEdfR1VJTlQzMl9G
T1JNQVQKKyAgICAgICAgICAgICAgICAiLCByZXF1ZXN0ZWQgJSIgR19HVUlOVDMyX0ZPUk1BVCAi
LCBzZW5kICUiIEdfR1VJTlQzMl9GT1JNQVQsCisgICAgICAgICAgICAgICAgdXNiX3JlcS0+Y3N3
LnRhZywgYXZhaWxfbGVuLCBtYXhfbGVuLCBzZW5kX2xlbik7CisKKyAgICBnX2Fzc2VydChtYXhf
bGVuIDw9IHVzYl9yZXEtPnVzYl9yZXFfbGVuKTsKKworICAgIGNkX3VzYl9idWxrX21zZF9yZWFk
X2NvbXBsZXRlKGNkLT51c2JfdXNlcl9kYXRhLAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGJ1Ziwgc2VuZF9sZW4sCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
QlVMS19TVEFUVVNfR09PRCk7CisKKyAgICBpZiAoc2NzaV9yZXEtPnN0YXR1cyA9PSBHT09EKSB7
CisgICAgICAgIHVzYl9yZXEtPnhmZXJfbGVuICs9IHNlbmRfbGVuOworICAgICAgICBpZiAodXNi
X3JlcS0+eGZlcl9sZW4gPT0gdXNiX3JlcS0+c2NzaV9pbl9sZW4pIHsKKyAgICAgICAgICAgIC8q
IGFsbCBkYXRhIGZvciB0aGlzIGJ1bGsgaGFzIGJlZW4gdHJhbnNmZXJyZWQgKi8KKyAgICAgICAg
ICAgIGlmICh1c2JfcmVxLT5zY3NpX2luX2xlbiA9PSB1c2JfcmVxLT51c2JfcmVxX2xlbiB8fCAv
KiByZXEgZnVsbHkgc2F0aXNmaWVkICovCisgICAgICAgICAgICAgICAgc2VuZF9sZW4gPCBtYXhf
bGVuKSB7IC8qIHBhcnRpYWwgYnVsayAtIG5vIG1vcmUgZGF0YSAqLworICAgICAgICAgICAgICAg
IGNkX3VzYl9idWxrX21zZF9zZXRfc3RhdGUoY2QsIFVTQl9DRF9TVEFURV9DU1cpOworICAgICAg
ICAgICAgfSBlbHNlIHsKKyAgICAgICAgICAgICAgICAvKiBwYXJ0aWFsIGNtZCBkYXRhIGZ1bGxm
aWxsZWQgZW50aXJlIHZ1bGstaW4gcmVxdWVzdCAqLworICAgICAgICAgICAgICAgIGNkX3VzYl9i
dWxrX21zZF9zZXRfc3RhdGUoY2QsIFVTQl9DRF9TVEFURV9aRVJPX0RBVEFJTik7CisgICAgICAg
ICAgICB9CisgICAgICAgIH0KKyAgICB9IGVsc2UgeyAvKiBjbWQgZmFpbGVkIC0gbm8gbW9yZSBk
YXRhICovCisgICAgICAgIGNkX3VzYl9idWxrX21zZF9zZXRfc3RhdGUoY2QsIFVTQl9DRF9TVEFU
RV9DU1cpOworICAgIH0KK30KKworaW50IGNkX3VzYl9idWxrX21zZF9yZWFkKFVzYkNkQnVsa01z
ZERldmljZSAqY2QsIHVpbnQzMl90IG1heF9sZW4pCit7CisgICAgVXNiQ2RCdWxrTXNkUmVxdWVz
dCAqdXNiX3JlcSA9ICZjZC0+dXNiX3JlcTsKKyAgICBDZFNjc2lSZXF1ZXN0ICpzY3NpX3JlcSA9
ICZ1c2JfcmVxLT5zY3NpX3JlcTsKKworICAgIFNQSUNFX0RFQlVHKCJtc2RfcmVhZCwgc3RhdGU6
ICVzLCBsZW4gJSIgR19HVUlOVDMyX0ZPUk1BVCwKKyAgICAgICAgICAgICAgICB1c2JfY2Rfc3Rh
dGVfc3RyKGNkLT5zdGF0ZSksIG1heF9sZW4pOworCisgICAgc3dpdGNoIChjZC0+c3RhdGUpIHsK
KyAgICBjYXNlIFVTQl9DRF9TVEFURV9DU1c6IC8qIENvbW1hbmQgU3RhdHVzICovCisgICAgICAg
IGlmIChtYXhfbGVuIDwgMTMpIHsKKyAgICAgICAgICAgIGdvdG8gZmFpbDsKKyAgICAgICAgfQor
ICAgICAgICBpZiAoY2Rfc2NzaV9nZXRfcmVxX3N0YXRlKHNjc2lfcmVxKSA9PSBTQ1NJX1JFUV9D
T01QTEVURSkgeworICAgICAgICAgICAgdXNiX2NkX3NlbmRfc3RhdHVzKGNkKTsKKyAgICAgICAg
fSBlbHNlIHsKKyAgICAgICAgICAgIHVzYl9yZXEtPmJ1bGtfaW5fbGVuICs9IG1heF9sZW47Cisg
ICAgICAgICAgICBTUElDRV9ERUJVRygibXNkX3JlYWQgQ1NXLCByZXEgaW5jb21wbGV0ZSwgYWRk
ZWQgbGVuICUiIEdfR1VJTlQzMl9GT1JNQVQKKyAgICAgICAgICAgICAgICAgICAgICAgICIgc2F2
ZWQgbGVuICUiIEdfR1VJTlQzMl9GT1JNQVQsCisgICAgICAgICAgICAgICAgICAgICAgICBtYXhf
bGVuLCB1c2JfcmVxLT5idWxrX2luX2xlbik7CisgICAgICAgIH0KKyAgICAgICAgYnJlYWs7CisK
KyAgICBjYXNlIFVTQl9DRF9TVEFURV9EQVRBSU46IC8qIEJ1bGsgRGF0YS1JTiAqLworICAgICAg
ICBpZiAoY2Rfc2NzaV9nZXRfcmVxX3N0YXRlKHNjc2lfcmVxKSA9PSBTQ1NJX1JFUV9DT01QTEVU
RSkgeworICAgICAgICAgICAgdXNiX2NkX3NlbmRfZGF0YV9pbihjZCwgbWF4X2xlbik7CisgICAg
ICAgIH0gZWxzZSB7CisgICAgICAgICAgICB1c2JfcmVxLT5idWxrX2luX2xlbiArPSBtYXhfbGVu
OworICAgICAgICAgICAgU1BJQ0VfREVCVUcoIm1zZF9yZWFkIERBVEFJTiwgcmVxIGluY29tcGxl
dGUsIGFkZGVkIGxlbiAlIiBHX0dVSU5UMzJfRk9STUFUCisgICAgICAgICAgICAgICAgICAgICAg
ICAiIHNhdmVkIGxlbiAlIiBHX0dVSU5UMzJfRk9STUFULAorICAgICAgICAgICAgICAgICAgICAg
ICAgbWF4X2xlbiwgdXNiX3JlcS0+YnVsa19pbl9sZW4pOworICAgICAgICB9CisgICAgICAgIGJy
ZWFrOworCisgICAgY2FzZSBVU0JfQ0RfU1RBVEVfWkVST19EQVRBSU46CisgICAgICAgIGNkX3Vz
Yl9idWxrX21zZF9yZWFkX2NvbXBsZXRlKGNkLT51c2JfdXNlcl9kYXRhLAorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBOVUxMLCAwLAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBCVUxLX1NUQVRVU19HT09EKTsKKyAgICAgICAgY2RfdXNiX2J1bGtf
bXNkX3NldF9zdGF0ZShjZCwgVVNCX0NEX1NUQVRFX0NTVyk7IC8qIFN0YXR1cyBuZXh0ICovCisg
ICAgICAgIGJyZWFrOworCisgICAgZGVmYXVsdDoKKyAgICAgICAgU1BJQ0VfRVJST1IoIlVuZXhw
ZWN0ZWQgcmVhZCBzdGF0ZTogJXMsIGxlbiAlIiBHX0dVSU5UMzJfRk9STUFULAorICAgICAgICAg
ICAgICAgICAgICB1c2JfY2Rfc3RhdGVfc3RyKGNkLT5zdGF0ZSksIG1heF9sZW4pOworICAgICAg
ICBnb3RvIGZhaWw7CisgICAgfQorICAgIHJldHVybiAwOworCitmYWlsOgorICAgIHJldHVybiAt
MTsKK30KKwordm9pZCBjZF9zY3NpX2Rldl9yZXF1ZXN0X2NvbXBsZXRlKHZvaWQgKnRhcmdldF91
c2VyX2RhdGEsIENkU2NzaVJlcXVlc3QgKnNjc2lfcmVxKQoreworICAgIFVzYkNkQnVsa01zZERl
dmljZSAqY2QgPSAoVXNiQ2RCdWxrTXNkRGV2aWNlICopdGFyZ2V0X3VzZXJfZGF0YTsKKyAgICBV
c2JDZEJ1bGtNc2RSZXF1ZXN0ICp1c2JfcmVxID0gJmNkLT51c2JfcmVxOworCisgICAgZ19hc3Nl
cnQoc2NzaV9yZXEgPT0gJnVzYl9yZXEtPnNjc2lfcmVxKTsKKworICAgIGlmIChzY3NpX3JlcS0+
cmVxX3N0YXRlID09IFNDU0lfUkVRX0NPTVBMRVRFKSB7CisKKyAgICAgICAgdXNiX3JlcS0+c2Nz
aV9pbl9sZW4gPSAoc2NzaV9yZXEtPmluX2xlbiA8PSB1c2JfcmVxLT51c2JfcmVxX2xlbikgPwor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3NpX3JlcS0+aW5fbGVuIDogdXNiX3Jl
cS0+dXNiX3JlcV9sZW47CisKKyAgICAgICAgLyogcHJlcGFyZSBDU1cgKi8KKyAgICAgICAgaWYg
KHVzYl9yZXEtPnVzYl9yZXFfbGVuID4gdXNiX3JlcS0+c2NzaV9pbl9sZW4pIHsKKyAgICAgICAg
ICAgIHVzYl9yZXEtPmNzdy5yZXNpZHVlID0gaHRvbGUzMih1c2JfcmVxLT51c2JfcmVxX2xlbiAt
IHVzYl9yZXEtPnNjc2lfaW5fbGVuKTsKKyAgICAgICAgfQorICAgICAgICBpZiAoc2NzaV9yZXEt
PnN0YXR1cyAhPSBHT09EKSB7CisgICAgICAgICAgICB1c2JfcmVxLT5jc3cuc3RhdHVzID0gKHVp
bnQ4X3QpVVNCX01TRF9TVEFUVVNfRkFJTEVEOworICAgICAgICB9CisKKyAgICAgICAgaWYgKHVz
Yl9yZXEtPmJ1bGtfaW5fbGVuKSB7CisgICAgICAgICAgICAvKiBidWxrLWluIHJlcXVlc3QgYXJy
aXZlZCB3aGlsZSBzY3NpIHdhcyBzdGlsbCBydW5uaW5nICovCisgICAgICAgICAgICBpZiAoY2Qt
PnN0YXRlID09IFVTQl9DRF9TVEFURV9EQVRBSU4pIHsKKyAgICAgICAgICAgICAgICB1c2JfY2Rf
c2VuZF9kYXRhX2luKGNkLCB1c2JfcmVxLT5idWxrX2luX2xlbik7CisgICAgICAgICAgICB9IGVs
c2UgaWYgKGNkLT5zdGF0ZSA9PSBVU0JfQ0RfU1RBVEVfQ1NXKSB7CisgICAgICAgICAgICAgICAg
dXNiX2NkX3NlbmRfc3RhdHVzKGNkKTsKKyAgICAgICAgICAgIH0KKyAgICAgICAgICAgIHVzYl9y
ZXEtPmJ1bGtfaW5fbGVuID0gMDsKKyAgICAgICAgfQorICAgIH0gZWxzZSBpZiAoc2NzaV9yZXEt
PnJlcV9zdGF0ZSA9PSBTQ1NJX1JFUV9DQU5DRUxFRCkgeworICAgICAgICB1c2JfY2Rfc2VuZF9j
YW5jZWxlZChjZCk7CisgICAgfSBlbHNlIHsKKyAgICAgICAgZ19hc3NlcnQoc2NzaV9yZXEtPnJl
cV9zdGF0ZSA9PSBTQ1NJX1JFUV9ESVNQT1NFRCk7CisgICAgICAgIFNQSUNFX0RFQlVHKCJEaXNw
b3NlZCBjbWQgdGFnOjB4JXgsIGxlbjolIiBHX0dVSU5UNjRfRk9STUFULAorICAgICAgICAgICAg
ICAgIGxlMzJ0b2godXNiX3JlcS0+Y3N3LnRhZyksIHNpemVvZih1c2JfcmVxLT5jc3cpKTsKKyAg
ICAgICAgdXNiX2NkX2NtZF9kb25lKGNkKTsKKyAgICB9Cit9CisKK2ludCBjZF91c2JfYnVsa19t
c2RfY2FuY2VsX3JlYWQoVXNiQ2RCdWxrTXNkRGV2aWNlICpjZCkKK3sKKyAgICBVc2JDZEJ1bGtN
c2RSZXF1ZXN0ICp1c2JfcmVxID0gJmNkLT51c2JfcmVxOworICAgIENkU2NzaVJlcXVlc3QgKnNj
c2lfcmVxID0gJnVzYl9yZXEtPnNjc2lfcmVxOworCisgICAgY2Rfc2NzaV9kZXZfcmVxdWVzdF9j
YW5jZWwoY2QtPnNjc2lfdGFyZ2V0LCBzY3NpX3JlcSk7CisgICAgcmV0dXJuIDA7Cit9CisKK2lu
dCBjZF91c2JfYnVsa19tc2Rfd3JpdGUoVXNiQ2RCdWxrTXNkRGV2aWNlICpjZCwgdWludDhfdCAq
YnVmX291dCwgdWludDMyX3QgYnVmX291dF9sZW4pCit7CisgICAgc3dpdGNoIChjZC0+c3RhdGUp
IHsKKyAgICBjYXNlIFVTQl9DRF9TVEFURV9DQlc6IC8qIENvbW1hbmQgQmxvY2sgKi8KKyAgICAg
ICAgcGFyc2VfdXNiX21zZF9jbWQoY2QsIGJ1Zl9vdXQsIGJ1Zl9vdXRfbGVuKTsKKyAgICAgICAg
aWYgKGNkLT5zdGF0ZSA9PSBVU0JfQ0RfU1RBVEVfREFUQUlOIHx8IGNkLT5zdGF0ZSA9PSBVU0Jf
Q0RfU1RBVEVfQ1NXKSB7CisgICAgICAgICAgICBjZF9zY3NpX2Rldl9yZXF1ZXN0X3N1Ym1pdChj
ZC0+c2NzaV90YXJnZXQsICZjZC0+dXNiX3JlcS5zY3NpX3JlcSk7CisgICAgICAgIH0KKyAgICAg
ICAgYnJlYWs7CisgICAgY2FzZSBVU0JfQ0RfU1RBVEVfREFUQU9VVDogLyogRGF0YS1PdXQgZm9y
IGEgV3JpdGUgY21kICovCisgICAgICAgIGNkLT51c2JfcmVxLnNjc2lfcmVxLmJ1ZiA9IGJ1Zl9v
dXQ7CisgICAgICAgIGNkLT51c2JfcmVxLnNjc2lfcmVxLmJ1Zl9sZW4gPSBidWZfb3V0X2xlbjsK
KyAgICAgICAgY2Rfc2NzaV9kZXZfcmVxdWVzdF9zdWJtaXQoY2QtPnNjc2lfdGFyZ2V0LCAmY2Qt
PnVzYl9yZXEuc2NzaV9yZXEpOworICAgICAgICBjZF91c2JfYnVsa19tc2Rfc2V0X3N0YXRlKGNk
LCBVU0JfQ0RfU1RBVEVfQ1NXKTsgLyogU3RhdHVzIG5leHQgKi8KKyAgICAgICAgYnJlYWs7Cisg
ICAgZGVmYXVsdDoKKyAgICAgICAgU1BJQ0VfREVCVUcoIlVuZXhwZWN0ZWQgd3JpdGUgc3RhdGU6
ICVzLCBsZW4gJSIgR19HVUlOVDMyX0ZPUk1BVCwKKyAgICAgICAgICAgICAgICAgICAgdXNiX2Nk
X3N0YXRlX3N0cihjZC0+c3RhdGUpLCBidWZfb3V0X2xlbik7CisgICAgICAgIGdvdG8gZmFpbDsK
KyAgICB9CisgICAgcmV0dXJuIDA7CisKK2ZhaWw6CisgICAgcmV0dXJuIC0xOworfQorCit2b2lk
IGNkX3Njc2lfZGV2X3Jlc2V0X2NvbXBsZXRlKHZvaWQgKnRhcmdldF91c2VyX2RhdGEsIHVpbnQz
Ml90IGx1bikKK3sKKyAgICBVc2JDZEJ1bGtNc2REZXZpY2UgKmNkID0gKFVzYkNkQnVsa01zZERl
dmljZSAqKXRhcmdldF91c2VyX2RhdGE7CisKKyAgICBpZiAoY2QtPnN0YXRlID09IFVTQl9DRF9T
VEFURV9ERVZJQ0VfUkVTRVQpIHsKKyAgICAgICAgY2RfdXNiX2J1bGtfbXNkX3NldF9zdGF0ZShj
ZCwgVVNCX0NEX1NUQVRFX0NCVyk7CisgICAgICAgIGNkX3VzYl9idWxrX21zZF9yZXNldF9jb21w
bGV0ZShjZC0+dXNiX3VzZXJfZGF0YSwgMCk7CisgICAgfQorfQorCit2b2lkIGNkX3Njc2lfdGFy
Z2V0X3Jlc2V0X2NvbXBsZXRlKHZvaWQgKnRhcmdldF91c2VyX2RhdGEpCit7CisgICAgVXNiQ2RC
dWxrTXNkRGV2aWNlICpjZCA9IChVc2JDZEJ1bGtNc2REZXZpY2UgKil0YXJnZXRfdXNlcl9kYXRh
OworICAgIGNkX3VzYl9idWxrX21zZF9zZXRfc3RhdGUoY2QsIFVTQl9DRF9TVEFURV9JTklUKTsK
K30KKwordm9pZCBjZF9zY3NpX2Rldl9jaGFuZ2VkKHZvaWQgKnRhcmdldF91c2VyX2RhdGEsIHVp
bnQzMl90IGx1bikKK3sKKyAgICBVc2JDZEJ1bGtNc2REZXZpY2UgKmNkID0gKFVzYkNkQnVsa01z
ZERldmljZSAqKXRhcmdldF91c2VyX2RhdGE7CisgICAgU1BJQ0VfREVCVUcoIkRldmljZSBjaGFu
Z2VkLCBzdGF0ZTogJXMgbHVuOiAlIiBHX0dVSU5UMzJfRk9STUFULAorICAgICAgICAgICAgICAg
IHVzYl9jZF9zdGF0ZV9zdHIoY2QtPnN0YXRlKSwgbHVuKTsKKyAgICBjZF91c2JfYnVsa19tc2Rf
bHVuX2NoYW5nZWQoY2QtPnVzYl91c2VyX2RhdGEsIGx1bik7Cit9CisKKyNlbmRpZiAvKiBVU0Vf
VVNCUkVESVIgKi8KZGlmZiAtLWdpdCBhL3NyYy9jZC11c2ItYnVsay1tc2QuaCBiL3NyYy9jZC11
c2ItYnVsay1tc2QuaApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwLi40OTJhNDli
Ci0tLSAvZGV2L251bGwKKysrIGIvc3JjL2NkLXVzYi1idWxrLW1zZC5oCkBAIC0wLDAgKzEsMTM0
IEBACisvKiAtKi0gTW9kZTogQzsgYy1iYXNpYy1vZmZzZXQ6IDQ7IGluZGVudC10YWJzLW1vZGU6
IG5pbCAtKi0gKi8KKy8qCisgICAgQ29weXJpZ2h0IChDKSAyMDE4IFJlZCBIYXQsIEluYy4KKwor
ICAgIFJlZCBIYXQgQXV0aG9yczoKKyAgICBBbGV4YW5kZXIgTmV6aGluc2t5PGFuZXpoaW5zQHJl
ZGhhdC5jb20+CisKKyAgICBUaGlzIGxpYnJhcnkgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiBy
ZWRpc3RyaWJ1dGUgaXQgYW5kL29yCisgICAgbW9kaWZ5IGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0
aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYworICAgIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5
IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlcgorICAgIHZlcnNpb24gMi4xIG9m
IHRoZSBMaWNlbnNlLCBvciAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgorCisg
ICAgVGhpcyBsaWJyYXJ5IGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBi
ZSB1c2VmdWwsCisgICAgYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhl
IGltcGxpZWQgd2FycmFudHkgb2YKKyAgICBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1Ig
QSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlIEdOVQorICAgIExlc3NlciBHZW5lcmFsIFB1
YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCisKKyAgICBZb3Ugc2hvdWxkIGhhdmUgcmVj
ZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCisgICAgTGljZW5z
ZSBhbG9uZyB3aXRoIHRoaXMgbGlicmFyeTsgaWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9y
Zy9saWNlbnNlcy8+LgorKi8KKworI2lmbmRlZiBTUElDRV9HVEtfQ0RfVVNCX0JVTEtfTVNEX0hf
XworI2RlZmluZSBTUElDRV9HVEtfQ0RfVVNCX0JVTEtfTVNEX0hfXworCitHX0JFR0lOX0RFQ0xT
CisKKyNpbmNsdWRlIDxnaW8vZ2lvLmg+CisKKyNpbmNsdWRlICJjZC1zY3NpLWRldi1wYXJhbXMu
aCIKKwordHlwZWRlZiBlbnVtIENkVXNiQnVsa1N0YXR1cyB7CisgICAgQlVMS19TVEFUVVNfR09P
RCA9IDAsCisgICAgQlVMS19TVEFUVVNfRVJST1IsCisgICAgQlVMS19TVEFUVVNfQ0FOQ0VMRUQs
CisgICAgQlVMS19TVEFUVVNfU1RBTEwsCit9IENkVXNiQnVsa1N0YXR1czsKKwordHlwZWRlZiBz
dHJ1Y3QgVXNiQ2RCdWxrTXNkRGV2aWNlIFVzYkNkQnVsa01zZERldmljZTsKKworLyogVVNCIGJh
Y2tlbmQgY2FsbGJhY2tzICovCisKKy8qIGNhbGxlZCBvbiBjb21wbGV0ZWQgcmVhZCBkYXRhIGJ1
bGsgdHJhbnNmZXIKKyAqIHVzZXJfZGF0YSAtIHVzZXJfZGF0YSBpbiB1bml0IHBhcmFtZXRlcnMg
c3RydWN0dXJlCisgKiBzdGF0dXMgLSBidWxrIHN0YXR1cyBjb2RlCisgKi8KK3ZvaWQgY2RfdXNi
X2J1bGtfbXNkX3JlYWRfY29tcGxldGUodm9pZCAqdXNlcl9kYXRhLAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICB1aW50OF90ICpkYXRhLCB1aW50MzJfdCBsZW5ndGgsCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENkVXNiQnVsa1N0YXR1cyBzdGF0dXMpOwor
CisvKiBjYWxsZWQgd2hlbiBzdGF0ZSBvZiBkZXZpY2UncyB1bml0IGNoYW5nZWQgdG8gc2lnbmFs
IEdVSSBjb21wb25lbnQKKyAqICB1c2VyX2RhdGEgLSB1c2VyX2RhdGEgaW4gdW5pdCBwYXJhbWV0
ZXJzIHN0cnVjdHVyZQorICovCit2b2lkIGNkX3VzYl9idWxrX21zZF9sdW5fY2hhbmdlZCh2b2lk
ICp1c2VyX2RhdGEsIHVpbnQzMl90IGx1bik7CisKKy8qIGNhbGxlZCBvbiBjb21wbGV0ZWQgZGV2
aWNlIHJlc2V0CisgKiB1c2VyX2RhdGEgLSB1c2VyX2RhdGEgaW4gdW5pdCBwYXJhbWV0ZXJzIHN0
cnVjdHVyZQorICogc3RhdHVzIC0gZXJyb3IgY29kZQorICovCit2b2lkIGNkX3VzYl9idWxrX21z
ZF9yZXNldF9jb21wbGV0ZSh2b2lkICp1c2VyX2RhdGEsCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBpbnQgc3RhdHVzKTsKKworLyogTVNEIGJhY2tlbmQgYXBpICovCisKKy8q
IGFsbG9jYXRlIG5ldyBkZXZpY2UgZGVzY3JpcHRvciAqLworVXNiQ2RCdWxrTXNkRGV2aWNlICpj
ZF91c2JfYnVsa19tc2RfYWxsb2Modm9pZCAqdXNlcl9kYXRhLCB1aW50MzJfdCBtYXhfbHVuKTsK
KworLyogZnJlZSBkZXZpY2UgZGVzY3JpcHRvciAqLwordm9pZCBjZF91c2JfYnVsa19tc2RfZnJl
ZShVc2JDZEJ1bGtNc2REZXZpY2UgKmRldmljZSk7CisKKy8qIGNvbmZpZ3VyZSBhIG5ldyBMb2dp
Y2FsIFVuaXQgdG8gYmUgcmVwcmVzZW4gdGVkIGJ5IHRoZSBkZXZpY2UKKyAqICByZXR1cm5zOiBl
cnJvciBjb2RlCisgKi8KK2ludCBjZF91c2JfYnVsa19tc2RfcmVhbGl6ZShVc2JDZEJ1bGtNc2RE
ZXZpY2UgKmRldmljZSwgdWludDMyX3QgbHVuLAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGNvbnN0IENkU2NzaURldmljZVBhcmFtZXRlcnMgKmRldl9wYXJhbXMpOworCisvKiBsb2NrIHRo
ZSBkZXZpY2UsIHByZXZlbnQgdW5sb2FkaW5nCisgKiByZXR1cm5zOiBlcnJvciBjb2RlCisgKi8K
K2ludCBjZF91c2JfYnVsa19tc2RfbG9jayhVc2JDZEJ1bGtNc2REZXZpY2UgKmRldmljZSwgdWlu
dDMyX3QgbHVuLCBnYm9vbGVhbiBsb2NrKTsKKworLyogbG9hZCBuZXcgbWVkaWEsIGlmIGFscmVh
ZHkgbG9hZGVkLCBzaW11bGF0ZSBtZWRpYSBjaGFuZ2UKKyAqIHJldHVybnM6IGVycm9yIGNvZGUK
KyAqLworaW50IGNkX3VzYl9idWxrX21zZF9sb2FkKFVzYkNkQnVsa01zZERldmljZSAqZGV2aWNl
LCB1aW50MzJfdCBsdW4sCisgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgQ2RTY3NpTWVk
aWFQYXJhbWV0ZXJzICptZWRpYV9wYXJhbXMpOworCisvKiBxdWVyeSB1bml0IHBhcmFtZXRlcnMg
YW5kIHN0YXR1cworICogcmV0dXJuczogZXJyb3IgY29kZQorICovCitpbnQgY2RfdXNiX2J1bGtf
bXNkX2dldF9pbmZvKFVzYkNkQnVsa01zZERldmljZSAqZGV2aWNlLCB1aW50MzJfdCBsdW4sCisg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIENkU2NzaURldmljZUluZm8gKmx1bl9pbmZvKTsK
KworLyogdW5sb2FkIHRoZSBtZWRpYQorICogcmV0dXJuczogZXJyb3IgY29kZQorICovCitpbnQg
Y2RfdXNiX2J1bGtfbXNkX3VubG9hZChVc2JDZEJ1bGtNc2REZXZpY2UgKmRldmljZSwgdWludDMy
X3QgbHVuKTsKKworLyogZGV0YWNoIGEgTG9naWNhbCBVbml0CisgKiByZXR1cm5zOiBlcnJvciBj
b2RlCisgKi8KK2ludCBjZF91c2JfYnVsa19tc2RfdW5yZWFsaXplKFVzYkNkQnVsa01zZERldmlj
ZSAqZGV2aWNlLCB1aW50MzJfdCBsdW4pOworCisvKiByZXNldCB0aGUgZGV2aWNlIGluc3RhbmNl
OyBjYW5jZWwgYWxsIElPIG9wcywgcmVzZXQgc3RhdGUKKyAqIHJldHVybnM6IGVycm9yIGNvZGUK
KyAqLworaW50IGNkX3VzYl9idWxrX21zZF9yZXNldChVc2JDZEJ1bGtNc2REZXZpY2UgKmRldmlj
ZSk7CisKKworLyogcGVyZm9ybSBhIHdyaXRlIGRhdGEgYnVsayB0cmFuc2ZlcgorICogZGF0YV9s
ZW4gLSBsZW5ndGggb2YgYXZhaWxhYmxlIGRhdGEgdG8gd3JpdGUKKyAqIHJldHVybnM6IGVycm9y
IGNvZGUKKyAqLworaW50IGNkX3VzYl9idWxrX21zZF93cml0ZShVc2JDZEJ1bGtNc2REZXZpY2Uq
ZGV2aWNlLCB1aW50OF90ICpidWYsIHVpbnQzMl90IGRhdGFfbGVuKTsKKworCisvKiBwZXJmb3Jt
IGEgcmVhZCBkYXRhIGJ1bGsgdHJhbnNmZXIKKyAqIG1heF9sZW4gLSBsZW5ndGggb2YgYXZhaWxh
YmxlIGJ1ZmZlciB0byBmaWxsCisgKiBJZiBkYXRhIGF2YWlsYWJsZSBpbW1lZGlhdGVseSwgc2hv
dWxkIGNhbGwgY2RfdXNiX2J1bGtfbXNkX3JlYWRfY29tcGxldGUoKQorICogICBhbmQgcmV0dXJu
IHN1Y2Nlc3MKKyAqIElmIGZhdGFsIGVycm9yIGRldGVjdGVkIGltbWVkaWF0ZWx5LCBzaG91bGQg
Y2FsbCBjZF91c2JfYnVsa19tc2RfcmVhZF9jb21wbGV0ZSgpCisgKiAgIHdpdGggZXJyb3IgY29k
ZSBhbmQgcmV0dXJuIHN1Y2Nlc3MKKyAqCisgKiByZXR1cm5zOiAwIC0gc3VjY2VzcywgLTEgLSBl
cnJvcgorICovCitpbnQgY2RfdXNiX2J1bGtfbXNkX3JlYWQoVXNiQ2RCdWxrTXNkRGV2aWNlICpk
ZXZpY2UsIHVpbnQzMl90IG1heF9sZW4pOworCisvKiBjYW5jZWxzIHBlbmRpbmcgcmVhZCBkYXRh
IGJ1bGsgdHJhbnNmZXIKKyAqIHJldHVybnM6IGVycm9yIGNvZGUKKyAqLworaW50IGNkX3VzYl9i
dWxrX21zZF9jYW5jZWxfcmVhZChVc2JDZEJ1bGtNc2REZXZpY2UgKmRldmljZSk7CisKK0dfRU5E
X0RFQ0xTCisKKyNlbmRpZiAvKiBTUElDRV9HVEtfQ0RfVVNCX0JVTEtfTVNEX0hfXyAqLwpkaWZm
IC0tZ2l0IGEvc3JjL3Njc2ktY29uc3RhbnRzLmggYi9zcmMvc2NzaS1jb25zdGFudHMuaApuZXcg
ZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwLi5jZjhhODgyCi0tLSAvZGV2L251bGwKKysr
IGIvc3JjL3Njc2ktY29uc3RhbnRzLmgKQEAgLTAsMCArMSwzMjQgQEAKKy8qIC0qLSBNb2RlOiBD
OyBjLWJhc2ljLW9mZnNldDogNDsgaW5kZW50LXRhYnMtbW9kZTogbmlsIC0qLSAqLworLyoKKyAg
IENvcHlyaWdodCAoQykgMjAxOCBSZWQgSGF0LCBJbmMuCisgICBCYXNlZCBvbiB0aGUgR0xpYiBo
ZWFkZXIKKworICAgVGhpcyBsaWJyYXJ5IGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0
cmlidXRlIGl0IGFuZC9vcgorICAgbW9kaWZ5IGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05V
IExlc3NlciBHZW5lcmFsIFB1YmxpYworICAgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkgdGhlIEZy
ZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyCisgICB2ZXJzaW9uIDIuMSBvZiB0aGUgTGlj
ZW5zZSwgb3IgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4KKworICAgVGhpcyBs
aWJyYXJ5IGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWws
CisgICBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3
YXJyYW50eSBvZgorICAgTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxB
UiBQVVJQT1NFLiAgU2VlIHRoZSBHTlUKKyAgIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNl
IGZvciBtb3JlIGRldGFpbHMuCisKKyAgIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkg
b2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKKyAgIExpY2Vuc2UgYWxvbmcgd2l0aCB0
aGlzIGxpYnJhcnk7IGlmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4K
KyovCisKKyNpZm5kZWYgU1BJQ0VfR1RLX1NDU0lfQ09OU1RBTlRTX0hfXworI2RlZmluZSBTUElD
RV9HVEtfU0NTSV9DT05TVEFOVFNfSF9fCisKKy8qCisgKiAgICAgIFNDU0kgb3Bjb2RlcworICov
CisKKyNkZWZpbmUgVEVTVF9VTklUX1JFQURZICAgICAgIDB4MDAKKyNkZWZpbmUgUkVXSU5EICAg
ICAgICAgICAgICAgIDB4MDEKKyNkZWZpbmUgUkVRVUVTVF9TRU5TRSAgICAgICAgIDB4MDMKKyNk
ZWZpbmUgRk9STUFUX1VOSVQgICAgICAgICAgIDB4MDQKKyNkZWZpbmUgUkVBRF9CTE9DS19MSU1J
VFMgICAgIDB4MDUKKyNkZWZpbmUgSU5JVElBTElaRV9FTEVNRU5UX1NUQVRVUyAweDA3CisjZGVm
aW5lIFJFQVNTSUdOX0JMT0NLU18gICAgICAweDA3CisjZGVmaW5lIFJFQURfNiAgICAgICAgICAg
ICAgICAweDA4CisjZGVmaW5lIFdSSVRFXzYgICAgICAgICAgICAgICAweDBhCisjZGVmaW5lIFNF
VF9DQVBBQ0lUWSAgICAgICAgICAweDBiCisjZGVmaW5lIFJFQURfUkVWRVJTRSAgICAgICAgICAw
eDBmCisjZGVmaW5lIFdSSVRFX0ZJTEVNQVJLUyAgICAgICAweDEwCisjZGVmaW5lIFNQQUNFICAg
ICAgICAgICAgICAgICAweDExCisjZGVmaW5lIElOUVVJUlkgICAgICAgICAgICAgICAweDEyCisj
ZGVmaW5lIFJFQ09WRVJfQlVGRkVSRURfREFUQSAweDE0CisjZGVmaW5lIE1PREVfU0VMRUNUICAg
ICAgICAgICAweDE1CisjZGVmaW5lIFJFU0VSVkUgICAgICAgICAgICAgICAweDE2CisjZGVmaW5l
IFJFTEVBU0UgICAgICAgICAgICAgICAweDE3CisjZGVmaW5lIENPUFkgICAgICAgICAgICAgICAg
ICAweDE4CisjZGVmaW5lIEVSQVNFICAgICAgICAgICAgICAgICAweDE5CisjZGVmaW5lIE1PREVf
U0VOU0UgICAgICAgICAgICAweDFhCisjZGVmaW5lIExPQURfVU5MT0FEICAgICAgICAgICAweDFi
CisjZGVmaW5lIFNDQU4gICAgICAgICAgICAgICAgICAweDFiCisjZGVmaW5lIFNUQVJUX1NUT1Ag
ICAgICAgICAgICAweDFiCisjZGVmaW5lIFJFQ0VJVkVfRElBR05PU1RJQyAgICAweDFjCisjZGVm
aW5lIFNFTkRfRElBR05PU1RJQyAgICAgICAweDFkCisjZGVmaW5lIEFMTE9XX01FRElVTV9SRU1P
VkFMICAweDFlCisjZGVmaW5lIFNFVF9XSU5ET1cgICAgICAgICAgICAweDI0CisjZGVmaW5lIFJF
QURfQ0FQQUNJVFlfMTAgICAgICAweDI1CisjZGVmaW5lIEdFVF9XSU5ET1cgICAgICAgICAgICAw
eDI1CisjZGVmaW5lIFJFQURfMTAgICAgICAgICAgICAgICAweDI4CisjZGVmaW5lIFdSSVRFXzEw
ICAgICAgICAgICAgICAweDJhCisjZGVmaW5lIFNFTkQgICAgICAgICAgICAgICAgICAweDJhCisj
ZGVmaW5lIFNFRUtfMTAgICAgICAgICAgICAgICAweDJiCisjZGVmaW5lIExPQ0FURV8xMCAgICAg
ICAgICAgICAweDJiCisjZGVmaW5lIFBPU0lUSU9OX1RPX0VMRU1FTlQgICAweDJiCisjZGVmaW5l
IFdSSVRFX1ZFUklGWV8xMCAgICAgICAweDJlCisjZGVmaW5lIFZFUklGWV8xMCAgICAgICAgICAg
ICAweDJmCisjZGVmaW5lIFNFQVJDSF9ISUdIICAgICAgICAgICAweDMwCisjZGVmaW5lIFNFQVJD
SF9FUVVBTCAgICAgICAgICAweDMxCisjZGVmaW5lIE9CSkVDVF9QT1NJVElPTiAgICAgICAweDMx
CisjZGVmaW5lIFNFQVJDSF9MT1cgICAgICAgICAgICAweDMyCisjZGVmaW5lIFNFVF9MSU1JVFMg
ICAgICAgICAgICAweDMzCisjZGVmaW5lIFBSRV9GRVRDSCAgICAgICAgICAgICAweDM0CisjZGVm
aW5lIFJFQURfUE9TSVRJT04gICAgICAgICAweDM0CisjZGVmaW5lIEdFVF9EQVRBX0JVRkZFUl9T
VEFUVVMgMHgzNAorI2RlZmluZSBTWU5DSFJPTklaRV9DQUNIRSAgICAgMHgzNQorI2RlZmluZSBM
T0NLX1VOTE9DS19DQUNIRSAgICAgMHgzNgorI2RlZmluZSBJTklUSUFMSVpFX0VMRU1FTlRfU1RB
VFVTX1dJVEhfUkFOR0UgMHgzNworI2RlZmluZSBSRUFEX0RFRkVDVF9EQVRBICAgICAgMHgzNwor
I2RlZmluZSBNRURJVU1fU0NBTiAgICAgICAgICAgMHgzOAorI2RlZmluZSBDT01QQVJFICAgICAg
ICAgICAgICAgMHgzOQorI2RlZmluZSBDT1BZX1ZFUklGWSAgICAgICAgICAgMHgzYQorI2RlZmlu
ZSBXUklURV9CVUZGRVIgICAgICAgICAgMHgzYgorI2RlZmluZSBSRUFEX0JVRkZFUiAgICAgICAg
ICAgMHgzYworI2RlZmluZSBVUERBVEVfQkxPQ0sgICAgICAgICAgMHgzZAorI2RlZmluZSBSRUFE
X0xPTkdfMTAgICAgICAgICAgMHgzZQorI2RlZmluZSBXUklURV9MT05HXzEwICAgICAgICAgMHgz
ZgorI2RlZmluZSBDSEFOR0VfREVGSU5JVElPTiAgICAgMHg0MAorI2RlZmluZSBXUklURV9TQU1F
XzEwICAgICAgICAgMHg0MQorI2RlZmluZSBVTk1BUCAgICAgICAgICAgICAgICAgMHg0MgorI2Rl
ZmluZSBSRUFEX1RPQyAgICAgICAgICAgICAgMHg0MworI2RlZmluZSBSRVBPUlRfREVOU0lUWV9T
VVBQT1JUIDB4NDQKKyNkZWZpbmUgR0VUX0NPTkZJR1VSQVRJT04gICAgIDB4NDYKKyNkZWZpbmUg
U0FOSVRJWkUgICAgICAgICAgICAgIDB4NDgKKyNkZWZpbmUgR0VUX0VWRU5UX1NUQVRVU19OT1RJ
RklDQVRJT04gMHg0YQorI2RlZmluZSBMT0dfU0VMRUNUICAgICAgICAgICAgMHg0YworI2RlZmlu
ZSBMT0dfU0VOU0UgICAgICAgICAgICAgMHg0ZAorI2RlZmluZSBSRUFEX0RJU0NfSU5GT1JNQVRJ
T04gMHg1MQorI2RlZmluZSBSRUFEX1RSQUNLX0lORk9STUFUSU9OIDB4NTIKKyNkZWZpbmUgUkVT
RVJWRV9UUkFDSyAgICAgICAgIDB4NTMKKyNkZWZpbmUgTU9ERV9TRUxFQ1RfMTAgICAgICAgIDB4
NTUKKyNkZWZpbmUgUkVTRVJWRV8xMCAgICAgICAgICAgIDB4NTYKKyNkZWZpbmUgUkVMRUFTRV8x
MCAgICAgICAgICAgIDB4NTcKKyNkZWZpbmUgTU9ERV9TRU5TRV8xMCAgICAgICAgIDB4NWEKKyNk
ZWZpbmUgU0VORF9DVUVfU0hFRVQgICAgICAgIDB4NWQKKyNkZWZpbmUgUEVSU0lTVEVOVF9SRVNF
UlZFX0lOIDB4NWUKKyNkZWZpbmUgUEVSU0lTVEVOVF9SRVNFUlZFX09VVCAweDVmCisjZGVmaW5l
IFZBUkxFTkdUSF9DREIgICAgICAgICAweDdmCisjZGVmaW5lIFdSSVRFX0ZJTEVNQVJLU18xNiAg
ICAweDgwCisjZGVmaW5lIFJFQURfUkVWRVJTRV8xNiAgICAgICAweDgxCisjZGVmaW5lIEFMTE9X
X09WRVJXUklURSAgICAgICAweDgyCisjZGVmaW5lIEVYVEVOREVEX0NPUFkgICAgICAgICAweDgz
CisjZGVmaW5lIEFUQV9QQVNTVEhST1VHSF8xNiAgICAweDg1CisjZGVmaW5lIEFDQ0VTU19DT05U
Uk9MX0lOICAgICAweDg2CisjZGVmaW5lIEFDQ0VTU19DT05UUk9MX09VVCAgICAweDg3CisjZGVm
aW5lIFJFQURfMTYgICAgICAgICAgICAgICAweDg4CisjZGVmaW5lIENPTVBBUkVfQU5EX1dSSVRF
ICAgICAweDg5CisjZGVmaW5lIFdSSVRFXzE2ICAgICAgICAgICAgICAweDhhCisjZGVmaW5lIFdS
SVRFX1ZFUklGWV8xNiAgICAgICAweDhlCisjZGVmaW5lIFZFUklGWV8xNiAgICAgICAgICAgICAw
eDhmCisjZGVmaW5lIFBSRV9GRVRDSF8xNiAgICAgICAgICAweDkwCisjZGVmaW5lIFNQQUNFXzE2
ICAgICAgICAgICAgICAweDkxCisjZGVmaW5lIFNZTkNIUk9OSVpFX0NBQ0hFXzE2ICAweDkxCisj
ZGVmaW5lIExPQ0FURV8xNiAgICAgICAgICAgICAweDkyCisjZGVmaW5lIFdSSVRFX1NBTUVfMTYg
ICAgICAgICAweDkzCisjZGVmaW5lIEVSQVNFXzE2ICAgICAgICAgICAgICAweDkzCisjZGVmaW5l
IFNFUlZJQ0VfQUNUSU9OX0lOXzE2ICAweDllCisjZGVmaW5lIFdSSVRFX0xPTkdfMTYgICAgICAg
ICAweDlmCisjZGVmaW5lIFJFUE9SVF9MVU5TICAgICAgICAgICAweGEwCisjZGVmaW5lIEFUQV9Q
QVNTVEhST1VHSF8xMiAgICAweGExCisjZGVmaW5lIE1BSU5URU5BTkNFX0lOICAgICAgICAweGEz
CisjZGVmaW5lIE1BSU5URU5BTkNFX09VVCAgICAgICAweGE0CisjZGVmaW5lIE1PVkVfTUVESVVN
ICAgICAgICAgICAweGE1CisjZGVmaW5lIEVYQ0hBTkdFX01FRElVTSAgICAgICAweGE2CisjZGVm
aW5lIFNFVF9SRUFEX0FIRUFEICAgICAgICAweGE3CisjZGVmaW5lIFJFQURfMTIgICAgICAgICAg
ICAgICAweGE4CisjZGVmaW5lIFdSSVRFXzEyICAgICAgICAgICAgICAweGFhCisjZGVmaW5lIFNF
UlZJQ0VfQUNUSU9OX0lOXzEyICAweGFiCisjZGVmaW5lIEVSQVNFXzEyICAgICAgICAgICAgICAw
eGFjCisjZGVmaW5lIFdSSVRFX1ZFUklGWV8xMiAgICAgICAweGFlCisjZGVmaW5lIFZFUklGWV8x
MiAgICAgICAgICAgICAweGFmCisjZGVmaW5lIFNFQVJDSF9ISUdIXzEyICAgICAgICAweGIwCisj
ZGVmaW5lIFNFQVJDSF9FUVVBTF8xMiAgICAgICAweGIxCisjZGVmaW5lIFNFQVJDSF9MT1dfMTIg
ICAgICAgICAweGIyCisjZGVmaW5lIFJFQURfRUxFTUVOVF9TVEFUVVMgICAweGI4CisjZGVmaW5l
IFNFTkRfVk9MVU1FX1RBRyAgICAgICAweGI2CisKKy8qIE1NQy1zcGVjaWZpYyBvcGNvZGUgYXNz
aWdubWVudCAqLworI2RlZmluZSBNTUNfU0VORF9FVkVOVCAgICAgICAgICAweGEyCisjZGVmaW5l
IE1NQ19TRU5EX0tFWSAgICAgICAgICAgIDB4YTMKKyNkZWZpbmUgTU1DX1JFUE9SVF9LRVkgICAg
ICAgICAgMHhhNAorI2RlZmluZSBNTUNfR0VUX1BFUkZPUk1BTkNFICAgICAweGFjCisjZGVmaW5l
IE1NQ19SRUFEX0RWRF9TVFJVQ1RVUkUgIDB4YWQKKyNkZWZpbmUgTU1DX1JFQURfREVGRUNUX0RB
VEFfMTIgMHhiNworI2RlZmluZSBNTUNfU0VUX0NEX1NQRUVEICAgICAgICAweGJiCisjZGVmaW5l
IE1NQ19NRUNIQU5JU01fU1RBVFVTICAgIDB4YmQKKyNkZWZpbmUgTU1DX1JFQURfQ0QgICAgICAg
ICAgICAgMHhiZQorI2RlZmluZSBNTUNfU0VORF9EVkRfU1RSVUNUVVJFICAweGJmCisKKy8qCisg
KiBTRVJWSUNFIEFDVElPTiBJTiBzdWJjb2RlcworICovCisjZGVmaW5lIFNBSV9SRUFEX0NBUEFD
SVRZXzE2ICAweDEwCisKKy8qCisgKiBSRUFEIFBPU0lUSU9OIHNlcnZpY2UgYWN0aW9uIGNvZGVz
CisgKi8KKyNkZWZpbmUgU0hPUlRfRk9STV9CTE9DS19JRCAgMHgwMAorI2RlZmluZSBTSE9SVF9G
T1JNX1ZFTkRPUl9TUEVDSUZJQyAweDAxCisjZGVmaW5lIExPTkdfRk9STSAgICAgICAgICAgIDB4
MDYKKyNkZWZpbmUgRVhURU5ERURfRk9STSAgICAgICAgMHgwOAorCisvKgorICogIFNBTSBTdGF0
dXMgY29kZXMKKyAqLworCisjZGVmaW5lIEdPT0QgICAgICAgICAgICAgICAgIDB4MDAKKyNkZWZp
bmUgQ0hFQ0tfQ09ORElUSU9OICAgICAgMHgwMgorI2RlZmluZSBDT05ESVRJT05fR09PRCAgICAg
ICAweDA0CisjZGVmaW5lIEJVU1kgICAgICAgICAgICAgICAgIDB4MDgKKyNkZWZpbmUgSU5URVJN
RURJQVRFX0dPT0QgICAgMHgxMAorI2RlZmluZSBJTlRFUk1FRElBVEVfQ19HT09EICAweDE0Cisj
ZGVmaW5lIFJFU0VSVkFUSU9OX0NPTkZMSUNUIDB4MTgKKyNkZWZpbmUgQ09NTUFORF9URVJNSU5B
VEVEICAgMHgyMgorI2RlZmluZSBUQVNLX1NFVF9GVUxMICAgICAgICAweDI4CisjZGVmaW5lIEFD
QV9BQ1RJVkUgICAgICAgICAgIDB4MzAKKyNkZWZpbmUgVEFTS19BQk9SVEVEICAgICAgICAgMHg0
MAorCisjZGVmaW5lIFNUQVRVU19NQVNLICAgICAgICAgIDB4M2UKKworLyoKKyAqICBTRU5TRSBL
RVlTCisgKi8KKworI2RlZmluZSBOT19TRU5TRSAgICAgICAgICAgIDB4MDAKKyNkZWZpbmUgUkVD
T1ZFUkVEX0VSUk9SICAgICAweDAxCisjZGVmaW5lIE5PVF9SRUFEWSAgICAgICAgICAgMHgwMgor
I2RlZmluZSBNRURJVU1fRVJST1IgICAgICAgIDB4MDMKKyNkZWZpbmUgSEFSRFdBUkVfRVJST1Ig
ICAgICAweDA0CisjZGVmaW5lIElMTEVHQUxfUkVRVUVTVCAgICAgMHgwNQorI2RlZmluZSBVTklU
X0FUVEVOVElPTiAgICAgIDB4MDYKKyNkZWZpbmUgREFUQV9QUk9URUNUICAgICAgICAweDA3Cisj
ZGVmaW5lIEJMQU5LX0NIRUNLICAgICAgICAgMHgwOAorI2RlZmluZSBDT1BZX0FCT1JURUQgICAg
ICAgIDB4MGEKKyNkZWZpbmUgQUJPUlRFRF9DT01NQU5EICAgICAweDBiCisjZGVmaW5lIFZPTFVN
RV9PVkVSRkxPVyAgICAgMHgwZAorI2RlZmluZSBNSVNDT01QQVJFICAgICAgICAgIDB4MGUKKwor
CisvKgorICogIERFVklDRSBUWVBFUworICovCisKKyNkZWZpbmUgVFlQRV9ESVNLICAgICAgICAg
ICAweDAwCisjZGVmaW5lIFRZUEVfVEFQRSAgICAgICAgICAgMHgwMQorI2RlZmluZSBUWVBFX1BS
SU5URVIgICAgICAgIDB4MDIKKyNkZWZpbmUgVFlQRV9QUk9DRVNTT1IgICAgICAweDAzICAgIC8q
IEhQIHNjYW5uZXJzIHVzZSB0aGlzICovCisjZGVmaW5lIFRZUEVfV09STSAgICAgICAgICAgMHgw
NCAgICAvKiBUcmVhdGVkIGFzIFJPTSBieSBvdXIgc3lzdGVtICovCisjZGVmaW5lIFRZUEVfUk9N
ICAgICAgICAgICAgMHgwNQorI2RlZmluZSBUWVBFX1NDQU5ORVIgICAgICAgIDB4MDYKKyNkZWZp
bmUgVFlQRV9NT0QgICAgICAgICAgICAweDA3ICAgIC8qIE1hZ25ldG8tb3B0aWNhbCBkaXNrIC0K
KwkJCQkgICAgICogLSB0cmVhdGVkIGFzIFRZUEVfRElTSyAqLworI2RlZmluZSBUWVBFX01FRElV
TV9DSEFOR0VSIDB4MDgKKyNkZWZpbmUgVFlQRV9TVE9SQUdFX0FSUkFZICAweDBjICAgIC8qIFN0
b3JhZ2UgYXJyYXkgZGV2aWNlICovCisjZGVmaW5lIFRZUEVfRU5DTE9TVVJFICAgICAgMHgwZCAg
ICAvKiBFbmNsb3N1cmUgU2VydmljZXMgRGV2aWNlICovCisjZGVmaW5lIFRZUEVfUkJDICAgICAg
ICAgICAgMHgwZSAgICAvKiBTaW1wbGlmaWVkIERpcmVjdC1BY2Nlc3MgRGV2aWNlICovCisjZGVm
aW5lIFRZUEVfT1NEICAgICAgICAgICAgMHgxMSAgICAvKiBPYmplY3Qtc3RvcmFnZSBEZXZpY2Ug
Ki8KKyNkZWZpbmUgVFlQRV9XTFVOICAgICAgICAgICAweDFlICAgIC8qIFdlbGwga25vd24gTFVO
ICovCisjZGVmaW5lIFRZUEVfTk9UX1BSRVNFTlQgICAgMHgxZgorI2RlZmluZSBUWVBFX0lOQUNU
SVZFICAgICAgIDB4MjAKKyNkZWZpbmUgVFlQRV9OT19MVU4gICAgICAgICAweDdmCisKKy8qIE1v
ZGUgcGFnZSBjb2RlcyBmb3IgbW9kZSBzZW5zZS9zZXQgKi8KKyNkZWZpbmUgTU9ERV9QQUdFX1Jf
V19FUlJPUiAgICAgICAgICAgICAgICAgICAweDAxCisjZGVmaW5lIE1PREVfUEFHRV9NUlcgICAg
ICAgICAgICAgICAgICAgICAgICAgMHgwMworI2RlZmluZSBNT0RFX1BBR0VfSERfR0VPTUVUUlkg
ICAgICAgICAgICAgICAgIDB4MDQKKyNkZWZpbmUgTU9ERV9QQUdFX0ZMRVhJQkxFX0RJU0tfR0VP
TUVUUlkgICAgICAweDA1IC8qIFNCQyAqLworI2RlZmluZSBNT0RFX1BBR0VfV1JJVEVfUEFSQU1F
VEVSICAgICAgICAgICAgIDB4MDUgLyogTU1DICovCisjZGVmaW5lIE1PREVfUEFHRV9DQUNISU5H
ICAgICAgICAgICAgICAgICAgICAgMHgwOAorI2RlZmluZSBNT0RFX1BBR0VfQ0RfREVWSUNFICAg
ICAgICAgICAgICAgICAgIDB4MGQKKyNkZWZpbmUgTU9ERV9QQUdFX0FVRElPX0NUTCAgICAgICAg
ICAgICAgICAgICAweDBlCisjZGVmaW5lIE1PREVfUEFHRV9QT1dFUiAgICAgICAgICAgICAgICAg
ICAgICAgMHgxYQorI2RlZmluZSBNT0RFX1BBR0VfRkFVTFRfRkFJTCAgICAgICAgICAgICAgICAg
IDB4MWMKKyNkZWZpbmUgTU9ERV9QQUdFX1RPX1BST1RFQ1QgICAgICAgICAgICAgICAgICAweDFk
CisjZGVmaW5lIE1PREVfUEFHRV9DQVBTX01FQ0hfU1RBVFVTICAgICAgICAgICAgMHgyYQorI2Rl
ZmluZSBNT0RFX1BBR0VfTVJXX1ZFTkRPUiAgICAgICAgICAgICAgICAgIDB4MkMKKyNkZWZpbmUg
TU9ERV9QQUdFX0FMTFMgICAgICAgICAgICAgICAgICAgICAgICAweDNmCisvKiBOb3QgaW4gTXQu
IEZ1amksIGJ1dCBpbiBBVEFQSSAyLjYgLS0gZGVwcmVjYXRlZCBub3cgaW4gZmF2b3IKKyAqIG9m
IE1PREVfUEFHRV9TRU5TRV9QT1dFUiAqLworI2RlZmluZSBNT0RFX1BBR0VfQ0RST00gICAgICAg
ICAgICAgICAgICAgICAgIDB4MGQKKworI2RlZmluZSBNT0RFX1BBR0VfQ0RST00gICAgICAgICAg
ICAgICAgICAgICAgIDB4MGQKKworLyogRXZlbnQgbm90aWZpY2F0aW9uIGNsYXNzZXMgZm9yIEdF
VCBFVkVOVCBTVEFUVVMgTk9USUZJQ0FUSU9OICovCisjZGVmaW5lIEdFU05fTk9fRVZFTlRTICAg
ICAgICAgICAgICAgIDAKKyNkZWZpbmUgR0VTTl9PUEVSQVRJT05BTF9DSEFOR0UgICAgICAgMQor
I2RlZmluZSBHRVNOX1BPV0VSX01BTkFHRU1FTlQgICAgICAgICAyCisjZGVmaW5lIEdFU05fRVhU
RVJOQUxfUkVRVUVTVCAgICAgICAgIDMKKyNkZWZpbmUgR0VTTl9NRURJQSAgICAgICAgICAgICAg
ICAgICAgNAorI2RlZmluZSBHRVNOX01VTFRJUExFX0hPU1RTICAgICAgICAgICA1CisjZGVmaW5l
IEdFU05fREVWSUNFX0JVU1kgICAgICAgICAgICAgIDYKKworLyogRXZlbnQgY29kZXMgZm9yIE1F
RElBIGV2ZW50IHN0YXR1cyBub3RpZmljYXRpb24gKi8KKyNkZWZpbmUgTUVDX05PX0NIQU5HRSAg
ICAgICAgICAgICAgICAgMAorI2RlZmluZSBNRUNfRUpFQ1RfUkVRVUVTVEVEICAgICAgICAgICAx
CisjZGVmaW5lIE1FQ19ORVdfTUVESUEgICAgICAgICAgICAgICAgIDIKKyNkZWZpbmUgTUVDX01F
RElBX1JFTU9WQUwgICAgICAgICAgICAgMyAvKiBvbmx5IGZvciBtZWRpYSBjaGFuZ2VycyAqLwor
I2RlZmluZSBNRUNfTUVESUFfQ0hBTkdFRCAgICAgICAgICAgICA0IC8qIG9ubHkgZm9yIG1lZGlh
IGNoYW5nZXJzICovCisjZGVmaW5lIE1FQ19CR19GT1JNQVRfQ09NUExFVEVEICAgICAgIDUgLyog
TVJXIG9yIERWRCtSVyBiL2cgZm9ybWF0IGNvbXBsZXRlZCAqLworI2RlZmluZSBNRUNfQkdfRk9S
TUFUX1JFU1RBUlRFRCAgICAgICA2IC8qIE1SVyBvciBEVkQrUlcgYi9nIGZvcm1hdCByZXN0YXJ0
ZWQgKi8KKworI2RlZmluZSBNU19UUkFZX09QRU4gICAgICAgICAgICAgICAgICAxCisjZGVmaW5l
IE1TX01FRElBX1BSRVNFTlQgICAgICAgICAgICAgIDIKKworLyoKKyAqIEJhc2VkIG9uIHZhbHVl
cyBmcm9tIDxsaW51eC9jZHJvbS5oPiBidXQgZXh0ZW5kaW5nIENEX01JTlMKKyAqIHRvIHRoZSBt
YXhpbXVtIGNvbW1vbiBzaXplIGFsbG93ZWQgYnkgdGhlIE9yYW5nZSdzIEJvb2sgQVRJUAorICoK
KyAqIDkwIGFuZCA5OSBtaW4gQ0RzIGFyZSBhbHNvIGF2YWlsYWJsZSBidXQgdXNpbmcgdGhlbSBh
cyB0aGUKKyAqIHVwcGVyIGxpbWl0IHJlZHVjZXMgdGhlIGVmZmVjdGl2ZW5lc3Mgb2YgdGhlIGhl
dXJpc3RpYyB0bworICogZGV0ZWN0IERWRHMgYnVybmVkIHRvIGxlc3MgdGhhbiAyNSUgb2YgdGhl
aXIgbWF4aW11bSBjYXBhY2l0eQorICovCisKKy8qIFNvbWUgZ2VuZXJhbGx5IHVzZWZ1bCBDRC1S
T00gaW5mb3JtYXRpb24gKi8KKyNkZWZpbmUgQ0RfTUlOUyAgICAgICAgICAgICAgICAgICAgICAg
ODAgLyogbWF4LiBtaW51dGVzIHBlciBDRCAqLworI2RlZmluZSBDRF9TRUNTICAgICAgICAgICAg
ICAgICAgICAgICA2MCAvKiBzZWNvbmRzIHBlciBtaW51dGUgKi8KKyNkZWZpbmUgQ0RfRlJBTUVT
ICAgICAgICAgICAgICAgICAgICAgNzUgLyogZnJhbWVzIHBlciBzZWNvbmQgKi8KKyNkZWZpbmUg
Q0RfRlJBTUVTSVpFICAgICAgICAgICAgICAgIDIwNDggLyogYnl0ZXMgcGVyIGZyYW1lLCAiY29v
a2VkIiBtb2RlICovCisjZGVmaW5lIENEX01BWF9CWVRFUyAgICAgICAoQ0RfTUlOUyAqIENEX1NF
Q1MgKiBDRF9GUkFNRVMgKiBDRF9GUkFNRVNJWkUpCisjZGVmaW5lIENEX01BWF9TRUNUT1JTICAg
ICAoQ0RfTUFYX0JZVEVTIC8gNTEyKQorCisvKgorICogVGhlIE1NQyB2YWx1ZXMgYXJlIG5vdCBJ
REUgc3BlY2lmaWMgYW5kIG1pZ2h0IG5lZWQgdG8gYmUgbW92ZWQKKyAqIHRvIGEgY29tbW9uIGhl
YWRlciBpZiB0aGV5IGFyZSBhbHNvIG5lZWRlZCBmb3IgdGhlIFNDU0kgZW11bGF0aW9uCisgKi8K
KworLyogUHJvZmlsZSBsaXN0IGZyb20gTU1DLTYgcmV2aXNpb24gMSB0YWJsZSA5MSAqLworI2Rl
ZmluZSBNTUNfUFJPRklMRV9OT05FICAgICAgICAgICAgICAgIDB4MDAwMAorI2RlZmluZSBNTUNf
UFJPRklMRV9DRF9ST00gICAgICAgICAgICAgIDB4MDAwOAorI2RlZmluZSBNTUNfUFJPRklMRV9D
RF9SICAgICAgICAgICAgICAgIDB4MDAwOQorI2RlZmluZSBNTUNfUFJPRklMRV9DRF9SVyAgICAg
ICAgICAgICAgIDB4MDAwQQorI2RlZmluZSBNTUNfUFJPRklMRV9EVkRfUk9NICAgICAgICAgICAg
IDB4MDAxMAorI2RlZmluZSBNTUNfUFJPRklMRV9EVkRfUl9TUiAgICAgICAgICAgIDB4MDAxMQor
I2RlZmluZSBNTUNfUFJPRklMRV9EVkRfUkFNICAgICAgICAgICAgIDB4MDAxMgorI2RlZmluZSBN
TUNfUFJPRklMRV9EVkRfUldfUk8gICAgICAgICAgIDB4MDAxMworI2RlZmluZSBNTUNfUFJPRklM
RV9EVkRfUldfU1IgICAgICAgICAgIDB4MDAxNAorI2RlZmluZSBNTUNfUFJPRklMRV9EVkRfUl9E
TF9TUiAgICAgICAgIDB4MDAxNQorI2RlZmluZSBNTUNfUFJPRklMRV9EVkRfUl9ETF9KUiAgICAg
ICAgIDB4MDAxNgorI2RlZmluZSBNTUNfUFJPRklMRV9EVkRfUldfREwgICAgICAgICAgIDB4MDAx
NworI2RlZmluZSBNTUNfUFJPRklMRV9EVkRfRERSICAgICAgICAgICAgIDB4MDAxOAorI2RlZmlu
ZSBNTUNfUFJPRklMRV9EVkRfUExVU19SVyAgICAgICAgIDB4MDAxQQorI2RlZmluZSBNTUNfUFJP
RklMRV9EVkRfUExVU19SICAgICAgICAgIDB4MDAxQgorI2RlZmluZSBNTUNfUFJPRklMRV9EVkRf
UExVU19SV19ETCAgICAgIDB4MDAyQQorI2RlZmluZSBNTUNfUFJPRklMRV9EVkRfUExVU19SX0RM
ICAgICAgIDB4MDAyQgorI2RlZmluZSBNTUNfUFJPRklMRV9CRF9ST00gICAgICAgICAgICAgIDB4
MDA0MAorI2RlZmluZSBNTUNfUFJPRklMRV9CRF9SX1NSTSAgICAgICAgICAgIDB4MDA0MQorI2Rl
ZmluZSBNTUNfUFJPRklMRV9CRF9SX1JSTSAgICAgICAgICAgIDB4MDA0MgorI2RlZmluZSBNTUNf
UFJPRklMRV9CRF9SRSAgICAgICAgICAgICAgIDB4MDA0MworI2RlZmluZSBNTUNfUFJPRklMRV9I
RERWRF9ST00gICAgICAgICAgIDB4MDA1MAorI2RlZmluZSBNTUNfUFJPRklMRV9IRERWRF9SICAg
ICAgICAgICAgIDB4MDA1MQorI2RlZmluZSBNTUNfUFJPRklMRV9IRERWRF9SQU0gICAgICAgICAg
IDB4MDA1MgorI2RlZmluZSBNTUNfUFJPRklMRV9IRERWRF9SVyAgICAgICAgICAgIDB4MDA1Mwor
I2RlZmluZSBNTUNfUFJPRklMRV9IRERWRF9SX0RMICAgICAgICAgIDB4MDA1OAorI2RlZmluZSBN
TUNfUFJPRklMRV9IRERWRF9SV19ETCAgICAgICAgIDB4MDA1QQorI2RlZmluZSBNTUNfUFJPRklM
RV9JTlZBTElEICAgICAgICAgICAgIDB4RkZGRgorCisjZW5kaWYKLS0gCjIuMTcuMQoKX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KU3BpY2UtZGV2ZWwgbWFp
bGluZyBsaXN0ClNwaWNlLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3Rz
LmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL3NwaWNlLWRldmVs
