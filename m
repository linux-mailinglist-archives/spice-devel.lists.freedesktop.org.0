Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 0F9BC89D79
	for <lists+spice-devel@lfdr.de>; Mon, 12 Aug 2019 14:00:31 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 9A1936E4F1;
	Mon, 12 Aug 2019 12:00:29 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 8E5E76E4F1
 for <spice-devel@lists.freedesktop.org>; Mon, 12 Aug 2019 12:00:28 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx01.intmail.prod.int.phx2.redhat.com
 [10.5.11.11])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id 0D1F6300413C;
 Mon, 12 Aug 2019 12:00:28 +0000 (UTC)
Received: from colo-mx.corp.redhat.com
 (colo-mx01.intmail.prod.int.phx2.redhat.com [10.5.11.20])
 by smtp.corp.redhat.com (Postfix) with ESMTPS id 0293563B8A;
 Mon, 12 Aug 2019 12:00:28 +0000 (UTC)
Received: from zmail25.collab.prod.int.phx2.redhat.com
 (zmail25.collab.prod.int.phx2.redhat.com [10.5.83.31])
 by colo-mx.corp.redhat.com (Postfix) with ESMTP id E9364180B536;
 Mon, 12 Aug 2019 12:00:27 +0000 (UTC)
Date: Mon, 12 Aug 2019 08:00:27 -0400 (EDT)
From: Frediano Ziglio <fziglio@redhat.com>
To: Yuri Benditovich <yuri.benditovich@daynix.com>
Message-ID: <980332373.5513125.1565611227740.JavaMail.zimbra@redhat.com>
In-Reply-To: <20190812095729.32692-2-yuri.benditovich@daynix.com>
References: <20190812095729.32692-1-yuri.benditovich@daynix.com>
 <20190812095729.32692-2-yuri.benditovich@daynix.com>
MIME-Version: 1.0
X-Originating-IP: [10.40.204.153, 10.4.195.17]
Thread-Topic: usb-redir: define interfaces to support emulated devices
Thread-Index: lXSCz0iNC/TMhrWlYfBZGavBRQIXpw==
X-Scanned-By: MIMEDefang 2.79 on 10.5.11.11
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16
 (mx1.redhat.com [10.5.110.46]); Mon, 12 Aug 2019 12:00:28 +0000 (UTC)
Subject: Re: [Spice-devel] [spice-gtk v3 1/9] usb-redir: define interfaces
 to support emulated devices
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: yan@daynix.com, spice-devel@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

PiAKPiBTcGljZVVzYkJhY2tlbmREZXZpY2Ugc3RydWN0dXJlIGlzIGV4dGVuZGVkIHRvIHN1cHBv
cnQKPiBhZGRpdGlvbmFsIGtpbmQgb2YgZGV2aWNlIHRoYXQgaXMgZW11bGF0ZWQgYnkgU3BpY2Ut
R1RLCj4gYW5kIG5vdCBwcmVzZW50IGxvY2FsbHkgKGFuZCBkb2VzIG5vdCBoYXZlIGxpYnVzYl9k
ZXZpY2UpLAo+IHN1Y2ggZGV2aWNlIGhhcyBpbnN0ZWFkIHBvaW50ZXIgdG8gU3BpY2VVc2JFbXVs
YXRlZERldmljZQo+IGFic3RyYWN0IHN0cnVjdHVyZS4gU3BlY2lmaWMgaW1wbGVtZW50YXRpb24g
b2Ygc3VjaCBkZXZpY2UKPiBkZXBlbmRzIG9uIGl0cyBkZXZpY2UgdHlwZS4gSW1wbGVtZW50YXRp
b24gbW9kdWxlIHdpbGwgZGVmaW5lCj4gY29uc3RydWN0b3IgZm9yIHNwZWNpZmljIGRldmljZSB0
eXBlLgo+IERldmljZSBzdHJ1Y3R1cmUgaXMgYWJzdHJhY3QgYnV0IGFsd2F5cyBzdGFydHMgZnJv
bSB0YWJsZSBvZgo+IHZpcnR1YWwgZnVuY3Rpb25zIHJlcXVpcmVkIHRvIHJlZGlyZWN0IHN1Y2gg
dmlydHVhbCBkZXZpY2UuCj4gCj4gU2lnbmVkLW9mZi1ieTogWXVyaSBCZW5kaXRvdmljaCA8eXVy
aS5iZW5kaXRvdmljaEBkYXluaXguY29tPgoKQWNrZWQtYnk6IEZyZWRpYW5vIFppZ2xpbyA8Znpp
Z2xpb0ByZWRoYXQuY29tPgoKQnV0IEkgd291bGQgbWVyZ2UgMi85IGludG8KCj4gLS0tCj4gIHNy
Yy9tZXNvbi5idWlsZCAgICAgfCAgIDEgKwo+ICBzcmMvdXNiLWJhY2tlbmQuYyAgIHwgMTAzICsr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKystCj4gIHNyYy91c2ItYmFj
a2VuZC5oICAgfCAgIDMgKysKPiAgc3JjL3VzYi1lbXVsYXRpb24uaCB8ICA4OCArKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrCj4gIDQgZmlsZXMgY2hhbmdlZCwgMTkzIGluc2Vy
dGlvbnMoKyksIDIgZGVsZXRpb25zKC0pCj4gIGNyZWF0ZSBtb2RlIDEwMDY0NCBzcmMvdXNiLWVt
dWxhdGlvbi5oCj4gCj4gZGlmZiAtLWdpdCBhL3NyYy9tZXNvbi5idWlsZCBiL3NyYy9tZXNvbi5i
dWlsZAo+IGluZGV4IGI0YTY4NzAuLmZlMTljMTYgMTAwNjQ0Cj4gLS0tIGEvc3JjL21lc29uLmJ1
aWxkCj4gKysrIGIvc3JjL21lc29uLmJ1aWxkCj4gQEAgLTEyMiw2ICsxMjIsNyBAQCBzcGljZV9j
bGllbnRfZ2xpYl9zb3VyY2VzID0gWwo+ICAgICd1c2J1dGlsLmMnLAo+ICAgICd1c2J1dGlsLmgn
LAo+ICAgICd1c2ItYmFja2VuZC5jJywKPiArICAndXNiLWVtdWxhdGlvbi5oJywKPiAgICAndXNi
LWJhY2tlbmQuaCcsCj4gICAgJ3ZtY3N0cmVhbS5jJywKPiAgICAndm1jc3RyZWFtLmgnLAo+IGRp
ZmYgLS1naXQgYS9zcmMvdXNiLWJhY2tlbmQuYyBiL3NyYy91c2ItYmFja2VuZC5jCj4gaW5kZXgg
OWFjODU5NS4uZGUyYjU1ZSAxMDA2NDQKPiAtLS0gYS9zcmMvdXNiLWJhY2tlbmQuYwo+ICsrKyBi
L3NyYy91c2ItYmFja2VuZC5jCj4gQEAgLTM5LDYgKzM5LDcgQEAKPiAgI2luY2x1ZGUgInVzYnJl
ZGlycGFyc2VyLmgiCj4gICNpbmNsdWRlICJzcGljZS11dGlsLmgiCj4gICNpbmNsdWRlICJ1c2It
YmFja2VuZC5oIgo+ICsjaW5jbHVkZSAidXNiLWVtdWxhdGlvbi5oIgo+ICAjaW5jbHVkZSAiY2hh
bm5lbC11c2JyZWRpci1wcml2LmgiCj4gICNpbmNsdWRlICJzcGljZS1jaGFubmVsLXByaXYuaCIK
PiAgCj4gQEAgLTQ2LDcgKzQ3LDEwIEBACj4gIAo+ICBzdHJ1Y3QgX1NwaWNlVXNiQmFja2VuZERl
dmljZQo+ICB7Cj4gKyAgICAvKiBQb2ludGVyIHRvIGRldmljZS4gRWl0aGVyIHJlYWwgZGV2aWNl
IChsaWJ1c2JfZGV2aWNlKQo+ICsgICAgICogb3IgZW11bGF0ZWQgb25lIChlZGV2KSAqLwo+ICAg
ICAgbGlidXNiX2RldmljZSAqbGlidXNiX2RldmljZTsKPiArICAgIFNwaWNlVXNiRW11bGF0ZWRE
ZXZpY2UgKmVkZXY7Cj4gICAgICBnaW50IHJlZl9jb3VudDsKPiAgICAgIFNwaWNlVXNiQmFja2Vu
ZENoYW5uZWwgKmF0dGFjaGVkX3RvOwo+ICAgICAgVXNiRGV2aWNlSW5mb3JtYXRpb24gZGV2aWNl
X2luZm87Cj4gQEAgLTY2LDYgKzcwLDEwIEBAIHN0cnVjdCBfU3BpY2VVc2JCYWNrZW5kCj4gICAg
ICBsaWJ1c2JfZGV2aWNlICoqbGlidXNiX2RldmljZV9saXN0Owo+ICAgICAgZ2ludCByZWRpcmVj
dGluZzsKPiAgI2VuZGlmCj4gKwo+ICsgICAgLyogTWFzayBvZiBhbGxvY2F0ZWQgZGV2aWNlLCBh
IHNwZWNpZmljIGJpdCBzZXQgdG8gMSB0byBpbmRpY2F0ZSB0aGF0Cj4gdGhlIGRldmljZSBhdAo+
ICsgICAgICogdGhhdCBhZGRyZXNzIGlzIGFsbG9jYXRlZCAqLwo+ICsgICAgdWludDMyX3Qgb3du
X2RldmljZXNfbWFzazsKPiAgfTsKPiAgCj4gIHN0cnVjdCBfU3BpY2VVc2JCYWNrZW5kQ2hhbm5l
bAo+IEBAIC00MDgsNiArNDE2LDggQEAgU3BpY2VVc2JCYWNrZW5kICpzcGljZV91c2JfYmFja2Vu
ZF9uZXcoR0Vycm9yICoqZXJyb3IpCj4gICAgICAgICAgbGlidXNiX3NldF9vcHRpb24oYmUtPmxp
YnVzYl9jb250ZXh0LCBMSUJVU0JfT1BUSU9OX1VTRV9VU0JESyk7Cj4gICNlbmRpZgo+ICAjZW5k
aWYKPiArICAgICAgICAvKiBleGNsdWRlIGFkZHJlc3NlcyAwIChyZXNlcnZlZCkgYW5kIDEgKHJv
b3QgaHViKSAqLwo+ICsgICAgICAgIGJlLT5vd25fZGV2aWNlc19tYXNrID0gMzsKPiAgICAgIH0K
PiAgICAgIFNQSUNFX0RFQlVHKCIlcyA8PCIsIF9fRlVOQ1RJT05fXyk7Cj4gICAgICByZXR1cm4g
YmU7Cj4gQEAgLTUyNCw4ICs1MzQsMTMgQEAgdm9pZAo+IHNwaWNlX3VzYl9iYWNrZW5kX2Rldmlj
ZV91bnJlZihTcGljZVVzYkJhY2tlbmREZXZpY2UgKmRldikKPiAgewo+ICAgICAgTE9VRF9ERUJV
RygiJXMgPj4gJXAoJWQpIiwgX19GVU5DVElPTl9fLCBkZXYsIGRldi0+cmVmX2NvdW50KTsKPiAg
ICAgIGlmIChnX2F0b21pY19pbnRfZGVjX2FuZF90ZXN0KCZkZXYtPnJlZl9jb3VudCkpIHsKPiAt
ICAgICAgICBsaWJ1c2JfdW5yZWZfZGV2aWNlKGRldi0+bGlidXNiX2RldmljZSk7Cj4gLSAgICAg
ICAgTE9VRF9ERUJVRygiJXMgZnJlZWluZyAlcCAobGlidXNiICVwKSIsIF9fRlVOQ1RJT05fXywg
ZGV2LAo+IGRldi0+bGlidXNiX2RldmljZSk7Cj4gKyAgICAgICAgaWYgKGRldi0+bGlidXNiX2Rl
dmljZSkgewo+ICsgICAgICAgICAgICBsaWJ1c2JfdW5yZWZfZGV2aWNlKGRldi0+bGlidXNiX2Rl
dmljZSk7Cj4gKyAgICAgICAgICAgIExPVURfREVCVUcoIiVzIGZyZWVpbmcgJXAgKGxpYnVzYiAl
cCkiLCBfX0ZVTkNUSU9OX18sIGRldiwKPiBkZXYtPmxpYnVzYl9kZXZpY2UpOwo+ICsgICAgICAg
IH0KPiArICAgICAgICBpZiAoZGV2LT5lZGV2KSB7Cj4gKyAgICAgICAgICAgIGRldmljZV9vcHMo
ZGV2LT5lZGV2KS0+dW5yZWFsaXplKGRldi0+ZWRldik7Cj4gKyAgICAgICAgfQo+ICAgICAgICAg
IGdfZnJlZShkZXYpOwo+ICAgICAgfQo+ICB9Cj4gQEAgLTgyNCw0ICs4MzksODggQEAKPiBzcGlj
ZV91c2JfYmFja2VuZF9jaGFubmVsX2dldF9ndWVzdF9maWx0ZXIoU3BpY2VVc2JCYWNrZW5kQ2hh
bm5lbCAqY2gsCj4gICAgICB9Cj4gIH0KPiAgCj4gK3ZvaWQgc3BpY2VfdXNiX2JhY2tlbmRfZGV2
aWNlX3JlcG9ydF9jaGFuZ2UoU3BpY2VVc2JCYWNrZW5kICpiZSwKPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTcGljZVVzYkJhY2tlbmREZXZpY2UgKmRldikK
PiArewo+ICsgICAgZ2NoYXIgKmRlc2M7Cj4gKyAgICBnX3JldHVybl9pZl9mYWlsKGRldiAmJiBk
ZXYtPmVkZXYpOwo+ICsKPiArICAgIGRlc2MgPSBkZXZpY2Vfb3BzKGRldi0+ZWRldiktPmdldF9w
cm9kdWN0X2Rlc2NyaXB0aW9uKGRldi0+ZWRldik7Cj4gKyAgICBTUElDRV9ERUJVRygiJXM6ICVz
IiwgX19GVU5DVElPTl9fLCBkZXNjKTsKPiArICAgIGdfZnJlZShkZXNjKTsKPiArfQo+ICsKPiAr
dm9pZCBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfZWplY3QoU3BpY2VVc2JCYWNrZW5kICpiZSwK
PiBTcGljZVVzYkJhY2tlbmREZXZpY2UgKmRldikKPiArewo+ICsgICAgZ19yZXR1cm5faWZfZmFp
bChkZXYpOwo+ICsKPiArICAgIGlmIChkZXYtPmVkZXYpIHsKPiArICAgICAgICBiZS0+b3duX2Rl
dmljZXNfbWFzayAmPSB+KDEgPDwgZGV2LT5kZXZpY2VfaW5mby5hZGRyZXNzKTsKPiArICAgIH0K
PiArICAgIGlmIChiZS0+aG90cGx1Z19jYWxsYmFjaykgewo+ICsgICAgICAgIGJlLT5ob3RwbHVn
X2NhbGxiYWNrKGJlLT5ob3RwbHVnX3VzZXJfZGF0YSwgZGV2LCBGQUxTRSk7Cj4gKyAgICB9Cj4g
K30KPiArCj4gK2dib29sZWFuCj4gK3NwaWNlX3VzYl9iYWNrZW5kX2NyZWF0ZV9lbXVsYXRlZF9k
ZXZpY2UoU3BpY2VVc2JCYWNrZW5kICpiZSwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBTcGljZVVzYkVtdWxhdGVkRGV2aWNlQ3JlYXRlCj4gY3JlYXRlX3Byb2Ms
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdm9pZCAqY3JlYXRl
X3BhcmFtcywKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBHRXJy
b3IgKiplcnIpCj4gK3sKPiArICAgIFNwaWNlVXNiRW11bGF0ZWREZXZpY2UgKmVkZXY7Cj4gKyAg
ICBTcGljZVVzYkJhY2tlbmREZXZpY2UgKmRldjsKPiArICAgIHN0cnVjdCBsaWJ1c2JfZGV2aWNl
X2Rlc2NyaXB0b3IgKmRlc2M7Cj4gKyAgICB1aW50MTZfdCBkZXZpY2VfZGVzY19zaXplOwo+ICsg
ICAgdWludDhfdCBhZGRyZXNzID0gMDsKPiArCj4gKyAgICBpZiAoYmUtPm93bl9kZXZpY2VzX21h
c2sgPT0gMHhmZmZmZmZmZikgewo+ICsgICAgICAgIGdfc2V0X2Vycm9yKGVyciwgU1BJQ0VfQ0xJ
RU5UX0VSUk9SLCBTUElDRV9DTElFTlRfRVJST1JfRkFJTEVELAo+ICsgICAgICAgICAgICAgICAg
ICAgIF8oImNhbid0IGNyZWF0ZSBkZXZpY2UgLSBsaW1pdCByZWFjaGVkIikpOwo+ICsgICAgICAg
IHJldHVybiBGQUxTRTsKPiArICAgIH0KPiArICAgIGZvciAoYWRkcmVzcyA9IDA7IGFkZHJlc3Mg
PCAzMjsgKythZGRyZXNzKSB7Cj4gKyAgICAgICAgaWYgKH5iZS0+b3duX2RldmljZXNfbWFzayAm
ICgxIDw8IGFkZHJlc3MpKSB7Cj4gKyAgICAgICAgICAgIGJyZWFrOwo+ICsgICAgICAgIH0KPiAr
ICAgIH0KPiArCj4gKyAgICBkZXYgPSBnX25ldzAoU3BpY2VVc2JCYWNrZW5kRGV2aWNlLCAxKTsK
PiArICAgIGRldi0+ZGV2aWNlX2luZm8uYnVzID0gQlVTX05VTUJFUl9GT1JfRU1VTEFURURfVVNC
Owo+ICsgICAgZGV2LT5kZXZpY2VfaW5mby5hZGRyZXNzID0gYWRkcmVzczsKPiArICAgIGRldi0+
cmVmX2NvdW50ID0gMTsKPiArCj4gKyAgICBkZXYtPmVkZXYgPSBlZGV2ID0gY3JlYXRlX3Byb2Mo
YmUsIGRldiwgY3JlYXRlX3BhcmFtcywgZXJyKTsKPiArICAgIGlmIChlZGV2ID09IE5VTEwpIHsK
PiArICAgICAgICBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfdW5yZWYoZGV2KTsKPiArICAgICAg
ICByZXR1cm4gRkFMU0U7Cj4gKyAgICB9Cj4gKwo+ICsgICAgaWYgKCFkZXZpY2Vfb3BzKGVkZXYp
LT5nZXRfZGVzY3JpcHRvcihlZGV2LCBMSUJVU0JfRFRfREVWSUNFLCAwLAo+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAodm9pZCAqKikmZGVzYywgJmRldmljZV9k
ZXNjX3NpemUpCj4gKyAgICAgICAgfHwgZGV2aWNlX2Rlc2Nfc2l6ZSAhPSBzaXplb2YoKmRlc2Mp
KSB7Cj4gKwo+ICsgICAgICAgIHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV91bnJlZihkZXYpOwo+
ICsgICAgICAgIGdfc2V0X2Vycm9yKGVyciwgU1BJQ0VfQ0xJRU5UX0VSUk9SLCBTUElDRV9DTElF
TlRfRVJST1JfRkFJTEVELAo+ICsgICAgICAgICAgICAgICAgICAgIF8oImNhbid0IGNyZWF0ZSBk
ZXZpY2UgLSBpbnRlcm5hbCBlcnJvciIpKTsKPiArICAgICAgICByZXR1cm4gRkFMU0U7Cj4gKyAg
ICB9Cj4gKwo+ICsgICAgYmUtPm93bl9kZXZpY2VzX21hc2sgfD0gMSA8PCBhZGRyZXNzOwo+ICsK
PiArICAgIGRldi0+ZGV2aWNlX2luZm8udmlkID0gZGVzYy0+aWRWZW5kb3I7Cj4gKyAgICBkZXYt
PmRldmljZV9pbmZvLnBpZCA9IGRlc2MtPmlkUHJvZHVjdDsKPiArICAgIGRldi0+ZGV2aWNlX2lu
Zm8uYmNkVVNCID0gZGVzYy0+YmNkVVNCOwo+ICsgICAgZGV2LT5kZXZpY2VfaW5mby5jbGFzcyA9
IGRlc2MtPmJEZXZpY2VDbGFzczsKPiArICAgIGRldi0+ZGV2aWNlX2luZm8uc3ViY2xhc3MgPSBk
ZXNjLT5iRGV2aWNlU3ViQ2xhc3M7Cj4gKyAgICBkZXYtPmRldmljZV9pbmZvLnByb3RvY29sID0g
ZGVzYy0+YkRldmljZVByb3RvY29sOwo+ICsKPiArICAgIGlmIChiZS0+aG90cGx1Z19jYWxsYmFj
aykgewo+ICsgICAgICAgIGJlLT5ob3RwbHVnX2NhbGxiYWNrKGJlLT5ob3RwbHVnX3VzZXJfZGF0
YSwgZGV2LCBUUlVFKTsKPiArICAgIH0KPiArICAgIHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV91
bnJlZihkZXYpOwo+ICsKPiArICAgIHJldHVybiBUUlVFOwo+ICt9Cj4gKwo+ICAjZW5kaWYgLyog
VVNCX1JFRElSICovCj4gZGlmZiAtLWdpdCBhL3NyYy91c2ItYmFja2VuZC5oIGIvc3JjL3VzYi1i
YWNrZW5kLmgKPiBpbmRleCA2NmUxM2Y1Li5jZDNmZjA5IDEwMDY0NAo+IC0tLSBhL3NyYy91c2It
YmFja2VuZC5oCj4gKysrIGIvc3JjL3VzYi1iYWNrZW5kLmgKPiBAQCAtMzAsMTIgKzMwLDE1IEBA
IHR5cGVkZWYgc3RydWN0IF9TcGljZVVzYkJhY2tlbmQgU3BpY2VVc2JCYWNrZW5kOwo+ICB0eXBl
ZGVmIHN0cnVjdCBfU3BpY2VVc2JCYWNrZW5kRGV2aWNlIFNwaWNlVXNiQmFja2VuZERldmljZTsK
PiAgdHlwZWRlZiBzdHJ1Y3QgX1NwaWNlVXNiQmFja2VuZENoYW5uZWwgU3BpY2VVc2JCYWNrZW5k
Q2hhbm5lbDsKPiAgCj4gKyNkZWZpbmUgQlVTX05VTUJFUl9GT1JfRU1VTEFURURfVVNCIEdfTUFY
VUlOVDE2Cj4gKwo+ICB0eXBlZGVmIHN0cnVjdCBVc2JEZXZpY2VJbmZvcm1hdGlvbgo+ICB7Cj4g
ICAgICB1aW50MTZfdCBidXM7Cj4gICAgICB1aW50MTZfdCBhZGRyZXNzOwo+ICAgICAgdWludDE2
X3QgdmlkOwo+ICAgICAgdWludDE2X3QgcGlkOwo+ICsgICAgdWludDE2X3QgYmNkVVNCOwo+ICAg
ICAgdWludDhfdCBjbGFzczsKPiAgICAgIHVpbnQ4X3Qgc3ViY2xhc3M7Cj4gICAgICB1aW50OF90
IHByb3RvY29sOwo+IGRpZmYgLS1naXQgYS9zcmMvdXNiLWVtdWxhdGlvbi5oIGIvc3JjL3VzYi1l
bXVsYXRpb24uaAo+IG5ldyBmaWxlIG1vZGUgMTAwNjQ0Cj4gaW5kZXggMDAwMDAwMC4uYWMzZDhl
MAo+IC0tLSAvZGV2L251bGwKPiArKysgYi9zcmMvdXNiLWVtdWxhdGlvbi5oCj4gQEAgLTAsMCAr
MSw4OCBAQAo+ICsvKiAtKi0gTW9kZTogQzsgYy1iYXNpYy1vZmZzZXQ6IDQ7IGluZGVudC10YWJz
LW1vZGU6IG5pbCAtKi0gKi8KPiArLyoKPiArICAgIENvcHlyaWdodCAoQykgMjAxOSBSZWQgSGF0
LCBJbmMuCj4gKwo+ICsgICAgUmVkIEhhdCBBdXRob3JzOgo+ICsgICAgWXVyaSBCZW5kaXRvdmlj
aDx5YmVuZGl0b0ByZWRoYXQuY29tPgo+ICsKPiArICAgIFRoaXMgbGlicmFyeSBpcyBmcmVlIHNv
ZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IKPiArICAgIG1vZGlmeSBpdCB1
bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKPiArICAgIExp
Y2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhl
cgo+ICsgICAgdmVyc2lvbiAyLjEgb2YgdGhlIExpY2Vuc2UsIG9yIChhdCB5b3VyIG9wdGlvbikg
YW55IGxhdGVyIHZlcnNpb24uCj4gKwo+ICsgICAgVGhpcyBsaWJyYXJ5IGlzIGRpc3RyaWJ1dGVk
IGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCj4gKyAgICBidXQgV0lUSE9VVCBB
TlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgo+ICsgICAg
TUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2Vl
IHRoZSBHTlUKPiArICAgIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRl
dGFpbHMuCj4gKwo+ICsgICAgWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUg
R05VIExlc3NlciBHZW5lcmFsIFB1YmxpYwo+ICsgICAgTGljZW5zZSBhbG9uZyB3aXRoIHRoaXMg
bGlicmFyeTsgaWYgbm90LCBzZWUKPiA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCj4g
KyovCj4gKwo+ICsjcHJhZ21hIG9uY2UKPiArCj4gKyNpbmNsdWRlICJ1c2JyZWRpcnBhcnNlci5o
Igo+ICsjaW5jbHVkZSAidXNiLWJhY2tlbmQuaCIKPiArCj4gK3R5cGVkZWYgc3RydWN0IFNwaWNl
VXNiRW11bGF0ZWREZXZpY2UgU3BpY2VVc2JFbXVsYXRlZERldmljZTsKPiArdHlwZWRlZiBTcGlj
ZVVzYkVtdWxhdGVkRGV2aWNlKgo+ICsoKlNwaWNlVXNiRW11bGF0ZWREZXZpY2VDcmVhdGUpKFNw
aWNlVXNiQmFja2VuZCAqYmUsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU3Bp
Y2VVc2JCYWNrZW5kRGV2aWNlICpwYXJlbnQsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgdm9pZCAqY3JlYXRlX3BhcmFtcywKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBHRXJyb3IgKiplcnIpOwo+ICsKPiArLyoKPiArICAgIGZ1bmN0aW9uIHRhYmxlIGZvciBl
bXVsYXRlZCBVU0IgZGV2aWNlCj4gKyAgICBtdXN0IGJlIGZpcnN0IG1lbWJlciBvZiBkZXZpY2Ug
c3RydWN0dXJlCj4gKyAgICBhbGwgZnVuY3Rpb25zIGFyZSBtYW5kYXRvcnkgZm9yIGltcGxlbWVu
dGF0aW9uCj4gKyovCj4gK3R5cGVkZWYgc3RydWN0IFVzYkRldmljZU9wcyB7Cj4gKyAgICBnYm9v
bGVhbiAoKmdldF9kZXNjcmlwdG9yKShTcGljZVVzYkVtdWxhdGVkRGV2aWNlICpkZXZpY2UsCj4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50OF90IHR5cGUsIHVpbnQ4X3QgaW5k
ZXgsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2b2lkICoqYnVmZmVyLCB1aW50
MTZfdCAqc2l6ZSk7Cj4gKyAgICBnY2hhciAqICgqZ2V0X3Byb2R1Y3RfZGVzY3JpcHRpb24pKFNw
aWNlVXNiRW11bGF0ZWREZXZpY2UgKmRldmljZSk7Cj4gKyAgICB2b2lkICgqYXR0YWNoKShTcGlj
ZVVzYkVtdWxhdGVkRGV2aWNlICpkZXZpY2UsIHN0cnVjdCB1c2JyZWRpcnBhcnNlcgo+ICpwYXJz
ZXIpOwo+ICsgICAgdm9pZCAoKnJlc2V0KShTcGljZVVzYkVtdWxhdGVkRGV2aWNlICpkZXZpY2Up
Owo+ICsgICAgLyoKPiArICAgICAgICBwcm9jZXNzaW5nIGlzIHN5bmNocm9ub3VzLCBkZWZhdWx0
ID0gc3RhbGw6Cj4gKyAgICAgICAgLSByZXR1cm4gc3VjY2VzcyB3aXRob3V0IGRhdGE6IHNldCBz
dGF0dXMgdG8gMAo+ICsgICAgICAgIC0gcmV0dXJuIGVycm9yIC0gc2V0IHN0YXR1cyB0byBlcnJv
cgo+ICsgICAgICAgIC0gcmV0dXJuIHN1Y2Nlc3Mgd2l0aCBkYXRhIC0gc2V0IHN0YXR1cyB0byAw
LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXQgYnVmZmVyIHRvIHNv
bWUgYnVmZmVyCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldCBsZW5n
dGggdG8gb3V0IGxlbgo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnVu
Y2F0aW9uIGlzIGF1dG9tYXRpYwo+ICsgICAgKi8KPiArICAgIHZvaWQgKCpjb250cm9sX3JlcXVl
c3QpKFNwaWNlVXNiRW11bGF0ZWREZXZpY2UgKmRldmljZSwKPiArICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHVpbnQ4X3QgKmRhdGEsIGludCBkYXRhX2xlbiwKPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHN0cnVjdCB1c2JfcmVkaXJfY29udHJvbF9wYWNrZXRfaGVhZGVyICpoLAo+
ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgdm9pZCAqKmJ1ZmZlcik7Cj4gKyAgICAvKgo+
ICsgICAgICAgIHByb2Nlc3NpbmcgaXMgc3luY2hyb25vdXM6Cj4gKyAgICAgICAgLSBzZXQgaC0+
c3RhdHVzIHRvIHJlc3VsdGluZyBzdGF0dXMsIGRlZmF1bHQgPSBzdGFsbAo+ICsgICAgKi8KPiAr
ICAgIHZvaWQgKCpidWxrX291dF9yZXF1ZXN0KShTcGljZVVzYkVtdWxhdGVkRGV2aWNlICpkZXZp
Y2UsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDhfdCBlcCwgdWludDhfdCAq
ZGF0YSwgaW50IGRhdGFfbGVuLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQ4
X3QgKnN0YXR1cyk7Cj4gKyAgICAvKgo+ICsgICAgICAgIGlmIHJldHVybnMgdHJ1ZSwgcHJvY2Vz
c2luZyBpcyBhc3luY2hyb25vdXMKPiArICAgICAgICBvdGhlcndpc2UgaGVhZGVyIGNvbnRhaW5z
IGVycm9yIHN0YXR1cwo+ICsgICAgKi8KPiArICAgIGdib29sZWFuICgqYnVsa19pbl9yZXF1ZXN0
KShTcGljZVVzYkVtdWxhdGVkRGV2aWNlICpkZXZpY2UsIHVpbnQ2NF90IGlkLAo+ICsgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHVzYl9yZWRpcl9idWxrX3BhY2tldF9oZWFkZXIK
PiAqYnVsa19oZWFkZXIpOwo+ICsgICAgdm9pZCAoKmNhbmNlbF9yZXF1ZXN0KShTcGljZVVzYkVt
dWxhdGVkRGV2aWNlICpkZXZpY2UsIHVpbnQ2NF90IGlkKTsKPiArICAgIHZvaWQgKCpkZXRhY2gp
KFNwaWNlVXNiRW11bGF0ZWREZXZpY2UgKmRldmljZSk7Cj4gKyAgICB2b2lkICgqdW5yZWFsaXpl
KShTcGljZVVzYkVtdWxhdGVkRGV2aWNlICpkZXZpY2UpOwo+ICt9IFVzYkRldmljZU9wczsKPiAr
Cj4gK3N0YXRpYyBpbmxpbmUgY29uc3QgVXNiRGV2aWNlT3BzICpkZXZpY2Vfb3BzKFNwaWNlVXNi
RW11bGF0ZWREZXZpY2UgKmRldikKPiArewo+ICsgICAgcmV0dXJuIChjb25zdCBVc2JEZXZpY2VP
cHMgKilkZXY7Cj4gK30KPiArCj4gK2dib29sZWFuCj4gK3NwaWNlX3VzYl9iYWNrZW5kX2NyZWF0
ZV9lbXVsYXRlZF9kZXZpY2UoU3BpY2VVc2JCYWNrZW5kICpiZSwKPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBTcGljZVVzYkVtdWxhdGVkRGV2aWNlQ3JlYXRlCj4g
Y3JlYXRlX3Byb2MsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
dm9pZCAqY3JlYXRlX3BhcmFtcywKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBHRXJyb3IgKiplcnIpOwo+ICt2b2lkIHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9l
amVjdChTcGljZVVzYkJhY2tlbmQgKmJlLAo+IFNwaWNlVXNiQmFja2VuZERldmljZSAqZGV2aWNl
KTsKPiArdm9pZCBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfcmVwb3J0X2NoYW5nZShTcGljZVVz
YkJhY2tlbmQgKmJlLAo+IFNwaWNlVXNiQmFja2VuZERldmljZSAqZGV2aWNlKTsKX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KU3BpY2UtZGV2ZWwgbWFpbGlu
ZyBsaXN0ClNwaWNlLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZy
ZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL3NwaWNlLWRldmVs
