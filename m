Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 0A79F87CAB
	for <lists+spice-devel@lfdr.de>; Fri,  9 Aug 2019 16:27:54 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 987746EE2B;
	Fri,  9 Aug 2019 14:27:52 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 730A16EE2B
 for <spice-devel@lists.freedesktop.org>; Fri,  9 Aug 2019 14:27:51 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx07.intmail.prod.int.phx2.redhat.com
 [10.5.11.22])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id 1E0F73081D8F
 for <spice-devel@lists.freedesktop.org>; Fri,  9 Aug 2019 14:27:51 +0000 (UTC)
Received: from fziglio.remote.csb (ovpn-204-160.brq.redhat.com [10.40.204.160])
 by smtp.corp.redhat.com (Postfix) with ESMTP id 0611410016EA;
 Fri,  9 Aug 2019 14:27:48 +0000 (UTC)
From: Frediano Ziglio <fziglio@redhat.com>
To: spice-devel@lists.freedesktop.org
Date: Fri,  9 Aug 2019 15:26:33 +0100
Message-Id: <20190809142651.2967-16-fziglio@redhat.com>
In-Reply-To: <20190809142651.2967-1-fziglio@redhat.com>
References: <20190809142651.2967-1-fziglio@redhat.com>
MIME-Version: 1.0
X-Scanned-By: MIMEDefang 2.84 on 10.5.11.22
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16
 (mx1.redhat.com [10.5.110.43]); Fri, 09 Aug 2019 14:27:51 +0000 (UTC)
Subject: [Spice-devel] [PATCH spice-gtk v2 15/33] fixup! usb-redir: add
 files for SCSI and USB MSC implementation
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

UmV1c2UgTUlOIG1hY3JvLgotLS0KIHNyYy9jZC1zY3NpLmMgfCAyNyArKysrKysrKysrKysrLS0t
LS0tLS0tLS0tLS0KIDEgZmlsZSBjaGFuZ2VkLCAxMyBpbnNlcnRpb25zKCspLCAxNCBkZWxldGlv
bnMoLSkKCmRpZmYgLS1naXQgYS9zcmMvY2Qtc2NzaS5jIGIvc3JjL2NkLXNjc2kuYwppbmRleCA2
MTZjNjVkYS4uYmNlNzE5MWIgMTAwNjQ0Ci0tLSBhL3NyYy9jZC1zY3NpLmMKKysrIGIvc3JjL2Nk
LXNjc2kuYwpAQCAtODQ5LDggKzg0OSw3IEBAIHN0YXRpYyB2b2lkIGNkX3Njc2lfY21kX3JlcXVl
c3Rfc2Vuc2UoQ2RTY3NpTFUgKmRldiwgQ2RTY3NpUmVxdWVzdCAqcmVxKQogICAgIHJlcS0+eGZl
cl9kaXIgPSBTQ1NJX1hGRVJfRlJPTV9ERVY7CiAKICAgICByZXEtPnJlcV9sZW4gPSByZXEtPmNk
Yls0XTsKLSAgICByZXEtPmluX2xlbiA9IChyZXEtPnJlcV9sZW4gPCBzaXplb2YoZGV2LT5maXhl
ZF9zZW5zZSkpID8KLSAgICAgICAgICAgICAgICAgICByZXEtPnJlcV9sZW4gOiBzaXplb2YoZGV2
LT5maXhlZF9zZW5zZSk7CisgICAgcmVxLT5pbl9sZW4gPSBNSU4ocmVxLT5yZXFfbGVuLCBzaXpl
b2YoZGV2LT5maXhlZF9zZW5zZSkpOwogCiAgICAgaWYgKGRldi0+c2hvcnRfc2Vuc2Uua2V5ICE9
IE5PX1NFTlNFKSB7CiAgICAgICAgIFNQSUNFX0RFQlVHKCIlcywgbHVuOiV1IHJlcG9ydGVkIHNl
bnNlOiAweCUwMnggJTAyeCAlMDJ4IC0gJXMsICVzIiwKQEAgLTkxOCw3ICs5MTcsNyBAQCBzdGF0
aWMgdm9pZCBjZF9zY3NpX2NtZF9pbnF1aXJ5X3ZwZF9ub19sdW4oQ2RTY3NpTFUgKmRldiwgQ2RT
Y3NpUmVxdWVzdCAqcmVxLAogICAgIG91dGJ1ZlsyXSA9IDB4MDA7IC8qIHBhZ2UgbGVuZ3RoIE1T
QiAqLwogICAgIG91dGJ1ZlszXSA9IDB4MDA7IC8qIHBhZ2UgbGVuZ3RoIExTQiAtIG5vIG1vcmUg
ZGF0YSAqLwogCi0gICAgcmVxLT5pbl9sZW4gPSAocmVxLT5yZXFfbGVuIDwgcmVzcF9sZW4pID8g
cmVxLT5yZXFfbGVuIDogcmVzcF9sZW47CisgICAgcmVxLT5pbl9sZW4gPSBNSU4ocmVxLT5yZXFf
bGVuLCByZXNwX2xlbik7CiAKICAgICBTUElDRV9ERUJVRygiaW5xdWlyeV92cGQsIHVuc3VwcG9y
dGVkIGx1bjoldSIKICAgICAgICAgICAgICAgICAiIHBlcmlmX3F1YWw6MHgleCByZXNwX2xlbjog
JSIgR19HVUlOVDY0X0ZPUk1BVCwKQEAgLTEwNDQsNyArMTA0Myw3IEBAIHN0YXRpYyB2b2lkIGNk
X3Njc2lfY21kX2lucXVpcnlfc3RhbmRhcmRfbm9fbHVuKENkU2NzaUxVICpkZXYsIENkU2NzaVJl
cXVlc3QgKnJlCiAKICAgICBvdXRidWZbNF0gPSByZXNwX2xlbiAtIDQ7IC8qIGFkZGl0aW9uYWwg
bGVuZ3RoLCBhZnRlciBoZWFkZXIgKi8KIAotICAgIHJlcS0+aW5fbGVuID0gKHJlcS0+cmVxX2xl
biA8IHJlc3BfbGVuKSA/IHJlcS0+cmVxX2xlbiA6IHJlc3BfbGVuOworICAgIHJlcS0+aW5fbGVu
ID0gTUlOKHJlcS0+cmVxX2xlbiwgcmVzcF9sZW4pOwogCiAgICAgU1BJQ0VfREVCVUcoImlucXVp
cnlfc3RhbmRhcmQsIHVuc3VwcG9ydGVkIGx1bjoldSBwZXJpZl9xdWFsOjB4JXggIgogICAgICAg
ICAgICAgICAgICJpbnF1aXJ5X2xlbjogJXUgcmVzcF9sZW46ICUiIEdfR1VJTlQ2NF9GT1JNQVQs
CkBAIC0xMDg3LDcgKzEwODYsNyBAQCBzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9pbnF1aXJ5X3N0
YW5kYXJkKENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKICAgICAgICAgb3V0YnVm
WzY1XSA9IElOUVVJUllfVkVSU0lPTl9ERVNDX1NCQzIgJiAweGZmOwogICAgIH0KIAotICAgIHJl
cS0+aW5fbGVuID0gKHJlcS0+cmVxX2xlbiA8IHJlc3BfbGVuKSA/IHJlcS0+cmVxX2xlbiA6IHJl
c3BfbGVuOworICAgIHJlcS0+aW5fbGVuID0gTUlOKHJlcS0+cmVxX2xlbiwgcmVzcF9sZW4pOwog
CiAgICAgU1BJQ0VfREVCVUcoImlucXVpcnlfc3RhbmRhcmQsIGx1bjoldSIKICAgICAgICAgICAg
ICAgICAiIGlucXVpcnlfbGVuOiAldSByZXNwX2xlbjogJSIgR19HVUlOVDY0X0ZPUk1BVCwKQEAg
LTExOTYsNyArMTE5NSw3IEBAIHN0YXRpYyB2b2lkIGNkX3Njc2lfY21kX2dldF9yZWFkX2Rpc2Nf
aW5mb3JtYXRpb24oQ2RTY3NpTFUgKmRldiwgQ2RTY3NpUmVxdWVzdCAqCiAgICAgfQogCiAgICAg
cmVxLT5yZXFfbGVuID0gKHJlcS0+Y2RiWzddIDw8IDgpIHwgcmVxLT5jZGJbOF07Ci0gICAgcmVx
LT5pbl9sZW4gPSAocmVxLT5yZXFfbGVuIDwgUkRJX1NUQU5EQVJEX0xFTikgPyByZXEtPnJlcV9s
ZW4gOiBSRElfU1RBTkRBUkRfTEVOOworICAgIHJlcS0+aW5fbGVuID0gTUlOKHJlcS0+cmVxX2xl
biwgUkRJX1NUQU5EQVJEX0xFTik7CiAKICAgICBtZW1zZXQob3V0YnVmLCAwLCBSRElfU1RBTkRB
UkRfTEVOKTsKICAgICBvdXRidWZbMV0gPSBSRElfU1RBTkRBUkRfTEVOIC0gMjsgLyogbGVuZ3Ro
IGV4Y2x1ZGluZyB0aGUgY291bnRlciBpdHNlbGYgKi8KQEAgLTEyODcsNyArMTI4Niw3IEBAIHN0
YXRpYyB2b2lkIGNkX3Njc2lfY21kX2dldF9yZWFkX3RyYWNrX2luZm9ybWF0aW9uKENkU2NzaUxV
ICpkZXYsIENkU2NzaVJlcXVlc3QKICAgICB9CiAKICAgICByZXEtPnJlcV9sZW4gPSAocmVxLT5j
ZGJbN10gPDwgOCkgfCByZXEtPmNkYls4XTsKLSAgICByZXEtPmluX2xlbiA9IChyZXEtPnJlcV9s
ZW4gPCBUSUJfTEVOKSA/IHJlcS0+cmVxX2xlbiA6IFRJQl9MRU47CisgICAgcmVxLT5pbl9sZW4g
PSBNSU4ocmVxLT5yZXFfbGVuLCBUSUJfTEVOKTsKIAogICAgIG1lbXNldChvdXRidWYsIDAsIFRJ
Ql9MRU4pOwogICAgIG91dGJ1ZlsxXSA9IFRJQl9MRU4gLSAyOwpAQCAtMTMzMiw3ICsxMzMxLDcg
QEAgc3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRfcmVhZF90b2MoQ2RTY3NpTFUgKmRldiwgQ2RTY3Np
UmVxdWVzdCAqcmVxKQogICAgIHRyYWNrX251bSA9IHJlcS0+Y2RiWzZdOwogCiAgICAgcmVxLT5y
ZXFfbGVuID0gKHJlcS0+Y2RiWzddIDw8IDgpIHwgcmVxLT5jZGJbOF07Ci0gICAgcmVxLT5pbl9s
ZW4gPSAocmVxLT5yZXFfbGVuIDwgUkVBRF9UT0NfUkVTUF9MRU4pID8gcmVxLT5yZXFfbGVuIDog
UkVBRF9UT0NfUkVTUF9MRU47CisgICAgcmVxLT5pbl9sZW4gPSBNSU4ocmVxLT5yZXFfbGVuLCBS
RUFEX1RPQ19SRVNQX0xFTik7CiAKICAgICBtZW1zZXQob3V0YnVmLCAwLCBSRUFEX1RPQ19SRVNQ
X0xFTik7CiAgICAgb3V0YnVmWzFdID0gUkVBRF9UT0NfUkVTUF9MRU4gLSAyOyAvKiBsZW5ndGgg
ZXhjbHVkaW5nIHRoZSBjb3VudGVyIGl0c2VsZiAqLwpAQCAtMTQ4Nyw3ICsxNDg2LDcgQEAgc3Rh
dGljIHZvaWQgY2Rfc2NzaV9jbWRfbW9kZV9zZW5zZV8xMChDZFNjc2lMVSAqZGV2LCBDZFNjc2lS
ZXF1ZXN0ICpyZXEpCiAgICAgb3V0YnVmWzBdID0gKChyZXNwX2xlbiAtIDIpID4+IDgpICYgMHhm
ZjsKICAgICBvdXRidWZbMV0gPSAocmVzcF9sZW4gLSAyKSAmIDB4ZmY7CiAKLSAgICByZXEtPmlu
X2xlbiA9IChyZXEtPnJlcV9sZW4gPCByZXNwX2xlbikgPyByZXEtPnJlcV9sZW4gOiByZXNwX2xl
bjsKKyAgICByZXEtPmluX2xlbiA9IE1JTihyZXEtPnJlcV9sZW4sIHJlc3BfbGVuKTsKIAogICAg
IFNQSUNFX0RFQlVHKCJtb2RlX3NlbnNlXzEwLCBsdW46JXUiCiAgICAgICAgICAgICAgICAgIiBs
b25nX2xiYSAlZCwgZGJkICVkLCBwYWdlICVkLCBzdWJfcGFnZSAlZCwgcGMgJWQ7ICIKQEAgLTE5
MTIsNyArMTkxMSw3IEBAIHN0YXRpYyB2b2lkIGNkX3Njc2lfY21kX2dldF9jb25maWd1cmF0aW9u
KENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKICAgICBvdXRidWZbNl0gPSAocHJv
ZmlsZV9udW0gPj4gOCkgJiAweGZmOwogICAgIG91dGJ1Zls3XSA9IHByb2ZpbGVfbnVtICYgMHhm
ZjsKIAotICAgIHJlcS0+aW5fbGVuID0gKHJlcS0+cmVxX2xlbiA8IHJlc3BfbGVuKSA/IHJlcS0+
cmVxX2xlbiA6IHJlc3BfbGVuOworICAgIHJlcS0+aW5fbGVuID0gTUlOKHJlcS0+cmVxX2xlbiwg
cmVzcF9sZW4pOwogCiAgICAgU1BJQ0VfREVCVUcoImdldF9jb25maWd1cmF0aW9uLCBsdW46JXUg
cnQ6JXUgc3RhcnRfZjoldSByZXNwX2xlbjoldSIsCiAgICAgICAgICAgICAgICAgcmVxLT5sdW4s
IHJlcV90eXBlLCBzdGFydF9mZWF0dXJlLCByZXNwX2xlbik7CkBAIC0yMDIzLDcgKzIwMjIsNyBA
QCBzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9nZXRfZXZlbnRfc3RhdHVzX25vdGlmaWNhdGlvbihD
ZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgKiBmaWVsZCBpdHNlbGYgKi8KICAgICBvdXRidWZbM10gPSAodWludDhfdClj
bGFzc2VzX3N1cHBvcnRlZDsKIAotICAgIHJlcS0+aW5fbGVuID0gKHJlcS0+cmVxX2xlbiA8IHJl
c3BfbGVuKSA/IHJlcS0+cmVxX2xlbiA6IHJlc3BfbGVuOworICAgIHJlcS0+aW5fbGVuID0gTUlO
KHJlcS0+cmVxX2xlbiwgcmVzcF9sZW4pOwogICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2dvb2Qo
ZGV2LCByZXEpOwogfQogCkBAIC0yMzM2LDcgKzIzMzUsNyBAQCBzdGF0aWMgdm9pZCBjZF9zY3Np
X2dldF9wZXJmb3JtYW5jZV9yZXNwX3BlcmZvcm1hbmNlKENkU2NzaUxVICpkZXYsIENkU2NzaVJl
cXVlcwogICAgIHJlcS0+cmVxX2xlbiA9IENEX1BFUkZfSEVBREVSX0xFTiArCiAgICAgICAgICAg
ICAgICAgICAgKG1heF9udW1fZGVzY3IgKiBDRF9QRVJGX1RZUEVfUEVSRk9STUFOQ0VfREVTQ1Jf
TEVOKTsKIAotICAgIHJlcS0+aW5fbGVuID0gKHJlcS0+cmVxX2xlbiA8IHJlc3BfbGVuKSA/IHJl
cS0+cmVxX2xlbiA6IHJlc3BfbGVuOworICAgIHJlcS0+aW5fbGVuID0gTUlOKHJlcS0+cmVxX2xl
biwgcmVzcF9sZW4pOwogCiAgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfZ29vZChkZXYsIHJlcSk7
CiB9CkBAIC0yNDIyLDcgKzI0MjEsNyBAQCBzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9tZWNoYW5p
c21fc3RhdHVzKENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKICAgICAvKiBGb3Ig
bm9uLWNoYW5nZXIgZGV2aWNlcyB0aGUgbnVtYmVyIG9mIHNsb3QgdGFibGVzIHJldHVybmVkIHNo
YWxsIGJlIHplcm8sIHNvIHdlIGxlYXZlCiAgICAgICAgYm90aCAnTnVtYmVyIG9mIFNsb3RzIEF2
YWlsYWJsZScgYW5kICdMZW5ndGggb2YgU2xvdCBUYWJsZScgZmllbGRzIGFzIHplcm9zICovCiAK
LSAgICByZXEtPmluX2xlbiA9IChyZXEtPnJlcV9sZW4gPCByZXNwX2xlbikgPyByZXEtPnJlcV9s
ZW4gOiByZXNwX2xlbjsKKyAgICByZXEtPmluX2xlbiA9IE1JTihyZXEtPnJlcV9sZW4sIHJlc3Bf
bGVuKTsKIAogICAgIFNQSUNFX0RFQlVHKCJtZWNoYW5pc21fc3RhdHVzLCBsdW46JXUiLCByZXEt
Pmx1bik7CiAKQEAgLTI0NjMsNyArMjQ2Miw3IEBAIHN0YXRpYyB2b2lkIGNkX3Njc2lfcmVhZF9h
c3luY19jb21wbGV0ZShHT2JqZWN0ICpzcmNfb2JqZWN0LAogICAgICAgICAgICAgICAgICAgICAi
IHJlcTogJSIgIEdfR1VJTlQ2NF9GT1JNQVQsCiAgICAgICAgICAgICAgICAgICAgIHJlcS0+bHVu
LCBmaW5pc2hlZCwgKHVpbnQ2NF90KWJ5dGVzX3JlYWQsIHJlcS0+cmVxX2xlbik7CiAKLSAgICAg
ICAgcmVxLT5pbl9sZW4gPSAoYnl0ZXNfcmVhZCA8PSByZXEtPnJlcV9sZW4pID8gYnl0ZXNfcmVh
ZCA6IHJlcS0+cmVxX2xlbjsKKyAgICAgICAgcmVxLT5pbl9sZW4gPSBNSU4oYnl0ZXNfcmVhZCwg
cmVxLT5yZXFfbGVuKTsKICAgICAgICAgcmVxLT5zdGF0dXMgPSBHT09EOwogICAgIH0gZWxzZSB7
CiAgICAgICAgIGlmIChlcnJvciAhPSBOVUxMKSB7Ci0tIAoyLjIwLjEKCl9fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClNwaWNlLWRldmVsIG1haWxpbmcgbGlz
dApTcGljZS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVz
a3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9zcGljZS1kZXZlbA==
