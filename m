Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 10A5D24B21
	for <lists+spice-devel@lfdr.de>; Tue, 21 May 2019 11:06:02 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 50A5A8925C;
	Tue, 21 May 2019 09:05:59 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 1EBBE89247
 for <spice-devel@lists.freedesktop.org>; Tue, 21 May 2019 09:05:58 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx03.intmail.prod.int.phx2.redhat.com
 [10.5.11.13])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id B712B30832EA
 for <spice-devel@lists.freedesktop.org>; Tue, 21 May 2019 09:05:57 +0000 (UTC)
Received: from toolbox.mxp.redhat.com (unknown [10.32.181.168])
 by smtp.corp.redhat.com (Postfix) with ESMTP id 3CBAA646B4
 for <spice-devel@lists.freedesktop.org>; Tue, 21 May 2019 09:05:57 +0000 (UTC)
From: Victor Toso <victortoso@redhat.com>
To: spice-devel@lists.freedesktop.org
Date: Tue, 21 May 2019 09:05:52 +0000
Message-Id: <20190521090552.2310-5-victortoso@redhat.com>
In-Reply-To: <20190521090552.2310-1-victortoso@redhat.com>
References: <20190521090552.2310-1-victortoso@redhat.com>
MIME-Version: 1.0
X-Scanned-By: MIMEDefang 2.79 on 10.5.11.13
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16
 (mx1.redhat.com [10.5.110.44]); Tue, 21 May 2019 09:05:57 +0000 (UTC)
Subject: [Spice-devel] [spice-gtk v1 4/4] usb-redirection: do not duplicate
 USB device properties
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

RnJvbTogWXVyaSBCZW5kaXRvdmljaCA8eXVyaS5iZW5kaXRvdmljaEBkYXluaXguY29tPgoKRG8g
bm90IGtlZXAgYnVzLCBhZGRyZXNzLCB2aWQgYW5kIHBpZCBvZiB0aGUgVVNCIGRldmljZQppbiBT
cGljZVVzYkRldmljZUluZm8gc3RydWN0dXJlLiBHZXR0ZXJzIGZvciB0aGVzZSBwcm9wZXJ0aWVz
CmNhbiBlYXNpbHkgb2J0YWluIHRoZW0gZnJvbSByZXNwZWN0aXZlIGJhY2tlbmQgZGV2aWNlLgoK
U2lnbmVkLW9mZi1ieTogWXVyaSBCZW5kaXRvdmljaCA8eXVyaS5iZW5kaXRvdmljaEBkYXluaXgu
Y29tPgotLS0KIHNyYy91c2ItZGV2aWNlLW1hbmFnZXIuYyB8IDI5ICsrKysrKysrKysrKystLS0t
LS0tLS0tLS0tLS0tCiAxIGZpbGUgY2hhbmdlZCwgMTMgaW5zZXJ0aW9ucygrKSwgMTYgZGVsZXRp
b25zKC0pCgpkaWZmIC0tZ2l0IGEvc3JjL3VzYi1kZXZpY2UtbWFuYWdlci5jIGIvc3JjL3VzYi1k
ZXZpY2UtbWFuYWdlci5jCmluZGV4IDJiZWU1NWQuLjY4OTg0NzIgMTAwNjQ0Ci0tLSBhL3NyYy91
c2ItZGV2aWNlLW1hbmFnZXIuYworKysgYi9zcmMvdXNiLWRldmljZS1tYW5hZ2VyLmMKQEAgLTEy
OSwxMyArMTI5LDkgQEAgZW51bSB7CiAjaWZkZWYgVVNFX1VTQlJFRElSCiAKIHR5cGVkZWYgc3Ry
dWN0IF9TcGljZVVzYkRldmljZUluZm8gewotICAgIGd1aW50OCAgYnVzbnVtOwotICAgIGd1aW50
OCAgZGV2YWRkcjsKLSAgICBndWludDE2IHZpZDsKLSAgICBndWludDE2IHBpZDsKLSAgICBnYm9v
bGVhbiBpc29jaHJvbm91czsKICAgICBTcGljZVVzYkJhY2tlbmREZXZpY2UgKmJkZXY7CiAgICAg
Z2ludCAgICByZWY7CisgICAgZ2Jvb2xlYW4gaXNvY2hyb25vdXM7CiB9IFNwaWNlVXNiRGV2aWNl
SW5mbzsKIAogCkBAIC0xNjEzLDE4ICsxNjA5LDExIEBAIGdjaGFyICpzcGljZV91c2JfZGV2aWNl
X2dldF9kZXNjcmlwdGlvbihTcGljZVVzYkRldmljZSAqZGV2aWNlLCBjb25zdCBnY2hhciAqZm9y
CiBzdGF0aWMgU3BpY2VVc2JEZXZpY2VJbmZvICpzcGljZV91c2JfZGV2aWNlX25ldyhTcGljZVVz
YkJhY2tlbmREZXZpY2UgKmJkZXYpCiB7CiAgICAgU3BpY2VVc2JEZXZpY2VJbmZvICppbmZvOwot
ICAgIGNvbnN0IFVzYkRldmljZUluZm9ybWF0aW9uICpiZGV2X2luZm87CiAKICAgICBnX3JldHVy
bl92YWxfaWZfZmFpbChiZGV2ICE9IE5VTEwsIE5VTEwpOwogCi0gICAgYmRldl9pbmZvID0gc3Bp
Y2VfdXNiX2JhY2tlbmRfZGV2aWNlX2dldF9pbmZvKGJkZXYpOwotCiAgICAgaW5mbyA9IGdfbmV3
MChTcGljZVVzYkRldmljZUluZm8sIDEpOwogCi0gICAgaW5mby0+YnVzbnVtICA9IGJkZXZfaW5m
by0+YnVzOwotICAgIGluZm8tPmRldmFkZHIgPSBiZGV2X2luZm8tPmFkZHJlc3M7Ci0gICAgaW5m
by0+dmlkID0gYmRldl9pbmZvLT52aWQ7Ci0gICAgaW5mby0+cGlkID0gYmRldl9pbmZvLT5waWQ7
CiAgICAgaW5mby0+cmVmID0gMTsKICAgICBpbmZvLT5iZGV2ID0gc3BpY2VfdXNiX2JhY2tlbmRf
ZGV2aWNlX3JlZihiZGV2KTsKICAgICBpbmZvLT5pc29jaHJvbm91cyA9IHNwaWNlX3VzYl9iYWNr
ZW5kX2RldmljZV9pc29jaChiZGV2KTsKQEAgLTE2MzUsMzcgKzE2MjQsNDUgQEAgc3RhdGljIFNw
aWNlVXNiRGV2aWNlSW5mbyAqc3BpY2VfdXNiX2RldmljZV9uZXcoU3BpY2VVc2JCYWNrZW5kRGV2
aWNlICpiZGV2KQogZ3VpbnQ4IHNwaWNlX3VzYl9kZXZpY2VfZ2V0X2J1c251bShjb25zdCBTcGlj
ZVVzYkRldmljZSAqZGV2aWNlKQogewogICAgIGNvbnN0IFNwaWNlVXNiRGV2aWNlSW5mbyAqaW5m
byA9IChjb25zdCBTcGljZVVzYkRldmljZUluZm8gKilkZXZpY2U7CisgICAgY29uc3QgVXNiRGV2
aWNlSW5mb3JtYXRpb24gKmJfaW5mbzsKIAogICAgIGdfcmV0dXJuX3ZhbF9pZl9mYWlsKGluZm8g
IT0gTlVMTCwgMCk7CiAKLSAgICByZXR1cm4gaW5mby0+YnVzbnVtOworICAgIGJfaW5mbyA9IHNw
aWNlX3VzYl9iYWNrZW5kX2RldmljZV9nZXRfaW5mbyhpbmZvLT5iZGV2KTsKKyAgICByZXR1cm4g
Yl9pbmZvLT5idXM7CiB9CiAKIGd1aW50OCBzcGljZV91c2JfZGV2aWNlX2dldF9kZXZhZGRyKGNv
bnN0IFNwaWNlVXNiRGV2aWNlICpkZXZpY2UpCiB7CiAgICAgY29uc3QgU3BpY2VVc2JEZXZpY2VJ
bmZvICppbmZvID0gKGNvbnN0IFNwaWNlVXNiRGV2aWNlSW5mbyAqKWRldmljZTsKKyAgICBjb25z
dCBVc2JEZXZpY2VJbmZvcm1hdGlvbiAqYl9pbmZvOwogCiAgICAgZ19yZXR1cm5fdmFsX2lmX2Zh
aWwoaW5mbyAhPSBOVUxMLCAwKTsKIAotICAgIHJldHVybiBpbmZvLT5kZXZhZGRyOworICAgIGJf
aW5mbyA9IHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9nZXRfaW5mbyhpbmZvLT5iZGV2KTsKKyAg
ICByZXR1cm4gYl9pbmZvLT5hZGRyZXNzOwogfQogCiBndWludDE2IHNwaWNlX3VzYl9kZXZpY2Vf
Z2V0X3ZpZChjb25zdCBTcGljZVVzYkRldmljZSAqZGV2aWNlKQogewogICAgIGNvbnN0IFNwaWNl
VXNiRGV2aWNlSW5mbyAqaW5mbyA9IChjb25zdCBTcGljZVVzYkRldmljZUluZm8gKilkZXZpY2U7
CisgICAgY29uc3QgVXNiRGV2aWNlSW5mb3JtYXRpb24gKmJfaW5mbzsKIAogICAgIGdfcmV0dXJu
X3ZhbF9pZl9mYWlsKGluZm8gIT0gTlVMTCwgMCk7CiAKLSAgICByZXR1cm4gaW5mby0+dmlkOwor
ICAgIGJfaW5mbyA9IHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9nZXRfaW5mbyhpbmZvLT5iZGV2
KTsKKyAgICByZXR1cm4gYl9pbmZvLT52aWQ7CiB9CiAKIGd1aW50MTYgc3BpY2VfdXNiX2Rldmlj
ZV9nZXRfcGlkKGNvbnN0IFNwaWNlVXNiRGV2aWNlICpkZXZpY2UpCiB7CiAgICAgY29uc3QgU3Bp
Y2VVc2JEZXZpY2VJbmZvICppbmZvID0gKGNvbnN0IFNwaWNlVXNiRGV2aWNlSW5mbyAqKWRldmlj
ZTsKKyAgICBjb25zdCBVc2JEZXZpY2VJbmZvcm1hdGlvbiAqYl9pbmZvOwogCiAgICAgZ19yZXR1
cm5fdmFsX2lmX2ZhaWwoaW5mbyAhPSBOVUxMLCAwKTsKIAotICAgIHJldHVybiBpbmZvLT5waWQ7
CisgICAgYl9pbmZvID0gc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX2dldF9pbmZvKGluZm8tPmJk
ZXYpOworICAgIHJldHVybiBiX2luZm8tPnBpZDsKIH0KIAogZ2Jvb2xlYW4gc3BpY2VfdXNiX2Rl
dmljZV9pc19pc29jaHJvbm91cyhjb25zdCBTcGljZVVzYkRldmljZSAqZGV2aWNlKQotLSAKMi4y
MC4xCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpTcGlj
ZS1kZXZlbCBtYWlsaW5nIGxpc3QKU3BpY2UtZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0
dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vc3BpY2UtZGV2ZWw=
