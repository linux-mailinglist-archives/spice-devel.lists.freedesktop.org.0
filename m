Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 8483580C20
	for <lists+spice-devel@lfdr.de>; Sun,  4 Aug 2019 21:16:45 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 9522789E3B;
	Sun,  4 Aug 2019 19:16:43 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mail-wm1-x32d.google.com (mail-wm1-x32d.google.com
 [IPv6:2a00:1450:4864:20::32d])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 92D9D89E4C
 for <spice-devel@lists.freedesktop.org>; Sun,  4 Aug 2019 19:16:41 +0000 (UTC)
Received: by mail-wm1-x32d.google.com with SMTP id p74so72701586wme.4
 for <spice-devel@lists.freedesktop.org>; Sun, 04 Aug 2019 12:16:41 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references;
 bh=pFv9Tq7HsolXr380pzFWJIDPsnZSRw6Y6fHyZ5RrMJ8=;
 b=Ji9IlOjdcn92R11XvHaTWNWSm04ItVi06yWsKBXg7C9jDSmqWRBAe9dveLzZunYnfy
 G6jA4Pqj6mrXJ6NGBckQ5/Nlxzt9r7jtfiqTbBsuPQkxHE7VGJnA0tpZ/JYnTWHZEu6O
 M35jZTiSbyVBnijp8KBxfp6fDNOPu1zWPV2/tbnuljmh8JeY3rjwiH3SOQzQzoDzOSZX
 YeNEf111UdX1A8PRmJ48KyeNzAEpFiktXqkdQhasCIm1UMWOzMfuT3WqdFExlNZDaeDK
 DvYyJtOU3y+V2foMZkes1aHGlh7pSgzO+EmxjBYraecbx22FYaxcU3A41PO+I5TNiCp3
 B3Vg==
X-Gm-Message-State: APjAAAVDDnZpSx17JfEd8HTtdcFDTkQk3FoPBsURUnctzQsmPAr5O4MV
 5+aOmkZZnfVCeAtdtPkRunIVRxfIfhM=
X-Google-Smtp-Source: APXvYqz9saRCUu2/e1EHakFLNWTadg+/w75Rfmh58ywsiIHF5gU78dTIIh4VXAj0IdxX2/Ld6hG3BA==
X-Received: by 2002:a7b:cc04:: with SMTP id f4mr14939972wmh.125.1564946198097; 
 Sun, 04 Aug 2019 12:16:38 -0700 (PDT)
Received: from f2.redhat.com (bzq-79-182-115-245.red.bezeqint.net.
 [79.182.115.245])
 by smtp.gmail.com with ESMTPSA id f204sm136527687wme.18.2019.08.04.12.16.36
 (version=TLS1_2 cipher=ECDHE-RSA-CHACHA20-POLY1305 bits=256/256);
 Sun, 04 Aug 2019 12:16:37 -0700 (PDT)
From: Yuri Benditovich <yuri.benditovich@daynix.com>
To: spice-devel@lists.freedesktop.org
Date: Sun,  4 Aug 2019 22:16:21 +0300
Message-Id: <20190804191624.29235-6-yuri.benditovich@daynix.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20190804191624.29235-1-yuri.benditovich@daynix.com>
References: <20190804191624.29235-1-yuri.benditovich@daynix.com>
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=daynix-com.20150623.gappssmtp.com; s=20150623;
 h=from:to:cc:subject:date:message-id:in-reply-to:references;
 bh=pFv9Tq7HsolXr380pzFWJIDPsnZSRw6Y6fHyZ5RrMJ8=;
 b=aUPijThYDyJDsPfJdSfT9cYkCideBC66bZnNtbCYCmVAvNkyohycS4bgduWxqNiauB
 JwTg+LDJFdP1O4f0vi0GhPXNlQhOh7FnK/ojYYqJs54nl/rEV7bG2berr2p0iCaRDlvD
 Km2SE/8aAUYtiMTXbDCUBH9AYS3egkQ3/Xec8qvFIiGxxLZgrE7xDffL98j/E3BVSDxW
 mpLGaGIO9dlxn5VlI35Tcgx/ZNlta+DRZvFzUiy8DiNLcUqBW/8AW6pCnpw6oXQu4s8N
 yMM3HYXOPJSW+CUek7P4wbcQ8z2qMZuDOSOT/vLz4axwz3srKNIbz76x5QcNtVgznI/w
 Hftw==
Subject: [Spice-devel] [spice-gtk v2 5/8] usb-redir: add files for SCSI and
 USB MSC implementation
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: yan@daynix.com
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

RmlsZXMgYWRkZWQgd2l0aG91dCBpbmNsdWRpbmcgdGhlbSBpbiBjb21waWxhdGlvbi4KVGhleSBj
b250YWluIGltcGxlbWVudGF0aW9uIG9mIFNDU0kgY29tbWFuZHMgZm9yIGxvZ2ljYWwKdW5pdHMg
b2YgbWFzcy1zdG9yYWdlIGRldmljZSBjbGFzcyBhbmQgVVNCIGJ1bGstb25seQptYXNzLXN0b3Jh
Z2UgZGV2aWNlIHByb3RvY29sLgoKU2lnbmVkLW9mZi1ieTogQWxleGFuZGVyIE5lemhpbnNreTxh
bmV6aGluc0ByZWRoYXQuY29tPgpTaWduZWQtb2ZmLWJ5OiBZdXJpIEJlbmRpdG92aWNoIDx5dXJp
LmJlbmRpdG92aWNoQGRheW5peC5jb20+Ci0tLQogc3JjL2NkLXNjc2ktZGV2LXBhcmFtcy5oIHwg
ICA0OSArCiBzcmMvY2Qtc2NzaS5jICAgICAgICAgICAgfCAyNzU4ICsrKysrKysrKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysrCiBzcmMvY2Qtc2NzaS5oICAgICAgICAgICAgfCAgMTIxICsr
CiBzcmMvY2QtdXNiLWJ1bGstbXNkLmMgICAgfCAgNTQ2ICsrKysrKysrCiBzcmMvY2QtdXNiLWJ1
bGstbXNkLmggICAgfCAgMTM0ICsrCiBzcmMvc2NzaS1jb25zdGFudHMuaCAgICAgfCAgMzI0ICsr
KysrCiA2IGZpbGVzIGNoYW5nZWQsIDM5MzIgaW5zZXJ0aW9ucygrKQogY3JlYXRlIG1vZGUgMTAw
NjQ0IHNyYy9jZC1zY3NpLWRldi1wYXJhbXMuaAogY3JlYXRlIG1vZGUgMTAwNjQ0IHNyYy9jZC1z
Y3NpLmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBzcmMvY2Qtc2NzaS5oCiBjcmVhdGUgbW9kZSAxMDA2
NDQgc3JjL2NkLXVzYi1idWxrLW1zZC5jCiBjcmVhdGUgbW9kZSAxMDA2NDQgc3JjL2NkLXVzYi1i
dWxrLW1zZC5oCiBjcmVhdGUgbW9kZSAxMDA2NDQgc3JjL3Njc2ktY29uc3RhbnRzLmgKCmRpZmYg
LS1naXQgYS9zcmMvY2Qtc2NzaS1kZXYtcGFyYW1zLmggYi9zcmMvY2Qtc2NzaS1kZXYtcGFyYW1z
LmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMC4uYjQ4MGJjZAotLS0gL2Rldi9u
dWxsCisrKyBiL3NyYy9jZC1zY3NpLWRldi1wYXJhbXMuaApAQCAtMCwwICsxLDQ5IEBACisvKiAt
Ki0gTW9kZTogQzsgYy1iYXNpYy1vZmZzZXQ6IDQ7IGluZGVudC10YWJzLW1vZGU6IG5pbCAtKi0g
Ki8KKy8qCisgICBDRCBTQ1NJIGRldmljZSBwYXJhbWV0ZXJzCisKKyAgIENvcHlyaWdodCAoQykg
MjAxOCBSZWQgSGF0LCBJbmMuCisKKyAgIFJlZCBIYXQgQXV0aG9yczoKKyAgIEFsZXhhbmRlciBO
ZXpoaW5za3k8YW5lemhpbnNAcmVkaGF0LmNvbT4KKworICAgVGhpcyBsaWJyYXJ5IGlzIGZyZWUg
c29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vcgorICAgbW9kaWZ5IGl0IHVu
ZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYworICAgTGljZW5z
ZSBhcyBwdWJsaXNoZWQgYnkgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyCisg
ICB2ZXJzaW9uIDIuMSBvZiB0aGUgTGljZW5zZSwgb3IgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0
ZXIgdmVyc2lvbi4KKworICAgVGhpcyBsaWJyYXJ5IGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3Bl
IHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCisgICBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdp
dGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgorICAgTUVSQ0hBTlRBQklMSVRZIG9y
IEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZSBHTlUKKyAgIExlc3Nl
ciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCisKKyAgIFlvdSBzaG91
bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMK
KyAgIExpY2Vuc2UgYWxvbmcgd2l0aCB0aGlzIGxpYnJhcnk7IGlmIG5vdCwgc2VlIDxodHRwOi8v
d3d3LmdudS5vcmcvbGljZW5zZXMvPi4KKyovCisKKyNpZm5kZWYgU1BJQ0VfR1RLX0NEX1NDU0lf
REVWX1BBUkFNU19IXworI2RlZmluZSBTUElDRV9HVEtfQ0RfU0NTSV9ERVZfUEFSQU1TX0hfCisK
KyNpbmNsdWRlIDxnaW8vZ2lvLmg+CisKK3R5cGVkZWYgc3RydWN0IENkU2NzaURldmljZVBhcmFt
ZXRlcnMgeworICAgIGNvbnN0IGNoYXIgKnZlbmRvcjsKKyAgICBjb25zdCBjaGFyICpwcm9kdWN0
OworICAgIGNvbnN0IGNoYXIgKnZlcnNpb247CisgICAgY29uc3QgY2hhciAqc2VyaWFsOworfSBD
ZFNjc2lEZXZpY2VQYXJhbWV0ZXJzOworCit0eXBlZGVmIHN0cnVjdCBDZFNjc2lEZXZpY2VJbmZv
IHsKKyAgICBDZFNjc2lEZXZpY2VQYXJhbWV0ZXJzIHBhcmFtZXRlcnM7CisgICAgdWludDMyX3Qg
c3RhcnRlZCAgICA6IDE7CisgICAgdWludDMyX3QgbG9ja2VkICAgICA6IDE7CisgICAgdWludDMy
X3QgbG9hZGVkICAgICA6IDE7Cit9IENkU2NzaURldmljZUluZm87CisKK3R5cGVkZWYgc3RydWN0
IENkU2NzaU1lZGlhUGFyYW1ldGVycyB7CisgICAgR0ZpbGVJbnB1dFN0cmVhbSAqc3RyZWFtOwor
ICAgIHVpbnQ2NF90IHNpemU7CisgICAgdWludDMyX3QgYmxvY2tfc2l6ZTsKK30gQ2RTY3NpTWVk
aWFQYXJhbWV0ZXJzOworCisjZW5kaWYgLyogU1BJQ0VfR1RLX0NEX1NDU0lfREVWX1BBUkFNU19I
XyAqLwpkaWZmIC0tZ2l0IGEvc3JjL2NkLXNjc2kuYyBiL3NyYy9jZC1zY3NpLmMKbmV3IGZpbGUg
bW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMC4uMmEzNTk1YgotLS0gL2Rldi9udWxsCisrKyBiL3Ny
Yy9jZC1zY3NpLmMKQEAgLTAsMCArMSwyNzU4IEBACisvKiAtKi0gTW9kZTogQzsgYy1iYXNpYy1v
ZmZzZXQ6IDQ7IGluZGVudC10YWJzLW1vZGU6IG5pbCAtKi0gKi8KKy8qCisgICBDRCBkZXZpY2Ug
ZW11bGF0aW9uIC0gU0NTSSBlbmdpbmUKKworICAgQ29weXJpZ2h0IChDKSAyMDE4IFJlZCBIYXQs
IEluYy4KKworICAgUmVkIEhhdCBBdXRob3JzOgorICAgQWxleGFuZGVyIE5lemhpbnNreTxhbmV6
aGluc0ByZWRoYXQuY29tPgorCisgICBUaGlzIGxpYnJhcnkgaXMgZnJlZSBzb2Z0d2FyZTsgeW91
IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yCisgICBtb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1z
IG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCisgICBMaWNlbnNlIGFzIHB1Ymxpc2hl
ZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIKKyAgIHZlcnNpb24gMi4x
IG9mIHRoZSBMaWNlbnNlLCBvciAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgor
CisgICBUaGlzIGxpYnJhcnkgaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxs
IGJlIHVzZWZ1bCwKKyAgIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRo
ZSBpbXBsaWVkIHdhcnJhbnR5IG9mCisgICBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1Ig
QSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlIEdOVQorICAgTGVzc2VyIEdlbmVyYWwgUHVi
bGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KKworICAgWW91IHNob3VsZCBoYXZlIHJlY2Vp
dmVkIGEgY29weSBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYworICAgTGljZW5zZSBh
bG9uZyB3aXRoIHRoaXMgbGlicmFyeTsgaWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9s
aWNlbnNlcy8+LgorKi8KKworI2luY2x1ZGUgImNvbmZpZy5oIgorI2luY2x1ZGUgInNwaWNlL3R5
cGVzLmgiCisjaW5jbHVkZSAic3BpY2UtY29tbW9uLmgiCisjaW5jbHVkZSAic3BpY2UtdXRpbC5o
IgorI2luY2x1ZGUgImNkLXNjc2kuaCIKKworI2lmZGVmIFVTRV9VU0JSRURJUgorCisjZGVmaW5l
IFNQSUNFX0VSUk9SKGZtdCwgLi4uKSBcCisgICAgZG8geyBTUElDRV9ERUJVRygiZGV2LXNjc2kg
ZXJyb3I6ICIgZm10ICwgIyMgX19WQV9BUkdTX18pOyB9IHdoaWxlICgwKQorCisjZGVmaW5lIEZJ
WEVEX1NFTlNFX0NVUlJFTlQgMHg3MAorI2RlZmluZSBGSVhFRF9TRU5TRV9MRU4gMTgKKworI2Rl
ZmluZSBNQVhfTFVOUyAgIDMyCisKK3R5cGVkZWYgZW51bSBDZFNjc2lQb3dlckNvbmRpdGlvbiB7
CisgICAgQ0RfU0NTSV9QT1dFUl9TVE9QUEVELAorICAgIENEX1NDU0lfUE9XRVJfQUNUSVZFLAor
ICAgIENEX1NDU0lfUE9XRVJfSURMRSwKKyAgICBDRF9TQ1NJX1BPV0VSX1NUQU5EQlkKK30gQ2RT
Y3NpUG93ZXJDb25kaXRpb247CisKK3R5cGVkZWYgc3RydWN0IFNjc2lTaG9ydFNlbnNlIHsKKyAg
ICB1aW50OF90IGtleTsKKyAgICB1aW50OF90IGFzYzsKKyAgICB1aW50OF90IGFzY3E7CisgICAg
Y29uc3QgY2hhciAqZGVzY3I7Cit9IFNjc2lTaG9ydFNlbnNlOworCisjZGVmaW5lIENEX01FRElB
X0VWRU5UX05PX0NIQU5HRSAgICAgICAgICAgIDB4MAorI2RlZmluZSBDRF9NRURJQV9FVkVOVF9F
SkVDVF9SRVEgICAgICAgICAgICAweDEgLyogdXNlciByZXF1ZXN0IChtZWNoYW5pY2FsIHN3aXRj
aCkgdG8KKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAq
IGVqZWN0IHRoZSBtZWRpYSAqLworI2RlZmluZSBDRF9NRURJQV9FVkVOVF9ORVdfTUVESUEgICAg
ICAgICAgICAweDIgLyogbmV3IG1lZGlhIHJlY2VpdmVkICovCisjZGVmaW5lIENEX01FRElBX0VW
RU5UX01FRElBX1JFTU9WQUwgICAgICAgIDB4MyAvKiBtZWRpYSByZW1vdmVkICovCisjZGVmaW5l
IENEX01FRElBX0VWRU5UX01FRElBX0NIQU5HRUQgICAgICAgIDB4NCAvKiB1c2VyIHJlcXVlc3Qg
dG8gbG9hZCBuZXcgbWVkaWEgKi8KKyNkZWZpbmUgQ0RfTUVESUFfRVZFTlRfQkdfRk9STUFUX0NP
TVBMRVRFICAgMHg1CisjZGVmaW5lIENEX01FRElBX0VWRU5UX0JHX0ZPUk1BVF9SRVNUQVJUICAg
IDB4NgorCisjZGVmaW5lIENEX1BPV0VSX0VWRU5UX05PX0NIQU5HRSAgICAgICAgICAgIDB4MAor
I2RlZmluZSBDRF9QT1dFUl9FVkVOVF9DSEFOR0VfU1VDQ0VTUyAgICAgICAweDEKKyNkZWZpbmUg
Q0RfUE9XRVJfRVZFTlRfQ0hBTkdFX0ZBTEVEICAgICAgICAgMHgyCisKK3R5cGVkZWYgc3RydWN0
IENkU2NzaUxVIHsKKyAgICBDZFNjc2lUYXJnZXQgKnRndDsKKyAgICB1aW50MzJfdCBsdW47CisK
KyAgICBnYm9vbGVhbiByZWFsaXplZDsKKyAgICBnYm9vbGVhbiByZW1vdmFibGU7CisgICAgZ2Jv
b2xlYW4gbG9hZGVkOworICAgIGdib29sZWFuIHByZXZlbnRfbWVkaWFfcmVtb3ZhbDsKKyAgICBn
Ym9vbGVhbiBjZF9yb207CisKKyAgICBDZFNjc2lQb3dlckNvbmRpdGlvbiBwb3dlcl9jb25kOwor
ICAgIHVpbnQzMl90IHBvd2VyX2V2ZW50OworICAgIHVpbnQzMl90IG1lZGlhX2V2ZW50OworCisg
ICAgdWludDMyX3QgY2xhaW1fdmVyc2lvbjsKKworICAgIHVpbnQ2NF90IHNpemU7CisgICAgdWlu
dDMyX3QgYmxvY2tfc2l6ZTsKKyAgICB1aW50MzJfdCBudW1fYmxvY2tzOworCisgICAgY2hhciAq
dmVuZG9yOworICAgIGNoYXIgKnByb2R1Y3Q7CisgICAgY2hhciAqdmVyc2lvbjsKKyAgICBjaGFy
ICpzZXJpYWw7CisKKyAgICBHRmlsZUlucHV0U3RyZWFtICpzdHJlYW07CisKKyAgICBTY3NpU2hv
cnRTZW5zZSBzaG9ydF9zZW5zZTsgLyogY3VycmVudGx5IGhlbGQgc2Vuc2Ugb2YgdGhlIHNjc2kg
ZGV2aWNlICovCisgICAgdWludDhfdCBmaXhlZF9zZW5zZVtGSVhFRF9TRU5TRV9MRU5dOworfSBD
ZFNjc2lMVTsKKwordHlwZWRlZiBlbnVtIENkU2NzaVRhcmdldFN0YXRlIHsKKyAgICBDRF9TQ1NJ
X1RHVF9TVEFURV9SVU5OSU5HLAorICAgIENEX1NDU0lfVEdUX1NUQVRFX1JFU0VULAorfSBDZFNj
c2lUYXJnZXRTdGF0ZTsKKworc3RydWN0IENkU2NzaVRhcmdldCB7CisgICAgdm9pZCAqdXNlcl9k
YXRhOworCisgICAgQ2RTY3NpVGFyZ2V0U3RhdGUgc3RhdGU7CisgICAgQ2RTY3NpUmVxdWVzdCAq
Y3VyX3JlcTsKKyAgICBHQ2FuY2VsbGFibGUgKmNhbmNlbGxhYmxlOworCisgICAgdWludDMyX3Qg
bnVtX2x1bnM7CisgICAgdWludDMyX3QgbWF4X2x1bnM7CisgICAgQ2RTY3NpTFUgdW5pdHNbTUFY
X0xVTlNdOworfTsKKworc3RhdGljIGNvbnN0IGNoYXIqIHNjc2lfY21kX25hbWVbMjU2XTsKKwor
LyogUHJlZGVmaW5lZCBzZW5zZSBjb2RlcyAqLworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5z
ZV9jb2RlX05PX1NFTlNFID0geworICAgIC5rZXkgPSBOT19TRU5TRSAsIC5hc2MgPSAweDAwICwg
LmFzY3EgPSAweDAwLAorICAgIC5kZXNjciA9ICIiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5z
ZSBzZW5zZV9jb2RlX05PVF9SRUFEWV9DQVVTRV9OT1RfUkVQT1JUQUJMRSA9IHsKKyAgICAua2V5
ID0gTk9UX1JFQURZLCAuYXNjID0gMHgwNCwgLmFzY3EgPSAweDAwLAorICAgIC5kZXNjciA9ICJD
QVVTRSBOT1QgUkVQT1JUQUJMRSIKK307CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNlIHNlbnNlX2Nv
ZGVfQkVDT01JTkdfUkVBRFkgPSB7CisgICAgLmtleSA9IE5PVF9SRUFEWSwgLmFzYyA9IDB4MDQs
IC5hc2NxID0gMHgwMSwKKyAgICAuZGVzY3IgPSAiSU4gUFJPQ0VTUyBPRiBCRUNPTUlORyBSRUFE
WSIKK307CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNlIHNlbnNlX2NvZGVfSU5JVF9DTURfUkVRVUlS
RUQgPSB7CisgICAgLmtleSA9IE5PVF9SRUFEWSwgLmFzYyA9IDB4MDQsIC5hc2NxID0gMHgwMiwK
KyAgICAuZGVzY3IgPSAiSU5JVElBTElaSU5HIENPTU1BTkQgUkVRVUlSRUQiCit9OworCitjb25z
dCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX0lOVEVSVkVOVElPTl9SRVFVSVJFRCA9IHsKKyAg
ICAua2V5ID0gTk9UX1JFQURZLCAuYXNjID0gMHgwNCwgLmFzY3EgPSAweDAzLAorICAgIC5kZXNj
ciA9ICJNQU5VQUwgSU5URVJWRU5USU9OIFJFUVVJUkVEIgorfTsKKworY29uc3QgU2NzaVNob3J0
U2Vuc2Ugc2Vuc2VfY29kZV9OT1RfUkVBRFlfTk9fTUVESVVNID0geworICAgIC5rZXkgPSBOT1Rf
UkVBRFksIC5hc2MgPSAweDNhLCAuYXNjcSA9IDB4MDAsCisgICAgLmRlc2NyID0gIk1FRElVTSBO
T1QgUFJFU0VOVCIKK307CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNlIHNlbnNlX2NvZGVfTk9UX1JF
QURZX05PX01FRElVTV9UUkFZX0NMT1NFRCA9IHsKKyAgICAua2V5ID0gTk9UX1JFQURZLCAuYXNj
ID0gMHgzYSwgLmFzY3EgPSAweDAxLAorICAgIC5kZXNjciA9ICJNRURJVU0gTk9UIFBSRVNFTlQg
LSBUUkFZIENMT1NFRCIKK307CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNlIHNlbnNlX2NvZGVfTk9U
X1JFQURZX05PX01FRElVTV9UUkFZX09QRU4gPSB7CisgICAgLmtleSA9IE5PVF9SRUFEWSwgLmFz
YyA9IDB4M2EsIC5hc2NxID0gMHgwMiwKKyAgICAuZGVzY3IgPSAiTUVESVVNIE5PVCBQUkVTRU5U
IC0gVFJBWSBPUEVOIgorfTsKKworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9UQVJH
RVRfRkFJTFVSRSA9IHsKKyAgICAua2V5ID0gSEFSRFdBUkVfRVJST1IsIC5hc2MgPSAweDQ0LCAu
YXNjcSA9IDB4MDAsCisgICAgLmRlc2NyID0gIklOVEVSTkFMIFRBUkdFVCBGQUlMVVJFIgorfTsK
KworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9JTlZBTElEX09QQ09ERSA9IHsKKyAg
ICAua2V5ID0gSUxMRUdBTF9SRVFVRVNULCAuYXNjID0gMHgyMCwgLmFzY3EgPSAweDAwLAorICAg
IC5kZXNjciA9ICJJTlZBTElEIENPTU1BTkQgT1BFUkFUSU9OIENPREUiCit9OworCitjb25zdCBT
Y3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX0xCQV9PVVRfT0ZfUkFOR0UgPSB7CisgICAgLmtleSA9
IElMTEVHQUxfUkVRVUVTVCwgLmFzYyA9IDB4MjEsIC5hc2NxID0gMHgwMCwKKyAgICAuZGVzY3Ig
PSAiTE9HSUNBTCBCTE9DSyBBRERSRVNTIE9VVCBPRiBSQU5HRSIKK307CisKK2NvbnN0IFNjc2lT
aG9ydFNlbnNlIHNlbnNlX2NvZGVfSU5WQUxJRF9DREJfRklFTEQgPSB7CisgICAgLmtleSA9IElM
TEVHQUxfUkVRVUVTVCwgLmFzYyA9IDB4MjQsIC5hc2NxID0gMHgwMCwKKyAgICAuZGVzY3IgPSAi
SU5WQUxJRCBGSUVMRCBJTiBDREIiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9j
b2RlX0lOVkFMSURfUEFSQU1fRklFTEQgPSB7CisgICAgLmtleSA9IElMTEVHQUxfUkVRVUVTVCwg
LmFzYyA9IDB4MjYsIC5hc2NxID0gMHgwMCwKKyAgICAuZGVzY3IgPSAiSU5WQUxJRCBGSUVMRCBJ
TiBQQVJBTUVURVIgTElTVCIKK307CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNlIHNlbnNlX2NvZGVf
SU5WQUxJRF9QQVJBTV9MRU4gPSB7CisgICAgLmtleSA9IElMTEVHQUxfUkVRVUVTVCwgLmFzYyA9
IDB4MWEsIC5hc2NxID0gMHgwMCwKKyAgICAuZGVzY3IgPSAiUEFSQU1FVEVSIExJU1QgTEVOR1RI
IEVSUk9SIgorfTsKKworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9MVU5fTk9UX1NV
UFBPUlRFRCA9IHsKKyAgICAua2V5ID0gSUxMRUdBTF9SRVFVRVNULCAuYXNjID0gMHgyNSwgLmFz
Y3EgPSAweDAwLAorICAgIC5kZXNjciA9ICJMT0dJQ0FMIFVOSVQgTk9UIFNVUFBPUlRFRCIKK307
CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNlIHNlbnNlX2NvZGVfU0FWSU5HX1BBUkFNU19OT1RfU1VQ
UE9SVEVEID0geworICAgIC5rZXkgPSBJTExFR0FMX1JFUVVFU1QsIC5hc2MgPSAweDM5LCAuYXNj
cSA9IDB4MDAsCisgICAgLmRlc2NyID0gIlNBVklORyBQQVJBTUVURVJTIE5PVCBTVVBQT1JURUQi
Cit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX0lOQ09NUEFUSUJMRV9NRURJ
VU0gPSB7CisgICAgLmtleSA9IElMTEVHQUxfUkVRVUVTVCwgLmFzYyA9IDB4MzAsIC5hc2NxID0g
MHgwMCwKKyAgICAuZGVzY3IgPSAiSU5DT01QQVRJQkxFIE1FRElVTSBJTlNUQUxMRUQiCit9Owor
Citjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX01FRElVTV9SRU1PVkFMX1BSRVZFTlRF
RCA9IHsKKyAgICAua2V5ID0gSUxMRUdBTF9SRVFVRVNULCAuYXNjID0gMHg1MywgLmFzY3EgPSAw
eDAyLAorICAgIC5kZXNjciA9ICJNRURJVU0gUkVNT1ZBTCBQUkVWRU5URUQiCit9OworCitjb25z
dCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX1BBUkFNRVRFUlNfQ0hBTkdFRCA9IHsKKyAgICAu
a2V5ID0gVU5JVF9BVFRFTlRJT04sIC5hc2MgPSAweDJhLCAuYXNjcSA9IDB4MDAsCisgICAgLmRl
c2NyID0gIlBBUkFNRVRFUlMgQ0hBTkdFRCIKK307CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNlIHNl
bnNlX2NvZGVfUE9XRVJfT05fUkVTRVQgPSB7CisgICAgLmtleSA9IFVOSVRfQVRURU5USU9OLCAu
YXNjID0gMHgyOSwgLmFzY3EgPSAweDAwLAorICAgIC5kZXNjciA9ICJQT1dFUiBPTiwgUkVTRVQs
IE9SIEJVUyBERVZJQ0UgUkVTRVQiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9j
b2RlX1NDU0lfQlVTX1JFU0VUID0geworICAgIC5rZXkgPSBVTklUX0FUVEVOVElPTiwgLmFzYyA9
IDB4MjksIC5hc2NxID0gMHgwMiwKKyAgICAuZGVzY3IgPSAiU0NTSSBCVVMgUkVTRVQiCit9Owor
Citjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX1VBX05PX01FRElVTSA9IHsKKyAgICAu
a2V5ID0gVU5JVF9BVFRFTlRJT04sIC5hc2MgPSAweDNhLCAuYXNjcSA9IDB4MDAsCisgICAgLmRl
c2NyID0gIk1FRElVTSBOT1QgUFJFU0VOVCIKK307CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNlIHNl
bnNlX2NvZGVfTUVESVVNX0NIQU5HRUQgPSB7CisgICAgLmtleSA9IFVOSVRfQVRURU5USU9OLCAu
YXNjID0gMHgyOCwgLmFzY3EgPSAweDAwLAorICAgIC5kZXNjciA9ICJNRURJVU0gQ0hBTkdFRCIK
K307CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNlIHNlbnNlX2NvZGVfUkVQT1JURURfTFVOU19DSEFO
R0VEID0geworICAgIC5rZXkgPSBVTklUX0FUVEVOVElPTiwgLmFzYyA9IDB4M2YsIC5hc2NxID0g
MHgwZSwKKyAgICAuZGVzY3IgPSAiUkVQT1JURUQgTFVOUyBDSEFOR0VEIgorfTsKKworY29uc3Qg
U2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9ERVZJQ0VfSU5URVJOQUxfUkVTRVQgPSB7CisgICAg
LmtleSA9IFVOSVRfQVRURU5USU9OLCAuYXNjID0gMHgyOSwgLmFzY3EgPSAweDA0LAorICAgIC5k
ZXNjciA9ICJERVZJQ0UgSU5URVJOQUwgUkVTRVQiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5z
ZSBzZW5zZV9jb2RlX1VOSVRfQVRURU5USU9OX01FRElVTV9SRU1PVkFMX1JFUVVFU1QgPSB7Cisg
ICAgLmtleSA9IFVOSVRfQVRURU5USU9OLCAuYXNjID0gMHg1YSwgLmFzY3EgPSAweDAxLAorICAg
IC5kZXNjciA9ICJPUEVSQVRPUiBNRURJVU0gUkVNT1ZBTCBSRVFVRVNUIgorfTsKKworc3RhdGlj
IGlubGluZSBnYm9vbGVhbiBjZF9zY3NpX29wY29kZV91YV9zdXByZXNzKHVpbnQzMl90IG9wY29k
ZSkKK3sKKyAgICBzd2l0Y2ggKG9wY29kZSkgeworICAgIGNhc2UgSU5RVUlSWToKKyAgICBjYXNl
IFJFUE9SVF9MVU5TOgorICAgIGNhc2UgR0VUX0NPTkZJR1VSQVRJT046CisgICAgY2FzZSBHRVRf
RVZFTlRfU1RBVFVTX05PVElGSUNBVElPTjoKKyAgICBjYXNlIFJFUVVFU1RfU0VOU0U6CisgICAg
ICAgIHJldHVybiBUUlVFOworICAgIGRlZmF1bHQ6CisgICAgICAgIHJldHVybiBGQUxTRTsKKyAg
ICB9Cit9CisKK3N0YXRpYyBpbmxpbmUgY29uc3QgY2hhciAqQ2RTY3NpUmVxU3RhdGVfc3RyKENk
U2NzaVJlcVN0YXRlIHN0YXRlKQoreworICAgIHN3aXRjaChzdGF0ZSkgeworICAgIGNhc2UgU0NT
SV9SRVFfSURMRToKKyAgICAgICAgcmV0dXJuICJJRExFIjsKKyAgICBjYXNlIFNDU0lfUkVRX1JV
Tk5JTkc6CisgICAgICAgIHJldHVybiAiUlVOTklORyI7CisgICAgY2FzZSBTQ1NJX1JFUV9DT01Q
TEVURToKKyAgICAgICAgcmV0dXJuICJDT01QTEVURSI7CisgICAgY2FzZSBTQ1NJX1JFUV9DQU5D
RUxFRDoKKyAgICAgICAgcmV0dXJuICJDQU5DRUxFRCI7CisgICAgZGVmYXVsdDoKKyAgICAgICAg
cmV0dXJuICJJTExFR0FMIjsKKyAgICB9Cit9CisKK3N0YXRpYyBjb25zdCBjaGFyICpjZF9zY3Np
X3NlbnNlX2tleV9kZXNjcih1aW50OF90IHNlbnNlX2tleSkKK3sKKyAgICBzd2l0Y2goc2Vuc2Vf
a2V5KSB7CisgICAgY2FzZSBOT19TRU5TRToKKyAgICAgICAgcmV0dXJuICJOTyBTRU5TRSI7Cisg
ICAgY2FzZSBSRUNPVkVSRURfRVJST1I6CisgICAgICAgIHJldHVybiAiUkVDT1ZFUkVEIEVSUk9S
IjsKKyAgICBjYXNlIE5PVF9SRUFEWToKKyAgICAgICAgcmV0dXJuICJMVU4gTk9UIFJFQURZIjsK
KyAgICBjYXNlIE1FRElVTV9FUlJPUjoKKyAgICAgICAgcmV0dXJuICJNRURJVU0gRVJST1IiOwor
ICAgIGNhc2UgSEFSRFdBUkVfRVJST1I6CisgICAgICAgIHJldHVybiAiSEFSRFdBUkUgRVJST1Ii
OworICAgIGNhc2UgSUxMRUdBTF9SRVFVRVNUOgorICAgICAgICByZXR1cm4gIklMTEVHQUwgUkVR
VUVTVCI7CisgICAgY2FzZSBVTklUX0FUVEVOVElPTjoKKyAgICAgICAgcmV0dXJuICJVTklUIEFU
VEVOVElPTiI7CisgICAgY2FzZSBCTEFOS19DSEVDSzoKKyAgICAgICAgcmV0dXJuICJCTEFOSyBD
SEVDSyI7CisgICAgY2FzZSBBQk9SVEVEX0NPTU1BTkQ6CisgICAgICAgIHJldHVybiAiQUJPUlRF
RCBDT01NQU5EIjsKKyAgICBkZWZhdWx0OgorICAgICAgICByZXR1cm4gIj8/PyI7CisgICAgfQor
fQorc3RhdGljIHVpbnQzMl90IGNkX3Njc2lfYnVpbGRfZml4ZWRfc2Vuc2UodWludDhfdCAqYnVm
LCBjb25zdCBTY3NpU2hvcnRTZW5zZSAqc2hvcnRfc2Vuc2UpCit7CisgICAgbWVtc2V0KGJ1Ziwg
MCwgRklYRURfU0VOU0VfTEVOKTsKKworICAgIGJ1ZlswXSA9IEZJWEVEX1NFTlNFX0NVUlJFTlQ7
CisgICAgYnVmWzJdID0gc2hvcnRfc2Vuc2UtPmtleTsKKyAgICBidWZbN10gPSAxMDsKKyAgICBi
dWZbMTJdID0gc2hvcnRfc2Vuc2UtPmFzYzsKKyAgICBidWZbMTNdID0gc2hvcnRfc2Vuc2UtPmFz
Y3E7CisKKyAgICByZXR1cm4gRklYRURfU0VOU0VfTEVOOworfQorCitzdGF0aWMgaW5saW5lIHZv
aWQgY2Rfc2NzaV9yZXFfaW5pdChDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgcmVxLT5yZXFf
c3RhdGUgPSBTQ1NJX1JFUV9JRExFOworICAgIHJlcS0+eGZlcl9kaXIgPSBTQ1NJX1hGRVJfTk9O
RTsKKyAgICByZXEtPnByaXZfZGF0YSA9IE5VTEw7CisgICAgcmVxLT5pbl9sZW4gPSAwOworICAg
IHJlcS0+c3RhdHVzID0gR09PRDsKK30KKworc3RhdGljIGlubGluZSB2b2lkIGNkX3Njc2lfZGV2
X3NlbnNlX3Jlc2V0KENkU2NzaUxVICpkZXYpCit7CisgICAgbWVtc2V0KCZkZXYtPnNob3J0X3Nl
bnNlLCAwLCBzaXplb2YoZGV2LT5zaG9ydF9zZW5zZSkpOworICAgIGNkX3Njc2lfYnVpbGRfZml4
ZWRfc2Vuc2UoZGV2LT5maXhlZF9zZW5zZSwgJmRldi0+c2hvcnRfc2Vuc2UpOworfQorCitzdGF0
aWMgaW5saW5lIHZvaWQgY2Rfc2NzaV9kZXZfc2Vuc2Vfc2V0KENkU2NzaUxVICpkZXYsIGNvbnN0
IFNjc2lTaG9ydFNlbnNlICpzaG9ydF9zZW5zZSkKK3sKKyAgICBpZiAoc2hvcnRfc2Vuc2UgIT0g
TlVMTCkgeworICAgICAgICAvKiBjb3B5IHNob3J0IHNlbnNlIGFuZCBnZW5lcmF0ZSBmdWxsIHNl
bnNlIGluIGZpeGVkIGZvcm1hdCAqLworICAgICAgICBkZXYtPnNob3J0X3NlbnNlID0gKnNob3J0
X3NlbnNlOworICAgICAgICBjZF9zY3NpX2J1aWxkX2ZpeGVkX3NlbnNlKGRldi0+Zml4ZWRfc2Vu
c2UsIHNob3J0X3NlbnNlKTsKKyAgICB9Cit9CisKK3N0YXRpYyBpbmxpbmUgdm9pZCBjZF9zY3Np
X2Rldl9zZW5zZV9zZXRfcG93ZXJfb24oQ2RTY3NpTFUgKmRldikKK3sKKyAgICBjZF9zY3NpX2Rl
dl9zZW5zZV9zZXQoZGV2LCAmc2Vuc2VfY29kZV9QT1dFUl9PTl9SRVNFVCk7Cit9CisKK3N0YXRp
YyB2b2lkIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoQ2RTY3NpTFUgKmRldiwgQ2RT
Y3NpUmVxdWVzdCAqcmVxLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBjb25zdCBTY3NpU2hvcnRTZW5zZSAqc2hvcnRfc2Vuc2UpCit7CisgICAgcmVxLT5yZXFf
c3RhdGUgPSBTQ1NJX1JFUV9DT01QTEVURTsKKyAgICByZXEtPnN0YXR1cyA9IENIRUNLX0NPTkRJ
VElPTjsKKyAgICByZXEtPmluX2xlbiA9IDA7CisKKyAgICBjZF9zY3NpX2Rldl9zZW5zZV9zZXQo
ZGV2LCBzaG9ydF9zZW5zZSk7CisKKyAgICBTUElDRV9ERUJVRygiQ0hFQ0tfQ09ORCwgcmVxdWVz
dCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVAorICAgICAgICAgICAgICAgICIgb3A6IDB4JTAyeCwg
cGVuZGluZyBzZW5zZTogMHglMDJ4ICUwMnggJTAyeCAtICVzLCAlcyIsCisgICAgICAgICAgICAg
ICAgZGV2LT5sdW4sICh1aW50MzJfdClyZXEtPmNkYlswXSwKKyAgICAgICAgICAgICAgICAodWlu
dDMyX3QpZGV2LT5zaG9ydF9zZW5zZS5rZXksCisgICAgICAgICAgICAgICAgKHVpbnQzMl90KWRl
di0+c2hvcnRfc2Vuc2UuYXNjLAorICAgICAgICAgICAgICAgICh1aW50MzJfdClkZXYtPnNob3J0
X3NlbnNlLmFzY3EsCisgICAgICAgICAgICAgICAgY2Rfc2NzaV9zZW5zZV9rZXlfZGVzY3IoZGV2
LT5zaG9ydF9zZW5zZS5rZXkpLAorICAgICAgICAgICAgICAgIGRldi0+c2hvcnRfc2Vuc2UuZGVz
Y3IpOworfQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKENkU2NzaUxV
ICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICByZXEtPnJlcV9zdGF0ZSA9IFNDU0lf
UkVRX0NPTVBMRVRFOworICAgIHJlcS0+c3RhdHVzID0gR09PRDsKK30KKworLyogU0NTSSBUYXJn
ZXQgKi8KKworU1BJQ0VfQ09OU1RSVUNUT1JfRlVOQyhjZF9zY3NpX2NtZF9uYW1lc19pbml0KQor
eworICAgIHVpbnQzMl90IG9wY29kZTsKKworICAgIGZvciAob3Bjb2RlID0gMDsgb3Bjb2RlIDwg
MjU2OyBvcGNvZGUrKykgeworICAgICAgICBzY3NpX2NtZF9uYW1lW29wY29kZV0gPSAiVU5TVVBQ
T1JURUQiOworICAgIH0KKworICAgIHNjc2lfY21kX25hbWVbUkVQT1JUX0xVTlNdID0gIlJFUE9S
VCBMVU5TIjsKKyAgICBzY3NpX2NtZF9uYW1lW1RFU1RfVU5JVF9SRUFEWV0gPSAiVEVTVCBVTklU
IFJFQURZIjsKKyAgICBzY3NpX2NtZF9uYW1lW0lOUVVJUlldID0gIklOUVVJUlkiOworICAgIHNj
c2lfY21kX25hbWVbUkVRVUVTVF9TRU5TRV0gPSAiUkVRVUVTVCBTRU5TRSI7CisgICAgc2NzaV9j
bWRfbmFtZVtSRUFEXzZdID0gIlJFQUQoNikiOworICAgIHNjc2lfY21kX25hbWVbUkVBRF8xMF0g
PSAiUkVBRCgxMCkiOworICAgIHNjc2lfY21kX25hbWVbUkVBRF8xMl0gPSAiUkVBRCgxMikiOwor
ICAgIHNjc2lfY21kX25hbWVbUkVBRF8xNl0gPSAiUkVBRCgxNikiOworICAgIHNjc2lfY21kX25h
bWVbUkVBRF9DQVBBQ0lUWV8xMF0gPSAiUkVBRCBDQVBBQ0lUWSgxMCkiOworICAgIHNjc2lfY21k
X25hbWVbUkVBRF9UT0NdID0gIlJFQUQgVE9DIjsKKyAgICBzY3NpX2NtZF9uYW1lW0dFVF9FVkVO
VF9TVEFUVVNfTk9USUZJQ0FUSU9OXSA9ICJHRVQgRVZFTlQvU1RBVFVTIE5PVElGSUNBVElPTiI7
CisgICAgc2NzaV9jbWRfbmFtZVtSRUFEX0RJU0NfSU5GT1JNQVRJT05dID0gIlJFQUQgRElTQyBJ
TkZPIjsKKyAgICBzY3NpX2NtZF9uYW1lW1JFQURfVFJBQ0tfSU5GT1JNQVRJT05dID0gIlJFQUQg
VFJBQ0sgSU5GTyI7CisgICAgc2NzaV9jbWRfbmFtZVtNT0RFX1NFTlNFXzEwXSA9ICJNT0RFIFNF
TlNFKDEwKSI7CisgICAgc2NzaV9jbWRfbmFtZVtNT0RFX1NFTEVDVF0gPSAiTU9ERSBTRUxFQ1Qo
NikiOworICAgIHNjc2lfY21kX25hbWVbTU9ERV9TRUxFQ1RfMTBdID0gIk1PREUgU0VMRUNUKDEw
KSI7CisgICAgc2NzaV9jbWRfbmFtZVtHRVRfQ09ORklHVVJBVElPTl0gPSAiR0VUIENPTkZJR1VS
QVRJT04iOworICAgIHNjc2lfY21kX25hbWVbQUxMT1dfTUVESVVNX1JFTU9WQUxdID0gIlBSRVZF
TlQgQUxMT1cgTUVESVVNIFJFTU9WQUwiOworICAgIHNjc2lfY21kX25hbWVbTU1DX1NFTkRfRVZF
TlRdID0gIlNFTkQgRVZFTlQiOworICAgIHNjc2lfY21kX25hbWVbTU1DX1JFUE9SVF9LRVldID0g
IlJFUE9SVCBLRVkiOworICAgIHNjc2lfY21kX25hbWVbTU1DX1NFTkRfS0VZXSA9ICJTRU5EX0tF
WSI7CisgICAgc2NzaV9jbWRfbmFtZVtTVEFSVF9TVE9QXSA9ICJTVEFSVCBTVE9QIFVOSVQiOwor
ICAgIHNjc2lfY21kX25hbWVbTU1DX0dFVF9QRVJGT1JNQU5DRV0gPSAiR0VUIFBFUkZPUk1BTkNF
IjsKKyAgICBzY3NpX2NtZF9uYW1lW01NQ19NRUNIQU5JU01fU1RBVFVTXSA9ICJNRUNIQU5JU00g
U1RBVFVTIjsKK30KKworQ2RTY3NpVGFyZ2V0ICpjZF9zY3NpX3RhcmdldF9hbGxvYyh2b2lkICp0
YXJnZXRfdXNlcl9kYXRhLCB1aW50MzJfdCBtYXhfbHVucykKK3sKKyAgICBDZFNjc2lUYXJnZXQg
KnN0OworCisgICAgaWYgKG1heF9sdW5zID09IDAgfHwgbWF4X2x1bnMgPiBNQVhfTFVOUykgewor
ICAgICAgICBTUElDRV9FUlJPUigiQWxsb2MsIGlsbGVnYWwgbWF4X2x1bnM6JSIgR19HVUlOVDMy
X0ZPUk1BVCwgbWF4X2x1bnMpOworICAgICAgICByZXR1cm4gTlVMTDsKKyAgICB9CisKKyAgICBz
dCA9IGdfbWFsbG9jMChzaXplb2YoKnN0KSk7CisKKyAgICBzdC0+dXNlcl9kYXRhID0gdGFyZ2V0
X3VzZXJfZGF0YTsKKyAgICBzdC0+c3RhdGUgPSBDRF9TQ1NJX1RHVF9TVEFURV9SVU5OSU5HOwor
ICAgIHN0LT5jdXJfcmVxID0gTlVMTDsKKyAgICBzdC0+Y2FuY2VsbGFibGUgPSBnX2NhbmNlbGxh
YmxlX25ldygpOworICAgIHN0LT5tYXhfbHVucyA9IG1heF9sdW5zOworCisgICAgcmV0dXJuIHN0
OworfQorCit2b2lkIGNkX3Njc2lfdGFyZ2V0X2ZyZWUoQ2RTY3NpVGFyZ2V0ICpzY3NpX3Rhcmdl
dCkKK3sKKyAgICBjZF9zY3NpX3RhcmdldF9yZXNldChzY3NpX3RhcmdldCk7CisgICAgZ19mcmVl
KHNjc2lfdGFyZ2V0KTsKK30KKworLyogU0NTSSBEZXZpY2UgKi8KKworc3RhdGljIGlubGluZSBn
Ym9vbGVhbiBjZF9zY3NpX3RhcmdldF9sdW5fbGVnYWwoQ2RTY3NpVGFyZ2V0ICpzdCwgdWludDMy
X3QgbHVuKQoreworICAgIHJldHVybiAobHVuIDwgc3QtPm1heF9sdW5zKSA/IFRSVUUgOiBGQUxT
RTsKK30KKworc3RhdGljIGlubGluZSBnYm9vbGVhbiBjZF9zY3NpX3RhcmdldF9sdW5fcmVhbGl6
ZWQoQ2RTY3NpVGFyZ2V0ICpzdCwgdWludDMyX3QgbHVuKQoreworICAgIHJldHVybiAoc3QtPm51
bV9sdW5zID09IDAgfHwgIXN0LT51bml0c1tsdW5dLnJlYWxpemVkKSA/IEZBTFNFIDogVFJVRTsK
K30KKworaW50IGNkX3Njc2lfZGV2X3JlYWxpemUoQ2RTY3NpVGFyZ2V0ICpzdCwgdWludDMyX3Qg
bHVuLAorICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgQ2RTY3NpRGV2aWNlUGFyYW1ldGVy
cyAqZGV2X3BhcmFtcykKK3sKKyAgICBDZFNjc2lMVSAqZGV2OworCisgICAgaWYgKCFjZF9zY3Np
X3RhcmdldF9sdW5fbGVnYWwoc3QsIGx1bikpIHsKKyAgICAgICAgU1BJQ0VfRVJST1IoIlJlYWxp
emUsIGlsbGVnYWwgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQsIGx1bik7CisgICAgICAgIHJldHVy
biAtMTsKKyAgICB9CisgICAgaWYgKGNkX3Njc2lfdGFyZ2V0X2x1bl9yZWFsaXplZChzdCwgbHVu
KSkgeworICAgICAgICBTUElDRV9FUlJPUigiUmVhbGl6ZSwgYWxyZWFkeSByZWFsaXplZCBsdW46
JSIgR19HVUlOVDMyX0ZPUk1BVCwgbHVuKTsKKyAgICAgICAgcmV0dXJuIC0xOworICAgIH0KKyAg
ICBkZXYgPSAmc3QtPnVuaXRzW2x1bl07CisKKyAgICBtZW1zZXQoZGV2LCAwLCBzaXplb2YoKmRl
dikpOworICAgIGRldi0+dGd0ID0gc3Q7CisgICAgZGV2LT5sdW4gPSBsdW47CisKKyAgICBkZXYt
PnJlYWxpemVkID0gVFJVRTsKKyAgICBkZXYtPnJlbW92YWJsZSA9IFRSVUU7CisgICAgZGV2LT5s
b2FkZWQgPSBGQUxTRTsKKyAgICBkZXYtPnByZXZlbnRfbWVkaWFfcmVtb3ZhbCA9IEZBTFNFOwor
ICAgIGRldi0+Y2Rfcm9tID0gRkFMU0U7CisKKyAgICBkZXYtPnBvd2VyX2NvbmQgPSBDRF9TQ1NJ
X1BPV0VSX0FDVElWRTsKKyAgICBkZXYtPnBvd2VyX2V2ZW50ID0gQ0RfUE9XRVJfRVZFTlRfTk9f
Q0hBTkdFOworICAgIGRldi0+bWVkaWFfZXZlbnQgPSBDRF9NRURJQV9FVkVOVF9OT19DSEFOR0U7
CisKKyAgICBkZXYtPmNsYWltX3ZlcnNpb24gPSAzOyAvKiAwIDogbm9uZTsgMiwzLDUgOiBTUEMv
TU1DLXggKi8KKworICAgIGRldi0+dmVuZG9yID0gZ19zdHJkdXAoZGV2X3BhcmFtcy0+dmVuZG9y
KTsKKyAgICBkZXYtPnByb2R1Y3QgPSBnX3N0cmR1cChkZXZfcGFyYW1zLT5wcm9kdWN0KTsKKyAg
ICBkZXYtPnZlcnNpb24gPSBnX3N0cmR1cChkZXZfcGFyYW1zLT52ZXJzaW9uKTsKKyAgICBkZXYt
PnNlcmlhbCA9IGdfc3RyZHVwKGRldl9wYXJhbXMtPnNlcmlhbCk7CisKKyAgICBjZF9zY3NpX2Rl
dl9zZW5zZV9zZXRfcG93ZXJfb24oZGV2KTsKKworICAgIHN0LT5udW1fbHVucyArKzsKKworICAg
IFNQSUNFX0RFQlVHKCJSZWFsaXplIGx1bjolIiBHX0dVSU5UMzJfRk9STUFUICIgYnM6JSIgR19H
VUlOVDMyX0ZPUk1BVAorICAgICAgICAgICAgICAgICIgVlI6WyVzXSBQVDpbJXNdIHZlcjpbJXNd
IFNOWyVzXSIsCisgICAgICAgICAgICAgICAgbHVuLCBkZXYtPmJsb2NrX3NpemUsIGRldi0+dmVu
ZG9yLAorICAgICAgICAgICAgICAgIGRldi0+cHJvZHVjdCwgZGV2LT52ZXJzaW9uLCBkZXYtPnNl
cmlhbCk7CisgICAgcmV0dXJuIDA7Cit9CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfbHVfbWVkaWFf
cmVzZXQoQ2RTY3NpTFUgKmRldikKK3sKKyAgICAvKiBtZWRpYV9ldmVudCBpcyBub3Qgc2V0IGhl
cmUsIGFzIGl0IGRlcGVuZHMgb24gdGhlIGNvbnRleHQgKi8KKyAgICBkZXYtPnN0cmVhbSA9IE5V
TEw7CisgICAgZGV2LT5zaXplID0gMDsKKyAgICBkZXYtPmJsb2NrX3NpemUgPSAwOworICAgIGRl
di0+bnVtX2Jsb2NrcyA9IDA7Cit9CisKK2ludCBjZF9zY3NpX2Rldl9sb2NrKENkU2NzaVRhcmdl
dCAqc3QsIHVpbnQzMl90IGx1biwgZ2Jvb2xlYW4gbG9jaykKK3sKKyAgICBDZFNjc2lMVSAqZGV2
OworCisgICAgaWYgKCFjZF9zY3NpX3RhcmdldF9sdW5fbGVnYWwoc3QsIGx1bikpIHsKKyAgICAg
ICAgU1BJQ0VfRVJST1IoIkxvY2ssIGlsbGVnYWwgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQsIGx1
bik7CisgICAgICAgIHJldHVybiAtMTsKKyAgICB9CisgICAgaWYgKCFjZF9zY3NpX3RhcmdldF9s
dW5fcmVhbGl6ZWQoc3QsIGx1bikpIHsKKyAgICAgICAgU1BJQ0VfRVJST1IoIkxvY2ssIHVucmVh
bGl6ZWQgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQsIGx1bik7CisgICAgICAgIHJldHVybiAtMTsK
KyAgICB9CisgICAgZGV2ID0gJnN0LT51bml0c1tsdW5dOworICAgIGRldi0+cHJldmVudF9tZWRp
YV9yZW1vdmFsID0gbG9jazsKKyAgICBTUElDRV9ERUJVRygibHVuOiUiIEdfR1VJTlQzMl9GT1JN
QVQgIiVzbG9jayIsIGx1biwgbG9jayA/ICJ1biIgOiIiKTsKKyAgICByZXR1cm4gMDsKK30KKwor
c3RhdGljIHZvaWQgY2Rfc2NzaV9sdV9sb2FkKENkU2NzaUxVICpkZXYsCisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgY29uc3QgQ2RTY3NpTWVkaWFQYXJhbWV0ZXJzICptZWRpYV9wYXJhbXMp
Cit7CisgICAgaWYgKG1lZGlhX3BhcmFtcyAhPSBOVUxMKSB7CisgICAgICAgIGRldi0+bWVkaWFf
ZXZlbnQgPSBDRF9NRURJQV9FVkVOVF9ORVdfTUVESUE7CisgICAgICAgIGRldi0+c3RyZWFtID0g
bWVkaWFfcGFyYW1zLT5zdHJlYW07CisgICAgICAgIGRldi0+c2l6ZSA9IG1lZGlhX3BhcmFtcy0+
c2l6ZTsKKyAgICAgICAgZGV2LT5ibG9ja19zaXplID0gbWVkaWFfcGFyYW1zLT5ibG9ja19zaXpl
OworICAgICAgICBkZXYtPm51bV9ibG9ja3MgPSBtZWRpYV9wYXJhbXMtPnNpemUgLyBtZWRpYV9w
YXJhbXMtPmJsb2NrX3NpemU7CisgICAgfSBlbHNlIHsKKyAgICAgICAgZGV2LT5tZWRpYV9ldmVu
dCA9IENEX01FRElBX0VWRU5UX01FRElBX1JFTU9WQUw7CisgICAgICAgIGNkX3Njc2lfbHVfbWVk
aWFfcmVzZXQoZGV2KTsKKyAgICB9CisgICAgZGV2LT5sb2FkZWQgPSBUUlVFOworfQorCitzdGF0
aWMgdm9pZCBjZF9zY3NpX2x1X3VubG9hZChDZFNjc2lMVSAqZGV2KQoreworICAgIGRldi0+bWVk
aWFfZXZlbnQgPSBDRF9NRURJQV9FVkVOVF9NRURJQV9SRU1PVkFMOworICAgIGNkX3Njc2lfbHVf
bWVkaWFfcmVzZXQoZGV2KTsKKyAgICBkZXYtPmxvYWRlZCA9IEZBTFNFOworfQorCitpbnQgY2Rf
c2NzaV9kZXZfbG9hZChDZFNjc2lUYXJnZXQgKnN0LCB1aW50MzJfdCBsdW4sCisgICAgICAgICAg
ICAgICAgICAgICBjb25zdCBDZFNjc2lNZWRpYVBhcmFtZXRlcnMgKm1lZGlhX3BhcmFtcykKK3sK
KyAgICBDZFNjc2lMVSAqZGV2OworCisgICAgaWYgKCFjZF9zY3NpX3RhcmdldF9sdW5fbGVnYWwo
c3QsIGx1bikpIHsKKyAgICAgICAgU1BJQ0VfRVJST1IoIkxvYWQsIGlsbGVnYWwgbHVuOiUiIEdf
R1VJTlQzMl9GT1JNQVQsIGx1bik7CisgICAgICAgIHJldHVybiAtMTsKKyAgICB9CisgICAgaWYg
KCFjZF9zY3NpX3RhcmdldF9sdW5fcmVhbGl6ZWQoc3QsIGx1bikpIHsKKyAgICAgICAgU1BJQ0Vf
RVJST1IoIkxvYWQsIHVucmVhbGl6ZWQgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQsIGx1bik7Cisg
ICAgICAgIHJldHVybiAtMTsKKyAgICB9CisgICAgZGV2ID0gJnN0LT51bml0c1tsdW5dOworCisg
ICAgY2Rfc2NzaV9sdV9sb2FkKGRldiwgbWVkaWFfcGFyYW1zKTsKKyAgICBkZXYtPnBvd2VyX2Nv
bmQgPSBDRF9TQ1NJX1BPV0VSX0FDVElWRTsKKyAgICBkZXYtPnBvd2VyX2V2ZW50ID0gQ0RfUE9X
RVJfRVZFTlRfQ0hBTkdFX1NVQ0NFU1M7CisKKyAgICBjZF9zY3NpX2Rldl9zZW5zZV9zZXQoZGV2
LCAmc2Vuc2VfY29kZV9NRURJVU1fQ0hBTkdFRCk7CisKKyAgICBTUElDRV9ERUJVRygiTG9hZCBs
dW46JSIgR19HVUlOVDMyX0ZPUk1BVCAiIHNpemU6JSIgR19HVUlOVDY0X0ZPUk1BVAorICAgICAg
ICAgICAgICAgICIgYmxrX3N6OiUiIEdfR1VJTlQzMl9GT1JNQVQgIiBudW1fYmxvY2tzOiUiIEdf
R1VJTlQzMl9GT1JNQVQsCisgICAgICAgICAgICAgICAgbHVuLCBkZXYtPnNpemUsIGRldi0+Ymxv
Y2tfc2l6ZSwgZGV2LT5udW1fYmxvY2tzKTsKKyAgICByZXR1cm4gMDsKK30KKworaW50IGNkX3Nj
c2lfZGV2X2dldF9pbmZvKENkU2NzaVRhcmdldCAqc3QsIHVpbnQzMl90IGx1biwgQ2RTY3NpRGV2
aWNlSW5mbyAqbHVuX2luZm8pCit7CisgICAgQ2RTY3NpTFUgKmRldjsKKworICAgIGlmICghY2Rf
c2NzaV90YXJnZXRfbHVuX2xlZ2FsKHN0LCBsdW4pKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJM
b2FkLCBpbGxlZ2FsIGx1bjolIiBHX0dVSU5UMzJfRk9STUFULCBsdW4pOworICAgICAgICByZXR1
cm4gLTE7CisgICAgfQorICAgIGlmICghY2Rfc2NzaV90YXJnZXRfbHVuX3JlYWxpemVkKHN0LCBs
dW4pKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJMb2FkLCB1bnJlYWxpemVkIGx1bjolIiBHX0dV
SU5UMzJfRk9STUFULCBsdW4pOworICAgICAgICByZXR1cm4gLTE7CisgICAgfQorICAgIGRldiA9
ICZzdC0+dW5pdHNbbHVuXTsKKworICAgIGx1bl9pbmZvLT5zdGFydGVkID0gZGV2LT5wb3dlcl9j
b25kID09IENEX1NDU0lfUE9XRVJfQUNUSVZFOworICAgIGx1bl9pbmZvLT5sb2NrZWQgPSBkZXYt
PnByZXZlbnRfbWVkaWFfcmVtb3ZhbDsKKyAgICBsdW5faW5mby0+bG9hZGVkID0gZGV2LT5sb2Fk
ZWQ7CisKKyAgICBsdW5faW5mby0+cGFyYW1ldGVycy52ZW5kb3IgPSBkZXYtPnZlbmRvcjsKKyAg
ICBsdW5faW5mby0+cGFyYW1ldGVycy5wcm9kdWN0ID0gZGV2LT5wcm9kdWN0OworICAgIGx1bl9p
bmZvLT5wYXJhbWV0ZXJzLnZlcnNpb24gPSBkZXYtPnZlcnNpb247CisgICAgbHVuX2luZm8tPnBh
cmFtZXRlcnMuc2VyaWFsID0gZGV2LT5zZXJpYWw7CisKKyAgICByZXR1cm4gMDsKK30KKworaW50
IGNkX3Njc2lfZGV2X3VubG9hZChDZFNjc2lUYXJnZXQgKnN0LCB1aW50MzJfdCBsdW4pCit7Cisg
ICAgQ2RTY3NpTFUgKmRldjsKKworICAgIGlmICghY2Rfc2NzaV90YXJnZXRfbHVuX2xlZ2FsKHN0
LCBsdW4pKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJVbmxvYWQsIGlsbGVnYWwgbHVuOiUiIEdf
R1VJTlQzMl9GT1JNQVQsIGx1bik7CisgICAgICAgIHJldHVybiAtMTsKKyAgICB9CisgICAgaWYg
KCFjZF9zY3NpX3RhcmdldF9sdW5fcmVhbGl6ZWQoc3QsIGx1bikpIHsKKyAgICAgICAgU1BJQ0Vf
RVJST1IoIlVubG9hZCwgdW5yZWFsaXplZCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCwgbHVuKTsK
KyAgICAgICAgcmV0dXJuIC0xOworICAgIH0KKyAgICBkZXYgPSAmc3QtPnVuaXRzW2x1bl07Cisg
ICAgaWYgKCFkZXYtPmxvYWRlZCkgeworICAgICAgICBTUElDRV9FUlJPUigiVW5sb2FkLCBsdW46
JSIgR19HVUlOVDMyX0ZPUk1BVCAiIG5vdCBsb2FkZWQgeWV0IiwgbHVuKTsKKyAgICAgICAgcmV0
dXJuIDA7CisgICAgfQorICAgIGlmIChkZXYtPnByZXZlbnRfbWVkaWFfcmVtb3ZhbCkgeworICAg
ICAgICBTUElDRV9FUlJPUigiVW5sb2FkLCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCAiIHByZXZl
bnRfbWVkaWFfcmVtb3ZhbCBzZXQiLCBsdW4pOworICAgICAgICByZXR1cm4gLTE7CisgICAgfQor
CisgICAgY2Rfc2NzaV9sdV91bmxvYWQoZGV2KTsKKyAgICBkZXYtPnBvd2VyX2NvbmQgPSBDRF9T
Q1NJX1BPV0VSX1NUT1BQRUQ7CisgICAgZGV2LT5wb3dlcl9ldmVudCA9IENEX1BPV0VSX0VWRU5U
X0NIQU5HRV9TVUNDRVNTOworCisgICAgY2Rfc2NzaV9kZXZfc2Vuc2Vfc2V0KGRldiwgJnNlbnNl
X2NvZGVfVUFfTk9fTUVESVVNKTsKKworICAgIFNQSUNFX0RFQlVHKCJVbmxvYWQgbHVuOiUiIEdf
R1VJTlQzMl9GT1JNQVQsIGx1bik7CisgICAgcmV0dXJuIDA7Cit9CisKK2ludCBjZF9zY3NpX2Rl
dl91bnJlYWxpemUoQ2RTY3NpVGFyZ2V0ICpzdCwgdWludDMyX3QgbHVuKQoreworICAgIENkU2Nz
aUxVICpkZXY7CisKKyAgICBpZiAoIWNkX3Njc2lfdGFyZ2V0X2x1bl9sZWdhbChzdCwgbHVuKSkg
eworICAgICAgICBTUElDRV9FUlJPUigiVW5yZWFsaXplLCBpbGxlZ2FsIGx1bjolIiBHX0dVSU5U
MzJfRk9STUFULCBsdW4pOworICAgICAgICByZXR1cm4gLTE7CisgICAgfQorICAgIGlmICghY2Rf
c2NzaV90YXJnZXRfbHVuX3JlYWxpemVkKHN0LCBsdW4pKSB7CisgICAgICAgIFNQSUNFX0VSUk9S
KCJVbnJlYWxpemUsIGFic2VudCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCwgbHVuKTsKKyAgICAg
ICAgcmV0dXJuIC0xOworICAgIH0KKyAgICBkZXYgPSAmc3QtPnVuaXRzW2x1bl07CisKKyAgICBp
ZiAoZGV2LT52ZW5kb3IgIT0gTlVMTCkgeworICAgICAgICBmcmVlKGRldi0+dmVuZG9yKTsKKyAg
ICAgICAgZGV2LT52ZW5kb3IgPSBOVUxMOworICAgIH0KKyAgICBpZiAoZGV2LT5wcm9kdWN0ICE9
IE5VTEwpIHsKKyAgICAgICAgZnJlZShkZXYtPnByb2R1Y3QpOworICAgICAgICBkZXYtPnByb2R1
Y3QgPSBOVUxMOworICAgIH0KKyAgICBpZiAoZGV2LT52ZXJzaW9uICE9IE5VTEwpIHsKKyAgICAg
ICAgZnJlZShkZXYtPnZlcnNpb24pOworICAgICAgICBkZXYtPnZlcnNpb24gPSBOVUxMOworICAg
IH0KKyAgICBpZiAoZGV2LT5zZXJpYWwgIT0gTlVMTCkgeworICAgICAgICBmcmVlKGRldi0+c2Vy
aWFsKTsKKyAgICAgICAgZGV2LT5zZXJpYWwgPSBOVUxMOworICAgIH0KKworICAgIGRldi0+bG9h
ZGVkID0gRkFMU0U7CisgICAgZGV2LT5yZWFsaXplZCA9IEZBTFNFOworICAgIGRldi0+cG93ZXJf
Y29uZCA9IENEX1NDU0lfUE9XRVJfU1RPUFBFRDsKKworICAgIHN0LT5udW1fbHVucyAtLTsKKwor
ICAgIFNQSUNFX0RFQlVHKCJVbnJlYWxpemUgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQsIGx1bik7
CisgICAgcmV0dXJuIDA7Cit9CisKK2ludCBjZF9zY3NpX2Rldl9yZXNldChDZFNjc2lUYXJnZXQg
KnN0LCB1aW50MzJfdCBsdW4pCit7CisgICAgQ2RTY3NpTFUgKmRldjsKKworICAgIGlmICghY2Rf
c2NzaV90YXJnZXRfbHVuX2xlZ2FsKHN0LCBsdW4pKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJE
ZXZpY2UgcmVzZXQsIGlsbGVnYWwgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQsIGx1bik7CisgICAg
ICAgIHJldHVybiAtMTsKKyAgICB9CisgICAgaWYgKCFjZF9zY3NpX3RhcmdldF9sdW5fcmVhbGl6
ZWQoc3QsIGx1bikpIHsKKyAgICAgICAgU1BJQ0VfRVJST1IoIkRldmljZSByZXNldCwgYWJzZW50
IGx1bjolIiBHX0dVSU5UMzJfRk9STUFULCBsdW4pOworICAgICAgICByZXR1cm4gLTE7CisgICAg
fQorICAgIGRldiA9ICZzdC0+dW5pdHNbbHVuXTsKKworICAgIC8qIGlmIHdlIHJlc2V0IHRoZSAn
cHJldmVudCcgZmxhZyB3ZSBjYW4ndCBjcmVhdGUKKyAgICAgKiB0aGUgdW5pdCB0aGF0IGlzIGxv
Y2tlZCBmcm9tIHRoZSBiZWdpbm5pbmcsIHNvCisgICAgICogd2Uga2VlcCB0aGlzIGZsYWcgYXMg
cGVyc2lzdGVudCBvdmVyIHJlc2V0cworICAgICAqLworICAgIC8qIGRldi0+cHJldmVudF9tZWRp
YV9yZW1vdmFsID0gRkFMU0U7ICovCisgICAgZGV2LT5wb3dlcl9jb25kID0gQ0RfU0NTSV9QT1dF
Ul9BQ1RJVkU7CisgICAgZGV2LT5wb3dlcl9ldmVudCA9IENEX1BPV0VSX0VWRU5UX0NIQU5HRV9T
VUNDRVNTOworICAgIGNkX3Njc2lfZGV2X3NlbnNlX3NldF9wb3dlcl9vbihkZXYpOworCisgICAg
U1BJQ0VfREVCVUcoIkRldmljZSByZXNldCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCwgbHVuKTsK
KyAgICByZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQgY2Rfc2NzaV90YXJnZXRfZG9fcmVzZXQo
Q2RTY3NpVGFyZ2V0ICpzdCkKK3sKKyAgICB1aW50MzJfdCBsdW47CisKKyAgICBmb3IgKGx1biA9
IDA7IGx1biA8IHN0LT5tYXhfbHVuczsgbHVuKyspIHsKKyAgICAgICAgaWYgKHN0LT51bml0c1ts
dW5dLnJlYWxpemVkKSB7CisgICAgICAgICAgICBjZF9zY3NpX2Rldl9yZXNldChzdCwgbHVuKTsK
KyAgICAgICAgfQorICAgIH0KKworICAgIFNQSUNFX0RFQlVHKCJUYXJnZXQgcmVzZXQgY29tcGxl
dGUiKTsKKyAgICBzdC0+c3RhdGUgPSBDRF9TQ1NJX1RHVF9TVEFURV9SVU5OSU5HOworICAgIGNk
X3Njc2lfdGFyZ2V0X3Jlc2V0X2NvbXBsZXRlKHN0LT51c2VyX2RhdGEpOworfQorCitpbnQgY2Rf
c2NzaV90YXJnZXRfcmVzZXQoQ2RTY3NpVGFyZ2V0ICpzdCkKK3sKKyAgICBpZiAoc3QtPnN0YXRl
ID09IENEX1NDU0lfVEdUX1NUQVRFX1JFU0VUKSB7CisgICAgICAgIFNQSUNFX0RFQlVHKCJUYXJn
ZXQgYWxyZWFkeSBpbiByZXNldCIpOworICAgICAgICByZXR1cm4gLTE7CisgICAgfQorCisgICAg
c3QtPnN0YXRlID0gQ0RfU0NTSV9UR1RfU1RBVEVfUkVTRVQ7CisKKyAgICBpZiAoc3QtPmN1cl9y
ZXEgIT0gTlVMTCkgeworICAgICAgICBjZF9zY3NpX2Rldl9yZXF1ZXN0X2NhbmNlbChzdCwgc3Qt
PmN1cl9yZXEpOworICAgICAgICBpZiAoc3QtPmN1cl9yZXEgIT0gTlVMTCkgeworICAgICAgICAg
ICAgU1BJQ0VfREVCVUcoIlRhcmdldCByZXNldCBpbiBwcm9ncmVzcy4uLiIpOworICAgICAgICAg
ICAgcmV0dXJuIDA7CisgICAgICAgIH0KKyAgICB9CisKKyAgICBjZF9zY3NpX3RhcmdldF9kb19y
ZXNldChzdCk7CisgICAgcmV0dXJuIDA7Cit9CisKK0NkU2NzaVJlcVN0YXRlIGNkX3Njc2lfZ2V0
X3JlcV9zdGF0ZShDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgcmV0dXJuIHJlcS0+cmVxX3N0
YXRlOworfQorCitzdGF0aWMgdm9pZCBzdHJwYWRjcHkoY2hhciAqYnVmLCBpbnQgYnVmX3NpemUs
IGNvbnN0IGNoYXIgKnN0ciwgY2hhciBwYWQpCit7CisgICAgaW50IGxlbiA9IHN0cm5sZW4oc3Ry
LCBidWZfc2l6ZSk7CisgICAgbWVtY3B5KGJ1Ziwgc3RyLCBsZW4pOworICAgIG1lbXNldChidWYg
KyBsZW4sIHBhZCwgYnVmX3NpemUgLSBsZW4pOworfQorCisvKiBTQ1NJIENEQiAqLworCitzdGF0
aWMgaW50IHNjc2lfY2RiX2xlbmd0aCh1aW50OF90ICpjZGIpCit7CisgICAgaW50IGNkYl9sZW47
CisKKyAgICBzd2l0Y2ggKGNkYlswXSA+PiA1KSB7CisgICAgY2FzZSAwOgorICAgICAgICBjZGJf
bGVuID0gNjsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSAxOgorICAgIGNhc2UgMjoKKyAgICAg
ICAgY2RiX2xlbiA9IDEwOworICAgICAgICBicmVhazsKKyAgICBjYXNlIDQ6CisgICAgICAgIGNk
Yl9sZW4gPSAxNjsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSA1OgorICAgICAgICBjZGJfbGVu
ID0gMTI7CisgICAgICAgIGJyZWFrOworICAgIGRlZmF1bHQ6CisgICAgICAgIGNkYl9sZW4gPSAt
MTsKKyAgICB9CisgICAgcmV0dXJuIGNkYl9sZW47Cit9CisKK3N0YXRpYyB1aW50NjRfdCBzY3Np
X2NkYl9sYmEodWludDhfdCAqY2RiLCBpbnQgY2RiX2xlbikKK3sKKyAgICB1aW50NjRfdCBsYmE7
CisKKyAgICBzd2l0Y2ggKGNkYl9sZW4pIHsKKyAgICBjYXNlIDY6CisgICAgICAgIGxiYSA9ICgo
KHVpbnQ2NF90KShjZGJbMV0gJiAweDFmKSkgPDwgMTYpIHwKKyAgICAgICAgICAgICAgKCgodWlu
dDY0X3QpY2RiWzJdKSA8PCA4KSB8CisgICAgICAgICAgICAgICAoKHVpbnQ2NF90KWNkYlszXSk7
CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgMTA6CisgICAgY2FzZSAxMjoKKyAgICAgICAgbGJh
ID0gKCgodWludDY0X3QpY2RiWzJdKSA8PCAyNCkgfAorICAgICAgICAgICAgICAoKCh1aW50NjRf
dCljZGJbM10pIDw8IDE2KSB8CisgICAgICAgICAgICAgICgoKHVpbnQ2NF90KWNkYls0XSkgPDwg
OCkgIHwKKyAgICAgICAgICAgICAgICgodWludDY0X3QpY2RiWzVdKTsKKyAgICAgICAgYnJlYWs7
CisgICAgY2FzZSAxNjoKKyAgICAgICAgbGJhID0gKCgodWludDY0X3QpY2RiWzJdKSA8PCA1Nikg
fAorICAgICAgICAgICAgICAoKCh1aW50NjRfdCljZGJbM10pIDw8IDQ4KSB8CisgICAgICAgICAg
ICAgICgoKHVpbnQ2NF90KWNkYls0XSkgPDwgNDApIHwKKyAgICAgICAgICAgICAgKCgodWludDY0
X3QpY2RiWzVdKSA8PCAzMikgfAorICAgICAgICAgICAgICAoKCh1aW50NjRfdCljZGJbNl0pIDw8
IDI0KSB8CisgICAgICAgICAgICAgICgoKHVpbnQ2NF90KWNkYls3XSkgPDwgMTYpIHwKKyAgICAg
ICAgICAgICAgKCgodWludDY0X3QpY2RiWzhdKSA8PCA4KSAgfAorICAgICAgICAgICAgICAgKCh1
aW50NjRfdCljZGJbOV0pOworICAgICAgICBicmVhazsKKyAgICBkZWZhdWx0OgorICAgICAgICBs
YmEgPSAwOworICAgIH0KKyAgICByZXR1cm4gbGJhOworfQorCitzdGF0aWMgdWludDMyX3Qgc2Nz
aV9jZGJfeGZlcl9sZW5ndGgodWludDhfdCAqY2RiLCBpbnQgY2RiX2xlbikKK3sKKyAgICB1aW50
MzJfdCBsZW47CisKKyAgICBzd2l0Y2ggKGNkYl9sZW4pIHsKKyAgICBjYXNlIDY6CisgICAgICAg
IGxlbiA9ICh1aW50MzJfdCljZGJbNF07CisgICAgICAgIGlmIChsZW4gPT0gMCkKKyAgICAgICAg
ICAgIGxlbiA9IDI1NjsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSAxMDoKKyAgICAgICAgbGVu
ID0gKCgodWludDMyX3QpY2RiWzddKSA8PCA4KSB8CisgICAgICAgICAgICAgICAoKHVpbnQzMl90
KWNkYls4XSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgMTI6CisgICAgICAgIGxlbiA9ICgo
KHVpbnQzMl90KWNkYls2XSkgPDwgMjQpIHwKKyAgICAgICAgICAgICAgKCgodWludDMyX3QpY2Ri
WzddKSA8PCAxNikgfAorICAgICAgICAgICAgICAoKCh1aW50MzJfdCljZGJbOF0pIDw8IDgpICB8
CisgICAgICAgICAgICAgICAoKHVpbnQzMl90KWNkYls5XSk7CisgICAgICAgIGJyZWFrOworICAg
IGNhc2UgMTY6CisgICAgICAgIGxlbiA9ICgoKHVpbnQzMl90KWNkYlsxMF0pIDw8IDI0KSB8Cisg
ICAgICAgICAgICAgICgoKHVpbnQzMl90KWNkYlsxMV0pIDw8IDE2KSB8CisgICAgICAgICAgICAg
ICgoKHVpbnQzMl90KWNkYlsxMl0pIDw8IDgpICB8CisgICAgICAgICAgICAgICAoKHVpbnQzMl90
KWNkYlsxM10pOworICAgICAgICBicmVhazsKKyAgICBkZWZhdWx0OgorICAgICAgICBsZW4gPSAw
OworICAgICAgICBicmVhazsKKyAgICB9CisgICAgcmV0dXJuIGxlbjsKK30KKworLyogU0NTSSBj
b21tYW5kcyAqLworCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF90ZXN0X3VuaXRfcmVhZHkoQ2RT
Y3NpTFUgKmRldiwgQ2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAgIHJlcS0+eGZlcl9kaXIgPSBT
Q1NJX1hGRVJfTk9ORTsKKyAgICByZXEtPmluX2xlbiA9IDA7CisKKyAgICBpZiAoZGV2LT5sb2Fk
ZWQpIHsKKyAgICAgICAgaWYgKGRldi0+cG93ZXJfY29uZCAhPSBDRF9TQ1NJX1BPV0VSX1NUT1BQ
RUQpIHsKKyAgICAgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2LCByZXEpOwor
ICAgICAgICB9IGVsc2UgeworICAgICAgICAgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tf
Y29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfSU5JVF9DTURfUkVRVUlSRUQpOworICAgICAgICB9
CisgICAgfSBlbHNlIHsKKyAgICAgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChk
ZXYsIHJlcSwgJnNlbnNlX2NvZGVfTk9UX1JFQURZX05PX01FRElVTSk7CisgICAgfQorfQorCitz
dGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9yZXF1ZXN0X3NlbnNlKENkU2NzaUxVICpkZXYsIENkU2Nz
aVJlcXVlc3QgKnJlcSkKK3sKKyAgICByZXEtPnhmZXJfZGlyID0gU0NTSV9YRkVSX0ZST01fREVW
OworCisgICAgcmVxLT5yZXFfbGVuID0gcmVxLT5jZGJbNF07CisgICAgcmVxLT5pbl9sZW4gPSAo
cmVxLT5yZXFfbGVuIDwgc2l6ZW9mKGRldi0+Zml4ZWRfc2Vuc2UpKSA/CisgICAgICAgICAgICAg
ICAgICAgcmVxLT5yZXFfbGVuIDogc2l6ZW9mKGRldi0+Zml4ZWRfc2Vuc2UpOworCisgICAgaWYg
KGRldi0+c2hvcnRfc2Vuc2Uua2V5ICE9IE5PX1NFTlNFKSB7CisgICAgICAgIFNQSUNFX0RFQlVH
KCIlcywgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQgIiByZXBvcnRlZCBzZW5zZTogMHglMDJ4ICUw
MnggJTAyeCAtICVzLCAlcyIsCisgICAgICAgICAgICAgICAgICAgIF9fRlVOQ1RJT05fXywgcmVx
LT5sdW4sCisgICAgICAgICAgICAgICAgICAgIGRldi0+c2hvcnRfc2Vuc2Uua2V5LCBkZXYtPnNo
b3J0X3NlbnNlLmFzYywgZGV2LT5zaG9ydF9zZW5zZS5hc2NxLAorICAgICAgICAgICAgICAgICAg
ICBjZF9zY3NpX3NlbnNlX2tleV9kZXNjcihkZXYtPnNob3J0X3NlbnNlLmtleSksCisgICAgICAg
ICAgICAgICAgICAgIGRldi0+c2hvcnRfc2Vuc2UuZGVzY3IpOworICAgIH0KKyAgICBtZW1jcHko
cmVxLT5idWYsIGRldi0+Zml4ZWRfc2Vuc2UsIHNpemVvZihkZXYtPmZpeGVkX3NlbnNlKSk7Cisg
ICAgY2Rfc2NzaV9kZXZfc2Vuc2VfcmVzZXQoZGV2KTsgLyogY2xlYXIgcmVwb3J0ZWQgc2Vuc2Ug
Ki8KKworICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2LCByZXEpOworfQorCitzdGF0
aWMgdm9pZCBjZF9zY3NpX2NtZF9yZXBvcnRfbHVucyhDZFNjc2lUYXJnZXQgKnN0LCBDZFNjc2lM
VSAqZGV2LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ2RTY3NpUmVxdWVz
dCAqcmVxKQoreworICAgIHVpbnQ4X3QgKm91dF9idWYgPSByZXEtPmJ1ZjsKKyAgICB1aW50MzJf
dCBudW1fbHVucyA9IHN0LT5udW1fbHVuczsKKyAgICB1aW50MzJfdCBidWZsZW4gPSA4OyAvKiBo
ZWFkZXIgbGVuZ3RoICovCisgICAgdWludDMyX3QgbHVuOworCisgICAgcmVxLT5yZXFfbGVuID0g
c2NzaV9jZGJfeGZlcl9sZW5ndGgocmVxLT5jZGIsIDEyKTsKKyAgICByZXEtPnhmZXJfZGlyID0g
U0NTSV9YRkVSX0ZST01fREVWOworCisgICAgaWYgKHJlcS0+Y2RiWzBdID09IDB4MDEpIHsKKyAg
ICAgICAgLyogb25seSB3ZWxsIGtub3duIGxvZ2ljYWwgdW5pdHMgKi8KKyAgICAgICAgbnVtX2x1
bnMgPSAwOworICAgIH0KKworICAgIG91dF9idWZbMF0gPSAodWludDhfdCkobnVtX2x1bnMgPj4g
MjQpOworICAgIG91dF9idWZbMV0gPSAodWludDhfdCkobnVtX2x1bnMgPj4gMTYpOworICAgIG91
dF9idWZbMl0gPSAodWludDhfdCkobnVtX2x1bnMgPj4gOCk7CisgICAgb3V0X2J1ZlszXSA9ICh1
aW50OF90KShudW1fbHVucyk7CisgICAgbWVtc2V0KCZvdXRfYnVmWzRdLCAwLCA0KTsKKworICAg
IGlmIChudW1fbHVucyA+IDApIHsKKyAgICAgICAgZm9yIChsdW4gPSAwOyBsdW4gPCBudW1fbHVu
czsgbHVuKyspIHsKKyAgICAgICAgICAgIGlmIChzdC0+dW5pdHNbbHVuXS5yZWFsaXplZCkgewor
ICAgICAgICAgICAgICAgIG91dF9idWZbYnVmbGVuKytdID0gKHVpbnQ4X3QpKG51bV9sdW5zID4+
IDI0KTsKKyAgICAgICAgICAgICAgICBvdXRfYnVmW2J1ZmxlbisrXSA9ICh1aW50OF90KShudW1f
bHVucyA+PiAxNik7CisgICAgICAgICAgICAgICAgb3V0X2J1ZltidWZsZW4rK10gPSAodWludDhf
dCkobnVtX2x1bnMgPj4gOCk7CisgICAgICAgICAgICAgICAgb3V0X2J1ZltidWZsZW4rK10gPSAo
dWludDhfdCkobnVtX2x1bnMpOworICAgICAgICAgICAgICAgIG1lbXNldCgmb3V0X2J1ZltidWZs
ZW5dLCAwLCA0KTsKKyAgICAgICAgICAgICAgICBidWZsZW4gKz0gNDsKKyAgICAgICAgICAgIH0K
KyAgICAgICAgfQorICAgIH0KKworICAgIHJlcS0+aW5fbGVuID0gYnVmbGVuOworICAgIGNkX3Nj
c2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2LCByZXEpOworfQorCisjZGVmaW5lIFNDU0lfTUFYX0lO
UVVJUllfTEVOICAgICAgICAyNTYKKyNkZWZpbmUgU0NTSV9NQVhfTU9ERV9MRU4gICAgICAgICAg
IDI1NgorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9pbnF1aXJ5X3ZwZF9ub19sdW4oQ2RTY3Np
TFUgKmRldiwgQ2RTY3NpUmVxdWVzdCAqcmVxLAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHVpbnQzMl90IHBlcmlmX3F1YWwpCit7CisgICAgdWludDhfdCAqb3V0
YnVmID0gcmVxLT5idWY7CisgICAgdWludDhfdCBwYWdlX2NvZGUgPSByZXEtPmNkYlsyXTsKKyAg
ICB1aW50MzJfdCByZXNwX2xlbiA9IDQ7CisKKyAgICBvdXRidWZbMF0gPSAocGVyaWZfcXVhbCA8
PCA1KSB8IFRZUEVfUk9NOworICAgIG91dGJ1ZlsxXSA9IHBhZ2VfY29kZSA7IC8qIHRoaXMgcGFn
ZSAqLworICAgIG91dGJ1ZlsyXSA9IDB4MDA7IC8qIHBhZ2UgbGVuZ3RoIE1TQiAqLworICAgIG91
dGJ1ZlszXSA9IDB4MDA7IC8qIHBhZ2UgbGVuZ3RoIExTQiAtIG5vIG1vcmUgZGF0YSAqLworCisg
ICAgcmVxLT5pbl9sZW4gPSAocmVxLT5yZXFfbGVuIDwgcmVzcF9sZW4pID8gcmVxLT5yZXFfbGVu
IDogcmVzcF9sZW47CisKKyAgICBTUElDRV9ERUJVRygiaW5xdWlyeV92cGQsIHVuc3VwcG9ydGVk
IGx1bjolIiBHX0dVSU5UMzJfRk9STUFUCisgICAgICAgICAgICAgICAgIiBwZXJpZl9xdWFsOjB4
JXggcmVzcF9sZW46ICUiIEdfR1VJTlQ2NF9GT1JNQVQsCisgICAgICAgICAgICAgICAgcmVxLT5s
dW4sIHBlcmlmX3F1YWwsIHJlcS0+aW5fbGVuKTsKKworICAgIGNkX3Njc2lfY21kX2NvbXBsZXRl
X2dvb2QoZGV2LCByZXEpOworfQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9pbnF1aXJ5X3Zw
ZChDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgdWludDhfdCAqb3V0
YnVmID0gcmVxLT5idWY7CisgICAgdWludDhfdCBwYWdlX2NvZGUgPSByZXEtPmNkYlsyXTsKKyAg
ICBpbnQgYnVmbGVuID0gNDsKKyAgICBpbnQgc3RhcnQgPSA0OworCisgICAgb3V0YnVmWzBdID0g
VFlQRV9ST007CisgICAgb3V0YnVmWzFdID0gcGFnZV9jb2RlIDsgLyogdGhpcyBwYWdlICovCisg
ICAgb3V0YnVmWzJdID0gMHgwMDsgLyogcGFnZSBsZW5ndGggTVNCICovCisgICAgb3V0YnVmWzNd
ID0gMHgwMDsgLyogcGFnZSBsZW5ndGggTFNCLCB0byB3cml0ZSBsYXRlciAqLworCisgICAgc3dp
dGNoIChwYWdlX2NvZGUpIHsKKyAgICBjYXNlIDB4MDA6IC8qIFN1cHBvcnRlZCBwYWdlIGNvZGVz
LCBtYW5kYXRvcnkgKi8KKyAgICB7CisgICAgICAgIG91dGJ1ZltidWZsZW4rK10gPSAweDAwOyAv
LyBsaXN0IG9mIHN1cHBvcnRlZCBwYWdlcyAodGhpcyBwYWdlKQorICAgICAgICBpZiAoZGV2LT5z
ZXJpYWwpIHsKKyAgICAgICAgICAgIG91dGJ1ZltidWZsZW4rK10gPSAweDgwOyAvLyB1bml0IHNl
cmlhbCBudW1iZXIKKyAgICAgICAgfQorICAgICAgICBvdXRidWZbYnVmbGVuKytdID0gMHg4Mzsg
Ly8gZGV2aWNlIGlkZW50aWZpY2F0aW9uCisKKyAgICAgICAgU1BJQ0VfREVCVUcoIklucXVpcnkg
RVZQRFtTdXBwb3J0ZWQgcGFnZXNdIGx1bjolIiBHX0dVSU5UMzJfRk9STUFUCisgICAgICAgICAg
ICAgICAgICAgICIgcmVxX2xlbjogJSIgR19HVUlOVDY0X0ZPUk1BVCAiIHJlc3BfbGVuOiAlZCIs
CisgICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuLCByZXEtPnJlcV9sZW4sIGJ1Zmxlbik7Cisg
ICAgICAgIGJyZWFrOworICAgIH0KKyAgICBjYXNlIDB4ODA6IC8qIERldmljZSBzZXJpYWwgbnVt
YmVyLCBvcHRpb25hbCAqLworICAgIHsKKyAgICAgICAgaW50IHNlcmlhbF9sZW47CisKKyAgICAg
ICAgc2VyaWFsX2xlbiA9IHN0cmxlbihkZXYtPnNlcmlhbCk7CisgICAgICAgIGlmIChzZXJpYWxf
bGVuID4gMzYpIHsKKyAgICAgICAgICAgIHNlcmlhbF9sZW4gPSAzNjsKKyAgICAgICAgfQorICAg
ICAgICBtZW1jcHkob3V0YnVmK2J1ZmxlbiwgZGV2LT5zZXJpYWwsIHNlcmlhbF9sZW4pOworICAg
ICAgICBidWZsZW4gKz0gc2VyaWFsX2xlbjsKKworICAgICAgICBTUElDRV9ERUJVRygiSW5xdWly
eSBFVlBEW1NlcmlhbCBudW1dIGx1bjolIiBHX0dVSU5UMzJfRk9STUFUCisgICAgICAgICAgICAg
ICAgICAgICIgcmVxX2xlbjogJSIgR19HVUlOVDY0X0ZPUk1BVCAiIHJlc3BfbGVuOiAlZCIsCisg
ICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuLCByZXEtPnJlcV9sZW4sIGJ1Zmxlbik7CisgICAg
ICAgIGJyZWFrOworICAgIH0KKyAgICBjYXNlIDB4ODM6IC8qIERldmljZSBpZGVudGlmaWNhdGlv
biBwYWdlLCBtYW5kYXRvcnkgKi8KKyAgICB7CisgICAgICAgIGludCBzZXJpYWxfbGVuID0gc3Ry
bGVuKGRldi0+c2VyaWFsKTsKKyAgICAgICAgaW50IG1heF9sZW4gPSAyMDsKKworICAgICAgICBp
ZiAoc2VyaWFsX2xlbiA+IG1heF9sZW4pIHsKKyAgICAgICAgICAgIHNlcmlhbF9sZW4gPSBtYXhf
bGVuOworICAgICAgICB9CisKKyAgICAgICAgb3V0YnVmW2J1ZmxlbisrXSA9IDB4MjsgLy8gQVND
SUkKKyAgICAgICAgb3V0YnVmW2J1ZmxlbisrXSA9IDA7ICAgLy8gbm90IG9mZmljaWFsbHkgYXNz
aWduZWQKKyAgICAgICAgb3V0YnVmW2J1ZmxlbisrXSA9IDA7ICAgLy8gcmVzZXJ2ZWQKKyAgICAg
ICAgb3V0YnVmW2J1ZmxlbisrXSA9IHNlcmlhbF9sZW47IC8vIGxlbmd0aCBvZiBkYXRhIGZvbGxv
d2luZworCisgICAgICAgIG1lbWNweShvdXRidWYrYnVmbGVuLCBkZXYtPnNlcmlhbCwgc2VyaWFs
X2xlbik7CisgICAgICAgIGJ1ZmxlbiArPSBzZXJpYWxfbGVuOworCisgICAgICAgIFNQSUNFX0RF
QlVHKCJJbnF1aXJ5IEVWUERbRGV2aWNlIGlkXSBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVAorICAg
ICAgICAgICAgICAgICAgICAiIHJlcV9sZW46ICUiIEdfR1VJTlQ2NF9GT1JNQVQgIiByZXNwX2xl
bjogJWQiLAorICAgICAgICAgICAgICAgICAgICByZXEtPmx1biwgcmVxLT5yZXFfbGVuLCBidWZs
ZW4pOworICAgICAgICBicmVhazsKKyAgICB9CisKKyAgICBkZWZhdWx0OgorICAgICAgICBjZF9z
Y3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZBTElE
X0NEQl9GSUVMRCk7CisgICAgICAgIFNQSUNFX0RFQlVHKCJpbnF1aXJ5X3N0YW5kYXJkLCBsdW46
JSIgR19HVUlOVDMyX0ZPUk1BVCAiIGludmFsaWQgcGFnZV9jb2RlOiAlMDJ4IiwKKyAgICAgICAg
ICAgICAgICAgICAgcmVxLT5sdW4sIChpbnQpcGFnZV9jb2RlKTsKKyAgICAgICAgcmV0dXJuOwor
ICAgIH0KKworICAgIC8qIGRvbmUgd2l0aCBFVlBEICovCisgICAgZ19hc3NlcnQoYnVmbGVuIC0g
c3RhcnQgPD0gMjU1KTsKKyAgICBvdXRidWZbM10gPSBidWZsZW4gLSBzdGFydDsgLyogcGFnZSBs
ZW5ndGggTFNCICovCisKKyAgICByZXEtPmluX2xlbiA9IGJ1ZmxlbjsKKyAgICBjZF9zY3NpX2Nt
ZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworI2RlZmluZSBJTlFVSVJZX1NUQU5EQVJE
X0xFTl9NSU4gICAgICAgICAgICAzNgorI2RlZmluZSBJTlFVSVJZX1NUQU5EQVJEX0xFTiAgICAg
ICAgICAgICAgICA5NgorI2RlZmluZSBJTlFVSVJZX1NUQU5EQVJEX0xFTl9OT19WRVIgICAgICAg
ICA1NworCisjZGVmaW5lIFBFUklGX1FVQUxJRklFUl9DT05ORUNURUQgICAgICAgICAgIDB4MDAK
KyNkZWZpbmUgUEVSSUZfUVVBTElGSUVSX05PVF9DT05ORUNURUQgICAgICAgMHgwMQorI2RlZmlu
ZSBQRVJJRl9RVUFMSUZJRVJfVU5TVVBQT1JURUQgICAgICAgICAweDAzCisKKyNkZWZpbmUgSU5R
VUlSWV9SRU1PVkFCTEVfTUVESVVNICAgICAgICAgICAgMHg4MAorCisjZGVmaW5lIElOUVVJUllf
VkVSU0lPTl9OT05FICAgICAgICAgICAgICAgIDB4MDAKKyNkZWZpbmUgSU5RVUlSWV9WRVJTSU9O
X1NQQzMgICAgICAgICAgICAgICAgMHgwNQorCisvKiBieXRlIDMgKi8KKyNkZWZpbmUgSU5RVUlS
WV9SRVNQX0hJU1VQICAgICAgICAgICAgICAgICAgKDB4MDEgPDwgNCkKKyNkZWZpbmUgSU5RVUlS
WV9SRVNQX05PUk1fQUNBICAgICAgICAgICAgICAgKDB4MDEgPDwgNSkKKyNkZWZpbmUgSU5RVUlS
WV9SRVNQX0RBVEFfRk9STUFUX1NQQzMgICAgICAgMHgwMgorCisjZGVmaW5lIElOUVVJUllfVkVS
U0lPTl9ERVNDX1NBTTIgICAgICAgICAgIDB4MDQwCisjZGVmaW5lIElOUVVJUllfVkVSU0lPTl9E
RVNDX1NQQzMgICAgICAgICAgIDB4MzAwCisjZGVmaW5lIElOUVVJUllfVkVSU0lPTl9ERVNDX01N
QzMgICAgICAgICAgIDB4MkEwCisjZGVmaW5lIElOUVVJUllfVkVSU0lPTl9ERVNDX1NCQzIgICAg
ICAgICAgIDB4MzIwCisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX2lucXVpcnlfc3RhbmRhcmRf
bm9fbHVuKENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSwKKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IHBlcmlmX3F1YWwpCit7
CisgICAgdWludDhfdCAqb3V0YnVmID0gcmVxLT5idWY7CisgICAgdWludDMyX3QgcmVzcF9sZW4g
PSBJTlFVSVJZX1NUQU5EQVJEX0xFTl9NSU47CisKKyAgICBtZW1zZXQocmVxLT5idWYsIDAsIElO
UVVJUllfU1RBTkRBUkRfTEVOX01JTik7CisKKyAgICBvdXRidWZbMF0gPSAocGVyaWZfcXVhbCA8
PCA1KSB8IFRZUEVfUk9NOworICAgIG91dGJ1ZlsyXSA9IElOUVVJUllfVkVSU0lPTl9OT05FOwor
ICAgIG91dGJ1ZlszXSA9IElOUVVJUllfUkVTUF9EQVRBX0ZPUk1BVF9TUEMzOworCisgICAgb3V0
YnVmWzRdID0gcmVzcF9sZW4gLSA0OyAvKiBhZGRpdGlvbmFsIGxlbmd0aCwgYWZ0ZXIgaGVhZGVy
ICovCisKKyAgICByZXEtPmluX2xlbiA9IChyZXEtPnJlcV9sZW4gPCByZXNwX2xlbikgPyByZXEt
PnJlcV9sZW4gOiByZXNwX2xlbjsKKworICAgIFNQSUNFX0RFQlVHKCJpbnF1aXJ5X3N0YW5kYXJk
LCB1bnN1cHBvcnRlZCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCAiIHBlcmlmX3F1YWw6MHgleCAi
CisgICAgICAgICAgICAgICAgImlucXVpcnlfbGVuOiAlIiBHX0dVSU5UMzJfRk9STUFUICIgcmVz
cF9sZW46ICUiIEdfR1VJTlQ2NF9GT1JNQVQsCisgICAgICAgICAgICAgICAgcmVxLT5sdW4sIHBl
cmlmX3F1YWwsIHJlc3BfbGVuLCByZXEtPmluX2xlbik7CisKKyAgICBjZF9zY3NpX2NtZF9jb21w
bGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRfaW5xdWly
eV9zdGFuZGFyZChDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgdWlu
dDhfdCAqb3V0YnVmID0gcmVxLT5idWY7CisgICAgdWludDMyX3QgcmVzcF9sZW4gPQorICAgICAg
ICAoZGV2LT5jbGFpbV92ZXJzaW9uID09IDApID8gSU5RVUlSWV9TVEFOREFSRF9MRU5fTk9fVkVS
IDogSU5RVUlSWV9TVEFOREFSRF9MRU47CisKKyAgICBvdXRidWZbMF0gPSAoUEVSSUZfUVVBTElG
SUVSX0NPTk5FQ1RFRCA8PCA1KSB8IFRZUEVfUk9NOworICAgIG91dGJ1ZlsxXSA9IChkZXYtPnJl
bW92YWJsZSkgPyBJTlFVSVJZX1JFTU9WQUJMRV9NRURJVU0gOiAwOworICAgIG91dGJ1ZlsyXSA9
IChkZXYtPmNsYWltX3ZlcnNpb24gPT0gMCkgPyBJTlFVSVJZX1ZFUlNJT05fTk9ORSA6IElOUVVJ
UllfVkVSU0lPTl9TUEMzOworICAgIG91dGJ1ZlszXSA9IElOUVVJUllfUkVTUF9OT1JNX0FDQSB8
IElOUVVJUllfUkVTUF9ISVNVUCB8IElOUVVJUllfUkVTUF9EQVRBX0ZPUk1BVF9TUEMzOworCisg
ICAgb3V0YnVmWzRdID0gcmVzcF9sZW4gLSA0OyAvKiBhZGRpdGlvbmFsIGxlbmd0aCwgYWZ0ZXIg
aGVhZGVyICovCisKKyAgICAvKiAob3V0YnVmWzYsN10gPSAwKSBtZWFucyBhbHNvIHtCUXVlPTAs
Q21kUXVlPTB9IC0gbm8gcXVldWVpbmcgYXQgYWxsICovCisKKyAgICBzdHJwYWRjcHkoKGNoYXIg
KikgJm91dGJ1Zls4XSwgOCwgZGV2LT52ZW5kb3IsICcgJyk7CisgICAgc3RycGFkY3B5KChjaGFy
ICopICZvdXRidWZbMTZdLCAxNiwgZGV2LT5wcm9kdWN0LCAnICcpOworICAgIG1lbWNweSgmb3V0
YnVmWzMyXSwgZGV2LT52ZXJzaW9uLCBNSU4oNCwgc3RybGVuKGRldi0+dmVyc2lvbikpKTsKKwor
ICAgIGlmIChkZXYtPmNsYWltX3ZlcnNpb24gPiAwKSB7CisgICAgICAgIC8qIG5vdyBzdXBwb3J0
aW5nIG9ubHkgMyAqLworICAgICAgICBvdXRidWZbNThdID0gKElOUVVJUllfVkVSU0lPTl9ERVND
X1NBTTIgPj4gOCkgJiAweGZmOworICAgICAgICBvdXRidWZbNTldID0gSU5RVUlSWV9WRVJTSU9O
X0RFU0NfU0FNMiAmIDB4ZmY7CisKKyAgICAgICAgb3V0YnVmWzYwXSA9IChJTlFVSVJZX1ZFUlNJ
T05fREVTQ19TUEMzID4+IDgpICYgMHhmZjsKKyAgICAgICAgb3V0YnVmWzYxXSA9IElOUVVJUllf
VkVSU0lPTl9ERVNDX1NQQzMgJiAweGZmOworCisgICAgICAgIG91dGJ1Zls2Ml0gPSAoSU5RVUlS
WV9WRVJTSU9OX0RFU0NfTU1DMyA+PiA4KSAmIDB4ZmY7CisgICAgICAgIG91dGJ1Zls2M10gPSBJ
TlFVSVJZX1ZFUlNJT05fREVTQ19NTUMzICYgMHhmZjsKKworICAgICAgICBvdXRidWZbNjRdID0g
KElOUVVJUllfVkVSU0lPTl9ERVNDX1NCQzIgPj4gOCkgJiAweGZmOworICAgICAgICBvdXRidWZb
NjVdID0gSU5RVUlSWV9WRVJTSU9OX0RFU0NfU0JDMiAmIDB4ZmY7CisgICAgfQorCisgICAgcmVx
LT5pbl9sZW4gPSAocmVxLT5yZXFfbGVuIDwgcmVzcF9sZW4pID8gcmVxLT5yZXFfbGVuIDogcmVz
cF9sZW47CisKKyAgICBTUElDRV9ERUJVRygiaW5xdWlyeV9zdGFuZGFyZCwgbHVuOiUiIEdfR1VJ
TlQzMl9GT1JNQVQKKyAgICAgICAgICAgICAgICAiIGlucXVpcnlfbGVuOiAlIiBHX0dVSU5UMzJf
Rk9STUFUICIgcmVzcF9sZW46ICUiIEdfR1VJTlQ2NF9GT1JNQVQsCisgICAgICAgICAgICAgICAg
cmVxLT5sdW4sIHJlc3BfbGVuLCByZXEtPmluX2xlbik7CisKKyAgICBjZF9zY3NpX2NtZF9jb21w
bGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworI2RlZmluZSBDRF9JTlFVSVJZX0ZMQUdfRVZQRCAg
ICAgICAgICAgICAgICAweDAxCisjZGVmaW5lIENEX0lOUVVJUllfRkxBR19DTURfRFQgICAgICAg
ICAgICAgIDB4MDIKKworc3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRfaW5xdWlyeShDZFNjc2lMVSAq
ZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgZ2Jvb2xlYW4gZXZwZCwgY21kX2RhdGE7
CisKKyAgICByZXEtPnhmZXJfZGlyID0gU0NTSV9YRkVSX0ZST01fREVWOworCisgICAgZXZwZCA9
IChyZXEtPmNkYlsxXSAmIENEX0lOUVVJUllfRkxBR19FVlBEKSA/IFRSVUUgOiBGQUxTRTsKKyAg
ICBjbWRfZGF0YSA9IChyZXEtPmNkYlsxXSAmIENEX0lOUVVJUllfRkxBR19DTURfRFQpID8gVFJV
RSA6IEZBTFNFOworCisgICAgaWYgKGNtZF9kYXRhKSB7CisgICAgICAgIFNQSUNFX0RFQlVHKCJp
bnF1aXJ5LCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCAiIENtZERUIGJpdCBzZXQgLSB1bnN1cHBv
cnRlZCwgIgorICAgICAgICAgICAgICAgICAgICAiY2RiWzFdOjB4JTAyeCBjZGJbMV06MHglMDJ4
IiwKKyAgICAgICAgICAgICAgICAgICAgcmVxLT5sdW4sIChpbnQpcmVxLT5jZGJbMV0sIChpbnQp
cmVxLT5jZGJbMl0pOworICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRl
diwgcmVxLCAmc2Vuc2VfY29kZV9JTlZBTElEX0NEQl9GSUVMRCk7CisgICAgICAgIHJldHVybjsK
KyAgICB9CisKKyAgICByZXEtPnJlcV9sZW4gPSByZXEtPmNkYls0XSB8IChyZXEtPmNkYlszXSA8
PCA4KTsKKyAgICBtZW1zZXQocmVxLT5idWYsIDAsIHJlcS0+cmVxX2xlbik7CisKKyAgICBpZiAo
ZXZwZCkgeyAvKiBlbmFibGUgdml0YWwgcHJvZHVjdCBkYXRhICovCisgICAgICAgIGNkX3Njc2lf
Y21kX2lucXVpcnlfdnBkKGRldiwgcmVxKTsKKyAgICB9IGVsc2UgeyAvKiBzdGFuZGFyZCBpbnF1
aXJ5IGRhdGEgKi8KKyAgICAgICAgaWYgKHJlcS0+Y2RiWzJdICE9IDApIHsKKyAgICAgICAgICAg
IFNQSUNFX0RFQlVHKCJpbnF1aXJ5X3N0YW5kYXJkLCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCAi
IG5vbi16ZXJvIHBhZ2UgY29kZTogJTAyeCIsCisgICAgICAgICAgICAgICAgICAgICAgICByZXEt
Pmx1biwgKGludClyZXEtPmNkYlsyXSk7CisgICAgICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0
ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZBTElEX0NEQl9GSUVMRCk7Cisg
ICAgICAgICAgICByZXR1cm47CisgICAgICAgIH0KKyAgICAgICAgY2Rfc2NzaV9jbWRfaW5xdWly
eV9zdGFuZGFyZChkZXYsIHJlcSk7CisgICAgfQorfQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2Nt
ZF9yZWFkX2NhcGFjaXR5KENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAg
ICB1aW50MzJfdCBsYXN0X2JsayA9IGRldi0+bnVtX2Jsb2NrcyAtIDE7CisgICAgdWludDMyX3Qg
YmxrX3NpemUgPSBkZXYtPmJsb2NrX3NpemU7CisgICAgdWludDMyX3QgKmxhc3RfYmxrX291dCA9
ICh1aW50MzJfdCAqKXJlcS0+YnVmOworICAgIHVpbnQzMl90ICpibGtfc2l6ZV9vdXQgPSAodWlu
dDMyX3QgKikocmVxLT5idWYgKyA0KTsKKworICAgIHJlcS0+eGZlcl9kaXIgPSBTQ1NJX1hGRVJf
RlJPTV9ERVY7CisgICAgcmVxLT5yZXFfbGVuID0gODsKKworICAgICpsYXN0X2Jsa19vdXQgPSBo
dG9iZTMyKGxhc3RfYmxrKTsKKyAgICAqYmxrX3NpemVfb3V0ID0gaHRvYmUzMihibGtfc2l6ZSk7
CisKKyAgICBTUElDRV9ERUJVRygiUmVhZCBjYXBhY2l0eSwgbHVuOiUiIEdfR1VJTlQzMl9GT1JN
QVQKKyAgICAgICAgICAgICAgICAiIGxhc3RfYmxrOiAlIiBHX0dVSU5UMzJfRk9STUFUICIgYmxr
X3N6OiAlIiBHX0dVSU5UMzJfRk9STUFULAorICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBsYXN0
X2JsaywgYmxrX3NpemUpOworCisgICAgcmVxLT5pbl9sZW4gPSA4OworICAgIGNkX3Njc2lfY21k
X2NvbXBsZXRlX2dvb2QoZGV2LCByZXEpOworfQorCisjZGVmaW5lIFJESV9UWVBFX1NUQU5EQVJE
ICAgICAgICAgICAwIC8qIFN0YW5kYXJkIERpc2MgSW5mb3JtYXRpb24gKi8KKyNkZWZpbmUgUkRJ
X1RZUEVfVFJBQ0tfUkVTT1VSQ0VTICAgIDEgLyogVHJhY2sgUmVzb3VyY2VzIEluZm9ybWF0aW9u
ICovCisjZGVmaW5lIFJESV9UWVBFX1BPV19SRVNPVVJDRVMgICAgICAyIC8qIFBPVyBSZXNvdXJj
ZXMgSW5mb3JtYXRpb24gKi8KKworI2RlZmluZSBSRElfU1RBTkRBUkRfTEVOICAgICAgICAgICAg
MzQKKworI2RlZmluZSBSRElfRVJBWkFCTEUgICAgICAgICAgICAgICAgKDB4MDEgPDwgNCkKKyNk
ZWZpbmUgUkRJX05PTl9FUkFaQUJMRSAgICAgICAgICAgICgweDAwIDw8IDQpCisKKyNkZWZpbmUg
UkRJX1NFU1NJT05fRU1QVFkgICAgICAgICAgICgweDAwIDw8IDIpCisjZGVmaW5lIFJESV9TRVNT
SU9OX0lOQ09NUExFVEUgICAgICAoMHgwMSA8PCAyKQorI2RlZmluZSBSRElfU0VTU0lPTl9EQU1B
R0VEICAgICAgICAgKDB4MDIgPDwgMikKKyNkZWZpbmUgUkRJX1NFU1NJT05fQ09NUExFVEUgICAg
ICAgICgweDAzIDw8IDIpCisKKyNkZWZpbmUgUkRJX0RJU0NfRU1QVFkgICAgICAgICAgICAgIDB4
MDAKKyNkZWZpbmUgUkRJX0RJU0NfSU5DT01QTEVURSAgICAgICAgIDB4MDEKKyNkZWZpbmUgUkRJ
X0RJU0NfQ09NUExFVEUgICAgICAgICAgIDB4MDIKKyNkZWZpbmUgUkRJX0RJU0NfUkFORE9NX1dS
ICAgICAgICAgIDB4MDMKKworI2RlZmluZSBSRElfRElTQ19QTUFfVFlQRV9DRF9ST00gICAgMHgw
MAorI2RlZmluZSBSRElfRElTQ19QTUFfVFlQRV9DREkgICAgICAgMHgxMAorI2RlZmluZSBSRElf
RElTQ19QTUFfVFlQRV9ERENEICAgICAgMHgyMAorI2RlZmluZSBSRElfRElTQ19QTUFfVFlQRV9V
TkRFRklORUQgMHhGRgorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9nZXRfcmVhZF9kaXNjX2lu
Zm9ybWF0aW9uKENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICB1aW50
OF90ICpvdXRidWYgPSByZXEtPmJ1ZjsKKyAgICB1aW50MzJfdCBkYXRhX3R5cGU7CisgICAgdWlu
dDMyX3QgZmlyc3RfdHJhY2sgPSAxOworICAgIHVpbnQzMl90IGxhc3RfdHJhY2sgPSAxOworICAg
IHVpbnQzMl90IG51bV9zZXNzaW9ucyA9IDE7CisKKyAgICByZXEtPnhmZXJfZGlyID0gU0NTSV9Y
RkVSX0ZST01fREVWOworCisgICAgZGF0YV90eXBlID0gcmVxLT5jZGJbMV0gJiAweDc7CisgICAg
aWYgKGRhdGFfdHlwZSAhPSBSRElfVFlQRV9TVEFOREFSRCkgeworICAgICAgICBTUElDRV9ERUJV
RygicmVhZF9kaXNjX2luZm9ybWF0aW9uLCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVAorICAgICAg
ICAgICAgICAgICAgICAiIHVuc3VwcG9ydGVkIGRhdGEgdHlwZTogJTAyeCIsCisgICAgICAgICAg
ICAgICAgICAgIHJlcS0+bHVuLCBkYXRhX3R5cGUpOworICAgICAgICBjZF9zY3NpX2NtZF9jb21w
bGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZBTElEX0NEQl9GSUVMRCk7
CisgICAgICAgIHJldHVybjsKKyAgICB9CisKKyAgICByZXEtPnJlcV9sZW4gPSAocmVxLT5jZGJb
N10gPDwgOCkgfCByZXEtPmNkYls4XTsKKyAgICByZXEtPmluX2xlbiA9IChyZXEtPnJlcV9sZW4g
PCBSRElfU1RBTkRBUkRfTEVOKSA/IHJlcS0+cmVxX2xlbiA6IFJESV9TVEFOREFSRF9MRU47CisK
KyAgICBtZW1zZXQob3V0YnVmLCAwLCBSRElfU1RBTkRBUkRfTEVOKTsKKyAgICBvdXRidWZbMV0g
PSBSRElfU1RBTkRBUkRfTEVOIC0gMjsgLyogbGVuZ3RoIGV4Y2x1ZGluZyB0aGUgY291bnRlciBp
dHNlbGYgKi8KKyAgICBvdXRidWZbMl0gPSBSRElfTk9OX0VSQVpBQkxFIHwgUkRJX1NFU1NJT05f
Q09NUExFVEUgfCBSRElfRElTQ19DT01QTEVURTsKKyAgICBvdXRidWZbM10gPSBmaXJzdF90cmFj
azsgLyogb24gZGlzayAqLworICAgIG91dGJ1Zls0XSA9IG51bV9zZXNzaW9ucyAmIDB4ZmY7IC8q
IGxzYiAqLworICAgIG91dGJ1Zls1XSA9IGZpcnN0X3RyYWNrICYgMHhmZjsgLyogaW4gbGFzdCBz
ZXNzb24sIGxzYiAqLworICAgIG91dGJ1Zls2XSA9IGxhc3RfdHJhY2sgJiAweGZmOyAvKiBpbiBs
YXN0IHNlc3NvbiwgbHNiICovCisgICAgb3V0YnVmWzhdID0gUkRJX0RJU0NfUE1BX1RZUEVfQ0Rf
Uk9NOworICAgIG91dGJ1Zls5XSA9IChudW1fc2Vzc2lvbnMgPj4gOCkgJiAweGZmOyAvKiBtc2Ig
Ki8KKyAgICBvdXRidWZbMTBdID0gKGZpcnN0X3RyYWNrID4+IDgpICYgMHhmZjsgLyogaW4gbGFz
dCBzZXNzb24sIGxzYiAqLworICAgIG91dGJ1ZlsxMV0gPSAobGFzdF90cmFjayA+PiA4KSAmIDB4
ZmY7IC8qIGluIGxhc3Qgc2Vzc29uLCBsc2IgKi8KKworICAgIFNQSUNFX0RFQlVHKCJyZWFkX2Rp
c2NfaW5mb3JtYXRpb24sIGx1bjolIiBHX0dVSU5UMzJfRk9STUFUICIgbGVuOiAlIiBHX0dVSU5U
NjRfRk9STUFULAorICAgICAgICAgICAgICAgIHJlcS0+bHVuLCByZXEtPmluX2xlbik7CisKKyAg
ICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworI2RlZmluZSBSVElf
QUREUl9UWVBFX0xCQSAgICAgICAgICAgMHgwMAorI2RlZmluZSBSVElfQUREUl9UWVBFX1RSQUNL
X05VTSAgICAgMHgwMQorI2RlZmluZSBSVElfQUREUl9UWVBFX1NFU1NJT05fTlVNICAgMHgwMgor
CisjZGVmaW5lIFJUSV9UUkFDS19OVU1fTEVBRF9JTiAgICAgICAweDAwCisjZGVmaW5lIFJUSV9U
UkFDS19OVU1fSU5WSVNJQkxFICAgICAweGZmCisKKyNkZWZpbmUgVElCX0xFTiAgICAgICAgICAg
ICAgICAgICAgIDB4MzYKKworI2RlZmluZSBUSUJfVFJBQ0tfTU9ERV9DRCAgICAgICAgICAgMHgw
NAorI2RlZmluZSBUSUJfREFUQV9NT0RFX0lTT18xMDE0OSAgICAgMHgwMQorCisjZGVmaW5lIFRJ
Ql9MUkFfVkFMSUQgICAgICAgICAgICAgICAoMHgwMSA8PCAxKQorCitzdGF0aWMgdm9pZCBjZF9z
Y3NpX2NtZF9nZXRfcmVhZF90cmFja19pbmZvcm1hdGlvbihDZFNjc2lMVSAqZGV2LCBDZFNjc2lS
ZXF1ZXN0ICpyZXEpCit7CisgICAgdWludDhfdCAqb3V0YnVmID0gcmVxLT5idWY7CisgICAgdWlu
dDMyX3QgdHJhY2tfc2l6ZSA9IGRldi0+bnVtX2Jsb2NrczsKKyAgICB1aW50MzJfdCBsYXN0X2Fk
ZHIgPSB0cmFja19zaXplIC0gMTsKKyAgICB1aW50MzJfdCB0cmFja19udW0gPSAxOworICAgIHVp
bnQzMl90IHNlc3Npb25fbnVtID0gMTsKKyAgICB1aW50MzJfdCBhZGRyX3R5cGU7CisgICAgdWlu
dDMyX3QgYWRkcl9udW07CisKKyAgICByZXEtPnhmZXJfZGlyID0gU0NTSV9YRkVSX0ZST01fREVW
OworCisgICAgYWRkcl90eXBlID0gcmVxLT5jZGJbMV0gJiAweDM7CisgICAgYWRkcl9udW0gPSAo
cmVxLT5jZGJbMl0gPDwgMjQpIHwgKHJlcS0+Y2RiWzNdIDw8IDE2KSB8CisgICAgICAgICAgICAg
ICAocmVxLT5jZGJbNF0gPDwgOCkgfCByZXEtPmNkYls1XTsKKworICAgIHN3aXRjaCAoYWRkcl90
eXBlKSB7CisgICAgY2FzZSBSVElfQUREUl9UWVBFX0xCQToKKyAgICAgICAgaWYgKGFkZHJfbnVt
ID4gbGFzdF9hZGRyKSB7CisgICAgICAgICAgICBTUElDRV9ERUJVRygicmVhZF90cmFja19pbmZv
cm1hdGlvbiwgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQKKyAgICAgICAgICAgICAgICAgICAgICAg
ICIgYWRkcl90eXBlIExCQTogJSIgR19HVUlOVDMyX0ZPUk1BVAorICAgICAgICAgICAgICAgICAg
ICAgICAgIiBpbnZhbGlkIExCQTogJSIgR19HVUlOVDMyX0ZPUk1BVCwKKyAgICAgICAgICAgICAg
ICAgICAgICAgIHJlcS0+bHVuLCBhZGRyX3R5cGUsIGFkZHJfbnVtKTsKKyAgICAgICAgICAgIGNk
X3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX0lOVkFM
SURfQ0RCX0ZJRUxEKTsKKyAgICAgICAgICAgIHJldHVybjsKKyAgICAgICAgfQorICAgICAgICBi
cmVhazsKKyAgICBjYXNlIFJUSV9BRERSX1RZUEVfVFJBQ0tfTlVNOgorICAgICAgICBpZiAoYWRk
cl9udW0gIT0gdHJhY2tfbnVtKSB7CisgICAgICAgICAgICBTUElDRV9ERUJVRygicmVhZF90cmFj
a19pbmZvcm1hdGlvbiwgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQKKyAgICAgICAgICAgICAgICAg
ICAgICAgICIgYWRkcl90eXBlIHRyYWNrOiAlIiBHX0dVSU5UMzJfRk9STUFUCisgICAgICAgICAg
ICAgICAgICAgICAgICAiIGludmFsaWQgdHJhY2s6ICUiIEdfR1VJTlQzMl9GT1JNQVQsCisgICAg
ICAgICAgICAgICAgICAgICAgICByZXEtPmx1biwgYWRkcl90eXBlLCBhZGRyX251bSk7CisgICAg
ICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2Vf
Y29kZV9JTlZBTElEX0NEQl9GSUVMRCk7CisgICAgICAgICAgICByZXR1cm47CisgICAgICAgIH0K
KyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBSVElfQUREUl9UWVBFX1NFU1NJT05fTlVNOgorICAg
ICAgICBpZiAoYWRkcl9udW0gIT0gc2Vzc2lvbl9udW0pIHsKKyAgICAgICAgICAgIFNQSUNFX0RF
QlVHKCJyZWFkX3RyYWNrX2luZm9ybWF0aW9uLCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVAorICAg
ICAgICAgICAgICAgICAgICAgICAgIiBhZGRyX3R5cGUgc2Vzc2lvbjogJSIgR19HVUlOVDMyX0ZP
Uk1BVAorICAgICAgICAgICAgICAgICAgICAgICAgIiBpbnZhbGlkIHNlc3Npb246ICUiIEdfR1VJ
TlQzMl9GT1JNQVQsCisgICAgICAgICAgICAgICAgICAgICAgICByZXEtPmx1biwgYWRkcl90eXBl
LCBhZGRyX251bSk7CisgICAgICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25k
KGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZBTElEX0NEQl9GSUVMRCk7CisgICAgICAgICAgICBy
ZXR1cm47CisgICAgICAgIH0KKyAgICAgICAgYnJlYWs7CisgICAgZGVmYXVsdDoKKyAgICAgICAg
U1BJQ0VfREVCVUcoInJlYWRfdHJhY2tfaW5mb3JtYXRpb24sIGx1bjolIiBHX0dVSU5UMzJfRk9S
TUFUCisgICAgICAgICAgICAgICAgICAgICJpbnZhbGlkIGFkZHJfdHlwZTogJSIgR19HVUlOVDMy
X0ZPUk1BVAorICAgICAgICAgICAgICAgICAgICAiIGFkZHJfbnVtOiAlIiBHX0dVSU5UMzJfRk9S
TUFULAorICAgICAgICAgICAgICAgICAgICByZXEtPmx1biwgYWRkcl90eXBlLCBhZGRyX251bSk7
CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5z
ZV9jb2RlX0lOVkFMSURfQ0RCX0ZJRUxEKTsKKyAgICAgICAgcmV0dXJuOworICAgIH0KKworICAg
IHJlcS0+cmVxX2xlbiA9IChyZXEtPmNkYls3XSA8PCA4KSB8IHJlcS0+Y2RiWzhdOworICAgIHJl
cS0+aW5fbGVuID0gKHJlcS0+cmVxX2xlbiA8IFRJQl9MRU4pID8gcmVxLT5yZXFfbGVuIDogVElC
X0xFTjsKKworICAgIG1lbXNldChvdXRidWYsIDAsIFRJQl9MRU4pOworICAgIG91dGJ1ZlsxXSA9
IFRJQl9MRU4gLSAyOworICAgIG91dGJ1ZlsyXSA9IHNlc3Npb25fbnVtOworICAgIG91dGJ1Zlsz
XSA9IHRyYWNrX251bTsKKyAgICBvdXRidWZbNV0gPSBUSUJfVFJBQ0tfTU9ERV9DRCAmIDB4MGY7
CisgICAgb3V0YnVmWzZdID0gVElCX0RBVEFfTU9ERV9JU09fMTAxNDkgJiAweDBmOworICAgIG91
dGJ1Zls3XSA9IFRJQl9MUkFfVkFMSUQ7CisKKyAgICAvKiBUcmFjayBzaXplICovCisgICAgb3V0
YnVmWzI0XSA9ICh0cmFja19zaXplID4+IDI0KSAmIDB4ZmY7CisgICAgb3V0YnVmWzI1XSA9ICh0
cmFja19zaXplID4+IDE2KSAmIDB4ZmY7CisgICAgb3V0YnVmWzI2XSA9ICh0cmFja19zaXplID4+
IDgpICYgMHhmZjsKKyAgICBvdXRidWZbMjddID0gKHRyYWNrX3NpemUpICYgMHhmZjsKKworICAg
IC8qIExhc3QgcmVjb3JkZWQgYWRkcmVzcyAqLworICAgIG91dGJ1ZlsyOF0gPSAobGFzdF9hZGRy
ID4+IDI0KSAmIDB4ZmY7CisgICAgb3V0YnVmWzI5XSA9IChsYXN0X2FkZHIgPj4gMTYpICYgMHhm
ZjsKKyAgICBvdXRidWZbMzBdID0gKGxhc3RfYWRkciA+PiA4KSAmIDB4ZmY7CisgICAgb3V0YnVm
WzMxXSA9IChsYXN0X2FkZHIpICYgMHhmZjsKKworICAgIFNQSUNFX0RFQlVHKCJyZWFkX3RyYWNr
X2luZm9ybWF0aW9uLCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVAorICAgICAgICAgICAgICAgICJh
ZGRyX3R5cGU6ICUiIEdfR1VJTlQzMl9GT1JNQVQgIiBhZGRyX251bTogJSIgR19HVUlOVDMyX0ZP
Uk1BVCwKKyAgICAgICAgICAgICAgICByZXEtPmx1biwgYWRkcl90eXBlLCBhZGRyX251bSk7CisK
KyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworI2RlZmluZSBS
RUFEX1RPQ19UUkFDS19ERVNDX0xFTiAgICAgOAorI2RlZmluZSBSRUFEX1RPQ19SRVNQX0xFTiAg
ICAgICAgICAgKDQgKyAyKlJFQURfVE9DX1RSQUNLX0RFU0NfTEVOKQorCitzdGF0aWMgdm9pZCBj
ZF9zY3NpX2NtZF9yZWFkX3RvYyhDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7
CisgICAgdWludDhfdCAqb3V0YnVmID0gcmVxLT5idWY7CisgICAgdWludDMyX3QgbXNmLCBmb3Jt
YXQsIHRyYWNrX251bTsKKyAgICB1aW50MzJfdCBsYXN0X2JsayA9IGRldi0+bnVtX2Jsb2NrcyAt
IDE7CisKKyAgICByZXEtPnhmZXJfZGlyID0gU0NTSV9YRkVSX0ZST01fREVWOworCisgICAgbXNm
ID0gKHJlcS0+Y2RiWzFdID4+IDEpICYgMHgxOworICAgIGZvcm1hdCA9IHJlcS0+Y2RiWzJdICYg
MHhmOworICAgIHRyYWNrX251bSA9IHJlcS0+Y2RiWzZdOworCisgICAgcmVxLT5yZXFfbGVuID0g
KHJlcS0+Y2RiWzddIDw8IDgpIHwgcmVxLT5jZGJbOF07CisgICAgcmVxLT5pbl9sZW4gPSAocmVx
LT5yZXFfbGVuIDwgUkVBRF9UT0NfUkVTUF9MRU4pID8gcmVxLT5yZXFfbGVuIDogUkVBRF9UT0Nf
UkVTUF9MRU47CisKKyAgICBtZW1zZXQob3V0YnVmLCAwLCBSRUFEX1RPQ19SRVNQX0xFTik7Cisg
ICAgb3V0YnVmWzFdID0gUkVBRF9UT0NfUkVTUF9MRU4gLSAyOyAvKiBsZW5ndGggZXhjbHVkaW5n
IHRoZSBjb3VudGVyIGl0c2VsZiAqLworICAgIG91dGJ1ZlsyXSA9IDE7IC8qIGZpcnN0IHRyYWNr
L3Nlc3Npb24gKi8KKyAgICBvdXRidWZbM10gPSAxOyAvKiBsYXN0IHRyYWNrL3Nlc3Npb24gKi8K
KworICAgIG91dGJ1Zls1XSA9IDB4MDQ7IC8qIERhdGEgQ0QsIG5vIFEtc3ViY2hhbm5lbCAqLwor
ICAgIG91dGJ1Zls2XSA9IDB4MDE7IC8qIFRyYWNrIG51bWJlciAqLworICAgIG91dGJ1ZlsxMF0g
PSBtc2YgPyAweDAyIDogMHgwOworCisgICAgb3V0YnVmWzEzXSA9IDB4MDQ7IC8qIERhdGEgQ0Qs
IG5vIFEtc3ViY2hhbm5lbCAqLworICAgIG91dGJ1ZlsxNF0gPSAweGFhOyAvKiBUcmFjayBudW1i
ZXIgKi8KKyAgICBpZiAobXNmKSB7CisgICAgICAgIGxhc3RfYmxrID0gMHhmZjMwMDAwMDsKKyAg
ICB9CisgICAgb3V0YnVmWzE2XSA9IGxhc3RfYmxrID4+IDI0OworICAgIG91dGJ1ZlsxN10gPSBs
YXN0X2JsayA+PiAxNjsKKyAgICBvdXRidWZbMThdID0gbGFzdF9ibGsgPj4gODsKKyAgICBvdXRi
dWZbMTldID0gbGFzdF9ibGs7CisKKyAgICBTUElDRV9ERUJVRygicmVhZF90b2MsIGx1bjolIiBH
X0dVSU5UMzJfRk9STUFUICIgbGVuOiAlIiBHX0dVSU5UNjRfRk9STUFUCisgICAgICAgICAgICAg
ICAgIiBtc2Y6ICV4IGZvcm1hdDogMHglMDJ4IHRyYWNrL3Nlc3Npb246IDB4JTAyeCIsCisgICAg
ICAgICAgICAgICAgcmVxLT5sdW4sIHJlcS0+aW5fbGVuLCBtc2YsIGZvcm1hdCwgdHJhY2tfbnVt
KTsKKworICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2LCByZXEpOworfQorCisjZGVm
aW5lIENEX01PREVfUEFSQU1fNl9MRU5fSEVBREVSICAgICAgICAgICAgICA0CisjZGVmaW5lIENE
X01PREVfUEFSQU1fMTBfTEVOX0hFQURFUiAgICAgICAgICAgICA4CisKKyNkZWZpbmUgQ0RfTU9E
RV9QQUdFX0xFTl9SV19FUlJPUiAgICAgICAgICAgICAgIDEyCisKK3N0YXRpYyB1aW50MzJfdCBj
ZF9zY3NpX2FkZF9tb2RlX3BhZ2VfcndfZXJyb3JfcmVjb3ZlcnkoQ2RTY3NpTFUgKmRldiwgdWlu
dDhfdCAqb3V0YnVmKQoreworICAgIHVpbnQzMl90IHBhZ2VfbGVuID0gQ0RfTU9ERV9QQUdFX0xF
Tl9SV19FUlJPUjsKKworICAgIG91dGJ1ZlswXSA9IE1PREVfUEFHRV9SX1dfRVJST1I7CisgICAg
b3V0YnVmWzFdID0gQ0RfTU9ERV9QQUdFX0xFTl9SV19FUlJPUiAtIDI7CisgICAgb3V0YnVmWzNd
ID0gMTsgLyogcmVhZCByZXRyeSBjb3VudCAqLworCisgICAgcmV0dXJuIHBhZ2VfbGVuOworfQor
CisjZGVmaW5lIENEX01PREVfUEFHRV9MRU5fUE9XRVIgICAgICAgICAgICAgICAgICAxMgorCitz
dGF0aWMgdWludDMyX3QgY2Rfc2NzaV9hZGRfbW9kZV9wYWdlX3Bvd2VyX2NvbmRpdGlvbihDZFNj
c2lMVSAqZGV2LCB1aW50OF90ICpvdXRidWYpCit7CisgICAgdWludDMyX3QgcGFnZV9sZW4gPSBD
RF9NT0RFX1BBR0VfTEVOX1BPV0VSOworCisgICAgb3V0YnVmWzBdID0gTU9ERV9QQUdFX1BPV0VS
OworICAgIG91dGJ1ZlsxXSA9IENEX01PREVfUEFHRV9MRU5fUE9XRVIgLSAyOworCisgICAgcmV0
dXJuIHBhZ2VfbGVuOworfQorCisjZGVmaW5lIENEX01PREVfUEFHRV9MRU5fRkFVTFRfRkFJTCAg
ICAgICAgICAgICAxMgorI2RlZmluZSBDRF9NT0RFX1BBR0VfRkFVTFRfRkFJTF9GTEFHX1BFUkYg
ICAgICAgMHg4MAorCitzdGF0aWMgdWludDMyX3QgY2Rfc2NzaV9hZGRfbW9kZV9wYWdlX2ZhdWx0
X3JlcG9ydGluZyhDZFNjc2lMVSAqZGV2LCB1aW50OF90ICpvdXRidWYpCit7CisgICAgdWludDMy
X3QgcGFnZV9sZW4gPSBDRF9NT0RFX1BBR0VfTEVOX0ZBVUxUX0ZBSUw7CisKKyAgICBvdXRidWZb
MF0gPSBNT0RFX1BBR0VfRkFVTFRfRkFJTDsKKyAgICBvdXRidWZbMV0gPSBDRF9NT0RFX1BBR0Vf
TEVOX0ZBVUxUX0ZBSUwgLSAyOworICAgIG91dGJ1ZlsyXSB8PSBDRF9NT0RFX1BBR0VfRkFVTFRf
RkFJTF9GTEFHX1BFUkY7CisKKyAgICByZXR1cm4gcGFnZV9sZW47Cit9CisKKyNkZWZpbmUgQ0Rf
TU9ERV9QQUdFX0xFTl9DQVBTX01FQ0hfU1RBVFVTX1JPICAgIDI2CisvKiBieXRlIDIgKi8KKyNk
ZWZpbmUgQ0RfTU9ERV9QQUdFX0NBUFNfQ0RfUl9SRUFEICAgICAgICAgICAgIDB4MDEKKyNkZWZp
bmUgQ0RfTU9ERV9QQUdFX0NBUFNfQ0RfUldfUkVBRCAgICAgICAgICAgICgweDAxIDw8IDEpCisj
ZGVmaW5lIENEX01PREVfUEFHRV9DQVBTX0RWRF9ST01fUkVBRCAgICAgICAgICAoMHgwMSA8PCAz
KQorI2RlZmluZSBDRF9NT0RFX1BBR0VfQ0FQU19EVkRfUl9SRUFEICAgICAgICAgICAgKDB4MDEg
PDwgNCkKKyNkZWZpbmUgQ0RfTU9ERV9QQUdFX0NBUFNfRFZEX1JBTV9SRUFEICAgICAgICAgICgw
eDAxIDw8IDUpCisvKiBieXRlIDYgKi8KKyNkZWZpbmUgQ0RfTU9ERV9QQUdFX0NBUFNfTE9DS19T
VVBQT1JUICAgICAgICAgICgweDAxKQorI2RlZmluZSBDRF9NT0RFX1BBR0VfQ0FQU19MT0NLX1NU
QVRFICAgICAgICAgICAgKDB4MDEgPDwgMSkKKyNkZWZpbmUgQ0RfTU9ERV9QQUdFX0NBUFNfUFJF
VkVOVF9KVU1QRVIgICAgICAgICgweDAxIDw8IDIpCisjZGVmaW5lIENEX01PREVfUEFHRV9DQVBT
X0VKRUNUICAgICAgICAgICAgICAgICAoMHgwMSA8PCAzKQorI2RlZmluZSBDRF9NT0RFX1BBR0Vf
Q0FQU19MT0FESU5HX1RSQVkgICAgICAgICAgKDB4MDEgPDwgNSkKKworc3RhdGljIHVpbnQzMl90
IGNkX3Njc2lfYWRkX21vZGVfcGFnZV9jYXBzX21lY2hfc3RhdHVzKENkU2NzaUxVICpkZXYsIHVp
bnQ4X3QgKm91dGJ1ZikKK3sKKyAgICB1aW50MzJfdCBwYWdlX2xlbiA9IENEX01PREVfUEFHRV9M
RU5fQ0FQU19NRUNIX1NUQVRVU19STzsgLyogbm8gd3JpdGUgKi8KKworICAgIG91dGJ1ZlswXSA9
IE1PREVfUEFHRV9DQVBTX01FQ0hfU1RBVFVTOworICAgIG91dGJ1ZlsxXSA9IHBhZ2VfbGVuOwor
ICAgIG91dGJ1ZlsyXSA9IENEX01PREVfUEFHRV9DQVBTX0NEX1JfUkVBRCB8IENEX01PREVfUEFH
RV9DQVBTX0NEX1JXX1JFQUQgfAorICAgICAgICAgICAgICAgIENEX01PREVfUEFHRV9DQVBTX0RW
RF9ST01fUkVBRCB8IENEX01PREVfUEFHRV9DQVBTX0RWRF9SX1JFQUQgfAorICAgICAgICAgICAg
ICAgIENEX01PREVfUEFHRV9DQVBTX0RWRF9SQU1fUkVBRDsKKyAgICBvdXRidWZbNl0gPSBDRF9N
T0RFX1BBR0VfQ0FQU19MT0FESU5HX1RSQVkgfCBDRF9NT0RFX1BBR0VfQ0FQU19FSkVDVCB8Cisg
ICAgICAgICAgICAgICAgQ0RfTU9ERV9QQUdFX0NBUFNfTE9DS19TVVBQT1JUOworICAgIGlmIChk
ZXYtPnByZXZlbnRfbWVkaWFfcmVtb3ZhbCkgeworICAgICAgICBvdXRidWZbNl0gfD0gQ0RfTU9E
RV9QQUdFX0NBUFNfTE9DS19TVEFURTsKKyAgICB9CisKKyAgICByZXR1cm4gcGFnZV9sZW47Cit9
CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX21vZGVfc2Vuc2VfMTAoQ2RTY3NpTFUgKmRldiwg
Q2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAgIHVpbnQ4X3QgKm91dGJ1ZiA9IHJlcS0+YnVmOwor
ICAgIGludCBsb25nX2xiYSwgZGJkLCBwYWdlLCBzdWJfcGFnZSwgcGM7CisgICAgdWludDMyX3Qg
cmVzcF9sZW4gPSBDRF9NT0RFX1BBUkFNXzEwX0xFTl9IRUFERVI7CisKKyAgICByZXEtPnhmZXJf
ZGlyID0gU0NTSV9YRkVSX0ZST01fREVWOworCisgICAgbG9uZ19sYmEgPSAocmVxLT5jZGJbMV0g
Pj4gNCkgJiAweDE7CisgICAgZGJkID0gKHJlcS0+Y2RiWzFdID4+IDMpICYgMHgxOworICAgIHBh
Z2UgPSByZXEtPmNkYlsyXSAmIDB4M2Y7CisgICAgcGMgPSByZXEtPmNkYlsyXSA+PiA2OworICAg
IHN1Yl9wYWdlID0gcmVxLT5jZGJbM10gJiAweGY7CisKKyAgICByZXEtPnJlcV9sZW4gPSAocmVx
LT5jZGJbN10gPDwgOCkgfCByZXEtPmNkYls4XTsKKworICAgIG1lbXNldChvdXRidWYsIDAsIHJl
cS0+cmVxX2xlbik7CisgICAgb3V0YnVmWzJdID0gIDA7IC8qIG1lZGl1bSB0eXBlICovCisKKyAg
ICBzd2l0Y2ggKHBhZ2UpIHsKKyAgICBjYXNlIE1PREVfUEFHRV9SX1dfRVJST1I6CisgICAgICAg
IC8qIFJlYWQvV3JpdGUgRXJyb3IgUmVjb3ZlcnkgKi8KKyAgICAgICAgcmVzcF9sZW4gKz0gY2Rf
c2NzaV9hZGRfbW9kZV9wYWdlX3J3X2Vycm9yX3JlY292ZXJ5KGRldiwgb3V0YnVmICsgcmVzcF9s
ZW4pOworICAgICAgICBicmVhazsKKyAgICBjYXNlIE1PREVfUEFHRV9QT1dFUjoKKyAgICAgICAg
LyogUG93ZXIgQ29uZGlzdGlvbnMgKi8KKyAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9hZGRf
bW9kZV9wYWdlX3Bvd2VyX2NvbmRpdGlvbihkZXYsIG91dGJ1ZiArIHJlc3BfbGVuKTsKKyAgICAg
ICAgYnJlYWs7CisgICAgY2FzZSBNT0RFX1BBR0VfRkFVTFRfRkFJTDoKKyAgICAgICAgLyogRmF1
bHQgLyBGYWlsdXJlIFJlcG9ydGluZyBDb250cm9sICovCisgICAgICAgIHJlc3BfbGVuICs9IGNk
X3Njc2lfYWRkX21vZGVfcGFnZV9mYXVsdF9yZXBvcnRpbmcoZGV2LCBvdXRidWYgKyByZXNwX2xl
bik7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgTU9ERV9QQUdFX0NBUFNfTUVDSF9TVEFUVVM6
CisgICAgICAgIHJlc3BfbGVuICs9IGNkX3Njc2lfYWRkX21vZGVfcGFnZV9jYXBzX21lY2hfc3Rh
dHVzKGRldiwgb3V0YnVmICsgcmVzcF9sZW4pOworICAgICAgICBicmVhazsKKworICAgIC8qIG5v
dCBpbXBsZW1lbnRlZCAqLworICAgIGNhc2UgTU9ERV9QQUdFX1dSSVRFX1BBUkFNRVRFUjogLyog
V3JpdGVyIFBhcmFtZXRlcnMgKi8KKyAgICBjYXNlIE1PREVfUEFHRV9NUlc6CisgICAgY2FzZSBN
T0RFX1BBR0VfTVJXX1ZFTkRPUjogLyogTVJXIChNb3VudCBSYWluaWVyIFJlLXdyaXRhYmxlIERp
c2tzICovCisgICAgY2FzZSBNT0RFX1BBR0VfQ0RfREVWSUNFOiAvKiBDRCBEZXZpY2UgcGFyYW1l
dGVycyAqLworICAgIGNhc2UgTU9ERV9QQUdFX1RPX1BST1RFQ1Q6IC8qIFRpbWUtb3V0IGFuZCBQ
cm90ZWN0ICovCisgICAgZGVmYXVsdDoKKyAgICAgICAgU1BJQ0VfREVCVUcoIm1vZGVfc2Vuc2Vf
MTAsIGx1bjolIiBHX0dVSU5UMzJfRk9STUFUCisgICAgICAgICAgICAgICAgICAgICIgcGFnZSAw
eCV4IG5vdCBpbXBsZW1lbnRlZCIsCisgICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuLCAodW5z
aWduZWQpcGFnZSk7CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2
LCByZXEsICZzZW5zZV9jb2RlX0lOVkFMSURfQ0RCX0ZJRUxEKTsKKyAgICAgICAgcmV0dXJuOwor
ICAgIH0KKworICAgIG91dGJ1ZlswXSA9ICgocmVzcF9sZW4gLSAyKSA+PiA4KSAmIDB4ZmY7Cisg
ICAgb3V0YnVmWzFdID0gKHJlc3BfbGVuIC0gMikgJiAweGZmOworCisgICAgcmVxLT5pbl9sZW4g
PSAocmVxLT5yZXFfbGVuIDwgcmVzcF9sZW4pID8gcmVxLT5yZXFfbGVuIDogcmVzcF9sZW47CisK
KyAgICBTUElDRV9ERUJVRygibW9kZV9zZW5zZV8xMCwgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQK
KyAgICAgICAgICAgICAgICAiIGxvbmdfbGJhICVkLCBkYmQgJWQsIHBhZ2UgJWQsIHN1Yl9wYWdl
ICVkLCBwYyAlZDsgIgorICAgICAgICAgICAgICAgICJyZXNwX2xlbiAlIiBHX0dVSU5UMzJfRk9S
TUFULAorICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBsb25nX2xiYSwgZGJkLCBwYWdlLCBzdWJf
cGFnZSwgcGMsIHJlc3BfbGVuKTsKKworICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2
LCByZXEpOworfQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9tb2RlX3NlbGVjdF82KENkU2Nz
aUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICB1aW50OF90ICpibG9ja19kZXNj
X2RhdGEsICptb2RlX2RhdGE7CisgICAgdWludDMyX3QgcGFnZV9mb3JtYXQsIHNhdmVfcGFnZXMs
IGxpc3RfbGVuOyAvKiBjZGIgKi8KKyAgICB1aW50MzJfdCBudW1fYmxvY2tzID0gMCwgYmxvY2tf
bGVuID0gMDsgLyogYmxvY2sgZGVzY3JpcHRvciAqLworICAgIHVpbnQzMl90IG1vZGVfbGVuLCBt
ZWRpdW1fdHlwZSwgZGV2X3BhcmFtLCBibG9ja19kZXNjX2xlbjsgLyogbW9kZSBwYXJhbSBoZWFk
ZXIgKi8KKyAgICB1aW50MzJfdCBwYWdlX251bSA9IDAsIHBhZ2VfbGVuID0gMDsgLyogbW9kZSBw
YWdlICovCisKKyAgICBwYWdlX2Zvcm1hdCA9IChyZXEtPmNkYlsxXSA+PiA0KSAmIDB4MTsKKyAg
ICBzYXZlX3BhZ2VzID0gcmVxLT5jZGJbMV0gJiAweDE7CisgICAgbGlzdF9sZW4gPSByZXEtPmNk
Yls0XTsKKworICAgIGlmIChsaXN0X2xlbiA+IHJlcS0+YnVmX2xlbikgeworICAgICAgICBTUElD
RV9ERUJVRygibW9kZV9zZWxlY3RfNiwgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQKKyAgICAgICAg
ICAgICAgICAgICAgIiBwZjolIiBHX0dVSU5UMzJfRk9STUFUICIgc3A6JSIgR19HVUlOVDMyX0ZP
Uk1BVAorICAgICAgICAgICAgICAgICAgICAiIGxpc3RfbGVuOiUiIEdfR1VJTlQzMl9GT1JNQVQg
IiBleGNlZWRzIGRhdGFfbGVuOiUiIEdfR1VJTlQzMl9GT1JNQVQsCisgICAgICAgICAgICAgICAg
ICAgIHJlcS0+bHVuLCBwYWdlX2Zvcm1hdCwgc2F2ZV9wYWdlcywgbGlzdF9sZW4sIHJlcS0+YnVm
X2xlbik7CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEs
ICZzZW5zZV9jb2RlX0lOVkFMSURfUEFSQU1fTEVOKTsKKyAgICAgICAgcmV0dXJuOworICAgIH0K
KworICAgIG1vZGVfbGVuID0gcmVxLT5idWZbMF07CisgICAgbWVkaXVtX3R5cGUgPSByZXEtPmJ1
ZlsxXTsKKyAgICBkZXZfcGFyYW0gPSByZXEtPmJ1ZlsyXTsKKyAgICBibG9ja19kZXNjX2xlbiA9
IHJlcS0+YnVmWzNdOworCisgICAgaWYgKGJsb2NrX2Rlc2NfbGVuKSB7CisgICAgICAgIGJsb2Nr
X2Rlc2NfZGF0YSA9ICZyZXEtPmJ1ZltDRF9NT0RFX1BBUkFNXzZfTEVOX0hFQURFUl07CisgICAg
ICAgIG51bV9ibG9ja3MgPSAoYmxvY2tfZGVzY19kYXRhWzNdIDw8IDE2KSB8IChibG9ja19kZXNj
X2RhdGFbMl0gPDwgOCkgfCBibG9ja19kZXNjX2RhdGFbM107CisgICAgICAgIGJsb2NrX2xlbiA9
IChibG9ja19kZXNjX2RhdGFbNV0gPDwgMTYpIHwgKGJsb2NrX2Rlc2NfZGF0YVs2XSA8PCA4KSB8
IGJsb2NrX2Rlc2NfZGF0YVs3XTsKKyAgICB9CisKKyAgICBpZiAobW9kZV9sZW4pIHsKKyAgICAg
ICAgbW9kZV9kYXRhID0gJnJlcS0+YnVmW0NEX01PREVfUEFSQU1fNl9MRU5fSEVBREVSXTsKKyAg
ICAgICAgaWYgKGJsb2NrX2Rlc2NfbGVuKSB7CisgICAgICAgICAgICBtb2RlX2RhdGEgKz0gYmxv
Y2tfZGVzY19sZW47CisgICAgICAgIH0KKyAgICAgICAgcGFnZV9udW0gPSBtb2RlX2RhdGFbMF0g
JiAweDNmOworICAgICAgICBwYWdlX2xlbiA9IG1vZGVfZGF0YVsxXTsKKyAgICB9CisKKyAgICBT
UElDRV9ERUJVRygibW9kZV9zZWxlY3RfNiwgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQKKyAgICAg
ICAgICAgICAgICAiIHBmOiUiIEdfR1VJTlQzMl9GT1JNQVQgIiBzcDolIiBHX0dVSU5UMzJfRk9S
TUFUCisgICAgICAgICAgICAgICAgIiBsaXN0X2xlbjolIiBHX0dVSU5UMzJfRk9STUFUICIgZGF0
YV9sZW46JSIgR19HVUlOVDMyX0ZPUk1BVAorICAgICAgICAgICAgICAgICIgbW9kZV9sZW46JSIg
R19HVUlOVDMyX0ZPUk1BVCAiIG1lZGl1bTolIiBHX0dVSU5UMzJfRk9STUFUCisgICAgICAgICAg
ICAgICAgIiBkZXZfcGFyYW06JSIgR19HVUlOVDMyX0ZPUk1BVCAiIGJsa19kZXNjX2xlbjolIiBH
X0dVSU5UMzJfRk9STUFUCisgICAgICAgICAgICAgICAgIiBudW1fYmxvY2tzOiUiIEdfR1VJTlQz
Ml9GT1JNQVQgIiBibG9ja19sZW46JSIgR19HVUlOVDMyX0ZPUk1BVAorICAgICAgICAgICAgICAg
ICIgcGFnZV9udW06JSIgR19HVUlOVDMyX0ZPUk1BVCAiIHBhZ2VfbGVuOiUiIEdfR1VJTlQzMl9G
T1JNQVQsCisgICAgICAgICAgICAgICAgcmVxLT5sdW4sIHBhZ2VfZm9ybWF0LCBzYXZlX3BhZ2Vz
LCBsaXN0X2xlbiwgcmVxLT5idWZfbGVuLAorICAgICAgICAgICAgICAgIG1vZGVfbGVuLCBtZWRp
dW1fdHlwZSwgZGV2X3BhcmFtLCBibG9ja19kZXNjX2xlbiwKKyAgICAgICAgICAgICAgICBudW1f
YmxvY2tzLCBibG9ja19sZW4sCisgICAgICAgICAgICAgICAgcGFnZV9udW0sIHBhZ2VfbGVuKTsK
KworICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2LCByZXEpOworfQorCitzdGF0aWMg
dm9pZCBjZF9zY3NpX2NtZF9tb2RlX3NlbGVjdF8xMChDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1
ZXN0ICpyZXEpCit7CisgICAgdWludDMyX3QgcGFnZV9mb3JtYXQsIHNhdmVfcGFnZXMsIGxpc3Rf
bGVuOworCisgICAgcGFnZV9mb3JtYXQgPSAocmVxLT5jZGJbMV0gPj4gNCkgJiAweDE7CisgICAg
c2F2ZV9wYWdlcyA9IHJlcS0+Y2RiWzFdICYgMHgxOworICAgIGxpc3RfbGVuID0gKHJlcS0+Y2Ri
WzddIDw8IDgpIHwgcmVxLT5jZGJbOF07CisKKyAgICBpZiAobGlzdF9sZW4gPiByZXEtPmJ1Zl9s
ZW4pIHsKKyAgICAgICAgU1BJQ0VfREVCVUcoIm1vZGVfc2VsZWN0XzEwLCBsdW46JSIgR19HVUlO
VDMyX0ZPUk1BVAorICAgICAgICAgICAgICAgICAgICAiIHBmOiUiIEdfR1VJTlQzMl9GT1JNQVQg
IiBzcDolIiBHX0dVSU5UMzJfRk9STUFUCisgICAgICAgICAgICAgICAgICAgICIgbGlzdF9sZW46
JSIgR19HVUlOVDMyX0ZPUk1BVCAiIGV4Y2VlZHMgZGF0YV9sZW46JSIgR19HVUlOVDMyX0ZPUk1B
VCwKKyAgICAgICAgICAgICAgICAgICAgcmVxLT5sdW4sIHBhZ2VfZm9ybWF0LCBzYXZlX3BhZ2Vz
LCBsaXN0X2xlbiwgcmVxLT5idWZfbGVuKTsKKyAgICAgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVf
Y2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfSU5WQUxJRF9QQVJBTV9MRU4pOworICAg
ICAgICByZXR1cm47CisgICAgfQorCisgICAgU1BJQ0VfREVCVUcoIm1vZGVfc2VsZWN0XzEwLCBs
dW46JSIgR19HVUlOVDMyX0ZPUk1BVAorICAgICAgICAgICAgICAgICIgcGY6JSIgR19HVUlOVDMy
X0ZPUk1BVCAiIHNwOiUiIEdfR1VJTlQzMl9GT1JNQVQKKyAgICAgICAgICAgICAgICAiIGxpc3Rf
bGVuOiUiIEdfR1VJTlQzMl9GT1JNQVQgIiBkYXRhX2xlbjolIiBHX0dVSU5UMzJfRk9STUFULAor
ICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBwYWdlX2Zvcm1hdCwgc2F2ZV9wYWdlcywgbGlzdF9s
ZW4sIHJlcS0+YnVmX2xlbik7CisKKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwg
cmVxKTsKK30KKworI2RlZmluZSBDRF9GRUFUVVJFX0hFQURFUl9MRU4gICAgICAgICAgICAgICA4
CisjZGVmaW5lIENEX0ZFQVRVUkVfREVTQ19MRU4gICAgICAgICAgICAgICAgIDQKKworI2RlZmlu
ZSBDRF9QUk9GSUxFX0RFU0NfTEVOICAgICAgICAgICAgICAgICA0CisjZGVmaW5lIENEX1BST0ZJ
TEVfQ1VSUkVOVCAgICAgICAgICAgICAgICAgIDB4MDEKKworLyogUHJvZmlsZXMgTGlzdCAqLwor
I2RlZmluZSBDRF9GRUFUVVJFX05VTV9QUk9GSUxFU19MSVNUICAgICAgICAweDAwCisvKiBDb3Jl
IC0gQmFzaWMgRnVuY3Rpb25hbGl0eSAqLworI2RlZmluZSBDRF9GRUFUVVJFX05VTV9DT1JFICAg
ICAgICAgICAgICAgICAweDAxCisvKiBNb3JwaGluZyAtIFRoZSBkZXZpY2UgY2hhbmdlcyBpdHMg
YmVoYXZpb3IgZHVlIHRvIGV4dGVybmFsIGV2ZW50cyAqLworI2RlZmluZSBDRF9GRUFUVVJFX05V
TV9NT1JQSCAgICAgICAgICAgICAgICAweDAyCisvKiBSZW1vdmFibGUgTWVkaXVtIC0gVGhlIG1l
ZGl1bSBtYXkgYmUgcmVtb3ZlZCBmcm9tIHRoZSBkZXZpY2UgKi8KKyNkZWZpbmUgQ0RfRkVBVFVS
RV9OVU1fUkVNT1ZBQkxFICAgICAgICAgICAgMHgwMworLyogUmFuZG9tIFJlYWRhYmxlIC0gUFA9
MSBSZWFkIGFiaWxpdHkgZm9yIHN0b3JhZ2UgZGV2aWNlcyB3aXRoIHJhbmRvbSBhZGRyZXNzaW5n
ICovCisjZGVmaW5lIENEX0ZFQVRVUkVfTlVNX1JBTkRPTV9SRUFEICAgICAgICAgIDB4MTAKKy8q
IENEIFJlYWQgLSBUaGUgYWJpbGl0eSB0byByZWFkIENEIHNwZWNpZmljIHN0cnVjdHVyZXMgKi8K
KyNkZWZpbmUgQ0RfRkVBVFVSRV9OVU1fQ0RfUkVBRCAgICAgICAgICAgICAgMHgxRQorLyogRFZE
IFJlYWQgLSBUaGUgYWJpbGl0eSB0byByZWFkIERWRCBzcGVjaWZpYyBzdHJ1Y3R1cmVzICovCisj
ZGVmaW5lIENEX0ZFQVRVUkVfTlVNX0RWRF9SRUFEICAgICAgICAgICAgIDB4MUYKKy8qIFBvd2Vy
IE1hbmFnZW1lbnQgLSBJbml0aWF0b3IgYW5kIGRldmljZSBkaXJlY3RlZCBwb3dlciBtYW5hZ2Vt
ZW50ICovCisjZGVmaW5lIENEX0ZFQVRVUkVfTlVNX1BPV0VSX01OR1QgICAgICAgICAgIDB4MTAw
CisvKiBUaW1lb3V0ICovCisjZGVmaW5lIENEX0ZFQVRVUkVfTlVNX1RJTUVPVVQgICAgICAgICAg
ICAgIDB4MTA1CisKKyNkZWZpbmUgQ0RfRkVBVFVSRV9SRVFfQUxMICAgICAgICAgICAgICAgICAg
MAorI2RlZmluZSBDRF9GRUFUVVJFX1JFUV9DVVJSRU5UICAgICAgICAgICAgICAxCisjZGVmaW5l
IENEX0ZFQVRVUkVfUkVRX1NJTkdMRSAgICAgICAgICAgICAgIDIKKworI2RlZmluZSBDRF9GRUFU
VVJFX0NVUlJFTlQgICAgICAgICAgICAgICAgICAweDAxCisjZGVmaW5lIENEX0ZFQVRVUkVfUEVS
U0lTVEVOVCAgICAgICAgICAgICAgIDB4MDIKKworI2RlZmluZSBDRF9GRUFUVVJFX1ZFUlNJT05f
MSAgICAgICAgICAgICAgICAoMHgwMSA8PCAyKQorCisjZGVmaW5lIENEX0ZFQVRVUkVfUEhZU19J
Rl9TQ1NJICAgICAgICAgICAgIDB4MDEKKworI2RlZmluZSBDRF9GRUFUVVJFX1JFTU9WQUJMRV9M
T0FESU5HX1RSQVkgICAoMHgwMSA8PCA1KQorI2RlZmluZSBDRF9GRUFUVVJFX1JFTU9WQUJMRV9F
SkVDVCAgICAgICAgICAoMHgwMSA8PCAzKQorI2RlZmluZSBDRF9GRUFUVVJFX1JFTU9WQUJMRV9O
T19QUlZOVF9KTVBSICAoMHgwMSA8PCAyKQorI2RlZmluZSBDRF9GRUFUVVJFX1JFTU9WQUJMRV9M
T0NLICAgICAgICAgICAoMHgwMSkKKworc3RhdGljIGdib29sZWFuIGNkX3Njc2lfZmVhdHVyZV9y
ZXBvcnRhYmxlKHVpbnQzMl90IGZlYXR1cmUsIHVpbnQzMl90IHN0YXJ0X2ZlYXR1cmUsCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyX3QgcmVxX3R5cGUp
Cit7CisgICAgcmV0dXJuIChyZXFfdHlwZSA9PSBDRF9GRUFUVVJFX1JFUV9TSU5HTEUgJiYgc3Rh
cnRfZmVhdHVyZSA9PSBmZWF0dXJlKSB8fAorICAgICAgICAgICAoZmVhdHVyZSA+PSBzdGFydF9m
ZWF0dXJlKTsKK30KKworc3RhdGljIHVpbnQzMl90IGNkX3Njc2lfYWRkX2ZlYXR1cmVfcHJvZmls
ZXNfbGlzdChDZFNjc2lMVSAqZGV2LCB1aW50OF90ICpvdXRidWYsCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IHN0YXJ0X2ZlYXR1cmUs
IHVpbnQzMl90IHJlcV90eXBlKQoreworICAgIHVpbnQ4X3QgKnByb2ZpbGUgPSBvdXRidWYgKyBD
RF9GRUFUVVJFX0RFU0NfTEVOOworICAgIHVpbnQzMl90IGZlYXR1cmVfbGVuID0gQ0RfRkVBVFVS
RV9ERVNDX0xFTjsKKyAgICB1aW50MzJfdCBhZGRfbGVuLCBwcm9maWxlX251bTsKKworICAgIGlm
ICghY2Rfc2NzaV9mZWF0dXJlX3JlcG9ydGFibGUoQ0RfRkVBVFVSRV9OVU1fUFJPRklMRVNfTElT
VCwgc3RhcnRfZmVhdHVyZSwgcmVxX3R5cGUpKSB7CisgICAgICAgIHJldHVybiAwOworICAgIH0K
KyAgICAvKiBmZWF0dXJlIGRlc2NyaXB0b3IgaGVhZGVyICovCisgICAgb3V0YnVmWzBdID0gKENE
X0ZFQVRVUkVfTlVNX1BST0ZJTEVTX0xJU1QgPj4gOCkgJiAweGZmOworICAgIG91dGJ1ZlsxXSA9
IENEX0ZFQVRVUkVfTlVNX1BST0ZJTEVTX0xJU1QgJiAweGZmOworICAgIG91dGJ1ZlsyXSA9IENE
X0ZFQVRVUkVfUEVSU0lTVEVOVCB8IENEX0ZFQVRVUkVfQ1VSUkVOVDsKKworICAgIC8qIERWRC1S
T00gcHJvZmlsZSBkZXNjcmlwdG9yICovCisgICAgYWRkX2xlbiA9IENEX1BST0ZJTEVfREVTQ19M
RU47IC8qIHN0YXJ0IHdpdGggc2luZ2xlIHByb2ZpbGUsIGFkZCBsYXRlciAqLworICAgIHByb2Zp
bGVfbnVtID0gTU1DX1BST0ZJTEVfRFZEX1JPTTsKKworICAgIHByb2ZpbGVbMF0gPSAocHJvZmls
ZV9udW0gPj4gOCkgJiAweGZmOyAvKiBmZWF0dXJlIGNvZGUgKi8KKyAgICBwcm9maWxlWzFdID0g
cHJvZmlsZV9udW0gJiAweGZmOworICAgIHByb2ZpbGVbMl0gPSAoIWRldi0+Y2Rfcm9tKSA/IENE
X1BST0ZJTEVfQ1VSUkVOVCA6IDA7CisKKyAgICAvKiBuZXh0IHByb2ZpbGUgKi8KKyAgICBhZGRf
bGVuICs9IENEX1BST0ZJTEVfREVTQ19MRU47CisgICAgcHJvZmlsZSArPSBDRF9QUk9GSUxFX0RF
U0NfTEVOOworCisgICAgLyogQ0QtUk9NIHByb2ZpbGUgZGVzY3JpcHRvciAqLworICAgIHByb2Zp
bGVfbnVtID0gTU1DX1BST0ZJTEVfQ0RfUk9NOworICAgIHByb2ZpbGVbMF0gPSAocHJvZmlsZV9u
dW0gPj4gOCkgJiAweGZmOworICAgIHByb2ZpbGVbMV0gPSBwcm9maWxlX251bSAmIDB4ZmY7Cisg
ICAgcHJvZmlsZVsyXSA9IGRldi0+Y2Rfcm9tID8gQ0RfUFJPRklMRV9DVVJSRU5UIDogMDsKKwor
ICAgIG91dGJ1ZlszXSA9IGFkZF9sZW47CisgICAgZmVhdHVyZV9sZW4gKz0gYWRkX2xlbjsKKwor
ICAgIHJldHVybiBmZWF0dXJlX2xlbjsKK30KKworI2RlZmluZSBDRF9GRUFUVVJFX0NPUkVfUEhZ
U19QUk9GSUxFX0xFTiAgICA0CisKK3N0YXRpYyB1aW50MzJfdCBjZF9zY3NpX2FkZF9mZWF0dXJl
X2NvcmUoQ2RTY3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVmLAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCBzdGFydF9mZWF0dXJlLCB1aW50MzJfdCBy
ZXFfdHlwZSkKK3sKKyAgICB1aW50OF90ICpwcm9maWxlID0gb3V0YnVmICsgQ0RfRkVBVFVSRV9E
RVNDX0xFTjsKKyAgICB1aW50MzJfdCBmZWF0dXJlX2xlbiA9IENEX0ZFQVRVUkVfREVTQ19MRU4g
KyBDRF9GRUFUVVJFX0NPUkVfUEhZU19QUk9GSUxFX0xFTjsKKworICAgIGlmICghY2Rfc2NzaV9m
ZWF0dXJlX3JlcG9ydGFibGUoQ0RfRkVBVFVSRV9OVU1fQ09SRSwgc3RhcnRfZmVhdHVyZSwgcmVx
X3R5cGUpKSB7CisgICAgICAgIHJldHVybiAwOworICAgIH0KKyAgICBvdXRidWZbMF0gPSAoQ0Rf
RkVBVFVSRV9OVU1fQ09SRSA+PiA4KSAmIDB4ZmY7CisgICAgb3V0YnVmWzFdID0gQ0RfRkVBVFVS
RV9OVU1fQ09SRSAmIDB4ZmY7CisgICAgb3V0YnVmWzJdID0gQ0RfRkVBVFVSRV9QRVJTSVNURU5U
IHwgQ0RfRkVBVFVSRV9DVVJSRU5UOworICAgIG91dGJ1ZlszXSA9IENEX0ZFQVRVUkVfQ09SRV9Q
SFlTX1BST0ZJTEVfTEVOOworCisgICAgcHJvZmlsZVszXSA9IENEX0ZFQVRVUkVfUEhZU19JRl9T
Q1NJOworCisgICAgcmV0dXJuIGZlYXR1cmVfbGVuOworfQorCisjZGVmaW5lIENEX0ZFQVRVUkVf
TU9SUEhfUFJPR0lMRV9MRU4gICAgNAorI2RlZmluZSBDRF9GRUFUVVJFX01PUlBIX0FTWU5DX0VW
RU5UUyAgIDB4MDEKKworc3RhdGljIHVpbnQzMl90IGNkX3Njc2lfYWRkX2ZlYXR1cmVfbW9ycGgo
Q2RTY3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVmLAorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgdWludDMyX3Qgc3RhcnRfZmVhdHVyZSwgdWludDMyX3QgcmVxX3R5
cGUpCit7CisgICAgdWludDhfdCAqcHJvZmlsZSA9IG91dGJ1ZiArIENEX0ZFQVRVUkVfREVTQ19M
RU47CisgICAgdWludDMyX3QgZmVhdHVyZV9sZW4gPSBDRF9GRUFUVVJFX0RFU0NfTEVOICsgQ0Rf
RkVBVFVSRV9NT1JQSF9QUk9HSUxFX0xFTjsKKworICAgIGlmICghY2Rfc2NzaV9mZWF0dXJlX3Jl
cG9ydGFibGUoQ0RfRkVBVFVSRV9OVU1fTU9SUEgsIHN0YXJ0X2ZlYXR1cmUsIHJlcV90eXBlKSkg
eworICAgICAgICByZXR1cm4gMDsKKyAgICB9CisgICAgb3V0YnVmWzFdID0gQ0RfRkVBVFVSRV9O
VU1fTU9SUEg7CisgICAgb3V0YnVmWzJdID0gQ0RfRkVBVFVSRV9QRVJTSVNURU5UIHwgQ0RfRkVB
VFVSRV9DVVJSRU5UOworICAgIG91dGJ1ZlszXSA9IENEX0ZFQVRVUkVfTU9SUEhfUFJPR0lMRV9M
RU47CisKKyAgICBwcm9maWxlWzBdID0gQ0RfRkVBVFVSRV9NT1JQSF9BU1lOQ19FVkVOVFM7CisK
KyAgICByZXR1cm4gZmVhdHVyZV9sZW47Cit9CisKKyNkZWZpbmUgQ0RfRkVBVFVSRV9SRU1PVkFC
TEVfUFJPRklMRV9MRU4gICAgNAorCitzdGF0aWMgdWludDMyX3QgY2Rfc2NzaV9hZGRfZmVhdHVy
ZV9yZW1vdmFibGUoQ2RTY3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVmLAorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IHN0YXJ0X2ZlYXR1cmUs
IHVpbnQzMl90IHJlcV90eXBlKQoreworICAgIHVpbnQ4X3QgKnByb2ZpbGUgPSBvdXRidWYgKyBD
RF9GRUFUVVJFX0RFU0NfTEVOOworICAgIHVpbnQzMl90IGZlYXR1cmVfbGVuID0gQ0RfRkVBVFVS
RV9ERVNDX0xFTiArIENEX0ZFQVRVUkVfUkVNT1ZBQkxFX1BST0ZJTEVfTEVOOworCisgICAgaWYg
KCFjZF9zY3NpX2ZlYXR1cmVfcmVwb3J0YWJsZShDRF9GRUFUVVJFX05VTV9SRU1PVkFCTEUsIHN0
YXJ0X2ZlYXR1cmUsIHJlcV90eXBlKSkgeworICAgICAgICByZXR1cm4gMDsKKyAgICB9CisgICAg
b3V0YnVmWzFdID0gQ0RfRkVBVFVSRV9OVU1fUkVNT1ZBQkxFOworICAgIG91dGJ1ZlsyXSA9IENE
X0ZFQVRVUkVfUEVSU0lTVEVOVCB8IENEX0ZFQVRVUkVfQ1VSUkVOVDsKKyAgICBvdXRidWZbM10g
PSBDRF9GRUFUVVJFX1JFTU9WQUJMRV9QUk9GSUxFX0xFTjsKKworICAgIHByb2ZpbGVbMF0gPSBD
RF9GRUFUVVJFX1JFTU9WQUJMRV9OT19QUlZOVF9KTVBSOworICAgIGlmIChkZXYtPnJlbW92YWJs
ZSkgeworICAgICAgICBwcm9maWxlWzBdIHw9IChDRF9GRUFUVVJFX1JFTU9WQUJMRV9MT0FESU5H
X1RSQVkgfCBDRF9GRUFUVVJFX1JFTU9WQUJMRV9FSkVDVCk7CisgICAgfQorCisgICAgcmV0dXJu
IGZlYXR1cmVfbGVuOworfQorCisjZGVmaW5lIENEX0ZFQVRVUkVfUkFORE9NX1JFQURfUFJPRklM
RV9MRU4gICAgOAorCitzdGF0aWMgdWludDMyX3QgY2Rfc2NzaV9hZGRfZmVhdHVyZV9yYW5kb21f
cmVhZChDZFNjc2lMVSAqZGV2LCB1aW50OF90ICpvdXRidWYsCisgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCBzdGFydF9mZWF0dXJlLCB1aW50
MzJfdCByZXFfdHlwZSkKK3sKKyAgICB1aW50OF90ICpwcm9maWxlID0gb3V0YnVmICsgQ0RfRkVB
VFVSRV9ERVNDX0xFTjsKKyAgICB1aW50MzJfdCBmZWF0dXJlX2xlbiA9IENEX0ZFQVRVUkVfREVT
Q19MRU4gKyBDRF9GRUFUVVJFX1JBTkRPTV9SRUFEX1BST0ZJTEVfTEVOOworCisgICAgaWYgKCFj
ZF9zY3NpX2ZlYXR1cmVfcmVwb3J0YWJsZShDRF9GRUFUVVJFX05VTV9SQU5ET01fUkVBRCwgc3Rh
cnRfZmVhdHVyZSwgcmVxX3R5cGUpKSB7CisgICAgICAgIHJldHVybiAwOworICAgIH0KKyAgICBv
dXRidWZbMF0gPSAoQ0RfRkVBVFVSRV9OVU1fUkFORE9NX1JFQUQgPj4gOCkgJiAweGZmOworICAg
IG91dGJ1ZlsxXSA9IENEX0ZFQVRVUkVfTlVNX1JBTkRPTV9SRUFEICYgMHhmZjsKKyAgICBvdXRi
dWZbMl0gPSBDRF9GRUFUVVJFX1BFUlNJU1RFTlQgfCBDRF9GRUFUVVJFX0NVUlJFTlQ7CisgICAg
b3V0YnVmWzNdID0gQ0RfRkVBVFVSRV9SQU5ET01fUkVBRF9QUk9GSUxFX0xFTjsKKworICAgIHBy
b2ZpbGVbMF0gPSAoZGV2LT5ibG9ja19zaXplID4+IDI0KSAmIDB4ZmY7CisgICAgcHJvZmlsZVsx
XSA9IChkZXYtPmJsb2NrX3NpemUgPj4gMTYpICYgMHhmZjsKKyAgICBwcm9maWxlWzJdID0gKGRl
di0+YmxvY2tfc2l6ZSA+PiA4KSAmIDB4ZmY7CisgICAgcHJvZmlsZVszXSA9IChkZXYtPmJsb2Nr
X3NpemUpICYgMHhmZjsKKyAgICBwcm9maWxlWzVdID0gKGRldi0+Y2Rfcm9tKSA/IDB4MDEgOiAw
eDEwOyAvKiBsb2dpY2FsIGJsb2NrcyBwZXIgcmVhZGFibGUgdW5pdCAqLworCisgICAgcmV0dXJu
IGZlYXR1cmVfbGVuOworfQorCisjZGVmaW5lIENEX0ZFQVRVUkVfQ0RfUkVBRF9QUk9GSUxFX0xF
TiAgICA0CisKK3N0YXRpYyB1aW50MzJfdCBjZF9zY3NpX2FkZF9mZWF0dXJlX2NkX3JlYWQoQ2RT
Y3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVmLAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICB1aW50MzJfdCBzdGFydF9mZWF0dXJlLCB1aW50MzJfdCByZXFfdHlw
ZSkKK3sKKyAgICB1aW50OF90ICpwcm9maWxlID0gb3V0YnVmICsgQ0RfRkVBVFVSRV9ERVNDX0xF
TjsKKyAgICB1aW50MzJfdCBmZWF0dXJlX2xlbiA9IENEX0ZFQVRVUkVfREVTQ19MRU4gKyBDRF9G
RUFUVVJFX0NEX1JFQURfUFJPRklMRV9MRU47CisKKyAgICBpZiAoIWNkX3Njc2lfZmVhdHVyZV9y
ZXBvcnRhYmxlKENEX0ZFQVRVUkVfTlVNX0NEX1JFQUQsIHN0YXJ0X2ZlYXR1cmUsIHJlcV90eXBl
KSkgeworICAgICAgICByZXR1cm4gMDsKKyAgICB9CisgICAgb3V0YnVmWzBdID0gKENEX0ZFQVRV
UkVfTlVNX0NEX1JFQUQgPj4gOCkgJiAweGZmOworICAgIG91dGJ1ZlsxXSA9IChDRF9GRUFUVVJF
X05VTV9DRF9SRUFEKSAmIDB4ZmY7CisgICAgb3V0YnVmWzJdID0gQ0RfRkVBVFVSRV9WRVJTSU9O
XzEgfCBDRF9GRUFUVVJFX1BFUlNJU1RFTlQgfCBDRF9GRUFUVVJFX0NVUlJFTlQ7CisgICAgb3V0
YnVmWzNdID0gQ0RfRkVBVFVSRV9DRF9SRUFEX1BST0ZJTEVfTEVOOworCisgICAgcHJvZmlsZVsw
XSA9IDA7IC8qIEMyIEVycm9ycywgQ0QtVGV4dCBub3Qgc3VwcG9ydGUgKi8KKworICAgIHJldHVy
biBmZWF0dXJlX2xlbjsKK30KKworI2RlZmluZSBDRF9GRUFUVVJFX0RWRF9SRUFEX1BST0ZJTEVf
TEVOICAgIDAKKworc3RhdGljIHVpbnQzMl90IGNkX3Njc2lfYWRkX2ZlYXR1cmVfZHZkX3JlYWQo
Q2RTY3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVmLAorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgdWludDMyX3Qgc3RhcnRfZmVhdHVyZSwgdWludDMyX3QgcmVx
X3R5cGUpCit7CisgICAgdWludDMyX3QgZmVhdHVyZV9sZW4gPSBDRF9GRUFUVVJFX0RFU0NfTEVO
ICsgQ0RfRkVBVFVSRV9EVkRfUkVBRF9QUk9GSUxFX0xFTjsKKworICAgIGlmICghY2Rfc2NzaV9m
ZWF0dXJlX3JlcG9ydGFibGUoQ0RfRkVBVFVSRV9OVU1fQ0RfUkVBRCwgc3RhcnRfZmVhdHVyZSwg
cmVxX3R5cGUpKSB7CisgICAgICAgIHJldHVybiAwOworICAgIH0KKyAgICBvdXRidWZbMF0gPSAo
Q0RfRkVBVFVSRV9OVU1fRFZEX1JFQUQgPj4gOCkgJiAweGZmOworICAgIG91dGJ1ZlsxXSA9IChD
RF9GRUFUVVJFX05VTV9EVkRfUkVBRCkgJiAweGZmOworICAgIG91dGJ1ZlsyXSA9IENEX0ZFQVRV
UkVfVkVSU0lPTl8xIHwgQ0RfRkVBVFVSRV9QRVJTSVNURU5UIHwgQ0RfRkVBVFVSRV9DVVJSRU5U
OworICAgIG91dGJ1ZlszXSA9IENEX0ZFQVRVUkVfRFZEX1JFQURfUFJPRklMRV9MRU47CisKKyAg
ICByZXR1cm4gZmVhdHVyZV9sZW47Cit9CisKKyNkZWZpbmUgQ0RfRkVBVFVSRV9QT1dFUl9NTkdU
X1BST0ZJTEVfTEVOICAgIDAKKworc3RhdGljIHVpbnQzMl90IGNkX3Njc2lfYWRkX2ZlYXR1cmVf
cG93ZXJfbWdtdChDZFNjc2lMVSAqZGV2LCB1aW50OF90ICpvdXRidWYsCisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IHN0YXJ0X2ZlYXR1cmUs
IHVpbnQzMl90IHJlcV90eXBlKQoreworICAgIHVpbnQzMl90IGZlYXR1cmVfbGVuID0gQ0RfRkVB
VFVSRV9ERVNDX0xFTiArIENEX0ZFQVRVUkVfUE9XRVJfTU5HVF9QUk9GSUxFX0xFTjsKKworICAg
IGlmICghY2Rfc2NzaV9mZWF0dXJlX3JlcG9ydGFibGUoQ0RfRkVBVFVSRV9OVU1fUE9XRVJfTU5H
VCwgc3RhcnRfZmVhdHVyZSwgcmVxX3R5cGUpKSB7CisgICAgICAgIHJldHVybiAwOworICAgIH0K
KyAgICBvdXRidWZbMF0gPSAoQ0RfRkVBVFVSRV9OVU1fUE9XRVJfTU5HVCA+PiA4KSAmIDB4ZmY7
CisgICAgb3V0YnVmWzFdID0gKENEX0ZFQVRVUkVfTlVNX1BPV0VSX01OR1QpICYgMHhmZjsKKyAg
ICBvdXRidWZbMl0gPSBDRF9GRUFUVVJFX1BFUlNJU1RFTlQgfCBDRF9GRUFUVVJFX0NVUlJFTlQ7
CisgICAgb3V0YnVmWzNdID0gQ0RfRkVBVFVSRV9QT1dFUl9NTkdUX1BST0ZJTEVfTEVOOworCisg
ICAgcmV0dXJuIGZlYXR1cmVfbGVuOworfQorCisjZGVmaW5lIENEX0ZFQVRVUkVfVElNRU9VVF9Q
Uk9GSUxFX0xFTiAgICAwCisKK3N0YXRpYyB1aW50MzJfdCBjZF9zY3NpX2FkZF9mZWF0dXJlX3Rp
bWVvdXQoQ2RTY3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVmLAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCBzdGFydF9mZWF0dXJlLCB1aW50MzJf
dCByZXFfdHlwZSkKK3sKKyAgICB1aW50MzJfdCBmZWF0dXJlX2xlbiA9IENEX0ZFQVRVUkVfREVT
Q19MRU4gKyBDRF9GRUFUVVJFX1RJTUVPVVRfUFJPRklMRV9MRU47CisKKyAgICBpZiAoIWNkX3Nj
c2lfZmVhdHVyZV9yZXBvcnRhYmxlKENEX0ZFQVRVUkVfTlVNX1RJTUVPVVQsIHN0YXJ0X2ZlYXR1
cmUsIHJlcV90eXBlKSkgeworICAgICAgICByZXR1cm4gMDsKKyAgICB9CisgICAgb3V0YnVmWzBd
ID0gKENEX0ZFQVRVUkVfTlVNX1RJTUVPVVQgPj4gOCkgJiAweGZmOworICAgIG91dGJ1ZlsxXSA9
IENEX0ZFQVRVUkVfTlVNX1RJTUVPVVQgJiAweGZmOworICAgIG91dGJ1ZlsyXSA9IENEX0ZFQVRV
UkVfUEVSU0lTVEVOVCB8IENEX0ZFQVRVUkVfQ1VSUkVOVDsKKyAgICBvdXRidWZbM10gPSBDRF9G
RUFUVVJFX1RJTUVPVVRfUFJPRklMRV9MRU47CisKKyAgICByZXR1cm4gZmVhdHVyZV9sZW47Cit9
CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX2dldF9jb25maWd1cmF0aW9uKENkU2NzaUxVICpk
ZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICB1aW50OF90ICpvdXRidWYgPSByZXEtPmJ1
ZjsKKyAgICB1aW50MzJfdCBwcm9maWxlX251bSA9ICghZGV2LT5jZF9yb20pID8gTU1DX1BST0ZJ
TEVfRFZEX1JPTSA6IE1NQ19QUk9GSUxFX0NEX1JPTTsKKyAgICB1aW50MzJfdCByZXFfdHlwZSwg
c3RhcnRfZmVhdHVyZSwgcmVzcF9sZW47CisKKyAgICByZXEtPnhmZXJfZGlyID0gU0NTSV9YRkVS
X0ZST01fREVWOworCisgICAgcmVxX3R5cGUgPSByZXEtPmNkYlsxXSAmIDB4MzsKKyAgICBzdGFy
dF9mZWF0dXJlID0gKHJlcS0+Y2RiWzJdIDw8IDgpIHwgcmVxLT5jZGJbM107CisgICAgcmVxLT5y
ZXFfbGVuID0gKHJlcS0+Y2RiWzddIDw8IDgpIHwgcmVxLT5jZGJbOF07CisKKyAgICBtZW1zZXQo
b3V0YnVmLCAwLCByZXEtPnJlcV9sZW4pOworCisgICAgLyogYXQgbGVhc3QgRmVhdHVyZSBIZWFk
ZXIgc2hvdWxkIGJlIHByZXNlbnQsIHRvIGJlIGZpbGxlZCBsYXRlciAqLworICAgIHJlc3BfbGVu
ID0gQ0RfRkVBVFVSRV9IRUFERVJfTEVOOworCisgICAgc3dpdGNoIChyZXFfdHlwZSkgeworICAg
IGNhc2UgQ0RfRkVBVFVSRV9SRVFfQUxMOgorICAgIGNhc2UgQ0RfRkVBVFVSRV9SRVFfQ1VSUkVO
VDoKKyAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9hZGRfZmVhdHVyZV9wcm9maWxlc19saXN0
KGRldiwgb3V0YnVmICsgcmVzcF9sZW4sIHN0YXJ0X2ZlYXR1cmUsCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXFfdHlwZSk7CisgICAgICAg
IHJlc3BfbGVuICs9IGNkX3Njc2lfYWRkX2ZlYXR1cmVfY29yZShkZXYsIG91dGJ1ZiArIHJlc3Bf
bGVuLCBzdGFydF9mZWF0dXJlLCByZXFfdHlwZSk7CisgICAgICAgIHJlc3BfbGVuICs9IGNkX3Nj
c2lfYWRkX2ZlYXR1cmVfbW9ycGgoZGV2LCBvdXRidWYgKyByZXNwX2xlbiwgc3RhcnRfZmVhdHVy
ZSwgcmVxX3R5cGUpOworICAgICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9mZWF0dXJlX3Jl
bW92YWJsZShkZXYsIG91dGJ1ZiArIHJlc3BfbGVuLCBzdGFydF9mZWF0dXJlLCByZXFfdHlwZSk7
CisgICAgICAgIHJlc3BfbGVuICs9IGNkX3Njc2lfYWRkX2ZlYXR1cmVfcmFuZG9tX3JlYWQoZGV2
LCBvdXRidWYgKyByZXNwX2xlbiwgc3RhcnRfZmVhdHVyZSwKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXFfdHlwZSk7CisgICAgICAgIHJlc3Bf
bGVuICs9IGNkX3Njc2lfYWRkX2ZlYXR1cmVfY2RfcmVhZChkZXYsIG91dGJ1ZiArIHJlc3BfbGVu
LCBzdGFydF9mZWF0dXJlLCByZXFfdHlwZSk7CisgICAgICAgIHJlc3BfbGVuICs9IGNkX3Njc2lf
YWRkX2ZlYXR1cmVfZHZkX3JlYWQoZGV2LCBvdXRidWYgKyByZXNwX2xlbiwgc3RhcnRfZmVhdHVy
ZSwgcmVxX3R5cGUpOworICAgICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9mZWF0dXJlX3Bv
d2VyX21nbXQoZGV2LCBvdXRidWYgKyByZXNwX2xlbiwgc3RhcnRfZmVhdHVyZSwgcmVxX3R5cGUp
OworICAgICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9mZWF0dXJlX3RpbWVvdXQoZGV2LCBv
dXRidWYgKyByZXNwX2xlbiwgc3RhcnRfZmVhdHVyZSwgcmVxX3R5cGUpOworICAgICAgICBicmVh
azsKKyAgICBjYXNlIENEX0ZFQVRVUkVfUkVRX1NJTkdMRToKKyAgICAgICAgc3dpdGNoIChzdGFy
dF9mZWF0dXJlKSB7CisgICAgICAgIGNhc2UgQ0RfRkVBVFVSRV9OVU1fQ09SRToKKyAgICAgICAg
ICAgIHJlc3BfbGVuICs9IGNkX3Njc2lfYWRkX2ZlYXR1cmVfY29yZShkZXYsIG91dGJ1ZiArIHJl
c3BfbGVuLCBzdGFydF9mZWF0dXJlLCByZXFfdHlwZSk7CisgICAgICAgICAgICBicmVhazsKKyAg
ICAgICAgY2FzZSBDRF9GRUFUVVJFX05VTV9NT1JQSDoKKyAgICAgICAgICAgIHJlc3BfbGVuICs9
IGNkX3Njc2lfYWRkX2ZlYXR1cmVfbW9ycGgoZGV2LCBvdXRidWYgKyByZXNwX2xlbiwgc3RhcnRf
ZmVhdHVyZSwgcmVxX3R5cGUpOworICAgICAgICAgICAgYnJlYWs7CisgICAgICAgIGNhc2UgQ0Rf
RkVBVFVSRV9OVU1fUkVNT1ZBQkxFOgorICAgICAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9h
ZGRfZmVhdHVyZV9yZW1vdmFibGUoZGV2LCBvdXRidWYgKyByZXNwX2xlbiwgc3RhcnRfZmVhdHVy
ZSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHJlcV90eXBlKTsKKyAgICAgICAgICAgIGJyZWFrOworICAgICAgICBjYXNlIENEX0ZFQVRVUkVf
TlVNX1JBTkRPTV9SRUFEOgorICAgICAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9hZGRfZmVh
dHVyZV9yYW5kb21fcmVhZChkZXYsIG91dGJ1ZiArIHJlc3BfbGVuLCBzdGFydF9mZWF0dXJlLAor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBy
ZXFfdHlwZSk7CisgICAgICAgICAgICBicmVhazsKKyAgICAgICAgY2FzZSBDRF9GRUFUVVJFX05V
TV9DRF9SRUFEOgorICAgICAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9hZGRfZmVhdHVyZV9j
ZF9yZWFkKGRldiwgb3V0YnVmICsgcmVzcF9sZW4sIHN0YXJ0X2ZlYXR1cmUsCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxX3R5cGUpOworICAg
ICAgICAgICAgYnJlYWs7CisgICAgICAgIGNhc2UgQ0RfRkVBVFVSRV9OVU1fRFZEX1JFQUQ6Cisg
ICAgICAgICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9mZWF0dXJlX2R2ZF9yZWFkKGRldiwg
b3V0YnVmICsgcmVzcF9sZW4sIHN0YXJ0X2ZlYXR1cmUsCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcV90eXBlKTsKKyAgICAgICAgICAgIGJy
ZWFrOworICAgICAgICBjYXNlIENEX0ZFQVRVUkVfTlVNX1BPV0VSX01OR1Q6CisgICAgICAgICAg
ICByZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9mZWF0dXJlX3Bvd2VyX21nbXQoZGV2LCBvdXRidWYg
KyByZXNwX2xlbiwgc3RhcnRfZmVhdHVyZSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICByZXFfdHlwZSk7CisgICAgICAgICAgICBicmVhazsK
KyAgICAgICAgY2FzZSBDRF9GRUFUVVJFX05VTV9USU1FT1VUOgorICAgICAgICAgICAgcmVzcF9s
ZW4gKz0gY2Rfc2NzaV9hZGRfZmVhdHVyZV90aW1lb3V0KGRldiwgb3V0YnVmICsgcmVzcF9sZW4s
IHN0YXJ0X2ZlYXR1cmUsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgcmVxX3R5cGUpOworICAgICAgICAgICAgYnJlYWs7CisgICAgICAgIGRlZmF1
bHQ6CisgICAgICAgICAgICBicmVhazsKKyAgICAgICAgfQorICAgICAgICBicmVhazsKKworICAg
IGRlZmF1bHQ6CisgICAgICAgIFNQSUNFX0RFQlVHKCJnZXRfY29uZmlndXJhdGlvbiwgbHVuOiUi
IEdfR1VJTlQzMl9GT1JNQVQKKyAgICAgICAgICAgICAgICAgICAgIiBpbnZhbGlkIHJ0OiUiIEdf
R1VJTlQzMl9GT1JNQVQgIiBzdGFydF9mOiUiIEdfR1VJTlQzMl9GT1JNQVQsCisgICAgICAgICAg
ICAgICAgICAgIHJlcS0+bHVuLCByZXFfdHlwZSwgc3RhcnRfZmVhdHVyZSk7CisgICAgICAgIGNk
X3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX0lOVkFM
SURfQ0RCX0ZJRUxEKTsKKyAgICAgICAgcmV0dXJuOworICAgIH0KKworICAgIC8qIHNldCB0b3Rh
bCBkYXRhIGxlbiAqLworICAgIG91dGJ1ZlswXSA9IChyZXNwX2xlbiA+PiAyNCkgJiAweGZmOwor
ICAgIG91dGJ1ZlsxXSA9IChyZXNwX2xlbiA+PiAxNikgJiAweGZmOworICAgIG91dGJ1ZlsyXSA9
IChyZXNwX2xlbiA+PiA4KSAmIDB4ZmY7CisgICAgb3V0YnVmWzNdID0gcmVzcF9sZW4gJiAweGZm
OworCisgICAgLyogcmVwb3J0IGN1cnJlbnQgcHJvZmlsZSBudW0gKi8KKyAgICBvdXRidWZbNl0g
PSAocHJvZmlsZV9udW0gPj4gOCkgJiAweGZmOworICAgIG91dGJ1Zls3XSA9IHByb2ZpbGVfbnVt
ICYgMHhmZjsKKworICAgIHJlcS0+aW5fbGVuID0gKHJlcS0+cmVxX2xlbiA8IHJlc3BfbGVuKSA/
IHJlcS0+cmVxX2xlbiA6IHJlc3BfbGVuOworCisgICAgU1BJQ0VfREVCVUcoImdldF9jb25maWd1
cmF0aW9uLCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVAorICAgICAgICAgICAgICAgICIgcnQ6JSIg
R19HVUlOVDMyX0ZPUk1BVCAiIHN0YXJ0X2Y6JSIgR19HVUlOVDMyX0ZPUk1BVAorICAgICAgICAg
ICAgICAgICIgcmVzcF9sZW46JSIgR19HVUlOVDMyX0ZPUk1BVCwKKyAgICAgICAgICAgICAgICBy
ZXEtPmx1biwgcmVxX3R5cGUsIHN0YXJ0X2ZlYXR1cmUsIHJlc3BfbGVuKTsKKworICAgIGNkX3Nj
c2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2LCByZXEpOworfQorCisjZGVmaW5lIENEX0dFVF9FVkVO
VF9TVEFUVVNfSU1NRUQgICAgICAgICAgICAweDAxCisKKyNkZWZpbmUgQ0RfR0VUX0VWRU5UX0hF
QURFUl9OT19FVkVOVF9BVkFJTCAgKDB4MDEgPDwgNykKKyNkZWZpbmUgQ0RfR0VUX0VWRU5UX0hF
QURFUl9MRU4gICAgICAgICAgICAgNAorCisjZGVmaW5lIENEX0dFVF9FVkVOVF9DTEFTU19OT05F
ICAgICAgICAgICAgICgweDAwKQorI2RlZmluZSBDRF9HRVRfRVZFTlRfQ0xBU1NfT1BFUl9DSEFO
R0UgICAgICAoMHgwMSkKKyNkZWZpbmUgQ0RfR0VUX0VWRU5UX0NMQVNTX1BPV0VSX01HTVQgICAg
ICAgKDB4MDIpCisjZGVmaW5lIENEX0dFVF9FVkVOVF9DTEFTU19FWFRFUk5BTF9SRVEgICAgICgw
eDAzKQorI2RlZmluZSBDRF9HRVRfRVZFTlRfQ0xBU1NfTUVESUEgICAgICAgICAgICAoMHgwNCkK
KyNkZWZpbmUgQ0RfR0VUX0VWRU5UX0NMQVNTX01VTFRJX0lOSVRJQVRPUiAgKDB4MDUpCisjZGVm
aW5lIENEX0dFVF9FVkVOVF9DTEFTU19ERVZfQlVTWSAgICAgICAgICgweDA2KQorCisjZGVmaW5l
IENEX0dFVF9FVkVOVF9MRU5fTUVESUEgICAgICAgICAgICAgIDQKKworI2RlZmluZSBDRF9NRURJ
QV9TVEFUVVNfTUVESUFfUFJFU0VOVCAgICAgICAweDEKKyNkZWZpbmUgQ0RfTUVESUFfU1RBVFVT
X1RSQVlfT1BFTiAgICAgICAgICAgMHgyCisKK3N0YXRpYyB1aW50MzJfdCBjZF9zY3NpX2NtZF9n
ZXRfZXZlbnRfcmVzcF9hZGRfbWVkaWEoQ2RTY3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVmKQor
eworICAgIG91dGJ1ZlswXSA9ICh1aW50OF90KWRldi0+bWVkaWFfZXZlbnQgJiAweDBmOworICAg
IG91dGJ1ZlsxXSA9ICh1aW50OF90KSgoZGV2LT5sb2FkZWQgPyAwIDogQ0RfTUVESUFfU1RBVFVT
X1RSQVlfT1BFTikgfAorICAgICAgICAgICAgICAgICAgICAgICAgICAoZGV2LT5zdHJlYW0gIT0g
TlVMTCA/IENEX01FRElBX1NUQVRVU19NRURJQV9QUkVTRU5UIDogMCkpOworCisgICAgZGV2LT5t
ZWRpYV9ldmVudCA9IENEX01FRElBX0VWRU5UX05PX0NIQU5HRTsgLyogcmVzZXQgdGhlIGV2ZW50
ICovCisgICAgcmV0dXJuIENEX0dFVF9FVkVOVF9MRU5fTUVESUE7Cit9CisKKyNkZWZpbmUgQ0Rf
R0VUX0VWRU5UX0xFTl9QT1dFUiAgICAgICAgICAgICAgNAorCisjZGVmaW5lIENEX1BPV0VSX1NU
QVRVU19BQ1RJVkUgICAgICAgICAgICAgIDB4MQorI2RlZmluZSBDRF9QT1dFUl9TVEFUVVNfSURM
RSAgICAgICAgICAgICAgICAweDIKKworc3RhdGljIHVpbnQzMl90IGNkX3Njc2lfY21kX2dldF9l
dmVudF9yZXNwX2FkZF9wb3dlcihDZFNjc2lMVSAqZGV2LCB1aW50OF90ICpvdXRidWYpCit7Cisg
ICAgb3V0YnVmWzBdID0gKHVpbnQ4X3QpZGV2LT5wb3dlcl9ldmVudCAmIDB4MGY7CisgICAgb3V0
YnVmWzFdID0gKHVpbnQ4X3QpKChkZXYtPnBvd2VyX2NvbmQgPT0gQ0RfU0NTSV9QT1dFUl9BQ1RJ
VkUpID8KKyAgICAgICAgICAgICAgICAgICAgICAgICAgIENEX1BPV0VSX1NUQVRVU19BQ1RJVkUg
OiBDRF9QT1dFUl9TVEFUVVNfSURMRSk7CisKKyAgICBkZXYtPnBvd2VyX2V2ZW50ID0gQ0RfUE9X
RVJfRVZFTlRfTk9fQ0hBTkdFOyAvKiByZXNldCB0aGUgZXZlbnQgKi8KKyAgICByZXR1cm4gQ0Rf
R0VUX0VWRU5UX0xFTl9QT1dFUjsKK30KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRfZ2V0X2V2
ZW50X3N0YXR1c19ub3RpZmljYXRpb24oQ2RTY3NpTFUgKmRldiwgQ2RTY3NpUmVxdWVzdCAqcmVx
KQoreworICAgIHVpbnQ4X3QgKm91dGJ1ZiA9IHJlcS0+YnVmOworICAgIHVpbnQzMl90IHJlc3Bf
bGVuID0gQ0RfR0VUX0VWRU5UX0hFQURFUl9MRU47CisgICAgY29uc3QgdWludDMyX3QgcG93ZXJf
Y2xhc3NfbWFzayA9ICgweDAxIDw8IENEX0dFVF9FVkVOVF9DTEFTU19QT1dFUl9NR01UKTsKKyAg
ICBjb25zdCB1aW50MzJfdCBtZWRpYV9jbGFzc19tYXNrID0gKDB4MDEgPDwgQ0RfR0VUX0VWRU5U
X0NMQVNTX01FRElBKTsKKyAgICB1aW50MzJfdCBjbGFzc2VzX3N1cHBvcnRlZCA9ICBwb3dlcl9j
bGFzc19tYXNrIHwgbWVkaWFfY2xhc3NfbWFzazsKKyAgICB1aW50MzJfdCBpbW1lZCwgY2xhc3Nl
c19yZXF1ZXN0ZWQ7CisKKyAgICByZXEtPnhmZXJfZGlyID0gU0NTSV9YRkVSX0ZST01fREVWOwor
CisgICAgaW1tZWQgPSByZXEtPmNkYlsxXSAmIENEX0dFVF9FVkVOVF9TVEFUVVNfSU1NRUQ7Cisg
ICAgY2xhc3Nlc19yZXF1ZXN0ZWQgPSByZXEtPmNkYls0XTsKKyAgICByZXEtPnJlcV9sZW4gPSAo
cmVxLT5jZGJbN10gPDwgOCkgfCByZXEtPmNkYls4XTsKKworICAgIGlmICghaW1tZWQpIHsKKyAg
ICAgICAgU1BJQ0VfREVCVUcoImdldF9ldmVudF9zdGF0dXNfbm90aWZpY2F0aW9uLCBsdW46JSIg
R19HVUlOVDMyX0ZPUk1BVAorICAgICAgICAgICAgICAgICIgaW1tOjAgY2xhc3NfcmVxOiUwMngs
IE5vbi1pbW1lZGlhdGUgKGFzeW5jKSBtb2RlIHVuc3VwcG9ydGVkIiwKKyAgICAgICAgICAgICAg
ICByZXEtPmx1biwgY2xhc3Nlc19yZXF1ZXN0ZWQpOworICAgICAgICBjZF9zY3NpX2NtZF9jb21w
bGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZBTElEX0NEQl9GSUVMRCk7
CisgICAgICAgIHJldHVybjsKKyAgICB9CisKKyAgICBtZW1zZXQob3V0YnVmLCAwLCByZXEtPnJl
cV9sZW4pOworICAgIGlmICgoY2xhc3Nlc19zdXBwb3J0ZWQgJiBjbGFzc2VzX3JlcXVlc3RlZCkg
IT0gMCkgeworICAgICAgICBpZiAoY2xhc3Nlc19yZXF1ZXN0ZWQgJiBwb3dlcl9jbGFzc19tYXNr
KSB7CisgICAgICAgICAgICBvdXRidWZbMl0gPSBDRF9HRVRfRVZFTlRfQ0xBU1NfUE9XRVJfTUdN
VDsKKyAgICAgICAgICAgIG91dGJ1ZlszXSA9ICh1aW50OF90KXBvd2VyX2NsYXNzX21hc2s7CisK
KyAgICAgICAgICAgIFNQSUNFX0RFQlVHKCJnZXRfZXZlbnRfc3RhdHVzX25vdGlmaWNhdGlvbiwg
bHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQKKyAgICAgICAgICAgICAgICAgICAgICAgICIgaW1tOiUi
IEdfR1VJTlQzMl9GT1JNQVQgIiBjbGFzc19yZXE6MHglMDJ4IGNsYXNzX3N1cDoweCUwMngiCisg
ICAgICAgICAgICAgICAgICAgICAgICAiIHBvd2VyX2V2ZW50OjB4JTAyeCBwb3dlcl9jb25kOjB4
JTAyeCIsCisgICAgICAgICAgICAgICAgICAgICAgICByZXEtPmx1biwgaW1tZWQsIGNsYXNzZXNf
cmVxdWVzdGVkLCBjbGFzc2VzX3N1cHBvcnRlZCwKKyAgICAgICAgICAgICAgICAgICAgICAgIGRl
di0+cG93ZXJfZXZlbnQsIGRldi0+cG93ZXJfY29uZCk7CisKKyAgICAgICAgICAgIHJlc3BfbGVu
ICs9IGNkX3Njc2lfY21kX2dldF9ldmVudF9yZXNwX2FkZF9wb3dlcihkZXYsIG91dGJ1ZiArIHJl
c3BfbGVuKTsKKyAgICAgICAgfSBlbHNlIGlmIChjbGFzc2VzX3JlcXVlc3RlZCAmIG1lZGlhX2Ns
YXNzX21hc2spIHsKKyAgICAgICAgICAgIG91dGJ1ZlsyXSA9IENEX0dFVF9FVkVOVF9DTEFTU19N
RURJQTsKKyAgICAgICAgICAgIG91dGJ1ZlszXSA9ICh1aW50OF90KW1lZGlhX2NsYXNzX21hc2s7
CisKKyAgICAgICAgICAgIFNQSUNFX0RFQlVHKCJnZXRfZXZlbnRfc3RhdHVzX25vdGlmaWNhdGlv
biwgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQKKyAgICAgICAgICAgICAgICAgICAgICAgICIgaW1t
OiUiIEdfR1VJTlQzMl9GT1JNQVQgIiBjbGFzc19yZXE6MHglMDJ4IGNsYXNzX3N1cDoweCUwMngi
CisgICAgICAgICAgICAgICAgICAgICAgICAiIG1lZGlhX2V2ZW50OjB4JTAyeCBsb2FkZWQ6ICVk
IiwKKyAgICAgICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBpbW1lZCwgY2xhc3Nlc19yZXF1
ZXN0ZWQsIGNsYXNzZXNfc3VwcG9ydGVkLAorICAgICAgICAgICAgICAgICAgICAgICAgZGV2LT5t
ZWRpYV9ldmVudCwgZGV2LT5sb2FkZWQpOworCisgICAgICAgICAgICByZXNwX2xlbiArPSBjZF9z
Y3NpX2NtZF9nZXRfZXZlbnRfcmVzcF9hZGRfbWVkaWEoZGV2LCBvdXRidWYgKyByZXNwX2xlbik7
CisgICAgICAgIH0KKyAgICB9IGVsc2UgeworICAgICAgICBvdXRidWZbMl0gPSBDRF9HRVRfRVZF
TlRfSEVBREVSX05PX0VWRU5UX0FWQUlMIHwgQ0RfR0VUX0VWRU5UX0NMQVNTX05PTkU7CisKKyAg
ICAgICAgU1BJQ0VfREVCVUcoImdldF9ldmVudF9zdGF0dXNfbm90aWZpY2F0aW9uLCBsdW46JSIg
R19HVUlOVDMyX0ZPUk1BVAorICAgICAgICAgICAgICAgICAgICAgICAgIiBpbW06JSIgR19HVUlO
VDMyX0ZPUk1BVCAiIGNsYXNzX3JlcToweCUwMnggY2xhc3Nfc3VwOjB4JTAyeCIKKyAgICAgICAg
ICAgICAgICAgICAgICAgICIgbm9uZSBvZiByZXF1ZXN0ZWQgZXZlbnRzIHN1cHBvcnRlZCIsCisg
ICAgICAgICAgICAgICAgICAgICAgICByZXEtPmx1biwgaW1tZWQsIGNsYXNzZXNfcmVxdWVzdGVk
LCBjbGFzc2VzX3N1cHBvcnRlZCk7CisgICAgfQorICAgIG91dGJ1ZlsxXSA9ICh1aW50OF90KShy
ZXNwX2xlbiAtIDIpOyAvKiBFdmVudCBEYXRhIExlbmd0aCBMU0IsIGxlbmd0aCBleGNsdWRpbmcg
dGhlCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGZpZWxkIGl0
c2VsZiAqLworICAgIG91dGJ1ZlszXSA9ICh1aW50OF90KWNsYXNzZXNfc3VwcG9ydGVkOworCisg
ICAgcmVxLT5pbl9sZW4gPSAocmVxLT5yZXFfbGVuIDwgcmVzcF9sZW4pID8gcmVxLT5yZXFfbGVu
IDogcmVzcF9sZW47CisgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfZ29vZChkZXYsIHJlcSk7Cit9
CisKKyNkZWZpbmUgQ0RfRVhUX1JFUV9FVkVOVF9GT1JNQVRfTk9fQ0hHICAgICAgICAgIDB4MDAK
KyNkZWZpbmUgQ0RfRVhUX1JFUV9FVkVOVF9GT1JNQVRfTFVfS0VZX0RPV04gICAgIDB4MDEKKyNk
ZWZpbmUgQ0RfRVhUX1JFUV9FVkVOVF9GT1JNQVRfTFVfS0VZX1VQICAgICAgIDB4MDIKKyNkZWZp
bmUgQ0RfRVhUX1JFUV9FVkVOVF9GT1JNQVRfUkVRX05PVElGWSAgICAgIDB4MDMKKworI2RlZmlu
ZSBDRF9FWFRfUkVRX1NUQVRVU19SRUFEWSAgICAgICAgICAgICAgICAgMHgwMAorI2RlZmluZSBD
RF9FWFRfUkVRX1NUQVRVU19PVEhFUl9QUkVWRU5UICAgICAgICAgMHgwMQorCisjZGVmaW5lIENE
X0VYVF9SRVFfQ09ERV9OT19SRVFVRVNUICAgICAgICAgICAgICAweDAwCisjZGVmaW5lIENEX0VY
VF9SRVFfQ09ERV9PVkVSUlVOICAgICAgICAgICAgICAgICAweDAxCisjZGVmaW5lIENEX0VYVF9S
RVFfQ09ERV9QTEFZICAgICAgICAgICAgICAgICAgICAweDEwMQorI2RlZmluZSBDRF9FWFRfUkVR
X0NPREVfUkVXSU5EICAgICAgICAgICAgICAgICAgMHgxMDIKKyNkZWZpbmUgQ0RfRVhUX1JFUV9D
T0RFX0ZBU1RfRlcgICAgICAgICAgICAgICAgIDB4MTAzCisjZGVmaW5lIENEX0VYVF9SRVFfQ09E
RV9QQVVTRSAgICAgICAgICAgICAgICAgICAweDEwNAorI2RlZmluZSBDRF9FWFRfUkVRX0NPREVf
U1RPUCAgICAgICAgICAgICAgICAgICAgMHgxMDYKKyNkZWZpbmUgQ0RfRVhUX1JFUV9DT0RFX0FT
Q0lJX0JBU0UgICAgICAgICAgICAgIDB4MjAwIC8qIFNDU0lJIHZhbHVlIGlzIExTQiAqLworCitz
dGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9zZW5kX2V2ZW50KENkU2NzaUxVICpkZXYsIENkU2NzaVJl
cXVlc3QgKnJlcSkKK3sKKyAgICB1aW50OF90ICpwYXJhbSwgKmV2ZW50OworICAgIHVpbnQzMl90
IGltbWVkLCBwYXJhbV9saXN0X2xlbjsKKyAgICB1aW50MzJfdCBldmVudF9wYXJhbV9sZW4sIG5v
dGlmaWNhdGlvbl9jbGFzczsKKyAgICB1aW50MzJfdCBleHRfcmVxX2V2ZW50LCBleHRfcmVxX3N0
YXR1cywgcGVyc19wcmV2ZW50LCBleHRfcmVxX2NvZGU7CisKKyAgICByZXEtPnhmZXJfZGlyID0g
U0NTSV9YRkVSX1RPX0RFVjsKKworICAgIGltbWVkID0gcmVxLT5jZGJbMV0gJiAweDAxOworICAg
IHBhcmFtX2xpc3RfbGVuID0gKHJlcS0+Y2RiWzhdIDw8IDgpIHwgcmVxLT5jZGJbOV07CisKKyAg
ICBpZiAocmVxLT5idWZfbGVuIDwgcGFyYW1fbGlzdF9sZW4pIHsKKyAgICAgICAgU1BJQ0VfREVC
VUcoInNlbmRfZXZlbnQsIGx1bjolIiBHX0dVSU5UMzJfRk9STUFUCisgICAgICAgICAgICAgICAg
ICAgICIgaW52YWxpZCBwYXJhbSBsaXN0IGxlbjoweCV4LCBidWZfbGVuOjB4JXgiLAorICAgICAg
ICAgICAgICAgICAgICByZXEtPmx1biwgcGFyYW1fbGlzdF9sZW4sIHJlcS0+YnVmX2xlbik7Cisg
ICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9j
b2RlX0lOVkFMSURfUEFSQU1fTEVOKTsKKyAgICAgICAgcmV0dXJuOworICAgIH0KKyAgICBwYXJh
bSA9IHJlcS0+YnVmOworICAgIGV2ZW50X3BhcmFtX2xlbiA9IChwYXJhbVswXSA8PCA4KSB8IHBh
cmFtWzFdOworCisgICAgbm90aWZpY2F0aW9uX2NsYXNzID0gcGFyYW1bMl0gJiAweDA3OworICAg
IGlmIChub3RpZmljYXRpb25fY2xhc3MgIT0gQ0RfR0VUX0VWRU5UX0NMQVNTX0VYVEVSTkFMX1JF
USkgeworICAgICAgICBTUElDRV9ERUJVRygic2VuZF9ldmVudCwgbHVuOiUiIEdfR1VJTlQzMl9G
T1JNQVQKKyAgICAgICAgICAgICAgICAgICAgIiBpbnZhbGlkIG5vdGlmaWNhdGlvbiBjbGFzczow
eCV4IiwKKyAgICAgICAgICAgICAgICAgICAgcmVxLT5sdW4sIG5vdGlmaWNhdGlvbl9jbGFzcyk7
CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5z
ZV9jb2RlX0lOVkFMSURfQ0RCX0ZJRUxEKTsKKyAgICAgICAgcmV0dXJuOworICAgIH0KKworICAg
IGV2ZW50ID0gcGFyYW0gKyBDRF9HRVRfRVZFTlRfSEVBREVSX0xFTjsKKyAgICBleHRfcmVxX2V2
ZW50ID0gZXZlbnRbMF0gJiAweGZmOworICAgIGV4dF9yZXFfc3RhdHVzID0gZXZlbnRbMV0gJiAw
eDBmOworICAgIHBlcnNfcHJldmVudCA9IGV2ZW50WzFdICYgMHg4MDsKKyAgICBleHRfcmVxX2Nv
ZGUgPSAoZXZlbnRbMl0gPDwgOCkgfCBldmVudFszXTsKKworICAgIFNQSUNFX0RFQlVHKCJzZW5k
X2V2ZW50LCBsdW46MHglIiBHX0dVSU5UMzJfRk9STUFUCisgICAgICAgICAgICAgICAgIiBpbW1l
ZDolIiBHX0dVSU5UMzJfRk9STUFUICIgcGFyYW1fbGVuOiUiIEdfR1VJTlQzMl9GT1JNQVQKKyAg
ICAgICAgICAgICAgICAiIGV4dF9yZXFfZXZlbnQ6MHgleCBleHRfcmVxX3N0YXR1czoweCV4Igor
ICAgICAgICAgICAgICAgICIgcGVyc19wcmV2ZW50OjB4JXggZXh0X3JlcV9jb2RlOjB4JXgiLAor
ICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBpbW1lZCwgZXZlbnRfcGFyYW1fbGVuLCBleHRfcmVx
X2V2ZW50LAorICAgICAgICAgICAgICAgIGV4dF9yZXFfc3RhdHVzLCBwZXJzX3ByZXZlbnQsIGV4
dF9yZXFfY29kZSk7CisKKyAgICAvKiBUb0RvOiBwcm9jZXNzIHRoZSBldmVudCAqLworCisgICAg
Y2Rfc2NzaV9jbWRfY29tcGxldGVfZ29vZChkZXYsIHJlcSk7Cit9CisKKyNkZWZpbmUgQ0RfTUVE
SVVNX1JFTU9WQUxfUkVRX0FMTE9XICAgICAgICAgICAgICAgICAweDAwCisjZGVmaW5lIENEX01F
RElVTV9SRU1PVkFMX1JFUV9QUkVWRU5UICAgICAgICAgICAgICAgMHgwMQorI2RlZmluZSBDRF9N
RURJVU1fUkVNT1ZBTF9SRVFfQUxMT1dfQ0hBTkdFUiAgICAgICAgIDB4MDIKKyNkZWZpbmUgQ0Rf
TUVESVVNX1JFTU9WQUxfUkVRX1BSRVZFTlRfQ0hBTkdFUiAgICAgICAweDAzCisKK3N0YXRpYyB2
b2lkIGNkX3Njc2lfY21kX2FsbG93X21lZGl1bV9yZW1vdmFsKENkU2NzaUxVICpkZXYsIENkU2Nz
aVJlcXVlc3QgKnJlcSkKK3sKKyAgICB1aW50MzJfdCBwcmV2ZW50OworCisgICAgcmVxLT54ZmVy
X2RpciA9IFNDU0lfWEZFUl9GUk9NX0RFVjsKKworICAgIHByZXZlbnQgPSByZXEtPmNkYls0XSAm
IDB4MDM7CisgICAgZGV2LT5wcmV2ZW50X21lZGlhX3JlbW92YWwgPSAocHJldmVudCA9PSBDRF9N
RURJVU1fUkVNT1ZBTF9SRVFfUFJFVkVOVCB8fAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHByZXZlbnQgPT0gQ0RfTUVESVVNX1JFTU9WQUxfUkVRX1BSRVZFTlRfQ0hBTkdFUik7
CisgICAgcmVxLT5pbl9sZW4gPSAwOworCisgICAgU1BJQ0VfREVCVUcoImFsbG93X21lZGl1bV9y
ZW1vdmFsLCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCAiIHByZXZlbnQgZmllbGQ6OjB4JTAyeCBm
bGFnOiVkIiwKKyAgICAgICAgICAgICAgICByZXEtPmx1biwgcHJldmVudCwgZGV2LT5wcmV2ZW50
X21lZGlhX3JlbW92YWwpOworCisgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfZ29vZChkZXYsIHJl
cSk7Cit9CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX3JlcG9ydF9rZXkoQ2RTY3NpTFUgKmRl
diwgQ2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAgIFNQSUNFX0RFQlVHKCJyZXBvcnRfa2V5IC0g
Y29udGVudCBwcm90ZWN0aW9uIHVuc3VwcG9ydGVkLCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCwg
cmVxLT5sdW4pOworICAgIHJlcS0+eGZlcl9kaXIgPSBTQ1NJX1hGRVJfTk9ORTsKKyAgICBjZF9z
Y3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZBTElE
X09QQ09ERSk7Cit9CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX3NlbmRfa2V5KENkU2NzaUxV
ICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICBTUElDRV9ERUJVRygic2VuZF9rZXkg
LSBjb250ZW50IHByb3RlY3Rpb24gdW5zdXBwb3J0ZWQsIGx1bjolIiBHX0dVSU5UMzJfRk9STUFU
LCByZXEtPmx1bik7CisgICAgcmVxLT54ZmVyX2RpciA9IFNDU0lfWEZFUl9OT05FOworICAgIGNk
X3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX0lOVkFM
SURfT1BDT0RFKTsKK30KKworLyogYnl0ZSAxICovCisjZGVmaW5lIENEX1NUQVJUX1NUT1BfRkxB
R19JTU1FRCAgICAgICAgICAgICAgICAgICAgMHgwMQorCisvKiBieXRlIDQgKi8KKyNkZWZpbmUg
Q0RfU1RBUlRfU1RPUF9GTEFHX1NUQVJUICAgICAgICAgICAgICAgICAgICAweDAxCisjZGVmaW5l
IENEX1NUQVJUX1NUT1BfRkxBR19MT0VKICAgICAgICAgICAgICAgICAgICAgMHgwMgorCisvKiBQ
T1dFUiBDT05ESVRJT04gZmllbGQgdmFsdWVzICovCisjZGVmaW5lIENEX1NUQVJUX1NUT1BfUE9X
RVJfQ09ORF9TVEFSVF9WQUxJRCAgICAgICAgMHgwMAorI2RlZmluZSBDRF9TVEFSVF9TVE9QX1BP
V0VSX0NPTkRfQUNUSVZFICAgICAgICAgICAgIDB4MDEKKyNkZWZpbmUgQ0RfU1RBUlRfU1RPUF9Q
T1dFUl9DT05EX0lETEUgICAgICAgICAgICAgICAweDAyCisjZGVmaW5lIENEX1NUQVJUX1NUT1Bf
UE9XRVJfQ09ORF9TVEFOREJZICAgICAgICAgICAgMHgwMworI2RlZmluZSBDRF9TVEFSVF9TVE9Q
X1BPV0VSX0NPTkRfTFVfQ09OVFJPTCAgICAgICAgIDB4MDcKKyNkZWZpbmUgQ0RfU1RBUlRfU1RP
UF9QT1dFUl9DT05EX0ZPUkNFX0lETEVfMCAgICAgICAweDBhCisjZGVmaW5lIENEX1NUQVJUX1NU
T1BfUE9XRVJfQ09ORF9GT1JDRV9TVEFOREJZXzAgICAgMHgwYgorCitzdGF0aWMgaW5saW5lIGNv
bnN0IGNoYXIgKmNkX3Njc2lfc3RhcnRfc3RvcF9wb3dlcl9jb25kX25hbWUodWludDMyX3QgcG93
ZXJfY29uZCkKK3sKKyAgICBzd2l0Y2ggKHBvd2VyX2NvbmQpIHsKKyAgICBjYXNlIENEX1NUQVJU
X1NUT1BfUE9XRVJfQ09ORF9TVEFSVF9WQUxJRDoKKyAgICAgICAgcmV0dXJuICJTVEFSVF9WQUxJ
RCI7CisgICAgY2FzZSBDRF9TVEFSVF9TVE9QX1BPV0VSX0NPTkRfQUNUSVZFOgorICAgICAgICBy
ZXR1cm4gIkFDVElWRSI7CisgICAgY2FzZSBDRF9TVEFSVF9TVE9QX1BPV0VSX0NPTkRfSURMRToK
KyAgICAgICAgcmV0dXJuICJJRExFIjsKKyAgICBjYXNlIENEX1NUQVJUX1NUT1BfUE9XRVJfQ09O
RF9TVEFOREJZOgorICAgICAgICByZXR1cm4gIlNUQU5EQlkiOworICAgIGNhc2UgQ0RfU1RBUlRf
U1RPUF9QT1dFUl9DT05EX0xVX0NPTlRST0w6CisgICAgICAgIHJldHVybiAiTFVfQ09OVFJPTCI7
CisgICAgY2FzZSBDRF9TVEFSVF9TVE9QX1BPV0VSX0NPTkRfRk9SQ0VfSURMRV8wOgorICAgICAg
ICByZXR1cm4gIkZPUkNFX0lETEVfMCI7CisgICAgY2FzZSBDRF9TVEFSVF9TVE9QX1BPV0VSX0NP
TkRfRk9SQ0VfU1RBTkRCWV8wOgorICAgICAgICByZXR1cm4gIkZPUkNFX1NUQU5EQllfMCI7Cisg
ICAgZGVmYXVsdDoKKyAgICAgICAgcmV0dXJuICJSRVNFUlZFRCI7CisgICAgfQorfQorCitzdGF0
aWMgdm9pZCBjZF9zY3NpX2NtZF9zdGFydF9zdG9wX3VuaXQoQ2RTY3NpTFUgKmRldiwgQ2RTY3Np
UmVxdWVzdCAqcmVxKQoreworICAgIGdib29sZWFuIGltbWVkLCBzdGFydCwgbG9hZF9lamVjdDsK
KyAgICB1aW50MzJfdCBwb3dlcl9jb25kOworCisgICAgcmVxLT54ZmVyX2RpciA9IFNDU0lfWEZF
Ul9OT05FOworICAgIHJlcS0+aW5fbGVuID0gMDsKKworICAgIGltbWVkID0gKHJlcS0+Y2RiWzFd
ICYgQ0RfU1RBUlRfU1RPUF9GTEFHX0lNTUVEKSA/IFRSVUUgOiBGQUxTRTsKKyAgICBzdGFydCA9
IChyZXEtPmNkYls0XSAmIENEX1NUQVJUX1NUT1BfRkxBR19TVEFSVCkgPyBUUlVFIDogRkFMU0U7
CisgICAgbG9hZF9lamVjdCA9IChyZXEtPmNkYls0XSAmIENEX1NUQVJUX1NUT1BfRkxBR19MT0VK
KSA/IFRSVUUgOiBGQUxTRTsKKyAgICBwb3dlcl9jb25kID0gcmVxLT5jZGJbNF0gPj4gNDsKKwor
ICAgIFNQSUNFX0RFQlVHKCJzdGFydF9zdG9wX3VuaXQsIGx1bjoweCUiIEdfR1VJTlQzMl9GT1JN
QVQKKyAgICAgICAgICAgICAgICAiIGltbWVkOiVkIHN0YXJ0OiVkIGxvYWRfZWplY3Q6JWQgcG93
ZXJfY29uZDoweCV4KCVzKSIsCisgICAgICAgICAgICAgICAgcmVxLT5sdW4sIGltbWVkLCBzdGFy
dCwgbG9hZF9lamVjdCwgcG93ZXJfY29uZCwKKyAgICAgICAgICAgICAgICBjZF9zY3NpX3N0YXJ0
X3N0b3BfcG93ZXJfY29uZF9uYW1lKHBvd2VyX2NvbmQpKTsKKworICAgIHN3aXRjaCAocG93ZXJf
Y29uZCkgeworICAgIGNhc2UgQ0RfU1RBUlRfU1RPUF9QT1dFUl9DT05EX1NUQVJUX1ZBTElEOgor
ICAgICAgICBpZiAoIXN0YXJ0KSB7IC8qIHN0b3AgdGhlIHVuaXQgKi8KKyAgICAgICAgICAgIGlm
IChsb2FkX2VqZWN0KSB7IC8qIGVqZWN0IG1lZGl1bSAqLworICAgICAgICAgICAgICAgIGlmIChk
ZXYtPnByZXZlbnRfbWVkaWFfcmVtb3ZhbCkgeworICAgICAgICAgICAgICAgICAgICBTUElDRV9E
RUJVRygic3RhcnRfc3RvcF91bml0LCBsdW46MHglIiBHX0dVSU5UMzJfRk9STUFUCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICIgcHJldmVudF9tZWRpYV9yZW1vdmFsIHNldCwgZWpl
Y3QgZmFpbGVkIiwgcmVxLT5sdW4pOworICAgICAgICAgICAgICAgICAgICBjZF9zY3NpX2NtZF9j
b21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9NRURJVU1fUkVNT1ZBTF9Q
UkVWRU5URUQpOworICAgICAgICAgICAgICAgICAgICByZXR1cm47CisgICAgICAgICAgICAgICAg
fQorICAgICAgICAgICAgICAgIFNQSUNFX0RFQlVHKCJzdGFydF9zdG9wX3VuaXQsIGx1bjoweCUi
IEdfR1VJTlQzMl9GT1JNQVQgIiBlamVjdCIsIHJlcS0+bHVuKTsKKyAgICAgICAgICAgICAgICBj
ZF9zY3NpX2x1X3VubG9hZChkZXYpOworICAgICAgICAgICAgICAgIGNkX3Njc2lfZGV2X2NoYW5n
ZWQoZGV2LT50Z3QtPnVzZXJfZGF0YSwgcmVxLT5sdW4pOworICAgICAgICAgICAgfQorICAgICAg
ICAgICAgZGV2LT5wb3dlcl9jb25kID0gQ0RfU0NTSV9QT1dFUl9TVE9QUEVEOworICAgICAgICAg
ICAgU1BJQ0VfREVCVUcoInN0YXJ0X3N0b3BfdW5pdCwgbHVuOjB4JSIgR19HVUlOVDMyX0ZPUk1B
VCAiIHN0b3BwZWQiLCByZXEtPmx1bik7CisgICAgICAgIH0gZWxzZSB7IC8qIHN0YXJ0IHRoZSB1
bml0ICovCisgICAgICAgICAgICBkZXYtPnBvd2VyX2NvbmQgPSBDRF9TQ1NJX1BPV0VSX0FDVElW
RTsKKyAgICAgICAgICAgIFNQSUNFX0RFQlVHKCJzdGFydF9zdG9wX3VuaXQsIGx1bjoweCUiIEdf
R1VJTlQzMl9GT1JNQVQgIiBzdGFydGVkIiwgcmVxLT5sdW4pOworCisgICAgICAgICAgICBpZiAo
bG9hZF9lamVjdCkgeyAvKiBsb2FkIG1lZGl1bSAqLworICAgICAgICAgICAgICAgIFNQSUNFX0RF
QlVHKCJzdGFydF9zdG9wX3VuaXQsIGx1bjoweCUiIEdfR1VJTlQzMl9GT1JNQVQgIiBsb2FkIHdp
dGggbm8gbWVkaWEiLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuKTsKKyAg
ICAgICAgICAgICAgICBjZF9zY3NpX2x1X2xvYWQoZGV2LCBOVUxMKTsKKyAgICAgICAgICAgICAg
ICBjZF9zY3NpX2Rldl9jaGFuZ2VkKGRldi0+dGd0LT51c2VyX2RhdGEsIHJlcS0+bHVuKTsKKyAg
ICAgICAgICAgIH0KKyAgICAgICAgfQorICAgICAgICBicmVhazsKKyAgICBjYXNlIENEX1NUQVJU
X1NUT1BfUE9XRVJfQ09ORF9BQ1RJVkU6CisgICAgICAgIC8qIG5vdCBlcnJvciB0byBzcGVjaWZ5
IHRyYW5zaXRpb24gdG8gdGhlIGN1cnJlbnQgcG93ZXIgY29uZGl0aW9uICovCisgICAgICAgIGRl
di0+cG93ZXJfY29uZCA9IENEX1NDU0lfUE9XRVJfQUNUSVZFOworICAgICAgICBTUElDRV9ERUJV
Rygic3RhcnRfc3RvcF91bml0LCBsdW46MHglIiBHX0dVSU5UMzJfRk9STUFUICIgYWN0aXZlIiwg
cmVxLT5sdW4pOworICAgICAgICBicmVhazsKKyAgICBjYXNlIENEX1NUQVJUX1NUT1BfUE9XRVJf
Q09ORF9JRExFOgorICAgIGNhc2UgQ0RfU1RBUlRfU1RPUF9QT1dFUl9DT05EX0ZPUkNFX0lETEVf
MDoKKyAgICAgICAgZGV2LT5wb3dlcl9jb25kID0gQ0RfU0NTSV9QT1dFUl9JRExFOworICAgICAg
ICBTUElDRV9ERUJVRygic3RhcnRfc3RvcF91bml0LCBsdW46MHglIiBHX0dVSU5UMzJfRk9STUFU
ICIgaWRsZSIsIHJlcS0+bHVuKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBDRF9TVEFSVF9T
VE9QX1BPV0VSX0NPTkRfU1RBTkRCWToKKyAgICBjYXNlIENEX1NUQVJUX1NUT1BfUE9XRVJfQ09O
RF9GT1JDRV9TVEFOREJZXzA6CisgICAgICAgIGRldi0+cG93ZXJfY29uZCA9IENEX1NDU0lfUE9X
RVJfU1RBTkRCWTsKKyAgICAgICAgU1BJQ0VfREVCVUcoInN0YXJ0X3N0b3BfdW5pdCwgbHVuOjB4
JSIgR19HVUlOVDMyX0ZPUk1BVCAiIHN0YW5kYnkiLCByZXEtPmx1bik7CisgICAgICAgIGJyZWFr
OworICAgIGNhc2UgQ0RfU1RBUlRfU1RPUF9QT1dFUl9DT05EX0xVX0NPTlRST0w6CisgICAgICAg
IGJyZWFrOworICAgIGRlZmF1bHQ6CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNr
X2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX0lOVkFMSURfQ0RCX0ZJRUxEKTsKKyAgICAgICAg
cmV0dXJuOworICAgIH0KKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsK
K30KKworI2RlZmluZSBDRF9QRVJGX1RZUEVfUEVSRk9STUFOQ0UgICAgICAgICAgICAgICAgMHgw
MAorI2RlZmluZSBDRF9QRVJGX1RZUEVfVU5VU0FCTEVfQVJFQSAgICAgICAgICAgICAgMHgwMQor
I2RlZmluZSBDRF9QRVJGX1RZUEVfREVGRUNUX1NUQVRVUyAgICAgICAgICAgICAgMHgwMgorI2Rl
ZmluZSBDRF9QRVJGX1RZUEVfV1JJVEVfU1BFRUQgICAgICAgICAgICAgICAgMHgwMworCisjZGVm
aW5lIENEX1BFUkZfSEVBREVSX0xFTiAgICAgICAgICAgICAgICAgICAgICA4CisKKyNkZWZpbmUg
Q0RfUEVSRl9UWVBFX1BFUkZPUk1BTkNFX0RFU0NSX0xFTiAgICAgIDE2CisKKyNkZWZpbmUgQ0Rf
UEVSRl9UWVBFX1BFUkZPUk1BTkNFX1JFUE9SVF9OT01JTkFMIDB4MDAKKyNkZWZpbmUgQ0RfUEVS
Rl9UWVBFX1BFUkZPUk1BTkNFX1JFUE9SVF9BTEwgICAgIDB4MDEKKyNkZWZpbmUgQ0RfUEVSRl9U
WVBFX1BFUkZPUk1BTkNFX1JFUE9SVF9FWENFUFQgIDB4MTAKKworCitzdGF0aWMgdm9pZCBjZF9z
Y3NpX2dldF9wZXJmb3JtYW5jZV9yZXNwX2VtcHR5KENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVl
c3QgKnJlcSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
dWludDMyX3QgdHlwZSwgdWludDMyX3QgZGF0YV90eXBlLAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCBtYXhfbnVtX2Rlc2NyKQoreworICAg
IHVpbnQ4X3QgKm91dGJ1ZiA9IHJlcS0+YnVmOworICAgIHVpbnQzMl90IHdyaXRlID0gKGRhdGFf
dHlwZSA+PiAyKSAmIDB4MDE7CisKKyAgICBtZW1zZXQob3V0YnVmLCAwLCBDRF9QRVJGX0hFQURF
Ul9MRU4pOworICAgIGlmICh3cml0ZSkgeworICAgICAgICBvdXRidWZbNF0gPSAweDAyOworICAg
IH0KKyAgICByZXEtPmluX2xlbiA9IENEX1BFUkZfSEVBREVSX0xFTjsKKworICAgIFNQSUNFX0RF
QlVHKCJnZXRfcGVyZm9ybWFuY2UsIGx1bjolIiBHX0dVSU5UMzJfRk9STUFUCisgICAgICAgICAg
ICAgICAgIiB0eXBlOjB4JXggZGF0YV90eXBlOjB4JXggLSBzZW5kaW5nIGVtcHR5IHJlc3BvbnNl
IiwKKyAgICAgICAgICAgICAgICByZXEtPmx1biwgdHlwZSwgZGF0YV90eXBlKTsKKworICAgIGNk
X3Njc2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2LCByZXEpOworfQorCitzdGF0aWMgdm9pZCBjZF9z
Y3NpX2dldF9wZXJmb3JtYW5jZV9yZXNwX3BlcmZvcm1hbmNlKENkU2NzaUxVICpkZXYsIENkU2Nz
aVJlcXVlc3QgKnJlcSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgdWludDMyX3Qgc3RhcnRfbGJhLAorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCBkYXRhX3R5cGUsCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IG1h
eF9udW1fZGVzY3IpCit7CisgICAgdWludDhfdCAqb3V0YnVmID0gcmVxLT5idWYsICpwZXJmX2Rl
c2M7CisgICAgdWludDMyX3QgcmVzcF9sZW4gPSBDRF9QRVJGX0hFQURFUl9MRU4gKworICAgICAg
ICAgICAgICAgICAgICAgICAgQ0RfUEVSRl9UWVBFX1BFUkZPUk1BTkNFX0RFU0NSX0xFTjsKKyAg
ICB1aW50MzJfdCBwZXJmX2RhdGFfbGVuID0gcmVzcF9sZW4gLSA0OyAvKiBub3QgaW5jbC4gUGVy
ZiBEYXRhIExlbmd0aCAqLworICAgIHVpbnQzMl90IHBlcmZfa2IgPSAxMDAwMDsKKyAgICB1aW50
MzJfdCBlbmRfbGJhID0gZGV2LT5udW1fYmxvY2tzIC0gMTsKKyAgICB1aW50MzJfdCBleGNlcHQs
IHdyaXRlLCB0b2xlcmFuY2U7CisKKyAgICBleGNlcHQgPSBkYXRhX3R5cGUgJiAweDAzOworICAg
IGlmIChleGNlcHQgIT0gQ0RfUEVSRl9UWVBFX1BFUkZPUk1BTkNFX1JFUE9SVF9BTEwpIHsKKyAg
ICAgICAgc3RhcnRfbGJhID0gMDsKKyAgICB9CisgICAgd3JpdGUgPSAoZGF0YV90eXBlID4+IDIp
ICYgMHgwMTsKKyAgICB0b2xlcmFuY2UgPSAoZGF0YV90eXBlID4+IDMpICYgMHgwMzsKKworICAg
IFNQSUNFX0RFQlVHKCJnZXRfcGVyZm9ybWFuY2UsIGx1bjolIiBHX0dVSU5UMzJfRk9STUFUCisg
ICAgICAgICAgICAgICAgIiBwZXJmb3JtYW5jZSB0eXBlOjB4MDAgZGF0YV90eXBlOjB4JXgiCisg
ICAgICAgICAgICAgICAgIiBleGNlcHQ6MHgleCB3cml0ZToweCV4IHRvbGVyYW5jZToweCV4Igor
ICAgICAgICAgICAgICAgICIgbWF4X251bTolIiBHX0dVSU5UMzJfRk9STUFULAorICAgICAgICAg
ICAgICAgIHJlcS0+bHVuLCBkYXRhX3R5cGUsIGV4Y2VwdCwgd3JpdGUsCisgICAgICAgICAgICAg
ICAgdG9sZXJhbmNlLCBtYXhfbnVtX2Rlc2NyKTsKKworICAgIGlmICh3cml0ZSkgeworICAgICAg
ICBTUElDRV9ERUJVRygiZ2V0X3BlcmZvcm1hbmNlLCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVAor
ICAgICAgICAgICAgICAgICIgcGVyZm9ybWFuY2UgdHlwZToweDAwIGRhdGFfdHlwZToweCV4IC0g
d3JpdGUgdW5zdXBwb3J0ZWQiLAorICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBkYXRhX3R5cGUp
OworICAgICAgICBjZF9zY3NpX2dldF9wZXJmb3JtYW5jZV9yZXNwX2VtcHR5KGRldiwgcmVxLCBD
RF9QRVJGX1RZUEVfUEVSRk9STUFOQ0UsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgZGF0YV90eXBlLCBtYXhfbnVtX2Rlc2NyKTsKKyAgICAgICAgcmV0dXJuOwor
ICAgIH0KKworICAgIG1lbXNldChvdXRidWYsIDAsIHJlc3BfbGVuKTsKKworICAgIG91dGJ1Zlsw
XSA9IChwZXJmX2RhdGFfbGVuID4+IDI0KSAmIDB4ZmY7CisgICAgb3V0YnVmWzFdID0gKHBlcmZf
ZGF0YV9sZW4gPj4gMTYpICYgMHhmZjsKKyAgICBvdXRidWZbMl0gPSAocGVyZl9kYXRhX2xlbiA+
PiA4KSAmIDB4ZmY7CisgICAgb3V0YnVmWzNdID0gcGVyZl9kYXRhX2xlbiAmIDB4ZmY7CisKKyAg
ICBwZXJmX2Rlc2MgPSBvdXRidWYgKyBDRF9QRVJGX0hFQURFUl9MRU47CisKKyAgICBwZXJmX2Rl
c2NbMF0gPSAoc3RhcnRfbGJhID4+IDI0KSAmIDB4ZmY7CisgICAgcGVyZl9kZXNjWzFdID0gKHN0
YXJ0X2xiYSA+PiAxNikgJiAweGZmOworICAgIHBlcmZfZGVzY1syXSA9IChzdGFydF9sYmEgPj4g
OCkgJiAweGZmOworICAgIHBlcmZfZGVzY1szXSA9IHN0YXJ0X2xiYSAmIDB4ZmY7CisKKyAgICBw
ZXJmX2Rlc2NbNF0gPSAocGVyZl9rYiA+PiAyNCkgJiAweGZmOworICAgIHBlcmZfZGVzY1s1XSA9
IChwZXJmX2tiID4+IDE2KSAmIDB4ZmY7CisgICAgcGVyZl9kZXNjWzZdID0gKHBlcmZfa2IgPj4g
OCkgJiAweGZmOworICAgIHBlcmZfZGVzY1s3XSA9IHBlcmZfa2IgJiAweGZmOworCisgICAgcGVy
Zl9kZXNjWzhdID0gKGVuZF9sYmEgPj4gMjQpICYgMHhmZjsKKyAgICBwZXJmX2Rlc2NbOV0gPSAo
ZW5kX2xiYSA+PiAxNikgJiAweGZmOworICAgIHBlcmZfZGVzY1sxMF0gPSAoZW5kX2xiYSA+PiA4
KSAmIDB4ZmY7CisgICAgcGVyZl9kZXNjWzExXSA9IGVuZF9sYmEgJiAweGZmOworCisgICAgcGVy
Zl9kZXNjWzEyXSA9IChwZXJmX2tiID4+IDI0KSAmIDB4ZmY7CisgICAgcGVyZl9kZXNjWzEzXSA9
IChwZXJmX2tiID4+IDE2KSAmIDB4ZmY7CisgICAgcGVyZl9kZXNjWzE0XSA9IChwZXJmX2tiID4+
IDgpICYgMHhmZjsKKyAgICBwZXJmX2Rlc2NbMTVdID0gcGVyZl9rYiAmIDB4ZmY7CisKKyAgICBy
ZXEtPnJlcV9sZW4gPSBDRF9QRVJGX0hFQURFUl9MRU4gKworICAgICAgICAgICAgICAgICAgICht
YXhfbnVtX2Rlc2NyICogQ0RfUEVSRl9UWVBFX1BFUkZPUk1BTkNFX0RFU0NSX0xFTik7CisKKyAg
ICByZXEtPmluX2xlbiA9IChyZXEtPnJlcV9sZW4gPCByZXNwX2xlbikgPyByZXEtPnJlcV9sZW4g
OiByZXNwX2xlbjsKKworICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2LCByZXEpOwor
fQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9nZXRfcGVyZm9ybWFuY2UoQ2RTY3NpTFUgKmRl
diwgQ2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAgIHVpbnQzMl90IGRhdGFfdHlwZSwgbWF4X251
bV9kZXNjciwgc3RhcnRfbGJhLCB0eXBlOworCisgICAgcmVxLT54ZmVyX2RpciA9IFNDU0lfWEZF
Ul9GUk9NX0RFVjsKKworICAgIGRhdGFfdHlwZSA9IHJlcS0+Y2RiWzFdICYgMHgwZjsKKyAgICBz
dGFydF9sYmEgPSAocmVxLT5jZGJbMl0gPDwgMjQpIHwKKyAgICAgICAgICAgICAgICAocmVxLT5j
ZGJbM10gPDwgMTYpIHwKKyAgICAgICAgICAgICAgICAocmVxLT5jZGJbNF0gPDwgOCkgfAorICAg
ICAgICAgICAgICAgICByZXEtPmNkYls1XTsKKyAgICBtYXhfbnVtX2Rlc2NyID0gKHJlcS0+Y2Ri
WzhdIDw8IDgpIHwgcmVxLT5jZGJbOV07CisgICAgdHlwZSA9IHJlcS0+Y2RiWzEwXTsKKworICAg
IHN3aXRjaCAodHlwZSkgeworICAgIGNhc2UgQ0RfUEVSRl9UWVBFX1BFUkZPUk1BTkNFOgorICAg
ICAgICBjZF9zY3NpX2dldF9wZXJmb3JtYW5jZV9yZXNwX3BlcmZvcm1hbmNlKGRldiwgcmVxLCBz
dGFydF9sYmEsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgZGF0YV90eXBlLCBtYXhfbnVtX2Rlc2NyKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBD
RF9QRVJGX1RZUEVfVU5VU0FCTEVfQVJFQTogLyogbm90IHdyaXRhYmxlICovCisgICAgY2FzZSBD
RF9QRVJGX1RZUEVfREVGRUNUX1NUQVRVUzogLyogbm90IHJlc3RyaWN0ZWQgb3ZlcndyaXRlIG1l
ZGlhICovCisgICAgY2FzZSBDRF9QRVJGX1RZUEVfV1JJVEVfU1BFRUQ6IC8qIHVuc3VwcG9ydGVk
LCBpcnJlbGV2YW50ICovCisgICAgZGVmYXVsdDoKKyAgICAgICAgU1BJQ0VfREVCVUcoImdldF9w
ZXJmb3JtYW5jZSwgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQKKyAgICAgICAgICAgICAgICAgICAg
IiB1bnN1cHBvcnRlZCB0eXBlOjB4JXgiCisgICAgICAgICAgICAgICAgICAgICIgZGF0YV90eXBl
OjB4JXggbWF4X251bTolIiBHX0dVSU5UMzJfRk9STUFULAorICAgICAgICAgICAgICAgICAgICBy
ZXEtPmx1biwgdHlwZSwgZGF0YV90eXBlLCBtYXhfbnVtX2Rlc2NyKTsKKyAgICAgICAgY2Rfc2Nz
aV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfSU5WQUxJRF9D
REJfRklFTEQpOworICAgICAgICByZXR1cm47CisgICAgfQorfQorCisjZGVmaW5lIENEX01FQ0hB
TklTTV9TVEFUVVNfSERSX0xFTiAgICAgOAorCisvKiBieXRlIDAgKi8KKyNkZWZpbmUgQ0RfQ0hB
TkdFUl9GQVVMVF9GTEFHICAgICAgICAgICAweDgwCisKKyNkZWZpbmUgQ0RfQ0hBTkdFUl9SRUFE
WSAgICAgICAgICAgICAgICAweDAwCisjZGVmaW5lIENEX0NIQU5HRVJfTE9BRElORyAgICAgICAg
ICAgICAgMHgwMQorI2RlZmluZSBDRF9DSEFOR0VSX1VOTE9BRElORyAgICAgICAgICAgIDB4MDIK
KyNkZWZpbmUgQ0RfQ0hBTkdFUl9JTklUSUFMSVpJTkcgICAgICAgICAweDAzCisKKy8qIGJ5dGUg
MSAqLworI2RlZmluZSBDRF9DSEFOR0VSX0RPT1JfT1BFTl9GTEFHICAgICAgIDB4MTAKKworI2Rl
ZmluZSBDRF9NRUNIQU5JU01fU1RBVEVfSURMRSAgICAgICAgIDB4MDAKKyNkZWZpbmUgQ0RfTUVD
SEFOSVNNX1NUQVRFX1BMQVlJTkcgICAgICAweDAxCisjZGVmaW5lIENEX01FQ0hBTklTTV9TVEFU
RV9TQ0FOTklORyAgICAgMHgwMgorLyogQUNUSVZFOiB3aXRoIEluaXRpYXRvciwgQ29tcG9zaXRl
IG9yIE90aGVyIHBvcnRzCisgIChpLmUuIFJFQUQsIFBMQVkgQ0QsIFNDQU4gZHVyaW5nIFBMQVkg
Q0QpICovCisjZGVmaW5lIENEX01FQ0hBTklTTV9TVEFURV9BQ1RJVkUgICAgICAgMHgwMworI2Rl
ZmluZSBDRF9NRUNIQU5JU01fU1RBVEVfTk9fSU5GTyAgICAgIDB4MDcKKworLyogc2xvdHMgKi8K
KyNkZWZpbmUgQ0RfTUVDSEFOSVNNX1NUQVRVU19TTE9UX0xFTiAgICA0CisKKyNkZWZpbmUgQ0Rf
TUVDSEFOSVNNX1NMT1RfRElTS19DSEFOR0VEICAweDAxCisjZGVmaW5lIENEX01FQ0hBTklTTV9T
TE9UX0RJU0tfUFJFU0VOVCAgMHg4MAorI2RlZmluZSBDRF9NRUNIQU5JU01fU0xPVF9ESVNLX0NX
UF9WICAgIDB4MDIKKyNkZWZpbmUgQ0RfTUVDSEFOSVNNX1NMT1RfRElTS19DV1AgICAgICAweDAx
CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX21lY2hhbmlzbV9zdGF0dXMoQ2RTY3NpTFUgKmRl
diwgQ2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAgIHVpbnQ4X3QgKm91dGJ1ZiA9IHJlcS0+YnVm
OworICAgIHVpbnQzMl90IHJlc3BfbGVuID0gQ0RfTUVDSEFOSVNNX1NUQVRVU19IRFJfTEVOOwor
CisgICAgcmVxLT54ZmVyX2RpciA9IFNDU0lfWEZFUl9GUk9NX0RFVjsKKworICAgIHJlcS0+cmVx
X2xlbiA9IChyZXEtPmNkYls4XSA8PCA4KSB8IHJlcS0+Y2RiWzldOworICAgIG1lbXNldChvdXRi
dWYsIDAsIHJlcS0+cmVxX2xlbik7CisKKyAgICAvKiBGb3Igbm9uLWNoYW5nZXIgZGV2aWNlcyB0
aGUgY3VyZW50IHNsb3QgbnVtYmVyIGZpZWxkIGlzIHJlc2VydmVkLCBzZXQgb25seSBzdGF0dXMg
Ki8KKyAgICBvdXRidWZbMF0gfD0gKENEX0NIQU5HRVJfUkVBRFkgPDwgNSk7CisKKyAgICBvdXRi
dWZbMV0gfD0gKCFkZXYtPmxvYWRlZCkgPyBDRF9DSEFOR0VSX0RPT1JfT1BFTl9GTEFHIDogMDsK
KyAgICBvdXRidWZbMV0gfD0gKGRldi0+cG93ZXJfY29uZCA9PSBDRF9QT1dFUl9TVEFUVVNfQUNU
SVZFKSA/CisgICAgICAgICAgICAgICAgIChDRF9NRUNIQU5JU01fU1RBVEVfQUNUSVZFIDw8IDUp
IDogKENEX01FQ0hBTklTTV9TVEFURV9JRExFIDw8IDUpOworCisgICAgLyogRm9yIG5vbi1jaGFu
Z2VyIGRldmljZXMgdGhlIG51bWJlciBvZiBzbG90IHRhYmxlcyByZXR1cm5lZCBzaGFsbCBiZSB6
ZXJvLCBzbyB3ZSBsZWF2ZQorICAgICAgIGJvdGggJ051bWJlciBvZiBTbG90cyBBdmFpbGFibGUn
IGFuZCAnTGVuZ3RoIG9mIFNsb3QgVGFibGUnIGZpZWxkcyBhcyB6ZXJvcyAqLworCisgICAgcmVx
LT5pbl9sZW4gPSAocmVxLT5yZXFfbGVuIDwgcmVzcF9sZW4pID8gcmVxLT5yZXFfbGVuIDogcmVz
cF9sZW47CisKKyAgICBTUElDRV9ERUJVRygibWVjaGFuaXNtX3N0YXR1cywgbHVuOiUiIEdfR1VJ
TlQzMl9GT1JNQVQsIHJlcS0+bHVuKTsKKworICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2dvb2Qo
ZGV2LCByZXEpOworfQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX3JlYWRfYXN5bmNfY29tcGxldGUo
R09iamVjdCAqc3JjX29iamVjdCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBHQXN5bmNSZXN1bHQgKnJlc3VsdCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBncG9pbnRlciB1c2VyX2RhdGEpCit7CisgICAgR0ZpbGVJbnB1dFN0cmVhbSAq
c3RyZWFtID0gR19GSUxFX0lOUFVUX1NUUkVBTShzcmNfb2JqZWN0KTsKKyAgICBDZFNjc2lSZXF1
ZXN0ICpyZXEgPSAoQ2RTY3NpUmVxdWVzdCAqKXVzZXJfZGF0YTsKKyAgICBDZFNjc2lUYXJnZXQg
KnN0ID0gKENkU2NzaVRhcmdldCAqKXJlcS0+cHJpdl9kYXRhOworICAgIENkU2NzaUxVICpkZXYg
PSAmc3QtPnVuaXRzW3JlcS0+bHVuXTsKKyAgICBHRXJyb3IgKmVycm9yID0gTlVMTDsKKyAgICBn
c2l6ZSBieXRlc19yZWFkOworICAgIGdib29sZWFuIGZpbmlzaGVkOworCisgICAgcmVxLT5yZXFf
c3RhdGUgPSBTQ1NJX1JFUV9DT01QTEVURTsKKyAgICByZXEtPmNhbmNlbF9pZCA9IDA7CisKKy8v
ICAgIGdfYXNzZXJ0KHN0cmVhbSA9PSBkZXYtPnN0cmVhbSk7CisgICAgaWYgKHN0cmVhbSAhPSBk
ZXYtPnN0cmVhbSkgeworICAgICAgICB1aW50MzJfdCBvcGNvZGUgPSAodWludDMyX3QpcmVxLT5j
ZGJbMF07CisgICAgICAgIFNQSUNFX0RFQlVHKCJyZWFkX2FzeW5jX2NvbXBsZXRlIEJBRCBTVFJF
QU0sIGx1bjogJSIgR19HVUlOVDMyX0ZPUk1BVAorICAgICAgICAgICAgICAgICAgICAiIHJlcTog
JSIgR19HVUlOVDY0X0ZPUk1BVCAiIG9wOiAweCUwMngiLAorICAgICAgICAgICAgICAgICAgICBy
ZXEtPmx1biwgcmVxLT5yZXFfbGVuLCBvcGNvZGUpOworICAgICAgICBjZF9zY3NpX2NtZF9jb21w
bGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9UQVJHRVRfRkFJTFVSRSk7Cisg
ICAgICAgIGNkX3Njc2lfZGV2X3JlcXVlc3RfY29tcGxldGUoc3QtPnVzZXJfZGF0YSwgcmVxKTsK
KyAgICAgICAgcmV0dXJuOworICAgIH0KKworICAgIGJ5dGVzX3JlYWQgPSBnX2lucHV0X3N0cmVh
bV9yZWFkX2ZpbmlzaChHX0lOUFVUX1NUUkVBTShzdHJlYW0pLCByZXN1bHQsICZlcnJvcik7Cisg
ICAgZmluaXNoZWQgPSBieXRlc19yZWFkID4gMDsKKyAgICBpZiAoZmluaXNoZWQpIHsKKyAgICAg
ICAgU1BJQ0VfREVCVUcoInJlYWRfYXN5bmNfY29tcGxldGUsIGx1bjogJSIgR19HVUlOVDMyX0ZP
Uk1BVAorICAgICAgICAgICAgICAgICAgICAiIGZpbmlzaGVkOiAlZCBieXRlc19yZWFkOiAlIiBH
X0dVSU5UNjRfRk9STUFUCisgICAgICAgICAgICAgICAgICAgICIgcmVxOiAlIiAgR19HVUlOVDY0
X0ZPUk1BVCwKKyAgICAgICAgICAgICAgICAgICAgcmVxLT5sdW4sIGZpbmlzaGVkLCAodWludDY0
X3QpYnl0ZXNfcmVhZCwgcmVxLT5yZXFfbGVuKTsKKworICAgICAgICByZXEtPmluX2xlbiA9IChi
eXRlc19yZWFkIDw9IHJlcS0+cmVxX2xlbikgPyBieXRlc19yZWFkIDogcmVxLT5yZXFfbGVuOwor
ICAgICAgICByZXEtPnN0YXR1cyA9IEdPT0Q7CisgICAgfSBlbHNlIHsKKyAgICAgICAgaWYgKGVy
cm9yICE9IE5VTEwpIHsKKyAgICAgICAgICAgIFNQSUNFX0VSUk9SKCJnX2lucHV0X3N0cmVhbV9y
ZWFkX2ZpbmlzaCBmYWlsZWQ6ICVzIiwgZXJyb3ItPm1lc3NhZ2UpOworICAgICAgICAgICAgZ19j
bGVhcl9lcnJvciAoJmVycm9yKTsKKyAgICAgICAgfSBlbHNlIHsKKyAgICAgICAgICAgIFNQSUNF
X0VSUk9SKCJnX2lucHV0X3N0cmVhbV9yZWFkX2ZpbmlzaCBmYWlsZWQgKG5vIGVyciBwcm92aWRl
ZCkiKTsKKyAgICAgICAgfQorICAgICAgICByZXEtPmluX2xlbiA9IDA7CisgICAgICAgIHJlcS0+
c3RhdHVzID0gR09PRDsKKyAgICB9CisgICAgY2Rfc2NzaV9kZXZfcmVxdWVzdF9jb21wbGV0ZShz
dC0+dXNlcl9kYXRhLCByZXEpOworfQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX3JlYWRfYXN5bmNf
Y2FuY2VsZWQoR0NhbmNlbGxhYmxlICpjYW5jZWxsYWJsZSwgZ3BvaW50ZXIgdXNlcl9kYXRhKQor
eworICAgIENkU2NzaVJlcXVlc3QgKnJlcSA9IChDZFNjc2lSZXF1ZXN0ICopdXNlcl9kYXRhOwor
ICAgIENkU2NzaVRhcmdldCAqc3QgPSAoQ2RTY3NpVGFyZ2V0ICopcmVxLT5wcml2X2RhdGE7CisK
KyAgICBnX2Fzc2VydChjYW5jZWxsYWJsZSA9PSBzdC0+Y2FuY2VsbGFibGUpOworICAgIGdfY2Fu
Y2VsbGFibGVfZGlzY29ubmVjdChjYW5jZWxsYWJsZSwgcmVxLT5jYW5jZWxfaWQpOworICAgIHJl
cS0+Y2FuY2VsX2lkID0gMDsKKworICAgIHJlcS0+cmVxX3N0YXRlID0KKyAgICAgICAgKHN0LT5z
dGF0ZSA9PSBDRF9TQ1NJX1RHVF9TVEFURV9SVU5OSU5HKSA/IFNDU0lfUkVRX0NBTkNFTEVEIDog
U0NTSV9SRVFfRElTUE9TRUQ7CisgICAgcmVxLT5pbl9sZW4gPSAwOworICAgIHJlcS0+c3RhdHVz
ID0gR09PRDsKKworICAgIGNkX3Njc2lfZGV2X3JlcXVlc3RfY29tcGxldGUoc3QtPnVzZXJfZGF0
YSwgcmVxKTsKK30KKworc3RhdGljIGludCBjZF9zY3NpX3JlYWRfYXN5bmNfc3RhcnQoQ2RTY3Np
TFUgKmRldiwgQ2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAgIENkU2NzaVRhcmdldCAqc3QgPSBk
ZXYtPnRndDsKKyAgICBHRmlsZUlucHV0U3RyZWFtICpzdHJlYW0gPSBkZXYtPnN0cmVhbTsKKwor
ICAgIFNQSUNFX0RFQlVHKCJyZWFkX2FzeW5jX3N0YXJ0LCBsdW46JSIgR19HVUlOVDMyX0ZPUk1B
VAorICAgICAgICAgICAgICAgICIgbGJhOiAlIiBHX0dVSU5UNjRfRk9STUFUICIgb2Zmc2V0OiAl
IiBHX0dVSU5UNjRfRk9STUFUCisgICAgICAgICAgICAgICAgIiBjbnQ6ICUiIEdfR1VJTlQ2NF9G
T1JNQVQgIiBsZW46ICUiIEdfR1VJTlQ2NF9GT1JNQVQsCisgICAgICAgICAgICAgICAgcmVxLT5s
dW4sIHJlcS0+bGJhLCByZXEtPm9mZnNldCwgcmVxLT5jb3VudCwgcmVxLT5yZXFfbGVuKTsKKwor
ICAgIHJlcS0+Y2FuY2VsX2lkID0gZ19jYW5jZWxsYWJsZV9jb25uZWN0KHN0LT5jYW5jZWxsYWJs
ZSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBHX0NBTExCQUNL
KGNkX3Njc2lfcmVhZF9hc3luY19jYW5jZWxlZCksCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgcmVxLCAvKiBkYXRhICovCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgTlVMTCk7IC8qIGRhdGEgZGVzdHJveSBjYiAqLworICAgIGlm
IChyZXEtPmNhbmNlbF9pZCA9PSAwKSB7CisgICAgICAgIC8qIGFscmVhZHkgY2FuY2VsZWQgKi8K
KyAgICAgICAgcmV0dXJuIC0xOworICAgIH0KKworICAgIGdfc2Vla2FibGVfc2VlayhHX1NFRUtB
QkxFKHN0cmVhbSksCisgICAgICAgICAgICAgICAgICAgIHJlcS0+b2Zmc2V0LAorICAgICAgICAg
ICAgICAgICAgICBHX1NFRUtfU0VULAorICAgICAgICAgICAgICAgICAgICBOVUxMLCAvKiBjYW5j
ZWxsYWJsZSAqLworICAgICAgICAgICAgICAgICAgICBOVUxMKTsgLyogZXJyb3IgKi8KKworICAg
IGdfaW5wdXRfc3RyZWFtX3JlYWRfYXN5bmMoR19JTlBVVF9TVFJFQU0oc3RyZWFtKSwKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHJlcS0+YnVmLCAvKiBidWZmZXIgdG8gZmlsbCAqLwor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxLT5yZXFfbGVuLAorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgR19QUklPUklUWV9ERUZBVUxULAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgc3QtPmNhbmNlbGxhYmxlLAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgY2Rfc2NzaV9yZWFkX2FzeW5jX2NvbXBsZXRlLAorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgKGdwb2ludGVyKXJlcSk7IC8qIGNhbGxiYWNrIGFyZ3VtZW50ICovCisgICAgcmV0dXJu
IDA7Cit9CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX3JlYWQoQ2RTY3NpTFUgKmRldiwgQ2RT
Y3NpUmVxdWVzdCAqcmVxKQoreworICAgIGlmIChkZXYtPnBvd2VyX2NvbmQgPT0gQ0RfU0NTSV9Q
T1dFUl9TVE9QUEVEKSB7CisgICAgICAgIFNQSUNFX0RFQlVHKCJyZWFkLCBsdW46ICUiIEdfR1VJ
TlQzMl9GT1JNQVQgIiBpcyBzdG9wcGVkIiwgcmVxLT5sdW4pOworICAgICAgICBjZF9zY3NpX2Nt
ZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTklUX0NNRF9SRVFV
SVJFRCk7CisgICAgICAgIHJldHVybjsKKyAgICB9IGVsc2UgaWYgKCFkZXYtPmxvYWRlZCB8fCBk
ZXYtPnN0cmVhbSA9PSBOVUxMKSB7CisgICAgICAgIFNQSUNFX0RFQlVHKCJyZWFkLCBsdW46ICUi
IEdfR1VJTlQzMl9GT1JNQVQgIiBpcyBub3QgbG9hZGVkIiwgcmVxLT5sdW4pOworICAgICAgICBj
ZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9OT1Rf
UkVBRFlfTk9fTUVESVVNKTsKKyAgICAgICAgcmV0dXJuOworICAgIH0KKworICAgIHJlcS0+Y2Ri
X2xlbiA9IHNjc2lfY2RiX2xlbmd0aChyZXEtPmNkYik7CisKKyAgICByZXEtPmxiYSA9IHNjc2lf
Y2RiX2xiYShyZXEtPmNkYiwgcmVxLT5jZGJfbGVuKTsKKyAgICByZXEtPm9mZnNldCA9IHJlcS0+
bGJhICogZGV2LT5ibG9ja19zaXplOworCisgICAgcmVxLT5jb3VudCA9IHNjc2lfY2RiX3hmZXJf
bGVuZ3RoKHJlcS0+Y2RiLCByZXEtPmNkYl9sZW4pOyAvKiB4ZmVyIGluIGJsb2NrcyAqLworICAg
IHJlcS0+cmVxX2xlbiA9IHJlcS0+Y291bnQgKiBkZXYtPmJsb2NrX3NpemU7CisKKyAgICBjZF9z
Y3NpX3JlYWRfYXN5bmNfc3RhcnQoZGV2LCByZXEpOworfQorCit2b2lkIGNkX3Njc2lfZGV2X3Jl
cXVlc3Rfc3VibWl0KENkU2NzaVRhcmdldCAqc3QsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAg
ICB1aW50MzJfdCBsdW4gPSByZXEtPmx1bjsKKyAgICB1aW50MzJfdCBvcGNvZGUgPSAodWludDMy
X3QpcmVxLT5jZGJbMF07CisgICAgY29uc3QgY2hhciAqY21kX25hbWUgPSBzY3NpX2NtZF9uYW1l
W29wY29kZV07CisgICAgQ2RTY3NpTFUgKmRldiA9ICZzdC0+dW5pdHNbbHVuXTsKKworICAgIFNQ
SUNFX0RFQlVHKCJyZXF1ZXN0X3N1Ym1pdCwgbHVuOiAlIiBHX0dVSU5UMzJfRk9STUFUICIgb3A6
IDB4JTAyeCAlcyIsIGx1biwgb3Bjb2RlLCBjbWRfbmFtZSk7CisKKyAgICBpZiAoc3QtPmN1cl9y
ZXEgIT0gTlVMTCkgeworICAgICAgICBTUElDRV9FUlJPUigicmVxdWVzdF9zdWJtaXQsIHJlcXVl
c3Qgbm90IGlkbGUiKTsKKyAgICAgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChk
ZXYsIHJlcSwgJnNlbnNlX2NvZGVfVEFSR0VUX0ZBSUxVUkUpOworICAgICAgICBnb3RvIGRvbmU7
CisgICAgfQorICAgIGlmIChyZXEtPnJlcV9zdGF0ZSAhPSBTQ1NJX1JFUV9JRExFKSB7CisgICAg
ICAgIFNQSUNFX0VSUk9SKCJyZXF1ZXN0X3N1Ym1pdCwgcHJldiByZXF1ZXN0IG91dHN0YW5kaW5n
Iik7CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZz
ZW5zZV9jb2RlX1RBUkdFVF9GQUlMVVJFKTsKKyAgICAgICAgZ290byBkb25lOworICAgIH0KKyAg
ICByZXEtPnJlcV9zdGF0ZSA9IFNDU0lfUkVRX1JVTk5JTkc7CisgICAgc3QtPmN1cl9yZXEgPSBy
ZXE7CisKKyAgICAvKiBJTlFVSVJZIHNob3VsZCBzZW5kIHJlc3BvbnNlIGV2ZW4gZm9yIG5vbi1l
eGlzdGluZyBMVU5zICovCisgICAgaWYgKCFjZF9zY3NpX3RhcmdldF9sdW5fbGVnYWwoc3QsIGx1
bikpIHsKKyAgICAgICAgU1BJQ0VfRVJST1IoInJlcXVlc3Rfc3VibWl0LCBpbGxlZ2FsIGx1bjol
IiBHX0dVSU5UMzJfRk9STUFULCBsdW4pOworICAgICAgICBpZiAob3Bjb2RlID09IElOUVVJUlkp
IHsKKyAgICAgICAgICAgIGlmIChyZXEtPmNkYlsxXSAmIDB4MSkgeworICAgICAgICAgICAgICAg
IGNkX3Njc2lfY21kX2lucXVpcnlfdnBkX25vX2x1bihkZXYsIHJlcSwgUEVSSUZfUVVBTElGSUVS
X1VOU1VQUE9SVEVEKTsKKyAgICAgICAgICAgIH0gZWxzZSB7CisgICAgICAgICAgICAgICAgY2Rf
c2NzaV9jbWRfaW5xdWlyeV9zdGFuZGFyZF9ub19sdW4oZGV2LCByZXEsIFBFUklGX1FVQUxJRklF
Ul9VTlNVUFBPUlRFRCk7CisgICAgICAgICAgICB9CisgICAgICAgIH0gZWxzZSB7CisgICAgICAg
ICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29k
ZV9MVU5fTk9UX1NVUFBPUlRFRCk7CisgICAgICAgIH0KKyAgICAgICAgZ290byBkb25lOworICAg
IH0KKyAgICBpZiAoIWNkX3Njc2lfdGFyZ2V0X2x1bl9yZWFsaXplZChzdCwgbHVuKSkgeworICAg
ICAgICBTUElDRV9FUlJPUigicmVxdWVzdF9zdWJtaXQsIGFic2VudCBsdW46JSIgR19HVUlOVDMy
X0ZPUk1BVCwgbHVuKTsKKyAgICAgICAgaWYgKG9wY29kZSA9PSBJTlFVSVJZKSB7CisgICAgICAg
ICAgICBpZiAocmVxLT5jZGJbMV0gJiAweDEpIHsKKyAgICAgICAgICAgICAgICBjZF9zY3NpX2Nt
ZF9pbnF1aXJ5X3ZwZF9ub19sdW4oZGV2LCByZXEsIFBFUklGX1FVQUxJRklFUl9OT1RfQ09OTkVD
VEVEKTsKKyAgICAgICAgICAgIH0gZWxzZSB7CisgICAgICAgICAgICAgICAgY2Rfc2NzaV9jbWRf
aW5xdWlyeV9zdGFuZGFyZF9ub19sdW4oZGV2LCByZXEsIFBFUklGX1FVQUxJRklFUl9OT1RfQ09O
TkVDVEVEKTsKKyAgICAgICAgICAgIH0KKyAgICAgICAgfSBlbHNlIHsKKyAgICAgICAgICAgIGNk
X3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX0xVTl9O
T1RfU1VQUE9SVEVEKTsKKyAgICAgICAgfQorICAgICAgICBnb3RvIGRvbmU7CisgICAgfQorCisg
ICAgaWYgKGRldi0+c2hvcnRfc2Vuc2Uua2V5ICE9IE5PX1NFTlNFKSB7CisgICAgICAgIGdib29s
ZWFuIHBlbmRpbmdfc2Vuc2UgPSBUUlVFOworICAgICAgICBpZiAoZGV2LT5zaG9ydF9zZW5zZS5r
ZXkgPT0gVU5JVF9BVFRFTlRJT04pIHsKKyAgICAgICAgICAgIGlmIChjZF9zY3NpX29wY29kZV91
YV9zdXByZXNzKG9wY29kZSkpIHsKKyAgICAgICAgICAgICAgICBwZW5kaW5nX3NlbnNlID0gRkFM
U0U7IC8qIFVBIHN1cHJlc3NlZCAqLworICAgICAgICAgICAgfQorICAgICAgICB9IGVsc2UgaWYg
KG9wY29kZSA9PSBSRVFVRVNUX1NFTlNFKSB7CisgICAgICAgICAgICBwZW5kaW5nX3NlbnNlID0g
RkFMU0U7IC8qIHNlbnNlIHJldHVybmVkIGFzIGRhdGEgKi8KKyAgICAgICAgfQorICAgICAgICBp
ZiAocGVuZGluZ19zZW5zZSkgeworICAgICAgICAgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfY2hl
Y2tfY29uZChkZXYsIHJlcSwgTlVMTCk7IC8qIHNlbnNlIGFscmVhZHkgc2V0ICovCisgICAgICAg
ICAgICBnb3RvIGRvbmU7CisgICAgICAgIH0KKyAgICB9CisKKyAgICAvKiBzYXZlIHRoZSB0YXJn
ZXQgdG8gYmUgdXNlZCBpbiBjYWxsYmFja3Mgd2hlcmUgb25seSByZXEgaXMgcGFzc2VkICovCisg
ICAgcmVxLT5wcml2X2RhdGEgPSAodm9pZCAqKXN0OworCisgICAgcmVxLT5yZXFfbGVuID0gMDsK
KworICAgIHN3aXRjaCAob3Bjb2RlKSB7CisgICAgY2FzZSBSRVBPUlRfTFVOUzoKKyAgICAgICAg
Y2Rfc2NzaV9jbWRfcmVwb3J0X2x1bnMoc3QsIGRldiwgcmVxKTsKKyAgICAgICAgYnJlYWs7Cisg
ICAgY2FzZSBURVNUX1VOSVRfUkVBRFk6CisgICAgICAgIGNkX3Njc2lfY21kX3Rlc3RfdW5pdF9y
ZWFkeShkZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgSU5RVUlSWToKKyAgICAg
ICAgY2Rfc2NzaV9jbWRfaW5xdWlyeShkZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGNh
c2UgUkVRVUVTVF9TRU5TRToKKyAgICAgICAgY2Rfc2NzaV9jbWRfcmVxdWVzdF9zZW5zZShkZXYs
IHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgUkVBRF82OgorICAgIGNhc2UgUkVBRF8x
MDoKKyAgICBjYXNlIFJFQURfMTI6CisgICAgY2FzZSBSRUFEXzE2OgorICAgICAgICBjZF9zY3Np
X2NtZF9yZWFkKGRldiwgcmVxKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBSRUFEX0NBUEFD
SVRZXzEwOgorICAgICAgICBjZF9zY3NpX2NtZF9yZWFkX2NhcGFjaXR5KGRldiwgcmVxKTsKKyAg
ICAgICAgYnJlYWs7CisgICAgY2FzZSBSRUFEX1RPQzoKKyAgICAgICAgY2Rfc2NzaV9jbWRfcmVh
ZF90b2MoZGV2LCByZXEpOworICAgICAgICBicmVhazsKKyAgICBjYXNlIEdFVF9FVkVOVF9TVEFU
VVNfTk9USUZJQ0FUSU9OOgorICAgICAgICBjZF9zY3NpX2NtZF9nZXRfZXZlbnRfc3RhdHVzX25v
dGlmaWNhdGlvbihkZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgUkVBRF9ESVND
X0lORk9STUFUSU9OOgorICAgICAgICBjZF9zY3NpX2NtZF9nZXRfcmVhZF9kaXNjX2luZm9ybWF0
aW9uKGRldiwgcmVxKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBSRUFEX1RSQUNLX0lORk9S
TUFUSU9OOgorICAgICAgICBjZF9zY3NpX2NtZF9nZXRfcmVhZF90cmFja19pbmZvcm1hdGlvbihk
ZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgTU9ERV9TRU5TRV8xMDoKKyAgICAg
ICAgY2Rfc2NzaV9jbWRfbW9kZV9zZW5zZV8xMChkZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOwor
ICAgIGNhc2UgTU9ERV9TRUxFQ1Q6CisgICAgICAgIGNkX3Njc2lfY21kX21vZGVfc2VsZWN0XzYo
ZGV2LCByZXEpOworICAgICAgICBicmVhazsKKyAgICBjYXNlIE1PREVfU0VMRUNUXzEwOgorICAg
ICAgICBjZF9zY3NpX2NtZF9tb2RlX3NlbGVjdF8xMChkZXYsIHJlcSk7CisgICAgICAgIGJyZWFr
OworICAgIGNhc2UgR0VUX0NPTkZJR1VSQVRJT046CisgICAgICAgIGNkX3Njc2lfY21kX2dldF9j
b25maWd1cmF0aW9uKGRldiwgcmVxKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBBTExPV19N
RURJVU1fUkVNT1ZBTDoKKyAgICAgICAgY2Rfc2NzaV9jbWRfYWxsb3dfbWVkaXVtX3JlbW92YWwo
ZGV2LCByZXEpOworICAgICAgICBicmVhazsKKyAgICBjYXNlIE1NQ19TRU5EX0VWRU5UOgorICAg
ICAgICBjZF9zY3NpX2NtZF9zZW5kX2V2ZW50KGRldiwgcmVxKTsKKyAgICAgICAgYnJlYWs7Cisg
ICAgY2FzZSBNTUNfUkVQT1JUX0tFWToKKyAgICAgICAgY2Rfc2NzaV9jbWRfcmVwb3J0X2tleShk
ZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgTU1DX1NFTkRfS0VZOgorICAgICAg
ICBjZF9zY3NpX2NtZF9zZW5kX2tleShkZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGNh
c2UgU1RBUlRfU1RPUDoKKyAgICAgICAgY2Rfc2NzaV9jbWRfc3RhcnRfc3RvcF91bml0KGRldiwg
cmVxKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBNTUNfR0VUX1BFUkZPUk1BTkNFOgorICAg
ICAgICBjZF9zY3NpX2NtZF9nZXRfcGVyZm9ybWFuY2UoZGV2LCByZXEpOworICAgICAgICBicmVh
azsKKyAgICBjYXNlIE1NQ19NRUNIQU5JU01fU1RBVFVTOgorICAgICAgICBjZF9zY3NpX2NtZF9t
ZWNoYW5pc21fc3RhdHVzKGRldiwgcmVxKTsKKyAgICAgICAgYnJlYWs7CisgICAgZGVmYXVsdDoK
KyAgICAgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNl
X2NvZGVfSU5WQUxJRF9PUENPREUpOworICAgICAgICBicmVhazsKKyAgICB9CisKKyAgICBpZiAo
cmVxLT5yZXFfbGVuID4gSU5UMzJfTUFYKSB7CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRl
X2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX0lOVkFMSURfQ0RCX0ZJRUxEKTsKKyAg
ICAgICAgZ290byBkb25lOworICAgIH0KKworZG9uZToKKyAgICBTUElDRV9ERUJVRygicmVxdWVz
dF9zdWJtaXQgZG9uZSwgbHVuOiAlIiBHX0dVSU5UMzJfRk9STUFUCisgICAgICAgICAgICAgICAg
IiBvcDogMHglMDJ4ICVzLCBzdGF0ZTogJXMgc3RhdHVzOiAlIiBHX0dVSU5UMzJfRk9STUFUICIg
bGVuOiAlIiBHX0dVSU5UNjRfRk9STUFULAorICAgICAgICAgICAgICAgIGx1biwgb3Bjb2RlLCBj
bWRfbmFtZSwgQ2RTY3NpUmVxU3RhdGVfc3RyKHJlcS0+cmVxX3N0YXRlKSwgcmVxLT5zdGF0dXMs
CisgICAgICAgICAgICAgICAgcmVxLT5pbl9sZW4pOworCisgICAgaWYgKHJlcS0+cmVxX3N0YXRl
ID09IFNDU0lfUkVRX0NPTVBMRVRFKSB7CisgICAgICAgIGNkX3Njc2lfZGV2X3JlcXVlc3RfY29t
cGxldGUoc3QtPnVzZXJfZGF0YSwgcmVxKTsKKyAgICB9Cit9CisKK3ZvaWQgY2Rfc2NzaV9kZXZf
cmVxdWVzdF9jYW5jZWwoQ2RTY3NpVGFyZ2V0ICpzdCwgQ2RTY3NpUmVxdWVzdCAqcmVxKQorewor
ICAgIGlmIChzdC0+Y3VyX3JlcSA9PSByZXEpIHsKKyAgICAgICAgaWYgKHJlcS0+cmVxX3N0YXRl
ID09IFNDU0lfUkVRX1JVTk5JTkcpIHsKKyAgICAgICAgICAgIFNQSUNFX0RFQlVHKCJyZXF1ZXN0
X2NhbmNlbDogbHVuOiAlIiBHX0dVSU5UMzJfRk9STUFUCisgICAgICAgICAgICAgICAgICAgICAg
ICAgIiBvcDogMHglMDJ4IGxlbjogJSIgR19HVUlOVDY0X0ZPUk1BVCwKKyAgICAgICAgICAgICAg
ICAgICAgICAgIHJlcS0+bHVuLCAodW5zaWduZWQgaW50KXJlcS0+Y2RiWzBdLCByZXEtPnJlcV9s
ZW4pOworICAgICAgICAgICAgZ19jYW5jZWxsYWJsZV9jYW5jZWwoc3QtPmNhbmNlbGxhYmxlKTsK
KyAgICAgICAgfSBlbHNlIHsKKyAgICAgICAgICAgIFNQSUNFX0RFQlVHKCJyZXF1ZXN0X2NhbmNl
bDogcmVxdWVzdCBpcyBub3QgcnVubmluZyIpOworICAgICAgICB9CisgICAgfSBlbHNlIHsKKyAg
ICAgICAgU1BJQ0VfREVCVUcoInJlcXVlc3RfY2FuY2VsOiBvdGhlciByZXF1ZXN0IGlzIG91dHN0
YW5kaW5nIik7CisgICAgfQorfQorCit2b2lkIGNkX3Njc2lfZGV2X3JlcXVlc3RfcmVsZWFzZShD
ZFNjc2lUYXJnZXQgKnN0LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgc3QtPmN1cl9yZXEg
PSBOVUxMOworICAgIGNkX3Njc2lfcmVxX2luaXQocmVxKTsKKworICAgIGlmIChzdC0+c3RhdGUg
PT0gQ0RfU0NTSV9UR1RfU1RBVEVfUkVTRVQpIHsKKyAgICAgICAgY2Rfc2NzaV90YXJnZXRfZG9f
cmVzZXQoc3QpOworICAgIH0KK30KKworI2VuZGlmIC8qIFVTRV9VU0JSRURJUiAqLwpkaWZmIC0t
Z2l0IGEvc3JjL2NkLXNjc2kuaCBiL3NyYy9jZC1zY3NpLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQK
aW5kZXggMDAwMDAwMC4uNjUyNDI0NAotLS0gL2Rldi9udWxsCisrKyBiL3NyYy9jZC1zY3NpLmgK
QEAgLTAsMCArMSwxMjEgQEAKKy8qIC0qLSBNb2RlOiBDOyBjLWJhc2ljLW9mZnNldDogNDsgaW5k
ZW50LXRhYnMtbW9kZTogbmlsIC0qLSAqLworLyoKKyAgIENEIGRldmljZSBlbXVsYXRpb24gLSBT
Q1NJIGVuZ2luZQorCisgICBDb3B5cmlnaHQgKEMpIDIwMTggUmVkIEhhdCwgSW5jLgorCisgICBS
ZWQgSGF0IEF1dGhvcnM6CisgICBBbGV4YW5kZXIgTmV6aGluc2t5PGFuZXpoaW5zQHJlZGhhdC5j
b20+CisKKyAgIFRoaXMgbGlicmFyeSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJp
YnV0ZSBpdCBhbmQvb3IKKyAgIG1vZGlmeSBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBM
ZXNzZXIgR2VuZXJhbCBQdWJsaWMKKyAgIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVl
IFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlcgorICAgdmVyc2lvbiAyLjEgb2YgdGhlIExpY2Vu
c2UsIG9yIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCisKKyAgIFRoaXMgbGli
cmFyeSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAor
ICAgYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2Fy
cmFudHkgb2YKKyAgIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIg
UFVSUE9TRS4gIFNlZSB0aGUgR05VCisgICBMZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBm
b3IgbW9yZSBkZXRhaWxzLgorCisgICBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9m
IHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCisgICBMaWNlbnNlIGFsb25nIHdpdGggdGhp
cyBsaWJyYXJ5OyBpZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCisq
LworCisjaWZuZGVmIFNQSUNFX0dUS19DRF9TQ1NJX0hfXworI2RlZmluZSBTUElDRV9HVEtfQ0Rf
U0NTSV9IX18KKworI2luY2x1ZGUgImNkLXNjc2ktZGV2LXBhcmFtcy5oIgorI2luY2x1ZGUgImNk
LXVzYi1idWxrLW1zZC5oIgorI2luY2x1ZGUgInNjc2ktY29uc3RhbnRzLmgiCisKKyNpZiBkZWZp
bmVkKEdfT1NfV0lOMzIpCisjaW5jbHVkZSA8d2luc29jazIuaD4KKyNpbmNsdWRlIDx3aW5kb3dz
Lmg+CisvKiBXaW5kb3dzIGlzIGFsd2F5cyBMRSBhdCB0aGUgbW9tZW50ICovCisjZGVmaW5lIGxl
MzJ0b2goeCkgICAgICAgICAgKHgpCisjZGVmaW5lIGh0b2xlMzIoeCkgICAgICAgICAgKHgpCisj
ZGVmaW5lIGh0b2JlMzIoeCkgICAgICAgICAgaHRvbmwoeCkKKyNlbmRpZgorCit0eXBlZGVmIGVu
dW0gU2NzaVhmZXJEaXIgeworICAgIFNDU0lfWEZFUl9OT05FID0gMCwgIC8qIFRFU1RfVU5JVF9S
RUFEWSwgLi4uICAgICAgICAgICAqLworICAgIFNDU0lfWEZFUl9GUk9NX0RFViwgIC8qIFJFQUQs
IElOUVVJUlksIE1PREVfU0VOU0UsIC4uLiAqLworICAgIFNDU0lfWEZFUl9UT19ERVYsICAgIC8q
IFdSSVRFLCBNT0RFX1NFTEVDVCwgLi4uICAgICAgICAqLworfSBTY3NpWGZlckRpcjsKKworI2Rl
ZmluZSBTQ1NJX0NEQl9CVUZfU0laRSAgIDE2CisKK3R5cGVkZWYgZW51bSBDZFNjc2lSZXFTdGF0
ZSB7CisgICAgU0NTSV9SRVFfSURMRSA9IDAsCisgICAgU0NTSV9SRVFfUlVOTklORywKKyAgICBT
Q1NJX1JFUV9DT01QTEVURSwKKyAgICBTQ1NJX1JFUV9DQU5DRUxFRCwKKyAgICBTQ1NJX1JFUV9E
SVNQT1NFRCwKK30gQ2RTY3NpUmVxU3RhdGU7CisKK3R5cGVkZWYgc3RydWN0IENkU2NzaVJlcXVl
c3QgeworICAgIC8qIHJlcXVlc3QgKi8KKyAgICB1aW50OF90IGNkYltTQ1NJX0NEQl9CVUZfU0la
RV07CisgICAgdWludDMyX3QgY2RiX2xlbjsKKworICAgIHVpbnQzMl90IHRhZzsKKyAgICB1aW50
MzJfdCBsdW47CisKKyAgICB1aW50OF90ICpidWY7CisgICAgdWludDMyX3QgYnVmX2xlbjsKKwor
ICAgIC8qIGludGVybmFsICovCisgICAgQ2RTY3NpUmVxU3RhdGUgcmVxX3N0YXRlOworICAgIFNj
c2lYZmVyRGlyIHhmZXJfZGlyOworICAgIHVpbnQ2NF90IGNhbmNlbF9pZDsKKyAgICB2b2lkICpw
cml2X2RhdGE7CisKKyAgICB1aW50NjRfdCBsYmE7IC8qIG9mZnNldCBpbiBsb2dpY2FsIGJsb2Nr
cyBpZiByZWxldmFudCAqLworICAgIHVpbnQ2NF90IGNvdW50OyAvKiBjb3VudCBpbiBsb2dpY2Fs
IGJsb2NrcyAqLworCisgICAgdWludDY0X3Qgb2Zmc2V0OyAvKiBzY3NpIGNkYiBvZmZzZXQsIG5v
cm1hbGl6ZWQgdG8gYnl0ZXMgKi8KKyAgICB1aW50NjRfdCByZXFfbGVuOyAvKiBzY3NpIGNkYiBy
ZXF1ZXN0IGxlbmd0aCwgbm9ybWFsaXplZCB0byBieXRlcyAqLworCisgICAgLyogcmVzdWx0ICov
CisgICAgdWludDY0X3QgaW5fbGVuOyAvKiBsZW5ndGggb2YgZGF0YSBhY3R1YWxseSBhdmFpbGFi
bGUgYWZ0ZXIgcmVhZCAqLworICAgIHVpbnQzMl90IHN0YXR1czsgLyogU0NTSSBzdGF0dXMgY29k
ZSAqLworCit9IENkU2NzaVJlcXVlc3Q7CisKK0NkU2NzaVJlcVN0YXRlIGNkX3Njc2lfZ2V0X3Jl
cV9zdGF0ZShDZFNjc2lSZXF1ZXN0ICpyZXEpOworCisvKiBTQ1NJIHRhcmdldC9kZXZpY2UgQVBJ
ICovCit0eXBlZGVmIHN0cnVjdCBDZFNjc2lUYXJnZXQgQ2RTY3NpVGFyZ2V0OworCisvKiB0byBi
ZSB1c2VkIGluIGNhbGxiYWNrcyAqLworQ2RTY3NpVGFyZ2V0ICpjZF9zY3NpX3RhcmdldF9hbGxv
Yyh2b2lkICp0YXJnZXRfdXNlcl9kYXRhLCB1aW50MzJfdCBtYXhfbHVucyk7Cit2b2lkIGNkX3Nj
c2lfdGFyZ2V0X2ZyZWUoQ2RTY3NpVGFyZ2V0ICpzY3NpX3RhcmdldCk7CisKK2ludCBjZF9zY3Np
X2Rldl9yZWFsaXplKENkU2NzaVRhcmdldCAqc2NzaV90YXJnZXQsIHVpbnQzMl90IGx1biwKKyAg
ICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IENkU2NzaURldmljZVBhcmFtZXRlcnMgKmRldl9w
YXJhbXMpOworaW50IGNkX3Njc2lfZGV2X3VucmVhbGl6ZShDZFNjc2lUYXJnZXQgKnNjc2lfdGFy
Z2V0LCB1aW50MzJfdCBsdW4pOworCitpbnQgY2Rfc2NzaV9kZXZfbG9jayhDZFNjc2lUYXJnZXQg
KnNjc2lfdGFyZ2V0LCB1aW50MzJfdCBsdW4sIGdib29sZWFuIGxvY2spOworaW50IGNkX3Njc2lf
ZGV2X2xvYWQoQ2RTY3NpVGFyZ2V0ICpzY3NpX3RhcmdldCwgdWludDMyX3QgbHVuLAorICAgICAg
ICAgICAgICAgICAgICAgY29uc3QgQ2RTY3NpTWVkaWFQYXJhbWV0ZXJzICptZWRpYV9wYXJhbXMp
OworaW50IGNkX3Njc2lfZGV2X2dldF9pbmZvKENkU2NzaVRhcmdldCAqc2NzaV90YXJnZXQsIHVp
bnQzMl90IGx1biwgQ2RTY3NpRGV2aWNlSW5mbyAqbHVuX2luZm8pOworaW50IGNkX3Njc2lfZGV2
X3VubG9hZChDZFNjc2lUYXJnZXQgKnNjc2lfdGFyZ2V0LCB1aW50MzJfdCBsdW4pOworCit2b2lk
IGNkX3Njc2lfZGV2X3JlcXVlc3Rfc3VibWl0KENkU2NzaVRhcmdldCAqc2NzaV90YXJnZXQsIENk
U2NzaVJlcXVlc3QgKnJlcXVlc3QpOwordm9pZCBjZF9zY3NpX2Rldl9yZXF1ZXN0X2NhbmNlbChD
ZFNjc2lUYXJnZXQgKnNjc2lfdGFyZ2V0LCBDZFNjc2lSZXF1ZXN0ICpyZXF1ZXN0KTsKK3ZvaWQg
Y2Rfc2NzaV9kZXZfcmVxdWVzdF9yZWxlYXNlKENkU2NzaVRhcmdldCAqc2NzaV90YXJnZXQsIENk
U2NzaVJlcXVlc3QgKnJlcXVlc3QpOworCitpbnQgY2Rfc2NzaV9kZXZfcmVzZXQoQ2RTY3NpVGFy
Z2V0ICpzY3NpX3RhcmdldCwgdWludDMyX3QgbHVuKTsKKworaW50IGNkX3Njc2lfdGFyZ2V0X3Jl
c2V0KENkU2NzaVRhcmdldCAqc2NzaV90YXJnZXQpOworCisvKiBDYWxsYmFja3MKKyAqIFRoZXNl
IGNhbGxiYWNrcyBhcmUgdXNlZCBieSB1cHBlciBsYXllciB0byBpbXBsZW1lbnQgc3BlY2lmaWMg
U0NTSQorICogdGFyZ2V0IGRldmljZXMuCisgKi8KK3ZvaWQgY2Rfc2NzaV9kZXZfcmVxdWVzdF9j
b21wbGV0ZSh2b2lkICp0YXJnZXRfdXNlcl9kYXRhLCBDZFNjc2lSZXF1ZXN0ICpyZXF1ZXN0KTsK
K3ZvaWQgY2Rfc2NzaV9kZXZfY2hhbmdlZCh2b2lkICp0YXJnZXRfdXNlcl9kYXRhLCB1aW50MzJf
dCBsdW4pOwordm9pZCBjZF9zY3NpX2Rldl9yZXNldF9jb21wbGV0ZSh2b2lkICp0YXJnZXRfdXNl
cl9kYXRhLCB1aW50MzJfdCBsdW4pOwordm9pZCBjZF9zY3NpX3RhcmdldF9yZXNldF9jb21wbGV0
ZSh2b2lkICp0YXJnZXRfdXNlcl9kYXRhKTsKKworI2VuZGlmIC8qIFNQSUNFX0dUS19DRF9TQ1NJ
X0hfXyAqLwpkaWZmIC0tZ2l0IGEvc3JjL2NkLXVzYi1idWxrLW1zZC5jIGIvc3JjL2NkLXVzYi1i
dWxrLW1zZC5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAuLjk1MzY1MTYKLS0t
IC9kZXYvbnVsbAorKysgYi9zcmMvY2QtdXNiLWJ1bGstbXNkLmMKQEAgLTAsMCArMSw1NDYgQEAK
Ky8qIC0qLSBNb2RlOiBDOyBjLWJhc2ljLW9mZnNldDogNDsgaW5kZW50LXRhYnMtbW9kZTogbmls
IC0qLSAqLworLyoKKyAgICBVU0IgQ0QgRGV2aWNlIGVtdWxhdGlvbiAtIERhdGEgQnVsayB0cmFu
c2ZlcnMgLSBNYXNzIFN0b3JhZ2UgRGV2aWNlCisKKyAgICBDb3B5cmlnaHQgKEMpIDIwMTggUmVk
IEhhdCwgSW5jLgorCisgICAgUmVkIEhhdCBBdXRob3JzOgorICAgIEFsZXhhbmRlciBOZXpoaW5z
a3k8YW5lemhpbnNAcmVkaGF0LmNvbT4KKworICAgIFRoaXMgbGlicmFyeSBpcyBmcmVlIHNvZnR3
YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IKKyAgICBtb2RpZnkgaXQgdW5kZXIg
dGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCisgICAgTGljZW5zZSBh
cyBwdWJsaXNoZWQgYnkgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyCisgICAg
dmVyc2lvbiAyLjEgb2YgdGhlIExpY2Vuc2UsIG9yIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVy
IHZlcnNpb24uCisKKyAgICBUaGlzIGxpYnJhcnkgaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUg
dGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKKyAgICBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdp
dGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgorICAgIE1FUkNIQU5UQUJJTElUWSBv
ciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUgR05VCisgICAgTGVz
c2VyIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KKworICAgIFlvdSBz
aG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJs
aWMKKyAgICBMaWNlbnNlIGFsb25nIHdpdGggdGhpcyBsaWJyYXJ5OyBpZiBub3QsIHNlZSA8aHR0
cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCisqLworCisjaW5jbHVkZSAiY29uZmlnLmgiCisj
aW5jbHVkZSAic3BpY2UvdHlwZXMuaCIKKyNpbmNsdWRlICJzcGljZS1jb21tb24uaCIKKyNpbmNs
dWRlICJzcGljZS11dGlsLmgiCisjaW5jbHVkZSAiY2QtdXNiLWJ1bGstbXNkLmgiCisjaW5jbHVk
ZSAiY2Qtc2NzaS5oIgorCisjaWZkZWYgVVNFX1VTQlJFRElSCisKKyNkZWZpbmUgU1BJQ0VfRVJS
T1IoZm10LCAuLi4pIFwKKyAgICBkbyB7IFNQSUNFX0RFQlVHKCJ1c2ItbXNkIGVycm9yOiAiIGZt
dCAsICMjIF9fVkFfQVJHU19fKTsgfSB3aGlsZSAoMCkKKwordHlwZWRlZiBlbnVtIFVzYkNkU3Rh
dGUgeworICAgIFVTQl9DRF9TVEFURV9JTklULCAvKiBOb3QgcmVhZHkgKi8KKyAgICBVU0JfQ0Rf
U1RBVEVfQ0JXLCAvKiBXYWl0aW5nIGZvciBDb21tYW5kIEJsb2NrICovCisgICAgVVNCX0NEX1NU
QVRFX0RBVEFPVVQsIC8qIFRyYW5zZmVyIGRhdGEgdG8gZGV2aWNlICovCisgICAgVVNCX0NEX1NU
QVRFX0RBVEFJTiwgLyogVHJhbnNmZXIgZGF0YSBmcm9tIGRldmljZSAqLworICAgIFVTQl9DRF9T
VEFURV9aRVJPX0RBVEFJTiwgLyogTmVlZCB0byBzZW5kIHplcm8gYnVsay1pbiBiZWZvcmUgc3Rh
dHVzICovCisgICAgVVNCX0NEX1NUQVRFX0NTVywgLyogU2VuZCBDb21tYW5kIFN0YXR1cyAqLwor
ICAgIFVTQl9DRF9TVEFURV9ERVZJQ0VfUkVTRVQsIC8qIHJlc2V0IG9mIGEgc2luZ2xlIGRldmlj
ZSAqLworICAgIFVTQl9DRF9TVEFURV9UQVJHRVRfUkVTRVQgLyogcmVzZXQgb2YgZW50aXJlIHRh
cmdldCAqLworfSBVc2JDZFN0YXRlOworCisvKiBVU0IgTVNEIENvbW1hbmQgQmxvY2sgV3JhcHBl
ciAqLworc3RydWN0IF9fYXR0cmlidXRlX18oKF9fcGFja2VkX18pKSBVc2JDZENCVyB7CisgICAg
dWludDMyX3Qgc2lnOworICAgIHVpbnQzMl90IHRhZzsKKyAgICB1aW50MzJfdCBleHBfZGF0YV9s
ZW47IC8qIGV4cGVjdGVkIGRhdGEgeGZlciBsZW5ndGggZm9yIHRoZSByZXF1ZXN0ICovCisgICAg
dWludDhfdCBmbGFnczsKKyAgICB1aW50OF90IGx1bjsKKyAgICB1aW50OF90IGNtZF9sZW47IC8q
IGFjdHVhbCBsZW5ndGggb2YgdGhlIHNjc2kgY29tbWFuZCB0aGF0IGZvbGxvd3MgKi8KKyAgICB1
aW50OF90IGNtZFsxNl07IC8qIHNjc2kgY29tbWFuZCB0byBwZXJmb3JtICovCit9OworCisvKiBV
U0IgTVNEIENvbW1hbmQgU3RhdHVzIFdyYXBwZXIgKi8KK3N0cnVjdCBfX2F0dHJpYnV0ZV9fKChf
X3BhY2tlZF9fKSkgVXNiQ2RDU1cgeworICAgIHVpbnQzMl90IHNpZzsKKyAgICB1aW50MzJfdCB0
YWc7CisgICAgdWludDMyX3QgcmVzaWR1ZTsKKyAgICB1aW50OF90IHN0YXR1czsKK307CisKKy8q
IFVzYkNkQ1NXOjpzdGF0dXMgKi8KK3R5cGVkZWYgZW51bSBVc2JNc2RTdGF0dXMgeworICAgIFVT
Ql9NU0RfU1RBVFVTX0dPT0QgPSAwLAorICAgIFVTQl9NU0RfU1RBVFVTX0ZBSUxFRCA9IDEsCisg
ICAgVVNCX01TRF9TVEFUVVNfUEhBU0VfRVJSID0gMiwKK30gVXNiTXNkU3RhdHVzOworCit0eXBl
ZGVmIHN0cnVjdCBVc2JDZEJ1bGtNc2RSZXF1ZXN0IHsKKyAgICBDZFNjc2lSZXF1ZXN0IHNjc2lf
cmVxOworCisgICAgdWludDMyX3QgbHVuOworICAgIHVpbnQzMl90IHVzYl90YWc7CisgICAgdWlu
dDMyX3QgdXNiX3JlcV9sZW47IC8qIGxlbmd0aCBvZiBkYXRhIHJlcXVlc3RlZCBieSB1c2IgKi8K
KyAgICB1aW50MzJfdCBzY3NpX2luX2xlbjsgLyogbGVuZ3RoIG9mIGRhdGEgcmV0dXJuZWQgYnkg
c2NzaSBsaW1pdGVkIGJ5IHVzYiByZXF1ZXN0ICovCisKKyAgICB1aW50MzJfdCB4ZmVyX2xlbjsg
LyogbGVuZ3RoIG9mIGRhdGEgdHJhbnNmZXJlZCB1bnRpbCBub3cgKi8KKyAgICB1aW50MzJfdCBi
dWxrX2luX2xlbjsgLyogbGVuZ3RoIG9mIHRoZSBsYXN0IHBvc3Rwb25lZCBidWxrLWluIHJlcXVl
c3QgKi8KKworICAgIHN0cnVjdCBVc2JDZENTVyBjc3c7IC8qIHVzYiBzdGF0dXMgaGVhZGVyICov
Cit9IFVzYkNkQnVsa01zZFJlcXVlc3Q7CisKK3R5cGVkZWYgc3RydWN0IFVzYkNkQnVsa01zZERl
dmljZSB7CisgICAgVXNiQ2RTdGF0ZSBzdGF0ZTsKKyAgICBDZFNjc2lUYXJnZXQgKnNjc2lfdGFy
Z2V0OyAvKiBzY3NpIGhhbmRsZSAqLworICAgIHZvaWQgKnVzYl91c2VyX2RhdGE7IC8qIHVzZWQg
aW4gY2FsbGJhY2tzIHRvIHVzYiAqLworICAgIFVzYkNkQnVsa01zZFJlcXVlc3QgdXNiX3JlcTsg
Lyogbm93IHN1cHBvcnRpbmcgYSBzaW5nbGUgY21kICovCisgICAgdWludDhfdCAqZGF0YV9idWY7
CisgICAgdWludDMyX3QgZGF0YV9idWZfbGVuOworfSBVc2JDZEJ1bGtNc2REZXZpY2U7CisKK3N0
YXRpYyBpbmxpbmUgY29uc3QgY2hhciAqdXNiX2NkX3N0YXRlX3N0cihVc2JDZFN0YXRlIHN0YXRl
KQoreworICAgIHN3aXRjaCAoc3RhdGUpIHsKKyAgICBjYXNlIFVTQl9DRF9TVEFURV9JTklUOgor
ICAgICAgICByZXR1cm4gIklOSVQiOworICAgIGNhc2UgVVNCX0NEX1NUQVRFX0NCVzoKKyAgICAg
ICAgcmV0dXJuICJDQlciOworICAgIGNhc2UgVVNCX0NEX1NUQVRFX0RBVEFPVVQ6CisgICAgICAg
IHJldHVybiAiREFUQU9VVCI7CisgICAgY2FzZSBVU0JfQ0RfU1RBVEVfREFUQUlOOgorICAgICAg
ICByZXR1cm4gIkRBVEFJTiI7CisgICAgY2FzZSBVU0JfQ0RfU1RBVEVfWkVST19EQVRBSU46Cisg
ICAgICAgIHJldHVybiAiWkVST19EQVRBSU4iOworICAgIGNhc2UgVVNCX0NEX1NUQVRFX0NTVzoK
KyAgICAgICAgcmV0dXJuICJDU1ciOworICAgIGNhc2UgVVNCX0NEX1NUQVRFX0RFVklDRV9SRVNF
VDoKKyAgICAgICAgcmV0dXJuICJERVZfUkVTRVQiOworICAgIGNhc2UgVVNCX0NEX1NUQVRFX1RB
UkdFVF9SRVNFVDoKKyAgICAgICAgcmV0dXJuICJUR1RfUkVTRVQiOworICAgIGRlZmF1bHQ6Cisg
ICAgICAgIHJldHVybiAiSUxMRUdBTCI7CisgICAgfQorfQorCitzdGF0aWMgdm9pZCBjZF91c2Jf
YnVsa19tc2Rfc2V0X3N0YXRlKFVzYkNkQnVsa01zZERldmljZSAqY2QsIFVzYkNkU3RhdGUgc3Rh
dGUpCit7CisgICAgU1BJQ0VfREVCVUcoIlN0YXRlICVzIC0+ICVzIiwgdXNiX2NkX3N0YXRlX3N0
cihjZC0+c3RhdGUpLCB1c2JfY2Rfc3RhdGVfc3RyKHN0YXRlKSk7CisgICAgY2QtPnN0YXRlID0g
c3RhdGU7Cit9CisKK1VzYkNkQnVsa01zZERldmljZSAqY2RfdXNiX2J1bGtfbXNkX2FsbG9jKHZv
aWQgKnVzYl91c2VyX2RhdGEsIHVpbnQzMl90IG1heF9sdW5zKQoreworICAgIFVzYkNkQnVsa01z
ZERldmljZSAqY2QgPSBnX25ldzAoVXNiQ2RCdWxrTXNkRGV2aWNlLCAxKTsKKworICAgIGNkLT5k
YXRhX2J1Zl9sZW4gPSAyNTYgKiAxMDI0OworICAgIGNkLT5kYXRhX2J1ZiA9IGdfbWFsbG9jKGNk
LT5kYXRhX2J1Zl9sZW4pOworCisgICAgY2QtPnNjc2lfdGFyZ2V0ID0gY2Rfc2NzaV90YXJnZXRf
YWxsb2MoY2QsIG1heF9sdW5zKTsKKyAgICBpZiAoY2QtPnNjc2lfdGFyZ2V0ID09IE5VTEwpIHsK
KyAgICAgICAgZ19mcmVlKGNkLT5kYXRhX2J1Zik7CisgICAgICAgIGdfZnJlZShjZCk7CisgICAg
ICAgIHJldHVybiBOVUxMOworICAgIH0KKyAgICBjZF91c2JfYnVsa19tc2Rfc2V0X3N0YXRlKGNk
LCBVU0JfQ0RfU1RBVEVfSU5JVCk7CisgICAgY2QtPnVzYl91c2VyX2RhdGEgPSB1c2JfdXNlcl9k
YXRhOworCisgICAgU1BJQ0VfREVCVUcoIkFsbG9jLCBtYXhfbHVuczolIiBHX0dVSU5UMzJfRk9S
TUFULCBtYXhfbHVucyk7CisgICAgcmV0dXJuIGNkOworfQorCitpbnQgY2RfdXNiX2J1bGtfbXNk
X3JlYWxpemUoVXNiQ2RCdWxrTXNkRGV2aWNlICpjZCwgdWludDMyX3QgbHVuLAorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGNvbnN0IENkU2NzaURldmljZVBhcmFtZXRlcnMgKmRldl9wYXJh
bXMpCit7CisgICAgQ2RTY3NpRGV2aWNlUGFyYW1ldGVycyBzY3NpX2Rldl9wYXJhbXM7CisgICAg
aW50IHJjOworCisgICAgc2NzaV9kZXZfcGFyYW1zLnZlbmRvciA9IGRldl9wYXJhbXMtPnZlbmRv
ciA/IDogIlNQSUNFIjsKKyAgICBzY3NpX2Rldl9wYXJhbXMucHJvZHVjdCA9IGRldl9wYXJhbXMt
PnByb2R1Y3QgPyA6ICJVU0ItQ0QiOworICAgIHNjc2lfZGV2X3BhcmFtcy52ZXJzaW9uID0gZGV2
X3BhcmFtcy0+dmVyc2lvbiA/IDogIjAuMSI7CisgICAgc2NzaV9kZXZfcGFyYW1zLnNlcmlhbCA9
IGRldl9wYXJhbXMtPnNlcmlhbCA/IDogIjEyMzQ1NiI7CisKKyAgICByYyA9IGNkX3Njc2lfZGV2
X3JlYWxpemUoY2QtPnNjc2lfdGFyZ2V0LCBsdW4sICZzY3NpX2Rldl9wYXJhbXMpOworICAgIGlm
IChyYyAhPSAwKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJGYWlsZWQgdG8gcmVhbGl6ZSBsdW46
JSIgR19HVUlOVDMyX0ZPUk1BVCwgbHVuKTsKKyAgICAgICAgcmV0dXJuIHJjOworICAgIH0KKwor
ICAgIGlmIChjZC0+c3RhdGUgPT0gVVNCX0NEX1NUQVRFX0lOSVQpIHsKKyAgICAgICAgLyogd2Fp
dCBuZXh0IHJlcXVlc3QgKi8KKyAgICAgICAgY2RfdXNiX2J1bGtfbXNkX3NldF9zdGF0ZShjZCwg
VVNCX0NEX1NUQVRFX0NCVyk7CisgICAgICAgIGNkX3Njc2lfZGV2X3JlcXVlc3RfcmVsZWFzZShj
ZC0+c2NzaV90YXJnZXQsICZjZC0+dXNiX3JlcS5zY3NpX3JlcSk7CisgICAgfQorCisgICAgU1BJ
Q0VfREVCVUcoIlJlYWxpemUgT0sgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQsIGx1bik7CisgICAg
cmV0dXJuIDA7Cit9CisKK2ludCBjZF91c2JfYnVsa19tc2RfbG9jayhVc2JDZEJ1bGtNc2REZXZp
Y2UgKmNkLCB1aW50MzJfdCBsdW4sIGdib29sZWFuIGxvY2spCit7CisgICAgaW50IHJjOworCisg
ICAgcmMgPSBjZF9zY3NpX2Rldl9sb2NrKGNkLT5zY3NpX3RhcmdldCwgbHVuLCBsb2NrKTsKKyAg
ICBpZiAocmMgIT0gMCkgeworICAgICAgICBTUElDRV9FUlJPUigiRmFpbGVkIHRvIGxvY2sgbHVu
OiUiIEdfR1VJTlQzMl9GT1JNQVQsIGx1bik7CisgICAgICAgIHJldHVybiByYzsKKyAgICB9CisK
KyAgICBTUElDRV9ERUJVRygiTG9jayBPSyBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCwgbHVuKTsK
KyAgICByZXR1cm4gMDsKK30KKworaW50IGNkX3VzYl9idWxrX21zZF9sb2FkKFVzYkNkQnVsa01z
ZERldmljZSAqY2QsIHVpbnQzMl90IGx1biwKKyAgICAgICAgICAgICAgICAgICAgICAgICBjb25z
dCBDZFNjc2lNZWRpYVBhcmFtZXRlcnMgKm1lZGlhX3BhcmFtcykKK3sKKyAgICBpbnQgcmM7CisK
KyAgICByYyA9IGNkX3Njc2lfZGV2X2xvYWQoY2QtPnNjc2lfdGFyZ2V0LCBsdW4sIG1lZGlhX3Bh
cmFtcyk7CisgICAgaWYgKHJjICE9IDApIHsKKyAgICAgICAgU1BJQ0VfRVJST1IoIkZhaWxlZCB0
byBsb2FkIGx1bjolIiBHX0dVSU5UMzJfRk9STUFULCBsdW4pOworICAgICAgICByZXR1cm4gcmM7
CisgICAgfQorCisgICAgU1BJQ0VfREVCVUcoIkxvYWQgT0sgbHVuOiUiIEdfR1VJTlQzMl9GT1JN
QVQsIGx1bik7CisgICAgcmV0dXJuIDA7Cit9CisKK2ludCBjZF91c2JfYnVsa19tc2RfZ2V0X2lu
Zm8oVXNiQ2RCdWxrTXNkRGV2aWNlICpjZCwgdWludDMyX3QgbHVuLCBDZFNjc2lEZXZpY2VJbmZv
ICpsdW5faW5mbykKK3sKKyAgICBpbnQgcmM7CisKKyAgICByYyA9IGNkX3Njc2lfZGV2X2dldF9p
bmZvKGNkLT5zY3NpX3RhcmdldCwgbHVuLCBsdW5faW5mbyk7CisgICAgaWYgKHJjICE9IDApIHsK
KyAgICAgICAgU1BJQ0VfRVJST1IoIkZhaWxlZCB0byBnZXQgaW5mbyBsdW46JSIgR19HVUlOVDMy
X0ZPUk1BVCwgbHVuKTsKKyAgICAgICAgcmV0dXJuIHJjOworICAgIH0KKworICAgIHJldHVybiAw
OworfQorCitpbnQgY2RfdXNiX2J1bGtfbXNkX3VubG9hZChVc2JDZEJ1bGtNc2REZXZpY2UgKmNk
LCB1aW50MzJfdCBsdW4pCit7CisgICAgaW50IHJjOworCisgICAgcmMgPSBjZF9zY3NpX2Rldl91
bmxvYWQoY2QtPnNjc2lfdGFyZ2V0LCBsdW4pOworICAgIGlmIChyYyAhPSAwKSB7CisgICAgICAg
IFNQSUNFX0VSUk9SKCJGYWlsZWQgdG8gdW5sb2FkIGx1bjolIiBHX0dVSU5UMzJfRk9STUFULCBs
dW4pOworICAgICAgICByZXR1cm4gcmM7CisgICAgfQorCisgICAgU1BJQ0VfREVCVUcoIlVubG9h
ZCBPSyBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCwgbHVuKTsKKyAgICByZXR1cm4gMDsKK30KKwor
aW50IGNkX3VzYl9idWxrX21zZF91bnJlYWxpemUoVXNiQ2RCdWxrTXNkRGV2aWNlICpjZCwgdWlu
dDMyX3QgbHVuKQoreworICAgIGludCByYzsKKworICAgIHJjID0gY2Rfc2NzaV9kZXZfdW5yZWFs
aXplKGNkLT5zY3NpX3RhcmdldCwgbHVuKTsKKyAgICBpZiAocmMgIT0gMCkgeworICAgICAgICBT
UElDRV9FUlJPUigiVW5yZWFsaXplIGx1bjolIiBHX0dVSU5UMzJfRk9STUFULCBsdW4pOworICAg
ICAgICByZXR1cm4gcmM7CisgICAgfQorCisgICAgU1BJQ0VfREVCVUcoIlVucmVhbGl6ZSBsdW46
JSIgR19HVUlOVDMyX0ZPUk1BVCwgbHVuKTsKKyAgICByZXR1cm4gMDsKK30KKwordm9pZCBjZF91
c2JfYnVsa19tc2RfZnJlZShVc2JDZEJ1bGtNc2REZXZpY2UgKmNkKQoreworICAgIGNkX3Njc2lf
dGFyZ2V0X2ZyZWUoY2QtPnNjc2lfdGFyZ2V0KTsKKyAgICBnX2ZyZWUoY2QtPmRhdGFfYnVmKTsK
KyAgICBnX2ZyZWUoY2QpOworCisgICAgU1BJQ0VfREVCVUcoIkZyZWUiKTsKK30KKworaW50IGNk
X3VzYl9idWxrX21zZF9yZXNldChVc2JDZEJ1bGtNc2REZXZpY2UgKmNkKQoreworICAgIGNkX3Nj
c2lfdGFyZ2V0X3Jlc2V0KGNkLT5zY3NpX3RhcmdldCk7CisgICAgY2RfdXNiX2J1bGtfbXNkX3Nl
dF9zdGF0ZShjZCwgVVNCX0NEX1NUQVRFX0NCVyk7CisKKyAgICBTUElDRV9ERUJVRygiUmVzZXQi
KTsKKyAgICByZXR1cm4gMDsKK30KKworc3RhdGljIGludCBwYXJzZV91c2JfbXNkX2NtZChVc2JD
ZEJ1bGtNc2REZXZpY2UgKmNkLCB1aW50OF90ICpidWYsIHVpbnQzMl90IGNid19sZW4pCit7Cisg
ICAgc3RydWN0IFVzYkNkQ0JXICpjYncgPSAoc3RydWN0IFVzYkNkQ0JXICopYnVmOworICAgIFVz
YkNkQnVsa01zZFJlcXVlc3QgKnVzYl9yZXEgPSAmY2QtPnVzYl9yZXE7CisgICAgQ2RTY3NpUmVx
dWVzdCAqc2NzaV9yZXEgPSAmdXNiX3JlcS0+c2NzaV9yZXE7CisKKyAgICBpZiAoY2J3X2xlbiAh
PSBzaXplb2YoKmNidykpIHsKKyAgICAgICAgU1BJQ0VfRVJST1IoIkNNRDogQmFkIENCVyBzaXpl
OiUiIEdfR1VJTlQzMl9GT1JNQVQsIGNid19sZW4pOworICAgICAgICByZXR1cm4gLTE7CisgICAg
fQorICAgIGlmIChsZTMydG9oKGNidy0+c2lnKSAhPSAweDQzNDI1MzU1KSB7IC8qIE1TRCBjb21t
YW5kIHNpZ25hdHVyZSAqLworICAgICAgICBTUElDRV9FUlJPUigiQ01EOiBCYWQgQ0JXIHNpZ25h
dHVyZTolMDh4IiwgbGUzMnRvaChjYnctPnNpZykpOworICAgICAgICByZXR1cm4gLTE7CisgICAg
fQorICAgIGlmIChjYnctPmNtZF9sZW4gPCAxIHx8IGNidy0+Y21kX2xlbiA+PSAxNikgeworICAg
ICAgICBTUElDRV9FUlJPUigiQ01EOiBCYWQgQ0JXIGNvbW1hbmQgbGVuOiUwOHgiLCBjYnctPmNt
ZF9sZW4pOworICAgICAgICByZXR1cm4gLTE7CisgICAgfQorCisgICAgdXNiX3JlcS0+bHVuID0g
Y2J3LT5sdW47CisgICAgdXNiX3JlcS0+dXNiX3RhZyA9IGxlMzJ0b2goY2J3LT50YWcpOworICAg
IHVzYl9yZXEtPnVzYl9yZXFfbGVuID0gbGUzMnRvaChjYnctPmV4cF9kYXRhX2xlbik7CisKKyAg
ICB1c2JfcmVxLT5zY3NpX2luX2xlbiA9IDA7IC8qIG5vIGRhdGEgZnJvbSBzY3NpIHlldCAqLwor
ICAgIHVzYl9yZXEtPnhmZXJfbGVuID0gMDsgLyogbm8gYnVsa3MgdHJhbnNmZXJlZCB5ZXQgKi8K
KyAgICB1c2JfcmVxLT5idWxrX2luX2xlbiA9IDA7IC8qIG5vIGJ1bGstaW4gcmVxdWVzdHMgeWV0
ICovCisKKyAgICBpZiAodXNiX3JlcS0+dXNiX3JlcV9sZW4gPT0gMCkgeworICAgICAgICBjZF91
c2JfYnVsa19tc2Rfc2V0X3N0YXRlKGNkLCBVU0JfQ0RfU1RBVEVfQ1NXKTsgLyogbm8gZGF0YSAt
IHJldHVybiBzdGF0dXMgKi8KKyAgICAgICAgc2NzaV9yZXEtPmJ1ZiA9IE5VTEw7CisgICAgICAg
IHNjc2lfcmVxLT5idWZfbGVuID0gMDsKKyAgICB9IGVsc2UgaWYgKGNidy0+ZmxhZ3MgJiAweDgw
KSB7CisgICAgICAgIGNkX3VzYl9idWxrX21zZF9zZXRfc3RhdGUoY2QsIFVTQl9DRF9TVEFURV9E
QVRBSU4pOyAvKiByZWFkIGNvbW1hbmQgKi8KKyAgICAgICAgc2NzaV9yZXEtPmJ1ZiA9IGNkLT5k
YXRhX2J1ZjsKKyAgICAgICAgc2NzaV9yZXEtPmJ1Zl9sZW4gPSBjZC0+ZGF0YV9idWZfbGVuOwor
ICAgIH0gZWxzZSB7CisgICAgICAgIGNkX3VzYl9idWxrX21zZF9zZXRfc3RhdGUoY2QsIFVTQl9D
RF9TVEFURV9EQVRBT1VUKTsgLyogd3JpdGUgY29tbWFuZCAqLworICAgICAgICBzY3NpX3JlcS0+
YnVmID0gTlVMTDsKKyAgICAgICAgc2NzaV9yZXEtPmJ1Zl9sZW4gPSAwOworICAgIH0KKworICAg
IHNjc2lfcmVxLT5jZGJfbGVuID0gY2J3LT5jbWRfbGVuOworICAgIGdfYXNzZXJ0KHNjc2lfcmVx
LT5jZGJfbGVuIDw9IHNpemVvZihzY3NpX3JlcS0+Y2RiKSk7CisgICAgbWVtY3B5KHNjc2lfcmVx
LT5jZGIsIGNidy0+Y21kLCBzY3NpX3JlcS0+Y2RiX2xlbik7CisKKyAgICBzY3NpX3JlcS0+dGFn
ID0gdXNiX3JlcS0+dXNiX3RhZzsKKyAgICBzY3NpX3JlcS0+bHVuID0gdXNiX3JlcS0+bHVuOwor
CisgICAgU1BJQ0VfREVCVUcoIkNNRCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCAiIHRhZzoweCV4
IGZsYWdzOiUwOHggIgorICAgICAgICAiY2RiX2xlbjolIiBHX0dVSU5UMzJfRk9STUFUICIgcmVx
X2xlbjolIiBHX0dVSU5UMzJfRk9STUFULAorICAgICAgICB1c2JfcmVxLT5sdW4sIHVzYl9yZXEt
PnVzYl90YWcsIGNidy0+ZmxhZ3MsCisgICAgICAgIHNjc2lfcmVxLT5jZGJfbGVuLCB1c2JfcmVx
LT51c2JfcmVxX2xlbik7CisKKyAgICAvKiBwcmVwYXJlIHN0YXR1cyAtIENTVyAqLworICAgIHVz
Yl9yZXEtPmNzdy5zaWcgPSBodG9sZTMyKDB4NTM0MjUzNTUpOworICAgIHVzYl9yZXEtPmNzdy50
YWcgPSBjYnctPnRhZzsKKyAgICB1c2JfcmVxLT5jc3cucmVzaWR1ZSA9IDA7CisgICAgdXNiX3Jl
cS0+Y3N3LnN0YXR1cyA9ICh1aW50OF90KVVTQl9NU0RfU1RBVFVTX0dPT0Q7CisKKyAgICByZXR1
cm4gMDsKK30KKworc3RhdGljIHZvaWQgdXNiX2NkX2NtZF9kb25lKFVzYkNkQnVsa01zZERldmlj
ZSAqY2QpCit7CisgICAgVXNiQ2RCdWxrTXNkUmVxdWVzdCAqdXNiX3JlcSA9ICZjZC0+dXNiX3Jl
cTsKKyAgICBDZFNjc2lSZXF1ZXN0ICpzY3NpX3JlcSA9ICZ1c2JfcmVxLT5zY3NpX3JlcTsKKwor
ICAgIGNkX3VzYl9idWxrX21zZF9zZXRfc3RhdGUoY2QsIFVTQl9DRF9TVEFURV9DQlcpOyAvKiBD
b21tYW5kIG5leHQgKi8KKyAgICBjZF9zY3NpX2Rldl9yZXF1ZXN0X3JlbGVhc2UoY2QtPnNjc2lf
dGFyZ2V0LCBzY3NpX3JlcSk7Cit9CisKK3N0YXRpYyB2b2lkIHVzYl9jZF9zZW5kX3N0YXR1cyhV
c2JDZEJ1bGtNc2REZXZpY2UgKmNkKQoreworICAgIFVzYkNkQnVsa01zZFJlcXVlc3QgKnVzYl9y
ZXEgPSAmY2QtPnVzYl9yZXE7CisKKyAgICBTUElDRV9ERUJVRygiQ29tbWFuZCBDU1cgdGFnOjB4
JXggbXNkX3N0YXR1czolZCBsZW46JSIgR19HVUlOVDY0X0ZPUk1BVCwKKyAgICAgICAgICAgICAg
ICBsZTMydG9oKHVzYl9yZXEtPmNzdy50YWcpLCAoaW50KXVzYl9yZXEtPmNzdy5zdGF0dXMsIHNp
emVvZih1c2JfcmVxLT5jc3cpKTsKKworICAgIHVzYl9jZF9jbWRfZG9uZShjZCk7CisKKyAgICBn
X2Fzc2VydCh1c2JfcmVxLT5jc3cuc2lnID09IGh0b2xlMzIoMHg1MzQyNTM1NSkpOworICAgIGNk
X3VzYl9idWxrX21zZF9yZWFkX2NvbXBsZXRlKGNkLT51c2JfdXNlcl9kYXRhLAorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICh1aW50OF90ICopJnVzYl9yZXEtPmNzdywgc2l6ZW9m
KHVzYl9yZXEtPmNzdyksCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQlVMS19T
VEFUVVNfR09PRCk7Cit9CisKK3N0YXRpYyB2b2lkIHVzYl9jZF9zZW5kX2NhbmNlbGVkKFVzYkNk
QnVsa01zZERldmljZSAqY2QpCit7CisgICAgVXNiQ2RCdWxrTXNkUmVxdWVzdCAqdXNiX3JlcSA9
ICZjZC0+dXNiX3JlcTsKKworICAgIFNQSUNFX0RFQlVHKCJDYW5jZWxlZCBjbWQgdGFnOjB4JXgs
IGxlbjolIiBHX0dVSU5UNjRfRk9STUFULAorICAgICAgICAgICAgICAgIGxlMzJ0b2godXNiX3Jl
cS0+Y3N3LnRhZyksIHNpemVvZih1c2JfcmVxLT5jc3cpKTsKKworICAgIHVzYl9jZF9jbWRfZG9u
ZShjZCk7CisKKyAgICBjZF91c2JfYnVsa19tc2RfcmVhZF9jb21wbGV0ZShjZC0+dXNiX3VzZXJf
ZGF0YSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOVUxMLCAwLAorICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIEJVTEtfU1RBVFVTX0NBTkNFTEVEKTsKK30KKwor
c3RhdGljIHZvaWQgdXNiX2NkX3NlbmRfZGF0YV9pbihVc2JDZEJ1bGtNc2REZXZpY2UgKmNkLCB1
aW50MzJfdCBtYXhfbGVuKQoreworICAgIFVzYkNkQnVsa01zZFJlcXVlc3QgKnVzYl9yZXEgPSAm
Y2QtPnVzYl9yZXE7CisgICAgQ2RTY3NpUmVxdWVzdCAqc2NzaV9yZXEgPSAmdXNiX3JlcS0+c2Nz
aV9yZXE7CisgICAgdWludDhfdCAqYnVmID0gKCh1aW50OF90ICopc2NzaV9yZXEtPmJ1ZikgKyB1
c2JfcmVxLT54ZmVyX2xlbjsKKyAgICB1aW50MzJfdCBhdmFpbF9sZW4gPSB1c2JfcmVxLT5zY3Np
X2luX2xlbiAtIHVzYl9yZXEtPnhmZXJfbGVuOworICAgIHVpbnQzMl90IHNlbmRfbGVuID0gTUlO
KGF2YWlsX2xlbiwgbWF4X2xlbik7CisKKyAgICBTUElDRV9ERUJVRygiRGF0YS1pbiBjbWQgdGFn
IDB4JXgsIHJlbWFpbnMgJSIgR19HVUlOVDMyX0ZPUk1BVAorICAgICAgICAgICAgICAgICIsIHJl
cXVlc3RlZCAlIiBHX0dVSU5UMzJfRk9STUFUICIsIHNlbmQgJSIgR19HVUlOVDMyX0ZPUk1BVCwK
KyAgICAgICAgICAgICAgICB1c2JfcmVxLT5jc3cudGFnLCBhdmFpbF9sZW4sIG1heF9sZW4sIHNl
bmRfbGVuKTsKKworICAgIGdfYXNzZXJ0KG1heF9sZW4gPD0gdXNiX3JlcS0+dXNiX3JlcV9sZW4p
OworCisgICAgY2RfdXNiX2J1bGtfbXNkX3JlYWRfY29tcGxldGUoY2QtPnVzYl91c2VyX2RhdGEs
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnVmLCBzZW5kX2xlbiwKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBCVUxLX1NUQVRVU19HT09EKTsKKworICAgIGlm
IChzY3NpX3JlcS0+c3RhdHVzID09IEdPT0QpIHsKKyAgICAgICAgdXNiX3JlcS0+eGZlcl9sZW4g
Kz0gc2VuZF9sZW47CisgICAgICAgIGlmICh1c2JfcmVxLT54ZmVyX2xlbiA9PSB1c2JfcmVxLT5z
Y3NpX2luX2xlbikgeworICAgICAgICAgICAgLyogYWxsIGRhdGEgZm9yIHRoaXMgYnVsayBoYXMg
YmVlbiB0cmFuc2ZlcnJlZCAqLworICAgICAgICAgICAgaWYgKHVzYl9yZXEtPnNjc2lfaW5fbGVu
ID09IHVzYl9yZXEtPnVzYl9yZXFfbGVuIHx8IC8qIHJlcSBmdWxseSBzYXRpc2ZpZWQgKi8KKyAg
ICAgICAgICAgICAgICBzZW5kX2xlbiA8IG1heF9sZW4pIHsgLyogcGFydGlhbCBidWxrIC0gbm8g
bW9yZSBkYXRhICovCisgICAgICAgICAgICAgICAgY2RfdXNiX2J1bGtfbXNkX3NldF9zdGF0ZShj
ZCwgVVNCX0NEX1NUQVRFX0NTVyk7CisgICAgICAgICAgICB9IGVsc2UgeworICAgICAgICAgICAg
ICAgIC8qIHBhcnRpYWwgY21kIGRhdGEgZnVsbGZpbGxlZCBlbnRpcmUgdnVsay1pbiByZXF1ZXN0
ICovCisgICAgICAgICAgICAgICAgY2RfdXNiX2J1bGtfbXNkX3NldF9zdGF0ZShjZCwgVVNCX0NE
X1NUQVRFX1pFUk9fREFUQUlOKTsKKyAgICAgICAgICAgIH0KKyAgICAgICAgfQorICAgIH0gZWxz
ZSB7IC8qIGNtZCBmYWlsZWQgLSBubyBtb3JlIGRhdGEgKi8KKyAgICAgICAgY2RfdXNiX2J1bGtf
bXNkX3NldF9zdGF0ZShjZCwgVVNCX0NEX1NUQVRFX0NTVyk7CisgICAgfQorfQorCitpbnQgY2Rf
dXNiX2J1bGtfbXNkX3JlYWQoVXNiQ2RCdWxrTXNkRGV2aWNlICpjZCwgdWludDMyX3QgbWF4X2xl
bikKK3sKKyAgICBVc2JDZEJ1bGtNc2RSZXF1ZXN0ICp1c2JfcmVxID0gJmNkLT51c2JfcmVxOwor
ICAgIENkU2NzaVJlcXVlc3QgKnNjc2lfcmVxID0gJnVzYl9yZXEtPnNjc2lfcmVxOworCisgICAg
U1BJQ0VfREVCVUcoIm1zZF9yZWFkLCBzdGF0ZTogJXMsIGxlbiAlIiBHX0dVSU5UMzJfRk9STUFU
LAorICAgICAgICAgICAgICAgIHVzYl9jZF9zdGF0ZV9zdHIoY2QtPnN0YXRlKSwgbWF4X2xlbik7
CisKKyAgICBzd2l0Y2ggKGNkLT5zdGF0ZSkgeworICAgIGNhc2UgVVNCX0NEX1NUQVRFX0NTVzog
LyogQ29tbWFuZCBTdGF0dXMgKi8KKyAgICAgICAgaWYgKG1heF9sZW4gPCAxMykgeworICAgICAg
ICAgICAgZ290byBmYWlsOworICAgICAgICB9CisgICAgICAgIGlmIChjZF9zY3NpX2dldF9yZXFf
c3RhdGUoc2NzaV9yZXEpID09IFNDU0lfUkVRX0NPTVBMRVRFKSB7CisgICAgICAgICAgICB1c2Jf
Y2Rfc2VuZF9zdGF0dXMoY2QpOworICAgICAgICB9IGVsc2UgeworICAgICAgICAgICAgdXNiX3Jl
cS0+YnVsa19pbl9sZW4gKz0gbWF4X2xlbjsKKyAgICAgICAgICAgIFNQSUNFX0RFQlVHKCJtc2Rf
cmVhZCBDU1csIHJlcSBpbmNvbXBsZXRlLCBhZGRlZCBsZW4gJSIgR19HVUlOVDMyX0ZPUk1BVAor
ICAgICAgICAgICAgICAgICAgICAgICAgIiBzYXZlZCBsZW4gJSIgR19HVUlOVDMyX0ZPUk1BVCwK
KyAgICAgICAgICAgICAgICAgICAgICAgIG1heF9sZW4sIHVzYl9yZXEtPmJ1bGtfaW5fbGVuKTsK
KyAgICAgICAgfQorICAgICAgICBicmVhazsKKworICAgIGNhc2UgVVNCX0NEX1NUQVRFX0RBVEFJ
TjogLyogQnVsayBEYXRhLUlOICovCisgICAgICAgIGlmIChjZF9zY3NpX2dldF9yZXFfc3RhdGUo
c2NzaV9yZXEpID09IFNDU0lfUkVRX0NPTVBMRVRFKSB7CisgICAgICAgICAgICB1c2JfY2Rfc2Vu
ZF9kYXRhX2luKGNkLCBtYXhfbGVuKTsKKyAgICAgICAgfSBlbHNlIHsKKyAgICAgICAgICAgIHVz
Yl9yZXEtPmJ1bGtfaW5fbGVuICs9IG1heF9sZW47CisgICAgICAgICAgICBTUElDRV9ERUJVRygi
bXNkX3JlYWQgREFUQUlOLCByZXEgaW5jb21wbGV0ZSwgYWRkZWQgbGVuICUiIEdfR1VJTlQzMl9G
T1JNQVQKKyAgICAgICAgICAgICAgICAgICAgICAgICIgc2F2ZWQgbGVuICUiIEdfR1VJTlQzMl9G
T1JNQVQsCisgICAgICAgICAgICAgICAgICAgICAgICBtYXhfbGVuLCB1c2JfcmVxLT5idWxrX2lu
X2xlbik7CisgICAgICAgIH0KKyAgICAgICAgYnJlYWs7CisKKyAgICBjYXNlIFVTQl9DRF9TVEFU
RV9aRVJPX0RBVEFJTjoKKyAgICAgICAgY2RfdXNiX2J1bGtfbXNkX3JlYWRfY29tcGxldGUoY2Qt
PnVzYl91c2VyX2RhdGEsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5V
TEwsIDAsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEJVTEtfU1RBVFVT
X0dPT0QpOworICAgICAgICBjZF91c2JfYnVsa19tc2Rfc2V0X3N0YXRlKGNkLCBVU0JfQ0RfU1RB
VEVfQ1NXKTsgLyogU3RhdHVzIG5leHQgKi8KKyAgICAgICAgYnJlYWs7CisKKyAgICBkZWZhdWx0
OgorICAgICAgICBTUElDRV9FUlJPUigiVW5leHBlY3RlZCByZWFkIHN0YXRlOiAlcywgbGVuICUi
IEdfR1VJTlQzMl9GT1JNQVQsCisgICAgICAgICAgICAgICAgICAgIHVzYl9jZF9zdGF0ZV9zdHIo
Y2QtPnN0YXRlKSwgbWF4X2xlbik7CisgICAgICAgIGdvdG8gZmFpbDsKKyAgICB9CisgICAgcmV0
dXJuIDA7CisKK2ZhaWw6CisgICAgcmV0dXJuIC0xOworfQorCit2b2lkIGNkX3Njc2lfZGV2X3Jl
cXVlc3RfY29tcGxldGUodm9pZCAqdGFyZ2V0X3VzZXJfZGF0YSwgQ2RTY3NpUmVxdWVzdCAqc2Nz
aV9yZXEpCit7CisgICAgVXNiQ2RCdWxrTXNkRGV2aWNlICpjZCA9IChVc2JDZEJ1bGtNc2REZXZp
Y2UgKil0YXJnZXRfdXNlcl9kYXRhOworICAgIFVzYkNkQnVsa01zZFJlcXVlc3QgKnVzYl9yZXEg
PSAmY2QtPnVzYl9yZXE7CisKKyAgICBnX2Fzc2VydChzY3NpX3JlcSA9PSAmdXNiX3JlcS0+c2Nz
aV9yZXEpOworCisgICAgaWYgKHNjc2lfcmVxLT5yZXFfc3RhdGUgPT0gU0NTSV9SRVFfQ09NUExF
VEUpIHsKKworICAgICAgICB1c2JfcmVxLT5zY3NpX2luX2xlbiA9IChzY3NpX3JlcS0+aW5fbGVu
IDw9IHVzYl9yZXEtPnVzYl9yZXFfbGVuKSA/CisgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHNjc2lfcmVxLT5pbl9sZW4gOiB1c2JfcmVxLT51c2JfcmVxX2xlbjsKKworICAgICAgICAv
KiBwcmVwYXJlIENTVyAqLworICAgICAgICBpZiAodXNiX3JlcS0+dXNiX3JlcV9sZW4gPiB1c2Jf
cmVxLT5zY3NpX2luX2xlbikgeworICAgICAgICAgICAgdXNiX3JlcS0+Y3N3LnJlc2lkdWUgPSBo
dG9sZTMyKHVzYl9yZXEtPnVzYl9yZXFfbGVuIC0gdXNiX3JlcS0+c2NzaV9pbl9sZW4pOworICAg
ICAgICB9CisgICAgICAgIGlmIChzY3NpX3JlcS0+c3RhdHVzICE9IEdPT0QpIHsKKyAgICAgICAg
ICAgIHVzYl9yZXEtPmNzdy5zdGF0dXMgPSAodWludDhfdClVU0JfTVNEX1NUQVRVU19GQUlMRUQ7
CisgICAgICAgIH0KKworICAgICAgICBpZiAodXNiX3JlcS0+YnVsa19pbl9sZW4pIHsKKyAgICAg
ICAgICAgIC8qIGJ1bGstaW4gcmVxdWVzdCBhcnJpdmVkIHdoaWxlIHNjc2kgd2FzIHN0aWxsIHJ1
bm5pbmcgKi8KKyAgICAgICAgICAgIGlmIChjZC0+c3RhdGUgPT0gVVNCX0NEX1NUQVRFX0RBVEFJ
TikgeworICAgICAgICAgICAgICAgIHVzYl9jZF9zZW5kX2RhdGFfaW4oY2QsIHVzYl9yZXEtPmJ1
bGtfaW5fbGVuKTsKKyAgICAgICAgICAgIH0gZWxzZSBpZiAoY2QtPnN0YXRlID09IFVTQl9DRF9T
VEFURV9DU1cpIHsKKyAgICAgICAgICAgICAgICB1c2JfY2Rfc2VuZF9zdGF0dXMoY2QpOworICAg
ICAgICAgICAgfQorICAgICAgICAgICAgdXNiX3JlcS0+YnVsa19pbl9sZW4gPSAwOworICAgICAg
ICB9CisgICAgfSBlbHNlIGlmIChzY3NpX3JlcS0+cmVxX3N0YXRlID09IFNDU0lfUkVRX0NBTkNF
TEVEKSB7CisgICAgICAgIHVzYl9jZF9zZW5kX2NhbmNlbGVkKGNkKTsKKyAgICB9IGVsc2Ugewor
ICAgICAgICBnX2Fzc2VydChzY3NpX3JlcS0+cmVxX3N0YXRlID09IFNDU0lfUkVRX0RJU1BPU0VE
KTsKKyAgICAgICAgU1BJQ0VfREVCVUcoIkRpc3Bvc2VkIGNtZCB0YWc6MHgleCwgbGVuOiUiIEdf
R1VJTlQ2NF9GT1JNQVQsCisgICAgICAgICAgICAgICAgbGUzMnRvaCh1c2JfcmVxLT5jc3cudGFn
KSwgc2l6ZW9mKHVzYl9yZXEtPmNzdykpOworICAgICAgICB1c2JfY2RfY21kX2RvbmUoY2QpOwor
ICAgIH0KK30KKworaW50IGNkX3VzYl9idWxrX21zZF9jYW5jZWxfcmVhZChVc2JDZEJ1bGtNc2RE
ZXZpY2UgKmNkKQoreworICAgIFVzYkNkQnVsa01zZFJlcXVlc3QgKnVzYl9yZXEgPSAmY2QtPnVz
Yl9yZXE7CisgICAgQ2RTY3NpUmVxdWVzdCAqc2NzaV9yZXEgPSAmdXNiX3JlcS0+c2NzaV9yZXE7
CisKKyAgICBjZF9zY3NpX2Rldl9yZXF1ZXN0X2NhbmNlbChjZC0+c2NzaV90YXJnZXQsIHNjc2lf
cmVxKTsKKyAgICByZXR1cm4gMDsKK30KKworaW50IGNkX3VzYl9idWxrX21zZF93cml0ZShVc2JD
ZEJ1bGtNc2REZXZpY2UgKmNkLCB1aW50OF90ICpidWZfb3V0LCB1aW50MzJfdCBidWZfb3V0X2xl
bikKK3sKKyAgICBzd2l0Y2ggKGNkLT5zdGF0ZSkgeworICAgIGNhc2UgVVNCX0NEX1NUQVRFX0NC
VzogLyogQ29tbWFuZCBCbG9jayAqLworICAgICAgICBwYXJzZV91c2JfbXNkX2NtZChjZCwgYnVm
X291dCwgYnVmX291dF9sZW4pOworICAgICAgICBpZiAoY2QtPnN0YXRlID09IFVTQl9DRF9TVEFU
RV9EQVRBSU4gfHwgY2QtPnN0YXRlID09IFVTQl9DRF9TVEFURV9DU1cpIHsKKyAgICAgICAgICAg
IGNkX3Njc2lfZGV2X3JlcXVlc3Rfc3VibWl0KGNkLT5zY3NpX3RhcmdldCwgJmNkLT51c2JfcmVx
LnNjc2lfcmVxKTsKKyAgICAgICAgfQorICAgICAgICBicmVhazsKKyAgICBjYXNlIFVTQl9DRF9T
VEFURV9EQVRBT1VUOiAvKiBEYXRhLU91dCBmb3IgYSBXcml0ZSBjbWQgKi8KKyAgICAgICAgY2Qt
PnVzYl9yZXEuc2NzaV9yZXEuYnVmID0gYnVmX291dDsKKyAgICAgICAgY2QtPnVzYl9yZXEuc2Nz
aV9yZXEuYnVmX2xlbiA9IGJ1Zl9vdXRfbGVuOworICAgICAgICBjZF9zY3NpX2Rldl9yZXF1ZXN0
X3N1Ym1pdChjZC0+c2NzaV90YXJnZXQsICZjZC0+dXNiX3JlcS5zY3NpX3JlcSk7CisgICAgICAg
IGNkX3VzYl9idWxrX21zZF9zZXRfc3RhdGUoY2QsIFVTQl9DRF9TVEFURV9DU1cpOyAvKiBTdGF0
dXMgbmV4dCAqLworICAgICAgICBicmVhazsKKyAgICBkZWZhdWx0OgorICAgICAgICBTUElDRV9E
RUJVRygiVW5leHBlY3RlZCB3cml0ZSBzdGF0ZTogJXMsIGxlbiAlIiBHX0dVSU5UMzJfRk9STUFU
LAorICAgICAgICAgICAgICAgICAgICB1c2JfY2Rfc3RhdGVfc3RyKGNkLT5zdGF0ZSksIGJ1Zl9v
dXRfbGVuKTsKKyAgICAgICAgZ290byBmYWlsOworICAgIH0KKyAgICByZXR1cm4gMDsKKworZmFp
bDoKKyAgICByZXR1cm4gLTE7Cit9CisKK3ZvaWQgY2Rfc2NzaV9kZXZfcmVzZXRfY29tcGxldGUo
dm9pZCAqdGFyZ2V0X3VzZXJfZGF0YSwgdWludDMyX3QgbHVuKQoreworICAgIFVzYkNkQnVsa01z
ZERldmljZSAqY2QgPSAoVXNiQ2RCdWxrTXNkRGV2aWNlICopdGFyZ2V0X3VzZXJfZGF0YTsKKwor
ICAgIGlmIChjZC0+c3RhdGUgPT0gVVNCX0NEX1NUQVRFX0RFVklDRV9SRVNFVCkgeworICAgICAg
ICBjZF91c2JfYnVsa19tc2Rfc2V0X3N0YXRlKGNkLCBVU0JfQ0RfU1RBVEVfQ0JXKTsKKyAgICAg
ICAgY2RfdXNiX2J1bGtfbXNkX3Jlc2V0X2NvbXBsZXRlKGNkLT51c2JfdXNlcl9kYXRhLCAwKTsK
KyAgICB9Cit9CisKK3ZvaWQgY2Rfc2NzaV90YXJnZXRfcmVzZXRfY29tcGxldGUodm9pZCAqdGFy
Z2V0X3VzZXJfZGF0YSkKK3sKKyAgICBVc2JDZEJ1bGtNc2REZXZpY2UgKmNkID0gKFVzYkNkQnVs
a01zZERldmljZSAqKXRhcmdldF91c2VyX2RhdGE7CisgICAgY2RfdXNiX2J1bGtfbXNkX3NldF9z
dGF0ZShjZCwgVVNCX0NEX1NUQVRFX0lOSVQpOworfQorCit2b2lkIGNkX3Njc2lfZGV2X2NoYW5n
ZWQodm9pZCAqdGFyZ2V0X3VzZXJfZGF0YSwgdWludDMyX3QgbHVuKQoreworICAgIFVzYkNkQnVs
a01zZERldmljZSAqY2QgPSAoVXNiQ2RCdWxrTXNkRGV2aWNlICopdGFyZ2V0X3VzZXJfZGF0YTsK
KyAgICBTUElDRV9ERUJVRygiRGV2aWNlIGNoYW5nZWQsIHN0YXRlOiAlcyBsdW46ICUiIEdfR1VJ
TlQzMl9GT1JNQVQsCisgICAgICAgICAgICAgICAgdXNiX2NkX3N0YXRlX3N0cihjZC0+c3RhdGUp
LCBsdW4pOworICAgIGNkX3VzYl9idWxrX21zZF9sdW5fY2hhbmdlZChjZC0+dXNiX3VzZXJfZGF0
YSwgbHVuKTsKK30KKworI2VuZGlmIC8qIFVTRV9VU0JSRURJUiAqLwpkaWZmIC0tZ2l0IGEvc3Jj
L2NkLXVzYi1idWxrLW1zZC5oIGIvc3JjL2NkLXVzYi1idWxrLW1zZC5oCm5ldyBmaWxlIG1vZGUg
MTAwNjQ0CmluZGV4IDAwMDAwMDAuLjQ5MmE0OWIKLS0tIC9kZXYvbnVsbAorKysgYi9zcmMvY2Qt
dXNiLWJ1bGstbXNkLmgKQEAgLTAsMCArMSwxMzQgQEAKKy8qIC0qLSBNb2RlOiBDOyBjLWJhc2lj
LW9mZnNldDogNDsgaW5kZW50LXRhYnMtbW9kZTogbmlsIC0qLSAqLworLyoKKyAgICBDb3B5cmln
aHQgKEMpIDIwMTggUmVkIEhhdCwgSW5jLgorCisgICAgUmVkIEhhdCBBdXRob3JzOgorICAgIEFs
ZXhhbmRlciBOZXpoaW5za3k8YW5lemhpbnNAcmVkaGF0LmNvbT4KKworICAgIFRoaXMgbGlicmFy
eSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IKKyAgICBt
b2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGlj
CisgICAgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlv
bjsgZWl0aGVyCisgICAgdmVyc2lvbiAyLjEgb2YgdGhlIExpY2Vuc2UsIG9yIChhdCB5b3VyIG9w
dGlvbikgYW55IGxhdGVyIHZlcnNpb24uCisKKyAgICBUaGlzIGxpYnJhcnkgaXMgZGlzdHJpYnV0
ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKKyAgICBidXQgV0lUSE9VVCBB
TlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgorICAgIE1F
UkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0
aGUgR05VCisgICAgTGVzc2VyIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWls
cy4KKworICAgIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBMZXNz
ZXIgR2VuZXJhbCBQdWJsaWMKKyAgICBMaWNlbnNlIGFsb25nIHdpdGggdGhpcyBsaWJyYXJ5OyBp
ZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCisqLworCisjaWZuZGVm
IFNQSUNFX0dUS19DRF9VU0JfQlVMS19NU0RfSF9fCisjZGVmaW5lIFNQSUNFX0dUS19DRF9VU0Jf
QlVMS19NU0RfSF9fCisKK0dfQkVHSU5fREVDTFMKKworI2luY2x1ZGUgPGdpby9naW8uaD4KKwor
I2luY2x1ZGUgImNkLXNjc2ktZGV2LXBhcmFtcy5oIgorCit0eXBlZGVmIGVudW0gQ2RVc2JCdWxr
U3RhdHVzIHsKKyAgICBCVUxLX1NUQVRVU19HT09EID0gMCwKKyAgICBCVUxLX1NUQVRVU19FUlJP
UiwKKyAgICBCVUxLX1NUQVRVU19DQU5DRUxFRCwKKyAgICBCVUxLX1NUQVRVU19TVEFMTCwKK30g
Q2RVc2JCdWxrU3RhdHVzOworCit0eXBlZGVmIHN0cnVjdCBVc2JDZEJ1bGtNc2REZXZpY2UgVXNi
Q2RCdWxrTXNkRGV2aWNlOworCisvKiBVU0IgYmFja2VuZCBjYWxsYmFja3MgKi8KKworLyogY2Fs
bGVkIG9uIGNvbXBsZXRlZCByZWFkIGRhdGEgYnVsayB0cmFuc2ZlcgorICogdXNlcl9kYXRhIC0g
dXNlcl9kYXRhIGluIHVuaXQgcGFyYW1ldGVycyBzdHJ1Y3R1cmUKKyAqIHN0YXR1cyAtIGJ1bGsg
c3RhdHVzIGNvZGUKKyAqLwordm9pZCBjZF91c2JfYnVsa19tc2RfcmVhZF9jb21wbGV0ZSh2b2lk
ICp1c2VyX2RhdGEsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQ4X3Qg
KmRhdGEsIHVpbnQzMl90IGxlbmd0aCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgQ2RVc2JCdWxrU3RhdHVzIHN0YXR1cyk7CisKKy8qIGNhbGxlZCB3aGVuIHN0YXRlIG9mIGRl
dmljZSdzIHVuaXQgY2hhbmdlZCB0byBzaWduYWwgR1VJIGNvbXBvbmVudAorICogIHVzZXJfZGF0
YSAtIHVzZXJfZGF0YSBpbiB1bml0IHBhcmFtZXRlcnMgc3RydWN0dXJlCisgKi8KK3ZvaWQgY2Rf
dXNiX2J1bGtfbXNkX2x1bl9jaGFuZ2VkKHZvaWQgKnVzZXJfZGF0YSwgdWludDMyX3QgbHVuKTsK
KworLyogY2FsbGVkIG9uIGNvbXBsZXRlZCBkZXZpY2UgcmVzZXQKKyAqIHVzZXJfZGF0YSAtIHVz
ZXJfZGF0YSBpbiB1bml0IHBhcmFtZXRlcnMgc3RydWN0dXJlCisgKiBzdGF0dXMgLSBlcnJvciBj
b2RlCisgKi8KK3ZvaWQgY2RfdXNiX2J1bGtfbXNkX3Jlc2V0X2NvbXBsZXRlKHZvaWQgKnVzZXJf
ZGF0YSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBzdGF0dXMpOwor
CisvKiBNU0QgYmFja2VuZCBhcGkgKi8KKworLyogYWxsb2NhdGUgbmV3IGRldmljZSBkZXNjcmlw
dG9yICovCitVc2JDZEJ1bGtNc2REZXZpY2UgKmNkX3VzYl9idWxrX21zZF9hbGxvYyh2b2lkICp1
c2VyX2RhdGEsIHVpbnQzMl90IG1heF9sdW4pOworCisvKiBmcmVlIGRldmljZSBkZXNjcmlwdG9y
ICovCit2b2lkIGNkX3VzYl9idWxrX21zZF9mcmVlKFVzYkNkQnVsa01zZERldmljZSAqZGV2aWNl
KTsKKworLyogY29uZmlndXJlIGEgbmV3IExvZ2ljYWwgVW5pdCB0byBiZSByZXByZXNlbiB0ZWQg
YnkgdGhlIGRldmljZQorICogIHJldHVybnM6IGVycm9yIGNvZGUKKyAqLworaW50IGNkX3VzYl9i
dWxrX21zZF9yZWFsaXplKFVzYkNkQnVsa01zZERldmljZSAqZGV2aWNlLCB1aW50MzJfdCBsdW4s
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgQ2RTY3NpRGV2aWNlUGFyYW1ldGVy
cyAqZGV2X3BhcmFtcyk7CisKKy8qIGxvY2sgdGhlIGRldmljZSwgcHJldmVudCB1bmxvYWRpbmcK
KyAqIHJldHVybnM6IGVycm9yIGNvZGUKKyAqLworaW50IGNkX3VzYl9idWxrX21zZF9sb2NrKFVz
YkNkQnVsa01zZERldmljZSAqZGV2aWNlLCB1aW50MzJfdCBsdW4sIGdib29sZWFuIGxvY2spOwor
CisvKiBsb2FkIG5ldyBtZWRpYSwgaWYgYWxyZWFkeSBsb2FkZWQsIHNpbXVsYXRlIG1lZGlhIGNo
YW5nZQorICogcmV0dXJuczogZXJyb3IgY29kZQorICovCitpbnQgY2RfdXNiX2J1bGtfbXNkX2xv
YWQoVXNiQ2RCdWxrTXNkRGV2aWNlICpkZXZpY2UsIHVpbnQzMl90IGx1biwKKyAgICAgICAgICAg
ICAgICAgICAgICAgICBjb25zdCBDZFNjc2lNZWRpYVBhcmFtZXRlcnMgKm1lZGlhX3BhcmFtcyk7
CisKKy8qIHF1ZXJ5IHVuaXQgcGFyYW1ldGVycyBhbmQgc3RhdHVzCisgKiByZXR1cm5zOiBlcnJv
ciBjb2RlCisgKi8KK2ludCBjZF91c2JfYnVsa19tc2RfZ2V0X2luZm8oVXNiQ2RCdWxrTXNkRGV2
aWNlICpkZXZpY2UsIHVpbnQzMl90IGx1biwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
Q2RTY3NpRGV2aWNlSW5mbyAqbHVuX2luZm8pOworCisvKiB1bmxvYWQgdGhlIG1lZGlhCisgKiBy
ZXR1cm5zOiBlcnJvciBjb2RlCisgKi8KK2ludCBjZF91c2JfYnVsa19tc2RfdW5sb2FkKFVzYkNk
QnVsa01zZERldmljZSAqZGV2aWNlLCB1aW50MzJfdCBsdW4pOworCisvKiBkZXRhY2ggYSBMb2dp
Y2FsIFVuaXQKKyAqIHJldHVybnM6IGVycm9yIGNvZGUKKyAqLworaW50IGNkX3VzYl9idWxrX21z
ZF91bnJlYWxpemUoVXNiQ2RCdWxrTXNkRGV2aWNlICpkZXZpY2UsIHVpbnQzMl90IGx1bik7CisK
Ky8qIHJlc2V0IHRoZSBkZXZpY2UgaW5zdGFuY2U7IGNhbmNlbCBhbGwgSU8gb3BzLCByZXNldCBz
dGF0ZQorICogcmV0dXJuczogZXJyb3IgY29kZQorICovCitpbnQgY2RfdXNiX2J1bGtfbXNkX3Jl
c2V0KFVzYkNkQnVsa01zZERldmljZSAqZGV2aWNlKTsKKworCisvKiBwZXJmb3JtIGEgd3JpdGUg
ZGF0YSBidWxrIHRyYW5zZmVyCisgKiBkYXRhX2xlbiAtIGxlbmd0aCBvZiBhdmFpbGFibGUgZGF0
YSB0byB3cml0ZQorICogcmV0dXJuczogZXJyb3IgY29kZQorICovCitpbnQgY2RfdXNiX2J1bGtf
bXNkX3dyaXRlKFVzYkNkQnVsa01zZERldmljZSpkZXZpY2UsIHVpbnQ4X3QgKmJ1ZiwgdWludDMy
X3QgZGF0YV9sZW4pOworCisKKy8qIHBlcmZvcm0gYSByZWFkIGRhdGEgYnVsayB0cmFuc2Zlcgor
ICogbWF4X2xlbiAtIGxlbmd0aCBvZiBhdmFpbGFibGUgYnVmZmVyIHRvIGZpbGwKKyAqIElmIGRh
dGEgYXZhaWxhYmxlIGltbWVkaWF0ZWx5LCBzaG91bGQgY2FsbCBjZF91c2JfYnVsa19tc2RfcmVh
ZF9jb21wbGV0ZSgpCisgKiAgIGFuZCByZXR1cm4gc3VjY2VzcworICogSWYgZmF0YWwgZXJyb3Ig
ZGV0ZWN0ZWQgaW1tZWRpYXRlbHksIHNob3VsZCBjYWxsIGNkX3VzYl9idWxrX21zZF9yZWFkX2Nv
bXBsZXRlKCkKKyAqICAgd2l0aCBlcnJvciBjb2RlIGFuZCByZXR1cm4gc3VjY2VzcworICoKKyAq
IHJldHVybnM6IDAgLSBzdWNjZXNzLCAtMSAtIGVycm9yCisgKi8KK2ludCBjZF91c2JfYnVsa19t
c2RfcmVhZChVc2JDZEJ1bGtNc2REZXZpY2UgKmRldmljZSwgdWludDMyX3QgbWF4X2xlbik7CisK
Ky8qIGNhbmNlbHMgcGVuZGluZyByZWFkIGRhdGEgYnVsayB0cmFuc2ZlcgorICogcmV0dXJuczog
ZXJyb3IgY29kZQorICovCitpbnQgY2RfdXNiX2J1bGtfbXNkX2NhbmNlbF9yZWFkKFVzYkNkQnVs
a01zZERldmljZSAqZGV2aWNlKTsKKworR19FTkRfREVDTFMKKworI2VuZGlmIC8qIFNQSUNFX0dU
S19DRF9VU0JfQlVMS19NU0RfSF9fICovCmRpZmYgLS1naXQgYS9zcmMvc2NzaS1jb25zdGFudHMu
aCBiL3NyYy9zY3NpLWNvbnN0YW50cy5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAw
MDAuLmNmOGE4ODIKLS0tIC9kZXYvbnVsbAorKysgYi9zcmMvc2NzaS1jb25zdGFudHMuaApAQCAt
MCwwICsxLDMyNCBAQAorLyogLSotIE1vZGU6IEM7IGMtYmFzaWMtb2Zmc2V0OiA0OyBpbmRlbnQt
dGFicy1tb2RlOiBuaWwgLSotICovCisvKgorICAgQ29weXJpZ2h0IChDKSAyMDE4IFJlZCBIYXQs
IEluYy4KKyAgIEJhc2VkIG9uIHRoZSBHTGliIGhlYWRlcgorCisgICBUaGlzIGxpYnJhcnkgaXMg
ZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yCisgICBtb2RpZnkg
aXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCisgICBM
aWNlbnNlIGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRo
ZXIKKyAgIHZlcnNpb24gMi4xIG9mIHRoZSBMaWNlbnNlLCBvciAoYXQgeW91ciBvcHRpb24pIGFu
eSBsYXRlciB2ZXJzaW9uLgorCisgICBUaGlzIGxpYnJhcnkgaXMgZGlzdHJpYnV0ZWQgaW4gdGhl
IGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKKyAgIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5U
WTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCisgICBNRVJDSEFOVEFCSUxJ
VFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlIEdOVQorICAg
TGVzc2VyIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KKworICAgWW91
IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1
YmxpYworICAgTGljZW5zZSBhbG9uZyB3aXRoIHRoaXMgbGlicmFyeTsgaWYgbm90LCBzZWUgPGh0
dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+LgorKi8KKworI2lmbmRlZiBTUElDRV9HVEtfU0NT
SV9DT05TVEFOVFNfSF9fCisjZGVmaW5lIFNQSUNFX0dUS19TQ1NJX0NPTlNUQU5UU19IX18KKwor
LyoKKyAqICAgICAgU0NTSSBvcGNvZGVzCisgKi8KKworI2RlZmluZSBURVNUX1VOSVRfUkVBRFkg
ICAgICAgMHgwMAorI2RlZmluZSBSRVdJTkQgICAgICAgICAgICAgICAgMHgwMQorI2RlZmluZSBS
RVFVRVNUX1NFTlNFICAgICAgICAgMHgwMworI2RlZmluZSBGT1JNQVRfVU5JVCAgICAgICAgICAg
MHgwNAorI2RlZmluZSBSRUFEX0JMT0NLX0xJTUlUUyAgICAgMHgwNQorI2RlZmluZSBJTklUSUFM
SVpFX0VMRU1FTlRfU1RBVFVTIDB4MDcKKyNkZWZpbmUgUkVBU1NJR05fQkxPQ0tTXyAgICAgIDB4
MDcKKyNkZWZpbmUgUkVBRF82ICAgICAgICAgICAgICAgIDB4MDgKKyNkZWZpbmUgV1JJVEVfNiAg
ICAgICAgICAgICAgIDB4MGEKKyNkZWZpbmUgU0VUX0NBUEFDSVRZICAgICAgICAgIDB4MGIKKyNk
ZWZpbmUgUkVBRF9SRVZFUlNFICAgICAgICAgIDB4MGYKKyNkZWZpbmUgV1JJVEVfRklMRU1BUktT
ICAgICAgIDB4MTAKKyNkZWZpbmUgU1BBQ0UgICAgICAgICAgICAgICAgIDB4MTEKKyNkZWZpbmUg
SU5RVUlSWSAgICAgICAgICAgICAgIDB4MTIKKyNkZWZpbmUgUkVDT1ZFUl9CVUZGRVJFRF9EQVRB
IDB4MTQKKyNkZWZpbmUgTU9ERV9TRUxFQ1QgICAgICAgICAgIDB4MTUKKyNkZWZpbmUgUkVTRVJW
RSAgICAgICAgICAgICAgIDB4MTYKKyNkZWZpbmUgUkVMRUFTRSAgICAgICAgICAgICAgIDB4MTcK
KyNkZWZpbmUgQ09QWSAgICAgICAgICAgICAgICAgIDB4MTgKKyNkZWZpbmUgRVJBU0UgICAgICAg
ICAgICAgICAgIDB4MTkKKyNkZWZpbmUgTU9ERV9TRU5TRSAgICAgICAgICAgIDB4MWEKKyNkZWZp
bmUgTE9BRF9VTkxPQUQgICAgICAgICAgIDB4MWIKKyNkZWZpbmUgU0NBTiAgICAgICAgICAgICAg
ICAgIDB4MWIKKyNkZWZpbmUgU1RBUlRfU1RPUCAgICAgICAgICAgIDB4MWIKKyNkZWZpbmUgUkVD
RUlWRV9ESUFHTk9TVElDICAgIDB4MWMKKyNkZWZpbmUgU0VORF9ESUFHTk9TVElDICAgICAgIDB4
MWQKKyNkZWZpbmUgQUxMT1dfTUVESVVNX1JFTU9WQUwgIDB4MWUKKyNkZWZpbmUgU0VUX1dJTkRP
VyAgICAgICAgICAgIDB4MjQKKyNkZWZpbmUgUkVBRF9DQVBBQ0lUWV8xMCAgICAgIDB4MjUKKyNk
ZWZpbmUgR0VUX1dJTkRPVyAgICAgICAgICAgIDB4MjUKKyNkZWZpbmUgUkVBRF8xMCAgICAgICAg
ICAgICAgIDB4MjgKKyNkZWZpbmUgV1JJVEVfMTAgICAgICAgICAgICAgIDB4MmEKKyNkZWZpbmUg
U0VORCAgICAgICAgICAgICAgICAgIDB4MmEKKyNkZWZpbmUgU0VFS18xMCAgICAgICAgICAgICAg
IDB4MmIKKyNkZWZpbmUgTE9DQVRFXzEwICAgICAgICAgICAgIDB4MmIKKyNkZWZpbmUgUE9TSVRJ
T05fVE9fRUxFTUVOVCAgIDB4MmIKKyNkZWZpbmUgV1JJVEVfVkVSSUZZXzEwICAgICAgIDB4MmUK
KyNkZWZpbmUgVkVSSUZZXzEwICAgICAgICAgICAgIDB4MmYKKyNkZWZpbmUgU0VBUkNIX0hJR0gg
ICAgICAgICAgIDB4MzAKKyNkZWZpbmUgU0VBUkNIX0VRVUFMICAgICAgICAgIDB4MzEKKyNkZWZp
bmUgT0JKRUNUX1BPU0lUSU9OICAgICAgIDB4MzEKKyNkZWZpbmUgU0VBUkNIX0xPVyAgICAgICAg
ICAgIDB4MzIKKyNkZWZpbmUgU0VUX0xJTUlUUyAgICAgICAgICAgIDB4MzMKKyNkZWZpbmUgUFJF
X0ZFVENIICAgICAgICAgICAgIDB4MzQKKyNkZWZpbmUgUkVBRF9QT1NJVElPTiAgICAgICAgIDB4
MzQKKyNkZWZpbmUgR0VUX0RBVEFfQlVGRkVSX1NUQVRVUyAweDM0CisjZGVmaW5lIFNZTkNIUk9O
SVpFX0NBQ0hFICAgICAweDM1CisjZGVmaW5lIExPQ0tfVU5MT0NLX0NBQ0hFICAgICAweDM2Cisj
ZGVmaW5lIElOSVRJQUxJWkVfRUxFTUVOVF9TVEFUVVNfV0lUSF9SQU5HRSAweDM3CisjZGVmaW5l
IFJFQURfREVGRUNUX0RBVEEgICAgICAweDM3CisjZGVmaW5lIE1FRElVTV9TQ0FOICAgICAgICAg
ICAweDM4CisjZGVmaW5lIENPTVBBUkUgICAgICAgICAgICAgICAweDM5CisjZGVmaW5lIENPUFlf
VkVSSUZZICAgICAgICAgICAweDNhCisjZGVmaW5lIFdSSVRFX0JVRkZFUiAgICAgICAgICAweDNi
CisjZGVmaW5lIFJFQURfQlVGRkVSICAgICAgICAgICAweDNjCisjZGVmaW5lIFVQREFURV9CTE9D
SyAgICAgICAgICAweDNkCisjZGVmaW5lIFJFQURfTE9OR18xMCAgICAgICAgICAweDNlCisjZGVm
aW5lIFdSSVRFX0xPTkdfMTAgICAgICAgICAweDNmCisjZGVmaW5lIENIQU5HRV9ERUZJTklUSU9O
ICAgICAweDQwCisjZGVmaW5lIFdSSVRFX1NBTUVfMTAgICAgICAgICAweDQxCisjZGVmaW5lIFVO
TUFQICAgICAgICAgICAgICAgICAweDQyCisjZGVmaW5lIFJFQURfVE9DICAgICAgICAgICAgICAw
eDQzCisjZGVmaW5lIFJFUE9SVF9ERU5TSVRZX1NVUFBPUlQgMHg0NAorI2RlZmluZSBHRVRfQ09O
RklHVVJBVElPTiAgICAgMHg0NgorI2RlZmluZSBTQU5JVElaRSAgICAgICAgICAgICAgMHg0OAor
I2RlZmluZSBHRVRfRVZFTlRfU1RBVFVTX05PVElGSUNBVElPTiAweDRhCisjZGVmaW5lIExPR19T
RUxFQ1QgICAgICAgICAgICAweDRjCisjZGVmaW5lIExPR19TRU5TRSAgICAgICAgICAgICAweDRk
CisjZGVmaW5lIFJFQURfRElTQ19JTkZPUk1BVElPTiAweDUxCisjZGVmaW5lIFJFQURfVFJBQ0tf
SU5GT1JNQVRJT04gMHg1MgorI2RlZmluZSBSRVNFUlZFX1RSQUNLICAgICAgICAgMHg1MworI2Rl
ZmluZSBNT0RFX1NFTEVDVF8xMCAgICAgICAgMHg1NQorI2RlZmluZSBSRVNFUlZFXzEwICAgICAg
ICAgICAgMHg1NgorI2RlZmluZSBSRUxFQVNFXzEwICAgICAgICAgICAgMHg1NworI2RlZmluZSBN
T0RFX1NFTlNFXzEwICAgICAgICAgMHg1YQorI2RlZmluZSBTRU5EX0NVRV9TSEVFVCAgICAgICAg
MHg1ZAorI2RlZmluZSBQRVJTSVNURU5UX1JFU0VSVkVfSU4gMHg1ZQorI2RlZmluZSBQRVJTSVNU
RU5UX1JFU0VSVkVfT1VUIDB4NWYKKyNkZWZpbmUgVkFSTEVOR1RIX0NEQiAgICAgICAgIDB4N2YK
KyNkZWZpbmUgV1JJVEVfRklMRU1BUktTXzE2ICAgIDB4ODAKKyNkZWZpbmUgUkVBRF9SRVZFUlNF
XzE2ICAgICAgIDB4ODEKKyNkZWZpbmUgQUxMT1dfT1ZFUldSSVRFICAgICAgIDB4ODIKKyNkZWZp
bmUgRVhURU5ERURfQ09QWSAgICAgICAgIDB4ODMKKyNkZWZpbmUgQVRBX1BBU1NUSFJPVUdIXzE2
ICAgIDB4ODUKKyNkZWZpbmUgQUNDRVNTX0NPTlRST0xfSU4gICAgIDB4ODYKKyNkZWZpbmUgQUND
RVNTX0NPTlRST0xfT1VUICAgIDB4ODcKKyNkZWZpbmUgUkVBRF8xNiAgICAgICAgICAgICAgIDB4
ODgKKyNkZWZpbmUgQ09NUEFSRV9BTkRfV1JJVEUgICAgIDB4ODkKKyNkZWZpbmUgV1JJVEVfMTYg
ICAgICAgICAgICAgIDB4OGEKKyNkZWZpbmUgV1JJVEVfVkVSSUZZXzE2ICAgICAgIDB4OGUKKyNk
ZWZpbmUgVkVSSUZZXzE2ICAgICAgICAgICAgIDB4OGYKKyNkZWZpbmUgUFJFX0ZFVENIXzE2ICAg
ICAgICAgIDB4OTAKKyNkZWZpbmUgU1BBQ0VfMTYgICAgICAgICAgICAgIDB4OTEKKyNkZWZpbmUg
U1lOQ0hST05JWkVfQ0FDSEVfMTYgIDB4OTEKKyNkZWZpbmUgTE9DQVRFXzE2ICAgICAgICAgICAg
IDB4OTIKKyNkZWZpbmUgV1JJVEVfU0FNRV8xNiAgICAgICAgIDB4OTMKKyNkZWZpbmUgRVJBU0Vf
MTYgICAgICAgICAgICAgIDB4OTMKKyNkZWZpbmUgU0VSVklDRV9BQ1RJT05fSU5fMTYgIDB4OWUK
KyNkZWZpbmUgV1JJVEVfTE9OR18xNiAgICAgICAgIDB4OWYKKyNkZWZpbmUgUkVQT1JUX0xVTlMg
ICAgICAgICAgIDB4YTAKKyNkZWZpbmUgQVRBX1BBU1NUSFJPVUdIXzEyICAgIDB4YTEKKyNkZWZp
bmUgTUFJTlRFTkFOQ0VfSU4gICAgICAgIDB4YTMKKyNkZWZpbmUgTUFJTlRFTkFOQ0VfT1VUICAg
ICAgIDB4YTQKKyNkZWZpbmUgTU9WRV9NRURJVU0gICAgICAgICAgIDB4YTUKKyNkZWZpbmUgRVhD
SEFOR0VfTUVESVVNICAgICAgIDB4YTYKKyNkZWZpbmUgU0VUX1JFQURfQUhFQUQgICAgICAgIDB4
YTcKKyNkZWZpbmUgUkVBRF8xMiAgICAgICAgICAgICAgIDB4YTgKKyNkZWZpbmUgV1JJVEVfMTIg
ICAgICAgICAgICAgIDB4YWEKKyNkZWZpbmUgU0VSVklDRV9BQ1RJT05fSU5fMTIgIDB4YWIKKyNk
ZWZpbmUgRVJBU0VfMTIgICAgICAgICAgICAgIDB4YWMKKyNkZWZpbmUgV1JJVEVfVkVSSUZZXzEy
ICAgICAgIDB4YWUKKyNkZWZpbmUgVkVSSUZZXzEyICAgICAgICAgICAgIDB4YWYKKyNkZWZpbmUg
U0VBUkNIX0hJR0hfMTIgICAgICAgIDB4YjAKKyNkZWZpbmUgU0VBUkNIX0VRVUFMXzEyICAgICAg
IDB4YjEKKyNkZWZpbmUgU0VBUkNIX0xPV18xMiAgICAgICAgIDB4YjIKKyNkZWZpbmUgUkVBRF9F
TEVNRU5UX1NUQVRVUyAgIDB4YjgKKyNkZWZpbmUgU0VORF9WT0xVTUVfVEFHICAgICAgIDB4YjYK
KworLyogTU1DLXNwZWNpZmljIG9wY29kZSBhc3NpZ25tZW50ICovCisjZGVmaW5lIE1NQ19TRU5E
X0VWRU5UICAgICAgICAgIDB4YTIKKyNkZWZpbmUgTU1DX1NFTkRfS0VZICAgICAgICAgICAgMHhh
MworI2RlZmluZSBNTUNfUkVQT1JUX0tFWSAgICAgICAgICAweGE0CisjZGVmaW5lIE1NQ19HRVRf
UEVSRk9STUFOQ0UgICAgIDB4YWMKKyNkZWZpbmUgTU1DX1JFQURfRFZEX1NUUlVDVFVSRSAgMHhh
ZAorI2RlZmluZSBNTUNfUkVBRF9ERUZFQ1RfREFUQV8xMiAweGI3CisjZGVmaW5lIE1NQ19TRVRf
Q0RfU1BFRUQgICAgICAgIDB4YmIKKyNkZWZpbmUgTU1DX01FQ0hBTklTTV9TVEFUVVMgICAgMHhi
ZAorI2RlZmluZSBNTUNfUkVBRF9DRCAgICAgICAgICAgICAweGJlCisjZGVmaW5lIE1NQ19TRU5E
X0RWRF9TVFJVQ1RVUkUgIDB4YmYKKworLyoKKyAqIFNFUlZJQ0UgQUNUSU9OIElOIHN1YmNvZGVz
CisgKi8KKyNkZWZpbmUgU0FJX1JFQURfQ0FQQUNJVFlfMTYgIDB4MTAKKworLyoKKyAqIFJFQUQg
UE9TSVRJT04gc2VydmljZSBhY3Rpb24gY29kZXMKKyAqLworI2RlZmluZSBTSE9SVF9GT1JNX0JM
T0NLX0lEICAweDAwCisjZGVmaW5lIFNIT1JUX0ZPUk1fVkVORE9SX1NQRUNJRklDIDB4MDEKKyNk
ZWZpbmUgTE9OR19GT1JNICAgICAgICAgICAgMHgwNgorI2RlZmluZSBFWFRFTkRFRF9GT1JNICAg
ICAgICAweDA4CisKKy8qCisgKiAgU0FNIFN0YXR1cyBjb2RlcworICovCisKKyNkZWZpbmUgR09P
RCAgICAgICAgICAgICAgICAgMHgwMAorI2RlZmluZSBDSEVDS19DT05ESVRJT04gICAgICAweDAy
CisjZGVmaW5lIENPTkRJVElPTl9HT09EICAgICAgIDB4MDQKKyNkZWZpbmUgQlVTWSAgICAgICAg
ICAgICAgICAgMHgwOAorI2RlZmluZSBJTlRFUk1FRElBVEVfR09PRCAgICAweDEwCisjZGVmaW5l
IElOVEVSTUVESUFURV9DX0dPT0QgIDB4MTQKKyNkZWZpbmUgUkVTRVJWQVRJT05fQ09ORkxJQ1Qg
MHgxOAorI2RlZmluZSBDT01NQU5EX1RFUk1JTkFURUQgICAweDIyCisjZGVmaW5lIFRBU0tfU0VU
X0ZVTEwgICAgICAgIDB4MjgKKyNkZWZpbmUgQUNBX0FDVElWRSAgICAgICAgICAgMHgzMAorI2Rl
ZmluZSBUQVNLX0FCT1JURUQgICAgICAgICAweDQwCisKKyNkZWZpbmUgU1RBVFVTX01BU0sgICAg
ICAgICAgMHgzZQorCisvKgorICogIFNFTlNFIEtFWVMKKyAqLworCisjZGVmaW5lIE5PX1NFTlNF
ICAgICAgICAgICAgMHgwMAorI2RlZmluZSBSRUNPVkVSRURfRVJST1IgICAgIDB4MDEKKyNkZWZp
bmUgTk9UX1JFQURZICAgICAgICAgICAweDAyCisjZGVmaW5lIE1FRElVTV9FUlJPUiAgICAgICAg
MHgwMworI2RlZmluZSBIQVJEV0FSRV9FUlJPUiAgICAgIDB4MDQKKyNkZWZpbmUgSUxMRUdBTF9S
RVFVRVNUICAgICAweDA1CisjZGVmaW5lIFVOSVRfQVRURU5USU9OICAgICAgMHgwNgorI2RlZmlu
ZSBEQVRBX1BST1RFQ1QgICAgICAgIDB4MDcKKyNkZWZpbmUgQkxBTktfQ0hFQ0sgICAgICAgICAw
eDA4CisjZGVmaW5lIENPUFlfQUJPUlRFRCAgICAgICAgMHgwYQorI2RlZmluZSBBQk9SVEVEX0NP
TU1BTkQgICAgIDB4MGIKKyNkZWZpbmUgVk9MVU1FX09WRVJGTE9XICAgICAweDBkCisjZGVmaW5l
IE1JU0NPTVBBUkUgICAgICAgICAgMHgwZQorCisKKy8qCisgKiAgREVWSUNFIFRZUEVTCisgKi8K
KworI2RlZmluZSBUWVBFX0RJU0sgICAgICAgICAgIDB4MDAKKyNkZWZpbmUgVFlQRV9UQVBFICAg
ICAgICAgICAweDAxCisjZGVmaW5lIFRZUEVfUFJJTlRFUiAgICAgICAgMHgwMgorI2RlZmluZSBU
WVBFX1BST0NFU1NPUiAgICAgIDB4MDMgICAgLyogSFAgc2Nhbm5lcnMgdXNlIHRoaXMgKi8KKyNk
ZWZpbmUgVFlQRV9XT1JNICAgICAgICAgICAweDA0ICAgIC8qIFRyZWF0ZWQgYXMgUk9NIGJ5IG91
ciBzeXN0ZW0gKi8KKyNkZWZpbmUgVFlQRV9ST00gICAgICAgICAgICAweDA1CisjZGVmaW5lIFRZ
UEVfU0NBTk5FUiAgICAgICAgMHgwNgorI2RlZmluZSBUWVBFX01PRCAgICAgICAgICAgIDB4MDcg
ICAgLyogTWFnbmV0by1vcHRpY2FsIGRpc2sgLQorCQkJCSAgICAgKiAtIHRyZWF0ZWQgYXMgVFlQ
RV9ESVNLICovCisjZGVmaW5lIFRZUEVfTUVESVVNX0NIQU5HRVIgMHgwOAorI2RlZmluZSBUWVBF
X1NUT1JBR0VfQVJSQVkgIDB4MGMgICAgLyogU3RvcmFnZSBhcnJheSBkZXZpY2UgKi8KKyNkZWZp
bmUgVFlQRV9FTkNMT1NVUkUgICAgICAweDBkICAgIC8qIEVuY2xvc3VyZSBTZXJ2aWNlcyBEZXZp
Y2UgKi8KKyNkZWZpbmUgVFlQRV9SQkMgICAgICAgICAgICAweDBlICAgIC8qIFNpbXBsaWZpZWQg
RGlyZWN0LUFjY2VzcyBEZXZpY2UgKi8KKyNkZWZpbmUgVFlQRV9PU0QgICAgICAgICAgICAweDEx
ICAgIC8qIE9iamVjdC1zdG9yYWdlIERldmljZSAqLworI2RlZmluZSBUWVBFX1dMVU4gICAgICAg
ICAgIDB4MWUgICAgLyogV2VsbCBrbm93biBMVU4gKi8KKyNkZWZpbmUgVFlQRV9OT1RfUFJFU0VO
VCAgICAweDFmCisjZGVmaW5lIFRZUEVfSU5BQ1RJVkUgICAgICAgMHgyMAorI2RlZmluZSBUWVBF
X05PX0xVTiAgICAgICAgIDB4N2YKKworLyogTW9kZSBwYWdlIGNvZGVzIGZvciBtb2RlIHNlbnNl
L3NldCAqLworI2RlZmluZSBNT0RFX1BBR0VfUl9XX0VSUk9SICAgICAgICAgICAgICAgICAgIDB4
MDEKKyNkZWZpbmUgTU9ERV9QQUdFX01SVyAgICAgICAgICAgICAgICAgICAgICAgICAweDAzCisj
ZGVmaW5lIE1PREVfUEFHRV9IRF9HRU9NRVRSWSAgICAgICAgICAgICAgICAgMHgwNAorI2RlZmlu
ZSBNT0RFX1BBR0VfRkxFWElCTEVfRElTS19HRU9NRVRSWSAgICAgIDB4MDUgLyogU0JDICovCisj
ZGVmaW5lIE1PREVfUEFHRV9XUklURV9QQVJBTUVURVIgICAgICAgICAgICAgMHgwNSAvKiBNTUMg
Ki8KKyNkZWZpbmUgTU9ERV9QQUdFX0NBQ0hJTkcgICAgICAgICAgICAgICAgICAgICAweDA4Cisj
ZGVmaW5lIE1PREVfUEFHRV9DRF9ERVZJQ0UgICAgICAgICAgICAgICAgICAgMHgwZAorI2RlZmlu
ZSBNT0RFX1BBR0VfQVVESU9fQ1RMICAgICAgICAgICAgICAgICAgIDB4MGUKKyNkZWZpbmUgTU9E
RV9QQUdFX1BPV0VSICAgICAgICAgICAgICAgICAgICAgICAweDFhCisjZGVmaW5lIE1PREVfUEFH
RV9GQVVMVF9GQUlMICAgICAgICAgICAgICAgICAgMHgxYworI2RlZmluZSBNT0RFX1BBR0VfVE9f
UFJPVEVDVCAgICAgICAgICAgICAgICAgIDB4MWQKKyNkZWZpbmUgTU9ERV9QQUdFX0NBUFNfTUVD
SF9TVEFUVVMgICAgICAgICAgICAweDJhCisjZGVmaW5lIE1PREVfUEFHRV9NUldfVkVORE9SICAg
ICAgICAgICAgICAgICAgMHgyQworI2RlZmluZSBNT0RFX1BBR0VfQUxMUyAgICAgICAgICAgICAg
ICAgICAgICAgIDB4M2YKKy8qIE5vdCBpbiBNdC4gRnVqaSwgYnV0IGluIEFUQVBJIDIuNiAtLSBk
ZXByZWNhdGVkIG5vdyBpbiBmYXZvcgorICogb2YgTU9ERV9QQUdFX1NFTlNFX1BPV0VSICovCisj
ZGVmaW5lIE1PREVfUEFHRV9DRFJPTSAgICAgICAgICAgICAgICAgICAgICAgMHgwZAorCisjZGVm
aW5lIE1PREVfUEFHRV9DRFJPTSAgICAgICAgICAgICAgICAgICAgICAgMHgwZAorCisvKiBFdmVu
dCBub3RpZmljYXRpb24gY2xhc3NlcyBmb3IgR0VUIEVWRU5UIFNUQVRVUyBOT1RJRklDQVRJT04g
Ki8KKyNkZWZpbmUgR0VTTl9OT19FVkVOVFMgICAgICAgICAgICAgICAgMAorI2RlZmluZSBHRVNO
X09QRVJBVElPTkFMX0NIQU5HRSAgICAgICAxCisjZGVmaW5lIEdFU05fUE9XRVJfTUFOQUdFTUVO
VCAgICAgICAgIDIKKyNkZWZpbmUgR0VTTl9FWFRFUk5BTF9SRVFVRVNUICAgICAgICAgMworI2Rl
ZmluZSBHRVNOX01FRElBICAgICAgICAgICAgICAgICAgICA0CisjZGVmaW5lIEdFU05fTVVMVElQ
TEVfSE9TVFMgICAgICAgICAgIDUKKyNkZWZpbmUgR0VTTl9ERVZJQ0VfQlVTWSAgICAgICAgICAg
ICAgNgorCisvKiBFdmVudCBjb2RlcyBmb3IgTUVESUEgZXZlbnQgc3RhdHVzIG5vdGlmaWNhdGlv
biAqLworI2RlZmluZSBNRUNfTk9fQ0hBTkdFICAgICAgICAgICAgICAgICAwCisjZGVmaW5lIE1F
Q19FSkVDVF9SRVFVRVNURUQgICAgICAgICAgIDEKKyNkZWZpbmUgTUVDX05FV19NRURJQSAgICAg
ICAgICAgICAgICAgMgorI2RlZmluZSBNRUNfTUVESUFfUkVNT1ZBTCAgICAgICAgICAgICAzIC8q
IG9ubHkgZm9yIG1lZGlhIGNoYW5nZXJzICovCisjZGVmaW5lIE1FQ19NRURJQV9DSEFOR0VEICAg
ICAgICAgICAgIDQgLyogb25seSBmb3IgbWVkaWEgY2hhbmdlcnMgKi8KKyNkZWZpbmUgTUVDX0JH
X0ZPUk1BVF9DT01QTEVURUQgICAgICAgNSAvKiBNUlcgb3IgRFZEK1JXIGIvZyBmb3JtYXQgY29t
cGxldGVkICovCisjZGVmaW5lIE1FQ19CR19GT1JNQVRfUkVTVEFSVEVEICAgICAgIDYgLyogTVJX
IG9yIERWRCtSVyBiL2cgZm9ybWF0IHJlc3RhcnRlZCAqLworCisjZGVmaW5lIE1TX1RSQVlfT1BF
TiAgICAgICAgICAgICAgICAgIDEKKyNkZWZpbmUgTVNfTUVESUFfUFJFU0VOVCAgICAgICAgICAg
ICAgMgorCisvKgorICogQmFzZWQgb24gdmFsdWVzIGZyb20gPGxpbnV4L2Nkcm9tLmg+IGJ1dCBl
eHRlbmRpbmcgQ0RfTUlOUworICogdG8gdGhlIG1heGltdW0gY29tbW9uIHNpemUgYWxsb3dlZCBi
eSB0aGUgT3JhbmdlJ3MgQm9vayBBVElQCisgKgorICogOTAgYW5kIDk5IG1pbiBDRHMgYXJlIGFs
c28gYXZhaWxhYmxlIGJ1dCB1c2luZyB0aGVtIGFzIHRoZQorICogdXBwZXIgbGltaXQgcmVkdWNl
cyB0aGUgZWZmZWN0aXZlbmVzcyBvZiB0aGUgaGV1cmlzdGljIHRvCisgKiBkZXRlY3QgRFZEcyBi
dXJuZWQgdG8gbGVzcyB0aGFuIDI1JSBvZiB0aGVpciBtYXhpbXVtIGNhcGFjaXR5CisgKi8KKwor
LyogU29tZSBnZW5lcmFsbHkgdXNlZnVsIENELVJPTSBpbmZvcm1hdGlvbiAqLworI2RlZmluZSBD
RF9NSU5TICAgICAgICAgICAgICAgICAgICAgICA4MCAvKiBtYXguIG1pbnV0ZXMgcGVyIENEICov
CisjZGVmaW5lIENEX1NFQ1MgICAgICAgICAgICAgICAgICAgICAgIDYwIC8qIHNlY29uZHMgcGVy
IG1pbnV0ZSAqLworI2RlZmluZSBDRF9GUkFNRVMgICAgICAgICAgICAgICAgICAgICA3NSAvKiBm
cmFtZXMgcGVyIHNlY29uZCAqLworI2RlZmluZSBDRF9GUkFNRVNJWkUgICAgICAgICAgICAgICAg
MjA0OCAvKiBieXRlcyBwZXIgZnJhbWUsICJjb29rZWQiIG1vZGUgKi8KKyNkZWZpbmUgQ0RfTUFY
X0JZVEVTICAgICAgIChDRF9NSU5TICogQ0RfU0VDUyAqIENEX0ZSQU1FUyAqIENEX0ZSQU1FU0la
RSkKKyNkZWZpbmUgQ0RfTUFYX1NFQ1RPUlMgICAgIChDRF9NQVhfQllURVMgLyA1MTIpCisKKy8q
CisgKiBUaGUgTU1DIHZhbHVlcyBhcmUgbm90IElERSBzcGVjaWZpYyBhbmQgbWlnaHQgbmVlZCB0
byBiZSBtb3ZlZAorICogdG8gYSBjb21tb24gaGVhZGVyIGlmIHRoZXkgYXJlIGFsc28gbmVlZGVk
IGZvciB0aGUgU0NTSSBlbXVsYXRpb24KKyAqLworCisvKiBQcm9maWxlIGxpc3QgZnJvbSBNTUMt
NiByZXZpc2lvbiAxIHRhYmxlIDkxICovCisjZGVmaW5lIE1NQ19QUk9GSUxFX05PTkUgICAgICAg
ICAgICAgICAgMHgwMDAwCisjZGVmaW5lIE1NQ19QUk9GSUxFX0NEX1JPTSAgICAgICAgICAgICAg
MHgwMDA4CisjZGVmaW5lIE1NQ19QUk9GSUxFX0NEX1IgICAgICAgICAgICAgICAgMHgwMDA5Cisj
ZGVmaW5lIE1NQ19QUk9GSUxFX0NEX1JXICAgICAgICAgICAgICAgMHgwMDBBCisjZGVmaW5lIE1N
Q19QUk9GSUxFX0RWRF9ST00gICAgICAgICAgICAgMHgwMDEwCisjZGVmaW5lIE1NQ19QUk9GSUxF
X0RWRF9SX1NSICAgICAgICAgICAgMHgwMDExCisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9SQU0g
ICAgICAgICAgICAgMHgwMDEyCisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9SV19STyAgICAgICAg
ICAgMHgwMDEzCisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9SV19TUiAgICAgICAgICAgMHgwMDE0
CisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9SX0RMX1NSICAgICAgICAgMHgwMDE1CisjZGVmaW5l
IE1NQ19QUk9GSUxFX0RWRF9SX0RMX0pSICAgICAgICAgMHgwMDE2CisjZGVmaW5lIE1NQ19QUk9G
SUxFX0RWRF9SV19ETCAgICAgICAgICAgMHgwMDE3CisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9E
RFIgICAgICAgICAgICAgMHgwMDE4CisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9QTFVTX1JXICAg
ICAgICAgMHgwMDFBCisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9QTFVTX1IgICAgICAgICAgMHgw
MDFCCisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9QTFVTX1JXX0RMICAgICAgMHgwMDJBCisjZGVm
aW5lIE1NQ19QUk9GSUxFX0RWRF9QTFVTX1JfREwgICAgICAgMHgwMDJCCisjZGVmaW5lIE1NQ19Q
Uk9GSUxFX0JEX1JPTSAgICAgICAgICAgICAgMHgwMDQwCisjZGVmaW5lIE1NQ19QUk9GSUxFX0JE
X1JfU1JNICAgICAgICAgICAgMHgwMDQxCisjZGVmaW5lIE1NQ19QUk9GSUxFX0JEX1JfUlJNICAg
ICAgICAgICAgMHgwMDQyCisjZGVmaW5lIE1NQ19QUk9GSUxFX0JEX1JFICAgICAgICAgICAgICAg
MHgwMDQzCisjZGVmaW5lIE1NQ19QUk9GSUxFX0hERFZEX1JPTSAgICAgICAgICAgMHgwMDUwCisj
ZGVmaW5lIE1NQ19QUk9GSUxFX0hERFZEX1IgICAgICAgICAgICAgMHgwMDUxCisjZGVmaW5lIE1N
Q19QUk9GSUxFX0hERFZEX1JBTSAgICAgICAgICAgMHgwMDUyCisjZGVmaW5lIE1NQ19QUk9GSUxF
X0hERFZEX1JXICAgICAgICAgICAgMHgwMDUzCisjZGVmaW5lIE1NQ19QUk9GSUxFX0hERFZEX1Jf
REwgICAgICAgICAgMHgwMDU4CisjZGVmaW5lIE1NQ19QUk9GSUxFX0hERFZEX1JXX0RMICAgICAg
ICAgMHgwMDVBCisjZGVmaW5lIE1NQ19QUk9GSUxFX0lOVkFMSUQgICAgICAgICAgICAgMHhGRkZG
CisKKyNlbmRpZgotLSAKMi4xNy4xCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fXwpTcGljZS1kZXZlbCBtYWlsaW5nIGxpc3QKU3BpY2UtZGV2ZWxAbGlzdHMu
ZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlz
dGluZm8vc3BpY2UtZGV2ZWw=
