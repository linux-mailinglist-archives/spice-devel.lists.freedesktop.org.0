Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id D3F7DDC408
	for <lists+spice-devel@lfdr.de>; Fri, 18 Oct 2019 13:37:25 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 2295A6EB1D;
	Fri, 18 Oct 2019 11:37:24 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from us-smtp-1.mimecast.com (us-smtp-delivery-1.mimecast.com
 [207.211.31.120])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 51FE46EB1D
 for <spice-devel@lists.freedesktop.org>; Fri, 18 Oct 2019 11:37:22 +0000 (UTC)
Received: from mail-wm1-f71.google.com (mail-wm1-f71.google.com
 [209.85.128.71]) (Using TLS) by relay.mimecast.com with ESMTP id
 us-mta-323-etkh93nRPc6yZaHWvTUXEQ-1; Fri, 18 Oct 2019 07:37:18 -0400
Received: by mail-wm1-f71.google.com with SMTP id g67so2215910wmg.4
 for <spice-devel@lists.freedesktop.org>; Fri, 18 Oct 2019 04:37:18 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:subject:date:message-id:mime-version
 :content-transfer-encoding;
 bh=wMKueBhAtQP8XnojFiMLoIATo+gIx7n0mq8l5UEjlbQ=;
 b=NwsdHqwP7WWfaBQMsYysop+GQQApAV3sDjItlHoe3yOibHd9zhbgZ7YlvlLyYLERdB
 LtQ1sbbg4+zafYe3DpTBJRsQVaG6QJjJ2d9gK7hefOPsJk9T1xJ6rK9RsuD8AEo8HogH
 /YEvnmA7s+ccHYqyPG9xLFnWB9kBg51GlNxoHwyn44Sg1wdt9HjG/XdgGrbxJybuMQBk
 xfPpJIHeEvT+fN7t8r1Bu2E9KhzVtcTv1d1w3JCJtjYGtUvAN40hCFuP/FMxpqAo8XNJ
 muYtcXdeb7VBhXcgOYA8m7Cb5rK4ww99iK6e6LAAEkvwaGWB44Immyf2ELNuJPkZKQ0F
 F8eQ==
X-Gm-Message-State: APjAAAW8pSunCTarr4O/jGYG7jCMndu17wouYplwHVK4pIK3OCwGtSTH
 Vllx42n9SR3dAW1zl2Z04qUYiFrf/AQ2FiIYF58XfIcfZQuZHTtq3/vav6bf26CpHfZq8ez/ne/
 yUWJa39vq/OlbjmLyN78ylQaYClu3Xyc=
X-Received: by 2002:adf:9cca:: with SMTP id h10mr7166830wre.339.1571398636948; 
 Fri, 18 Oct 2019 04:37:16 -0700 (PDT)
X-Google-Smtp-Source: APXvYqwswu2MDluIlHSaDLFAS8ViSsdBpYIFEJShH5GAevqe1sYIwwVNfsKukj2PuJnnSIWFzVrgZw==
X-Received: by 2002:adf:9cca:: with SMTP id h10mr7166766wre.339.1571398635815; 
 Fri, 18 Oct 2019 04:37:15 -0700 (PDT)
Received: from pinea.redhat.com ([2001:861:3440:6a0:2cf1:592d:314d:825])
 by smtp.gmail.com with ESMTPSA id h125sm6936375wmf.31.2019.10.18.04.37.14
 for <spice-devel@lists.freedesktop.org>
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Fri, 18 Oct 2019 04:37:15 -0700 (PDT)
From: Kevin Pouget <kpouget@redhat.com>
To: spice-devel@lists.freedesktop.org
Date: Fri, 18 Oct 2019 13:37:07 +0200
Message-Id: <20191018113709.18888-1-kpouget@redhat.com>
X-Mailer: git-send-email 2.21.0
MIME-Version: 1.0
X-MC-Unique: etkh93nRPc6yZaHWvTUXEQ-1
X-Mimecast-Spam-Score: 0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=redhat.com; 
 s=mimecast20190719; t=1571398641;
 h=from:from:reply-to:subject:subject:date:date:message-id:message-id:
 to:to:cc:mime-version:mime-version:content-type:content-type:
 content-transfer-encoding:content-transfer-encoding;
 bh=QqpM4vQbfWfNs4oijTrIymbVTZQPW2pTP9qsGpEHYVA=;
 b=MZnY/3bVg4YzhVM1/J8qJLLLR9oAtTtH8TIxtpULSy2t1VM5WDsg5Tb+1YqHyGcweOGR/B
 X0wInYiyw6zWUi0dubiPflKoSjGHXufNKzTgNd4oMqjbgnmT8OjvWr2GgZg2L5zj8IJ/YG
 AHW0PqNNAhxZm+z+LhFRYU/b+yhER14=
Subject: [Spice-devel] [PATCH spice-common v2 1/3] agent-interface:
 introduce the core of the Agent Interface
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

V2hlbiBpbml0aWFsaXplZCAocmVjb3JkZXJfaW5pdGlhbGl6YXRpb24pLCB0aGUgQWdlbnQgSW50
ZXJmYWNlIGxhdW5jaAphIEdUaHJlYWQgKGhhbmRsZV9jb21tdW5pY2F0aW9ucykgdGhhdCBvcGVu
cyBhIFRDUCBzZXJ2ZXIgc29ja2V0IGFuZAp3YWl0cyBmb3IgU21hcnQgTG9jYWwgQWdlbnQgY29u
bmVjdGlvbnMuIFdoZW4gYSBMb2NhbCBBZ2VudCBjb25uZWN0cwp0byB0aGUgc29ja2V0cywgdGhl
IGNvbW11bmljYXRpb24gaXMgaW5pdGlhbGl6ZWQKKGFnZW50X2luaXRpYWxpemVfY29tbXVuaWNh
dGlvbiksIHRoZSBjb21tdW5pY2F0aW9uIHNvY2tldCBpcyBzdG9yZWQKYW5kIHRoZSBsaXN0IG9m
IFJlY29yZGVycyBpcyBzZW50LiBJbiByZXR1cm4sIHRoZSBsb2NhbCBhZ2VudAppbmRpY2F0ZXMg
d2hpY2ggcmVjb3JkZXJzIHRvIGVuYWJsZS4KCk9uIHRoZSBTUElDRSBzaWRlLCB0aGUgQWdlbnQg
SW50ZXJmYWNlIGhhbmRsZXMgdGhlIHJlY29yZCgpIGNhbGxzCihyZWNvcmRlcl9hcHBlbmQqKS4g
V2hlbiBhIHJlY29yZCBpcyByZWNlaXZlZCBmcm9tIFNQSUNFLCBhbmQgaWYgdGhlCnJlY29yZGVy
IGlzIGVuYWJsZWQsIHRoZSByZWNvcmQgZW50cnkgaXMgc2VudCB0aHJvdWdoIHRoZSBUQ1AKY29u
bmVjdGlvbi4gT3RoZXJ3aXNlLCB0aGUgcmVjb3JkIGlzIGRyb3BwZWQuCgpTaWduZWQtb2ZmLWJ5
OiBLZXZpbiBQb3VnZXQgPGtwb3VnZXRAcmVkaGF0LmNvbT4KLS0tCnYxLT52MjogZml4IHRlc3Rz
L3Rlc3QtZHVtbXktcmVjb3JkZXIuYwotLS0KIGNvbW1vbi9hZ2VudF9pbnRlcmZhY2UuYyAgICB8
IDQ2NyArKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrCiBjb21tb24vYWdlbnRfaW50ZXJm
YWNlLmggICAgfCA1NDIgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrCiB0ZXN0
cy90ZXN0LWR1bW15LXJlY29yZGVyLmMgfCAgIDMgKy0KIDMgZmlsZXMgY2hhbmdlZCwgMTAxMSBp
bnNlcnRpb25zKCspLCAxIGRlbGV0aW9uKC0pCiBjcmVhdGUgbW9kZSAxMDA2NDQgY29tbW9uL2Fn
ZW50X2ludGVyZmFjZS5jCiBjcmVhdGUgbW9kZSAxMDA2NDQgY29tbW9uL2FnZW50X2ludGVyZmFj
ZS5oCgpkaWZmIC0tZ2l0IGEvY29tbW9uL2FnZW50X2ludGVyZmFjZS5jIGIvY29tbW9uL2FnZW50
X2ludGVyZmFjZS5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAuLjc2OGI2YTkK
LS0tIC9kZXYvbnVsbAorKysgYi9jb21tb24vYWdlbnRfaW50ZXJmYWNlLmMKQEAgLTAsMCArMSw0
NjcgQEAKKy8qIC0qLSBNb2RlOiBDOyBjLWJhc2ljLW9mZnNldDogNDsgaW5kZW50LXRhYnMtbW9k
ZTogbmlsIC0qLSAqLworLyoKKyAgIENvcHlyaWdodCAoQykgMjAxOSBSZWQgSGF0LCBJbmMuCisK
KyAgIFRoaXMgbGlicmFyeSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBp
dCBhbmQvb3IKKyAgIG1vZGlmeSBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBMZXNzZXIg
R2VuZXJhbCBQdWJsaWMKKyAgIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3
YXJlIEZvdW5kYXRpb247IGVpdGhlcgorICAgdmVyc2lvbiAyLjEgb2YgdGhlIExpY2Vuc2UsIG9y
IChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCisKKyAgIFRoaXMgbGlicmFyeSBp
cyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAorICAgYnV0
IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkg
b2YKKyAgIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9T
RS4gIFNlZSB0aGUgR05VCisgICBMZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9y
ZSBkZXRhaWxzLgorCisgICBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBH
TlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCisgICBMaWNlbnNlIGFsb25nIHdpdGggdGhpcyBsaWJy
YXJ5OyBpZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCisqLworCisj
aW5jbHVkZSA8Y29uZmlnLmg+CisjaW5jbHVkZSA8c3RkbGliLmg+CisjaW5jbHVkZSA8c3lzL3Rp
bWUuaD4KKyNpbmNsdWRlIDxzdHJpbmcuaD4KKyNpbmNsdWRlIDxnbGliLmg+CisjaW5jbHVkZSA8
c3RkaW8uaD4KKyNpbmNsdWRlIDxzeXMvc29ja2V0Lmg+CisjaW5jbHVkZSA8bmV0aW5ldC9pbi5o
PgorI2luY2x1ZGUgPHVuaXN0ZC5oPgorI2luY2x1ZGUgPGFycGEvaW5ldC5oPgorI2luY2x1ZGUg
PHN5cy9ldmVudGZkLmg+CisjaW5jbHVkZSA8ZXJybm8uaD4KKyNpbmNsdWRlIDxwb2xsLmg+CisK
KyNpbmNsdWRlIDxjb21tb24vYWdlbnRfaW50ZXJmYWNlLmg+CisKK3R5cGVkZWYgc3RydWN0IHNv
Y2thZGRyIFNBOworCitzdGF0aWMgR1RocmVhZCAqcmVjb3JkZXJfY29tbV90aHI7CitzdGF0aWMg
Ym9vbCBhZ2VudF90ZXJtaW5hdGVkID0gZmFsc2U7CitzdGF0aWMgaW50IHRlcm1pbmF0ZV9lZmQg
PSAtMTsKK3N0YXRpYyBGSUxFICpjb21tdW5pY2F0aW9uX2YgPSBOVUxMOworCisjZGVmaW5lIE5C
X01BWF9SRUNPUkRFUlMgMTYKK3N0YXRpYyByZWNvcmRlcl9pbmZvICpyZWNvcmRlcnNbTkJfTUFY
X1JFQ09SREVSU107CitzdGF0aWMgdWludDMyX3QgbmJfcmVjb3JkZXJzID0gMDsKKworc3RhdGlj
IHVpbnRwdHJfdCByZWNvcmRlcl90aWNrKHZvaWQpOworCisjaWZuZGVmIFJFQ09SREVSX0haCisj
ZGVmaW5lIFJFQ09SREVSX0haICAgICAxMDAwMDAwCisjZW5kaWYgLy8gUkVDT1JERVJfSFoKKwor
c3RhdGljIEdNdXRleCBtdXRleF9zb2NrZXQ7CisKK3N0YXRpYyBpbnQgYWdlbnRfaW5pdGlhbGl6
ZV9jb21tdW5pY2F0aW9uKGludCBzb2NrZXQpCit7CisgICAgdWludDMyX3QgaTsKKyAgICBpbnQg
cmV0ID0gLTE7CisgICAgRklMRSAqc29ja2V0X2Y7CisKKyAgICBnX211dGV4X2xvY2soJm11dGV4
X3NvY2tldCk7CisKKyAgICBpZiAoY29tbXVuaWNhdGlvbl9mICE9IE5VTEwpIHsKKyAgICAgICAg
Z193YXJuaW5nKCJBIGNsaWVudCBpcyBhbHJlYWR5IGNvbm5lY3RlZCwgcmVqZWN0aW5nIHRoZSBj
b25uZWN0aW9uLiIpOworCisgICAgICAgIGdvdG8gdW5sb2NrOworICAgIH0KKworICAgIHNvY2tl
dF9mID0gZmRvcGVuKHNvY2tldCwgIncrYiIpOworCisgICAgZnByaW50Zihzb2NrZXRfZiwgIlJl
Y29yZGVyczogIik7CisgICAgZm9yIChpID0gMDsgaSA8IG5iX3JlY29yZGVyczsgaSsrKSB7Cisg
ICAgICAgIGdfZGVidWcoIlNlbmRpbmcgJXMiLCByZWNvcmRlcnNbaV0tPm5hbWUpOworICAgICAg
ICBmcHJpbnRmKHNvY2tldF9mLCAiJXM7IiwgcmVjb3JkZXJzW2ldLT5uYW1lKTsKKyAgICB9Cisg
ICAgZnByaW50Zihzb2NrZXRfZiwgIlxuIik7CisgICAgZmZsdXNoKHNvY2tldF9mKTsKKworICAg
IGZvciAoaSA9IDA7IGkgPCBuYl9yZWNvcmRlcnM7IGkrKykgeworICAgICAgICBjaGFyIGVuYWJs
ZTsKKworICAgICAgICBpZiAocmVhZChzb2NrZXQsICZlbmFibGUsIHNpemVvZihlbmFibGUpKSAh
PSBzaXplb2YoZW5hYmxlKSkgeworICAgICAgICAgICAgZ193YXJuaW5nKCJJbnZhbGlkIHJlYWQg
b24gdGhlIGNsaWVudCBzb2NrZXQiKTsKKworICAgICAgICAgICAgZ290byB1bmxvY2s7CisgICAg
ICAgIH0KKyAgICAgICAgaWYgKGVuYWJsZSAhPSAnMCcgJiYgZW5hYmxlICE9ICcxJykgeworICAg
ICAgICAgICAgZ19jcml0aWNhbCgiSW52YWxpZCBlbmFibGUtdmFsdWUgcmVjZWl2ZWQgZm9yIHJl
Y29yZGVyICclcyc6ICV1IiwKKyAgICAgICAgICAgICAgICAgICAgICAgcmVjb3JkZXJzW2ldLT5u
YW1lLCBlbmFibGUpOworCisgICAgICAgICAgICBnb3RvIHVubG9jazsKKyAgICAgICAgfQorCisg
ICAgICAgIGlmIChlbmFibGUgPT0gJzAnKSB7CisgICAgICAgICAgICBjb250aW51ZTsKKyAgICAg
ICAgfQorCisgICAgICAgIHJlY29yZGVyc1tpXS0+dHJhY2UgPSAxOworICAgICAgICBnX2luZm8o
IkVuYWJsZSByZWNvcmRlciAnJXMnIiwgcmVjb3JkZXJzW2ldLT5uYW1lKTsKKyAgICB9CisKKyAg
ICBjb21tdW5pY2F0aW9uX2YgPSBzb2NrZXRfZjsKKyAgICByZXQgPSAwOworCit1bmxvY2s6Cisg
ICAgZ19tdXRleF91bmxvY2soJm11dGV4X3NvY2tldCk7CisKKyAgICByZXR1cm4gcmV0OworfQor
CitzdGF0aWMgdm9pZCBhZ2VudF9maW5hbGl6ZV9jb21tdW5pY2F0aW9uKGludCBzb2NrZXQpCit7
CisgICAgdWludDMyX3QgaTsKKyAgICBnX2luZm8oIkNvbW11bmljYXRpb24gc29ja2V0IGNsb3Nl
ZC4iKTsKKworICAgIGdfbXV0ZXhfbG9jaygmbXV0ZXhfc29ja2V0KTsKKyAgICBnX2Fzc2VydChz
b2NrZXQgPT0gZmlsZW5vKGNvbW11bmljYXRpb25fZikpOworCisgICAgZmNsb3NlKGNvbW11bmlj
YXRpb25fZik7CisgICAgY29tbXVuaWNhdGlvbl9mID0gTlVMTDsKKworICAgIGZvciAoaSA9IDA7
IGkgPCBuYl9yZWNvcmRlcnM7IGkrKykgeworICAgICAgICByZWNvcmRlcnNbaV0tPnRyYWNlID0g
MDsKKyAgICB9CisgICAgZ19tdXRleF91bmxvY2soJm11dGV4X3NvY2tldCk7Cit9CisKK3N0YXRp
YyBpbnQgYWdlbnRfcHJvY2Vzc19jb21tdW5pY2F0aW9uKGludCBzb2NrZXQpCit7CisgICAgc3Rh
dGljIGNoYXIgbXNnX2luWzEyOF07CisKKyAgICBzdGF0aWMgbG9uZyB1bnNpZ25lZCBpbnQgbGVu
ID0gMDsKKworICAgIGdfYXNzZXJ0KHNvY2tldCA9PSBmaWxlbm8oY29tbXVuaWNhdGlvbl9mKSk7
CisKKyAgICBpbnQgbmJ5dGVzID0gcmVhZChzb2NrZXQsIG1zZ19pbiArIGxlbiwgMSk7CisKKyAg
ICBpZiAobmJ5dGVzIDwgMCAmJiBlcnJubyA9PSBFSU5UUikgeworICAgICAgIHJldHVybiAwOwor
ICAgIH0KKworICAgIGlmIChuYnl0ZXMgPD0gMCkgeworICAgICAgICBhZ2VudF9maW5hbGl6ZV9j
b21tdW5pY2F0aW9uKHNvY2tldCk7CisgICAgICAgIHJldHVybiAtMTsgLy8gc29ja2V0IGNsb3Nl
ZAorICAgIH0KKworICAgIGlmIChtc2dfaW5bbGVuXSA9PSAnXDAnKSB7CisgICAgICAgIC8vIFRP
RE86IHByb2Nlc3MgcXVhbGl0eSBpbmRpY2F0b3IKKyAgICAgICAgbGVuID0gMDsKKyAgICAgICAg
cmV0dXJuIDA7CisgICAgfQorCisgICAgbGVuICs9IG5ieXRlczsKKworICAgIGlmIChsZW4gPj0g
c2l6ZW9mKG1zZ19pbikgLSAxKSB7CisgICAgICAgIG1zZ19pbltzaXplb2YobXNnX2luKSAtIDFd
ID0gJ1wwJzsKKyAgICAgICAgZ193YXJuaW5nKCJJbnZhbGlkIG1lc3NhZ2UgcmVjZWl2ZWQgKHRv
byBsb25nPyk6ICVzIiwgbXNnX2luKTsKKyAgICAgICAgbGVuID0gMDsKKyAgICB9CisKKyAgICBy
ZXR1cm4gMDsKK30KKworc3RhdGljIGludCBtYWtlX3NvY2tldChndWludCBwb3J0KQoreworICAg
IHN0cnVjdCBzb2NrYWRkcl9pbiBzZXJ2YWRkcjsKKyAgICBpbnQgbGlzdGVuX3NvY2tldCA9IHNv
Y2tldChBRl9JTkVULCBTT0NLX1NUUkVBTSwgMCk7CisKKyAgICBpZiAobGlzdGVuX3NvY2tldCA9
PSAtMSkgeworICAgICAgICBnX2NyaXRpY2FsKCJzb2NrZXQgY3JlYXRpb24gZmFpbGVkIik7Cisg
ICAgICAgIHJldHVybiAtMTsKKyAgICB9CisKKyAgICBpbnQgZW5hYmxlID0gMTsKKyAgICBpZiAo
c2V0c29ja29wdChsaXN0ZW5fc29ja2V0LCBTT0xfU09DS0VULCBTT19SRVVTRUFERFIsICZlbmFi
bGUsIHNpemVvZihpbnQpKSA8IDApIHsKKyAgICAgICAgZ19jcml0aWNhbCgic2V0c29ja29wdChT
T19SRVVTRUFERFIpIGZhaWxlZCIpOworICAgICAgICBjbG9zZShsaXN0ZW5fc29ja2V0KTsKKyAg
ICAgICAgcmV0dXJuIC0xOworICAgIH0KKworICAgIG1lbXNldCgmc2VydmFkZHIsIDAsIHNpemVv
ZihzZXJ2YWRkcikpOworCisgICAgc2VydmFkZHIuc2luX2ZhbWlseSA9IEFGX0lORVQ7CisgICAg
c2VydmFkZHIuc2luX2FkZHIuc19hZGRyID0gaHRvbmwoSU5BRERSX0FOWSk7CisgICAgc2VydmFk
ZHIuc2luX3BvcnQgPSBodG9ucyhwb3J0KTsKKworICAgIGlmIChiaW5kKGxpc3Rlbl9zb2NrZXQs
IChTQSAqKSAmc2VydmFkZHIsIHNpemVvZihzZXJ2YWRkcikpICE9IDApIHsKKyAgICAgICAgZ19j
cml0aWNhbCgic29ja2V0IGJpbmQgZmFpbGVkIik7CisgICAgICAgIGNsb3NlKGxpc3Rlbl9zb2Nr
ZXQpOworICAgICAgICByZXR1cm4gLTE7CisgICAgfQorCisgICAgcmV0dXJuIGxpc3Rlbl9zb2Nr
ZXQ7Cit9CisKK3N0YXRpYyBncG9pbnRlciBoYW5kbGVfY29tbXVuaWNhdGlvbnMoZ3BvaW50ZXIg
dXNlcl9kYXRhKQoreworICAgIHN0cnVjdCBwb2xsZmQgZmRzWzNdOworICAgIGludCBuYl9mZCA9
IDA7CisgICAgaW50IGxpc3Rlbl9zb2NrZXQ7CisgICAgaW50IGk7CisgICAgZ3VpbnQgcG9ydCA9
IEdQT0lOVEVSX1RPX1VJTlQodXNlcl9kYXRhKTsKKworICAgIGxpc3Rlbl9zb2NrZXQgPSBtYWtl
X3NvY2tldChwb3J0KTsKKyAgICBpZiAobGlzdGVuX3NvY2tldCA8IDApIHsKKyAgICAgICAgcmV0
dXJuIE5VTEw7CisgICAgfQorCisgICAgZ19kZWJ1ZygiTGlzdGVuaW5nISIpOworCisgICAgaWYg
KChsaXN0ZW4obGlzdGVuX3NvY2tldCwgMSkpICE9IDApIHsKKyAgICAgICAgZ19jcml0aWNhbCgi
bGlzdGVuIGZhaWxlZDogJW0iKTsKKyAgICAgICAgcmV0dXJuIE5VTEw7CisgICAgfQorCisgICAg
ZmRzWzBdLmZkID0gdGVybWluYXRlX2VmZDsKKyAgICBmZHNbMF0uZXZlbnRzID0gUE9MTElOOwor
ICAgIGZkc1sxXS5mZCA9IGxpc3Rlbl9zb2NrZXQ7CisgICAgZmRzWzFdLmV2ZW50cyA9IFBPTExJ
TjsKKyAgICBuYl9mZCA9IDI7CisKKyAgICB3aGlsZSAoIWFnZW50X3Rlcm1pbmF0ZWQpIHsKKwor
ICAgICAgICAvKiBCbG9jayB1bnRpbCBpbnB1dCBhcnJpdmVzIG9uIG9uZSBvciBtb3JlIGFjdGl2
ZSBzb2NrZXRzLiAqLworICAgICAgICBpbnQgcmV0ID0gcG9sbChmZHMsIG5iX2ZkLCAtMSk7CisK
KyAgICAgICAgaWYgKHJldCA8IDApIHsKKyAgICAgICAgICAgIGdfY3JpdGljYWwoInBvbGwgZmFp
bGVkOiAlbSIpOworICAgICAgICAgICAgYnJlYWs7CisgICAgICAgIH0KKworICAgICAgICAvKiBT
ZXJ2aWNlIGFsbCB0aGUgc29ja2V0cyB3aXRoIGlucHV0IHBlbmRpbmcuICovCisgICAgICAgIGZv
ciAoaSA9IDA7IGkgPCBuYl9mZDsgaSsrKSB7CisgICAgICAgICAgICBpbnQgZmQgPSBmZHNbaV0u
ZmQ7CisgICAgICAgICAgICBpZiAoZmQgPT0gdGVybWluYXRlX2VmZCkgeworICAgICAgICAgICAg
ICAgIGlmIChmZHNbaV0ucmV2ZW50cyAmIFBPTExJTikgeworICAgICAgICAgICAgICAgICAgICBn
X2Fzc2VydChhZ2VudF90ZXJtaW5hdGVkKTsKKyAgICAgICAgICAgICAgICAgICAgYnJlYWs7Cisg
ICAgICAgICAgICAgICAgfQorICAgICAgICAgICAgfSBlbHNlIGlmIChmZCA9PSBsaXN0ZW5fc29j
a2V0KSB7CisgICAgICAgICAgICAgICAgaWYgKGZkc1tpXS5yZXZlbnRzICYgflBPTExJTikgewor
ICAgICAgICAgICAgICAgICAgICBnX2NyaXRpY2FsKCJzZXJ2ZXIgc29ja2V0IGNsb3NlZCIpOwor
ICAgICAgICAgICAgICAgICAgICBicmVhazsKKyAgICAgICAgICAgICAgICB9CisgICAgICAgICAg
ICAgICAgaWYgKCEoZmRzW2ldLnJldmVudHMgJiBQT0xMSU4pKSB7CisgICAgICAgICAgICAgICAg
ICAgIGNvbnRpbnVlOworICAgICAgICAgICAgICAgIH0KKworICAgICAgICAgICAgICAgIC8qIENv
bm5lY3Rpb24gcmVxdWVzdCBvbiBvcmlnaW5hbCBzb2NrZXQuICovCisgICAgICAgICAgICAgICAg
aW50IG5ld19mZCA9IGFjY2VwdChsaXN0ZW5fc29ja2V0LCBOVUxMLCBOVUxMKTsKKworICAgICAg
ICAgICAgICAgIGlmIChuZXdfZmQgPCAwKSB7CisgICAgICAgICAgICAgICAgICAgIGdfY3JpdGlj
YWwoImFjY2VwdCBmYWlsZWQ6ICVtIik7CisgICAgICAgICAgICAgICAgICAgIGJyZWFrOworICAg
ICAgICAgICAgICAgIH0KKworICAgICAgICAgICAgICAgIGlmIChuYl9mZCA9PSAzKSB7CisgICAg
ICAgICAgICAgICAgICAgIGNsb3NlKG5ld19mZCk7CisgICAgICAgICAgICAgICAgICAgIGdfd2Fy
bmluZygiVG9vIG1hbnkgY2xpZW50cyBhY2NlcHRlZCAuLi4iKTsKKyAgICAgICAgICAgICAgICAg
ICAgY29udGludWU7CisgICAgICAgICAgICAgICAgfQorCisgICAgICAgICAgICAgICAgZ19kZWJ1
ZygiQWdlbnQgSW50ZXJmYWNlOiBjbGllbnQgY29ubmVjdGVkISIpOworCisgICAgICAgICAgICAg
ICAgaWYgKGFnZW50X2luaXRpYWxpemVfY29tbXVuaWNhdGlvbihuZXdfZmQpKSB7CisgICAgICAg
ICAgICAgICAgICAgIGNsb3NlKG5ld19mZCk7CisgICAgICAgICAgICAgICAgICAgIGdfd2Fybmlu
ZygiSW5pdGlhbGl6YXRpb24gZmFpbGVkIC4uLiIpOworICAgICAgICAgICAgICAgICAgICBjb250
aW51ZTsKKyAgICAgICAgICAgICAgICB9CisKKyAgICAgICAgICAgICAgICBmZHNbbmJfZmRdLmZk
ID0gbmV3X2ZkOworICAgICAgICAgICAgICAgIGZkc1tuYl9mZF0uZXZlbnRzID0gUE9MTElOOwor
ICAgICAgICAgICAgICAgIG5iX2ZkKys7CisKKyAgICAgICAgICAgICAgICAvKiBmZHMgYXJyYXkg
bW9kaWZpZWQsIHJlc3RhcnQgdGhlIHBvbGwuICovCisgICAgICAgICAgICAgICAgYnJlYWs7Cisg
ICAgICAgICAgICB9IGVsc2UgeworICAgICAgICAgICAgICAgIGlmICghKGZkc1tpXS5yZXZlbnRz
ICYgUE9MTElOKSkgeworICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKKyAgICAgICAgICAg
ICAgICB9CisKKyAgICAgICAgICAgICAgICAvKiBEYXRhIGFycml2aW5nIG9uIGFuIGFscmVhZHkt
Y29ubmVjdGVkIHNvY2tldC4gKi8KKyAgICAgICAgICAgICAgICBpZiAoYWdlbnRfcHJvY2Vzc19j
b21tdW5pY2F0aW9uKGZkKSA8IDApIHsKKyAgICAgICAgICAgICAgICAgICAgbmJfZmQtLTsKKyAg
ICAgICAgICAgICAgICB9CisgICAgICAgICAgICB9CisgICAgICAgIH0KKyAgICB9CisKKyAgICBj
bG9zZSh0ZXJtaW5hdGVfZWZkKTsKKyAgICBjbG9zZShsaXN0ZW5fc29ja2V0KTsKKworICAgIGdf
aW5mbygiQWdlbnQgaW50ZXJmYWNlIHRocmVhZDogYnllISIpOworICAgIHJldHVybiBOVUxMOwor
fQorCitzdGF0aWMgdm9pZCByZWNvcmRlcl9kZXJlZ2lzdGVyKHZvaWQpOworCitzdGF0aWMgdm9p
ZCByZWNvcmRlcl9pbml0aWFsaXphdGlvbih1bnNpZ25lZCBpbnQgcG9ydCkKK3sKKyAgICBHRXJy
b3IgKmVycm9yID0gTlVMTDsKKworICAgIHRlcm1pbmF0ZV9lZmQgPSBldmVudGZkKDAsIDApOwor
ICAgIGlmICh0ZXJtaW5hdGVfZWZkID09IC0xKSB7CisgICAgICAgIGdfY3JpdGljYWwoImV2ZW50
ZmQgZmFpbGVkOiAlbSIpOworICAgICAgICByZXR1cm47CisgICAgfQorCisgICAgcmVjb3JkZXJf
Y29tbV90aHIgPSBnX3RocmVhZF90cnlfbmV3KCJzbWFydF9hZ2VudF9pbnRlcmZhY2UiLAorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVfY29tbXVuaWNhdGlv
bnMsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdVSU5UX1RPX1BP
SU5URVIoKGd1aW50KSBwb3J0KSwgJmVycm9yKTsKKyAgICBpZiAoZXJyb3IpIHsKKyAgICAgICAg
Z19hc3NlcnQoIXJlY29yZGVyX2NvbW1fdGhyKTsKKyAgICAgICAgZ19jcml0aWNhbCgiRXJyb3I6
IENvdWxkIG5vdCBzdGFydCB0aGUgYWdlbnQgaW50ZXJmYWNlIHRocmVhZDogJXMiLCBlcnJvci0+
bWVzc2FnZSk7CisgICAgICAgIGdfZXJyb3JfZnJlZShlcnJvcik7CisgICAgICAgIHJldHVybjsK
KyAgICB9CisKKyAgICBhdGV4aXQocmVjb3JkZXJfZGVyZWdpc3Rlcik7Cit9CisKK3N0YXRpYyB2
b2lkIHJlY29yZGVyX2ludGVycnVwdF9jb21tdW5pY2F0aW9ucyh2b2lkKQoreworICAgIGFnZW50
X3Rlcm1pbmF0ZWQgPSB0cnVlOworCisgICAgdWludDY0X3QgbXNnID0gMTsKKyAgICBzc2l6ZV90
IHMgPSB3cml0ZSh0ZXJtaW5hdGVfZWZkLCAmbXNnLCBzaXplb2YodWludDY0X3QpKTsKKworICAg
IGlmIChzICE9IHNpemVvZih1aW50NjRfdCkpIHsKKyAgICAgICAgZ193YXJuaW5nKCJmYWlsZWQg
dG8gc2VuZCByZWNvcmRlciB0aHJlYWQgdGVybWluYXRpb24gZXZlbnQ6ICVtIik7CisgICAgfQor
fQorCisKK3N0YXRpYyB2b2lkIHJlY29yZGVyX2RlcmVnaXN0ZXIodm9pZCkKK3sKKyAgICBpZiAo
cmVjb3JkZXJfY29tbV90aHIpIHsKKyAgICAgICAgcmVjb3JkZXJfaW50ZXJydXB0X2NvbW11bmlj
YXRpb25zKCk7CisgICAgICAgIGdfdGhyZWFkX2pvaW4ocmVjb3JkZXJfY29tbV90aHIpOworICAg
ICAgICByZWNvcmRlcl9jb21tX3RociA9IE5VTEw7CisgICAgfQorfQorCit2b2lkIHJlY29yZGVy
X2FjdGl2YXRlKHJlY29yZGVyX2luZm8gKnJlY29yZGVyKQoreworICAgIGlmIChuYl9yZWNvcmRl
cnMgPj0gTkJfTUFYX1JFQ09SREVSUykgeworICAgICAgICBnX2NyaXRpY2FsKCJUb28gbWFueSBy
ZWNvcmRlcnMgY29uZmlndXJlZCAobmIgbWF4OiAlZCkiLCBOQl9NQVhfUkVDT1JERVJTKTsKKyAg
ICAgICAgcmV0dXJuOworICAgIH0KKworICAgIHJlY29yZGVyc1tuYl9yZWNvcmRlcnNdID0gcmVj
b3JkZXI7CisgICAgbmJfcmVjb3JkZXJzKys7Cit9CisKK3N0YXRpYyB2b2lkIGRvX3NlbmRfZW50
cnkoRklMRSAqZGVzdCwgcmVjb3JkZXJfaW5mbyAqaW5mbywgcmVjb3JkZXJfZW50cnkgKmVudHJ5
LCB2YV9saXN0IGFyZ3MpCit7CisgICAgZnByaW50ZihkZXN0LCAiTmFtZTogJXNcbkZ1bmN0aW9u
OiAlc1xuVGltZTogJWx1XG4iLAorICAgICAgICAgICAgaW5mby0+bmFtZSwgZW50cnktPndoZXJl
LCBlbnRyeS0+dGltZXN0YW1wKTsKKworICAgIHZmcHJpbnRmKGRlc3QsIGVudHJ5LT5mb3JtYXQs
IGFyZ3MpOworICAgIGZwcmludGYoZGVzdCwgIlxuXG4iKTsKKworICAgIGZmbHVzaChkZXN0KTsK
K30KKworCitzdGF0aWMgdm9pZCByZWNvcmRlcl90cmFjZV9lbnRyeShyZWNvcmRlcl9pbmZvICpp
bmZvLCByZWNvcmRlcl9lbnRyeSAqZW50cnksIC4uLikKKy8vIC0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0K
Ky8vICAgU2hvdyBhIHJlY29yZGVyIGVudHJ5IHdoZW4gYSB0cmFjZSBpcyBlbmFibGVkCisvLyAt
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tCit7CisgICAgdmFfbGlzdCBhcmdzOworCisgICAgaWYgKHN0cmNo
cihlbnRyeS0+Zm9ybWF0LCAnXG4nKSAhPSBOVUxMKSB7CisgICAgICAgIGdfY3JpdGljYWwoIkFn
ZW50IHJlY29yZHMgY2Fubm90IGNvbnRhaW4gJ1xuJyBjaGFyIC4uLiAoJXMpIiwgZW50cnktPndo
ZXJlKTsKKyAgICAgICAgcmV0dXJuOworICAgIH0KKworICAgIC8vIHNlbmQgaW5mby9lbnRyeSB0
byB0aGUgc29ja2V0CisgICAgZ19tdXRleF9sb2NrKCZtdXRleF9zb2NrZXQpOworCisgICAgaWYg
KGNvbW11bmljYXRpb25fZiA9PSBOVUxMKSB7CisgICAgICAgIGdfbXV0ZXhfdW5sb2NrKCZtdXRl
eF9zb2NrZXQpOworICAgICAgICByZXR1cm47CisgICAgfQorCisgICAgdmFfc3RhcnQoYXJncywg
ZW50cnkpOworICAgIGRvX3NlbmRfZW50cnkoY29tbXVuaWNhdGlvbl9mLCBpbmZvLCBlbnRyeSwg
YXJncyk7CisgICAgdmFfZW5kKGFyZ3MpOworCisgICAgaWYgKGdfc3RyY21wMChnX2dldGVudigi
U1BJQ0VfQUdFTlRfTE9HX1JFQ09SRFMiKSwgIjEiKSA9PSAwKSB7CisgICAgICAgIHZhX3N0YXJ0
KGFyZ3MsIGVudHJ5KTsKKyAgICAgICAgZG9fc2VuZF9lbnRyeShzdGRlcnIsIGluZm8sIGVudHJ5
LCBhcmdzKTsKKyAgICAgICAgdmFfZW5kKGFyZ3MpOworICAgIH0KKworICAgIGdfbXV0ZXhfdW5s
b2NrKCZtdXRleF9zb2NrZXQpOworfQorCit2b2lkIHJlY29yZGVyX2FwcGVuZChyZWNvcmRlcl9p
bmZvICpyZWMsCisgICAgICAgICAgICAgICAgICAgICBjb25zdCBjaGFyICp3aGVyZSwKKyAgICAg
ICAgICAgICAgICAgICAgIGNvbnN0IGNoYXIgKmZvcm1hdCwKKyAgICAgICAgICAgICAgICAgICAg
IHVpbnRwdHJfdCBhMCwKKyAgICAgICAgICAgICAgICAgICAgIHVpbnRwdHJfdCBhMSwKKyAgICAg
ICAgICAgICAgICAgICAgIHVpbnRwdHJfdCBhMiwKKyAgICAgICAgICAgICAgICAgICAgIHVpbnRw
dHJfdCBhMykKKy8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKy8vICBFbnRlciBhIHJlY29yZCBlbnRy
eSBpbiByaW5nIGJ1ZmZlciB3aXRoIGdpdmVuIHNldCBvZiBhcmdzCisvLyAtLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tCit7CisgICAgcmVjb3JkZXJfZW50cnkgZW50cnk7CisKKyAgICBpZiAoIXJlYy0+dHJh
Y2UpIHsKKyAgICAgICAgcmV0dXJuOworICAgIH0KKworICAgIGVudHJ5LmZvcm1hdCA9IGZvcm1h
dDsKKyAgICBlbnRyeS50aW1lc3RhbXAgPSByZWNvcmRlcl90aWNrKCk7CisgICAgZW50cnkud2hl
cmUgPSB3aGVyZTsKKworICAgIHJlY29yZGVyX3RyYWNlX2VudHJ5KHJlYywgJmVudHJ5LCBhMCwg
YTEsIGEyLCBhMyk7Cit9CisKK3ZvaWQgcmVjb3JkZXJfYXBwZW5kMihyZWNvcmRlcl9pbmZvICpy
ZWMsCisgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hhciAqd2hlcmUsCisgICAgICAgICAg
ICAgICAgICAgICAgY29uc3QgY2hhciAqZm9ybWF0LAorICAgICAgICAgICAgICAgICAgICAgIHVp
bnRwdHJfdCBhMCwKKyAgICAgICAgICAgICAgICAgICAgICB1aW50cHRyX3QgYTEsCisgICAgICAg
ICAgICAgICAgICAgICAgdWludHB0cl90IGEyLAorICAgICAgICAgICAgICAgICAgICAgIHVpbnRw
dHJfdCBhMywKKyAgICAgICAgICAgICAgICAgICAgICB1aW50cHRyX3QgYTQsCisgICAgICAgICAg
ICAgICAgICAgICAgdWludHB0cl90IGE1LAorICAgICAgICAgICAgICAgICAgICAgIHVpbnRwdHJf
dCBhNiwKKyAgICAgICAgICAgICAgICAgICAgICB1aW50cHRyX3QgYTcpCisvLyAtLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tCisvLyAgIEVudGVyIGEgZG91YmxlIHJlY29yZCAodXAgdG8gOCBhcmdzKQorLy8g
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLQoreworICAgIHJlY29yZGVyX2VudHJ5IGVudHJ5OworCisgICAg
aWYgKCFyZWMtPnRyYWNlKSB7CisgICAgICAgIHJldHVybjsKKyAgICB9CisKKyAgICBlbnRyeS5m
b3JtYXQgPSBmb3JtYXQ7CisgICAgZW50cnkudGltZXN0YW1wID0gcmVjb3JkZXJfdGljaygpOwor
ICAgIGVudHJ5LndoZXJlID0gd2hlcmU7CisKKyAgICByZWNvcmRlcl90cmFjZV9lbnRyeShyZWMs
ICZlbnRyeSwgYTAsIGExLCBhMiwgYTMsIGE0LCBhNSwgYTYsIGE3KTsKK30KKworLy8gPT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PQorLy8KKy8vICAgIFN1cHBvcnQgZnVuY3Rpb25zCisvLworLy8gPT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PQorCitzdGF0aWMgdWludHB0cl90IHJlY29yZGVyX3RpY2sodm9pZCkKKy8v
IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0KKy8vICAgUmV0dXJuIHRoZSAidGlja3MiIGFzIHN0b3JlZCBp
biB0aGUgcmVjb3JkZXIKKy8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KK3sKKyAgICBzdHJ1Y3QgdGlt
ZXZhbCB0OworCisgICAgZ2V0dGltZW9mZGF5KCZ0LCBOVUxMKTsKKworICAgIHJldHVybiB0LnR2
X3NlYyAqIFJFQ09SREVSX0haICsgdC50dl91c2VjIC8gKDEwMDAwMDAgLyBSRUNPUkRFUl9IWik7
Cit9CmRpZmYgLS1naXQgYS9jb21tb24vYWdlbnRfaW50ZXJmYWNlLmggYi9jb21tb24vYWdlbnRf
aW50ZXJmYWNlLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMC4uMDQyMTIwZQot
LS0gL2Rldi9udWxsCisrKyBiL2NvbW1vbi9hZ2VudF9pbnRlcmZhY2UuaApAQCAtMCwwICsxLDU0
MiBAQAorI3ByYWdtYSBvbmNlCisKKy8vICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCisvLyBUaGlzIHNv
ZnR3YXJlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljIExp
Y2Vuc2UgdjIrCisvLyAoQykgMjAxNy0yMDE5LCBDaHJpc3RvcGhlIGRlIERpbmVjaGluIDxjaHJp
c3RvcGhlQGRpbmVjaGluLm9yZz4KKy8vICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCisvLyBUaGlzIGZp
bGUgd2FzIHBhcnQgb2YgUmVjb3JkZXIKKy8vCisvLyBSZWNvcmRlciBpcyBmcmVlIHNvZnR3YXJl
OiB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CisvLyBpdCB1bmRlciB0aGUg
dGVybXMgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNo
ZWQgYnkKKy8vIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24sIGVpdGhlciB2ZXJzaW9uIDIg
b2YgdGhlIExpY2Vuc2UsIG9yCisvLyAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9u
LgorLy8KKy8vIFJlY29yZGVyIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2ls
bCBiZSB1c2VmdWwsCisvLyBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0
aGUgaW1wbGllZCB3YXJyYW50eSBvZgorLy8gTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9S
IEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQorLy8gR05VIExlc3NlciBHZW5lcmFsIFB1
YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCisvLworLy8gWW91IHNob3VsZCBoYXZlIHJl
Y2VpdmVkIGEgY29weSBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlCisv
LyBhbG9uZyB3aXRoIFJlY29yZGVyLCBpbiBhIGZpbGUgbmFtZWQgQ09QWUlORy4KKy8vIElmIG5v
dCwgc2VlIDxodHRwczovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCisvLyAqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKgorLyogVGhpcyBmaWxlIGlzIGJhc2VkIG9uIFJlY29yZGVyJ3MgcmVjb3JkZXIuaCBm
aWxlLCB0aGF0IGRlc2NyaWJlcyBhIGdlbmVyYWwtCisgKiBwdXJwb3NlIGluc3RydW1lbnRhdGlv
biBpbnRlcmZhY2UuIGFnZW50X2ludGVyZmFjZS5oIGlzIGEgdHJpbW1lZC1kb3duCisgKiB2ZXJz
aW9uIG9mIGl0LiAqLworCisjaW5jbHVkZSA8c3RkYXJnLmg+CisjaW5jbHVkZSA8c3RkaW50Lmg+
CisjaW5jbHVkZSA8c3RkYm9vbC5oPgorI2luY2x1ZGUgPHN0ZGRlZi5oPgorCisjaWZkZWYgX19j
cGx1c3BsdXMKK2V4dGVybiAiQyIgeworI2VuZGlmIC8vIF9fY3BsdXNwbHVzCisKK3N0YXRpYyBp
bmxpbmUgdm9pZAorcmVjb3JkZXJfZHVtcF9vbl9jb21tb25fc2lnbmFscyh1bnNpZ25lZCBhZGQs
IHVuc2lnbmVkIHJlbW92ZSkKK3sKK30KKworLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQorLy8KKy8v
ICAgIFJlY29yZGVyIGRhdGEgc3RydWN0dXJlcworLy8KKy8vID09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0K
KwordHlwZWRlZiBzdHJ1Y3QgcmVjb3JkZXJfZW50cnkKKy8vLyAtLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0K
Ky8vLyAgIEVudHJ5IGluIHRoZSBmbGlnaHQgcmVjb3JkZXIuCisvLy8tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tCisvLy8gIE5vdGljZSB0aGF0IHRoZSBhcmd1bWVudHMgYXJlIHN0b3JlZCBhcyAiaW50cHRy
X3QiIGJlY2F1c2UgdGhhdCB0eXBlCisvLy8gIGlzIGd1YXJhbnRlZWQgdG8gYmUgdGhlIHNhbWUg
c2l6ZSBhcyBhIHBvaW50ZXIuIFRoaXMgYWxsb3dzIHVzIHRvCisvLy8gIHByb3Blcmx5IGFsaWdu
IHJlY29yZGVyIGVudHJpZXMgdG8gcG93ZXJzIG9mIDIgZm9yIGVmZmljaWVuY3kuCisvLy8gIEFs
c28gcmVhZCBleHBsYW5hdGlvbnMgb2YgXHJlZiBfcmVjb3JkZXJfZG91YmxlIGFuZCBccmVmIF9y
ZWNvcmRlcl9mbG9hdAorLy8vICBiZWxvdyByZWdhcmRpbmcgaG93IHRvIHVzZSBmbG9hdGluZy1w
b2ludCB3aXRoIHRoZSByZWNvcmRlci4KK3sKKyAgICBjb25zdCBjaGFyICpmb3JtYXQ7ICAgICAg
ICAgLy8vPCBQcmludGYtc3R5bGUgZm9ybWF0IGZvciByZWNvcmQgKyBmaWxlL2xpbmUKKyAgICB1
aW50cHRyX3QgICB0aW1lc3RhbXA7ICAgICAgLy8vPCBUaW1lIGF0IHdoaWNoIHJlY29yZCB0b29r
IHBsYWNlCisgICAgY29uc3QgY2hhciAqd2hlcmU7ICAgICAgICAgIC8vLzwgU291cmNlIGNvZGUg
ZnVuY3Rpb24KKyAgICB1aW50cHRyX3QgICBhcmdzWzRdOyAgICAgICAgLy8vPCBGb3VyIGFyZ3Vt
ZW50cywgZm9yIGEgdG90YWwgb2YgOCBmaWVsZHMKK30gcmVjb3JkZXJfZW50cnk7CisKKworLy8v
IEEgZ2xvYmFsIGNvdW50ZXIgaW5kaWNhdGluZyB0aGUgb3JkZXIgb2YgZW50cmllcyBhY3Jvc3Mg
cmVjb3JkZXJzLgorLy8vIHRoaXMgaXMgaW5jcmVtZW50ZWQgYXRvbWljYWxseSBmb3IgZWFjaCBy
ZWNvcmQoKSBjYWxsLgorLy8vIEl0IG11c3QgYmUgZXhwb3NlZCBiZWNhdXNlIGFsbCBYWVpfcmVj
b3JkKCkgaW1wbGVtZW50YXRpb25zIG5lZWQgdG8KKy8vLyB0b3VjaCB0aGUgc2FtZSBzaGFyZWQg
dmFyaWFibGUgaW4gb3JkZXIgdG8gcHJvdmlkZSBhIGdsb2JhbCBvcmRlci4KK2V4dGVybiB1aW50
cHRyX3QgcmVjb3JkZXJfb3JkZXI7CisKK3R5cGVkZWYgc3RydWN0IHJlY29yZGVyX2luZm8KKy8v
Ly0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0KKy8vLyAgIEEgbGlua2VkIGxpc3Qgb2YgdGhlIGFjdGl2YXRl
ZCByZWNvcmRlcnMKKy8vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KK3sKKyAgICBpbnRwdHJfdCAgICAg
ICAgICAgICAgICB0cmFjZTsgICAgICAvLy88IFRyYWNlIHRoaXMgcmVjb3JkZXIKKyAgICBjb25z
dCBjaGFyICogICAgICAgICAgICBuYW1lOyAgICAgICAvLy88IE5hbWUgb2YgdGhpcyBwYXJhbWV0
ZXIgLyByZWNvcmRlcgorICAgIGNvbnN0IGNoYXIgKiAgICAgICAgICAgIGRlc2NyaXB0aW9uOy8v
LzwgRGVzY3JpcHRpb24gb2Ygd2hhdCBpcyByZWNvcmRlZAorICAgIHJlY29yZGVyX2VudHJ5ICAg
ICAgICAgIGRhdGFbMF07ICAgIC8vLzwgRGF0YSBmb3IgdGhpcyByZWNvcmRlcgorfSByZWNvcmRl
cl9pbmZvOworCisvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CisvLworLy8gICBBZGRpbmcgZGF0YSB0
byBhIHJlY29yZGVyCisvLworLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQorCitleHRlcm4gdm9pZCBy
ZWNvcmRlcl9hcHBlbmQocmVjb3JkZXJfaW5mbyAqcmVjLAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGNvbnN0IGNoYXIgKndoZXJlLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNv
bnN0IGNoYXIgKmZvcm1hdCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50cHRyX3Qg
YTAsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludHB0cl90IGExLAorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHVpbnRwdHJfdCBhMiwKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICB1aW50cHRyX3QgYTMpOworZXh0ZXJuIHZvaWQgcmVjb3JkZXJfYXBwZW5kMihyZWNvcmRl
cl9pbmZvICpyZWMsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoYXIgKndo
ZXJlLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjaGFyICpmb3JtYXQsCisg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnRwdHJfdCBhMCwKKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgdWludHB0cl90IGExLAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICB1aW50cHRyX3QgYTIsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnRwdHJfdCBh
MywKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludHB0cl90IGE0LAorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICB1aW50cHRyX3QgYTUsCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHVpbnRwdHJfdCBhNiwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludHB0
cl90IGE3KTsKK2V4dGVybiB2b2lkIHJlY29yZGVyX2FwcGVuZDMocmVjb3JkZXJfaW5mbyAqcmVj
LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjaGFyICp3aGVyZSwKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hhciAqZm9ybWF0LAorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICB1aW50cHRyX3QgYTAsCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHVpbnRwdHJfdCBhMSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludHB0cl90
IGEyLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50cHRyX3QgYTMsCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHVpbnRwdHJfdCBhNCwKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgdWludHB0cl90IGE1LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50
cHRyX3QgYTYsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnRwdHJfdCBhNywKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludHB0cl90IGE4LAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB1aW50cHRyX3QgYTksCisgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHVpbnRwdHJfdCBhMTAsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnRwdHJfdCBh
MTEpOworCisvLy8gQWN0aXZhdGUgYSByZWNvcmRlciAoZHVyaW5nIGNvbnN0cnVjdGlvbiB0aW1l
KQorZXh0ZXJuIHZvaWQgcmVjb3JkZXJfYWN0aXZhdGUocmVjb3JkZXJfaW5mbyAqcmVjb3JkZXIp
OworCisvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09CisvLworLy8gICAgRGVjbGFyYXRpb24gb2YgcmVj
b3JkZXJzIGFuZCB0d2Vha3MKKy8vCisvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CisKKyNkZWZpbmUg
UkVDT1JERVJfREVDTEFSRShOYW1lKSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIFwKKy8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0qLyAgIFwKKy8qICBEZWNsYXJlIGEgcmVjb3JkZXIgd2l0aCB0
aGUgZ2l2ZW4gbmFtZSAoZm9yIHVzZSBpbiBoZWFkZXJzKSAgICAqLyAgIFwKKy8qIC0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0q
LyAgIFwKKyAgICBleHRlcm4gcmVjb3JkZXJfaW5mbyAqIGNvbnN0IHJlY29yZGVyX2luZm9fcHRy
X2Zvcl8jI05hbWU7ICAgICAgICAgIFwKKyAgICBleHRlcm4gc3RydWN0IHJlY29yZGVyX2luZm9f
Zm9yXyMjTmFtZSByZWNvcmRlcl9pbmZvX2Zvcl8jI05hbWUKKworCisvLyA9PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09CisvLworLy8gICAgRGVmaW5pdGlvbiBvZiByZWNvcmRlcnMgYW5kIHR3ZWFrcworLy8K
Ky8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT0KKworI2RlZmluZSBSRUNPUkRFUihOYW1lLCBTaXplLCBJ
bmZvKSAgICAgIFJFQ09SREVSX0RFRklORShOYW1lLFNpemUsSW5mbykKKworI2RlZmluZSBSRUNP
UkRFUl9ERUZJTkUoTmFtZSwgU2l6ZSwgSW5mbykgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgXAorLyohLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLSovICAgXAorLyohIERlZmluZSBhIHJlY29yZGVyIHR5cGUgd2l0aCBT
aXplIGVsZW1lbnRzICAgICAgICAgICAgICAgICAgICAgICovICAgXAorLyohLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovICAg
XAorLyohIFxwYXJhbSBOYW1lIGlzIHRoZSBDIG5hbWUgZm8gdGhlIHJlY29yZGVyLiAgICAgICAg
ICAgICAgICAgICAgICAgICAgXAorICohIFxwYXJhbSBTaXplIGlzIHRoZSBudW1iZXIgb2YgZW50
cmllcyBpbiB0aGUgY2lyY3VsYXIgYnVmZmVyLiAgICAgICAgXAorICohIFxwYXJhbSBJbmZvIGlz
IGEgZGVzY3JpcHRpb24gb2YgdGhlIHJlY29yZGVyIGZvciBoZWxwLiAqLyAgICAgICAgICAgXAor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgXAorLyogVGhlIGVudHJ5IGluIGxpbmtlZCBsaXN0IGZvciB0aGlzIHR5
cGUgKi8gICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorc3RydWN0IHJlY29yZGVyX2luZm9f
Zm9yXyMjTmFtZSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAoreyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgXAorICAgIHJlY29yZGVyX2luZm8gICAgICAgaW5mbzsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgIHJlY29yZGVyX2VudHJ5ICAgICAg
ZGF0YVtTaXplXTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorfSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgXAorcmVjb3JkZXJfaW5mb19mb3JfIyNOYW1lID0gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgXAoreyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgIHsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgXAorICAgICAgICAwLCAjTmFtZSwgSW5mbywge30gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgIH0sICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgIHt9ICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgXAorfTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgXAorcmVjb3JkZXJfaW5mbyAqIGNvbnN0IHJlY29yZGVyX2lu
Zm9fcHRyX2Zvcl8jI05hbWUgPSAgICAgICAgICAgICAgICAgICAgXAorICAgICZyZWNvcmRlcl9p
bmZvX2Zvcl8jI05hbWUuaW5mbzsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
XAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgXAorUkVDT1JERVJfQ09OU1RSVUNUT1IgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorc3RhdGljIHZvaWQgcmVjb3Jk
ZXJfYWN0aXZhdGVfIyNOYW1lKHZvaWQpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAor
LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLSovICAgXAorLyogIEFjdGl2YXRlIHJlY29yZGVyIGJlZm9yZSBlbnRlcmluZyBt
YWluKCkgICAgICAgICAgICAgICAgICAgICAgICovICAgXAorLyogLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovICAgXAoreyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgXAorICAgIHJlY29yZGVyX2FjdGl2YXRlKFJFQ09SREVSX0lORk8oTmFtZSkp
OyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorfSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgXAorLyogUHVycG9zZWZ1bGx5IGdlbmVyYXRlIGNvbXBpbGUgZXJyb3IgaWYgbWFj
cm8gbm90IGZvbGxvd2VkIGJ5IDsgKi8gICAgXAorZXh0ZXJuIHZvaWQgcmVjb3JkZXJfYWN0aXZh
dGUocmVjb3JkZXJfaW5mbyAqcmVjb3JkZXIpCisKK3R5cGVkZWYgc3RydWN0IFNwaWNlRHVtbXlU
d2VhayB7CisgICAgaW50cHRyX3QgdHdlYWtfdmFsdWU7Cit9IFNwaWNlRHVtbXlUd2VhazsKKwor
dHlwZWRlZiBzdHJ1Y3QgU3BpY2VFbXB0eVN0cnVjdCB7CisgICAgY2hhciBkdW1teVswXTsKK30g
U3BpY2VFbXB0eVN0cnVjdDsKKworI2RlZmluZSBSRUNPUkRFUl9UV0VBS19ERUNMQVJFKHJlYykg
XAorICAgIGV4dGVybiBjb25zdCBTcGljZUR1bW15VHdlYWsgc3BpY2VfcmVjb3JkZXJfdHdlYWtf
ICMjIHJlYworCisjZGVmaW5lIFJFQ09SREVSX1RXRUFLX0RFRklORShyZWMsIHZhbHVlLCBjb21t
ZW50KSBcCisgICAgY29uc3QgU3BpY2VEdW1teVR3ZWFrIHNwaWNlX3JlY29yZGVyX3R3ZWFrXyAj
IyByZWMgPSB7ICh2YWx1ZSkgfQorCisjZGVmaW5lIFJFQ09SREVSX1RXRUFLKHJlYykgXAorICAg
ICgoc3BpY2VfcmVjb3JkZXJfdHdlYWtfICMjIHJlYykudHdlYWtfdmFsdWUpCisKKyNkZWZpbmUg
UkVDT1JERVJfVFJBQ0UocmVjKSBcCisgICAgKHNpemVvZihzdHJ1Y3QgcmVjb3JkZXJfaW5mb19m
b3JfICMjIHJlYykgIT0gc2l6ZW9mKFNwaWNlRW1wdHlTdHJ1Y3QpKQorCisKKy8vID09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT0KKy8vCisvLyAgICBBY2Nlc3MgdG8gcmVjb3JkZXIgYW5kIHR3ZWFrIGluZm8K
Ky8vCisvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09CisKKyNkZWZpbmUgUkVDT1JERVJfSU5GTyhOYW1l
KSAgICAgKHJlY29yZGVyX2luZm9fcHRyX2Zvcl8jI05hbWUpCisKKy8vID09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT0KKy8vCisvLyAgICBSZWNvcmRpbmcgc3R1ZmYKKy8vCisvLyA9PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09CisKKyNkZWZpbmUgcmVjb3JkKE5hbWUsIC4uLikgICAgICAgICAgICAgICBSRUNPUkRfTUFD
Uk8oTmFtZSwgX19WQV9BUkdTX18pCisjZGVmaW5lIFJFQ09SRChOYW1lLC4uLikgICAgICAgICAg
ICAgICAgUkVDT1JEX01BQ1JPKE5hbWUsIF9fVkFfQVJHU19fKQorI2RlZmluZSBSRUNPUkRfTUFD
Uk8oTmFtZSwgRm9ybWF0LC4uLikgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAor
ICAgIFJFQ09SRF8oUkVDT1JELFJFQ09SRF9DT1VOVF8oX19WQV9BUkdTX18pLE5hbWUsRm9ybWF0
LCMjX19WQV9BUkdTX18pCisjZGVmaW5lIFJFQ09SRF8oUkVDT1JELFJDT1VOVCxOYW1lLEZvcm1h
dCwuLi4pICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgUkVDT1JEX18oUkVDT1JELFJD
T1VOVCxOYW1lLEZvcm1hdCwjIyBfX1ZBX0FSR1NfXykKKyNkZWZpbmUgUkVDT1JEX18oUkVDT1JE
LFJDT1VOVCxOYW1lLEZvcm1hdCwuLi4pICAgICAgICAgICAgICAgICAgICAgICAgIFwKKyAgICBS
RUNPUkQjI1JDT1VOVChOYW1lLEZvcm1hdCwjI19fVkFfQVJHU19fKQorI2RlZmluZSBSRUNPUkRf
Q09VTlRfKC4uLikgICAgICBSRUNPUkRfQ09VTlRfXyhEdW1teSwjI19fVkFfQVJHU19fLF9YLF9Y
LF8xMixfMTEsXzEwLF85LF84LF83LF82LF81LF80LF8zLF8yLF8xLF8wKQorI2RlZmluZSBSRUNP
UkRfQ09VTlRfXyhEdW1teSxfMCxfMSxfMixfMyxfNCxfNSxfNixfNyxfOCxfOSxfMTAsXzExLF8x
MixfMTMsX04sLi4uKSAgICAgIF9OCisKKyNkZWZpbmUgUkVDT1JEXzAoTmFtZSwgRm9ybWF0KSAg
ICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgIHJlY29yZGVyX2FwcGVuZChSRUNPUkRFUl9J
TkZPKE5hbWUpLCAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgIFJFQ09SREVS
X1NPVVJDRV9GVU5DVElPTiwgICAgICAgICAgIFwKKyAgICAgICAgICAgICAgICAgICAgUkVDT1JE
RVJfU09VUkNFX0xPQ0FUSU9OICAgICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICBGb3Jt
YXQsIDAsIDAsIDAsIDApCisjZGVmaW5lIFJFQ09SRF8xKE5hbWUsIEZvcm1hdCwgYSkgICAgICAg
ICAgICAgICAgICAgICAgIFwKKyAgICByZWNvcmRlcl9hcHBlbmQoUkVDT1JERVJfSU5GTyhOYW1l
KSwgICAgICAgICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICBSRUNPUkRFUl9TT1VSQ0Vf
RlVOQ1RJT04sICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgIFJFQ09SREVSX1NPVVJD
RV9MT0NBVElPTiAgICAgICAgICAgIFwKKyAgICAgICAgICAgICAgICAgICAgRm9ybWF0LCAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICBSRUNPUkRFUl9B
UkcoYSksIDAsIDAsIDApCisjZGVmaW5lIFJFQ09SRF8yKE5hbWUsIEZvcm1hdCwgYSxiKSAgICAg
ICAgICAgICAgICAgICAgIFwKKyAgICByZWNvcmRlcl9hcHBlbmQoUkVDT1JERVJfSU5GTyhOYW1l
KSwgICAgICAgICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICBSRUNPUkRFUl9TT1VSQ0Vf
RlVOQ1RJT04sICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgIFJFQ09SREVSX1NPVVJD
RV9MT0NBVElPTiAgICAgICAgICAgIFwKKyAgICAgICAgICAgICAgICAgICAgRm9ybWF0LCAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICBSRUNPUkRFUl9B
UkcoYSksICAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgIFJFQ09SREVS
X0FSRyhiKSwgMCwgMCkKKyNkZWZpbmUgUkVDT1JEXzMoTmFtZSwgRm9ybWF0LCBhLGIsYykgICAg
ICAgICAgICAgICAgICAgXAorICAgIHJlY29yZGVyX2FwcGVuZChSRUNPUkRFUl9JTkZPKE5hbWUp
LCAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgIFJFQ09SREVSX1NPVVJDRV9G
VU5DVElPTiwgICAgICAgICAgIFwKKyAgICAgICAgICAgICAgICAgICAgUkVDT1JERVJfU09VUkNF
X0xPQ0FUSU9OICAgICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICBGb3JtYXQsICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgIFJFQ09SREVSX0FS
RyhhKSwgICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgICAgICAgICAgICAgUkVDT1JERVJf
QVJHKGIpLCAgICAgICAgICAgICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICBSRUNPUkRF
Ul9BUkcoYyksIDApCisjZGVmaW5lIFJFQ09SRF80KE5hbWUsIEZvcm1hdCwgYSxiLGMsZCkgICAg
ICAgICAgICAgICAgIFwKKyAgICByZWNvcmRlcl9hcHBlbmQoUkVDT1JERVJfSU5GTyhOYW1lKSwg
ICAgICAgICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICBSRUNPUkRFUl9TT1VSQ0VfRlVO
Q1RJT04sICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgIFJFQ09SREVSX1NPVVJDRV9M
T0NBVElPTiAgICAgICAgICAgIFwKKyAgICAgICAgICAgICAgICAgICAgRm9ybWF0LCAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICBSRUNPUkRFUl9BUkco
YSksICAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgIFJFQ09SREVSX0FS
RyhiKSwgICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgICAgICAgICAgICAgUkVDT1JERVJf
QVJHKGMpLCAgICAgICAgICAgICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICBSRUNPUkRF
Ul9BUkcoZCkpCisjZGVmaW5lIFJFQ09SRF81KE5hbWUsIEZvcm1hdCwgYSxiLGMsZCxlKSAgICAg
ICAgICAgICAgIFwKKyAgICByZWNvcmRlcl9hcHBlbmQyKFJFQ09SREVSX0lORk8oTmFtZSksICAg
ICAgICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICAgUkVDT1JERVJfU09VUkNFX0ZVTkNU
SU9OLCAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgICBSRUNPUkRFUl9TT1VSQ0VfTE9D
QVRJT04gICAgICAgICAgIFwKKyAgICAgICAgICAgICAgICAgICAgIEZvcm1hdCwgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICAgUkVDT1JERVJfQVJHKGEp
LCAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgICBSRUNPUkRFUl9BUkco
YiksICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgICAgICAgICAgICAgIFJFQ09SREVSX0FS
RyhjKSwgICAgICAgICAgICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICAgUkVDT1JERVJf
QVJHKGQpLCAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgICBSRUNPUkRF
Ul9BUkcoZSksIDAsIDAsIDApCisjZGVmaW5lIFJFQ09SRF82KE5hbWUsIEZvcm1hdCwgYSxiLGMs
ZCxlLGYpICAgICAgICAgICAgIFwKKyAgICByZWNvcmRlcl9hcHBlbmQyKFJFQ09SREVSX0lORk8o
TmFtZSksICAgICAgICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICAgUkVDT1JERVJfU09V
UkNFX0ZVTkNUSU9OLCAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgICBSRUNPUkRFUl9T
T1VSQ0VfTE9DQVRJT04gICAgICAgICAgIFwKKyAgICAgICAgICAgICAgICAgICAgIEZvcm1hdCwg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICAgUkVDT1JE
RVJfQVJHKGEpLCAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgICBSRUNP
UkRFUl9BUkcoYiksICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgICAgICAgICAgICAgIFJF
Q09SREVSX0FSRyhjKSwgICAgICAgICAgICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICAg
UkVDT1JERVJfQVJHKGQpLCAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAg
ICBSRUNPUkRFUl9BUkcoZSksICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgICAgICAgICAg
ICAgIFJFQ09SREVSX0FSRyhmKSwgMCwgMCkKKyNkZWZpbmUgUkVDT1JEXzcoTmFtZSwgRm9ybWF0
LCBhLGIsYyxkLGUsZixnKSAgICAgICAgICAgXAorICAgIHJlY29yZGVyX2FwcGVuZDIoUkVDT1JE
RVJfSU5GTyhOYW1lKSwgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgICBSRUNP
UkRFUl9TT1VSQ0VfRlVOQ1RJT04sICAgICAgICAgIFwKKyAgICAgICAgICAgICAgICAgICAgIFJF
Q09SREVSX1NPVVJDRV9MT0NBVElPTiAgICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICAg
Rm9ybWF0LCAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAg
ICBSRUNPUkRFUl9BUkcoYSksICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgICAgICAgICAg
ICAgIFJFQ09SREVSX0FSRyhiKSwgICAgICAgICAgICAgICAgICAgXAorICAgICAgICAgICAgICAg
ICAgICAgUkVDT1JERVJfQVJHKGMpLCAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAg
ICAgICAgICBSRUNPUkRFUl9BUkcoZCksICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgICAg
ICAgICAgICAgIFJFQ09SREVSX0FSRyhlKSwgICAgICAgICAgICAgICAgICAgXAorICAgICAgICAg
ICAgICAgICAgICAgUkVDT1JERVJfQVJHKGYpLCAgICAgICAgICAgICAgICAgICBcCisgICAgICAg
ICAgICAgICAgICAgICBSRUNPUkRFUl9BUkcoZyksIDApCisjZGVmaW5lIFJFQ09SRF84KE5hbWUs
IEZvcm1hdCwgYSxiLGMsZCxlLGYsZyxoKSAgICAgICAgIFwKKyAgICByZWNvcmRlcl9hcHBlbmQy
KFJFQ09SREVSX0lORk8oTmFtZSksICAgICAgICAgICAgICAgXAorICAgICAgICAgICAgICAgICAg
ICAgUkVDT1JERVJfU09VUkNFX0ZVTkNUSU9OLCAgICAgICAgICBcCisgICAgICAgICAgICAgICAg
ICAgICBSRUNPUkRFUl9TT1VSQ0VfTE9DQVRJT04gICAgICAgICAgIFwKKyAgICAgICAgICAgICAg
ICAgICAgIEZvcm1hdCwgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgICAgICAgICAg
ICAgICAgICAgUkVDT1JERVJfQVJHKGEpLCAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAg
ICAgICAgICAgICBSRUNPUkRFUl9BUkcoYiksICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAg
ICAgICAgICAgICAgIFJFQ09SREVSX0FSRyhjKSwgICAgICAgICAgICAgICAgICAgXAorICAgICAg
ICAgICAgICAgICAgICAgUkVDT1JERVJfQVJHKGQpLCAgICAgICAgICAgICAgICAgICBcCisgICAg
ICAgICAgICAgICAgICAgICBSRUNPUkRFUl9BUkcoZSksICAgICAgICAgICAgICAgICAgIFwKKyAg
ICAgICAgICAgICAgICAgICAgIFJFQ09SREVSX0FSRyhmKSwgICAgICAgICAgICAgICAgICAgXAor
ICAgICAgICAgICAgICAgICAgICAgUkVDT1JERVJfQVJHKGcpLCAgICAgICAgICAgICAgICAgICBc
CisgICAgICAgICAgICAgICAgICAgICBSRUNPUkRFUl9BUkcoaCkpCisjZGVmaW5lIFJFQ09SRF85
KE5hbWUsIEZvcm1hdCwgYSxiLGMsZCxlLGYsZyxoLGkpICAgICAgIFwKKyAgICByZWNvcmRlcl9h
cHBlbmQzKFJFQ09SREVSX0lORk8oTmFtZSksICAgICAgICAgICAgICAgXAorICAgICAgICAgICAg
ICAgICAgICAgUkVDT1JERVJfU09VUkNFX0ZVTkNUSU9OLCAgICAgICAgICBcCisgICAgICAgICAg
ICAgICAgICAgICBSRUNPUkRFUl9TT1VSQ0VfTE9DQVRJT04gICAgICAgICAgIFwKKyAgICAgICAg
ICAgICAgICAgICAgIEZvcm1hdCwgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgICAg
ICAgICAgICAgICAgICAgUkVDT1JERVJfQVJHKGEpLCAgICAgICAgICAgICAgICAgICBcCisgICAg
ICAgICAgICAgICAgICAgICBSRUNPUkRFUl9BUkcoYiksICAgICAgICAgICAgICAgICAgIFwKKyAg
ICAgICAgICAgICAgICAgICAgIFJFQ09SREVSX0FSRyhjKSwgICAgICAgICAgICAgICAgICAgXAor
ICAgICAgICAgICAgICAgICAgICAgUkVDT1JERVJfQVJHKGQpLCAgICAgICAgICAgICAgICAgICBc
CisgICAgICAgICAgICAgICAgICAgICBSRUNPUkRFUl9BUkcoZSksICAgICAgICAgICAgICAgICAg
IFwKKyAgICAgICAgICAgICAgICAgICAgIFJFQ09SREVSX0FSRyhmKSwgICAgICAgICAgICAgICAg
ICAgXAorICAgICAgICAgICAgICAgICAgICAgUkVDT1JERVJfQVJHKGcpLCAgICAgICAgICAgICAg
ICAgICBcCisgICAgICAgICAgICAgICAgICAgICBSRUNPUkRFUl9BUkcoaCksICAgICAgICAgICAg
ICAgICAgIFwKKyAgICAgICAgICAgICAgICAgICAgIFJFQ09SREVSX0FSRyhpKSwgMCwwLDApCisj
ZGVmaW5lIFJFQ09SRF8xMChOYW1lLCBGb3JtYXQsIGEsYixjLGQsZSxmLGcsaCxpLGopICAgIFwK
KyAgICByZWNvcmRlcl9hcHBlbmQzKFJFQ09SREVSX0lORk8oTmFtZSksICAgICAgICAgICAgICAg
XAorICAgICAgICAgICAgICAgICAgICAgUkVDT1JERVJfU09VUkNFX0ZVTkNUSU9OLCAgICAgICAg
ICBcCisgICAgICAgICAgICAgICAgICAgICBSRUNPUkRFUl9TT1VSQ0VfTE9DQVRJT04gICAgICAg
ICAgIFwKKyAgICAgICAgICAgICAgICAgICAgIEZvcm1hdCwgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgXAorICAgICAgICAgICAgICAgICAgICAgUkVDT1JERVJfQVJHKGEpLCAgICAgICAgICAg
ICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgICBSRUNPUkRFUl9BUkcoYiksICAgICAgICAg
ICAgICAgICAgIFwKKyAgICAgICAgICAgICAgICAgICAgIFJFQ09SREVSX0FSRyhjKSwgICAgICAg
ICAgICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICAgUkVDT1JERVJfQVJHKGQpLCAgICAg
ICAgICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgICBSRUNPUkRFUl9BUkcoZSksICAg
ICAgICAgICAgICAgICAgIFwKKyAgICAgICAgICAgICAgICAgICAgIFJFQ09SREVSX0FSRyhmKSwg
ICAgICAgICAgICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICAgUkVDT1JERVJfQVJHKGcp
LCAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgICBSRUNPUkRFUl9BUkco
aCksICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgICAgICAgICAgICAgIFJFQ09SREVSX0FS
RyhpKSwgICAgICAgICAgICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICAgUkVDT1JERVJf
QVJHKGopLCAwLDApCisjZGVmaW5lIFJFQ09SRF8xMShOYW1lLCBGb3JtYXQsIGEsYixjLGQsZSxm
LGcsaCxpLGosaykgIFwKKyAgICByZWNvcmRlcl9hcHBlbmQzKFJFQ09SREVSX0lORk8oTmFtZSks
ICAgICAgICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICAgUkVDT1JERVJfU09VUkNFX0ZV
TkNUSU9OLCAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgICBSRUNPUkRFUl9TT1VSQ0Vf
TE9DQVRJT04gICAgICAgICAgIFwKKyAgICAgICAgICAgICAgICAgICAgIEZvcm1hdCwgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICAgUkVDT1JERVJfQVJH
KGEpLCAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgICBSRUNPUkRFUl9B
UkcoYiksICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgICAgICAgICAgICAgIFJFQ09SREVS
X0FSRyhjKSwgICAgICAgICAgICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICAgUkVDT1JE
RVJfQVJHKGQpLCAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgICBSRUNP
UkRFUl9BUkcoZSksICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgICAgICAgICAgICAgIFJF
Q09SREVSX0FSRyhmKSwgICAgICAgICAgICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICAg
UkVDT1JERVJfQVJHKGcpLCAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAg
ICBSRUNPUkRFUl9BUkcoaCksICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgICAgICAgICAg
ICAgIFJFQ09SREVSX0FSRyhpKSwgICAgICAgICAgICAgICAgICAgXAorICAgICAgICAgICAgICAg
ICAgICAgUkVDT1JERVJfQVJHKGopLCAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAg
ICAgICAgICBSRUNPUkRFUl9BUkcoayksMCkKKyNkZWZpbmUgUkVDT1JEXzEyKE5hbWUsRm9ybWF0
LGEsYixjLGQsZSxmLGcsaCxpLGosayxsKSAgXAorICAgIHJlY29yZGVyX2FwcGVuZDMoUkVDT1JE
RVJfSU5GTyhOYW1lKSwgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgICBSRUNP
UkRFUl9TT1VSQ0VfRlVOQ1RJT04sICAgICAgICAgIFwKKyAgICAgICAgICAgICAgICAgICAgIFJF
Q09SREVSX1NPVVJDRV9MT0NBVElPTiAgICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICAg
Rm9ybWF0LCAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAg
ICBSRUNPUkRFUl9BUkcoYSksICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgICAgICAgICAg
ICAgIFJFQ09SREVSX0FSRyhiKSwgICAgICAgICAgICAgICAgICAgXAorICAgICAgICAgICAgICAg
ICAgICAgUkVDT1JERVJfQVJHKGMpLCAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAg
ICAgICAgICBSRUNPUkRFUl9BUkcoZCksICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgICAg
ICAgICAgICAgIFJFQ09SREVSX0FSRyhlKSwgICAgICAgICAgICAgICAgICAgXAorICAgICAgICAg
ICAgICAgICAgICAgUkVDT1JERVJfQVJHKGYpLCAgICAgICAgICAgICAgICAgICBcCisgICAgICAg
ICAgICAgICAgICAgICBSRUNPUkRFUl9BUkcoZyksICAgICAgICAgICAgICAgICAgIFwKKyAgICAg
ICAgICAgICAgICAgICAgIFJFQ09SREVSX0FSRyhoKSwgICAgICAgICAgICAgICAgICAgXAorICAg
ICAgICAgICAgICAgICAgICAgUkVDT1JERVJfQVJHKGkpLCAgICAgICAgICAgICAgICAgICBcCisg
ICAgICAgICAgICAgICAgICAgICBSRUNPUkRFUl9BUkcoaiksICAgICAgICAgICAgICAgICAgIFwK
KyAgICAgICAgICAgICAgICAgICAgIFJFQ09SREVSX0FSRyhrKSwgICAgICAgICAgICAgICAgICAg
XAorICAgICAgICAgICAgICAgICAgICAgUkVDT1JERVJfQVJHKGwpKQorI2RlZmluZSBSRUNPUkRf
WChOYW1lLCBGb3JtYXQsIC4uLikgICBSRUNPUkRfVE9PX01BTllfQVJHUyhwcmludGYoRm9ybWF0
LCBfX1ZBX0FSR1NfXykpCisKKworLy8gU29tZSB1Z2x5IG1hY3JvIGRydWRnZXJ5IHRvIG1ha2Ug
dGhpbmdzIGVhc3kgdG8gdXNlLiBBZGp1c3QgdHlwZS4KKyNpZmRlZiBfX2NwbHVzcGx1cworI2Rl
ZmluZSBSRUNPUkRFUl9BUkcoYXJnKSAgICAgICBfcmVjb3JkZXJfYXJnKGFyZykKKyNlbHNlIC8v
ICFfX2NwbHVzcGx1cworCisjaWYgZGVmaW5lZChfX0dOVUNfXykgJiYgIWRlZmluZWQoX19jbGFu
Z19fKQorIyAgaWYgX19HTlVDX18gPD0gNCB8fCAoX19HTlVDX18gPT0gNCAmJiBfX0dOVUNfTUlO
T1JfXyA8IDkpCisjICAgIGRlZmluZSBSRUNPUkRFUl9XSVRIT1VUX0dFTkVSSUMKKyMgIGVuZGlm
CisjZW5kaWYgLy8gX19HTlVDX18KKworI2lmZGVmIFJFQ09SREVSX1dJVEhPVVRfR0VORVJJQwor
I2RlZmluZSBSRUNPUkRFUl9BUkcoYXJnKSAoKHVpbnRwdHJfdCkgKGFyZykpCisjZWxzZSAvLyAh
UkVDT1JERVJfV0lUSE9VVF9HRU5FUklDCisjZGVmaW5lIFJFQ09SREVSX0FSRyhhcmcpICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIFwKKyAgICBfR2VuZXJpYyhhcmcsICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgICAgICAgICAgIHVuc2lnbmVkIGNoYXI6
ICAgICBfcmVjb3JkZXJfdW5zaWduZWQsICAgICBcCisgICAgICAgICAgICAgdW5zaWduZWQgc2hv
cnQ6ICAgIF9yZWNvcmRlcl91bnNpZ25lZCwgICAgIFwKKyAgICAgICAgICAgICB1bnNpZ25lZDog
ICAgICAgICAgX3JlY29yZGVyX3Vuc2lnbmVkLCAgICAgXAorICAgICAgICAgICAgIHVuc2lnbmVk
IGxvbmc6ICAgICBfcmVjb3JkZXJfdW5zaWduZWQsICAgICBcCisgICAgICAgICAgICAgdW5zaWdu
ZWQgbG9uZyBsb25nOl9yZWNvcmRlcl91bnNpZ25lZCwgICAgIFwKKyAgICAgICAgICAgICBjaGFy
OiAgICAgICAgICAgICAgX3JlY29yZGVyX2NoYXIsICAgICAgICAgXAorICAgICAgICAgICAgIHNp
Z25lZCBjaGFyOiAgICAgICBfcmVjb3JkZXJfc2lnbmVkLCAgICAgICBcCisgICAgICAgICAgICAg
c2lnbmVkIHNob3J0OiAgICAgIF9yZWNvcmRlcl9zaWduZWQsICAgICAgIFwKKyAgICAgICAgICAg
ICBzaWduZWQ6ICAgICAgICAgICAgX3JlY29yZGVyX3NpZ25lZCwgICAgICAgXAorICAgICAgICAg
ICAgIHNpZ25lZCBsb25nOiAgICAgICBfcmVjb3JkZXJfc2lnbmVkLCAgICAgICBcCisgICAgICAg
ICAgICAgc2lnbmVkIGxvbmcgbG9uZzogIF9yZWNvcmRlcl9zaWduZWQsICAgICAgIFwKKyAgICAg
ICAgICAgICBmbG9hdDogICAgICAgICAgICAgX3JlY29yZGVyX2Zsb2F0LCAgICAgICAgXAorICAg
ICAgICAgICAgIGRvdWJsZTogICAgICAgICAgICBfcmVjb3JkZXJfZG91YmxlLCAgICAgICBcCisg
ICAgICAgICAgICAgZGVmYXVsdDogICAgICAgICAgIF9yZWNvcmRlcl9wb2ludGVyKShhcmcpCisj
ZW5kaWYgLy8gUkVDT1JERVJfV0lUSE9VVF9HRU5FUklDCisjZW5kaWYgLy8gX19jcGx1c3BsdXMK
KworLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PQorLy8KKy8vICAgIFRpbWluZyBpbmZvcm1hdGlvbgor
Ly8KKy8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT0KKworI2RlZmluZSBSRUNPUkRfVElNSU5HX0JFR0lO
KHJlYykgXAorICAgIGRvIHsgUkVDT1JEKHJlYywgImJlZ2luIik7CisjZGVmaW5lIFJFQ09SRF9U
SU1JTkdfRU5EKHJlYywgb3AsIG5hbWUsIHZhbHVlKSBcCisgICAgICAgIFJFQ09SRChyZWMsICJl
bmQiIG9wIG5hbWUpOyBcCisgICAgfSB3aGlsZSAoMCkKKworCisvLyA9PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09CisvLworLy8gICBTdXBwb3J0IG1hY3JvcworLy8KKy8vID09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0K
KworI2RlZmluZSBSRUNPUkRFUl9TT1VSQ0VfRlVOQ1RJT04gICAgX19mdW5jX18gLyogV29ya3Mg
aW4gQzk5IGFuZCBDKysxMSAqLworI2RlZmluZSBSRUNPUkRFUl9TT1VSQ0VfTE9DQVRJT04gICAg
X19GSUxFX18gIjoiIFJFQ09SREVSX1NUUklORyhfX0xJTkVfXykgIjoiCisjZGVmaW5lIFJFQ09S
REVSX1NUUklORyhMSU5FKSAgICAgICBSRUNPUkRFUl9TVFJJTkdfKExJTkUpCisjZGVmaW5lIFJF
Q09SREVSX1NUUklOR18oTElORSkgICAgICAjTElORQorCisjaWZkZWYgX19HTlVDX18KKyNkZWZp
bmUgUkVDT1JERVJfQ09OU1RSVUNUT1IgICAgICAgICAgICBfX2F0dHJpYnV0ZV9fKChjb25zdHJ1
Y3RvcikpCisjZWxzZQorI2RlZmluZSBSRUNPUkRFUl9DT05TVFJVQ1RPUgorI2VuZGlmCisKKyNp
ZmRlZiBfX2NwbHVzcGx1cworfQorI2VuZGlmIC8vIF9fY3BsdXNwbHVzCisKKy8vID09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT0KKy8vCisvLyAgICBVdGlsaXR5OiBDb252ZXJ0IGZsb2F0aW5nIHBvaW50IHZh
bHVlcyBmb3IgdmFyYXJnIGZvcm1hdAorLy8KKy8vID09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KKy8vCisv
LyAgIFRoZSByZWNvcmRlciBzdG9yZXMgb25seSB1aW50cHRyX3QgaW4gcmVjb3JkZXIgZW50cmll
cy4gSW50ZWdlciB0eXBlcworLy8gICBhcmUgcHJvbW90ZWQsIHBvaW50ZXIgdHlwZXMgYXJlIGNv
bnZlcnRlZC4gRmxvYXRpbmcgcG9pbnQgdmFsdWVzCisvLyAgIGFyZSBjb252ZXJ0ZWQgYSBmbG9h
dGluZyBwb2ludCB0eXBlIG9mIHRoZSBzYW1lIHNpemUgYXMgdWludHB0cl90LAorLy8gICBpLmUu
IGZsb2F0IGFyZSBjb252ZXJ0ZWQgdG8gZG91YmxlIG9uIDY0LWJpdCBwbGF0Zm9ybXMsIGFuZCBj
b252ZXJzZWx5LgorCisjaWZkZWYgX19jcGx1c3BsdXMKKyNpbmNsdWRlIDxzdHJpbmc+CisKKy8v
IEluIEMrKywgd2UgZG9uJ3QgdXNlIF9HZW5lcmljIGJ1dCBhY3R1YWwgb3ZlcmxvYWRpbmcKK3Rl
bXBsYXRlIDxjbGFzcyBpbnR0eXBlPgorc3RhdGljIGlubGluZSB1aW50cHRyX3QgICAgICAgICBf
cmVjb3JkZXJfYXJnKGludHR5cGUgaSkKK3sKKyAgICByZXR1cm4gKHVpbnRwdHJfdCkgaTsKK30K
KworCitzdGF0aWMgaW5saW5lIHVpbnRwdHJfdCAgICAgICAgIF9yZWNvcmRlcl9hcmcoY29uc3Qg
c3RkOjpzdHJpbmcgJmFyZykKK3sKKyAgICByZXR1cm4gKHVpbnRwdHJfdCkgYXJnLmNfc3RyKCk7
Cit9CisjZGVmaW5lIF9yZWNvcmRlcl9mbG9hdCAgICAgICAgIF9yZWNvcmRlcl9hcmcKKyNkZWZp
bmUgX3JlY29yZGVyX2RvdWJsZSAgICAgICAgX3JlY29yZGVyX2FyZworCisjZWxzZSAvLyAhX19j
cGx1c3BsdXMKKworc3RhdGljIGlubGluZSB1aW50cHRyX3QgX3JlY29yZGVyX2NoYXIoY2hhciBj
KQorLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQorLy8gICBOZWNlc3NhcnkgYmVjYXVzZSBvZiB0aGUg
d2F5IGdlbmVyaWMgc2VsZWN0aW9ucyB3b3JrCisvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCit7Cisg
ICAgcmV0dXJuIGM7Cit9CisKKworc3RhdGljIGlubGluZSB1aW50cHRyX3QgX3JlY29yZGVyX3Vu
c2lnbmVkKHVpbnRwdHJfdCBpKQorLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQorLy8gICBOZWNlc3Nh
cnkgYmVjYXVzZSBvZiB0aGUgd2F5IGdlbmVyaWMgc2VsZWN0aW9ucyB3b3JrCisvLyAtLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tCit7CisgICAgcmV0dXJuIGk7Cit9CisKKworc3RhdGljIGlubGluZSB1aW50
cHRyX3QgX3JlY29yZGVyX3NpZ25lZChpbnRwdHJfdCBpKQorLy8gLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LQorLy8gICBOZWNlc3NhcnkgYmVjYXVzZSBvZiB0aGUgd2F5IGdlbmVyaWMgc2VsZWN0aW9ucyB3
b3JrCisvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCit7CisgICAgcmV0dXJuICh1aW50cHRyX3QpIGk7
Cit9CisKKworc3RhdGljIGlubGluZSB1aW50cHRyX3QgX3JlY29yZGVyX3BvaW50ZXIoY29uc3Qg
dm9pZCAqaSkKKy8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKy8vICAgTmVjZXNzYXJ5IGJlY2F1c2Ug
b2YgdGhlIHdheSBnZW5lcmljIHNlbGVjdGlvbnMgd29yaworLy8gLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LQoreworICAgIHJldHVybiAodWludHB0cl90KSBpOworfQorCisjZW5kaWYgLy8gX19jcGx1c3Bs
dXMKKworCitzdGF0aWMgaW5saW5lIHVpbnRwdHJfdCBfcmVjb3JkZXJfZmxvYXQoZmxvYXQgZikK
Ky8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKy8vICAgQ29udmVydCBmbG9hdGluZyBwb2ludCBudW1i
ZXIgdG8gaW50cHRyX3QgcmVwcmVzZW50YXRpb24gZm9yIHJlY29yZGVyCisvLyAtLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tCit7CisgICAgaWYgKHNpemVvZihmbG9hdCkgPT0gc2l6ZW9mKGludHB0cl90KSkg
eworICAgICAgICB1bmlvbiB7IGZsb2F0IGY7IHVpbnRwdHJfdCBpOyB9IHU7CisgICAgICAgIHUu
ZiA9IGY7CisgICAgICAgIHJldHVybiB1Lmk7CisgICAgfSBlbHNlIHsKKyAgICAgICAgdW5pb24g
eyBkb3VibGUgZDsgdWludHB0cl90IGk7IH0gdTsKKyAgICAgICAgdS5kID0gKGRvdWJsZSkgZjsK
KyAgICAgICAgcmV0dXJuIHUuaTsKKyAgICB9Cit9CisKKworc3RhdGljIGlubGluZSB1aW50cHRy
X3QgX3JlY29yZGVyX2RvdWJsZShkb3VibGUgZCkKKy8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKy8v
ICAgQ29udmVydCBkb3VibGUtcHJlY2lzaW9uIGZsb2F0aW5nIHBvaW50IG51bWJlciB0byBpbnRw
dHJfdCByZXByZXNlbnRhdGlvbgorLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoreworICAgIGlmIChz
aXplb2YoZG91YmxlKSA9PSBzaXplb2YoaW50cHRyX3QpKSB7CisgICAgICAgIHVuaW9uIHsgZG91
YmxlIGQ7IHVpbnRwdHJfdCBpOyB9IHU7CisgICAgICAgIHUuZCA9IGQ7CisgICAgICAgIHJldHVy
biB1Lmk7CisgICAgfSBlbHNlIHsKKyAgICAgICAgLy8gQmV0dGVyIHRvIGxvc2UgcHJlY2lzaW9u
IHRoYW4gbm90IHN0b3JlIGFueSBkYXRhCisgICAgICAgIHVuaW9uIHsgZmxvYXQgZjsgdWludHB0
cl90IGk7IH0gdTsKKyAgICAgICAgdS5mID0gZDsKKyAgICAgICAgcmV0dXJuIHUuaTsKKyAgICB9
Cit9CmRpZmYgLS1naXQgYS90ZXN0cy90ZXN0LWR1bW15LXJlY29yZGVyLmMgYi90ZXN0cy90ZXN0
LWR1bW15LXJlY29yZGVyLmMKaW5kZXggNGU2NzRhOS4uNWJlNGNiZCAxMDA2NDQKLS0tIGEvdGVz
dHMvdGVzdC1kdW1teS1yZWNvcmRlci5jCisrKyBiL3Rlc3RzL3Rlc3QtZHVtbXktcmVjb3JkZXIu
YwpAQCAtMTksNyArMTksOCBAQAogI2luY2x1ZGUgPGNvbmZpZy5oPgogI2luY2x1ZGUgPGFzc2Vy
dC5oPgoKLSN1bmRlZiBFTkFCTEVfUkVDT1JERVIKKyN1bmRlZiBFTkFCTEVfQzNEX1JFQ09SREVS
CisjdW5kZWYgRU5BQkxFX0FHRU5UX0lOVEVSRkFDRQoKICNpbmNsdWRlIDxjb21tb24vcmVjb3Jk
ZXIuaD4KCi0tCjIuMjEuMAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX18KU3BpY2UtZGV2ZWwgbWFpbGluZyBsaXN0ClNwaWNlLWRldmVsQGxpc3RzLmZyZWVk
ZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZv
L3NwaWNlLWRldmVs
