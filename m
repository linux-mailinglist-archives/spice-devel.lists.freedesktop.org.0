Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 160F472CAF
	for <lists+spice-devel@lfdr.de>; Wed, 24 Jul 2019 12:54:15 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 8C38D6E512;
	Wed, 24 Jul 2019 10:54:13 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mail-wr1-x42d.google.com (mail-wr1-x42d.google.com
 [IPv6:2a00:1450:4864:20::42d])
 by gabe.freedesktop.org (Postfix) with ESMTPS id B28BA6E512
 for <spice-devel@lists.freedesktop.org>; Wed, 24 Jul 2019 10:54:09 +0000 (UTC)
Received: by mail-wr1-x42d.google.com with SMTP id f9so46413760wre.12
 for <spice-devel@lists.freedesktop.org>; Wed, 24 Jul 2019 03:54:09 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references;
 bh=JgarokvpWy8bp0XYoM4SZfKGyhARVV1/lwreo75hUH4=;
 b=Rhak607LbMr70ZxdOa+mQf/av6YWEyz5o1IqAAABUhItPL4IJuAcAGjvl4QgjgPmPW
 D/Ju+Rash++C7/Qy8sDY5a9IVk9MhWCHDQBM4asYuLMcnXZo/vkpTkPPHFv7/RSqDbRd
 8Gf1gu6+IrwwT+MjC8M/e4WeqEET37eGu65cFTTgKBIqCb8ZqwDrQ68s6dWGtPWVzxEY
 9TIWcHGXQEbdMsi6IRszTTzBPiQ1pEE+qOnEof/J7O3Idm2Maa4oeMDtCFSGYtByDDyT
 UB/X8xSg1pJK7N2E3DY1nPSSEdi0PkdoPGn3jP+5sz3Y+VZ/VpO9JrTHgETlnvyKlJ8a
 rnhw==
X-Gm-Message-State: APjAAAU66wPrrbYuD1iS6XUqS1Bc8yMccJ9CFsdZwTRr2sAicMUUE2jP
 wh2DWYeTct40wd4njCGNarM2GTf3
X-Google-Smtp-Source: APXvYqwtbQ+GIC07xKae2oD7RL/r1mmEui0+5wOU7kuXNC0O+nZH8ou2x04DP1/sfM2m4lfTO6kN4g==
X-Received: by 2002:a5d:55c2:: with SMTP id i2mr50303692wrw.96.1563965646304; 
 Wed, 24 Jul 2019 03:54:06 -0700 (PDT)
Received: from f2.redhat.com (bzq-79-182-115-245.red.bezeqint.net.
 [79.182.115.245])
 by smtp.gmail.com with ESMTPSA id r12sm53542137wrt.95.2019.07.24.03.54.04
 (version=TLS1_2 cipher=ECDHE-RSA-CHACHA20-POLY1305 bits=256/256);
 Wed, 24 Jul 2019 03:54:05 -0700 (PDT)
From: Yuri Benditovich <yuri.benditovich@daynix.com>
To: spice-devel@lists.freedesktop.org
Date: Wed, 24 Jul 2019 13:53:49 +0300
Message-Id: <20190724105351.13753-8-yuri.benditovich@daynix.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20190724105351.13753-1-yuri.benditovich@daynix.com>
References: <20190724105351.13753-1-yuri.benditovich@daynix.com>
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=daynix-com.20150623.gappssmtp.com; s=20150623;
 h=from:to:cc:subject:date:message-id:in-reply-to:references;
 bh=JgarokvpWy8bp0XYoM4SZfKGyhARVV1/lwreo75hUH4=;
 b=XBXZjphsuWROnWDiz5WtG//HNvsNqERpAPh3/hC1b/iCFnUlBq627iU95FK/9yRnQ8
 P2Nu8YBPm498QBYxYlAJbCYVjfH6H8vYPGj9cSEaKhNKVzJMocotCvgO1Nl59sVjqQDC
 Ua2JViFiazpHHfSZSHA1cVPosNi6mObpauelvI7lkulK070EjNidC7ScXcaOpDrqSjK9
 5J5J8rE7cdNz0sFmio+G/M3OdfqnRhnzZowhhVdkxTmyRWPzLAmdlKaYtEzgEJ9ykoSa
 FaSaYVYAoBO1d6YuGGu9S6O0i/XIL9pC4YfI2S83g2EgXz+RA/dYTDqkyzAfdVJheGg8
 0AYg==
Subject: [Spice-devel] [spice-gtk 7/9] usb-redir: add files for SCSI and USB
 MSC implementation
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: yan@daynix.com
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

RmlsZXMgYWRkZWQgd2l0aG91dCBpbmNsdWRpbmcgdGhlbSBpbiBjb21waWxhdGlvbi4KVGhleSBj
b250YWluIGltcGxlbWVudGF0aW9uIG9mIFNDU0kgY29tbWFuZHMgZm9yIGxvZ2ljYWwKdW5pdHMg
b2YgbWFzcy1zdG9yYWdlIGRldmljZSBjbGFzcyBhbmQgVVNCIGJ1bGstb25seQptYXNzLXN0b3Jh
Z2UgZGV2aWNlIHByb3RvY29sLgoKU2lnbmVkLW9mZi1ieTogQWxleGFuZGVyIE5lemhpbnNreTxh
bmV6aGluc0ByZWRoYXQuY29tPgpTaWduZWQtb2ZmLWJ5OiBZdXJpIEJlbmRpdG92aWNoIDx5dXJp
LmJlbmRpdG92aWNoQGRheW5peC5jb20+Ci0tLQogc3JjL2NkLXNjc2ktZGV2LXBhcmFtcy5oIHwg
ICA1MiArCiBzcmMvY2Qtc2NzaS5jICAgICAgICAgICAgfCAyNzcwICsrKysrKysrKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysrCiBzcmMvY2Qtc2NzaS5oICAgICAgICAgICAgfCAgMTIyICsr
CiBzcmMvY2QtdXNiLWJ1bGstbXNkLmMgICAgfCAgNTU1ICsrKysrKysrCiBzcmMvY2QtdXNiLWJ1
bGstbXNkLmggICAgfCAgMTM0ICsrCiBzcmMvc2NzaS1jb25zdGFudHMuaCAgICAgfCAgMzI0ICsr
KysrCiA2IGZpbGVzIGNoYW5nZWQsIDM5NTcgaW5zZXJ0aW9ucygrKQogY3JlYXRlIG1vZGUgMTAw
NjQ0IHNyYy9jZC1zY3NpLWRldi1wYXJhbXMuaAogY3JlYXRlIG1vZGUgMTAwNjQ0IHNyYy9jZC1z
Y3NpLmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBzcmMvY2Qtc2NzaS5oCiBjcmVhdGUgbW9kZSAxMDA2
NDQgc3JjL2NkLXVzYi1idWxrLW1zZC5jCiBjcmVhdGUgbW9kZSAxMDA2NDQgc3JjL2NkLXVzYi1i
dWxrLW1zZC5oCiBjcmVhdGUgbW9kZSAxMDA2NDQgc3JjL3Njc2ktY29uc3RhbnRzLmgKCmRpZmYg
LS1naXQgYS9zcmMvY2Qtc2NzaS1kZXYtcGFyYW1zLmggYi9zcmMvY2Qtc2NzaS1kZXYtcGFyYW1z
LmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMC4uY2RkY2UwYQotLS0gL2Rldi9u
dWxsCisrKyBiL3NyYy9jZC1zY3NpLWRldi1wYXJhbXMuaApAQCAtMCwwICsxLDUyIEBACisvKiAt
Ki0gTW9kZTogQzsgYy1iYXNpYy1vZmZzZXQ6IDQ7IGluZGVudC10YWJzLW1vZGU6IG5pbCAtKi0g
Ki8KKy8qCisgICBDRCBTQ1NJIGRldmljZSBwYXJhbWV0ZXJzCisKKyAgIENvcHlyaWdodCAoQykg
MjAxOCBSZWQgSGF0LCBJbmMuCisKKyAgIFJlZCBIYXQgQXV0aG9yczoKKyAgIEFsZXhhbmRlciBO
ZXpoaW5za3k8YW5lemhpbnNAcmVkaGF0LmNvbT4KKworICAgVGhpcyBsaWJyYXJ5IGlzIGZyZWUg
c29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vcgorICAgbW9kaWZ5IGl0IHVu
ZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYworICAgTGljZW5z
ZSBhcyBwdWJsaXNoZWQgYnkgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyCisg
ICB2ZXJzaW9uIDIuMSBvZiB0aGUgTGljZW5zZSwgb3IgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0
ZXIgdmVyc2lvbi4KKworICAgVGhpcyBsaWJyYXJ5IGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3Bl
IHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCisgICBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdp
dGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgorICAgTUVSQ0hBTlRBQklMSVRZIG9y
IEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZSBHTlUKKyAgIExlc3Nl
ciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCisKKyAgIFlvdSBzaG91
bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMK
KyAgIExpY2Vuc2UgYWxvbmcgd2l0aCB0aGlzIGxpYnJhcnk7IGlmIG5vdCwgc2VlIDxodHRwOi8v
d3d3LmdudS5vcmcvbGljZW5zZXMvPi4KKyovCisKKyNpZm5kZWYgX0NEX1NDU0lfREVWX1BBUkFN
U19IXworI2RlZmluZSBfQ0RfU0NTSV9ERVZfUEFSQU1TX0hfCisKKyNpbmNsdWRlIDxnaW8vZ2lv
Lmg+CisKK3R5cGVkZWYgc3RydWN0IF9DZFNjc2lEZXZpY2VQYXJhbWV0ZXJzCit7CisgICAgY29u
c3QgY2hhciAqdmVuZG9yOworICAgIGNvbnN0IGNoYXIgKnByb2R1Y3Q7CisgICAgY29uc3QgY2hh
ciAqdmVyc2lvbjsKKyAgICBjb25zdCBjaGFyICpzZXJpYWw7Cit9IENkU2NzaURldmljZVBhcmFt
ZXRlcnM7CisKK3R5cGVkZWYgc3RydWN0IF9DZFNjc2lEZXZpY2VJbmZvCit7CisgICAgQ2RTY3Np
RGV2aWNlUGFyYW1ldGVycyBwYXJhbWV0ZXJzOworICAgIHVpbnQzMl90IHN0YXJ0ZWQgICAgOiAx
OworICAgIHVpbnQzMl90IGxvY2tlZCAgICAgOiAxOworICAgIHVpbnQzMl90IGxvYWRlZCAgICAg
OiAxOworfSBDZFNjc2lEZXZpY2VJbmZvOworCit0eXBlZGVmIHN0cnVjdCBfQ2RTY3NpTWVkaWFQ
YXJhbWV0ZXJzCit7CisgICAgR0ZpbGVJbnB1dFN0cmVhbSAqc3RyZWFtOworICAgIHVpbnQ2NF90
IHNpemU7CisgICAgdWludDMyX3QgYmxvY2tfc2l6ZTsKK30gQ2RTY3NpTWVkaWFQYXJhbWV0ZXJz
OworCisjZW5kaWYgLyogX0NEX1NDU0lfREVWX1BBUkFNU19IXyAqLwpkaWZmIC0tZ2l0IGEvc3Jj
L2NkLXNjc2kuYyBiL3NyYy9jZC1zY3NpLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAw
MDAwMC4uZTgyNTEyNAotLS0gL2Rldi9udWxsCisrKyBiL3NyYy9jZC1zY3NpLmMKQEAgLTAsMCAr
MSwyNzcwIEBACisvKiAtKi0gTW9kZTogQzsgYy1iYXNpYy1vZmZzZXQ6IDQ7IGluZGVudC10YWJz
LW1vZGU6IG5pbCAtKi0gKi8KKy8qCisgICBDRCBkZXZpY2UgZW11bGF0aW9uIC0gU0NTSSBlbmdp
bmUKKworICAgQ29weXJpZ2h0IChDKSAyMDE4IFJlZCBIYXQsIEluYy4KKworICAgUmVkIEhhdCBB
dXRob3JzOgorICAgQWxleGFuZGVyIE5lemhpbnNreTxhbmV6aGluc0ByZWRoYXQuY29tPgorCisg
ICBUaGlzIGxpYnJhcnkgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQg
YW5kL29yCisgICBtb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdl
bmVyYWwgUHVibGljCisgICBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2Fy
ZSBGb3VuZGF0aW9uOyBlaXRoZXIKKyAgIHZlcnNpb24gMi4xIG9mIHRoZSBMaWNlbnNlLCBvciAo
YXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgorCisgICBUaGlzIGxpYnJhcnkgaXMg
ZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKKyAgIGJ1dCBX
SVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9m
CisgICBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0Uu
ICBTZWUgdGhlIEdOVQorICAgTGVzc2VyIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUg
ZGV0YWlscy4KKworICAgWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05V
IExlc3NlciBHZW5lcmFsIFB1YmxpYworICAgTGljZW5zZSBhbG9uZyB3aXRoIHRoaXMgbGlicmFy
eTsgaWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+LgorKi8KKworI2lu
Y2x1ZGUgImNvbmZpZy5oIgorI2luY2x1ZGUgInNwaWNlL3R5cGVzLmgiCisjaW5jbHVkZSAic3Bp
Y2UtY29tbW9uLmgiCisjaW5jbHVkZSAic3BpY2UtdXRpbC5oIgorI2luY2x1ZGUgImNkLXNjc2ku
aCIKKworI2lmZGVmIFVTRV9VU0JSRURJUgorCisjZGVmaW5lIFNQSUNFX0VSUk9SKGZtdCwgLi4u
KSBcCisgICAgZG8geyBTUElDRV9ERUJVRygiZGV2LXNjc2kgZXJyb3I6ICIgZm10ICwgIyMgX19W
QV9BUkdTX18pOyB9IHdoaWxlICgwKQorCisjZGVmaW5lIE1BWF9MVU5TICAgMzIKKworc3RydWN0
IF9DZFNjc2lUYXJnZXQ7IC8qIGZvcndhcmQgZGVjbGFyYXRpb24gKi8KK3R5cGVkZWYgc3RydWN0
IF9DZFNjc2lUYXJnZXQgQ2RTY3NpVGFyZ2V0OworCit0eXBlZGVmIGVudW0gX0NkU2NzaVBvd2Vy
Q29uZGl0aW9uIHsKKyAgICBDRF9TQ1NJX1BPV0VSX1NUT1BQRUQsCisgICAgQ0RfU0NTSV9QT1dF
Ul9BQ1RJVkUsCisgICAgQ0RfU0NTSV9QT1dFUl9JRExFLAorICAgIENEX1NDU0lfUE9XRVJfU1RB
TkRCWQorfSBDZFNjc2lQb3dlckNvbmRpdGlvbjsKKwordHlwZWRlZiBzdHJ1Y3QgX1Njc2lTaG9y
dFNlbnNlCit7CisgICAgdWludDhfdCBrZXk7CisgICAgdWludDhfdCBhc2M7CisgICAgdWludDhf
dCBhc2NxOworICAgIGNvbnN0IGNoYXIgKmRlc2NyOworfSBTY3NpU2hvcnRTZW5zZTsKKworI2Rl
ZmluZSBDRF9NRURJQV9FVkVOVF9OT19DSEFOR0UgICAgICAgICAgICAweDAKKyNkZWZpbmUgQ0Rf
TUVESUFfRVZFTlRfRUpFQ1RfUkVRICAgICAgICAgICAgMHgxIC8qIHVzZXIgcmVxdWVzdCAobWVj
aGFuaWNhbCBzd2l0Y2gpIHRvIGVqZWN0IHRoZSBtZWRpYSAqLworI2RlZmluZSBDRF9NRURJQV9F
VkVOVF9ORVdfTUVESUEgICAgICAgICAgICAweDIgLyogbmV3IG1lZGlhIHJlY2VpdmVkICovCisj
ZGVmaW5lIENEX01FRElBX0VWRU5UX01FRElBX1JFTU9WQUwgICAgICAgIDB4MyAvKiBtZWRpYSBy
ZW1vdmVkICovCisjZGVmaW5lIENEX01FRElBX0VWRU5UX01FRElBX0NIQU5HRUQgICAgICAgIDB4
NCAvKiB1c2VyIHJlcXVlc3QgdG8gbG9hZCBuZXcgbWVkaWEgKi8KKyNkZWZpbmUgQ0RfTUVESUFf
RVZFTlRfQkdfRk9STUFUX0NPTVBMRVRFICAgMHg1CisjZGVmaW5lIENEX01FRElBX0VWRU5UX0JH
X0ZPUk1BVF9SRVNUQVJUICAgIDB4NgorCisjZGVmaW5lIENEX1BPV0VSX0VWRU5UX05PX0NIQU5H
RSAgICAgICAgICAgIDB4MAorI2RlZmluZSBDRF9QT1dFUl9FVkVOVF9DSEFOR0VfU1VDQ0VTUyAg
ICAgICAweDEKKyNkZWZpbmUgQ0RfUE9XRVJfRVZFTlRfQ0hBTkdFX0ZBTEVEICAgICAgICAgMHgy
CisKK3R5cGVkZWYgc3RydWN0IF9DZFNjc2lMVQoreworICAgIENkU2NzaVRhcmdldCAqdGd0Owor
ICAgIHVpbnQzMl90IGx1bjsKKworICAgIGdib29sZWFuIHJlYWxpemVkOworICAgIGdib29sZWFu
IHJlbW92YWJsZTsKKyAgICBnYm9vbGVhbiBsb2FkZWQ7CisgICAgZ2Jvb2xlYW4gcHJldmVudF9t
ZWRpYV9yZW1vdmFsOworICAgIGdib29sZWFuIGNkX3JvbTsKKworICAgIENkU2NzaVBvd2VyQ29u
ZGl0aW9uIHBvd2VyX2NvbmQ7CisgICAgdWludDMyX3QgcG93ZXJfZXZlbnQ7CisgICAgdWludDMy
X3QgbWVkaWFfZXZlbnQ7CisKKyAgICB1aW50MzJfdCBjbGFpbV92ZXJzaW9uOworCisgICAgdWlu
dDY0X3Qgc2l6ZTsKKyAgICB1aW50MzJfdCBibG9ja19zaXplOworICAgIHVpbnQzMl90IG51bV9i
bG9ja3M7CisKKyAgICBjaGFyICp2ZW5kb3I7CisgICAgY2hhciAqcHJvZHVjdDsKKyAgICBjaGFy
ICp2ZXJzaW9uOworICAgIGNoYXIgKnNlcmlhbDsKKworICAgIEdGaWxlSW5wdXRTdHJlYW0gKnN0
cmVhbTsKKworICAgIFNjc2lTaG9ydFNlbnNlIHNob3J0X3NlbnNlOyAvKiBjdXJyZW50bHkgaGVs
ZCBzZW5zZSBvZiB0aGUgc2NzaSBkZXZpY2UgKi8KKyAgICB1aW50OF90IGZpeGVkX3NlbnNlW0ZJ
WEVEX1NFTlNFX0xFTl07Cit9IENkU2NzaUxVOworCit0eXBlZGVmIGVudW0gX0NkU2NzaVRhcmdl
dFN0YXRlCit7CisgICAgQ0RfU0NTSV9UR1RfU1RBVEVfUlVOTklORywKKyAgICBDRF9TQ1NJX1RH
VF9TVEFURV9SRVNFVCwKK30gQ2RTY3NpVGFyZ2V0U3RhdGU7CisKK3N0cnVjdCBfQ2RTY3NpVGFy
Z2V0Cit7CisgICAgdm9pZCAqdXNlcl9kYXRhOworCisgICAgQ2RTY3NpVGFyZ2V0U3RhdGUgc3Rh
dGU7CisgICAgQ2RTY3NpUmVxdWVzdCAqY3VyX3JlcTsKKyAgICBHQ2FuY2VsbGFibGUgKmNhbmNl
bGxhYmxlOworCisgICAgdWludDMyX3QgbnVtX2x1bnM7CisgICAgdWludDMyX3QgbWF4X2x1bnM7
CisgICAgQ2RTY3NpTFUgdW5pdHNbTUFYX0xVTlNdOworfTsKKworc3RhdGljIGdib29sZWFuIGNt
ZF9uYW1lc19pbml0aWFsaXplZCA9IEZBTFNFOworc3RhdGljIGNvbnN0IGNoYXIqIHNjc2lfY21k
X25hbWVbMjU2XTsKKworLyogUHJlZGVmaW5lZCBzZW5zZSBjb2RlcyAqLworCitjb25zdCBTY3Np
U2hvcnRTZW5zZSBzZW5zZV9jb2RlX05PX1NFTlNFID0geworICAgIC5rZXkgPSBOT19TRU5TRSAs
IC5hc2MgPSAweDAwICwgLmFzY3EgPSAweDAwLAorICAgIC5kZXNjciA9ICIiCit9OworCitjb25z
dCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX05PVF9SRUFEWV9DQVVTRV9OT1RfUkVQT1JUQUJM
RSA9IHsKKyAgICAua2V5ID0gTk9UX1JFQURZLCAuYXNjID0gMHgwNCwgLmFzY3EgPSAweDAwLAor
ICAgIC5kZXNjciA9ICJDQVVTRSBOT1QgUkVQT1JUQUJMRSIKK307CisKK2NvbnN0IFNjc2lTaG9y
dFNlbnNlIHNlbnNlX2NvZGVfQkVDT01JTkdfUkVBRFkgPSB7CisgICAgLmtleSA9IE5PVF9SRUFE
WSwgLmFzYyA9IDB4MDQsIC5hc2NxID0gMHgwMSwKKyAgICAuZGVzY3IgPSAiSU4gUFJPQ0VTUyBP
RiBCRUNPTUlORyBSRUFEWSIKK307CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNlIHNlbnNlX2NvZGVf
SU5JVF9DTURfUkVRVUlSRUQgPSB7CisgICAgLmtleSA9IE5PVF9SRUFEWSwgLmFzYyA9IDB4MDQs
IC5hc2NxID0gMHgwMiwKKyAgICAuZGVzY3IgPSAiSU5JVElBTElaSU5HIENPTU1BTkQgUkVRVUlS
RUQiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX0lOVEVSVkVOVElPTl9S
RVFVSVJFRCA9IHsKKyAgICAua2V5ID0gTk9UX1JFQURZLCAuYXNjID0gMHgwNCwgLmFzY3EgPSAw
eDAzLAorICAgIC5kZXNjciA9ICJNQU5VQUwgSU5URVJWRU5USU9OIFJFUVVJUkVEIgorfTsKKwor
Y29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9OT1RfUkVBRFlfTk9fTUVESVVNID0gewor
ICAgIC5rZXkgPSBOT1RfUkVBRFksIC5hc2MgPSAweDNhLCAuYXNjcSA9IDB4MDAsCisgICAgLmRl
c2NyID0gIk1FRElVTSBOT1QgUFJFU0VOVCIKK307CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNlIHNl
bnNlX2NvZGVfTk9UX1JFQURZX05PX01FRElVTV9UUkFZX0NMT1NFRCA9IHsKKyAgICAua2V5ID0g
Tk9UX1JFQURZLCAuYXNjID0gMHgzYSwgLmFzY3EgPSAweDAxLAorICAgIC5kZXNjciA9ICJNRURJ
VU0gTk9UIFBSRVNFTlQgLSBUUkFZIENMT1NFRCIKK307CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNl
IHNlbnNlX2NvZGVfTk9UX1JFQURZX05PX01FRElVTV9UUkFZX09QRU4gPSB7CisgICAgLmtleSA9
IE5PVF9SRUFEWSwgLmFzYyA9IDB4M2EsIC5hc2NxID0gMHgwMiwKKyAgICAuZGVzY3IgPSAiTUVE
SVVNIE5PVCBQUkVTRU5UIC0gVFJBWSBPUEVOIgorfTsKKworY29uc3QgU2NzaVNob3J0U2Vuc2Ug
c2Vuc2VfY29kZV9UQVJHRVRfRkFJTFVSRSA9IHsKKyAgICAua2V5ID0gSEFSRFdBUkVfRVJST1Is
IC5hc2MgPSAweDQ0LCAuYXNjcSA9IDB4MDAsCisgICAgLmRlc2NyID0gIklOVEVSTkFMIFRBUkdF
VCBGQUlMVVJFIgorfTsKKworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9JTlZBTElE
X09QQ09ERSA9IHsKKyAgICAua2V5ID0gSUxMRUdBTF9SRVFVRVNULCAuYXNjID0gMHgyMCwgLmFz
Y3EgPSAweDAwLAorICAgIC5kZXNjciA9ICJJTlZBTElEIENPTU1BTkQgT1BFUkFUSU9OIENPREUi
Cit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX0xCQV9PVVRfT0ZfUkFOR0Ug
PSB7CisgICAgLmtleSA9IElMTEVHQUxfUkVRVUVTVCwgLmFzYyA9IDB4MjEsIC5hc2NxID0gMHgw
MCwKKyAgICAuZGVzY3IgPSAiTE9HSUNBTCBCTE9DSyBBRERSRVNTIE9VVCBPRiBSQU5HRSIKK307
CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNlIHNlbnNlX2NvZGVfSU5WQUxJRF9DREJfRklFTEQgPSB7
CisgICAgLmtleSA9IElMTEVHQUxfUkVRVUVTVCwgLmFzYyA9IDB4MjQsIC5hc2NxID0gMHgwMCwK
KyAgICAuZGVzY3IgPSAiSU5WQUxJRCBGSUVMRCBJTiBDREIiCit9OworCitjb25zdCBTY3NpU2hv
cnRTZW5zZSBzZW5zZV9jb2RlX0lOVkFMSURfUEFSQU1fRklFTEQgPSB7CisgICAgLmtleSA9IElM
TEVHQUxfUkVRVUVTVCwgLmFzYyA9IDB4MjYsIC5hc2NxID0gMHgwMCwKKyAgICAuZGVzY3IgPSAi
SU5WQUxJRCBGSUVMRCBJTiBQQVJBTUVURVIgTElTVCIKK307CisKK2NvbnN0IFNjc2lTaG9ydFNl
bnNlIHNlbnNlX2NvZGVfSU5WQUxJRF9QQVJBTV9MRU4gPSB7CisgICAgLmtleSA9IElMTEVHQUxf
UkVRVUVTVCwgLmFzYyA9IDB4MWEsIC5hc2NxID0gMHgwMCwKKyAgICAuZGVzY3IgPSAiUEFSQU1F
VEVSIExJU1QgTEVOR1RIIEVSUk9SIgorfTsKKworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2Vf
Y29kZV9MVU5fTk9UX1NVUFBPUlRFRCA9IHsKKyAgICAua2V5ID0gSUxMRUdBTF9SRVFVRVNULCAu
YXNjID0gMHgyNSwgLmFzY3EgPSAweDAwLAorICAgIC5kZXNjciA9ICJMT0dJQ0FMIFVOSVQgTk9U
IFNVUFBPUlRFRCIKK307CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNlIHNlbnNlX2NvZGVfU0FWSU5H
X1BBUkFNU19OT1RfU1VQUE9SVEVEID0geworICAgIC5rZXkgPSBJTExFR0FMX1JFUVVFU1QsIC5h
c2MgPSAweDM5LCAuYXNjcSA9IDB4MDAsCisgICAgLmRlc2NyID0gIlNBVklORyBQQVJBTUVURVJT
IE5PVCBTVVBQT1JURUQiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX0lO
Q09NUEFUSUJMRV9NRURJVU0gPSB7CisgICAgLmtleSA9IElMTEVHQUxfUkVRVUVTVCwgLmFzYyA9
IDB4MzAsIC5hc2NxID0gMHgwMCwKKyAgICAuZGVzY3IgPSAiSU5DT01QQVRJQkxFIE1FRElVTSBJ
TlNUQUxMRUQiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX01FRElVTV9S
RU1PVkFMX1BSRVZFTlRFRCA9IHsKKyAgICAua2V5ID0gSUxMRUdBTF9SRVFVRVNULCAuYXNjID0g
MHg1MywgLmFzY3EgPSAweDAyLAorICAgIC5kZXNjciA9ICJNRURJVU0gUkVNT1ZBTCBQUkVWRU5U
RUQiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX1BBUkFNRVRFUlNfQ0hB
TkdFRCA9IHsKKyAgICAua2V5ID0gVU5JVF9BVFRFTlRJT04sIC5hc2MgPSAweDJhLCAuYXNjcSA9
IDB4MDAsCisgICAgLmRlc2NyID0gIlBBUkFNRVRFUlMgQ0hBTkdFRCIKK307CisKK2NvbnN0IFNj
c2lTaG9ydFNlbnNlIHNlbnNlX2NvZGVfUE9XRVJfT05fUkVTRVQgPSB7CisgICAgLmtleSA9IFVO
SVRfQVRURU5USU9OLCAuYXNjID0gMHgyOSwgLmFzY3EgPSAweDAwLAorICAgIC5kZXNjciA9ICJQ
T1dFUiBPTiwgUkVTRVQsIE9SIEJVUyBERVZJQ0UgUkVTRVQiCit9OworCitjb25zdCBTY3NpU2hv
cnRTZW5zZSBzZW5zZV9jb2RlX1NDU0lfQlVTX1JFU0VUID0geworICAgIC5rZXkgPSBVTklUX0FU
VEVOVElPTiwgLmFzYyA9IDB4MjksIC5hc2NxID0gMHgwMiwKKyAgICAuZGVzY3IgPSAiU0NTSSBC
VVMgUkVTRVQiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX1VBX05PX01F
RElVTSA9IHsKKyAgICAua2V5ID0gVU5JVF9BVFRFTlRJT04sIC5hc2MgPSAweDNhLCAuYXNjcSA9
IDB4MDAsCisgICAgLmRlc2NyID0gIk1FRElVTSBOT1QgUFJFU0VOVCIKK307CisKK2NvbnN0IFNj
c2lTaG9ydFNlbnNlIHNlbnNlX2NvZGVfTUVESVVNX0NIQU5HRUQgPSB7CisgICAgLmtleSA9IFVO
SVRfQVRURU5USU9OLCAuYXNjID0gMHgyOCwgLmFzY3EgPSAweDAwLAorICAgIC5kZXNjciA9ICJN
RURJVU0gQ0hBTkdFRCIKK307CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNlIHNlbnNlX2NvZGVfUkVQ
T1JURURfTFVOU19DSEFOR0VEID0geworICAgIC5rZXkgPSBVTklUX0FUVEVOVElPTiwgLmFzYyA9
IDB4M2YsIC5hc2NxID0gMHgwZSwKKyAgICAuZGVzY3IgPSAiUkVQT1JURUQgTFVOUyBDSEFOR0VE
IgorfTsKKworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9ERVZJQ0VfSU5URVJOQUxf
UkVTRVQgPSB7CisgICAgLmtleSA9IFVOSVRfQVRURU5USU9OLCAuYXNjID0gMHgyOSwgLmFzY3Eg
PSAweDA0LAorICAgIC5kZXNjciA9ICJERVZJQ0UgSU5URVJOQUwgUkVTRVQiCit9OworCitjb25z
dCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX1VOSVRfQVRURU5USU9OX01FRElVTV9SRU1PVkFM
X1JFUVVFU1QgPSB7CisgICAgLmtleSA9IFVOSVRfQVRURU5USU9OLCAuYXNjID0gMHg1YSwgLmFz
Y3EgPSAweDAxLAorICAgIC5kZXNjciA9ICJPUEVSQVRPUiBNRURJVU0gUkVNT1ZBTCBSRVFVRVNU
IgorfTsKKworc3RhdGljIGlubGluZSBnYm9vbGVhbiBjZF9zY3NpX29wY29kZV91YV9zdXByZXNz
KHVpbnQzMl90IG9wY29kZSkKK3sKKyAgICBzd2l0Y2ggKG9wY29kZSkgeworICAgIGNhc2UgSU5R
VUlSWToKKyAgICBjYXNlIFJFUE9SVF9MVU5TOgorICAgIGNhc2UgR0VUX0NPTkZJR1VSQVRJT046
CisgICAgY2FzZSBHRVRfRVZFTlRfU1RBVFVTX05PVElGSUNBVElPTjoKKyAgICBjYXNlIFJFUVVF
U1RfU0VOU0U6CisgICAgICAgIHJldHVybiBUUlVFOworICAgIGRlZmF1bHQ6CisgICAgICAgIHJl
dHVybiBGQUxTRTsKKyAgICB9Cit9CisKK3N0YXRpYyBpbmxpbmUgY29uc3QgY2hhciAqQ2RTY3Np
UmVxU3RhdGVfc3RyKENkU2NzaVJlcVN0YXRlIHN0YXRlKQoreworICAgIHN3aXRjaChzdGF0ZSkg
eworICAgIGNhc2UgU0NTSV9SRVFfSURMRToKKyAgICAgICAgcmV0dXJuICJJRExFIjsKKyAgICBj
YXNlIFNDU0lfUkVRX1JVTk5JTkc6CisgICAgICAgIHJldHVybiAiUlVOTklORyI7CisgICAgY2Fz
ZSBTQ1NJX1JFUV9DT01QTEVURToKKyAgICAgICAgcmV0dXJuICJDT01QTEVURSI7CisgICAgY2Fz
ZSBTQ1NJX1JFUV9DQU5DRUxFRDoKKyAgICAgICAgcmV0dXJuICJDQU5DRUxFRCI7CisgICAgZGVm
YXVsdDoKKyAgICAgICAgcmV0dXJuICJJTExFR0FMIjsKKyAgICB9Cit9CisKK3N0YXRpYyBjb25z
dCBjaGFyICpjZF9zY3NpX3NlbnNlX2tleV9kZXNjcih1aW50OF90IHNlbnNlX2tleSkKK3sKKyAg
ICBzd2l0Y2goc2Vuc2Vfa2V5KSB7CisgICAgY2FzZSBOT19TRU5TRToKKyAgICAgICAgcmV0dXJu
ICJOTyBTRU5TRSI7CisgICAgY2FzZSBSRUNPVkVSRURfRVJST1I6CisgICAgICAgIHJldHVybiAi
UkVDT1ZFUkVEIEVSUk9SIjsKKyAgICBjYXNlIE5PVF9SRUFEWToKKyAgICAgICAgcmV0dXJuICJM
VU4gTk9UIFJFQURZIjsKKyAgICBjYXNlIE1FRElVTV9FUlJPUjoKKyAgICAgICAgcmV0dXJuICJN
RURJVU0gRVJST1IiOworICAgIGNhc2UgSEFSRFdBUkVfRVJST1I6CisgICAgICAgIHJldHVybiAi
SEFSRFdBUkUgRVJST1IiOworICAgIGNhc2UgSUxMRUdBTF9SRVFVRVNUOgorICAgICAgICByZXR1
cm4gIklMTEVHQUwgUkVRVUVTVCI7CisgICAgY2FzZSBVTklUX0FUVEVOVElPTjoKKyAgICAgICAg
cmV0dXJuICJVTklUIEFUVEVOVElPTiI7CisgICAgY2FzZSBCTEFOS19DSEVDSzoKKyAgICAgICAg
cmV0dXJuICJCTEFOSyBDSEVDSyI7CisgICAgY2FzZSBBQk9SVEVEX0NPTU1BTkQ6CisgICAgICAg
IHJldHVybiAiQUJPUlRFRCBDT01NQU5EIjsKKyAgICBkZWZhdWx0OgorICAgICAgICByZXR1cm4g
Ij8/PyI7CisgICAgfQorfQorc3RhdGljIHVpbnQzMl90IGNkX3Njc2lfYnVpbGRfZml4ZWRfc2Vu
c2UodWludDhfdCAqYnVmLCBjb25zdCBTY3NpU2hvcnRTZW5zZSAqc2hvcnRfc2Vuc2UpCit7Cisg
ICAgbWVtc2V0KGJ1ZiwgMCwgRklYRURfU0VOU0VfTEVOKTsKKworICAgIGJ1ZlswXSA9IEZJWEVE
X1NFTlNFX0NVUlJFTlQ7CisgICAgYnVmWzJdID0gc2hvcnRfc2Vuc2UtPmtleTsKKyAgICBidWZb
N10gPSAxMDsKKyAgICBidWZbMTJdID0gc2hvcnRfc2Vuc2UtPmFzYzsKKyAgICBidWZbMTNdID0g
c2hvcnRfc2Vuc2UtPmFzY3E7CisKKyAgICByZXR1cm4gRklYRURfU0VOU0VfTEVOOworfQorCitz
dGF0aWMgaW5saW5lIHZvaWQgY2Rfc2NzaV9yZXFfaW5pdChDZFNjc2lSZXF1ZXN0ICpyZXEpCit7
CisgICAgcmVxLT5yZXFfc3RhdGUgPSBTQ1NJX1JFUV9JRExFOworICAgIHJlcS0+eGZlcl9kaXIg
PSBTQ1NJX1hGRVJfTk9ORTsKKyAgICByZXEtPnByaXZfZGF0YSA9IE5VTEw7CisgICAgcmVxLT5p
bl9sZW4gPSAwOworICAgIHJlcS0+c3RhdHVzID0gR09PRDsKK30KKworc3RhdGljIGlubGluZSB2
b2lkIGNkX3Njc2lfZGV2X3NlbnNlX3Jlc2V0KENkU2NzaUxVICpkZXYpCit7CisgICAgbWVtc2V0
KCZkZXYtPnNob3J0X3NlbnNlLCAwLCBzaXplb2YoZGV2LT5zaG9ydF9zZW5zZSkpOworICAgIGNk
X3Njc2lfYnVpbGRfZml4ZWRfc2Vuc2UoZGV2LT5maXhlZF9zZW5zZSwgJmRldi0+c2hvcnRfc2Vu
c2UpOworfQorCitzdGF0aWMgaW5saW5lIHZvaWQgY2Rfc2NzaV9kZXZfc2Vuc2Vfc2V0KENkU2Nz
aUxVICpkZXYsIGNvbnN0IFNjc2lTaG9ydFNlbnNlICpzaG9ydF9zZW5zZSkKK3sKKyAgICBpZiAo
c2hvcnRfc2Vuc2UgIT0gTlVMTCkgeworICAgICAgICAvKiBjb3B5IHNob3J0IHNlbnNlIGFuZCBn
ZW5lcmF0ZSBmdWxsIHNlbnNlIGluIGZpeGVkIGZvcm1hdCAqLworICAgICAgICBkZXYtPnNob3J0
X3NlbnNlID0gKnNob3J0X3NlbnNlOworICAgICAgICBjZF9zY3NpX2J1aWxkX2ZpeGVkX3NlbnNl
KGRldi0+Zml4ZWRfc2Vuc2UsIHNob3J0X3NlbnNlKTsKKyAgICB9Cit9CisKK3N0YXRpYyBpbmxp
bmUgdm9pZCBjZF9zY3NpX2Rldl9zZW5zZV9zZXRfcG93ZXJfb24oQ2RTY3NpTFUgKmRldikKK3sK
KyAgICBjZF9zY3NpX2Rldl9zZW5zZV9zZXQoZGV2LCAmc2Vuc2VfY29kZV9QT1dFUl9PTl9SRVNF
VCk7Cit9CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoQ2RT
Y3NpTFUgKmRldiwgQ2RTY3NpUmVxdWVzdCAqcmVxLAorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBjb25zdCBTY3NpU2hvcnRTZW5zZSAqc2hvcnRfc2Vuc2UpCit7
CisgICAgcmVxLT5yZXFfc3RhdGUgPSBTQ1NJX1JFUV9DT01QTEVURTsKKyAgICByZXEtPnN0YXR1
cyA9IENIRUNLX0NPTkRJVElPTjsKKyAgICByZXEtPmluX2xlbiA9IDA7CisKKyAgICBjZF9zY3Np
X2Rldl9zZW5zZV9zZXQoZGV2LCBzaG9ydF9zZW5zZSk7CisKKyAgICBTUElDRV9ERUJVRygiQ0hF
Q0tfQ09ORCwgcmVxdWVzdCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVAorICAgICAgICAgICAgICAg
ICIgb3A6IDB4JTAyeCwgcGVuZGluZyBzZW5zZTogMHglMDJ4ICUwMnggJTAyeCAtICVzLCAlcyIs
CisgICAgICAgICAgICAgICAgZGV2LT5sdW4sICh1aW50MzJfdClyZXEtPmNkYlswXSwKKyAgICAg
ICAgICAgICAgICAodWludDMyX3QpZGV2LT5zaG9ydF9zZW5zZS5rZXksCisgICAgICAgICAgICAg
ICAgKHVpbnQzMl90KWRldi0+c2hvcnRfc2Vuc2UuYXNjLAorICAgICAgICAgICAgICAgICh1aW50
MzJfdClkZXYtPnNob3J0X3NlbnNlLmFzY3EsCisgICAgICAgICAgICAgICAgY2Rfc2NzaV9zZW5z
ZV9rZXlfZGVzY3IoZGV2LT5zaG9ydF9zZW5zZS5rZXkpLAorICAgICAgICAgICAgICAgIGRldi0+
c2hvcnRfc2Vuc2UuZGVzY3IpOworfQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9jb21wbGV0
ZV9nb29kKENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICByZXEtPnJl
cV9zdGF0ZSA9IFNDU0lfUkVRX0NPTVBMRVRFOworICAgIHJlcS0+c3RhdHVzID0gR09PRDsKK30K
KworLyogU0NTSSBUYXJnZXQgKi8KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRfbmFtZXNfaW5p
dCh2b2lkKQoreworICAgIHVpbnQzMl90IG9wY29kZTsKKworICAgIGlmIChjbWRfbmFtZXNfaW5p
dGlhbGl6ZWQpIHsKKyAgICAgICAgcmV0dXJuOworICAgIH0KKworICAgIGZvciAob3Bjb2RlID0g
MDsgb3Bjb2RlIDwgMjU2OyBvcGNvZGUrKykgeworICAgICAgICBzY3NpX2NtZF9uYW1lW29wY29k
ZV0gPSAiVU5TVVBQT1JURUQiOworICAgIH0KKworICAgIHNjc2lfY21kX25hbWVbUkVQT1JUX0xV
TlNdID0gIlJFUE9SVCBMVU5TIjsKKyAgICBzY3NpX2NtZF9uYW1lW1RFU1RfVU5JVF9SRUFEWV0g
PSAiVEVTVCBVTklUIFJFQURZIjsKKyAgICBzY3NpX2NtZF9uYW1lW0lOUVVJUlldID0gIklOUVVJ
UlkiOworICAgIHNjc2lfY21kX25hbWVbUkVRVUVTVF9TRU5TRV0gPSAiUkVRVUVTVCBTRU5TRSI7
CisgICAgc2NzaV9jbWRfbmFtZVtSRUFEXzZdID0gIlJFQUQoNikiOworICAgIHNjc2lfY21kX25h
bWVbUkVBRF8xMF0gPSAiUkVBRCgxMCkiOworICAgIHNjc2lfY21kX25hbWVbUkVBRF8xMl0gPSAi
UkVBRCgxMikiOworICAgIHNjc2lfY21kX25hbWVbUkVBRF8xNl0gPSAiUkVBRCgxNikiOworICAg
IHNjc2lfY21kX25hbWVbUkVBRF9DQVBBQ0lUWV8xMF0gPSAiUkVBRCBDQVBBQ0lUWSgxMCkiOwor
ICAgIHNjc2lfY21kX25hbWVbUkVBRF9UT0NdID0gIlJFQUQgVE9DIjsKKyAgICBzY3NpX2NtZF9u
YW1lW0dFVF9FVkVOVF9TVEFUVVNfTk9USUZJQ0FUSU9OXSA9ICJHRVQgRVZFTlQvU1RBVFVTIE5P
VElGSUNBVElPTiI7CisgICAgc2NzaV9jbWRfbmFtZVtSRUFEX0RJU0NfSU5GT1JNQVRJT05dID0g
IlJFQUQgRElTQyBJTkZPIjsKKyAgICBzY3NpX2NtZF9uYW1lW1JFQURfVFJBQ0tfSU5GT1JNQVRJ
T05dID0gIlJFQUQgVFJBQ0sgSU5GTyI7CisgICAgc2NzaV9jbWRfbmFtZVtNT0RFX1NFTlNFXzEw
XSA9ICJNT0RFIFNFTlNFKDEwKSI7CisgICAgc2NzaV9jbWRfbmFtZVtNT0RFX1NFTEVDVF0gPSAi
TU9ERSBTRUxFQ1QoNikiOworICAgIHNjc2lfY21kX25hbWVbTU9ERV9TRUxFQ1RfMTBdID0gIk1P
REUgU0VMRUNUKDEwKSI7CisgICAgc2NzaV9jbWRfbmFtZVtHRVRfQ09ORklHVVJBVElPTl0gPSAi
R0VUIENPTkZJR1VSQVRJT04iOworICAgIHNjc2lfY21kX25hbWVbQUxMT1dfTUVESVVNX1JFTU9W
QUxdID0gIlBSRVZFTlQgQUxMT1cgTUVESVVNIFJFTU9WQUwiOworICAgIHNjc2lfY21kX25hbWVb
TU1DX1NFTkRfRVZFTlRdID0gIlNFTkQgRVZFTlQiOworICAgIHNjc2lfY21kX25hbWVbTU1DX1JF
UE9SVF9LRVldID0gIlJFUE9SVCBLRVkiOworICAgIHNjc2lfY21kX25hbWVbTU1DX1NFTkRfS0VZ
XSA9ICJTRU5EX0tFWSI7CisgICAgc2NzaV9jbWRfbmFtZVtTVEFSVF9TVE9QXSA9ICJTVEFSVCBT
VE9QIFVOSVQiOworICAgIHNjc2lfY21kX25hbWVbTU1DX0dFVF9QRVJGT1JNQU5DRV0gPSAiR0VU
IFBFUkZPUk1BTkNFIjsKKyAgICBzY3NpX2NtZF9uYW1lW01NQ19NRUNIQU5JU01fU1RBVFVTXSA9
ICJNRUNIQU5JU00gU1RBVFVTIjsKKworICAgIGNtZF9uYW1lc19pbml0aWFsaXplZCA9IFRSVUU7
Cit9CisKK3ZvaWQgKmNkX3Njc2lfdGFyZ2V0X2FsbG9jKHZvaWQgKnRhcmdldF91c2VyX2RhdGEs
IHVpbnQzMl90IG1heF9sdW5zKQoreworICAgIENkU2NzaVRhcmdldCAqc3Q7CisKKyAgICBpZiAo
bWF4X2x1bnMgPT0gMCB8fCBtYXhfbHVucyA+IE1BWF9MVU5TKSB7CisgICAgICAgIFNQSUNFX0VS
Uk9SKCJBbGxvYywgaWxsZWdhbCBtYXhfbHVuczolIiBHX0dVSU5UMzJfRk9STUFULCBtYXhfbHVu
cyk7CisgICAgICAgIHJldHVybiBOVUxMOworICAgIH0KKworICAgIHN0ID0gZ19tYWxsb2MwKHNp
emVvZigqc3QpKTsKKworICAgIHN0LT51c2VyX2RhdGEgPSB0YXJnZXRfdXNlcl9kYXRhOworICAg
IHN0LT5zdGF0ZSA9IENEX1NDU0lfVEdUX1NUQVRFX1JVTk5JTkc7CisgICAgc3QtPmN1cl9yZXEg
PSBOVUxMOworICAgIHN0LT5jYW5jZWxsYWJsZSA9IGdfY2FuY2VsbGFibGVfbmV3KCk7CisgICAg
c3QtPm1heF9sdW5zID0gbWF4X2x1bnM7CisKKyAgICBjZF9zY3NpX2NtZF9uYW1lc19pbml0KCk7
CisKKyAgICByZXR1cm4gKHZvaWQgKilzdDsKK30KKwordm9pZCBjZF9zY3NpX3RhcmdldF9mcmVl
KHZvaWQgKnNjc2lfdGFyZ2V0KQoreworICAgIGNkX3Njc2lfdGFyZ2V0X3Jlc2V0KHNjc2lfdGFy
Z2V0KTsKKyAgICBnX2ZyZWUoc2NzaV90YXJnZXQpOworfQorCisvKiBTQ1NJIERldmljZSAqLwor
CitzdGF0aWMgaW5saW5lIGdib29sZWFuIGNkX3Njc2lfdGFyZ2V0X2x1bl9sZWdhbChDZFNjc2lU
YXJnZXQgKnN0LCB1aW50MzJfdCBsdW4pCit7CisgICAgcmV0dXJuIChsdW4gPCBzdC0+bWF4X2x1
bnMpID8gVFJVRSA6IEZBTFNFOworfQorCitzdGF0aWMgaW5saW5lIGdib29sZWFuIGNkX3Njc2lf
dGFyZ2V0X2x1bl9yZWFsaXplZChDZFNjc2lUYXJnZXQgKnN0LCB1aW50MzJfdCBsdW4pCit7Cisg
ICAgcmV0dXJuIChzdC0+bnVtX2x1bnMgPT0gMCB8fCAhc3QtPnVuaXRzW2x1bl0ucmVhbGl6ZWQp
ID8gRkFMU0UgOiBUUlVFOworfQorCitpbnQgY2Rfc2NzaV9kZXZfcmVhbGl6ZSh2b2lkICpzY3Np
X3RhcmdldCwgdWludDMyX3QgbHVuLAorICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgQ2RT
Y3NpRGV2aWNlUGFyYW1ldGVycyAqZGV2X3BhcmFtcykKK3sKKyAgICBDZFNjc2lUYXJnZXQgKnN0
ID0gKENkU2NzaVRhcmdldCAqKXNjc2lfdGFyZ2V0OworICAgIENkU2NzaUxVICpkZXY7CisKKyAg
ICBpZiAoIWNkX3Njc2lfdGFyZ2V0X2x1bl9sZWdhbChzdCwgbHVuKSkgeworICAgICAgICBTUElD
RV9FUlJPUigiUmVhbGl6ZSwgaWxsZWdhbCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCwgbHVuKTsK
KyAgICAgICAgcmV0dXJuIC0xOworICAgIH0KKyAgICBpZiAoY2Rfc2NzaV90YXJnZXRfbHVuX3Jl
YWxpemVkKHN0LCBsdW4pKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJSZWFsaXplLCBhbHJlYWR5
IHJlYWxpemVkIGx1bjolIiBHX0dVSU5UMzJfRk9STUFULCBsdW4pOworICAgICAgICByZXR1cm4g
LTE7CisgICAgfQorICAgIGRldiA9ICZzdC0+dW5pdHNbbHVuXTsKKworICAgIG1lbXNldChkZXYs
IDAsIHNpemVvZigqZGV2KSk7CisgICAgZGV2LT50Z3QgPSBzdDsKKyAgICBkZXYtPmx1biA9IGx1
bjsKKworICAgIGRldi0+cmVhbGl6ZWQgPSBUUlVFOworICAgIGRldi0+cmVtb3ZhYmxlID0gVFJV
RTsKKyAgICBkZXYtPmxvYWRlZCA9IEZBTFNFOworICAgIGRldi0+cHJldmVudF9tZWRpYV9yZW1v
dmFsID0gRkFMU0U7CisgICAgZGV2LT5jZF9yb20gPSBGQUxTRTsKKworICAgIGRldi0+cG93ZXJf
Y29uZCA9IENEX1NDU0lfUE9XRVJfQUNUSVZFOworICAgIGRldi0+cG93ZXJfZXZlbnQgPSBDRF9Q
T1dFUl9FVkVOVF9OT19DSEFOR0U7CisgICAgZGV2LT5tZWRpYV9ldmVudCA9IENEX01FRElBX0VW
RU5UX05PX0NIQU5HRTsKKworICAgIGRldi0+Y2xhaW1fdmVyc2lvbiA9IDM7IC8qIDAgOiBub25l
OyAyLDMsNSA6IFNQQy9NTUMteCAqLworCisgICAgZGV2LT52ZW5kb3IgPSBnX3N0cmR1cChkZXZf
cGFyYW1zLT52ZW5kb3IpOworICAgIGRldi0+cHJvZHVjdCA9IGdfc3RyZHVwKGRldl9wYXJhbXMt
PnByb2R1Y3QpOworICAgIGRldi0+dmVyc2lvbiA9IGdfc3RyZHVwKGRldl9wYXJhbXMtPnZlcnNp
b24pOworICAgIGRldi0+c2VyaWFsID0gZ19zdHJkdXAoZGV2X3BhcmFtcy0+c2VyaWFsKTsKKwor
ICAgIGNkX3Njc2lfZGV2X3NlbnNlX3NldF9wb3dlcl9vbihkZXYpOworCisgICAgc3QtPm51bV9s
dW5zICsrOworCisgICAgU1BJQ0VfREVCVUcoIlJlYWxpemUgbHVuOiUiIEdfR1VJTlQzMl9GT1JN
QVQgIiBiczolIiBHX0dVSU5UMzJfRk9STUFUCisgICAgICAgICAgICAgICAgIiBWUjpbJXNdIFBU
Olslc10gdmVyOlslc10gU05bJXNdIiwKKyAgICAgICAgICAgICAgICBsdW4sIGRldi0+YmxvY2tf
c2l6ZSwgZGV2LT52ZW5kb3IsCisgICAgICAgICAgICAgICAgZGV2LT5wcm9kdWN0LCBkZXYtPnZl
cnNpb24sIGRldi0+c2VyaWFsKTsKKyAgICByZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQgY2Rf
c2NzaV9sdV9tZWRpYV9yZXNldChDZFNjc2lMVSAqZGV2KQoreworICAgIC8qIG1lZGlhX2V2ZW50
IGlzIG5vdCBzZXQgaGVyZSwgYXMgaXQgZGVwZW5kcyBvbiB0aGUgY29udGV4dCAqLworICAgIGRl
di0+c3RyZWFtID0gTlVMTDsKKyAgICBkZXYtPnNpemUgPSAwOworICAgIGRldi0+YmxvY2tfc2l6
ZSA9IDA7CisgICAgZGV2LT5udW1fYmxvY2tzID0gMDsKK30KKworaW50IGNkX3Njc2lfZGV2X2xv
Y2sodm9pZCAqc2NzaV90YXJnZXQsIHVpbnQzMl90IGx1biwgZ2Jvb2xlYW4gbG9jaykKK3sKKyAg
ICBDZFNjc2lUYXJnZXQgKnN0ID0gKENkU2NzaVRhcmdldCAqKXNjc2lfdGFyZ2V0OworICAgIENk
U2NzaUxVICpkZXY7CisKKyAgICBpZiAoIWNkX3Njc2lfdGFyZ2V0X2x1bl9sZWdhbChzdCwgbHVu
KSkgeworICAgICAgICBTUElDRV9FUlJPUigiTG9jaywgaWxsZWdhbCBsdW46JSIgR19HVUlOVDMy
X0ZPUk1BVCwgbHVuKTsKKyAgICAgICAgcmV0dXJuIC0xOworICAgIH0KKyAgICBpZiAoIWNkX3Nj
c2lfdGFyZ2V0X2x1bl9yZWFsaXplZChzdCwgbHVuKSkgeworICAgICAgICBTUElDRV9FUlJPUigi
TG9jaywgdW5yZWFsaXplZCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCwgbHVuKTsKKyAgICAgICAg
cmV0dXJuIC0xOworICAgIH0KKyAgICBkZXYgPSAmc3QtPnVuaXRzW2x1bl07CisgICAgZGV2LT5w
cmV2ZW50X21lZGlhX3JlbW92YWwgPSBsb2NrOworICAgIFNQSUNFX0RFQlVHKCJsdW46JSIgR19H
VUlOVDMyX0ZPUk1BVCAiJXNsb2NrIiwgbHVuLCBsb2NrID8gInVuIiA6IiIpOworICAgIHJldHVy
biAwOworfQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2x1X2xvYWQoQ2RTY3NpTFUgKmRldiwKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBDZFNjc2lNZWRpYVBhcmFtZXRlcnMgKm1l
ZGlhX3BhcmFtcykKK3sKKyAgICBpZiAobWVkaWFfcGFyYW1zICE9IE5VTEwpIHsKKyAgICAgICAg
ZGV2LT5tZWRpYV9ldmVudCA9IENEX01FRElBX0VWRU5UX05FV19NRURJQTsKKyAgICAgICAgZGV2
LT5zdHJlYW0gPSBtZWRpYV9wYXJhbXMtPnN0cmVhbTsKKyAgICAgICAgZGV2LT5zaXplID0gbWVk
aWFfcGFyYW1zLT5zaXplOworICAgICAgICBkZXYtPmJsb2NrX3NpemUgPSBtZWRpYV9wYXJhbXMt
PmJsb2NrX3NpemU7CisgICAgICAgIGRldi0+bnVtX2Jsb2NrcyA9IG1lZGlhX3BhcmFtcy0+c2l6
ZSAvIG1lZGlhX3BhcmFtcy0+YmxvY2tfc2l6ZTsKKyAgICB9IGVsc2UgeworICAgICAgICBkZXYt
Pm1lZGlhX2V2ZW50ID0gQ0RfTUVESUFfRVZFTlRfTUVESUFfUkVNT1ZBTDsKKyAgICAgICAgY2Rf
c2NzaV9sdV9tZWRpYV9yZXNldChkZXYpOworICAgIH0KKyAgICBkZXYtPmxvYWRlZCA9IFRSVUU7
Cit9CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfbHVfdW5sb2FkKENkU2NzaUxVICpkZXYpCit7Cisg
ICAgZGV2LT5tZWRpYV9ldmVudCA9IENEX01FRElBX0VWRU5UX01FRElBX1JFTU9WQUw7CisgICAg
Y2Rfc2NzaV9sdV9tZWRpYV9yZXNldChkZXYpOworICAgIGRldi0+bG9hZGVkID0gRkFMU0U7Cit9
CisKK2ludCBjZF9zY3NpX2Rldl9sb2FkKHZvaWQgKnNjc2lfdGFyZ2V0LCB1aW50MzJfdCBsdW4s
CisgICAgICAgICAgICAgICAgICAgICBjb25zdCBDZFNjc2lNZWRpYVBhcmFtZXRlcnMgKm1lZGlh
X3BhcmFtcykKK3sKKyAgICBDZFNjc2lUYXJnZXQgKnN0ID0gKENkU2NzaVRhcmdldCAqKXNjc2lf
dGFyZ2V0OworICAgIENkU2NzaUxVICpkZXY7CisKKyAgICBpZiAoIWNkX3Njc2lfdGFyZ2V0X2x1
bl9sZWdhbChzdCwgbHVuKSkgeworICAgICAgICBTUElDRV9FUlJPUigiTG9hZCwgaWxsZWdhbCBs
dW46JSIgR19HVUlOVDMyX0ZPUk1BVCwgbHVuKTsKKyAgICAgICAgcmV0dXJuIC0xOworICAgIH0K
KyAgICBpZiAoIWNkX3Njc2lfdGFyZ2V0X2x1bl9yZWFsaXplZChzdCwgbHVuKSkgeworICAgICAg
ICBTUElDRV9FUlJPUigiTG9hZCwgdW5yZWFsaXplZCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCwg
bHVuKTsKKyAgICAgICAgcmV0dXJuIC0xOworICAgIH0KKyAgICBkZXYgPSAmc3QtPnVuaXRzW2x1
bl07CisKKyAgICBjZF9zY3NpX2x1X2xvYWQoZGV2LCBtZWRpYV9wYXJhbXMpOworICAgIGRldi0+
cG93ZXJfY29uZCA9IENEX1NDU0lfUE9XRVJfQUNUSVZFOworICAgIGRldi0+cG93ZXJfZXZlbnQg
PSBDRF9QT1dFUl9FVkVOVF9DSEFOR0VfU1VDQ0VTUzsKKworICAgIGNkX3Njc2lfZGV2X3NlbnNl
X3NldChkZXYsICZzZW5zZV9jb2RlX01FRElVTV9DSEFOR0VEKTsKKworICAgIFNQSUNFX0RFQlVH
KCJMb2FkIGx1bjolIiBHX0dVSU5UMzJfRk9STUFUICIgc2l6ZTolIiBHX0dVSU5UNjRfRk9STUFU
CisgICAgICAgICAgICAgICAgIiBibGtfc3o6JSIgR19HVUlOVDMyX0ZPUk1BVCAiIG51bV9ibG9j
a3M6JSIgR19HVUlOVDMyX0ZPUk1BVCwKKyAgICAgICAgICAgICAgICBsdW4sIGRldi0+c2l6ZSwg
ZGV2LT5ibG9ja19zaXplLCBkZXYtPm51bV9ibG9ja3MpOworICAgIHJldHVybiAwOworfQorCitp
bnQgY2Rfc2NzaV9kZXZfZ2V0X2luZm8odm9pZCAqc2NzaV90YXJnZXQsIHVpbnQzMl90IGx1biwg
Q2RTY3NpRGV2aWNlSW5mbyAqbHVuX2luZm8pCit7CisgICAgQ2RTY3NpVGFyZ2V0ICpzdCA9IChD
ZFNjc2lUYXJnZXQgKilzY3NpX3RhcmdldDsKKyAgICBDZFNjc2lMVSAqZGV2OworCisgICAgaWYg
KCFjZF9zY3NpX3RhcmdldF9sdW5fbGVnYWwoc3QsIGx1bikpIHsKKyAgICAgICAgU1BJQ0VfRVJS
T1IoIkxvYWQsIGlsbGVnYWwgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQsIGx1bik7CisgICAgICAg
IHJldHVybiAtMTsKKyAgICB9CisgICAgaWYgKCFjZF9zY3NpX3RhcmdldF9sdW5fcmVhbGl6ZWQo
c3QsIGx1bikpIHsKKyAgICAgICAgU1BJQ0VfRVJST1IoIkxvYWQsIHVucmVhbGl6ZWQgbHVuOiUi
IEdfR1VJTlQzMl9GT1JNQVQsIGx1bik7CisgICAgICAgIHJldHVybiAtMTsKKyAgICB9CisgICAg
ZGV2ID0gJnN0LT51bml0c1tsdW5dOworCisgICAgbHVuX2luZm8tPnN0YXJ0ZWQgPSBkZXYtPnBv
d2VyX2NvbmQgPT0gQ0RfU0NTSV9QT1dFUl9BQ1RJVkU7CisgICAgbHVuX2luZm8tPmxvY2tlZCA9
IGRldi0+cHJldmVudF9tZWRpYV9yZW1vdmFsOworICAgIGx1bl9pbmZvLT5sb2FkZWQgPSBkZXYt
PmxvYWRlZDsKKworICAgIGx1bl9pbmZvLT5wYXJhbWV0ZXJzLnZlbmRvciA9IGRldi0+dmVuZG9y
OworICAgIGx1bl9pbmZvLT5wYXJhbWV0ZXJzLnByb2R1Y3QgPSBkZXYtPnByb2R1Y3Q7CisgICAg
bHVuX2luZm8tPnBhcmFtZXRlcnMudmVyc2lvbiA9IGRldi0+dmVyc2lvbjsKKyAgICBsdW5faW5m
by0+cGFyYW1ldGVycy5zZXJpYWwgPSBkZXYtPnNlcmlhbDsKKworICAgIHJldHVybiAwOworfQor
CitpbnQgY2Rfc2NzaV9kZXZfdW5sb2FkKHZvaWQgKnNjc2lfdGFyZ2V0LCB1aW50MzJfdCBsdW4p
Cit7CisgICAgQ2RTY3NpVGFyZ2V0ICpzdCA9IChDZFNjc2lUYXJnZXQgKilzY3NpX3RhcmdldDsK
KyAgICBDZFNjc2lMVSAqZGV2OworCisgICAgaWYgKCFjZF9zY3NpX3RhcmdldF9sdW5fbGVnYWwo
c3QsIGx1bikpIHsKKyAgICAgICAgU1BJQ0VfRVJST1IoIlVubG9hZCwgaWxsZWdhbCBsdW46JSIg
R19HVUlOVDMyX0ZPUk1BVCwgbHVuKTsKKyAgICAgICAgcmV0dXJuIC0xOworICAgIH0KKyAgICBp
ZiAoIWNkX3Njc2lfdGFyZ2V0X2x1bl9yZWFsaXplZChzdCwgbHVuKSkgeworICAgICAgICBTUElD
RV9FUlJPUigiVW5sb2FkLCB1bnJlYWxpemVkIGx1bjolIiBHX0dVSU5UMzJfRk9STUFULCBsdW4p
OworICAgICAgICByZXR1cm4gLTE7CisgICAgfQorICAgIGRldiA9ICZzdC0+dW5pdHNbbHVuXTsK
KyAgICBpZiAoIWRldi0+bG9hZGVkKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJVbmxvYWQsIGx1
bjolIiBHX0dVSU5UMzJfRk9STUFUICIgbm90IGxvYWRlZCB5ZXQiLCBsdW4pOworICAgICAgICBy
ZXR1cm4gMDsKKyAgICB9CisgICAgaWYgKGRldi0+cHJldmVudF9tZWRpYV9yZW1vdmFsKSB7Cisg
ICAgICAgIFNQSUNFX0VSUk9SKCJVbmxvYWQsIGx1bjolIiBHX0dVSU5UMzJfRk9STUFUICIgcHJl
dmVudF9tZWRpYV9yZW1vdmFsIHNldCIsIGx1bik7CisgICAgICAgIHJldHVybiAtMTsKKyAgICB9
CisKKyAgICBjZF9zY3NpX2x1X3VubG9hZChkZXYpOworICAgIGRldi0+cG93ZXJfY29uZCA9IENE
X1NDU0lfUE9XRVJfU1RPUFBFRDsKKyAgICBkZXYtPnBvd2VyX2V2ZW50ID0gQ0RfUE9XRVJfRVZF
TlRfQ0hBTkdFX1NVQ0NFU1M7CisKKyAgICBjZF9zY3NpX2Rldl9zZW5zZV9zZXQoZGV2LCAmc2Vu
c2VfY29kZV9VQV9OT19NRURJVU0pOworCisgICAgU1BJQ0VfREVCVUcoIlVubG9hZCBsdW46JSIg
R19HVUlOVDMyX0ZPUk1BVCwgbHVuKTsKKyAgICByZXR1cm4gMDsKK30KKworaW50IGNkX3Njc2lf
ZGV2X3VucmVhbGl6ZSh2b2lkICpzY3NpX3RhcmdldCwgdWludDMyX3QgbHVuKQoreworICAgIENk
U2NzaVRhcmdldCAqc3QgPSAoQ2RTY3NpVGFyZ2V0ICopc2NzaV90YXJnZXQ7CisgICAgQ2RTY3Np
TFUgKmRldjsKKworICAgIGlmICghY2Rfc2NzaV90YXJnZXRfbHVuX2xlZ2FsKHN0LCBsdW4pKSB7
CisgICAgICAgIFNQSUNFX0VSUk9SKCJVbnJlYWxpemUsIGlsbGVnYWwgbHVuOiUiIEdfR1VJTlQz
Ml9GT1JNQVQsIGx1bik7CisgICAgICAgIHJldHVybiAtMTsKKyAgICB9CisgICAgaWYgKCFjZF9z
Y3NpX3RhcmdldF9sdW5fcmVhbGl6ZWQoc3QsIGx1bikpIHsKKyAgICAgICAgU1BJQ0VfRVJST1Io
IlVucmVhbGl6ZSwgYWJzZW50IGx1bjolIiBHX0dVSU5UMzJfRk9STUFULCBsdW4pOworICAgICAg
ICByZXR1cm4gLTE7CisgICAgfQorICAgIGRldiA9ICZzdC0+dW5pdHNbbHVuXTsKKworICAgIGlm
IChkZXYtPnZlbmRvciAhPSBOVUxMKSB7CisgICAgICAgIGZyZWUoZGV2LT52ZW5kb3IpOworICAg
ICAgICBkZXYtPnZlbmRvciA9IE5VTEw7CisgICAgfQorICAgIGlmIChkZXYtPnByb2R1Y3QgIT0g
TlVMTCkgeworICAgICAgICBmcmVlKGRldi0+cHJvZHVjdCk7CisgICAgICAgIGRldi0+cHJvZHVj
dCA9IE5VTEw7CisgICAgfQorICAgIGlmIChkZXYtPnZlcnNpb24gIT0gTlVMTCkgeworICAgICAg
ICBmcmVlKGRldi0+dmVyc2lvbik7CisgICAgICAgIGRldi0+dmVyc2lvbiA9IE5VTEw7CisgICAg
fQorICAgIGlmIChkZXYtPnNlcmlhbCAhPSBOVUxMKSB7CisgICAgICAgIGZyZWUoZGV2LT5zZXJp
YWwpOworICAgICAgICBkZXYtPnNlcmlhbCA9IE5VTEw7CisgICAgfQorCisgICAgZGV2LT5sb2Fk
ZWQgPSBGQUxTRTsKKyAgICBkZXYtPnJlYWxpemVkID0gRkFMU0U7CisgICAgZGV2LT5wb3dlcl9j
b25kID0gQ0RfU0NTSV9QT1dFUl9TVE9QUEVEOworCisgICAgc3QtPm51bV9sdW5zIC0tOworCisg
ICAgU1BJQ0VfREVCVUcoIlVucmVhbGl6ZSBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCwgbHVuKTsK
KyAgICByZXR1cm4gMDsKK30KKworaW50IGNkX3Njc2lfZGV2X3Jlc2V0KHZvaWQgKnNjc2lfdGFy
Z2V0LCB1aW50MzJfdCBsdW4pCit7CisgICAgQ2RTY3NpVGFyZ2V0ICpzdCA9IChDZFNjc2lUYXJn
ZXQgKilzY3NpX3RhcmdldDsKKyAgICBDZFNjc2lMVSAqZGV2OworCisgICAgaWYgKCFjZF9zY3Np
X3RhcmdldF9sdW5fbGVnYWwoc3QsIGx1bikpIHsKKyAgICAgICAgU1BJQ0VfRVJST1IoIkRldmlj
ZSByZXNldCwgaWxsZWdhbCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCwgbHVuKTsKKyAgICAgICAg
cmV0dXJuIC0xOworICAgIH0KKyAgICBpZiAoIWNkX3Njc2lfdGFyZ2V0X2x1bl9yZWFsaXplZChz
dCwgbHVuKSkgeworICAgICAgICBTUElDRV9FUlJPUigiRGV2aWNlIHJlc2V0LCBhYnNlbnQgbHVu
OiUiIEdfR1VJTlQzMl9GT1JNQVQsIGx1bik7CisgICAgICAgIHJldHVybiAtMTsKKyAgICB9Cisg
ICAgZGV2ID0gJnN0LT51bml0c1tsdW5dOworCisgICAgLyoKKyAgICAgICAgaWYgd2UgcmVzZXQg
dGhlICdwcmV2ZW50JyBmbGFnIHdlIGNhbid0IGNyZWF0ZQorICAgICAgICB0aGUgdW5pdCB0aGF0
IGlzIGxvY2tlZCBmcm9tIHRoZSBiZWdpbm5pbmcsIHNvCisgICAgICAgIHdlIGtlZXAgdGhpcyBm
bGFnIGFzIHBlcnNpc3RlbnQgb3ZlciByZXNldHMKKyAgICAqLworICAgIC8qIGRldi0+cHJldmVu
dF9tZWRpYV9yZW1vdmFsID0gRkFMU0U7ICovCisgICAgZGV2LT5wb3dlcl9jb25kID0gQ0RfU0NT
SV9QT1dFUl9BQ1RJVkU7CisgICAgZGV2LT5wb3dlcl9ldmVudCA9IENEX1BPV0VSX0VWRU5UX0NI
QU5HRV9TVUNDRVNTOworICAgIGNkX3Njc2lfZGV2X3NlbnNlX3NldF9wb3dlcl9vbihkZXYpOwor
CisgICAgU1BJQ0VfREVCVUcoIkRldmljZSByZXNldCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCwg
bHVuKTsKKyAgICByZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQgY2Rfc2NzaV90YXJnZXRfZG9f
cmVzZXQoQ2RTY3NpVGFyZ2V0ICpzdCkKK3sKKyAgICB1aW50MzJfdCBsdW47CisKKyAgICBmb3Ig
KGx1biA9IDA7IGx1biA8IHN0LT5tYXhfbHVuczsgbHVuKyspIHsKKyAgICAgICAgaWYgKHN0LT51
bml0c1tsdW5dLnJlYWxpemVkKSB7CisgICAgICAgICAgICBjZF9zY3NpX2Rldl9yZXNldChzdCwg
bHVuKTsKKyAgICAgICAgfQorICAgIH0KKworICAgIFNQSUNFX0RFQlVHKCJUYXJnZXQgcmVzZXQg
Y29tcGxldGUiKTsKKyAgICBzdC0+c3RhdGUgPSBDRF9TQ1NJX1RHVF9TVEFURV9SVU5OSU5HOwor
ICAgIGNkX3Njc2lfdGFyZ2V0X3Jlc2V0X2NvbXBsZXRlKHN0LT51c2VyX2RhdGEpOworfQorCitp
bnQgY2Rfc2NzaV90YXJnZXRfcmVzZXQodm9pZCAqc2NzaV90YXJnZXQpCit7CisgICAgQ2RTY3Np
VGFyZ2V0ICpzdCA9IChDZFNjc2lUYXJnZXQgKilzY3NpX3RhcmdldDsKKworICAgIGlmIChzdC0+
c3RhdGUgPT0gQ0RfU0NTSV9UR1RfU1RBVEVfUkVTRVQpIHsKKyAgICAgICAgU1BJQ0VfREVCVUco
IlRhcmdldCBhbHJlYWR5IGluIHJlc2V0Iik7CisgICAgICAgIHJldHVybiAtMTsKKyAgICB9CisK
KyAgICBzdC0+c3RhdGUgPSBDRF9TQ1NJX1RHVF9TVEFURV9SRVNFVDsKKworICAgIGlmIChzdC0+
Y3VyX3JlcSAhPSBOVUxMKSB7CisgICAgICAgIGNkX3Njc2lfZGV2X3JlcXVlc3RfY2FuY2VsKHNj
c2lfdGFyZ2V0LCBzdC0+Y3VyX3JlcSk7CisgICAgICAgIGlmIChzdC0+Y3VyX3JlcSAhPSBOVUxM
KSB7CisgICAgICAgICAgICBTUElDRV9ERUJVRygiVGFyZ2V0IHJlc2V0IGluIHByb2dyZXNzLi4u
Iik7CisgICAgICAgICAgICByZXR1cm4gMDsKKyAgICAgICAgfQorICAgIH0KKworICAgIGNkX3Nj
c2lfdGFyZ2V0X2RvX3Jlc2V0KHN0KTsKKyAgICByZXR1cm4gMDsKK30KKworQ2RTY3NpUmVxU3Rh
dGUgY2Rfc2NzaV9nZXRfcmVxX3N0YXRlKENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICByZXR1
cm4gcmVxLT5yZXFfc3RhdGU7Cit9CisKK3N0YXRpYyB2b2lkIHN0cnBhZGNweShjaGFyICpidWYs
IGludCBidWZfc2l6ZSwgY29uc3QgY2hhciAqc3RyLCBjaGFyIHBhZCkKK3sKKyAgICBpbnQgbGVu
ID0gc3RybmxlbihzdHIsIGJ1Zl9zaXplKTsKKyAgICBtZW1jcHkoYnVmLCBzdHIsIGxlbik7Cisg
ICAgbWVtc2V0KGJ1ZiArIGxlbiwgcGFkLCBidWZfc2l6ZSAtIGxlbik7Cit9CisKKy8qIFNDU0kg
Q0RCICovCisKK3N0YXRpYyBpbnQgc2NzaV9jZGJfbGVuZ3RoKHVpbnQ4X3QgKmNkYikKK3sKKyAg
ICBpbnQgY2RiX2xlbjsKKworICAgIHN3aXRjaCAoY2RiWzBdID4+IDUpIHsKKyAgICBjYXNlIDA6
CisgICAgICAgIGNkYl9sZW4gPSA2OworICAgICAgICBicmVhazsKKyAgICBjYXNlIDE6CisgICAg
Y2FzZSAyOgorICAgICAgICBjZGJfbGVuID0gMTA7CisgICAgICAgIGJyZWFrOworICAgIGNhc2Ug
NDoKKyAgICAgICAgY2RiX2xlbiA9IDE2OworICAgICAgICBicmVhazsKKyAgICBjYXNlIDU6Cisg
ICAgICAgIGNkYl9sZW4gPSAxMjsKKyAgICAgICAgYnJlYWs7CisgICAgZGVmYXVsdDoKKyAgICAg
ICAgY2RiX2xlbiA9IC0xOworICAgIH0KKyAgICByZXR1cm4gY2RiX2xlbjsKK30KKworc3RhdGlj
IHVpbnQ2NF90IHNjc2lfY2RiX2xiYSh1aW50OF90ICpjZGIsIGludCBjZGJfbGVuKQoreworICAg
IHVpbnQ2NF90IGxiYTsKKworICAgIHN3aXRjaCAoY2RiX2xlbikgeworICAgIGNhc2UgNjoKKyAg
ICAgICAgbGJhID0gKCgodWludDY0X3QpKGNkYlsxXSAmIDB4MWYpKSA8PCAxNikgfAorICAgICAg
ICAgICAgICAoKCh1aW50NjRfdCljZGJbMl0pIDw8IDgpIHwKKyAgICAgICAgICAgICAgICgodWlu
dDY0X3QpY2RiWzNdKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSAxMDoKKyAgICBjYXNlIDEy
OgorICAgICAgICBsYmEgPSAoKCh1aW50NjRfdCljZGJbMl0pIDw8IDI0KSB8CisgICAgICAgICAg
ICAgICgoKHVpbnQ2NF90KWNkYlszXSkgPDwgMTYpIHwKKyAgICAgICAgICAgICAgKCgodWludDY0
X3QpY2RiWzRdKSA8PCA4KSAgfAorICAgICAgICAgICAgICAgKCh1aW50NjRfdCljZGJbNV0pOwor
ICAgICAgICBicmVhazsKKyAgICBjYXNlIDE2OgorICAgICAgICBsYmEgPSAoKCh1aW50NjRfdClj
ZGJbMl0pIDw8IDU2KSB8CisgICAgICAgICAgICAgICgoKHVpbnQ2NF90KWNkYlszXSkgPDwgNDgp
IHwKKyAgICAgICAgICAgICAgKCgodWludDY0X3QpY2RiWzRdKSA8PCA0MCkgfAorICAgICAgICAg
ICAgICAoKCh1aW50NjRfdCljZGJbNV0pIDw8IDMyKSB8CisgICAgICAgICAgICAgICgoKHVpbnQ2
NF90KWNkYls2XSkgPDwgMjQpIHwKKyAgICAgICAgICAgICAgKCgodWludDY0X3QpY2RiWzddKSA8
PCAxNikgfAorICAgICAgICAgICAgICAoKCh1aW50NjRfdCljZGJbOF0pIDw8IDgpICB8CisgICAg
ICAgICAgICAgICAoKHVpbnQ2NF90KWNkYls5XSk7CisgICAgICAgIGJyZWFrOworICAgIGRlZmF1
bHQ6CisgICAgICAgIGxiYSA9IDA7CisgICAgfQorICAgIHJldHVybiBsYmE7Cit9CisKK3N0YXRp
YyB1aW50MzJfdCBzY3NpX2NkYl94ZmVyX2xlbmd0aCh1aW50OF90ICpjZGIsIGludCBjZGJfbGVu
KQoreworICAgIHVpbnQzMl90IGxlbjsKKworICAgIHN3aXRjaCAoY2RiX2xlbikgeworICAgIGNh
c2UgNjoKKyAgICAgICAgbGVuID0gKHVpbnQzMl90KWNkYls0XTsKKyAgICAgICAgaWYgKGxlbiA9
PSAwKQorICAgICAgICAgICAgbGVuID0gMjU2OworICAgICAgICBicmVhazsKKyAgICBjYXNlIDEw
OgorICAgICAgICBsZW4gPSAoKCh1aW50MzJfdCljZGJbN10pIDw8IDgpIHwKKyAgICAgICAgICAg
ICAgICgodWludDMyX3QpY2RiWzhdKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSAxMjoKKyAg
ICAgICAgbGVuID0gKCgodWludDMyX3QpY2RiWzZdKSA8PCAyNCkgfAorICAgICAgICAgICAgICAo
KCh1aW50MzJfdCljZGJbN10pIDw8IDE2KSB8CisgICAgICAgICAgICAgICgoKHVpbnQzMl90KWNk
Yls4XSkgPDwgOCkgIHwKKyAgICAgICAgICAgICAgICgodWludDMyX3QpY2RiWzldKTsKKyAgICAg
ICAgYnJlYWs7CisgICAgY2FzZSAxNjoKKyAgICAgICAgbGVuID0gKCgodWludDMyX3QpY2RiWzEw
XSkgPDwgMjQpIHwKKyAgICAgICAgICAgICAgKCgodWludDMyX3QpY2RiWzExXSkgPDwgMTYpIHwK
KyAgICAgICAgICAgICAgKCgodWludDMyX3QpY2RiWzEyXSkgPDwgOCkgIHwKKyAgICAgICAgICAg
ICAgICgodWludDMyX3QpY2RiWzEzXSk7CisgICAgICAgIGJyZWFrOworICAgIGRlZmF1bHQ6Cisg
ICAgICAgIGxlbiA9IDA7CisgICAgICAgIGJyZWFrOworICAgIH0KKyAgICByZXR1cm4gbGVuOwor
fQorCisvKiBTQ1NJIGNvbW1hbmRzICovCisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX3Rlc3Rf
dW5pdF9yZWFkeShDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgcmVx
LT54ZmVyX2RpciA9IFNDU0lfWEZFUl9OT05FOworICAgIHJlcS0+aW5fbGVuID0gMDsKKworICAg
IGlmIChkZXYtPmxvYWRlZCkgeworICAgICAgICBpZiAoZGV2LT5wb3dlcl9jb25kICE9IENEX1ND
U0lfUE9XRVJfU1RPUFBFRCkgeworICAgICAgICAgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfZ29v
ZChkZXYsIHJlcSk7CisgICAgICAgIH0gZWxzZSB7CisgICAgICAgICAgICBjZF9zY3NpX2NtZF9j
b21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTklUX0NNRF9SRVFVSVJF
RCk7CisgICAgICAgIH0KKyAgICB9IGVsc2UgeworICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0
ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9OT1RfUkVBRFlfTk9fTUVESVVNKTsK
KyAgICB9Cit9CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX3JlcXVlc3Rfc2Vuc2UoQ2RTY3Np
TFUgKmRldiwgQ2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAgIHJlcS0+eGZlcl9kaXIgPSBTQ1NJ
X1hGRVJfRlJPTV9ERVY7CisKKyAgICByZXEtPnJlcV9sZW4gPSByZXEtPmNkYls0XTsKKyAgICBy
ZXEtPmluX2xlbiA9IChyZXEtPnJlcV9sZW4gPCBzaXplb2YoZGV2LT5maXhlZF9zZW5zZSkpID8K
KyAgICAgICAgICAgICAgICAgICByZXEtPnJlcV9sZW4gOiBzaXplb2YoZGV2LT5maXhlZF9zZW5z
ZSk7CisKKyAgICBpZiAoZGV2LT5zaG9ydF9zZW5zZS5rZXkgIT0gTk9fU0VOU0UpIHsKKyAgICAg
ICAgU1BJQ0VfREVCVUcoIiVzLCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCAiIHJlcG9ydGVkIHNl
bnNlOiAweCUwMnggJTAyeCAlMDJ4IC0gJXMsICVzIiwKKyAgICAgICAgICAgICAgICAgICAgX19G
VU5DVElPTl9fLCByZXEtPmx1biwKKyAgICAgICAgICAgICAgICAgICAgZGV2LT5zaG9ydF9zZW5z
ZS5rZXksIGRldi0+c2hvcnRfc2Vuc2UuYXNjLCBkZXYtPnNob3J0X3NlbnNlLmFzY3EsCisgICAg
ICAgICAgICAgICAgICAgIGNkX3Njc2lfc2Vuc2Vfa2V5X2Rlc2NyKGRldi0+c2hvcnRfc2Vuc2Uu
a2V5KSwKKyAgICAgICAgICAgICAgICAgICAgZGV2LT5zaG9ydF9zZW5zZS5kZXNjcik7CisgICAg
fQorICAgIG1lbWNweShyZXEtPmJ1ZiwgZGV2LT5maXhlZF9zZW5zZSwgc2l6ZW9mKGRldi0+Zml4
ZWRfc2Vuc2UpKTsKKyAgICBjZF9zY3NpX2Rldl9zZW5zZV9yZXNldChkZXYpOyAvKiBjbGVhciBy
ZXBvcnRlZCBzZW5zZSAqLworCisgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfZ29vZChkZXYsIHJl
cSk7Cit9CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX3JlcG9ydF9sdW5zKENkU2NzaVRhcmdl
dCAqc3QsIENkU2NzaUxVICpkZXYsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgdWludDhfdCAqb3V0X2J1ZiA9IHJlcS0+YnVm
OworICAgIHVpbnQzMl90IG51bV9sdW5zID0gc3QtPm51bV9sdW5zOworICAgIHVpbnQzMl90IGJ1
ZmxlbiA9IDg7IC8qIGhlYWRlciBsZW5ndGggKi8KKyAgICB1aW50MzJfdCBsdW47CisKKyAgICBy
ZXEtPnJlcV9sZW4gPSBzY3NpX2NkYl94ZmVyX2xlbmd0aChyZXEtPmNkYiwgMTIpOworICAgIHJl
cS0+eGZlcl9kaXIgPSBTQ1NJX1hGRVJfRlJPTV9ERVY7CisKKyAgICBpZiAocmVxLT5jZGJbMF0g
PT0gMHgwMSkgeworICAgICAgICAvKiBvbmx5IHdlbGwga25vd24gbG9naWNhbCB1bml0cyAqLwor
ICAgICAgICBudW1fbHVucyA9IDA7CisgICAgfQorCisgICAgb3V0X2J1ZlswXSA9ICh1aW50OF90
KShudW1fbHVucyA+PiAyNCk7CisgICAgb3V0X2J1ZlsxXSA9ICh1aW50OF90KShudW1fbHVucyA+
PiAxNik7CisgICAgb3V0X2J1ZlsyXSA9ICh1aW50OF90KShudW1fbHVucyA+PiA4KTsKKyAgICBv
dXRfYnVmWzNdID0gKHVpbnQ4X3QpKG51bV9sdW5zKTsKKyAgICBtZW1zZXQoJm91dF9idWZbNF0s
IDAsIDQpOworCisgICAgaWYgKG51bV9sdW5zID4gMCkgeworICAgICAgICBmb3IgKGx1biA9IDA7
IGx1biA8IG51bV9sdW5zOyBsdW4rKykgeworICAgICAgICAgICAgaWYgKHN0LT51bml0c1tsdW5d
LnJlYWxpemVkKSB7CisgICAgICAgICAgICAgICAgb3V0X2J1ZltidWZsZW4rK10gPSAodWludDhf
dCkobnVtX2x1bnMgPj4gMjQpOworICAgICAgICAgICAgICAgIG91dF9idWZbYnVmbGVuKytdID0g
KHVpbnQ4X3QpKG51bV9sdW5zID4+IDE2KTsKKyAgICAgICAgICAgICAgICBvdXRfYnVmW2J1Zmxl
bisrXSA9ICh1aW50OF90KShudW1fbHVucyA+PiA4KTsKKyAgICAgICAgICAgICAgICBvdXRfYnVm
W2J1ZmxlbisrXSA9ICh1aW50OF90KShudW1fbHVucyk7CisgICAgICAgICAgICAgICAgbWVtc2V0
KCZvdXRfYnVmW2J1Zmxlbl0sIDAsIDQpOworICAgICAgICAgICAgICAgIGJ1ZmxlbiArPSA0Owor
ICAgICAgICAgICAgfQorICAgICAgICB9CisgICAgfQorCisgICAgcmVxLT5pbl9sZW4gPSBidWZs
ZW47CisgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfZ29vZChkZXYsIHJlcSk7Cit9CisKKyNkZWZp
bmUgU0NTSV9NQVhfSU5RVUlSWV9MRU4gICAgICAgIDI1NgorI2RlZmluZSBTQ1NJX01BWF9NT0RF
X0xFTiAgICAgICAgICAgMjU2CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX2lucXVpcnlfdnBk
X25vX2x1bihDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEsCisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyX3QgcGVyaWZfcXVhbCkKK3sKKyAg
ICB1aW50OF90ICpvdXRidWYgPSByZXEtPmJ1ZjsKKyAgICB1aW50OF90IHBhZ2VfY29kZSA9IHJl
cS0+Y2RiWzJdOworICAgIHVpbnQzMl90IHJlc3BfbGVuID0gNDsKKworICAgIG91dGJ1ZlswXSA9
IChwZXJpZl9xdWFsIDw8IDUpIHwgVFlQRV9ST007CisgICAgb3V0YnVmWzFdID0gcGFnZV9jb2Rl
IDsgLyogdGhpcyBwYWdlICovCisgICAgb3V0YnVmWzJdID0gMHgwMDsgLyogcGFnZSBsZW5ndGgg
TVNCICovCisgICAgb3V0YnVmWzNdID0gMHgwMDsgLyogcGFnZSBsZW5ndGggTFNCIC0gbm8gbW9y
ZSBkYXRhICovCisKKyAgICByZXEtPmluX2xlbiA9IChyZXEtPnJlcV9sZW4gPCByZXNwX2xlbikg
PyByZXEtPnJlcV9sZW4gOiByZXNwX2xlbjsKKworICAgIFNQSUNFX0RFQlVHKCJpbnF1aXJ5X3Zw
ZCwgdW5zdXBwb3J0ZWQgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQKKyAgICAgICAgICAgICAgICAi
IHBlcmlmX3F1YWw6MHgleCByZXNwX2xlbjogJSIgR19HVUlOVDY0X0ZPUk1BVCwKKyAgICAgICAg
ICAgICAgICByZXEtPmx1biwgcGVyaWZfcXVhbCwgcmVxLT5pbl9sZW4pOworCisgICAgY2Rfc2Nz
aV9jbWRfY29tcGxldGVfZ29vZChkZXYsIHJlcSk7Cit9CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lf
Y21kX2lucXVpcnlfdnBkKENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAg
ICB1aW50OF90ICpvdXRidWYgPSByZXEtPmJ1ZjsKKyAgICB1aW50OF90IHBhZ2VfY29kZSA9IHJl
cS0+Y2RiWzJdOworICAgIGludCBidWZsZW4gPSA0OworICAgIGludCBzdGFydCA9IDQ7CisKKyAg
ICBvdXRidWZbMF0gPSBUWVBFX1JPTTsKKyAgICBvdXRidWZbMV0gPSBwYWdlX2NvZGUgOyAvKiB0
aGlzIHBhZ2UgKi8KKyAgICBvdXRidWZbMl0gPSAweDAwOyAvKiBwYWdlIGxlbmd0aCBNU0IgKi8K
KyAgICBvdXRidWZbM10gPSAweDAwOyAvKiBwYWdlIGxlbmd0aCBMU0IsIHRvIHdyaXRlIGxhdGVy
ICovCisKKyAgICBzd2l0Y2ggKHBhZ2VfY29kZSkgeworICAgIGNhc2UgMHgwMDogLyogU3VwcG9y
dGVkIHBhZ2UgY29kZXMsIG1hbmRhdG9yeSAqLworICAgIHsKKyAgICAgICAgb3V0YnVmW2J1Zmxl
bisrXSA9IDB4MDA7IC8vIGxpc3Qgb2Ygc3VwcG9ydGVkIHBhZ2VzICh0aGlzIHBhZ2UpCisgICAg
ICAgIGlmIChkZXYtPnNlcmlhbCkgeworICAgICAgICAgICAgb3V0YnVmW2J1ZmxlbisrXSA9IDB4
ODA7IC8vIHVuaXQgc2VyaWFsIG51bWJlcgorICAgICAgICB9CisgICAgICAgIG91dGJ1ZltidWZs
ZW4rK10gPSAweDgzOyAvLyBkZXZpY2UgaWRlbnRpZmljYXRpb24KKworICAgICAgICBTUElDRV9E
RUJVRygiSW5xdWlyeSBFVlBEW1N1cHBvcnRlZCBwYWdlc10gbHVuOiUiIEdfR1VJTlQzMl9GT1JN
QVQKKyAgICAgICAgICAgICAgICAgICAgIiByZXFfbGVuOiAlIiBHX0dVSU5UNjRfRk9STUFUICIg
cmVzcF9sZW46ICVkIiwKKyAgICAgICAgICAgICAgICAgICAgcmVxLT5sdW4sIHJlcS0+cmVxX2xl
biwgYnVmbGVuKTsKKyAgICAgICAgYnJlYWs7CisgICAgfQorICAgIGNhc2UgMHg4MDogLyogRGV2
aWNlIHNlcmlhbCBudW1iZXIsIG9wdGlvbmFsICovCisgICAgeworICAgICAgICBpbnQgc2VyaWFs
X2xlbjsKKworICAgICAgICBzZXJpYWxfbGVuID0gc3RybGVuKGRldi0+c2VyaWFsKTsKKyAgICAg
ICAgaWYgKHNlcmlhbF9sZW4gPiAzNikgeworICAgICAgICAgICAgc2VyaWFsX2xlbiA9IDM2Owor
ICAgICAgICB9CisgICAgICAgIG1lbWNweShvdXRidWYrYnVmbGVuLCBkZXYtPnNlcmlhbCwgc2Vy
aWFsX2xlbik7CisgICAgICAgIGJ1ZmxlbiArPSBzZXJpYWxfbGVuOworCisgICAgICAgIFNQSUNF
X0RFQlVHKCJJbnF1aXJ5IEVWUERbU2VyaWFsIG51bV0gbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQK
KyAgICAgICAgICAgICAgICAgICAgIiByZXFfbGVuOiAlIiBHX0dVSU5UNjRfRk9STUFUICIgcmVz
cF9sZW46ICVkIiwKKyAgICAgICAgICAgICAgICAgICAgcmVxLT5sdW4sIHJlcS0+cmVxX2xlbiwg
YnVmbGVuKTsKKyAgICAgICAgYnJlYWs7CisgICAgfQorICAgIGNhc2UgMHg4MzogLyogRGV2aWNl
IGlkZW50aWZpY2F0aW9uIHBhZ2UsIG1hbmRhdG9yeSAqLworICAgIHsKKyAgICAgICAgaW50IHNl
cmlhbF9sZW4gPSBzdHJsZW4oZGV2LT5zZXJpYWwpOworICAgICAgICBpbnQgbWF4X2xlbiA9IDIw
OworCisgICAgICAgIGlmIChzZXJpYWxfbGVuID4gbWF4X2xlbikgeworICAgICAgICAgICAgc2Vy
aWFsX2xlbiA9IG1heF9sZW47CisgICAgICAgIH0KKworICAgICAgICBvdXRidWZbYnVmbGVuKytd
ID0gMHgyOyAvLyBBU0NJSQorICAgICAgICBvdXRidWZbYnVmbGVuKytdID0gMDsgICAvLyBub3Qg
b2ZmaWNpYWxseSBhc3NpZ25lZAorICAgICAgICBvdXRidWZbYnVmbGVuKytdID0gMDsgICAvLyBy
ZXNlcnZlZAorICAgICAgICBvdXRidWZbYnVmbGVuKytdID0gc2VyaWFsX2xlbjsgLy8gbGVuZ3Ro
IG9mIGRhdGEgZm9sbG93aW5nCisKKyAgICAgICAgbWVtY3B5KG91dGJ1ZitidWZsZW4sIGRldi0+
c2VyaWFsLCBzZXJpYWxfbGVuKTsKKyAgICAgICAgYnVmbGVuICs9IHNlcmlhbF9sZW47CisKKyAg
ICAgICAgU1BJQ0VfREVCVUcoIklucXVpcnkgRVZQRFtEZXZpY2UgaWRdIGx1bjolIiBHX0dVSU5U
MzJfRk9STUFUCisgICAgICAgICAgICAgICAgICAgICIgcmVxX2xlbjogJSIgR19HVUlOVDY0X0ZP
Uk1BVCAiIHJlc3BfbGVuOiAlZCIsCisgICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuLCByZXEt
PnJlcV9sZW4sIGJ1Zmxlbik7CisgICAgICAgIGJyZWFrOworICAgIH0KKworICAgIGRlZmF1bHQ6
CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5z
ZV9jb2RlX0lOVkFMSURfQ0RCX0ZJRUxEKTsKKyAgICAgICAgU1BJQ0VfREVCVUcoImlucXVpcnlf
c3RhbmRhcmQsIGx1bjolIiBHX0dVSU5UMzJfRk9STUFUICIgaW52YWxpZCBwYWdlX2NvZGU6ICUw
MngiLAorICAgICAgICAgICAgICAgICAgICByZXEtPmx1biwgKGludClwYWdlX2NvZGUpOworICAg
ICAgICByZXR1cm47CisgICAgfQorCisgICAgLyogZG9uZSB3aXRoIEVWUEQgKi8KKyAgICBnX2Fz
c2VydChidWZsZW4gLSBzdGFydCA8PSAyNTUpOworICAgIG91dGJ1ZlszXSA9IGJ1ZmxlbiAtIHN0
YXJ0OyAvKiBwYWdlIGxlbmd0aCBMU0IgKi8KKworICAgIHJlcS0+aW5fbGVuID0gYnVmbGVuOwor
ICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2LCByZXEpOworfQorCisjZGVmaW5lIElO
UVVJUllfU1RBTkRBUkRfTEVOX01JTiAgICAgICAgICAgIDM2CisjZGVmaW5lIElOUVVJUllfU1RB
TkRBUkRfTEVOICAgICAgICAgICAgICAgIDk2CisjZGVmaW5lIElOUVVJUllfU1RBTkRBUkRfTEVO
X05PX1ZFUiAgICAgICAgIDU3CisKKyNkZWZpbmUgUEVSSUZfUVVBTElGSUVSX0NPTk5FQ1RFRCAg
ICAgICAgICAgMHgwMAorI2RlZmluZSBQRVJJRl9RVUFMSUZJRVJfTk9UX0NPTk5FQ1RFRCAgICAg
ICAweDAxCisjZGVmaW5lIFBFUklGX1FVQUxJRklFUl9VTlNVUFBPUlRFRCAgICAgICAgIDB4MDMK
KworI2RlZmluZSBJTlFVSVJZX1JFTU9WQUJMRV9NRURJVU0gICAgICAgICAgICAweDgwCisKKyNk
ZWZpbmUgSU5RVUlSWV9WRVJTSU9OX05PTkUgICAgICAgICAgICAgICAgMHgwMAorI2RlZmluZSBJ
TlFVSVJZX1ZFUlNJT05fU1BDMyAgICAgICAgICAgICAgICAweDA1CisKKy8qIGJ5dGUgMyAqLwor
I2RlZmluZSBJTlFVSVJZX1JFU1BfSElTVVAgICAgICAgICAgICAgICAgICAoMHgwMSA8PCA0KQor
I2RlZmluZSBJTlFVSVJZX1JFU1BfTk9STV9BQ0EgICAgICAgICAgICAgICAoMHgwMSA8PCA1KQor
I2RlZmluZSBJTlFVSVJZX1JFU1BfREFUQV9GT1JNQVRfU1BDMyAgICAgICAweDAyCisKKyNkZWZp
bmUgSU5RVUlSWV9WRVJTSU9OX0RFU0NfU0FNMiAgICAgICAgICAgMHgwNDAKKyNkZWZpbmUgSU5R
VUlSWV9WRVJTSU9OX0RFU0NfU1BDMyAgICAgICAgICAgMHgzMDAKKyNkZWZpbmUgSU5RVUlSWV9W
RVJTSU9OX0RFU0NfTU1DMyAgICAgICAgICAgMHgyQTAKKyNkZWZpbmUgSU5RVUlSWV9WRVJTSU9O
X0RFU0NfU0JDMiAgICAgICAgICAgMHgzMjAKKworc3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRfaW5x
dWlyeV9zdGFuZGFyZF9ub19sdW4oQ2RTY3NpTFUgKmRldiwgQ2RTY3NpUmVxdWVzdCAqcmVxLAor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyX3Qg
cGVyaWZfcXVhbCkKK3sKKyAgICB1aW50OF90ICpvdXRidWYgPSByZXEtPmJ1ZjsKKyAgICB1aW50
MzJfdCByZXNwX2xlbiA9IElOUVVJUllfU1RBTkRBUkRfTEVOX01JTjsKKworICAgIG1lbXNldChy
ZXEtPmJ1ZiwgMCwgSU5RVUlSWV9TVEFOREFSRF9MRU5fTUlOKTsKKworICAgIG91dGJ1ZlswXSA9
IChwZXJpZl9xdWFsIDw8IDUpIHwgVFlQRV9ST007CisgICAgb3V0YnVmWzJdID0gSU5RVUlSWV9W
RVJTSU9OX05PTkU7CisgICAgb3V0YnVmWzNdID0gSU5RVUlSWV9SRVNQX0RBVEFfRk9STUFUX1NQ
QzM7CisKKyAgICBvdXRidWZbNF0gPSByZXNwX2xlbiAtIDQ7IC8qIGFkZGl0aW9uYWwgbGVuZ3Ro
LCBhZnRlciBoZWFkZXIgKi8KKworICAgIHJlcS0+aW5fbGVuID0gKHJlcS0+cmVxX2xlbiA8IHJl
c3BfbGVuKSA/IHJlcS0+cmVxX2xlbiA6IHJlc3BfbGVuOworCisgICAgU1BJQ0VfREVCVUcoImlu
cXVpcnlfc3RhbmRhcmQsIHVuc3VwcG9ydGVkIGx1bjolIiBHX0dVSU5UMzJfRk9STUFUICIgcGVy
aWZfcXVhbDoweCV4ICIKKyAgICAgICAgICAgICAgICAiaW5xdWlyeV9sZW46ICUiIEdfR1VJTlQz
Ml9GT1JNQVQgIiByZXNwX2xlbjogJSIgR19HVUlOVDY0X0ZPUk1BVCwKKyAgICAgICAgICAgICAg
ICByZXEtPmx1biwgcGVyaWZfcXVhbCwgcmVzcF9sZW4sIHJlcS0+aW5fbGVuKTsKKworICAgIGNk
X3Njc2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2LCByZXEpOworfQorCitzdGF0aWMgdm9pZCBjZF9z
Y3NpX2NtZF9pbnF1aXJ5X3N0YW5kYXJkKENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJl
cSkKK3sKKyAgICB1aW50OF90ICpvdXRidWYgPSByZXEtPmJ1ZjsKKyAgICB1aW50MzJfdCByZXNw
X2xlbiA9IChkZXYtPmNsYWltX3ZlcnNpb24gPT0gMCkgPyBJTlFVSVJZX1NUQU5EQVJEX0xFTl9O
T19WRVIgOiBJTlFVSVJZX1NUQU5EQVJEX0xFTjsKKworICAgIG91dGJ1ZlswXSA9IChQRVJJRl9R
VUFMSUZJRVJfQ09OTkVDVEVEIDw8IDUpIHwgVFlQRV9ST007CisgICAgb3V0YnVmWzFdID0gKGRl
di0+cmVtb3ZhYmxlKSA/IElOUVVJUllfUkVNT1ZBQkxFX01FRElVTSA6IDA7CisgICAgb3V0YnVm
WzJdID0gKGRldi0+Y2xhaW1fdmVyc2lvbiA9PSAwKSA/IElOUVVJUllfVkVSU0lPTl9OT05FIDog
SU5RVUlSWV9WRVJTSU9OX1NQQzM7CisgICAgb3V0YnVmWzNdID0gSU5RVUlSWV9SRVNQX05PUk1f
QUNBIHwgSU5RVUlSWV9SRVNQX0hJU1VQIHwgSU5RVUlSWV9SRVNQX0RBVEFfRk9STUFUX1NQQzM7
CisKKyAgICBvdXRidWZbNF0gPSByZXNwX2xlbiAtIDQ7IC8qIGFkZGl0aW9uYWwgbGVuZ3RoLCBh
ZnRlciBoZWFkZXIgKi8KKworICAgIC8qIChvdXRidWZbNiw3XSA9IDApIG1lYW5zIGFsc28ge0JR
dWU9MCxDbWRRdWU9MH0gLSBubyBxdWV1ZWluZyBhdCBhbGwgKi8KKworICAgIHN0cnBhZGNweSgo
Y2hhciAqKSAmb3V0YnVmWzhdLCA4LCBkZXYtPnZlbmRvciwgJyAnKTsKKyAgICBzdHJwYWRjcHko
KGNoYXIgKikgJm91dGJ1ZlsxNl0sIDE2LCBkZXYtPnByb2R1Y3QsICcgJyk7CisgICAgbWVtY3B5
KCZvdXRidWZbMzJdLCBkZXYtPnZlcnNpb24sIE1JTig0LCBzdHJsZW4oZGV2LT52ZXJzaW9uKSkp
OworCisgICAgaWYgKGRldi0+Y2xhaW1fdmVyc2lvbiA+IDApIHsKKyAgICAgICAgLyogbm93IHN1
cHBvcnRpbmcgb25seSAzICovCisgICAgICAgIG91dGJ1Zls1OF0gPSAoSU5RVUlSWV9WRVJTSU9O
X0RFU0NfU0FNMiA+PiA4KSAmIDB4ZmY7CisgICAgICAgIG91dGJ1Zls1OV0gPSBJTlFVSVJZX1ZF
UlNJT05fREVTQ19TQU0yICYgMHhmZjsKKworICAgICAgICBvdXRidWZbNjBdID0gKElOUVVJUllf
VkVSU0lPTl9ERVNDX1NQQzMgPj4gOCkgJiAweGZmOworICAgICAgICBvdXRidWZbNjFdID0gSU5R
VUlSWV9WRVJTSU9OX0RFU0NfU1BDMyAmIDB4ZmY7CisKKyAgICAgICAgb3V0YnVmWzYyXSA9IChJ
TlFVSVJZX1ZFUlNJT05fREVTQ19NTUMzID4+IDgpICYgMHhmZjsKKyAgICAgICAgb3V0YnVmWzYz
XSA9IElOUVVJUllfVkVSU0lPTl9ERVNDX01NQzMgJiAweGZmOworCisgICAgICAgIG91dGJ1Zls2
NF0gPSAoSU5RVUlSWV9WRVJTSU9OX0RFU0NfU0JDMiA+PiA4KSAmIDB4ZmY7CisgICAgICAgIG91
dGJ1Zls2NV0gPSBJTlFVSVJZX1ZFUlNJT05fREVTQ19TQkMyICYgMHhmZjsKKyAgICB9CisKKyAg
ICByZXEtPmluX2xlbiA9IChyZXEtPnJlcV9sZW4gPCByZXNwX2xlbikgPyByZXEtPnJlcV9sZW4g
OiByZXNwX2xlbjsKKworICAgIFNQSUNFX0RFQlVHKCJpbnF1aXJ5X3N0YW5kYXJkLCBsdW46JSIg
R19HVUlOVDMyX0ZPUk1BVAorICAgICAgICAgICAgICAgICIgaW5xdWlyeV9sZW46ICUiIEdfR1VJ
TlQzMl9GT1JNQVQgIiByZXNwX2xlbjogJSIgR19HVUlOVDY0X0ZPUk1BVCwKKyAgICAgICAgICAg
ICAgICByZXEtPmx1biwgcmVzcF9sZW4sIHJlcS0+aW5fbGVuKTsKKworICAgIGNkX3Njc2lfY21k
X2NvbXBsZXRlX2dvb2QoZGV2LCByZXEpOworfQorCisjZGVmaW5lIENEX0lOUVVJUllfRkxBR19F
VlBEICAgICAgICAgICAgICAgIDB4MDEKKyNkZWZpbmUgQ0RfSU5RVUlSWV9GTEFHX0NNRF9EVCAg
ICAgICAgICAgICAgMHgwMgorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9pbnF1aXJ5KENkU2Nz
aUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICBnYm9vbGVhbiBldnBkLCBjbWRf
ZGF0YTsKKworICAgIHJlcS0+eGZlcl9kaXIgPSBTQ1NJX1hGRVJfRlJPTV9ERVY7CisKKyAgICBl
dnBkID0gKHJlcS0+Y2RiWzFdICYgQ0RfSU5RVUlSWV9GTEFHX0VWUEQpID8gVFJVRSA6IEZBTFNF
OworICAgIGNtZF9kYXRhID0gKHJlcS0+Y2RiWzFdICYgQ0RfSU5RVUlSWV9GTEFHX0NNRF9EVCkg
PyBUUlVFIDogRkFMU0U7CisKKyAgICBpZiAoY21kX2RhdGEpIHsKKyAgICAgICAgU1BJQ0VfREVC
VUcoImlucXVpcnksIGx1bjolIiBHX0dVSU5UMzJfRk9STUFUICIgQ21kRFQgYml0IHNldCAtIHVu
c3VwcG9ydGVkLCAiCisgICAgICAgICAgICAgICAgICAgICJjZGJbMV06MHglMDJ4IGNkYlsxXTow
eCUwMngiLAorICAgICAgICAgICAgICAgICAgICByZXEtPmx1biwgKGludClyZXEtPmNkYlsxXSwg
KGludClyZXEtPmNkYlsyXSk7CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2Nv
bmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX0lOVkFMSURfQ0RCX0ZJRUxEKTsKKyAgICAgICAgcmV0
dXJuOworICAgIH0KKworICAgIHJlcS0+cmVxX2xlbiA9IHJlcS0+Y2RiWzRdIHwgKHJlcS0+Y2Ri
WzNdIDw8IDgpOworICAgIG1lbXNldChyZXEtPmJ1ZiwgMCwgcmVxLT5yZXFfbGVuKTsKKworICAg
IGlmIChldnBkKSB7IC8qIGVuYWJsZSB2aXRhbCBwcm9kdWN0IGRhdGEgKi8KKyAgICAgICAgY2Rf
c2NzaV9jbWRfaW5xdWlyeV92cGQoZGV2LCByZXEpOworICAgIH0gZWxzZSB7IC8qIHN0YW5kYXJk
IGlucXVpcnkgZGF0YSAqLworICAgICAgICBpZiAocmVxLT5jZGJbMl0gIT0gMCkgeworICAgICAg
ICAgICAgU1BJQ0VfREVCVUcoImlucXVpcnlfc3RhbmRhcmQsIGx1bjolIiBHX0dVSU5UMzJfRk9S
TUFUICIgbm9uLXplcm8gcGFnZSBjb2RlOiAlMDJ4IiwKKyAgICAgICAgICAgICAgICAgICAgICAg
IHJlcS0+bHVuLCAoaW50KXJlcS0+Y2RiWzJdKTsKKyAgICAgICAgICAgIGNkX3Njc2lfY21kX2Nv
bXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX0lOVkFMSURfQ0RCX0ZJRUxE
KTsKKyAgICAgICAgICAgIHJldHVybjsKKyAgICAgICAgfQorICAgICAgICBjZF9zY3NpX2NtZF9p
bnF1aXJ5X3N0YW5kYXJkKGRldiwgcmVxKTsKKyAgICB9Cit9CisKK3N0YXRpYyB2b2lkIGNkX3Nj
c2lfY21kX3JlYWRfY2FwYWNpdHkoQ2RTY3NpTFUgKmRldiwgQ2RTY3NpUmVxdWVzdCAqcmVxKQor
eworICAgIHVpbnQzMl90IGxhc3RfYmxrID0gZGV2LT5udW1fYmxvY2tzIC0gMTsKKyAgICB1aW50
MzJfdCBibGtfc2l6ZSA9IGRldi0+YmxvY2tfc2l6ZTsKKyAgICB1aW50MzJfdCAqbGFzdF9ibGtf
b3V0ID0gKHVpbnQzMl90ICopcmVxLT5idWY7CisgICAgdWludDMyX3QgKmJsa19zaXplX291dCA9
ICh1aW50MzJfdCAqKShyZXEtPmJ1ZiArIDQpOworCisgICAgcmVxLT54ZmVyX2RpciA9IFNDU0lf
WEZFUl9GUk9NX0RFVjsKKyAgICByZXEtPnJlcV9sZW4gPSA4OworCisgICAgKmxhc3RfYmxrX291
dCA9IGh0b2JlMzIobGFzdF9ibGspOworICAgICpibGtfc2l6ZV9vdXQgPSBodG9iZTMyKGJsa19z
aXplKTsKKworICAgIFNQSUNFX0RFQlVHKCJSZWFkIGNhcGFjaXR5LCBsdW46JSIgR19HVUlOVDMy
X0ZPUk1BVAorICAgICAgICAgICAgICAgICIgbGFzdF9ibGs6ICUiIEdfR1VJTlQzMl9GT1JNQVQg
IiBibGtfc3o6ICUiIEdfR1VJTlQzMl9GT1JNQVQsCisgICAgICAgICAgICAgICAgcmVxLT5sdW4s
IGxhc3RfYmxrLCBibGtfc2l6ZSk7CisKKyAgICByZXEtPmluX2xlbiA9IDg7CisgICAgY2Rfc2Nz
aV9jbWRfY29tcGxldGVfZ29vZChkZXYsIHJlcSk7Cit9CisKKyNkZWZpbmUgUkRJX1RZUEVfU1RB
TkRBUkQgICAgICAgICAgIDAgLyogU3RhbmRhcmQgRGlzYyBJbmZvcm1hdGlvbiAqLworI2RlZmlu
ZSBSRElfVFlQRV9UUkFDS19SRVNPVVJDRVMgICAgMSAvKiBUcmFjayBSZXNvdXJjZXMgSW5mb3Jt
YXRpb24gKi8KKyNkZWZpbmUgUkRJX1RZUEVfUE9XX1JFU09VUkNFUyAgICAgIDIgLyogUE9XIFJl
c291cmNlcyBJbmZvcm1hdGlvbiAqLworCisjZGVmaW5lIFJESV9TVEFOREFSRF9MRU4gICAgICAg
ICAgICAzNAorCisjZGVmaW5lIFJESV9FUkFaQUJMRSAgICAgICAgICAgICAgICAoMHgwMSA8PCA0
KQorI2RlZmluZSBSRElfTk9OX0VSQVpBQkxFICAgICAgICAgICAgKDB4MDAgPDwgNCkKKworI2Rl
ZmluZSBSRElfU0VTU0lPTl9FTVBUWSAgICAgICAgICAgKDB4MDAgPDwgMikKKyNkZWZpbmUgUkRJ
X1NFU1NJT05fSU5DT01QTEVURSAgICAgICgweDAxIDw8IDIpCisjZGVmaW5lIFJESV9TRVNTSU9O
X0RBTUFHRUQgICAgICAgICAoMHgwMiA8PCAyKQorI2RlZmluZSBSRElfU0VTU0lPTl9DT01QTEVU
RSAgICAgICAgKDB4MDMgPDwgMikKKworI2RlZmluZSBSRElfRElTQ19FTVBUWSAgICAgICAgICAg
ICAgMHgwMAorI2RlZmluZSBSRElfRElTQ19JTkNPTVBMRVRFICAgICAgICAgMHgwMQorI2RlZmlu
ZSBSRElfRElTQ19DT01QTEVURSAgICAgICAgICAgMHgwMgorI2RlZmluZSBSRElfRElTQ19SQU5E
T01fV1IgICAgICAgICAgMHgwMworCisjZGVmaW5lIFJESV9ESVNDX1BNQV9UWVBFX0NEX1JPTSAg
ICAweDAwCisjZGVmaW5lIFJESV9ESVNDX1BNQV9UWVBFX0NESSAgICAgICAweDEwCisjZGVmaW5l
IFJESV9ESVNDX1BNQV9UWVBFX0REQ0QgICAgICAweDIwCisjZGVmaW5lIFJESV9ESVNDX1BNQV9U
WVBFX1VOREVGSU5FRCAweEZGCisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX2dldF9yZWFkX2Rp
c2NfaW5mb3JtYXRpb24oQ2RTY3NpTFUgKmRldiwgQ2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAg
IHVpbnQ4X3QgKm91dGJ1ZiA9IHJlcS0+YnVmOworICAgIHVpbnQzMl90IGRhdGFfdHlwZTsKKyAg
ICB1aW50MzJfdCBmaXJzdF90cmFjayA9IDE7CisgICAgdWludDMyX3QgbGFzdF90cmFjayA9IDE7
CisgICAgdWludDMyX3QgbnVtX3Nlc3Npb25zID0gMTsKKworICAgIHJlcS0+eGZlcl9kaXIgPSBT
Q1NJX1hGRVJfRlJPTV9ERVY7CisKKyAgICBkYXRhX3R5cGUgPSByZXEtPmNkYlsxXSAmIDB4NzsK
KyAgICBpZiAoZGF0YV90eXBlICE9IFJESV9UWVBFX1NUQU5EQVJEKSB7CisgICAgICAgIFNQSUNF
X0RFQlVHKCJyZWFkX2Rpc2NfaW5mb3JtYXRpb24sIGx1bjolIiBHX0dVSU5UMzJfRk9STUFUCisg
ICAgICAgICAgICAgICAgICAgICIgdW5zdXBwb3J0ZWQgZGF0YSB0eXBlOiAlMDJ4IiwKKyAgICAg
ICAgICAgICAgICAgICAgcmVxLT5sdW4sIGRhdGFfdHlwZSk7CisgICAgICAgIGNkX3Njc2lfY21k
X2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX0lOVkFMSURfQ0RCX0ZJ
RUxEKTsKKyAgICAgICAgcmV0dXJuOworICAgIH0KKworICAgIHJlcS0+cmVxX2xlbiA9IChyZXEt
PmNkYls3XSA8PCA4KSB8IHJlcS0+Y2RiWzhdOworICAgIHJlcS0+aW5fbGVuID0gKHJlcS0+cmVx
X2xlbiA8IFJESV9TVEFOREFSRF9MRU4pID8gcmVxLT5yZXFfbGVuIDogUkRJX1NUQU5EQVJEX0xF
TjsKKworICAgIG1lbXNldChvdXRidWYsIDAsIFJESV9TVEFOREFSRF9MRU4pOworICAgIG91dGJ1
ZlsxXSA9IFJESV9TVEFOREFSRF9MRU4gLSAyOyAvKiBsZW5ndGggZXhjbHVkaW5nIHRoZSBjb3Vu
dGVyIGl0c2VsZiAqLworICAgIG91dGJ1ZlsyXSA9IFJESV9OT05fRVJBWkFCTEUgfCBSRElfU0VT
U0lPTl9DT01QTEVURSB8IFJESV9ESVNDX0NPTVBMRVRFOworICAgIG91dGJ1ZlszXSA9IGZpcnN0
X3RyYWNrOyAvKiBvbiBkaXNrICovCisgICAgb3V0YnVmWzRdID0gbnVtX3Nlc3Npb25zICYgMHhm
ZjsgLyogbHNiICovCisgICAgb3V0YnVmWzVdID0gZmlyc3RfdHJhY2sgJiAweGZmOyAvKiBpbiBs
YXN0IHNlc3NvbiwgbHNiICovCisgICAgb3V0YnVmWzZdID0gbGFzdF90cmFjayAmIDB4ZmY7IC8q
IGluIGxhc3Qgc2Vzc29uLCBsc2IgKi8KKyAgICBvdXRidWZbOF0gPSBSRElfRElTQ19QTUFfVFlQ
RV9DRF9ST007CisgICAgb3V0YnVmWzldID0gKG51bV9zZXNzaW9ucyA+PiA4KSAmIDB4ZmY7IC8q
IG1zYiAqLworICAgIG91dGJ1ZlsxMF0gPSAoZmlyc3RfdHJhY2sgPj4gOCkgJiAweGZmOyAvKiBp
biBsYXN0IHNlc3NvbiwgbHNiICovCisgICAgb3V0YnVmWzExXSA9IChsYXN0X3RyYWNrID4+IDgp
ICYgMHhmZjsgLyogaW4gbGFzdCBzZXNzb24sIGxzYiAqLworCisgICAgU1BJQ0VfREVCVUcoInJl
YWRfZGlzY19pbmZvcm1hdGlvbiwgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQgIiBsZW46ICUiIEdf
R1VJTlQ2NF9GT1JNQVQsCisgICAgICAgICAgICAgICAgcmVxLT5sdW4sIHJlcS0+aW5fbGVuKTsK
KworICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2LCByZXEpOworfQorCisjZGVmaW5l
IFJUSV9BRERSX1RZUEVfTEJBICAgICAgICAgICAweDAwCisjZGVmaW5lIFJUSV9BRERSX1RZUEVf
VFJBQ0tfTlVNICAgICAweDAxCisjZGVmaW5lIFJUSV9BRERSX1RZUEVfU0VTU0lPTl9OVU0gICAw
eDAyCisKKyNkZWZpbmUgUlRJX1RSQUNLX05VTV9MRUFEX0lOICAgICAgIDB4MDAKKyNkZWZpbmUg
UlRJX1RSQUNLX05VTV9JTlZJU0lCTEUgICAgIDB4ZmYKKworI2RlZmluZSBUSUJfTEVOICAgICAg
ICAgICAgICAgICAgICAgMHgzNgorCisjZGVmaW5lIFRJQl9UUkFDS19NT0RFX0NEICAgICAgICAg
ICAweDA0CisjZGVmaW5lIFRJQl9EQVRBX01PREVfSVNPXzEwMTQ5ICAgICAweDAxCisKKyNkZWZp
bmUgVElCX0xSQV9WQUxJRCAgICAgICAgICAgICAgICgweDAxIDw8IDEpCisKK3N0YXRpYyB2b2lk
IGNkX3Njc2lfY21kX2dldF9yZWFkX3RyYWNrX2luZm9ybWF0aW9uKENkU2NzaUxVICpkZXYsIENk
U2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICB1aW50OF90ICpvdXRidWYgPSByZXEtPmJ1ZjsKKyAg
ICB1aW50MzJfdCB0cmFja19zaXplID0gZGV2LT5udW1fYmxvY2tzOworICAgIHVpbnQzMl90IGxh
c3RfYWRkciA9IHRyYWNrX3NpemUgLSAxOworICAgIHVpbnQzMl90IHRyYWNrX251bSA9IDE7Cisg
ICAgdWludDMyX3Qgc2Vzc2lvbl9udW0gPSAxOworICAgIHVpbnQzMl90IGFkZHJfdHlwZTsKKyAg
ICB1aW50MzJfdCBhZGRyX251bTsKKworICAgIHJlcS0+eGZlcl9kaXIgPSBTQ1NJX1hGRVJfRlJP
TV9ERVY7CisKKyAgICBhZGRyX3R5cGUgPSByZXEtPmNkYlsxXSAmIDB4MzsKKyAgICBhZGRyX251
bSA9IChyZXEtPmNkYlsyXSA8PCAyNCkgfCAocmVxLT5jZGJbM10gPDwgMTYpIHwKKyAgICAgICAg
ICAgICAgIChyZXEtPmNkYls0XSA8PCA4KSB8IHJlcS0+Y2RiWzVdOworCisgICAgc3dpdGNoIChh
ZGRyX3R5cGUpIHsKKyAgICBjYXNlIFJUSV9BRERSX1RZUEVfTEJBOgorICAgICAgICBpZiAoYWRk
cl9udW0gPiBsYXN0X2FkZHIpIHsKKyAgICAgICAgICAgIFNQSUNFX0RFQlVHKCJyZWFkX3RyYWNr
X2luZm9ybWF0aW9uLCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVAorICAgICAgICAgICAgICAgICAg
ICAgICAgIiBhZGRyX3R5cGUgTEJBOiAlIiBHX0dVSU5UMzJfRk9STUFUCisgICAgICAgICAgICAg
ICAgICAgICAgICAiIGludmFsaWQgTEJBOiAlIiBHX0dVSU5UMzJfRk9STUFULAorICAgICAgICAg
ICAgICAgICAgICAgICAgcmVxLT5sdW4sIGFkZHJfdHlwZSwgYWRkcl9udW0pOworICAgICAgICAg
ICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVf
SU5WQUxJRF9DREJfRklFTEQpOworICAgICAgICAgICAgcmV0dXJuOworICAgICAgICB9CisgICAg
ICAgIGJyZWFrOworICAgIGNhc2UgUlRJX0FERFJfVFlQRV9UUkFDS19OVU06CisgICAgICAgIGlm
IChhZGRyX251bSAhPSB0cmFja19udW0pIHsKKyAgICAgICAgICAgIFNQSUNFX0RFQlVHKCJyZWFk
X3RyYWNrX2luZm9ybWF0aW9uLCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVAorICAgICAgICAgICAg
ICAgICAgICAgICAgIiBhZGRyX3R5cGUgdHJhY2s6ICUiIEdfR1VJTlQzMl9GT1JNQVQKKyAgICAg
ICAgICAgICAgICAgICAgICAgICIgaW52YWxpZCB0cmFjazogJSIgR19HVUlOVDMyX0ZPUk1BVCwK
KyAgICAgICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBhZGRyX3R5cGUsIGFkZHJfbnVtKTsK
KyAgICAgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZz
ZW5zZV9jb2RlX0lOVkFMSURfQ0RCX0ZJRUxEKTsKKyAgICAgICAgICAgIHJldHVybjsKKyAgICAg
ICAgfQorICAgICAgICBicmVhazsKKyAgICBjYXNlIFJUSV9BRERSX1RZUEVfU0VTU0lPTl9OVU06
CisgICAgICAgIGlmIChhZGRyX251bSAhPSBzZXNzaW9uX251bSkgeworICAgICAgICAgICAgU1BJ
Q0VfREVCVUcoInJlYWRfdHJhY2tfaW5mb3JtYXRpb24sIGx1bjolIiBHX0dVSU5UMzJfRk9STUFU
CisgICAgICAgICAgICAgICAgICAgICAgICAiIGFkZHJfdHlwZSBzZXNzaW9uOiAlIiBHX0dVSU5U
MzJfRk9STUFUCisgICAgICAgICAgICAgICAgICAgICAgICAiIGludmFsaWQgc2Vzc2lvbjogJSIg
R19HVUlOVDMyX0ZPUk1BVCwKKyAgICAgICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBhZGRy
X3R5cGUsIGFkZHJfbnVtKTsKKyAgICAgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNr
X2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX0lOVkFMSURfQ0RCX0ZJRUxEKTsKKyAgICAgICAg
ICAgIHJldHVybjsKKyAgICAgICAgfQorICAgICAgICBicmVhazsKKyAgICBkZWZhdWx0OgorICAg
ICAgICBTUElDRV9ERUJVRygicmVhZF90cmFja19pbmZvcm1hdGlvbiwgbHVuOiUiIEdfR1VJTlQz
Ml9GT1JNQVQKKyAgICAgICAgICAgICAgICAgICAgImludmFsaWQgYWRkcl90eXBlOiAlIiBHX0dV
SU5UMzJfRk9STUFUCisgICAgICAgICAgICAgICAgICAgICIgYWRkcl9udW06ICUiIEdfR1VJTlQz
Ml9GT1JNQVQsCisgICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBhZGRyX3R5cGUsIGFkZHJf
bnVtKTsKKyAgICAgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwg
JnNlbnNlX2NvZGVfSU5WQUxJRF9DREJfRklFTEQpOworICAgICAgICByZXR1cm47CisgICAgfQor
CisgICAgcmVxLT5yZXFfbGVuID0gKHJlcS0+Y2RiWzddIDw8IDgpIHwgcmVxLT5jZGJbOF07Cisg
ICAgcmVxLT5pbl9sZW4gPSAocmVxLT5yZXFfbGVuIDwgVElCX0xFTikgPyByZXEtPnJlcV9sZW4g
OiBUSUJfTEVOOworCisgICAgbWVtc2V0KG91dGJ1ZiwgMCwgVElCX0xFTik7CisgICAgb3V0YnVm
WzFdID0gVElCX0xFTiAtIDI7CisgICAgb3V0YnVmWzJdID0gc2Vzc2lvbl9udW07CisgICAgb3V0
YnVmWzNdID0gdHJhY2tfbnVtOworICAgIG91dGJ1Zls1XSA9IFRJQl9UUkFDS19NT0RFX0NEICYg
MHgwZjsKKyAgICBvdXRidWZbNl0gPSBUSUJfREFUQV9NT0RFX0lTT18xMDE0OSAmIDB4MGY7Cisg
ICAgb3V0YnVmWzddID0gVElCX0xSQV9WQUxJRDsKKworICAgIC8qIFRyYWNrIHNpemUgKi8KKyAg
ICBvdXRidWZbMjRdID0gKHRyYWNrX3NpemUgPj4gMjQpICYgMHhmZjsKKyAgICBvdXRidWZbMjVd
ID0gKHRyYWNrX3NpemUgPj4gMTYpICYgMHhmZjsKKyAgICBvdXRidWZbMjZdID0gKHRyYWNrX3Np
emUgPj4gOCkgJiAweGZmOworICAgIG91dGJ1ZlsyN10gPSAodHJhY2tfc2l6ZSkgJiAweGZmOwor
CisgICAgLyogTGFzdCByZWNvcmRlZCBhZGRyZXNzICovCisgICAgb3V0YnVmWzI4XSA9IChsYXN0
X2FkZHIgPj4gMjQpICYgMHhmZjsKKyAgICBvdXRidWZbMjldID0gKGxhc3RfYWRkciA+PiAxNikg
JiAweGZmOworICAgIG91dGJ1ZlszMF0gPSAobGFzdF9hZGRyID4+IDgpICYgMHhmZjsKKyAgICBv
dXRidWZbMzFdID0gKGxhc3RfYWRkcikgJiAweGZmOworCisgICAgU1BJQ0VfREVCVUcoInJlYWRf
dHJhY2tfaW5mb3JtYXRpb24sIGx1bjolIiBHX0dVSU5UMzJfRk9STUFUCisgICAgICAgICAgICAg
ICAgImFkZHJfdHlwZTogJSIgR19HVUlOVDMyX0ZPUk1BVCAiIGFkZHJfbnVtOiAlIiBHX0dVSU5U
MzJfRk9STUFULAorICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBhZGRyX3R5cGUsIGFkZHJfbnVt
KTsKKworICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2LCByZXEpOworfQorCisjZGVm
aW5lIFJFQURfVE9DX1RSQUNLX0RFU0NfTEVOICAgICA4CisjZGVmaW5lIFJFQURfVE9DX1JFU1Bf
TEVOICAgICAgICAgICAoNCArIDIqUkVBRF9UT0NfVFJBQ0tfREVTQ19MRU4pCisKK3N0YXRpYyB2
b2lkIGNkX3Njc2lfY21kX3JlYWRfdG9jKENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJl
cSkKK3sKKyAgICB1aW50OF90ICpvdXRidWYgPSByZXEtPmJ1ZjsKKyAgICB1aW50MzJfdCBtc2Ys
IGZvcm1hdCwgdHJhY2tfbnVtOworICAgIHVpbnQzMl90IGxhc3RfYmxrID0gZGV2LT5udW1fYmxv
Y2tzIC0gMTsKKworICAgIHJlcS0+eGZlcl9kaXIgPSBTQ1NJX1hGRVJfRlJPTV9ERVY7CisKKyAg
ICBtc2YgPSAocmVxLT5jZGJbMV0gPj4gMSkgJiAweDE7CisgICAgZm9ybWF0ID0gcmVxLT5jZGJb
Ml0gJiAweGY7CisgICAgdHJhY2tfbnVtID0gcmVxLT5jZGJbNl07CisKKyAgICByZXEtPnJlcV9s
ZW4gPSAocmVxLT5jZGJbN10gPDwgOCkgfCByZXEtPmNkYls4XTsKKyAgICByZXEtPmluX2xlbiA9
IChyZXEtPnJlcV9sZW4gPCBSRUFEX1RPQ19SRVNQX0xFTikgPyByZXEtPnJlcV9sZW4gOiBSRUFE
X1RPQ19SRVNQX0xFTjsKKworICAgIG1lbXNldChvdXRidWYsIDAsIFJFQURfVE9DX1JFU1BfTEVO
KTsKKyAgICBvdXRidWZbMV0gPSBSRUFEX1RPQ19SRVNQX0xFTiAtIDI7IC8qIGxlbmd0aCBleGNs
dWRpbmcgdGhlIGNvdW50ZXIgaXRzZWxmICovCisgICAgb3V0YnVmWzJdID0gMTsgLyogZmlyc3Qg
dHJhY2svc2Vzc2lvbiAqLworICAgIG91dGJ1ZlszXSA9IDE7IC8qIGxhc3QgdHJhY2svc2Vzc2lv
biAqLworCisgICAgb3V0YnVmWzVdID0gMHgwNDsgLyogRGF0YSBDRCwgbm8gUS1zdWJjaGFubmVs
ICovCisgICAgb3V0YnVmWzZdID0gMHgwMTsgLyogVHJhY2sgbnVtYmVyICovCisgICAgb3V0YnVm
WzEwXSA9IG1zZiA/IDB4MDIgOiAweDA7CisKKyAgICBvdXRidWZbMTNdID0gMHgwNDsgLyogRGF0
YSBDRCwgbm8gUS1zdWJjaGFubmVsICovCisgICAgb3V0YnVmWzE0XSA9IDB4YWE7IC8qIFRyYWNr
IG51bWJlciAqLworICAgIGlmIChtc2YpIHsKKyAgICAgICAgbGFzdF9ibGsgPSAweGZmMzAwMDAw
OworICAgIH0KKyAgICBvdXRidWZbMTZdID0gbGFzdF9ibGsgPj4gMjQ7CisgICAgb3V0YnVmWzE3
XSA9IGxhc3RfYmxrID4+IDE2OworICAgIG91dGJ1ZlsxOF0gPSBsYXN0X2JsayA+PiA4OworICAg
IG91dGJ1ZlsxOV0gPSBsYXN0X2JsazsKKworICAgIFNQSUNFX0RFQlVHKCJyZWFkX3RvYywgbHVu
OiUiIEdfR1VJTlQzMl9GT1JNQVQgIiBsZW46ICUiIEdfR1VJTlQ2NF9GT1JNQVQKKyAgICAgICAg
ICAgICAgICAiIG1zZjogJXggZm9ybWF0OiAweCUwMnggdHJhY2svc2Vzc2lvbjogMHglMDJ4IiwK
KyAgICAgICAgICAgICAgICByZXEtPmx1biwgcmVxLT5pbl9sZW4sIG1zZiwgZm9ybWF0LCB0cmFj
a19udW0pOworCisgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfZ29vZChkZXYsIHJlcSk7Cit9CisK
KyNkZWZpbmUgQ0RfTU9ERV9QQVJBTV82X0xFTl9IRUFERVIgICAgICAgICAgICAgIDQKKyNkZWZp
bmUgQ0RfTU9ERV9QQVJBTV8xMF9MRU5fSEVBREVSICAgICAgICAgICAgIDgKKworI2RlZmluZSBD
RF9NT0RFX1BBR0VfTEVOX1JXX0VSUk9SICAgICAgICAgICAgICAgMTIKKworc3RhdGljIHVpbnQz
Ml90IGNkX3Njc2lfYWRkX21vZGVfcGFnZV9yd19lcnJvcl9yZWNvdmVyeShDZFNjc2lMVSAqZGV2
LCB1aW50OF90ICpvdXRidWYpCit7CisgICAgdWludDMyX3QgcGFnZV9sZW4gPSBDRF9NT0RFX1BB
R0VfTEVOX1JXX0VSUk9SOworCisgICAgb3V0YnVmWzBdID0gTU9ERV9QQUdFX1JfV19FUlJPUjsK
KyAgICBvdXRidWZbMV0gPSBDRF9NT0RFX1BBR0VfTEVOX1JXX0VSUk9SIC0gMjsKKyAgICBvdXRi
dWZbM10gPSAxOyAvKiByZWFkIHJldHJ5IGNvdW50ICovCisKKyAgICByZXR1cm4gcGFnZV9sZW47
Cit9CisKKyNkZWZpbmUgQ0RfTU9ERV9QQUdFX0xFTl9QT1dFUiAgICAgICAgICAgICAgICAgIDEy
CisKK3N0YXRpYyB1aW50MzJfdCBjZF9zY3NpX2FkZF9tb2RlX3BhZ2VfcG93ZXJfY29uZGl0aW9u
KENkU2NzaUxVICpkZXYsIHVpbnQ4X3QgKm91dGJ1ZikKK3sKKyAgICB1aW50MzJfdCBwYWdlX2xl
biA9IENEX01PREVfUEFHRV9MRU5fUE9XRVI7CisKKyAgICBvdXRidWZbMF0gPSBNT0RFX1BBR0Vf
UE9XRVI7CisgICAgb3V0YnVmWzFdID0gQ0RfTU9ERV9QQUdFX0xFTl9QT1dFUiAtIDI7CisKKyAg
ICByZXR1cm4gcGFnZV9sZW47Cit9CisKKyNkZWZpbmUgQ0RfTU9ERV9QQUdFX0xFTl9GQVVMVF9G
QUlMICAgICAgICAgICAgIDEyCisjZGVmaW5lIENEX01PREVfUEFHRV9GQVVMVF9GQUlMX0ZMQUdf
UEVSRiAgICAgICAweDgwCisKK3N0YXRpYyB1aW50MzJfdCBjZF9zY3NpX2FkZF9tb2RlX3BhZ2Vf
ZmF1bHRfcmVwb3J0aW5nKENkU2NzaUxVICpkZXYsIHVpbnQ4X3QgKm91dGJ1ZikKK3sKKyAgICB1
aW50MzJfdCBwYWdlX2xlbiA9IENEX01PREVfUEFHRV9MRU5fRkFVTFRfRkFJTDsKKworICAgIG91
dGJ1ZlswXSA9IE1PREVfUEFHRV9GQVVMVF9GQUlMOworICAgIG91dGJ1ZlsxXSA9IENEX01PREVf
UEFHRV9MRU5fRkFVTFRfRkFJTCAtIDI7CisgICAgb3V0YnVmWzJdIHw9IENEX01PREVfUEFHRV9G
QVVMVF9GQUlMX0ZMQUdfUEVSRjsKKworICAgIHJldHVybiBwYWdlX2xlbjsKK30KKworI2RlZmlu
ZSBDRF9NT0RFX1BBR0VfTEVOX0NBUFNfTUVDSF9TVEFUVVNfUk8gICAgMjYKKy8qIGJ5dGUgMiAq
LworI2RlZmluZSBDRF9NT0RFX1BBR0VfQ0FQU19DRF9SX1JFQUQgICAgICAgICAgICAgMHgwMQor
I2RlZmluZSBDRF9NT0RFX1BBR0VfQ0FQU19DRF9SV19SRUFEICAgICAgICAgICAgKDB4MDEgPDwg
MSkKKyNkZWZpbmUgQ0RfTU9ERV9QQUdFX0NBUFNfRFZEX1JPTV9SRUFEICAgICAgICAgICgweDAx
IDw8IDMpCisjZGVmaW5lIENEX01PREVfUEFHRV9DQVBTX0RWRF9SX1JFQUQgICAgICAgICAgICAo
MHgwMSA8PCA0KQorI2RlZmluZSBDRF9NT0RFX1BBR0VfQ0FQU19EVkRfUkFNX1JFQUQgICAgICAg
ICAgKDB4MDEgPDwgNSkKKy8qIGJ5dGUgNiAqLworI2RlZmluZSBDRF9NT0RFX1BBR0VfQ0FQU19M
T0NLX1NVUFBPUlQgICAgICAgICAgKDB4MDEpCisjZGVmaW5lIENEX01PREVfUEFHRV9DQVBTX0xP
Q0tfU1RBVEUgICAgICAgICAgICAoMHgwMSA8PCAxKQorI2RlZmluZSBDRF9NT0RFX1BBR0VfQ0FQ
U19QUkVWRU5UX0pVTVBFUiAgICAgICAgKDB4MDEgPDwgMikKKyNkZWZpbmUgQ0RfTU9ERV9QQUdF
X0NBUFNfRUpFQ1QgICAgICAgICAgICAgICAgICgweDAxIDw8IDMpCisjZGVmaW5lIENEX01PREVf
UEFHRV9DQVBTX0xPQURJTkdfVFJBWSAgICAgICAgICAoMHgwMSA8PCA1KQorCitzdGF0aWMgdWlu
dDMyX3QgY2Rfc2NzaV9hZGRfbW9kZV9wYWdlX2NhcHNfbWVjaF9zdGF0dXMoQ2RTY3NpTFUgKmRl
diwgdWludDhfdCAqb3V0YnVmKQoreworICAgIHVpbnQzMl90IHBhZ2VfbGVuID0gQ0RfTU9ERV9Q
QUdFX0xFTl9DQVBTX01FQ0hfU1RBVFVTX1JPOyAvKiBubyB3cml0ZSAqLworCisgICAgb3V0YnVm
WzBdID0gTU9ERV9QQUdFX0NBUFNfTUVDSF9TVEFUVVM7CisgICAgb3V0YnVmWzFdID0gcGFnZV9s
ZW47CisgICAgb3V0YnVmWzJdID0gQ0RfTU9ERV9QQUdFX0NBUFNfQ0RfUl9SRUFEIHwgQ0RfTU9E
RV9QQUdFX0NBUFNfQ0RfUldfUkVBRCB8CisgICAgICAgICAgICAgICAgQ0RfTU9ERV9QQUdFX0NB
UFNfRFZEX1JPTV9SRUFEIHwgQ0RfTU9ERV9QQUdFX0NBUFNfRFZEX1JfUkVBRCB8CisgICAgICAg
ICAgICAgICAgQ0RfTU9ERV9QQUdFX0NBUFNfRFZEX1JBTV9SRUFEOworICAgIG91dGJ1Zls2XSA9
IENEX01PREVfUEFHRV9DQVBTX0xPQURJTkdfVFJBWSB8IENEX01PREVfUEFHRV9DQVBTX0VKRUNU
IHwgQ0RfTU9ERV9QQUdFX0NBUFNfTE9DS19TVVBQT1JUOworICAgIGlmIChkZXYtPnByZXZlbnRf
bWVkaWFfcmVtb3ZhbCkgeworICAgICAgICBvdXRidWZbNl0gfD0gQ0RfTU9ERV9QQUdFX0NBUFNf
TE9DS19TVEFURTsKKyAgICB9CisKKyAgICByZXR1cm4gcGFnZV9sZW47Cit9CisKK3N0YXRpYyB2
b2lkIGNkX3Njc2lfY21kX21vZGVfc2Vuc2VfMTAoQ2RTY3NpTFUgKmRldiwgQ2RTY3NpUmVxdWVz
dCAqcmVxKQoreworICAgIHVpbnQ4X3QgKm91dGJ1ZiA9IHJlcS0+YnVmOworICAgIGludCBsb25n
X2xiYSwgZGJkLCBwYWdlLCBzdWJfcGFnZSwgcGM7CisgICAgdWludDMyX3QgcmVzcF9sZW4gPSBD
RF9NT0RFX1BBUkFNXzEwX0xFTl9IRUFERVI7CisKKyAgICByZXEtPnhmZXJfZGlyID0gU0NTSV9Y
RkVSX0ZST01fREVWOworCisgICAgbG9uZ19sYmEgPSAocmVxLT5jZGJbMV0gPj4gNCkgJiAweDE7
CisgICAgZGJkID0gKHJlcS0+Y2RiWzFdID4+IDMpICYgMHgxOworICAgIHBhZ2UgPSByZXEtPmNk
YlsyXSAmIDB4M2Y7CisgICAgcGMgPSByZXEtPmNkYlsyXSA+PiA2OworICAgIHN1Yl9wYWdlID0g
cmVxLT5jZGJbM10gJiAweGY7CisKKyAgICByZXEtPnJlcV9sZW4gPSAocmVxLT5jZGJbN10gPDwg
OCkgfCByZXEtPmNkYls4XTsKKworICAgIG1lbXNldChvdXRidWYsIDAsIHJlcS0+cmVxX2xlbik7
CisgICAgb3V0YnVmWzJdID0gIDA7IC8qIG1lZGl1bSB0eXBlICovCisKKyAgICBzd2l0Y2ggKHBh
Z2UpIHsKKyAgICBjYXNlIE1PREVfUEFHRV9SX1dfRVJST1I6CisgICAgICAgIC8qIFJlYWQvV3Jp
dGUgRXJyb3IgUmVjb3ZlcnkgKi8KKyAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9hZGRfbW9k
ZV9wYWdlX3J3X2Vycm9yX3JlY292ZXJ5KGRldiwgb3V0YnVmICsgcmVzcF9sZW4pOworICAgICAg
ICBicmVhazsKKyAgICBjYXNlIE1PREVfUEFHRV9QT1dFUjoKKyAgICAgICAgLyogUG93ZXIgQ29u
ZGlzdGlvbnMgKi8KKyAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9hZGRfbW9kZV9wYWdlX3Bv
d2VyX2NvbmRpdGlvbihkZXYsIG91dGJ1ZiArIHJlc3BfbGVuKTsKKyAgICAgICAgYnJlYWs7Cisg
ICAgY2FzZSBNT0RFX1BBR0VfRkFVTFRfRkFJTDoKKyAgICAgICAgLyogRmF1bHQgLyBGYWlsdXJl
IFJlcG9ydGluZyBDb250cm9sICovCisgICAgICAgIHJlc3BfbGVuICs9IGNkX3Njc2lfYWRkX21v
ZGVfcGFnZV9mYXVsdF9yZXBvcnRpbmcoZGV2LCBvdXRidWYgKyByZXNwX2xlbik7CisgICAgICAg
IGJyZWFrOworICAgIGNhc2UgTU9ERV9QQUdFX0NBUFNfTUVDSF9TVEFUVVM6CisgICAgICAgIHJl
c3BfbGVuICs9IGNkX3Njc2lfYWRkX21vZGVfcGFnZV9jYXBzX21lY2hfc3RhdHVzKGRldiwgb3V0
YnVmICsgcmVzcF9sZW4pOworICAgICAgICBicmVhazsKKworICAgIC8qIG5vdCBpbXBsZW1lbnRl
ZCAqLworICAgIGNhc2UgTU9ERV9QQUdFX1dSSVRFX1BBUkFNRVRFUjogLyogV3JpdGVyIFBhcmFt
ZXRlcnMgKi8KKyAgICBjYXNlIE1PREVfUEFHRV9NUlc6CisgICAgY2FzZSBNT0RFX1BBR0VfTVJX
X1ZFTkRPUjogLyogTVJXIChNb3VudCBSYWluaWVyIFJlLXdyaXRhYmxlIERpc2tzICovCisgICAg
Y2FzZSBNT0RFX1BBR0VfQ0RfREVWSUNFOiAvKiBDRCBEZXZpY2UgcGFyYW1ldGVycyAqLworICAg
IGNhc2UgTU9ERV9QQUdFX1RPX1BST1RFQ1Q6IC8qIFRpbWUtb3V0IGFuZCBQcm90ZWN0ICovCisg
ICAgZGVmYXVsdDoKKyAgICAgICAgU1BJQ0VfREVCVUcoIm1vZGVfc2Vuc2VfMTAsIGx1bjolIiBH
X0dVSU5UMzJfRk9STUFUCisgICAgICAgICAgICAgICAgICAgICIgcGFnZSAweCV4IG5vdCBpbXBs
ZW1lbnRlZCIsCisgICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuLCAodW5zaWduZWQpcGFnZSk7
CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5z
ZV9jb2RlX0lOVkFMSURfQ0RCX0ZJRUxEKTsKKyAgICAgICAgcmV0dXJuOworICAgIH0KKworICAg
IG91dGJ1ZlswXSA9ICgocmVzcF9sZW4gLSAyKSA+PiA4KSAmIDB4ZmY7CisgICAgb3V0YnVmWzFd
ID0gKHJlc3BfbGVuIC0gMikgJiAweGZmOworCisgICAgcmVxLT5pbl9sZW4gPSAocmVxLT5yZXFf
bGVuIDwgcmVzcF9sZW4pID8gcmVxLT5yZXFfbGVuIDogcmVzcF9sZW47CisKKyAgICBTUElDRV9E
RUJVRygibW9kZV9zZW5zZV8xMCwgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQKKyAgICAgICAgICAg
ICAgICAiIGxvbmdfbGJhICVkLCBkYmQgJWQsIHBhZ2UgJWQsIHN1Yl9wYWdlICVkLCBwYyAlZDsg
IgorICAgICAgICAgICAgICAgICJyZXNwX2xlbiAlIiBHX0dVSU5UMzJfRk9STUFULAorICAgICAg
ICAgICAgICAgIHJlcS0+bHVuLCBsb25nX2xiYSwgZGJkLCBwYWdlLCBzdWJfcGFnZSwgcGMsIHJl
c3BfbGVuKTsKKworICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2LCByZXEpOworfQor
CitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9tb2RlX3NlbGVjdF82KENkU2NzaUxVICpkZXYsIENk
U2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICB1aW50OF90ICpibG9ja19kZXNjX2RhdGEsICptb2Rl
X2RhdGE7CisgICAgdWludDMyX3QgcGFnZV9mb3JtYXQsIHNhdmVfcGFnZXMsIGxpc3RfbGVuOyAv
KiBjZGIgKi8KKyAgICB1aW50MzJfdCBudW1fYmxvY2tzID0gMCwgYmxvY2tfbGVuID0gMDsgLyog
YmxvY2sgZGVzY3JpcHRvciAqLworICAgIHVpbnQzMl90IG1vZGVfbGVuLCBtZWRpdW1fdHlwZSwg
ZGV2X3BhcmFtLCBibG9ja19kZXNjX2xlbjsgLyogbW9kZSBwYXJhbSBoZWFkZXIgKi8KKyAgICB1
aW50MzJfdCBwYWdlX251bSA9IDAsIHBhZ2VfbGVuID0gMDsgLyogbW9kZSBwYWdlICovCisKKyAg
ICBwYWdlX2Zvcm1hdCA9IChyZXEtPmNkYlsxXSA+PiA0KSAmIDB4MTsKKyAgICBzYXZlX3BhZ2Vz
ID0gcmVxLT5jZGJbMV0gJiAweDE7CisgICAgbGlzdF9sZW4gPSByZXEtPmNkYls0XTsKKworICAg
IGlmIChsaXN0X2xlbiA+IHJlcS0+YnVmX2xlbikgeworICAgICAgICBTUElDRV9ERUJVRygibW9k
ZV9zZWxlY3RfNiwgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQKKyAgICAgICAgICAgICAgICAgICAg
IiBwZjolIiBHX0dVSU5UMzJfRk9STUFUICIgc3A6JSIgR19HVUlOVDMyX0ZPUk1BVAorICAgICAg
ICAgICAgICAgICAgICAiIGxpc3RfbGVuOiUiIEdfR1VJTlQzMl9GT1JNQVQgIiBleGNlZWRzIGRh
dGFfbGVuOiUiIEdfR1VJTlQzMl9GT1JNQVQsCisgICAgICAgICAgICAgICAgICAgIHJlcS0+bHVu
LCBwYWdlX2Zvcm1hdCwgc2F2ZV9wYWdlcywgbGlzdF9sZW4sIHJlcS0+YnVmX2xlbik7CisgICAg
ICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2Rl
X0lOVkFMSURfUEFSQU1fTEVOKTsKKyAgICAgICAgcmV0dXJuOworICAgIH0KKworICAgIG1vZGVf
bGVuID0gcmVxLT5idWZbMF07CisgICAgbWVkaXVtX3R5cGUgPSByZXEtPmJ1ZlsxXTsKKyAgICBk
ZXZfcGFyYW0gPSByZXEtPmJ1ZlsyXTsKKyAgICBibG9ja19kZXNjX2xlbiA9IHJlcS0+YnVmWzNd
OworCisgICAgaWYgKGJsb2NrX2Rlc2NfbGVuKSB7CisgICAgICAgIGJsb2NrX2Rlc2NfZGF0YSA9
ICZyZXEtPmJ1ZltDRF9NT0RFX1BBUkFNXzZfTEVOX0hFQURFUl07CisgICAgICAgIG51bV9ibG9j
a3MgPSAoYmxvY2tfZGVzY19kYXRhWzNdIDw8IDE2KSB8IChibG9ja19kZXNjX2RhdGFbMl0gPDwg
OCkgfCBibG9ja19kZXNjX2RhdGFbM107CisgICAgICAgIGJsb2NrX2xlbiA9IChibG9ja19kZXNj
X2RhdGFbNV0gPDwgMTYpIHwgKGJsb2NrX2Rlc2NfZGF0YVs2XSA8PCA4KSB8IGJsb2NrX2Rlc2Nf
ZGF0YVs3XTsKKyAgICB9CisKKyAgICBpZiAobW9kZV9sZW4pIHsKKyAgICAgICAgbW9kZV9kYXRh
ID0gJnJlcS0+YnVmW0NEX01PREVfUEFSQU1fNl9MRU5fSEVBREVSXTsKKyAgICAgICAgaWYgKGJs
b2NrX2Rlc2NfbGVuKSB7CisgICAgICAgICAgICBtb2RlX2RhdGEgKz0gYmxvY2tfZGVzY19sZW47
CisgICAgICAgIH0KKyAgICAgICAgcGFnZV9udW0gPSBtb2RlX2RhdGFbMF0gJiAweDNmOworICAg
ICAgICBwYWdlX2xlbiA9IG1vZGVfZGF0YVsxXTsKKyAgICB9CisKKyAgICBTUElDRV9ERUJVRygi
bW9kZV9zZWxlY3RfNiwgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQKKyAgICAgICAgICAgICAgICAi
IHBmOiUiIEdfR1VJTlQzMl9GT1JNQVQgIiBzcDolIiBHX0dVSU5UMzJfRk9STUFUCisgICAgICAg
ICAgICAgICAgIiBsaXN0X2xlbjolIiBHX0dVSU5UMzJfRk9STUFUICIgZGF0YV9sZW46JSIgR19H
VUlOVDMyX0ZPUk1BVAorICAgICAgICAgICAgICAgICIgbW9kZV9sZW46JSIgR19HVUlOVDMyX0ZP
Uk1BVCAiIG1lZGl1bTolIiBHX0dVSU5UMzJfRk9STUFUCisgICAgICAgICAgICAgICAgIiBkZXZf
cGFyYW06JSIgR19HVUlOVDMyX0ZPUk1BVCAiIGJsa19kZXNjX2xlbjolIiBHX0dVSU5UMzJfRk9S
TUFUCisgICAgICAgICAgICAgICAgIiBudW1fYmxvY2tzOiUiIEdfR1VJTlQzMl9GT1JNQVQgIiBi
bG9ja19sZW46JSIgR19HVUlOVDMyX0ZPUk1BVAorICAgICAgICAgICAgICAgICIgcGFnZV9udW06
JSIgR19HVUlOVDMyX0ZPUk1BVCAiIHBhZ2VfbGVuOiUiIEdfR1VJTlQzMl9GT1JNQVQsCisgICAg
ICAgICAgICAgICAgcmVxLT5sdW4sIHBhZ2VfZm9ybWF0LCBzYXZlX3BhZ2VzLCBsaXN0X2xlbiwg
cmVxLT5idWZfbGVuLAorICAgICAgICAgICAgICAgIG1vZGVfbGVuLCBtZWRpdW1fdHlwZSwgZGV2
X3BhcmFtLCBibG9ja19kZXNjX2xlbiwKKyAgICAgICAgICAgICAgICBudW1fYmxvY2tzLCBibG9j
a19sZW4sCisgICAgICAgICAgICAgICAgcGFnZV9udW0sIHBhZ2VfbGVuKTsKKworICAgIGNkX3Nj
c2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2LCByZXEpOworfQorCitzdGF0aWMgdm9pZCBjZF9zY3Np
X2NtZF9tb2RlX3NlbGVjdF8xMChDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7
CisgICAgdWludDMyX3QgcGFnZV9mb3JtYXQsIHNhdmVfcGFnZXMsIGxpc3RfbGVuOworCisgICAg
cGFnZV9mb3JtYXQgPSAocmVxLT5jZGJbMV0gPj4gNCkgJiAweDE7CisgICAgc2F2ZV9wYWdlcyA9
IHJlcS0+Y2RiWzFdICYgMHgxOworICAgIGxpc3RfbGVuID0gKHJlcS0+Y2RiWzddIDw8IDgpIHwg
cmVxLT5jZGJbOF07CisKKyAgICBpZiAobGlzdF9sZW4gPiByZXEtPmJ1Zl9sZW4pIHsKKyAgICAg
ICAgU1BJQ0VfREVCVUcoIm1vZGVfc2VsZWN0XzEwLCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVAor
ICAgICAgICAgICAgICAgICAgICAiIHBmOiUiIEdfR1VJTlQzMl9GT1JNQVQgIiBzcDolIiBHX0dV
SU5UMzJfRk9STUFUCisgICAgICAgICAgICAgICAgICAgICIgbGlzdF9sZW46JSIgR19HVUlOVDMy
X0ZPUk1BVCAiIGV4Y2VlZHMgZGF0YV9sZW46JSIgR19HVUlOVDMyX0ZPUk1BVCwKKyAgICAgICAg
ICAgICAgICAgICAgcmVxLT5sdW4sIHBhZ2VfZm9ybWF0LCBzYXZlX3BhZ2VzLCBsaXN0X2xlbiwg
cmVxLT5idWZfbGVuKTsKKyAgICAgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChk
ZXYsIHJlcSwgJnNlbnNlX2NvZGVfSU5WQUxJRF9QQVJBTV9MRU4pOworICAgICAgICByZXR1cm47
CisgICAgfQorCisgICAgU1BJQ0VfREVCVUcoIm1vZGVfc2VsZWN0XzEwLCBsdW46JSIgR19HVUlO
VDMyX0ZPUk1BVAorICAgICAgICAgICAgICAgICIgcGY6JSIgR19HVUlOVDMyX0ZPUk1BVCAiIHNw
OiUiIEdfR1VJTlQzMl9GT1JNQVQKKyAgICAgICAgICAgICAgICAiIGxpc3RfbGVuOiUiIEdfR1VJ
TlQzMl9GT1JNQVQgIiBkYXRhX2xlbjolIiBHX0dVSU5UMzJfRk9STUFULAorICAgICAgICAgICAg
ICAgIHJlcS0+bHVuLCBwYWdlX2Zvcm1hdCwgc2F2ZV9wYWdlcywgbGlzdF9sZW4sIHJlcS0+YnVm
X2xlbik7CisKKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKwor
I2RlZmluZSBDRF9GRUFUVVJFX0hFQURFUl9MRU4gICAgICAgICAgICAgICA4CisjZGVmaW5lIENE
X0ZFQVRVUkVfREVTQ19MRU4gICAgICAgICAgICAgICAgIDQKKworI2RlZmluZSBDRF9QUk9GSUxF
X0RFU0NfTEVOICAgICAgICAgICAgICAgICA0CisjZGVmaW5lIENEX1BST0ZJTEVfQ1VSUkVOVCAg
ICAgICAgICAgICAgICAgIDB4MDEKKworLyogUHJvZmlsZXMgTGlzdCAqLworI2RlZmluZSBDRF9G
RUFUVVJFX05VTV9QUk9GSUxFU19MSVNUICAgICAgICAweDAwCisvKiBDb3JlIC0gQmFzaWMgRnVu
Y3Rpb25hbGl0eSAqLworI2RlZmluZSBDRF9GRUFUVVJFX05VTV9DT1JFICAgICAgICAgICAgICAg
ICAweDAxCisvKiBNb3JwaGluZyAtIFRoZSBkZXZpY2UgY2hhbmdlcyBpdHMgYmVoYXZpb3IgZHVl
IHRvIGV4dGVybmFsIGV2ZW50cyAqLworI2RlZmluZSBDRF9GRUFUVVJFX05VTV9NT1JQSCAgICAg
ICAgICAgICAgICAweDAyCisvKiBSZW1vdmFibGUgTWVkaXVtIC0gVGhlIG1lZGl1bSBtYXkgYmUg
cmVtb3ZlZCBmcm9tIHRoZSBkZXZpY2UgKi8KKyNkZWZpbmUgQ0RfRkVBVFVSRV9OVU1fUkVNT1ZB
QkxFICAgICAgICAgICAgMHgwMworLyogUmFuZG9tIFJlYWRhYmxlIC0gUFA9MSBSZWFkIGFiaWxp
dHkgZm9yIHN0b3JhZ2UgZGV2aWNlcyB3aXRoIHJhbmRvbSBhZGRyZXNzaW5nICovCisjZGVmaW5l
IENEX0ZFQVRVUkVfTlVNX1JBTkRPTV9SRUFEICAgICAgICAgIDB4MTAKKy8qIENEIFJlYWQgLSBU
aGUgYWJpbGl0eSB0byByZWFkIENEIHNwZWNpZmljIHN0cnVjdHVyZXMgKi8KKyNkZWZpbmUgQ0Rf
RkVBVFVSRV9OVU1fQ0RfUkVBRCAgICAgICAgICAgICAgMHgxRQorLyogRFZEIFJlYWQgLSBUaGUg
YWJpbGl0eSB0byByZWFkIERWRCBzcGVjaWZpYyBzdHJ1Y3R1cmVzICovCisjZGVmaW5lIENEX0ZF
QVRVUkVfTlVNX0RWRF9SRUFEICAgICAgICAgICAgIDB4MUYKKy8qIFBvd2VyIE1hbmFnZW1lbnQg
LSBJbml0aWF0b3IgYW5kIGRldmljZSBkaXJlY3RlZCBwb3dlciBtYW5hZ2VtZW50ICovCisjZGVm
aW5lIENEX0ZFQVRVUkVfTlVNX1BPV0VSX01OR1QgICAgICAgICAgIDB4MTAwCisvKiBUaW1lb3V0
ICovCisjZGVmaW5lIENEX0ZFQVRVUkVfTlVNX1RJTUVPVVQgICAgICAgICAgICAgIDB4MTA1CisK
KyNkZWZpbmUgQ0RfRkVBVFVSRV9SRVFfQUxMICAgICAgICAgICAgICAgICAgMAorI2RlZmluZSBD
RF9GRUFUVVJFX1JFUV9DVVJSRU5UICAgICAgICAgICAgICAxCisjZGVmaW5lIENEX0ZFQVRVUkVf
UkVRX1NJTkdMRSAgICAgICAgICAgICAgIDIKKworI2RlZmluZSBDRF9GRUFUVVJFX0NVUlJFTlQg
ICAgICAgICAgICAgICAgICAweDAxCisjZGVmaW5lIENEX0ZFQVRVUkVfUEVSU0lTVEVOVCAgICAg
ICAgICAgICAgIDB4MDIKKworI2RlZmluZSBDRF9GRUFUVVJFX1ZFUlNJT05fMSAgICAgICAgICAg
ICAgICAoMHgwMSA8PCAyKQorCisjZGVmaW5lIENEX0ZFQVRVUkVfUEhZU19JRl9TQ1NJICAgICAg
ICAgICAgIDB4MDEKKworI2RlZmluZSBDRF9GRUFUVVJFX1JFTU9WQUJMRV9MT0FESU5HX1RSQVkg
ICAoMHgwMSA8PCA1KQorI2RlZmluZSBDRF9GRUFUVVJFX1JFTU9WQUJMRV9FSkVDVCAgICAgICAg
ICAoMHgwMSA8PCAzKQorI2RlZmluZSBDRF9GRUFUVVJFX1JFTU9WQUJMRV9OT19QUlZOVF9KTVBS
ICAoMHgwMSA8PCAyKQorI2RlZmluZSBDRF9GRUFUVVJFX1JFTU9WQUJMRV9MT0NLICAgICAgICAg
ICAoMHgwMSkKKworc3RhdGljIGdib29sZWFuIGNkX3Njc2lfZmVhdHVyZV9yZXBvcnRhYmxlKHVp
bnQzMl90IGZlYXR1cmUsIHVpbnQzMl90IHN0YXJ0X2ZlYXR1cmUsIHVpbnQzMl90IHJlcV90eXBl
KQoreworICAgIHJldHVybiAocmVxX3R5cGUgPT0gQ0RfRkVBVFVSRV9SRVFfU0lOR0xFICYmIHN0
YXJ0X2ZlYXR1cmUgPT0gZmVhdHVyZSkgfHwKKyAgICAgICAgICAgKGZlYXR1cmUgPj0gc3RhcnRf
ZmVhdHVyZSk7Cit9CisKK3N0YXRpYyB1aW50MzJfdCBjZF9zY3NpX2FkZF9mZWF0dXJlX3Byb2Zp
bGVzX2xpc3QoQ2RTY3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVmLAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCBzdGFydF9mZWF0dXJl
LCB1aW50MzJfdCByZXFfdHlwZSkKK3sKKyAgICB1aW50OF90ICpwcm9maWxlID0gb3V0YnVmICsg
Q0RfRkVBVFVSRV9ERVNDX0xFTjsKKyAgICB1aW50MzJfdCBmZWF0dXJlX2xlbiA9IENEX0ZFQVRV
UkVfREVTQ19MRU47CisgICAgdWludDMyX3QgYWRkX2xlbiwgcHJvZmlsZV9udW07CisKKyAgICBp
ZiAoIWNkX3Njc2lfZmVhdHVyZV9yZXBvcnRhYmxlKENEX0ZFQVRVUkVfTlVNX1BST0ZJTEVTX0xJ
U1QsIHN0YXJ0X2ZlYXR1cmUsIHJlcV90eXBlKSkgeworICAgICAgICByZXR1cm4gMDsKKyAgICB9
CisgICAgLyogZmVhdHVyZSBkZXNjcmlwdG9yIGhlYWRlciAqLworICAgIG91dGJ1ZlswXSA9IChD
RF9GRUFUVVJFX05VTV9QUk9GSUxFU19MSVNUID4+IDgpICYgMHhmZjsKKyAgICBvdXRidWZbMV0g
PSBDRF9GRUFUVVJFX05VTV9QUk9GSUxFU19MSVNUICYgMHhmZjsKKyAgICBvdXRidWZbMl0gPSBD
RF9GRUFUVVJFX1BFUlNJU1RFTlQgfCBDRF9GRUFUVVJFX0NVUlJFTlQ7CisKKyAgICAvKiBEVkQt
Uk9NIHByb2ZpbGUgZGVzY3JpcHRvciAqLworICAgIGFkZF9sZW4gPSBDRF9QUk9GSUxFX0RFU0Nf
TEVOOyAvKiBzdGFydCB3aXRoIHNpbmdsZSBwcm9maWxlLCBhZGQgbGF0ZXIgKi8KKyAgICBwcm9m
aWxlX251bSA9IE1NQ19QUk9GSUxFX0RWRF9ST007CisKKyAgICBwcm9maWxlWzBdID0gKHByb2Zp
bGVfbnVtID4+IDgpICYgMHhmZjsgLyogZmVhdHVyZSBjb2RlICovCisgICAgcHJvZmlsZVsxXSA9
IHByb2ZpbGVfbnVtICYgMHhmZjsKKyAgICBwcm9maWxlWzJdID0gKCFkZXYtPmNkX3JvbSkgPyBD
RF9QUk9GSUxFX0NVUlJFTlQgOiAwOworCisgICAgLyogbmV4dCBwcm9maWxlICovCisgICAgYWRk
X2xlbiArPSBDRF9QUk9GSUxFX0RFU0NfTEVOOworICAgIHByb2ZpbGUgKz0gQ0RfUFJPRklMRV9E
RVNDX0xFTjsKKworICAgIC8qIENELVJPTSBwcm9maWxlIGRlc2NyaXB0b3IgKi8KKyAgICBwcm9m
aWxlX251bSA9IE1NQ19QUk9GSUxFX0NEX1JPTTsKKyAgICBwcm9maWxlWzBdID0gKHByb2ZpbGVf
bnVtID4+IDgpICYgMHhmZjsKKyAgICBwcm9maWxlWzFdID0gcHJvZmlsZV9udW0gJiAweGZmOwor
ICAgIHByb2ZpbGVbMl0gPSBkZXYtPmNkX3JvbSA/IENEX1BST0ZJTEVfQ1VSUkVOVCA6IDA7CisK
KyAgICBvdXRidWZbM10gPSBhZGRfbGVuOworICAgIGZlYXR1cmVfbGVuICs9IGFkZF9sZW47CisK
KyAgICByZXR1cm4gZmVhdHVyZV9sZW47Cit9CisKKyNkZWZpbmUgQ0RfRkVBVFVSRV9DT1JFX1BI
WVNfUFJPRklMRV9MRU4gICAgNAorCitzdGF0aWMgdWludDMyX3QgY2Rfc2NzaV9hZGRfZmVhdHVy
ZV9jb3JlKENkU2NzaUxVICpkZXYsIHVpbnQ4X3QgKm91dGJ1ZiwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyX3Qgc3RhcnRfZmVhdHVyZSwgdWludDMyX3Qg
cmVxX3R5cGUpCit7CisgICAgdWludDhfdCAqcHJvZmlsZSA9IG91dGJ1ZiArIENEX0ZFQVRVUkVf
REVTQ19MRU47CisgICAgdWludDMyX3QgZmVhdHVyZV9sZW4gPSBDRF9GRUFUVVJFX0RFU0NfTEVO
ICsgQ0RfRkVBVFVSRV9DT1JFX1BIWVNfUFJPRklMRV9MRU47CisKKyAgICBpZiAoIWNkX3Njc2lf
ZmVhdHVyZV9yZXBvcnRhYmxlKENEX0ZFQVRVUkVfTlVNX0NPUkUsIHN0YXJ0X2ZlYXR1cmUsIHJl
cV90eXBlKSkgeworICAgICAgICByZXR1cm4gMDsKKyAgICB9CisgICAgb3V0YnVmWzBdID0gKENE
X0ZFQVRVUkVfTlVNX0NPUkUgPj4gOCkgJiAweGZmOworICAgIG91dGJ1ZlsxXSA9IENEX0ZFQVRV
UkVfTlVNX0NPUkUgJiAweGZmOworICAgIG91dGJ1ZlsyXSA9IENEX0ZFQVRVUkVfUEVSU0lTVEVO
VCB8IENEX0ZFQVRVUkVfQ1VSUkVOVDsKKyAgICBvdXRidWZbM10gPSBDRF9GRUFUVVJFX0NPUkVf
UEhZU19QUk9GSUxFX0xFTjsKKworICAgIHByb2ZpbGVbM10gPSBDRF9GRUFUVVJFX1BIWVNfSUZf
U0NTSTsKKworICAgIHJldHVybiBmZWF0dXJlX2xlbjsKK30KKworI2RlZmluZSBDRF9GRUFUVVJF
X01PUlBIX1BST0dJTEVfTEVOICAgIDQKKyNkZWZpbmUgQ0RfRkVBVFVSRV9NT1JQSF9BU1lOQ19F
VkVOVFMgICAweDAxCisKK3N0YXRpYyB1aW50MzJfdCBjZF9zY3NpX2FkZF9mZWF0dXJlX21vcnBo
KENkU2NzaUxVICpkZXYsIHVpbnQ4X3QgKm91dGJ1ZiwKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IHN0YXJ0X2ZlYXR1cmUsIHVpbnQzMl90IHJlcV90
eXBlKQoreworICAgIHVpbnQ4X3QgKnByb2ZpbGUgPSBvdXRidWYgKyBDRF9GRUFUVVJFX0RFU0Nf
TEVOOworICAgIHVpbnQzMl90IGZlYXR1cmVfbGVuID0gQ0RfRkVBVFVSRV9ERVNDX0xFTiArIENE
X0ZFQVRVUkVfTU9SUEhfUFJPR0lMRV9MRU47CisKKyAgICBpZiAoIWNkX3Njc2lfZmVhdHVyZV9y
ZXBvcnRhYmxlKENEX0ZFQVRVUkVfTlVNX01PUlBILCBzdGFydF9mZWF0dXJlLCByZXFfdHlwZSkp
IHsKKyAgICAgICAgcmV0dXJuIDA7CisgICAgfQorICAgIG91dGJ1ZlsxXSA9IENEX0ZFQVRVUkVf
TlVNX01PUlBIOworICAgIG91dGJ1ZlsyXSA9IENEX0ZFQVRVUkVfUEVSU0lTVEVOVCB8IENEX0ZF
QVRVUkVfQ1VSUkVOVDsKKyAgICBvdXRidWZbM10gPSBDRF9GRUFUVVJFX01PUlBIX1BST0dJTEVf
TEVOOworCisgICAgcHJvZmlsZVswXSA9IENEX0ZFQVRVUkVfTU9SUEhfQVNZTkNfRVZFTlRTOwor
CisgICAgcmV0dXJuIGZlYXR1cmVfbGVuOworfQorCisjZGVmaW5lIENEX0ZFQVRVUkVfUkVNT1ZB
QkxFX1BST0ZJTEVfTEVOICAgIDQKKworc3RhdGljIHVpbnQzMl90IGNkX3Njc2lfYWRkX2ZlYXR1
cmVfcmVtb3ZhYmxlKENkU2NzaUxVICpkZXYsIHVpbnQ4X3QgKm91dGJ1ZiwKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCBzdGFydF9mZWF0dXJl
LCB1aW50MzJfdCByZXFfdHlwZSkKK3sKKyAgICB1aW50OF90ICpwcm9maWxlID0gb3V0YnVmICsg
Q0RfRkVBVFVSRV9ERVNDX0xFTjsKKyAgICB1aW50MzJfdCBmZWF0dXJlX2xlbiA9IENEX0ZFQVRV
UkVfREVTQ19MRU4gKyBDRF9GRUFUVVJFX1JFTU9WQUJMRV9QUk9GSUxFX0xFTjsKKworICAgIGlm
ICghY2Rfc2NzaV9mZWF0dXJlX3JlcG9ydGFibGUoQ0RfRkVBVFVSRV9OVU1fUkVNT1ZBQkxFLCBz
dGFydF9mZWF0dXJlLCByZXFfdHlwZSkpIHsKKyAgICAgICAgcmV0dXJuIDA7CisgICAgfQorICAg
IG91dGJ1ZlsxXSA9IENEX0ZFQVRVUkVfTlVNX1JFTU9WQUJMRTsKKyAgICBvdXRidWZbMl0gPSBD
RF9GRUFUVVJFX1BFUlNJU1RFTlQgfCBDRF9GRUFUVVJFX0NVUlJFTlQ7CisgICAgb3V0YnVmWzNd
ID0gQ0RfRkVBVFVSRV9SRU1PVkFCTEVfUFJPRklMRV9MRU47CisKKyAgICBwcm9maWxlWzBdID0g
Q0RfRkVBVFVSRV9SRU1PVkFCTEVfTk9fUFJWTlRfSk1QUjsKKyAgICBpZiAoZGV2LT5yZW1vdmFi
bGUpIHsKKyAgICAgICAgcHJvZmlsZVswXSB8PSAoQ0RfRkVBVFVSRV9SRU1PVkFCTEVfTE9BRElO
R19UUkFZIHwgQ0RfRkVBVFVSRV9SRU1PVkFCTEVfRUpFQ1QpOworICAgIH0KKworICAgIHJldHVy
biBmZWF0dXJlX2xlbjsKK30KKworI2RlZmluZSBDRF9GRUFUVVJFX1JBTkRPTV9SRUFEX1BST0ZJ
TEVfTEVOICAgIDgKKworc3RhdGljIHVpbnQzMl90IGNkX3Njc2lfYWRkX2ZlYXR1cmVfcmFuZG9t
X3JlYWQoQ2RTY3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVmLAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyX3Qgc3RhcnRfZmVhdHVyZSwgdWlu
dDMyX3QgcmVxX3R5cGUpCit7CisgICAgdWludDhfdCAqcHJvZmlsZSA9IG91dGJ1ZiArIENEX0ZF
QVRVUkVfREVTQ19MRU47CisgICAgdWludDMyX3QgZmVhdHVyZV9sZW4gPSBDRF9GRUFUVVJFX0RF
U0NfTEVOICsgQ0RfRkVBVFVSRV9SQU5ET01fUkVBRF9QUk9GSUxFX0xFTjsKKworICAgIGlmICgh
Y2Rfc2NzaV9mZWF0dXJlX3JlcG9ydGFibGUoQ0RfRkVBVFVSRV9OVU1fUkFORE9NX1JFQUQsIHN0
YXJ0X2ZlYXR1cmUsIHJlcV90eXBlKSkgeworICAgICAgICByZXR1cm4gMDsKKyAgICB9CisgICAg
b3V0YnVmWzBdID0gKENEX0ZFQVRVUkVfTlVNX1JBTkRPTV9SRUFEID4+IDgpICYgMHhmZjsKKyAg
ICBvdXRidWZbMV0gPSBDRF9GRUFUVVJFX05VTV9SQU5ET01fUkVBRCAmIDB4ZmY7CisgICAgb3V0
YnVmWzJdID0gQ0RfRkVBVFVSRV9QRVJTSVNURU5UIHwgQ0RfRkVBVFVSRV9DVVJSRU5UOworICAg
IG91dGJ1ZlszXSA9IENEX0ZFQVRVUkVfUkFORE9NX1JFQURfUFJPRklMRV9MRU47CisKKyAgICBw
cm9maWxlWzBdID0gKGRldi0+YmxvY2tfc2l6ZSA+PiAyNCkgJiAweGZmOworICAgIHByb2ZpbGVb
MV0gPSAoZGV2LT5ibG9ja19zaXplID4+IDE2KSAmIDB4ZmY7CisgICAgcHJvZmlsZVsyXSA9IChk
ZXYtPmJsb2NrX3NpemUgPj4gOCkgJiAweGZmOworICAgIHByb2ZpbGVbM10gPSAoZGV2LT5ibG9j
a19zaXplKSAmIDB4ZmY7CisgICAgcHJvZmlsZVs1XSA9IChkZXYtPmNkX3JvbSkgPyAweDAxIDog
MHgxMDsgLyogbG9naWNhbCBibG9ja3MgcGVyIHJlYWRhYmxlIHVuaXQgKi8KKworICAgIHJldHVy
biBmZWF0dXJlX2xlbjsKK30KKworI2RlZmluZSBDRF9GRUFUVVJFX0NEX1JFQURfUFJPRklMRV9M
RU4gICAgNAorCitzdGF0aWMgdWludDMyX3QgY2Rfc2NzaV9hZGRfZmVhdHVyZV9jZF9yZWFkKENk
U2NzaUxVICpkZXYsIHVpbnQ4X3QgKm91dGJ1ZiwKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgdWludDMyX3Qgc3RhcnRfZmVhdHVyZSwgdWludDMyX3QgcmVxX3R5
cGUpCit7CisgICAgdWludDhfdCAqcHJvZmlsZSA9IG91dGJ1ZiArIENEX0ZFQVRVUkVfREVTQ19M
RU47CisgICAgdWludDMyX3QgZmVhdHVyZV9sZW4gPSBDRF9GRUFUVVJFX0RFU0NfTEVOICsgQ0Rf
RkVBVFVSRV9DRF9SRUFEX1BST0ZJTEVfTEVOOworCisgICAgaWYgKCFjZF9zY3NpX2ZlYXR1cmVf
cmVwb3J0YWJsZShDRF9GRUFUVVJFX05VTV9DRF9SRUFELCBzdGFydF9mZWF0dXJlLCByZXFfdHlw
ZSkpIHsKKyAgICAgICAgcmV0dXJuIDA7CisgICAgfQorICAgIG91dGJ1ZlswXSA9IChDRF9GRUFU
VVJFX05VTV9DRF9SRUFEID4+IDgpICYgMHhmZjsKKyAgICBvdXRidWZbMV0gPSAoQ0RfRkVBVFVS
RV9OVU1fQ0RfUkVBRCkgJiAweGZmOworICAgIG91dGJ1ZlsyXSA9IENEX0ZFQVRVUkVfVkVSU0lP
Tl8xIHwgQ0RfRkVBVFVSRV9QRVJTSVNURU5UIHwgQ0RfRkVBVFVSRV9DVVJSRU5UOworICAgIG91
dGJ1ZlszXSA9IENEX0ZFQVRVUkVfQ0RfUkVBRF9QUk9GSUxFX0xFTjsKKworICAgIHByb2ZpbGVb
MF0gPSAwOyAvKiBDMiBFcnJvcnMsIENELVRleHQgbm90IHN1cHBvcnRlICovCisKKyAgICByZXR1
cm4gZmVhdHVyZV9sZW47Cit9CisKKyNkZWZpbmUgQ0RfRkVBVFVSRV9EVkRfUkVBRF9QUk9GSUxF
X0xFTiAgICAwCisKK3N0YXRpYyB1aW50MzJfdCBjZF9zY3NpX2FkZF9mZWF0dXJlX2R2ZF9yZWFk
KENkU2NzaUxVICpkZXYsIHVpbnQ4X3QgKm91dGJ1ZiwKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IHN0YXJ0X2ZlYXR1cmUsIHVpbnQzMl90IHJl
cV90eXBlKQoreworICAgIHVpbnQzMl90IGZlYXR1cmVfbGVuID0gQ0RfRkVBVFVSRV9ERVNDX0xF
TiArIENEX0ZFQVRVUkVfRFZEX1JFQURfUFJPRklMRV9MRU47CisKKyAgICBpZiAoIWNkX3Njc2lf
ZmVhdHVyZV9yZXBvcnRhYmxlKENEX0ZFQVRVUkVfTlVNX0NEX1JFQUQsIHN0YXJ0X2ZlYXR1cmUs
IHJlcV90eXBlKSkgeworICAgICAgICByZXR1cm4gMDsKKyAgICB9CisgICAgb3V0YnVmWzBdID0g
KENEX0ZFQVRVUkVfTlVNX0RWRF9SRUFEID4+IDgpICYgMHhmZjsKKyAgICBvdXRidWZbMV0gPSAo
Q0RfRkVBVFVSRV9OVU1fRFZEX1JFQUQpICYgMHhmZjsKKyAgICBvdXRidWZbMl0gPSBDRF9GRUFU
VVJFX1ZFUlNJT05fMSB8IENEX0ZFQVRVUkVfUEVSU0lTVEVOVCB8IENEX0ZFQVRVUkVfQ1VSUkVO
VDsKKyAgICBvdXRidWZbM10gPSBDRF9GRUFUVVJFX0RWRF9SRUFEX1BST0ZJTEVfTEVOOworCisg
ICAgcmV0dXJuIGZlYXR1cmVfbGVuOworfQorCisjZGVmaW5lIENEX0ZFQVRVUkVfUE9XRVJfTU5H
VF9QUk9GSUxFX0xFTiAgICAwCisKK3N0YXRpYyB1aW50MzJfdCBjZF9zY3NpX2FkZF9mZWF0dXJl
X3Bvd2VyX21nbXQoQ2RTY3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVmLAorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCBzdGFydF9mZWF0dXJl
LCB1aW50MzJfdCByZXFfdHlwZSkKK3sKKyAgICB1aW50MzJfdCBmZWF0dXJlX2xlbiA9IENEX0ZF
QVRVUkVfREVTQ19MRU4gKyBDRF9GRUFUVVJFX1BPV0VSX01OR1RfUFJPRklMRV9MRU47CisKKyAg
ICBpZiAoIWNkX3Njc2lfZmVhdHVyZV9yZXBvcnRhYmxlKENEX0ZFQVRVUkVfTlVNX1BPV0VSX01O
R1QsIHN0YXJ0X2ZlYXR1cmUsIHJlcV90eXBlKSkgeworICAgICAgICByZXR1cm4gMDsKKyAgICB9
CisgICAgb3V0YnVmWzBdID0gKENEX0ZFQVRVUkVfTlVNX1BPV0VSX01OR1QgPj4gOCkgJiAweGZm
OworICAgIG91dGJ1ZlsxXSA9IChDRF9GRUFUVVJFX05VTV9QT1dFUl9NTkdUKSAmIDB4ZmY7Cisg
ICAgb3V0YnVmWzJdID0gQ0RfRkVBVFVSRV9QRVJTSVNURU5UIHwgQ0RfRkVBVFVSRV9DVVJSRU5U
OworICAgIG91dGJ1ZlszXSA9IENEX0ZFQVRVUkVfUE9XRVJfTU5HVF9QUk9GSUxFX0xFTjsKKwor
ICAgIHJldHVybiBmZWF0dXJlX2xlbjsKK30KKworI2RlZmluZSBDRF9GRUFUVVJFX1RJTUVPVVRf
UFJPRklMRV9MRU4gICAgMAorCitzdGF0aWMgdWludDMyX3QgY2Rfc2NzaV9hZGRfZmVhdHVyZV90
aW1lb3V0KENkU2NzaUxVICpkZXYsIHVpbnQ4X3QgKm91dGJ1ZiwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyX3Qgc3RhcnRfZmVhdHVyZSwgdWludDMy
X3QgcmVxX3R5cGUpCit7CisgICAgdWludDMyX3QgZmVhdHVyZV9sZW4gPSBDRF9GRUFUVVJFX0RF
U0NfTEVOICsgQ0RfRkVBVFVSRV9USU1FT1VUX1BST0ZJTEVfTEVOOworCisgICAgaWYgKCFjZF9z
Y3NpX2ZlYXR1cmVfcmVwb3J0YWJsZShDRF9GRUFUVVJFX05VTV9USU1FT1VULCBzdGFydF9mZWF0
dXJlLCByZXFfdHlwZSkpIHsKKyAgICAgICAgcmV0dXJuIDA7CisgICAgfQorICAgIG91dGJ1Zlsw
XSA9IChDRF9GRUFUVVJFX05VTV9USU1FT1VUID4+IDgpICYgMHhmZjsKKyAgICBvdXRidWZbMV0g
PSBDRF9GRUFUVVJFX05VTV9USU1FT1VUICYgMHhmZjsKKyAgICBvdXRidWZbMl0gPSBDRF9GRUFU
VVJFX1BFUlNJU1RFTlQgfCBDRF9GRUFUVVJFX0NVUlJFTlQ7CisgICAgb3V0YnVmWzNdID0gQ0Rf
RkVBVFVSRV9USU1FT1VUX1BST0ZJTEVfTEVOOworCisgICAgcmV0dXJuIGZlYXR1cmVfbGVuOwor
fQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9nZXRfY29uZmlndXJhdGlvbihDZFNjc2lMVSAq
ZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgdWludDhfdCAqb3V0YnVmID0gcmVxLT5i
dWY7CisgICAgdWludDMyX3QgcHJvZmlsZV9udW0gPSAoIWRldi0+Y2Rfcm9tKSA/IE1NQ19QUk9G
SUxFX0RWRF9ST00gOiBNTUNfUFJPRklMRV9DRF9ST007CisgICAgdWludDMyX3QgcmVxX3R5cGUs
IHN0YXJ0X2ZlYXR1cmUsIHJlc3BfbGVuOworCisgICAgcmVxLT54ZmVyX2RpciA9IFNDU0lfWEZF
Ul9GUk9NX0RFVjsKKworICAgIHJlcV90eXBlID0gcmVxLT5jZGJbMV0gJiAweDM7CisgICAgc3Rh
cnRfZmVhdHVyZSA9IChyZXEtPmNkYlsyXSA8PCA4KSB8IHJlcS0+Y2RiWzNdOworICAgIHJlcS0+
cmVxX2xlbiA9IChyZXEtPmNkYls3XSA8PCA4KSB8IHJlcS0+Y2RiWzhdOworCisgICAgbWVtc2V0
KG91dGJ1ZiwgMCwgcmVxLT5yZXFfbGVuKTsKKworICAgIC8qIGF0IGxlYXN0IEZlYXR1cmUgSGVh
ZGVyIHNob3VsZCBiZSBwcmVzZW50LCB0byBiZSBmaWxsZWQgbGF0ZXIgKi8KKyAgICByZXNwX2xl
biA9IENEX0ZFQVRVUkVfSEVBREVSX0xFTjsKKworICAgIHN3aXRjaCAocmVxX3R5cGUpIHsKKyAg
ICBjYXNlIENEX0ZFQVRVUkVfUkVRX0FMTDoKKyAgICBjYXNlIENEX0ZFQVRVUkVfUkVRX0NVUlJF
TlQ6CisgICAgICAgIHJlc3BfbGVuICs9IGNkX3Njc2lfYWRkX2ZlYXR1cmVfcHJvZmlsZXNfbGlz
dChkZXYsIG91dGJ1ZiArIHJlc3BfbGVuLCBzdGFydF9mZWF0dXJlLCByZXFfdHlwZSk7CisgICAg
ICAgIHJlc3BfbGVuICs9IGNkX3Njc2lfYWRkX2ZlYXR1cmVfY29yZShkZXYsIG91dGJ1ZiArIHJl
c3BfbGVuLCBzdGFydF9mZWF0dXJlLCByZXFfdHlwZSk7CisgICAgICAgIHJlc3BfbGVuICs9IGNk
X3Njc2lfYWRkX2ZlYXR1cmVfbW9ycGgoZGV2LCBvdXRidWYgKyByZXNwX2xlbiwgc3RhcnRfZmVh
dHVyZSwgcmVxX3R5cGUpOworICAgICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9mZWF0dXJl
X3JlbW92YWJsZShkZXYsIG91dGJ1ZiArIHJlc3BfbGVuLCBzdGFydF9mZWF0dXJlLCByZXFfdHlw
ZSk7CisgICAgICAgIHJlc3BfbGVuICs9IGNkX3Njc2lfYWRkX2ZlYXR1cmVfcmFuZG9tX3JlYWQo
ZGV2LCBvdXRidWYgKyByZXNwX2xlbiwgc3RhcnRfZmVhdHVyZSwgcmVxX3R5cGUpOworICAgICAg
ICByZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9mZWF0dXJlX2NkX3JlYWQoZGV2LCBvdXRidWYgKyBy
ZXNwX2xlbiwgc3RhcnRfZmVhdHVyZSwgcmVxX3R5cGUpOworICAgICAgICByZXNwX2xlbiArPSBj
ZF9zY3NpX2FkZF9mZWF0dXJlX2R2ZF9yZWFkKGRldiwgb3V0YnVmICsgcmVzcF9sZW4sIHN0YXJ0
X2ZlYXR1cmUsIHJlcV90eXBlKTsKKyAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9hZGRfZmVh
dHVyZV9wb3dlcl9tZ210KGRldiwgb3V0YnVmICsgcmVzcF9sZW4sIHN0YXJ0X2ZlYXR1cmUsIHJl
cV90eXBlKTsKKyAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9hZGRfZmVhdHVyZV90aW1lb3V0
KGRldiwgb3V0YnVmICsgcmVzcF9sZW4sIHN0YXJ0X2ZlYXR1cmUsIHJlcV90eXBlKTsKKyAgICAg
ICAgYnJlYWs7CisgICAgY2FzZSBDRF9GRUFUVVJFX1JFUV9TSU5HTEU6CisgICAgICAgIHN3aXRj
aCAoc3RhcnRfZmVhdHVyZSkgeworICAgICAgICBjYXNlIENEX0ZFQVRVUkVfTlVNX0NPUkU6Cisg
ICAgICAgICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9mZWF0dXJlX2NvcmUoZGV2LCBvdXRi
dWYgKyByZXNwX2xlbiwgc3RhcnRfZmVhdHVyZSwgcmVxX3R5cGUpOworICAgICAgICAgICAgYnJl
YWs7CisgICAgICAgIGNhc2UgQ0RfRkVBVFVSRV9OVU1fTU9SUEg6CisgICAgICAgICAgICByZXNw
X2xlbiArPSBjZF9zY3NpX2FkZF9mZWF0dXJlX21vcnBoKGRldiwgb3V0YnVmICsgcmVzcF9sZW4s
IHN0YXJ0X2ZlYXR1cmUsIHJlcV90eXBlKTsKKyAgICAgICAgICAgIGJyZWFrOworICAgICAgICBj
YXNlIENEX0ZFQVRVUkVfTlVNX1JFTU9WQUJMRToKKyAgICAgICAgICAgIHJlc3BfbGVuICs9IGNk
X3Njc2lfYWRkX2ZlYXR1cmVfcmVtb3ZhYmxlKGRldiwgb3V0YnVmICsgcmVzcF9sZW4sIHN0YXJ0
X2ZlYXR1cmUsIHJlcV90eXBlKTsKKyAgICAgICAgICAgIGJyZWFrOworICAgICAgICBjYXNlIENE
X0ZFQVRVUkVfTlVNX1JBTkRPTV9SRUFEOgorICAgICAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2Nz
aV9hZGRfZmVhdHVyZV9yYW5kb21fcmVhZChkZXYsIG91dGJ1ZiArIHJlc3BfbGVuLCBzdGFydF9m
ZWF0dXJlLCByZXFfdHlwZSk7CisgICAgICAgICAgICBicmVhazsKKyAgICAgICAgY2FzZSBDRF9G
RUFUVVJFX05VTV9DRF9SRUFEOgorICAgICAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9hZGRf
ZmVhdHVyZV9jZF9yZWFkKGRldiwgb3V0YnVmICsgcmVzcF9sZW4sIHN0YXJ0X2ZlYXR1cmUsIHJl
cV90eXBlKTsKKyAgICAgICAgICAgIGJyZWFrOworICAgICAgICBjYXNlIENEX0ZFQVRVUkVfTlVN
X0RWRF9SRUFEOgorICAgICAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9hZGRfZmVhdHVyZV9k
dmRfcmVhZChkZXYsIG91dGJ1ZiArIHJlc3BfbGVuLCBzdGFydF9mZWF0dXJlLCByZXFfdHlwZSk7
CisgICAgICAgICAgICBicmVhazsKKyAgICAgICAgY2FzZSBDRF9GRUFUVVJFX05VTV9QT1dFUl9N
TkdUOgorICAgICAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9hZGRfZmVhdHVyZV9wb3dlcl9t
Z210KGRldiwgb3V0YnVmICsgcmVzcF9sZW4sIHN0YXJ0X2ZlYXR1cmUsIHJlcV90eXBlKTsKKyAg
ICAgICAgICAgIGJyZWFrOworICAgICAgICBjYXNlIENEX0ZFQVRVUkVfTlVNX1RJTUVPVVQ6Cisg
ICAgICAgICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9mZWF0dXJlX3RpbWVvdXQoZGV2LCBv
dXRidWYgKyByZXNwX2xlbiwgc3RhcnRfZmVhdHVyZSwgcmVxX3R5cGUpOworICAgICAgICAgICAg
YnJlYWs7CisgICAgICAgIGRlZmF1bHQ6CisgICAgICAgICAgICBicmVhazsKKyAgICAgICAgfQor
ICAgICAgICBicmVhazsKKworICAgIGRlZmF1bHQ6CisgICAgICAgIFNQSUNFX0RFQlVHKCJnZXRf
Y29uZmlndXJhdGlvbiwgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQKKyAgICAgICAgICAgICAgICAg
ICAgIiBpbnZhbGlkIHJ0OiUiIEdfR1VJTlQzMl9GT1JNQVQgIiBzdGFydF9mOiUiIEdfR1VJTlQz
Ml9GT1JNQVQsCisgICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuLCByZXFfdHlwZSwgc3RhcnRf
ZmVhdHVyZSk7CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCBy
ZXEsICZzZW5zZV9jb2RlX0lOVkFMSURfQ0RCX0ZJRUxEKTsKKyAgICAgICAgcmV0dXJuOworICAg
IH0KKworICAgIC8qIHNldCB0b3RhbCBkYXRhIGxlbiAqLworICAgIG91dGJ1ZlswXSA9IChyZXNw
X2xlbiA+PiAyNCkgJiAweGZmOworICAgIG91dGJ1ZlsxXSA9IChyZXNwX2xlbiA+PiAxNikgJiAw
eGZmOworICAgIG91dGJ1ZlsyXSA9IChyZXNwX2xlbiA+PiA4KSAmIDB4ZmY7CisgICAgb3V0YnVm
WzNdID0gcmVzcF9sZW4gJiAweGZmOworCisgICAgLyogcmVwb3J0IGN1cnJlbnQgcHJvZmlsZSBu
dW0gKi8KKyAgICBvdXRidWZbNl0gPSAocHJvZmlsZV9udW0gPj4gOCkgJiAweGZmOworICAgIG91
dGJ1Zls3XSA9IHByb2ZpbGVfbnVtICYgMHhmZjsKKworICAgIHJlcS0+aW5fbGVuID0gKHJlcS0+
cmVxX2xlbiA8IHJlc3BfbGVuKSA/IHJlcS0+cmVxX2xlbiA6IHJlc3BfbGVuOworCisgICAgU1BJ
Q0VfREVCVUcoImdldF9jb25maWd1cmF0aW9uLCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVAorICAg
ICAgICAgICAgICAgICIgcnQ6JSIgR19HVUlOVDMyX0ZPUk1BVCAiIHN0YXJ0X2Y6JSIgR19HVUlO
VDMyX0ZPUk1BVAorICAgICAgICAgICAgICAgICIgcmVzcF9sZW46JSIgR19HVUlOVDMyX0ZPUk1B
VCwKKyAgICAgICAgICAgICAgICByZXEtPmx1biwgcmVxX3R5cGUsIHN0YXJ0X2ZlYXR1cmUsIHJl
c3BfbGVuKTsKKworICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2LCByZXEpOworfQor
CisjZGVmaW5lIENEX0dFVF9FVkVOVF9TVEFUVVNfSU1NRUQgICAgICAgICAgICAweDAxCisKKyNk
ZWZpbmUgQ0RfR0VUX0VWRU5UX0hFQURFUl9OT19FVkVOVF9BVkFJTCAgKDB4MDEgPDwgNykKKyNk
ZWZpbmUgQ0RfR0VUX0VWRU5UX0hFQURFUl9MRU4gICAgICAgICAgICAgNAorCisjZGVmaW5lIENE
X0dFVF9FVkVOVF9DTEFTU19OT05FICAgICAgICAgICAgICgweDAwKQorI2RlZmluZSBDRF9HRVRf
RVZFTlRfQ0xBU1NfT1BFUl9DSEFOR0UgICAgICAoMHgwMSkKKyNkZWZpbmUgQ0RfR0VUX0VWRU5U
X0NMQVNTX1BPV0VSX01HTVQgICAgICAgKDB4MDIpCisjZGVmaW5lIENEX0dFVF9FVkVOVF9DTEFT
U19FWFRFUk5BTF9SRVEgICAgICgweDAzKQorI2RlZmluZSBDRF9HRVRfRVZFTlRfQ0xBU1NfTUVE
SUEgICAgICAgICAgICAoMHgwNCkKKyNkZWZpbmUgQ0RfR0VUX0VWRU5UX0NMQVNTX01VTFRJX0lO
SVRJQVRPUiAgKDB4MDUpCisjZGVmaW5lIENEX0dFVF9FVkVOVF9DTEFTU19ERVZfQlVTWSAgICAg
ICAgICgweDA2KQorCisjZGVmaW5lIENEX0dFVF9FVkVOVF9MRU5fTUVESUEgICAgICAgICAgICAg
IDQKKworI2RlZmluZSBDRF9NRURJQV9TVEFUVVNfTUVESUFfUFJFU0VOVCAgICAgICAweDEKKyNk
ZWZpbmUgQ0RfTUVESUFfU1RBVFVTX1RSQVlfT1BFTiAgICAgICAgICAgMHgyCisKK3N0YXRpYyB1
aW50MzJfdCBjZF9zY3NpX2NtZF9nZXRfZXZlbnRfcmVzcF9hZGRfbWVkaWEoQ2RTY3NpTFUgKmRl
diwgdWludDhfdCAqb3V0YnVmKQoreworICAgIG91dGJ1ZlswXSA9ICh1aW50OF90KWRldi0+bWVk
aWFfZXZlbnQgJiAweDBmOworICAgIG91dGJ1ZlsxXSA9ICh1aW50OF90KSgoZGV2LT5sb2FkZWQg
PyAwIDogQ0RfTUVESUFfU1RBVFVTX1RSQVlfT1BFTikgfAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAoZGV2LT5zdHJlYW0gIT0gTlVMTCA/IENEX01FRElBX1NUQVRVU19NRURJQV9QUkVTRU5U
IDogMCkpOworCisgICAgZGV2LT5tZWRpYV9ldmVudCA9IENEX01FRElBX0VWRU5UX05PX0NIQU5H
RTsgLyogcmVzZXQgdGhlIGV2ZW50ICovCisgICAgcmV0dXJuIENEX0dFVF9FVkVOVF9MRU5fTUVE
SUE7Cit9CisKKyNkZWZpbmUgQ0RfR0VUX0VWRU5UX0xFTl9QT1dFUiAgICAgICAgICAgICAgNAor
CisjZGVmaW5lIENEX1BPV0VSX1NUQVRVU19BQ1RJVkUgICAgICAgICAgICAgIDB4MQorI2RlZmlu
ZSBDRF9QT1dFUl9TVEFUVVNfSURMRSAgICAgICAgICAgICAgICAweDIKKworc3RhdGljIHVpbnQz
Ml90IGNkX3Njc2lfY21kX2dldF9ldmVudF9yZXNwX2FkZF9wb3dlcihDZFNjc2lMVSAqZGV2LCB1
aW50OF90ICpvdXRidWYpCit7CisgICAgb3V0YnVmWzBdID0gKHVpbnQ4X3QpZGV2LT5wb3dlcl9l
dmVudCAmIDB4MGY7CisgICAgb3V0YnVmWzFdID0gKHVpbnQ4X3QpKChkZXYtPnBvd2VyX2NvbmQg
PT0gQ0RfU0NTSV9QT1dFUl9BQ1RJVkUpID8KKyAgICAgICAgICAgICAgICAgICAgICAgICAgIENE
X1BPV0VSX1NUQVRVU19BQ1RJVkUgOiBDRF9QT1dFUl9TVEFUVVNfSURMRSk7CisKKyAgICBkZXYt
PnBvd2VyX2V2ZW50ID0gQ0RfUE9XRVJfRVZFTlRfTk9fQ0hBTkdFOyAvKiByZXNldCB0aGUgZXZl
bnQgKi8KKyAgICByZXR1cm4gQ0RfR0VUX0VWRU5UX0xFTl9QT1dFUjsKK30KKworc3RhdGljIHZv
aWQgY2Rfc2NzaV9jbWRfZ2V0X2V2ZW50X3N0YXR1c19ub3RpZmljYXRpb24oQ2RTY3NpTFUgKmRl
diwgQ2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAgIHVpbnQ4X3QgKm91dGJ1ZiA9IHJlcS0+YnVm
OworICAgIHVpbnQzMl90IHJlc3BfbGVuID0gQ0RfR0VUX0VWRU5UX0hFQURFUl9MRU47CisgICAg
Y29uc3QgdWludDMyX3QgcG93ZXJfY2xhc3NfbWFzayA9ICgweDAxIDw8IENEX0dFVF9FVkVOVF9D
TEFTU19QT1dFUl9NR01UKTsKKyAgICBjb25zdCB1aW50MzJfdCBtZWRpYV9jbGFzc19tYXNrID0g
KDB4MDEgPDwgQ0RfR0VUX0VWRU5UX0NMQVNTX01FRElBKTsKKyAgICB1aW50MzJfdCBjbGFzc2Vz
X3N1cHBvcnRlZCA9ICBwb3dlcl9jbGFzc19tYXNrIHwgbWVkaWFfY2xhc3NfbWFzazsKKyAgICB1
aW50MzJfdCBpbW1lZCwgY2xhc3Nlc19yZXF1ZXN0ZWQ7CisKKyAgICByZXEtPnhmZXJfZGlyID0g
U0NTSV9YRkVSX0ZST01fREVWOworCisgICAgaW1tZWQgPSByZXEtPmNkYlsxXSAmIENEX0dFVF9F
VkVOVF9TVEFUVVNfSU1NRUQ7CisgICAgY2xhc3Nlc19yZXF1ZXN0ZWQgPSByZXEtPmNkYls0XTsK
KyAgICByZXEtPnJlcV9sZW4gPSAocmVxLT5jZGJbN10gPDwgOCkgfCByZXEtPmNkYls4XTsKKwor
ICAgIGlmICghaW1tZWQpIHsKKyAgICAgICAgU1BJQ0VfREVCVUcoImdldF9ldmVudF9zdGF0dXNf
bm90aWZpY2F0aW9uLCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVAorICAgICAgICAgICAgICAgICIg
aW1tOjAgY2xhc3NfcmVxOiUwMngsIE5vbi1pbW1lZGlhdGUgKGFzeW5jKSBtb2RlIHVuc3VwcG9y
dGVkIiwKKyAgICAgICAgICAgICAgICByZXEtPmx1biwgY2xhc3Nlc19yZXF1ZXN0ZWQpOworICAg
ICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29k
ZV9JTlZBTElEX0NEQl9GSUVMRCk7CisgICAgICAgIHJldHVybjsKKyAgICB9CisKKyAgICBtZW1z
ZXQob3V0YnVmLCAwLCByZXEtPnJlcV9sZW4pOworICAgIGlmICgoY2xhc3Nlc19zdXBwb3J0ZWQg
JiBjbGFzc2VzX3JlcXVlc3RlZCkgIT0gMCkgeworICAgICAgICBpZiAoY2xhc3Nlc19yZXF1ZXN0
ZWQgJiBwb3dlcl9jbGFzc19tYXNrKSB7CisgICAgICAgICAgICBvdXRidWZbMl0gPSBDRF9HRVRf
RVZFTlRfQ0xBU1NfUE9XRVJfTUdNVDsKKyAgICAgICAgICAgIG91dGJ1ZlszXSA9ICh1aW50OF90
KXBvd2VyX2NsYXNzX21hc2s7CisKKyAgICAgICAgICAgIFNQSUNFX0RFQlVHKCJnZXRfZXZlbnRf
c3RhdHVzX25vdGlmaWNhdGlvbiwgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQKKyAgICAgICAgICAg
ICAgICAgICAgICAgICIgaW1tOiUiIEdfR1VJTlQzMl9GT1JNQVQgIiBjbGFzc19yZXE6MHglMDJ4
IGNsYXNzX3N1cDoweCUwMngiCisgICAgICAgICAgICAgICAgICAgICAgICAiIHBvd2VyX2V2ZW50
OjB4JTAyeCBwb3dlcl9jb25kOjB4JTAyeCIsCisgICAgICAgICAgICAgICAgICAgICAgICByZXEt
Pmx1biwgaW1tZWQsIGNsYXNzZXNfcmVxdWVzdGVkLCBjbGFzc2VzX3N1cHBvcnRlZCwKKyAgICAg
ICAgICAgICAgICAgICAgICAgIGRldi0+cG93ZXJfZXZlbnQsIGRldi0+cG93ZXJfY29uZCk7CisK
KyAgICAgICAgICAgIHJlc3BfbGVuICs9IGNkX3Njc2lfY21kX2dldF9ldmVudF9yZXNwX2FkZF9w
b3dlcihkZXYsIG91dGJ1ZiArIHJlc3BfbGVuKTsKKyAgICAgICAgfSBlbHNlIGlmIChjbGFzc2Vz
X3JlcXVlc3RlZCAmIG1lZGlhX2NsYXNzX21hc2spIHsKKyAgICAgICAgICAgIG91dGJ1ZlsyXSA9
IENEX0dFVF9FVkVOVF9DTEFTU19NRURJQTsKKyAgICAgICAgICAgIG91dGJ1ZlszXSA9ICh1aW50
OF90KW1lZGlhX2NsYXNzX21hc2s7CisKKyAgICAgICAgICAgIFNQSUNFX0RFQlVHKCJnZXRfZXZl
bnRfc3RhdHVzX25vdGlmaWNhdGlvbiwgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQKKyAgICAgICAg
ICAgICAgICAgICAgICAgICIgaW1tOiUiIEdfR1VJTlQzMl9GT1JNQVQgIiBjbGFzc19yZXE6MHgl
MDJ4IGNsYXNzX3N1cDoweCUwMngiCisgICAgICAgICAgICAgICAgICAgICAgICAiIG1lZGlhX2V2
ZW50OjB4JTAyeCBsb2FkZWQ6ICVkIiwKKyAgICAgICAgICAgICAgICAgICAgICAgIHJlcS0+bHVu
LCBpbW1lZCwgY2xhc3Nlc19yZXF1ZXN0ZWQsIGNsYXNzZXNfc3VwcG9ydGVkLAorICAgICAgICAg
ICAgICAgICAgICAgICAgZGV2LT5tZWRpYV9ldmVudCwgZGV2LT5sb2FkZWQpOworCisgICAgICAg
ICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2NtZF9nZXRfZXZlbnRfcmVzcF9hZGRfbWVkaWEoZGV2
LCBvdXRidWYgKyByZXNwX2xlbik7CisgICAgICAgIH0KKyAgICB9IGVsc2UgeworICAgICAgICBv
dXRidWZbMl0gPSBDRF9HRVRfRVZFTlRfSEVBREVSX05PX0VWRU5UX0FWQUlMIHwgQ0RfR0VUX0VW
RU5UX0NMQVNTX05PTkU7CisKKyAgICAgICAgU1BJQ0VfREVCVUcoImdldF9ldmVudF9zdGF0dXNf
bm90aWZpY2F0aW9uLCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVAorICAgICAgICAgICAgICAgICAg
ICAgICAgIiBpbW06JSIgR19HVUlOVDMyX0ZPUk1BVCAiIGNsYXNzX3JlcToweCUwMnggY2xhc3Nf
c3VwOjB4JTAyeCIKKyAgICAgICAgICAgICAgICAgICAgICAgICIgbm9uZSBvZiByZXF1ZXN0ZWQg
ZXZlbnRzIHN1cHBvcnRlZCIsCisgICAgICAgICAgICAgICAgICAgICAgICByZXEtPmx1biwgaW1t
ZWQsIGNsYXNzZXNfcmVxdWVzdGVkLCBjbGFzc2VzX3N1cHBvcnRlZCk7CisgICAgfQorICAgIG91
dGJ1ZlsxXSA9ICh1aW50OF90KShyZXNwX2xlbiAtIDIpOyAvKiBFdmVudCBEYXRhIExlbmd0aCBM
U0IsIGxlbmd0aCBleGNsdWRpbmcgdGhlIGZpZWxkIGl0c2VsZiAqLworICAgIG91dGJ1ZlszXSA9
ICh1aW50OF90KWNsYXNzZXNfc3VwcG9ydGVkOworCisgICAgcmVxLT5pbl9sZW4gPSAocmVxLT5y
ZXFfbGVuIDwgcmVzcF9sZW4pID8gcmVxLT5yZXFfbGVuIDogcmVzcF9sZW47CisgICAgY2Rfc2Nz
aV9jbWRfY29tcGxldGVfZ29vZChkZXYsIHJlcSk7Cit9CisKKyNkZWZpbmUgQ0RfRVhUX1JFUV9F
VkVOVF9GT1JNQVRfTk9fQ0hHICAgICAgICAgIDB4MDAKKyNkZWZpbmUgQ0RfRVhUX1JFUV9FVkVO
VF9GT1JNQVRfTFVfS0VZX0RPV04gICAgIDB4MDEKKyNkZWZpbmUgQ0RfRVhUX1JFUV9FVkVOVF9G
T1JNQVRfTFVfS0VZX1VQICAgICAgIDB4MDIKKyNkZWZpbmUgQ0RfRVhUX1JFUV9FVkVOVF9GT1JN
QVRfUkVRX05PVElGWSAgICAgIDB4MDMKKworI2RlZmluZSBDRF9FWFRfUkVRX1NUQVRVU19SRUFE
WSAgICAgICAgICAgICAgICAgMHgwMAorI2RlZmluZSBDRF9FWFRfUkVRX1NUQVRVU19PVEhFUl9Q
UkVWRU5UICAgICAgICAgMHgwMQorCisjZGVmaW5lIENEX0VYVF9SRVFfQ09ERV9OT19SRVFVRVNU
ICAgICAgICAgICAgICAweDAwCisjZGVmaW5lIENEX0VYVF9SRVFfQ09ERV9PVkVSUlVOICAgICAg
ICAgICAgICAgICAweDAxCisjZGVmaW5lIENEX0VYVF9SRVFfQ09ERV9QTEFZICAgICAgICAgICAg
ICAgICAgICAweDEwMQorI2RlZmluZSBDRF9FWFRfUkVRX0NPREVfUkVXSU5EICAgICAgICAgICAg
ICAgICAgMHgxMDIKKyNkZWZpbmUgQ0RfRVhUX1JFUV9DT0RFX0ZBU1RfRlcgICAgICAgICAgICAg
ICAgIDB4MTAzCisjZGVmaW5lIENEX0VYVF9SRVFfQ09ERV9QQVVTRSAgICAgICAgICAgICAgICAg
ICAweDEwNAorI2RlZmluZSBDRF9FWFRfUkVRX0NPREVfU1RPUCAgICAgICAgICAgICAgICAgICAg
MHgxMDYKKyNkZWZpbmUgQ0RfRVhUX1JFUV9DT0RFX0FTQ0lJX0JBU0UgICAgICAgICAgICAgIDB4
MjAwIC8qIFNDU0lJIHZhbHVlIGlzIExTQiAqLworCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9z
ZW5kX2V2ZW50KENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICB1aW50
OF90ICpwYXJhbSwgKmV2ZW50OworICAgIHVpbnQzMl90IGltbWVkLCBwYXJhbV9saXN0X2xlbjsK
KyAgICB1aW50MzJfdCBldmVudF9wYXJhbV9sZW4sIG5vdGlmaWNhdGlvbl9jbGFzczsKKyAgICB1
aW50MzJfdCBleHRfcmVxX2V2ZW50LCBleHRfcmVxX3N0YXR1cywgcGVyc19wcmV2ZW50LCBleHRf
cmVxX2NvZGU7CisKKyAgICByZXEtPnhmZXJfZGlyID0gU0NTSV9YRkVSX1RPX0RFVjsKKworICAg
IGltbWVkID0gcmVxLT5jZGJbMV0gJiAweDAxOworICAgIHBhcmFtX2xpc3RfbGVuID0gKHJlcS0+
Y2RiWzhdIDw8IDgpIHwgcmVxLT5jZGJbOV07CisKKyAgICBpZiAocmVxLT5idWZfbGVuIDwgcGFy
YW1fbGlzdF9sZW4pIHsKKyAgICAgICAgU1BJQ0VfREVCVUcoInNlbmRfZXZlbnQsIGx1bjolIiBH
X0dVSU5UMzJfRk9STUFUCisgICAgICAgICAgICAgICAgICAgICIgaW52YWxpZCBwYXJhbSBsaXN0
IGxlbjoweCV4LCBidWZfbGVuOjB4JXgiLAorICAgICAgICAgICAgICAgICAgICByZXEtPmx1biwg
cGFyYW1fbGlzdF9sZW4sIHJlcS0+YnVmX2xlbik7CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBs
ZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX0lOVkFMSURfUEFSQU1fTEVOKTsK
KyAgICAgICAgcmV0dXJuOworICAgIH0KKyAgICBwYXJhbSA9IHJlcS0+YnVmOworICAgIGV2ZW50
X3BhcmFtX2xlbiA9IChwYXJhbVswXSA8PCA4KSB8IHBhcmFtWzFdOworCisgICAgbm90aWZpY2F0
aW9uX2NsYXNzID0gcGFyYW1bMl0gJiAweDA3OworICAgIGlmIChub3RpZmljYXRpb25fY2xhc3Mg
IT0gQ0RfR0VUX0VWRU5UX0NMQVNTX0VYVEVSTkFMX1JFUSkgeworICAgICAgICBTUElDRV9ERUJV
Rygic2VuZF9ldmVudCwgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQKKyAgICAgICAgICAgICAgICAg
ICAgIiBpbnZhbGlkIG5vdGlmaWNhdGlvbiBjbGFzczoweCV4IiwKKyAgICAgICAgICAgICAgICAg
ICAgcmVxLT5sdW4sIG5vdGlmaWNhdGlvbl9jbGFzcyk7CisgICAgICAgIGNkX3Njc2lfY21kX2Nv
bXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX0lOVkFMSURfQ0RCX0ZJRUxE
KTsKKyAgICAgICAgcmV0dXJuOworICAgIH0KKworICAgIGV2ZW50ID0gcGFyYW0gKyBDRF9HRVRf
RVZFTlRfSEVBREVSX0xFTjsKKyAgICBleHRfcmVxX2V2ZW50ID0gZXZlbnRbMF0gJiAweGZmOwor
ICAgIGV4dF9yZXFfc3RhdHVzID0gZXZlbnRbMV0gJiAweDBmOworICAgIHBlcnNfcHJldmVudCA9
IGV2ZW50WzFdICYgMHg4MDsKKyAgICBleHRfcmVxX2NvZGUgPSAoZXZlbnRbMl0gPDwgOCkgfCBl
dmVudFszXTsKKworICAgIFNQSUNFX0RFQlVHKCJzZW5kX2V2ZW50LCBsdW46MHglIiBHX0dVSU5U
MzJfRk9STUFUCisgICAgICAgICAgICAgICAgIiBpbW1lZDolIiBHX0dVSU5UMzJfRk9STUFUICIg
cGFyYW1fbGVuOiUiIEdfR1VJTlQzMl9GT1JNQVQKKyAgICAgICAgICAgICAgICAiIGV4dF9yZXFf
ZXZlbnQ6MHgleCBleHRfcmVxX3N0YXR1czoweCV4IgorICAgICAgICAgICAgICAgICIgcGVyc19w
cmV2ZW50OjB4JXggZXh0X3JlcV9jb2RlOjB4JXgiLAorICAgICAgICAgICAgICAgIHJlcS0+bHVu
LCBpbW1lZCwgZXZlbnRfcGFyYW1fbGVuLCBleHRfcmVxX2V2ZW50LAorICAgICAgICAgICAgICAg
IGV4dF9yZXFfc3RhdHVzLCBwZXJzX3ByZXZlbnQsIGV4dF9yZXFfY29kZSk7CisKKyAgICAvKiBU
b0RvOiBwcm9jZXNzIHRoZSBldmVudCAqLworCisgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfZ29v
ZChkZXYsIHJlcSk7Cit9CisKKyNkZWZpbmUgQ0RfTUVESVVNX1JFTU9WQUxfUkVRX0FMTE9XICAg
ICAgICAgICAgICAgICAweDAwCisjZGVmaW5lIENEX01FRElVTV9SRU1PVkFMX1JFUV9QUkVWRU5U
ICAgICAgICAgICAgICAgMHgwMQorI2RlZmluZSBDRF9NRURJVU1fUkVNT1ZBTF9SRVFfQUxMT1df
Q0hBTkdFUiAgICAgICAgIDB4MDIKKyNkZWZpbmUgQ0RfTUVESVVNX1JFTU9WQUxfUkVRX1BSRVZF
TlRfQ0hBTkdFUiAgICAgICAweDAzCisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX2FsbG93X21l
ZGl1bV9yZW1vdmFsKENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICB1
aW50MzJfdCBwcmV2ZW50OworCisgICAgcmVxLT54ZmVyX2RpciA9IFNDU0lfWEZFUl9GUk9NX0RF
VjsKKworICAgIHByZXZlbnQgPSByZXEtPmNkYls0XSAmIDB4MDM7CisgICAgZGV2LT5wcmV2ZW50
X21lZGlhX3JlbW92YWwgPSAocHJldmVudCA9PSBDRF9NRURJVU1fUkVNT1ZBTF9SRVFfUFJFVkVO
VCB8fAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZXZlbnQgPT0gQ0RfTUVE
SVVNX1JFTU9WQUxfUkVRX1BSRVZFTlRfQ0hBTkdFUik7CisgICAgcmVxLT5pbl9sZW4gPSAwOwor
CisgICAgU1BJQ0VfREVCVUcoImFsbG93X21lZGl1bV9yZW1vdmFsLCBsdW46JSIgR19HVUlOVDMy
X0ZPUk1BVCAiIHByZXZlbnQgZmllbGQ6OjB4JTAyeCBmbGFnOiVkIiwKKyAgICAgICAgICAgICAg
ICByZXEtPmx1biwgcHJldmVudCwgZGV2LT5wcmV2ZW50X21lZGlhX3JlbW92YWwpOworCisgICAg
Y2Rfc2NzaV9jbWRfY29tcGxldGVfZ29vZChkZXYsIHJlcSk7Cit9CisKK3N0YXRpYyB2b2lkIGNk
X3Njc2lfY21kX3JlcG9ydF9rZXkoQ2RTY3NpTFUgKmRldiwgQ2RTY3NpUmVxdWVzdCAqcmVxKQor
eworICAgIFNQSUNFX0RFQlVHKCJyZXBvcnRfa2V5IC0gY29udGVudCBwcm90ZWN0aW9uIHVuc3Vw
cG9ydGVkLCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCwgcmVxLT5sdW4pOworICAgIHJlcS0+eGZl
cl9kaXIgPSBTQ1NJX1hGRVJfTk9ORTsKKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19j
b25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZBTElEX09QQ09ERSk7Cit9CisKK3N0YXRpYyB2
b2lkIGNkX3Njc2lfY21kX3NlbmRfa2V5KENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJl
cSkKK3sKKyAgICBTUElDRV9ERUJVRygic2VuZF9rZXkgLSBjb250ZW50IHByb3RlY3Rpb24gdW5z
dXBwb3J0ZWQsIGx1bjolIiBHX0dVSU5UMzJfRk9STUFULCByZXEtPmx1bik7CisgICAgcmVxLT54
ZmVyX2RpciA9IFNDU0lfWEZFUl9OT05FOworICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNr
X2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX0lOVkFMSURfT1BDT0RFKTsKK30KKworLyogYnl0
ZSAxICovCisjZGVmaW5lIENEX1NUQVJUX1NUT1BfRkxBR19JTU1FRCAgICAgICAgICAgICAgICAg
ICAgMHgwMQorCisvKiBieXRlIDQgKi8KKyNkZWZpbmUgQ0RfU1RBUlRfU1RPUF9GTEFHX1NUQVJU
ICAgICAgICAgICAgICAgICAgICAweDAxCisjZGVmaW5lIENEX1NUQVJUX1NUT1BfRkxBR19MT0VK
ICAgICAgICAgICAgICAgICAgICAgMHgwMgorCisvKiBQT1dFUiBDT05ESVRJT04gZmllbGQgdmFs
dWVzICovCisjZGVmaW5lIENEX1NUQVJUX1NUT1BfUE9XRVJfQ09ORF9TVEFSVF9WQUxJRCAgICAg
ICAgMHgwMAorI2RlZmluZSBDRF9TVEFSVF9TVE9QX1BPV0VSX0NPTkRfQUNUSVZFICAgICAgICAg
ICAgIDB4MDEKKyNkZWZpbmUgQ0RfU1RBUlRfU1RPUF9QT1dFUl9DT05EX0lETEUgICAgICAgICAg
ICAgICAweDAyCisjZGVmaW5lIENEX1NUQVJUX1NUT1BfUE9XRVJfQ09ORF9TVEFOREJZICAgICAg
ICAgICAgMHgwMworI2RlZmluZSBDRF9TVEFSVF9TVE9QX1BPV0VSX0NPTkRfTFVfQ09OVFJPTCAg
ICAgICAgIDB4MDcKKyNkZWZpbmUgQ0RfU1RBUlRfU1RPUF9QT1dFUl9DT05EX0ZPUkNFX0lETEVf
MCAgICAgICAweDBhCisjZGVmaW5lIENEX1NUQVJUX1NUT1BfUE9XRVJfQ09ORF9GT1JDRV9TVEFO
REJZXzAgICAgMHgwYgorCitzdGF0aWMgaW5saW5lIGNvbnN0IGNoYXIgKmNkX3Njc2lfc3RhcnRf
c3RvcF9wb3dlcl9jb25kX25hbWUodWludDMyX3QgcG93ZXJfY29uZCkKK3sKKyAgICBzd2l0Y2gg
KHBvd2VyX2NvbmQpIHsKKyAgICBjYXNlIENEX1NUQVJUX1NUT1BfUE9XRVJfQ09ORF9TVEFSVF9W
QUxJRDoKKyAgICAgICAgcmV0dXJuICJTVEFSVF9WQUxJRCI7CisgICAgY2FzZSBDRF9TVEFSVF9T
VE9QX1BPV0VSX0NPTkRfQUNUSVZFOgorICAgICAgICByZXR1cm4gIkFDVElWRSI7CisgICAgY2Fz
ZSBDRF9TVEFSVF9TVE9QX1BPV0VSX0NPTkRfSURMRToKKyAgICAgICAgcmV0dXJuICJJRExFIjsK
KyAgICBjYXNlIENEX1NUQVJUX1NUT1BfUE9XRVJfQ09ORF9TVEFOREJZOgorICAgICAgICByZXR1
cm4gIlNUQU5EQlkiOworICAgIGNhc2UgQ0RfU1RBUlRfU1RPUF9QT1dFUl9DT05EX0xVX0NPTlRS
T0w6CisgICAgICAgIHJldHVybiAiTFVfQ09OVFJPTCI7CisgICAgY2FzZSBDRF9TVEFSVF9TVE9Q
X1BPV0VSX0NPTkRfRk9SQ0VfSURMRV8wOgorICAgICAgICByZXR1cm4gIkZPUkNFX0lETEVfMCI7
CisgICAgY2FzZSBDRF9TVEFSVF9TVE9QX1BPV0VSX0NPTkRfRk9SQ0VfU1RBTkRCWV8wOgorICAg
ICAgICByZXR1cm4gIkZPUkNFX1NUQU5EQllfMCI7CisgICAgZGVmYXVsdDoKKyAgICAgICAgcmV0
dXJuICJSRVNFUlZFRCI7CisgICAgfQorfQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9zdGFy
dF9zdG9wX3VuaXQoQ2RTY3NpTFUgKmRldiwgQ2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAgIGdi
b29sZWFuIGltbWVkLCBzdGFydCwgbG9hZF9lamVjdDsKKyAgICB1aW50MzJfdCBwb3dlcl9jb25k
OworCisgICAgcmVxLT54ZmVyX2RpciA9IFNDU0lfWEZFUl9OT05FOworICAgIHJlcS0+aW5fbGVu
ID0gMDsKKworICAgIGltbWVkID0gKHJlcS0+Y2RiWzFdICYgQ0RfU1RBUlRfU1RPUF9GTEFHX0lN
TUVEKSA/IFRSVUUgOiBGQUxTRTsKKyAgICBzdGFydCA9IChyZXEtPmNkYls0XSAmIENEX1NUQVJU
X1NUT1BfRkxBR19TVEFSVCkgPyBUUlVFIDogRkFMU0U7CisgICAgbG9hZF9lamVjdCA9IChyZXEt
PmNkYls0XSAmIENEX1NUQVJUX1NUT1BfRkxBR19MT0VKKSA/IFRSVUUgOiBGQUxTRTsKKyAgICBw
b3dlcl9jb25kID0gcmVxLT5jZGJbNF0gPj4gNDsKKworICAgIFNQSUNFX0RFQlVHKCJzdGFydF9z
dG9wX3VuaXQsIGx1bjoweCUiIEdfR1VJTlQzMl9GT1JNQVQKKyAgICAgICAgICAgICAgICAiIGlt
bWVkOiVkIHN0YXJ0OiVkIGxvYWRfZWplY3Q6JWQgcG93ZXJfY29uZDoweCV4KCVzKSIsCisgICAg
ICAgICAgICAgICAgcmVxLT5sdW4sIGltbWVkLCBzdGFydCwgbG9hZF9lamVjdCwgcG93ZXJfY29u
ZCwKKyAgICAgICAgICAgICAgICBjZF9zY3NpX3N0YXJ0X3N0b3BfcG93ZXJfY29uZF9uYW1lKHBv
d2VyX2NvbmQpKTsKKworICAgIHN3aXRjaCAocG93ZXJfY29uZCkgeworICAgIGNhc2UgQ0RfU1RB
UlRfU1RPUF9QT1dFUl9DT05EX1NUQVJUX1ZBTElEOgorICAgICAgICBpZiAoIXN0YXJ0KSB7IC8q
IHN0b3AgdGhlIHVuaXQgKi8KKyAgICAgICAgICAgIGlmIChsb2FkX2VqZWN0KSB7IC8qIGVqZWN0
IG1lZGl1bSAqLworICAgICAgICAgICAgICAgIGlmIChkZXYtPnByZXZlbnRfbWVkaWFfcmVtb3Zh
bCkgeworICAgICAgICAgICAgICAgICAgICBTUElDRV9ERUJVRygic3RhcnRfc3RvcF91bml0LCBs
dW46MHglIiBHX0dVSU5UMzJfRk9STUFUCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICIgcHJldmVudF9tZWRpYV9yZW1vdmFsIHNldCwgZWplY3QgZmFpbGVkIiwgcmVxLT5sdW4pOwor
ICAgICAgICAgICAgICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwg
cmVxLCAmc2Vuc2VfY29kZV9NRURJVU1fUkVNT1ZBTF9QUkVWRU5URUQpOworICAgICAgICAgICAg
ICAgICAgICByZXR1cm47CisgICAgICAgICAgICAgICAgfQorICAgICAgICAgICAgICAgIFNQSUNF
X0RFQlVHKCJzdGFydF9zdG9wX3VuaXQsIGx1bjoweCUiIEdfR1VJTlQzMl9GT1JNQVQgIiBlamVj
dCIsIHJlcS0+bHVuKTsKKyAgICAgICAgICAgICAgICBjZF9zY3NpX2x1X3VubG9hZChkZXYpOwor
ICAgICAgICAgICAgICAgIGNkX3Njc2lfZGV2X2NoYW5nZWQoZGV2LT50Z3QtPnVzZXJfZGF0YSwg
cmVxLT5sdW4pOworICAgICAgICAgICAgfQorICAgICAgICAgICAgZGV2LT5wb3dlcl9jb25kID0g
Q0RfU0NTSV9QT1dFUl9TVE9QUEVEOworICAgICAgICAgICAgU1BJQ0VfREVCVUcoInN0YXJ0X3N0
b3BfdW5pdCwgbHVuOjB4JSIgR19HVUlOVDMyX0ZPUk1BVCAiIHN0b3BwZWQiLCByZXEtPmx1bik7
CisgICAgICAgIH0gZWxzZSB7IC8qIHN0YXJ0IHRoZSB1bml0ICovCisgICAgICAgICAgICBkZXYt
PnBvd2VyX2NvbmQgPSBDRF9TQ1NJX1BPV0VSX0FDVElWRTsKKyAgICAgICAgICAgIFNQSUNFX0RF
QlVHKCJzdGFydF9zdG9wX3VuaXQsIGx1bjoweCUiIEdfR1VJTlQzMl9GT1JNQVQgIiBzdGFydGVk
IiwgcmVxLT5sdW4pOworCisgICAgICAgICAgICBpZiAobG9hZF9lamVjdCkgeyAvKiBsb2FkIG1l
ZGl1bSAqLworICAgICAgICAgICAgICAgIFNQSUNFX0RFQlVHKCJzdGFydF9zdG9wX3VuaXQsIGx1
bjoweCUiIEdfR1VJTlQzMl9GT1JNQVQgIiBsb2FkIHdpdGggbm8gbWVkaWEiLCByZXEtPmx1bik7
CisgICAgICAgICAgICAgICAgY2Rfc2NzaV9sdV9sb2FkKGRldiwgTlVMTCk7CisgICAgICAgICAg
ICAgICAgY2Rfc2NzaV9kZXZfY2hhbmdlZChkZXYtPnRndC0+dXNlcl9kYXRhLCByZXEtPmx1bik7
CisgICAgICAgICAgICB9CisgICAgICAgIH0KKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBDRF9T
VEFSVF9TVE9QX1BPV0VSX0NPTkRfQUNUSVZFOgorICAgICAgICAvKiBub3QgZXJyb3IgdG8gc3Bl
Y2lmeSB0cmFuc2l0aW9uIHRvIHRoZSBjdXJyZW50IHBvd2VyIGNvbmRpdGlvbiAqLworICAgICAg
ICBkZXYtPnBvd2VyX2NvbmQgPSBDRF9TQ1NJX1BPV0VSX0FDVElWRTsKKyAgICAgICAgU1BJQ0Vf
REVCVUcoInN0YXJ0X3N0b3BfdW5pdCwgbHVuOjB4JSIgR19HVUlOVDMyX0ZPUk1BVCAiIGFjdGl2
ZSIsIHJlcS0+bHVuKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBDRF9TVEFSVF9TVE9QX1BP
V0VSX0NPTkRfSURMRToKKyAgICBjYXNlIENEX1NUQVJUX1NUT1BfUE9XRVJfQ09ORF9GT1JDRV9J
RExFXzA6CisgICAgICAgIGRldi0+cG93ZXJfY29uZCA9IENEX1NDU0lfUE9XRVJfSURMRTsKKyAg
ICAgICAgU1BJQ0VfREVCVUcoInN0YXJ0X3N0b3BfdW5pdCwgbHVuOjB4JSIgR19HVUlOVDMyX0ZP
Uk1BVCAiIGlkbGUiLCByZXEtPmx1bik7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgQ0RfU1RB
UlRfU1RPUF9QT1dFUl9DT05EX1NUQU5EQlk6CisgICAgY2FzZSBDRF9TVEFSVF9TVE9QX1BPV0VS
X0NPTkRfRk9SQ0VfU1RBTkRCWV8wOgorICAgICAgICBkZXYtPnBvd2VyX2NvbmQgPSBDRF9TQ1NJ
X1BPV0VSX1NUQU5EQlk7CisgICAgICAgIFNQSUNFX0RFQlVHKCJzdGFydF9zdG9wX3VuaXQsIGx1
bjoweCUiIEdfR1VJTlQzMl9GT1JNQVQgIiBzdGFuZGJ5IiwgcmVxLT5sdW4pOworICAgICAgICBi
cmVhazsKKyAgICBjYXNlIENEX1NUQVJUX1NUT1BfUE9XRVJfQ09ORF9MVV9DT05UUk9MOgorICAg
ICAgICBicmVhazsKKyAgICBkZWZhdWx0OgorICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9j
aGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZBTElEX0NEQl9GSUVMRCk7CisgICAg
ICAgIHJldHVybjsKKyAgICB9CisgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfZ29vZChkZXYsIHJl
cSk7Cit9CisKKyNkZWZpbmUgQ0RfUEVSRl9UWVBFX1BFUkZPUk1BTkNFICAgICAgICAgICAgICAg
IDB4MDAKKyNkZWZpbmUgQ0RfUEVSRl9UWVBFX1VOVVNBQkxFX0FSRUEgICAgICAgICAgICAgIDB4
MDEKKyNkZWZpbmUgQ0RfUEVSRl9UWVBFX0RFRkVDVF9TVEFUVVMgICAgICAgICAgICAgIDB4MDIK
KyNkZWZpbmUgQ0RfUEVSRl9UWVBFX1dSSVRFX1NQRUVEICAgICAgICAgICAgICAgIDB4MDMKKwor
I2RlZmluZSBDRF9QRVJGX0hFQURFUl9MRU4gICAgICAgICAgICAgICAgICAgICAgOAorCisjZGVm
aW5lIENEX1BFUkZfVFlQRV9QRVJGT1JNQU5DRV9ERVNDUl9MRU4gICAgICAxNgorCisjZGVmaW5l
IENEX1BFUkZfVFlQRV9QRVJGT1JNQU5DRV9SRVBPUlRfTk9NSU5BTCAweDAwCisjZGVmaW5lIENE
X1BFUkZfVFlQRV9QRVJGT1JNQU5DRV9SRVBPUlRfQUxMICAgICAweDAxCisjZGVmaW5lIENEX1BF
UkZfVFlQRV9QRVJGT1JNQU5DRV9SRVBPUlRfRVhDRVBUICAweDEwCisKKworc3RhdGljIHZvaWQg
Y2Rfc2NzaV9nZXRfcGVyZm9ybWFuY2VfcmVzcF9lbXB0eShDZFNjc2lMVSAqZGV2LCBDZFNjc2lS
ZXF1ZXN0ICpyZXEsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHVpbnQzMl90IHR5cGUsIHVpbnQzMl90IGRhdGFfdHlwZSwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyX3QgbWF4X251bV9kZXNjcikKK3sK
KyAgICB1aW50OF90ICpvdXRidWYgPSByZXEtPmJ1ZjsKKyAgICB1aW50MzJfdCB3cml0ZSA9IChk
YXRhX3R5cGUgPj4gMikgJiAweDAxOworCisgICAgbWVtc2V0KG91dGJ1ZiwgMCwgQ0RfUEVSRl9I
RUFERVJfTEVOKTsKKyAgICBpZiAod3JpdGUpIHsKKyAgICAgICAgb3V0YnVmWzRdID0gMHgwMjsK
KyAgICB9CisgICAgcmVxLT5pbl9sZW4gPSBDRF9QRVJGX0hFQURFUl9MRU47CisKKyAgICBTUElD
RV9ERUJVRygiZ2V0X3BlcmZvcm1hbmNlLCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVAorICAgICAg
ICAgICAgICAgICIgdHlwZToweCV4IGRhdGFfdHlwZToweCV4IC0gc2VuZGluZyBlbXB0eSByZXNw
b25zZSIsCisgICAgICAgICAgICAgICAgcmVxLT5sdW4sIHR5cGUsIGRhdGFfdHlwZSk7CisKKyAg
ICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworc3RhdGljIHZvaWQg
Y2Rfc2NzaV9nZXRfcGVyZm9ybWFuY2VfcmVzcF9wZXJmb3JtYW5jZShDZFNjc2lMVSAqZGV2LCBD
ZFNjc2lSZXF1ZXN0ICpyZXEsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHVpbnQzMl90IHN0YXJ0X2xiYSwKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyX3QgZGF0YV90eXBlLAorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJf
dCBtYXhfbnVtX2Rlc2NyKQoreworICAgIHVpbnQ4X3QgKm91dGJ1ZiA9IHJlcS0+YnVmLCAqcGVy
Zl9kZXNjOworICAgIHVpbnQzMl90IHJlc3BfbGVuID0gQ0RfUEVSRl9IRUFERVJfTEVOICsKKyAg
ICAgICAgICAgICAgICAgICAgICAgIENEX1BFUkZfVFlQRV9QRVJGT1JNQU5DRV9ERVNDUl9MRU47
CisgICAgdWludDMyX3QgcGVyZl9kYXRhX2xlbiA9IHJlc3BfbGVuIC0gNDsgLyogbm90IGluY2wu
IFBlcmYgRGF0YSBMZW5ndGggKi8KKyAgICB1aW50MzJfdCBwZXJmX2tiID0gMTAwMDA7CisgICAg
dWludDMyX3QgZW5kX2xiYSA9IGRldi0+bnVtX2Jsb2NrcyAtIDE7CisgICAgdWludDMyX3QgZXhj
ZXB0LCB3cml0ZSwgdG9sZXJhbmNlOworCisgICAgZXhjZXB0ID0gZGF0YV90eXBlICYgMHgwMzsK
KyAgICBpZiAoZXhjZXB0ICE9IENEX1BFUkZfVFlQRV9QRVJGT1JNQU5DRV9SRVBPUlRfQUxMKSB7
CisgICAgICAgIHN0YXJ0X2xiYSA9IDA7CisgICAgfQorICAgIHdyaXRlID0gKGRhdGFfdHlwZSA+
PiAyKSAmIDB4MDE7CisgICAgdG9sZXJhbmNlID0gKGRhdGFfdHlwZSA+PiAzKSAmIDB4MDM7CisK
KyAgICBTUElDRV9ERUJVRygiZ2V0X3BlcmZvcm1hbmNlLCBsdW46JSIgR19HVUlOVDMyX0ZPUk1B
VAorICAgICAgICAgICAgICAgICIgcGVyZm9ybWFuY2UgdHlwZToweDAwIGRhdGFfdHlwZToweCV4
IgorICAgICAgICAgICAgICAgICIgZXhjZXB0OjB4JXggd3JpdGU6MHgleCB0b2xlcmFuY2U6MHgl
eCIKKyAgICAgICAgICAgICAgICAiIG1heF9udW06JSIgR19HVUlOVDMyX0ZPUk1BVCwKKyAgICAg
ICAgICAgICAgICByZXEtPmx1biwgZGF0YV90eXBlLCBleGNlcHQsIHdyaXRlLAorICAgICAgICAg
ICAgICAgIHRvbGVyYW5jZSwgbWF4X251bV9kZXNjcik7CisKKyAgICBpZiAod3JpdGUpIHsKKyAg
ICAgICAgU1BJQ0VfREVCVUcoImdldF9wZXJmb3JtYW5jZSwgbHVuOiUiIEdfR1VJTlQzMl9GT1JN
QVQKKyAgICAgICAgICAgICAgICAiIHBlcmZvcm1hbmNlIHR5cGU6MHgwMCBkYXRhX3R5cGU6MHgl
eCAtIHdyaXRlIHVuc3VwcG9ydGVkIiwKKyAgICAgICAgICAgICAgICByZXEtPmx1biwgZGF0YV90
eXBlKTsKKyAgICAgICAgY2Rfc2NzaV9nZXRfcGVyZm9ybWFuY2VfcmVzcF9lbXB0eShkZXYsIHJl
cSwgQ0RfUEVSRl9UWVBFX1BFUkZPUk1BTkNFLAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGRhdGFfdHlwZSwgbWF4X251bV9kZXNjcik7CisgICAgICAgIHJldHVy
bjsKKyAgICB9CisKKyAgICBtZW1zZXQob3V0YnVmLCAwLCByZXNwX2xlbik7CisKKyAgICBvdXRi
dWZbMF0gPSAocGVyZl9kYXRhX2xlbiA+PiAyNCkgJiAweGZmOworICAgIG91dGJ1ZlsxXSA9IChw
ZXJmX2RhdGFfbGVuID4+IDE2KSAmIDB4ZmY7CisgICAgb3V0YnVmWzJdID0gKHBlcmZfZGF0YV9s
ZW4gPj4gOCkgJiAweGZmOworICAgIG91dGJ1ZlszXSA9IHBlcmZfZGF0YV9sZW4gJiAweGZmOwor
CisgICAgcGVyZl9kZXNjID0gb3V0YnVmICsgQ0RfUEVSRl9IRUFERVJfTEVOOworCisgICAgcGVy
Zl9kZXNjWzBdID0gKHN0YXJ0X2xiYSA+PiAyNCkgJiAweGZmOworICAgIHBlcmZfZGVzY1sxXSA9
IChzdGFydF9sYmEgPj4gMTYpICYgMHhmZjsKKyAgICBwZXJmX2Rlc2NbMl0gPSAoc3RhcnRfbGJh
ID4+IDgpICYgMHhmZjsKKyAgICBwZXJmX2Rlc2NbM10gPSBzdGFydF9sYmEgJiAweGZmOworCisg
ICAgcGVyZl9kZXNjWzRdID0gKHBlcmZfa2IgPj4gMjQpICYgMHhmZjsKKyAgICBwZXJmX2Rlc2Nb
NV0gPSAocGVyZl9rYiA+PiAxNikgJiAweGZmOworICAgIHBlcmZfZGVzY1s2XSA9IChwZXJmX2ti
ID4+IDgpICYgMHhmZjsKKyAgICBwZXJmX2Rlc2NbN10gPSBwZXJmX2tiICYgMHhmZjsKKworICAg
IHBlcmZfZGVzY1s4XSA9IChlbmRfbGJhID4+IDI0KSAmIDB4ZmY7CisgICAgcGVyZl9kZXNjWzld
ID0gKGVuZF9sYmEgPj4gMTYpICYgMHhmZjsKKyAgICBwZXJmX2Rlc2NbMTBdID0gKGVuZF9sYmEg
Pj4gOCkgJiAweGZmOworICAgIHBlcmZfZGVzY1sxMV0gPSBlbmRfbGJhICYgMHhmZjsKKworICAg
IHBlcmZfZGVzY1sxMl0gPSAocGVyZl9rYiA+PiAyNCkgJiAweGZmOworICAgIHBlcmZfZGVzY1sx
M10gPSAocGVyZl9rYiA+PiAxNikgJiAweGZmOworICAgIHBlcmZfZGVzY1sxNF0gPSAocGVyZl9r
YiA+PiA4KSAmIDB4ZmY7CisgICAgcGVyZl9kZXNjWzE1XSA9IHBlcmZfa2IgJiAweGZmOworCisg
ICAgcmVxLT5yZXFfbGVuID0gQ0RfUEVSRl9IRUFERVJfTEVOICsKKyAgICAgICAgICAgICAgICAg
ICAobWF4X251bV9kZXNjciAqIENEX1BFUkZfVFlQRV9QRVJGT1JNQU5DRV9ERVNDUl9MRU4pOwor
CisgICAgcmVxLT5pbl9sZW4gPSAocmVxLT5yZXFfbGVuIDwgcmVzcF9sZW4pID8gcmVxLT5yZXFf
bGVuIDogcmVzcF9sZW47CisKKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVx
KTsKK30KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRfZ2V0X3BlcmZvcm1hbmNlKENkU2NzaUxV
ICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICB1aW50MzJfdCBkYXRhX3R5cGUsIG1h
eF9udW1fZGVzY3IsIHN0YXJ0X2xiYSwgdHlwZTsKKworICAgIHJlcS0+eGZlcl9kaXIgPSBTQ1NJ
X1hGRVJfRlJPTV9ERVY7CisKKyAgICBkYXRhX3R5cGUgPSByZXEtPmNkYlsxXSAmIDB4MGY7Cisg
ICAgc3RhcnRfbGJhID0gKHJlcS0+Y2RiWzJdIDw8IDI0KSB8CisgICAgICAgICAgICAgICAgKHJl
cS0+Y2RiWzNdIDw8IDE2KSB8CisgICAgICAgICAgICAgICAgKHJlcS0+Y2RiWzRdIDw8IDgpIHwK
KyAgICAgICAgICAgICAgICAgcmVxLT5jZGJbNV07CisgICAgbWF4X251bV9kZXNjciA9IChyZXEt
PmNkYls4XSA8PCA4KSB8IHJlcS0+Y2RiWzldOworICAgIHR5cGUgPSByZXEtPmNkYlsxMF07CisK
KyAgICBzd2l0Y2ggKHR5cGUpIHsKKyAgICBjYXNlIENEX1BFUkZfVFlQRV9QRVJGT1JNQU5DRToK
KyAgICAgICAgY2Rfc2NzaV9nZXRfcGVyZm9ybWFuY2VfcmVzcF9wZXJmb3JtYW5jZShkZXYsIHJl
cSwgc3RhcnRfbGJhLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGRhdGFfdHlwZSwgbWF4X251bV9kZXNjcik7CisgICAgICAgIGJyZWFrOworICAgIGNh
c2UgQ0RfUEVSRl9UWVBFX1VOVVNBQkxFX0FSRUE6IC8qIG5vdCB3cml0YWJsZSAqLworICAgIGNh
c2UgQ0RfUEVSRl9UWVBFX0RFRkVDVF9TVEFUVVM6IC8qIG5vdCByZXN0cmljdGVkIG92ZXJ3cml0
ZSBtZWRpYSAqLworICAgIGNhc2UgQ0RfUEVSRl9UWVBFX1dSSVRFX1NQRUVEOiAvKiB1bnN1cHBv
cnRlZCwgaXJyZWxldmFudCAqLworICAgIGRlZmF1bHQ6CisgICAgICAgIFNQSUNFX0RFQlVHKCJn
ZXRfcGVyZm9ybWFuY2UsIGx1bjolIiBHX0dVSU5UMzJfRk9STUFUCisgICAgICAgICAgICAgICAg
ICAgICIgdW5zdXBwb3J0ZWQgdHlwZToweCV4IgorICAgICAgICAgICAgICAgICAgICAiIGRhdGFf
dHlwZToweCV4IG1heF9udW06JSIgR19HVUlOVDMyX0ZPUk1BVCwKKyAgICAgICAgICAgICAgICAg
ICAgcmVxLT5sdW4sIHR5cGUsIGRhdGFfdHlwZSwgbWF4X251bV9kZXNjcik7CisgICAgICAgIGNk
X3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX0lOVkFM
SURfQ0RCX0ZJRUxEKTsKKyAgICAgICAgcmV0dXJuOworICAgIH0KK30KKworI2RlZmluZSBDRF9N
RUNIQU5JU01fU1RBVFVTX0hEUl9MRU4gICAgIDgKKworLyogYnl0ZSAwICovCisjZGVmaW5lIENE
X0NIQU5HRVJfRkFVTFRfRkxBRyAgICAgICAgICAgMHg4MAorCisjZGVmaW5lIENEX0NIQU5HRVJf
UkVBRFkgICAgICAgICAgICAgICAgMHgwMAorI2RlZmluZSBDRF9DSEFOR0VSX0xPQURJTkcgICAg
ICAgICAgICAgIDB4MDEKKyNkZWZpbmUgQ0RfQ0hBTkdFUl9VTkxPQURJTkcgICAgICAgICAgICAw
eDAyCisjZGVmaW5lIENEX0NIQU5HRVJfSU5JVElBTElaSU5HICAgICAgICAgMHgwMworCisvKiBi
eXRlIDEgKi8KKyNkZWZpbmUgQ0RfQ0hBTkdFUl9ET09SX09QRU5fRkxBRyAgICAgICAweDEwCisK
KyNkZWZpbmUgQ0RfTUVDSEFOSVNNX1NUQVRFX0lETEUgICAgICAgICAweDAwCisjZGVmaW5lIENE
X01FQ0hBTklTTV9TVEFURV9QTEFZSU5HICAgICAgMHgwMQorI2RlZmluZSBDRF9NRUNIQU5JU01f
U1RBVEVfU0NBTk5JTkcgICAgIDB4MDIKKy8qIEFDVElWRTogd2l0aCBJbml0aWF0b3IsIENvbXBv
c2l0ZSBvciBPdGhlciBwb3J0cworICAoaS5lLiBSRUFELCBQTEFZIENELCBTQ0FOIGR1cmluZyBQ
TEFZIENEKSAqLworI2RlZmluZSBDRF9NRUNIQU5JU01fU1RBVEVfQUNUSVZFICAgICAgIDB4MDMK
KyNkZWZpbmUgQ0RfTUVDSEFOSVNNX1NUQVRFX05PX0lORk8gICAgICAweDA3CisKKy8qIHNsb3Rz
ICovCisjZGVmaW5lIENEX01FQ0hBTklTTV9TVEFUVVNfU0xPVF9MRU4gICAgNAorCisjZGVmaW5l
IENEX01FQ0hBTklTTV9TTE9UX0RJU0tfQ0hBTkdFRCAgMHgwMQorI2RlZmluZSBDRF9NRUNIQU5J
U01fU0xPVF9ESVNLX1BSRVNFTlQgIDB4ODAKKyNkZWZpbmUgQ0RfTUVDSEFOSVNNX1NMT1RfRElT
S19DV1BfViAgICAweDAyCisjZGVmaW5lIENEX01FQ0hBTklTTV9TTE9UX0RJU0tfQ1dQICAgICAg
MHgwMQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9tZWNoYW5pc21fc3RhdHVzKENkU2NzaUxV
ICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICB1aW50OF90ICpvdXRidWYgPSByZXEt
PmJ1ZjsKKyAgICB1aW50MzJfdCByZXNwX2xlbiA9IENEX01FQ0hBTklTTV9TVEFUVVNfSERSX0xF
TjsKKworICAgIHJlcS0+eGZlcl9kaXIgPSBTQ1NJX1hGRVJfRlJPTV9ERVY7CisKKyAgICByZXEt
PnJlcV9sZW4gPSAocmVxLT5jZGJbOF0gPDwgOCkgfCByZXEtPmNkYls5XTsKKyAgICBtZW1zZXQo
b3V0YnVmLCAwLCByZXEtPnJlcV9sZW4pOworCisgICAgLyogRm9yIG5vbi1jaGFuZ2VyIGRldmlj
ZXMgdGhlIGN1cmVudCBzbG90IG51bWJlciBmaWVsZCBpcyByZXNlcnZlZCwgc2V0IG9ubHkgc3Rh
dHVzICovCisgICAgb3V0YnVmWzBdIHw9IChDRF9DSEFOR0VSX1JFQURZIDw8IDUpOworCisgICAg
b3V0YnVmWzFdIHw9ICghZGV2LT5sb2FkZWQpID8gQ0RfQ0hBTkdFUl9ET09SX09QRU5fRkxBRyA6
IDA7CisgICAgb3V0YnVmWzFdIHw9IChkZXYtPnBvd2VyX2NvbmQgPT0gQ0RfUE9XRVJfU1RBVFVT
X0FDVElWRSkgPworICAgICAgICAgICAgICAgICAoQ0RfTUVDSEFOSVNNX1NUQVRFX0FDVElWRSA8
PCA1KSA6IChDRF9NRUNIQU5JU01fU1RBVEVfSURMRSA8PCA1KTsKKworICAgIC8qIEZvciBub24t
Y2hhbmdlciBkZXZpY2VzIHRoZSBudW1iZXIgb2Ygc2xvdCB0YWJsZXMgcmV0dXJuZWQgc2hhbGwg
YmUgemVybywgc28gd2UgbGVhdmUKKyAgICAgICBib3RoICdOdW1iZXIgb2YgU2xvdHMgQXZhaWxh
YmxlJyBhbmQgJ0xlbmd0aCBvZiBTbG90IFRhYmxlJyBmaWVsZHMgYXMgemVyb3MgKi8KKworICAg
IHJlcS0+aW5fbGVuID0gKHJlcS0+cmVxX2xlbiA8IHJlc3BfbGVuKSA/IHJlcS0+cmVxX2xlbiA6
IHJlc3BfbGVuOworCisgICAgU1BJQ0VfREVCVUcoIm1lY2hhbmlzbV9zdGF0dXMsIGx1bjolIiBH
X0dVSU5UMzJfRk9STUFULCByZXEtPmx1bik7CisKKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9n
b29kKGRldiwgcmVxKTsKK30KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9yZWFkX2FzeW5jX2NvbXBs
ZXRlKEdPYmplY3QgKnNyY19vYmplY3QsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgR0FzeW5jUmVzdWx0ICpyZXN1bHQsCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgZ3BvaW50ZXIgdXNlcl9kYXRhKQoreworICAgIEdGaWxlSW5wdXRTdHJl
YW0gKnN0cmVhbSA9IEdfRklMRV9JTlBVVF9TVFJFQU0oc3JjX29iamVjdCk7CisgICAgQ2RTY3Np
UmVxdWVzdCAqcmVxID0gKENkU2NzaVJlcXVlc3QgKil1c2VyX2RhdGE7CisgICAgQ2RTY3NpVGFy
Z2V0ICpzdCA9IChDZFNjc2lUYXJnZXQgKilyZXEtPnByaXZfZGF0YTsKKyAgICBDZFNjc2lMVSAq
ZGV2ID0gJnN0LT51bml0c1tyZXEtPmx1bl07CisgICAgR0Vycm9yICplcnJvciA9IE5VTEw7Cisg
ICAgZ3NpemUgYnl0ZXNfcmVhZDsKKyAgICBnYm9vbGVhbiBmaW5pc2hlZDsKKworICAgIHJlcS0+
cmVxX3N0YXRlID0gU0NTSV9SRVFfQ09NUExFVEU7CisgICAgcmVxLT5jYW5jZWxfaWQgPSAwOwor
CisvLyAgICBnX2Fzc2VydChzdHJlYW0gPT0gZGV2LT5zdHJlYW0pOworICAgIGlmIChzdHJlYW0g
IT0gZGV2LT5zdHJlYW0pIHsKKyAgICAgICAgdWludDMyX3Qgb3Bjb2RlID0gKHVpbnQzMl90KXJl
cS0+Y2RiWzBdOworICAgICAgICBTUElDRV9ERUJVRygicmVhZF9hc3luY19jb21wbGV0ZSBCQUQg
U1RSRUFNLCBsdW46ICUiIEdfR1VJTlQzMl9GT1JNQVQKKyAgICAgICAgICAgICAgICAgICAgIiBy
ZXE6ICUiIEdfR1VJTlQ2NF9GT1JNQVQgIiBvcDogMHglMDJ4IiwKKyAgICAgICAgICAgICAgICAg
ICAgcmVxLT5sdW4sIHJlcS0+cmVxX2xlbiwgb3Bjb2RlKTsKKyAgICAgICAgY2Rfc2NzaV9jbWRf
Y29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfVEFSR0VUX0ZBSUxVUkUp
OworICAgICAgICBjZF9zY3NpX2Rldl9yZXF1ZXN0X2NvbXBsZXRlKHN0LT51c2VyX2RhdGEsIHJl
cSk7CisgICAgICAgIHJldHVybjsKKyAgICB9CisKKyAgICBieXRlc19yZWFkID0gZ19pbnB1dF9z
dHJlYW1fcmVhZF9maW5pc2goR19JTlBVVF9TVFJFQU0oc3RyZWFtKSwgcmVzdWx0LCAmZXJyb3Ip
OworICAgIGZpbmlzaGVkID0gYnl0ZXNfcmVhZCA+IDA7CisgICAgaWYgKGZpbmlzaGVkKSB7Cisg
ICAgICAgIFNQSUNFX0RFQlVHKCJyZWFkX2FzeW5jX2NvbXBsZXRlLCBsdW46ICUiIEdfR1VJTlQz
Ml9GT1JNQVQKKyAgICAgICAgICAgICAgICAgICAgIiBmaW5pc2hlZDogJWQgYnl0ZXNfcmVhZDog
JSIgR19HVUlOVDY0X0ZPUk1BVAorICAgICAgICAgICAgICAgICAgICAiIHJlcTogJSIgIEdfR1VJ
TlQ2NF9GT1JNQVQsCisgICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBmaW5pc2hlZCwgKHVp
bnQ2NF90KWJ5dGVzX3JlYWQsIHJlcS0+cmVxX2xlbik7CisKKyAgICAgICAgcmVxLT5pbl9sZW4g
PSAoYnl0ZXNfcmVhZCA8PSByZXEtPnJlcV9sZW4pID8gYnl0ZXNfcmVhZCA6IHJlcS0+cmVxX2xl
bjsKKyAgICAgICAgcmVxLT5zdGF0dXMgPSBHT09EOworICAgIH0gZWxzZSB7CisgICAgICAgIGlm
IChlcnJvciAhPSBOVUxMKSB7CisgICAgICAgICAgICBTUElDRV9FUlJPUigiZ19pbnB1dF9zdHJl
YW1fcmVhZF9maW5pc2ggZmFpbGVkOiAlcyIsIGVycm9yLT5tZXNzYWdlKTsKKyAgICAgICAgICAg
IGdfY2xlYXJfZXJyb3IgKCZlcnJvcik7CisgICAgICAgIH0gZWxzZSB7CisgICAgICAgICAgICBT
UElDRV9FUlJPUigiZ19pbnB1dF9zdHJlYW1fcmVhZF9maW5pc2ggZmFpbGVkIChubyBlcnIgcHJv
dmlkZWQpIik7CisgICAgICAgIH0KKyAgICAgICAgcmVxLT5pbl9sZW4gPSAwOworICAgICAgICBy
ZXEtPnN0YXR1cyA9IEdPT0Q7CisgICAgfQorICAgIGNkX3Njc2lfZGV2X3JlcXVlc3RfY29tcGxl
dGUoc3QtPnVzZXJfZGF0YSwgcmVxKTsKK30KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9yZWFkX2Fz
eW5jX2NhbmNlbGVkKEdDYW5jZWxsYWJsZSAqY2FuY2VsbGFibGUsIGdwb2ludGVyIHVzZXJfZGF0
YSkKK3sKKyAgICBDZFNjc2lSZXF1ZXN0ICpyZXEgPSAoQ2RTY3NpUmVxdWVzdCAqKXVzZXJfZGF0
YTsKKyAgICBDZFNjc2lUYXJnZXQgKnN0ID0gKENkU2NzaVRhcmdldCAqKXJlcS0+cHJpdl9kYXRh
OworCisgICAgZ19hc3NlcnQoY2FuY2VsbGFibGUgPT0gc3QtPmNhbmNlbGxhYmxlKTsKKyAgICBn
X2NhbmNlbGxhYmxlX2Rpc2Nvbm5lY3QoY2FuY2VsbGFibGUsIHJlcS0+Y2FuY2VsX2lkKTsKKyAg
ICByZXEtPmNhbmNlbF9pZCA9IDA7CisKKyAgICByZXEtPnJlcV9zdGF0ZSA9IChzdC0+c3RhdGUg
PT0gQ0RfU0NTSV9UR1RfU1RBVEVfUlVOTklORykgPyBTQ1NJX1JFUV9DQU5DRUxFRCA6IFNDU0lf
UkVRX0RJU1BPU0VEOworICAgIHJlcS0+aW5fbGVuID0gMDsKKyAgICByZXEtPnN0YXR1cyA9IEdP
T0Q7CisKKyAgICBjZF9zY3NpX2Rldl9yZXF1ZXN0X2NvbXBsZXRlKHN0LT51c2VyX2RhdGEsIHJl
cSk7Cit9CisKK3N0YXRpYyBpbnQgY2Rfc2NzaV9yZWFkX2FzeW5jX3N0YXJ0KENkU2NzaUxVICpk
ZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICBDZFNjc2lUYXJnZXQgKnN0ID0gZGV2LT50
Z3Q7CisgICAgR0ZpbGVJbnB1dFN0cmVhbSAqc3RyZWFtID0gZGV2LT5zdHJlYW07CisKKyAgICBT
UElDRV9ERUJVRygicmVhZF9hc3luY19zdGFydCwgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQKKyAg
ICAgICAgICAgICAgICAiIGxiYTogJSIgR19HVUlOVDY0X0ZPUk1BVCAiIG9mZnNldDogJSIgR19H
VUlOVDY0X0ZPUk1BVAorICAgICAgICAgICAgICAgICIgY250OiAlIiBHX0dVSU5UNjRfRk9STUFU
ICIgbGVuOiAlIiBHX0dVSU5UNjRfRk9STUFULAorICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBy
ZXEtPmxiYSwgcmVxLT5vZmZzZXQsIHJlcS0+Y291bnQsIHJlcS0+cmVxX2xlbik7CisKKyAgICBy
ZXEtPmNhbmNlbF9pZCA9IGdfY2FuY2VsbGFibGVfY29ubmVjdChzdC0+Y2FuY2VsbGFibGUsCisg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgR19DQUxMQkFDSyhjZF9z
Y3NpX3JlYWRfYXN5bmNfY2FuY2VsZWQpLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHJlcSwgLyogZGF0YSAqLworICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIE5VTEwpOyAvKiBkYXRhIGRlc3Ryb3kgY2IgKi8KKyAgICBpZiAocmVx
LT5jYW5jZWxfaWQgPT0gMCkgeworICAgICAgICAvKiBhbHJlYWR5IGNhbmNlbGVkICovCisgICAg
ICAgIHJldHVybiAtMTsKKyAgICB9CisKKyAgICBnX3NlZWthYmxlX3NlZWsoR19TRUVLQUJMRShz
dHJlYW0pLAorICAgICAgICAgICAgICAgICAgICByZXEtPm9mZnNldCwKKyAgICAgICAgICAgICAg
ICAgICAgR19TRUVLX1NFVCwKKyAgICAgICAgICAgICAgICAgICAgTlVMTCwgLyogY2FuY2VsbGFi
bGUgKi8KKyAgICAgICAgICAgICAgICAgICAgTlVMTCk7IC8qIGVycm9yICovCisKKyAgICBnX2lu
cHV0X3N0cmVhbV9yZWFkX2FzeW5jKEdfSU5QVVRfU1RSRUFNKHN0cmVhbSksCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICByZXEtPmJ1ZiwgLyogYnVmZmVyIHRvIGZpbGwgKi8KKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHJlcS0+cmVxX2xlbiwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIEdfUFJJT1JJVFlfREVGQVVMVCwKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHN0LT5jYW5jZWxsYWJsZSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNk
X3Njc2lfcmVhZF9hc3luY19jb21wbGV0ZSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IChncG9pbnRlcilyZXEpOyAvKiBjYWxsYmFjayBhcmd1bWVudCAqLworICAgIHJldHVybiAwOwor
fQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9yZWFkKENkU2NzaUxVICpkZXYsIENkU2NzaVJl
cXVlc3QgKnJlcSkKK3sKKyAgICBpZiAoZGV2LT5wb3dlcl9jb25kID09IENEX1NDU0lfUE9XRVJf
U1RPUFBFRCkgeworICAgICAgICBTUElDRV9ERUJVRygicmVhZCwgbHVuOiAlIiBHX0dVSU5UMzJf
Rk9STUFUICIgaXMgc3RvcHBlZCIsIHJlcS0+bHVuKTsKKyAgICAgICAgY2Rfc2NzaV9jbWRfY29t
cGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfSU5JVF9DTURfUkVRVUlSRUQp
OworICAgICAgICByZXR1cm47CisgICAgfSBlbHNlIGlmICghZGV2LT5sb2FkZWQgfHwgZGV2LT5z
dHJlYW0gPT0gTlVMTCkgeworICAgICAgICBTUElDRV9ERUJVRygicmVhZCwgbHVuOiAlIiBHX0dV
SU5UMzJfRk9STUFUICIgaXMgbm90IGxvYWRlZCIsIHJlcS0+bHVuKTsKKyAgICAgICAgY2Rfc2Nz
aV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfTk9UX1JFQURZ
X05PX01FRElVTSk7CisgICAgICAgIHJldHVybjsKKyAgICB9CisKKyAgICByZXEtPmNkYl9sZW4g
PSBzY3NpX2NkYl9sZW5ndGgocmVxLT5jZGIpOworCisgICAgcmVxLT5sYmEgPSBzY3NpX2NkYl9s
YmEocmVxLT5jZGIsIHJlcS0+Y2RiX2xlbik7CisgICAgcmVxLT5vZmZzZXQgPSByZXEtPmxiYSAq
IGRldi0+YmxvY2tfc2l6ZTsKKworICAgIHJlcS0+Y291bnQgPSBzY3NpX2NkYl94ZmVyX2xlbmd0
aChyZXEtPmNkYiwgcmVxLT5jZGJfbGVuKTsgLyogeGZlciBpbiBibG9ja3MgKi8KKyAgICByZXEt
PnJlcV9sZW4gPSByZXEtPmNvdW50ICogZGV2LT5ibG9ja19zaXplOworCisgICAgY2Rfc2NzaV9y
ZWFkX2FzeW5jX3N0YXJ0KGRldiwgcmVxKTsKK30KKwordm9pZCBjZF9zY3NpX2Rldl9yZXF1ZXN0
X3N1Ym1pdCh2b2lkICpzY3NpX3RhcmdldCwgQ2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAgIENk
U2NzaVRhcmdldCAqc3QgPSAoQ2RTY3NpVGFyZ2V0ICopc2NzaV90YXJnZXQ7CisgICAgdWludDMy
X3QgbHVuID0gcmVxLT5sdW47CisgICAgdWludDMyX3Qgb3Bjb2RlID0gKHVpbnQzMl90KXJlcS0+
Y2RiWzBdOworICAgIGNvbnN0IGNoYXIgKmNtZF9uYW1lID0gc2NzaV9jbWRfbmFtZVtvcGNvZGVd
OworICAgIENkU2NzaUxVICpkZXYgPSAmc3QtPnVuaXRzW2x1bl07CisKKyAgICBTUElDRV9ERUJV
RygicmVxdWVzdF9zdWJtaXQsIGx1bjogJSIgR19HVUlOVDMyX0ZPUk1BVCAiIG9wOiAweCUwMngg
JXMiLCBsdW4sIG9wY29kZSwgY21kX25hbWUpOworCisgICAgaWYgKHN0LT5jdXJfcmVxICE9IE5V
TEwpIHsKKyAgICAgICAgU1BJQ0VfRVJST1IoInJlcXVlc3Rfc3VibWl0LCByZXF1ZXN0IG5vdCBp
ZGxlIik7CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEs
ICZzZW5zZV9jb2RlX1RBUkdFVF9GQUlMVVJFKTsKKyAgICAgICAgZ290byBkb25lOworICAgIH0K
KyAgICBpZiAocmVxLT5yZXFfc3RhdGUgIT0gU0NTSV9SRVFfSURMRSkgeworICAgICAgICBTUElD
RV9FUlJPUigicmVxdWVzdF9zdWJtaXQsIHByZXYgcmVxdWVzdCBvdXRzdGFuZGluZyIpOworICAg
ICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29k
ZV9UQVJHRVRfRkFJTFVSRSk7CisgICAgICAgIGdvdG8gZG9uZTsKKyAgICB9CisgICAgcmVxLT5y
ZXFfc3RhdGUgPSBTQ1NJX1JFUV9SVU5OSU5HOworICAgIHN0LT5jdXJfcmVxID0gcmVxOworCisg
ICAgLyogSU5RVUlSWSBzaG91bGQgc2VuZCByZXNwb25zZSBldmVuIGZvciBub24tZXhpc3Rpbmcg
TFVOcyAqLworICAgIGlmICghY2Rfc2NzaV90YXJnZXRfbHVuX2xlZ2FsKHN0LCBsdW4pKSB7Cisg
ICAgICAgIFNQSUNFX0VSUk9SKCJyZXF1ZXN0X3N1Ym1pdCwgaWxsZWdhbCBsdW46JSIgR19HVUlO
VDMyX0ZPUk1BVCwgbHVuKTsKKyAgICAgICAgaWYgKG9wY29kZSA9PSBJTlFVSVJZKSB7CisgICAg
ICAgICAgICBpZiAocmVxLT5jZGJbMV0gJiAweDEpIHsKKyAgICAgICAgICAgICAgICBjZF9zY3Np
X2NtZF9pbnF1aXJ5X3ZwZF9ub19sdW4oZGV2LCByZXEsIFBFUklGX1FVQUxJRklFUl9VTlNVUFBP
UlRFRCk7CisgICAgICAgICAgICB9IGVsc2UgeworICAgICAgICAgICAgICAgIGNkX3Njc2lfY21k
X2lucXVpcnlfc3RhbmRhcmRfbm9fbHVuKGRldiwgcmVxLCBQRVJJRl9RVUFMSUZJRVJfVU5TVVBQ
T1JURUQpOworICAgICAgICAgICAgfQorICAgICAgICB9IGVsc2UgeworICAgICAgICAgICAgY2Rf
c2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfTFVOX05P
VF9TVVBQT1JURUQpOworICAgICAgICB9CisgICAgICAgIGdvdG8gZG9uZTsKKyAgICB9CisgICAg
aWYgKCFjZF9zY3NpX3RhcmdldF9sdW5fcmVhbGl6ZWQoc3QsIGx1bikpIHsKKyAgICAgICAgU1BJ
Q0VfRVJST1IoInJlcXVlc3Rfc3VibWl0LCBhYnNlbnQgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQs
IGx1bik7CisgICAgICAgIGlmIChvcGNvZGUgPT0gSU5RVUlSWSkgeworICAgICAgICAgICAgaWYg
KHJlcS0+Y2RiWzFdICYgMHgxKSB7CisgICAgICAgICAgICAgICAgY2Rfc2NzaV9jbWRfaW5xdWly
eV92cGRfbm9fbHVuKGRldiwgcmVxLCBQRVJJRl9RVUFMSUZJRVJfTk9UX0NPTk5FQ1RFRCk7Cisg
ICAgICAgICAgICB9IGVsc2UgeworICAgICAgICAgICAgICAgIGNkX3Njc2lfY21kX2lucXVpcnlf
c3RhbmRhcmRfbm9fbHVuKGRldiwgcmVxLCBQRVJJRl9RVUFMSUZJRVJfTk9UX0NPTk5FQ1RFRCk7
CisgICAgICAgICAgICB9CisgICAgICAgIH0gZWxzZSB7CisgICAgICAgICAgICBjZF9zY3NpX2Nt
ZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9MVU5fTk9UX1NVUFBP
UlRFRCk7CisgICAgICAgIH0KKyAgICAgICAgZ290byBkb25lOworICAgIH0KKworICAgIGlmIChk
ZXYtPnNob3J0X3NlbnNlLmtleSAhPSBOT19TRU5TRSkgeworICAgICAgICBnYm9vbGVhbiBwZW5k
aW5nX3NlbnNlID0gVFJVRTsKKyAgICAgICAgaWYgKGRldi0+c2hvcnRfc2Vuc2Uua2V5ID09IFVO
SVRfQVRURU5USU9OKSB7CisgICAgICAgICAgICBpZiAoY2Rfc2NzaV9vcGNvZGVfdWFfc3VwcmVz
cyhvcGNvZGUpKSB7CisgICAgICAgICAgICAgICAgcGVuZGluZ19zZW5zZSA9IEZBTFNFOyAvKiBV
QSBzdXByZXNzZWQgKi8KKyAgICAgICAgICAgIH0KKyAgICAgICAgfSBlbHNlIGlmIChvcGNvZGUg
PT0gUkVRVUVTVF9TRU5TRSkgeworICAgICAgICAgICAgcGVuZGluZ19zZW5zZSA9IEZBTFNFOyAv
KiBzZW5zZSByZXR1cm5lZCBhcyBkYXRhICovCisgICAgICAgIH0KKyAgICAgICAgaWYgKHBlbmRp
bmdfc2Vuc2UpIHsKKyAgICAgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQo
ZGV2LCByZXEsIE5VTEwpOyAvKiBzZW5zZSBhbHJlYWR5IHNldCAqLworICAgICAgICAgICAgZ290
byBkb25lOworICAgICAgICB9CisgICAgfQorCisgICAgLyogc2F2ZSB0aGUgdGFyZ2V0IHRvIGJl
IHVzZWQgaW4gY2FsbGJhY2tzIHdoZXJlIG9ubHkgcmVxIGlzIHBhc3NlZCAqLworICAgIHJlcS0+
cHJpdl9kYXRhID0gKHZvaWQgKilzdDsKKworICAgIHJlcS0+cmVxX2xlbiA9IDA7CisKKyAgICBz
d2l0Y2ggKG9wY29kZSkgeworICAgIGNhc2UgUkVQT1JUX0xVTlM6CisgICAgICAgIGNkX3Njc2lf
Y21kX3JlcG9ydF9sdW5zKHN0LCBkZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2Ug
VEVTVF9VTklUX1JFQURZOgorICAgICAgICBjZF9zY3NpX2NtZF90ZXN0X3VuaXRfcmVhZHkoZGV2
LCByZXEpOworICAgICAgICBicmVhazsKKyAgICBjYXNlIElOUVVJUlk6CisgICAgICAgIGNkX3Nj
c2lfY21kX2lucXVpcnkoZGV2LCByZXEpOworICAgICAgICBicmVhazsKKyAgICBjYXNlIFJFUVVF
U1RfU0VOU0U6CisgICAgICAgIGNkX3Njc2lfY21kX3JlcXVlc3Rfc2Vuc2UoZGV2LCByZXEpOwor
ICAgICAgICBicmVhazsKKyAgICBjYXNlIFJFQURfNjoKKyAgICBjYXNlIFJFQURfMTA6CisgICAg
Y2FzZSBSRUFEXzEyOgorICAgIGNhc2UgUkVBRF8xNjoKKyAgICAgICAgY2Rfc2NzaV9jbWRfcmVh
ZChkZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgUkVBRF9DQVBBQ0lUWV8xMDoK
KyAgICAgICAgY2Rfc2NzaV9jbWRfcmVhZF9jYXBhY2l0eShkZXYsIHJlcSk7CisgICAgICAgIGJy
ZWFrOworICAgIGNhc2UgUkVBRF9UT0M6CisgICAgICAgIGNkX3Njc2lfY21kX3JlYWRfdG9jKGRl
diwgcmVxKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBHRVRfRVZFTlRfU1RBVFVTX05PVElG
SUNBVElPTjoKKyAgICAgICAgY2Rfc2NzaV9jbWRfZ2V0X2V2ZW50X3N0YXR1c19ub3RpZmljYXRp
b24oZGV2LCByZXEpOworICAgICAgICBicmVhazsKKyAgICBjYXNlIFJFQURfRElTQ19JTkZPUk1B
VElPTjoKKyAgICAgICAgY2Rfc2NzaV9jbWRfZ2V0X3JlYWRfZGlzY19pbmZvcm1hdGlvbihkZXYs
IHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgUkVBRF9UUkFDS19JTkZPUk1BVElPTjoK
KyAgICAgICAgY2Rfc2NzaV9jbWRfZ2V0X3JlYWRfdHJhY2tfaW5mb3JtYXRpb24oZGV2LCByZXEp
OworICAgICAgICBicmVhazsKKyAgICBjYXNlIE1PREVfU0VOU0VfMTA6CisgICAgICAgIGNkX3Nj
c2lfY21kX21vZGVfc2Vuc2VfMTAoZGV2LCByZXEpOworICAgICAgICBicmVhazsKKyAgICBjYXNl
IE1PREVfU0VMRUNUOgorICAgICAgICBjZF9zY3NpX2NtZF9tb2RlX3NlbGVjdF82KGRldiwgcmVx
KTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBNT0RFX1NFTEVDVF8xMDoKKyAgICAgICAgY2Rf
c2NzaV9jbWRfbW9kZV9zZWxlY3RfMTAoZGV2LCByZXEpOworICAgICAgICBicmVhazsKKyAgICBj
YXNlIEdFVF9DT05GSUdVUkFUSU9OOgorICAgICAgICBjZF9zY3NpX2NtZF9nZXRfY29uZmlndXJh
dGlvbihkZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgQUxMT1dfTUVESVVNX1JF
TU9WQUw6CisgICAgICAgIGNkX3Njc2lfY21kX2FsbG93X21lZGl1bV9yZW1vdmFsKGRldiwgcmVx
KTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBNTUNfU0VORF9FVkVOVDoKKyAgICAgICAgY2Rf
c2NzaV9jbWRfc2VuZF9ldmVudChkZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2Ug
TU1DX1JFUE9SVF9LRVk6CisgICAgICAgIGNkX3Njc2lfY21kX3JlcG9ydF9rZXkoZGV2LCByZXEp
OworICAgICAgICBicmVhazsKKyAgICBjYXNlIE1NQ19TRU5EX0tFWToKKyAgICAgICAgY2Rfc2Nz
aV9jbWRfc2VuZF9rZXkoZGV2LCByZXEpOworICAgICAgICBicmVhazsKKyAgICBjYXNlIFNUQVJU
X1NUT1A6CisgICAgICAgIGNkX3Njc2lfY21kX3N0YXJ0X3N0b3BfdW5pdChkZXYsIHJlcSk7Cisg
ICAgICAgIGJyZWFrOworICAgIGNhc2UgTU1DX0dFVF9QRVJGT1JNQU5DRToKKyAgICAgICAgY2Rf
c2NzaV9jbWRfZ2V0X3BlcmZvcm1hbmNlKGRldiwgcmVxKTsKKyAgICAgICAgYnJlYWs7CisgICAg
Y2FzZSBNTUNfTUVDSEFOSVNNX1NUQVRVUzoKKyAgICAgICAgY2Rfc2NzaV9jbWRfbWVjaGFuaXNt
X3N0YXR1cyhkZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGRlZmF1bHQ6CisgICAgICAg
IGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX0lO
VkFMSURfT1BDT0RFKTsKKyAgICAgICAgYnJlYWs7CisgICAgfQorCisgICAgaWYgKHJlcS0+cmVx
X2xlbiA+IElOVDMyX01BWCkgeworICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19j
b25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZBTElEX0NEQl9GSUVMRCk7CisgICAgICAgIGdv
dG8gZG9uZTsKKyAgICB9CisKK2RvbmU6CisgICAgU1BJQ0VfREVCVUcoInJlcXVlc3Rfc3VibWl0
IGRvbmUsIGx1bjogJSIgR19HVUlOVDMyX0ZPUk1BVAorICAgICAgICAgICAgICAgICIgb3A6IDB4
JTAyeCAlcywgc3RhdGU6ICVzIHN0YXR1czogJSIgR19HVUlOVDMyX0ZPUk1BVCAiIGxlbjogJSIg
R19HVUlOVDY0X0ZPUk1BVCwKKyAgICAgICAgICAgICAgICBsdW4sIG9wY29kZSwgY21kX25hbWUs
IENkU2NzaVJlcVN0YXRlX3N0cihyZXEtPnJlcV9zdGF0ZSksIHJlcS0+c3RhdHVzLCByZXEtPmlu
X2xlbik7CisKKyAgICBpZiAocmVxLT5yZXFfc3RhdGUgPT0gU0NTSV9SRVFfQ09NUExFVEUpIHsK
KyAgICAgICAgY2Rfc2NzaV9kZXZfcmVxdWVzdF9jb21wbGV0ZShzdC0+dXNlcl9kYXRhLCByZXEp
OworICAgIH0KK30KKwordm9pZCBjZF9zY3NpX2Rldl9yZXF1ZXN0X2NhbmNlbCh2b2lkICpzY3Np
X3RhcmdldCwgQ2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAgIENkU2NzaVRhcmdldCAqc3QgPSAo
Q2RTY3NpVGFyZ2V0ICopc2NzaV90YXJnZXQ7CisKKyAgICBpZiAoc3QtPmN1cl9yZXEgPT0gcmVx
KSB7CisgICAgICAgIGlmIChyZXEtPnJlcV9zdGF0ZSA9PSBTQ1NJX1JFUV9SVU5OSU5HKSB7Cisg
ICAgICAgICAgICBTUElDRV9ERUJVRygicmVxdWVzdF9jYW5jZWw6IGx1bjogJSIgR19HVUlOVDMy
X0ZPUk1BVAorICAgICAgICAgICAgICAgICAgICAgICAgICIgb3A6IDB4JTAyeCBsZW46ICUiIEdf
R1VJTlQ2NF9GT1JNQVQsCisgICAgICAgICAgICAgICAgICAgICAgICByZXEtPmx1biwgKHVuc2ln
bmVkIGludClyZXEtPmNkYlswXSwgcmVxLT5yZXFfbGVuKTsKKyAgICAgICAgICAgIGdfY2FuY2Vs
bGFibGVfY2FuY2VsKHN0LT5jYW5jZWxsYWJsZSk7CisgICAgICAgIH0gZWxzZSB7CisgICAgICAg
ICAgICBTUElDRV9ERUJVRygicmVxdWVzdF9jYW5jZWw6IHJlcXVlc3QgaXMgbm90IHJ1bm5pbmci
KTsKKyAgICAgICAgfQorICAgIH0gZWxzZSB7CisgICAgICAgIFNQSUNFX0RFQlVHKCJyZXF1ZXN0
X2NhbmNlbDogb3RoZXIgcmVxdWVzdCBpcyBvdXRzdGFuZGluZyIpOworICAgIH0KK30KKwordm9p
ZCBjZF9zY3NpX2Rldl9yZXF1ZXN0X3JlbGVhc2Uodm9pZCAqc2NzaV90YXJnZXQsIENkU2NzaVJl
cXVlc3QgKnJlcSkKK3sKKyAgICBDZFNjc2lUYXJnZXQgKnN0ID0gKENkU2NzaVRhcmdldCAqKXNj
c2lfdGFyZ2V0OworCisgICAgc3QtPmN1cl9yZXEgPSBOVUxMOworICAgIGNkX3Njc2lfcmVxX2lu
aXQocmVxKTsKKworICAgIGlmIChzdC0+c3RhdGUgPT0gQ0RfU0NTSV9UR1RfU1RBVEVfUkVTRVQp
IHsKKyAgICAgICAgY2Rfc2NzaV90YXJnZXRfZG9fcmVzZXQoc3QpOworICAgIH0KK30KKworI2Vu
ZGlmIC8qIFVTRV9VU0JSRURJUiAqLwpkaWZmIC0tZ2l0IGEvc3JjL2NkLXNjc2kuaCBiL3NyYy9j
ZC1zY3NpLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMC4uYjFkMGNlMgotLS0g
L2Rldi9udWxsCisrKyBiL3NyYy9jZC1zY3NpLmgKQEAgLTAsMCArMSwxMjIgQEAKKy8qIC0qLSBN
b2RlOiBDOyBjLWJhc2ljLW9mZnNldDogNDsgaW5kZW50LXRhYnMtbW9kZTogbmlsIC0qLSAqLwor
LyoKKyAgIENEIGRldmljZSBlbXVsYXRpb24gLSBTQ1NJIGVuZ2luZQorCisgICBDb3B5cmlnaHQg
KEMpIDIwMTggUmVkIEhhdCwgSW5jLgorCisgICBSZWQgSGF0IEF1dGhvcnM6CisgICBBbGV4YW5k
ZXIgTmV6aGluc2t5PGFuZXpoaW5zQHJlZGhhdC5jb20+CisKKyAgIFRoaXMgbGlicmFyeSBpcyBm
cmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IKKyAgIG1vZGlmeSBp
dCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKKyAgIExp
Y2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhl
cgorICAgdmVyc2lvbiAyLjEgb2YgdGhlIExpY2Vuc2UsIG9yIChhdCB5b3VyIG9wdGlvbikgYW55
IGxhdGVyIHZlcnNpb24uCisKKyAgIFRoaXMgbGlicmFyeSBpcyBkaXN0cmlidXRlZCBpbiB0aGUg
aG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAorICAgYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZ
OyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKKyAgIE1FUkNIQU5UQUJJTElU
WSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUgR05VCisgICBM
ZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgorCisgICBZb3Ug
c2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVi
bGljCisgICBMaWNlbnNlIGFsb25nIHdpdGggdGhpcyBsaWJyYXJ5OyBpZiBub3QsIHNlZSA8aHR0
cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCisqLworCisjaWZuZGVmIF9fQ0RfU0NTSV9IX18K
KyNkZWZpbmUgX19DRF9TQ1NJX0hfXworCisjaW5jbHVkZSAiY2Qtc2NzaS1kZXYtcGFyYW1zLmgi
CisjaW5jbHVkZSAiY2QtdXNiLWJ1bGstbXNkLmgiCisjaW5jbHVkZSAic2NzaS1jb25zdGFudHMu
aCIKKworI2RlZmluZSBGSVhFRF9TRU5TRV9DVVJSRU5UIDB4NzAKKyNkZWZpbmUgRklYRURfU0VO
U0VfTEVOIDE4CisKKyNpZiBkZWZpbmVkKEdfT1NfV0lOMzIpCisjaW5jbHVkZSA8d2luc29jazIu
aD4KKyNpbmNsdWRlIDx3aW5kb3dzLmg+CisvKiBXaW5kb3dzIGlzIGFsd2F5cyBMRSBhdCB0aGUg
bW9tZW50ICovCisjZGVmaW5lIGxlMzJ0b2goeCkgICAgICAgICAgKHgpCisjZGVmaW5lIGh0b2xl
MzIoeCkgICAgICAgICAgKHgpCisjZGVmaW5lIGh0b2JlMzIoeCkgICAgICAgICAgaHRvbmwoeCkK
KyNlbmRpZgorCit0eXBlZGVmIGVudW0gX1Njc2lYZmVyRGlyCit7CisgICAgU0NTSV9YRkVSX05P
TkUgPSAwLCAgLyogVEVTVF9VTklUX1JFQURZLCAuLi4gICAgICAgICAgICovCisgICAgU0NTSV9Y
RkVSX0ZST01fREVWLCAgLyogUkVBRCwgSU5RVUlSWSwgTU9ERV9TRU5TRSwgLi4uICovCisgICAg
U0NTSV9YRkVSX1RPX0RFViwgICAgLyogV1JJVEUsIE1PREVfU0VMRUNULCAuLi4gICAgICAgICov
Cit9IFNjc2lYZmVyRGlyOworCisjZGVmaW5lIFNDU0lfQ0RCX0JVRl9TSVpFICAgMTYKKyNkZWZp
bmUgU0NTSV9TRU5TRV9CVUZfU0laRSA2NAorCit0eXBlZGVmIGVudW0gX0NkU2NzaVJlcVN0YXRl
Cit7CisgICAgU0NTSV9SRVFfSURMRSA9IDAsCisgICAgU0NTSV9SRVFfUlVOTklORywKKyAgICBT
Q1NJX1JFUV9DT01QTEVURSwKKyAgICBTQ1NJX1JFUV9DQU5DRUxFRCwKKyAgICBTQ1NJX1JFUV9E
SVNQT1NFRCwKK30gQ2RTY3NpUmVxU3RhdGU7CisKK3R5cGVkZWYgc3RydWN0IF9DZFNjc2lSZXF1
ZXN0Cit7CisgICAgLyogcmVxdWVzdCAqLworICAgIHVpbnQ4X3QgY2RiW1NDU0lfQ0RCX0JVRl9T
SVpFXTsKKyAgICB1aW50MzJfdCBjZGJfbGVuOworCisgICAgdWludDMyX3QgdGFnOworICAgIHVp
bnQzMl90IGx1bjsKKworICAgIHVpbnQ4X3QgKmJ1ZjsKKyAgICB1aW50MzJfdCBidWZfbGVuOwor
CisgICAgLyogaW50ZXJuYWwgKi8KKyAgICBDZFNjc2lSZXFTdGF0ZSByZXFfc3RhdGU7CisgICAg
U2NzaVhmZXJEaXIgeGZlcl9kaXI7CisgICAgdWludDY0X3QgY2FuY2VsX2lkOworICAgIHZvaWQg
KnByaXZfZGF0YTsKKworICAgIHVpbnQ2NF90IGxiYTsgLyogb2Zmc2V0IGluIGxvZ2ljYWwgYmxv
Y2tzIGlmIHJlbGV2YW50ICovCisgICAgdWludDY0X3QgY291bnQ7IC8qIGNvdW50IGluIGxvZ2lj
YWwgYmxvY2tzICovCisKKyAgICB1aW50NjRfdCBvZmZzZXQ7IC8qIHNjc2kgY2RiIG9mZnNldCwg
bm9ybWFsaXplZCB0byBieXRlcyAqLworICAgIHVpbnQ2NF90IHJlcV9sZW47IC8qIHNjc2kgY2Ri
IHJlcXVlc3QgbGVuZ3RoLCBub3JtYWxpemVkIHRvIGJ5dGVzICovCisKKyAgICAvKiByZXN1bHQg
Ki8KKyAgICB1aW50NjRfdCBpbl9sZW47IC8qIGxlbmd0aCBvZiBkYXRhIGFjdHVhbGx5IGF2YWls
YWJsZSBhZnRlciByZWFkICovCisgICAgdWludDMyX3Qgc3RhdHVzOyAvKiBTQ1NJIHN0YXR1cyBj
b2RlICovCisKK30gQ2RTY3NpUmVxdWVzdDsKKworQ2RTY3NpUmVxU3RhdGUgY2Rfc2NzaV9nZXRf
cmVxX3N0YXRlKENkU2NzaVJlcXVlc3QgKnJlcSk7CisKKy8qIFNDU0kgdGFyZ2V0L2RldmljZSBB
UEkgKi8KKwordm9pZCAqY2Rfc2NzaV90YXJnZXRfYWxsb2Modm9pZCAqdGFyZ2V0X3VzZXJfZGF0
YSwgdWludDMyX3QgbWF4X2x1bnMpOyAvKiB0byBiZSB1c2VkIGluIGNhbGxiYWNrcyAqLwordm9p
ZCBjZF9zY3NpX3RhcmdldF9mcmVlKHZvaWQgKnNjc2lfdGFyZ2V0KTsKKworaW50IGNkX3Njc2lf
ZGV2X3JlYWxpemUodm9pZCAqc2NzaV90YXJnZXQsIHVpbnQzMl90IGx1biwgY29uc3QgQ2RTY3Np
RGV2aWNlUGFyYW1ldGVycyAqZGV2X3BhcmFtcyk7CitpbnQgY2Rfc2NzaV9kZXZfdW5yZWFsaXpl
KHZvaWQgKnNjc2lfdGFyZ2V0LCB1aW50MzJfdCBsdW4pOworCitpbnQgY2Rfc2NzaV9kZXZfbG9j
ayh2b2lkICpzY3NpX3RhcmdldCwgdWludDMyX3QgbHVuLCBnYm9vbGVhbiBsb2NrKTsKK2ludCBj
ZF9zY3NpX2Rldl9sb2FkKHZvaWQgKnNjc2lfdGFyZ2V0LCB1aW50MzJfdCBsdW4sIGNvbnN0IENk
U2NzaU1lZGlhUGFyYW1ldGVycyAqbWVkaWFfcGFyYW1zKTsKK2ludCBjZF9zY3NpX2Rldl9nZXRf
aW5mbyh2b2lkICpzY3NpX3RhcmdldCwgdWludDMyX3QgbHVuLCBDZFNjc2lEZXZpY2VJbmZvICps
dW5faW5mbyk7CitpbnQgY2Rfc2NzaV9kZXZfdW5sb2FkKHZvaWQgKnNjc2lfdGFyZ2V0LCB1aW50
MzJfdCBsdW4pOworCit2b2lkIGNkX3Njc2lfZGV2X3JlcXVlc3Rfc3VibWl0KHZvaWQgKnNjc2lf
dGFyZ2V0LCBDZFNjc2lSZXF1ZXN0ICpyZXF1ZXN0KTsKK3ZvaWQgY2Rfc2NzaV9kZXZfcmVxdWVz
dF9jYW5jZWwodm9pZCAqc2NzaV90YXJnZXQsIENkU2NzaVJlcXVlc3QgKnJlcXVlc3QpOwordm9p
ZCBjZF9zY3NpX2Rldl9yZXF1ZXN0X3JlbGVhc2Uodm9pZCAqc2NzaV90YXJnZXQsIENkU2NzaVJl
cXVlc3QgKnJlcXVlc3QpOworCitpbnQgY2Rfc2NzaV9kZXZfcmVzZXQodm9pZCAqc2NzaV90YXJn
ZXQsIHVpbnQzMl90IGx1bik7CisKK2ludCBjZF9zY3NpX3RhcmdldF9yZXNldCh2b2lkICpzY3Np
X3RhcmdldCk7CisKKy8qIENhbGxiYWNrcyAqLworCit2b2lkIGNkX3Njc2lfZGV2X3JlcXVlc3Rf
Y29tcGxldGUodm9pZCAqdGFyZ2V0X3VzZXJfZGF0YSwgQ2RTY3NpUmVxdWVzdCAqcmVxdWVzdCk7
Cit2b2lkIGNkX3Njc2lfZGV2X2NoYW5nZWQodm9pZCAqdGFyZ2V0X3VzZXJfZGF0YSwgdWludDMy
X3QgbHVuKTsKK3ZvaWQgY2Rfc2NzaV9kZXZfcmVzZXRfY29tcGxldGUodm9pZCAqdGFyZ2V0X3Vz
ZXJfZGF0YSwgdWludDMyX3QgbHVuKTsKK3ZvaWQgY2Rfc2NzaV90YXJnZXRfcmVzZXRfY29tcGxl
dGUodm9pZCAqdGFyZ2V0X3VzZXJfZGF0YSk7CisKKyNlbmRpZiAvKiBfX0NEX1NDU0lfSF9fICov
CmRpZmYgLS1naXQgYS9zcmMvY2QtdXNiLWJ1bGstbXNkLmMgYi9zcmMvY2QtdXNiLWJ1bGstbXNk
LmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMC4uYmUwZmVlMwotLS0gL2Rldi9u
dWxsCisrKyBiL3NyYy9jZC11c2ItYnVsay1tc2QuYwpAQCAtMCwwICsxLDU1NSBAQAorLyogLSot
IE1vZGU6IEM7IGMtYmFzaWMtb2Zmc2V0OiA0OyBpbmRlbnQtdGFicy1tb2RlOiBuaWwgLSotICov
CisvKgorICAgIFVTQiBDRCBEZXZpY2UgZW11bGF0aW9uIC0gRGF0YSBCdWxrIHRyYW5zZmVycyAt
IE1hc3MgU3RvcmFnZSBEZXZpY2UKKworICAgIENvcHlyaWdodCAoQykgMjAxOCBSZWQgSGF0LCBJ
bmMuCisKKyAgICBSZWQgSGF0IEF1dGhvcnM6CisgICAgQWxleGFuZGVyIE5lemhpbnNreTxhbmV6
aGluc0ByZWRoYXQuY29tPgorCisgICAgVGhpcyBsaWJyYXJ5IGlzIGZyZWUgc29mdHdhcmU7IHlv
dSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vcgorICAgIG1vZGlmeSBpdCB1bmRlciB0aGUgdGVy
bXMgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKKyAgICBMaWNlbnNlIGFzIHB1Ymxp
c2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIKKyAgICB2ZXJzaW9u
IDIuMSBvZiB0aGUgTGljZW5zZSwgb3IgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lv
bi4KKworICAgIFRoaXMgbGlicmFyeSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0
IHdpbGwgYmUgdXNlZnVsLAorICAgIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBl
dmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCisgICAgTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5F
U1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZSBHTlUKKyAgICBMZXNzZXIgR2Vu
ZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgorCisgICAgWW91IHNob3VsZCBo
YXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYworICAg
IExpY2Vuc2UgYWxvbmcgd2l0aCB0aGlzIGxpYnJhcnk7IGlmIG5vdCwgc2VlIDxodHRwOi8vd3d3
LmdudS5vcmcvbGljZW5zZXMvPi4KKyovCisKKyNpbmNsdWRlICJjb25maWcuaCIKKyNpbmNsdWRl
ICJzcGljZS90eXBlcy5oIgorI2luY2x1ZGUgInNwaWNlLWNvbW1vbi5oIgorI2luY2x1ZGUgInNw
aWNlLXV0aWwuaCIKKyNpbmNsdWRlICJjZC11c2ItYnVsay1tc2QuaCIKKyNpbmNsdWRlICJjZC1z
Y3NpLmgiCisKKyNpZmRlZiBVU0VfVVNCUkVESVIKKworI2RlZmluZSBTUElDRV9FUlJPUihmbXQs
IC4uLikgXAorICAgIGRvIHsgU1BJQ0VfREVCVUcoInVzYi1tc2QgZXJyb3I6ICIgZm10ICwgIyMg
X19WQV9BUkdTX18pOyB9IHdoaWxlICgwKQorCit0eXBlZGVmIGVudW0gX1VzYkNkU3RhdGUgewor
ICAgIFVTQl9DRF9TVEFURV9JTklULCAvKiBOb3QgcmVhZHkgKi8KKyAgICBVU0JfQ0RfU1RBVEVf
Q0JXLCAvKiBXYWl0aW5nIGZvciBDb21tYW5kIEJsb2NrICovCisgICAgVVNCX0NEX1NUQVRFX0RB
VEFPVVQsIC8qIFRyYW5zZmVyIGRhdGEgdG8gZGV2aWNlICovCisgICAgVVNCX0NEX1NUQVRFX0RB
VEFJTiwgLyogVHJhbnNmZXIgZGF0YSBmcm9tIGRldmljZSAqLworICAgIFVTQl9DRF9TVEFURV9a
RVJPX0RBVEFJTiwgLyogTmVlZCB0byBzZW5kIHplcm8gYnVsay1pbiBiZWZvcmUgc3RhdHVzICov
CisgICAgVVNCX0NEX1NUQVRFX0NTVywgLyogU2VuZCBDb21tYW5kIFN0YXR1cyAqLworICAgIFVT
Ql9DRF9TVEFURV9ERVZJQ0VfUkVTRVQsIC8qIHJlc2V0IG9mIGEgc2luZ2xlIGRldmljZSAqLwor
ICAgIFVTQl9DRF9TVEFURV9UQVJHRVRfUkVTRVQgLyogcmVzZXQgb2YgZW50aXJlIHRhcmdldCAq
LworfSBVc2JDZFN0YXRlOworCitzdHJ1Y3QgX19hdHRyaWJ1dGVfXygoX19wYWNrZWRfXykpIFVz
YkNkQ0JXIHsKKyAgICB1aW50MzJfdCBzaWc7CisgICAgdWludDMyX3QgdGFnOworICAgIHVpbnQz
Ml90IGV4cF9kYXRhX2xlbjsgLyogZXhwZWN0ZWQgZGF0YSB4ZmVyIGxlbmd0aCBmb3IgdGhlIHJl
cXVlc3QgKi8KKyAgICB1aW50OF90IGZsYWdzOworICAgIHVpbnQ4X3QgbHVuOworICAgIHVpbnQ4
X3QgY21kX2xlbjsgLyogYWN0dWFsIGxlbmd0aCBvZiB0aGUgc2NzaSBjb21tYW5kIHRoYXQgZm9s
bG93cyAqLworICAgIHVpbnQ4X3QgY21kWzE2XTsgLyogc2NzaSBjb21tYW5kIHRvIHBlcmZvcm0g
Ki8KK307CisKK3N0cnVjdCBfX2F0dHJpYnV0ZV9fKChfX3BhY2tlZF9fKSkgVXNiQ2RDU1cgewor
ICAgIHVpbnQzMl90IHNpZzsKKyAgICB1aW50MzJfdCB0YWc7CisgICAgdWludDMyX3QgcmVzaWR1
ZTsKKyAgICB1aW50OF90IHN0YXR1czsKK307CisKK3R5cGVkZWYgZW51bSBfVXNiTXNkU3RhdHVz
IHsKKyAgICBVU0JfTVNEX1NUQVRVU19HT09EID0gMCwKKyAgICBVU0JfTVNEX1NUQVRVU19GQUlM
RUQgPSAxLAorICAgIFVTQl9NU0RfU1RBVFVTX1BIQVNFX0VSUiA9IDIsCit9IFVzYk1zZFN0YXR1
czsKKwordHlwZWRlZiBzdHJ1Y3QgX1VzYkNkQnVsa01zZFJlcXVlc3QKK3sKKyAgICBDZFNjc2lS
ZXF1ZXN0IHNjc2lfcmVxOworCisgICAgdWludDMyX3QgbHVuOworICAgIHVpbnQzMl90IHVzYl90
YWc7CisgICAgdWludDMyX3QgdXNiX3JlcV9sZW47IC8qIGxlbmd0aCBvZiBkYXRhIHJlcXVlc3Rl
ZCBieSB1c2IgKi8KKyAgICB1aW50MzJfdCBzY3NpX2luX2xlbjsgLyogbGVuZ3RoIG9mIGRhdGEg
cmV0dXJuZWQgYnkgc2NzaSBsaW1pdGVkIGJ5IHVzYiByZXF1ZXN0ICovCisKKyAgICB1aW50MzJf
dCB4ZmVyX2xlbjsgLyogbGVuZ3RoIG9mIGRhdGEgdHJhbnNmZXJlZCB1bnRpbCBub3cgKi8KKyAg
ICB1aW50MzJfdCBidWxrX2luX2xlbjsgLyogbGVuZ3RoIG9mIHRoZSBsYXN0IHBvc3Rwb25lZCBi
dWxrLWluIHJlcXVlc3QgKi8KKworICAgIHN0cnVjdCBVc2JDZENTVyBjc3c7IC8qIHVzYiBzdGF0
dXMgaGVhZGVyICovCit9IFVzYkNkQnVsa01zZFJlcXVlc3Q7CisKK3R5cGVkZWYgc3RydWN0IF9V
c2JDZEJ1bGtNc2REZXZpY2UKK3sKKyAgICBVc2JDZFN0YXRlIHN0YXRlOworICAgIHZvaWQgKnNj
c2lfdGFyZ2V0OyAvKiBzY3NpIGhhbmRsZSAqLworICAgIHZvaWQgKnVzYl91c2VyX2RhdGE7IC8q
IHVzZWQgaW4gY2FsbGJhY2tzIHRvIHVzYiAqLworICAgIFVzYkNkQnVsa01zZFJlcXVlc3QgdXNi
X3JlcTsgLyogbm93IHN1cHBvcnRpbmcgYSBzaW5nbGUgY21kICovCisgICAgdWludDhfdCAqZGF0
YV9idWY7CisgICAgdWludDMyX3QgZGF0YV9idWZfbGVuOworfSBVc2JDZEJ1bGtNc2REZXZpY2U7
CisKK3N0YXRpYyBpbmxpbmUgY29uc3QgY2hhciAqdXNiX2NkX3N0YXRlX3N0cihVc2JDZFN0YXRl
IHN0YXRlKQoreworICAgIHN3aXRjaChzdGF0ZSkKKyAgICB7CisgICAgY2FzZSBVU0JfQ0RfU1RB
VEVfSU5JVDoKKyAgICAgICAgcmV0dXJuICJJTklUIjsKKyAgICBjYXNlIFVTQl9DRF9TVEFURV9D
Qlc6CisgICAgICAgIHJldHVybiAiQ0JXIjsKKyAgICBjYXNlIFVTQl9DRF9TVEFURV9EQVRBT1VU
OgorICAgICAgICByZXR1cm4gIkRBVEFPVVQiOworICAgIGNhc2UgVVNCX0NEX1NUQVRFX0RBVEFJ
TjoKKyAgICAgICAgcmV0dXJuICJEQVRBSU4iOworICAgIGNhc2UgVVNCX0NEX1NUQVRFX1pFUk9f
REFUQUlOOgorICAgICAgICByZXR1cm4gIlpFUk9fREFUQUlOIjsKKyAgICBjYXNlIFVTQl9DRF9T
VEFURV9DU1c6CisgICAgICAgIHJldHVybiAiQ1NXIjsKKyAgICBjYXNlIFVTQl9DRF9TVEFURV9E
RVZJQ0VfUkVTRVQ6CisgICAgICAgIHJldHVybiAiREVWX1JFU0VUIjsKKyAgICBjYXNlIFVTQl9D
RF9TVEFURV9UQVJHRVRfUkVTRVQ6CisgICAgICAgIHJldHVybiAiVEdUX1JFU0VUIjsKKyAgICBk
ZWZhdWx0OgorICAgICAgICByZXR1cm4gIklMTEVHQUwiOworICAgIH0KK30KKworc3RhdGljIHZv
aWQgY2RfdXNiX2J1bGtfbXNkX3NldF9zdGF0ZShVc2JDZEJ1bGtNc2REZXZpY2UgKmNkLCBVc2JD
ZFN0YXRlIHN0YXRlKQoreworICAgIFNQSUNFX0RFQlVHKCJTdGF0ZSAlcyAtPiAlcyIsIHVzYl9j
ZF9zdGF0ZV9zdHIoY2QtPnN0YXRlKSwgdXNiX2NkX3N0YXRlX3N0cihzdGF0ZSkpOworICAgIGNk
LT5zdGF0ZSA9IHN0YXRlOworfQorCit2b2lkICpjZF91c2JfYnVsa19tc2RfYWxsb2Modm9pZCAq
dXNiX3VzZXJfZGF0YSwgdWludDMyX3QgbWF4X2x1bnMpCit7CisgICAgVXNiQ2RCdWxrTXNkRGV2
aWNlICpjZDsKKworICAgIGNkID0gZ19tYWxsb2MwKHNpemVvZigqY2QpKTsKKworICAgIGNkLT5k
YXRhX2J1Zl9sZW4gPSAyNTYgKiAxMDI0OworICAgIGNkLT5kYXRhX2J1ZiA9IGdfbWFsbG9jKGNk
LT5kYXRhX2J1Zl9sZW4pOworCisgICAgY2QtPnNjc2lfdGFyZ2V0ID0gY2Rfc2NzaV90YXJnZXRf
YWxsb2MoY2QsIG1heF9sdW5zKTsKKyAgICBpZiAoY2QtPnNjc2lfdGFyZ2V0ID09IE5VTEwpIHsK
KyAgICAgICAgZ19mcmVlKGNkKTsKKyAgICAgICAgcmV0dXJuIE5VTEw7CisgICAgfQorICAgIGNk
X3VzYl9idWxrX21zZF9zZXRfc3RhdGUoY2QsIFVTQl9DRF9TVEFURV9JTklUKTsKKyAgICBjZC0+
dXNiX3VzZXJfZGF0YSA9IHVzYl91c2VyX2RhdGE7CisKKyAgICBTUElDRV9ERUJVRygiQWxsb2Ms
IG1heF9sdW5zOiUiIEdfR1VJTlQzMl9GT1JNQVQsIG1heF9sdW5zKTsKKyAgICByZXR1cm4gY2Q7
Cit9CisKK2ludCBjZF91c2JfYnVsa19tc2RfcmVhbGl6ZSh2b2lkICpkZXZpY2UsIHVpbnQzMl90
IGx1biwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBDZFNjc2lEZXZpY2VQYXJh
bWV0ZXJzICpkZXZfcGFyYW1zKQoreworICAgIFVzYkNkQnVsa01zZERldmljZSAqY2QgPSAoVXNi
Q2RCdWxrTXNkRGV2aWNlICopZGV2aWNlOworICAgIENkU2NzaURldmljZVBhcmFtZXRlcnMgc2Nz
aV9kZXZfcGFyYW1zOworICAgIGludCByYzsKKworICAgIHNjc2lfZGV2X3BhcmFtcy52ZW5kb3Ig
PSBkZXZfcGFyYW1zLT52ZW5kb3IgPyA6ICJTUElDRSI7CisgICAgc2NzaV9kZXZfcGFyYW1zLnBy
b2R1Y3QgPSBkZXZfcGFyYW1zLT5wcm9kdWN0ID8gOiAiVVNCLUNEIjsKKyAgICBzY3NpX2Rldl9w
YXJhbXMudmVyc2lvbiA9IGRldl9wYXJhbXMtPnZlcnNpb24gPyA6ICIwLjEiOworICAgIHNjc2lf
ZGV2X3BhcmFtcy5zZXJpYWwgPSBkZXZfcGFyYW1zLT5zZXJpYWwgPyA6ICIxMjM0NTYiOworCisg
ICAgcmMgPSBjZF9zY3NpX2Rldl9yZWFsaXplKGNkLT5zY3NpX3RhcmdldCwgbHVuLCAmc2NzaV9k
ZXZfcGFyYW1zKTsKKyAgICBpZiAocmMgIT0gMCkgeworICAgICAgICBTUElDRV9FUlJPUigiRmFp
bGVkIHRvIHJlYWxpemUgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQsIGx1bik7CisgICAgICAgIHJl
dHVybiByYzsKKyAgICB9CisKKyAgICBpZiAoY2QtPnN0YXRlID09IFVTQl9DRF9TVEFURV9JTklU
KSB7CisgICAgICAgIGNkX3VzYl9idWxrX21zZF9zZXRfc3RhdGUoY2QsIFVTQl9DRF9TVEFURV9D
QlcpOworICAgICAgICBjZF9zY3NpX2Rldl9yZXF1ZXN0X3JlbGVhc2UoY2QtPnNjc2lfdGFyZ2V0
LCAmY2QtPnVzYl9yZXEuc2NzaV9yZXEpOworICAgIH0KKworICAgIFNQSUNFX0RFQlVHKCJSZWFs
aXplIE9LIGx1bjolIiBHX0dVSU5UMzJfRk9STUFULCBsdW4pOworICAgIHJldHVybiAwOworfQor
CitpbnQgY2RfdXNiX2J1bGtfbXNkX2xvY2sodm9pZCAqZGV2aWNlLCB1aW50MzJfdCBsdW4sIGdi
b29sZWFuIGxvY2spCit7CisgICAgVXNiQ2RCdWxrTXNkRGV2aWNlICpjZCA9IChVc2JDZEJ1bGtN
c2REZXZpY2UgKilkZXZpY2U7CisgICAgaW50IHJjOworCisgICAgcmMgPSBjZF9zY3NpX2Rldl9s
b2NrKGNkLT5zY3NpX3RhcmdldCwgbHVuLCBsb2NrKTsKKyAgICBpZiAocmMgIT0gMCkgeworICAg
ICAgICBTUElDRV9FUlJPUigiRmFpbGVkIHRvIGxvY2sgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQs
IGx1bik7CisgICAgICAgIHJldHVybiByYzsKKyAgICB9CisKKyAgICBTUElDRV9ERUJVRygiTG9j
ayBPSyBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCwgbHVuKTsKKyAgICByZXR1cm4gMDsKK30KKwor
aW50IGNkX3VzYl9idWxrX21zZF9sb2FkKHZvaWQgKmRldmljZSwgdWludDMyX3QgbHVuLAorICAg
ICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IENkU2NzaU1lZGlhUGFyYW1ldGVycyAqbWVkaWFf
cGFyYW1zKQoreworICAgIFVzYkNkQnVsa01zZERldmljZSAqY2QgPSAoVXNiQ2RCdWxrTXNkRGV2
aWNlICopZGV2aWNlOworICAgIGludCByYzsKKworICAgIHJjID0gY2Rfc2NzaV9kZXZfbG9hZChj
ZC0+c2NzaV90YXJnZXQsIGx1biwgbWVkaWFfcGFyYW1zKTsKKyAgICBpZiAocmMgIT0gMCkgewor
ICAgICAgICBTUElDRV9FUlJPUigiRmFpbGVkIHRvIGxvYWQgbHVuOiUiIEdfR1VJTlQzMl9GT1JN
QVQsIGx1bik7CisgICAgICAgIHJldHVybiByYzsKKyAgICB9CisKKyAgICBTUElDRV9ERUJVRygi
TG9hZCBPSyBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCwgbHVuKTsKKyAgICByZXR1cm4gMDsKK30K
KworaW50IGNkX3VzYl9idWxrX21zZF9nZXRfaW5mbyh2b2lkICpkZXZpY2UsIHVpbnQzMl90IGx1
biwgQ2RTY3NpRGV2aWNlSW5mbyAqbHVuX2luZm8pCit7CisgICAgVXNiQ2RCdWxrTXNkRGV2aWNl
ICpjZCA9IChVc2JDZEJ1bGtNc2REZXZpY2UgKilkZXZpY2U7CisgICAgaW50IHJjOworCisgICAg
cmMgPSBjZF9zY3NpX2Rldl9nZXRfaW5mbyhjZC0+c2NzaV90YXJnZXQsIGx1biwgbHVuX2luZm8p
OworICAgIGlmIChyYyAhPSAwKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJGYWlsZWQgdG8gZ2V0
IGluZm8gbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQsIGx1bik7CisgICAgICAgIHJldHVybiByYzsK
KyAgICB9CisKKyAgICByZXR1cm4gMDsKK30KKworaW50IGNkX3VzYl9idWxrX21zZF91bmxvYWQo
dm9pZCAqZGV2aWNlLCB1aW50MzJfdCBsdW4pCit7CisgICAgVXNiQ2RCdWxrTXNkRGV2aWNlICpj
ZCA9IChVc2JDZEJ1bGtNc2REZXZpY2UgKilkZXZpY2U7CisgICAgaW50IHJjOworCisgICAgcmMg
PSBjZF9zY3NpX2Rldl91bmxvYWQoY2QtPnNjc2lfdGFyZ2V0LCBsdW4pOworICAgIGlmIChyYyAh
PSAwKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJGYWlsZWQgdG8gdW5sb2FkIGx1bjolIiBHX0dV
SU5UMzJfRk9STUFULCBsdW4pOworICAgICAgICByZXR1cm4gcmM7CisgICAgfQorCisgICAgU1BJ
Q0VfREVCVUcoIlVubG9hZCBPSyBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCwgbHVuKTsKKyAgICBy
ZXR1cm4gMDsKK30KKworaW50IGNkX3VzYl9idWxrX21zZF91bnJlYWxpemUodm9pZCAqZGV2aWNl
LCB1aW50MzJfdCBsdW4pCit7CisgICAgVXNiQ2RCdWxrTXNkRGV2aWNlICpjZCA9IChVc2JDZEJ1
bGtNc2REZXZpY2UgKilkZXZpY2U7CisgICAgaW50IHJjOworCisgICAgcmMgPSBjZF9zY3NpX2Rl
dl91bnJlYWxpemUoY2QtPnNjc2lfdGFyZ2V0LCBsdW4pOworICAgIGlmIChyYyAhPSAwKSB7Cisg
ICAgICAgIFNQSUNFX0VSUk9SKCJVbnJlYWxpemUgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQsIGx1
bik7CisgICAgICAgIHJldHVybiByYzsKKyAgICB9CisKKyAgICBTUElDRV9ERUJVRygiVW5yZWFs
aXplIGx1bjolIiBHX0dVSU5UMzJfRk9STUFULCBsdW4pOworICAgIHJldHVybiAwOworfQorCit2
b2lkIGNkX3VzYl9idWxrX21zZF9mcmVlKHZvaWQgKmRldmljZSkKK3sKKyAgICBVc2JDZEJ1bGtN
c2REZXZpY2UgKmNkID0gKFVzYkNkQnVsa01zZERldmljZSAqKWRldmljZTsKKworICAgIGNkX3Nj
c2lfdGFyZ2V0X2ZyZWUoY2QtPnNjc2lfdGFyZ2V0KTsKKyAgICBnX2ZyZWUoY2QpOworCisgICAg
U1BJQ0VfREVCVUcoIkZyZWUiKTsKK30KKworaW50IGNkX3VzYl9idWxrX21zZF9yZXNldCh2b2lk
ICpkZXZpY2UpCit7CisgICAgVXNiQ2RCdWxrTXNkRGV2aWNlICpjZCA9IChVc2JDZEJ1bGtNc2RE
ZXZpY2UgKilkZXZpY2U7CisKKyAgICBjZF9zY3NpX3RhcmdldF9yZXNldChjZC0+c2NzaV90YXJn
ZXQpOworICAgIGNkX3VzYl9idWxrX21zZF9zZXRfc3RhdGUoY2QsIFVTQl9DRF9TVEFURV9DQlcp
OworCisgICAgU1BJQ0VfREVCVUcoIlJlc2V0Iik7CisgICAgcmV0dXJuIDA7Cit9CisKK3N0YXRp
YyBpbnQgcGFyc2VfdXNiX21zZF9jbWQoVXNiQ2RCdWxrTXNkRGV2aWNlICpjZCwgdWludDhfdCAq
YnVmLCB1aW50MzJfdCBjYndfbGVuKQoreworICAgIHN0cnVjdCBVc2JDZENCVyAqY2J3ID0gKHN0
cnVjdCBVc2JDZENCVyAqKWJ1ZjsKKyAgICBVc2JDZEJ1bGtNc2RSZXF1ZXN0ICp1c2JfcmVxID0g
JmNkLT51c2JfcmVxOworICAgIENkU2NzaVJlcXVlc3QgKnNjc2lfcmVxID0gJnVzYl9yZXEtPnNj
c2lfcmVxOworCisgICAgaWYgKGNid19sZW4gIT0gMzEpIHsKKyAgICAgICAgU1BJQ0VfRVJST1Io
IkNNRDogQmFkIENCVyBzaXplOiUiIEdfR1VJTlQzMl9GT1JNQVQsIGNid19sZW4pOworICAgICAg
ICByZXR1cm4gLTE7CisgICAgfQorICAgIGlmIChsZTMydG9oKGNidy0+c2lnKSAhPSAweDQzNDI1
MzU1KSB7IC8qIE1TRCBjb21tYW5kIHNpZ25hdHVyZSAqLworICAgICAgICBTUElDRV9FUlJPUigi
Q01EOiBCYWQgQ0JXIHNpZ25hdHVyZTolMDh4IiwgbGUzMnRvaChjYnctPnNpZykpOworICAgICAg
ICByZXR1cm4gLTE7CisgICAgfQorCisgICAgdXNiX3JlcS0+bHVuID0gY2J3LT5sdW47CisgICAg
dXNiX3JlcS0+dXNiX3RhZyA9IGxlMzJ0b2goY2J3LT50YWcpOworICAgIHVzYl9yZXEtPnVzYl9y
ZXFfbGVuID0gbGUzMnRvaChjYnctPmV4cF9kYXRhX2xlbik7CisKKyAgICB1c2JfcmVxLT5zY3Np
X2luX2xlbiA9IDA7IC8qIG5vIGRhdGEgZnJvbSBzY3NpIHlldCAqLworICAgIHVzYl9yZXEtPnhm
ZXJfbGVuID0gMDsgLyogbm8gYnVsa3MgdHJhbnNmZXJlZCB5ZXQgKi8KKyAgICB1c2JfcmVxLT5i
dWxrX2luX2xlbiA9IDA7IC8qIG5vIGJ1bGstaW4gcmVxdWVzdHMgeWV0ICovCisKKyAgICBpZiAo
dXNiX3JlcS0+dXNiX3JlcV9sZW4gPT0gMCkgeworICAgICAgICBjZF91c2JfYnVsa19tc2Rfc2V0
X3N0YXRlKGNkLCBVU0JfQ0RfU1RBVEVfQ1NXKTsgLyogbm8gZGF0YSAtIHJldHVybiBzdGF0dXMg
Ki8KKyAgICAgICAgc2NzaV9yZXEtPmJ1ZiA9IE5VTEw7CisgICAgICAgIHNjc2lfcmVxLT5idWZf
bGVuID0gMDsKKyAgICB9IGVsc2UgaWYgKGNidy0+ZmxhZ3MgJiAweDgwKSB7CisgICAgICAgIGNk
X3VzYl9idWxrX21zZF9zZXRfc3RhdGUoY2QsIFVTQl9DRF9TVEFURV9EQVRBSU4pOyAvKiByZWFk
IGNvbW1hbmQgKi8KKyAgICAgICAgc2NzaV9yZXEtPmJ1ZiA9IGNkLT5kYXRhX2J1ZjsKKyAgICAg
ICAgc2NzaV9yZXEtPmJ1Zl9sZW4gPSBjZC0+ZGF0YV9idWZfbGVuOworICAgIH0gZWxzZSB7Cisg
ICAgICAgIGNkX3VzYl9idWxrX21zZF9zZXRfc3RhdGUoY2QsIFVTQl9DRF9TVEFURV9EQVRBT1VU
KTsgLyogd3JpdGUgY29tbWFuZCAqLworICAgICAgICBzY3NpX3JlcS0+YnVmID0gTlVMTDsKKyAg
ICAgICAgc2NzaV9yZXEtPmJ1Zl9sZW4gPSAwOworICAgIH0KKworICAgIHNjc2lfcmVxLT5jZGJf
bGVuID0gKCh1aW50MzJfdCljYnctPmNtZF9sZW4pICYgMHgxRjsKKyAgICBnX2Fzc2VydChzY3Np
X3JlcS0+Y2RiX2xlbiA8PSBzaXplb2Yoc2NzaV9yZXEtPmNkYikpOworICAgIG1lbWNweShzY3Np
X3JlcS0+Y2RiLCBjYnctPmNtZCwgc2NzaV9yZXEtPmNkYl9sZW4pOworCisgICAgc2NzaV9yZXEt
PnRhZyA9IHVzYl9yZXEtPnVzYl90YWc7CisgICAgc2NzaV9yZXEtPmx1biA9IHVzYl9yZXEtPmx1
bjsKKworICAgIFNQSUNFX0RFQlVHKCJDTUQgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQgIiB0YWc6
MHgleCBmbGFnczolMDh4ICIKKyAgICAgICAgImNkYl9sZW46JSIgR19HVUlOVDMyX0ZPUk1BVCAi
IHJlcV9sZW46JSIgR19HVUlOVDMyX0ZPUk1BVCwKKyAgICAgICAgdXNiX3JlcS0+bHVuLCB1c2Jf
cmVxLT51c2JfdGFnLCBjYnctPmZsYWdzLAorICAgICAgICBzY3NpX3JlcS0+Y2RiX2xlbiwgdXNi
X3JlcS0+dXNiX3JlcV9sZW4pOworCisgICAgLyogcHJlcGFyZSBzdGF0dXMgLSBDU1cgKi8KKyAg
ICB1c2JfcmVxLT5jc3cuc2lnID0gaHRvbGUzMigweDUzNDI1MzU1KTsKKyAgICB1c2JfcmVxLT5j
c3cudGFnID0gY2J3LT50YWc7CisgICAgdXNiX3JlcS0+Y3N3LnJlc2lkdWUgPSAwOworICAgIHVz
Yl9yZXEtPmNzdy5zdGF0dXMgPSAodWludDhfdClVU0JfTVNEX1NUQVRVU19HT09EOworCisgICAg
cmV0dXJuIDA7Cit9CisKK3N0YXRpYyB2b2lkIHVzYl9jZF9jbWRfZG9uZShVc2JDZEJ1bGtNc2RE
ZXZpY2UgKmNkKQoreworICAgIFVzYkNkQnVsa01zZFJlcXVlc3QgKnVzYl9yZXEgPSAmY2QtPnVz
Yl9yZXE7CisgICAgQ2RTY3NpUmVxdWVzdCAqc2NzaV9yZXEgPSAmdXNiX3JlcS0+c2NzaV9yZXE7
CisKKyAgICBjZF91c2JfYnVsa19tc2Rfc2V0X3N0YXRlKGNkLCBVU0JfQ0RfU1RBVEVfQ0JXKTsg
LyogQ29tbWFuZCBuZXh0ICovCisgICAgY2Rfc2NzaV9kZXZfcmVxdWVzdF9yZWxlYXNlKGNkLT5z
Y3NpX3RhcmdldCwgc2NzaV9yZXEpOworfQorCitzdGF0aWMgdm9pZCB1c2JfY2Rfc2VuZF9zdGF0
dXMoVXNiQ2RCdWxrTXNkRGV2aWNlICpjZCkKK3sKKyAgICBVc2JDZEJ1bGtNc2RSZXF1ZXN0ICp1
c2JfcmVxID0gJmNkLT51c2JfcmVxOworCisgICAgU1BJQ0VfREVCVUcoIkNvbW1hbmQgQ1NXIHRh
ZzoweCV4IG1zZF9zdGF0dXM6JWQgbGVuOiUiIEdfR1VJTlQ2NF9GT1JNQVQsCisgICAgICAgICAg
ICAgICAgbGUzMnRvaCh1c2JfcmVxLT5jc3cudGFnKSwgKGludCl1c2JfcmVxLT5jc3cuc3RhdHVz
LCBzaXplb2YodXNiX3JlcS0+Y3N3KSk7CisKKyAgICB1c2JfY2RfY21kX2RvbmUoY2QpOworCisg
ICAgZ19hc3NlcnQodXNiX3JlcS0+Y3N3LnNpZyA9PSBodG9sZTMyKDB4NTM0MjUzNTUpKTsKKyAg
ICBjZF91c2JfYnVsa19tc2RfcmVhZF9jb21wbGV0ZShjZC0+dXNiX3VzZXJfZGF0YSwKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAodWludDhfdCAqKSZ1c2JfcmVxLT5jc3csIHNp
emVvZih1c2JfcmVxLT5jc3cpLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEJV
TEtfU1RBVFVTX0dPT0QpOworfQorCitzdGF0aWMgdm9pZCB1c2JfY2Rfc2VuZF9jYW5jZWxlZChV
c2JDZEJ1bGtNc2REZXZpY2UgKmNkKQoreworICAgIFVzYkNkQnVsa01zZFJlcXVlc3QgKnVzYl9y
ZXEgPSAmY2QtPnVzYl9yZXE7CisKKyAgICBTUElDRV9ERUJVRygiQ2FuY2VsZWQgY21kIHRhZzow
eCV4LCBsZW46JSIgR19HVUlOVDY0X0ZPUk1BVCwKKyAgICAgICAgICAgICAgICBsZTMydG9oKHVz
Yl9yZXEtPmNzdy50YWcpLCBzaXplb2YodXNiX3JlcS0+Y3N3KSk7CisKKyAgICB1c2JfY2RfY21k
X2RvbmUoY2QpOworCisgICAgY2RfdXNiX2J1bGtfbXNkX3JlYWRfY29tcGxldGUoY2QtPnVzYl91
c2VyX2RhdGEsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTlVMTCwgMCwKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBCVUxLX1NUQVRVU19DQU5DRUxFRCk7Cit9
CisKK3N0YXRpYyB2b2lkIHVzYl9jZF9zZW5kX2RhdGFfaW4oVXNiQ2RCdWxrTXNkRGV2aWNlICpj
ZCwgdWludDMyX3QgbWF4X2xlbikKK3sKKyAgICBVc2JDZEJ1bGtNc2RSZXF1ZXN0ICp1c2JfcmVx
ID0gJmNkLT51c2JfcmVxOworICAgIENkU2NzaVJlcXVlc3QgKnNjc2lfcmVxID0gJnVzYl9yZXEt
PnNjc2lfcmVxOworICAgIHVpbnQ4X3QgKmJ1ZiA9ICgodWludDhfdCAqKXNjc2lfcmVxLT5idWYp
ICsgdXNiX3JlcS0+eGZlcl9sZW47CisgICAgdWludDMyX3QgYXZhaWxfbGVuID0gdXNiX3JlcS0+
c2NzaV9pbl9sZW4gLSB1c2JfcmVxLT54ZmVyX2xlbjsKKyAgICB1aW50MzJfdCBzZW5kX2xlbiA9
IChhdmFpbF9sZW4gPD0gbWF4X2xlbikgPyBhdmFpbF9sZW4gOiBtYXhfbGVuOworCisgICAgU1BJ
Q0VfREVCVUcoIkRhdGEtaW4gY21kIHRhZyAweCV4LCByZW1haW5zICUiIEdfR1VJTlQzMl9GT1JN
QVQKKyAgICAgICAgICAgICAgICAiLCByZXF1ZXN0ZWQgJSIgR19HVUlOVDMyX0ZPUk1BVCAiLCBz
ZW5kICUiIEdfR1VJTlQzMl9GT1JNQVQsCisgICAgICAgICAgICAgICAgdXNiX3JlcS0+Y3N3LnRh
ZywgYXZhaWxfbGVuLCBtYXhfbGVuLCBzZW5kX2xlbik7CisKKyAgICBnX2Fzc2VydChtYXhfbGVu
IDw9IHVzYl9yZXEtPnVzYl9yZXFfbGVuKTsKKworICAgIGNkX3VzYl9idWxrX21zZF9yZWFkX2Nv
bXBsZXRlKGNkLT51c2JfdXNlcl9kYXRhLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGJ1Ziwgc2VuZF9sZW4sCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQlVM
S19TVEFUVVNfR09PRCk7CisKKyAgICBpZiAoc2NzaV9yZXEtPnN0YXR1cyA9PSBHT09EKSB7Cisg
ICAgICAgIHVzYl9yZXEtPnhmZXJfbGVuICs9IHNlbmRfbGVuOworICAgICAgICBpZiAodXNiX3Jl
cS0+eGZlcl9sZW4gPT0gdXNiX3JlcS0+c2NzaV9pbl9sZW4pIHsKKyAgICAgICAgICAgIC8qIGFs
bCBkYXRhIGZvciB0aGlzIGJ1bGsgaGFzIGJlZW4gdHJhbnNmZXJyZWQgKi8KKyAgICAgICAgICAg
IGlmICh1c2JfcmVxLT5zY3NpX2luX2xlbiA9PSB1c2JfcmVxLT51c2JfcmVxX2xlbiB8fCAvKiBy
ZXEgZnVsbHkgc2F0aXNmaWxlZCAqLworICAgICAgICAgICAgICAgIHNlbmRfbGVuIDwgbWF4X2xl
bikgeyAvKiBwYXJ0aWFsIGJ1bGsgLSBubyBtb3JlIGRhdGEgKi8KKyAgICAgICAgICAgICAgICBj
ZF91c2JfYnVsa19tc2Rfc2V0X3N0YXRlKGNkLCBVU0JfQ0RfU1RBVEVfQ1NXKTsKKyAgICAgICAg
ICAgIH0gZWxzZSB7CisgICAgICAgICAgICAgICAgLyogcGFydGlhbCBjbWQgZGF0YSBmdWxsZmls
bGVkIGVudGlyZSB2dWxrLWluIHJlcXVlc3QgKi8KKyAgICAgICAgICAgICAgICBjZF91c2JfYnVs
a19tc2Rfc2V0X3N0YXRlKGNkLCBVU0JfQ0RfU1RBVEVfWkVST19EQVRBSU4pOworICAgICAgICAg
ICAgfQorICAgICAgICB9CisgICAgfSBlbHNlIHsgLyogY21kIGZhaWxlZCAtIG5vIG1vcmUgZGF0
YSAqLworICAgICAgICBjZF91c2JfYnVsa19tc2Rfc2V0X3N0YXRlKGNkLCBVU0JfQ0RfU1RBVEVf
Q1NXKTsKKyAgICB9Cit9CisKK2ludCBjZF91c2JfYnVsa19tc2RfcmVhZCh2b2lkICpkZXZpY2Us
IHVpbnQzMl90IG1heF9sZW4pCit7CisgICAgVXNiQ2RCdWxrTXNkRGV2aWNlICpjZCA9IChVc2JD
ZEJ1bGtNc2REZXZpY2UgKilkZXZpY2U7CisgICAgVXNiQ2RCdWxrTXNkUmVxdWVzdCAqdXNiX3Jl
cSA9ICZjZC0+dXNiX3JlcTsKKyAgICBDZFNjc2lSZXF1ZXN0ICpzY3NpX3JlcSA9ICZ1c2JfcmVx
LT5zY3NpX3JlcTsKKworICAgIFNQSUNFX0RFQlVHKCJtc2RfcmVhZCwgc3RhdGU6ICVzLCBsZW4g
JSIgR19HVUlOVDMyX0ZPUk1BVCwKKyAgICAgICAgICAgICAgICB1c2JfY2Rfc3RhdGVfc3RyKGNk
LT5zdGF0ZSksIG1heF9sZW4pOworCisgICAgc3dpdGNoIChjZC0+c3RhdGUpIHsKKyAgICBjYXNl
IFVTQl9DRF9TVEFURV9DU1c6IC8qIENvbW1hbmQgU3RhdHVzICovCisgICAgICAgIGlmIChtYXhf
bGVuIDwgMTMpIHsKKyAgICAgICAgICAgIGdvdG8gZmFpbDsKKyAgICAgICAgfQorICAgICAgICBp
ZiAoY2Rfc2NzaV9nZXRfcmVxX3N0YXRlKHNjc2lfcmVxKSA9PSBTQ1NJX1JFUV9DT01QTEVURSkg
eworICAgICAgICAgICAgdXNiX2NkX3NlbmRfc3RhdHVzKGNkKTsKKyAgICAgICAgfSBlbHNlIHsK
KyAgICAgICAgICAgIHVzYl9yZXEtPmJ1bGtfaW5fbGVuICs9IG1heF9sZW47CisgICAgICAgICAg
ICBTUElDRV9ERUJVRygibXNkX3JlYWQgQ1NXLCByZXEgaW5jb21wbGV0ZSwgYWRkZWQgbGVuICUi
IEdfR1VJTlQzMl9GT1JNQVQKKyAgICAgICAgICAgICAgICAgICAgICAgICIgc2F2ZWQgbGVuICUi
IEdfR1VJTlQzMl9GT1JNQVQsCisgICAgICAgICAgICAgICAgICAgICAgICBtYXhfbGVuLCB1c2Jf
cmVxLT5idWxrX2luX2xlbik7CisgICAgICAgIH0KKyAgICAgICAgYnJlYWs7CisKKyAgICBjYXNl
IFVTQl9DRF9TVEFURV9EQVRBSU46IC8qIEJ1bGsgRGF0YS1JTiAqLworICAgICAgICBpZiAoY2Rf
c2NzaV9nZXRfcmVxX3N0YXRlKHNjc2lfcmVxKSA9PSBTQ1NJX1JFUV9DT01QTEVURSkgeworICAg
ICAgICAgICAgdXNiX2NkX3NlbmRfZGF0YV9pbihjZCwgbWF4X2xlbik7CisgICAgICAgIH0gZWxz
ZSB7CisgICAgICAgICAgICB1c2JfcmVxLT5idWxrX2luX2xlbiArPSBtYXhfbGVuOworICAgICAg
ICAgICAgU1BJQ0VfREVCVUcoIm1zZF9yZWFkIERBVEFJTiwgcmVxIGluY29tcGxldGUsIGFkZGVk
IGxlbiAlIiBHX0dVSU5UMzJfRk9STUFUCisgICAgICAgICAgICAgICAgICAgICAgICAiIHNhdmVk
IGxlbiAlIiBHX0dVSU5UMzJfRk9STUFULAorICAgICAgICAgICAgICAgICAgICAgICAgbWF4X2xl
biwgdXNiX3JlcS0+YnVsa19pbl9sZW4pOworICAgICAgICB9CisgICAgICAgIGJyZWFrOworCisg
ICAgY2FzZSBVU0JfQ0RfU1RBVEVfWkVST19EQVRBSU46CisgICAgICAgIGNkX3VzYl9idWxrX21z
ZF9yZWFkX2NvbXBsZXRlKGNkLT51c2JfdXNlcl9kYXRhLAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBOVUxMLCAwLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBCVUxLX1NUQVRVU19HT09EKTsKKyAgICAgICAgY2RfdXNiX2J1bGtfbXNkX3NldF9z
dGF0ZShjZCwgVVNCX0NEX1NUQVRFX0NTVyk7IC8qIFN0YXR1cyBuZXh0ICovCisgICAgICAgIGJy
ZWFrOworCisgICAgZGVmYXVsdDoKKyAgICAgICAgU1BJQ0VfRVJST1IoIlVuZXhwZWN0ZWQgcmVh
ZCBzdGF0ZTogJXMsIGxlbiAlIiBHX0dVSU5UMzJfRk9STUFULAorICAgICAgICAgICAgICAgICAg
ICB1c2JfY2Rfc3RhdGVfc3RyKGNkLT5zdGF0ZSksIG1heF9sZW4pOworICAgICAgICBnb3RvIGZh
aWw7CisgICAgfQorICAgIHJldHVybiAwOworCitmYWlsOgorICAgIHJldHVybiAtMTsKK30KKwor
dm9pZCBjZF9zY3NpX2Rldl9yZXF1ZXN0X2NvbXBsZXRlKHZvaWQgKnRhcmdldF91c2VyX2RhdGEs
IENkU2NzaVJlcXVlc3QgKnNjc2lfcmVxKQoreworICAgIFVzYkNkQnVsa01zZERldmljZSAqY2Qg
PSAoVXNiQ2RCdWxrTXNkRGV2aWNlICopdGFyZ2V0X3VzZXJfZGF0YTsKKyAgICBVc2JDZEJ1bGtN
c2RSZXF1ZXN0ICp1c2JfcmVxID0gJmNkLT51c2JfcmVxOworCisgICAgZ19hc3NlcnQoc2NzaV9y
ZXEgPT0gJnVzYl9yZXEtPnNjc2lfcmVxKTsKKworICAgIGlmIChzY3NpX3JlcS0+cmVxX3N0YXRl
ID09IFNDU0lfUkVRX0NPTVBMRVRFKSB7CisKKyAgICAgICAgdXNiX3JlcS0+c2NzaV9pbl9sZW4g
PSAoc2NzaV9yZXEtPmluX2xlbiA8PSB1c2JfcmVxLT51c2JfcmVxX2xlbikgPworICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBzY3NpX3JlcS0+aW5fbGVuIDogdXNiX3JlcS0+dXNiX3Jl
cV9sZW47CisKKyAgICAgICAgLyogcHJlcGFyZSBDU1cgKi8KKyAgICAgICAgaWYgKHVzYl9yZXEt
PnVzYl9yZXFfbGVuID4gdXNiX3JlcS0+c2NzaV9pbl9sZW4pIHsKKyAgICAgICAgICAgIHVzYl9y
ZXEtPmNzdy5yZXNpZHVlID0gaHRvbGUzMih1c2JfcmVxLT51c2JfcmVxX2xlbiAtIHVzYl9yZXEt
PnNjc2lfaW5fbGVuKTsKKyAgICAgICAgfQorICAgICAgICBpZiAoc2NzaV9yZXEtPnN0YXR1cyAh
PSBHT09EKSB7CisgICAgICAgICAgICB1c2JfcmVxLT5jc3cuc3RhdHVzID0gKHVpbnQ4X3QpVVNC
X01TRF9TVEFUVVNfRkFJTEVEOworICAgICAgICB9CisKKyAgICAgICAgaWYgKHVzYl9yZXEtPmJ1
bGtfaW5fbGVuKSB7CisgICAgICAgICAgICAvKiBidWxrLWluIHJlcXVlc3QgYXJyaXZlZCB3aGls
ZSBzY3NpIHdhcyBzdGlsbCBydW5uaW5nICovCisgICAgICAgICAgICBpZiAoY2QtPnN0YXRlID09
IFVTQl9DRF9TVEFURV9EQVRBSU4pIHsKKyAgICAgICAgICAgICAgICB1c2JfY2Rfc2VuZF9kYXRh
X2luKGNkLCB1c2JfcmVxLT5idWxrX2luX2xlbik7CisgICAgICAgICAgICB9IGVsc2UgaWYgKGNk
LT5zdGF0ZSA9PSBVU0JfQ0RfU1RBVEVfQ1NXKSB7CisgICAgICAgICAgICAgICAgdXNiX2NkX3Nl
bmRfc3RhdHVzKGNkKTsKKyAgICAgICAgICAgIH0KKyAgICAgICAgICAgIHVzYl9yZXEtPmJ1bGtf
aW5fbGVuID0gMDsKKyAgICAgICAgfQorICAgIH0gZWxzZSBpZiAoc2NzaV9yZXEtPnJlcV9zdGF0
ZSA9PSBTQ1NJX1JFUV9DQU5DRUxFRCkgeworICAgICAgICB1c2JfY2Rfc2VuZF9jYW5jZWxlZChj
ZCk7CisgICAgfSBlbHNlIHsKKyAgICAgICAgZ19hc3NlcnQoc2NzaV9yZXEtPnJlcV9zdGF0ZSA9
PSBTQ1NJX1JFUV9ESVNQT1NFRCk7CisgICAgICAgIFNQSUNFX0RFQlVHKCJEaXNwb3NlZCBjbWQg
dGFnOjB4JXgsIGxlbjolIiBHX0dVSU5UNjRfRk9STUFULAorICAgICAgICAgICAgICAgIGxlMzJ0
b2godXNiX3JlcS0+Y3N3LnRhZyksIHNpemVvZih1c2JfcmVxLT5jc3cpKTsKKyAgICAgICAgdXNi
X2NkX2NtZF9kb25lKGNkKTsKKyAgICB9Cit9CisKK2ludCBjZF91c2JfYnVsa19tc2RfY2FuY2Vs
X3JlYWQodm9pZCAqZGV2aWNlKQoreworICAgIFVzYkNkQnVsa01zZERldmljZSAqY2QgPSAoVXNi
Q2RCdWxrTXNkRGV2aWNlICopZGV2aWNlOworICAgIFVzYkNkQnVsa01zZFJlcXVlc3QgKnVzYl9y
ZXEgPSAmY2QtPnVzYl9yZXE7CisgICAgQ2RTY3NpUmVxdWVzdCAqc2NzaV9yZXEgPSAmdXNiX3Jl
cS0+c2NzaV9yZXE7CisKKyAgICBjZF9zY3NpX2Rldl9yZXF1ZXN0X2NhbmNlbChjZC0+c2NzaV90
YXJnZXQsIHNjc2lfcmVxKTsKKyAgICByZXR1cm4gMDsKK30KKworaW50IGNkX3VzYl9idWxrX21z
ZF93cml0ZSh2b2lkICpkZXZpY2UsIHVpbnQ4X3QgKmJ1Zl9vdXQsIHVpbnQzMl90IGJ1Zl9vdXRf
bGVuKQoreworICAgIFVzYkNkQnVsa01zZERldmljZSAqY2QgPSAoVXNiQ2RCdWxrTXNkRGV2aWNl
ICopZGV2aWNlOworCisgICAgc3dpdGNoIChjZC0+c3RhdGUpIHsKKyAgICBjYXNlIFVTQl9DRF9T
VEFURV9DQlc6IC8qIENvbW1hbmQgQmxvY2sgKi8KKyAgICAgICAgcGFyc2VfdXNiX21zZF9jbWQo
Y2QsIGJ1Zl9vdXQsIGJ1Zl9vdXRfbGVuKTsKKyAgICAgICAgaWYgKGNkLT5zdGF0ZSA9PSBVU0Jf
Q0RfU1RBVEVfREFUQUlOIHx8IGNkLT5zdGF0ZSA9PSBVU0JfQ0RfU1RBVEVfQ1NXKSB7CisgICAg
ICAgICAgICBjZF9zY3NpX2Rldl9yZXF1ZXN0X3N1Ym1pdChjZC0+c2NzaV90YXJnZXQsICZjZC0+
dXNiX3JlcS5zY3NpX3JlcSk7CisgICAgICAgIH0KKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBV
U0JfQ0RfU1RBVEVfREFUQU9VVDogLyogRGF0YS1PdXQgZm9yIGEgV3JpdGUgY21kICovCisgICAg
ICAgIGNkLT51c2JfcmVxLnNjc2lfcmVxLmJ1ZiA9IGJ1Zl9vdXQ7CisgICAgICAgIGNkLT51c2Jf
cmVxLnNjc2lfcmVxLmJ1Zl9sZW4gPSBidWZfb3V0X2xlbjsKKyAgICAgICAgY2Rfc2NzaV9kZXZf
cmVxdWVzdF9zdWJtaXQoY2QtPnNjc2lfdGFyZ2V0LCAmY2QtPnVzYl9yZXEuc2NzaV9yZXEpOwor
ICAgICAgICBjZF91c2JfYnVsa19tc2Rfc2V0X3N0YXRlKGNkLCBVU0JfQ0RfU1RBVEVfQ1NXKTsg
LyogU3RhdHVzIG5leHQgKi8KKyAgICAgICAgYnJlYWs7CisgICAgZGVmYXVsdDoKKyAgICAgICAg
U1BJQ0VfREVCVUcoIlVuZXhwZWN0ZWQgd3JpdGUgc3RhdGU6ICVzLCBsZW4gJSIgR19HVUlOVDMy
X0ZPUk1BVCwKKyAgICAgICAgICAgICAgICAgICAgdXNiX2NkX3N0YXRlX3N0cihjZC0+c3RhdGUp
LCBidWZfb3V0X2xlbik7CisgICAgICAgIGdvdG8gZmFpbDsKKyAgICB9CisgICAgcmV0dXJuIDA7
CisKK2ZhaWw6CisgICAgcmV0dXJuIC0xOworfQorCit2b2lkIGNkX3Njc2lfZGV2X3Jlc2V0X2Nv
bXBsZXRlKHZvaWQgKnRhcmdldF91c2VyX2RhdGEsIHVpbnQzMl90IGx1bikKK3sKKyAgICBVc2JD
ZEJ1bGtNc2REZXZpY2UgKmNkID0gKFVzYkNkQnVsa01zZERldmljZSAqKXRhcmdldF91c2VyX2Rh
dGE7CisKKyAgICBpZiAoY2QtPnN0YXRlID09IFVTQl9DRF9TVEFURV9ERVZJQ0VfUkVTRVQpIHsK
KyAgICAgICAgY2RfdXNiX2J1bGtfbXNkX3NldF9zdGF0ZShjZCwgVVNCX0NEX1NUQVRFX0NCVyk7
CisgICAgICAgIGNkX3VzYl9idWxrX21zZF9yZXNldF9jb21wbGV0ZShjZC0+dXNiX3VzZXJfZGF0
YSwgMCk7CisgICAgfQorfQorCit2b2lkIGNkX3Njc2lfdGFyZ2V0X3Jlc2V0X2NvbXBsZXRlKHZv
aWQgKnRhcmdldF91c2VyX2RhdGEpCit7CisgICAgVXNiQ2RCdWxrTXNkRGV2aWNlICpjZCA9IChV
c2JDZEJ1bGtNc2REZXZpY2UgKil0YXJnZXRfdXNlcl9kYXRhOworICAgIGNkX3VzYl9idWxrX21z
ZF9zZXRfc3RhdGUoY2QsIFVTQl9DRF9TVEFURV9JTklUKTsKK30KKwordm9pZCBjZF9zY3NpX2Rl
dl9jaGFuZ2VkKHZvaWQgKnRhcmdldF91c2VyX2RhdGEsIHVpbnQzMl90IGx1bikKK3sKKyAgICBV
c2JDZEJ1bGtNc2REZXZpY2UgKmNkID0gKFVzYkNkQnVsa01zZERldmljZSAqKXRhcmdldF91c2Vy
X2RhdGE7CisgICAgU1BJQ0VfREVCVUcoIkRldmljZSBjaGFuZ2VkLCBzdGF0ZTogJXMgbHVuOiAl
IiBHX0dVSU5UMzJfRk9STUFULAorICAgICAgICAgICAgICAgIHVzYl9jZF9zdGF0ZV9zdHIoY2Qt
PnN0YXRlKSwgbHVuKTsKKyAgICBjZF91c2JfYnVsa19tc2RfbHVuX2NoYW5nZWQoY2QtPnVzYl91
c2VyX2RhdGEsIGx1bik7Cit9CisKKyNlbmRpZiAvKiBVU0VfVVNCUkVESVIgKi8KZGlmZiAtLWdp
dCBhL3NyYy9jZC11c2ItYnVsay1tc2QuaCBiL3NyYy9jZC11c2ItYnVsay1tc2QuaApuZXcgZmls
ZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwLi4xMDk4YTg3Ci0tLSAvZGV2L251bGwKKysrIGIv
c3JjL2NkLXVzYi1idWxrLW1zZC5oCkBAIC0wLDAgKzEsMTM0IEBACisvKiAtKi0gTW9kZTogQzsg
Yy1iYXNpYy1vZmZzZXQ6IDQ7IGluZGVudC10YWJzLW1vZGU6IG5pbCAtKi0gKi8KKy8qCisgICAg
Q29weXJpZ2h0IChDKSAyMDE4IFJlZCBIYXQsIEluYy4KKworICAgIFJlZCBIYXQgQXV0aG9yczoK
KyAgICBBbGV4YW5kZXIgTmV6aGluc2t5PGFuZXpoaW5zQHJlZGhhdC5jb20+CisKKyAgICBUaGlz
IGxpYnJhcnkgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29y
CisgICAgbW9kaWZ5IGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFs
IFB1YmxpYworICAgIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZv
dW5kYXRpb247IGVpdGhlcgorICAgIHZlcnNpb24gMi4xIG9mIHRoZSBMaWNlbnNlLCBvciAoYXQg
eW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgorCisgICAgVGhpcyBsaWJyYXJ5IGlzIGRp
c3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCisgICAgYnV0IFdJ
VEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YK
KyAgICBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0Uu
ICBTZWUgdGhlIEdOVQorICAgIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3Jl
IGRldGFpbHMuCisKKyAgICBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBH
TlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCisgICAgTGljZW5zZSBhbG9uZyB3aXRoIHRoaXMgbGli
cmFyeTsgaWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+LgorKi8KKwor
I2lmbmRlZiBfX0NEX1VTQl9CVUxLX01TRF9IX18KKyNkZWZpbmUgX19DRF9VU0JfQlVMS19NU0Rf
SF9fCisKK0dfQkVHSU5fREVDTFMKKworI2luY2x1ZGUgPGdpby9naW8uaD4KKworI2luY2x1ZGUg
ImNkLXNjc2ktZGV2LXBhcmFtcy5oIgorCit0eXBlZGVmIGVudW0gX0NkVXNiQnVsa1N0YXR1cwor
eworICAgIEJVTEtfU1RBVFVTX0dPT0QgPSAwLAorICAgIEJVTEtfU1RBVFVTX0VSUk9SLAorICAg
IEJVTEtfU1RBVFVTX0NBTkNFTEVELAorICAgIEJVTEtfU1RBVFVTX1NUQUxMLAorfSBDZFVzYkJ1
bGtTdGF0dXM7CisKKy8qIFVTQiBiYWNrZW5kIGNhbGxiYWNrcyAqLworCisvKiBjYWxsZWQgb24g
Y29tcGxldGVkIHJlYWQgZGF0YSBidWxrIHRyYW5zZmVyCisgICB1c2VyX2RhdGEgLSB1c2VyX2Rh
dGEgaW4gdW5pdCBwYXJhbWV0ZXJzIHN0cnVjdHVyZQorICAgc3RhdHVzIC0gYnVsayBzdGF0dXMg
Y29kZQorKi8KK3ZvaWQgY2RfdXNiX2J1bGtfbXNkX3JlYWRfY29tcGxldGUodm9pZCAqdXNlcl9k
YXRhLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50OF90ICpkYXRhLCB1
aW50MzJfdCBsZW5ndGgsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENkVXNi
QnVsa1N0YXR1cyBzdGF0dXMpOworCisvKiBjYWxsZWQgd2hlbiBzdGF0ZSBvZiBkZXZpY2UncyB1
bml0IGNoYW5nZWQgdG8gc2lnbmFsIEdVSSBjb21wb25lbnQKKyAgIHVzZXJfZGF0YSAtIHVzZXJf
ZGF0YSBpbiB1bml0IHBhcmFtZXRlcnMgc3RydWN0dXJlCisqLwordm9pZCBjZF91c2JfYnVsa19t
c2RfbHVuX2NoYW5nZWQodm9pZCAqdXNlcl9kYXRhLCB1aW50MzJfdCBsdW4pOworCisvKiBjYWxs
ZWQgb24gY29tcGxldGVkIGRldmljZSByZXNldAorICAgdXNlcl9kYXRhIC0gdXNlcl9kYXRhIGlu
IHVuaXQgcGFyYW1ldGVycyBzdHJ1Y3R1cmUKKyAgIHN0YXR1cyAtIGVycm9yIGNvZGUKKyovCit2
b2lkIGNkX3VzYl9idWxrX21zZF9yZXNldF9jb21wbGV0ZSh2b2lkICp1c2VyX2RhdGEsCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgc3RhdHVzKTsKKworLyogTVNEIGJh
Y2tlbmQgYXBpICovCisKKy8qIGFsbG9jYXRlIG5ldyBkZXZpY2UgZGVzY3JpcHRvciAqLwordm9p
ZCAqY2RfdXNiX2J1bGtfbXNkX2FsbG9jKHZvaWQgKnVzZXJfZGF0YSwgdWludDMyX3QgbWF4X2x1
bik7CisKKy8qIGZyZWUgZGV2aWNlIGRlc2NyaXB0b3IgKi8KK3ZvaWQgY2RfdXNiX2J1bGtfbXNk
X2ZyZWUodm9pZCAqZGV2aWNlKTsKKworLyogY29uZmlndXJlIGEgbmV3IExvZ2ljYWwgVW5pdCB0
byBiZSByZXByZXNlbnRlZCBieSB0aGUgZGV2aWNlCisgICByZXR1cm5zOiBlcnJvciBjb2RlCisq
LworaW50IGNkX3VzYl9idWxrX21zZF9yZWFsaXplKHZvaWQgKmRldmljZSwgdWludDMyX3QgbHVu
LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IENkU2NzaURldmljZVBhcmFtZXRl
cnMgKmRldl9wYXJhbXMpOworCisvKiBsb2NrIHRoZSBkZXZpY2UsIHByZXZlbnQgdW5sb2FkaW5n
CisgICByZXR1cm5zOiBlcnJvciBjb2RlCisqLworaW50IGNkX3VzYl9idWxrX21zZF9sb2NrKHZv
aWQgKmRldmljZSwgdWludDMyX3QgbHVuLCBnYm9vbGVhbiBsb2NrKTsKKworLyogbG9hZCBuZXcg
bWVkaWEsIGlmIGFscmVhZHkgbG9hZGVkLCBzaW11bGF0ZSBtZWRpYSBjaGFuZ2UKKyAgIHJldHVy
bnM6IGVycm9yIGNvZGUKKyovCitpbnQgY2RfdXNiX2J1bGtfbXNkX2xvYWQodm9pZCAqZGV2aWNl
LCB1aW50MzJfdCBsdW4sCisgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgQ2RTY3NpTWVk
aWFQYXJhbWV0ZXJzICptZWRpYV9wYXJhbXMpOworCisvKiBxdWVyeSB1bml0IHBhcmFtZXRlcnMg
YW5kIHN0YXR1cworICAgcmV0dXJuczogZXJyb3IgY29kZQorKi8KK2ludCBjZF91c2JfYnVsa19t
c2RfZ2V0X2luZm8odm9pZCAqZGV2aWNlLCB1aW50MzJfdCBsdW4sCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIENkU2NzaURldmljZUluZm8gKmx1bl9pbmZvKTsKKworLyogdW5sb2FkIHRo
ZSBtZWRpYQorICAgcmV0dXJuczogZXJyb3IgY29kZQorKi8KK2ludCBjZF91c2JfYnVsa19tc2Rf
dW5sb2FkKHZvaWQgKmRldmljZSwgdWludDMyX3QgbHVuKTsKKworLyogZGV0YWNoIGEgTG9naWNh
bCBVbml0CisgICByZXR1cm5zOiBlcnJvciBjb2RlCisqLworaW50IGNkX3VzYl9idWxrX21zZF91
bnJlYWxpemUodm9pZCAqZGV2aWNlLCB1aW50MzJfdCBsdW4pOworCisvKiByZXNldCB0aGUgZGV2
aWNlIGluc3RhbmNlOyBjYW5jZWwgYWxsIElPIG9wcywgcmVzZXQgc3RhdGUKKyAgIHJldHVybnM6
IGVycm9yIGNvZGUKKyovCitpbnQgY2RfdXNiX2J1bGtfbXNkX3Jlc2V0KHZvaWQgKmRldmljZSk7
CisKKworLyogcGVyZm9ybSBhIHdyaXRlIGRhdGEgYnVsayB0cmFuc2ZlcgorICAgZGF0YV9sZW4g
LSBsZW5ndGggb2YgYXZhaWxhYmxlIGRhdGEgdG8gd3JpdGUKKyAgIHJldHVybnM6IGVycm9yIGNv
ZGUKKyovCitpbnQgY2RfdXNiX2J1bGtfbXNkX3dyaXRlKHZvaWQgKmRldmljZSwKKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgdWludDhfdCAqYnVmLCB1aW50MzJfdCBkYXRhX2xlbik7CisKKwor
LyogcGVyZm9ybSBhIHJlYWQgZGF0YSBidWxrIHRyYW5zZmVyCisgICBtYXhfbGVuIC0gbGVuZ3Ro
IG9mIGF2YWlsYWJsZSBidWZmZXIgdG8gZmlsbAorICAgSWYgZGF0YSBhdmFpbGFibGUgaW1tZWRp
YXRlbHksIHNob3VsZCBjYWxsIGNkX3VzYl9idWxrX21zZF9yZWFkX2NvbXBsZXRlKCkKKyAgICAg
YW5kIHJldHVybiBzdWNjZXNzCisgICBJZiBmYXRhbCBlcnJvciBkZXRlY3RlZCBpbW1lZGlhdGVs
eSwgc2hvdWxkIGNhbGwgY2RfdXNiX2J1bGtfbXNkX3JlYWRfY29tcGxldGUoKQorICAgICB3aXRo
IGVycm9yIGNvZGUgYW5kIHJldHVybiBzdWNjZXNzCisKKyAgIHJldHVybnM6IDAgLSBzdWNjZXNz
LCAtMSAtIGVycm9yCisqLworaW50IGNkX3VzYl9idWxrX21zZF9yZWFkKHZvaWQgKmRldmljZSwg
dWludDMyX3QgbWF4X2xlbik7CisKKy8qIGNhbmNlbHMgcGVuZGluZyByZWFkIGRhdGEgYnVsayB0
cmFuc2ZlcgorICAgcmV0dXJuczogZXJyb3IgY29kZQorKi8KK2ludCBjZF91c2JfYnVsa19tc2Rf
Y2FuY2VsX3JlYWQodm9pZCAqZGV2aWNlKTsKKworR19FTkRfREVDTFMKKworI2VuZGlmIC8qIF9f
Q0RfVVNCX0JVTEtfTVNEX0hfXyAqLwpkaWZmIC0tZ2l0IGEvc3JjL3Njc2ktY29uc3RhbnRzLmgg
Yi9zcmMvc2NzaS1jb25zdGFudHMuaApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAw
Li4zMWRhNzUwCi0tLSAvZGV2L251bGwKKysrIGIvc3JjL3Njc2ktY29uc3RhbnRzLmgKQEAgLTAs
MCArMSwzMjQgQEAKKy8qIC0qLSBNb2RlOiBDOyBjLWJhc2ljLW9mZnNldDogNDsgaW5kZW50LXRh
YnMtbW9kZTogbmlsIC0qLSAqLworLyoKKyAgIENvcHlyaWdodCAoQykgMjAxOCBSZWQgSGF0LCBJ
bmMuCisgICBCYXNlZCBvbiB0aGUgR0xpYiBoZWFkZXIKKworICAgVGhpcyBsaWJyYXJ5IGlzIGZy
ZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vcgorICAgbW9kaWZ5IGl0
IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYworICAgTGlj
ZW5zZSBhcyBwdWJsaXNoZWQgYnkgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVy
CisgICB2ZXJzaW9uIDIuMSBvZiB0aGUgTGljZW5zZSwgb3IgKGF0IHlvdXIgb3B0aW9uKSBhbnkg
bGF0ZXIgdmVyc2lvbi4KKworICAgVGhpcyBsaWJyYXJ5IGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBo
b3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCisgICBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7
IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgorICAgTUVSQ0hBTlRBQklMSVRZ
IG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZSBHTlUKKyAgIExl
c3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCisKKyAgIFlvdSBz
aG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJs
aWMKKyAgIExpY2Vuc2UgYWxvbmcgd2l0aCB0aGlzIGxpYnJhcnk7IGlmIG5vdCwgc2VlIDxodHRw
Oi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4KKyovCisKKyNpZm5kZWYgX19TQ1NJX0NPTlNUQU5U
U19IX18KKyNkZWZpbmUgX19TQ1NJX0NPTlNUQU5UU19IX18KKworLyoKKyAqICAgICAgU0NTSSBv
cGNvZGVzCisgKi8KKworI2RlZmluZSBURVNUX1VOSVRfUkVBRFkgICAgICAgMHgwMAorI2RlZmlu
ZSBSRVdJTkQgICAgICAgICAgICAgICAgMHgwMQorI2RlZmluZSBSRVFVRVNUX1NFTlNFICAgICAg
ICAgMHgwMworI2RlZmluZSBGT1JNQVRfVU5JVCAgICAgICAgICAgMHgwNAorI2RlZmluZSBSRUFE
X0JMT0NLX0xJTUlUUyAgICAgMHgwNQorI2RlZmluZSBJTklUSUFMSVpFX0VMRU1FTlRfU1RBVFVT
IDB4MDcKKyNkZWZpbmUgUkVBU1NJR05fQkxPQ0tTXyAgICAgIDB4MDcKKyNkZWZpbmUgUkVBRF82
ICAgICAgICAgICAgICAgIDB4MDgKKyNkZWZpbmUgV1JJVEVfNiAgICAgICAgICAgICAgIDB4MGEK
KyNkZWZpbmUgU0VUX0NBUEFDSVRZICAgICAgICAgIDB4MGIKKyNkZWZpbmUgUkVBRF9SRVZFUlNF
ICAgICAgICAgIDB4MGYKKyNkZWZpbmUgV1JJVEVfRklMRU1BUktTICAgICAgIDB4MTAKKyNkZWZp
bmUgU1BBQ0UgICAgICAgICAgICAgICAgIDB4MTEKKyNkZWZpbmUgSU5RVUlSWSAgICAgICAgICAg
ICAgIDB4MTIKKyNkZWZpbmUgUkVDT1ZFUl9CVUZGRVJFRF9EQVRBIDB4MTQKKyNkZWZpbmUgTU9E
RV9TRUxFQ1QgICAgICAgICAgIDB4MTUKKyNkZWZpbmUgUkVTRVJWRSAgICAgICAgICAgICAgIDB4
MTYKKyNkZWZpbmUgUkVMRUFTRSAgICAgICAgICAgICAgIDB4MTcKKyNkZWZpbmUgQ09QWSAgICAg
ICAgICAgICAgICAgIDB4MTgKKyNkZWZpbmUgRVJBU0UgICAgICAgICAgICAgICAgIDB4MTkKKyNk
ZWZpbmUgTU9ERV9TRU5TRSAgICAgICAgICAgIDB4MWEKKyNkZWZpbmUgTE9BRF9VTkxPQUQgICAg
ICAgICAgIDB4MWIKKyNkZWZpbmUgU0NBTiAgICAgICAgICAgICAgICAgIDB4MWIKKyNkZWZpbmUg
U1RBUlRfU1RPUCAgICAgICAgICAgIDB4MWIKKyNkZWZpbmUgUkVDRUlWRV9ESUFHTk9TVElDICAg
IDB4MWMKKyNkZWZpbmUgU0VORF9ESUFHTk9TVElDICAgICAgIDB4MWQKKyNkZWZpbmUgQUxMT1df
TUVESVVNX1JFTU9WQUwgIDB4MWUKKyNkZWZpbmUgU0VUX1dJTkRPVyAgICAgICAgICAgIDB4MjQK
KyNkZWZpbmUgUkVBRF9DQVBBQ0lUWV8xMCAgICAgIDB4MjUKKyNkZWZpbmUgR0VUX1dJTkRPVyAg
ICAgICAgICAgIDB4MjUKKyNkZWZpbmUgUkVBRF8xMCAgICAgICAgICAgICAgIDB4MjgKKyNkZWZp
bmUgV1JJVEVfMTAgICAgICAgICAgICAgIDB4MmEKKyNkZWZpbmUgU0VORCAgICAgICAgICAgICAg
ICAgIDB4MmEKKyNkZWZpbmUgU0VFS18xMCAgICAgICAgICAgICAgIDB4MmIKKyNkZWZpbmUgTE9D
QVRFXzEwICAgICAgICAgICAgIDB4MmIKKyNkZWZpbmUgUE9TSVRJT05fVE9fRUxFTUVOVCAgIDB4
MmIKKyNkZWZpbmUgV1JJVEVfVkVSSUZZXzEwICAgICAgIDB4MmUKKyNkZWZpbmUgVkVSSUZZXzEw
ICAgICAgICAgICAgIDB4MmYKKyNkZWZpbmUgU0VBUkNIX0hJR0ggICAgICAgICAgIDB4MzAKKyNk
ZWZpbmUgU0VBUkNIX0VRVUFMICAgICAgICAgIDB4MzEKKyNkZWZpbmUgT0JKRUNUX1BPU0lUSU9O
ICAgICAgIDB4MzEKKyNkZWZpbmUgU0VBUkNIX0xPVyAgICAgICAgICAgIDB4MzIKKyNkZWZpbmUg
U0VUX0xJTUlUUyAgICAgICAgICAgIDB4MzMKKyNkZWZpbmUgUFJFX0ZFVENIICAgICAgICAgICAg
IDB4MzQKKyNkZWZpbmUgUkVBRF9QT1NJVElPTiAgICAgICAgIDB4MzQKKyNkZWZpbmUgR0VUX0RB
VEFfQlVGRkVSX1NUQVRVUyAweDM0CisjZGVmaW5lIFNZTkNIUk9OSVpFX0NBQ0hFICAgICAweDM1
CisjZGVmaW5lIExPQ0tfVU5MT0NLX0NBQ0hFICAgICAweDM2CisjZGVmaW5lIElOSVRJQUxJWkVf
RUxFTUVOVF9TVEFUVVNfV0lUSF9SQU5HRSAweDM3CisjZGVmaW5lIFJFQURfREVGRUNUX0RBVEEg
ICAgICAweDM3CisjZGVmaW5lIE1FRElVTV9TQ0FOICAgICAgICAgICAweDM4CisjZGVmaW5lIENP
TVBBUkUgICAgICAgICAgICAgICAweDM5CisjZGVmaW5lIENPUFlfVkVSSUZZICAgICAgICAgICAw
eDNhCisjZGVmaW5lIFdSSVRFX0JVRkZFUiAgICAgICAgICAweDNiCisjZGVmaW5lIFJFQURfQlVG
RkVSICAgICAgICAgICAweDNjCisjZGVmaW5lIFVQREFURV9CTE9DSyAgICAgICAgICAweDNkCisj
ZGVmaW5lIFJFQURfTE9OR18xMCAgICAgICAgICAweDNlCisjZGVmaW5lIFdSSVRFX0xPTkdfMTAg
ICAgICAgICAweDNmCisjZGVmaW5lIENIQU5HRV9ERUZJTklUSU9OICAgICAweDQwCisjZGVmaW5l
IFdSSVRFX1NBTUVfMTAgICAgICAgICAweDQxCisjZGVmaW5lIFVOTUFQICAgICAgICAgICAgICAg
ICAweDQyCisjZGVmaW5lIFJFQURfVE9DICAgICAgICAgICAgICAweDQzCisjZGVmaW5lIFJFUE9S
VF9ERU5TSVRZX1NVUFBPUlQgMHg0NAorI2RlZmluZSBHRVRfQ09ORklHVVJBVElPTiAgICAgMHg0
NgorI2RlZmluZSBTQU5JVElaRSAgICAgICAgICAgICAgMHg0OAorI2RlZmluZSBHRVRfRVZFTlRf
U1RBVFVTX05PVElGSUNBVElPTiAweDRhCisjZGVmaW5lIExPR19TRUxFQ1QgICAgICAgICAgICAw
eDRjCisjZGVmaW5lIExPR19TRU5TRSAgICAgICAgICAgICAweDRkCisjZGVmaW5lIFJFQURfRElT
Q19JTkZPUk1BVElPTiAweDUxCisjZGVmaW5lIFJFQURfVFJBQ0tfSU5GT1JNQVRJT04gMHg1Mgor
I2RlZmluZSBSRVNFUlZFX1RSQUNLICAgICAgICAgMHg1MworI2RlZmluZSBNT0RFX1NFTEVDVF8x
MCAgICAgICAgMHg1NQorI2RlZmluZSBSRVNFUlZFXzEwICAgICAgICAgICAgMHg1NgorI2RlZmlu
ZSBSRUxFQVNFXzEwICAgICAgICAgICAgMHg1NworI2RlZmluZSBNT0RFX1NFTlNFXzEwICAgICAg
ICAgMHg1YQorI2RlZmluZSBTRU5EX0NVRV9TSEVFVCAgICAgICAgMHg1ZAorI2RlZmluZSBQRVJT
SVNURU5UX1JFU0VSVkVfSU4gMHg1ZQorI2RlZmluZSBQRVJTSVNURU5UX1JFU0VSVkVfT1VUIDB4
NWYKKyNkZWZpbmUgVkFSTEVOR1RIX0NEQiAgICAgICAgIDB4N2YKKyNkZWZpbmUgV1JJVEVfRklM
RU1BUktTXzE2ICAgIDB4ODAKKyNkZWZpbmUgUkVBRF9SRVZFUlNFXzE2ICAgICAgIDB4ODEKKyNk
ZWZpbmUgQUxMT1dfT1ZFUldSSVRFICAgICAgIDB4ODIKKyNkZWZpbmUgRVhURU5ERURfQ09QWSAg
ICAgICAgIDB4ODMKKyNkZWZpbmUgQVRBX1BBU1NUSFJPVUdIXzE2ICAgIDB4ODUKKyNkZWZpbmUg
QUNDRVNTX0NPTlRST0xfSU4gICAgIDB4ODYKKyNkZWZpbmUgQUNDRVNTX0NPTlRST0xfT1VUICAg
IDB4ODcKKyNkZWZpbmUgUkVBRF8xNiAgICAgICAgICAgICAgIDB4ODgKKyNkZWZpbmUgQ09NUEFS
RV9BTkRfV1JJVEUgICAgIDB4ODkKKyNkZWZpbmUgV1JJVEVfMTYgICAgICAgICAgICAgIDB4OGEK
KyNkZWZpbmUgV1JJVEVfVkVSSUZZXzE2ICAgICAgIDB4OGUKKyNkZWZpbmUgVkVSSUZZXzE2ICAg
ICAgICAgICAgIDB4OGYKKyNkZWZpbmUgUFJFX0ZFVENIXzE2ICAgICAgICAgIDB4OTAKKyNkZWZp
bmUgU1BBQ0VfMTYgICAgICAgICAgICAgIDB4OTEKKyNkZWZpbmUgU1lOQ0hST05JWkVfQ0FDSEVf
MTYgIDB4OTEKKyNkZWZpbmUgTE9DQVRFXzE2ICAgICAgICAgICAgIDB4OTIKKyNkZWZpbmUgV1JJ
VEVfU0FNRV8xNiAgICAgICAgIDB4OTMKKyNkZWZpbmUgRVJBU0VfMTYgICAgICAgICAgICAgIDB4
OTMKKyNkZWZpbmUgU0VSVklDRV9BQ1RJT05fSU5fMTYgIDB4OWUKKyNkZWZpbmUgV1JJVEVfTE9O
R18xNiAgICAgICAgIDB4OWYKKyNkZWZpbmUgUkVQT1JUX0xVTlMgICAgICAgICAgIDB4YTAKKyNk
ZWZpbmUgQVRBX1BBU1NUSFJPVUdIXzEyICAgIDB4YTEKKyNkZWZpbmUgTUFJTlRFTkFOQ0VfSU4g
ICAgICAgIDB4YTMKKyNkZWZpbmUgTUFJTlRFTkFOQ0VfT1VUICAgICAgIDB4YTQKKyNkZWZpbmUg
TU9WRV9NRURJVU0gICAgICAgICAgIDB4YTUKKyNkZWZpbmUgRVhDSEFOR0VfTUVESVVNICAgICAg
IDB4YTYKKyNkZWZpbmUgU0VUX1JFQURfQUhFQUQgICAgICAgIDB4YTcKKyNkZWZpbmUgUkVBRF8x
MiAgICAgICAgICAgICAgIDB4YTgKKyNkZWZpbmUgV1JJVEVfMTIgICAgICAgICAgICAgIDB4YWEK
KyNkZWZpbmUgU0VSVklDRV9BQ1RJT05fSU5fMTIgIDB4YWIKKyNkZWZpbmUgRVJBU0VfMTIgICAg
ICAgICAgICAgIDB4YWMKKyNkZWZpbmUgV1JJVEVfVkVSSUZZXzEyICAgICAgIDB4YWUKKyNkZWZp
bmUgVkVSSUZZXzEyICAgICAgICAgICAgIDB4YWYKKyNkZWZpbmUgU0VBUkNIX0hJR0hfMTIgICAg
ICAgIDB4YjAKKyNkZWZpbmUgU0VBUkNIX0VRVUFMXzEyICAgICAgIDB4YjEKKyNkZWZpbmUgU0VB
UkNIX0xPV18xMiAgICAgICAgIDB4YjIKKyNkZWZpbmUgUkVBRF9FTEVNRU5UX1NUQVRVUyAgIDB4
YjgKKyNkZWZpbmUgU0VORF9WT0xVTUVfVEFHICAgICAgIDB4YjYKKworLyogTU1DLXNwZWNpZmlj
IG9wY29kZSBhc3NpZ25tZW50ICovCisjZGVmaW5lIE1NQ19TRU5EX0VWRU5UICAgICAgICAgIDB4
YTIKKyNkZWZpbmUgTU1DX1NFTkRfS0VZICAgICAgICAgICAgMHhhMworI2RlZmluZSBNTUNfUkVQ
T1JUX0tFWSAgICAgICAgICAweGE0CisjZGVmaW5lIE1NQ19HRVRfUEVSRk9STUFOQ0UgICAgIDB4
YWMKKyNkZWZpbmUgTU1DX1JFQURfRFZEX1NUUlVDVFVSRSAgMHhhZAorI2RlZmluZSBNTUNfUkVB
RF9ERUZFQ1RfREFUQV8xMiAweGI3CisjZGVmaW5lIE1NQ19TRVRfQ0RfU1BFRUQgICAgICAgIDB4
YmIKKyNkZWZpbmUgTU1DX01FQ0hBTklTTV9TVEFUVVMgICAgMHhiZAorI2RlZmluZSBNTUNfUkVB
RF9DRCAgICAgICAgICAgICAweGJlCisjZGVmaW5lIE1NQ19TRU5EX0RWRF9TVFJVQ1RVUkUgIDB4
YmYKKworLyoKKyAqIFNFUlZJQ0UgQUNUSU9OIElOIHN1YmNvZGVzCisgKi8KKyNkZWZpbmUgU0FJ
X1JFQURfQ0FQQUNJVFlfMTYgIDB4MTAKKworLyoKKyAqIFJFQUQgUE9TSVRJT04gc2VydmljZSBh
Y3Rpb24gY29kZXMKKyAqLworI2RlZmluZSBTSE9SVF9GT1JNX0JMT0NLX0lEICAweDAwCisjZGVm
aW5lIFNIT1JUX0ZPUk1fVkVORE9SX1NQRUNJRklDIDB4MDEKKyNkZWZpbmUgTE9OR19GT1JNICAg
ICAgICAgICAgMHgwNgorI2RlZmluZSBFWFRFTkRFRF9GT1JNICAgICAgICAweDA4CisKKy8qCisg
KiAgU0FNIFN0YXR1cyBjb2RlcworICovCisKKyNkZWZpbmUgR09PRCAgICAgICAgICAgICAgICAg
MHgwMAorI2RlZmluZSBDSEVDS19DT05ESVRJT04gICAgICAweDAyCisjZGVmaW5lIENPTkRJVElP
Tl9HT09EICAgICAgIDB4MDQKKyNkZWZpbmUgQlVTWSAgICAgICAgICAgICAgICAgMHgwOAorI2Rl
ZmluZSBJTlRFUk1FRElBVEVfR09PRCAgICAweDEwCisjZGVmaW5lIElOVEVSTUVESUFURV9DX0dP
T0QgIDB4MTQKKyNkZWZpbmUgUkVTRVJWQVRJT05fQ09ORkxJQ1QgMHgxOAorI2RlZmluZSBDT01N
QU5EX1RFUk1JTkFURUQgICAweDIyCisjZGVmaW5lIFRBU0tfU0VUX0ZVTEwgICAgICAgIDB4MjgK
KyNkZWZpbmUgQUNBX0FDVElWRSAgICAgICAgICAgMHgzMAorI2RlZmluZSBUQVNLX0FCT1JURUQg
ICAgICAgICAweDQwCisKKyNkZWZpbmUgU1RBVFVTX01BU0sgICAgICAgICAgMHgzZQorCisvKgor
ICogIFNFTlNFIEtFWVMKKyAqLworCisjZGVmaW5lIE5PX1NFTlNFICAgICAgICAgICAgMHgwMAor
I2RlZmluZSBSRUNPVkVSRURfRVJST1IgICAgIDB4MDEKKyNkZWZpbmUgTk9UX1JFQURZICAgICAg
ICAgICAweDAyCisjZGVmaW5lIE1FRElVTV9FUlJPUiAgICAgICAgMHgwMworI2RlZmluZSBIQVJE
V0FSRV9FUlJPUiAgICAgIDB4MDQKKyNkZWZpbmUgSUxMRUdBTF9SRVFVRVNUICAgICAweDA1Cisj
ZGVmaW5lIFVOSVRfQVRURU5USU9OICAgICAgMHgwNgorI2RlZmluZSBEQVRBX1BST1RFQ1QgICAg
ICAgIDB4MDcKKyNkZWZpbmUgQkxBTktfQ0hFQ0sgICAgICAgICAweDA4CisjZGVmaW5lIENPUFlf
QUJPUlRFRCAgICAgICAgMHgwYQorI2RlZmluZSBBQk9SVEVEX0NPTU1BTkQgICAgIDB4MGIKKyNk
ZWZpbmUgVk9MVU1FX09WRVJGTE9XICAgICAweDBkCisjZGVmaW5lIE1JU0NPTVBBUkUgICAgICAg
ICAgMHgwZQorCisKKy8qCisgKiAgREVWSUNFIFRZUEVTCisgKi8KKworI2RlZmluZSBUWVBFX0RJ
U0sgICAgICAgICAgIDB4MDAKKyNkZWZpbmUgVFlQRV9UQVBFICAgICAgICAgICAweDAxCisjZGVm
aW5lIFRZUEVfUFJJTlRFUiAgICAgICAgMHgwMgorI2RlZmluZSBUWVBFX1BST0NFU1NPUiAgICAg
IDB4MDMgICAgLyogSFAgc2Nhbm5lcnMgdXNlIHRoaXMgKi8KKyNkZWZpbmUgVFlQRV9XT1JNICAg
ICAgICAgICAweDA0ICAgIC8qIFRyZWF0ZWQgYXMgUk9NIGJ5IG91ciBzeXN0ZW0gKi8KKyNkZWZp
bmUgVFlQRV9ST00gICAgICAgICAgICAweDA1CisjZGVmaW5lIFRZUEVfU0NBTk5FUiAgICAgICAg
MHgwNgorI2RlZmluZSBUWVBFX01PRCAgICAgICAgICAgIDB4MDcgICAgLyogTWFnbmV0by1vcHRp
Y2FsIGRpc2sgLQorCQkJCSAgICAgKiAtIHRyZWF0ZWQgYXMgVFlQRV9ESVNLICovCisjZGVmaW5l
IFRZUEVfTUVESVVNX0NIQU5HRVIgMHgwOAorI2RlZmluZSBUWVBFX1NUT1JBR0VfQVJSQVkgIDB4
MGMgICAgLyogU3RvcmFnZSBhcnJheSBkZXZpY2UgKi8KKyNkZWZpbmUgVFlQRV9FTkNMT1NVUkUg
ICAgICAweDBkICAgIC8qIEVuY2xvc3VyZSBTZXJ2aWNlcyBEZXZpY2UgKi8KKyNkZWZpbmUgVFlQ
RV9SQkMgICAgICAgICAgICAweDBlICAgIC8qIFNpbXBsaWZpZWQgRGlyZWN0LUFjY2VzcyBEZXZp
Y2UgKi8KKyNkZWZpbmUgVFlQRV9PU0QgICAgICAgICAgICAweDExICAgIC8qIE9iamVjdC1zdG9y
YWdlIERldmljZSAqLworI2RlZmluZSBUWVBFX1dMVU4gICAgICAgICAgIDB4MWUgICAgLyogV2Vs
bCBrbm93biBMVU4gKi8KKyNkZWZpbmUgVFlQRV9OT1RfUFJFU0VOVCAgICAweDFmCisjZGVmaW5l
IFRZUEVfSU5BQ1RJVkUgICAgICAgMHgyMAorI2RlZmluZSBUWVBFX05PX0xVTiAgICAgICAgIDB4
N2YKKworLyogTW9kZSBwYWdlIGNvZGVzIGZvciBtb2RlIHNlbnNlL3NldCAqLworI2RlZmluZSBN
T0RFX1BBR0VfUl9XX0VSUk9SICAgICAgICAgICAgICAgICAgIDB4MDEKKyNkZWZpbmUgTU9ERV9Q
QUdFX01SVyAgICAgICAgICAgICAgICAgICAgICAgICAweDAzCisjZGVmaW5lIE1PREVfUEFHRV9I
RF9HRU9NRVRSWSAgICAgICAgICAgICAgICAgMHgwNAorI2RlZmluZSBNT0RFX1BBR0VfRkxFWElC
TEVfRElTS19HRU9NRVRSWSAgICAgIDB4MDUgLyogU0JDICovCisjZGVmaW5lIE1PREVfUEFHRV9X
UklURV9QQVJBTUVURVIgICAgICAgICAgICAgMHgwNSAvKiBNTUMgKi8KKyNkZWZpbmUgTU9ERV9Q
QUdFX0NBQ0hJTkcgICAgICAgICAgICAgICAgICAgICAweDA4CisjZGVmaW5lIE1PREVfUEFHRV9D
RF9ERVZJQ0UgICAgICAgICAgICAgICAgICAgMHgwZAorI2RlZmluZSBNT0RFX1BBR0VfQVVESU9f
Q1RMICAgICAgICAgICAgICAgICAgIDB4MGUKKyNkZWZpbmUgTU9ERV9QQUdFX1BPV0VSICAgICAg
ICAgICAgICAgICAgICAgICAweDFhCisjZGVmaW5lIE1PREVfUEFHRV9GQVVMVF9GQUlMICAgICAg
ICAgICAgICAgICAgMHgxYworI2RlZmluZSBNT0RFX1BBR0VfVE9fUFJPVEVDVCAgICAgICAgICAg
ICAgICAgIDB4MWQKKyNkZWZpbmUgTU9ERV9QQUdFX0NBUFNfTUVDSF9TVEFUVVMgICAgICAgICAg
ICAweDJhCisjZGVmaW5lIE1PREVfUEFHRV9NUldfVkVORE9SICAgICAgICAgICAgICAgICAgMHgy
QworI2RlZmluZSBNT0RFX1BBR0VfQUxMUyAgICAgICAgICAgICAgICAgICAgICAgIDB4M2YKKy8q
IE5vdCBpbiBNdC4gRnVqaSwgYnV0IGluIEFUQVBJIDIuNiAtLSBkZXByZWNhdGVkIG5vdyBpbiBm
YXZvcgorICogb2YgTU9ERV9QQUdFX1NFTlNFX1BPV0VSICovCisjZGVmaW5lIE1PREVfUEFHRV9D
RFJPTSAgICAgICAgICAgICAgICAgICAgICAgMHgwZAorCisjZGVmaW5lIE1PREVfUEFHRV9DRFJP
TSAgICAgICAgICAgICAgICAgICAgICAgMHgwZAorCisvKiBFdmVudCBub3RpZmljYXRpb24gY2xh
c3NlcyBmb3IgR0VUIEVWRU5UIFNUQVRVUyBOT1RJRklDQVRJT04gKi8KKyNkZWZpbmUgR0VTTl9O
T19FVkVOVFMgICAgICAgICAgICAgICAgMAorI2RlZmluZSBHRVNOX09QRVJBVElPTkFMX0NIQU5H
RSAgICAgICAxCisjZGVmaW5lIEdFU05fUE9XRVJfTUFOQUdFTUVOVCAgICAgICAgIDIKKyNkZWZp
bmUgR0VTTl9FWFRFUk5BTF9SRVFVRVNUICAgICAgICAgMworI2RlZmluZSBHRVNOX01FRElBICAg
ICAgICAgICAgICAgICAgICA0CisjZGVmaW5lIEdFU05fTVVMVElQTEVfSE9TVFMgICAgICAgICAg
IDUKKyNkZWZpbmUgR0VTTl9ERVZJQ0VfQlVTWSAgICAgICAgICAgICAgNgorCisvKiBFdmVudCBj
b2RlcyBmb3IgTUVESUEgZXZlbnQgc3RhdHVzIG5vdGlmaWNhdGlvbiAqLworI2RlZmluZSBNRUNf
Tk9fQ0hBTkdFICAgICAgICAgICAgICAgICAwCisjZGVmaW5lIE1FQ19FSkVDVF9SRVFVRVNURUQg
ICAgICAgICAgIDEKKyNkZWZpbmUgTUVDX05FV19NRURJQSAgICAgICAgICAgICAgICAgMgorI2Rl
ZmluZSBNRUNfTUVESUFfUkVNT1ZBTCAgICAgICAgICAgICAzIC8qIG9ubHkgZm9yIG1lZGlhIGNo
YW5nZXJzICovCisjZGVmaW5lIE1FQ19NRURJQV9DSEFOR0VEICAgICAgICAgICAgIDQgLyogb25s
eSBmb3IgbWVkaWEgY2hhbmdlcnMgKi8KKyNkZWZpbmUgTUVDX0JHX0ZPUk1BVF9DT01QTEVURUQg
ICAgICAgNSAvKiBNUlcgb3IgRFZEK1JXIGIvZyBmb3JtYXQgY29tcGxldGVkICovCisjZGVmaW5l
IE1FQ19CR19GT1JNQVRfUkVTVEFSVEVEICAgICAgIDYgLyogTVJXIG9yIERWRCtSVyBiL2cgZm9y
bWF0IHJlc3RhcnRlZCAqLworCisjZGVmaW5lIE1TX1RSQVlfT1BFTiAgICAgICAgICAgICAgICAg
IDEKKyNkZWZpbmUgTVNfTUVESUFfUFJFU0VOVCAgICAgICAgICAgICAgMgorCisvKgorICogQmFz
ZWQgb24gdmFsdWVzIGZyb20gPGxpbnV4L2Nkcm9tLmg+IGJ1dCBleHRlbmRpbmcgQ0RfTUlOUwor
ICogdG8gdGhlIG1heGltdW0gY29tbW9uIHNpemUgYWxsb3dlZCBieSB0aGUgT3JhbmdlJ3MgQm9v
ayBBVElQCisgKgorICogOTAgYW5kIDk5IG1pbiBDRHMgYXJlIGFsc28gYXZhaWxhYmxlIGJ1dCB1
c2luZyB0aGVtIGFzIHRoZQorICogdXBwZXIgbGltaXQgcmVkdWNlcyB0aGUgZWZmZWN0aXZlbmVz
cyBvZiB0aGUgaGV1cmlzdGljIHRvCisgKiBkZXRlY3QgRFZEcyBidXJuZWQgdG8gbGVzcyB0aGFu
IDI1JSBvZiB0aGVpciBtYXhpbXVtIGNhcGFjaXR5CisgKi8KKworLyogU29tZSBnZW5lcmFsbHkg
dXNlZnVsIENELVJPTSBpbmZvcm1hdGlvbiAqLworI2RlZmluZSBDRF9NSU5TICAgICAgICAgICAg
ICAgICAgICAgICA4MCAvKiBtYXguIG1pbnV0ZXMgcGVyIENEICovCisjZGVmaW5lIENEX1NFQ1Mg
ICAgICAgICAgICAgICAgICAgICAgIDYwIC8qIHNlY29uZHMgcGVyIG1pbnV0ZSAqLworI2RlZmlu
ZSBDRF9GUkFNRVMgICAgICAgICAgICAgICAgICAgICA3NSAvKiBmcmFtZXMgcGVyIHNlY29uZCAq
LworI2RlZmluZSBDRF9GUkFNRVNJWkUgICAgICAgICAgICAgICAgMjA0OCAvKiBieXRlcyBwZXIg
ZnJhbWUsICJjb29rZWQiIG1vZGUgKi8KKyNkZWZpbmUgQ0RfTUFYX0JZVEVTICAgICAgIChDRF9N
SU5TICogQ0RfU0VDUyAqIENEX0ZSQU1FUyAqIENEX0ZSQU1FU0laRSkKKyNkZWZpbmUgQ0RfTUFY
X1NFQ1RPUlMgICAgIChDRF9NQVhfQllURVMgLyA1MTIpCisKKy8qCisgKiBUaGUgTU1DIHZhbHVl
cyBhcmUgbm90IElERSBzcGVjaWZpYyBhbmQgbWlnaHQgbmVlZCB0byBiZSBtb3ZlZAorICogdG8g
YSBjb21tb24gaGVhZGVyIGlmIHRoZXkgYXJlIGFsc28gbmVlZGVkIGZvciB0aGUgU0NTSSBlbXVs
YXRpb24KKyAqLworCisvKiBQcm9maWxlIGxpc3QgZnJvbSBNTUMtNiByZXZpc2lvbiAxIHRhYmxl
IDkxICovCisjZGVmaW5lIE1NQ19QUk9GSUxFX05PTkUgICAgICAgICAgICAgICAgMHgwMDAwCisj
ZGVmaW5lIE1NQ19QUk9GSUxFX0NEX1JPTSAgICAgICAgICAgICAgMHgwMDA4CisjZGVmaW5lIE1N
Q19QUk9GSUxFX0NEX1IgICAgICAgICAgICAgICAgMHgwMDA5CisjZGVmaW5lIE1NQ19QUk9GSUxF
X0NEX1JXICAgICAgICAgICAgICAgMHgwMDBBCisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9ST00g
ICAgICAgICAgICAgMHgwMDEwCisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9SX1NSICAgICAgICAg
ICAgMHgwMDExCisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9SQU0gICAgICAgICAgICAgMHgwMDEy
CisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9SV19STyAgICAgICAgICAgMHgwMDEzCisjZGVmaW5l
IE1NQ19QUk9GSUxFX0RWRF9SV19TUiAgICAgICAgICAgMHgwMDE0CisjZGVmaW5lIE1NQ19QUk9G
SUxFX0RWRF9SX0RMX1NSICAgICAgICAgMHgwMDE1CisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9S
X0RMX0pSICAgICAgICAgMHgwMDE2CisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9SV19ETCAgICAg
ICAgICAgMHgwMDE3CisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9ERFIgICAgICAgICAgICAgMHgw
MDE4CisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9QTFVTX1JXICAgICAgICAgMHgwMDFBCisjZGVm
aW5lIE1NQ19QUk9GSUxFX0RWRF9QTFVTX1IgICAgICAgICAgMHgwMDFCCisjZGVmaW5lIE1NQ19Q
Uk9GSUxFX0RWRF9QTFVTX1JXX0RMICAgICAgMHgwMDJBCisjZGVmaW5lIE1NQ19QUk9GSUxFX0RW
RF9QTFVTX1JfREwgICAgICAgMHgwMDJCCisjZGVmaW5lIE1NQ19QUk9GSUxFX0JEX1JPTSAgICAg
ICAgICAgICAgMHgwMDQwCisjZGVmaW5lIE1NQ19QUk9GSUxFX0JEX1JfU1JNICAgICAgICAgICAg
MHgwMDQxCisjZGVmaW5lIE1NQ19QUk9GSUxFX0JEX1JfUlJNICAgICAgICAgICAgMHgwMDQyCisj
ZGVmaW5lIE1NQ19QUk9GSUxFX0JEX1JFICAgICAgICAgICAgICAgMHgwMDQzCisjZGVmaW5lIE1N
Q19QUk9GSUxFX0hERFZEX1JPTSAgICAgICAgICAgMHgwMDUwCisjZGVmaW5lIE1NQ19QUk9GSUxF
X0hERFZEX1IgICAgICAgICAgICAgMHgwMDUxCisjZGVmaW5lIE1NQ19QUk9GSUxFX0hERFZEX1JB
TSAgICAgICAgICAgMHgwMDUyCisjZGVmaW5lIE1NQ19QUk9GSUxFX0hERFZEX1JXICAgICAgICAg
ICAgMHgwMDUzCisjZGVmaW5lIE1NQ19QUk9GSUxFX0hERFZEX1JfREwgICAgICAgICAgMHgwMDU4
CisjZGVmaW5lIE1NQ19QUk9GSUxFX0hERFZEX1JXX0RMICAgICAgICAgMHgwMDVBCisjZGVmaW5l
IE1NQ19QUk9GSUxFX0lOVkFMSUQgICAgICAgICAgICAgMHhGRkZGCisKKyNlbmRpZgotLSAKMi4x
Ny4xCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpTcGlj
ZS1kZXZlbCBtYWlsaW5nIGxpc3QKU3BpY2UtZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0
dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vc3BpY2UtZGV2ZWw=
