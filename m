Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 2C9617AA65
	for <lists+spice-devel@lfdr.de>; Tue, 30 Jul 2019 15:59:57 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 9977F6E529;
	Tue, 30 Jul 2019 13:59:55 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 0F67A6E528
 for <spice-devel@lists.freedesktop.org>; Tue, 30 Jul 2019 13:59:54 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx01.intmail.prod.int.phx2.redhat.com
 [10.5.11.11])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id A80A43082120;
 Tue, 30 Jul 2019 13:59:53 +0000 (UTC)
Received: from colo-mx.corp.redhat.com
 (colo-mx01.intmail.prod.int.phx2.redhat.com [10.5.11.20])
 by smtp.corp.redhat.com (Postfix) with ESMTPS id 9A408601A1;
 Tue, 30 Jul 2019 13:59:53 +0000 (UTC)
Received: from zmail25.collab.prod.int.phx2.redhat.com
 (zmail25.collab.prod.int.phx2.redhat.com [10.5.83.31])
 by colo-mx.corp.redhat.com (Postfix) with ESMTP id 8EB0218089C8;
 Tue, 30 Jul 2019 13:59:53 +0000 (UTC)
Date: Tue, 30 Jul 2019 09:59:53 -0400 (EDT)
From: Frediano Ziglio <fziglio@redhat.com>
To: Yuri Benditovich <yuri.benditovich@daynix.com>
Message-ID: <1522914548.3511381.1564495193504.JavaMail.zimbra@redhat.com>
In-Reply-To: <CAOEp5OfDHLcfLL4z7QtH7iUvB3Ldk+ASZjkyVevAgr6rm5C0Uw@mail.gmail.com>
References: <20190724105351.13753-1-yuri.benditovich@daynix.com>
 <20190724105351.13753-9-yuri.benditovich@daynix.com>
 <1039725951.3474044.1564483429122.JavaMail.zimbra@redhat.com>
 <CAOEp5OfDHLcfLL4z7QtH7iUvB3Ldk+ASZjkyVevAgr6rm5C0Uw@mail.gmail.com>
MIME-Version: 1.0
X-Originating-IP: [10.33.32.10, 10.4.195.9]
Thread-Topic: usb-redir: add implementation of emulated CD device
Thread-Index: OkCH/1AtIewYfzLzXimMvXJqgzjxJQ==
X-Scanned-By: MIMEDefang 2.79 on 10.5.11.11
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16
 (mx1.redhat.com [10.5.110.42]); Tue, 30 Jul 2019 13:59:53 +0000 (UTC)
Subject: Re: [Spice-devel] [spice-gtk 8/9] usb-redir: add implementation of
 emulated CD device
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Yan Vugenfirer <yan@daynix.com>,
 Spice List <spice-devel@lists.freedesktop.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

PiAKPiBPbiBUdWUsIEp1bCAzMCwgMjAxOSBhdCAxOjQzIFBNIEZyZWRpYW5vIFppZ2xpbyA8Znpp
Z2xpb0ByZWRoYXQuY29tPiB3cm90ZToKPiA+Cj4gPiA+Cj4gPiA+IFRoaXMgbW9kdWxlIGNvbnRh
aW5zIGltcGxlbWVudGF0aW9uIG9mIGVtdWxhdGVkIGRldmljZQo+ID4gPiBpbnRlcmZhY2UgZm9y
IHNoYXJlZCBDRC4KPiA+ID4KPiA+ID4gU2lnbmVkLW9mZi1ieTogWXVyaSBCZW5kaXRvdmljaCA8
eXVyaS5iZW5kaXRvdmljaEBkYXluaXguY29tPgo+ID4gPiAtLS0KPiA+ID4gIHNyYy91c2ItZGV2
aWNlLWNkLmMgfCA3OTQgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr
KysKPiA+ID4gIDEgZmlsZSBjaGFuZ2VkLCA3OTQgaW5zZXJ0aW9ucygrKQo+ID4gPiAgY3JlYXRl
IG1vZGUgMTAwNjQ0IHNyYy91c2ItZGV2aWNlLWNkLmMKPiA+ID4KPiA+ID4gZGlmZiAtLWdpdCBh
L3NyYy91c2ItZGV2aWNlLWNkLmMgYi9zcmMvdXNiLWRldmljZS1jZC5jCj4gPiA+IG5ldyBmaWxl
IG1vZGUgMTAwNjQ0Cj4gPiA+IGluZGV4IDAwMDAwMDAuLjE4ZGJjZWEKPiA+ID4gLS0tIC9kZXYv
bnVsbAo+ID4gPiArKysgYi9zcmMvdXNiLWRldmljZS1jZC5jCj4gPiA+IEBAIC0wLDAgKzEsNzk0
IEBACj4gPiA+ICsvKiAtKi0gTW9kZTogQzsgYy1iYXNpYy1vZmZzZXQ6IDQ7IGluZGVudC10YWJz
LW1vZGU6IG5pbCAtKi0gKi8KPiA+ID4gKy8qCj4gPiA+ICsgICAgQ29weXJpZ2h0IChDKSAyMDE5
IFJlZCBIYXQsIEluYy4KPiA+ID4gKwo+ID4gPiArICAgIFJlZCBIYXQgQXV0aG9yczoKPiA+ID4g
KyAgICBZdXJpIEJlbmRpdG92aWNoPHliZW5kaXRvQHJlZGhhdC5jb20+Cj4gPiA+ICsKPiA+ID4g
KyAgICBUaGlzIGxpYnJhcnkgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUg
aXQgYW5kL29yCj4gPiA+ICsgICAgbW9kaWZ5IGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05V
IExlc3NlciBHZW5lcmFsIFB1YmxpYwo+ID4gPiArICAgIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5
IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlcgo+ID4gPiArICAgIHZlcnNpb24g
Mi4xIG9mIHRoZSBMaWNlbnNlLCBvciAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9u
Lgo+ID4gPiArCj4gPiA+ICsgICAgVGhpcyBsaWJyYXJ5IGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBo
b3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCj4gPiA+ICsgICAgYnV0IFdJVEhPVVQgQU5ZIFdB
UlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKPiA+ID4gKyAgICBN
RVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUg
dGhlIEdOVQo+ID4gPiArICAgIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3Jl
IGRldGFpbHMuCj4gPiA+ICsKPiA+ID4gKyAgICBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBj
b3B5IG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCj4gPiA+ICsgICAgTGljZW5zZSBh
bG9uZyB3aXRoIHRoaXMgbGlicmFyeTsgaWYgbm90LCBzZWUKPiA+ID4gPGh0dHA6Ly93d3cuZ251
Lm9yZy9saWNlbnNlcy8+Lgo+ID4gPiArKi8KPiA+ID4gKwo+ID4gPiArI2luY2x1ZGUgImNvbmZp
Zy5oIgo+ID4gPiArCj4gPiA+ICsjaWZkZWYgVVNFX1VTQlJFRElSCj4gPiA+ICsKPiA+ID4gKyNp
bmNsdWRlIDxnbGliLW9iamVjdC5oPgo+ID4gPiArI2luY2x1ZGUgPGludHR5cGVzLmg+Cj4gPiA+
ICsjaW5jbHVkZSA8Z2lvL2dpby5oPgo+ID4gPiArI2luY2x1ZGUgPGdsaWIvZ2kxOG4tbGliLmg+
Cj4gPiA+ICsjaW5jbHVkZSA8ZXJybm8uaD4KPiA+ID4gKyNpbmNsdWRlIDxsaWJ1c2IuaD4KPiA+
ID4gKyNpbmNsdWRlIDxmY250bC5oPgo+ID4gPiArCj4gPiA+ICsjaWZkZWYgR19PU19XSU4zMgo+
ID4gPiArI2luY2x1ZGUgPHdpbmRvd3MuaD4KPiA+ID4gKyNpbmNsdWRlIDxudGRkY2RybS5oPgo+
ID4gPiArI2luY2x1ZGUgPG50ZGRtbWMuaD4KPiA+ID4gKyNlbHNlCj4gPiA+ICsjaW5jbHVkZSA8
c3lzL3N0YXQuaD4KPiA+ID4gKyNpbmNsdWRlIDxzeXMvaW9jdGwuaD4KPiA+ID4gKyNpbmNsdWRl
IDxsaW51eC9mcy5oPgo+ID4gPiArI2luY2x1ZGUgPGxpbnV4L2Nkcm9tLmg+Cj4gPiA+ICsjZW5k
aWYKPiA+ID4gKwo+ID4gPiArI2luY2x1ZGUgInVzYi1lbXVsYXRpb24uaCIKPiA+ID4gKyNpbmNs
dWRlICJjZC11c2ItYnVsay1tc2QuaCIKPiA+ID4gKwo+ID4gPiArdHlwZWRlZiBzdHJ1Y3QgU3Bp
Y2VDZExVCj4gPiA+ICt7Cj4gPiA+ICsgICAgY2hhciAqZmlsZW5hbWU7Cj4gPiA+ICsgICAgR0Zp
bGUgKmZpbGVfb2JqZWN0Owo+ID4gPiArICAgIEdGaWxlSW5wdXRTdHJlYW0gKnN0cmVhbTsKPiA+
ID4gKyAgICB1aW50NjRfdCBzaXplOwo+ID4gPiArICAgIHVpbnQzMl90IGJsb2NrU2l6ZTsKPiA+
ID4gKyAgICB1aW50MzJfdCBsb2FkZWQgOiAxOwo+ID4gPiArICAgIHVpbnQzMl90IGRldmljZSA6
IDE7Cj4gPiA+ICt9IFNwaWNlQ2RMVTsKPiA+ID4gKwo+ID4gPiArI2RlZmluZSBNQVhfTFVOX1BF
Ul9ERVZJQ0UgICAgICAgICAgICAgIDEKPiA+ID4gKyNkZWZpbmUgVVNCMl9CQ0QgICAgICAgICAg
ICAgICAgICAgICAgICAweDIwMAo+ID4gPiArI2RlZmluZSBDRF9ERVZfVklEICAgICAgICAgICAg
ICAgICAgICAgIDB4MmIyMwo+ID4gPiArI2RlZmluZSBDRF9ERVZfUElEICAgICAgICAgICAgICAg
ICAgICAgIDB4Q0RDRAo+ID4KPiA+IFdoZXJlIHRoZXNlIHZhbHVlcyBjYW1lPyBMYXRlciB5b3Ug
YXJlIHN0YXRpbmcgdmVuZG9yCj4gPiBpcyAiUmVkIEhhdCIgYnV0IFJlZCBIYXQgaXMgMHgxYjM2
IGFuZCBRdW1yYW5ldCBpcyAweDFhZjQuCj4gPiBBcmUgdGhlc2UgdGVtcG9yYXJ5IHZhbHVlcz8K
PiAKPiBJIHN1cHBvc2UgeW91IG1lYW4gUENJIHZlbmRvciBJRHMuIFVTQiBvbmUgY29tZSBmcm9t
IGFub3RoZXIgc291cmNlLgo+IGh0dHBzOi8vYnVnemlsbGEucmVkaGF0LmNvbS9zaG93X2J1Zy5j
Z2k/aWQ9MTEzMjMzMAo+IAoKT2ssIHdvcnRoIGEgbWVudGlvbiBmb3IgdGhlIFZJRC4KQW5kIHRo
ZSBQSUQgPyBXYXMgdGhpcyAweENEQ0QgcmVnaXN0ZXJlZCBzb21laG93PwoKPiA+Cj4gPiA+ICsj
ZGVmaW5lIENEX0RFVl9DTEFTUyAgICAgICAgICAgICAgICAgICAgOAo+ID4gPiArI2RlZmluZSBD
RF9ERVZfU1VCQ0xBU1MgICAgICAgICAgICAgICAgIDYKPiA+ID4gKyNkZWZpbmUgQ0RfREVWX1BS
T1RPQ09MICAgICAgICAgICAgICAgICAweDUwCj4gPiA+ICsjZGVmaW5lIENEX0RFVl9CTE9DS19T
SVpFICAgICAgICAgICAgICAgMHgyMDAKPiA+Cj4gPiBJIGRpZG4ndCBleHBlY3RlZCB0aGlzLiBJ
IHRob3VnaCBhbGwgQ0RzIHdlcmUgMjA0OCBzZWN0b3Igc2l6ZWQuCj4gCj4gQXMgZmFyIGFzIEkg
cmVtZW1iZXIsIEkndmUgY2hlY2tlZCB0aGF0IGR1cmluZyBkZXZlbG9wbWVudCwgQ0RGUyBoYXMK
PiBzZWN0b3Igb2YgNTEyIGJ5dGVzLgo+IAo+ID4KPiA+ID4gKyNkZWZpbmUgQ0RfREVWX01BWF9T
SVpFICAgICAgICAgICAgICAgICA3MzcyODAwMDAKPiA+Cj4gPiBUaGlzIGlzIHVudXNlZC4gSSB3
b3VsZCByZW1vdmUgSSBzdXBwb3NlIERWRCBkZXZpY2VzIG9yIGltYWdlcwo+ID4gd29uJ3QgZml0
IGhlcmUgYW55d2F5Lgo+IAo+IFdoZW4gdGhlIHNpemUgaXMgYmlnZ2VyIHRoYW4gcmVndWxhciBD
RCBpbWFnZSwgc2VjdG9yIHNpemUgaXMgMksuCj4gQXMgZmFyIGFzIEkgcmVtZW1iZXIsIG90aGVy
IEZTIHVzZWQgaW4gdGhpcyBjYXNlIChVREYgZXRjKQo+IHdvbid0IGZpciB3aGVyZT8gVGhpcyBp
cyBDRC1EVkQgcmVhZGVyLCB3ZSB1c2VkIGl0IHdpdGggbGFyZ2UgaW1hZ2VzLgo+IAoKQSBEVkQg
Y2FuIGJlIGxhcmdlci4gQnkgdGhlIHdheSwgdGhpcyBjb25zdGFudCBpcyBub3QgdXNlZCBpbiB0
aGUgY29kZS4KCj4gPgo+ID4gPiArI2RlZmluZSBEVkRfREVWX0JMT0NLX1NJWkUgICAgICAgICAg
ICAgIDB4ODAwCj4gPiA+ICsjZGVmaW5lIE1BWF9CVUxLX0lOX1JFUVVFU1RTICAgICAgICAgICAg
NjQKPiA+ID4gKwo+ID4gPiArc3RydWN0IEJ1ZmZlcmVkQnVsa1JlYWQKPiA+ID4gK3sKPiA+ID4g
KyAgICBzdHJ1Y3QgdXNiX3JlZGlyX2J1bGtfcGFja2V0X2hlYWRlciBob3V0Owo+ID4gPiArICAg
IHVpbnQ2NF90IGlkOwo+ID4gPiArfTsKPiA+ID4gKwo+ID4gPiArc3RydWN0IF9TcGljZVVzYkVt
dWxhdGVkRGV2aWNlCj4gPiA+ICt7Cj4gPiA+ICsgICAgVXNiRGV2aWNlT3BzIGRldl9vcHM7Cj4g
PiA+ICsgICAgU3BpY2VVc2JCYWNrZW5kICpiYWNrZW5kOwo+ID4gPiArICAgIFNwaWNlVXNiQmFj
a2VuZERldmljZSAqcGFyZW50Owo+ID4gPiArICAgIHN0cnVjdCB1c2JyZWRpcnBhcnNlciAqcGFy
c2VyOwo+ID4gPiArICAgIHZvaWQgKiBtc2M7Cj4gPiA+ICsgICAgU3BpY2VDZExVIHVuaXRzW01B
WF9MVU5fUEVSX0RFVklDRV07Cj4gPiA+ICsgICAgZ2Jvb2xlYW4gbG9ja2VkOwo+ID4gPiArICAg
IGdib29sZWFuIGRlbGV0ZV9vbl9lamVjdDsKPiA+ID4gKyAgICBnYm9vbGVhbiBkZWxldGluZzsK
PiA+ID4gKyAgICB1aW50MzJfdCBudW1fcmVhZHM7Cj4gPiA+ICsgICAgc3RydWN0IEJ1ZmZlcmVk
QnVsa1JlYWQgcmVhZF9idWxrW01BWF9CVUxLX0lOX1JFUVVFU1RTXTsKPiA+ID4gKyAgICB1aW50
MTZfdCBzZXJpYWxbNF07Cj4gPgo+ID4gU3BlY2lmaWNhdGlvbnMgc3RhdGUgdGhhdCBzZXJpYWwg
c2hvdWxkIGJlIGF0IGxlYXN0IDEyIGNoYXJhY3RlcnMuCj4gCj4gV2hpY2ggc3BlY2lmaWNhdGlv
bj8gSSBkbyBub3QgcmVtZW1iZXIgaW4gVVNCIHNwZWMgc3VjaCByZXF1aXJlbWVudC4KPiAKCmh0
dHBzOi8vd3d3LnVzYi5vcmcvc2l0ZXMvZGVmYXVsdC9maWxlcy91c2JtYXNzYnVsa18xMC5wZGYK
Cj4gPgo+ID4gPiArICAgIHVpbnQ4X3QgIG1heF9sdW5faW5kZXg7Cj4gPiA+ICt9Owo+ID4gPiAr
Cj4gPiA+ICt0eXBlZGVmIFNwaWNlVXNiRW11bGF0ZWREZXZpY2UgVXNiQ2Q7Cj4gPiA+ICsKPiA+
ID4gKyNpZm5kZWYgR19PU19XSU4zMgo+ID4gPiArCj4gPiA+ICtzdGF0aWMgaW50IGNkX2Rldmlj
ZV9vcGVuX3N0cmVhbShTcGljZUNkTFUgKnVuaXQsIGNvbnN0IGNoYXIgKmZpbGVuYW1lKQo+ID4g
PiArewo+ID4gPiArICAgIGludCBlcnJvciA9IDA7Cj4gPiA+ICsgICAgdW5pdC0+ZGV2aWNlID0g
MDsKPiA+ID4gKwo+ID4gPiArICAgIGlmICghdW5pdC0+ZmlsZW5hbWUgJiYgIWZpbGVuYW1lKSB7
Cj4gPiA+ICsgICAgICAgIFNQSUNFX0RFQlVHKCIlczogZmlsZSBuYW1lIG5vdCBwcm92aWRlZCIs
IF9fRlVOQ1RJT05fXyk7Cj4gPiA+ICsgICAgICAgIHJldHVybiAtMTsKPiA+ID4gKyAgICB9Cj4g
PiA+ICsgICAgaWYgKHVuaXQtPmZpbGVuYW1lICYmIGZpbGVuYW1lKSB7Cj4gPiA+ICsgICAgICAg
IGdfZnJlZSh1bml0LT5maWxlbmFtZSk7Cj4gPiA+ICsgICAgICAgIHVuaXQtPmZpbGVuYW1lID0g
TlVMTDsKPiA+ID4gKyAgICB9Cj4gPiA+ICsgICAgaWYgKGZpbGVuYW1lKSB7Cj4gPiA+ICsgICAg
ICAgIHVuaXQtPmZpbGVuYW1lID0gZ19zdHJkdXAoZmlsZW5hbWUpOwo+ID4gPiArICAgIH0KPiA+
ID4gKwo+ID4gPiArICAgIGludCBmZCA9IG9wZW4odW5pdC0+ZmlsZW5hbWUsIE9fUkRPTkxZIHwg
T19OT05CTE9DSyk7Cj4gPiA+ICsgICAgaWYgKGZkID4gMCkgewo+ID4gPiArICAgICAgICBzdHJ1
Y3Qgc3RhdCBmaWxlX3N0YXQgPSB7IDAgfTsKPiA+ID4gKyAgICAgICAgaWYgKGZzdGF0KGZkLCAm
ZmlsZV9zdGF0KSB8fCBmaWxlX3N0YXQuc3Rfc2l6ZSA9PSAwKSB7Cj4gPiA+ICsgICAgICAgICAg
ICBmaWxlX3N0YXQuc3Rfc2l6ZSA9IDA7Cj4gPiA+ICsgICAgICAgICAgICB1bml0LT5kZXZpY2Ug
PSAxOwo+ID4gPiArICAgICAgICAgICAgaWYgKCFpb2N0bChmZCwgQkxLR0VUU0laRTY0LCAmZmls
ZV9zdGF0LnN0X3NpemUpICYmCj4gPiA+ICsgICAgICAgICAgICAgICAgIWlvY3RsKGZkLCBCTEtT
U1pHRVQsICZ1bml0LT5ibG9ja1NpemUpKSB7Cj4gPiA+ICsgICAgICAgICAgICB9Cj4gPiA+ICsg
ICAgICAgIH0KPiA+ID4gKyAgICAgICAgdW5pdC0+c2l6ZSA9IGZpbGVfc3RhdC5zdF9zaXplOwo+
ID4gPiArICAgICAgICBjbG9zZShmZCk7Cj4gPiA+ICsgICAgICAgIGlmICh1bml0LT5zaXplKSB7
Cj4gPiA+ICsgICAgICAgICAgICB1bml0LT5maWxlX29iamVjdCA9IGdfZmlsZV9uZXdfZm9yX3Bh
dGgodW5pdC0+ZmlsZW5hbWUpOwo+ID4gPiArICAgICAgICAgICAgdW5pdC0+c3RyZWFtID0gZ19m
aWxlX3JlYWQodW5pdC0+ZmlsZV9vYmplY3QsIE5VTEwsIE5VTEwpOwo+ID4gPiArICAgICAgICB9
Cj4gPiA+ICsgICAgICAgIGlmICghdW5pdC0+c3RyZWFtKSB7Cj4gPiA+ICsgICAgICAgICAgICBT
UElDRV9ERUJVRygiJXM6IGNhbid0IG9wZW4gc3RyZWFtIG9uICVzIiwgX19GVU5DVElPTl9fLAo+
ID4gPiB1bml0LT5maWxlbmFtZSk7Cj4gPiA+ICsgICAgICAgICAgICBnX29iamVjdF91bnJlZih1
bml0LT5maWxlX29iamVjdCk7Cj4gPiA+ICsgICAgICAgICAgICB1bml0LT5maWxlX29iamVjdCA9
IE5VTEw7Cj4gPiA+ICsgICAgICAgICAgICBlcnJvciA9IC0xOwo+ID4gPiArICAgICAgICB9Cj4g
PiA+ICsgICAgfQo+ID4gPiArICAgIGVsc2Ugewo+ID4gPiArICAgICAgICBTUElDRV9ERUJVRygi
JXM6IGNhbid0IG9wZW4gZmlsZSAlcyIsIF9fRlVOQ1RJT05fXywKPiA+ID4gdW5pdC0+ZmlsZW5h
bWUpOwo+ID4gPiArICAgICAgICBlcnJvciA9IC0xOwo+ID4gPiArICAgIH0KPiA+ID4gKwo+ID4g
PiArICAgIHJldHVybiBlcnJvcjsKPiA+ID4gK30KPiA+ID4gKwo+ID4gPiArc3RhdGljIGludCBj
ZF9kZXZpY2VfbG9hZChTcGljZUNkTFUgKnVuaXQsIGdib29sZWFuIGxvYWQpCj4gPiA+ICt7Cj4g
PiA+ICsgICAgaW50IGVycm9yOwo+ID4gPiArICAgIGlmICghdW5pdC0+ZGV2aWNlIHx8ICF1bml0
LT5maWxlbmFtZSkgewo+ID4gPiArICAgICAgICByZXR1cm4gLTE7Cj4gPiA+ICsgICAgfQo+ID4g
PiArICAgIGludCBmZCA9IG9wZW4odW5pdC0+ZmlsZW5hbWUsIE9fUkRPTkxZIHwgT19OT05CTE9D
Syk7Cj4gPiA+ICsgICAgaWYgKGZkIDwgMCkgewo+ID4gPiArICAgICAgICByZXR1cm4gLTE7Cj4g
PiA+ICsgICAgfQo+ID4gPiArICAgIGlmIChsb2FkKSB7Cj4gPiA+ICsgICAgICAgIGVycm9yID0g
aW9jdGwoZmQsIENEUk9NQ0xPU0VUUkFZLCAwKTsKPiA+ID4gKyAgICB9IGVsc2Ugewo+ID4gPiAr
ICAgICAgICBlcnJvciA9IGlvY3RsKGZkLCBDRFJPTV9MT0NLRE9PUiwgMCk7Cj4gPiA+ICsgICAg
ICAgIGVycm9yID0gaW9jdGwoZmQsIENEUk9NRUpFQ1QsIDApOwo+ID4gPiArICAgIH0KPiA+ID4g
KyAgICBpZiAoZXJyb3IpIHsKPiA+ID4gKyAgICAgICAgLy8gbm90ZSB0aGF0IGVqZWN0aW5nIG1p
Z2h0IGJlIGF2YWlsYWJsZSBvbmx5IGZvciByb290Cj4gPiA+ICsgICAgICAgIC8vIGxvYWRpbmcg
bWlnaHQgYmUgYXZhaWxhYmxlIGFsc28gZm9yIHJlZ3VsYXIgdXNlcgo+ID4gPiArICAgICAgICBT
UElDRV9ERUJVRygiJXM6IGNhbid0ICVzbG9hZCAlcywgcmVzICVkLCBlcnJubyAlZCIsCj4gPiA+
ICsgICAgICAgICAgICBfX0ZVTkNUSU9OX18sIGxvYWQgPyAiIiA6ICJ1biIsIHVuaXQtPmZpbGVu
YW1lLCBlcnJvciwKPiA+ID4gZXJybm8pOwo+ID4gPiArICAgIH0KPiA+ID4gKyAgICBjbG9zZShm
ZCk7Cj4gPiA+ICsgICAgcmV0dXJuIGVycm9yOwo+ID4gPiArfQo+ID4gPiArCj4gPiA+ICtzdGF0
aWMgaW50IGNkX2RldmljZV9jaGVjayhTcGljZUNkTFUgKnVuaXQpCj4gPiA+ICt7Cj4gPiA+ICsg
ICAgaW50IGVycm9yOwo+ID4gPiArICAgIGlmICghdW5pdC0+ZGV2aWNlIHx8ICF1bml0LT5maWxl
bmFtZSkgewo+ID4gPiArICAgICAgICByZXR1cm4gLTE7Cj4gPiA+ICsgICAgfQo+ID4gPiArICAg
IGludCBmZCA9IG9wZW4odW5pdC0+ZmlsZW5hbWUsIE9fUkRPTkxZIHwgT19OT05CTE9DSyk7Cj4g
PiA+ICsgICAgaWYgKGZkIDwgMCkgewo+ID4gPiArICAgICAgICByZXR1cm4gLTE7Cj4gPiA+ICsg
ICAgfQo+ID4gPiArICAgIGVycm9yID0gaW9jdGwoZmQsIENEUk9NX0RSSVZFX1NUQVRVUywgMCk7
Cj4gPiA+ICsgICAgZXJyb3IgPSAoZXJyb3IgPT0gQ0RTX0RJU0NfT0spID8gMCA6IC0xOwo+ID4g
PiArICAgIGlmICghZXJyb3IpIHsKPiA+ID4gKyAgICAgICAgZXJyb3IgPSBpb2N0bChmZCwgQ0RS
T01fRElTQ19TVEFUVVMsIDApOwo+ID4gPiArICAgICAgICBlcnJvciA9IChlcnJvciA9PSBDRFNf
REFUQV8xKSA/IDAgOiAtMTsKPiA+ID4gKyAgICB9Cj4gPiA+ICsgICAgY2xvc2UoZmQpOwo+ID4g
PiArICAgIHJldHVybiBlcnJvcjsKPiA+ID4gK30KPiA+ID4gKwo+ID4gPiArI2Vsc2UKPiA+ID4g
Kwo+ID4gPiArc3RhdGljIGdib29sZWFuIGlzX2RldmljZV9uYW1lKGNvbnN0IGNoYXIgKmZpbGVu
YW1lKQo+ID4gPiArewo+ID4gPiArICAgIGdib29sZWFuIGIgPSBzdHJsZW4oZmlsZW5hbWUpID09
IDIgJiYgZmlsZW5hbWVbMV0gPT0gJzonOwo+ID4gPiArICAgIHJldHVybiBiOwo+ID4KPiA+IEhl
cmUgIjo6IiBvciAiMDoiIGFyZSBhY2NlcHRlZC4gSSBoYXZlIGEgZm9sbG93IHVwIGZvciB0aGlz
Lgo+ID4KPiA+ID4gK30KPiA+ID4gKwo+ID4gPiArc3RhdGljIEhBTkRMRSBvcGVuX2ZpbGUoY29u
c3QgY2hhciAqZmlsZW5hbWUpCj4gPiA+ICt7Cj4gPiA+ICsgICAgSEFORExFIGggPSBDcmVhdGVG
aWxlQShmaWxlbmFtZSwKPiA+Cj4gPiBNaW5vciBidXQgbWF5YmUgd2Ugd2FudCB0byBjb252ZXJ0
IGZyb20gdXRmOCAodXN1YWxseSB1c2VkIGJ5Cj4gPiBHTGliKSB0byB1dGYxNiBhbmQgdXNlIENy
ZWF0ZUZpbGVXLgo+ID4KPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgIEdFTkVSSUNf
UkVBRCwKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgIEZJTEVfU0hBUkVfUkVBRCB8
IEZJTEVfU0hBUkVfV1JJVEUsCj4gPgo+ID4gVGhpcyB3aWxsIGFsbG93IG90aGVyIHByb2dyYW0g
dG8gY2hhbmdlIHRoZSBJU08gd2hpbGUgdGhlIHByb2dyYW0gaXMKPiA+IHJ1bm5pbmcuIElzIHRo
aXMgd2FudGVkPyBJIGtub3cgaXQncyBjb21wYXRpYmxlIHdpdGggVW5peCBzb21laG93IGJ1dAo+
ID4gSSB0aGluayB1c3VhbGx5IG9uIFdpbmRvd3MgeW91IGRvbid0IGV4cGVjdCB0aGlzLgo+ID4g
QnV0IGhvbmVzdGx5IGlzIGp1c3QgYSBtaW5vci4KPiA+Cj4gPiA+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICBOVUxMLCBPUEVOX0VYSVNUSU5HLAo+ID4gPiArICAgICAgICAgICAgICAgICAg
ICAgICAgICAgMCwKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgIE5VTEwpOwo+ID4g
PiArICAgIGlmIChoID09IElOVkFMSURfSEFORExFX1ZBTFVFKSB7Cj4gPiA+ICsgICAgICAgIGgg
PSBOVUxMOwo+ID4gPiArICAgIH0KPiA+ID4gKyAgICByZXR1cm4gaDsKPiA+ID4gK30KPiA+ID4g
Kwo+ID4gPiArc3RhdGljIHVpbnQzMl90IGlvY3RsX291dChIQU5ETEUgaCwgdWludDMyX3QgY29k
ZSwgdm9pZCAqb3V0X2J1ZmZlciwKPiA+ID4gdWludDMyX3Qgb3V0X3NpemUpCj4gPiA+ICt7Cj4g
PiA+ICsgICAgdWludDMyX3QgZXJyb3I7Cj4gPiA+ICsgICAgRFdPUkQgcmV0Owo+ID4gPiArICAg
IEJPT0wgYiA9IERldmljZUlvQ29udHJvbChoLCBjb2RlLCBOVUxMLCAwLCBvdXRfYnVmZmVyLCBv
dXRfc2l6ZSwKPiA+ID4gJnJldCwKPiA+ID4gTlVMTCk7Cj4gPiA+ICsgICAgZXJyb3IgPSBiID8g
MCA6IEdldExhc3RFcnJvcigpOwo+ID4gPiArICAgIHJldHVybiBlcnJvcjsKPiA+ID4gK30KPiA+
ID4gKwo+ID4gPiArc3RhdGljIHVpbnQzMl90IGlvY3RsX25vbmUoSEFORExFIGgsIHVpbnQzMl90
IGNvZGUpCj4gPiA+ICt7Cj4gPiA+ICsgICAgcmV0dXJuIGlvY3RsX291dChoLCBjb2RlLCBOVUxM
LCAwKTsKPiA+ID4gK30KPiA+ID4gKwo+ID4gPiArc3RhdGljIGdib29sZWFuIGNoZWNrX2Rldmlj
ZShIQU5ETEUgaCkKPiA+ID4gK3sKPiA+ID4gKyAgICBHRVRfQ09ORklHVVJBVElPTl9JT0NUTF9J
TlBVVCBjZmdJbiA9Cj4gPiA+ICsgICAgICAgIHsgRmVhdHVyZUNkUmVhZCwgU0NTSV9HRVRfQ09O
RklHVVJBVElPTl9SRVFVRVNUX1RZUEVfQUxMLCB7fSB9Owo+ID4gPiArICAgIERXT1JEIHJldDsK
PiA+ID4gKyAgICBHRVRfQ09ORklHVVJBVElPTl9IRUFERVIgY2ZnT3V0Owo+ID4gPiArICAgIHJl
dHVybiBEZXZpY2VJb0NvbnRyb2woaCwgSU9DVExfQ0RST01fR0VUX0NPTkZJR1VSQVRJT04sCj4g
PiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAmY2ZnSW4sIHNpemVvZihjZmdJbiksICZj
ZmdPdXQsCj4gPiA+IHNpemVvZihjZmdPdXQpLAo+ID4gPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgJnJldCwgTlVMTCk7Cj4gPiA+ICt9Cj4gPiA+ICsKPiA+ID4gK3N0YXRpYyBpbnQgY2Rf
ZGV2aWNlX29wZW5fc3RyZWFtKFNwaWNlQ2RMVSAqdW5pdCwgY29uc3QgY2hhciAqZmlsZW5hbWUp
Cj4gPiA+ICt7Cj4gPiA+ICsgICAgaW50IGVycm9yID0gMDsKPiA+ID4gKyAgICBIQU5ETEUgaDsK
PiA+ID4gKyAgICB1bml0LT5kZXZpY2UgPSAwOwo+ID4gPiArICAgIGlmICghdW5pdC0+ZmlsZW5h
bWUgJiYgIWZpbGVuYW1lKSB7Cj4gPiA+ICsgICAgICAgIFNQSUNFX0RFQlVHKCIlczogdW5uYW1l
ZCBmaWxlIiwgX19GVU5DVElPTl9fKTsKPiA+ID4gKyAgICAgICAgcmV0dXJuIC0xOwo+ID4gPiAr
ICAgIH0KPiA+ID4gKyAgICBpZiAodW5pdC0+ZmlsZW5hbWUgJiYgZmlsZW5hbWUpIHsKPiA+ID4g
KyAgICAgICAgZ19mcmVlKHVuaXQtPmZpbGVuYW1lKTsKPiA+ID4gKyAgICAgICAgdW5pdC0+Zmls
ZW5hbWUgPSBOVUxMOwo+ID4gPiArICAgIH0KPiA+ID4gKyAgICBpZiAoIWZpbGVuYW1lKSB7Cj4g
PiA+ICsgICAgICAgIC8vIHJlb3BlbmluZyB0aGUgc3RyZWFtIG9uIGV4aXN0aW5nIGZpbGUgbmFt
ZQo+ID4gPiArICAgIH0gZWxzZSBpZiAoaXNfZGV2aWNlX25hbWUoZmlsZW5hbWUpKSB7Cj4gPiA+
ICsgICAgICAgIHVuaXQtPmZpbGVuYW1lID0gZ19zdHJkdXBfcHJpbnRmKCJcXFxcLlxcJXMiLCBm
aWxlbmFtZSk7Cj4gPiA+ICsgICAgfSBlbHNlIHsKPiA+ID4gKyAgICAgICAgdW5pdC0+ZmlsZW5h
bWUgPSBnX3N0cmR1cChmaWxlbmFtZSk7Cj4gPiA+ICsgICAgfQo+ID4gPiArICAgIGggPSBvcGVu
X2ZpbGUodW5pdC0+ZmlsZW5hbWUpOwo+ID4gPiArICAgIGlmIChoKSB7Cj4gPiA+ICsgICAgICAg
IExBUkdFX0lOVEVHRVIgc2l6ZSA9IHsgMCB9Owo+ID4gPiArICAgICAgICBpZiAoIUdldEZpbGVT
aXplRXgoaCwgJnNpemUpKSB7Cj4gPiA+ICsgICAgICAgICAgICB1aW50NjRfdCBidWZmZXJbMjU2
XTsKPiA+ID4gKyAgICAgICAgICAgIHVpbnQzMl90IHJlczsKPiA+ID4gKyAgICAgICAgICAgIHVu
aXQtPmRldmljZSA9IGNoZWNrX2RldmljZShoKTsKPiA+ID4gKyAgICAgICAgICAgIFNQSUNFX0RF
QlVHKCIlczogQ0QgZGV2aWNlICVzcmVjb2duaXplZCBvbiAlcyIsCj4gPiA+ICsgICAgICAgICAg
ICAgICAgX19GVU5DVElPTl9fLCB1bml0LT5kZXZpY2UgPyAiIiA6ICJOT1QgIiwKPiA+ID4gdW5p
dC0+ZmlsZW5hbWUpOwo+ID4gPiArICAgICAgICAgICAgcmVzID0gaW9jdGxfb3V0KGgsIElPQ1RM
X0RJU0tfR0VUX0RSSVZFX0dFT01FVFJZX0VYLAo+ID4gPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGJ1ZmZlciwgc2l6ZW9mKGJ1ZmZlcikpOwo+ID4gPiArICAgICAgICAgICAgaWYgKCFy
ZXMpCj4gPiA+ICsgICAgICAgICAgICB7Cj4gPiA+ICsgICAgICAgICAgICAgICAgRElTS19HRU9N
RVRSWV9FWCAqcGcgPSAoRElTS19HRU9NRVRSWV9FWCAqKWJ1ZmZlcjsKPiA+ID4gKyAgICAgICAg
ICAgICAgICB1bml0LT5ibG9ja1NpemUgPSBwZy0+R2VvbWV0cnkuQnl0ZXNQZXJTZWN0b3I7Cj4g
PiA+ICsgICAgICAgICAgICAgICAgc2l6ZSA9IHBnLT5EaXNrU2l6ZTsKPiA+ID4gKyAgICAgICAg
ICAgIH0gZWxzZSB7Cj4gPiA+ICsgICAgICAgICAgICAgICAgU1BJQ0VfREVCVUcoIiVzOiBjYW4n
dCBvYnRhaW4gc2l6ZSBvZiAlcyAoZXJyb3IgJXUpIiwKPiA+ID4gKyAgICAgICAgICAgICAgICAg
ICAgX19GVU5DVElPTl9fLCB1bml0LT5maWxlbmFtZSwgcmVzKTsKPiA+ID4gKyAgICAgICAgICAg
IH0KPiA+ID4gKyAgICAgICAgfQo+ID4gPiArICAgICAgICB1bml0LT5zaXplID0gc2l6ZS5RdWFk
UGFydDsKPiA+ID4gKyAgICAgICAgQ2xvc2VIYW5kbGUoaCk7Cj4gPiA+ICsgICAgICAgIGlmICh1
bml0LT5zaXplKSB7Cj4gPiA+ICsgICAgICAgICAgICB1bml0LT5maWxlX29iamVjdCA9IGdfZmls
ZV9uZXdfZm9yX3BhdGgodW5pdC0+ZmlsZW5hbWUpOwo+ID4gPiArICAgICAgICAgICAgdW5pdC0+
c3RyZWFtID0gZ19maWxlX3JlYWQodW5pdC0+ZmlsZV9vYmplY3QsIE5VTEwsIE5VTEwpOwo+ID4g
PiArICAgICAgICB9Cj4gPiA+ICsgICAgICAgIGlmICghdW5pdC0+c3RyZWFtKSB7Cj4gPiA+ICsg
ICAgICAgICAgICBTUElDRV9ERUJVRygiJXM6IGNhbid0IG9wZW4gc3RyZWFtIG9uICVzIiwgX19G
VU5DVElPTl9fLAo+ID4gPiB1bml0LT5maWxlbmFtZSk7Cj4gPiA+ICsgICAgICAgICAgICBnX29i
amVjdF91bnJlZih1bml0LT5maWxlX29iamVjdCk7Cj4gPiA+ICsgICAgICAgICAgICB1bml0LT5m
aWxlX29iamVjdCA9IE5VTEw7Cj4gPiA+ICsgICAgICAgICAgICBlcnJvciA9IC0xOwo+ID4gPiAr
ICAgICAgICB9Cj4gPiA+ICsgICAgfSBlbHNlIHsKPiA+ID4gKyAgICAgICAgU1BJQ0VfREVCVUco
IiVzOiBjYW4ndCBvcGVuIGZpbGUgJXMiLCBfX0ZVTkNUSU9OX18sCj4gPiA+IHVuaXQtPmZpbGVu
YW1lKTsKPiA+ID4gKyAgICAgICAgZXJyb3IgPSAtMTsKPiA+ID4gKyAgICB9Cj4gPiA+ICsgICAg
cmV0dXJuIGVycm9yOwo+ID4gPiArfQo+ID4gPiArCj4gPiA+ICtzdGF0aWMgaW50IGNkX2Rldmlj
ZV9sb2FkKFNwaWNlQ2RMVSAqdW5pdCwgZ2Jvb2xlYW4gbG9hZCkKPiA+ID4gK3sKPiA+ID4gKyAg
ICBpbnQgZXJyb3IgPSAwOwo+ID4gPiArICAgIEhBTkRMRSBoOwo+ID4gPiArICAgIGlmICghdW5p
dC0+ZGV2aWNlIHx8ICF1bml0LT5maWxlbmFtZSkgewo+ID4gPiArICAgICAgICByZXR1cm4gLTE7
Cj4gPiA+ICsgICAgfQo+ID4gPiArICAgIGggPSBvcGVuX2ZpbGUodW5pdC0+ZmlsZW5hbWUpOwo+
ID4gPiArICAgIGlmIChoKSB7Cj4gPiA+ICsgICAgICAgIHVpbnQzMl90IHJlcyA9IGlvY3RsX25v
bmUoaCwgbG9hZCA/IElPQ1RMX1NUT1JBR0VfTE9BRF9NRURJQSA6Cj4gPiA+IElPQ1RMX1NUT1JB
R0VfRUpFQ1RfTUVESUEpOwo+ID4gPiArICAgICAgICBpZiAocmVzKSB7Cj4gPiA+ICsgICAgICAg
ICAgICBTUElDRV9ERUJVRygiJXM6IGNhbid0ICVzbG9hZCAlcywgd2luIGVycm9yICV1IiwKPiA+
ID4gKyAgICAgICAgICAgICAgICAgICAgICAgIF9fRlVOQ1RJT05fXywgbG9hZCA/ICIiIDogInVu
IiwgdW5pdC0+ZmlsZW5hbWUsCj4gPiA+IHJlcyk7Cj4gPiA+ICsgICAgICAgICAgICBlcnJvciA9
IC0xOwo+ID4gPiArICAgICAgICB9IGVsc2Ugewo+ID4gPiArICAgICAgICAgICAgU1BJQ0VfREVC
VUcoIiVzOiBkZXZpY2UgJXMgWyVzXSIsCj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICBf
X0ZVTkNUSU9OX18sIGxvYWQgPyAibG9hZGVkIiA6ICJlamVjdGVkIiwKPiA+ID4gdW5pdC0+Zmls
ZW5hbWUpOwo+ID4gPiArICAgICAgICB9Cj4gPiA+ICsgICAgICAgIENsb3NlSGFuZGxlKGgpOwo+
ID4gPiArICAgIH0KPiA+ID4gKyAgICByZXR1cm4gZXJyb3I7Cj4gPiA+ICt9Cj4gPiA+ICsKPiA+
ID4gK3N0YXRpYyBpbnQgY2RfZGV2aWNlX2NoZWNrKFNwaWNlQ2RMVSAqdW5pdCkKPiA+ID4gK3sK
PiA+ID4gKyAgICBpbnQgZXJyb3IgPSAwOwo+ID4gPiArICAgIENEUk9NX0RJU0tfREFUQSBkYXRh
Owo+ID4gPiArICAgIEhBTkRMRSBoOwo+ID4gPiArICAgIGlmICghdW5pdC0+ZGV2aWNlIHx8ICF1
bml0LT5maWxlbmFtZSkgewo+ID4gPiArICAgICAgICByZXR1cm4gLTE7Cj4gPiA+ICsgICAgfQo+
ID4gPiArICAgIGggPSBvcGVuX2ZpbGUodW5pdC0+ZmlsZW5hbWUpOwo+ID4gPiArICAgIGlmICho
KSB7Cj4gPiA+ICsgICAgICAgIHVpbnQzMl90IHJlcyA9IGlvY3RsX25vbmUoaCwgSU9DVExfU1RP
UkFHRV9DSEVDS19WRVJJRlkpOwo+ID4gPiArICAgICAgICBpZiAoIXJlcykgewo+ID4gPiArICAg
ICAgICAgICAgcmVzID0gaW9jdGxfb3V0KGgsIElPQ1RMX0NEUk9NX0RJU0tfVFlQRSwgJmRhdGEs
Cj4gPiA+IHNpemVvZihkYXRhKSk7Cj4gPiA+ICsgICAgICAgIH0KPiA+ID4gKyAgICAgICAgaWYg
KHJlcyAhPSAwIHx8IGRhdGEuRGlza0RhdGEgIT0gQ0RST01fRElTS19EQVRBX1RSQUNLKSB7Cj4g
PiA+ICsgICAgICAgICAgICBlcnJvciA9IC0xOwo+ID4gPiArICAgICAgICB9Cj4gPiA+ICsgICAg
ICAgIENsb3NlSGFuZGxlKGgpOwo+ID4gPiArICAgIH0KPiA+ID4gKyAgICByZXR1cm4gZXJyb3I7
Cj4gPiA+ICt9Cj4gPiA+ICsKPiA+ID4gKyNlbmRpZgo+ID4gPiArCj4gPiA+ICtzdGF0aWMgZ2Jv
b2xlYW4gb3Blbl9zdHJlYW0oU3BpY2VDZExVICp1bml0LCBjb25zdCBjaGFyICpmaWxlbmFtZSkK
PiA+ID4gK3sKPiA+ID4gKyAgICBnYm9vbGVhbiBiID0gRkFMU0U7Cj4gPiA+ICsgICAgYiA9IGNk
X2RldmljZV9vcGVuX3N0cmVhbSh1bml0LCBmaWxlbmFtZSkgPT0gMDsKPiA+ID4gKyAgICByZXR1
cm4gYjsKPiA+ID4gK30KPiA+ID4gKwo+ID4gPiArc3RhdGljIHZvaWQgY2xvc2Vfc3RyZWFtKFNw
aWNlQ2RMVSAqdW5pdCkKPiA+ID4gK3sKPiA+ID4gKyAgICBpZiAodW5pdC0+c3RyZWFtKSB7Cj4g
PiA+ICsgICAgICAgIGdfb2JqZWN0X3VucmVmKHVuaXQtPnN0cmVhbSk7Cj4gPiA+ICsgICAgICAg
IHVuaXQtPnN0cmVhbSA9IE5VTEw7Cj4gPiA+ICsgICAgfQo+ID4gPiArICAgIGlmICh1bml0LT5m
aWxlX29iamVjdCkgewo+ID4gPiArICAgICAgICBnX29iamVjdF91bnJlZih1bml0LT5maWxlX29i
amVjdCk7Cj4gPiA+ICsgICAgICAgIHVuaXQtPmZpbGVfb2JqZWN0ID0gTlVMTDsKPiA+ID4gKyAg
ICB9Cj4gPiA+ICt9Cj4gPiA+ICsKPiA+ID4gK3N0YXRpYyBnYm9vbGVhbiBsb2FkX2x1bihVc2JD
ZCAqZCwgaW50IHVuaXQsIGdib29sZWFuIGxvYWQpCj4gPiA+ICt7Cj4gPiA+ICsgICAgZ2Jvb2xl
YW4gYiA9IFRSVUU7Cj4gPiA+ICsgICAgaWYgKGxvYWQgJiYgZC0+dW5pdHNbdW5pdF0uZGV2aWNl
KSB7Cj4gPiA+ICsgICAgICAgIC8vIHRoZXJlIGlzIG9uZSBwb3NzaWJsZSBwcm9ibGVtIGluIGNh
c2Ugb3VyIGJhY2tlbmQgaXMgdGhlCj4gPiA+ICsgICAgICAgIC8vIGxvY2FsIENEIGRldmljZSBh
bmQgaXQgaXMgZWplY3RlZAo+ID4gPiArICAgICAgICBjZF9kZXZpY2VfbG9hZCgmZC0+dW5pdHNb
dW5pdF0sIFRSVUUpOwo+ID4gPiArICAgICAgICBjbG9zZV9zdHJlYW0oJmQtPnVuaXRzW3VuaXRd
KTsKPiA+ID4gKyAgICAgICAgaWYgKGNkX2RldmljZV9jaGVjaygmZC0+dW5pdHNbdW5pdF0pIHx8
Cj4gPiA+ICFvcGVuX3N0cmVhbSgmZC0+dW5pdHNbdW5pdF0sIE5VTEwpKSB7Cj4gPiA+ICsgICAg
ICAgICAgICByZXR1cm4gRkFMU0U7Cj4gPiA+ICsgICAgICAgIH0KPiA+ID4gKyAgICB9Cj4gPiA+
ICsKPiA+ID4gKyAgICBpZiAobG9hZCkgewo+ID4gPiArICAgICAgICBDZFNjc2lNZWRpYVBhcmFt
ZXRlcnMgbWVkaWFfcGFyYW1zID0geyAwIH07Cj4gPiA+ICsKPiA+ID4gKyAgICAgICAgbWVkaWFf
cGFyYW1zLnN0cmVhbSA9IGQtPnVuaXRzW3VuaXRdLnN0cmVhbTsKPiA+ID4gKyAgICAgICAgbWVk
aWFfcGFyYW1zLnNpemUgPSBkLT51bml0c1t1bml0XS5zaXplOwo+ID4gPiArICAgICAgICBtZWRp
YV9wYXJhbXMuYmxvY2tfc2l6ZSA9IGQtPnVuaXRzW3VuaXRdLmJsb2NrU2l6ZTsKPiA+ID4gKyAg
ICAgICAgaWYgKG1lZGlhX3BhcmFtcy5ibG9ja19zaXplID09IENEX0RFVl9CTE9DS19TSVpFICYm
Cj4gPiA+ICsgICAgICAgICAgICBtZWRpYV9wYXJhbXMuc2l6ZSAlIERWRF9ERVZfQkxPQ0tfU0la
RSA9PSAwKSB7Cj4gPiA+ICsgICAgICAgICAgICBtZWRpYV9wYXJhbXMuYmxvY2tfc2l6ZSA9IERW
RF9ERVZfQkxPQ0tfU0laRTsKPiA+ID4gKyAgICAgICAgfQo+ID4gPiArICAgICAgICBTUElDRV9E
RUJVRygiJXM6IGxvYWRpbmcgJXMsIHNpemUgJSIgUFJJdTY0ICIsIGJsb2NrICV1IiwKPiA+ID4g
KyAgICAgICAgICAgICAgICAgICAgX19GVU5DVElPTl9fLCBkLT51bml0c1t1bml0XS5maWxlbmFt
ZSwKPiA+ID4gbWVkaWFfcGFyYW1zLnNpemUsIG1lZGlhX3BhcmFtcy5ibG9ja19zaXplKTsKPiA+
ID4gKwo+ID4gPiArICAgICAgICBiID0gIWNkX3VzYl9idWxrX21zZF9sb2FkKGQtPm1zYywgdW5p
dCwgJm1lZGlhX3BhcmFtcyk7Cj4gPiA+ICsKPiA+ID4gKyAgICAgICAgZC0+dW5pdHNbdW5pdF0u
bG9hZGVkID0gISFiOwo+ID4gPiArCj4gPiA+ICsgICAgfSBlbHNlIHsKPiA+ID4gKyAgICAgICAg
U1BJQ0VfREVCVUcoIiVzOiB1bmxvYWRpbmcgJXMiLCBfX0ZVTkNUSU9OX18sCj4gPiA+IGQtPnVu
aXRzW3VuaXRdLmZpbGVuYW1lKTsKPiA+ID4gKyAgICAgICAgY2RfdXNiX2J1bGtfbXNkX3VubG9h
ZChkLT5tc2MsIHVuaXQpOwo+ID4gPiArICAgICAgICBkLT51bml0c1t1bml0XS5sb2FkZWQgPSBG
QUxTRTsKPiA+ID4gKyAgICB9Cj4gPiA+ICsgICAgcmV0dXJuIGI7Cj4gPiA+ICt9Cj4gPiA+ICsK
PiA+ID4gK3N0YXRpYyB2b2lkIHVzYl9jZF9kZWxldGUoVXNiQ2QgKmQpCj4gPiA+ICt7Cj4gPiA+
ICsgICAgdWludDMyX3QgdW5pdCA9IDA7Cj4gPgo+ID4gV2h5IHVuaXQgaXMgYWx3YXlzIDA/IEhl
cmUgYW5kIGluIG90aGVyIHBsYWNlcy4KPiA+IE1heWJlIHdvcnRoIGFkZGluZyBhIG1uZW1vbmlj
Pwo+IAo+IEJlY2F1c2UgY3VycmVudGx5IHdlIGRlZmluZSB0aGUgZGV2aWNlIGFzIHNpbmdsZS11
bml0Lgo+IEJ1dCB0aGUgY29kZSBvZiBNU0QvU0NTSSBpbiBnZW5lcmFsIHN1cHBvcnRzIG11bHRp
cGxlIHVuaXRzLgo+IAo+ID4KPiA+ID4gKyAgICBjZF91c2JfYnVsa19tc2RfdW5yZWFsaXplKGQt
Pm1zYywgdW5pdCk7Cj4gPiA+ICsgICAgZ19jbGVhcl9wb2ludGVyKCZkLT51bml0c1t1bml0XS5m
aWxlbmFtZSwgZ19mcmVlKTsKPiA+ID4gKyAgICBjbG9zZV9zdHJlYW0oJmQtPnVuaXRzW3VuaXRd
KTsKPiA+ID4gKyAgICBnX2NsZWFyX3BvaW50ZXIoJmQtPm1zYywgY2RfdXNiX2J1bGtfbXNkX2Zy
ZWUpOwo+ID4gPiArICAgIGdfZnJlZShkKTsKPiA+ID4gK30KPiA+ID4gKwo+ID4gPiArc3RhdGlj
IGdib29sZWFuIHVzYl9jZF9nZXRfZGVzY3JpcHRvcihVc2JDZCAqZCwgdWludDhfdCB0eXBlLCB1
aW50OF90Cj4gPiA+IGluZGV4LAo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB2b2lkICoqYnVmZmVyLCB1aW50MTZfdCAqc2l6ZSkKPiA+ID4gK3sKPiA+ID4gKyAg
ICBzdGF0aWMgc3RydWN0IGxpYnVzYl9kZXZpY2VfZGVzY3JpcHRvciBkZXNjID0KPiA+ID4gKyAg
ICB7Cj4gPiA+ICsgICAgICAgIC5iTGVuZ3RoID0gMTgsCj4gPiA+ICsgICAgICAgIC5iRGVzY3Jp
cHRvclR5cGUgPSBMSUJVU0JfRFRfREVWSUNFLAo+ID4gPiArICAgICAgICAuYmNkVVNCID0gVVNC
Ml9CQ0QsCj4gPiA+ICsgICAgICAgIC5iRGV2aWNlQ2xhc3MgPSAwLAo+ID4gPiArICAgICAgICAu
YkRldmljZVN1YkNsYXNzID0gMCwKPiA+ID4gKyAgICAgICAgLmJEZXZpY2VQcm90b2NvbCA9IDAs
Cj4gPiA+ICsgICAgICAgIC5iTWF4UGFja2V0U2l6ZTAgPSA2NCwKPiA+ID4gKyAgICAgICAgLmlk
VmVuZG9yID0gQ0RfREVWX1ZJRCwKPiA+ID4gKyAgICAgICAgLmlkUHJvZHVjdCA9IENEX0RFVl9Q
SUQsCj4gPiA+ICsgICAgICAgIC5iY2REZXZpY2UgPSAweDEwMCwKPiA+ID4gKyAgICAgICAgLmlN
YW51ZmFjdHVyZXIgPSAxLAo+ID4gPiArICAgICAgICAuaVByb2R1Y3QgPSAyLAo+ID4gPiArICAg
ICAgICAuaVNlcmlhbE51bWJlciA9IDMsCj4gPiA+ICsgICAgICAgIC5iTnVtQ29uZmlndXJhdGlv
bnMgPSAxCj4gPiA+ICsgICAgfTsKPiA+Cj4gPiBTbyBhcmUgd2UgZXhwZWN0aW5nIHRoZSBjYWxs
ZXIgdG8gYmUgYWJsZSB0byBjaGFuZ2UgdGhlc2Ugc3RhdGljCj4gPiBzdHJ1Y3R1cmVzPwo+ID4g
Qm90aCBmdW5jdGlvbiBkZWNsYXJhdGlvbiBhbmQgZGF0YSBvbmVzIGFyZSBzdWdnZXN0aW5nIGl0
Lgo+ID4KPiA+ID4gKyAgICBzdGF0aWMgdWludDhfdCBjZmdbXSA9Cj4gPiA+ICsgICAgewo+ID4g
PiArICAgICAgICA5LCAvL2xlbiBvZiBjZmcgZGVzYwo+ID4gPiArICAgICAgICBMSUJVU0JfRFRf
Q09ORklHLCAvLyBkZXNjIHR5cGUKPiA+ID4gKyAgICAgICAgMHgyMCwgLy8gd2xlbgo+ID4gPiAr
ICAgICAgICAwLAo+ID4gPiArICAgICAgICAxLCAvLyBudW0gaWYKPiA+ID4gKyAgICAgICAgMSwg
Ly8gY2ZnIHZhbAo+ID4gPiArICAgICAgICAwLCAvLyBjZmcgbmFtZQo+ID4gPiArICAgICAgICAw
eDgwLCAvLyBidXMgcG93ZXJlZAo+ID4gPiArICAgICAgICAweDMyLCAvLyAxMDAgbWEKPiA+ID4g
KyAgICAgICAgOSwgLy8gbGVuIG9mIElGIGRlc2MKPiA+ID4gKyAgICAgICAgTElCVVNCX0RUX0lO
VEVSRkFDRSwKPiA+ID4gKyAgICAgICAgMCwgLy8gbnVtIGlmCj4gPiA+ICsgICAgICAgIDAsIC8v
IGFsdCBzZXR0aW5nCj4gPiA+ICsgICAgICAgIDIsIC8vIG51bSBvZiBlbmRwb2ludHMKPiA+ID4g
KyAgICAgICAgQ0RfREVWX0NMQVNTLAo+ID4gPiArICAgICAgICBDRF9ERVZfU1VCQ0xBU1MsCj4g
PiA+ICsgICAgICAgIENEX0RFVl9QUk9UT0NPTCwKPiA+ID4gKyAgICAgICAgMCwgLy8gaWYgbmFt
ZQo+ID4gPiArICAgICAgICA3LAo+ID4gPiArICAgICAgICBMSUJVU0JfRFRfRU5EUE9JTlQsCj4g
PiA+ICsgICAgICAgIDB4ODEsIC8vLT5EaXJlY3Rpb24gOiBJTiAtIEVuZHBvaW50SUQgOiAxCj4g
PiA+ICsgICAgICAgIDB4MDIsIC8vLT5CdWxrIFRyYW5zZmVyIFR5cGUKPiA+ID4gKyAgICAgICAg
MCwgICAgLy93TWF4UGFja2V0U2l6ZSA6IDB4MDIwMCA9IDB4MjAwIG1heCBieXRlcwo+ID4gPiAr
ICAgICAgICAyLAo+ID4gPiArICAgICAgICAwLCAgICAvL2JJbnRlcnZhbAo+ID4gPiArICAgICAg
ICA3LAo+ID4gPiArICAgICAgICBMSUJVU0JfRFRfRU5EUE9JTlQsCj4gPiA+ICsgICAgICAgIDB4
MDIsIC8vLT5EaXJlY3Rpb24gOiBPVVQgLSBFbmRwb2ludElEIDogMgo+ID4gPiArICAgICAgICAw
eDAyLCAvLy0+QnVsayBUcmFuc2ZlciBUeXBlCj4gPiA+ICsgICAgICAgIDAsICAgIC8vd01heFBh
Y2tldFNpemUgOiAweDAyMDAgPSAweDIwMCBtYXggYnl0ZXMKPiA+ID4gKyAgICAgICAgMiwKPiA+
ID4gKyAgICAgICAgMCwgICAgLy9iSW50ZXJ2YWwKPiA+ID4gKyAgICB9Owo+ID4gPiArICAgIHN0
YXRpYyB1aW50MTZfdCBzMFsyXSA9IHsgMHgzMDQsIDB4NDA5IH07Cj4gPiA+ICsgICAgc3RhdGlj
IHVpbnQxNl90IHMxWzhdID0geyAweDMxMCwgJ1InLCAnZScsICdkJywgJyAnLCAnSCcsICdhJywg
J3QnCj4gPiA+IH07Cj4gPiA+ICsgICAgc3RhdGljIHVpbnQxNl90IHMyWzldID0geyAweDMxMiwg
J1MnLCAncCcsICdpJywgJ2MnLCAnZScsICcgJywgJ0MnLAo+ID4gPiAnRCcKPiA+Cj4gPiBNaW5v
cjogdGhlc2Ugd2lsbCB3b3JrIG9ubHkgb24gbGl0dGxlIGVuZGlhbiwgbm90IGEgYmlnIGlzc3Vl
IGF0IHRoZSBtb21lbnQKPiA+IGJ1dAo+ID4gSSBzYXcgb3RoZXIgY29kZSBkZWFsaW5nIHdpdGgg
YmlnIGVuZGlhbiBtYWNoaW5lcy4KPiA+Cj4gQ3VycmVudGx5IEkgZG8gbm90IGhhdmUgYW55IHBv
c3NpYmlsaXR5IHRvIHRlc3QgdGhlIGNvZGUgb24gYmlnLWVuZGlhbgo+IG1hY2hpbmUuCj4gCj4g
PiA+IH07Cj4gPiA+ICsKPiA+ID4gKyAgICB2b2lkICpwID0gTlVMTDsKPiA+ID4gKyAgICB1aW50
MTZfdCBsZW4gPSAwOwo+ID4gPiArCj4gPiA+ICsgICAgc3dpdGNoICh0eXBlKQo+ID4gPiArICAg
IHsKPiA+ID4gKyAgICAgICAgY2FzZSBMSUJVU0JfRFRfREVWSUNFOgo+ID4gPiArICAgICAgICAg
ICAgcCA9ICZkZXNjOwo+ID4gPiArICAgICAgICAgICAgbGVuID0gc2l6ZW9mKGRlc2MpOwo+ID4g
PiArICAgICAgICAgICAgYnJlYWs7Cj4gPiA+ICsgICAgICAgIGNhc2UgTElCVVNCX0RUX0NPTkZJ
RzoKPiA+ID4gKyAgICAgICAgICAgIHAgPSBjZmc7Cj4gPiA+ICsgICAgICAgICAgICBsZW4gPSBz
aXplb2YoY2ZnKTsKPiA+ID4gKyAgICAgICAgICAgIGJyZWFrOwo+ID4gPiArICAgICAgICBjYXNl
IExJQlVTQl9EVF9TVFJJTkc6Cj4gPiA+ICsgICAgICAgICAgICBpZiAoaW5kZXggPT0gMCkgewo+
ID4gPiArICAgICAgICAgICAgICAgIHAgPSBzMDsgbGVuID0gc2l6ZW9mKHMwKTsKPiA+ID4gKyAg
ICAgICAgICAgIH0gZWxzZSBpZiAoaW5kZXggPT0gMSkgewo+ID4gPiArICAgICAgICAgICAgICAg
IHAgPSBzMTsgbGVuID0gc2l6ZW9mKHMxKTsKPiA+ID4gKyAgICAgICAgICAgIH0gZWxzZSBpZiAo
aW5kZXggPT0gMikgewo+ID4gPiArICAgICAgICAgICAgICAgIHAgPSBzMjsgbGVuID0gc2l6ZW9m
KHMyKTsKPiA+ID4gKyAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5kZXggPT0gMykgewo+ID4gPiAr
ICAgICAgICAgICAgICAgIHAgPSBkLT5zZXJpYWw7IGxlbiA9IHNpemVvZihkLT5zZXJpYWwpOwo+
ID4gPiArICAgICAgICAgICAgfQo+ID4gPiArICAgICAgICAgICAgYnJlYWs7Cj4gPiA+ICsgICAg
fQo+ID4gPiArCj4gPiA+ICsgICAgaWYgKHApIHsKPiA+ID4gKyAgICAgICAgKmJ1ZmZlciA9IHA7
Cj4gPiA+ICsgICAgICAgICpzaXplID0gbGVuOwo+ID4gPiArICAgIH0KPiA+ID4gKwo+ID4gPiAr
ICAgIHJldHVybiBwICE9IE5VTEw7Cj4gPiA+ICt9Cj4gPiA+ICsKPiA+ID4gK3N0YXRpYyB2b2lk
IHVzYl9jZF9hdHRhY2goVXNiQ2QgKmRldmljZSwgc3RydWN0IHVzYnJlZGlycGFyc2VyICpwYXJz
ZXIpCj4gPiA+ICt7Cj4gPiA+ICsgICAgZGV2aWNlLT5wYXJzZXIgPSBwYXJzZXI7Cj4gPiA+ICt9
Cj4gPiA+ICsKPiA+ID4gK3N0YXRpYyB2b2lkIHVzYl9jZF9kZXRhY2goVXNiQ2QgKmRldmljZSkK
PiA+ID4gK3sKPiA+ID4gKyAgICBkZXZpY2UtPnBhcnNlciA9IE5VTEw7Cj4gPiA+ICt9Cj4gPiA+
ICsKPiA+ID4gK3N0YXRpYyB2b2lkIHVzYl9jZF9yZXNldChVc2JDZCAqZGV2aWNlKQo+ID4gPiAr
ewo+ID4gPiArICAgIGNkX3VzYl9idWxrX21zZF9yZXNldChkZXZpY2UtPm1zYyk7Cj4gPiA+ICt9
Cj4gPiA+ICsKPiA+ID4gK3N0YXRpYyB2b2lkIHVzYl9jZF9jb250cm9sX3JlcXVlc3QoVXNiQ2Qg
KmRldmljZSwKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDhf
dCAqZGF0YSwgaW50IGRhdGFfbGVuLAo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBzdHJ1Y3QKPiA+ID4gdXNiX3JlZGlyX2NvbnRyb2xfcGFja2V0X2hlYWRlcgo+ID4g
PiAqaCwKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdm9pZCAqKmJ1
ZmZlcikKPiA+ID4gK3sKPiA+ID4gKyAgICB1aW50OF90IHJlcXR5cGUgPSBoLT5yZXF1ZXN0dHlw
ZSAmIDB4N2Y7Cj4gPiA+ICsgICAgaWYgKCFkZXZpY2UtPm1zYykgewo+ID4gPiArICAgICAgICBy
ZXR1cm47Cj4gPiA+ICsgICAgfQo+ID4gPiArICAgIGlmIChyZXF0eXBlID09IChMSUJVU0JfUkVR
VUVTVF9UWVBFX1NUQU5EQVJEIHwKPiA+ID4gTElCVVNCX1JFQ0lQSUVOVF9FTkRQT0lOVCkpIHsK
PiA+ID4gKyAgICAgICAgLy8gbWlnaHQgYmUgY2xlYXIgc3RhbGwgcmVxdWVzdAo+ID4gPiArICAg
ICAgICBoLT5sZW5ndGggPSAwOwo+ID4gPiArICAgICAgICBoLT5zdGF0dXMgPSB1c2JfcmVkaXJf
c3VjY2Vzczs7Cj4gPiA+ICsgICAgICAgIHJldHVybjsKPiA+ID4gKyAgICB9Cj4gPiA+ICsKPiA+
ID4gKyAgICBpZiAocmVxdHlwZSA9PSAoTElCVVNCX1JFUVVFU1RfVFlQRV9DTEFTUyB8Cj4gPiA+
IExJQlVTQl9SRUNJUElFTlRfSU5URVJGQUNFKSkKPiA+ID4gewo+ID4gPiArICAgICAgICBzd2l0
Y2ggKGgtPnJlcXVlc3QpIHsKPiA+ID4gKyAgICAgICAgICAgIGNhc2UgMHhGRjoKPiA+ID4gKyAg
ICAgICAgICAgICAgICAvLyBtYXNzLXN0b3JhZ2UgY2xhc3MgcmVxdWVzdCAncmVzZXQnCj4gPiA+
ICsgICAgICAgICAgICAgICAgdXNiX2NkX3Jlc2V0KGRldmljZSk7Cj4gPiA+ICsgICAgICAgICAg
ICAgICAgaC0+bGVuZ3RoID0gMDsKPiA+ID4gKyAgICAgICAgICAgICAgICBoLT5zdGF0dXMgPSB1
c2JfcmVkaXJfc3VjY2VzczsKPiA+ID4gKyAgICAgICAgICAgICAgICBicmVhazsKPiA+ID4gKyAg
ICAgICAgICAgIGNhc2UgMHhGRToKPiA+ID4gKyAgICAgICAgICAgICAgICAvLyBtYXNzLXN0b3Jh
Z2UgY2xhc3MgcmVxdWVzdCAnZ2V0IG1heCBsdW4nCj4gPiA+ICsgICAgICAgICAgICAgICAgLy8g
cmV0dXJuaW5nIG9uZSBieXRlCj4gPiA+ICsgICAgICAgICAgICAgICAgaWYgKGgtPmxlbmd0aCkg
ewo+ID4gPiArICAgICAgICAgICAgICAgICAgICBoLT5sZW5ndGggPSAxOwo+ID4gPiArICAgICAg
ICAgICAgICAgICAgICBoLT5zdGF0dXMgPSB1c2JfcmVkaXJfc3VjY2Vzczs7Cj4gPiA+ICsgICAg
ICAgICAgICAgICAgICAgICpidWZmZXIgPSAmZGV2aWNlLT5tYXhfbHVuX2luZGV4Owo+ID4gPiAr
ICAgICAgICAgICAgICAgIH0KPiA+ID4gKyAgICAgICAgICAgICAgICBicmVhazsKPiA+ID4gKyAg
ICAgICAgfQo+ID4gPiArICAgIH0KPiA+ID4gK30KPiA+ID4gKwo+ID4gPiArc3RhdGljIHZvaWQg
dXNiX2NkX2J1bGtfb3V0X3JlcXVlc3QoVXNiQ2QgKmRldmljZSwKPiA+ID4gKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQ4X3QgZXAsIHVpbnQ4X3QgKmRhdGEsIGludAo+
ID4gPiBkYXRhX2xlbiwKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHVpbnQ4X3QgKnN0YXR1cykKPiA+ID4gK3sKPiA+ID4gKyAgICBpZiAoIWNkX3VzYl9idWxrX21z
ZF93cml0ZShkZXZpY2UtPm1zYywgZGF0YSwgZGF0YV9sZW4pKSB7Cj4gPiA+ICsgICAgICAgICpz
dGF0dXMgPSB1c2JfcmVkaXJfc3VjY2VzczsKPiA+ID4gKyAgICB9Cj4gPiA+ICt9Cj4gPiA+ICsK
PiA+ID4gK3ZvaWQgY2RfdXNiX2J1bGtfbXNkX3JlYWRfY29tcGxldGUodm9pZCAqdXNlcl9kYXRh
LAo+ID4gPiArICAgIHVpbnQ4X3QgKmRhdGEsIHVpbnQzMl90IGxlbmd0aCwgQ2RVc2JCdWxrU3Rh
dHVzIHN0YXR1cykKPiA+ID4gK3sKPiA+ID4gKyAgICBVc2JDZCAqZCA9IChVc2JDZCAqKXVzZXJf
ZGF0YTsKPiA+ID4gKwo+ID4gPiArICAgIGlmIChkLT5kZWxldGluZykgewo+ID4gPiArICAgICAg
ICBkLT5kZWxldGluZyA9IEZBTFNFOwo+ID4gPiArICAgICAgICBzcGljZV91c2JfYmFja2VuZF9k
ZXZpY2VfZWplY3QoZC0+YmFja2VuZCwgZC0+cGFyZW50KTsKPiA+Cj4gPiBJIHdvdWxkIHBsYWNl
IGEgcmV0dXJuIGFmdGVyIHRoaXMsIHRoZSBwYXJlbnQgaXMgZGVsZXRlZCBhbmQgcG90ZW50aWFs
bHkKPiA+IGFsbCB0aGlzIHN0cnVjdHVyZSB0b28uCj4gCj4gTm9ib2R5IGlzIGRlbGV0ZWQsIGp1
c3QgaW5kaWNhdGlvbiBpc3N1ZWQgYW5kIHRoZSBkZWxldGUgd2lsbCBoYXBwZW4KPiBvbiBuZXh0
IGlkbGUuCj4gV2UgbmVlZCB0byByZXNwb25kIHRoZSBVU0IgcmVxdWVzdC4KPiAKPiA+Cj4gPiA+
ICsgICAgfQo+ID4gPiArCj4gPiA+ICsgICAgaWYgKGQtPnBhcnNlcikgewo+ID4gPiArICAgICAg
ICBpbnQgbnJlYWQ7Cj4gPiA+ICsgICAgICAgIHVpbnQzMl90IG9mZnNldCA9IDA7Cj4gPiA+ICsK
PiA+ID4gKyAgICAgICAgZm9yIChucmVhZCA9IDA7IG5yZWFkIDwgZC0+bnVtX3JlYWRzOyBucmVh
ZCsrKSB7Cj4gPiA+ICsgICAgICAgICAgICB1aW50MzJfdCBtYXhfbGVuOwo+ID4gPiArICAgICAg
ICAgICAgbWF4X2xlbiA9IChkLT5yZWFkX2J1bGtbbnJlYWRdLmhvdXQubGVuZ3RoX2hpZ2ggPDwg
MTYpIHwKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgIGQtPnJlYWRfYnVsa1tucmVhZF0u
aG91dC5sZW5ndGg7Cj4gPiA+ICsgICAgICAgICAgICBpZiAobWF4X2xlbiA+IGxlbmd0aCkgewo+
ID4gPiArICAgICAgICAgICAgICAgIG1heF9sZW4gPSBsZW5ndGg7Cj4gPiA+ICsgICAgICAgICAg
ICAgICAgZC0+cmVhZF9idWxrW25yZWFkXS5ob3V0Lmxlbmd0aCA9IGxlbmd0aDsKPiA+ID4gKyAg
ICAgICAgICAgICAgICBkLT5yZWFkX2J1bGtbbnJlYWRdLmhvdXQubGVuZ3RoX2hpZ2ggPSBsZW5n
dGggPj4gMTY7Cj4gPiA+ICsgICAgICAgICAgICB9Cj4gPiA+ICsKPiA+ID4gKyAgICAgICAgICAg
IHN3aXRjaCAoc3RhdHVzKSB7Cj4gPiA+ICsgICAgICAgICAgICBjYXNlIEJVTEtfU1RBVFVTX0dP
T0Q6Cj4gPiA+ICsgICAgICAgICAgICAgICAgZC0+cmVhZF9idWxrW25yZWFkXS5ob3V0LnN0YXR1
cyA9IHVzYl9yZWRpcl9zdWNjZXNzOwo+ID4gPiArICAgICAgICAgICAgICAgIGJyZWFrOwo+ID4g
PiArICAgICAgICAgICAgY2FzZSBCVUxLX1NUQVRVU19DQU5DRUxFRDoKPiA+ID4gKyAgICAgICAg
ICAgICAgICBkLT5yZWFkX2J1bGtbbnJlYWRdLmhvdXQuc3RhdHVzID0gdXNiX3JlZGlyX2NhbmNl
bGxlZDsKPiA+ID4gKyAgICAgICAgICAgICAgICBicmVhazsKPiA+ID4gKyAgICAgICAgICAgIGNh
c2UgQlVMS19TVEFUVVNfRVJST1I6Cj4gPiA+ICsgICAgICAgICAgICAgICAgZC0+cmVhZF9idWxr
W25yZWFkXS5ob3V0LnN0YXR1cyA9IHVzYl9yZWRpcl9pb2Vycm9yOwo+ID4gPiArICAgICAgICAg
ICAgICAgIGJyZWFrOwo+ID4gPiArICAgICAgICAgICAgY2FzZSBCVUxLX1NUQVRVU19TVEFMTDoK
PiA+ID4gKyAgICAgICAgICAgIGRlZmF1bHQ6Cj4gPiA+ICsgICAgICAgICAgICAgICAgZC0+cmVh
ZF9idWxrW25yZWFkXS5ob3V0LnN0YXR1cyA9IHVzYl9yZWRpcl9zdGFsbDsKPiA+ID4gKyAgICAg
ICAgICAgICAgICBicmVhazsKPiA+ID4gKyAgICAgICAgICAgIH0KPiA+ID4gKwo+ID4gPiArICAg
ICAgICAgICAgU1BJQ0VfREVCVUcoIiVzOiByZXNwb25kaW5nICUiIFBSSXU2NCAiIHdpdGggbGVu
ICV1IG91dCBvZgo+ID4gPiAldSwKPiA+ID4gc3RhdHVzICVkIiwKPiA+ID4gKyAgICAgICAgICAg
ICAgICAgICAgICAgIF9fRlVOQ1RJT05fXywgZC0+cmVhZF9idWxrW25yZWFkXS5pZCwgbWF4X2xl
biwKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgIGxlbmd0aCwgZC0+cmVhZF9idWxrW25y
ZWFkXS5ob3V0LnN0YXR1cyk7Cj4gPiA+ICsgICAgICAgICAgICB1c2JyZWRpcnBhcnNlcl9zZW5k
X2J1bGtfcGFja2V0KGQtPnBhcnNlciwKPiA+ID4gZC0+cmVhZF9idWxrW25yZWFkXS5pZCwKPiA+
ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJmQtPnJlYWRf
YnVsa1tucmVhZF0uaG91dCwKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgbWF4X2xlbiA/IChkYXRhICsgb2Zmc2V0KSA6Cj4gPiA+IE5VTEwsCj4gPiA+
ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heF9sZW4pOwo+
ID4gPiArICAgICAgICAgICAgb2Zmc2V0ICs9IG1heF9sZW47Cj4gPiA+ICsgICAgICAgICAgICBs
ZW5ndGggLT0gbWF4X2xlbjsKPiA+ID4gKyAgICAgICAgfQo+ID4gPiArICAgICAgICBkLT5udW1f
cmVhZHMgPSAwOwo+ID4gPiArICAgICAgICB1c2JyZWRpcnBhcnNlcl9kb193cml0ZShkLT5wYXJz
ZXIpOwo+ID4gPiArCj4gPiA+ICsgICAgICAgIGlmIChsZW5ndGgpIHsKPiA+ID4gKyAgICAgICAg
ICAgIFNQSUNFX0RFQlVHKCIlczogRVJST1I6ICV1IGJ5dGVzIHdlcmUgbm90IHJlcG9ydGVkISIs
Cj4gPiA+IF9fRlVOQ1RJT05fXywgbGVuZ3RoKTsKPiA+ID4gKyAgICAgICAgfQo+ID4gPiArCj4g
PiA+ICsgICAgfSBlbHNlIHsKPiA+ID4gKyAgICAgICAgU1BJQ0VfREVCVUcoIiVzOiBicm9rZW4g
ZGV2aWNlPC0+Y2hhbm5lbCByZWxhdGlvbnNoaXAhIiwKPiA+ID4gX19GVU5DVElPTl9fKTsKPiA+
ID4gKyAgICB9Cj4gPiA+ICt9Cj4gPiA+ICsKPiA+ID4gKy8qIGRldmljZSByZXNldCBjb21wbGV0
aW9uIGNhbGxiYWNrICovCj4gPiA+ICt2b2lkIGNkX3VzYl9idWxrX21zZF9yZXNldF9jb21wbGV0
ZSh2b2lkICp1c2VyX2RhdGEsIGludCBzdGF0dXMpCj4gPiA+ICt7Cj4gPiA+ICsgICAgLy8gVXNi
Q2QgKmQgPSAoVXNiQ2QgKil1c2VyX2RhdGE7Cj4gPiA+ICt9Cj4gPiA+ICsKPiA+ID4gK3N0YXRp
YyBnYm9vbGVhbiB1c2JfY2RfYnVsa19pbl9yZXF1ZXN0KFVzYkNkICpkLCB1aW50NjRfdCBpZCwK
PiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHVzYl9yZWRp
cl9idWxrX3BhY2tldF9oZWFkZXIKPiA+ID4gKmgpCj4gPiA+ICt7Cj4gPiA+ICsgICAgaW50IHJl
czsKPiA+ID4gKyAgICB1aW50MzJfdCBsZW4gPSAoaC0+bGVuZ3RoX2hpZ2ggPDwgMTYpIHwgaC0+
bGVuZ3RoOwo+ID4gPiArICAgIGlmIChkLT5udW1fcmVhZHMgPj0gTUFYX0JVTEtfSU5fUkVRVUVT
VFMpIHsKPiA+ID4gKyAgICAgICAgaC0+bGVuZ3RoID0gaC0+bGVuZ3RoX2hpZ2ggPSAwOwo+ID4g
PiArICAgICAgICBTUElDRV9ERUJVRygiJXM6IHRvbyBtYW55IHBlbmRpbmcgcmVhZHMiLCBfX0ZV
TkNUSU9OX18pOwo+ID4gPiArICAgICAgICBoLT5zdGF0dXMgPSB1c2JfcmVkaXJfYmFiYmxlOwo+
ID4gPiArICAgICAgICByZXR1cm4gRkFMU0U7Cj4gPiA+ICsgICAgfQo+ID4gPiArCj4gPiA+ICsg
ICAgaWYgKGQtPm51bV9yZWFkcykgewo+ID4gPiArICAgICAgICBTUElDRV9ERUJVRygiJXM6IGFs
cmVhZHkgaGFzICV1IHBlbmRpbmcgcmVhZHMiLCBfX0ZVTkNUSU9OX18sCj4gPiA+IGQtPm51bV9y
ZWFkcyk7Cj4gPiA+ICsgICAgfQo+ID4gPiArCj4gPiA+ICsgICAgZC0+cmVhZF9idWxrW2QtPm51
bV9yZWFkc10uaG91dCA9ICpoOwo+ID4gPiArICAgIGQtPnJlYWRfYnVsa1tkLT5udW1fcmVhZHNd
LmlkID0gaWQ7Cj4gPiA+ICsgICAgZC0+bnVtX3JlYWRzKys7Cj4gPiA+ICsgICAgcmVzID0gY2Rf
dXNiX2J1bGtfbXNkX3JlYWQoZC0+bXNjLCBsZW4pOwo+ID4gPiArICAgIGlmICghcmVzKSB7Cj4g
PiA+ICsgICAgICAgIHJldHVybiBUUlVFOwo+ID4gPiArICAgIH0KPiA+ID4gKwo+ID4gPiArICAg
IFNQSUNFX0RFQlVHKCIlczogZXJyb3Igb24gYnVsayByZWFkIiwgX19GVU5DVElPTl9fKTsKPiA+
ID4gKyAgICBkLT5udW1fcmVhZHMtLTsKPiA+ID4gKyAgICBoLT5sZW5ndGggPSBoLT5sZW5ndGhf
aGlnaCA9IDA7Cj4gPiA+ICsgICAgaC0+c3RhdHVzID0gdXNiX3JlZGlyX2lvZXJyb3I7Cj4gPiA+
ICsKPiA+ID4gKyAgICByZXR1cm4gRkFMU0U7Cj4gPiA+ICt9Cj4gPiA+ICsKPiA+ID4gK3N0YXRp
YyB2b2lkIHVzYl9jZF9jYW5jZWxfcmVxdWVzdChVc2JDZCAqZCwgdWludDY0X3QgaWQpCj4gPiA+
ICt7Cj4gPiA+ICsgICAgdWludDMyX3QgbnJlYWQ7Cj4gPiA+ICsKPiA+ID4gKyAgICBmb3IgKG5y
ZWFkID0gMDsgbnJlYWQgPCBkLT5udW1fcmVhZHM7IG5yZWFkKyspIHsKPiA+ID4gKyAgICAgICAg
aWYgKGQtPnJlYWRfYnVsa1tucmVhZF0uaWQgPT0gaWQpIHsKPiA+ID4gKyAgICAgICAgICAgIGlm
IChjZF91c2JfYnVsa19tc2RfY2FuY2VsX3JlYWQoZC0+bXNjKSkgewo+ID4gPiArICAgICAgICAg
ICAgICAgIGNkX3VzYl9idWxrX21zZF9yZWFkX2NvbXBsZXRlKGQsIE5VTEwsIDAsCj4gPiA+IEJV
TEtfU1RBVFVTX0NBTkNFTEVEKTsKPiA+ID4gKyAgICAgICAgICAgIH0KPiA+ID4gKyAgICAgICAg
ICAgIHJldHVybjsKPiA+ID4gKyAgICAgICAgfQo+ID4gPiArICAgIH0KPiA+ID4gKyAgICBTUElD
RV9ERUJVRygiJXM6IEVSUk9SOiBubyBzdWNoIGlkIHRvIGNhbmNlbCEiLCBfX0ZVTkNUSU9OX18p
Owo+ID4gPiArfQo+ID4gPiArCj4gPiA+ICsvLyBjYWxsZWQgd2hlbiBhIGNoYW5nZSBoYXBwZW5z
IG9uIFNDU0kgbGF5ZXIKPiA+ID4gK3ZvaWQgY2RfdXNiX2J1bGtfbXNkX2x1bl9jaGFuZ2VkKHZv
aWQgKnVzZXJfZGF0YSwgdWludDMyX3QgbHVuKQo+ID4gPiArewo+ID4gPiArICAgIFVzYkNkICpk
ID0gKFVzYkNkICopdXNlcl9kYXRhOwo+ID4gPiArICAgIENkU2NzaURldmljZUluZm8gY2RfaW5m
bzsKPiA+ID4gKwo+ID4gPiArICAgIGlmICghY2RfdXNiX2J1bGtfbXNkX2dldF9pbmZvKGQtPm1z
YywgbHVuLCAmY2RfaW5mbykpIHsKPiA+ID4gKyAgICAgICAgLy8gbG9hZCBvciB1bmxvYWQgY29t
bWFuZCByZWNlaXZlZCBmcm9tIFNDU0kKPiA+ID4gKyAgICAgICAgaWYgKGQtPnVuaXRzW2x1bl0u
bG9hZGVkICE9IGNkX2luZm8ubG9hZGVkKSB7Cj4gPiA+ICsgICAgICAgICAgICBpZiAoIWxvYWRf
bHVuKGQsIGx1biwgY2RfaW5mby5sb2FkZWQpKSB7Cj4gPiA+ICsgICAgICAgICAgICAgICAgU1BJ
Q0VfREVCVUcoIiVzOiBsb2FkIGZhaWxlZCwgdW5sb2FkaW5nIHVuaXQiLAo+ID4gPiBfX0ZVTkNU
SU9OX18pOwo+ID4gPiArICAgICAgICAgICAgICAgIGNkX3VzYl9idWxrX21zZF91bmxvYWQoZC0+
bXNjLCBsdW4pOwo+ID4gPiArICAgICAgICAgICAgfQo+ID4gPiArICAgICAgICB9Cj4gPiA+ICsg
ICAgfQo+ID4gPiArCj4gPiA+ICsgICAgaWYgKGQtPmRlbGV0ZV9vbl9lamVjdCkgewo+ID4gPiAr
ICAgICAgICBkLT5kZWxldGVfb25fZWplY3QgPSBGQUxTRTsKPiA+ID4gKyAgICAgICAgZC0+ZGVs
ZXRpbmcgPSBUUlVFOwo+ID4gPiArICAgIH0gZWxzZSB7Cj4gPiA+ICsgICAgICAgIHNwaWNlX3Vz
Yl9iYWNrZW5kX2RldmljZV9yZXBvcnRfY2hhbmdlKGQtPmJhY2tlbmQsIGQtPnBhcmVudCk7Cj4g
PiA+ICsgICAgfQo+ID4gPiArfQo+ID4gPiArCj4gPiA+ICtzdGF0aWMgZ2NoYXIgKnVzYl9jZF9n
ZXRfcHJvZHVjdF9kZXNjcmlwdGlvbihVc2JDZCAqZGV2aWNlKQo+ID4gPiArewo+ID4gPiArICAg
IGdjaGFyICpiYXNlX25hbWUgPSBnX3BhdGhfZ2V0X2Jhc2VuYW1lKGRldmljZS0+dW5pdHNbMF0u
ZmlsZW5hbWUpOwo+ID4gPiArICAgIGdjaGFyICpyZXMgPSBnX3N0cmR1cF9wcmludGYoIlNQSUNF
IENEKCVzKSIsIGJhc2VfbmFtZSk7Cj4gPgo+ID4gTWF5YmUgbGVhdmUgYSBzcGFjZSBiZXR3ZWVu
ICJTUElDRSBDRCIgYW5kIHRoZSBmaWxlIG5hbWU/Cj4gPiBPbiB0aGUgR1VJIGRvZXMgbm90IGFw
cGVhciB0aGF0IGdyZWF0IHdpdGhvdXQuCj4gCj4gTm8gcHJvYmxlbQo+IAo+ID4KPiA+ID4gKyAg
ICBnX2ZyZWUoYmFzZV9uYW1lKTsKPiA+ID4gKyAgICByZXR1cm4gcmVzOwo+ID4gPiArfQo+ID4g
PiArCj4gPiA+ICtzdGF0aWMgY29uc3QgVXNiRGV2aWNlT3BzIGRldm9wcyA9Cj4gPiA+ICt7Cj4g
PiA+ICsgICAgLmdldF9kZXNjcmlwdG9yID0gdXNiX2NkX2dldF9kZXNjcmlwdG9yLAo+ID4gPiAr
ICAgIC5nZXRfcHJvZHVjdF9kZXNjcmlwdGlvbiA9IHVzYl9jZF9nZXRfcHJvZHVjdF9kZXNjcmlw
dGlvbiwKPiA+ID4gKyAgICAuYXR0YWNoID0gdXNiX2NkX2F0dGFjaCwKPiA+ID4gKyAgICAucmVz
ZXQgPSB1c2JfY2RfcmVzZXQsCj4gPiA+ICsgICAgLmRldGFjaCA9IHVzYl9jZF9kZXRhY2gsCj4g
PiA+ICsgICAgLmNvbnRyb2xfcmVxdWVzdCA9IHVzYl9jZF9jb250cm9sX3JlcXVlc3QsCj4gPiA+
ICsgICAgLmJ1bGtfb3V0X3JlcXVlc3QgPSB1c2JfY2RfYnVsa19vdXRfcmVxdWVzdCwKPiA+ID4g
KyAgICAuYnVsa19pbl9yZXF1ZXN0ID0gdXNiX2NkX2J1bGtfaW5fcmVxdWVzdCwKPiA+ID4gKyAg
ICAuY2FuY2VsX3JlcXVlc3QgPSB1c2JfY2RfY2FuY2VsX3JlcXVlc3QsCj4gPiA+ICsgICAgLmRl
bGV0ZSA9IHVzYl9jZF9kZWxldGUsCj4gPiA+ICt9Owo+ID4gPiArCj4gPiA+ICtzdGF0aWMgaW50
IHVzYl9jZF9jcmVhdGUoU3BpY2VVc2JCYWNrZW5kICpiZSwKPiA+ID4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICBTcGljZVVzYkJhY2tlbmREZXZpY2UgKnBhcmVudCwKPiA+ID4gKyAgICAgICAg
ICAgICAgICAgICAgICAgICBVc2JDcmVhdGVEZXZpY2VQYXJhbWV0ZXJzICpwYXJhbSwKPiA+ID4g
KyAgICAgICAgICAgICAgICAgICAgICAgICBVc2JDZCAqKmRldikKPiA+ID4gK3sKPiA+ID4gKyAg
ICBpbnQgZXJyb3IgPSAwOwo+ID4KPiA+IElzIHRoaXMgcmVzdWx0IHZhbHVlIHVzZWQgb3IgcGxh
bm5lZCB0byBiZSB1c2VkPyBMb29rcyBsaWtlIHdlIHVzZQo+ID4gKGFuZCB0aGUgY2FsbGVyIHRv
bykgbGlrZSBhIGJvb2xlYW4uCj4gPgo+ID4gPiArICAgIHVpbnQzMl90IHVuaXQgPSAwOwo+ID4K
PiA+IFRoaXMgaXMgdGhlIG90aGVyICJ1bml0IiBjb25zdGFudCBzZXQgdG8gMCAoY29tbWVudCBh
Ym92ZSkuCj4gCj4gVGhlIGNvZGUgaXMgaW4gZ2VuZXJhbCB3YXMgcHJlcGFyZWQgYWxzbyB0byB3
b3JrIGFsc28gd2l0aAo+IG11bHRpcGxlLXVuaXQgZGV2aWNlcy4KPiBTd2l0Y2ggZnJvbSBzaW5n
bGUtdW5pdCB0byBtdWx0aXBsZS11bml0LCBpZiBuZWVkZWQsIHdpbGwgYmUgdmVyeSBzaW1wbGUu
Cj4gCj4gPgo+ID4gPiArICAgIFVzYkNkICpkID0gZ19uZXcwKFVzYkNkLCAxKTsKPiA+ID4gKyAg
ICBDZFNjc2lEZXZpY2VQYXJhbWV0ZXJzIGRldl9wYXJhbXMgPSB7IDAgfTsKPiA+ID4gKwo+ID4g
PiArICAgIGQtPmRldl9vcHMgPSBkZXZvcHM7Cj4gPiA+ICsgICAgZC0+YmFja2VuZCA9IGJlOwo+
ID4gPiArICAgIGQtPnBhcmVudCAgPSBwYXJlbnQ7Cj4gPiA+ICsgICAgZC0+ZGVsZXRlX29uX2Vq
ZWN0ID0KPiA+ID4gISFwYXJhbS0+ZGV2aWNlX3BhcmFtLmNyZWF0ZV9jZC5kZWxldGVfb25fZWpl
Y3Q7Cj4gPiA+ICsgICAgZC0+bG9ja2VkID0gIWQtPmRlbGV0ZV9vbl9lamVjdDsKPiA+ID4gKyAg
ICBkLT5zZXJpYWxbMF0gPSAweDAzMDg7Cj4gPiA+ICsgICAgZC0+c2VyaWFsWzFdID0gJ1gnOwo+
ID4KPiA+IFNwZWNpZmljYXRpb25zIHN0YXRlIHRoYXQgdmFsdWUgY2hhcmFjdGVycyBhcmUgMC05
IGFuZCBBLUYgKGNhcGl0YWwgY2FzZQo+ID4gaGV4YWRlY2ltYWwsIHllcyBxdWl0ZSBhIHdhc3Rl
IG9mIHNwYWNlIEkgd291bGQgc2F5KS4KPiAKPiBXaGljaCBzcGVjPwo+IFRoaXMgaXMgc2VyaWFs
IHN0cmluZyBmb3IgVVNCIHRvIGRpc3Rpbmd1aXNoIGJldHdlZW4gbXVsdGlwbGUgQ0RzLgo+IAoK
U2VlIGFib3ZlIGZvciBsaW5rIHRvIHNwZWNzCgo+ID4KPiA+ID4gKyAgICBkLT5zZXJpYWxbMl0g
PSAnMCcgKyBwYXJhbS0+YWRkcmVzcyAvIDEwOwo+ID4gPiArICAgIGQtPnNlcmlhbFszXSA9ICcw
JyArIHBhcmFtLT5hZGRyZXNzICUgMTA7Cj4gPiA+ICsgICAgZC0+bWF4X2x1bl9pbmRleCA9IE1B
WF9MVU5fUEVSX0RFVklDRSAtIDE7Cj4gPiA+ICsKPiA+ID4gKyAgICBkZXZfcGFyYW1zLnZlbmRv
ciA9ICJTUElDRSI7Cj4gPiA+ICsgICAgZGV2X3BhcmFtcy5wcm9kdWN0ID0gInNoYXJlZCBDRCI7
Cj4gPgo+ID4gV2h5IG5vdCAiUmVkIEhhdCIgYW5kICJTUElDRSBDRCIgZXZlbiBoZXJlPwo+IAo+
IEV2ZXJ5dGhpbmcgeW91IHdhbnQuIFRoZXkgYXJlIFNDU0kgcGFyYW1ldGVycy4KPiAKPiA+Cj4g
PiA+ICsgICAgZGV2X3BhcmFtcy52ZXJzaW9uID0gIjAiOwo+ID4gPiArCj4gPiA+ICsgICAgZC0+
bXNjID0gY2RfdXNiX2J1bGtfbXNkX2FsbG9jKGQsIE1BWF9MVU5fUEVSX0RFVklDRSk7Cj4gPiA+
ICsgICAgaWYgKCFkLT5tc2MpIHsKPiA+ID4gKyAgICAgICAgZ19jbGVhcl9wb2ludGVyKCZkLCBn
X2ZyZWUpOwo+ID4gPiArICAgICAgICBwYXJhbS0+ZXJyb3IgPSBnX2Vycm9yX25ldyhTUElDRV9D
TElFTlRfRVJST1IsCj4gPiA+IFNQSUNFX0NMSUVOVF9FUlJPUl9GQUlMRUQsCj4gPiA+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF8oImNhbid0IGFsbG9jYXRlIGRldmljZSIp
KTsKPiA+ID4gKyAgICAgICAgcmV0dXJuIDE7Cj4gPiA+ICsgICAgfQo+ID4gPiArICAgIGQtPnVu
aXRzW3VuaXRdLmJsb2NrU2l6ZSA9IENEX0RFVl9CTE9DS19TSVpFOwo+ID4gPiArICAgIGlmICgh
Y2RfdXNiX2J1bGtfbXNkX3JlYWxpemUoZC0+bXNjLCB1bml0LCAmZGV2X3BhcmFtcykpIHsKPiA+
ID4gKyAgICAgICAgaWYgKG9wZW5fc3RyZWFtKCZkLT51bml0c1t1bml0XSwKPiA+ID4gcGFyYW0t
PmRldmljZV9wYXJhbS5jcmVhdGVfY2QuZmlsZW5hbWUpICYmCj4gPiA+ICsgICAgICAgICAgICBs
b2FkX2x1bihkLCB1bml0LCBUUlVFKSkgewo+ID4gPiArICAgICAgICAgICAgaWYgKGQtPmxvY2tl
ZCkgewo+ID4gPiArICAgICAgICAgICAgICAgIGNkX3VzYl9idWxrX21zZF9sb2NrKGQtPm1zYywg
dW5pdCwgVFJVRSk7Cj4gPiA+ICsgICAgICAgICAgICB9Cj4gPiA+ICsgICAgICAgIH0gZWxzZSB7
Cj4gPiA+ICsgICAgICAgICAgICBjbG9zZV9zdHJlYW0oJmQtPnVuaXRzW3VuaXRdKTsKPiA+ID4g
KyAgICAgICAgICAgIGNkX3VzYl9idWxrX21zZF91bnJlYWxpemUoZC0+bXNjLCB1bml0KTsKPiA+
ID4gKyAgICAgICAgICAgIHBhcmFtLT5lcnJvciA9IGdfZXJyb3JfbmV3KFNQSUNFX0NMSUVOVF9F
UlJPUiwKPiA+ID4gU1BJQ0VfQ0xJRU5UX0VSUk9SX0ZBSUxFRCwKPiA+ID4gKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIF8oImNhbid0IGNyZWF0ZSBkZXZpY2Ugd2l0aCAl
cyIpLAo+ID4gPiArCj4gPiA+IHBhcmFtLT5kZXZpY2VfcGFyYW0uY3JlYXRlX2NkLmZpbGVuYW1l
KTsKPiA+ID4gKyAgICAgICAgICAgIGVycm9yID0gMzsKPiA+ID4gKyAgICAgICAgfQo+ID4gPiAr
ICAgIH0gZWxzZSB7Cj4gPiA+ICsgICAgICAgIGVycm9yID0gMjsKPiA+ID4gKyAgICAgICAgcGFy
YW0tPmVycm9yID0gZ19lcnJvcl9uZXcoU1BJQ0VfQ0xJRU5UX0VSUk9SLAo+ID4gPiBTUElDRV9D
TElFTlRfRVJST1JfRkFJTEVELAo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBfKCJjYW4ndCBhbGxvY2F0ZSBkZXZpY2UiKSk7Cj4gPiA+ICsgICAgfQo+ID4gPiArICAg
IGlmIChlcnJvcikgewo+ID4gPiArICAgICAgICBnX2NsZWFyX3BvaW50ZXIoJmQtPm1zYywgY2Rf
dXNiX2J1bGtfbXNkX2ZyZWUpOwo+ID4gPiArICAgICAgICBnX2NsZWFyX3BvaW50ZXIoJmQsIGdf
ZnJlZSk7Cj4gPiA+ICsgICAgfQo+ID4gPiArCj4gPiA+ICsgICAgKmRldiA9IGQ7Cj4gPiA+ICsg
ICAgcmV0dXJuIGVycm9yOwo+ID4gPiArfQo+ID4gPiArCj4gPiA+ICt2b2lkIHNwaWNlX3VzYl9k
ZXZpY2VfcmVnaXN0ZXJfY2QoU3BpY2VVc2JCYWNrZW5kICpiZSkKPiA+ID4gK3sKPiA+ID4gKyAg
ICBzcGljZV91c2JfYmFja2VuZF9yZWdpc3Rlcl9kZXZpY2VfdHlwZShiZSwgVVNCX0RFVl9UWVBF
X0NELAo+ID4gPiB1c2JfY2RfY3JlYXRlKTsKPiA+ID4gK30KPiA+ID4gKwo+ID4gPiArI2VuZGlm
IC8qIFVTRV9VU0JSRURJUiAqLwo+ID4KPiA+IEJ5IHRoZSB3YXksIHByZXBhcmluZyBzb21lIGZv
bGxvdyB1cHMuCj4gPgo+ID4gRnJlZGlhbm8KPiAKX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX18KU3BpY2UtZGV2ZWwgbWFpbGluZyBsaXN0ClNwaWNlLWRldmVs
QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWls
bWFuL2xpc3RpbmZvL3NwaWNlLWRldmVs
