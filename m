Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 546C6481B4
	for <lists+spice-devel@lfdr.de>; Mon, 17 Jun 2019 14:21:03 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 6D74B8916C;
	Mon, 17 Jun 2019 12:21:01 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 014EA8916C
 for <spice-devel@lists.freedesktop.org>; Mon, 17 Jun 2019 12:20:59 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx06.intmail.prod.int.phx2.redhat.com
 [10.5.11.16])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id C5B7C3024552
 for <spice-devel@lists.freedesktop.org>; Mon, 17 Jun 2019 12:20:58 +0000 (UTC)
Received: from colo-mx.corp.redhat.com
 (colo-mx02.intmail.prod.int.phx2.redhat.com [10.5.11.21])
 by smtp.corp.redhat.com (Postfix) with ESMTPS id BC6A582267
 for <spice-devel@lists.freedesktop.org>; Mon, 17 Jun 2019 12:20:58 +0000 (UTC)
Received: from zmail25.collab.prod.int.phx2.redhat.com
 (zmail25.collab.prod.int.phx2.redhat.com [10.5.83.31])
 by colo-mx.corp.redhat.com (Postfix) with ESMTP id B2913206D1
 for <spice-devel@lists.freedesktop.org>; Mon, 17 Jun 2019 12:20:58 +0000 (UTC)
Date: Mon, 17 Jun 2019 08:20:57 -0400 (EDT)
From: Frediano Ziglio <fziglio@redhat.com>
To: spice-devel@lists.freedesktop.org
Message-ID: <2035429986.23075376.1560774057128.JavaMail.zimbra@redhat.com>
In-Reply-To: <20190603112214.15093-1-fziglio@redhat.com>
References: <20190603112214.15093-1-fziglio@redhat.com>
MIME-Version: 1.0
X-Originating-IP: [10.40.205.51, 10.4.195.29]
Thread-Topic: Use SPICE_CONTAINEROF to avoid some possible alignment warnings
 on MIPS
Thread-Index: 4XebPrm4b8cHsm1xHr+bhKOCxUnDrA==
X-Scanned-By: MIMEDefang 2.79 on 10.5.11.16
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16
 (mx1.redhat.com [10.5.110.49]); Mon, 17 Jun 2019 12:20:58 +0000 (UTC)
Subject: Re: [Spice-devel] [PATCH spice-server 1/3] Use SPICE_CONTAINEROF to
 avoid some possible alignment warnings on MIPS
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

cGluZyB0aGUgc2VyaWVzCgo+IAo+IFRoaXMgcGF0Y2ggY2FtZSBmcm9tIHNvbWUgZXhwZXJpbWVu
dHMgdXNpbmcgYW4gZW11bGF0ZWQgTUlQUyBtYWNoaW5lLgo+IE9uIHN1Y2ggYXJjaGl0ZWN0dXJl
IGR1ZSB0byBub3Qgc3VwcG9ydGluZyBhbGlnbm1lbnQgYWNjZXNzIHRoZQo+IGNvbXBpbGVyIGlz
IG1vcmUgc3RyaWN0IGFib3V0IGNvbnZlcnNpb24gY29tcGxhaW5pbmcgd2l0aCBzb21lCj4gcG9p
bnRlciBjYXN0cy4gVXNlIGRpZmZlcmVudCBjb252ZXJzaW9uIHRvIGF2b2lkIHRoZXNlIHdhcm5p
bmdzLgo+IAo+IFNpZ25lZC1vZmYtYnk6IEZyZWRpYW5vIFppZ2xpbyA8ZnppZ2xpb0ByZWRoYXQu
Y29tPgo+IC0tLQo+ICBzZXJ2ZXIvY2FjaGUtaXRlbS50bXBsLmMgfCAgMyArKy0KPiAgc2VydmVy
L2RjYy5jICAgICAgICAgICAgIHwgIDQgKystLQo+ICBzZXJ2ZXIvaW1hZ2UtY2FjaGUuYyAgICAg
fCAgNSArKystLQo+ICBzZXJ2ZXIvaW1hZ2UtZW5jb2RlcnMuYyAgfCAyNiArKysrKysrKysrKysr
LS0tLS0tLS0tLS0tLQo+ICBzZXJ2ZXIvbWpwZWctZW5jb2Rlci5jICAgfCAxMiArKysrKystLS0t
LS0KPiAgc2VydmVyL3BpeG1hcC1jYWNoZS5jICAgIHwgIDIgKy0KPiAgNiBmaWxlcyBjaGFuZ2Vk
LCAyNyBpbnNlcnRpb25zKCspLCAyNSBkZWxldGlvbnMoLSkKPiAKPiBkaWZmIC0tZ2l0IGEvc2Vy
dmVyL2NhY2hlLWl0ZW0udG1wbC5jIGIvc2VydmVyL2NhY2hlLWl0ZW0udG1wbC5jCj4gaW5kZXgg
ZjExOWE5ZWU0Li44ZTE4ZjliMWIgMTAwNjQ0Cj4gLS0tIGEvc2VydmVyL2NhY2hlLWl0ZW0udG1w
bC5jCj4gKysrIGIvc2VydmVyL2NhY2hlLWl0ZW0udG1wbC5jCj4gQEAgLTg5LDcgKzg5LDggQEAg
c3RhdGljIGludCBGVU5DX05BTUUoYWRkKShDSEFOTkVMQ0xJRU5UICpjaGFubmVsX2NsaWVudCwK
PiB1aW50NjRfdCBpZCwgc2l6ZV90IHNpego+ICAgICAgY2hhbm5lbF9jbGllbnQtPnByaXYtPlZB
Ul9OQU1FKGF2YWlsYWJsZSkgLT0gc2l6ZTsKPiAgICAgIFNQSUNFX1ZFUklGWShTUElDRV9PRkZT
RVRPRihSZWRDYWNoZUl0ZW0sIHUuY2FjaGVfZGF0YS5scnVfbGluaykgPT0gMCk7Cj4gICAgICB3
aGlsZSAoY2hhbm5lbF9jbGllbnQtPnByaXYtPlZBUl9OQU1FKGF2YWlsYWJsZSkgPCAwKSB7Cj4g
LSAgICAgICAgUmVkQ2FjaGVJdGVtICp0YWlsID0gKFJlZENhY2hlSXRlbQo+ICopcmluZ19nZXRf
dGFpbCgmY2hhbm5lbF9jbGllbnQtPnByaXYtPlZBUl9OQU1FKGxydSkpOwo+ICsgICAgICAgIFJl
ZENhY2hlSXRlbSAqdGFpbCA9Cj4gU1BJQ0VfQ09OVEFJTkVST0YocmluZ19nZXRfdGFpbCgmY2hh
bm5lbF9jbGllbnQtPnByaXYtPlZBUl9OQU1FKGxydSkpLAo+ICsgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVkQ2FjaGVJdGVtLAo+
IHUuY2FjaGVfZGF0YS5scnVfbGluayk7Cj4gICAgICAgICAgaWYgKCF0YWlsKSB7Cj4gICAgICAg
ICAgICAgIGNoYW5uZWxfY2xpZW50LT5wcml2LT5WQVJfTkFNRShhdmFpbGFibGUpICs9IHNpemU7
Cj4gICAgICAgICAgICAgIGdfZnJlZShpdGVtKTsKPiBkaWZmIC0tZ2l0IGEvc2VydmVyL2RjYy5j
IGIvc2VydmVyL2RjYy5jCj4gaW5kZXggYWNjMWNhMzhjLi43MWQwOWI3N2YgMTAwNjQ0Cj4gLS0t
IGEvc2VydmVyL2RjYy5jCj4gKysrIGIvc2VydmVyL2RjYy5jCj4gQEAgLTk2OCw4ICs5NjgsOCBA
QCBib29sIGRjY19waXhtYXBfY2FjaGVfdW5sb2NrZWRfYWRkKERpc3BsYXlDaGFubmVsQ2xpZW50
Cj4gKmRjYywgdWludDY0X3QgaWQsCj4gICAgICAgICAgTmV3Q2FjaGVJdGVtICoqbm93Owo+ICAK
PiAgICAgICAgICBTUElDRV9WRVJJRlkoU1BJQ0VfT0ZGU0VUT0YoTmV3Q2FjaGVJdGVtLCBscnVf
bGluaykgPT0gMCk7Cj4gLSAgICAgICAgaWYgKCEodGFpbCA9IChOZXdDYWNoZUl0ZW0gKilyaW5n
X2dldF90YWlsKCZjYWNoZS0+bHJ1KSkgfHwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgdGFpbC0+c3luY1tkY2MtPnByaXYtPmlkXQo+ID09IHNl
cmlhbCkgewo+ICsgICAgICAgIGlmICghKHRhaWwgPSBTUElDRV9DT05UQUlORVJPRihyaW5nX2dl
dF90YWlsKCZjYWNoZS0+bHJ1KSwKPiBOZXdDYWNoZUl0ZW0sIGxydV9saW5rKSkgfHwKPiArCj4g
dGFpbC0+c3luY1tkY2MtPnByaXYtPmlkXQo+ID09IHNlcmlhbCkgewo+ICAgICAgICAgICAgICBj
YWNoZS0+YXZhaWxhYmxlICs9IHNpemU7Cj4gICAgICAgICAgICAgIGdfZnJlZShpdGVtKTsKPiAg
ICAgICAgICAgICAgcmV0dXJuIEZBTFNFOwo+IGRpZmYgLS1naXQgYS9zZXJ2ZXIvaW1hZ2UtY2Fj
aGUuYyBiL3NlcnZlci9pbWFnZS1jYWNoZS5jCj4gaW5kZXggMmNhNGQ0YjY3Li40ODgxZjRkOTIg
MTAwNjQ0Cj4gLS0tIGEvc2VydmVyL2ltYWdlLWNhY2hlLmMKPiArKysgYi9zZXJ2ZXIvaW1hZ2Ut
Y2FjaGUuYwo+IEBAIC03OCw3ICs3OCw4IEBAIHN0YXRpYyB2b2lkIGltYWdlX2NhY2hlX3B1dChT
cGljZUltYWdlQ2FjaGUgKnNwaWNlX2NhY2hlLAo+IHVpbnQ2NF90IGlkLCBwaXhtYW5faW0KPiAg
I2lmbmRlZiBJTUFHRV9DQUNIRV9BR0UKPiAgICAgIGlmIChjYWNoZS0+bnVtX2l0ZW1zID09IElN
QUdFX0NBQ0hFX01BWF9JVEVNUykgewo+ICAgICAgICAgIFNQSUNFX1ZFUklGWShTUElDRV9PRkZT
RVRPRihJbWFnZUNhY2hlSXRlbSwgbHJ1X2xpbmspID09IDApOwo+IC0gICAgICAgIEltYWdlQ2Fj
aGVJdGVtICp0YWlsID0gKEltYWdlQ2FjaGVJdGVtICopcmluZ19nZXRfdGFpbCgmY2FjaGUtPmxy
dSk7Cj4gKyAgICAgICAgSW1hZ2VDYWNoZUl0ZW0gKnRhaWwgPQo+ICsgICAgICAgICAgICBTUElD
RV9DT05UQUlORVJPRihyaW5nX2dldF90YWlsKCZjYWNoZS0+bHJ1KSwgSW1hZ2VDYWNoZUl0ZW0s
Cj4gbHJ1X2xpbmspOwo+ICAgICAgICAgIHNwaWNlX2Fzc2VydCh0YWlsKTsKPiAgICAgICAgICBp
bWFnZV9jYWNoZV9yZW1vdmUoY2FjaGUsIHRhaWwpOwo+ICAgICAgfQo+IEBAIC0xMzMsNyArMTM0
LDcgQEAgdm9pZCBpbWFnZV9jYWNoZV9yZXNldChJbWFnZUNhY2hlICpjYWNoZSkKPiAgICAgIElt
YWdlQ2FjaGVJdGVtICppdGVtOwo+ICAKPiAgICAgIFNQSUNFX1ZFUklGWShTUElDRV9PRkZTRVRP
RihJbWFnZUNhY2hlSXRlbSwgbHJ1X2xpbmspID09IDApOwo+IC0gICAgd2hpbGUgKChpdGVtID0g
KEltYWdlQ2FjaGVJdGVtICopcmluZ19nZXRfaGVhZCgmY2FjaGUtPmxydSkpKSB7Cj4gKyAgICB3
aGlsZSAoKGl0ZW0gPSBTUElDRV9DT05UQUlORVJPRihyaW5nX2dldF9oZWFkKCZjYWNoZS0+bHJ1
KSwKPiBJbWFnZUNhY2hlSXRlbSwgbHJ1X2xpbmspKSkgewo+ICAgICAgICAgIGltYWdlX2NhY2hl
X3JlbW92ZShjYWNoZSwgaXRlbSk7Cj4gICAgICB9Cj4gICNpZmRlZiBJTUFHRV9DQUNIRV9BR0UK
PiBkaWZmIC0tZ2l0IGEvc2VydmVyL2ltYWdlLWVuY29kZXJzLmMgYi9zZXJ2ZXIvaW1hZ2UtZW5j
b2RlcnMuYwo+IGluZGV4IDMwNmM2ZGNhNi4uZDRkNDg2YzM2IDEwMDY0NAo+IC0tLSBhL3NlcnZl
ci9pbWFnZS1lbmNvZGVycy5jCj4gKysrIGIvc2VydmVyL2ltYWdlLWVuY29kZXJzLmMKPiBAQCAt
ODksNyArODksNyBAQCBzdGF0aWMgdm9pZCBpbWFnZV9lbmNvZGVyc19yZWxlYXNlX2dseihJbWFn
ZUVuY29kZXJzICplbmMpOwo+ICBzdGF0aWMgU1BJQ0VfR05VQ19OT1JFVFVSTiBTUElDRV9HTlVD
X1BSSU5URigyLCAzKSB2b2lkCj4gIHF1aWNfdXNyX2Vycm9yKFF1aWNVc3JDb250ZXh0ICp1c3Is
IGNvbnN0IGNoYXIgKmZtdCwgLi4uKQo+ICB7Cj4gLSAgICBFbmNvZGVyRGF0YSAqdXNyX2RhdGEg
PSAmKCgoUXVpY0RhdGEgKil1c3IpLT5kYXRhKTsKPiArICAgIEVuY29kZXJEYXRhICp1c3JfZGF0
YSA9ICYoU1BJQ0VfQ09OVEFJTkVST0YodXNyLCBRdWljRGF0YSwgdXNyKS0+ZGF0YSk7Cj4gICAg
ICB2YV9saXN0IGFwOwo+ICAgICAgY2hhciBtZXNzYWdlX2J1ZltFTkNPREVSX01FU1NBR0VfU0la
RV07Cj4gIAo+IEBAIC0xMDQsNyArMTA0LDcgQEAgcXVpY191c3JfZXJyb3IoUXVpY1VzckNvbnRl
eHQgKnVzciwgY29uc3QgY2hhciAqZm10LCAuLi4pCj4gIHN0YXRpYyBTUElDRV9HTlVDX05PUkVU
VVJOIFNQSUNFX0dOVUNfUFJJTlRGKDIsIDMpIHZvaWQKPiAgbHpfdXNyX2Vycm9yKEx6VXNyQ29u
dGV4dCAqdXNyLCBjb25zdCBjaGFyICpmbXQsIC4uLikKPiAgewo+IC0gICAgRW5jb2RlckRhdGEg
KnVzcl9kYXRhID0gJigoKEx6RGF0YSAqKXVzciktPmRhdGEpOwo+ICsgICAgRW5jb2RlckRhdGEg
KnVzcl9kYXRhID0gJihTUElDRV9DT05UQUlORVJPRih1c3IsIEx6RGF0YSwgdXNyKS0+ZGF0YSk7
Cj4gICAgICB2YV9saXN0IGFwOwo+ICAgICAgY2hhciBtZXNzYWdlX2J1ZltFTkNPREVSX01FU1NB
R0VfU0laRV07Cj4gIAo+IEBAIC0yMzMsMjUgKzIzMywyNSBAQCBzdGF0aWMgaW50IGVuY29kZXJf
dXNyX21vcmVfc3BhY2UoRW5jb2RlckRhdGEKPiAqZW5jX2RhdGEsIHVpbnQ4X3QgKippb19wdHIp
Cj4gIAo+ICBzdGF0aWMgaW50IHF1aWNfdXNyX21vcmVfc3BhY2UoUXVpY1VzckNvbnRleHQgKnVz
ciwgdWludDMyX3QgKippb19wdHIsIGludAo+ICByb3dzX2NvbXBsZXRlZCkKPiAgewo+IC0gICAg
RW5jb2RlckRhdGEgKnVzcl9kYXRhID0gJigoKFF1aWNEYXRhICopdXNyKS0+ZGF0YSk7Cj4gKyAg
ICBFbmNvZGVyRGF0YSAqdXNyX2RhdGEgPSAmKFNQSUNFX0NPTlRBSU5FUk9GKHVzciwgUXVpY0Rh
dGEsIHVzciktPmRhdGEpOwo+ICAgICAgcmV0dXJuIGVuY29kZXJfdXNyX21vcmVfc3BhY2UodXNy
X2RhdGEsICh1aW50OF90ICoqKWlvX3B0cikgLwo+ICAgICAgc2l6ZW9mKHVpbnQzMl90KTsKPiAg
fQo+ICAKPiAgc3RhdGljIGludCBsel91c3JfbW9yZV9zcGFjZShMelVzckNvbnRleHQgKnVzciwg
dWludDhfdCAqKmlvX3B0cikKPiAgewo+IC0gICAgRW5jb2RlckRhdGEgKnVzcl9kYXRhID0gJigo
KEx6RGF0YSAqKXVzciktPmRhdGEpOwo+ICsgICAgRW5jb2RlckRhdGEgKnVzcl9kYXRhID0gJihT
UElDRV9DT05UQUlORVJPRih1c3IsIEx6RGF0YSwgdXNyKS0+ZGF0YSk7Cj4gICAgICByZXR1cm4g
ZW5jb2Rlcl91c3JfbW9yZV9zcGFjZSh1c3JfZGF0YSwgaW9fcHRyKTsKPiAgfQo+ICAKPiAgc3Rh
dGljIGludCBnbHpfdXNyX21vcmVfc3BhY2UoR2x6RW5jb2RlclVzckNvbnRleHQgKnVzciwgdWlu
dDhfdCAqKmlvX3B0cikKPiAgewo+IC0gICAgRW5jb2RlckRhdGEgKnVzcl9kYXRhID0gJigoKEds
ekRhdGEgKil1c3IpLT5kYXRhKTsKPiArICAgIEVuY29kZXJEYXRhICp1c3JfZGF0YSA9ICYoU1BJ
Q0VfQ09OVEFJTkVST0YodXNyLCBHbHpEYXRhLCB1c3IpLT5kYXRhKTsKPiAgICAgIHJldHVybiBl
bmNvZGVyX3Vzcl9tb3JlX3NwYWNlKHVzcl9kYXRhLCBpb19wdHIpOwo+ICB9Cj4gIAo+ICBzdGF0
aWMgaW50IGpwZWdfdXNyX21vcmVfc3BhY2UoSnBlZ0VuY29kZXJVc3JDb250ZXh0ICp1c3IsIHVp
bnQ4X3QgKippb19wdHIpCj4gIHsKPiAtICAgIEVuY29kZXJEYXRhICp1c3JfZGF0YSA9ICYoKChK
cGVnRGF0YSAqKXVzciktPmRhdGEpOwo+ICsgICAgRW5jb2RlckRhdGEgKnVzcl9kYXRhID0gJihT
UElDRV9DT05UQUlORVJPRih1c3IsIEpwZWdEYXRhLCB1c3IpLT5kYXRhKTsKPiAgICAgIHJldHVy
biBlbmNvZGVyX3Vzcl9tb3JlX3NwYWNlKHVzcl9kYXRhLCBpb19wdHIpOwo+ICB9Cj4gIAo+IEBA
IC0yNjUsNyArMjY1LDcgQEAgc3RhdGljIGludCBsejRfdXNyX21vcmVfc3BhY2UoTHo0RW5jb2Rl
clVzckNvbnRleHQgKnVzciwKPiB1aW50OF90ICoqaW9fcHRyKQo+ICAKPiAgc3RhdGljIGludCB6
bGliX3Vzcl9tb3JlX3NwYWNlKFpsaWJFbmNvZGVyVXNyQ29udGV4dCAqdXNyLCB1aW50OF90ICoq
aW9fcHRyKQo+ICB7Cj4gLSAgICBFbmNvZGVyRGF0YSAqdXNyX2RhdGEgPSAmKCgoWmxpYkRhdGEg
Kil1c3IpLT5kYXRhKTsKPiArICAgIEVuY29kZXJEYXRhICp1c3JfZGF0YSA9ICYoU1BJQ0VfQ09O
VEFJTkVST0YodXNyLCBabGliRGF0YSwgdXNyKS0+ZGF0YSk7Cj4gICAgICByZXR1cm4gZW5jb2Rl
cl91c3JfbW9yZV9zcGFjZSh1c3JfZGF0YSwgaW9fcHRyKTsKPiAgfQo+ICAKPiBAQCAtMzAxLDI1
ICszMDEsMjUgQEAgc3RhdGljIGlubGluZSBpbnQgZW5jb2Rlcl91c3JfbW9yZV9saW5lcyhFbmNv
ZGVyRGF0YQo+ICplbmNfZGF0YSwgdWludDhfdCAqKmxpbmVzKQo+ICAKPiAgc3RhdGljIGludCBx
dWljX3Vzcl9tb3JlX2xpbmVzKFF1aWNVc3JDb250ZXh0ICp1c3IsIHVpbnQ4X3QgKipsaW5lcykK
PiAgewo+IC0gICAgRW5jb2RlckRhdGEgKnVzcl9kYXRhID0gJigoKFF1aWNEYXRhICopdXNyKS0+
ZGF0YSk7Cj4gKyAgICBFbmNvZGVyRGF0YSAqdXNyX2RhdGEgPSAmKFNQSUNFX0NPTlRBSU5FUk9G
KHVzciwgUXVpY0RhdGEsIHVzciktPmRhdGEpOwo+ICAgICAgcmV0dXJuIGVuY29kZXJfdXNyX21v
cmVfbGluZXModXNyX2RhdGEsIGxpbmVzKTsKPiAgfQo+ICAKPiAgc3RhdGljIGludCBsel91c3Jf
bW9yZV9saW5lcyhMelVzckNvbnRleHQgKnVzciwgdWludDhfdCAqKmxpbmVzKQo+ICB7Cj4gLSAg
ICBFbmNvZGVyRGF0YSAqdXNyX2RhdGEgPSAmKCgoTHpEYXRhICopdXNyKS0+ZGF0YSk7Cj4gKyAg
ICBFbmNvZGVyRGF0YSAqdXNyX2RhdGEgPSAmKFNQSUNFX0NPTlRBSU5FUk9GKHVzciwgTHpEYXRh
LCB1c3IpLT5kYXRhKTsKPiAgICAgIHJldHVybiBlbmNvZGVyX3Vzcl9tb3JlX2xpbmVzKHVzcl9k
YXRhLCBsaW5lcyk7Cj4gIH0KPiAgCj4gIHN0YXRpYyBpbnQgZ2x6X3Vzcl9tb3JlX2xpbmVzKEds
ekVuY29kZXJVc3JDb250ZXh0ICp1c3IsIHVpbnQ4X3QgKipsaW5lcykKPiAgewo+IC0gICAgRW5j
b2RlckRhdGEgKnVzcl9kYXRhID0gJigoKEdsekRhdGEgKil1c3IpLT5kYXRhKTsKPiArICAgIEVu
Y29kZXJEYXRhICp1c3JfZGF0YSA9ICYoU1BJQ0VfQ09OVEFJTkVST0YodXNyLCBHbHpEYXRhLCB1
c3IpLT5kYXRhKTsKPiAgICAgIHJldHVybiBlbmNvZGVyX3Vzcl9tb3JlX2xpbmVzKHVzcl9kYXRh
LCBsaW5lcyk7Cj4gIH0KPiAgCj4gIHN0YXRpYyBpbnQganBlZ191c3JfbW9yZV9saW5lcyhKcGVn
RW5jb2RlclVzckNvbnRleHQgKnVzciwgdWludDhfdCAqKmxpbmVzKQo+ICB7Cj4gLSAgICBFbmNv
ZGVyRGF0YSAqdXNyX2RhdGEgPSAmKCgoSnBlZ0RhdGEgKil1c3IpLT5kYXRhKTsKPiArICAgIEVu
Y29kZXJEYXRhICp1c3JfZGF0YSA9ICYoU1BJQ0VfQ09OVEFJTkVST0YodXNyLCBKcGVnRGF0YSwg
dXNyKS0+ZGF0YSk7Cj4gICAgICByZXR1cm4gZW5jb2Rlcl91c3JfbW9yZV9saW5lcyh1c3JfZGF0
YSwgbGluZXMpOwo+ICB9Cj4gIAo+IEBAIC0zMzMsNyArMzMzLDcgQEAgc3RhdGljIGludCBsejRf
dXNyX21vcmVfbGluZXMoTHo0RW5jb2RlclVzckNvbnRleHQgKnVzciwKPiB1aW50OF90ICoqbGlu
ZXMpCj4gIAo+ICBzdGF0aWMgaW50IHpsaWJfdXNyX21vcmVfaW5wdXQoWmxpYkVuY29kZXJVc3JD
b250ZXh0ICp1c3IsIHVpbnQ4X3QqKiBpbnB1dCkKPiAgewo+IC0gICAgRW5jb2RlckRhdGEgKnVz
cl9kYXRhID0gJigoKFpsaWJEYXRhICopdXNyKS0+ZGF0YSk7Cj4gKyAgICBFbmNvZGVyRGF0YSAq
dXNyX2RhdGEgPSAmKFNQSUNFX0NPTlRBSU5FUk9GKHVzciwgWmxpYkRhdGEsIHVzciktPmRhdGEp
Owo+ICAgICAgaW50IGJ1Zl9zaXplOwo+ICAKPiAgICAgIGlmICghdXNyX2RhdGEtPnUuY29tcHJl
c3NlZF9kYXRhLm5leHQpIHsKPiBAQCAtMzg2LDcgKzM4Niw3IEBAIHN0YXRpYyB2b2lkIGltYWdl
X2VuY29kZXJzX2luaXRfbHooSW1hZ2VFbmNvZGVycyAqZW5jKQo+ICAKPiAgc3RhdGljIHZvaWQg
Z2x6X3Vzcl9mcmVlX2ltYWdlKEdsekVuY29kZXJVc3JDb250ZXh0ICp1c3IsIEdselVzckltYWdl
Q29udGV4dAo+ICAqaW1hZ2UpCj4gIHsKPiAtICAgIEdsekRhdGEgKmx6X2RhdGEgPSAoR2x6RGF0
YSAqKXVzcjsKPiArICAgIEdsekRhdGEgKmx6X2RhdGEgPSBTUElDRV9DT05UQUlORVJPRih1c3Is
IEdsekRhdGEsIHVzcik7Cj4gICAgICBHbHpEcmF3YWJsZUluc3RhbmNlSXRlbSAqZ2x6X2RyYXdh
YmxlX2luc3RhbmNlID0KPiAgICAgIChHbHpEcmF3YWJsZUluc3RhbmNlSXRlbSAqKWltYWdlOwo+
ICAgICAgSW1hZ2VFbmNvZGVycyAqZHJhd2FibGVfZW5jID0KPiAgICAgIGdsel9kcmF3YWJsZV9p
bnN0YW5jZS0+Z2x6X2RyYXdhYmxlLT5lbmNvZGVyczsKPiAgICAgIEltYWdlRW5jb2RlcnMgKnRo
aXNfZW5jID0gU1BJQ0VfQ09OVEFJTkVST0YobHpfZGF0YSwgSW1hZ2VFbmNvZGVycywKPiAgICAg
IGdsel9kYXRhKTsKPiBkaWZmIC0tZ2l0IGEvc2VydmVyL21qcGVnLWVuY29kZXIuYyBiL3NlcnZl
ci9tanBlZy1lbmNvZGVyLmMKPiBpbmRleCA0YTAyZTdjOGIuLmU2MjlhZGFlNCAxMDA2NDQKPiAt
LS0gYS9zZXJ2ZXIvbWpwZWctZW5jb2Rlci5jCj4gKysrIGIvc2VydmVyL21qcGVnLWVuY29kZXIu
Ywo+IEBAIC0yMDYsNyArMjA2LDcgQEAgc3RhdGljIE1KcGVnVmlkZW9CdWZmZXIqIGNyZWF0ZV9t
anBlZ192aWRlb19idWZmZXIodm9pZCkKPiAgCj4gIHN0YXRpYyB2b2lkIG1qcGVnX2VuY29kZXJf
ZGVzdHJveShWaWRlb0VuY29kZXIgKnZpZGVvX2VuY29kZXIpCj4gIHsKPiAtICAgIE1KcGVnRW5j
b2RlciAqZW5jb2RlciA9IChNSnBlZ0VuY29kZXIqKXZpZGVvX2VuY29kZXI7Cj4gKyAgICBNSnBl
Z0VuY29kZXIgKmVuY29kZXIgPSBTUElDRV9DT05UQUlORVJPRih2aWRlb19lbmNvZGVyLCBNSnBl
Z0VuY29kZXIsCj4gYmFzZSk7Cj4gICAgICBnX2ZyZWUoZW5jb2Rlci0+Y2luZm8uZGVzdCk7Cj4g
ICAgICBqcGVnX2Rlc3Ryb3lfY29tcHJlc3MoJmVuY29kZXItPmNpbmZvKTsKPiAgICAgIGdfZnJl
ZShlbmNvZGVyLT5yb3cpOwo+IEBAIC05MzEsNyArOTMxLDcgQEAgc3RhdGljIGludCBtanBlZ19l
bmNvZGVyX2VuY29kZV9mcmFtZShWaWRlb0VuY29kZXIKPiAqdmlkZW9fZW5jb2RlciwKPiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBncG9pbnRlciBiaXRtYXBfb3BhcXVl
LAo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZpZGVvQnVmZmVyICoq
b3V0YnVmKQo+ICB7Cj4gLSAgICBNSnBlZ0VuY29kZXIgKmVuY29kZXIgPSAoTUpwZWdFbmNvZGVy
Kil2aWRlb19lbmNvZGVyOwo+ICsgICAgTUpwZWdFbmNvZGVyICplbmNvZGVyID0gU1BJQ0VfQ09O
VEFJTkVST0YodmlkZW9fZW5jb2RlciwgTUpwZWdFbmNvZGVyLAo+IGJhc2UpOwo+ICAgICAgTUpw
ZWdWaWRlb0J1ZmZlciAqYnVmZmVyID0gY3JlYXRlX21qcGVnX3ZpZGVvX2J1ZmZlcigpOwo+ICAg
ICAgaWYgKCFidWZmZXIpIHsKPiAgICAgICAgICByZXR1cm4gVklERU9fRU5DT0RFUl9GUkFNRV9V
TlNVUFBPUlRFRDsKPiBAQCAtMTE5MSw3ICsxMTkxLDcgQEAgc3RhdGljIHZvaWQKPiBtanBlZ19l
bmNvZGVyX2NsaWVudF9zdHJlYW1fcmVwb3J0KFZpZGVvRW5jb2RlciAqdmlkZW9fZW5jb2RlciwK
PiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQzMl90
IGVuZF9mcmFtZV9kZWxheSwKPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICB1aW50MzJfdCBhdWRpb19kZWxheSkKPiAgewo+IC0gICAgTUpwZWdFbmNvZGVy
ICplbmNvZGVyID0gKE1KcGVnRW5jb2RlciopdmlkZW9fZW5jb2RlcjsKPiArICAgIE1KcGVnRW5j
b2RlciAqZW5jb2RlciA9IFNQSUNFX0NPTlRBSU5FUk9GKHZpZGVvX2VuY29kZXIsIE1KcGVnRW5j
b2RlciwKPiBiYXNlKTsKPiAgICAgIE1KcGVnRW5jb2RlclJhdGVDb250cm9sICpyYXRlX2NvbnRy
b2wgPSAmZW5jb2Rlci0+cmF0ZV9jb250cm9sOwo+ICAgICAgTUpwZWdFbmNvZGVyQ2xpZW50U3Rh
dGUgKmNsaWVudF9zdGF0ZSA9ICZyYXRlX2NvbnRyb2wtPmNsaWVudF9zdGF0ZTsKPiAgICAgIHVp
bnQ2NF90IGF2Z19lbmNfc2l6ZSA9IDA7Cj4gQEAgLTEyODksNyArMTI4OSw3IEBAIHN0YXRpYyB2
b2lkCj4gbWpwZWdfZW5jb2Rlcl9jbGllbnRfc3RyZWFtX3JlcG9ydChWaWRlb0VuY29kZXIgKnZp
ZGVvX2VuY29kZXIsCj4gIAo+ICBzdGF0aWMgdm9pZCBtanBlZ19lbmNvZGVyX25vdGlmeV9zZXJ2
ZXJfZnJhbWVfZHJvcChWaWRlb0VuY29kZXIKPiAgKnZpZGVvX2VuY29kZXIpCj4gIHsKPiAtICAg
IE1KcGVnRW5jb2RlciAqZW5jb2RlciA9IChNSnBlZ0VuY29kZXIqKXZpZGVvX2VuY29kZXI7Cj4g
KyAgICBNSnBlZ0VuY29kZXIgKmVuY29kZXIgPSBTUElDRV9DT05UQUlORVJPRih2aWRlb19lbmNv
ZGVyLCBNSnBlZ0VuY29kZXIsCj4gYmFzZSk7Cj4gICAgICBlbmNvZGVyLT5yYXRlX2NvbnRyb2wu
c2VydmVyX3N0YXRlLm51bV9mcmFtZXNfZHJvcHBlZCsrOwo+ICAgICAgbWpwZWdfZW5jb2Rlcl9w
cm9jZXNzX3NlcnZlcl9kcm9wcyhlbmNvZGVyKTsKPiAgfQo+IEBAIC0xMzI4LDE0ICsxMzI4LDE0
IEBAIHN0YXRpYyB2b2lkCj4gbWpwZWdfZW5jb2Rlcl9wcm9jZXNzX3NlcnZlcl9kcm9wcyhNSnBl
Z0VuY29kZXIgKmVuY29kZXIpCj4gIAo+ICBzdGF0aWMgdWludDY0X3QgbWpwZWdfZW5jb2Rlcl9n
ZXRfYml0X3JhdGUoVmlkZW9FbmNvZGVyICp2aWRlb19lbmNvZGVyKQo+ICB7Cj4gLSAgICBNSnBl
Z0VuY29kZXIgKmVuY29kZXIgPSAoTUpwZWdFbmNvZGVyKil2aWRlb19lbmNvZGVyOwo+ICsgICAg
TUpwZWdFbmNvZGVyICplbmNvZGVyID0gU1BJQ0VfQ09OVEFJTkVST0YodmlkZW9fZW5jb2Rlciwg
TUpwZWdFbmNvZGVyLAo+IGJhc2UpOwo+ICAgICAgcmV0dXJuIGVuY29kZXItPnJhdGVfY29udHJv
bC5ieXRlX3JhdGUgKiA4Owo+ICB9Cj4gIAo+ICBzdGF0aWMgdm9pZCBtanBlZ19lbmNvZGVyX2dl
dF9zdGF0cyhWaWRlb0VuY29kZXIgKnZpZGVvX2VuY29kZXIsCj4gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIFZpZGVvRW5jb2RlclN0YXRzICpzdGF0cykKPiAgewo+IC0gICAg
TUpwZWdFbmNvZGVyICplbmNvZGVyID0gKE1KcGVnRW5jb2RlciopdmlkZW9fZW5jb2RlcjsKPiAr
ICAgIE1KcGVnRW5jb2RlciAqZW5jb2RlciA9IFNQSUNFX0NPTlRBSU5FUk9GKHZpZGVvX2VuY29k
ZXIsIE1KcGVnRW5jb2RlciwKPiBiYXNlKTsKPiAgICAgIHNwaWNlX2Fzc2VydChlbmNvZGVyICE9
IE5VTEwgJiYgc3RhdHMgIT0gTlVMTCk7Cj4gICAgICBzdGF0cy0+c3RhcnRpbmdfYml0X3JhdGUg
PSBlbmNvZGVyLT5zdGFydGluZ19iaXRfcmF0ZTsKPiAgICAgIHN0YXRzLT5jdXJfYml0X3JhdGUg
PSBtanBlZ19lbmNvZGVyX2dldF9iaXRfcmF0ZSh2aWRlb19lbmNvZGVyKTsKPiBkaWZmIC0tZ2l0
IGEvc2VydmVyL3BpeG1hcC1jYWNoZS5jIGIvc2VydmVyL3BpeG1hcC1jYWNoZS5jCj4gaW5kZXgg
NDg5ZmUwYmY2Li40OTY1OWVhNDEgMTAwNjQ0Cj4gLS0tIGEvc2VydmVyL3BpeG1hcC1jYWNoZS5j
Cj4gKysrIGIvc2VydmVyL3BpeG1hcC1jYWNoZS5jCj4gQEAgLTQ1LDcgKzQ1LDcgQEAgdm9pZCBw
aXhtYXBfY2FjaGVfY2xlYXIoUGl4bWFwQ2FjaGUgKmNhY2hlKQo+ICAgICAgfQo+ICAKPiAgICAg
IFNQSUNFX1ZFUklGWShTUElDRV9PRkZTRVRPRihOZXdDYWNoZUl0ZW0sIGxydV9saW5rKSA9PSAw
KTsKPiAtICAgIHdoaWxlICgoaXRlbSA9IChOZXdDYWNoZUl0ZW0gKilyaW5nX2dldF9oZWFkKCZj
YWNoZS0+bHJ1KSkpIHsKPiArICAgIHdoaWxlICgoaXRlbSA9IFNQSUNFX0NPTlRBSU5FUk9GKHJp
bmdfZ2V0X2hlYWQoJmNhY2hlLT5scnUpLAo+IE5ld0NhY2hlSXRlbSwgbHJ1X2xpbmspKSkgewo+
ICAgICAgICAgIHJpbmdfcmVtb3ZlKCZpdGVtLT5scnVfbGluayk7Cj4gICAgICAgICAgZ19mcmVl
KGl0ZW0pOwo+ICAgICAgfQpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fXwpTcGljZS1kZXZlbCBtYWlsaW5nIGxpc3QKU3BpY2UtZGV2ZWxAbGlzdHMuZnJlZWRl
c2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8v
c3BpY2UtZGV2ZWw=
