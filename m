Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 1B6D274FE2
	for <lists+spice-devel@lfdr.de>; Thu, 25 Jul 2019 15:44:04 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 3C8BA6E788;
	Thu, 25 Jul 2019 13:44:02 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 039E76E788
 for <spice-devel@lists.freedesktop.org>; Thu, 25 Jul 2019 13:44:01 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx02.intmail.prod.int.phx2.redhat.com
 [10.5.11.12])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id 97FCC44BD1
 for <spice-devel@lists.freedesktop.org>; Thu, 25 Jul 2019 13:44:00 +0000 (UTC)
Received: from fziglio.remote.csb (unknown [10.33.32.8])
 by smtp.corp.redhat.com (Postfix) with ESMTP id D62DC60BEC;
 Thu, 25 Jul 2019 13:43:59 +0000 (UTC)
From: Frediano Ziglio <fziglio@redhat.com>
To: spice-devel@lists.freedesktop.org
Date: Thu, 25 Jul 2019 14:43:53 +0100
Message-Id: <20190725134353.23174-3-fziglio@redhat.com>
In-Reply-To: <20190725134353.23174-1-fziglio@redhat.com>
References: <20190725134353.23174-1-fziglio@redhat.com>
MIME-Version: 1.0
X-Scanned-By: MIMEDefang 2.79 on 10.5.11.12
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16
 (mx1.redhat.com [10.5.110.30]); Thu, 25 Jul 2019 13:44:00 +0000 (UTC)
Subject: [Spice-devel] [PATCH spice-gtk 3/3] usb-device-manager: Use
 SpiceUsbBackendDevice directly instead of SpiceUsbDevice
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

VGhleSB3ZXJlIHRoZSBzYW1lIHN0cnVjdHVyZS4KClNpZ25lZC1vZmYtYnk6IEZyZWRpYW5vIFpp
Z2xpbyA8ZnppZ2xpb0ByZWRoYXQuY29tPgotLS0KIHNyYy91c2ItYmFja2VuZC5jICAgICAgICB8
ICA2ICsrKy0tLQogc3JjL3VzYi1iYWNrZW5kLmggICAgICAgIHwgIDYgKysrLS0tCiBzcmMvdXNi
LWRldmljZS1tYW5hZ2VyLmMgfCA0MiArKysrKysrKysrKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tCiAzIGZpbGVzIGNoYW5nZWQsIDE3IGluc2VydGlvbnMoKyksIDM3IGRlbGV0aW9ucygt
KQoKZGlmZiAtLWdpdCBhL3NyYy91c2ItYmFja2VuZC5jIGIvc3JjL3VzYi1iYWNrZW5kLmMKaW5k
ZXggN2UwZTRhOGEuLjI2YmRhOGI5IDEwMDY0NAotLS0gYS9zcmMvdXNiLWJhY2tlbmQuYworKysg
Yi9zcmMvdXNiLWJhY2tlbmQuYwpAQCAtNDQsNyArNDQsNyBAQAogCiAjZGVmaW5lIExPVURfREVC
VUcoeCwgLi4uKQogCi1zdHJ1Y3QgX1NwaWNlVXNiQmFja2VuZERldmljZQorc3RydWN0IF9TcGlj
ZVVzYkRldmljZQogewogICAgIGxpYnVzYl9kZXZpY2UgKmxpYnVzYl9kZXZpY2U7CiAgICAgZ2lu
dCByZWZfY291bnQ7CkBAIC01MTIsMTIgKzUxMiwxMiBAQCB2b2lkIHNwaWNlX3VzYl9iYWNrZW5k
X2RlbGV0ZShTcGljZVVzYkJhY2tlbmQgKmJlKQogICAgIFNQSUNFX0RFQlVHKCIlcyA8PCIsIF9f
RlVOQ1RJT05fXyk7CiB9CiAKLWNvbnN0IFVzYkRldmljZUluZm9ybWF0aW9uKiBzcGljZV91c2Jf
YmFja2VuZF9kZXZpY2VfZ2V0X2luZm8oU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpkZXYpCitjb25z
dCBVc2JEZXZpY2VJbmZvcm1hdGlvbiogc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX2dldF9pbmZv
KGNvbnN0IFNwaWNlVXNiQmFja2VuZERldmljZSAqZGV2KQogewogICAgIHJldHVybiAmZGV2LT5k
ZXZpY2VfaW5mbzsKIH0KIAotZ2NvbnN0cG9pbnRlciBzcGljZV91c2JfYmFja2VuZF9kZXZpY2Vf
Z2V0X2xpYmRldihTcGljZVVzYkJhY2tlbmREZXZpY2UgKmRldikKK2djb25zdHBvaW50ZXIgc3Bp
Y2VfdXNiX2JhY2tlbmRfZGV2aWNlX2dldF9saWJkZXYoY29uc3QgU3BpY2VVc2JCYWNrZW5kRGV2
aWNlICpkZXYpCiB7CiAgICAgcmV0dXJuIGRldi0+bGlidXNiX2RldmljZTsKIH0KZGlmZiAtLWdp
dCBhL3NyYy91c2ItYmFja2VuZC5oIGIvc3JjL3VzYi1iYWNrZW5kLmgKaW5kZXggNjlhNDkwYjUu
LjZlYjAyY2I1IDEwMDY0NAotLS0gYS9zcmMvdXNiLWJhY2tlbmQuaAorKysgYi9zcmMvdXNiLWJh
Y2tlbmQuaApAQCAtMjgsNyArMjgsNyBAQAogR19CRUdJTl9ERUNMUwogCiB0eXBlZGVmIHN0cnVj
dCBfU3BpY2VVc2JCYWNrZW5kIFNwaWNlVXNiQmFja2VuZDsKLXR5cGVkZWYgc3RydWN0IF9TcGlj
ZVVzYkJhY2tlbmREZXZpY2UgU3BpY2VVc2JCYWNrZW5kRGV2aWNlOwordHlwZWRlZiBzdHJ1Y3Qg
X1NwaWNlVXNiRGV2aWNlIFNwaWNlVXNiQmFja2VuZERldmljZTsKIHR5cGVkZWYgc3RydWN0IF9T
cGljZVVzYkJhY2tlbmRDaGFubmVsIFNwaWNlVXNiQmFja2VuZENoYW5uZWw7CiAKIHR5cGVkZWYg
c3RydWN0IFVzYkRldmljZUluZm9ybWF0aW9uCkBAIC02NSw4ICs2NSw4IEBAIHZvaWQgc3BpY2Vf
dXNiX2JhY2tlbmRfZGVyZWdpc3Rlcl9ob3RwbHVnKFNwaWNlVXNiQmFja2VuZCAqYmUpOwogLyog
U3BpY2UgVVNCIGJhY2tlbmQgZGV2aWNlIEFQSSAqLwogU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpz
cGljZV91c2JfYmFja2VuZF9kZXZpY2VfcmVmKFNwaWNlVXNiQmFja2VuZERldmljZSAqZGV2KTsK
IHZvaWQgc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX3VucmVmKFNwaWNlVXNiQmFja2VuZERldmlj
ZSAqZGV2KTsKLWdjb25zdHBvaW50ZXIgc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX2dldF9saWJk
ZXYoU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpkZXYpOwotY29uc3QgVXNiRGV2aWNlSW5mb3JtYXRp
b24qIHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9nZXRfaW5mbyhTcGljZVVzYkJhY2tlbmREZXZp
Y2UgKmRldik7CitnY29uc3Rwb2ludGVyIHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9nZXRfbGli
ZGV2KGNvbnN0IFNwaWNlVXNiQmFja2VuZERldmljZSAqZGV2KTsKK2NvbnN0IFVzYkRldmljZUlu
Zm9ybWF0aW9uKiBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfZ2V0X2luZm8oY29uc3QgU3BpY2VV
c2JCYWNrZW5kRGV2aWNlICpkZXYpOwogZ2Jvb2xlYW4gc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNl
X2lzb2NoKFNwaWNlVXNiQmFja2VuZERldmljZSAqZGV2KTsKIC8qIHJldHVybnMgMCBpZiB0aGUg
ZGV2aWNlIHBhc3NlcyB0aGUgZmlsdGVyICovCiBpbnQgc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNl
X2NoZWNrX2ZpbHRlcihTcGljZVVzYkJhY2tlbmREZXZpY2UgKmRldiwKZGlmZiAtLWdpdCBhL3Ny
Yy91c2ItZGV2aWNlLW1hbmFnZXIuYyBiL3NyYy91c2ItZGV2aWNlLW1hbmFnZXIuYwppbmRleCBi
ZjFjMjNiZC4uODk3YWEwOWMgMTAwNjQ0Ci0tLSBhL3NyYy91c2ItZGV2aWNlLW1hbmFnZXIuYwor
KysgYi9zcmMvdXNiLWRldmljZS1tYW5hZ2VyLmMKQEAgLTEyMCwxMiArMTIwLDYgQEAgZW51bSB7
CiAKICNpZmRlZiBVU0VfVVNCUkVESVIKIAotc3RydWN0IF9TcGljZVVzYkRldmljZSB7Ci0gICAg
U3BpY2VVc2JCYWNrZW5kRGV2aWNlICpiZGV2OwotICAgIGdpbnQgICAgcmVmOwotfTsKLQotCiBz
dGF0aWMgdm9pZCBjaGFubmVsX25ldyhTcGljZVNlc3Npb24gKnNlc3Npb24sIFNwaWNlQ2hhbm5l
bCAqY2hhbm5lbCwKICAgICAgICAgICAgICAgICAgICAgICAgIGdwb2ludGVyIHVzZXJfZGF0YSk7
CiBzdGF0aWMgdm9pZCBjaGFubmVsX2Rlc3Ryb3koU3BpY2VTZXNzaW9uICpzZXNzaW9uLCBTcGlj
ZUNoYW5uZWwgKmNoYW5uZWwsCkBAIC02MzcsNyArNjMxLDcgQEAgc3BpY2VfdXNiX2RldmljZV9n
ZXRfbGlidXNiX2RldmljZShjb25zdCBTcGljZVVzYkRldmljZSAqaW5mbyBHX0dOVUNfVU5VU0VE
KQogI2lmZGVmIFVTRV9VU0JSRURJUgogICAgIGdfcmV0dXJuX3ZhbF9pZl9mYWlsKGluZm8gIT0g
TlVMTCwgRkFMU0UpOwogCi0gICAgcmV0dXJuIHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9nZXRf
bGliZGV2KGluZm8tPmJkZXYpOworICAgIHJldHVybiBzcGljZV91c2JfYmFja2VuZF9kZXZpY2Vf
Z2V0X2xpYmRldihpbmZvKTsKICNlbmRpZgogICAgIHJldHVybiBOVUxMOwogfQpAQCAtMTQ3Niwx
NiArMTQ3MCw5IEBAIGdjaGFyICpzcGljZV91c2JfZGV2aWNlX2dldF9kZXNjcmlwdGlvbihTcGlj
ZVVzYkRldmljZSAqZGV2aWNlLCBjb25zdCBnY2hhciAqZm9yCiAgKi8KIHN0YXRpYyBTcGljZVVz
YkRldmljZSAqc3BpY2VfdXNiX2RldmljZV9uZXcoU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpiZGV2
KQogewotICAgIFNwaWNlVXNiRGV2aWNlICppbmZvOwotCiAgICAgZ19yZXR1cm5fdmFsX2lmX2Zh
aWwoYmRldiAhPSBOVUxMLCBOVUxMKTsKIAotICAgIGluZm8gPSBnX25ldzAoU3BpY2VVc2JEZXZp
Y2UsIDEpOwotCi0gICAgaW5mby0+cmVmID0gMTsKLSAgICBpbmZvLT5iZGV2ID0gc3BpY2VfdXNi
X2JhY2tlbmRfZGV2aWNlX3JlZihiZGV2KTsKLQotICAgIHJldHVybiBpbmZvOworICAgIHJldHVy
biBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfcmVmKGJkZXYpOwogfQogCiBndWludDggc3BpY2Vf
dXNiX2RldmljZV9nZXRfYnVzbnVtKGNvbnN0IFNwaWNlVXNiRGV2aWNlICppbmZvKQpAQCAtMTQ5
NCw3ICsxNDgxLDcgQEAgZ3VpbnQ4IHNwaWNlX3VzYl9kZXZpY2VfZ2V0X2J1c251bShjb25zdCBT
cGljZVVzYkRldmljZSAqaW5mbykKIAogICAgIGdfcmV0dXJuX3ZhbF9pZl9mYWlsKGluZm8gIT0g
TlVMTCwgMCk7CiAKLSAgICBiX2luZm8gPSBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfZ2V0X2lu
Zm8oaW5mby0+YmRldik7CisgICAgYl9pbmZvID0gc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX2dl
dF9pbmZvKGluZm8pOwogICAgIHJldHVybiBiX2luZm8tPmJ1czsKIH0KIApAQCAtMTUwNCw3ICsx
NDkxLDcgQEAgZ3VpbnQ4IHNwaWNlX3VzYl9kZXZpY2VfZ2V0X2RldmFkZHIoY29uc3QgU3BpY2VV
c2JEZXZpY2UgKmluZm8pCiAKICAgICBnX3JldHVybl92YWxfaWZfZmFpbChpbmZvICE9IE5VTEws
IDApOwogCi0gICAgYl9pbmZvID0gc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX2dldF9pbmZvKGlu
Zm8tPmJkZXYpOworICAgIGJfaW5mbyA9IHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9nZXRfaW5m
byhpbmZvKTsKICAgICByZXR1cm4gYl9pbmZvLT5hZGRyZXNzOwogfQogCkBAIC0xNTE0LDcgKzE1
MDEsNyBAQCBndWludDE2IHNwaWNlX3VzYl9kZXZpY2VfZ2V0X3ZpZChjb25zdCBTcGljZVVzYkRl
dmljZSAqaW5mbykKIAogICAgIGdfcmV0dXJuX3ZhbF9pZl9mYWlsKGluZm8gIT0gTlVMTCwgMCk7
CiAKLSAgICBiX2luZm8gPSBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfZ2V0X2luZm8oaW5mby0+
YmRldik7CisgICAgYl9pbmZvID0gc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX2dldF9pbmZvKGlu
Zm8pOwogICAgIHJldHVybiBiX2luZm8tPnZpZDsKIH0KIApAQCAtMTUyNCw3ICsxNTExLDcgQEAg
Z3VpbnQxNiBzcGljZV91c2JfZGV2aWNlX2dldF9waWQoY29uc3QgU3BpY2VVc2JEZXZpY2UgKmlu
Zm8pCiAKICAgICBnX3JldHVybl92YWxfaWZfZmFpbChpbmZvICE9IE5VTEwsIDApOwogCi0gICAg
Yl9pbmZvID0gc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX2dldF9pbmZvKGluZm8tPmJkZXYpOwor
ICAgIGJfaW5mbyA9IHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9nZXRfaW5mbyhpbmZvKTsKICAg
ICByZXR1cm4gYl9pbmZvLT5waWQ7CiB9CiAKQEAgLTE1MzIsNyArMTUxOSw3IEBAIGdib29sZWFu
IHNwaWNlX3VzYl9kZXZpY2VfaXNfaXNvY2hyb25vdXMoY29uc3QgU3BpY2VVc2JEZXZpY2UgKmlu
Zm8pCiB7CiAgICAgZ19yZXR1cm5fdmFsX2lmX2ZhaWwoaW5mbyAhPSBOVUxMLCAwKTsKIAotICAg
IHJldHVybiBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfaXNvY2goaW5mby0+YmRldik7CisgICAg
cmV0dXJuIHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9pc29jaCgoU3BpY2VVc2JCYWNrZW5kRGV2
aWNlKikgaW5mbyk7CiB9CiAKICNpZmRlZiBHX09TX1dJTjMyCkBAIC0xNjA1LDIxICsxNTkyLDE0
IEBAIHZvaWQgX3VzYmRrX2hpZGVyX3VwZGF0ZShTcGljZVVzYkRldmljZU1hbmFnZXIgKm1hbmFn
ZXIpCiBzdGF0aWMgU3BpY2VVc2JEZXZpY2UgKnNwaWNlX3VzYl9kZXZpY2VfcmVmKFNwaWNlVXNi
RGV2aWNlICppbmZvKQogewogICAgIGdfcmV0dXJuX3ZhbF9pZl9mYWlsKGluZm8gIT0gTlVMTCwg
TlVMTCk7Ci0gICAgZ19hdG9taWNfaW50X2luYygmaW5mby0+cmVmKTsKLSAgICByZXR1cm4gaW5m
bzsKKyAgICByZXR1cm4gc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX3JlZihpbmZvKTsKIH0KIAog
c3RhdGljIHZvaWQgc3BpY2VfdXNiX2RldmljZV91bnJlZihTcGljZVVzYkRldmljZSAqaW5mbykK
IHsKLSAgICBnYm9vbGVhbiByZWZfY291bnRfaXNfMDsKLQogICAgIGdfcmV0dXJuX2lmX2ZhaWwo
aW5mbyAhPSBOVUxMKTsKIAotICAgIHJlZl9jb3VudF9pc18wID0gZ19hdG9taWNfaW50X2RlY19h
bmRfdGVzdCgmaW5mby0+cmVmKTsKLSAgICBpZiAocmVmX2NvdW50X2lzXzApIHsKLSAgICAgICAg
c3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX3VucmVmKGluZm8tPmJkZXYpOwotICAgICAgICBnX2Zy
ZWUoaW5mbyk7Ci0gICAgfQorICAgIHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV91bnJlZihpbmZv
KTsKIH0KIAogc3RhdGljIGdib29sZWFuCkBAIC0xNjMwLDcgKzE2MTAsNyBAQCBzcGljZV91c2Jf
bWFuYWdlcl9kZXZpY2VfZXF1YWxfYmRldihTcGljZVVzYkRldmljZU1hbmFnZXIgKm1hbmFnZXIs
CiAgICAgaWYgKChpbmZvID09IE5VTEwpIHx8IChiZGV2ID09IE5VTEwpKQogICAgICAgICByZXR1
cm4gRkFMU0U7CiAKLSAgICByZXR1cm4gaW5mby0+YmRldiA9PSBiZGV2OworICAgIHJldHVybiBp
bmZvID09IGJkZXY7CiB9CiAKIC8qCkBAIC0xNjQyLDYgKzE2MjIsNiBAQCBzcGljZV91c2JfZGV2
aWNlX21hbmFnZXJfZGV2aWNlX3RvX2JkZXYoU3BpY2VVc2JEZXZpY2VNYW5hZ2VyICpzZWxmLAog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNwaWNlVXNiRGV2aWNlICpp
bmZvKQogewogICAgIC8qIFNpbXBseSByZXR1cm4gYSByZWYgdG8gdGhlIGNhY2hlZCBsaWJkZXYg
Ki8KLSAgICByZXR1cm4gc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX3JlZihpbmZvLT5iZGV2KTsK
KyAgICByZXR1cm4gc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX3JlZihpbmZvKTsKIH0KICNlbmRp
ZiAvKiBVU0VfVVNCUkVESVIgKi8KLS0gCjIuMjAuMQoKX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX18KU3BpY2UtZGV2ZWwgbWFpbGluZyBsaXN0ClNwaWNlLWRl
dmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9t
YWlsbWFuL2xpc3RpbmZvL3NwaWNlLWRldmVs
