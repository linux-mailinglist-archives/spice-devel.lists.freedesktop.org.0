Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id E88E7A9F28
	for <lists+spice-devel@lfdr.de>; Thu,  5 Sep 2019 12:02:55 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id BA4B06E02A;
	Thu,  5 Sep 2019 10:02:52 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id DB0686E02A
 for <spice-devel@lists.freedesktop.org>; Thu,  5 Sep 2019 10:02:51 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx08.intmail.prod.int.phx2.redhat.com
 [10.5.11.23])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id 87D873175285
 for <spice-devel@lists.freedesktop.org>; Thu,  5 Sep 2019 10:02:51 +0000 (UTC)
Received: from fziglio.remote.csb (unknown [10.33.32.10])
 by smtp.corp.redhat.com (Postfix) with ESMTP id 848D9194B9;
 Thu,  5 Sep 2019 10:02:50 +0000 (UTC)
From: Frediano Ziglio <fziglio@redhat.com>
To: spice-devel@lists.freedesktop.org
Date: Thu,  5 Sep 2019 11:02:45 +0100
Message-Id: <20190905100245.2244-2-fziglio@redhat.com>
In-Reply-To: <20190905100245.2244-1-fziglio@redhat.com>
References: <20190905100245.2244-1-fziglio@redhat.com>
MIME-Version: 1.0
X-Scanned-By: MIMEDefang 2.84 on 10.5.11.23
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16
 (mx1.redhat.com [10.5.110.49]); Thu, 05 Sep 2019 10:02:51 +0000 (UTC)
Subject: [Spice-devel] [PATCH spice-gtk 2/2] usb-backend:
 SpiceUsbredirChannel is not opaque anymore
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

VXNlIHNwZWNpZmljIHR5cGUgaW4gc3BpY2VfdXNiX2JhY2tlbmRfY2hhbm5lbF9uZXcgYW5kCnNw
ZWNpZmljIG5hbWUgaW5zdGVhZCBvZiAidXNlcl9kYXRhIiBmaWVsZC4KClNpZ25lZC1vZmYtYnk6
IEZyZWRpYW5vIFppZ2xpbyA8ZnppZ2xpb0ByZWRoYXQuY29tPgotLS0KIHNyYy91c2ItYmFja2Vu
ZC5jIHwgMTcgKysrKysrKystLS0tLS0tLS0KIHNyYy91c2ItYmFja2VuZC5oIHwgIDIgKy0KIDIg
ZmlsZXMgY2hhbmdlZCwgOSBpbnNlcnRpb25zKCspLCAxMCBkZWxldGlvbnMoLSkKCmRpZmYgLS1n
aXQgYS9zcmMvdXNiLWJhY2tlbmQuYyBiL3NyYy91c2ItYmFja2VuZC5jCmluZGV4IGRiYzk2MTk0
Li5lMDIxZDQzNCAxMDA2NDQKLS0tIGEvc3JjL3VzYi1iYWNrZW5kLmMKKysrIGIvc3JjL3VzYi1i
YWNrZW5kLmMKQEAgLTc4LDcgKzc4LDcgQEAgc3RydWN0IF9TcGljZVVzYkJhY2tlbmRDaGFubmVs
CiAgICAgc3RydWN0IHVzYnJlZGlyZmlsdGVyX3J1bGUgKnJ1bGVzOwogICAgIGludCBydWxlc19j
b3VudDsKICAgICBTcGljZVVzYkJhY2tlbmREZXZpY2UgKmF0dGFjaGVkOwotICAgIFNwaWNlVXNi
cmVkaXJDaGFubmVsICAqdXNlcl9kYXRhOworICAgIFNwaWNlVXNicmVkaXJDaGFubmVsICp1c2Jy
ZWRpcl9jaGFubmVsOwogICAgIFNwaWNlVXNiQmFja2VuZCAqYmFja2VuZDsKICAgICBHRXJyb3Ig
KiplcnJvcjsKIH07CkBAIC0zOTQsNyArMzk0LDcgQEAgc3RhdGljIHZvaWQgdXNicmVkaXJfd3Jp
dGVfZmx1c2hfY2FsbGJhY2sodm9pZCAqdXNlcl9kYXRhKQogICAgICAgICAvKiBqdXN0IHRvIGJl
IG9uIHRoZSBzYWZlIHNpZGUgKi8KICAgICAgICAgcmV0dXJuOwogICAgIH0KLSAgICBpZiAoaXNf
Y2hhbm5lbF9yZWFkeShjaC0+dXNlcl9kYXRhKSkgeworICAgIGlmIChpc19jaGFubmVsX3JlYWR5
KGNoLT51c2JyZWRpcl9jaGFubmVsKSkgewogICAgICAgICBTUElDRV9ERUJVRygiJXMgY2ggJXAg
LT4gdXNicmVkaXJob3N0IiwgX19GVU5DVElPTl9fLCBjaCk7CiAgICAgICAgIHVzYnJlZGlyaG9z
dF93cml0ZV9ndWVzdF9kYXRhKGNoLT51c2JyZWRpcmhvc3QpOwogICAgIH0gZWxzZSB7CkBAIC02
MTQsMTQgKzYxNCwxNCBAQCBzdGF0aWMgaW50IHVzYnJlZGlyX3dyaXRlX2NhbGxiYWNrKHZvaWQg
KnVzZXJfZGF0YSwgdWludDhfdCAqZGF0YSwgaW50IGNvdW50KQogICAgIFNwaWNlVXNiQmFja2Vu
ZENoYW5uZWwgKmNoID0gdXNlcl9kYXRhOwogICAgIGludCByZXM7CiAgICAgU1BJQ0VfREVCVUco
IiVzIGNoICVwLCAlZCBieXRlcyIsIF9fRlVOQ1RJT05fXywgY2gsIGNvdW50KTsKLSAgICByZXMg
PSBzcGljZV91c2JyZWRpcl93cml0ZShjaC0+dXNlcl9kYXRhLCBkYXRhLCBjb3VudCk7CisgICAg
cmVzID0gc3BpY2VfdXNicmVkaXJfd3JpdGUoY2gtPnVzYnJlZGlyX2NoYW5uZWwsIGRhdGEsIGNv
dW50KTsKICAgICByZXR1cm4gcmVzOwogfQogCiBzdGF0aWMgdWludDY0X3QgdXNicmVkaXJfYnVm
ZmVyZWRfb3V0cHV0X3NpemVfY2FsbGJhY2sodm9pZCAqdXNlcl9kYXRhKQogewogICAgIFNwaWNl
VXNiQmFja2VuZENoYW5uZWwgKmNoID0gdXNlcl9kYXRhOwotICAgIHJldHVybiBzcGljZV9jaGFu
bmVsX2dldF9xdWV1ZV9zaXplKFNQSUNFX0NIQU5ORUwoY2gtPnVzZXJfZGF0YSkpOworICAgIHJl
dHVybiBzcGljZV9jaGFubmVsX2dldF9xdWV1ZV9zaXplKFNQSUNFX0NIQU5ORUwoY2gtPnVzYnJl
ZGlyX2NoYW5uZWwpKTsKIH0KIAogaW50IHNwaWNlX3VzYl9iYWNrZW5kX3JlYWRfZ3Vlc3RfZGF0
YShTcGljZVVzYkJhY2tlbmRDaGFubmVsICpjaCwgdWludDhfdCAqZGF0YSwgaW50IGNvdW50KQpA
QCAtNzQ3LDE2ICs3NDcsMTUgQEAgdm9pZCBzcGljZV91c2JfYmFja2VuZF9jaGFubmVsX2RldGFj
aChTcGljZVVzYkJhY2tlbmRDaGFubmVsICpjaCkKICAgICBjaC0+YXR0YWNoZWQgPSBOVUxMOwog
fQogCi1TcGljZVVzYkJhY2tlbmRDaGFubmVsICpzcGljZV91c2JfYmFja2VuZF9jaGFubmVsX25l
dyhTcGljZVVzYkJhY2tlbmQgKmJlLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgdm9pZCAqdXNlcl9kYXRhKQorU3BpY2VVc2JCYWNrZW5kQ2hh
bm5lbCAqCitzcGljZV91c2JfYmFja2VuZF9jaGFubmVsX25ldyhTcGljZVVzYkJhY2tlbmQgKmJl
LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU3BpY2VVc2JyZWRpckNoYW5uZWwgKnVz
YnJlZGlyX2NoYW5uZWwpCiB7CiAgICAgU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCAqY2g7CiAKLSAg
ICBnX3JldHVybl92YWxfaWZfZmFpbChTUElDRV9JU19VU0JSRURJUl9DSEFOTkVMKHVzZXJfZGF0
YSksIE5VTEwpOwotCiAgICAgY2ggPSBnX25ldzAoU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCwgMSk7
CiAgICAgU1BJQ0VfREVCVUcoIiVzID4+IiwgX19GVU5DVElPTl9fKTsKLSAgICBjaC0+dXNlcl9k
YXRhID0gU1BJQ0VfVVNCUkVESVJfQ0hBTk5FTCh1c2VyX2RhdGEpOworICAgIGNoLT51c2JyZWRp
cl9jaGFubmVsID0gdXNicmVkaXJfY2hhbm5lbDsKICAgICBpZiAoYmUtPmxpYnVzYl9jb250ZXh0
KSB7CiAgICAgICAgIGNoLT5iYWNrZW5kID0gYmU7CiAgICAgICAgIGNoLT51c2JyZWRpcmhvc3Qg
PSB1c2JyZWRpcmhvc3Rfb3Blbl9mdWxsKApkaWZmIC0tZ2l0IGEvc3JjL3VzYi1iYWNrZW5kLmgg
Yi9zcmMvdXNiLWJhY2tlbmQuaAppbmRleCA1ODMwMzEyYi4uNzU1ODgwNzAgMTAwNjQ0Ci0tLSBh
L3NyYy91c2ItYmFja2VuZC5oCisrKyBiL3NyYy91c2ItYmFja2VuZC5oCkBAIC03Myw3ICs3Myw3
IEBAIGludCBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfY2hlY2tfZmlsdGVyKFNwaWNlVXNiQmFj
a2VuZERldmljZSAqZGV2LAogCiAvKiBTcGljZSBVU0IgYmFja2VuZCBjaGFubmVsIEFQSSAqLwog
U3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCAqc3BpY2VfdXNiX2JhY2tlbmRfY2hhbm5lbF9uZXcoU3Bp
Y2VVc2JCYWNrZW5kICpjb250ZXh0LAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgdm9pZCAgICAgICAgICAgICp1c2VyX2RhdGEpOworICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU3BpY2VVc2Jy
ZWRpckNoYW5uZWwgKnVzYnJlZGlyX2NoYW5uZWwpOwogdm9pZCBzcGljZV91c2JfYmFja2VuZF9j
aGFubmVsX2RlbGV0ZShTcGljZVVzYkJhY2tlbmRDaGFubmVsICpjaCk7CiAvKiByZXR1cm5zIDAg
Zm9yIHN1Y2Nlc3Mgb3IgZXJyb3IgY29kZSAqLwogaW50IHNwaWNlX3VzYl9iYWNrZW5kX3JlYWRf
Z3Vlc3RfZGF0YShTcGljZVVzYkJhY2tlbmRDaGFubmVsICpjaCwgdWludDhfdCAqZGF0YSwgaW50
IGNvdW50KTsKLS0gCjIuMjAuMQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX18KU3BpY2UtZGV2ZWwgbWFpbGluZyBsaXN0ClNwaWNlLWRldmVsQGxpc3RzLmZy
ZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3Rp
bmZvL3NwaWNlLWRldmVs
