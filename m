Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id A32BC56B88
	for <lists+spice-devel@lfdr.de>; Wed, 26 Jun 2019 16:10:32 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 309AB6E446;
	Wed, 26 Jun 2019 14:10:31 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 6A62F6E446
 for <spice-devel@lists.freedesktop.org>; Wed, 26 Jun 2019 14:10:29 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx07.intmail.prod.int.phx2.redhat.com
 [10.5.11.22])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id CCF1530832D8
 for <spice-devel@lists.freedesktop.org>; Wed, 26 Jun 2019 14:10:28 +0000 (UTC)
Received: from dhcp-4-93.tlv.redhat.com (dhcp-4-93.tlv.redhat.com [10.35.4.93])
 by smtp.corp.redhat.com (Postfix) with ESMTP id 3AB6E1001281
 for <spice-devel@lists.freedesktop.org>; Wed, 26 Jun 2019 14:10:28 +0000 (UTC)
From: Snir Sheriber <ssheribe@redhat.com>
To: spice-devel@lists.freedesktop.org
Date: Wed, 26 Jun 2019 17:10:25 +0300
Message-Id: <20190626141026.30745-1-ssheribe@redhat.com>
MIME-Version: 1.0
X-Scanned-By: MIMEDefang 2.84 on 10.5.11.22
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16
 (mx1.redhat.com [10.5.110.44]); Wed, 26 Jun 2019 14:10:28 +0000 (UTC)
Subject: [Spice-devel] [PATCH spice-streaming-agent 1/2] gst-plugin: Drop
 sstream and use dedicated functions instead
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

U2lnbmVkLW9mZi1ieTogU25pciBTaGVyaWJlciA8c3NoZXJpYmVAcmVkaGF0LmNvbT4KLS0tCiBz
cmMvZ3N0LXBsdWdpbi5jcHAgfCAzMyArKysrKysrKysrKysrKysrKy0tLS0tLS0tLS0tLS0tLS0K
IDEgZmlsZSBjaGFuZ2VkLCAxNyBpbnNlcnRpb25zKCspLCAxNiBkZWxldGlvbnMoLSkKCmRpZmYg
LS1naXQgYS9zcmMvZ3N0LXBsdWdpbi5jcHAgYi9zcmMvZ3N0LXBsdWdpbi5jcHAKaW5kZXggOTg1
OGJlYi4uY2Y2NjBlYiAxMDA2NDQKLS0tIGEvc3JjL2dzdC1wbHVnaW4uY3BwCisrKyBiL3NyYy9n
c3QtcGx1Z2luLmNwcApAQCAtOCw3ICs4LDYgQEAKICNpbmNsdWRlIDxjc3RyaW5nPgogI2luY2x1
ZGUgPGV4Y2VwdGlvbj4KICNpbmNsdWRlIDxzdGRleGNlcHQ+Ci0jaW5jbHVkZSA8c3N0cmVhbT4K
ICNpbmNsdWRlIDxtZW1vcnk+CiAjaW5jbHVkZSA8c3lzbG9nLmg+CiAjaW5jbHVkZSA8dW5pc3Rk
Lmg+CkBAIC0xMzIsMzQgKzEzMSwzMyBAQCBHc3RFbGVtZW50ICpHc3RyZWFtZXJGcmFtZUNhcHR1
cmU6OmdldF9lbmNvZGVyX3BsdWdpbihjb25zdCBHc3RyZWFtZXJFbmNvZGVyU2V0dAogICAgIEdM
aXN0ICpmaWx0ZXJlZDsKICAgICBHc3RFbGVtZW50ICplbmNvZGVyOwogICAgIEdzdEVsZW1lbnRG
YWN0b3J5ICpmYWN0b3J5ID0gbnVsbHB0cjsKLSAgICBzdGQ6OnN0cmluZ3N0cmVhbSBjYXBzX3Nz
OwogCiAgICAgc3dpdGNoIChzZXR0aW5ncy5jb2RlYykgewogICAgIGNhc2UgU1BJQ0VfVklERU9f
Q09ERUNfVFlQRV9IMjY0OgotICAgICAgICBjYXBzX3NzIDw8ICJ2aWRlby94LWgyNjQiIDw8ICIs
c3RyZWFtLWZvcm1hdD0oc3RyaW5nKWJ5dGUtc3RyZWFtIjsKKyAgICAgICAgc2lua19jYXBzLnJl
c2V0KGdzdF9jYXBzX25ld19zaW1wbGUoInZpZGVvL3gtaDI2NCIsICJzdHJlYW0tZm9ybWF0Iiwg
R19UWVBFX1NUUklORywgImJ5dGUtc3RyZWFtIiwgbnVsbHB0cikpOwogICAgICAgICBicmVhazsK
ICAgICBjYXNlIFNQSUNFX1ZJREVPX0NPREVDX1RZUEVfTUpQRUc6Ci0gICAgICAgIGNhcHNfc3Mg
PDwgImltYWdlL2pwZWciOworICAgICAgICBzaW5rX2NhcHMucmVzZXQoZ3N0X2NhcHNfbmV3X2Vt
cHR5X3NpbXBsZSgiaW1hZ2UvanBlZyIpKTsKICAgICAgICAgYnJlYWs7CiAgICAgY2FzZSBTUElD
RV9WSURFT19DT0RFQ19UWVBFX1ZQODoKLSAgICAgICAgY2Fwc19zcyA8PCAidmlkZW8veC12cDgi
OworICAgICAgICBzaW5rX2NhcHMucmVzZXQoZ3N0X2NhcHNfbmV3X2VtcHR5X3NpbXBsZSgidmlk
ZW8veC12cDgiKSk7CiAgICAgICAgIGJyZWFrOwogICAgIGNhc2UgU1BJQ0VfVklERU9fQ09ERUNf
VFlQRV9WUDk6Ci0gICAgICAgIGNhcHNfc3MgPDwgInZpZGVvL3gtdnA5IjsKKyAgICAgICAgc2lu
a19jYXBzLnJlc2V0KGdzdF9jYXBzX25ld19lbXB0eV9zaW1wbGUoInZpZGVvL3gtdnA5IikpOwog
ICAgICAgICBicmVhazsKICAgICBjYXNlIFNQSUNFX1ZJREVPX0NPREVDX1RZUEVfSDI2NToKLSAg
ICAgICAgY2Fwc19zcyA8PCAidmlkZW8veC1oMjY1IjsKKyAgICAgICAgc2lua19jYXBzLnJlc2V0
KGdzdF9jYXBzX25ld19lbXB0eV9zaW1wbGUoInZpZGVvL3gtaDI2NSIpKTsKICAgICAgICAgYnJl
YWs7CiAgICAgZGVmYXVsdCA6IC8qIFNob3VsZCBub3QgaGFwcGVuIC0ganVzdCB0byBhdm9pZCBj
b21waWxlcidzIGNvbXBsYWludCAqLwogICAgICAgICB0aHJvdyBzdGQ6OmxvZ2ljX2Vycm9yKCJV
bmtub3duIGNvZGVjIik7CiAgICAgfQotICAgIGNhcHNfc3MgPDwgIixmcmFtZXJhdGU9IiA8PCBz
ZXR0aW5ncy5mcHMgPDwgIi8xIjsKKyAgICBnc3RfY2Fwc19zZXRfc2ltcGxlKHNpbmtfY2Fwcy5n
ZXQoKSwgImZyYW1lcmF0ZSIsIEdTVF9UWVBFX0ZSQUNUSU9OLCBzZXR0aW5ncy5mcHMsIDEsIG51
bGxwdHIpOworICAgIGdjaGFyICpjYXBzX3N0ciA9IGdzdF9jYXBzX3RvX3N0cmluZyhzaW5rX2Nh
cHMuZ2V0KCkpOwogCiAgICAgZW5jb2RlcnMgPSBnc3RfZWxlbWVudF9mYWN0b3J5X2xpc3RfZ2V0
X2VsZW1lbnRzKEdTVF9FTEVNRU5UX0ZBQ1RPUllfVFlQRV9WSURFT19FTkNPREVSLCBHU1RfUkFO
S19OT05FKTsKLSAgICBzaW5rX2NhcHMucmVzZXQoZ3N0X2NhcHNfZnJvbV9zdHJpbmcoY2Fwc19z
cy5zdHIoKS5jX3N0cigpKSk7CiAgICAgZmlsdGVyZWQgPSBnc3RfZWxlbWVudF9mYWN0b3J5X2xp
c3RfZmlsdGVyKGVuY29kZXJzLCBzaW5rX2NhcHMuZ2V0KCksIEdTVF9QQURfU1JDLCBmYWxzZSk7
CiAgICAgaWYgKGZpbHRlcmVkKSB7Ci0gICAgICAgIGdzdF9zeXNsb2coTE9HX05PVElDRSwgIkxv
b2tpbmcgZm9yIGVuY29kZXIgcGx1Z2lucyB3aGljaCBjYW4gcHJvZHVjZSBhICclcycgc3RyZWFt
IiwgY2Fwc19zcy5zdHIoKS5jX3N0cigpKTsKKyAgICAgICAgZ3N0X3N5c2xvZyhMT0dfTk9USUNF
LCAiTG9va2luZyBmb3IgZW5jb2RlciBwbHVnaW5zIHdoaWNoIGNhbiBwcm9kdWNlIGEgJyVzJyBz
dHJlYW0iLCBjYXBzX3N0cik7CiAgICAgICAgIGZvciAoR0xpc3QgKmwgPSBmaWx0ZXJlZDsgbCAh
PSBudWxscHRyOyBsID0gbC0+bmV4dCkgewogICAgICAgICAgICAgaWYgKCFmYWN0b3J5ICYmICFz
ZXR0aW5ncy5lbmNvZGVyLmNvbXBhcmUoR1NUX0VMRU1FTlRfTkFNRShsLT5kYXRhKSkpIHsKICAg
ICAgICAgICAgICAgICBmYWN0b3J5ID0gKEdzdEVsZW1lbnRGYWN0b3J5KilsLT5kYXRhOwpAQCAt
MTY5LDE0ICsxNjcsMTUgQEAgR3N0RWxlbWVudCAqR3N0cmVhbWVyRnJhbWVDYXB0dXJlOjpnZXRf
ZW5jb2Rlcl9wbHVnaW4oY29uc3QgR3N0cmVhbWVyRW5jb2RlclNldHQKICAgICAgICAgaWYgKCFm
YWN0b3J5ICYmICFzZXR0aW5ncy5lbmNvZGVyLmVtcHR5KCkpIHsKICAgICAgICAgICAgIGdzdF9z
eXNsb2coTE9HX1dBUk5JTkcsCiAgICAgICAgICAgICAgICAgICAgICAgICJTcGVjaWZpZWQgZW5j
b2RlciBuYW1lZCAnJXMnIGNhbm5vdCBwcm9kdWNlICclcycgc3RyZWFtLCBtYWtlIHN1cmUgbWF0
Y2hpbmcgZ3N0LmNvZGVjIGlzIHNwZWNpZmllZCBhbmQgcGx1Z2luJ3MgYXZhaWxhYmlsaXR5IiwK
LSAgICAgICAgICAgICAgICAgICAgICAgc2V0dGluZ3MuZW5jb2Rlci5jX3N0cigpLCBjYXBzX3Nz
LnN0cigpLmNfc3RyKCkpOworICAgICAgICAgICAgICAgICAgICAgICBzZXR0aW5ncy5lbmNvZGVy
LmNfc3RyKCksIGNhcHNfc3RyKTsKICAgICAgICAgfQogICAgICAgICBmYWN0b3J5ID0gZmFjdG9y
eSA/IGZhY3RvcnkgOiAoR3N0RWxlbWVudEZhY3RvcnkqKWZpbHRlcmVkLT5kYXRhOwogICAgICAg
ICBnc3Rfc3lzbG9nKExPR19OT1RJQ0UsICInJXMnIGVuY29kZXIgcGx1Z2luIGlzIHVzZWQiLCBH
U1RfRUxFTUVOVF9OQU1FKGZhY3RvcnkpKTsKIAogICAgIH0gZWxzZSB7Ci0gICAgICAgIGdzdF9z
eXNsb2coTE9HX0VSUiwgIk5vIHN1aXRhYmxlIGVuY29kZXIgd2FzIGZvdW5kIGZvciAnJXMnIiwg
Y2Fwc19zcy5zdHIoKS5jX3N0cigpKTsKKyAgICAgICAgZ3N0X3N5c2xvZyhMT0dfRVJSLCAiTm8g
c3VpdGFibGUgZW5jb2RlciB3YXMgZm91bmQgZm9yICclcyciLCBjYXBzX3N0cik7CiAgICAgfQor
ICAgIGdfZnJlZShjYXBzX3N0cik7CiAKICAgICBlbmNvZGVyID0gZmFjdG9yeSA/IGdzdF9lbGVt
ZW50X2ZhY3RvcnlfY3JlYXRlKGZhY3RvcnksICJlbmNvZGVyIikgOiBudWxscHRyOwogICAgIGlm
IChlbmNvZGVyKSB7IC8vIEludmFsaWQgcHJvcGVydGllcyB3aWxsIGJlIGlnbm9yZWQgc2lsZW50
bHkKQEAgLTM1MSwxMCArMzUwLDEyIEBAIHZvaWQgR3N0cmVhbWVyRnJhbWVDYXB0dXJlOjp4bGli
X2NhcHR1cmUoKQogICAgICAgICB0aHJvdyBzdGQ6OnJ1bnRpbWVfZXJyb3IoIkZhaWxlZCB0byB3
cmFwIGltYWdlIGluIGdzdHJlYW1lciBidWZmZXIiKTsKICAgICB9CiAKLSAgICBzdGQ6OnN0cmlu
Z3N0cmVhbSBzczsKLQotICAgIHNzIDw8ICJ2aWRlby94LXJhdyxmb3JtYXQ9QkdSeCx3aWR0aD0i
IDw8IGltYWdlLT53aWR0aCA8PCAiLGhlaWdodD0iIDw8IGltYWdlLT5oZWlnaHQgPDwgIixmcmFt
ZXJhdGU9IiA8PCBzZXR0aW5ncy5mcHMgPDwgIi8xIjsKLSAgICBHc3RDYXBzVVB0ciBjYXBzKGdz
dF9jYXBzX2Zyb21fc3RyaW5nKHNzLnN0cigpLmNfc3RyKCkpKTsKKyAgICBHc3RDYXBzVVB0ciBj
YXBzKGdzdF9jYXBzX25ld19zaW1wbGUoInZpZGVvL3gtcmF3IiwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgImZvcm1hdCIsIEdfVFlQRV9TVFJJTkcsICJCR1J4IiwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIndpZHRoIiwgR19UWVBF
X0lOVCwgaW1hZ2UtPndpZHRoLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAiaGVpZ2h0IiwgR19UWVBFX0lOVCwgaW1hZ2UtPmhlaWdodCwKKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgImZyYW1lcmF0ZSIsIEdTVF9UWVBFX0ZSQUNUSU9O
LCBzZXR0aW5ncy5mcHMsIDEsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIG51bGxwdHIpKTsKIAogICAgIC8vIFB1c2ggc2FtcGxlCiAgICAgR3N0U2FtcGxlVVB0ciBh
cHBzcmNfc2FtcGxlKGdzdF9zYW1wbGVfbmV3KGJ1ZiwgY2Fwcy5nZXQoKSwgbnVsbHB0ciwgbnVs
bHB0cikpOwotLSAKMi4yMS4wCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fXwpTcGljZS1kZXZlbCBtYWlsaW5nIGxpc3QKU3BpY2UtZGV2ZWxAbGlzdHMuZnJl
ZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGlu
Zm8vc3BpY2UtZGV2ZWw=
