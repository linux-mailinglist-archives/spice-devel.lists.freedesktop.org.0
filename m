Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id F178A2165C
	for <lists+spice-devel@lfdr.de>; Fri, 17 May 2019 11:38:11 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 797D089819;
	Fri, 17 May 2019 09:38:10 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 0F83589819
 for <spice-devel@lists.freedesktop.org>; Fri, 17 May 2019 09:38:09 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx07.intmail.prod.int.phx2.redhat.com
 [10.5.11.22])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id 99B11772FE
 for <spice-devel@lists.freedesktop.org>; Fri, 17 May 2019 09:38:08 +0000 (UTC)
Received: from colo-mx.corp.redhat.com
 (colo-mx01.intmail.prod.int.phx2.redhat.com [10.5.11.20])
 by smtp.corp.redhat.com (Postfix) with ESMTPS id 8FC00100203C
 for <spice-devel@lists.freedesktop.org>; Fri, 17 May 2019 09:38:08 +0000 (UTC)
Received: from zmail25.collab.prod.int.phx2.redhat.com
 (zmail25.collab.prod.int.phx2.redhat.com [10.5.83.31])
 by colo-mx.corp.redhat.com (Postfix) with ESMTP id 85A4E1806B10;
 Fri, 17 May 2019 09:38:08 +0000 (UTC)
Date: Fri, 17 May 2019 05:38:07 -0400 (EDT)
From: Frediano Ziglio <fziglio@redhat.com>
To: Victor Toso <victortoso@redhat.com>
Message-ID: <1358879826.18823504.1558085887023.JavaMail.zimbra@redhat.com>
In-Reply-To: <20190507085605.10054-2-victortoso@redhat.com>
References: <20190507085605.10054-1-victortoso@redhat.com>
 <20190507085605.10054-2-victortoso@redhat.com>
MIME-Version: 1.0
X-Originating-IP: [10.33.32.9, 10.4.195.27]
Thread-Topic: usb-acl-helper: move exec of binary to its own function
Thread-Index: X4IwjRISvuj6S+RyqzjaEfkK8ATbjw==
X-Scanned-By: MIMEDefang 2.84 on 10.5.11.22
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16
 (mx1.redhat.com [10.5.110.26]); Fri, 17 May 2019 09:38:08 +0000 (UTC)
Subject: Re: [Spice-devel] [spice-gtk v1 1/4] usb-acl-helper: move exec of
 binary to its own function
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: spice-devel@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

PiAKPiBGcm9tOiBWaWN0b3IgVG9zbyA8bWVAdmljdG9ydG9zby5jb20+Cj4gCj4gQ3JlYXRlIGhl
bHBlciBleGVjX3VzYl9hY2xfaGVscGVyX2JpbigpIHRvIGhhbmRsZSB0aGUgZXhlY3V0aW9uIG9m
Cj4gc3BpY2UtY2xpZW50LWdsaWItdXNiLWFjbC1oZWxwZXIgYmluYXJ5LiBUaGlzIGJpbiBpcyBv
bmx5IGNvbXBpbGVkIGluCj4gc3BpY2UtZ3RrIGlmIFBvbGtpdCBpcyBlbmFibGVkLgo+IAo+IFRo
aXMgaXMgYSBwcmVwYXJhdGlvbiBwYXRjaCBmb3IgZW5hYmxpbmcgdGhlIGJ1aWxkIG9mIHVzYi1h
Y2wtaGVscGVyLmMKPiB3aGVuIFBvbGtpdCBpcyBkaXNhYmxlZC4KCkkgZG9uJ3Qga25vdyBpZiB0
aGlzIGxhc3Qgc2VudGVuY2UgaXMgdXNlZnVsLCBhbHNvIEkgZG9uJ3QgYWdyZWUgb24Kb3RoZXIg
cGF0Y2hlcyBidXQgSSBjb25zaWRlciB0aGlzIGdvb2QuCgo+IAo+IFNpZ25lZC1vZmYtYnk6IFZp
Y3RvciBUb3NvIDx2aWN0b3J0b3NvQHJlZGhhdC5jb20+Cj4gLS0tCj4gIHNyYy91c2ItYWNsLWhl
bHBlci5jIHwgODggKysrKysrKysrKysrKysrKysrKysrKysrKy0tLS0tLS0tLS0tLS0tLS0tLS0K
PiAgMSBmaWxlIGNoYW5nZWQsIDUwIGluc2VydGlvbnMoKyksIDM4IGRlbGV0aW9ucygtKQo+IAo+
IGRpZmYgLS1naXQgYS9zcmMvdXNiLWFjbC1oZWxwZXIuYyBiL3NyYy91c2ItYWNsLWhlbHBlci5j
Cj4gaW5kZXggMTg2Yjg2ZS4uMzE0NTU5NyAxMDA2NDQKPiAtLS0gYS9zcmMvdXNiLWFjbC1oZWxw
ZXIuYwo+ICsrKyBiL3NyYy91c2ItYWNsLWhlbHBlci5jCj4gQEAgLTE1NCw2ICsxNTQsNTQgQEAg
c3RhdGljIHZvaWQgaGVscGVyX2NoaWxkX3dhdGNoX2NiKEdQaWQgcGlkLCBnaW50IHN0YXR1cywK
PiBncG9pbnRlciB1c2VyX2RhdGEpCj4gICAgICAvKiBOb3RoaW5nIHRvIGRvLCBidXQgd2UgbmVl
ZCB0aGUgY2hpbGQgd2F0Y2ggdG8gYXZvaWQgem9tYmllcyAqLwo+ICB9Cj4gIAo+ICtzdGF0aWMg
Z2Jvb2xlYW4KPiArZXhlY191c2JfYWNsX2hlbHBlcl9iaW4oU3BpY2VVc2JBY2xIZWxwZXIgKnNl
bGYsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGdjaGFyICpidWYsCj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgIEdFcnJvciAqKmVycikKPiArewo+ICsgICAgR0lPU3RhdHVzIHN0
YXR1czsKPiArICAgIEdQaWQgaGVscGVyX3BpZDsKPiArICAgIGdzaXplIGJ5dGVzX3dyaXR0ZW47
Cj4gKyAgICBjb25zdCBnY2hhciAqYWNsX2hlbHBlciA9IGdfZ2V0ZW52KCJTUElDRV9VU0JfQUNM
X0JJTkFSWSIpOwo+ICsgICAgaWYgKGFjbF9oZWxwZXIgPT0gTlVMTCkKPiArICAgICAgICBhY2xf
aGVscGVyID0gQUNMX0hFTFBFUl9QQVRIIi9zcGljZS1jbGllbnQtZ2xpYi11c2ItYWNsLWhlbHBl
ciI7CgpzdHlsZSBoZXJlIGlzIHdlaXJkLiBMb29rcyBsaWtlIHRoZSBzdGF0ZW1lbnRzIGJldHdl
ZW4gdGhlIGRlY2xhcmF0aW9ucyBhcmUKaGlkZGVuIHRvIG1ha2UgdGhlIG9ic2VydmVyIHRoaW5r
IGFyZSBqdXN0IGRlY2xhcmF0aW9ucy4KCkkgd291bGQgY2hhbmdlIHRvCgogICBHSU9TdGF0dXMg
c3RhdHVzOwogICBHUGlkIGhlbHBlcl9waWQ7CiAgIGdzaXplIGJ5dGVzX3dyaXR0ZW47CiAgIGdp
bnQgaW4sIG91dDsKICAgU3BpY2VVc2JBY2xIZWxwZXJQcml2YXRlICpwcml2ID0gc2VsZi0+cHJp
djsKICAgY29uc3QgZ2NoYXIgKmFjbF9oZWxwZXIgPSBnX2dldGVudigiU1BJQ0VfVVNCX0FDTF9C
SU5BUlkiKTsKCiAgIGlmIChhY2xfaGVscGVyID09IE5VTEwpIHsKICAgICAgIGFjbF9oZWxwZXIg
PSBBQ0xfSEVMUEVSX1BBVEgiL3NwaWNlLWNsaWVudC1nbGliLXVzYi1hY2wtaGVscGVyIjsKICAg
fQoKICAgZ2NoYXIgKmFyZ3ZbXSA9IHsgKGNoYXIqKWFjbF9oZWxwZXIsIE5VTEwgfTsKCgo+ICsg
ICAgZ2NoYXIgKmFyZ3ZbXSA9IHsgKGNoYXIqKWFjbF9oZWxwZXIsIE5VTEwgfTsKPiArICAgIGdp
bnQgaW4sIG91dDsKPiArICAgIFNwaWNlVXNiQWNsSGVscGVyUHJpdmF0ZSAqcHJpdiA9IHNlbGYt
PnByaXY7Cj4gKwo+ICsgICAgaWYgKCFnX3NwYXduX2FzeW5jX3dpdGhfcGlwZXMoTlVMTCwgYXJn
diwgTlVMTCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgR19TUEFXTl9ET19OT1RfUkVB
UF9DSElMRCB8IEdfU1BBV05fU0VBUkNIX1BBVEgsCj4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgIE5VTEwsIE5VTEwsICZoZWxwZXJfcGlkLCAmaW4sICZvdXQsIE5VTEwsIGVycikpIHsKCkkg
d291bGQgZml4IHRoZSBpbmRlbnRhdGlvbiBoZXJlCgo+ICsgICAgICAgIHJldHVybiBGQUxTRTsK
PiArICAgIH0KPiArCj4gKyAgICBnX2NoaWxkX3dhdGNoX2FkZChoZWxwZXJfcGlkLCBoZWxwZXJf
Y2hpbGRfd2F0Y2hfY2IsIE5VTEwpOwo+ICsKPiArICAgIHByaXYtPmluX2NoID0gZ19pb19jaGFu
bmVsX3VuaXhfbmV3KGluKTsKCk5vdCBhIHJlZ3Jlc3Npb24sIGhlcmUgeW91IGFyZSBhc3N1bWlu
ZyBpbl9jaCBhbmQgb3V0X2NoIGFyZSBOVUxMcy4KRnJvbSBBUEkgcHJvc3BlY3RpdmUgeW91IGNh
bm5vdCBjYWxsIHNwaWNlX3VzYl9hY2xfaGVscGVyX29wZW5fYWNsX2FzeW5jCnR3aWNlIG9uIHRo
ZSBzYW1lIG9iamVjdC4KCj4gKyAgICBnX2lvX2NoYW5uZWxfc2V0X2Nsb3NlX29uX3VucmVmKHBy
aXYtPmluX2NoLCBUUlVFKTsKPiArCj4gKyAgICBwcml2LT5vdXRfY2ggPSBnX2lvX2NoYW5uZWxf
dW5peF9uZXcob3V0KTsKPiArICAgIGdfaW9fY2hhbm5lbF9zZXRfY2xvc2Vfb25fdW5yZWYocHJp
di0+b3V0X2NoLCBUUlVFKTsKPiArICAgIHN0YXR1cyA9IGdfaW9fY2hhbm5lbF9zZXRfZmxhZ3Mo
cHJpdi0+b3V0X2NoLCBHX0lPX0ZMQUdfTk9OQkxPQ0ssIGVycik7Cj4gKyAgICBpZiAoc3RhdHVz
ICE9IEdfSU9fU1RBVFVTX05PUk1BTCkgewo+ICsgICAgICAgIHJldHVybiBGQUxTRTsKPiArICAg
IH0KPiArCj4gKyAgICBzdGF0dXMgPSBnX2lvX2NoYW5uZWxfd3JpdGVfY2hhcnMocHJpdi0+aW5f
Y2gsIGJ1ZiwgLTEsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJmJ5
dGVzX3dyaXR0ZW4sIGVycik7Cj4gKyAgICBpZiAoc3RhdHVzICE9IEdfSU9fU1RBVFVTX05PUk1B
TCkgewo+ICsgICAgICAgIHJldHVybiBGQUxTRTsKPiArICAgIH0KPiArICAgIHN0YXR1cyA9IGdf
aW9fY2hhbm5lbF9mbHVzaChwcml2LT5pbl9jaCwgZXJyKTsKPiArICAgIGlmIChzdGF0dXMgIT0g
R19JT19TVEFUVVNfTk9STUFMKSB7Cj4gKyAgICAgICAgcmV0dXJuIEZBTFNFOwo+ICsgICAgfQo+
ICsKPiArICAgIGdfaW9fYWRkX3dhdGNoKHByaXYtPm91dF9jaCwgR19JT19JTnxHX0lPX0hVUCwK
PiArICAgICAgICAgICAgICAgICAgIChHSU9GdW5jKWNiX291dF93YXRjaCwgZ19vYmplY3RfcmVm
KHNlbGYpKTsKPiArICAgIHJldHVybiBUUlVFOwo+ICt9Cj4gKwo+ICAvKiAtLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi8K
PiAgLyogcHJpdmF0ZSBhcGkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICovCj4gIAo+IEBAIC0xNzksMTUgKzIyNyw2IEBAIHZvaWQKPiBzcGlj
ZV91c2JfYWNsX2hlbHBlcl9vcGVuX2FjbF9hc3luYyhTcGljZVVzYkFjbEhlbHBlciAqc2VsZiwK
PiAgICAgIFNwaWNlVXNiQWNsSGVscGVyUHJpdmF0ZSAqcHJpdiA9IHNlbGYtPnByaXY7Cj4gICAg
ICBHVGFzayAqdGFzazsKPiAgICAgIEdFcnJvciAqZXJyID0gTlVMTDsKPiAtICAgIEdJT1N0YXR1
cyBzdGF0dXM7Cj4gLSAgICBHUGlkIGhlbHBlcl9waWQ7Cj4gLSAgICBnc2l6ZSBieXRlc193cml0
dGVuOwo+IC0gICAgY29uc3QgZ2NoYXIgKmFjbF9oZWxwZXIgPSBnX2dldGVudigiU1BJQ0VfVVNC
X0FDTF9CSU5BUlkiKTsKPiAtICAgIGlmIChhY2xfaGVscGVyID09IE5VTEwpCj4gLSAgICAgICAg
YWNsX2hlbHBlciA9IEFDTF9IRUxQRVJfUEFUSCIvc3BpY2UtY2xpZW50LWdsaWItdXNiLWFjbC1o
ZWxwZXIiOwo+IC0gICAgZ2NoYXIgKmFyZ3ZbXSA9IHsgKGNoYXIqKWFjbF9oZWxwZXIsIE5VTEwg
fTsKPiAtICAgIGdpbnQgaW4sIG91dDsKPiAtICAgIGdjaGFyIGJ1ZlsxMjhdOwo+ICAKPiAgICAg
IHRhc2sgPSBnX3Rhc2tfbmV3KHNlbGYsIGNhbmNlbGxhYmxlLCBjYWxsYmFjaywgdXNlcl9kYXRh
KTsKPiAgCj4gQEAgLTIwMywzNCArMjQyLDkgQEAgdm9pZAo+IHNwaWNlX3VzYl9hY2xfaGVscGVy
X29wZW5fYWNsX2FzeW5jKFNwaWNlVXNiQWNsSGVscGVyICpzZWxmLAo+ICAgICAgICAgIGdvdG8g
ZG9uZTsKPiAgICAgIH0KPiAgCj4gLSAgICBpZiAoIWdfc3Bhd25fYXN5bmNfd2l0aF9waXBlcyhO
VUxMLCBhcmd2LCBOVUxMLAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICBHX1NQQVdOX0RP
X05PVF9SRUFQX0NISUxEIHwgR19TUEFXTl9TRUFSQ0hfUEFUSCwKPiAtICAgICAgICAgICAgICAg
ICAgICAgICAgICAgTlVMTCwgTlVMTCwgJmhlbHBlcl9waWQsICZpbiwgJm91dCwgTlVMTCwgJmVy
cikpCj4gewo+IC0gICAgICAgIGdfdGFza19yZXR1cm5fZXJyb3IodGFzaywgZXJyKTsKPiAtICAg
ICAgICBnb3RvIGRvbmU7Cj4gLSAgICB9Cj4gLSAgICBnX2NoaWxkX3dhdGNoX2FkZChoZWxwZXJf
cGlkLCBoZWxwZXJfY2hpbGRfd2F0Y2hfY2IsIE5VTEwpOwo+IC0KPiAtICAgIHByaXYtPmluX2No
ID0gZ19pb19jaGFubmVsX3VuaXhfbmV3KGluKTsKPiAtICAgIGdfaW9fY2hhbm5lbF9zZXRfY2xv
c2Vfb25fdW5yZWYocHJpdi0+aW5fY2gsIFRSVUUpOwo+IC0KPiAtICAgIHByaXYtPm91dF9jaCA9
IGdfaW9fY2hhbm5lbF91bml4X25ldyhvdXQpOwo+IC0gICAgZ19pb19jaGFubmVsX3NldF9jbG9z
ZV9vbl91bnJlZihwcml2LT5vdXRfY2gsIFRSVUUpOwo+IC0gICAgc3RhdHVzID0gZ19pb19jaGFu
bmVsX3NldF9mbGFncyhwcml2LT5vdXRfY2gsIEdfSU9fRkxBR19OT05CTE9DSywgJmVycik7Cj4g
LSAgICBpZiAoc3RhdHVzICE9IEdfSU9fU1RBVFVTX05PUk1BTCkgewo+IC0gICAgICAgIGdfdGFz
a19yZXR1cm5fZXJyb3IodGFzaywgZXJyKTsKPiAtICAgICAgICBnb3RvIGRvbmU7Cj4gLSAgICB9
Cj4gLQo+ICsgICAgZ2NoYXIgYnVmWzEyOF07Cj4gICAgICBzbnByaW50ZihidWYsIHNpemVvZihi
dWYpLCAiJWQgJWRcbiIsIGJ1c251bSwgZGV2bnVtKTsKPiAtICAgIHN0YXR1cyA9IGdfaW9fY2hh
bm5lbF93cml0ZV9jaGFycyhwcml2LT5pbl9jaCwgYnVmLCAtMSwKPiAtICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAmYnl0ZXNfd3JpdHRlbiwgJmVycik7Cj4gLSAgICBpZiAo
c3RhdHVzICE9IEdfSU9fU1RBVFVTX05PUk1BTCkgewo+IC0gICAgICAgIGdfdGFza19yZXR1cm5f
ZXJyb3IodGFzaywgZXJyKTsKPiAtICAgICAgICBnb3RvIGRvbmU7Cj4gLSAgICB9Cj4gLSAgICBz
dGF0dXMgPSBnX2lvX2NoYW5uZWxfZmx1c2gocHJpdi0+aW5fY2gsICZlcnIpOwo+IC0gICAgaWYg
KHN0YXR1cyAhPSBHX0lPX1NUQVRVU19OT1JNQUwpIHsKPiArICAgIGlmICghZXhlY191c2JfYWNs
X2hlbHBlcl9iaW4oc2VsZiwgYnVmLCAmZXJyKSkgewo+ICAgICAgICAgIGdfdGFza19yZXR1cm5f
ZXJyb3IodGFzaywgZXJyKTsKPiAgICAgICAgICBnb3RvIGRvbmU7Cj4gICAgICB9Cj4gQEAgLTI0
Miw4ICsyNTYsNiBAQCB2b2lkCj4gc3BpY2VfdXNiX2FjbF9oZWxwZXJfb3Blbl9hY2xfYXN5bmMo
U3BpY2VVc2JBY2xIZWxwZXIgKnNlbGYsCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgR19DQUxMQkFDSyhjYW5jZWxsZWRfY2IpLAo+ICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYsIE5V
TEwpOwo+ICAgICAgfQo+IC0gICAgZ19pb19hZGRfd2F0Y2gocHJpdi0+b3V0X2NoLCBHX0lPX0lO
fEdfSU9fSFVQLAo+IC0gICAgICAgICAgICAgICAgICAgKEdJT0Z1bmMpY2Jfb3V0X3dhdGNoLCBn
X29iamVjdF9yZWYoc2VsZikpOwo+ICAgICAgcmV0dXJuOwo+ICAKPiAgZG9uZToKCk90aGVyIHBh
cnQgbG9va3MgZ29vZAoKRnJlZGlhbm8KX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX18KU3BpY2UtZGV2ZWwgbWFpbGluZyBsaXN0ClNwaWNlLWRldmVsQGxpc3Rz
LmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xp
c3RpbmZvL3NwaWNlLWRldmVs
