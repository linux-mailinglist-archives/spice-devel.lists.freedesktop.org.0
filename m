Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 9254B7A77C
	for <lists+spice-devel@lfdr.de>; Tue, 30 Jul 2019 14:04:08 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 8B5786E4D0;
	Tue, 30 Jul 2019 12:04:06 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 041A86E4CF
 for <spice-devel@lists.freedesktop.org>; Tue, 30 Jul 2019 12:04:05 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx05.intmail.prod.int.phx2.redhat.com
 [10.5.11.15])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id 9428F309265B;
 Tue, 30 Jul 2019 12:04:04 +0000 (UTC)
Received: from fziglio.remote.csb (unknown [10.33.32.10])
 by smtp.corp.redhat.com (Postfix) with ESMTP id 977555D6B0;
 Tue, 30 Jul 2019 12:04:00 +0000 (UTC)
From: Frediano Ziglio <fziglio@redhat.com>
To: spice-devel@lists.freedesktop.org
Date: Tue, 30 Jul 2019 13:03:05 +0100
Message-Id: <20190730120331.17967-17-fziglio@redhat.com>
In-Reply-To: <20190730120331.17967-1-fziglio@redhat.com>
References: <20190730120331.17967-1-fziglio@redhat.com>
MIME-Version: 1.0
X-Scanned-By: MIMEDefang 2.79 on 10.5.11.15
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16
 (mx1.redhat.com [10.5.110.43]); Tue, 30 Jul 2019 12:04:04 +0000 (UTC)
Subject: [Spice-devel] [PATCH spice-gtk 16/44] usb-redir: add files for SCSI
 and USB MSC implementation
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Alexander Nezhinsky <anezhins@redhat.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

RnJvbTogWXVyaSBCZW5kaXRvdmljaCA8eXVyaS5iZW5kaXRvdmljaEBkYXluaXguY29tPgoKRmls
ZXMgYWRkZWQgd2l0aG91dCBpbmNsdWRpbmcgdGhlbSBpbiBjb21waWxhdGlvbi4KVGhleSBjb250
YWluIGltcGxlbWVudGF0aW9uIG9mIFNDU0kgY29tbWFuZHMgZm9yIGxvZ2ljYWwKdW5pdHMgb2Yg
bWFzcy1zdG9yYWdlIGRldmljZSBjbGFzcyBhbmQgVVNCIGJ1bGstb25seQptYXNzLXN0b3JhZ2Ug
ZGV2aWNlIHByb3RvY29sLgoKU2lnbmVkLW9mZi1ieTogQWxleGFuZGVyIE5lemhpbnNreTxhbmV6
aGluc0ByZWRoYXQuY29tPgpTaWduZWQtb2ZmLWJ5OiBZdXJpIEJlbmRpdG92aWNoIDx5dXJpLmJl
bmRpdG92aWNoQGRheW5peC5jb20+Ci0tLQogc3JjL2NkLXNjc2ktZGV2LXBhcmFtcy5oIHwgICA1
MiArCiBzcmMvY2Qtc2NzaS5jICAgICAgICAgICAgfCAyNzcwICsrKysrKysrKysrKysrKysrKysr
KysrKysrKysrKysrKysrKysrCiBzcmMvY2Qtc2NzaS5oICAgICAgICAgICAgfCAgMTIyICsrCiBz
cmMvY2QtdXNiLWJ1bGstbXNkLmMgICAgfCAgNTU1ICsrKysrKysrCiBzcmMvY2QtdXNiLWJ1bGst
bXNkLmggICAgfCAgMTM0ICsrCiBzcmMvc2NzaS1jb25zdGFudHMuaCAgICAgfCAgMzI0ICsrKysr
CiA2IGZpbGVzIGNoYW5nZWQsIDM5NTcgaW5zZXJ0aW9ucygrKQogY3JlYXRlIG1vZGUgMTAwNjQ0
IHNyYy9jZC1zY3NpLWRldi1wYXJhbXMuaAogY3JlYXRlIG1vZGUgMTAwNjQ0IHNyYy9jZC1zY3Np
LmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBzcmMvY2Qtc2NzaS5oCiBjcmVhdGUgbW9kZSAxMDA2NDQg
c3JjL2NkLXVzYi1idWxrLW1zZC5jCiBjcmVhdGUgbW9kZSAxMDA2NDQgc3JjL2NkLXVzYi1idWxr
LW1zZC5oCiBjcmVhdGUgbW9kZSAxMDA2NDQgc3JjL3Njc2ktY29uc3RhbnRzLmgKCmRpZmYgLS1n
aXQgYS9zcmMvY2Qtc2NzaS1kZXYtcGFyYW1zLmggYi9zcmMvY2Qtc2NzaS1kZXYtcGFyYW1zLmgK
bmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAuLmNkZGNlMGEwCi0tLSAvZGV2L251
bGwKKysrIGIvc3JjL2NkLXNjc2ktZGV2LXBhcmFtcy5oCkBAIC0wLDAgKzEsNTIgQEAKKy8qIC0q
LSBNb2RlOiBDOyBjLWJhc2ljLW9mZnNldDogNDsgaW5kZW50LXRhYnMtbW9kZTogbmlsIC0qLSAq
LworLyoKKyAgIENEIFNDU0kgZGV2aWNlIHBhcmFtZXRlcnMKKworICAgQ29weXJpZ2h0IChDKSAy
MDE4IFJlZCBIYXQsIEluYy4KKworICAgUmVkIEhhdCBBdXRob3JzOgorICAgQWxleGFuZGVyIE5l
emhpbnNreTxhbmV6aGluc0ByZWRoYXQuY29tPgorCisgICBUaGlzIGxpYnJhcnkgaXMgZnJlZSBz
b2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yCisgICBtb2RpZnkgaXQgdW5k
ZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCisgICBMaWNlbnNl
IGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIKKyAg
IHZlcnNpb24gMi4xIG9mIHRoZSBMaWNlbnNlLCBvciAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRl
ciB2ZXJzaW9uLgorCisgICBUaGlzIGxpYnJhcnkgaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUg
dGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKKyAgIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0
aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCisgICBNRVJDSEFOVEFCSUxJVFkgb3Ig
RklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlIEdOVQorICAgTGVzc2Vy
IEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KKworICAgWW91IHNob3Vs
ZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYwor
ICAgTGljZW5zZSBhbG9uZyB3aXRoIHRoaXMgbGlicmFyeTsgaWYgbm90LCBzZWUgPGh0dHA6Ly93
d3cuZ251Lm9yZy9saWNlbnNlcy8+LgorKi8KKworI2lmbmRlZiBfQ0RfU0NTSV9ERVZfUEFSQU1T
X0hfCisjZGVmaW5lIF9DRF9TQ1NJX0RFVl9QQVJBTVNfSF8KKworI2luY2x1ZGUgPGdpby9naW8u
aD4KKwordHlwZWRlZiBzdHJ1Y3QgX0NkU2NzaURldmljZVBhcmFtZXRlcnMKK3sKKyAgICBjb25z
dCBjaGFyICp2ZW5kb3I7CisgICAgY29uc3QgY2hhciAqcHJvZHVjdDsKKyAgICBjb25zdCBjaGFy
ICp2ZXJzaW9uOworICAgIGNvbnN0IGNoYXIgKnNlcmlhbDsKK30gQ2RTY3NpRGV2aWNlUGFyYW1l
dGVyczsKKwordHlwZWRlZiBzdHJ1Y3QgX0NkU2NzaURldmljZUluZm8KK3sKKyAgICBDZFNjc2lE
ZXZpY2VQYXJhbWV0ZXJzIHBhcmFtZXRlcnM7CisgICAgdWludDMyX3Qgc3RhcnRlZCAgICA6IDE7
CisgICAgdWludDMyX3QgbG9ja2VkICAgICA6IDE7CisgICAgdWludDMyX3QgbG9hZGVkICAgICA6
IDE7Cit9IENkU2NzaURldmljZUluZm87CisKK3R5cGVkZWYgc3RydWN0IF9DZFNjc2lNZWRpYVBh
cmFtZXRlcnMKK3sKKyAgICBHRmlsZUlucHV0U3RyZWFtICpzdHJlYW07CisgICAgdWludDY0X3Qg
c2l6ZTsKKyAgICB1aW50MzJfdCBibG9ja19zaXplOworfSBDZFNjc2lNZWRpYVBhcmFtZXRlcnM7
CisKKyNlbmRpZiAvKiBfQ0RfU0NTSV9ERVZfUEFSQU1TX0hfICovCmRpZmYgLS1naXQgYS9zcmMv
Y2Qtc2NzaS5jIGIvc3JjL2NkLXNjc2kuYwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAw
MDAwMC4uZTgyNTEyNDkKLS0tIC9kZXYvbnVsbAorKysgYi9zcmMvY2Qtc2NzaS5jCkBAIC0wLDAg
KzEsMjc3MCBAQAorLyogLSotIE1vZGU6IEM7IGMtYmFzaWMtb2Zmc2V0OiA0OyBpbmRlbnQtdGFi
cy1tb2RlOiBuaWwgLSotICovCisvKgorICAgQ0QgZGV2aWNlIGVtdWxhdGlvbiAtIFNDU0kgZW5n
aW5lCisKKyAgIENvcHlyaWdodCAoQykgMjAxOCBSZWQgSGF0LCBJbmMuCisKKyAgIFJlZCBIYXQg
QXV0aG9yczoKKyAgIEFsZXhhbmRlciBOZXpoaW5za3k8YW5lemhpbnNAcmVkaGF0LmNvbT4KKwor
ICAgVGhpcyBsaWJyYXJ5IGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0
IGFuZC9vcgorICAgbW9kaWZ5IGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIExlc3NlciBH
ZW5lcmFsIFB1YmxpYworICAgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkgdGhlIEZyZWUgU29mdHdh
cmUgRm91bmRhdGlvbjsgZWl0aGVyCisgICB2ZXJzaW9uIDIuMSBvZiB0aGUgTGljZW5zZSwgb3Ig
KGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4KKworICAgVGhpcyBsaWJyYXJ5IGlz
IGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCisgICBidXQg
V0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBv
ZgorICAgTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NF
LiAgU2VlIHRoZSBHTlUKKyAgIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3Jl
IGRldGFpbHMuCisKKyAgIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdO
VSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKKyAgIExpY2Vuc2UgYWxvbmcgd2l0aCB0aGlzIGxpYnJh
cnk7IGlmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4KKyovCisKKyNp
bmNsdWRlICJjb25maWcuaCIKKyNpbmNsdWRlICJzcGljZS90eXBlcy5oIgorI2luY2x1ZGUgInNw
aWNlLWNvbW1vbi5oIgorI2luY2x1ZGUgInNwaWNlLXV0aWwuaCIKKyNpbmNsdWRlICJjZC1zY3Np
LmgiCisKKyNpZmRlZiBVU0VfVVNCUkVESVIKKworI2RlZmluZSBTUElDRV9FUlJPUihmbXQsIC4u
LikgXAorICAgIGRvIHsgU1BJQ0VfREVCVUcoImRldi1zY3NpIGVycm9yOiAiIGZtdCAsICMjIF9f
VkFfQVJHU19fKTsgfSB3aGlsZSAoMCkKKworI2RlZmluZSBNQVhfTFVOUyAgIDMyCisKK3N0cnVj
dCBfQ2RTY3NpVGFyZ2V0OyAvKiBmb3J3YXJkIGRlY2xhcmF0aW9uICovCit0eXBlZGVmIHN0cnVj
dCBfQ2RTY3NpVGFyZ2V0IENkU2NzaVRhcmdldDsKKwordHlwZWRlZiBlbnVtIF9DZFNjc2lQb3dl
ckNvbmRpdGlvbiB7CisgICAgQ0RfU0NTSV9QT1dFUl9TVE9QUEVELAorICAgIENEX1NDU0lfUE9X
RVJfQUNUSVZFLAorICAgIENEX1NDU0lfUE9XRVJfSURMRSwKKyAgICBDRF9TQ1NJX1BPV0VSX1NU
QU5EQlkKK30gQ2RTY3NpUG93ZXJDb25kaXRpb247CisKK3R5cGVkZWYgc3RydWN0IF9TY3NpU2hv
cnRTZW5zZQoreworICAgIHVpbnQ4X3Qga2V5OworICAgIHVpbnQ4X3QgYXNjOworICAgIHVpbnQ4
X3QgYXNjcTsKKyAgICBjb25zdCBjaGFyICpkZXNjcjsKK30gU2NzaVNob3J0U2Vuc2U7CisKKyNk
ZWZpbmUgQ0RfTUVESUFfRVZFTlRfTk9fQ0hBTkdFICAgICAgICAgICAgMHgwCisjZGVmaW5lIENE
X01FRElBX0VWRU5UX0VKRUNUX1JFUSAgICAgICAgICAgIDB4MSAvKiB1c2VyIHJlcXVlc3QgKG1l
Y2hhbmljYWwgc3dpdGNoKSB0byBlamVjdCB0aGUgbWVkaWEgKi8KKyNkZWZpbmUgQ0RfTUVESUFf
RVZFTlRfTkVXX01FRElBICAgICAgICAgICAgMHgyIC8qIG5ldyBtZWRpYSByZWNlaXZlZCAqLwor
I2RlZmluZSBDRF9NRURJQV9FVkVOVF9NRURJQV9SRU1PVkFMICAgICAgICAweDMgLyogbWVkaWEg
cmVtb3ZlZCAqLworI2RlZmluZSBDRF9NRURJQV9FVkVOVF9NRURJQV9DSEFOR0VEICAgICAgICAw
eDQgLyogdXNlciByZXF1ZXN0IHRvIGxvYWQgbmV3IG1lZGlhICovCisjZGVmaW5lIENEX01FRElB
X0VWRU5UX0JHX0ZPUk1BVF9DT01QTEVURSAgIDB4NQorI2RlZmluZSBDRF9NRURJQV9FVkVOVF9C
R19GT1JNQVRfUkVTVEFSVCAgICAweDYKKworI2RlZmluZSBDRF9QT1dFUl9FVkVOVF9OT19DSEFO
R0UgICAgICAgICAgICAweDAKKyNkZWZpbmUgQ0RfUE9XRVJfRVZFTlRfQ0hBTkdFX1NVQ0NFU1Mg
ICAgICAgMHgxCisjZGVmaW5lIENEX1BPV0VSX0VWRU5UX0NIQU5HRV9GQUxFRCAgICAgICAgIDB4
MgorCit0eXBlZGVmIHN0cnVjdCBfQ2RTY3NpTFUKK3sKKyAgICBDZFNjc2lUYXJnZXQgKnRndDsK
KyAgICB1aW50MzJfdCBsdW47CisKKyAgICBnYm9vbGVhbiByZWFsaXplZDsKKyAgICBnYm9vbGVh
biByZW1vdmFibGU7CisgICAgZ2Jvb2xlYW4gbG9hZGVkOworICAgIGdib29sZWFuIHByZXZlbnRf
bWVkaWFfcmVtb3ZhbDsKKyAgICBnYm9vbGVhbiBjZF9yb207CisKKyAgICBDZFNjc2lQb3dlckNv
bmRpdGlvbiBwb3dlcl9jb25kOworICAgIHVpbnQzMl90IHBvd2VyX2V2ZW50OworICAgIHVpbnQz
Ml90IG1lZGlhX2V2ZW50OworCisgICAgdWludDMyX3QgY2xhaW1fdmVyc2lvbjsKKworICAgIHVp
bnQ2NF90IHNpemU7CisgICAgdWludDMyX3QgYmxvY2tfc2l6ZTsKKyAgICB1aW50MzJfdCBudW1f
YmxvY2tzOworCisgICAgY2hhciAqdmVuZG9yOworICAgIGNoYXIgKnByb2R1Y3Q7CisgICAgY2hh
ciAqdmVyc2lvbjsKKyAgICBjaGFyICpzZXJpYWw7CisKKyAgICBHRmlsZUlucHV0U3RyZWFtICpz
dHJlYW07CisKKyAgICBTY3NpU2hvcnRTZW5zZSBzaG9ydF9zZW5zZTsgLyogY3VycmVudGx5IGhl
bGQgc2Vuc2Ugb2YgdGhlIHNjc2kgZGV2aWNlICovCisgICAgdWludDhfdCBmaXhlZF9zZW5zZVtG
SVhFRF9TRU5TRV9MRU5dOworfSBDZFNjc2lMVTsKKwordHlwZWRlZiBlbnVtIF9DZFNjc2lUYXJn
ZXRTdGF0ZQoreworICAgIENEX1NDU0lfVEdUX1NUQVRFX1JVTk5JTkcsCisgICAgQ0RfU0NTSV9U
R1RfU1RBVEVfUkVTRVQsCit9IENkU2NzaVRhcmdldFN0YXRlOworCitzdHJ1Y3QgX0NkU2NzaVRh
cmdldAoreworICAgIHZvaWQgKnVzZXJfZGF0YTsKKworICAgIENkU2NzaVRhcmdldFN0YXRlIHN0
YXRlOworICAgIENkU2NzaVJlcXVlc3QgKmN1cl9yZXE7CisgICAgR0NhbmNlbGxhYmxlICpjYW5j
ZWxsYWJsZTsKKworICAgIHVpbnQzMl90IG51bV9sdW5zOworICAgIHVpbnQzMl90IG1heF9sdW5z
OworICAgIENkU2NzaUxVIHVuaXRzW01BWF9MVU5TXTsKK307CisKK3N0YXRpYyBnYm9vbGVhbiBj
bWRfbmFtZXNfaW5pdGlhbGl6ZWQgPSBGQUxTRTsKK3N0YXRpYyBjb25zdCBjaGFyKiBzY3NpX2Nt
ZF9uYW1lWzI1Nl07CisKKy8qIFByZWRlZmluZWQgc2Vuc2UgY29kZXMgKi8KKworY29uc3QgU2Nz
aVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9OT19TRU5TRSA9IHsKKyAgICAua2V5ID0gTk9fU0VOU0Ug
LCAuYXNjID0gMHgwMCAsIC5hc2NxID0gMHgwMCwKKyAgICAuZGVzY3IgPSAiIgorfTsKKworY29u
c3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9OT1RfUkVBRFlfQ0FVU0VfTk9UX1JFUE9SVEFC
TEUgPSB7CisgICAgLmtleSA9IE5PVF9SRUFEWSwgLmFzYyA9IDB4MDQsIC5hc2NxID0gMHgwMCwK
KyAgICAuZGVzY3IgPSAiQ0FVU0UgTk9UIFJFUE9SVEFCTEUiCit9OworCitjb25zdCBTY3NpU2hv
cnRTZW5zZSBzZW5zZV9jb2RlX0JFQ09NSU5HX1JFQURZID0geworICAgIC5rZXkgPSBOT1RfUkVB
RFksIC5hc2MgPSAweDA0LCAuYXNjcSA9IDB4MDEsCisgICAgLmRlc2NyID0gIklOIFBST0NFU1Mg
T0YgQkVDT01JTkcgUkVBRFkiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2Rl
X0lOSVRfQ01EX1JFUVVJUkVEID0geworICAgIC5rZXkgPSBOT1RfUkVBRFksIC5hc2MgPSAweDA0
LCAuYXNjcSA9IDB4MDIsCisgICAgLmRlc2NyID0gIklOSVRJQUxJWklORyBDT01NQU5EIFJFUVVJ
UkVEIgorfTsKKworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9JTlRFUlZFTlRJT05f
UkVRVUlSRUQgPSB7CisgICAgLmtleSA9IE5PVF9SRUFEWSwgLmFzYyA9IDB4MDQsIC5hc2NxID0g
MHgwMywKKyAgICAuZGVzY3IgPSAiTUFOVUFMIElOVEVSVkVOVElPTiBSRVFVSVJFRCIKK307CisK
K2NvbnN0IFNjc2lTaG9ydFNlbnNlIHNlbnNlX2NvZGVfTk9UX1JFQURZX05PX01FRElVTSA9IHsK
KyAgICAua2V5ID0gTk9UX1JFQURZLCAuYXNjID0gMHgzYSwgLmFzY3EgPSAweDAwLAorICAgIC5k
ZXNjciA9ICJNRURJVU0gTk9UIFBSRVNFTlQiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBz
ZW5zZV9jb2RlX05PVF9SRUFEWV9OT19NRURJVU1fVFJBWV9DTE9TRUQgPSB7CisgICAgLmtleSA9
IE5PVF9SRUFEWSwgLmFzYyA9IDB4M2EsIC5hc2NxID0gMHgwMSwKKyAgICAuZGVzY3IgPSAiTUVE
SVVNIE5PVCBQUkVTRU5UIC0gVFJBWSBDTE9TRUQiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5z
ZSBzZW5zZV9jb2RlX05PVF9SRUFEWV9OT19NRURJVU1fVFJBWV9PUEVOID0geworICAgIC5rZXkg
PSBOT1RfUkVBRFksIC5hc2MgPSAweDNhLCAuYXNjcSA9IDB4MDIsCisgICAgLmRlc2NyID0gIk1F
RElVTSBOT1QgUFJFU0VOVCAtIFRSQVkgT1BFTiIKK307CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNl
IHNlbnNlX2NvZGVfVEFSR0VUX0ZBSUxVUkUgPSB7CisgICAgLmtleSA9IEhBUkRXQVJFX0VSUk9S
LCAuYXNjID0gMHg0NCwgLmFzY3EgPSAweDAwLAorICAgIC5kZXNjciA9ICJJTlRFUk5BTCBUQVJH
RVQgRkFJTFVSRSIKK307CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNlIHNlbnNlX2NvZGVfSU5WQUxJ
RF9PUENPREUgPSB7CisgICAgLmtleSA9IElMTEVHQUxfUkVRVUVTVCwgLmFzYyA9IDB4MjAsIC5h
c2NxID0gMHgwMCwKKyAgICAuZGVzY3IgPSAiSU5WQUxJRCBDT01NQU5EIE9QRVJBVElPTiBDT0RF
IgorfTsKKworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9MQkFfT1VUX09GX1JBTkdF
ID0geworICAgIC5rZXkgPSBJTExFR0FMX1JFUVVFU1QsIC5hc2MgPSAweDIxLCAuYXNjcSA9IDB4
MDAsCisgICAgLmRlc2NyID0gIkxPR0lDQUwgQkxPQ0sgQUREUkVTUyBPVVQgT0YgUkFOR0UiCit9
OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX0lOVkFMSURfQ0RCX0ZJRUxEID0g
eworICAgIC5rZXkgPSBJTExFR0FMX1JFUVVFU1QsIC5hc2MgPSAweDI0LCAuYXNjcSA9IDB4MDAs
CisgICAgLmRlc2NyID0gIklOVkFMSUQgRklFTEQgSU4gQ0RCIgorfTsKKworY29uc3QgU2NzaVNo
b3J0U2Vuc2Ugc2Vuc2VfY29kZV9JTlZBTElEX1BBUkFNX0ZJRUxEID0geworICAgIC5rZXkgPSBJ
TExFR0FMX1JFUVVFU1QsIC5hc2MgPSAweDI2LCAuYXNjcSA9IDB4MDAsCisgICAgLmRlc2NyID0g
IklOVkFMSUQgRklFTEQgSU4gUEFSQU1FVEVSIExJU1QiCit9OworCitjb25zdCBTY3NpU2hvcnRT
ZW5zZSBzZW5zZV9jb2RlX0lOVkFMSURfUEFSQU1fTEVOID0geworICAgIC5rZXkgPSBJTExFR0FM
X1JFUVVFU1QsIC5hc2MgPSAweDFhLCAuYXNjcSA9IDB4MDAsCisgICAgLmRlc2NyID0gIlBBUkFN
RVRFUiBMSVNUIExFTkdUSCBFUlJPUiIKK307CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNlIHNlbnNl
X2NvZGVfTFVOX05PVF9TVVBQT1JURUQgPSB7CisgICAgLmtleSA9IElMTEVHQUxfUkVRVUVTVCwg
LmFzYyA9IDB4MjUsIC5hc2NxID0gMHgwMCwKKyAgICAuZGVzY3IgPSAiTE9HSUNBTCBVTklUIE5P
VCBTVVBQT1JURUQiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX1NBVklO
R19QQVJBTVNfTk9UX1NVUFBPUlRFRCA9IHsKKyAgICAua2V5ID0gSUxMRUdBTF9SRVFVRVNULCAu
YXNjID0gMHgzOSwgLmFzY3EgPSAweDAwLAorICAgIC5kZXNjciA9ICJTQVZJTkcgUEFSQU1FVEVS
UyBOT1QgU1VQUE9SVEVEIgorfTsKKworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9J
TkNPTVBBVElCTEVfTUVESVVNID0geworICAgIC5rZXkgPSBJTExFR0FMX1JFUVVFU1QsIC5hc2Mg
PSAweDMwLCAuYXNjcSA9IDB4MDAsCisgICAgLmRlc2NyID0gIklOQ09NUEFUSUJMRSBNRURJVU0g
SU5TVEFMTEVEIgorfTsKKworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9NRURJVU1f
UkVNT1ZBTF9QUkVWRU5URUQgPSB7CisgICAgLmtleSA9IElMTEVHQUxfUkVRVUVTVCwgLmFzYyA9
IDB4NTMsIC5hc2NxID0gMHgwMiwKKyAgICAuZGVzY3IgPSAiTUVESVVNIFJFTU9WQUwgUFJFVkVO
VEVEIgorfTsKKworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9QQVJBTUVURVJTX0NI
QU5HRUQgPSB7CisgICAgLmtleSA9IFVOSVRfQVRURU5USU9OLCAuYXNjID0gMHgyYSwgLmFzY3Eg
PSAweDAwLAorICAgIC5kZXNjciA9ICJQQVJBTUVURVJTIENIQU5HRUQiCit9OworCitjb25zdCBT
Y3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX1BPV0VSX09OX1JFU0VUID0geworICAgIC5rZXkgPSBV
TklUX0FUVEVOVElPTiwgLmFzYyA9IDB4MjksIC5hc2NxID0gMHgwMCwKKyAgICAuZGVzY3IgPSAi
UE9XRVIgT04sIFJFU0VULCBPUiBCVVMgREVWSUNFIFJFU0VUIgorfTsKKworY29uc3QgU2NzaVNo
b3J0U2Vuc2Ugc2Vuc2VfY29kZV9TQ1NJX0JVU19SRVNFVCA9IHsKKyAgICAua2V5ID0gVU5JVF9B
VFRFTlRJT04sIC5hc2MgPSAweDI5LCAuYXNjcSA9IDB4MDIsCisgICAgLmRlc2NyID0gIlNDU0kg
QlVTIFJFU0VUIgorfTsKKworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9VQV9OT19N
RURJVU0gPSB7CisgICAgLmtleSA9IFVOSVRfQVRURU5USU9OLCAuYXNjID0gMHgzYSwgLmFzY3Eg
PSAweDAwLAorICAgIC5kZXNjciA9ICJNRURJVU0gTk9UIFBSRVNFTlQiCit9OworCitjb25zdCBT
Y3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX01FRElVTV9DSEFOR0VEID0geworICAgIC5rZXkgPSBV
TklUX0FUVEVOVElPTiwgLmFzYyA9IDB4MjgsIC5hc2NxID0gMHgwMCwKKyAgICAuZGVzY3IgPSAi
TUVESVVNIENIQU5HRUQiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX1JF
UE9SVEVEX0xVTlNfQ0hBTkdFRCA9IHsKKyAgICAua2V5ID0gVU5JVF9BVFRFTlRJT04sIC5hc2Mg
PSAweDNmLCAuYXNjcSA9IDB4MGUsCisgICAgLmRlc2NyID0gIlJFUE9SVEVEIExVTlMgQ0hBTkdF
RCIKK307CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNlIHNlbnNlX2NvZGVfREVWSUNFX0lOVEVSTkFM
X1JFU0VUID0geworICAgIC5rZXkgPSBVTklUX0FUVEVOVElPTiwgLmFzYyA9IDB4MjksIC5hc2Nx
ID0gMHgwNCwKKyAgICAuZGVzY3IgPSAiREVWSUNFIElOVEVSTkFMIFJFU0VUIgorfTsKKworY29u
c3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9VTklUX0FUVEVOVElPTl9NRURJVU1fUkVNT1ZB
TF9SRVFVRVNUID0geworICAgIC5rZXkgPSBVTklUX0FUVEVOVElPTiwgLmFzYyA9IDB4NWEsIC5h
c2NxID0gMHgwMSwKKyAgICAuZGVzY3IgPSAiT1BFUkFUT1IgTUVESVVNIFJFTU9WQUwgUkVRVUVT
VCIKK307CisKK3N0YXRpYyBpbmxpbmUgZ2Jvb2xlYW4gY2Rfc2NzaV9vcGNvZGVfdWFfc3VwcmVz
cyh1aW50MzJfdCBvcGNvZGUpCit7CisgICAgc3dpdGNoIChvcGNvZGUpIHsKKyAgICBjYXNlIElO
UVVJUlk6CisgICAgY2FzZSBSRVBPUlRfTFVOUzoKKyAgICBjYXNlIEdFVF9DT05GSUdVUkFUSU9O
OgorICAgIGNhc2UgR0VUX0VWRU5UX1NUQVRVU19OT1RJRklDQVRJT046CisgICAgY2FzZSBSRVFV
RVNUX1NFTlNFOgorICAgICAgICByZXR1cm4gVFJVRTsKKyAgICBkZWZhdWx0OgorICAgICAgICBy
ZXR1cm4gRkFMU0U7CisgICAgfQorfQorCitzdGF0aWMgaW5saW5lIGNvbnN0IGNoYXIgKkNkU2Nz
aVJlcVN0YXRlX3N0cihDZFNjc2lSZXFTdGF0ZSBzdGF0ZSkKK3sKKyAgICBzd2l0Y2goc3RhdGUp
IHsKKyAgICBjYXNlIFNDU0lfUkVRX0lETEU6CisgICAgICAgIHJldHVybiAiSURMRSI7CisgICAg
Y2FzZSBTQ1NJX1JFUV9SVU5OSU5HOgorICAgICAgICByZXR1cm4gIlJVTk5JTkciOworICAgIGNh
c2UgU0NTSV9SRVFfQ09NUExFVEU6CisgICAgICAgIHJldHVybiAiQ09NUExFVEUiOworICAgIGNh
c2UgU0NTSV9SRVFfQ0FOQ0VMRUQ6CisgICAgICAgIHJldHVybiAiQ0FOQ0VMRUQiOworICAgIGRl
ZmF1bHQ6CisgICAgICAgIHJldHVybiAiSUxMRUdBTCI7CisgICAgfQorfQorCitzdGF0aWMgY29u
c3QgY2hhciAqY2Rfc2NzaV9zZW5zZV9rZXlfZGVzY3IodWludDhfdCBzZW5zZV9rZXkpCit7Cisg
ICAgc3dpdGNoKHNlbnNlX2tleSkgeworICAgIGNhc2UgTk9fU0VOU0U6CisgICAgICAgIHJldHVy
biAiTk8gU0VOU0UiOworICAgIGNhc2UgUkVDT1ZFUkVEX0VSUk9SOgorICAgICAgICByZXR1cm4g
IlJFQ09WRVJFRCBFUlJPUiI7CisgICAgY2FzZSBOT1RfUkVBRFk6CisgICAgICAgIHJldHVybiAi
TFVOIE5PVCBSRUFEWSI7CisgICAgY2FzZSBNRURJVU1fRVJST1I6CisgICAgICAgIHJldHVybiAi
TUVESVVNIEVSUk9SIjsKKyAgICBjYXNlIEhBUkRXQVJFX0VSUk9SOgorICAgICAgICByZXR1cm4g
IkhBUkRXQVJFIEVSUk9SIjsKKyAgICBjYXNlIElMTEVHQUxfUkVRVUVTVDoKKyAgICAgICAgcmV0
dXJuICJJTExFR0FMIFJFUVVFU1QiOworICAgIGNhc2UgVU5JVF9BVFRFTlRJT046CisgICAgICAg
IHJldHVybiAiVU5JVCBBVFRFTlRJT04iOworICAgIGNhc2UgQkxBTktfQ0hFQ0s6CisgICAgICAg
IHJldHVybiAiQkxBTksgQ0hFQ0siOworICAgIGNhc2UgQUJPUlRFRF9DT01NQU5EOgorICAgICAg
ICByZXR1cm4gIkFCT1JURUQgQ09NTUFORCI7CisgICAgZGVmYXVsdDoKKyAgICAgICAgcmV0dXJu
ICI/Pz8iOworICAgIH0KK30KK3N0YXRpYyB1aW50MzJfdCBjZF9zY3NpX2J1aWxkX2ZpeGVkX3Nl
bnNlKHVpbnQ4X3QgKmJ1ZiwgY29uc3QgU2NzaVNob3J0U2Vuc2UgKnNob3J0X3NlbnNlKQorewor
ICAgIG1lbXNldChidWYsIDAsIEZJWEVEX1NFTlNFX0xFTik7CisKKyAgICBidWZbMF0gPSBGSVhF
RF9TRU5TRV9DVVJSRU5UOworICAgIGJ1ZlsyXSA9IHNob3J0X3NlbnNlLT5rZXk7CisgICAgYnVm
WzddID0gMTA7CisgICAgYnVmWzEyXSA9IHNob3J0X3NlbnNlLT5hc2M7CisgICAgYnVmWzEzXSA9
IHNob3J0X3NlbnNlLT5hc2NxOworCisgICAgcmV0dXJuIEZJWEVEX1NFTlNFX0xFTjsKK30KKwor
c3RhdGljIGlubGluZSB2b2lkIGNkX3Njc2lfcmVxX2luaXQoQ2RTY3NpUmVxdWVzdCAqcmVxKQor
eworICAgIHJlcS0+cmVxX3N0YXRlID0gU0NTSV9SRVFfSURMRTsKKyAgICByZXEtPnhmZXJfZGly
ID0gU0NTSV9YRkVSX05PTkU7CisgICAgcmVxLT5wcml2X2RhdGEgPSBOVUxMOworICAgIHJlcS0+
aW5fbGVuID0gMDsKKyAgICByZXEtPnN0YXR1cyA9IEdPT0Q7Cit9CisKK3N0YXRpYyBpbmxpbmUg
dm9pZCBjZF9zY3NpX2Rldl9zZW5zZV9yZXNldChDZFNjc2lMVSAqZGV2KQoreworICAgIG1lbXNl
dCgmZGV2LT5zaG9ydF9zZW5zZSwgMCwgc2l6ZW9mKGRldi0+c2hvcnRfc2Vuc2UpKTsKKyAgICBj
ZF9zY3NpX2J1aWxkX2ZpeGVkX3NlbnNlKGRldi0+Zml4ZWRfc2Vuc2UsICZkZXYtPnNob3J0X3Nl
bnNlKTsKK30KKworc3RhdGljIGlubGluZSB2b2lkIGNkX3Njc2lfZGV2X3NlbnNlX3NldChDZFNj
c2lMVSAqZGV2LCBjb25zdCBTY3NpU2hvcnRTZW5zZSAqc2hvcnRfc2Vuc2UpCit7CisgICAgaWYg
KHNob3J0X3NlbnNlICE9IE5VTEwpIHsKKyAgICAgICAgLyogY29weSBzaG9ydCBzZW5zZSBhbmQg
Z2VuZXJhdGUgZnVsbCBzZW5zZSBpbiBmaXhlZCBmb3JtYXQgKi8KKyAgICAgICAgZGV2LT5zaG9y
dF9zZW5zZSA9ICpzaG9ydF9zZW5zZTsKKyAgICAgICAgY2Rfc2NzaV9idWlsZF9maXhlZF9zZW5z
ZShkZXYtPmZpeGVkX3NlbnNlLCBzaG9ydF9zZW5zZSk7CisgICAgfQorfQorCitzdGF0aWMgaW5s
aW5lIHZvaWQgY2Rfc2NzaV9kZXZfc2Vuc2Vfc2V0X3Bvd2VyX29uKENkU2NzaUxVICpkZXYpCit7
CisgICAgY2Rfc2NzaV9kZXZfc2Vuc2Vfc2V0KGRldiwgJnNlbnNlX2NvZGVfUE9XRVJfT05fUkVT
RVQpOworfQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKENk
U2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSwKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgY29uc3QgU2NzaVNob3J0U2Vuc2UgKnNob3J0X3NlbnNlKQor
eworICAgIHJlcS0+cmVxX3N0YXRlID0gU0NTSV9SRVFfQ09NUExFVEU7CisgICAgcmVxLT5zdGF0
dXMgPSBDSEVDS19DT05ESVRJT047CisgICAgcmVxLT5pbl9sZW4gPSAwOworCisgICAgY2Rfc2Nz
aV9kZXZfc2Vuc2Vfc2V0KGRldiwgc2hvcnRfc2Vuc2UpOworCisgICAgU1BJQ0VfREVCVUcoIkNI
RUNLX0NPTkQsIHJlcXVlc3QgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQKKyAgICAgICAgICAgICAg
ICAiIG9wOiAweCUwMngsIHBlbmRpbmcgc2Vuc2U6IDB4JTAyeCAlMDJ4ICUwMnggLSAlcywgJXMi
LAorICAgICAgICAgICAgICAgIGRldi0+bHVuLCAodWludDMyX3QpcmVxLT5jZGJbMF0sCisgICAg
ICAgICAgICAgICAgKHVpbnQzMl90KWRldi0+c2hvcnRfc2Vuc2Uua2V5LAorICAgICAgICAgICAg
ICAgICh1aW50MzJfdClkZXYtPnNob3J0X3NlbnNlLmFzYywKKyAgICAgICAgICAgICAgICAodWlu
dDMyX3QpZGV2LT5zaG9ydF9zZW5zZS5hc2NxLAorICAgICAgICAgICAgICAgIGNkX3Njc2lfc2Vu
c2Vfa2V5X2Rlc2NyKGRldi0+c2hvcnRfc2Vuc2Uua2V5KSwKKyAgICAgICAgICAgICAgICBkZXYt
PnNob3J0X3NlbnNlLmRlc2NyKTsKK30KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRfY29tcGxl
dGVfZ29vZChDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgcmVxLT5y
ZXFfc3RhdGUgPSBTQ1NJX1JFUV9DT01QTEVURTsKKyAgICByZXEtPnN0YXR1cyA9IEdPT0Q7Cit9
CisKKy8qIFNDU0kgVGFyZ2V0ICovCisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX25hbWVzX2lu
aXQodm9pZCkKK3sKKyAgICB1aW50MzJfdCBvcGNvZGU7CisKKyAgICBpZiAoY21kX25hbWVzX2lu
aXRpYWxpemVkKSB7CisgICAgICAgIHJldHVybjsKKyAgICB9CisKKyAgICBmb3IgKG9wY29kZSA9
IDA7IG9wY29kZSA8IDI1Njsgb3Bjb2RlKyspIHsKKyAgICAgICAgc2NzaV9jbWRfbmFtZVtvcGNv
ZGVdID0gIlVOU1VQUE9SVEVEIjsKKyAgICB9CisKKyAgICBzY3NpX2NtZF9uYW1lW1JFUE9SVF9M
VU5TXSA9ICJSRVBPUlQgTFVOUyI7CisgICAgc2NzaV9jbWRfbmFtZVtURVNUX1VOSVRfUkVBRFld
ID0gIlRFU1QgVU5JVCBSRUFEWSI7CisgICAgc2NzaV9jbWRfbmFtZVtJTlFVSVJZXSA9ICJJTlFV
SVJZIjsKKyAgICBzY3NpX2NtZF9uYW1lW1JFUVVFU1RfU0VOU0VdID0gIlJFUVVFU1QgU0VOU0Ui
OworICAgIHNjc2lfY21kX25hbWVbUkVBRF82XSA9ICJSRUFEKDYpIjsKKyAgICBzY3NpX2NtZF9u
YW1lW1JFQURfMTBdID0gIlJFQUQoMTApIjsKKyAgICBzY3NpX2NtZF9uYW1lW1JFQURfMTJdID0g
IlJFQUQoMTIpIjsKKyAgICBzY3NpX2NtZF9uYW1lW1JFQURfMTZdID0gIlJFQUQoMTYpIjsKKyAg
ICBzY3NpX2NtZF9uYW1lW1JFQURfQ0FQQUNJVFlfMTBdID0gIlJFQUQgQ0FQQUNJVFkoMTApIjsK
KyAgICBzY3NpX2NtZF9uYW1lW1JFQURfVE9DXSA9ICJSRUFEIFRPQyI7CisgICAgc2NzaV9jbWRf
bmFtZVtHRVRfRVZFTlRfU1RBVFVTX05PVElGSUNBVElPTl0gPSAiR0VUIEVWRU5UL1NUQVRVUyBO
T1RJRklDQVRJT04iOworICAgIHNjc2lfY21kX25hbWVbUkVBRF9ESVNDX0lORk9STUFUSU9OXSA9
ICJSRUFEIERJU0MgSU5GTyI7CisgICAgc2NzaV9jbWRfbmFtZVtSRUFEX1RSQUNLX0lORk9STUFU
SU9OXSA9ICJSRUFEIFRSQUNLIElORk8iOworICAgIHNjc2lfY21kX25hbWVbTU9ERV9TRU5TRV8x
MF0gPSAiTU9ERSBTRU5TRSgxMCkiOworICAgIHNjc2lfY21kX25hbWVbTU9ERV9TRUxFQ1RdID0g
Ik1PREUgU0VMRUNUKDYpIjsKKyAgICBzY3NpX2NtZF9uYW1lW01PREVfU0VMRUNUXzEwXSA9ICJN
T0RFIFNFTEVDVCgxMCkiOworICAgIHNjc2lfY21kX25hbWVbR0VUX0NPTkZJR1VSQVRJT05dID0g
IkdFVCBDT05GSUdVUkFUSU9OIjsKKyAgICBzY3NpX2NtZF9uYW1lW0FMTE9XX01FRElVTV9SRU1P
VkFMXSA9ICJQUkVWRU5UIEFMTE9XIE1FRElVTSBSRU1PVkFMIjsKKyAgICBzY3NpX2NtZF9uYW1l
W01NQ19TRU5EX0VWRU5UXSA9ICJTRU5EIEVWRU5UIjsKKyAgICBzY3NpX2NtZF9uYW1lW01NQ19S
RVBPUlRfS0VZXSA9ICJSRVBPUlQgS0VZIjsKKyAgICBzY3NpX2NtZF9uYW1lW01NQ19TRU5EX0tF
WV0gPSAiU0VORF9LRVkiOworICAgIHNjc2lfY21kX25hbWVbU1RBUlRfU1RPUF0gPSAiU1RBUlQg
U1RPUCBVTklUIjsKKyAgICBzY3NpX2NtZF9uYW1lW01NQ19HRVRfUEVSRk9STUFOQ0VdID0gIkdF
VCBQRVJGT1JNQU5DRSI7CisgICAgc2NzaV9jbWRfbmFtZVtNTUNfTUVDSEFOSVNNX1NUQVRVU10g
PSAiTUVDSEFOSVNNIFNUQVRVUyI7CisKKyAgICBjbWRfbmFtZXNfaW5pdGlhbGl6ZWQgPSBUUlVF
OworfQorCit2b2lkICpjZF9zY3NpX3RhcmdldF9hbGxvYyh2b2lkICp0YXJnZXRfdXNlcl9kYXRh
LCB1aW50MzJfdCBtYXhfbHVucykKK3sKKyAgICBDZFNjc2lUYXJnZXQgKnN0OworCisgICAgaWYg
KG1heF9sdW5zID09IDAgfHwgbWF4X2x1bnMgPiBNQVhfTFVOUykgeworICAgICAgICBTUElDRV9F
UlJPUigiQWxsb2MsIGlsbGVnYWwgbWF4X2x1bnM6JSIgR19HVUlOVDMyX0ZPUk1BVCwgbWF4X2x1
bnMpOworICAgICAgICByZXR1cm4gTlVMTDsKKyAgICB9CisKKyAgICBzdCA9IGdfbWFsbG9jMChz
aXplb2YoKnN0KSk7CisKKyAgICBzdC0+dXNlcl9kYXRhID0gdGFyZ2V0X3VzZXJfZGF0YTsKKyAg
ICBzdC0+c3RhdGUgPSBDRF9TQ1NJX1RHVF9TVEFURV9SVU5OSU5HOworICAgIHN0LT5jdXJfcmVx
ID0gTlVMTDsKKyAgICBzdC0+Y2FuY2VsbGFibGUgPSBnX2NhbmNlbGxhYmxlX25ldygpOworICAg
IHN0LT5tYXhfbHVucyA9IG1heF9sdW5zOworCisgICAgY2Rfc2NzaV9jbWRfbmFtZXNfaW5pdCgp
OworCisgICAgcmV0dXJuICh2b2lkICopc3Q7Cit9CisKK3ZvaWQgY2Rfc2NzaV90YXJnZXRfZnJl
ZSh2b2lkICpzY3NpX3RhcmdldCkKK3sKKyAgICBjZF9zY3NpX3RhcmdldF9yZXNldChzY3NpX3Rh
cmdldCk7CisgICAgZ19mcmVlKHNjc2lfdGFyZ2V0KTsKK30KKworLyogU0NTSSBEZXZpY2UgKi8K
Kworc3RhdGljIGlubGluZSBnYm9vbGVhbiBjZF9zY3NpX3RhcmdldF9sdW5fbGVnYWwoQ2RTY3Np
VGFyZ2V0ICpzdCwgdWludDMyX3QgbHVuKQoreworICAgIHJldHVybiAobHVuIDwgc3QtPm1heF9s
dW5zKSA/IFRSVUUgOiBGQUxTRTsKK30KKworc3RhdGljIGlubGluZSBnYm9vbGVhbiBjZF9zY3Np
X3RhcmdldF9sdW5fcmVhbGl6ZWQoQ2RTY3NpVGFyZ2V0ICpzdCwgdWludDMyX3QgbHVuKQorewor
ICAgIHJldHVybiAoc3QtPm51bV9sdW5zID09IDAgfHwgIXN0LT51bml0c1tsdW5dLnJlYWxpemVk
KSA/IEZBTFNFIDogVFJVRTsKK30KKworaW50IGNkX3Njc2lfZGV2X3JlYWxpemUodm9pZCAqc2Nz
aV90YXJnZXQsIHVpbnQzMl90IGx1biwKKyAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IENk
U2NzaURldmljZVBhcmFtZXRlcnMgKmRldl9wYXJhbXMpCit7CisgICAgQ2RTY3NpVGFyZ2V0ICpz
dCA9IChDZFNjc2lUYXJnZXQgKilzY3NpX3RhcmdldDsKKyAgICBDZFNjc2lMVSAqZGV2OworCisg
ICAgaWYgKCFjZF9zY3NpX3RhcmdldF9sdW5fbGVnYWwoc3QsIGx1bikpIHsKKyAgICAgICAgU1BJ
Q0VfRVJST1IoIlJlYWxpemUsIGlsbGVnYWwgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQsIGx1bik7
CisgICAgICAgIHJldHVybiAtMTsKKyAgICB9CisgICAgaWYgKGNkX3Njc2lfdGFyZ2V0X2x1bl9y
ZWFsaXplZChzdCwgbHVuKSkgeworICAgICAgICBTUElDRV9FUlJPUigiUmVhbGl6ZSwgYWxyZWFk
eSByZWFsaXplZCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCwgbHVuKTsKKyAgICAgICAgcmV0dXJu
IC0xOworICAgIH0KKyAgICBkZXYgPSAmc3QtPnVuaXRzW2x1bl07CisKKyAgICBtZW1zZXQoZGV2
LCAwLCBzaXplb2YoKmRldikpOworICAgIGRldi0+dGd0ID0gc3Q7CisgICAgZGV2LT5sdW4gPSBs
dW47CisKKyAgICBkZXYtPnJlYWxpemVkID0gVFJVRTsKKyAgICBkZXYtPnJlbW92YWJsZSA9IFRS
VUU7CisgICAgZGV2LT5sb2FkZWQgPSBGQUxTRTsKKyAgICBkZXYtPnByZXZlbnRfbWVkaWFfcmVt
b3ZhbCA9IEZBTFNFOworICAgIGRldi0+Y2Rfcm9tID0gRkFMU0U7CisKKyAgICBkZXYtPnBvd2Vy
X2NvbmQgPSBDRF9TQ1NJX1BPV0VSX0FDVElWRTsKKyAgICBkZXYtPnBvd2VyX2V2ZW50ID0gQ0Rf
UE9XRVJfRVZFTlRfTk9fQ0hBTkdFOworICAgIGRldi0+bWVkaWFfZXZlbnQgPSBDRF9NRURJQV9F
VkVOVF9OT19DSEFOR0U7CisKKyAgICBkZXYtPmNsYWltX3ZlcnNpb24gPSAzOyAvKiAwIDogbm9u
ZTsgMiwzLDUgOiBTUEMvTU1DLXggKi8KKworICAgIGRldi0+dmVuZG9yID0gZ19zdHJkdXAoZGV2
X3BhcmFtcy0+dmVuZG9yKTsKKyAgICBkZXYtPnByb2R1Y3QgPSBnX3N0cmR1cChkZXZfcGFyYW1z
LT5wcm9kdWN0KTsKKyAgICBkZXYtPnZlcnNpb24gPSBnX3N0cmR1cChkZXZfcGFyYW1zLT52ZXJz
aW9uKTsKKyAgICBkZXYtPnNlcmlhbCA9IGdfc3RyZHVwKGRldl9wYXJhbXMtPnNlcmlhbCk7CisK
KyAgICBjZF9zY3NpX2Rldl9zZW5zZV9zZXRfcG93ZXJfb24oZGV2KTsKKworICAgIHN0LT5udW1f
bHVucyArKzsKKworICAgIFNQSUNFX0RFQlVHKCJSZWFsaXplIGx1bjolIiBHX0dVSU5UMzJfRk9S
TUFUICIgYnM6JSIgR19HVUlOVDMyX0ZPUk1BVAorICAgICAgICAgICAgICAgICIgVlI6WyVzXSBQ
VDpbJXNdIHZlcjpbJXNdIFNOWyVzXSIsCisgICAgICAgICAgICAgICAgbHVuLCBkZXYtPmJsb2Nr
X3NpemUsIGRldi0+dmVuZG9yLAorICAgICAgICAgICAgICAgIGRldi0+cHJvZHVjdCwgZGV2LT52
ZXJzaW9uLCBkZXYtPnNlcmlhbCk7CisgICAgcmV0dXJuIDA7Cit9CisKK3N0YXRpYyB2b2lkIGNk
X3Njc2lfbHVfbWVkaWFfcmVzZXQoQ2RTY3NpTFUgKmRldikKK3sKKyAgICAvKiBtZWRpYV9ldmVu
dCBpcyBub3Qgc2V0IGhlcmUsIGFzIGl0IGRlcGVuZHMgb24gdGhlIGNvbnRleHQgKi8KKyAgICBk
ZXYtPnN0cmVhbSA9IE5VTEw7CisgICAgZGV2LT5zaXplID0gMDsKKyAgICBkZXYtPmJsb2NrX3Np
emUgPSAwOworICAgIGRldi0+bnVtX2Jsb2NrcyA9IDA7Cit9CisKK2ludCBjZF9zY3NpX2Rldl9s
b2NrKHZvaWQgKnNjc2lfdGFyZ2V0LCB1aW50MzJfdCBsdW4sIGdib29sZWFuIGxvY2spCit7Cisg
ICAgQ2RTY3NpVGFyZ2V0ICpzdCA9IChDZFNjc2lUYXJnZXQgKilzY3NpX3RhcmdldDsKKyAgICBD
ZFNjc2lMVSAqZGV2OworCisgICAgaWYgKCFjZF9zY3NpX3RhcmdldF9sdW5fbGVnYWwoc3QsIGx1
bikpIHsKKyAgICAgICAgU1BJQ0VfRVJST1IoIkxvY2ssIGlsbGVnYWwgbHVuOiUiIEdfR1VJTlQz
Ml9GT1JNQVQsIGx1bik7CisgICAgICAgIHJldHVybiAtMTsKKyAgICB9CisgICAgaWYgKCFjZF9z
Y3NpX3RhcmdldF9sdW5fcmVhbGl6ZWQoc3QsIGx1bikpIHsKKyAgICAgICAgU1BJQ0VfRVJST1Io
IkxvY2ssIHVucmVhbGl6ZWQgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQsIGx1bik7CisgICAgICAg
IHJldHVybiAtMTsKKyAgICB9CisgICAgZGV2ID0gJnN0LT51bml0c1tsdW5dOworICAgIGRldi0+
cHJldmVudF9tZWRpYV9yZW1vdmFsID0gbG9jazsKKyAgICBTUElDRV9ERUJVRygibHVuOiUiIEdf
R1VJTlQzMl9GT1JNQVQgIiVzbG9jayIsIGx1biwgbG9jayA/ICJ1biIgOiIiKTsKKyAgICByZXR1
cm4gMDsKK30KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9sdV9sb2FkKENkU2NzaUxVICpkZXYsCisg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgQ2RTY3NpTWVkaWFQYXJhbWV0ZXJzICpt
ZWRpYV9wYXJhbXMpCit7CisgICAgaWYgKG1lZGlhX3BhcmFtcyAhPSBOVUxMKSB7CisgICAgICAg
IGRldi0+bWVkaWFfZXZlbnQgPSBDRF9NRURJQV9FVkVOVF9ORVdfTUVESUE7CisgICAgICAgIGRl
di0+c3RyZWFtID0gbWVkaWFfcGFyYW1zLT5zdHJlYW07CisgICAgICAgIGRldi0+c2l6ZSA9IG1l
ZGlhX3BhcmFtcy0+c2l6ZTsKKyAgICAgICAgZGV2LT5ibG9ja19zaXplID0gbWVkaWFfcGFyYW1z
LT5ibG9ja19zaXplOworICAgICAgICBkZXYtPm51bV9ibG9ja3MgPSBtZWRpYV9wYXJhbXMtPnNp
emUgLyBtZWRpYV9wYXJhbXMtPmJsb2NrX3NpemU7CisgICAgfSBlbHNlIHsKKyAgICAgICAgZGV2
LT5tZWRpYV9ldmVudCA9IENEX01FRElBX0VWRU5UX01FRElBX1JFTU9WQUw7CisgICAgICAgIGNk
X3Njc2lfbHVfbWVkaWFfcmVzZXQoZGV2KTsKKyAgICB9CisgICAgZGV2LT5sb2FkZWQgPSBUUlVF
OworfQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2x1X3VubG9hZChDZFNjc2lMVSAqZGV2KQorewor
ICAgIGRldi0+bWVkaWFfZXZlbnQgPSBDRF9NRURJQV9FVkVOVF9NRURJQV9SRU1PVkFMOworICAg
IGNkX3Njc2lfbHVfbWVkaWFfcmVzZXQoZGV2KTsKKyAgICBkZXYtPmxvYWRlZCA9IEZBTFNFOwor
fQorCitpbnQgY2Rfc2NzaV9kZXZfbG9hZCh2b2lkICpzY3NpX3RhcmdldCwgdWludDMyX3QgbHVu
LAorICAgICAgICAgICAgICAgICAgICAgY29uc3QgQ2RTY3NpTWVkaWFQYXJhbWV0ZXJzICptZWRp
YV9wYXJhbXMpCit7CisgICAgQ2RTY3NpVGFyZ2V0ICpzdCA9IChDZFNjc2lUYXJnZXQgKilzY3Np
X3RhcmdldDsKKyAgICBDZFNjc2lMVSAqZGV2OworCisgICAgaWYgKCFjZF9zY3NpX3RhcmdldF9s
dW5fbGVnYWwoc3QsIGx1bikpIHsKKyAgICAgICAgU1BJQ0VfRVJST1IoIkxvYWQsIGlsbGVnYWwg
bHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQsIGx1bik7CisgICAgICAgIHJldHVybiAtMTsKKyAgICB9
CisgICAgaWYgKCFjZF9zY3NpX3RhcmdldF9sdW5fcmVhbGl6ZWQoc3QsIGx1bikpIHsKKyAgICAg
ICAgU1BJQ0VfRVJST1IoIkxvYWQsIHVucmVhbGl6ZWQgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQs
IGx1bik7CisgICAgICAgIHJldHVybiAtMTsKKyAgICB9CisgICAgZGV2ID0gJnN0LT51bml0c1ts
dW5dOworCisgICAgY2Rfc2NzaV9sdV9sb2FkKGRldiwgbWVkaWFfcGFyYW1zKTsKKyAgICBkZXYt
PnBvd2VyX2NvbmQgPSBDRF9TQ1NJX1BPV0VSX0FDVElWRTsKKyAgICBkZXYtPnBvd2VyX2V2ZW50
ID0gQ0RfUE9XRVJfRVZFTlRfQ0hBTkdFX1NVQ0NFU1M7CisKKyAgICBjZF9zY3NpX2Rldl9zZW5z
ZV9zZXQoZGV2LCAmc2Vuc2VfY29kZV9NRURJVU1fQ0hBTkdFRCk7CisKKyAgICBTUElDRV9ERUJV
RygiTG9hZCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCAiIHNpemU6JSIgR19HVUlOVDY0X0ZPUk1B
VAorICAgICAgICAgICAgICAgICIgYmxrX3N6OiUiIEdfR1VJTlQzMl9GT1JNQVQgIiBudW1fYmxv
Y2tzOiUiIEdfR1VJTlQzMl9GT1JNQVQsCisgICAgICAgICAgICAgICAgbHVuLCBkZXYtPnNpemUs
IGRldi0+YmxvY2tfc2l6ZSwgZGV2LT5udW1fYmxvY2tzKTsKKyAgICByZXR1cm4gMDsKK30KKwor
aW50IGNkX3Njc2lfZGV2X2dldF9pbmZvKHZvaWQgKnNjc2lfdGFyZ2V0LCB1aW50MzJfdCBsdW4s
IENkU2NzaURldmljZUluZm8gKmx1bl9pbmZvKQoreworICAgIENkU2NzaVRhcmdldCAqc3QgPSAo
Q2RTY3NpVGFyZ2V0ICopc2NzaV90YXJnZXQ7CisgICAgQ2RTY3NpTFUgKmRldjsKKworICAgIGlm
ICghY2Rfc2NzaV90YXJnZXRfbHVuX2xlZ2FsKHN0LCBsdW4pKSB7CisgICAgICAgIFNQSUNFX0VS
Uk9SKCJMb2FkLCBpbGxlZ2FsIGx1bjolIiBHX0dVSU5UMzJfRk9STUFULCBsdW4pOworICAgICAg
ICByZXR1cm4gLTE7CisgICAgfQorICAgIGlmICghY2Rfc2NzaV90YXJnZXRfbHVuX3JlYWxpemVk
KHN0LCBsdW4pKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJMb2FkLCB1bnJlYWxpemVkIGx1bjol
IiBHX0dVSU5UMzJfRk9STUFULCBsdW4pOworICAgICAgICByZXR1cm4gLTE7CisgICAgfQorICAg
IGRldiA9ICZzdC0+dW5pdHNbbHVuXTsKKworICAgIGx1bl9pbmZvLT5zdGFydGVkID0gZGV2LT5w
b3dlcl9jb25kID09IENEX1NDU0lfUE9XRVJfQUNUSVZFOworICAgIGx1bl9pbmZvLT5sb2NrZWQg
PSBkZXYtPnByZXZlbnRfbWVkaWFfcmVtb3ZhbDsKKyAgICBsdW5faW5mby0+bG9hZGVkID0gZGV2
LT5sb2FkZWQ7CisKKyAgICBsdW5faW5mby0+cGFyYW1ldGVycy52ZW5kb3IgPSBkZXYtPnZlbmRv
cjsKKyAgICBsdW5faW5mby0+cGFyYW1ldGVycy5wcm9kdWN0ID0gZGV2LT5wcm9kdWN0OworICAg
IGx1bl9pbmZvLT5wYXJhbWV0ZXJzLnZlcnNpb24gPSBkZXYtPnZlcnNpb247CisgICAgbHVuX2lu
Zm8tPnBhcmFtZXRlcnMuc2VyaWFsID0gZGV2LT5zZXJpYWw7CisKKyAgICByZXR1cm4gMDsKK30K
KworaW50IGNkX3Njc2lfZGV2X3VubG9hZCh2b2lkICpzY3NpX3RhcmdldCwgdWludDMyX3QgbHVu
KQoreworICAgIENkU2NzaVRhcmdldCAqc3QgPSAoQ2RTY3NpVGFyZ2V0ICopc2NzaV90YXJnZXQ7
CisgICAgQ2RTY3NpTFUgKmRldjsKKworICAgIGlmICghY2Rfc2NzaV90YXJnZXRfbHVuX2xlZ2Fs
KHN0LCBsdW4pKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJVbmxvYWQsIGlsbGVnYWwgbHVuOiUi
IEdfR1VJTlQzMl9GT1JNQVQsIGx1bik7CisgICAgICAgIHJldHVybiAtMTsKKyAgICB9CisgICAg
aWYgKCFjZF9zY3NpX3RhcmdldF9sdW5fcmVhbGl6ZWQoc3QsIGx1bikpIHsKKyAgICAgICAgU1BJ
Q0VfRVJST1IoIlVubG9hZCwgdW5yZWFsaXplZCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCwgbHVu
KTsKKyAgICAgICAgcmV0dXJuIC0xOworICAgIH0KKyAgICBkZXYgPSAmc3QtPnVuaXRzW2x1bl07
CisgICAgaWYgKCFkZXYtPmxvYWRlZCkgeworICAgICAgICBTUElDRV9FUlJPUigiVW5sb2FkLCBs
dW46JSIgR19HVUlOVDMyX0ZPUk1BVCAiIG5vdCBsb2FkZWQgeWV0IiwgbHVuKTsKKyAgICAgICAg
cmV0dXJuIDA7CisgICAgfQorICAgIGlmIChkZXYtPnByZXZlbnRfbWVkaWFfcmVtb3ZhbCkgewor
ICAgICAgICBTUElDRV9FUlJPUigiVW5sb2FkLCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCAiIHBy
ZXZlbnRfbWVkaWFfcmVtb3ZhbCBzZXQiLCBsdW4pOworICAgICAgICByZXR1cm4gLTE7CisgICAg
fQorCisgICAgY2Rfc2NzaV9sdV91bmxvYWQoZGV2KTsKKyAgICBkZXYtPnBvd2VyX2NvbmQgPSBD
RF9TQ1NJX1BPV0VSX1NUT1BQRUQ7CisgICAgZGV2LT5wb3dlcl9ldmVudCA9IENEX1BPV0VSX0VW
RU5UX0NIQU5HRV9TVUNDRVNTOworCisgICAgY2Rfc2NzaV9kZXZfc2Vuc2Vfc2V0KGRldiwgJnNl
bnNlX2NvZGVfVUFfTk9fTUVESVVNKTsKKworICAgIFNQSUNFX0RFQlVHKCJVbmxvYWQgbHVuOiUi
IEdfR1VJTlQzMl9GT1JNQVQsIGx1bik7CisgICAgcmV0dXJuIDA7Cit9CisKK2ludCBjZF9zY3Np
X2Rldl91bnJlYWxpemUodm9pZCAqc2NzaV90YXJnZXQsIHVpbnQzMl90IGx1bikKK3sKKyAgICBD
ZFNjc2lUYXJnZXQgKnN0ID0gKENkU2NzaVRhcmdldCAqKXNjc2lfdGFyZ2V0OworICAgIENkU2Nz
aUxVICpkZXY7CisKKyAgICBpZiAoIWNkX3Njc2lfdGFyZ2V0X2x1bl9sZWdhbChzdCwgbHVuKSkg
eworICAgICAgICBTUElDRV9FUlJPUigiVW5yZWFsaXplLCBpbGxlZ2FsIGx1bjolIiBHX0dVSU5U
MzJfRk9STUFULCBsdW4pOworICAgICAgICByZXR1cm4gLTE7CisgICAgfQorICAgIGlmICghY2Rf
c2NzaV90YXJnZXRfbHVuX3JlYWxpemVkKHN0LCBsdW4pKSB7CisgICAgICAgIFNQSUNFX0VSUk9S
KCJVbnJlYWxpemUsIGFic2VudCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCwgbHVuKTsKKyAgICAg
ICAgcmV0dXJuIC0xOworICAgIH0KKyAgICBkZXYgPSAmc3QtPnVuaXRzW2x1bl07CisKKyAgICBp
ZiAoZGV2LT52ZW5kb3IgIT0gTlVMTCkgeworICAgICAgICBmcmVlKGRldi0+dmVuZG9yKTsKKyAg
ICAgICAgZGV2LT52ZW5kb3IgPSBOVUxMOworICAgIH0KKyAgICBpZiAoZGV2LT5wcm9kdWN0ICE9
IE5VTEwpIHsKKyAgICAgICAgZnJlZShkZXYtPnByb2R1Y3QpOworICAgICAgICBkZXYtPnByb2R1
Y3QgPSBOVUxMOworICAgIH0KKyAgICBpZiAoZGV2LT52ZXJzaW9uICE9IE5VTEwpIHsKKyAgICAg
ICAgZnJlZShkZXYtPnZlcnNpb24pOworICAgICAgICBkZXYtPnZlcnNpb24gPSBOVUxMOworICAg
IH0KKyAgICBpZiAoZGV2LT5zZXJpYWwgIT0gTlVMTCkgeworICAgICAgICBmcmVlKGRldi0+c2Vy
aWFsKTsKKyAgICAgICAgZGV2LT5zZXJpYWwgPSBOVUxMOworICAgIH0KKworICAgIGRldi0+bG9h
ZGVkID0gRkFMU0U7CisgICAgZGV2LT5yZWFsaXplZCA9IEZBTFNFOworICAgIGRldi0+cG93ZXJf
Y29uZCA9IENEX1NDU0lfUE9XRVJfU1RPUFBFRDsKKworICAgIHN0LT5udW1fbHVucyAtLTsKKwor
ICAgIFNQSUNFX0RFQlVHKCJVbnJlYWxpemUgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQsIGx1bik7
CisgICAgcmV0dXJuIDA7Cit9CisKK2ludCBjZF9zY3NpX2Rldl9yZXNldCh2b2lkICpzY3NpX3Rh
cmdldCwgdWludDMyX3QgbHVuKQoreworICAgIENkU2NzaVRhcmdldCAqc3QgPSAoQ2RTY3NpVGFy
Z2V0ICopc2NzaV90YXJnZXQ7CisgICAgQ2RTY3NpTFUgKmRldjsKKworICAgIGlmICghY2Rfc2Nz
aV90YXJnZXRfbHVuX2xlZ2FsKHN0LCBsdW4pKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJEZXZp
Y2UgcmVzZXQsIGlsbGVnYWwgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQsIGx1bik7CisgICAgICAg
IHJldHVybiAtMTsKKyAgICB9CisgICAgaWYgKCFjZF9zY3NpX3RhcmdldF9sdW5fcmVhbGl6ZWQo
c3QsIGx1bikpIHsKKyAgICAgICAgU1BJQ0VfRVJST1IoIkRldmljZSByZXNldCwgYWJzZW50IGx1
bjolIiBHX0dVSU5UMzJfRk9STUFULCBsdW4pOworICAgICAgICByZXR1cm4gLTE7CisgICAgfQor
ICAgIGRldiA9ICZzdC0+dW5pdHNbbHVuXTsKKworICAgIC8qCisgICAgICAgIGlmIHdlIHJlc2V0
IHRoZSAncHJldmVudCcgZmxhZyB3ZSBjYW4ndCBjcmVhdGUKKyAgICAgICAgdGhlIHVuaXQgdGhh
dCBpcyBsb2NrZWQgZnJvbSB0aGUgYmVnaW5uaW5nLCBzbworICAgICAgICB3ZSBrZWVwIHRoaXMg
ZmxhZyBhcyBwZXJzaXN0ZW50IG92ZXIgcmVzZXRzCisgICAgKi8KKyAgICAvKiBkZXYtPnByZXZl
bnRfbWVkaWFfcmVtb3ZhbCA9IEZBTFNFOyAqLworICAgIGRldi0+cG93ZXJfY29uZCA9IENEX1ND
U0lfUE9XRVJfQUNUSVZFOworICAgIGRldi0+cG93ZXJfZXZlbnQgPSBDRF9QT1dFUl9FVkVOVF9D
SEFOR0VfU1VDQ0VTUzsKKyAgICBjZF9zY3NpX2Rldl9zZW5zZV9zZXRfcG93ZXJfb24oZGV2KTsK
KworICAgIFNQSUNFX0RFQlVHKCJEZXZpY2UgcmVzZXQgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQs
IGx1bik7CisgICAgcmV0dXJuIDA7Cit9CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfdGFyZ2V0X2Rv
X3Jlc2V0KENkU2NzaVRhcmdldCAqc3QpCit7CisgICAgdWludDMyX3QgbHVuOworCisgICAgZm9y
IChsdW4gPSAwOyBsdW4gPCBzdC0+bWF4X2x1bnM7IGx1bisrKSB7CisgICAgICAgIGlmIChzdC0+
dW5pdHNbbHVuXS5yZWFsaXplZCkgeworICAgICAgICAgICAgY2Rfc2NzaV9kZXZfcmVzZXQoc3Qs
IGx1bik7CisgICAgICAgIH0KKyAgICB9CisKKyAgICBTUElDRV9ERUJVRygiVGFyZ2V0IHJlc2V0
IGNvbXBsZXRlIik7CisgICAgc3QtPnN0YXRlID0gQ0RfU0NTSV9UR1RfU1RBVEVfUlVOTklORzsK
KyAgICBjZF9zY3NpX3RhcmdldF9yZXNldF9jb21wbGV0ZShzdC0+dXNlcl9kYXRhKTsKK30KKwor
aW50IGNkX3Njc2lfdGFyZ2V0X3Jlc2V0KHZvaWQgKnNjc2lfdGFyZ2V0KQoreworICAgIENkU2Nz
aVRhcmdldCAqc3QgPSAoQ2RTY3NpVGFyZ2V0ICopc2NzaV90YXJnZXQ7CisKKyAgICBpZiAoc3Qt
PnN0YXRlID09IENEX1NDU0lfVEdUX1NUQVRFX1JFU0VUKSB7CisgICAgICAgIFNQSUNFX0RFQlVH
KCJUYXJnZXQgYWxyZWFkeSBpbiByZXNldCIpOworICAgICAgICByZXR1cm4gLTE7CisgICAgfQor
CisgICAgc3QtPnN0YXRlID0gQ0RfU0NTSV9UR1RfU1RBVEVfUkVTRVQ7CisKKyAgICBpZiAoc3Qt
PmN1cl9yZXEgIT0gTlVMTCkgeworICAgICAgICBjZF9zY3NpX2Rldl9yZXF1ZXN0X2NhbmNlbChz
Y3NpX3RhcmdldCwgc3QtPmN1cl9yZXEpOworICAgICAgICBpZiAoc3QtPmN1cl9yZXEgIT0gTlVM
TCkgeworICAgICAgICAgICAgU1BJQ0VfREVCVUcoIlRhcmdldCByZXNldCBpbiBwcm9ncmVzcy4u
LiIpOworICAgICAgICAgICAgcmV0dXJuIDA7CisgICAgICAgIH0KKyAgICB9CisKKyAgICBjZF9z
Y3NpX3RhcmdldF9kb19yZXNldChzdCk7CisgICAgcmV0dXJuIDA7Cit9CisKK0NkU2NzaVJlcVN0
YXRlIGNkX3Njc2lfZ2V0X3JlcV9zdGF0ZShDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgcmV0
dXJuIHJlcS0+cmVxX3N0YXRlOworfQorCitzdGF0aWMgdm9pZCBzdHJwYWRjcHkoY2hhciAqYnVm
LCBpbnQgYnVmX3NpemUsIGNvbnN0IGNoYXIgKnN0ciwgY2hhciBwYWQpCit7CisgICAgaW50IGxl
biA9IHN0cm5sZW4oc3RyLCBidWZfc2l6ZSk7CisgICAgbWVtY3B5KGJ1Ziwgc3RyLCBsZW4pOwor
ICAgIG1lbXNldChidWYgKyBsZW4sIHBhZCwgYnVmX3NpemUgLSBsZW4pOworfQorCisvKiBTQ1NJ
IENEQiAqLworCitzdGF0aWMgaW50IHNjc2lfY2RiX2xlbmd0aCh1aW50OF90ICpjZGIpCit7Cisg
ICAgaW50IGNkYl9sZW47CisKKyAgICBzd2l0Y2ggKGNkYlswXSA+PiA1KSB7CisgICAgY2FzZSAw
OgorICAgICAgICBjZGJfbGVuID0gNjsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSAxOgorICAg
IGNhc2UgMjoKKyAgICAgICAgY2RiX2xlbiA9IDEwOworICAgICAgICBicmVhazsKKyAgICBjYXNl
IDQ6CisgICAgICAgIGNkYl9sZW4gPSAxNjsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSA1Ogor
ICAgICAgICBjZGJfbGVuID0gMTI7CisgICAgICAgIGJyZWFrOworICAgIGRlZmF1bHQ6CisgICAg
ICAgIGNkYl9sZW4gPSAtMTsKKyAgICB9CisgICAgcmV0dXJuIGNkYl9sZW47Cit9CisKK3N0YXRp
YyB1aW50NjRfdCBzY3NpX2NkYl9sYmEodWludDhfdCAqY2RiLCBpbnQgY2RiX2xlbikKK3sKKyAg
ICB1aW50NjRfdCBsYmE7CisKKyAgICBzd2l0Y2ggKGNkYl9sZW4pIHsKKyAgICBjYXNlIDY6Cisg
ICAgICAgIGxiYSA9ICgoKHVpbnQ2NF90KShjZGJbMV0gJiAweDFmKSkgPDwgMTYpIHwKKyAgICAg
ICAgICAgICAgKCgodWludDY0X3QpY2RiWzJdKSA8PCA4KSB8CisgICAgICAgICAgICAgICAoKHVp
bnQ2NF90KWNkYlszXSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgMTA6CisgICAgY2FzZSAx
MjoKKyAgICAgICAgbGJhID0gKCgodWludDY0X3QpY2RiWzJdKSA8PCAyNCkgfAorICAgICAgICAg
ICAgICAoKCh1aW50NjRfdCljZGJbM10pIDw8IDE2KSB8CisgICAgICAgICAgICAgICgoKHVpbnQ2
NF90KWNkYls0XSkgPDwgOCkgIHwKKyAgICAgICAgICAgICAgICgodWludDY0X3QpY2RiWzVdKTsK
KyAgICAgICAgYnJlYWs7CisgICAgY2FzZSAxNjoKKyAgICAgICAgbGJhID0gKCgodWludDY0X3Qp
Y2RiWzJdKSA8PCA1NikgfAorICAgICAgICAgICAgICAoKCh1aW50NjRfdCljZGJbM10pIDw8IDQ4
KSB8CisgICAgICAgICAgICAgICgoKHVpbnQ2NF90KWNkYls0XSkgPDwgNDApIHwKKyAgICAgICAg
ICAgICAgKCgodWludDY0X3QpY2RiWzVdKSA8PCAzMikgfAorICAgICAgICAgICAgICAoKCh1aW50
NjRfdCljZGJbNl0pIDw8IDI0KSB8CisgICAgICAgICAgICAgICgoKHVpbnQ2NF90KWNkYls3XSkg
PDwgMTYpIHwKKyAgICAgICAgICAgICAgKCgodWludDY0X3QpY2RiWzhdKSA8PCA4KSAgfAorICAg
ICAgICAgICAgICAgKCh1aW50NjRfdCljZGJbOV0pOworICAgICAgICBicmVhazsKKyAgICBkZWZh
dWx0OgorICAgICAgICBsYmEgPSAwOworICAgIH0KKyAgICByZXR1cm4gbGJhOworfQorCitzdGF0
aWMgdWludDMyX3Qgc2NzaV9jZGJfeGZlcl9sZW5ndGgodWludDhfdCAqY2RiLCBpbnQgY2RiX2xl
bikKK3sKKyAgICB1aW50MzJfdCBsZW47CisKKyAgICBzd2l0Y2ggKGNkYl9sZW4pIHsKKyAgICBj
YXNlIDY6CisgICAgICAgIGxlbiA9ICh1aW50MzJfdCljZGJbNF07CisgICAgICAgIGlmIChsZW4g
PT0gMCkKKyAgICAgICAgICAgIGxlbiA9IDI1NjsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSAx
MDoKKyAgICAgICAgbGVuID0gKCgodWludDMyX3QpY2RiWzddKSA8PCA4KSB8CisgICAgICAgICAg
ICAgICAoKHVpbnQzMl90KWNkYls4XSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgMTI6Cisg
ICAgICAgIGxlbiA9ICgoKHVpbnQzMl90KWNkYls2XSkgPDwgMjQpIHwKKyAgICAgICAgICAgICAg
KCgodWludDMyX3QpY2RiWzddKSA8PCAxNikgfAorICAgICAgICAgICAgICAoKCh1aW50MzJfdClj
ZGJbOF0pIDw8IDgpICB8CisgICAgICAgICAgICAgICAoKHVpbnQzMl90KWNkYls5XSk7CisgICAg
ICAgIGJyZWFrOworICAgIGNhc2UgMTY6CisgICAgICAgIGxlbiA9ICgoKHVpbnQzMl90KWNkYlsx
MF0pIDw8IDI0KSB8CisgICAgICAgICAgICAgICgoKHVpbnQzMl90KWNkYlsxMV0pIDw8IDE2KSB8
CisgICAgICAgICAgICAgICgoKHVpbnQzMl90KWNkYlsxMl0pIDw8IDgpICB8CisgICAgICAgICAg
ICAgICAoKHVpbnQzMl90KWNkYlsxM10pOworICAgICAgICBicmVhazsKKyAgICBkZWZhdWx0Ogor
ICAgICAgICBsZW4gPSAwOworICAgICAgICBicmVhazsKKyAgICB9CisgICAgcmV0dXJuIGxlbjsK
K30KKworLyogU0NTSSBjb21tYW5kcyAqLworCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF90ZXN0
X3VuaXRfcmVhZHkoQ2RTY3NpTFUgKmRldiwgQ2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAgIHJl
cS0+eGZlcl9kaXIgPSBTQ1NJX1hGRVJfTk9ORTsKKyAgICByZXEtPmluX2xlbiA9IDA7CisKKyAg
ICBpZiAoZGV2LT5sb2FkZWQpIHsKKyAgICAgICAgaWYgKGRldi0+cG93ZXJfY29uZCAhPSBDRF9T
Q1NJX1BPV0VSX1NUT1BQRUQpIHsKKyAgICAgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2dv
b2QoZGV2LCByZXEpOworICAgICAgICB9IGVsc2UgeworICAgICAgICAgICAgY2Rfc2NzaV9jbWRf
Y29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfSU5JVF9DTURfUkVRVUlS
RUQpOworICAgICAgICB9CisgICAgfSBlbHNlIHsKKyAgICAgICAgY2Rfc2NzaV9jbWRfY29tcGxl
dGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfTk9UX1JFQURZX05PX01FRElVTSk7
CisgICAgfQorfQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9yZXF1ZXN0X3NlbnNlKENkU2Nz
aUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICByZXEtPnhmZXJfZGlyID0gU0NT
SV9YRkVSX0ZST01fREVWOworCisgICAgcmVxLT5yZXFfbGVuID0gcmVxLT5jZGJbNF07CisgICAg
cmVxLT5pbl9sZW4gPSAocmVxLT5yZXFfbGVuIDwgc2l6ZW9mKGRldi0+Zml4ZWRfc2Vuc2UpKSA/
CisgICAgICAgICAgICAgICAgICAgcmVxLT5yZXFfbGVuIDogc2l6ZW9mKGRldi0+Zml4ZWRfc2Vu
c2UpOworCisgICAgaWYgKGRldi0+c2hvcnRfc2Vuc2Uua2V5ICE9IE5PX1NFTlNFKSB7CisgICAg
ICAgIFNQSUNFX0RFQlVHKCIlcywgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQgIiByZXBvcnRlZCBz
ZW5zZTogMHglMDJ4ICUwMnggJTAyeCAtICVzLCAlcyIsCisgICAgICAgICAgICAgICAgICAgIF9f
RlVOQ1RJT05fXywgcmVxLT5sdW4sCisgICAgICAgICAgICAgICAgICAgIGRldi0+c2hvcnRfc2Vu
c2Uua2V5LCBkZXYtPnNob3J0X3NlbnNlLmFzYywgZGV2LT5zaG9ydF9zZW5zZS5hc2NxLAorICAg
ICAgICAgICAgICAgICAgICBjZF9zY3NpX3NlbnNlX2tleV9kZXNjcihkZXYtPnNob3J0X3NlbnNl
LmtleSksCisgICAgICAgICAgICAgICAgICAgIGRldi0+c2hvcnRfc2Vuc2UuZGVzY3IpOworICAg
IH0KKyAgICBtZW1jcHkocmVxLT5idWYsIGRldi0+Zml4ZWRfc2Vuc2UsIHNpemVvZihkZXYtPmZp
eGVkX3NlbnNlKSk7CisgICAgY2Rfc2NzaV9kZXZfc2Vuc2VfcmVzZXQoZGV2KTsgLyogY2xlYXIg
cmVwb3J0ZWQgc2Vuc2UgKi8KKworICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2LCBy
ZXEpOworfQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9yZXBvcnRfbHVucyhDZFNjc2lUYXJn
ZXQgKnN0LCBDZFNjc2lMVSAqZGV2LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgQ2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAgIHVpbnQ4X3QgKm91dF9idWYgPSByZXEtPmJ1
ZjsKKyAgICB1aW50MzJfdCBudW1fbHVucyA9IHN0LT5udW1fbHVuczsKKyAgICB1aW50MzJfdCBi
dWZsZW4gPSA4OyAvKiBoZWFkZXIgbGVuZ3RoICovCisgICAgdWludDMyX3QgbHVuOworCisgICAg
cmVxLT5yZXFfbGVuID0gc2NzaV9jZGJfeGZlcl9sZW5ndGgocmVxLT5jZGIsIDEyKTsKKyAgICBy
ZXEtPnhmZXJfZGlyID0gU0NTSV9YRkVSX0ZST01fREVWOworCisgICAgaWYgKHJlcS0+Y2RiWzBd
ID09IDB4MDEpIHsKKyAgICAgICAgLyogb25seSB3ZWxsIGtub3duIGxvZ2ljYWwgdW5pdHMgKi8K
KyAgICAgICAgbnVtX2x1bnMgPSAwOworICAgIH0KKworICAgIG91dF9idWZbMF0gPSAodWludDhf
dCkobnVtX2x1bnMgPj4gMjQpOworICAgIG91dF9idWZbMV0gPSAodWludDhfdCkobnVtX2x1bnMg
Pj4gMTYpOworICAgIG91dF9idWZbMl0gPSAodWludDhfdCkobnVtX2x1bnMgPj4gOCk7CisgICAg
b3V0X2J1ZlszXSA9ICh1aW50OF90KShudW1fbHVucyk7CisgICAgbWVtc2V0KCZvdXRfYnVmWzRd
LCAwLCA0KTsKKworICAgIGlmIChudW1fbHVucyA+IDApIHsKKyAgICAgICAgZm9yIChsdW4gPSAw
OyBsdW4gPCBudW1fbHVuczsgbHVuKyspIHsKKyAgICAgICAgICAgIGlmIChzdC0+dW5pdHNbbHVu
XS5yZWFsaXplZCkgeworICAgICAgICAgICAgICAgIG91dF9idWZbYnVmbGVuKytdID0gKHVpbnQ4
X3QpKG51bV9sdW5zID4+IDI0KTsKKyAgICAgICAgICAgICAgICBvdXRfYnVmW2J1ZmxlbisrXSA9
ICh1aW50OF90KShudW1fbHVucyA+PiAxNik7CisgICAgICAgICAgICAgICAgb3V0X2J1ZltidWZs
ZW4rK10gPSAodWludDhfdCkobnVtX2x1bnMgPj4gOCk7CisgICAgICAgICAgICAgICAgb3V0X2J1
ZltidWZsZW4rK10gPSAodWludDhfdCkobnVtX2x1bnMpOworICAgICAgICAgICAgICAgIG1lbXNl
dCgmb3V0X2J1ZltidWZsZW5dLCAwLCA0KTsKKyAgICAgICAgICAgICAgICBidWZsZW4gKz0gNDsK
KyAgICAgICAgICAgIH0KKyAgICAgICAgfQorICAgIH0KKworICAgIHJlcS0+aW5fbGVuID0gYnVm
bGVuOworICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2LCByZXEpOworfQorCisjZGVm
aW5lIFNDU0lfTUFYX0lOUVVJUllfTEVOICAgICAgICAyNTYKKyNkZWZpbmUgU0NTSV9NQVhfTU9E
RV9MRU4gICAgICAgICAgIDI1NgorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9pbnF1aXJ5X3Zw
ZF9ub19sdW4oQ2RTY3NpTFUgKmRldiwgQ2RTY3NpUmVxdWVzdCAqcmVxLAorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IHBlcmlmX3F1YWwpCit7Cisg
ICAgdWludDhfdCAqb3V0YnVmID0gcmVxLT5idWY7CisgICAgdWludDhfdCBwYWdlX2NvZGUgPSBy
ZXEtPmNkYlsyXTsKKyAgICB1aW50MzJfdCByZXNwX2xlbiA9IDQ7CisKKyAgICBvdXRidWZbMF0g
PSAocGVyaWZfcXVhbCA8PCA1KSB8IFRZUEVfUk9NOworICAgIG91dGJ1ZlsxXSA9IHBhZ2VfY29k
ZSA7IC8qIHRoaXMgcGFnZSAqLworICAgIG91dGJ1ZlsyXSA9IDB4MDA7IC8qIHBhZ2UgbGVuZ3Ro
IE1TQiAqLworICAgIG91dGJ1ZlszXSA9IDB4MDA7IC8qIHBhZ2UgbGVuZ3RoIExTQiAtIG5vIG1v
cmUgZGF0YSAqLworCisgICAgcmVxLT5pbl9sZW4gPSAocmVxLT5yZXFfbGVuIDwgcmVzcF9sZW4p
ID8gcmVxLT5yZXFfbGVuIDogcmVzcF9sZW47CisKKyAgICBTUElDRV9ERUJVRygiaW5xdWlyeV92
cGQsIHVuc3VwcG9ydGVkIGx1bjolIiBHX0dVSU5UMzJfRk9STUFUCisgICAgICAgICAgICAgICAg
IiBwZXJpZl9xdWFsOjB4JXggcmVzcF9sZW46ICUiIEdfR1VJTlQ2NF9GT1JNQVQsCisgICAgICAg
ICAgICAgICAgcmVxLT5sdW4sIHBlcmlmX3F1YWwsIHJlcS0+aW5fbGVuKTsKKworICAgIGNkX3Nj
c2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2LCByZXEpOworfQorCitzdGF0aWMgdm9pZCBjZF9zY3Np
X2NtZF9pbnF1aXJ5X3ZwZChDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7Cisg
ICAgdWludDhfdCAqb3V0YnVmID0gcmVxLT5idWY7CisgICAgdWludDhfdCBwYWdlX2NvZGUgPSBy
ZXEtPmNkYlsyXTsKKyAgICBpbnQgYnVmbGVuID0gNDsKKyAgICBpbnQgc3RhcnQgPSA0OworCisg
ICAgb3V0YnVmWzBdID0gVFlQRV9ST007CisgICAgb3V0YnVmWzFdID0gcGFnZV9jb2RlIDsgLyog
dGhpcyBwYWdlICovCisgICAgb3V0YnVmWzJdID0gMHgwMDsgLyogcGFnZSBsZW5ndGggTVNCICov
CisgICAgb3V0YnVmWzNdID0gMHgwMDsgLyogcGFnZSBsZW5ndGggTFNCLCB0byB3cml0ZSBsYXRl
ciAqLworCisgICAgc3dpdGNoIChwYWdlX2NvZGUpIHsKKyAgICBjYXNlIDB4MDA6IC8qIFN1cHBv
cnRlZCBwYWdlIGNvZGVzLCBtYW5kYXRvcnkgKi8KKyAgICB7CisgICAgICAgIG91dGJ1ZltidWZs
ZW4rK10gPSAweDAwOyAvLyBsaXN0IG9mIHN1cHBvcnRlZCBwYWdlcyAodGhpcyBwYWdlKQorICAg
ICAgICBpZiAoZGV2LT5zZXJpYWwpIHsKKyAgICAgICAgICAgIG91dGJ1ZltidWZsZW4rK10gPSAw
eDgwOyAvLyB1bml0IHNlcmlhbCBudW1iZXIKKyAgICAgICAgfQorICAgICAgICBvdXRidWZbYnVm
bGVuKytdID0gMHg4MzsgLy8gZGV2aWNlIGlkZW50aWZpY2F0aW9uCisKKyAgICAgICAgU1BJQ0Vf
REVCVUcoIklucXVpcnkgRVZQRFtTdXBwb3J0ZWQgcGFnZXNdIGx1bjolIiBHX0dVSU5UMzJfRk9S
TUFUCisgICAgICAgICAgICAgICAgICAgICIgcmVxX2xlbjogJSIgR19HVUlOVDY0X0ZPUk1BVCAi
IHJlc3BfbGVuOiAlZCIsCisgICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuLCByZXEtPnJlcV9s
ZW4sIGJ1Zmxlbik7CisgICAgICAgIGJyZWFrOworICAgIH0KKyAgICBjYXNlIDB4ODA6IC8qIERl
dmljZSBzZXJpYWwgbnVtYmVyLCBvcHRpb25hbCAqLworICAgIHsKKyAgICAgICAgaW50IHNlcmlh
bF9sZW47CisKKyAgICAgICAgc2VyaWFsX2xlbiA9IHN0cmxlbihkZXYtPnNlcmlhbCk7CisgICAg
ICAgIGlmIChzZXJpYWxfbGVuID4gMzYpIHsKKyAgICAgICAgICAgIHNlcmlhbF9sZW4gPSAzNjsK
KyAgICAgICAgfQorICAgICAgICBtZW1jcHkob3V0YnVmK2J1ZmxlbiwgZGV2LT5zZXJpYWwsIHNl
cmlhbF9sZW4pOworICAgICAgICBidWZsZW4gKz0gc2VyaWFsX2xlbjsKKworICAgICAgICBTUElD
RV9ERUJVRygiSW5xdWlyeSBFVlBEW1NlcmlhbCBudW1dIGx1bjolIiBHX0dVSU5UMzJfRk9STUFU
CisgICAgICAgICAgICAgICAgICAgICIgcmVxX2xlbjogJSIgR19HVUlOVDY0X0ZPUk1BVCAiIHJl
c3BfbGVuOiAlZCIsCisgICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuLCByZXEtPnJlcV9sZW4s
IGJ1Zmxlbik7CisgICAgICAgIGJyZWFrOworICAgIH0KKyAgICBjYXNlIDB4ODM6IC8qIERldmlj
ZSBpZGVudGlmaWNhdGlvbiBwYWdlLCBtYW5kYXRvcnkgKi8KKyAgICB7CisgICAgICAgIGludCBz
ZXJpYWxfbGVuID0gc3RybGVuKGRldi0+c2VyaWFsKTsKKyAgICAgICAgaW50IG1heF9sZW4gPSAy
MDsKKworICAgICAgICBpZiAoc2VyaWFsX2xlbiA+IG1heF9sZW4pIHsKKyAgICAgICAgICAgIHNl
cmlhbF9sZW4gPSBtYXhfbGVuOworICAgICAgICB9CisKKyAgICAgICAgb3V0YnVmW2J1Zmxlbisr
XSA9IDB4MjsgLy8gQVNDSUkKKyAgICAgICAgb3V0YnVmW2J1ZmxlbisrXSA9IDA7ICAgLy8gbm90
IG9mZmljaWFsbHkgYXNzaWduZWQKKyAgICAgICAgb3V0YnVmW2J1ZmxlbisrXSA9IDA7ICAgLy8g
cmVzZXJ2ZWQKKyAgICAgICAgb3V0YnVmW2J1ZmxlbisrXSA9IHNlcmlhbF9sZW47IC8vIGxlbmd0
aCBvZiBkYXRhIGZvbGxvd2luZworCisgICAgICAgIG1lbWNweShvdXRidWYrYnVmbGVuLCBkZXYt
PnNlcmlhbCwgc2VyaWFsX2xlbik7CisgICAgICAgIGJ1ZmxlbiArPSBzZXJpYWxfbGVuOworCisg
ICAgICAgIFNQSUNFX0RFQlVHKCJJbnF1aXJ5IEVWUERbRGV2aWNlIGlkXSBsdW46JSIgR19HVUlO
VDMyX0ZPUk1BVAorICAgICAgICAgICAgICAgICAgICAiIHJlcV9sZW46ICUiIEdfR1VJTlQ2NF9G
T1JNQVQgIiByZXNwX2xlbjogJWQiLAorICAgICAgICAgICAgICAgICAgICByZXEtPmx1biwgcmVx
LT5yZXFfbGVuLCBidWZsZW4pOworICAgICAgICBicmVhazsKKyAgICB9CisKKyAgICBkZWZhdWx0
OgorICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vu
c2VfY29kZV9JTlZBTElEX0NEQl9GSUVMRCk7CisgICAgICAgIFNQSUNFX0RFQlVHKCJpbnF1aXJ5
X3N0YW5kYXJkLCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCAiIGludmFsaWQgcGFnZV9jb2RlOiAl
MDJ4IiwKKyAgICAgICAgICAgICAgICAgICAgcmVxLT5sdW4sIChpbnQpcGFnZV9jb2RlKTsKKyAg
ICAgICAgcmV0dXJuOworICAgIH0KKworICAgIC8qIGRvbmUgd2l0aCBFVlBEICovCisgICAgZ19h
c3NlcnQoYnVmbGVuIC0gc3RhcnQgPD0gMjU1KTsKKyAgICBvdXRidWZbM10gPSBidWZsZW4gLSBz
dGFydDsgLyogcGFnZSBsZW5ndGggTFNCICovCisKKyAgICByZXEtPmluX2xlbiA9IGJ1ZmxlbjsK
KyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworI2RlZmluZSBJ
TlFVSVJZX1NUQU5EQVJEX0xFTl9NSU4gICAgICAgICAgICAzNgorI2RlZmluZSBJTlFVSVJZX1NU
QU5EQVJEX0xFTiAgICAgICAgICAgICAgICA5NgorI2RlZmluZSBJTlFVSVJZX1NUQU5EQVJEX0xF
Tl9OT19WRVIgICAgICAgICA1NworCisjZGVmaW5lIFBFUklGX1FVQUxJRklFUl9DT05ORUNURUQg
ICAgICAgICAgIDB4MDAKKyNkZWZpbmUgUEVSSUZfUVVBTElGSUVSX05PVF9DT05ORUNURUQgICAg
ICAgMHgwMQorI2RlZmluZSBQRVJJRl9RVUFMSUZJRVJfVU5TVVBQT1JURUQgICAgICAgICAweDAz
CisKKyNkZWZpbmUgSU5RVUlSWV9SRU1PVkFCTEVfTUVESVVNICAgICAgICAgICAgMHg4MAorCisj
ZGVmaW5lIElOUVVJUllfVkVSU0lPTl9OT05FICAgICAgICAgICAgICAgIDB4MDAKKyNkZWZpbmUg
SU5RVUlSWV9WRVJTSU9OX1NQQzMgICAgICAgICAgICAgICAgMHgwNQorCisvKiBieXRlIDMgKi8K
KyNkZWZpbmUgSU5RVUlSWV9SRVNQX0hJU1VQICAgICAgICAgICAgICAgICAgKDB4MDEgPDwgNCkK
KyNkZWZpbmUgSU5RVUlSWV9SRVNQX05PUk1fQUNBICAgICAgICAgICAgICAgKDB4MDEgPDwgNSkK
KyNkZWZpbmUgSU5RVUlSWV9SRVNQX0RBVEFfRk9STUFUX1NQQzMgICAgICAgMHgwMgorCisjZGVm
aW5lIElOUVVJUllfVkVSU0lPTl9ERVNDX1NBTTIgICAgICAgICAgIDB4MDQwCisjZGVmaW5lIElO
UVVJUllfVkVSU0lPTl9ERVNDX1NQQzMgICAgICAgICAgIDB4MzAwCisjZGVmaW5lIElOUVVJUllf
VkVSU0lPTl9ERVNDX01NQzMgICAgICAgICAgIDB4MkEwCisjZGVmaW5lIElOUVVJUllfVkVSU0lP
Tl9ERVNDX1NCQzIgICAgICAgICAgIDB4MzIwCisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX2lu
cXVpcnlfc3RhbmRhcmRfbm9fbHVuKENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90
IHBlcmlmX3F1YWwpCit7CisgICAgdWludDhfdCAqb3V0YnVmID0gcmVxLT5idWY7CisgICAgdWlu
dDMyX3QgcmVzcF9sZW4gPSBJTlFVSVJZX1NUQU5EQVJEX0xFTl9NSU47CisKKyAgICBtZW1zZXQo
cmVxLT5idWYsIDAsIElOUVVJUllfU1RBTkRBUkRfTEVOX01JTik7CisKKyAgICBvdXRidWZbMF0g
PSAocGVyaWZfcXVhbCA8PCA1KSB8IFRZUEVfUk9NOworICAgIG91dGJ1ZlsyXSA9IElOUVVJUllf
VkVSU0lPTl9OT05FOworICAgIG91dGJ1ZlszXSA9IElOUVVJUllfUkVTUF9EQVRBX0ZPUk1BVF9T
UEMzOworCisgICAgb3V0YnVmWzRdID0gcmVzcF9sZW4gLSA0OyAvKiBhZGRpdGlvbmFsIGxlbmd0
aCwgYWZ0ZXIgaGVhZGVyICovCisKKyAgICByZXEtPmluX2xlbiA9IChyZXEtPnJlcV9sZW4gPCBy
ZXNwX2xlbikgPyByZXEtPnJlcV9sZW4gOiByZXNwX2xlbjsKKworICAgIFNQSUNFX0RFQlVHKCJp
bnF1aXJ5X3N0YW5kYXJkLCB1bnN1cHBvcnRlZCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCAiIHBl
cmlmX3F1YWw6MHgleCAiCisgICAgICAgICAgICAgICAgImlucXVpcnlfbGVuOiAlIiBHX0dVSU5U
MzJfRk9STUFUICIgcmVzcF9sZW46ICUiIEdfR1VJTlQ2NF9GT1JNQVQsCisgICAgICAgICAgICAg
ICAgcmVxLT5sdW4sIHBlcmlmX3F1YWwsIHJlc3BfbGVuLCByZXEtPmluX2xlbik7CisKKyAgICBj
ZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworc3RhdGljIHZvaWQgY2Rf
c2NzaV9jbWRfaW5xdWlyeV9zdGFuZGFyZChDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpy
ZXEpCit7CisgICAgdWludDhfdCAqb3V0YnVmID0gcmVxLT5idWY7CisgICAgdWludDMyX3QgcmVz
cF9sZW4gPSAoZGV2LT5jbGFpbV92ZXJzaW9uID09IDApID8gSU5RVUlSWV9TVEFOREFSRF9MRU5f
Tk9fVkVSIDogSU5RVUlSWV9TVEFOREFSRF9MRU47CisKKyAgICBvdXRidWZbMF0gPSAoUEVSSUZf
UVVBTElGSUVSX0NPTk5FQ1RFRCA8PCA1KSB8IFRZUEVfUk9NOworICAgIG91dGJ1ZlsxXSA9IChk
ZXYtPnJlbW92YWJsZSkgPyBJTlFVSVJZX1JFTU9WQUJMRV9NRURJVU0gOiAwOworICAgIG91dGJ1
ZlsyXSA9IChkZXYtPmNsYWltX3ZlcnNpb24gPT0gMCkgPyBJTlFVSVJZX1ZFUlNJT05fTk9ORSA6
IElOUVVJUllfVkVSU0lPTl9TUEMzOworICAgIG91dGJ1ZlszXSA9IElOUVVJUllfUkVTUF9OT1JN
X0FDQSB8IElOUVVJUllfUkVTUF9ISVNVUCB8IElOUVVJUllfUkVTUF9EQVRBX0ZPUk1BVF9TUEMz
OworCisgICAgb3V0YnVmWzRdID0gcmVzcF9sZW4gLSA0OyAvKiBhZGRpdGlvbmFsIGxlbmd0aCwg
YWZ0ZXIgaGVhZGVyICovCisKKyAgICAvKiAob3V0YnVmWzYsN10gPSAwKSBtZWFucyBhbHNvIHtC
UXVlPTAsQ21kUXVlPTB9IC0gbm8gcXVldWVpbmcgYXQgYWxsICovCisKKyAgICBzdHJwYWRjcHko
KGNoYXIgKikgJm91dGJ1Zls4XSwgOCwgZGV2LT52ZW5kb3IsICcgJyk7CisgICAgc3RycGFkY3B5
KChjaGFyICopICZvdXRidWZbMTZdLCAxNiwgZGV2LT5wcm9kdWN0LCAnICcpOworICAgIG1lbWNw
eSgmb3V0YnVmWzMyXSwgZGV2LT52ZXJzaW9uLCBNSU4oNCwgc3RybGVuKGRldi0+dmVyc2lvbikp
KTsKKworICAgIGlmIChkZXYtPmNsYWltX3ZlcnNpb24gPiAwKSB7CisgICAgICAgIC8qIG5vdyBz
dXBwb3J0aW5nIG9ubHkgMyAqLworICAgICAgICBvdXRidWZbNThdID0gKElOUVVJUllfVkVSU0lP
Tl9ERVNDX1NBTTIgPj4gOCkgJiAweGZmOworICAgICAgICBvdXRidWZbNTldID0gSU5RVUlSWV9W
RVJTSU9OX0RFU0NfU0FNMiAmIDB4ZmY7CisKKyAgICAgICAgb3V0YnVmWzYwXSA9IChJTlFVSVJZ
X1ZFUlNJT05fREVTQ19TUEMzID4+IDgpICYgMHhmZjsKKyAgICAgICAgb3V0YnVmWzYxXSA9IElO
UVVJUllfVkVSU0lPTl9ERVNDX1NQQzMgJiAweGZmOworCisgICAgICAgIG91dGJ1Zls2Ml0gPSAo
SU5RVUlSWV9WRVJTSU9OX0RFU0NfTU1DMyA+PiA4KSAmIDB4ZmY7CisgICAgICAgIG91dGJ1Zls2
M10gPSBJTlFVSVJZX1ZFUlNJT05fREVTQ19NTUMzICYgMHhmZjsKKworICAgICAgICBvdXRidWZb
NjRdID0gKElOUVVJUllfVkVSU0lPTl9ERVNDX1NCQzIgPj4gOCkgJiAweGZmOworICAgICAgICBv
dXRidWZbNjVdID0gSU5RVUlSWV9WRVJTSU9OX0RFU0NfU0JDMiAmIDB4ZmY7CisgICAgfQorCisg
ICAgcmVxLT5pbl9sZW4gPSAocmVxLT5yZXFfbGVuIDwgcmVzcF9sZW4pID8gcmVxLT5yZXFfbGVu
IDogcmVzcF9sZW47CisKKyAgICBTUElDRV9ERUJVRygiaW5xdWlyeV9zdGFuZGFyZCwgbHVuOiUi
IEdfR1VJTlQzMl9GT1JNQVQKKyAgICAgICAgICAgICAgICAiIGlucXVpcnlfbGVuOiAlIiBHX0dV
SU5UMzJfRk9STUFUICIgcmVzcF9sZW46ICUiIEdfR1VJTlQ2NF9GT1JNQVQsCisgICAgICAgICAg
ICAgICAgcmVxLT5sdW4sIHJlc3BfbGVuLCByZXEtPmluX2xlbik7CisKKyAgICBjZF9zY3NpX2Nt
ZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworI2RlZmluZSBDRF9JTlFVSVJZX0ZMQUdf
RVZQRCAgICAgICAgICAgICAgICAweDAxCisjZGVmaW5lIENEX0lOUVVJUllfRkxBR19DTURfRFQg
ICAgICAgICAgICAgIDB4MDIKKworc3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRfaW5xdWlyeShDZFNj
c2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgZ2Jvb2xlYW4gZXZwZCwgY21k
X2RhdGE7CisKKyAgICByZXEtPnhmZXJfZGlyID0gU0NTSV9YRkVSX0ZST01fREVWOworCisgICAg
ZXZwZCA9IChyZXEtPmNkYlsxXSAmIENEX0lOUVVJUllfRkxBR19FVlBEKSA/IFRSVUUgOiBGQUxT
RTsKKyAgICBjbWRfZGF0YSA9IChyZXEtPmNkYlsxXSAmIENEX0lOUVVJUllfRkxBR19DTURfRFQp
ID8gVFJVRSA6IEZBTFNFOworCisgICAgaWYgKGNtZF9kYXRhKSB7CisgICAgICAgIFNQSUNFX0RF
QlVHKCJpbnF1aXJ5LCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCAiIENtZERUIGJpdCBzZXQgLSB1
bnN1cHBvcnRlZCwgIgorICAgICAgICAgICAgICAgICAgICAiY2RiWzFdOjB4JTAyeCBjZGJbMV06
MHglMDJ4IiwKKyAgICAgICAgICAgICAgICAgICAgcmVxLT5sdW4sIChpbnQpcmVxLT5jZGJbMV0s
IChpbnQpcmVxLT5jZGJbMl0pOworICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19j
b25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZBTElEX0NEQl9GSUVMRCk7CisgICAgICAgIHJl
dHVybjsKKyAgICB9CisKKyAgICByZXEtPnJlcV9sZW4gPSByZXEtPmNkYls0XSB8IChyZXEtPmNk
YlszXSA8PCA4KTsKKyAgICBtZW1zZXQocmVxLT5idWYsIDAsIHJlcS0+cmVxX2xlbik7CisKKyAg
ICBpZiAoZXZwZCkgeyAvKiBlbmFibGUgdml0YWwgcHJvZHVjdCBkYXRhICovCisgICAgICAgIGNk
X3Njc2lfY21kX2lucXVpcnlfdnBkKGRldiwgcmVxKTsKKyAgICB9IGVsc2UgeyAvKiBzdGFuZGFy
ZCBpbnF1aXJ5IGRhdGEgKi8KKyAgICAgICAgaWYgKHJlcS0+Y2RiWzJdICE9IDApIHsKKyAgICAg
ICAgICAgIFNQSUNFX0RFQlVHKCJpbnF1aXJ5X3N0YW5kYXJkLCBsdW46JSIgR19HVUlOVDMyX0ZP
Uk1BVCAiIG5vbi16ZXJvIHBhZ2UgY29kZTogJTAyeCIsCisgICAgICAgICAgICAgICAgICAgICAg
ICByZXEtPmx1biwgKGludClyZXEtPmNkYlsyXSk7CisgICAgICAgICAgICBjZF9zY3NpX2NtZF9j
b21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZBTElEX0NEQl9GSUVM
RCk7CisgICAgICAgICAgICByZXR1cm47CisgICAgICAgIH0KKyAgICAgICAgY2Rfc2NzaV9jbWRf
aW5xdWlyeV9zdGFuZGFyZChkZXYsIHJlcSk7CisgICAgfQorfQorCitzdGF0aWMgdm9pZCBjZF9z
Y3NpX2NtZF9yZWFkX2NhcGFjaXR5KENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkK
K3sKKyAgICB1aW50MzJfdCBsYXN0X2JsayA9IGRldi0+bnVtX2Jsb2NrcyAtIDE7CisgICAgdWlu
dDMyX3QgYmxrX3NpemUgPSBkZXYtPmJsb2NrX3NpemU7CisgICAgdWludDMyX3QgKmxhc3RfYmxr
X291dCA9ICh1aW50MzJfdCAqKXJlcS0+YnVmOworICAgIHVpbnQzMl90ICpibGtfc2l6ZV9vdXQg
PSAodWludDMyX3QgKikocmVxLT5idWYgKyA0KTsKKworICAgIHJlcS0+eGZlcl9kaXIgPSBTQ1NJ
X1hGRVJfRlJPTV9ERVY7CisgICAgcmVxLT5yZXFfbGVuID0gODsKKworICAgICpsYXN0X2Jsa19v
dXQgPSBodG9iZTMyKGxhc3RfYmxrKTsKKyAgICAqYmxrX3NpemVfb3V0ID0gaHRvYmUzMihibGtf
c2l6ZSk7CisKKyAgICBTUElDRV9ERUJVRygiUmVhZCBjYXBhY2l0eSwgbHVuOiUiIEdfR1VJTlQz
Ml9GT1JNQVQKKyAgICAgICAgICAgICAgICAiIGxhc3RfYmxrOiAlIiBHX0dVSU5UMzJfRk9STUFU
ICIgYmxrX3N6OiAlIiBHX0dVSU5UMzJfRk9STUFULAorICAgICAgICAgICAgICAgIHJlcS0+bHVu
LCBsYXN0X2JsaywgYmxrX3NpemUpOworCisgICAgcmVxLT5pbl9sZW4gPSA4OworICAgIGNkX3Nj
c2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2LCByZXEpOworfQorCisjZGVmaW5lIFJESV9UWVBFX1NU
QU5EQVJEICAgICAgICAgICAwIC8qIFN0YW5kYXJkIERpc2MgSW5mb3JtYXRpb24gKi8KKyNkZWZp
bmUgUkRJX1RZUEVfVFJBQ0tfUkVTT1VSQ0VTICAgIDEgLyogVHJhY2sgUmVzb3VyY2VzIEluZm9y
bWF0aW9uICovCisjZGVmaW5lIFJESV9UWVBFX1BPV19SRVNPVVJDRVMgICAgICAyIC8qIFBPVyBS
ZXNvdXJjZXMgSW5mb3JtYXRpb24gKi8KKworI2RlZmluZSBSRElfU1RBTkRBUkRfTEVOICAgICAg
ICAgICAgMzQKKworI2RlZmluZSBSRElfRVJBWkFCTEUgICAgICAgICAgICAgICAgKDB4MDEgPDwg
NCkKKyNkZWZpbmUgUkRJX05PTl9FUkFaQUJMRSAgICAgICAgICAgICgweDAwIDw8IDQpCisKKyNk
ZWZpbmUgUkRJX1NFU1NJT05fRU1QVFkgICAgICAgICAgICgweDAwIDw8IDIpCisjZGVmaW5lIFJE
SV9TRVNTSU9OX0lOQ09NUExFVEUgICAgICAoMHgwMSA8PCAyKQorI2RlZmluZSBSRElfU0VTU0lP
Tl9EQU1BR0VEICAgICAgICAgKDB4MDIgPDwgMikKKyNkZWZpbmUgUkRJX1NFU1NJT05fQ09NUExF
VEUgICAgICAgICgweDAzIDw8IDIpCisKKyNkZWZpbmUgUkRJX0RJU0NfRU1QVFkgICAgICAgICAg
ICAgIDB4MDAKKyNkZWZpbmUgUkRJX0RJU0NfSU5DT01QTEVURSAgICAgICAgIDB4MDEKKyNkZWZp
bmUgUkRJX0RJU0NfQ09NUExFVEUgICAgICAgICAgIDB4MDIKKyNkZWZpbmUgUkRJX0RJU0NfUkFO
RE9NX1dSICAgICAgICAgIDB4MDMKKworI2RlZmluZSBSRElfRElTQ19QTUFfVFlQRV9DRF9ST00g
ICAgMHgwMAorI2RlZmluZSBSRElfRElTQ19QTUFfVFlQRV9DREkgICAgICAgMHgxMAorI2RlZmlu
ZSBSRElfRElTQ19QTUFfVFlQRV9ERENEICAgICAgMHgyMAorI2RlZmluZSBSRElfRElTQ19QTUFf
VFlQRV9VTkRFRklORUQgMHhGRgorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9nZXRfcmVhZF9k
aXNjX2luZm9ybWF0aW9uKENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAg
ICB1aW50OF90ICpvdXRidWYgPSByZXEtPmJ1ZjsKKyAgICB1aW50MzJfdCBkYXRhX3R5cGU7Cisg
ICAgdWludDMyX3QgZmlyc3RfdHJhY2sgPSAxOworICAgIHVpbnQzMl90IGxhc3RfdHJhY2sgPSAx
OworICAgIHVpbnQzMl90IG51bV9zZXNzaW9ucyA9IDE7CisKKyAgICByZXEtPnhmZXJfZGlyID0g
U0NTSV9YRkVSX0ZST01fREVWOworCisgICAgZGF0YV90eXBlID0gcmVxLT5jZGJbMV0gJiAweDc7
CisgICAgaWYgKGRhdGFfdHlwZSAhPSBSRElfVFlQRV9TVEFOREFSRCkgeworICAgICAgICBTUElD
RV9ERUJVRygicmVhZF9kaXNjX2luZm9ybWF0aW9uLCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVAor
ICAgICAgICAgICAgICAgICAgICAiIHVuc3VwcG9ydGVkIGRhdGEgdHlwZTogJTAyeCIsCisgICAg
ICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBkYXRhX3R5cGUpOworICAgICAgICBjZF9zY3NpX2Nt
ZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZBTElEX0NEQl9G
SUVMRCk7CisgICAgICAgIHJldHVybjsKKyAgICB9CisKKyAgICByZXEtPnJlcV9sZW4gPSAocmVx
LT5jZGJbN10gPDwgOCkgfCByZXEtPmNkYls4XTsKKyAgICByZXEtPmluX2xlbiA9IChyZXEtPnJl
cV9sZW4gPCBSRElfU1RBTkRBUkRfTEVOKSA/IHJlcS0+cmVxX2xlbiA6IFJESV9TVEFOREFSRF9M
RU47CisKKyAgICBtZW1zZXQob3V0YnVmLCAwLCBSRElfU1RBTkRBUkRfTEVOKTsKKyAgICBvdXRi
dWZbMV0gPSBSRElfU1RBTkRBUkRfTEVOIC0gMjsgLyogbGVuZ3RoIGV4Y2x1ZGluZyB0aGUgY291
bnRlciBpdHNlbGYgKi8KKyAgICBvdXRidWZbMl0gPSBSRElfTk9OX0VSQVpBQkxFIHwgUkRJX1NF
U1NJT05fQ09NUExFVEUgfCBSRElfRElTQ19DT01QTEVURTsKKyAgICBvdXRidWZbM10gPSBmaXJz
dF90cmFjazsgLyogb24gZGlzayAqLworICAgIG91dGJ1Zls0XSA9IG51bV9zZXNzaW9ucyAmIDB4
ZmY7IC8qIGxzYiAqLworICAgIG91dGJ1Zls1XSA9IGZpcnN0X3RyYWNrICYgMHhmZjsgLyogaW4g
bGFzdCBzZXNzb24sIGxzYiAqLworICAgIG91dGJ1Zls2XSA9IGxhc3RfdHJhY2sgJiAweGZmOyAv
KiBpbiBsYXN0IHNlc3NvbiwgbHNiICovCisgICAgb3V0YnVmWzhdID0gUkRJX0RJU0NfUE1BX1RZ
UEVfQ0RfUk9NOworICAgIG91dGJ1Zls5XSA9IChudW1fc2Vzc2lvbnMgPj4gOCkgJiAweGZmOyAv
KiBtc2IgKi8KKyAgICBvdXRidWZbMTBdID0gKGZpcnN0X3RyYWNrID4+IDgpICYgMHhmZjsgLyog
aW4gbGFzdCBzZXNzb24sIGxzYiAqLworICAgIG91dGJ1ZlsxMV0gPSAobGFzdF90cmFjayA+PiA4
KSAmIDB4ZmY7IC8qIGluIGxhc3Qgc2Vzc29uLCBsc2IgKi8KKworICAgIFNQSUNFX0RFQlVHKCJy
ZWFkX2Rpc2NfaW5mb3JtYXRpb24sIGx1bjolIiBHX0dVSU5UMzJfRk9STUFUICIgbGVuOiAlIiBH
X0dVSU5UNjRfRk9STUFULAorICAgICAgICAgICAgICAgIHJlcS0+bHVuLCByZXEtPmluX2xlbik7
CisKKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworI2RlZmlu
ZSBSVElfQUREUl9UWVBFX0xCQSAgICAgICAgICAgMHgwMAorI2RlZmluZSBSVElfQUREUl9UWVBF
X1RSQUNLX05VTSAgICAgMHgwMQorI2RlZmluZSBSVElfQUREUl9UWVBFX1NFU1NJT05fTlVNICAg
MHgwMgorCisjZGVmaW5lIFJUSV9UUkFDS19OVU1fTEVBRF9JTiAgICAgICAweDAwCisjZGVmaW5l
IFJUSV9UUkFDS19OVU1fSU5WSVNJQkxFICAgICAweGZmCisKKyNkZWZpbmUgVElCX0xFTiAgICAg
ICAgICAgICAgICAgICAgIDB4MzYKKworI2RlZmluZSBUSUJfVFJBQ0tfTU9ERV9DRCAgICAgICAg
ICAgMHgwNAorI2RlZmluZSBUSUJfREFUQV9NT0RFX0lTT18xMDE0OSAgICAgMHgwMQorCisjZGVm
aW5lIFRJQl9MUkFfVkFMSUQgICAgICAgICAgICAgICAoMHgwMSA8PCAxKQorCitzdGF0aWMgdm9p
ZCBjZF9zY3NpX2NtZF9nZXRfcmVhZF90cmFja19pbmZvcm1hdGlvbihDZFNjc2lMVSAqZGV2LCBD
ZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgdWludDhfdCAqb3V0YnVmID0gcmVxLT5idWY7Cisg
ICAgdWludDMyX3QgdHJhY2tfc2l6ZSA9IGRldi0+bnVtX2Jsb2NrczsKKyAgICB1aW50MzJfdCBs
YXN0X2FkZHIgPSB0cmFja19zaXplIC0gMTsKKyAgICB1aW50MzJfdCB0cmFja19udW0gPSAxOwor
ICAgIHVpbnQzMl90IHNlc3Npb25fbnVtID0gMTsKKyAgICB1aW50MzJfdCBhZGRyX3R5cGU7Cisg
ICAgdWludDMyX3QgYWRkcl9udW07CisKKyAgICByZXEtPnhmZXJfZGlyID0gU0NTSV9YRkVSX0ZS
T01fREVWOworCisgICAgYWRkcl90eXBlID0gcmVxLT5jZGJbMV0gJiAweDM7CisgICAgYWRkcl9u
dW0gPSAocmVxLT5jZGJbMl0gPDwgMjQpIHwgKHJlcS0+Y2RiWzNdIDw8IDE2KSB8CisgICAgICAg
ICAgICAgICAocmVxLT5jZGJbNF0gPDwgOCkgfCByZXEtPmNkYls1XTsKKworICAgIHN3aXRjaCAo
YWRkcl90eXBlKSB7CisgICAgY2FzZSBSVElfQUREUl9UWVBFX0xCQToKKyAgICAgICAgaWYgKGFk
ZHJfbnVtID4gbGFzdF9hZGRyKSB7CisgICAgICAgICAgICBTUElDRV9ERUJVRygicmVhZF90cmFj
a19pbmZvcm1hdGlvbiwgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQKKyAgICAgICAgICAgICAgICAg
ICAgICAgICIgYWRkcl90eXBlIExCQTogJSIgR19HVUlOVDMyX0ZPUk1BVAorICAgICAgICAgICAg
ICAgICAgICAgICAgIiBpbnZhbGlkIExCQTogJSIgR19HVUlOVDMyX0ZPUk1BVCwKKyAgICAgICAg
ICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBhZGRyX3R5cGUsIGFkZHJfbnVtKTsKKyAgICAgICAg
ICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2Rl
X0lOVkFMSURfQ0RCX0ZJRUxEKTsKKyAgICAgICAgICAgIHJldHVybjsKKyAgICAgICAgfQorICAg
ICAgICBicmVhazsKKyAgICBjYXNlIFJUSV9BRERSX1RZUEVfVFJBQ0tfTlVNOgorICAgICAgICBp
ZiAoYWRkcl9udW0gIT0gdHJhY2tfbnVtKSB7CisgICAgICAgICAgICBTUElDRV9ERUJVRygicmVh
ZF90cmFja19pbmZvcm1hdGlvbiwgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQKKyAgICAgICAgICAg
ICAgICAgICAgICAgICIgYWRkcl90eXBlIHRyYWNrOiAlIiBHX0dVSU5UMzJfRk9STUFUCisgICAg
ICAgICAgICAgICAgICAgICAgICAiIGludmFsaWQgdHJhY2s6ICUiIEdfR1VJTlQzMl9GT1JNQVQs
CisgICAgICAgICAgICAgICAgICAgICAgICByZXEtPmx1biwgYWRkcl90eXBlLCBhZGRyX251bSk7
CisgICAgICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAm
c2Vuc2VfY29kZV9JTlZBTElEX0NEQl9GSUVMRCk7CisgICAgICAgICAgICByZXR1cm47CisgICAg
ICAgIH0KKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBSVElfQUREUl9UWVBFX1NFU1NJT05fTlVN
OgorICAgICAgICBpZiAoYWRkcl9udW0gIT0gc2Vzc2lvbl9udW0pIHsKKyAgICAgICAgICAgIFNQ
SUNFX0RFQlVHKCJyZWFkX3RyYWNrX2luZm9ybWF0aW9uLCBsdW46JSIgR19HVUlOVDMyX0ZPUk1B
VAorICAgICAgICAgICAgICAgICAgICAgICAgIiBhZGRyX3R5cGUgc2Vzc2lvbjogJSIgR19HVUlO
VDMyX0ZPUk1BVAorICAgICAgICAgICAgICAgICAgICAgICAgIiBpbnZhbGlkIHNlc3Npb246ICUi
IEdfR1VJTlQzMl9GT1JNQVQsCisgICAgICAgICAgICAgICAgICAgICAgICByZXEtPmx1biwgYWRk
cl90eXBlLCBhZGRyX251bSk7CisgICAgICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVj
a19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZBTElEX0NEQl9GSUVMRCk7CisgICAgICAg
ICAgICByZXR1cm47CisgICAgICAgIH0KKyAgICAgICAgYnJlYWs7CisgICAgZGVmYXVsdDoKKyAg
ICAgICAgU1BJQ0VfREVCVUcoInJlYWRfdHJhY2tfaW5mb3JtYXRpb24sIGx1bjolIiBHX0dVSU5U
MzJfRk9STUFUCisgICAgICAgICAgICAgICAgICAgICJpbnZhbGlkIGFkZHJfdHlwZTogJSIgR19H
VUlOVDMyX0ZPUk1BVAorICAgICAgICAgICAgICAgICAgICAiIGFkZHJfbnVtOiAlIiBHX0dVSU5U
MzJfRk9STUFULAorICAgICAgICAgICAgICAgICAgICByZXEtPmx1biwgYWRkcl90eXBlLCBhZGRy
X251bSk7CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEs
ICZzZW5zZV9jb2RlX0lOVkFMSURfQ0RCX0ZJRUxEKTsKKyAgICAgICAgcmV0dXJuOworICAgIH0K
KworICAgIHJlcS0+cmVxX2xlbiA9IChyZXEtPmNkYls3XSA8PCA4KSB8IHJlcS0+Y2RiWzhdOwor
ICAgIHJlcS0+aW5fbGVuID0gKHJlcS0+cmVxX2xlbiA8IFRJQl9MRU4pID8gcmVxLT5yZXFfbGVu
IDogVElCX0xFTjsKKworICAgIG1lbXNldChvdXRidWYsIDAsIFRJQl9MRU4pOworICAgIG91dGJ1
ZlsxXSA9IFRJQl9MRU4gLSAyOworICAgIG91dGJ1ZlsyXSA9IHNlc3Npb25fbnVtOworICAgIG91
dGJ1ZlszXSA9IHRyYWNrX251bTsKKyAgICBvdXRidWZbNV0gPSBUSUJfVFJBQ0tfTU9ERV9DRCAm
IDB4MGY7CisgICAgb3V0YnVmWzZdID0gVElCX0RBVEFfTU9ERV9JU09fMTAxNDkgJiAweDBmOwor
ICAgIG91dGJ1Zls3XSA9IFRJQl9MUkFfVkFMSUQ7CisKKyAgICAvKiBUcmFjayBzaXplICovCisg
ICAgb3V0YnVmWzI0XSA9ICh0cmFja19zaXplID4+IDI0KSAmIDB4ZmY7CisgICAgb3V0YnVmWzI1
XSA9ICh0cmFja19zaXplID4+IDE2KSAmIDB4ZmY7CisgICAgb3V0YnVmWzI2XSA9ICh0cmFja19z
aXplID4+IDgpICYgMHhmZjsKKyAgICBvdXRidWZbMjddID0gKHRyYWNrX3NpemUpICYgMHhmZjsK
KworICAgIC8qIExhc3QgcmVjb3JkZWQgYWRkcmVzcyAqLworICAgIG91dGJ1ZlsyOF0gPSAobGFz
dF9hZGRyID4+IDI0KSAmIDB4ZmY7CisgICAgb3V0YnVmWzI5XSA9IChsYXN0X2FkZHIgPj4gMTYp
ICYgMHhmZjsKKyAgICBvdXRidWZbMzBdID0gKGxhc3RfYWRkciA+PiA4KSAmIDB4ZmY7CisgICAg
b3V0YnVmWzMxXSA9IChsYXN0X2FkZHIpICYgMHhmZjsKKworICAgIFNQSUNFX0RFQlVHKCJyZWFk
X3RyYWNrX2luZm9ybWF0aW9uLCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVAorICAgICAgICAgICAg
ICAgICJhZGRyX3R5cGU6ICUiIEdfR1VJTlQzMl9GT1JNQVQgIiBhZGRyX251bTogJSIgR19HVUlO
VDMyX0ZPUk1BVCwKKyAgICAgICAgICAgICAgICByZXEtPmx1biwgYWRkcl90eXBlLCBhZGRyX251
bSk7CisKKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworI2Rl
ZmluZSBSRUFEX1RPQ19UUkFDS19ERVNDX0xFTiAgICAgOAorI2RlZmluZSBSRUFEX1RPQ19SRVNQ
X0xFTiAgICAgICAgICAgKDQgKyAyKlJFQURfVE9DX1RSQUNLX0RFU0NfTEVOKQorCitzdGF0aWMg
dm9pZCBjZF9zY3NpX2NtZF9yZWFkX3RvYyhDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpy
ZXEpCit7CisgICAgdWludDhfdCAqb3V0YnVmID0gcmVxLT5idWY7CisgICAgdWludDMyX3QgbXNm
LCBmb3JtYXQsIHRyYWNrX251bTsKKyAgICB1aW50MzJfdCBsYXN0X2JsayA9IGRldi0+bnVtX2Js
b2NrcyAtIDE7CisKKyAgICByZXEtPnhmZXJfZGlyID0gU0NTSV9YRkVSX0ZST01fREVWOworCisg
ICAgbXNmID0gKHJlcS0+Y2RiWzFdID4+IDEpICYgMHgxOworICAgIGZvcm1hdCA9IHJlcS0+Y2Ri
WzJdICYgMHhmOworICAgIHRyYWNrX251bSA9IHJlcS0+Y2RiWzZdOworCisgICAgcmVxLT5yZXFf
bGVuID0gKHJlcS0+Y2RiWzddIDw8IDgpIHwgcmVxLT5jZGJbOF07CisgICAgcmVxLT5pbl9sZW4g
PSAocmVxLT5yZXFfbGVuIDwgUkVBRF9UT0NfUkVTUF9MRU4pID8gcmVxLT5yZXFfbGVuIDogUkVB
RF9UT0NfUkVTUF9MRU47CisKKyAgICBtZW1zZXQob3V0YnVmLCAwLCBSRUFEX1RPQ19SRVNQX0xF
Tik7CisgICAgb3V0YnVmWzFdID0gUkVBRF9UT0NfUkVTUF9MRU4gLSAyOyAvKiBsZW5ndGggZXhj
bHVkaW5nIHRoZSBjb3VudGVyIGl0c2VsZiAqLworICAgIG91dGJ1ZlsyXSA9IDE7IC8qIGZpcnN0
IHRyYWNrL3Nlc3Npb24gKi8KKyAgICBvdXRidWZbM10gPSAxOyAvKiBsYXN0IHRyYWNrL3Nlc3Np
b24gKi8KKworICAgIG91dGJ1Zls1XSA9IDB4MDQ7IC8qIERhdGEgQ0QsIG5vIFEtc3ViY2hhbm5l
bCAqLworICAgIG91dGJ1Zls2XSA9IDB4MDE7IC8qIFRyYWNrIG51bWJlciAqLworICAgIG91dGJ1
ZlsxMF0gPSBtc2YgPyAweDAyIDogMHgwOworCisgICAgb3V0YnVmWzEzXSA9IDB4MDQ7IC8qIERh
dGEgQ0QsIG5vIFEtc3ViY2hhbm5lbCAqLworICAgIG91dGJ1ZlsxNF0gPSAweGFhOyAvKiBUcmFj
ayBudW1iZXIgKi8KKyAgICBpZiAobXNmKSB7CisgICAgICAgIGxhc3RfYmxrID0gMHhmZjMwMDAw
MDsKKyAgICB9CisgICAgb3V0YnVmWzE2XSA9IGxhc3RfYmxrID4+IDI0OworICAgIG91dGJ1Zlsx
N10gPSBsYXN0X2JsayA+PiAxNjsKKyAgICBvdXRidWZbMThdID0gbGFzdF9ibGsgPj4gODsKKyAg
ICBvdXRidWZbMTldID0gbGFzdF9ibGs7CisKKyAgICBTUElDRV9ERUJVRygicmVhZF90b2MsIGx1
bjolIiBHX0dVSU5UMzJfRk9STUFUICIgbGVuOiAlIiBHX0dVSU5UNjRfRk9STUFUCisgICAgICAg
ICAgICAgICAgIiBtc2Y6ICV4IGZvcm1hdDogMHglMDJ4IHRyYWNrL3Nlc3Npb246IDB4JTAyeCIs
CisgICAgICAgICAgICAgICAgcmVxLT5sdW4sIHJlcS0+aW5fbGVuLCBtc2YsIGZvcm1hdCwgdHJh
Y2tfbnVtKTsKKworICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2LCByZXEpOworfQor
CisjZGVmaW5lIENEX01PREVfUEFSQU1fNl9MRU5fSEVBREVSICAgICAgICAgICAgICA0CisjZGVm
aW5lIENEX01PREVfUEFSQU1fMTBfTEVOX0hFQURFUiAgICAgICAgICAgICA4CisKKyNkZWZpbmUg
Q0RfTU9ERV9QQUdFX0xFTl9SV19FUlJPUiAgICAgICAgICAgICAgIDEyCisKK3N0YXRpYyB1aW50
MzJfdCBjZF9zY3NpX2FkZF9tb2RlX3BhZ2VfcndfZXJyb3JfcmVjb3ZlcnkoQ2RTY3NpTFUgKmRl
diwgdWludDhfdCAqb3V0YnVmKQoreworICAgIHVpbnQzMl90IHBhZ2VfbGVuID0gQ0RfTU9ERV9Q
QUdFX0xFTl9SV19FUlJPUjsKKworICAgIG91dGJ1ZlswXSA9IE1PREVfUEFHRV9SX1dfRVJST1I7
CisgICAgb3V0YnVmWzFdID0gQ0RfTU9ERV9QQUdFX0xFTl9SV19FUlJPUiAtIDI7CisgICAgb3V0
YnVmWzNdID0gMTsgLyogcmVhZCByZXRyeSBjb3VudCAqLworCisgICAgcmV0dXJuIHBhZ2VfbGVu
OworfQorCisjZGVmaW5lIENEX01PREVfUEFHRV9MRU5fUE9XRVIgICAgICAgICAgICAgICAgICAx
MgorCitzdGF0aWMgdWludDMyX3QgY2Rfc2NzaV9hZGRfbW9kZV9wYWdlX3Bvd2VyX2NvbmRpdGlv
bihDZFNjc2lMVSAqZGV2LCB1aW50OF90ICpvdXRidWYpCit7CisgICAgdWludDMyX3QgcGFnZV9s
ZW4gPSBDRF9NT0RFX1BBR0VfTEVOX1BPV0VSOworCisgICAgb3V0YnVmWzBdID0gTU9ERV9QQUdF
X1BPV0VSOworICAgIG91dGJ1ZlsxXSA9IENEX01PREVfUEFHRV9MRU5fUE9XRVIgLSAyOworCisg
ICAgcmV0dXJuIHBhZ2VfbGVuOworfQorCisjZGVmaW5lIENEX01PREVfUEFHRV9MRU5fRkFVTFRf
RkFJTCAgICAgICAgICAgICAxMgorI2RlZmluZSBDRF9NT0RFX1BBR0VfRkFVTFRfRkFJTF9GTEFH
X1BFUkYgICAgICAgMHg4MAorCitzdGF0aWMgdWludDMyX3QgY2Rfc2NzaV9hZGRfbW9kZV9wYWdl
X2ZhdWx0X3JlcG9ydGluZyhDZFNjc2lMVSAqZGV2LCB1aW50OF90ICpvdXRidWYpCit7CisgICAg
dWludDMyX3QgcGFnZV9sZW4gPSBDRF9NT0RFX1BBR0VfTEVOX0ZBVUxUX0ZBSUw7CisKKyAgICBv
dXRidWZbMF0gPSBNT0RFX1BBR0VfRkFVTFRfRkFJTDsKKyAgICBvdXRidWZbMV0gPSBDRF9NT0RF
X1BBR0VfTEVOX0ZBVUxUX0ZBSUwgLSAyOworICAgIG91dGJ1ZlsyXSB8PSBDRF9NT0RFX1BBR0Vf
RkFVTFRfRkFJTF9GTEFHX1BFUkY7CisKKyAgICByZXR1cm4gcGFnZV9sZW47Cit9CisKKyNkZWZp
bmUgQ0RfTU9ERV9QQUdFX0xFTl9DQVBTX01FQ0hfU1RBVFVTX1JPICAgIDI2CisvKiBieXRlIDIg
Ki8KKyNkZWZpbmUgQ0RfTU9ERV9QQUdFX0NBUFNfQ0RfUl9SRUFEICAgICAgICAgICAgIDB4MDEK
KyNkZWZpbmUgQ0RfTU9ERV9QQUdFX0NBUFNfQ0RfUldfUkVBRCAgICAgICAgICAgICgweDAxIDw8
IDEpCisjZGVmaW5lIENEX01PREVfUEFHRV9DQVBTX0RWRF9ST01fUkVBRCAgICAgICAgICAoMHgw
MSA8PCAzKQorI2RlZmluZSBDRF9NT0RFX1BBR0VfQ0FQU19EVkRfUl9SRUFEICAgICAgICAgICAg
KDB4MDEgPDwgNCkKKyNkZWZpbmUgQ0RfTU9ERV9QQUdFX0NBUFNfRFZEX1JBTV9SRUFEICAgICAg
ICAgICgweDAxIDw8IDUpCisvKiBieXRlIDYgKi8KKyNkZWZpbmUgQ0RfTU9ERV9QQUdFX0NBUFNf
TE9DS19TVVBQT1JUICAgICAgICAgICgweDAxKQorI2RlZmluZSBDRF9NT0RFX1BBR0VfQ0FQU19M
T0NLX1NUQVRFICAgICAgICAgICAgKDB4MDEgPDwgMSkKKyNkZWZpbmUgQ0RfTU9ERV9QQUdFX0NB
UFNfUFJFVkVOVF9KVU1QRVIgICAgICAgICgweDAxIDw8IDIpCisjZGVmaW5lIENEX01PREVfUEFH
RV9DQVBTX0VKRUNUICAgICAgICAgICAgICAgICAoMHgwMSA8PCAzKQorI2RlZmluZSBDRF9NT0RF
X1BBR0VfQ0FQU19MT0FESU5HX1RSQVkgICAgICAgICAgKDB4MDEgPDwgNSkKKworc3RhdGljIHVp
bnQzMl90IGNkX3Njc2lfYWRkX21vZGVfcGFnZV9jYXBzX21lY2hfc3RhdHVzKENkU2NzaUxVICpk
ZXYsIHVpbnQ4X3QgKm91dGJ1ZikKK3sKKyAgICB1aW50MzJfdCBwYWdlX2xlbiA9IENEX01PREVf
UEFHRV9MRU5fQ0FQU19NRUNIX1NUQVRVU19STzsgLyogbm8gd3JpdGUgKi8KKworICAgIG91dGJ1
ZlswXSA9IE1PREVfUEFHRV9DQVBTX01FQ0hfU1RBVFVTOworICAgIG91dGJ1ZlsxXSA9IHBhZ2Vf
bGVuOworICAgIG91dGJ1ZlsyXSA9IENEX01PREVfUEFHRV9DQVBTX0NEX1JfUkVBRCB8IENEX01P
REVfUEFHRV9DQVBTX0NEX1JXX1JFQUQgfAorICAgICAgICAgICAgICAgIENEX01PREVfUEFHRV9D
QVBTX0RWRF9ST01fUkVBRCB8IENEX01PREVfUEFHRV9DQVBTX0RWRF9SX1JFQUQgfAorICAgICAg
ICAgICAgICAgIENEX01PREVfUEFHRV9DQVBTX0RWRF9SQU1fUkVBRDsKKyAgICBvdXRidWZbNl0g
PSBDRF9NT0RFX1BBR0VfQ0FQU19MT0FESU5HX1RSQVkgfCBDRF9NT0RFX1BBR0VfQ0FQU19FSkVD
VCB8IENEX01PREVfUEFHRV9DQVBTX0xPQ0tfU1VQUE9SVDsKKyAgICBpZiAoZGV2LT5wcmV2ZW50
X21lZGlhX3JlbW92YWwpIHsKKyAgICAgICAgb3V0YnVmWzZdIHw9IENEX01PREVfUEFHRV9DQVBT
X0xPQ0tfU1RBVEU7CisgICAgfQorCisgICAgcmV0dXJuIHBhZ2VfbGVuOworfQorCitzdGF0aWMg
dm9pZCBjZF9zY3NpX2NtZF9tb2RlX3NlbnNlXzEwKENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVl
c3QgKnJlcSkKK3sKKyAgICB1aW50OF90ICpvdXRidWYgPSByZXEtPmJ1ZjsKKyAgICBpbnQgbG9u
Z19sYmEsIGRiZCwgcGFnZSwgc3ViX3BhZ2UsIHBjOworICAgIHVpbnQzMl90IHJlc3BfbGVuID0g
Q0RfTU9ERV9QQVJBTV8xMF9MRU5fSEVBREVSOworCisgICAgcmVxLT54ZmVyX2RpciA9IFNDU0lf
WEZFUl9GUk9NX0RFVjsKKworICAgIGxvbmdfbGJhID0gKHJlcS0+Y2RiWzFdID4+IDQpICYgMHgx
OworICAgIGRiZCA9IChyZXEtPmNkYlsxXSA+PiAzKSAmIDB4MTsKKyAgICBwYWdlID0gcmVxLT5j
ZGJbMl0gJiAweDNmOworICAgIHBjID0gcmVxLT5jZGJbMl0gPj4gNjsKKyAgICBzdWJfcGFnZSA9
IHJlcS0+Y2RiWzNdICYgMHhmOworCisgICAgcmVxLT5yZXFfbGVuID0gKHJlcS0+Y2RiWzddIDw8
IDgpIHwgcmVxLT5jZGJbOF07CisKKyAgICBtZW1zZXQob3V0YnVmLCAwLCByZXEtPnJlcV9sZW4p
OworICAgIG91dGJ1ZlsyXSA9ICAwOyAvKiBtZWRpdW0gdHlwZSAqLworCisgICAgc3dpdGNoIChw
YWdlKSB7CisgICAgY2FzZSBNT0RFX1BBR0VfUl9XX0VSUk9SOgorICAgICAgICAvKiBSZWFkL1dy
aXRlIEVycm9yIFJlY292ZXJ5ICovCisgICAgICAgIHJlc3BfbGVuICs9IGNkX3Njc2lfYWRkX21v
ZGVfcGFnZV9yd19lcnJvcl9yZWNvdmVyeShkZXYsIG91dGJ1ZiArIHJlc3BfbGVuKTsKKyAgICAg
ICAgYnJlYWs7CisgICAgY2FzZSBNT0RFX1BBR0VfUE9XRVI6CisgICAgICAgIC8qIFBvd2VyIENv
bmRpc3Rpb25zICovCisgICAgICAgIHJlc3BfbGVuICs9IGNkX3Njc2lfYWRkX21vZGVfcGFnZV9w
b3dlcl9jb25kaXRpb24oZGV2LCBvdXRidWYgKyByZXNwX2xlbik7CisgICAgICAgIGJyZWFrOwor
ICAgIGNhc2UgTU9ERV9QQUdFX0ZBVUxUX0ZBSUw6CisgICAgICAgIC8qIEZhdWx0IC8gRmFpbHVy
ZSBSZXBvcnRpbmcgQ29udHJvbCAqLworICAgICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9t
b2RlX3BhZ2VfZmF1bHRfcmVwb3J0aW5nKGRldiwgb3V0YnVmICsgcmVzcF9sZW4pOworICAgICAg
ICBicmVhazsKKyAgICBjYXNlIE1PREVfUEFHRV9DQVBTX01FQ0hfU1RBVFVTOgorICAgICAgICBy
ZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9tb2RlX3BhZ2VfY2Fwc19tZWNoX3N0YXR1cyhkZXYsIG91
dGJ1ZiArIHJlc3BfbGVuKTsKKyAgICAgICAgYnJlYWs7CisKKyAgICAvKiBub3QgaW1wbGVtZW50
ZWQgKi8KKyAgICBjYXNlIE1PREVfUEFHRV9XUklURV9QQVJBTUVURVI6IC8qIFdyaXRlciBQYXJh
bWV0ZXJzICovCisgICAgY2FzZSBNT0RFX1BBR0VfTVJXOgorICAgIGNhc2UgTU9ERV9QQUdFX01S
V19WRU5ET1I6IC8qIE1SVyAoTW91bnQgUmFpbmllciBSZS13cml0YWJsZSBEaXNrcyAqLworICAg
IGNhc2UgTU9ERV9QQUdFX0NEX0RFVklDRTogLyogQ0QgRGV2aWNlIHBhcmFtZXRlcnMgKi8KKyAg
ICBjYXNlIE1PREVfUEFHRV9UT19QUk9URUNUOiAvKiBUaW1lLW91dCBhbmQgUHJvdGVjdCAqLwor
ICAgIGRlZmF1bHQ6CisgICAgICAgIFNQSUNFX0RFQlVHKCJtb2RlX3NlbnNlXzEwLCBsdW46JSIg
R19HVUlOVDMyX0ZPUk1BVAorICAgICAgICAgICAgICAgICAgICAiIHBhZ2UgMHgleCBub3QgaW1w
bGVtZW50ZWQiLAorICAgICAgICAgICAgICAgICAgICByZXEtPmx1biwgKHVuc2lnbmVkKXBhZ2Up
OworICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vu
c2VfY29kZV9JTlZBTElEX0NEQl9GSUVMRCk7CisgICAgICAgIHJldHVybjsKKyAgICB9CisKKyAg
ICBvdXRidWZbMF0gPSAoKHJlc3BfbGVuIC0gMikgPj4gOCkgJiAweGZmOworICAgIG91dGJ1Zlsx
XSA9IChyZXNwX2xlbiAtIDIpICYgMHhmZjsKKworICAgIHJlcS0+aW5fbGVuID0gKHJlcS0+cmVx
X2xlbiA8IHJlc3BfbGVuKSA/IHJlcS0+cmVxX2xlbiA6IHJlc3BfbGVuOworCisgICAgU1BJQ0Vf
REVCVUcoIm1vZGVfc2Vuc2VfMTAsIGx1bjolIiBHX0dVSU5UMzJfRk9STUFUCisgICAgICAgICAg
ICAgICAgIiBsb25nX2xiYSAlZCwgZGJkICVkLCBwYWdlICVkLCBzdWJfcGFnZSAlZCwgcGMgJWQ7
ICIKKyAgICAgICAgICAgICAgICAicmVzcF9sZW4gJSIgR19HVUlOVDMyX0ZPUk1BVCwKKyAgICAg
ICAgICAgICAgICByZXEtPmx1biwgbG9uZ19sYmEsIGRiZCwgcGFnZSwgc3ViX3BhZ2UsIHBjLCBy
ZXNwX2xlbik7CisKKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30K
Kworc3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRfbW9kZV9zZWxlY3RfNihDZFNjc2lMVSAqZGV2LCBD
ZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgdWludDhfdCAqYmxvY2tfZGVzY19kYXRhLCAqbW9k
ZV9kYXRhOworICAgIHVpbnQzMl90IHBhZ2VfZm9ybWF0LCBzYXZlX3BhZ2VzLCBsaXN0X2xlbjsg
LyogY2RiICovCisgICAgdWludDMyX3QgbnVtX2Jsb2NrcyA9IDAsIGJsb2NrX2xlbiA9IDA7IC8q
IGJsb2NrIGRlc2NyaXB0b3IgKi8KKyAgICB1aW50MzJfdCBtb2RlX2xlbiwgbWVkaXVtX3R5cGUs
IGRldl9wYXJhbSwgYmxvY2tfZGVzY19sZW47IC8qIG1vZGUgcGFyYW0gaGVhZGVyICovCisgICAg
dWludDMyX3QgcGFnZV9udW0gPSAwLCBwYWdlX2xlbiA9IDA7IC8qIG1vZGUgcGFnZSAqLworCisg
ICAgcGFnZV9mb3JtYXQgPSAocmVxLT5jZGJbMV0gPj4gNCkgJiAweDE7CisgICAgc2F2ZV9wYWdl
cyA9IHJlcS0+Y2RiWzFdICYgMHgxOworICAgIGxpc3RfbGVuID0gcmVxLT5jZGJbNF07CisKKyAg
ICBpZiAobGlzdF9sZW4gPiByZXEtPmJ1Zl9sZW4pIHsKKyAgICAgICAgU1BJQ0VfREVCVUcoIm1v
ZGVfc2VsZWN0XzYsIGx1bjolIiBHX0dVSU5UMzJfRk9STUFUCisgICAgICAgICAgICAgICAgICAg
ICIgcGY6JSIgR19HVUlOVDMyX0ZPUk1BVCAiIHNwOiUiIEdfR1VJTlQzMl9GT1JNQVQKKyAgICAg
ICAgICAgICAgICAgICAgIiBsaXN0X2xlbjolIiBHX0dVSU5UMzJfRk9STUFUICIgZXhjZWVkcyBk
YXRhX2xlbjolIiBHX0dVSU5UMzJfRk9STUFULAorICAgICAgICAgICAgICAgICAgICByZXEtPmx1
biwgcGFnZV9mb3JtYXQsIHNhdmVfcGFnZXMsIGxpc3RfbGVuLCByZXEtPmJ1Zl9sZW4pOworICAg
ICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29k
ZV9JTlZBTElEX1BBUkFNX0xFTik7CisgICAgICAgIHJldHVybjsKKyAgICB9CisKKyAgICBtb2Rl
X2xlbiA9IHJlcS0+YnVmWzBdOworICAgIG1lZGl1bV90eXBlID0gcmVxLT5idWZbMV07CisgICAg
ZGV2X3BhcmFtID0gcmVxLT5idWZbMl07CisgICAgYmxvY2tfZGVzY19sZW4gPSByZXEtPmJ1Zlsz
XTsKKworICAgIGlmIChibG9ja19kZXNjX2xlbikgeworICAgICAgICBibG9ja19kZXNjX2RhdGEg
PSAmcmVxLT5idWZbQ0RfTU9ERV9QQVJBTV82X0xFTl9IRUFERVJdOworICAgICAgICBudW1fYmxv
Y2tzID0gKGJsb2NrX2Rlc2NfZGF0YVszXSA8PCAxNikgfCAoYmxvY2tfZGVzY19kYXRhWzJdIDw8
IDgpIHwgYmxvY2tfZGVzY19kYXRhWzNdOworICAgICAgICBibG9ja19sZW4gPSAoYmxvY2tfZGVz
Y19kYXRhWzVdIDw8IDE2KSB8IChibG9ja19kZXNjX2RhdGFbNl0gPDwgOCkgfCBibG9ja19kZXNj
X2RhdGFbN107CisgICAgfQorCisgICAgaWYgKG1vZGVfbGVuKSB7CisgICAgICAgIG1vZGVfZGF0
YSA9ICZyZXEtPmJ1ZltDRF9NT0RFX1BBUkFNXzZfTEVOX0hFQURFUl07CisgICAgICAgIGlmIChi
bG9ja19kZXNjX2xlbikgeworICAgICAgICAgICAgbW9kZV9kYXRhICs9IGJsb2NrX2Rlc2NfbGVu
OworICAgICAgICB9CisgICAgICAgIHBhZ2VfbnVtID0gbW9kZV9kYXRhWzBdICYgMHgzZjsKKyAg
ICAgICAgcGFnZV9sZW4gPSBtb2RlX2RhdGFbMV07CisgICAgfQorCisgICAgU1BJQ0VfREVCVUco
Im1vZGVfc2VsZWN0XzYsIGx1bjolIiBHX0dVSU5UMzJfRk9STUFUCisgICAgICAgICAgICAgICAg
IiBwZjolIiBHX0dVSU5UMzJfRk9STUFUICIgc3A6JSIgR19HVUlOVDMyX0ZPUk1BVAorICAgICAg
ICAgICAgICAgICIgbGlzdF9sZW46JSIgR19HVUlOVDMyX0ZPUk1BVCAiIGRhdGFfbGVuOiUiIEdf
R1VJTlQzMl9GT1JNQVQKKyAgICAgICAgICAgICAgICAiIG1vZGVfbGVuOiUiIEdfR1VJTlQzMl9G
T1JNQVQgIiBtZWRpdW06JSIgR19HVUlOVDMyX0ZPUk1BVAorICAgICAgICAgICAgICAgICIgZGV2
X3BhcmFtOiUiIEdfR1VJTlQzMl9GT1JNQVQgIiBibGtfZGVzY19sZW46JSIgR19HVUlOVDMyX0ZP
Uk1BVAorICAgICAgICAgICAgICAgICIgbnVtX2Jsb2NrczolIiBHX0dVSU5UMzJfRk9STUFUICIg
YmxvY2tfbGVuOiUiIEdfR1VJTlQzMl9GT1JNQVQKKyAgICAgICAgICAgICAgICAiIHBhZ2VfbnVt
OiUiIEdfR1VJTlQzMl9GT1JNQVQgIiBwYWdlX2xlbjolIiBHX0dVSU5UMzJfRk9STUFULAorICAg
ICAgICAgICAgICAgIHJlcS0+bHVuLCBwYWdlX2Zvcm1hdCwgc2F2ZV9wYWdlcywgbGlzdF9sZW4s
IHJlcS0+YnVmX2xlbiwKKyAgICAgICAgICAgICAgICBtb2RlX2xlbiwgbWVkaXVtX3R5cGUsIGRl
dl9wYXJhbSwgYmxvY2tfZGVzY19sZW4sCisgICAgICAgICAgICAgICAgbnVtX2Jsb2NrcywgYmxv
Y2tfbGVuLAorICAgICAgICAgICAgICAgIHBhZ2VfbnVtLCBwYWdlX2xlbik7CisKKyAgICBjZF9z
Y3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworc3RhdGljIHZvaWQgY2Rfc2Nz
aV9jbWRfbW9kZV9zZWxlY3RfMTAoQ2RTY3NpTFUgKmRldiwgQ2RTY3NpUmVxdWVzdCAqcmVxKQor
eworICAgIHVpbnQzMl90IHBhZ2VfZm9ybWF0LCBzYXZlX3BhZ2VzLCBsaXN0X2xlbjsKKworICAg
IHBhZ2VfZm9ybWF0ID0gKHJlcS0+Y2RiWzFdID4+IDQpICYgMHgxOworICAgIHNhdmVfcGFnZXMg
PSByZXEtPmNkYlsxXSAmIDB4MTsKKyAgICBsaXN0X2xlbiA9IChyZXEtPmNkYls3XSA8PCA4KSB8
IHJlcS0+Y2RiWzhdOworCisgICAgaWYgKGxpc3RfbGVuID4gcmVxLT5idWZfbGVuKSB7CisgICAg
ICAgIFNQSUNFX0RFQlVHKCJtb2RlX3NlbGVjdF8xMCwgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQK
KyAgICAgICAgICAgICAgICAgICAgIiBwZjolIiBHX0dVSU5UMzJfRk9STUFUICIgc3A6JSIgR19H
VUlOVDMyX0ZPUk1BVAorICAgICAgICAgICAgICAgICAgICAiIGxpc3RfbGVuOiUiIEdfR1VJTlQz
Ml9GT1JNQVQgIiBleGNlZWRzIGRhdGFfbGVuOiUiIEdfR1VJTlQzMl9GT1JNQVQsCisgICAgICAg
ICAgICAgICAgICAgIHJlcS0+bHVuLCBwYWdlX2Zvcm1hdCwgc2F2ZV9wYWdlcywgbGlzdF9sZW4s
IHJlcS0+YnVmX2xlbik7CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQo
ZGV2LCByZXEsICZzZW5zZV9jb2RlX0lOVkFMSURfUEFSQU1fTEVOKTsKKyAgICAgICAgcmV0dXJu
OworICAgIH0KKworICAgIFNQSUNFX0RFQlVHKCJtb2RlX3NlbGVjdF8xMCwgbHVuOiUiIEdfR1VJ
TlQzMl9GT1JNQVQKKyAgICAgICAgICAgICAgICAiIHBmOiUiIEdfR1VJTlQzMl9GT1JNQVQgIiBz
cDolIiBHX0dVSU5UMzJfRk9STUFUCisgICAgICAgICAgICAgICAgIiBsaXN0X2xlbjolIiBHX0dV
SU5UMzJfRk9STUFUICIgZGF0YV9sZW46JSIgR19HVUlOVDMyX0ZPUk1BVCwKKyAgICAgICAgICAg
ICAgICByZXEtPmx1biwgcGFnZV9mb3JtYXQsIHNhdmVfcGFnZXMsIGxpc3RfbGVuLCByZXEtPmJ1
Zl9sZW4pOworCisgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfZ29vZChkZXYsIHJlcSk7Cit9CisK
KyNkZWZpbmUgQ0RfRkVBVFVSRV9IRUFERVJfTEVOICAgICAgICAgICAgICAgOAorI2RlZmluZSBD
RF9GRUFUVVJFX0RFU0NfTEVOICAgICAgICAgICAgICAgICA0CisKKyNkZWZpbmUgQ0RfUFJPRklM
RV9ERVNDX0xFTiAgICAgICAgICAgICAgICAgNAorI2RlZmluZSBDRF9QUk9GSUxFX0NVUlJFTlQg
ICAgICAgICAgICAgICAgICAweDAxCisKKy8qIFByb2ZpbGVzIExpc3QgKi8KKyNkZWZpbmUgQ0Rf
RkVBVFVSRV9OVU1fUFJPRklMRVNfTElTVCAgICAgICAgMHgwMAorLyogQ29yZSAtIEJhc2ljIEZ1
bmN0aW9uYWxpdHkgKi8KKyNkZWZpbmUgQ0RfRkVBVFVSRV9OVU1fQ09SRSAgICAgICAgICAgICAg
ICAgMHgwMQorLyogTW9ycGhpbmcgLSBUaGUgZGV2aWNlIGNoYW5nZXMgaXRzIGJlaGF2aW9yIGR1
ZSB0byBleHRlcm5hbCBldmVudHMgKi8KKyNkZWZpbmUgQ0RfRkVBVFVSRV9OVU1fTU9SUEggICAg
ICAgICAgICAgICAgMHgwMgorLyogUmVtb3ZhYmxlIE1lZGl1bSAtIFRoZSBtZWRpdW0gbWF5IGJl
IHJlbW92ZWQgZnJvbSB0aGUgZGV2aWNlICovCisjZGVmaW5lIENEX0ZFQVRVUkVfTlVNX1JFTU9W
QUJMRSAgICAgICAgICAgIDB4MDMKKy8qIFJhbmRvbSBSZWFkYWJsZSAtIFBQPTEgUmVhZCBhYmls
aXR5IGZvciBzdG9yYWdlIGRldmljZXMgd2l0aCByYW5kb20gYWRkcmVzc2luZyAqLworI2RlZmlu
ZSBDRF9GRUFUVVJFX05VTV9SQU5ET01fUkVBRCAgICAgICAgICAweDEwCisvKiBDRCBSZWFkIC0g
VGhlIGFiaWxpdHkgdG8gcmVhZCBDRCBzcGVjaWZpYyBzdHJ1Y3R1cmVzICovCisjZGVmaW5lIENE
X0ZFQVRVUkVfTlVNX0NEX1JFQUQgICAgICAgICAgICAgIDB4MUUKKy8qIERWRCBSZWFkIC0gVGhl
IGFiaWxpdHkgdG8gcmVhZCBEVkQgc3BlY2lmaWMgc3RydWN0dXJlcyAqLworI2RlZmluZSBDRF9G
RUFUVVJFX05VTV9EVkRfUkVBRCAgICAgICAgICAgICAweDFGCisvKiBQb3dlciBNYW5hZ2VtZW50
IC0gSW5pdGlhdG9yIGFuZCBkZXZpY2UgZGlyZWN0ZWQgcG93ZXIgbWFuYWdlbWVudCAqLworI2Rl
ZmluZSBDRF9GRUFUVVJFX05VTV9QT1dFUl9NTkdUICAgICAgICAgICAweDEwMAorLyogVGltZW91
dCAqLworI2RlZmluZSBDRF9GRUFUVVJFX05VTV9USU1FT1VUICAgICAgICAgICAgICAweDEwNQor
CisjZGVmaW5lIENEX0ZFQVRVUkVfUkVRX0FMTCAgICAgICAgICAgICAgICAgIDAKKyNkZWZpbmUg
Q0RfRkVBVFVSRV9SRVFfQ1VSUkVOVCAgICAgICAgICAgICAgMQorI2RlZmluZSBDRF9GRUFUVVJF
X1JFUV9TSU5HTEUgICAgICAgICAgICAgICAyCisKKyNkZWZpbmUgQ0RfRkVBVFVSRV9DVVJSRU5U
ICAgICAgICAgICAgICAgICAgMHgwMQorI2RlZmluZSBDRF9GRUFUVVJFX1BFUlNJU1RFTlQgICAg
ICAgICAgICAgICAweDAyCisKKyNkZWZpbmUgQ0RfRkVBVFVSRV9WRVJTSU9OXzEgICAgICAgICAg
ICAgICAgKDB4MDEgPDwgMikKKworI2RlZmluZSBDRF9GRUFUVVJFX1BIWVNfSUZfU0NTSSAgICAg
ICAgICAgICAweDAxCisKKyNkZWZpbmUgQ0RfRkVBVFVSRV9SRU1PVkFCTEVfTE9BRElOR19UUkFZ
ICAgKDB4MDEgPDwgNSkKKyNkZWZpbmUgQ0RfRkVBVFVSRV9SRU1PVkFCTEVfRUpFQ1QgICAgICAg
ICAgKDB4MDEgPDwgMykKKyNkZWZpbmUgQ0RfRkVBVFVSRV9SRU1PVkFCTEVfTk9fUFJWTlRfSk1Q
UiAgKDB4MDEgPDwgMikKKyNkZWZpbmUgQ0RfRkVBVFVSRV9SRU1PVkFCTEVfTE9DSyAgICAgICAg
ICAgKDB4MDEpCisKK3N0YXRpYyBnYm9vbGVhbiBjZF9zY3NpX2ZlYXR1cmVfcmVwb3J0YWJsZSh1
aW50MzJfdCBmZWF0dXJlLCB1aW50MzJfdCBzdGFydF9mZWF0dXJlLCB1aW50MzJfdCByZXFfdHlw
ZSkKK3sKKyAgICByZXR1cm4gKHJlcV90eXBlID09IENEX0ZFQVRVUkVfUkVRX1NJTkdMRSAmJiBz
dGFydF9mZWF0dXJlID09IGZlYXR1cmUpIHx8CisgICAgICAgICAgIChmZWF0dXJlID49IHN0YXJ0
X2ZlYXR1cmUpOworfQorCitzdGF0aWMgdWludDMyX3QgY2Rfc2NzaV9hZGRfZmVhdHVyZV9wcm9m
aWxlc19saXN0KENkU2NzaUxVICpkZXYsIHVpbnQ4X3QgKm91dGJ1ZiwKKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyX3Qgc3RhcnRfZmVhdHVy
ZSwgdWludDMyX3QgcmVxX3R5cGUpCit7CisgICAgdWludDhfdCAqcHJvZmlsZSA9IG91dGJ1ZiAr
IENEX0ZFQVRVUkVfREVTQ19MRU47CisgICAgdWludDMyX3QgZmVhdHVyZV9sZW4gPSBDRF9GRUFU
VVJFX0RFU0NfTEVOOworICAgIHVpbnQzMl90IGFkZF9sZW4sIHByb2ZpbGVfbnVtOworCisgICAg
aWYgKCFjZF9zY3NpX2ZlYXR1cmVfcmVwb3J0YWJsZShDRF9GRUFUVVJFX05VTV9QUk9GSUxFU19M
SVNULCBzdGFydF9mZWF0dXJlLCByZXFfdHlwZSkpIHsKKyAgICAgICAgcmV0dXJuIDA7CisgICAg
fQorICAgIC8qIGZlYXR1cmUgZGVzY3JpcHRvciBoZWFkZXIgKi8KKyAgICBvdXRidWZbMF0gPSAo
Q0RfRkVBVFVSRV9OVU1fUFJPRklMRVNfTElTVCA+PiA4KSAmIDB4ZmY7CisgICAgb3V0YnVmWzFd
ID0gQ0RfRkVBVFVSRV9OVU1fUFJPRklMRVNfTElTVCAmIDB4ZmY7CisgICAgb3V0YnVmWzJdID0g
Q0RfRkVBVFVSRV9QRVJTSVNURU5UIHwgQ0RfRkVBVFVSRV9DVVJSRU5UOworCisgICAgLyogRFZE
LVJPTSBwcm9maWxlIGRlc2NyaXB0b3IgKi8KKyAgICBhZGRfbGVuID0gQ0RfUFJPRklMRV9ERVND
X0xFTjsgLyogc3RhcnQgd2l0aCBzaW5nbGUgcHJvZmlsZSwgYWRkIGxhdGVyICovCisgICAgcHJv
ZmlsZV9udW0gPSBNTUNfUFJPRklMRV9EVkRfUk9NOworCisgICAgcHJvZmlsZVswXSA9IChwcm9m
aWxlX251bSA+PiA4KSAmIDB4ZmY7IC8qIGZlYXR1cmUgY29kZSAqLworICAgIHByb2ZpbGVbMV0g
PSBwcm9maWxlX251bSAmIDB4ZmY7CisgICAgcHJvZmlsZVsyXSA9ICghZGV2LT5jZF9yb20pID8g
Q0RfUFJPRklMRV9DVVJSRU5UIDogMDsKKworICAgIC8qIG5leHQgcHJvZmlsZSAqLworICAgIGFk
ZF9sZW4gKz0gQ0RfUFJPRklMRV9ERVNDX0xFTjsKKyAgICBwcm9maWxlICs9IENEX1BST0ZJTEVf
REVTQ19MRU47CisKKyAgICAvKiBDRC1ST00gcHJvZmlsZSBkZXNjcmlwdG9yICovCisgICAgcHJv
ZmlsZV9udW0gPSBNTUNfUFJPRklMRV9DRF9ST007CisgICAgcHJvZmlsZVswXSA9IChwcm9maWxl
X251bSA+PiA4KSAmIDB4ZmY7CisgICAgcHJvZmlsZVsxXSA9IHByb2ZpbGVfbnVtICYgMHhmZjsK
KyAgICBwcm9maWxlWzJdID0gZGV2LT5jZF9yb20gPyBDRF9QUk9GSUxFX0NVUlJFTlQgOiAwOwor
CisgICAgb3V0YnVmWzNdID0gYWRkX2xlbjsKKyAgICBmZWF0dXJlX2xlbiArPSBhZGRfbGVuOwor
CisgICAgcmV0dXJuIGZlYXR1cmVfbGVuOworfQorCisjZGVmaW5lIENEX0ZFQVRVUkVfQ09SRV9Q
SFlTX1BST0ZJTEVfTEVOICAgIDQKKworc3RhdGljIHVpbnQzMl90IGNkX3Njc2lfYWRkX2ZlYXR1
cmVfY29yZShDZFNjc2lMVSAqZGV2LCB1aW50OF90ICpvdXRidWYsCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IHN0YXJ0X2ZlYXR1cmUsIHVpbnQzMl90
IHJlcV90eXBlKQoreworICAgIHVpbnQ4X3QgKnByb2ZpbGUgPSBvdXRidWYgKyBDRF9GRUFUVVJF
X0RFU0NfTEVOOworICAgIHVpbnQzMl90IGZlYXR1cmVfbGVuID0gQ0RfRkVBVFVSRV9ERVNDX0xF
TiArIENEX0ZFQVRVUkVfQ09SRV9QSFlTX1BST0ZJTEVfTEVOOworCisgICAgaWYgKCFjZF9zY3Np
X2ZlYXR1cmVfcmVwb3J0YWJsZShDRF9GRUFUVVJFX05VTV9DT1JFLCBzdGFydF9mZWF0dXJlLCBy
ZXFfdHlwZSkpIHsKKyAgICAgICAgcmV0dXJuIDA7CisgICAgfQorICAgIG91dGJ1ZlswXSA9IChD
RF9GRUFUVVJFX05VTV9DT1JFID4+IDgpICYgMHhmZjsKKyAgICBvdXRidWZbMV0gPSBDRF9GRUFU
VVJFX05VTV9DT1JFICYgMHhmZjsKKyAgICBvdXRidWZbMl0gPSBDRF9GRUFUVVJFX1BFUlNJU1RF
TlQgfCBDRF9GRUFUVVJFX0NVUlJFTlQ7CisgICAgb3V0YnVmWzNdID0gQ0RfRkVBVFVSRV9DT1JF
X1BIWVNfUFJPRklMRV9MRU47CisKKyAgICBwcm9maWxlWzNdID0gQ0RfRkVBVFVSRV9QSFlTX0lG
X1NDU0k7CisKKyAgICByZXR1cm4gZmVhdHVyZV9sZW47Cit9CisKKyNkZWZpbmUgQ0RfRkVBVFVS
RV9NT1JQSF9QUk9HSUxFX0xFTiAgICA0CisjZGVmaW5lIENEX0ZFQVRVUkVfTU9SUEhfQVNZTkNf
RVZFTlRTICAgMHgwMQorCitzdGF0aWMgdWludDMyX3QgY2Rfc2NzaV9hZGRfZmVhdHVyZV9tb3Jw
aChDZFNjc2lMVSAqZGV2LCB1aW50OF90ICpvdXRidWYsCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCBzdGFydF9mZWF0dXJlLCB1aW50MzJfdCByZXFf
dHlwZSkKK3sKKyAgICB1aW50OF90ICpwcm9maWxlID0gb3V0YnVmICsgQ0RfRkVBVFVSRV9ERVND
X0xFTjsKKyAgICB1aW50MzJfdCBmZWF0dXJlX2xlbiA9IENEX0ZFQVRVUkVfREVTQ19MRU4gKyBD
RF9GRUFUVVJFX01PUlBIX1BST0dJTEVfTEVOOworCisgICAgaWYgKCFjZF9zY3NpX2ZlYXR1cmVf
cmVwb3J0YWJsZShDRF9GRUFUVVJFX05VTV9NT1JQSCwgc3RhcnRfZmVhdHVyZSwgcmVxX3R5cGUp
KSB7CisgICAgICAgIHJldHVybiAwOworICAgIH0KKyAgICBvdXRidWZbMV0gPSBDRF9GRUFUVVJF
X05VTV9NT1JQSDsKKyAgICBvdXRidWZbMl0gPSBDRF9GRUFUVVJFX1BFUlNJU1RFTlQgfCBDRF9G
RUFUVVJFX0NVUlJFTlQ7CisgICAgb3V0YnVmWzNdID0gQ0RfRkVBVFVSRV9NT1JQSF9QUk9HSUxF
X0xFTjsKKworICAgIHByb2ZpbGVbMF0gPSBDRF9GRUFUVVJFX01PUlBIX0FTWU5DX0VWRU5UUzsK
KworICAgIHJldHVybiBmZWF0dXJlX2xlbjsKK30KKworI2RlZmluZSBDRF9GRUFUVVJFX1JFTU9W
QUJMRV9QUk9GSUxFX0xFTiAgICA0CisKK3N0YXRpYyB1aW50MzJfdCBjZF9zY3NpX2FkZF9mZWF0
dXJlX3JlbW92YWJsZShDZFNjc2lMVSAqZGV2LCB1aW50OF90ICpvdXRidWYsCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyX3Qgc3RhcnRfZmVhdHVy
ZSwgdWludDMyX3QgcmVxX3R5cGUpCit7CisgICAgdWludDhfdCAqcHJvZmlsZSA9IG91dGJ1ZiAr
IENEX0ZFQVRVUkVfREVTQ19MRU47CisgICAgdWludDMyX3QgZmVhdHVyZV9sZW4gPSBDRF9GRUFU
VVJFX0RFU0NfTEVOICsgQ0RfRkVBVFVSRV9SRU1PVkFCTEVfUFJPRklMRV9MRU47CisKKyAgICBp
ZiAoIWNkX3Njc2lfZmVhdHVyZV9yZXBvcnRhYmxlKENEX0ZFQVRVUkVfTlVNX1JFTU9WQUJMRSwg
c3RhcnRfZmVhdHVyZSwgcmVxX3R5cGUpKSB7CisgICAgICAgIHJldHVybiAwOworICAgIH0KKyAg
ICBvdXRidWZbMV0gPSBDRF9GRUFUVVJFX05VTV9SRU1PVkFCTEU7CisgICAgb3V0YnVmWzJdID0g
Q0RfRkVBVFVSRV9QRVJTSVNURU5UIHwgQ0RfRkVBVFVSRV9DVVJSRU5UOworICAgIG91dGJ1Zlsz
XSA9IENEX0ZFQVRVUkVfUkVNT1ZBQkxFX1BST0ZJTEVfTEVOOworCisgICAgcHJvZmlsZVswXSA9
IENEX0ZFQVRVUkVfUkVNT1ZBQkxFX05PX1BSVk5UX0pNUFI7CisgICAgaWYgKGRldi0+cmVtb3Zh
YmxlKSB7CisgICAgICAgIHByb2ZpbGVbMF0gfD0gKENEX0ZFQVRVUkVfUkVNT1ZBQkxFX0xPQURJ
TkdfVFJBWSB8IENEX0ZFQVRVUkVfUkVNT1ZBQkxFX0VKRUNUKTsKKyAgICB9CisKKyAgICByZXR1
cm4gZmVhdHVyZV9sZW47Cit9CisKKyNkZWZpbmUgQ0RfRkVBVFVSRV9SQU5ET01fUkVBRF9QUk9G
SUxFX0xFTiAgICA4CisKK3N0YXRpYyB1aW50MzJfdCBjZF9zY3NpX2FkZF9mZWF0dXJlX3JhbmRv
bV9yZWFkKENkU2NzaUxVICpkZXYsIHVpbnQ4X3QgKm91dGJ1ZiwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IHN0YXJ0X2ZlYXR1cmUsIHVp
bnQzMl90IHJlcV90eXBlKQoreworICAgIHVpbnQ4X3QgKnByb2ZpbGUgPSBvdXRidWYgKyBDRF9G
RUFUVVJFX0RFU0NfTEVOOworICAgIHVpbnQzMl90IGZlYXR1cmVfbGVuID0gQ0RfRkVBVFVSRV9E
RVNDX0xFTiArIENEX0ZFQVRVUkVfUkFORE9NX1JFQURfUFJPRklMRV9MRU47CisKKyAgICBpZiAo
IWNkX3Njc2lfZmVhdHVyZV9yZXBvcnRhYmxlKENEX0ZFQVRVUkVfTlVNX1JBTkRPTV9SRUFELCBz
dGFydF9mZWF0dXJlLCByZXFfdHlwZSkpIHsKKyAgICAgICAgcmV0dXJuIDA7CisgICAgfQorICAg
IG91dGJ1ZlswXSA9IChDRF9GRUFUVVJFX05VTV9SQU5ET01fUkVBRCA+PiA4KSAmIDB4ZmY7Cisg
ICAgb3V0YnVmWzFdID0gQ0RfRkVBVFVSRV9OVU1fUkFORE9NX1JFQUQgJiAweGZmOworICAgIG91
dGJ1ZlsyXSA9IENEX0ZFQVRVUkVfUEVSU0lTVEVOVCB8IENEX0ZFQVRVUkVfQ1VSUkVOVDsKKyAg
ICBvdXRidWZbM10gPSBDRF9GRUFUVVJFX1JBTkRPTV9SRUFEX1BST0ZJTEVfTEVOOworCisgICAg
cHJvZmlsZVswXSA9IChkZXYtPmJsb2NrX3NpemUgPj4gMjQpICYgMHhmZjsKKyAgICBwcm9maWxl
WzFdID0gKGRldi0+YmxvY2tfc2l6ZSA+PiAxNikgJiAweGZmOworICAgIHByb2ZpbGVbMl0gPSAo
ZGV2LT5ibG9ja19zaXplID4+IDgpICYgMHhmZjsKKyAgICBwcm9maWxlWzNdID0gKGRldi0+Ymxv
Y2tfc2l6ZSkgJiAweGZmOworICAgIHByb2ZpbGVbNV0gPSAoZGV2LT5jZF9yb20pID8gMHgwMSA6
IDB4MTA7IC8qIGxvZ2ljYWwgYmxvY2tzIHBlciByZWFkYWJsZSB1bml0ICovCisKKyAgICByZXR1
cm4gZmVhdHVyZV9sZW47Cit9CisKKyNkZWZpbmUgQ0RfRkVBVFVSRV9DRF9SRUFEX1BST0ZJTEVf
TEVOICAgIDQKKworc3RhdGljIHVpbnQzMl90IGNkX3Njc2lfYWRkX2ZlYXR1cmVfY2RfcmVhZChD
ZFNjc2lMVSAqZGV2LCB1aW50OF90ICpvdXRidWYsCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IHN0YXJ0X2ZlYXR1cmUsIHVpbnQzMl90IHJlcV90
eXBlKQoreworICAgIHVpbnQ4X3QgKnByb2ZpbGUgPSBvdXRidWYgKyBDRF9GRUFUVVJFX0RFU0Nf
TEVOOworICAgIHVpbnQzMl90IGZlYXR1cmVfbGVuID0gQ0RfRkVBVFVSRV9ERVNDX0xFTiArIENE
X0ZFQVRVUkVfQ0RfUkVBRF9QUk9GSUxFX0xFTjsKKworICAgIGlmICghY2Rfc2NzaV9mZWF0dXJl
X3JlcG9ydGFibGUoQ0RfRkVBVFVSRV9OVU1fQ0RfUkVBRCwgc3RhcnRfZmVhdHVyZSwgcmVxX3R5
cGUpKSB7CisgICAgICAgIHJldHVybiAwOworICAgIH0KKyAgICBvdXRidWZbMF0gPSAoQ0RfRkVB
VFVSRV9OVU1fQ0RfUkVBRCA+PiA4KSAmIDB4ZmY7CisgICAgb3V0YnVmWzFdID0gKENEX0ZFQVRV
UkVfTlVNX0NEX1JFQUQpICYgMHhmZjsKKyAgICBvdXRidWZbMl0gPSBDRF9GRUFUVVJFX1ZFUlNJ
T05fMSB8IENEX0ZFQVRVUkVfUEVSU0lTVEVOVCB8IENEX0ZFQVRVUkVfQ1VSUkVOVDsKKyAgICBv
dXRidWZbM10gPSBDRF9GRUFUVVJFX0NEX1JFQURfUFJPRklMRV9MRU47CisKKyAgICBwcm9maWxl
WzBdID0gMDsgLyogQzIgRXJyb3JzLCBDRC1UZXh0IG5vdCBzdXBwb3J0ZSAqLworCisgICAgcmV0
dXJuIGZlYXR1cmVfbGVuOworfQorCisjZGVmaW5lIENEX0ZFQVRVUkVfRFZEX1JFQURfUFJPRklM
RV9MRU4gICAgMAorCitzdGF0aWMgdWludDMyX3QgY2Rfc2NzaV9hZGRfZmVhdHVyZV9kdmRfcmVh
ZChDZFNjc2lMVSAqZGV2LCB1aW50OF90ICpvdXRidWYsCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCBzdGFydF9mZWF0dXJlLCB1aW50MzJfdCBy
ZXFfdHlwZSkKK3sKKyAgICB1aW50MzJfdCBmZWF0dXJlX2xlbiA9IENEX0ZFQVRVUkVfREVTQ19M
RU4gKyBDRF9GRUFUVVJFX0RWRF9SRUFEX1BST0ZJTEVfTEVOOworCisgICAgaWYgKCFjZF9zY3Np
X2ZlYXR1cmVfcmVwb3J0YWJsZShDRF9GRUFUVVJFX05VTV9DRF9SRUFELCBzdGFydF9mZWF0dXJl
LCByZXFfdHlwZSkpIHsKKyAgICAgICAgcmV0dXJuIDA7CisgICAgfQorICAgIG91dGJ1ZlswXSA9
IChDRF9GRUFUVVJFX05VTV9EVkRfUkVBRCA+PiA4KSAmIDB4ZmY7CisgICAgb3V0YnVmWzFdID0g
KENEX0ZFQVRVUkVfTlVNX0RWRF9SRUFEKSAmIDB4ZmY7CisgICAgb3V0YnVmWzJdID0gQ0RfRkVB
VFVSRV9WRVJTSU9OXzEgfCBDRF9GRUFUVVJFX1BFUlNJU1RFTlQgfCBDRF9GRUFUVVJFX0NVUlJF
TlQ7CisgICAgb3V0YnVmWzNdID0gQ0RfRkVBVFVSRV9EVkRfUkVBRF9QUk9GSUxFX0xFTjsKKwor
ICAgIHJldHVybiBmZWF0dXJlX2xlbjsKK30KKworI2RlZmluZSBDRF9GRUFUVVJFX1BPV0VSX01O
R1RfUFJPRklMRV9MRU4gICAgMAorCitzdGF0aWMgdWludDMyX3QgY2Rfc2NzaV9hZGRfZmVhdHVy
ZV9wb3dlcl9tZ210KENkU2NzaUxVICpkZXYsIHVpbnQ4X3QgKm91dGJ1ZiwKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyX3Qgc3RhcnRfZmVhdHVy
ZSwgdWludDMyX3QgcmVxX3R5cGUpCit7CisgICAgdWludDMyX3QgZmVhdHVyZV9sZW4gPSBDRF9G
RUFUVVJFX0RFU0NfTEVOICsgQ0RfRkVBVFVSRV9QT1dFUl9NTkdUX1BST0ZJTEVfTEVOOworCisg
ICAgaWYgKCFjZF9zY3NpX2ZlYXR1cmVfcmVwb3J0YWJsZShDRF9GRUFUVVJFX05VTV9QT1dFUl9N
TkdULCBzdGFydF9mZWF0dXJlLCByZXFfdHlwZSkpIHsKKyAgICAgICAgcmV0dXJuIDA7CisgICAg
fQorICAgIG91dGJ1ZlswXSA9IChDRF9GRUFUVVJFX05VTV9QT1dFUl9NTkdUID4+IDgpICYgMHhm
ZjsKKyAgICBvdXRidWZbMV0gPSAoQ0RfRkVBVFVSRV9OVU1fUE9XRVJfTU5HVCkgJiAweGZmOwor
ICAgIG91dGJ1ZlsyXSA9IENEX0ZFQVRVUkVfUEVSU0lTVEVOVCB8IENEX0ZFQVRVUkVfQ1VSUkVO
VDsKKyAgICBvdXRidWZbM10gPSBDRF9GRUFUVVJFX1BPV0VSX01OR1RfUFJPRklMRV9MRU47CisK
KyAgICByZXR1cm4gZmVhdHVyZV9sZW47Cit9CisKKyNkZWZpbmUgQ0RfRkVBVFVSRV9USU1FT1VU
X1BST0ZJTEVfTEVOICAgIDAKKworc3RhdGljIHVpbnQzMl90IGNkX3Njc2lfYWRkX2ZlYXR1cmVf
dGltZW91dChDZFNjc2lMVSAqZGV2LCB1aW50OF90ICpvdXRidWYsCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IHN0YXJ0X2ZlYXR1cmUsIHVpbnQz
Ml90IHJlcV90eXBlKQoreworICAgIHVpbnQzMl90IGZlYXR1cmVfbGVuID0gQ0RfRkVBVFVSRV9E
RVNDX0xFTiArIENEX0ZFQVRVUkVfVElNRU9VVF9QUk9GSUxFX0xFTjsKKworICAgIGlmICghY2Rf
c2NzaV9mZWF0dXJlX3JlcG9ydGFibGUoQ0RfRkVBVFVSRV9OVU1fVElNRU9VVCwgc3RhcnRfZmVh
dHVyZSwgcmVxX3R5cGUpKSB7CisgICAgICAgIHJldHVybiAwOworICAgIH0KKyAgICBvdXRidWZb
MF0gPSAoQ0RfRkVBVFVSRV9OVU1fVElNRU9VVCA+PiA4KSAmIDB4ZmY7CisgICAgb3V0YnVmWzFd
ID0gQ0RfRkVBVFVSRV9OVU1fVElNRU9VVCAmIDB4ZmY7CisgICAgb3V0YnVmWzJdID0gQ0RfRkVB
VFVSRV9QRVJTSVNURU5UIHwgQ0RfRkVBVFVSRV9DVVJSRU5UOworICAgIG91dGJ1ZlszXSA9IENE
X0ZFQVRVUkVfVElNRU9VVF9QUk9GSUxFX0xFTjsKKworICAgIHJldHVybiBmZWF0dXJlX2xlbjsK
K30KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRfZ2V0X2NvbmZpZ3VyYXRpb24oQ2RTY3NpTFUg
KmRldiwgQ2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAgIHVpbnQ4X3QgKm91dGJ1ZiA9IHJlcS0+
YnVmOworICAgIHVpbnQzMl90IHByb2ZpbGVfbnVtID0gKCFkZXYtPmNkX3JvbSkgPyBNTUNfUFJP
RklMRV9EVkRfUk9NIDogTU1DX1BST0ZJTEVfQ0RfUk9NOworICAgIHVpbnQzMl90IHJlcV90eXBl
LCBzdGFydF9mZWF0dXJlLCByZXNwX2xlbjsKKworICAgIHJlcS0+eGZlcl9kaXIgPSBTQ1NJX1hG
RVJfRlJPTV9ERVY7CisKKyAgICByZXFfdHlwZSA9IHJlcS0+Y2RiWzFdICYgMHgzOworICAgIHN0
YXJ0X2ZlYXR1cmUgPSAocmVxLT5jZGJbMl0gPDwgOCkgfCByZXEtPmNkYlszXTsKKyAgICByZXEt
PnJlcV9sZW4gPSAocmVxLT5jZGJbN10gPDwgOCkgfCByZXEtPmNkYls4XTsKKworICAgIG1lbXNl
dChvdXRidWYsIDAsIHJlcS0+cmVxX2xlbik7CisKKyAgICAvKiBhdCBsZWFzdCBGZWF0dXJlIEhl
YWRlciBzaG91bGQgYmUgcHJlc2VudCwgdG8gYmUgZmlsbGVkIGxhdGVyICovCisgICAgcmVzcF9s
ZW4gPSBDRF9GRUFUVVJFX0hFQURFUl9MRU47CisKKyAgICBzd2l0Y2ggKHJlcV90eXBlKSB7Cisg
ICAgY2FzZSBDRF9GRUFUVVJFX1JFUV9BTEw6CisgICAgY2FzZSBDRF9GRUFUVVJFX1JFUV9DVVJS
RU5UOgorICAgICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9mZWF0dXJlX3Byb2ZpbGVzX2xp
c3QoZGV2LCBvdXRidWYgKyByZXNwX2xlbiwgc3RhcnRfZmVhdHVyZSwgcmVxX3R5cGUpOworICAg
ICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9mZWF0dXJlX2NvcmUoZGV2LCBvdXRidWYgKyBy
ZXNwX2xlbiwgc3RhcnRfZmVhdHVyZSwgcmVxX3R5cGUpOworICAgICAgICByZXNwX2xlbiArPSBj
ZF9zY3NpX2FkZF9mZWF0dXJlX21vcnBoKGRldiwgb3V0YnVmICsgcmVzcF9sZW4sIHN0YXJ0X2Zl
YXR1cmUsIHJlcV90eXBlKTsKKyAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9hZGRfZmVhdHVy
ZV9yZW1vdmFibGUoZGV2LCBvdXRidWYgKyByZXNwX2xlbiwgc3RhcnRfZmVhdHVyZSwgcmVxX3R5
cGUpOworICAgICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9mZWF0dXJlX3JhbmRvbV9yZWFk
KGRldiwgb3V0YnVmICsgcmVzcF9sZW4sIHN0YXJ0X2ZlYXR1cmUsIHJlcV90eXBlKTsKKyAgICAg
ICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9hZGRfZmVhdHVyZV9jZF9yZWFkKGRldiwgb3V0YnVmICsg
cmVzcF9sZW4sIHN0YXJ0X2ZlYXR1cmUsIHJlcV90eXBlKTsKKyAgICAgICAgcmVzcF9sZW4gKz0g
Y2Rfc2NzaV9hZGRfZmVhdHVyZV9kdmRfcmVhZChkZXYsIG91dGJ1ZiArIHJlc3BfbGVuLCBzdGFy
dF9mZWF0dXJlLCByZXFfdHlwZSk7CisgICAgICAgIHJlc3BfbGVuICs9IGNkX3Njc2lfYWRkX2Zl
YXR1cmVfcG93ZXJfbWdtdChkZXYsIG91dGJ1ZiArIHJlc3BfbGVuLCBzdGFydF9mZWF0dXJlLCBy
ZXFfdHlwZSk7CisgICAgICAgIHJlc3BfbGVuICs9IGNkX3Njc2lfYWRkX2ZlYXR1cmVfdGltZW91
dChkZXYsIG91dGJ1ZiArIHJlc3BfbGVuLCBzdGFydF9mZWF0dXJlLCByZXFfdHlwZSk7CisgICAg
ICAgIGJyZWFrOworICAgIGNhc2UgQ0RfRkVBVFVSRV9SRVFfU0lOR0xFOgorICAgICAgICBzd2l0
Y2ggKHN0YXJ0X2ZlYXR1cmUpIHsKKyAgICAgICAgY2FzZSBDRF9GRUFUVVJFX05VTV9DT1JFOgor
ICAgICAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9hZGRfZmVhdHVyZV9jb3JlKGRldiwgb3V0
YnVmICsgcmVzcF9sZW4sIHN0YXJ0X2ZlYXR1cmUsIHJlcV90eXBlKTsKKyAgICAgICAgICAgIGJy
ZWFrOworICAgICAgICBjYXNlIENEX0ZFQVRVUkVfTlVNX01PUlBIOgorICAgICAgICAgICAgcmVz
cF9sZW4gKz0gY2Rfc2NzaV9hZGRfZmVhdHVyZV9tb3JwaChkZXYsIG91dGJ1ZiArIHJlc3BfbGVu
LCBzdGFydF9mZWF0dXJlLCByZXFfdHlwZSk7CisgICAgICAgICAgICBicmVhazsKKyAgICAgICAg
Y2FzZSBDRF9GRUFUVVJFX05VTV9SRU1PVkFCTEU6CisgICAgICAgICAgICByZXNwX2xlbiArPSBj
ZF9zY3NpX2FkZF9mZWF0dXJlX3JlbW92YWJsZShkZXYsIG91dGJ1ZiArIHJlc3BfbGVuLCBzdGFy
dF9mZWF0dXJlLCByZXFfdHlwZSk7CisgICAgICAgICAgICBicmVhazsKKyAgICAgICAgY2FzZSBD
RF9GRUFUVVJFX05VTV9SQU5ET01fUkVBRDoKKyAgICAgICAgICAgIHJlc3BfbGVuICs9IGNkX3Nj
c2lfYWRkX2ZlYXR1cmVfcmFuZG9tX3JlYWQoZGV2LCBvdXRidWYgKyByZXNwX2xlbiwgc3RhcnRf
ZmVhdHVyZSwgcmVxX3R5cGUpOworICAgICAgICAgICAgYnJlYWs7CisgICAgICAgIGNhc2UgQ0Rf
RkVBVFVSRV9OVU1fQ0RfUkVBRDoKKyAgICAgICAgICAgIHJlc3BfbGVuICs9IGNkX3Njc2lfYWRk
X2ZlYXR1cmVfY2RfcmVhZChkZXYsIG91dGJ1ZiArIHJlc3BfbGVuLCBzdGFydF9mZWF0dXJlLCBy
ZXFfdHlwZSk7CisgICAgICAgICAgICBicmVhazsKKyAgICAgICAgY2FzZSBDRF9GRUFUVVJFX05V
TV9EVkRfUkVBRDoKKyAgICAgICAgICAgIHJlc3BfbGVuICs9IGNkX3Njc2lfYWRkX2ZlYXR1cmVf
ZHZkX3JlYWQoZGV2LCBvdXRidWYgKyByZXNwX2xlbiwgc3RhcnRfZmVhdHVyZSwgcmVxX3R5cGUp
OworICAgICAgICAgICAgYnJlYWs7CisgICAgICAgIGNhc2UgQ0RfRkVBVFVSRV9OVU1fUE9XRVJf
TU5HVDoKKyAgICAgICAgICAgIHJlc3BfbGVuICs9IGNkX3Njc2lfYWRkX2ZlYXR1cmVfcG93ZXJf
bWdtdChkZXYsIG91dGJ1ZiArIHJlc3BfbGVuLCBzdGFydF9mZWF0dXJlLCByZXFfdHlwZSk7Cisg
ICAgICAgICAgICBicmVhazsKKyAgICAgICAgY2FzZSBDRF9GRUFUVVJFX05VTV9USU1FT1VUOgor
ICAgICAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9hZGRfZmVhdHVyZV90aW1lb3V0KGRldiwg
b3V0YnVmICsgcmVzcF9sZW4sIHN0YXJ0X2ZlYXR1cmUsIHJlcV90eXBlKTsKKyAgICAgICAgICAg
IGJyZWFrOworICAgICAgICBkZWZhdWx0OgorICAgICAgICAgICAgYnJlYWs7CisgICAgICAgIH0K
KyAgICAgICAgYnJlYWs7CisKKyAgICBkZWZhdWx0OgorICAgICAgICBTUElDRV9ERUJVRygiZ2V0
X2NvbmZpZ3VyYXRpb24sIGx1bjolIiBHX0dVSU5UMzJfRk9STUFUCisgICAgICAgICAgICAgICAg
ICAgICIgaW52YWxpZCBydDolIiBHX0dVSU5UMzJfRk9STUFUICIgc3RhcnRfZjolIiBHX0dVSU5U
MzJfRk9STUFULAorICAgICAgICAgICAgICAgICAgICByZXEtPmx1biwgcmVxX3R5cGUsIHN0YXJ0
X2ZlYXR1cmUpOworICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwg
cmVxLCAmc2Vuc2VfY29kZV9JTlZBTElEX0NEQl9GSUVMRCk7CisgICAgICAgIHJldHVybjsKKyAg
ICB9CisKKyAgICAvKiBzZXQgdG90YWwgZGF0YSBsZW4gKi8KKyAgICBvdXRidWZbMF0gPSAocmVz
cF9sZW4gPj4gMjQpICYgMHhmZjsKKyAgICBvdXRidWZbMV0gPSAocmVzcF9sZW4gPj4gMTYpICYg
MHhmZjsKKyAgICBvdXRidWZbMl0gPSAocmVzcF9sZW4gPj4gOCkgJiAweGZmOworICAgIG91dGJ1
ZlszXSA9IHJlc3BfbGVuICYgMHhmZjsKKworICAgIC8qIHJlcG9ydCBjdXJyZW50IHByb2ZpbGUg
bnVtICovCisgICAgb3V0YnVmWzZdID0gKHByb2ZpbGVfbnVtID4+IDgpICYgMHhmZjsKKyAgICBv
dXRidWZbN10gPSBwcm9maWxlX251bSAmIDB4ZmY7CisKKyAgICByZXEtPmluX2xlbiA9IChyZXEt
PnJlcV9sZW4gPCByZXNwX2xlbikgPyByZXEtPnJlcV9sZW4gOiByZXNwX2xlbjsKKworICAgIFNQ
SUNFX0RFQlVHKCJnZXRfY29uZmlndXJhdGlvbiwgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQKKyAg
ICAgICAgICAgICAgICAiIHJ0OiUiIEdfR1VJTlQzMl9GT1JNQVQgIiBzdGFydF9mOiUiIEdfR1VJ
TlQzMl9GT1JNQVQKKyAgICAgICAgICAgICAgICAiIHJlc3BfbGVuOiUiIEdfR1VJTlQzMl9GT1JN
QVQsCisgICAgICAgICAgICAgICAgcmVxLT5sdW4sIHJlcV90eXBlLCBzdGFydF9mZWF0dXJlLCBy
ZXNwX2xlbik7CisKKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30K
KworI2RlZmluZSBDRF9HRVRfRVZFTlRfU1RBVFVTX0lNTUVEICAgICAgICAgICAgMHgwMQorCisj
ZGVmaW5lIENEX0dFVF9FVkVOVF9IRUFERVJfTk9fRVZFTlRfQVZBSUwgICgweDAxIDw8IDcpCisj
ZGVmaW5lIENEX0dFVF9FVkVOVF9IRUFERVJfTEVOICAgICAgICAgICAgIDQKKworI2RlZmluZSBD
RF9HRVRfRVZFTlRfQ0xBU1NfTk9ORSAgICAgICAgICAgICAoMHgwMCkKKyNkZWZpbmUgQ0RfR0VU
X0VWRU5UX0NMQVNTX09QRVJfQ0hBTkdFICAgICAgKDB4MDEpCisjZGVmaW5lIENEX0dFVF9FVkVO
VF9DTEFTU19QT1dFUl9NR01UICAgICAgICgweDAyKQorI2RlZmluZSBDRF9HRVRfRVZFTlRfQ0xB
U1NfRVhURVJOQUxfUkVRICAgICAoMHgwMykKKyNkZWZpbmUgQ0RfR0VUX0VWRU5UX0NMQVNTX01F
RElBICAgICAgICAgICAgKDB4MDQpCisjZGVmaW5lIENEX0dFVF9FVkVOVF9DTEFTU19NVUxUSV9J
TklUSUFUT1IgICgweDA1KQorI2RlZmluZSBDRF9HRVRfRVZFTlRfQ0xBU1NfREVWX0JVU1kgICAg
ICAgICAoMHgwNikKKworI2RlZmluZSBDRF9HRVRfRVZFTlRfTEVOX01FRElBICAgICAgICAgICAg
ICA0CisKKyNkZWZpbmUgQ0RfTUVESUFfU1RBVFVTX01FRElBX1BSRVNFTlQgICAgICAgMHgxCisj
ZGVmaW5lIENEX01FRElBX1NUQVRVU19UUkFZX09QRU4gICAgICAgICAgIDB4MgorCitzdGF0aWMg
dWludDMyX3QgY2Rfc2NzaV9jbWRfZ2V0X2V2ZW50X3Jlc3BfYWRkX21lZGlhKENkU2NzaUxVICpk
ZXYsIHVpbnQ4X3QgKm91dGJ1ZikKK3sKKyAgICBvdXRidWZbMF0gPSAodWludDhfdClkZXYtPm1l
ZGlhX2V2ZW50ICYgMHgwZjsKKyAgICBvdXRidWZbMV0gPSAodWludDhfdCkoKGRldi0+bG9hZGVk
ID8gMCA6IENEX01FRElBX1NUQVRVU19UUkFZX09QRU4pIHwKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgKGRldi0+c3RyZWFtICE9IE5VTEwgPyBDRF9NRURJQV9TVEFUVVNfTUVESUFfUFJFU0VO
VCA6IDApKTsKKworICAgIGRldi0+bWVkaWFfZXZlbnQgPSBDRF9NRURJQV9FVkVOVF9OT19DSEFO
R0U7IC8qIHJlc2V0IHRoZSBldmVudCAqLworICAgIHJldHVybiBDRF9HRVRfRVZFTlRfTEVOX01F
RElBOworfQorCisjZGVmaW5lIENEX0dFVF9FVkVOVF9MRU5fUE9XRVIgICAgICAgICAgICAgIDQK
KworI2RlZmluZSBDRF9QT1dFUl9TVEFUVVNfQUNUSVZFICAgICAgICAgICAgICAweDEKKyNkZWZp
bmUgQ0RfUE9XRVJfU1RBVFVTX0lETEUgICAgICAgICAgICAgICAgMHgyCisKK3N0YXRpYyB1aW50
MzJfdCBjZF9zY3NpX2NtZF9nZXRfZXZlbnRfcmVzcF9hZGRfcG93ZXIoQ2RTY3NpTFUgKmRldiwg
dWludDhfdCAqb3V0YnVmKQoreworICAgIG91dGJ1ZlswXSA9ICh1aW50OF90KWRldi0+cG93ZXJf
ZXZlbnQgJiAweDBmOworICAgIG91dGJ1ZlsxXSA9ICh1aW50OF90KSgoZGV2LT5wb3dlcl9jb25k
ID09IENEX1NDU0lfUE9XRVJfQUNUSVZFKSA/CisgICAgICAgICAgICAgICAgICAgICAgICAgICBD
RF9QT1dFUl9TVEFUVVNfQUNUSVZFIDogQ0RfUE9XRVJfU1RBVFVTX0lETEUpOworCisgICAgZGV2
LT5wb3dlcl9ldmVudCA9IENEX1BPV0VSX0VWRU5UX05PX0NIQU5HRTsgLyogcmVzZXQgdGhlIGV2
ZW50ICovCisgICAgcmV0dXJuIENEX0dFVF9FVkVOVF9MRU5fUE9XRVI7Cit9CisKK3N0YXRpYyB2
b2lkIGNkX3Njc2lfY21kX2dldF9ldmVudF9zdGF0dXNfbm90aWZpY2F0aW9uKENkU2NzaUxVICpk
ZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICB1aW50OF90ICpvdXRidWYgPSByZXEtPmJ1
ZjsKKyAgICB1aW50MzJfdCByZXNwX2xlbiA9IENEX0dFVF9FVkVOVF9IRUFERVJfTEVOOworICAg
IGNvbnN0IHVpbnQzMl90IHBvd2VyX2NsYXNzX21hc2sgPSAoMHgwMSA8PCBDRF9HRVRfRVZFTlRf
Q0xBU1NfUE9XRVJfTUdNVCk7CisgICAgY29uc3QgdWludDMyX3QgbWVkaWFfY2xhc3NfbWFzayA9
ICgweDAxIDw8IENEX0dFVF9FVkVOVF9DTEFTU19NRURJQSk7CisgICAgdWludDMyX3QgY2xhc3Nl
c19zdXBwb3J0ZWQgPSAgcG93ZXJfY2xhc3NfbWFzayB8IG1lZGlhX2NsYXNzX21hc2s7CisgICAg
dWludDMyX3QgaW1tZWQsIGNsYXNzZXNfcmVxdWVzdGVkOworCisgICAgcmVxLT54ZmVyX2RpciA9
IFNDU0lfWEZFUl9GUk9NX0RFVjsKKworICAgIGltbWVkID0gcmVxLT5jZGJbMV0gJiBDRF9HRVRf
RVZFTlRfU1RBVFVTX0lNTUVEOworICAgIGNsYXNzZXNfcmVxdWVzdGVkID0gcmVxLT5jZGJbNF07
CisgICAgcmVxLT5yZXFfbGVuID0gKHJlcS0+Y2RiWzddIDw8IDgpIHwgcmVxLT5jZGJbOF07CisK
KyAgICBpZiAoIWltbWVkKSB7CisgICAgICAgIFNQSUNFX0RFQlVHKCJnZXRfZXZlbnRfc3RhdHVz
X25vdGlmaWNhdGlvbiwgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQKKyAgICAgICAgICAgICAgICAi
IGltbTowIGNsYXNzX3JlcTolMDJ4LCBOb24taW1tZWRpYXRlIChhc3luYykgbW9kZSB1bnN1cHBv
cnRlZCIsCisgICAgICAgICAgICAgICAgcmVxLT5sdW4sIGNsYXNzZXNfcmVxdWVzdGVkKTsKKyAg
ICAgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2Nv
ZGVfSU5WQUxJRF9DREJfRklFTEQpOworICAgICAgICByZXR1cm47CisgICAgfQorCisgICAgbWVt
c2V0KG91dGJ1ZiwgMCwgcmVxLT5yZXFfbGVuKTsKKyAgICBpZiAoKGNsYXNzZXNfc3VwcG9ydGVk
ICYgY2xhc3Nlc19yZXF1ZXN0ZWQpICE9IDApIHsKKyAgICAgICAgaWYgKGNsYXNzZXNfcmVxdWVz
dGVkICYgcG93ZXJfY2xhc3NfbWFzaykgeworICAgICAgICAgICAgb3V0YnVmWzJdID0gQ0RfR0VU
X0VWRU5UX0NMQVNTX1BPV0VSX01HTVQ7CisgICAgICAgICAgICBvdXRidWZbM10gPSAodWludDhf
dClwb3dlcl9jbGFzc19tYXNrOworCisgICAgICAgICAgICBTUElDRV9ERUJVRygiZ2V0X2V2ZW50
X3N0YXR1c19ub3RpZmljYXRpb24sIGx1bjolIiBHX0dVSU5UMzJfRk9STUFUCisgICAgICAgICAg
ICAgICAgICAgICAgICAiIGltbTolIiBHX0dVSU5UMzJfRk9STUFUICIgY2xhc3NfcmVxOjB4JTAy
eCBjbGFzc19zdXA6MHglMDJ4IgorICAgICAgICAgICAgICAgICAgICAgICAgIiBwb3dlcl9ldmVu
dDoweCUwMnggcG93ZXJfY29uZDoweCUwMngiLAorICAgICAgICAgICAgICAgICAgICAgICAgcmVx
LT5sdW4sIGltbWVkLCBjbGFzc2VzX3JlcXVlc3RlZCwgY2xhc3Nlc19zdXBwb3J0ZWQsCisgICAg
ICAgICAgICAgICAgICAgICAgICBkZXYtPnBvd2VyX2V2ZW50LCBkZXYtPnBvd2VyX2NvbmQpOwor
CisgICAgICAgICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2NtZF9nZXRfZXZlbnRfcmVzcF9hZGRf
cG93ZXIoZGV2LCBvdXRidWYgKyByZXNwX2xlbik7CisgICAgICAgIH0gZWxzZSBpZiAoY2xhc3Nl
c19yZXF1ZXN0ZWQgJiBtZWRpYV9jbGFzc19tYXNrKSB7CisgICAgICAgICAgICBvdXRidWZbMl0g
PSBDRF9HRVRfRVZFTlRfQ0xBU1NfTUVESUE7CisgICAgICAgICAgICBvdXRidWZbM10gPSAodWlu
dDhfdCltZWRpYV9jbGFzc19tYXNrOworCisgICAgICAgICAgICBTUElDRV9ERUJVRygiZ2V0X2V2
ZW50X3N0YXR1c19ub3RpZmljYXRpb24sIGx1bjolIiBHX0dVSU5UMzJfRk9STUFUCisgICAgICAg
ICAgICAgICAgICAgICAgICAiIGltbTolIiBHX0dVSU5UMzJfRk9STUFUICIgY2xhc3NfcmVxOjB4
JTAyeCBjbGFzc19zdXA6MHglMDJ4IgorICAgICAgICAgICAgICAgICAgICAgICAgIiBtZWRpYV9l
dmVudDoweCUwMnggbG9hZGVkOiAlZCIsCisgICAgICAgICAgICAgICAgICAgICAgICByZXEtPmx1
biwgaW1tZWQsIGNsYXNzZXNfcmVxdWVzdGVkLCBjbGFzc2VzX3N1cHBvcnRlZCwKKyAgICAgICAg
ICAgICAgICAgICAgICAgIGRldi0+bWVkaWFfZXZlbnQsIGRldi0+bG9hZGVkKTsKKworICAgICAg
ICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9jbWRfZ2V0X2V2ZW50X3Jlc3BfYWRkX21lZGlhKGRl
diwgb3V0YnVmICsgcmVzcF9sZW4pOworICAgICAgICB9CisgICAgfSBlbHNlIHsKKyAgICAgICAg
b3V0YnVmWzJdID0gQ0RfR0VUX0VWRU5UX0hFQURFUl9OT19FVkVOVF9BVkFJTCB8IENEX0dFVF9F
VkVOVF9DTEFTU19OT05FOworCisgICAgICAgIFNQSUNFX0RFQlVHKCJnZXRfZXZlbnRfc3RhdHVz
X25vdGlmaWNhdGlvbiwgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQKKyAgICAgICAgICAgICAgICAg
ICAgICAgICIgaW1tOiUiIEdfR1VJTlQzMl9GT1JNQVQgIiBjbGFzc19yZXE6MHglMDJ4IGNsYXNz
X3N1cDoweCUwMngiCisgICAgICAgICAgICAgICAgICAgICAgICAiIG5vbmUgb2YgcmVxdWVzdGVk
IGV2ZW50cyBzdXBwb3J0ZWQiLAorICAgICAgICAgICAgICAgICAgICAgICAgcmVxLT5sdW4sIGlt
bWVkLCBjbGFzc2VzX3JlcXVlc3RlZCwgY2xhc3Nlc19zdXBwb3J0ZWQpOworICAgIH0KKyAgICBv
dXRidWZbMV0gPSAodWludDhfdCkocmVzcF9sZW4gLSAyKTsgLyogRXZlbnQgRGF0YSBMZW5ndGgg
TFNCLCBsZW5ndGggZXhjbHVkaW5nIHRoZSBmaWVsZCBpdHNlbGYgKi8KKyAgICBvdXRidWZbM10g
PSAodWludDhfdCljbGFzc2VzX3N1cHBvcnRlZDsKKworICAgIHJlcS0+aW5fbGVuID0gKHJlcS0+
cmVxX2xlbiA8IHJlc3BfbGVuKSA/IHJlcS0+cmVxX2xlbiA6IHJlc3BfbGVuOworICAgIGNkX3Nj
c2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2LCByZXEpOworfQorCisjZGVmaW5lIENEX0VYVF9SRVFf
RVZFTlRfRk9STUFUX05PX0NIRyAgICAgICAgICAweDAwCisjZGVmaW5lIENEX0VYVF9SRVFfRVZF
TlRfRk9STUFUX0xVX0tFWV9ET1dOICAgICAweDAxCisjZGVmaW5lIENEX0VYVF9SRVFfRVZFTlRf
Rk9STUFUX0xVX0tFWV9VUCAgICAgICAweDAyCisjZGVmaW5lIENEX0VYVF9SRVFfRVZFTlRfRk9S
TUFUX1JFUV9OT1RJRlkgICAgICAweDAzCisKKyNkZWZpbmUgQ0RfRVhUX1JFUV9TVEFUVVNfUkVB
RFkgICAgICAgICAgICAgICAgIDB4MDAKKyNkZWZpbmUgQ0RfRVhUX1JFUV9TVEFUVVNfT1RIRVJf
UFJFVkVOVCAgICAgICAgIDB4MDEKKworI2RlZmluZSBDRF9FWFRfUkVRX0NPREVfTk9fUkVRVUVT
VCAgICAgICAgICAgICAgMHgwMAorI2RlZmluZSBDRF9FWFRfUkVRX0NPREVfT1ZFUlJVTiAgICAg
ICAgICAgICAgICAgMHgwMQorI2RlZmluZSBDRF9FWFRfUkVRX0NPREVfUExBWSAgICAgICAgICAg
ICAgICAgICAgMHgxMDEKKyNkZWZpbmUgQ0RfRVhUX1JFUV9DT0RFX1JFV0lORCAgICAgICAgICAg
ICAgICAgIDB4MTAyCisjZGVmaW5lIENEX0VYVF9SRVFfQ09ERV9GQVNUX0ZXICAgICAgICAgICAg
ICAgICAweDEwMworI2RlZmluZSBDRF9FWFRfUkVRX0NPREVfUEFVU0UgICAgICAgICAgICAgICAg
ICAgMHgxMDQKKyNkZWZpbmUgQ0RfRVhUX1JFUV9DT0RFX1NUT1AgICAgICAgICAgICAgICAgICAg
IDB4MTA2CisjZGVmaW5lIENEX0VYVF9SRVFfQ09ERV9BU0NJSV9CQVNFICAgICAgICAgICAgICAw
eDIwMCAvKiBTQ1NJSSB2YWx1ZSBpcyBMU0IgKi8KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRf
c2VuZF9ldmVudChDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgdWlu
dDhfdCAqcGFyYW0sICpldmVudDsKKyAgICB1aW50MzJfdCBpbW1lZCwgcGFyYW1fbGlzdF9sZW47
CisgICAgdWludDMyX3QgZXZlbnRfcGFyYW1fbGVuLCBub3RpZmljYXRpb25fY2xhc3M7CisgICAg
dWludDMyX3QgZXh0X3JlcV9ldmVudCwgZXh0X3JlcV9zdGF0dXMsIHBlcnNfcHJldmVudCwgZXh0
X3JlcV9jb2RlOworCisgICAgcmVxLT54ZmVyX2RpciA9IFNDU0lfWEZFUl9UT19ERVY7CisKKyAg
ICBpbW1lZCA9IHJlcS0+Y2RiWzFdICYgMHgwMTsKKyAgICBwYXJhbV9saXN0X2xlbiA9IChyZXEt
PmNkYls4XSA8PCA4KSB8IHJlcS0+Y2RiWzldOworCisgICAgaWYgKHJlcS0+YnVmX2xlbiA8IHBh
cmFtX2xpc3RfbGVuKSB7CisgICAgICAgIFNQSUNFX0RFQlVHKCJzZW5kX2V2ZW50LCBsdW46JSIg
R19HVUlOVDMyX0ZPUk1BVAorICAgICAgICAgICAgICAgICAgICAiIGludmFsaWQgcGFyYW0gbGlz
dCBsZW46MHgleCwgYnVmX2xlbjoweCV4IiwKKyAgICAgICAgICAgICAgICAgICAgcmVxLT5sdW4s
IHBhcmFtX2xpc3RfbGVuLCByZXEtPmJ1Zl9sZW4pOworICAgICAgICBjZF9zY3NpX2NtZF9jb21w
bGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZBTElEX1BBUkFNX0xFTik7
CisgICAgICAgIHJldHVybjsKKyAgICB9CisgICAgcGFyYW0gPSByZXEtPmJ1ZjsKKyAgICBldmVu
dF9wYXJhbV9sZW4gPSAocGFyYW1bMF0gPDwgOCkgfCBwYXJhbVsxXTsKKworICAgIG5vdGlmaWNh
dGlvbl9jbGFzcyA9IHBhcmFtWzJdICYgMHgwNzsKKyAgICBpZiAobm90aWZpY2F0aW9uX2NsYXNz
ICE9IENEX0dFVF9FVkVOVF9DTEFTU19FWFRFUk5BTF9SRVEpIHsKKyAgICAgICAgU1BJQ0VfREVC
VUcoInNlbmRfZXZlbnQsIGx1bjolIiBHX0dVSU5UMzJfRk9STUFUCisgICAgICAgICAgICAgICAg
ICAgICIgaW52YWxpZCBub3RpZmljYXRpb24gY2xhc3M6MHgleCIsCisgICAgICAgICAgICAgICAg
ICAgIHJlcS0+bHVuLCBub3RpZmljYXRpb25fY2xhc3MpOworICAgICAgICBjZF9zY3NpX2NtZF9j
b21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZBTElEX0NEQl9GSUVM
RCk7CisgICAgICAgIHJldHVybjsKKyAgICB9CisKKyAgICBldmVudCA9IHBhcmFtICsgQ0RfR0VU
X0VWRU5UX0hFQURFUl9MRU47CisgICAgZXh0X3JlcV9ldmVudCA9IGV2ZW50WzBdICYgMHhmZjsK
KyAgICBleHRfcmVxX3N0YXR1cyA9IGV2ZW50WzFdICYgMHgwZjsKKyAgICBwZXJzX3ByZXZlbnQg
PSBldmVudFsxXSAmIDB4ODA7CisgICAgZXh0X3JlcV9jb2RlID0gKGV2ZW50WzJdIDw8IDgpIHwg
ZXZlbnRbM107CisKKyAgICBTUElDRV9ERUJVRygic2VuZF9ldmVudCwgbHVuOjB4JSIgR19HVUlO
VDMyX0ZPUk1BVAorICAgICAgICAgICAgICAgICIgaW1tZWQ6JSIgR19HVUlOVDMyX0ZPUk1BVCAi
IHBhcmFtX2xlbjolIiBHX0dVSU5UMzJfRk9STUFUCisgICAgICAgICAgICAgICAgIiBleHRfcmVx
X2V2ZW50OjB4JXggZXh0X3JlcV9zdGF0dXM6MHgleCIKKyAgICAgICAgICAgICAgICAiIHBlcnNf
cHJldmVudDoweCV4IGV4dF9yZXFfY29kZToweCV4IiwKKyAgICAgICAgICAgICAgICByZXEtPmx1
biwgaW1tZWQsIGV2ZW50X3BhcmFtX2xlbiwgZXh0X3JlcV9ldmVudCwKKyAgICAgICAgICAgICAg
ICBleHRfcmVxX3N0YXR1cywgcGVyc19wcmV2ZW50LCBleHRfcmVxX2NvZGUpOworCisgICAgLyog
VG9EbzogcHJvY2VzcyB0aGUgZXZlbnQgKi8KKworICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2dv
b2QoZGV2LCByZXEpOworfQorCisjZGVmaW5lIENEX01FRElVTV9SRU1PVkFMX1JFUV9BTExPVyAg
ICAgICAgICAgICAgICAgMHgwMAorI2RlZmluZSBDRF9NRURJVU1fUkVNT1ZBTF9SRVFfUFJFVkVO
VCAgICAgICAgICAgICAgIDB4MDEKKyNkZWZpbmUgQ0RfTUVESVVNX1JFTU9WQUxfUkVRX0FMTE9X
X0NIQU5HRVIgICAgICAgICAweDAyCisjZGVmaW5lIENEX01FRElVTV9SRU1PVkFMX1JFUV9QUkVW
RU5UX0NIQU5HRVIgICAgICAgMHgwMworCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9hbGxvd19t
ZWRpdW1fcmVtb3ZhbChDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAg
dWludDMyX3QgcHJldmVudDsKKworICAgIHJlcS0+eGZlcl9kaXIgPSBTQ1NJX1hGRVJfRlJPTV9E
RVY7CisKKyAgICBwcmV2ZW50ID0gcmVxLT5jZGJbNF0gJiAweDAzOworICAgIGRldi0+cHJldmVu
dF9tZWRpYV9yZW1vdmFsID0gKHByZXZlbnQgPT0gQ0RfTUVESVVNX1JFTU9WQUxfUkVRX1BSRVZF
TlQgfHwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2ZW50ID09IENEX01F
RElVTV9SRU1PVkFMX1JFUV9QUkVWRU5UX0NIQU5HRVIpOworICAgIHJlcS0+aW5fbGVuID0gMDsK
KworICAgIFNQSUNFX0RFQlVHKCJhbGxvd19tZWRpdW1fcmVtb3ZhbCwgbHVuOiUiIEdfR1VJTlQz
Ml9GT1JNQVQgIiBwcmV2ZW50IGZpZWxkOjoweCUwMnggZmxhZzolZCIsCisgICAgICAgICAgICAg
ICAgcmVxLT5sdW4sIHByZXZlbnQsIGRldi0+cHJldmVudF9tZWRpYV9yZW1vdmFsKTsKKworICAg
IGNkX3Njc2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2LCByZXEpOworfQorCitzdGF0aWMgdm9pZCBj
ZF9zY3NpX2NtZF9yZXBvcnRfa2V5KENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkK
K3sKKyAgICBTUElDRV9ERUJVRygicmVwb3J0X2tleSAtIGNvbnRlbnQgcHJvdGVjdGlvbiB1bnN1
cHBvcnRlZCwgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQsIHJlcS0+bHVuKTsKKyAgICByZXEtPnhm
ZXJfZGlyID0gU0NTSV9YRkVSX05PTkU7CisgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tf
Y29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfSU5WQUxJRF9PUENPREUpOworfQorCitzdGF0aWMg
dm9pZCBjZF9zY3NpX2NtZF9zZW5kX2tleShDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpy
ZXEpCit7CisgICAgU1BJQ0VfREVCVUcoInNlbmRfa2V5IC0gY29udGVudCBwcm90ZWN0aW9uIHVu
c3VwcG9ydGVkLCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCwgcmVxLT5sdW4pOworICAgIHJlcS0+
eGZlcl9kaXIgPSBTQ1NJX1hGRVJfTk9ORTsKKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVj
a19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZBTElEX09QQ09ERSk7Cit9CisKKy8qIGJ5
dGUgMSAqLworI2RlZmluZSBDRF9TVEFSVF9TVE9QX0ZMQUdfSU1NRUQgICAgICAgICAgICAgICAg
ICAgIDB4MDEKKworLyogYnl0ZSA0ICovCisjZGVmaW5lIENEX1NUQVJUX1NUT1BfRkxBR19TVEFS
VCAgICAgICAgICAgICAgICAgICAgMHgwMQorI2RlZmluZSBDRF9TVEFSVF9TVE9QX0ZMQUdfTE9F
SiAgICAgICAgICAgICAgICAgICAgIDB4MDIKKworLyogUE9XRVIgQ09ORElUSU9OIGZpZWxkIHZh
bHVlcyAqLworI2RlZmluZSBDRF9TVEFSVF9TVE9QX1BPV0VSX0NPTkRfU1RBUlRfVkFMSUQgICAg
ICAgIDB4MDAKKyNkZWZpbmUgQ0RfU1RBUlRfU1RPUF9QT1dFUl9DT05EX0FDVElWRSAgICAgICAg
ICAgICAweDAxCisjZGVmaW5lIENEX1NUQVJUX1NUT1BfUE9XRVJfQ09ORF9JRExFICAgICAgICAg
ICAgICAgMHgwMgorI2RlZmluZSBDRF9TVEFSVF9TVE9QX1BPV0VSX0NPTkRfU1RBTkRCWSAgICAg
ICAgICAgIDB4MDMKKyNkZWZpbmUgQ0RfU1RBUlRfU1RPUF9QT1dFUl9DT05EX0xVX0NPTlRST0wg
ICAgICAgICAweDA3CisjZGVmaW5lIENEX1NUQVJUX1NUT1BfUE9XRVJfQ09ORF9GT1JDRV9JRExF
XzAgICAgICAgMHgwYQorI2RlZmluZSBDRF9TVEFSVF9TVE9QX1BPV0VSX0NPTkRfRk9SQ0VfU1RB
TkRCWV8wICAgIDB4MGIKKworc3RhdGljIGlubGluZSBjb25zdCBjaGFyICpjZF9zY3NpX3N0YXJ0
X3N0b3BfcG93ZXJfY29uZF9uYW1lKHVpbnQzMl90IHBvd2VyX2NvbmQpCit7CisgICAgc3dpdGNo
IChwb3dlcl9jb25kKSB7CisgICAgY2FzZSBDRF9TVEFSVF9TVE9QX1BPV0VSX0NPTkRfU1RBUlRf
VkFMSUQ6CisgICAgICAgIHJldHVybiAiU1RBUlRfVkFMSUQiOworICAgIGNhc2UgQ0RfU1RBUlRf
U1RPUF9QT1dFUl9DT05EX0FDVElWRToKKyAgICAgICAgcmV0dXJuICJBQ1RJVkUiOworICAgIGNh
c2UgQ0RfU1RBUlRfU1RPUF9QT1dFUl9DT05EX0lETEU6CisgICAgICAgIHJldHVybiAiSURMRSI7
CisgICAgY2FzZSBDRF9TVEFSVF9TVE9QX1BPV0VSX0NPTkRfU1RBTkRCWToKKyAgICAgICAgcmV0
dXJuICJTVEFOREJZIjsKKyAgICBjYXNlIENEX1NUQVJUX1NUT1BfUE9XRVJfQ09ORF9MVV9DT05U
Uk9MOgorICAgICAgICByZXR1cm4gIkxVX0NPTlRST0wiOworICAgIGNhc2UgQ0RfU1RBUlRfU1RP
UF9QT1dFUl9DT05EX0ZPUkNFX0lETEVfMDoKKyAgICAgICAgcmV0dXJuICJGT1JDRV9JRExFXzAi
OworICAgIGNhc2UgQ0RfU1RBUlRfU1RPUF9QT1dFUl9DT05EX0ZPUkNFX1NUQU5EQllfMDoKKyAg
ICAgICAgcmV0dXJuICJGT1JDRV9TVEFOREJZXzAiOworICAgIGRlZmF1bHQ6CisgICAgICAgIHJl
dHVybiAiUkVTRVJWRUQiOworICAgIH0KK30KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRfc3Rh
cnRfc3RvcF91bml0KENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICBn
Ym9vbGVhbiBpbW1lZCwgc3RhcnQsIGxvYWRfZWplY3Q7CisgICAgdWludDMyX3QgcG93ZXJfY29u
ZDsKKworICAgIHJlcS0+eGZlcl9kaXIgPSBTQ1NJX1hGRVJfTk9ORTsKKyAgICByZXEtPmluX2xl
biA9IDA7CisKKyAgICBpbW1lZCA9IChyZXEtPmNkYlsxXSAmIENEX1NUQVJUX1NUT1BfRkxBR19J
TU1FRCkgPyBUUlVFIDogRkFMU0U7CisgICAgc3RhcnQgPSAocmVxLT5jZGJbNF0gJiBDRF9TVEFS
VF9TVE9QX0ZMQUdfU1RBUlQpID8gVFJVRSA6IEZBTFNFOworICAgIGxvYWRfZWplY3QgPSAocmVx
LT5jZGJbNF0gJiBDRF9TVEFSVF9TVE9QX0ZMQUdfTE9FSikgPyBUUlVFIDogRkFMU0U7CisgICAg
cG93ZXJfY29uZCA9IHJlcS0+Y2RiWzRdID4+IDQ7CisKKyAgICBTUElDRV9ERUJVRygic3RhcnRf
c3RvcF91bml0LCBsdW46MHglIiBHX0dVSU5UMzJfRk9STUFUCisgICAgICAgICAgICAgICAgIiBp
bW1lZDolZCBzdGFydDolZCBsb2FkX2VqZWN0OiVkIHBvd2VyX2NvbmQ6MHgleCglcykiLAorICAg
ICAgICAgICAgICAgIHJlcS0+bHVuLCBpbW1lZCwgc3RhcnQsIGxvYWRfZWplY3QsIHBvd2VyX2Nv
bmQsCisgICAgICAgICAgICAgICAgY2Rfc2NzaV9zdGFydF9zdG9wX3Bvd2VyX2NvbmRfbmFtZShw
b3dlcl9jb25kKSk7CisKKyAgICBzd2l0Y2ggKHBvd2VyX2NvbmQpIHsKKyAgICBjYXNlIENEX1NU
QVJUX1NUT1BfUE9XRVJfQ09ORF9TVEFSVF9WQUxJRDoKKyAgICAgICAgaWYgKCFzdGFydCkgeyAv
KiBzdG9wIHRoZSB1bml0ICovCisgICAgICAgICAgICBpZiAobG9hZF9lamVjdCkgeyAvKiBlamVj
dCBtZWRpdW0gKi8KKyAgICAgICAgICAgICAgICBpZiAoZGV2LT5wcmV2ZW50X21lZGlhX3JlbW92
YWwpIHsKKyAgICAgICAgICAgICAgICAgICAgU1BJQ0VfREVCVUcoInN0YXJ0X3N0b3BfdW5pdCwg
bHVuOjB4JSIgR19HVUlOVDMyX0ZPUk1BVAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAiIHByZXZlbnRfbWVkaWFfcmVtb3ZhbCBzZXQsIGVqZWN0IGZhaWxlZCIsIHJlcS0+bHVuKTsK
KyAgICAgICAgICAgICAgICAgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYs
IHJlcSwgJnNlbnNlX2NvZGVfTUVESVVNX1JFTU9WQUxfUFJFVkVOVEVEKTsKKyAgICAgICAgICAg
ICAgICAgICAgcmV0dXJuOworICAgICAgICAgICAgICAgIH0KKyAgICAgICAgICAgICAgICBTUElD
RV9ERUJVRygic3RhcnRfc3RvcF91bml0LCBsdW46MHglIiBHX0dVSU5UMzJfRk9STUFUICIgZWpl
Y3QiLCByZXEtPmx1bik7CisgICAgICAgICAgICAgICAgY2Rfc2NzaV9sdV91bmxvYWQoZGV2KTsK
KyAgICAgICAgICAgICAgICBjZF9zY3NpX2Rldl9jaGFuZ2VkKGRldi0+dGd0LT51c2VyX2RhdGEs
IHJlcS0+bHVuKTsKKyAgICAgICAgICAgIH0KKyAgICAgICAgICAgIGRldi0+cG93ZXJfY29uZCA9
IENEX1NDU0lfUE9XRVJfU1RPUFBFRDsKKyAgICAgICAgICAgIFNQSUNFX0RFQlVHKCJzdGFydF9z
dG9wX3VuaXQsIGx1bjoweCUiIEdfR1VJTlQzMl9GT1JNQVQgIiBzdG9wcGVkIiwgcmVxLT5sdW4p
OworICAgICAgICB9IGVsc2UgeyAvKiBzdGFydCB0aGUgdW5pdCAqLworICAgICAgICAgICAgZGV2
LT5wb3dlcl9jb25kID0gQ0RfU0NTSV9QT1dFUl9BQ1RJVkU7CisgICAgICAgICAgICBTUElDRV9E
RUJVRygic3RhcnRfc3RvcF91bml0LCBsdW46MHglIiBHX0dVSU5UMzJfRk9STUFUICIgc3RhcnRl
ZCIsIHJlcS0+bHVuKTsKKworICAgICAgICAgICAgaWYgKGxvYWRfZWplY3QpIHsgLyogbG9hZCBt
ZWRpdW0gKi8KKyAgICAgICAgICAgICAgICBTUElDRV9ERUJVRygic3RhcnRfc3RvcF91bml0LCBs
dW46MHglIiBHX0dVSU5UMzJfRk9STUFUICIgbG9hZCB3aXRoIG5vIG1lZGlhIiwgcmVxLT5sdW4p
OworICAgICAgICAgICAgICAgIGNkX3Njc2lfbHVfbG9hZChkZXYsIE5VTEwpOworICAgICAgICAg
ICAgICAgIGNkX3Njc2lfZGV2X2NoYW5nZWQoZGV2LT50Z3QtPnVzZXJfZGF0YSwgcmVxLT5sdW4p
OworICAgICAgICAgICAgfQorICAgICAgICB9CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgQ0Rf
U1RBUlRfU1RPUF9QT1dFUl9DT05EX0FDVElWRToKKyAgICAgICAgLyogbm90IGVycm9yIHRvIHNw
ZWNpZnkgdHJhbnNpdGlvbiB0byB0aGUgY3VycmVudCBwb3dlciBjb25kaXRpb24gKi8KKyAgICAg
ICAgZGV2LT5wb3dlcl9jb25kID0gQ0RfU0NTSV9QT1dFUl9BQ1RJVkU7CisgICAgICAgIFNQSUNF
X0RFQlVHKCJzdGFydF9zdG9wX3VuaXQsIGx1bjoweCUiIEdfR1VJTlQzMl9GT1JNQVQgIiBhY3Rp
dmUiLCByZXEtPmx1bik7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgQ0RfU1RBUlRfU1RPUF9Q
T1dFUl9DT05EX0lETEU6CisgICAgY2FzZSBDRF9TVEFSVF9TVE9QX1BPV0VSX0NPTkRfRk9SQ0Vf
SURMRV8wOgorICAgICAgICBkZXYtPnBvd2VyX2NvbmQgPSBDRF9TQ1NJX1BPV0VSX0lETEU7Cisg
ICAgICAgIFNQSUNFX0RFQlVHKCJzdGFydF9zdG9wX3VuaXQsIGx1bjoweCUiIEdfR1VJTlQzMl9G
T1JNQVQgIiBpZGxlIiwgcmVxLT5sdW4pOworICAgICAgICBicmVhazsKKyAgICBjYXNlIENEX1NU
QVJUX1NUT1BfUE9XRVJfQ09ORF9TVEFOREJZOgorICAgIGNhc2UgQ0RfU1RBUlRfU1RPUF9QT1dF
Ul9DT05EX0ZPUkNFX1NUQU5EQllfMDoKKyAgICAgICAgZGV2LT5wb3dlcl9jb25kID0gQ0RfU0NT
SV9QT1dFUl9TVEFOREJZOworICAgICAgICBTUElDRV9ERUJVRygic3RhcnRfc3RvcF91bml0LCBs
dW46MHglIiBHX0dVSU5UMzJfRk9STUFUICIgc3RhbmRieSIsIHJlcS0+bHVuKTsKKyAgICAgICAg
YnJlYWs7CisgICAgY2FzZSBDRF9TVEFSVF9TVE9QX1BPV0VSX0NPTkRfTFVfQ09OVFJPTDoKKyAg
ICAgICAgYnJlYWs7CisgICAgZGVmYXVsdDoKKyAgICAgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVf
Y2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfSU5WQUxJRF9DREJfRklFTEQpOworICAg
ICAgICByZXR1cm47CisgICAgfQorICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2LCBy
ZXEpOworfQorCisjZGVmaW5lIENEX1BFUkZfVFlQRV9QRVJGT1JNQU5DRSAgICAgICAgICAgICAg
ICAweDAwCisjZGVmaW5lIENEX1BFUkZfVFlQRV9VTlVTQUJMRV9BUkVBICAgICAgICAgICAgICAw
eDAxCisjZGVmaW5lIENEX1BFUkZfVFlQRV9ERUZFQ1RfU1RBVFVTICAgICAgICAgICAgICAweDAy
CisjZGVmaW5lIENEX1BFUkZfVFlQRV9XUklURV9TUEVFRCAgICAgICAgICAgICAgICAweDAzCisK
KyNkZWZpbmUgQ0RfUEVSRl9IRUFERVJfTEVOICAgICAgICAgICAgICAgICAgICAgIDgKKworI2Rl
ZmluZSBDRF9QRVJGX1RZUEVfUEVSRk9STUFOQ0VfREVTQ1JfTEVOICAgICAgMTYKKworI2RlZmlu
ZSBDRF9QRVJGX1RZUEVfUEVSRk9STUFOQ0VfUkVQT1JUX05PTUlOQUwgMHgwMAorI2RlZmluZSBD
RF9QRVJGX1RZUEVfUEVSRk9STUFOQ0VfUkVQT1JUX0FMTCAgICAgMHgwMQorI2RlZmluZSBDRF9Q
RVJGX1RZUEVfUEVSRk9STUFOQ0VfUkVQT1JUX0VYQ0VQVCAgMHgxMAorCisKK3N0YXRpYyB2b2lk
IGNkX3Njc2lfZ2V0X3BlcmZvcm1hbmNlX3Jlc3BfZW1wdHkoQ2RTY3NpTFUgKmRldiwgQ2RTY3Np
UmVxdWVzdCAqcmVxLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICB1aW50MzJfdCB0eXBlLCB1aW50MzJfdCBkYXRhX3R5cGUsCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IG1heF9udW1fZGVzY3IpCit7
CisgICAgdWludDhfdCAqb3V0YnVmID0gcmVxLT5idWY7CisgICAgdWludDMyX3Qgd3JpdGUgPSAo
ZGF0YV90eXBlID4+IDIpICYgMHgwMTsKKworICAgIG1lbXNldChvdXRidWYsIDAsIENEX1BFUkZf
SEVBREVSX0xFTik7CisgICAgaWYgKHdyaXRlKSB7CisgICAgICAgIG91dGJ1Zls0XSA9IDB4MDI7
CisgICAgfQorICAgIHJlcS0+aW5fbGVuID0gQ0RfUEVSRl9IRUFERVJfTEVOOworCisgICAgU1BJ
Q0VfREVCVUcoImdldF9wZXJmb3JtYW5jZSwgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQKKyAgICAg
ICAgICAgICAgICAiIHR5cGU6MHgleCBkYXRhX3R5cGU6MHgleCAtIHNlbmRpbmcgZW1wdHkgcmVz
cG9uc2UiLAorICAgICAgICAgICAgICAgIHJlcS0+bHVuLCB0eXBlLCBkYXRhX3R5cGUpOworCisg
ICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfZ29vZChkZXYsIHJlcSk7Cit9CisKK3N0YXRpYyB2b2lk
IGNkX3Njc2lfZ2V0X3BlcmZvcm1hbmNlX3Jlc3BfcGVyZm9ybWFuY2UoQ2RTY3NpTFUgKmRldiwg
Q2RTY3NpUmVxdWVzdCAqcmVxLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICB1aW50MzJfdCBzdGFydF9sYmEsCisgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IGRhdGFfdHlwZSwKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDMy
X3QgbWF4X251bV9kZXNjcikKK3sKKyAgICB1aW50OF90ICpvdXRidWYgPSByZXEtPmJ1ZiwgKnBl
cmZfZGVzYzsKKyAgICB1aW50MzJfdCByZXNwX2xlbiA9IENEX1BFUkZfSEVBREVSX0xFTiArCisg
ICAgICAgICAgICAgICAgICAgICAgICBDRF9QRVJGX1RZUEVfUEVSRk9STUFOQ0VfREVTQ1JfTEVO
OworICAgIHVpbnQzMl90IHBlcmZfZGF0YV9sZW4gPSByZXNwX2xlbiAtIDQ7IC8qIG5vdCBpbmNs
LiBQZXJmIERhdGEgTGVuZ3RoICovCisgICAgdWludDMyX3QgcGVyZl9rYiA9IDEwMDAwOworICAg
IHVpbnQzMl90IGVuZF9sYmEgPSBkZXYtPm51bV9ibG9ja3MgLSAxOworICAgIHVpbnQzMl90IGV4
Y2VwdCwgd3JpdGUsIHRvbGVyYW5jZTsKKworICAgIGV4Y2VwdCA9IGRhdGFfdHlwZSAmIDB4MDM7
CisgICAgaWYgKGV4Y2VwdCAhPSBDRF9QRVJGX1RZUEVfUEVSRk9STUFOQ0VfUkVQT1JUX0FMTCkg
eworICAgICAgICBzdGFydF9sYmEgPSAwOworICAgIH0KKyAgICB3cml0ZSA9IChkYXRhX3R5cGUg
Pj4gMikgJiAweDAxOworICAgIHRvbGVyYW5jZSA9IChkYXRhX3R5cGUgPj4gMykgJiAweDAzOwor
CisgICAgU1BJQ0VfREVCVUcoImdldF9wZXJmb3JtYW5jZSwgbHVuOiUiIEdfR1VJTlQzMl9GT1JN
QVQKKyAgICAgICAgICAgICAgICAiIHBlcmZvcm1hbmNlIHR5cGU6MHgwMCBkYXRhX3R5cGU6MHgl
eCIKKyAgICAgICAgICAgICAgICAiIGV4Y2VwdDoweCV4IHdyaXRlOjB4JXggdG9sZXJhbmNlOjB4
JXgiCisgICAgICAgICAgICAgICAgIiBtYXhfbnVtOiUiIEdfR1VJTlQzMl9GT1JNQVQsCisgICAg
ICAgICAgICAgICAgcmVxLT5sdW4sIGRhdGFfdHlwZSwgZXhjZXB0LCB3cml0ZSwKKyAgICAgICAg
ICAgICAgICB0b2xlcmFuY2UsIG1heF9udW1fZGVzY3IpOworCisgICAgaWYgKHdyaXRlKSB7Cisg
ICAgICAgIFNQSUNFX0RFQlVHKCJnZXRfcGVyZm9ybWFuY2UsIGx1bjolIiBHX0dVSU5UMzJfRk9S
TUFUCisgICAgICAgICAgICAgICAgIiBwZXJmb3JtYW5jZSB0eXBlOjB4MDAgZGF0YV90eXBlOjB4
JXggLSB3cml0ZSB1bnN1cHBvcnRlZCIsCisgICAgICAgICAgICAgICAgcmVxLT5sdW4sIGRhdGFf
dHlwZSk7CisgICAgICAgIGNkX3Njc2lfZ2V0X3BlcmZvcm1hbmNlX3Jlc3BfZW1wdHkoZGV2LCBy
ZXEsIENEX1BFUkZfVFlQRV9QRVJGT1JNQU5DRSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBkYXRhX3R5cGUsIG1heF9udW1fZGVzY3IpOworICAgICAgICByZXR1
cm47CisgICAgfQorCisgICAgbWVtc2V0KG91dGJ1ZiwgMCwgcmVzcF9sZW4pOworCisgICAgb3V0
YnVmWzBdID0gKHBlcmZfZGF0YV9sZW4gPj4gMjQpICYgMHhmZjsKKyAgICBvdXRidWZbMV0gPSAo
cGVyZl9kYXRhX2xlbiA+PiAxNikgJiAweGZmOworICAgIG91dGJ1ZlsyXSA9IChwZXJmX2RhdGFf
bGVuID4+IDgpICYgMHhmZjsKKyAgICBvdXRidWZbM10gPSBwZXJmX2RhdGFfbGVuICYgMHhmZjsK
KworICAgIHBlcmZfZGVzYyA9IG91dGJ1ZiArIENEX1BFUkZfSEVBREVSX0xFTjsKKworICAgIHBl
cmZfZGVzY1swXSA9IChzdGFydF9sYmEgPj4gMjQpICYgMHhmZjsKKyAgICBwZXJmX2Rlc2NbMV0g
PSAoc3RhcnRfbGJhID4+IDE2KSAmIDB4ZmY7CisgICAgcGVyZl9kZXNjWzJdID0gKHN0YXJ0X2xi
YSA+PiA4KSAmIDB4ZmY7CisgICAgcGVyZl9kZXNjWzNdID0gc3RhcnRfbGJhICYgMHhmZjsKKwor
ICAgIHBlcmZfZGVzY1s0XSA9IChwZXJmX2tiID4+IDI0KSAmIDB4ZmY7CisgICAgcGVyZl9kZXNj
WzVdID0gKHBlcmZfa2IgPj4gMTYpICYgMHhmZjsKKyAgICBwZXJmX2Rlc2NbNl0gPSAocGVyZl9r
YiA+PiA4KSAmIDB4ZmY7CisgICAgcGVyZl9kZXNjWzddID0gcGVyZl9rYiAmIDB4ZmY7CisKKyAg
ICBwZXJmX2Rlc2NbOF0gPSAoZW5kX2xiYSA+PiAyNCkgJiAweGZmOworICAgIHBlcmZfZGVzY1s5
XSA9IChlbmRfbGJhID4+IDE2KSAmIDB4ZmY7CisgICAgcGVyZl9kZXNjWzEwXSA9IChlbmRfbGJh
ID4+IDgpICYgMHhmZjsKKyAgICBwZXJmX2Rlc2NbMTFdID0gZW5kX2xiYSAmIDB4ZmY7CisKKyAg
ICBwZXJmX2Rlc2NbMTJdID0gKHBlcmZfa2IgPj4gMjQpICYgMHhmZjsKKyAgICBwZXJmX2Rlc2Nb
MTNdID0gKHBlcmZfa2IgPj4gMTYpICYgMHhmZjsKKyAgICBwZXJmX2Rlc2NbMTRdID0gKHBlcmZf
a2IgPj4gOCkgJiAweGZmOworICAgIHBlcmZfZGVzY1sxNV0gPSBwZXJmX2tiICYgMHhmZjsKKwor
ICAgIHJlcS0+cmVxX2xlbiA9IENEX1BFUkZfSEVBREVSX0xFTiArCisgICAgICAgICAgICAgICAg
ICAgKG1heF9udW1fZGVzY3IgKiBDRF9QRVJGX1RZUEVfUEVSRk9STUFOQ0VfREVTQ1JfTEVOKTsK
KworICAgIHJlcS0+aW5fbGVuID0gKHJlcS0+cmVxX2xlbiA8IHJlc3BfbGVuKSA/IHJlcS0+cmVx
X2xlbiA6IHJlc3BfbGVuOworCisgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfZ29vZChkZXYsIHJl
cSk7Cit9CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX2dldF9wZXJmb3JtYW5jZShDZFNjc2lM
VSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgdWludDMyX3QgZGF0YV90eXBlLCBt
YXhfbnVtX2Rlc2NyLCBzdGFydF9sYmEsIHR5cGU7CisKKyAgICByZXEtPnhmZXJfZGlyID0gU0NT
SV9YRkVSX0ZST01fREVWOworCisgICAgZGF0YV90eXBlID0gcmVxLT5jZGJbMV0gJiAweDBmOwor
ICAgIHN0YXJ0X2xiYSA9IChyZXEtPmNkYlsyXSA8PCAyNCkgfAorICAgICAgICAgICAgICAgIChy
ZXEtPmNkYlszXSA8PCAxNikgfAorICAgICAgICAgICAgICAgIChyZXEtPmNkYls0XSA8PCA4KSB8
CisgICAgICAgICAgICAgICAgIHJlcS0+Y2RiWzVdOworICAgIG1heF9udW1fZGVzY3IgPSAocmVx
LT5jZGJbOF0gPDwgOCkgfCByZXEtPmNkYls5XTsKKyAgICB0eXBlID0gcmVxLT5jZGJbMTBdOwor
CisgICAgc3dpdGNoICh0eXBlKSB7CisgICAgY2FzZSBDRF9QRVJGX1RZUEVfUEVSRk9STUFOQ0U6
CisgICAgICAgIGNkX3Njc2lfZ2V0X3BlcmZvcm1hbmNlX3Jlc3BfcGVyZm9ybWFuY2UoZGV2LCBy
ZXEsIHN0YXJ0X2xiYSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBkYXRhX3R5cGUsIG1heF9udW1fZGVzY3IpOworICAgICAgICBicmVhazsKKyAgICBj
YXNlIENEX1BFUkZfVFlQRV9VTlVTQUJMRV9BUkVBOiAvKiBub3Qgd3JpdGFibGUgKi8KKyAgICBj
YXNlIENEX1BFUkZfVFlQRV9ERUZFQ1RfU1RBVFVTOiAvKiBub3QgcmVzdHJpY3RlZCBvdmVyd3Jp
dGUgbWVkaWEgKi8KKyAgICBjYXNlIENEX1BFUkZfVFlQRV9XUklURV9TUEVFRDogLyogdW5zdXBw
b3J0ZWQsIGlycmVsZXZhbnQgKi8KKyAgICBkZWZhdWx0OgorICAgICAgICBTUElDRV9ERUJVRygi
Z2V0X3BlcmZvcm1hbmNlLCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVAorICAgICAgICAgICAgICAg
ICAgICAiIHVuc3VwcG9ydGVkIHR5cGU6MHgleCIKKyAgICAgICAgICAgICAgICAgICAgIiBkYXRh
X3R5cGU6MHgleCBtYXhfbnVtOiUiIEdfR1VJTlQzMl9GT1JNQVQsCisgICAgICAgICAgICAgICAg
ICAgIHJlcS0+bHVuLCB0eXBlLCBkYXRhX3R5cGUsIG1heF9udW1fZGVzY3IpOworICAgICAgICBj
ZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZB
TElEX0NEQl9GSUVMRCk7CisgICAgICAgIHJldHVybjsKKyAgICB9Cit9CisKKyNkZWZpbmUgQ0Rf
TUVDSEFOSVNNX1NUQVRVU19IRFJfTEVOICAgICA4CisKKy8qIGJ5dGUgMCAqLworI2RlZmluZSBD
RF9DSEFOR0VSX0ZBVUxUX0ZMQUcgICAgICAgICAgIDB4ODAKKworI2RlZmluZSBDRF9DSEFOR0VS
X1JFQURZICAgICAgICAgICAgICAgIDB4MDAKKyNkZWZpbmUgQ0RfQ0hBTkdFUl9MT0FESU5HICAg
ICAgICAgICAgICAweDAxCisjZGVmaW5lIENEX0NIQU5HRVJfVU5MT0FESU5HICAgICAgICAgICAg
MHgwMgorI2RlZmluZSBDRF9DSEFOR0VSX0lOSVRJQUxJWklORyAgICAgICAgIDB4MDMKKworLyog
Ynl0ZSAxICovCisjZGVmaW5lIENEX0NIQU5HRVJfRE9PUl9PUEVOX0ZMQUcgICAgICAgMHgxMAor
CisjZGVmaW5lIENEX01FQ0hBTklTTV9TVEFURV9JRExFICAgICAgICAgMHgwMAorI2RlZmluZSBD
RF9NRUNIQU5JU01fU1RBVEVfUExBWUlORyAgICAgIDB4MDEKKyNkZWZpbmUgQ0RfTUVDSEFOSVNN
X1NUQVRFX1NDQU5OSU5HICAgICAweDAyCisvKiBBQ1RJVkU6IHdpdGggSW5pdGlhdG9yLCBDb21w
b3NpdGUgb3IgT3RoZXIgcG9ydHMKKyAgKGkuZS4gUkVBRCwgUExBWSBDRCwgU0NBTiBkdXJpbmcg
UExBWSBDRCkgKi8KKyNkZWZpbmUgQ0RfTUVDSEFOSVNNX1NUQVRFX0FDVElWRSAgICAgICAweDAz
CisjZGVmaW5lIENEX01FQ0hBTklTTV9TVEFURV9OT19JTkZPICAgICAgMHgwNworCisvKiBzbG90
cyAqLworI2RlZmluZSBDRF9NRUNIQU5JU01fU1RBVFVTX1NMT1RfTEVOICAgIDQKKworI2RlZmlu
ZSBDRF9NRUNIQU5JU01fU0xPVF9ESVNLX0NIQU5HRUQgIDB4MDEKKyNkZWZpbmUgQ0RfTUVDSEFO
SVNNX1NMT1RfRElTS19QUkVTRU5UICAweDgwCisjZGVmaW5lIENEX01FQ0hBTklTTV9TTE9UX0RJ
U0tfQ1dQX1YgICAgMHgwMgorI2RlZmluZSBDRF9NRUNIQU5JU01fU0xPVF9ESVNLX0NXUCAgICAg
IDB4MDEKKworc3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRfbWVjaGFuaXNtX3N0YXR1cyhDZFNjc2lM
VSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgdWludDhfdCAqb3V0YnVmID0gcmVx
LT5idWY7CisgICAgdWludDMyX3QgcmVzcF9sZW4gPSBDRF9NRUNIQU5JU01fU1RBVFVTX0hEUl9M
RU47CisKKyAgICByZXEtPnhmZXJfZGlyID0gU0NTSV9YRkVSX0ZST01fREVWOworCisgICAgcmVx
LT5yZXFfbGVuID0gKHJlcS0+Y2RiWzhdIDw8IDgpIHwgcmVxLT5jZGJbOV07CisgICAgbWVtc2V0
KG91dGJ1ZiwgMCwgcmVxLT5yZXFfbGVuKTsKKworICAgIC8qIEZvciBub24tY2hhbmdlciBkZXZp
Y2VzIHRoZSBjdXJlbnQgc2xvdCBudW1iZXIgZmllbGQgaXMgcmVzZXJ2ZWQsIHNldCBvbmx5IHN0
YXR1cyAqLworICAgIG91dGJ1ZlswXSB8PSAoQ0RfQ0hBTkdFUl9SRUFEWSA8PCA1KTsKKworICAg
IG91dGJ1ZlsxXSB8PSAoIWRldi0+bG9hZGVkKSA/IENEX0NIQU5HRVJfRE9PUl9PUEVOX0ZMQUcg
OiAwOworICAgIG91dGJ1ZlsxXSB8PSAoZGV2LT5wb3dlcl9jb25kID09IENEX1BPV0VSX1NUQVRV
U19BQ1RJVkUpID8KKyAgICAgICAgICAgICAgICAgKENEX01FQ0hBTklTTV9TVEFURV9BQ1RJVkUg
PDwgNSkgOiAoQ0RfTUVDSEFOSVNNX1NUQVRFX0lETEUgPDwgNSk7CisKKyAgICAvKiBGb3Igbm9u
LWNoYW5nZXIgZGV2aWNlcyB0aGUgbnVtYmVyIG9mIHNsb3QgdGFibGVzIHJldHVybmVkIHNoYWxs
IGJlIHplcm8sIHNvIHdlIGxlYXZlCisgICAgICAgYm90aCAnTnVtYmVyIG9mIFNsb3RzIEF2YWls
YWJsZScgYW5kICdMZW5ndGggb2YgU2xvdCBUYWJsZScgZmllbGRzIGFzIHplcm9zICovCisKKyAg
ICByZXEtPmluX2xlbiA9IChyZXEtPnJlcV9sZW4gPCByZXNwX2xlbikgPyByZXEtPnJlcV9sZW4g
OiByZXNwX2xlbjsKKworICAgIFNQSUNFX0RFQlVHKCJtZWNoYW5pc21fc3RhdHVzLCBsdW46JSIg
R19HVUlOVDMyX0ZPUk1BVCwgcmVxLT5sdW4pOworCisgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVf
Z29vZChkZXYsIHJlcSk7Cit9CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfcmVhZF9hc3luY19jb21w
bGV0ZShHT2JqZWN0ICpzcmNfb2JqZWN0LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIEdBc3luY1Jlc3VsdCAqcmVzdWx0LAorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGdwb2ludGVyIHVzZXJfZGF0YSkKK3sKKyAgICBHRmlsZUlucHV0U3Ry
ZWFtICpzdHJlYW0gPSBHX0ZJTEVfSU5QVVRfU1RSRUFNKHNyY19vYmplY3QpOworICAgIENkU2Nz
aVJlcXVlc3QgKnJlcSA9IChDZFNjc2lSZXF1ZXN0ICopdXNlcl9kYXRhOworICAgIENkU2NzaVRh
cmdldCAqc3QgPSAoQ2RTY3NpVGFyZ2V0ICopcmVxLT5wcml2X2RhdGE7CisgICAgQ2RTY3NpTFUg
KmRldiA9ICZzdC0+dW5pdHNbcmVxLT5sdW5dOworICAgIEdFcnJvciAqZXJyb3IgPSBOVUxMOwor
ICAgIGdzaXplIGJ5dGVzX3JlYWQ7CisgICAgZ2Jvb2xlYW4gZmluaXNoZWQ7CisKKyAgICByZXEt
PnJlcV9zdGF0ZSA9IFNDU0lfUkVRX0NPTVBMRVRFOworICAgIHJlcS0+Y2FuY2VsX2lkID0gMDsK
KworLy8gICAgZ19hc3NlcnQoc3RyZWFtID09IGRldi0+c3RyZWFtKTsKKyAgICBpZiAoc3RyZWFt
ICE9IGRldi0+c3RyZWFtKSB7CisgICAgICAgIHVpbnQzMl90IG9wY29kZSA9ICh1aW50MzJfdCly
ZXEtPmNkYlswXTsKKyAgICAgICAgU1BJQ0VfREVCVUcoInJlYWRfYXN5bmNfY29tcGxldGUgQkFE
IFNUUkVBTSwgbHVuOiAlIiBHX0dVSU5UMzJfRk9STUFUCisgICAgICAgICAgICAgICAgICAgICIg
cmVxOiAlIiBHX0dVSU5UNjRfRk9STUFUICIgb3A6IDB4JTAyeCIsCisgICAgICAgICAgICAgICAg
ICAgIHJlcS0+bHVuLCByZXEtPnJlcV9sZW4sIG9wY29kZSk7CisgICAgICAgIGNkX3Njc2lfY21k
X2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX1RBUkdFVF9GQUlMVVJF
KTsKKyAgICAgICAgY2Rfc2NzaV9kZXZfcmVxdWVzdF9jb21wbGV0ZShzdC0+dXNlcl9kYXRhLCBy
ZXEpOworICAgICAgICByZXR1cm47CisgICAgfQorCisgICAgYnl0ZXNfcmVhZCA9IGdfaW5wdXRf
c3RyZWFtX3JlYWRfZmluaXNoKEdfSU5QVVRfU1RSRUFNKHN0cmVhbSksIHJlc3VsdCwgJmVycm9y
KTsKKyAgICBmaW5pc2hlZCA9IGJ5dGVzX3JlYWQgPiAwOworICAgIGlmIChmaW5pc2hlZCkgewor
ICAgICAgICBTUElDRV9ERUJVRygicmVhZF9hc3luY19jb21wbGV0ZSwgbHVuOiAlIiBHX0dVSU5U
MzJfRk9STUFUCisgICAgICAgICAgICAgICAgICAgICIgZmluaXNoZWQ6ICVkIGJ5dGVzX3JlYWQ6
ICUiIEdfR1VJTlQ2NF9GT1JNQVQKKyAgICAgICAgICAgICAgICAgICAgIiByZXE6ICUiICBHX0dV
SU5UNjRfRk9STUFULAorICAgICAgICAgICAgICAgICAgICByZXEtPmx1biwgZmluaXNoZWQsICh1
aW50NjRfdClieXRlc19yZWFkLCByZXEtPnJlcV9sZW4pOworCisgICAgICAgIHJlcS0+aW5fbGVu
ID0gKGJ5dGVzX3JlYWQgPD0gcmVxLT5yZXFfbGVuKSA/IGJ5dGVzX3JlYWQgOiByZXEtPnJlcV9s
ZW47CisgICAgICAgIHJlcS0+c3RhdHVzID0gR09PRDsKKyAgICB9IGVsc2UgeworICAgICAgICBp
ZiAoZXJyb3IgIT0gTlVMTCkgeworICAgICAgICAgICAgU1BJQ0VfRVJST1IoImdfaW5wdXRfc3Ry
ZWFtX3JlYWRfZmluaXNoIGZhaWxlZDogJXMiLCBlcnJvci0+bWVzc2FnZSk7CisgICAgICAgICAg
ICBnX2NsZWFyX2Vycm9yICgmZXJyb3IpOworICAgICAgICB9IGVsc2UgeworICAgICAgICAgICAg
U1BJQ0VfRVJST1IoImdfaW5wdXRfc3RyZWFtX3JlYWRfZmluaXNoIGZhaWxlZCAobm8gZXJyIHBy
b3ZpZGVkKSIpOworICAgICAgICB9CisgICAgICAgIHJlcS0+aW5fbGVuID0gMDsKKyAgICAgICAg
cmVxLT5zdGF0dXMgPSBHT09EOworICAgIH0KKyAgICBjZF9zY3NpX2Rldl9yZXF1ZXN0X2NvbXBs
ZXRlKHN0LT51c2VyX2RhdGEsIHJlcSk7Cit9CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfcmVhZF9h
c3luY19jYW5jZWxlZChHQ2FuY2VsbGFibGUgKmNhbmNlbGxhYmxlLCBncG9pbnRlciB1c2VyX2Rh
dGEpCit7CisgICAgQ2RTY3NpUmVxdWVzdCAqcmVxID0gKENkU2NzaVJlcXVlc3QgKil1c2VyX2Rh
dGE7CisgICAgQ2RTY3NpVGFyZ2V0ICpzdCA9IChDZFNjc2lUYXJnZXQgKilyZXEtPnByaXZfZGF0
YTsKKworICAgIGdfYXNzZXJ0KGNhbmNlbGxhYmxlID09IHN0LT5jYW5jZWxsYWJsZSk7CisgICAg
Z19jYW5jZWxsYWJsZV9kaXNjb25uZWN0KGNhbmNlbGxhYmxlLCByZXEtPmNhbmNlbF9pZCk7Cisg
ICAgcmVxLT5jYW5jZWxfaWQgPSAwOworCisgICAgcmVxLT5yZXFfc3RhdGUgPSAoc3QtPnN0YXRl
ID09IENEX1NDU0lfVEdUX1NUQVRFX1JVTk5JTkcpID8gU0NTSV9SRVFfQ0FOQ0VMRUQgOiBTQ1NJ
X1JFUV9ESVNQT1NFRDsKKyAgICByZXEtPmluX2xlbiA9IDA7CisgICAgcmVxLT5zdGF0dXMgPSBH
T09EOworCisgICAgY2Rfc2NzaV9kZXZfcmVxdWVzdF9jb21wbGV0ZShzdC0+dXNlcl9kYXRhLCBy
ZXEpOworfQorCitzdGF0aWMgaW50IGNkX3Njc2lfcmVhZF9hc3luY19zdGFydChDZFNjc2lMVSAq
ZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgQ2RTY3NpVGFyZ2V0ICpzdCA9IGRldi0+
dGd0OworICAgIEdGaWxlSW5wdXRTdHJlYW0gKnN0cmVhbSA9IGRldi0+c3RyZWFtOworCisgICAg
U1BJQ0VfREVCVUcoInJlYWRfYXN5bmNfc3RhcnQsIGx1bjolIiBHX0dVSU5UMzJfRk9STUFUCisg
ICAgICAgICAgICAgICAgIiBsYmE6ICUiIEdfR1VJTlQ2NF9GT1JNQVQgIiBvZmZzZXQ6ICUiIEdf
R1VJTlQ2NF9GT1JNQVQKKyAgICAgICAgICAgICAgICAiIGNudDogJSIgR19HVUlOVDY0X0ZPUk1B
VCAiIGxlbjogJSIgR19HVUlOVDY0X0ZPUk1BVCwKKyAgICAgICAgICAgICAgICByZXEtPmx1biwg
cmVxLT5sYmEsIHJlcS0+b2Zmc2V0LCByZXEtPmNvdW50LCByZXEtPnJlcV9sZW4pOworCisgICAg
cmVxLT5jYW5jZWxfaWQgPSBnX2NhbmNlbGxhYmxlX2Nvbm5lY3Qoc3QtPmNhbmNlbGxhYmxlLAor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdfQ0FMTEJBQ0soY2Rf
c2NzaV9yZWFkX2FzeW5jX2NhbmNlbGVkKSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICByZXEsIC8qIGRhdGEgKi8KKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBOVUxMKTsgLyogZGF0YSBkZXN0cm95IGNiICovCisgICAgaWYgKHJl
cS0+Y2FuY2VsX2lkID09IDApIHsKKyAgICAgICAgLyogYWxyZWFkeSBjYW5jZWxlZCAqLworICAg
ICAgICByZXR1cm4gLTE7CisgICAgfQorCisgICAgZ19zZWVrYWJsZV9zZWVrKEdfU0VFS0FCTEUo
c3RyZWFtKSwKKyAgICAgICAgICAgICAgICAgICAgcmVxLT5vZmZzZXQsCisgICAgICAgICAgICAg
ICAgICAgIEdfU0VFS19TRVQsCisgICAgICAgICAgICAgICAgICAgIE5VTEwsIC8qIGNhbmNlbGxh
YmxlICovCisgICAgICAgICAgICAgICAgICAgIE5VTEwpOyAvKiBlcnJvciAqLworCisgICAgZ19p
bnB1dF9zdHJlYW1fcmVhZF9hc3luYyhHX0lOUFVUX1NUUkVBTShzdHJlYW0pLAorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgcmVxLT5idWYsIC8qIGJ1ZmZlciB0byBmaWxsICovCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICByZXEtPnJlcV9sZW4sCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBHX1BSSU9SSVRZX0RFRkFVTFQsCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBzdC0+Y2FuY2VsbGFibGUsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBj
ZF9zY3NpX3JlYWRfYXN5bmNfY29tcGxldGUsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAoZ3BvaW50ZXIpcmVxKTsgLyogY2FsbGJhY2sgYXJndW1lbnQgKi8KKyAgICByZXR1cm4gMDsK
K30KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRfcmVhZChDZFNjc2lMVSAqZGV2LCBDZFNjc2lS
ZXF1ZXN0ICpyZXEpCit7CisgICAgaWYgKGRldi0+cG93ZXJfY29uZCA9PSBDRF9TQ1NJX1BPV0VS
X1NUT1BQRUQpIHsKKyAgICAgICAgU1BJQ0VfREVCVUcoInJlYWQsIGx1bjogJSIgR19HVUlOVDMy
X0ZPUk1BVCAiIGlzIHN0b3BwZWQiLCByZXEtPmx1bik7CisgICAgICAgIGNkX3Njc2lfY21kX2Nv
bXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX0lOSVRfQ01EX1JFUVVJUkVE
KTsKKyAgICAgICAgcmV0dXJuOworICAgIH0gZWxzZSBpZiAoIWRldi0+bG9hZGVkIHx8IGRldi0+
c3RyZWFtID09IE5VTEwpIHsKKyAgICAgICAgU1BJQ0VfREVCVUcoInJlYWQsIGx1bjogJSIgR19H
VUlOVDMyX0ZPUk1BVCAiIGlzIG5vdCBsb2FkZWQiLCByZXEtPmx1bik7CisgICAgICAgIGNkX3Nj
c2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX05PVF9SRUFE
WV9OT19NRURJVU0pOworICAgICAgICByZXR1cm47CisgICAgfQorCisgICAgcmVxLT5jZGJfbGVu
ID0gc2NzaV9jZGJfbGVuZ3RoKHJlcS0+Y2RiKTsKKworICAgIHJlcS0+bGJhID0gc2NzaV9jZGJf
bGJhKHJlcS0+Y2RiLCByZXEtPmNkYl9sZW4pOworICAgIHJlcS0+b2Zmc2V0ID0gcmVxLT5sYmEg
KiBkZXYtPmJsb2NrX3NpemU7CisKKyAgICByZXEtPmNvdW50ID0gc2NzaV9jZGJfeGZlcl9sZW5n
dGgocmVxLT5jZGIsIHJlcS0+Y2RiX2xlbik7IC8qIHhmZXIgaW4gYmxvY2tzICovCisgICAgcmVx
LT5yZXFfbGVuID0gcmVxLT5jb3VudCAqIGRldi0+YmxvY2tfc2l6ZTsKKworICAgIGNkX3Njc2lf
cmVhZF9hc3luY19zdGFydChkZXYsIHJlcSk7Cit9CisKK3ZvaWQgY2Rfc2NzaV9kZXZfcmVxdWVz
dF9zdWJtaXQodm9pZCAqc2NzaV90YXJnZXQsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICBD
ZFNjc2lUYXJnZXQgKnN0ID0gKENkU2NzaVRhcmdldCAqKXNjc2lfdGFyZ2V0OworICAgIHVpbnQz
Ml90IGx1biA9IHJlcS0+bHVuOworICAgIHVpbnQzMl90IG9wY29kZSA9ICh1aW50MzJfdClyZXEt
PmNkYlswXTsKKyAgICBjb25zdCBjaGFyICpjbWRfbmFtZSA9IHNjc2lfY21kX25hbWVbb3Bjb2Rl
XTsKKyAgICBDZFNjc2lMVSAqZGV2ID0gJnN0LT51bml0c1tsdW5dOworCisgICAgU1BJQ0VfREVC
VUcoInJlcXVlc3Rfc3VibWl0LCBsdW46ICUiIEdfR1VJTlQzMl9GT1JNQVQgIiBvcDogMHglMDJ4
ICVzIiwgbHVuLCBvcGNvZGUsIGNtZF9uYW1lKTsKKworICAgIGlmIChzdC0+Y3VyX3JlcSAhPSBO
VUxMKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJyZXF1ZXN0X3N1Ym1pdCwgcmVxdWVzdCBub3Qg
aWRsZSIpOworICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVx
LCAmc2Vuc2VfY29kZV9UQVJHRVRfRkFJTFVSRSk7CisgICAgICAgIGdvdG8gZG9uZTsKKyAgICB9
CisgICAgaWYgKHJlcS0+cmVxX3N0YXRlICE9IFNDU0lfUkVRX0lETEUpIHsKKyAgICAgICAgU1BJ
Q0VfRVJST1IoInJlcXVlc3Rfc3VibWl0LCBwcmV2IHJlcXVlc3Qgb3V0c3RhbmRpbmciKTsKKyAg
ICAgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2Nv
ZGVfVEFSR0VUX0ZBSUxVUkUpOworICAgICAgICBnb3RvIGRvbmU7CisgICAgfQorICAgIHJlcS0+
cmVxX3N0YXRlID0gU0NTSV9SRVFfUlVOTklORzsKKyAgICBzdC0+Y3VyX3JlcSA9IHJlcTsKKwor
ICAgIC8qIElOUVVJUlkgc2hvdWxkIHNlbmQgcmVzcG9uc2UgZXZlbiBmb3Igbm9uLWV4aXN0aW5n
IExVTnMgKi8KKyAgICBpZiAoIWNkX3Njc2lfdGFyZ2V0X2x1bl9sZWdhbChzdCwgbHVuKSkgewor
ICAgICAgICBTUElDRV9FUlJPUigicmVxdWVzdF9zdWJtaXQsIGlsbGVnYWwgbHVuOiUiIEdfR1VJ
TlQzMl9GT1JNQVQsIGx1bik7CisgICAgICAgIGlmIChvcGNvZGUgPT0gSU5RVUlSWSkgeworICAg
ICAgICAgICAgaWYgKHJlcS0+Y2RiWzFdICYgMHgxKSB7CisgICAgICAgICAgICAgICAgY2Rfc2Nz
aV9jbWRfaW5xdWlyeV92cGRfbm9fbHVuKGRldiwgcmVxLCBQRVJJRl9RVUFMSUZJRVJfVU5TVVBQ
T1JURUQpOworICAgICAgICAgICAgfSBlbHNlIHsKKyAgICAgICAgICAgICAgICBjZF9zY3NpX2Nt
ZF9pbnF1aXJ5X3N0YW5kYXJkX25vX2x1bihkZXYsIHJlcSwgUEVSSUZfUVVBTElGSUVSX1VOU1VQ
UE9SVEVEKTsKKyAgICAgICAgICAgIH0KKyAgICAgICAgfSBlbHNlIHsKKyAgICAgICAgICAgIGNk
X3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX0xVTl9O
T1RfU1VQUE9SVEVEKTsKKyAgICAgICAgfQorICAgICAgICBnb3RvIGRvbmU7CisgICAgfQorICAg
IGlmICghY2Rfc2NzaV90YXJnZXRfbHVuX3JlYWxpemVkKHN0LCBsdW4pKSB7CisgICAgICAgIFNQ
SUNFX0VSUk9SKCJyZXF1ZXN0X3N1Ym1pdCwgYWJzZW50IGx1bjolIiBHX0dVSU5UMzJfRk9STUFU
LCBsdW4pOworICAgICAgICBpZiAob3Bjb2RlID09IElOUVVJUlkpIHsKKyAgICAgICAgICAgIGlm
IChyZXEtPmNkYlsxXSAmIDB4MSkgeworICAgICAgICAgICAgICAgIGNkX3Njc2lfY21kX2lucXVp
cnlfdnBkX25vX2x1bihkZXYsIHJlcSwgUEVSSUZfUVVBTElGSUVSX05PVF9DT05ORUNURUQpOwor
ICAgICAgICAgICAgfSBlbHNlIHsKKyAgICAgICAgICAgICAgICBjZF9zY3NpX2NtZF9pbnF1aXJ5
X3N0YW5kYXJkX25vX2x1bihkZXYsIHJlcSwgUEVSSUZfUVVBTElGSUVSX05PVF9DT05ORUNURUQp
OworICAgICAgICAgICAgfQorICAgICAgICB9IGVsc2UgeworICAgICAgICAgICAgY2Rfc2NzaV9j
bWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfTFVOX05PVF9TVVBQ
T1JURUQpOworICAgICAgICB9CisgICAgICAgIGdvdG8gZG9uZTsKKyAgICB9CisKKyAgICBpZiAo
ZGV2LT5zaG9ydF9zZW5zZS5rZXkgIT0gTk9fU0VOU0UpIHsKKyAgICAgICAgZ2Jvb2xlYW4gcGVu
ZGluZ19zZW5zZSA9IFRSVUU7CisgICAgICAgIGlmIChkZXYtPnNob3J0X3NlbnNlLmtleSA9PSBV
TklUX0FUVEVOVElPTikgeworICAgICAgICAgICAgaWYgKGNkX3Njc2lfb3Bjb2RlX3VhX3N1cHJl
c3Mob3Bjb2RlKSkgeworICAgICAgICAgICAgICAgIHBlbmRpbmdfc2Vuc2UgPSBGQUxTRTsgLyog
VUEgc3VwcmVzc2VkICovCisgICAgICAgICAgICB9CisgICAgICAgIH0gZWxzZSBpZiAob3Bjb2Rl
ID09IFJFUVVFU1RfU0VOU0UpIHsKKyAgICAgICAgICAgIHBlbmRpbmdfc2Vuc2UgPSBGQUxTRTsg
Lyogc2Vuc2UgcmV0dXJuZWQgYXMgZGF0YSAqLworICAgICAgICB9CisgICAgICAgIGlmIChwZW5k
aW5nX3NlbnNlKSB7CisgICAgICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25k
KGRldiwgcmVxLCBOVUxMKTsgLyogc2Vuc2UgYWxyZWFkeSBzZXQgKi8KKyAgICAgICAgICAgIGdv
dG8gZG9uZTsKKyAgICAgICAgfQorICAgIH0KKworICAgIC8qIHNhdmUgdGhlIHRhcmdldCB0byBi
ZSB1c2VkIGluIGNhbGxiYWNrcyB3aGVyZSBvbmx5IHJlcSBpcyBwYXNzZWQgKi8KKyAgICByZXEt
PnByaXZfZGF0YSA9ICh2b2lkICopc3Q7CisKKyAgICByZXEtPnJlcV9sZW4gPSAwOworCisgICAg
c3dpdGNoIChvcGNvZGUpIHsKKyAgICBjYXNlIFJFUE9SVF9MVU5TOgorICAgICAgICBjZF9zY3Np
X2NtZF9yZXBvcnRfbHVucyhzdCwgZGV2LCByZXEpOworICAgICAgICBicmVhazsKKyAgICBjYXNl
IFRFU1RfVU5JVF9SRUFEWToKKyAgICAgICAgY2Rfc2NzaV9jbWRfdGVzdF91bml0X3JlYWR5KGRl
diwgcmVxKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBJTlFVSVJZOgorICAgICAgICBjZF9z
Y3NpX2NtZF9pbnF1aXJ5KGRldiwgcmVxKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBSRVFV
RVNUX1NFTlNFOgorICAgICAgICBjZF9zY3NpX2NtZF9yZXF1ZXN0X3NlbnNlKGRldiwgcmVxKTsK
KyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBSRUFEXzY6CisgICAgY2FzZSBSRUFEXzEwOgorICAg
IGNhc2UgUkVBRF8xMjoKKyAgICBjYXNlIFJFQURfMTY6CisgICAgICAgIGNkX3Njc2lfY21kX3Jl
YWQoZGV2LCByZXEpOworICAgICAgICBicmVhazsKKyAgICBjYXNlIFJFQURfQ0FQQUNJVFlfMTA6
CisgICAgICAgIGNkX3Njc2lfY21kX3JlYWRfY2FwYWNpdHkoZGV2LCByZXEpOworICAgICAgICBi
cmVhazsKKyAgICBjYXNlIFJFQURfVE9DOgorICAgICAgICBjZF9zY3NpX2NtZF9yZWFkX3RvYyhk
ZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgR0VUX0VWRU5UX1NUQVRVU19OT1RJ
RklDQVRJT046CisgICAgICAgIGNkX3Njc2lfY21kX2dldF9ldmVudF9zdGF0dXNfbm90aWZpY2F0
aW9uKGRldiwgcmVxKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBSRUFEX0RJU0NfSU5GT1JN
QVRJT046CisgICAgICAgIGNkX3Njc2lfY21kX2dldF9yZWFkX2Rpc2NfaW5mb3JtYXRpb24oZGV2
LCByZXEpOworICAgICAgICBicmVhazsKKyAgICBjYXNlIFJFQURfVFJBQ0tfSU5GT1JNQVRJT046
CisgICAgICAgIGNkX3Njc2lfY21kX2dldF9yZWFkX3RyYWNrX2luZm9ybWF0aW9uKGRldiwgcmVx
KTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBNT0RFX1NFTlNFXzEwOgorICAgICAgICBjZF9z
Y3NpX2NtZF9tb2RlX3NlbnNlXzEwKGRldiwgcmVxKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2Fz
ZSBNT0RFX1NFTEVDVDoKKyAgICAgICAgY2Rfc2NzaV9jbWRfbW9kZV9zZWxlY3RfNihkZXYsIHJl
cSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgTU9ERV9TRUxFQ1RfMTA6CisgICAgICAgIGNk
X3Njc2lfY21kX21vZGVfc2VsZWN0XzEwKGRldiwgcmVxKTsKKyAgICAgICAgYnJlYWs7CisgICAg
Y2FzZSBHRVRfQ09ORklHVVJBVElPTjoKKyAgICAgICAgY2Rfc2NzaV9jbWRfZ2V0X2NvbmZpZ3Vy
YXRpb24oZGV2LCByZXEpOworICAgICAgICBicmVhazsKKyAgICBjYXNlIEFMTE9XX01FRElVTV9S
RU1PVkFMOgorICAgICAgICBjZF9zY3NpX2NtZF9hbGxvd19tZWRpdW1fcmVtb3ZhbChkZXYsIHJl
cSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgTU1DX1NFTkRfRVZFTlQ6CisgICAgICAgIGNk
X3Njc2lfY21kX3NlbmRfZXZlbnQoZGV2LCByZXEpOworICAgICAgICBicmVhazsKKyAgICBjYXNl
IE1NQ19SRVBPUlRfS0VZOgorICAgICAgICBjZF9zY3NpX2NtZF9yZXBvcnRfa2V5KGRldiwgcmVx
KTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBNTUNfU0VORF9LRVk6CisgICAgICAgIGNkX3Nj
c2lfY21kX3NlbmRfa2V5KGRldiwgcmVxKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBTVEFS
VF9TVE9QOgorICAgICAgICBjZF9zY3NpX2NtZF9zdGFydF9zdG9wX3VuaXQoZGV2LCByZXEpOwor
ICAgICAgICBicmVhazsKKyAgICBjYXNlIE1NQ19HRVRfUEVSRk9STUFOQ0U6CisgICAgICAgIGNk
X3Njc2lfY21kX2dldF9wZXJmb3JtYW5jZShkZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOworICAg
IGNhc2UgTU1DX01FQ0hBTklTTV9TVEFUVVM6CisgICAgICAgIGNkX3Njc2lfY21kX21lY2hhbmlz
bV9zdGF0dXMoZGV2LCByZXEpOworICAgICAgICBicmVhazsKKyAgICBkZWZhdWx0OgorICAgICAg
ICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9J
TlZBTElEX09QQ09ERSk7CisgICAgICAgIGJyZWFrOworICAgIH0KKworICAgIGlmIChyZXEtPnJl
cV9sZW4gPiBJTlQzMl9NQVgpIHsKKyAgICAgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tf
Y29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfSU5WQUxJRF9DREJfRklFTEQpOworICAgICAgICBn
b3RvIGRvbmU7CisgICAgfQorCitkb25lOgorICAgIFNQSUNFX0RFQlVHKCJyZXF1ZXN0X3N1Ym1p
dCBkb25lLCBsdW46ICUiIEdfR1VJTlQzMl9GT1JNQVQKKyAgICAgICAgICAgICAgICAiIG9wOiAw
eCUwMnggJXMsIHN0YXRlOiAlcyBzdGF0dXM6ICUiIEdfR1VJTlQzMl9GT1JNQVQgIiBsZW46ICUi
IEdfR1VJTlQ2NF9GT1JNQVQsCisgICAgICAgICAgICAgICAgbHVuLCBvcGNvZGUsIGNtZF9uYW1l
LCBDZFNjc2lSZXFTdGF0ZV9zdHIocmVxLT5yZXFfc3RhdGUpLCByZXEtPnN0YXR1cywgcmVxLT5p
bl9sZW4pOworCisgICAgaWYgKHJlcS0+cmVxX3N0YXRlID09IFNDU0lfUkVRX0NPTVBMRVRFKSB7
CisgICAgICAgIGNkX3Njc2lfZGV2X3JlcXVlc3RfY29tcGxldGUoc3QtPnVzZXJfZGF0YSwgcmVx
KTsKKyAgICB9Cit9CisKK3ZvaWQgY2Rfc2NzaV9kZXZfcmVxdWVzdF9jYW5jZWwodm9pZCAqc2Nz
aV90YXJnZXQsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICBDZFNjc2lUYXJnZXQgKnN0ID0g
KENkU2NzaVRhcmdldCAqKXNjc2lfdGFyZ2V0OworCisgICAgaWYgKHN0LT5jdXJfcmVxID09IHJl
cSkgeworICAgICAgICBpZiAocmVxLT5yZXFfc3RhdGUgPT0gU0NTSV9SRVFfUlVOTklORykgewor
ICAgICAgICAgICAgU1BJQ0VfREVCVUcoInJlcXVlc3RfY2FuY2VsOiBsdW46ICUiIEdfR1VJTlQz
Ml9GT1JNQVQKKyAgICAgICAgICAgICAgICAgICAgICAgICAiIG9wOiAweCUwMnggbGVuOiAlIiBH
X0dVSU5UNjRfRk9STUFULAorICAgICAgICAgICAgICAgICAgICAgICAgcmVxLT5sdW4sICh1bnNp
Z25lZCBpbnQpcmVxLT5jZGJbMF0sIHJlcS0+cmVxX2xlbik7CisgICAgICAgICAgICBnX2NhbmNl
bGxhYmxlX2NhbmNlbChzdC0+Y2FuY2VsbGFibGUpOworICAgICAgICB9IGVsc2UgeworICAgICAg
ICAgICAgU1BJQ0VfREVCVUcoInJlcXVlc3RfY2FuY2VsOiByZXF1ZXN0IGlzIG5vdCBydW5uaW5n
Iik7CisgICAgICAgIH0KKyAgICB9IGVsc2UgeworICAgICAgICBTUElDRV9ERUJVRygicmVxdWVz
dF9jYW5jZWw6IG90aGVyIHJlcXVlc3QgaXMgb3V0c3RhbmRpbmciKTsKKyAgICB9Cit9CisKK3Zv
aWQgY2Rfc2NzaV9kZXZfcmVxdWVzdF9yZWxlYXNlKHZvaWQgKnNjc2lfdGFyZ2V0LCBDZFNjc2lS
ZXF1ZXN0ICpyZXEpCit7CisgICAgQ2RTY3NpVGFyZ2V0ICpzdCA9IChDZFNjc2lUYXJnZXQgKilz
Y3NpX3RhcmdldDsKKworICAgIHN0LT5jdXJfcmVxID0gTlVMTDsKKyAgICBjZF9zY3NpX3JlcV9p
bml0KHJlcSk7CisKKyAgICBpZiAoc3QtPnN0YXRlID09IENEX1NDU0lfVEdUX1NUQVRFX1JFU0VU
KSB7CisgICAgICAgIGNkX3Njc2lfdGFyZ2V0X2RvX3Jlc2V0KHN0KTsKKyAgICB9Cit9CisKKyNl
bmRpZiAvKiBVU0VfVVNCUkVESVIgKi8KZGlmZiAtLWdpdCBhL3NyYy9jZC1zY3NpLmggYi9zcmMv
Y2Qtc2NzaS5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwLi5iMWQwY2UyMwot
LS0gL2Rldi9udWxsCisrKyBiL3NyYy9jZC1zY3NpLmgKQEAgLTAsMCArMSwxMjIgQEAKKy8qIC0q
LSBNb2RlOiBDOyBjLWJhc2ljLW9mZnNldDogNDsgaW5kZW50LXRhYnMtbW9kZTogbmlsIC0qLSAq
LworLyoKKyAgIENEIGRldmljZSBlbXVsYXRpb24gLSBTQ1NJIGVuZ2luZQorCisgICBDb3B5cmln
aHQgKEMpIDIwMTggUmVkIEhhdCwgSW5jLgorCisgICBSZWQgSGF0IEF1dGhvcnM6CisgICBBbGV4
YW5kZXIgTmV6aGluc2t5PGFuZXpoaW5zQHJlZGhhdC5jb20+CisKKyAgIFRoaXMgbGlicmFyeSBp
cyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IKKyAgIG1vZGlm
eSBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKKyAg
IExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVp
dGhlcgorICAgdmVyc2lvbiAyLjEgb2YgdGhlIExpY2Vuc2UsIG9yIChhdCB5b3VyIG9wdGlvbikg
YW55IGxhdGVyIHZlcnNpb24uCisKKyAgIFRoaXMgbGlicmFyeSBpcyBkaXN0cmlidXRlZCBpbiB0
aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAorICAgYnV0IFdJVEhPVVQgQU5ZIFdBUlJB
TlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKKyAgIE1FUkNIQU5UQUJJ
TElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUgR05VCisg
ICBMZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgorCisgICBZ
b3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwg
UHVibGljCisgICBMaWNlbnNlIGFsb25nIHdpdGggdGhpcyBsaWJyYXJ5OyBpZiBub3QsIHNlZSA8
aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCisqLworCisjaWZuZGVmIF9fQ0RfU0NTSV9I
X18KKyNkZWZpbmUgX19DRF9TQ1NJX0hfXworCisjaW5jbHVkZSAiY2Qtc2NzaS1kZXYtcGFyYW1z
LmgiCisjaW5jbHVkZSAiY2QtdXNiLWJ1bGstbXNkLmgiCisjaW5jbHVkZSAic2NzaS1jb25zdGFu
dHMuaCIKKworI2RlZmluZSBGSVhFRF9TRU5TRV9DVVJSRU5UIDB4NzAKKyNkZWZpbmUgRklYRURf
U0VOU0VfTEVOIDE4CisKKyNpZiBkZWZpbmVkKEdfT1NfV0lOMzIpCisjaW5jbHVkZSA8d2luc29j
azIuaD4KKyNpbmNsdWRlIDx3aW5kb3dzLmg+CisvKiBXaW5kb3dzIGlzIGFsd2F5cyBMRSBhdCB0
aGUgbW9tZW50ICovCisjZGVmaW5lIGxlMzJ0b2goeCkgICAgICAgICAgKHgpCisjZGVmaW5lIGh0
b2xlMzIoeCkgICAgICAgICAgKHgpCisjZGVmaW5lIGh0b2JlMzIoeCkgICAgICAgICAgaHRvbmwo
eCkKKyNlbmRpZgorCit0eXBlZGVmIGVudW0gX1Njc2lYZmVyRGlyCit7CisgICAgU0NTSV9YRkVS
X05PTkUgPSAwLCAgLyogVEVTVF9VTklUX1JFQURZLCAuLi4gICAgICAgICAgICovCisgICAgU0NT
SV9YRkVSX0ZST01fREVWLCAgLyogUkVBRCwgSU5RVUlSWSwgTU9ERV9TRU5TRSwgLi4uICovCisg
ICAgU0NTSV9YRkVSX1RPX0RFViwgICAgLyogV1JJVEUsIE1PREVfU0VMRUNULCAuLi4gICAgICAg
ICovCit9IFNjc2lYZmVyRGlyOworCisjZGVmaW5lIFNDU0lfQ0RCX0JVRl9TSVpFICAgMTYKKyNk
ZWZpbmUgU0NTSV9TRU5TRV9CVUZfU0laRSA2NAorCit0eXBlZGVmIGVudW0gX0NkU2NzaVJlcVN0
YXRlCit7CisgICAgU0NTSV9SRVFfSURMRSA9IDAsCisgICAgU0NTSV9SRVFfUlVOTklORywKKyAg
ICBTQ1NJX1JFUV9DT01QTEVURSwKKyAgICBTQ1NJX1JFUV9DQU5DRUxFRCwKKyAgICBTQ1NJX1JF
UV9ESVNQT1NFRCwKK30gQ2RTY3NpUmVxU3RhdGU7CisKK3R5cGVkZWYgc3RydWN0IF9DZFNjc2lS
ZXF1ZXN0Cit7CisgICAgLyogcmVxdWVzdCAqLworICAgIHVpbnQ4X3QgY2RiW1NDU0lfQ0RCX0JV
Rl9TSVpFXTsKKyAgICB1aW50MzJfdCBjZGJfbGVuOworCisgICAgdWludDMyX3QgdGFnOworICAg
IHVpbnQzMl90IGx1bjsKKworICAgIHVpbnQ4X3QgKmJ1ZjsKKyAgICB1aW50MzJfdCBidWZfbGVu
OworCisgICAgLyogaW50ZXJuYWwgKi8KKyAgICBDZFNjc2lSZXFTdGF0ZSByZXFfc3RhdGU7Cisg
ICAgU2NzaVhmZXJEaXIgeGZlcl9kaXI7CisgICAgdWludDY0X3QgY2FuY2VsX2lkOworICAgIHZv
aWQgKnByaXZfZGF0YTsKKworICAgIHVpbnQ2NF90IGxiYTsgLyogb2Zmc2V0IGluIGxvZ2ljYWwg
YmxvY2tzIGlmIHJlbGV2YW50ICovCisgICAgdWludDY0X3QgY291bnQ7IC8qIGNvdW50IGluIGxv
Z2ljYWwgYmxvY2tzICovCisKKyAgICB1aW50NjRfdCBvZmZzZXQ7IC8qIHNjc2kgY2RiIG9mZnNl
dCwgbm9ybWFsaXplZCB0byBieXRlcyAqLworICAgIHVpbnQ2NF90IHJlcV9sZW47IC8qIHNjc2kg
Y2RiIHJlcXVlc3QgbGVuZ3RoLCBub3JtYWxpemVkIHRvIGJ5dGVzICovCisKKyAgICAvKiByZXN1
bHQgKi8KKyAgICB1aW50NjRfdCBpbl9sZW47IC8qIGxlbmd0aCBvZiBkYXRhIGFjdHVhbGx5IGF2
YWlsYWJsZSBhZnRlciByZWFkICovCisgICAgdWludDMyX3Qgc3RhdHVzOyAvKiBTQ1NJIHN0YXR1
cyBjb2RlICovCisKK30gQ2RTY3NpUmVxdWVzdDsKKworQ2RTY3NpUmVxU3RhdGUgY2Rfc2NzaV9n
ZXRfcmVxX3N0YXRlKENkU2NzaVJlcXVlc3QgKnJlcSk7CisKKy8qIFNDU0kgdGFyZ2V0L2Rldmlj
ZSBBUEkgKi8KKwordm9pZCAqY2Rfc2NzaV90YXJnZXRfYWxsb2Modm9pZCAqdGFyZ2V0X3VzZXJf
ZGF0YSwgdWludDMyX3QgbWF4X2x1bnMpOyAvKiB0byBiZSB1c2VkIGluIGNhbGxiYWNrcyAqLwor
dm9pZCBjZF9zY3NpX3RhcmdldF9mcmVlKHZvaWQgKnNjc2lfdGFyZ2V0KTsKKworaW50IGNkX3Nj
c2lfZGV2X3JlYWxpemUodm9pZCAqc2NzaV90YXJnZXQsIHVpbnQzMl90IGx1biwgY29uc3QgQ2RT
Y3NpRGV2aWNlUGFyYW1ldGVycyAqZGV2X3BhcmFtcyk7CitpbnQgY2Rfc2NzaV9kZXZfdW5yZWFs
aXplKHZvaWQgKnNjc2lfdGFyZ2V0LCB1aW50MzJfdCBsdW4pOworCitpbnQgY2Rfc2NzaV9kZXZf
bG9jayh2b2lkICpzY3NpX3RhcmdldCwgdWludDMyX3QgbHVuLCBnYm9vbGVhbiBsb2NrKTsKK2lu
dCBjZF9zY3NpX2Rldl9sb2FkKHZvaWQgKnNjc2lfdGFyZ2V0LCB1aW50MzJfdCBsdW4sIGNvbnN0
IENkU2NzaU1lZGlhUGFyYW1ldGVycyAqbWVkaWFfcGFyYW1zKTsKK2ludCBjZF9zY3NpX2Rldl9n
ZXRfaW5mbyh2b2lkICpzY3NpX3RhcmdldCwgdWludDMyX3QgbHVuLCBDZFNjc2lEZXZpY2VJbmZv
ICpsdW5faW5mbyk7CitpbnQgY2Rfc2NzaV9kZXZfdW5sb2FkKHZvaWQgKnNjc2lfdGFyZ2V0LCB1
aW50MzJfdCBsdW4pOworCit2b2lkIGNkX3Njc2lfZGV2X3JlcXVlc3Rfc3VibWl0KHZvaWQgKnNj
c2lfdGFyZ2V0LCBDZFNjc2lSZXF1ZXN0ICpyZXF1ZXN0KTsKK3ZvaWQgY2Rfc2NzaV9kZXZfcmVx
dWVzdF9jYW5jZWwodm9pZCAqc2NzaV90YXJnZXQsIENkU2NzaVJlcXVlc3QgKnJlcXVlc3QpOwor
dm9pZCBjZF9zY3NpX2Rldl9yZXF1ZXN0X3JlbGVhc2Uodm9pZCAqc2NzaV90YXJnZXQsIENkU2Nz
aVJlcXVlc3QgKnJlcXVlc3QpOworCitpbnQgY2Rfc2NzaV9kZXZfcmVzZXQodm9pZCAqc2NzaV90
YXJnZXQsIHVpbnQzMl90IGx1bik7CisKK2ludCBjZF9zY3NpX3RhcmdldF9yZXNldCh2b2lkICpz
Y3NpX3RhcmdldCk7CisKKy8qIENhbGxiYWNrcyAqLworCit2b2lkIGNkX3Njc2lfZGV2X3JlcXVl
c3RfY29tcGxldGUodm9pZCAqdGFyZ2V0X3VzZXJfZGF0YSwgQ2RTY3NpUmVxdWVzdCAqcmVxdWVz
dCk7Cit2b2lkIGNkX3Njc2lfZGV2X2NoYW5nZWQodm9pZCAqdGFyZ2V0X3VzZXJfZGF0YSwgdWlu
dDMyX3QgbHVuKTsKK3ZvaWQgY2Rfc2NzaV9kZXZfcmVzZXRfY29tcGxldGUodm9pZCAqdGFyZ2V0
X3VzZXJfZGF0YSwgdWludDMyX3QgbHVuKTsKK3ZvaWQgY2Rfc2NzaV90YXJnZXRfcmVzZXRfY29t
cGxldGUodm9pZCAqdGFyZ2V0X3VzZXJfZGF0YSk7CisKKyNlbmRpZiAvKiBfX0NEX1NDU0lfSF9f
ICovCmRpZmYgLS1naXQgYS9zcmMvY2QtdXNiLWJ1bGstbXNkLmMgYi9zcmMvY2QtdXNiLWJ1bGst
bXNkLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAuLmJlMGZlZTM2Ci0tLSAv
ZGV2L251bGwKKysrIGIvc3JjL2NkLXVzYi1idWxrLW1zZC5jCkBAIC0wLDAgKzEsNTU1IEBACisv
KiAtKi0gTW9kZTogQzsgYy1iYXNpYy1vZmZzZXQ6IDQ7IGluZGVudC10YWJzLW1vZGU6IG5pbCAt
Ki0gKi8KKy8qCisgICAgVVNCIENEIERldmljZSBlbXVsYXRpb24gLSBEYXRhIEJ1bGsgdHJhbnNm
ZXJzIC0gTWFzcyBTdG9yYWdlIERldmljZQorCisgICAgQ29weXJpZ2h0IChDKSAyMDE4IFJlZCBI
YXQsIEluYy4KKworICAgIFJlZCBIYXQgQXV0aG9yczoKKyAgICBBbGV4YW5kZXIgTmV6aGluc2t5
PGFuZXpoaW5zQHJlZGhhdC5jb20+CisKKyAgICBUaGlzIGxpYnJhcnkgaXMgZnJlZSBzb2Z0d2Fy
ZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yCisgICAgbW9kaWZ5IGl0IHVuZGVyIHRo
ZSB0ZXJtcyBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYworICAgIExpY2Vuc2UgYXMg
cHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlcgorICAgIHZl
cnNpb24gMi4xIG9mIHRoZSBMaWNlbnNlLCBvciAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2
ZXJzaW9uLgorCisgICAgVGhpcyBsaWJyYXJ5IGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRo
YXQgaXQgd2lsbCBiZSB1c2VmdWwsCisgICAgYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRo
b3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKKyAgICBNRVJDSEFOVEFCSUxJVFkgb3Ig
RklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlIEdOVQorICAgIExlc3Nl
ciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCisKKyAgICBZb3Ugc2hv
dWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGlj
CisgICAgTGljZW5zZSBhbG9uZyB3aXRoIHRoaXMgbGlicmFyeTsgaWYgbm90LCBzZWUgPGh0dHA6
Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+LgorKi8KKworI2luY2x1ZGUgImNvbmZpZy5oIgorI2lu
Y2x1ZGUgInNwaWNlL3R5cGVzLmgiCisjaW5jbHVkZSAic3BpY2UtY29tbW9uLmgiCisjaW5jbHVk
ZSAic3BpY2UtdXRpbC5oIgorI2luY2x1ZGUgImNkLXVzYi1idWxrLW1zZC5oIgorI2luY2x1ZGUg
ImNkLXNjc2kuaCIKKworI2lmZGVmIFVTRV9VU0JSRURJUgorCisjZGVmaW5lIFNQSUNFX0VSUk9S
KGZtdCwgLi4uKSBcCisgICAgZG8geyBTUElDRV9ERUJVRygidXNiLW1zZCBlcnJvcjogIiBmbXQg
LCAjIyBfX1ZBX0FSR1NfXyk7IH0gd2hpbGUgKDApCisKK3R5cGVkZWYgZW51bSBfVXNiQ2RTdGF0
ZSB7CisgICAgVVNCX0NEX1NUQVRFX0lOSVQsIC8qIE5vdCByZWFkeSAqLworICAgIFVTQl9DRF9T
VEFURV9DQlcsIC8qIFdhaXRpbmcgZm9yIENvbW1hbmQgQmxvY2sgKi8KKyAgICBVU0JfQ0RfU1RB
VEVfREFUQU9VVCwgLyogVHJhbnNmZXIgZGF0YSB0byBkZXZpY2UgKi8KKyAgICBVU0JfQ0RfU1RB
VEVfREFUQUlOLCAvKiBUcmFuc2ZlciBkYXRhIGZyb20gZGV2aWNlICovCisgICAgVVNCX0NEX1NU
QVRFX1pFUk9fREFUQUlOLCAvKiBOZWVkIHRvIHNlbmQgemVybyBidWxrLWluIGJlZm9yZSBzdGF0
dXMgKi8KKyAgICBVU0JfQ0RfU1RBVEVfQ1NXLCAvKiBTZW5kIENvbW1hbmQgU3RhdHVzICovCisg
ICAgVVNCX0NEX1NUQVRFX0RFVklDRV9SRVNFVCwgLyogcmVzZXQgb2YgYSBzaW5nbGUgZGV2aWNl
ICovCisgICAgVVNCX0NEX1NUQVRFX1RBUkdFVF9SRVNFVCAvKiByZXNldCBvZiBlbnRpcmUgdGFy
Z2V0ICovCit9IFVzYkNkU3RhdGU7CisKK3N0cnVjdCBfX2F0dHJpYnV0ZV9fKChfX3BhY2tlZF9f
KSkgVXNiQ2RDQlcgeworICAgIHVpbnQzMl90IHNpZzsKKyAgICB1aW50MzJfdCB0YWc7CisgICAg
dWludDMyX3QgZXhwX2RhdGFfbGVuOyAvKiBleHBlY3RlZCBkYXRhIHhmZXIgbGVuZ3RoIGZvciB0
aGUgcmVxdWVzdCAqLworICAgIHVpbnQ4X3QgZmxhZ3M7CisgICAgdWludDhfdCBsdW47CisgICAg
dWludDhfdCBjbWRfbGVuOyAvKiBhY3R1YWwgbGVuZ3RoIG9mIHRoZSBzY3NpIGNvbW1hbmQgdGhh
dCBmb2xsb3dzICovCisgICAgdWludDhfdCBjbWRbMTZdOyAvKiBzY3NpIGNvbW1hbmQgdG8gcGVy
Zm9ybSAqLworfTsKKworc3RydWN0IF9fYXR0cmlidXRlX18oKF9fcGFja2VkX18pKSBVc2JDZENT
VyB7CisgICAgdWludDMyX3Qgc2lnOworICAgIHVpbnQzMl90IHRhZzsKKyAgICB1aW50MzJfdCBy
ZXNpZHVlOworICAgIHVpbnQ4X3Qgc3RhdHVzOworfTsKKwordHlwZWRlZiBlbnVtIF9Vc2JNc2RT
dGF0dXMgeworICAgIFVTQl9NU0RfU1RBVFVTX0dPT0QgPSAwLAorICAgIFVTQl9NU0RfU1RBVFVT
X0ZBSUxFRCA9IDEsCisgICAgVVNCX01TRF9TVEFUVVNfUEhBU0VfRVJSID0gMiwKK30gVXNiTXNk
U3RhdHVzOworCit0eXBlZGVmIHN0cnVjdCBfVXNiQ2RCdWxrTXNkUmVxdWVzdAoreworICAgIENk
U2NzaVJlcXVlc3Qgc2NzaV9yZXE7CisKKyAgICB1aW50MzJfdCBsdW47CisgICAgdWludDMyX3Qg
dXNiX3RhZzsKKyAgICB1aW50MzJfdCB1c2JfcmVxX2xlbjsgLyogbGVuZ3RoIG9mIGRhdGEgcmVx
dWVzdGVkIGJ5IHVzYiAqLworICAgIHVpbnQzMl90IHNjc2lfaW5fbGVuOyAvKiBsZW5ndGggb2Yg
ZGF0YSByZXR1cm5lZCBieSBzY3NpIGxpbWl0ZWQgYnkgdXNiIHJlcXVlc3QgKi8KKworICAgIHVp
bnQzMl90IHhmZXJfbGVuOyAvKiBsZW5ndGggb2YgZGF0YSB0cmFuc2ZlcmVkIHVudGlsIG5vdyAq
LworICAgIHVpbnQzMl90IGJ1bGtfaW5fbGVuOyAvKiBsZW5ndGggb2YgdGhlIGxhc3QgcG9zdHBv
bmVkIGJ1bGstaW4gcmVxdWVzdCAqLworCisgICAgc3RydWN0IFVzYkNkQ1NXIGNzdzsgLyogdXNi
IHN0YXR1cyBoZWFkZXIgKi8KK30gVXNiQ2RCdWxrTXNkUmVxdWVzdDsKKwordHlwZWRlZiBzdHJ1
Y3QgX1VzYkNkQnVsa01zZERldmljZQoreworICAgIFVzYkNkU3RhdGUgc3RhdGU7CisgICAgdm9p
ZCAqc2NzaV90YXJnZXQ7IC8qIHNjc2kgaGFuZGxlICovCisgICAgdm9pZCAqdXNiX3VzZXJfZGF0
YTsgLyogdXNlZCBpbiBjYWxsYmFja3MgdG8gdXNiICovCisgICAgVXNiQ2RCdWxrTXNkUmVxdWVz
dCB1c2JfcmVxOyAvKiBub3cgc3VwcG9ydGluZyBhIHNpbmdsZSBjbWQgKi8KKyAgICB1aW50OF90
ICpkYXRhX2J1ZjsKKyAgICB1aW50MzJfdCBkYXRhX2J1Zl9sZW47Cit9IFVzYkNkQnVsa01zZERl
dmljZTsKKworc3RhdGljIGlubGluZSBjb25zdCBjaGFyICp1c2JfY2Rfc3RhdGVfc3RyKFVzYkNk
U3RhdGUgc3RhdGUpCit7CisgICAgc3dpdGNoKHN0YXRlKQorICAgIHsKKyAgICBjYXNlIFVTQl9D
RF9TVEFURV9JTklUOgorICAgICAgICByZXR1cm4gIklOSVQiOworICAgIGNhc2UgVVNCX0NEX1NU
QVRFX0NCVzoKKyAgICAgICAgcmV0dXJuICJDQlciOworICAgIGNhc2UgVVNCX0NEX1NUQVRFX0RB
VEFPVVQ6CisgICAgICAgIHJldHVybiAiREFUQU9VVCI7CisgICAgY2FzZSBVU0JfQ0RfU1RBVEVf
REFUQUlOOgorICAgICAgICByZXR1cm4gIkRBVEFJTiI7CisgICAgY2FzZSBVU0JfQ0RfU1RBVEVf
WkVST19EQVRBSU46CisgICAgICAgIHJldHVybiAiWkVST19EQVRBSU4iOworICAgIGNhc2UgVVNC
X0NEX1NUQVRFX0NTVzoKKyAgICAgICAgcmV0dXJuICJDU1ciOworICAgIGNhc2UgVVNCX0NEX1NU
QVRFX0RFVklDRV9SRVNFVDoKKyAgICAgICAgcmV0dXJuICJERVZfUkVTRVQiOworICAgIGNhc2Ug
VVNCX0NEX1NUQVRFX1RBUkdFVF9SRVNFVDoKKyAgICAgICAgcmV0dXJuICJUR1RfUkVTRVQiOwor
ICAgIGRlZmF1bHQ6CisgICAgICAgIHJldHVybiAiSUxMRUdBTCI7CisgICAgfQorfQorCitzdGF0
aWMgdm9pZCBjZF91c2JfYnVsa19tc2Rfc2V0X3N0YXRlKFVzYkNkQnVsa01zZERldmljZSAqY2Qs
IFVzYkNkU3RhdGUgc3RhdGUpCit7CisgICAgU1BJQ0VfREVCVUcoIlN0YXRlICVzIC0+ICVzIiwg
dXNiX2NkX3N0YXRlX3N0cihjZC0+c3RhdGUpLCB1c2JfY2Rfc3RhdGVfc3RyKHN0YXRlKSk7Cisg
ICAgY2QtPnN0YXRlID0gc3RhdGU7Cit9CisKK3ZvaWQgKmNkX3VzYl9idWxrX21zZF9hbGxvYyh2
b2lkICp1c2JfdXNlcl9kYXRhLCB1aW50MzJfdCBtYXhfbHVucykKK3sKKyAgICBVc2JDZEJ1bGtN
c2REZXZpY2UgKmNkOworCisgICAgY2QgPSBnX21hbGxvYzAoc2l6ZW9mKCpjZCkpOworCisgICAg
Y2QtPmRhdGFfYnVmX2xlbiA9IDI1NiAqIDEwMjQ7CisgICAgY2QtPmRhdGFfYnVmID0gZ19tYWxs
b2MoY2QtPmRhdGFfYnVmX2xlbik7CisKKyAgICBjZC0+c2NzaV90YXJnZXQgPSBjZF9zY3NpX3Rh
cmdldF9hbGxvYyhjZCwgbWF4X2x1bnMpOworICAgIGlmIChjZC0+c2NzaV90YXJnZXQgPT0gTlVM
TCkgeworICAgICAgICBnX2ZyZWUoY2QpOworICAgICAgICByZXR1cm4gTlVMTDsKKyAgICB9Cisg
ICAgY2RfdXNiX2J1bGtfbXNkX3NldF9zdGF0ZShjZCwgVVNCX0NEX1NUQVRFX0lOSVQpOworICAg
IGNkLT51c2JfdXNlcl9kYXRhID0gdXNiX3VzZXJfZGF0YTsKKworICAgIFNQSUNFX0RFQlVHKCJB
bGxvYywgbWF4X2x1bnM6JSIgR19HVUlOVDMyX0ZPUk1BVCwgbWF4X2x1bnMpOworICAgIHJldHVy
biBjZDsKK30KKworaW50IGNkX3VzYl9idWxrX21zZF9yZWFsaXplKHZvaWQgKmRldmljZSwgdWlu
dDMyX3QgbHVuLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IENkU2NzaURldmlj
ZVBhcmFtZXRlcnMgKmRldl9wYXJhbXMpCit7CisgICAgVXNiQ2RCdWxrTXNkRGV2aWNlICpjZCA9
IChVc2JDZEJ1bGtNc2REZXZpY2UgKilkZXZpY2U7CisgICAgQ2RTY3NpRGV2aWNlUGFyYW1ldGVy
cyBzY3NpX2Rldl9wYXJhbXM7CisgICAgaW50IHJjOworCisgICAgc2NzaV9kZXZfcGFyYW1zLnZl
bmRvciA9IGRldl9wYXJhbXMtPnZlbmRvciA/IDogIlNQSUNFIjsKKyAgICBzY3NpX2Rldl9wYXJh
bXMucHJvZHVjdCA9IGRldl9wYXJhbXMtPnByb2R1Y3QgPyA6ICJVU0ItQ0QiOworICAgIHNjc2lf
ZGV2X3BhcmFtcy52ZXJzaW9uID0gZGV2X3BhcmFtcy0+dmVyc2lvbiA/IDogIjAuMSI7CisgICAg
c2NzaV9kZXZfcGFyYW1zLnNlcmlhbCA9IGRldl9wYXJhbXMtPnNlcmlhbCA/IDogIjEyMzQ1NiI7
CisKKyAgICByYyA9IGNkX3Njc2lfZGV2X3JlYWxpemUoY2QtPnNjc2lfdGFyZ2V0LCBsdW4sICZz
Y3NpX2Rldl9wYXJhbXMpOworICAgIGlmIChyYyAhPSAwKSB7CisgICAgICAgIFNQSUNFX0VSUk9S
KCJGYWlsZWQgdG8gcmVhbGl6ZSBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCwgbHVuKTsKKyAgICAg
ICAgcmV0dXJuIHJjOworICAgIH0KKworICAgIGlmIChjZC0+c3RhdGUgPT0gVVNCX0NEX1NUQVRF
X0lOSVQpIHsKKyAgICAgICAgY2RfdXNiX2J1bGtfbXNkX3NldF9zdGF0ZShjZCwgVVNCX0NEX1NU
QVRFX0NCVyk7CisgICAgICAgIGNkX3Njc2lfZGV2X3JlcXVlc3RfcmVsZWFzZShjZC0+c2NzaV90
YXJnZXQsICZjZC0+dXNiX3JlcS5zY3NpX3JlcSk7CisgICAgfQorCisgICAgU1BJQ0VfREVCVUco
IlJlYWxpemUgT0sgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQsIGx1bik7CisgICAgcmV0dXJuIDA7
Cit9CisKK2ludCBjZF91c2JfYnVsa19tc2RfbG9jayh2b2lkICpkZXZpY2UsIHVpbnQzMl90IGx1
biwgZ2Jvb2xlYW4gbG9jaykKK3sKKyAgICBVc2JDZEJ1bGtNc2REZXZpY2UgKmNkID0gKFVzYkNk
QnVsa01zZERldmljZSAqKWRldmljZTsKKyAgICBpbnQgcmM7CisKKyAgICByYyA9IGNkX3Njc2lf
ZGV2X2xvY2soY2QtPnNjc2lfdGFyZ2V0LCBsdW4sIGxvY2spOworICAgIGlmIChyYyAhPSAwKSB7
CisgICAgICAgIFNQSUNFX0VSUk9SKCJGYWlsZWQgdG8gbG9jayBsdW46JSIgR19HVUlOVDMyX0ZP
Uk1BVCwgbHVuKTsKKyAgICAgICAgcmV0dXJuIHJjOworICAgIH0KKworICAgIFNQSUNFX0RFQlVH
KCJMb2NrIE9LIGx1bjolIiBHX0dVSU5UMzJfRk9STUFULCBsdW4pOworICAgIHJldHVybiAwOwor
fQorCitpbnQgY2RfdXNiX2J1bGtfbXNkX2xvYWQodm9pZCAqZGV2aWNlLCB1aW50MzJfdCBsdW4s
CisgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgQ2RTY3NpTWVkaWFQYXJhbWV0ZXJzICpt
ZWRpYV9wYXJhbXMpCit7CisgICAgVXNiQ2RCdWxrTXNkRGV2aWNlICpjZCA9IChVc2JDZEJ1bGtN
c2REZXZpY2UgKilkZXZpY2U7CisgICAgaW50IHJjOworCisgICAgcmMgPSBjZF9zY3NpX2Rldl9s
b2FkKGNkLT5zY3NpX3RhcmdldCwgbHVuLCBtZWRpYV9wYXJhbXMpOworICAgIGlmIChyYyAhPSAw
KSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJGYWlsZWQgdG8gbG9hZCBsdW46JSIgR19HVUlOVDMy
X0ZPUk1BVCwgbHVuKTsKKyAgICAgICAgcmV0dXJuIHJjOworICAgIH0KKworICAgIFNQSUNFX0RF
QlVHKCJMb2FkIE9LIGx1bjolIiBHX0dVSU5UMzJfRk9STUFULCBsdW4pOworICAgIHJldHVybiAw
OworfQorCitpbnQgY2RfdXNiX2J1bGtfbXNkX2dldF9pbmZvKHZvaWQgKmRldmljZSwgdWludDMy
X3QgbHVuLCBDZFNjc2lEZXZpY2VJbmZvICpsdW5faW5mbykKK3sKKyAgICBVc2JDZEJ1bGtNc2RE
ZXZpY2UgKmNkID0gKFVzYkNkQnVsa01zZERldmljZSAqKWRldmljZTsKKyAgICBpbnQgcmM7CisK
KyAgICByYyA9IGNkX3Njc2lfZGV2X2dldF9pbmZvKGNkLT5zY3NpX3RhcmdldCwgbHVuLCBsdW5f
aW5mbyk7CisgICAgaWYgKHJjICE9IDApIHsKKyAgICAgICAgU1BJQ0VfRVJST1IoIkZhaWxlZCB0
byBnZXQgaW5mbyBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCwgbHVuKTsKKyAgICAgICAgcmV0dXJu
IHJjOworICAgIH0KKworICAgIHJldHVybiAwOworfQorCitpbnQgY2RfdXNiX2J1bGtfbXNkX3Vu
bG9hZCh2b2lkICpkZXZpY2UsIHVpbnQzMl90IGx1bikKK3sKKyAgICBVc2JDZEJ1bGtNc2REZXZp
Y2UgKmNkID0gKFVzYkNkQnVsa01zZERldmljZSAqKWRldmljZTsKKyAgICBpbnQgcmM7CisKKyAg
ICByYyA9IGNkX3Njc2lfZGV2X3VubG9hZChjZC0+c2NzaV90YXJnZXQsIGx1bik7CisgICAgaWYg
KHJjICE9IDApIHsKKyAgICAgICAgU1BJQ0VfRVJST1IoIkZhaWxlZCB0byB1bmxvYWQgbHVuOiUi
IEdfR1VJTlQzMl9GT1JNQVQsIGx1bik7CisgICAgICAgIHJldHVybiByYzsKKyAgICB9CisKKyAg
ICBTUElDRV9ERUJVRygiVW5sb2FkIE9LIGx1bjolIiBHX0dVSU5UMzJfRk9STUFULCBsdW4pOwor
ICAgIHJldHVybiAwOworfQorCitpbnQgY2RfdXNiX2J1bGtfbXNkX3VucmVhbGl6ZSh2b2lkICpk
ZXZpY2UsIHVpbnQzMl90IGx1bikKK3sKKyAgICBVc2JDZEJ1bGtNc2REZXZpY2UgKmNkID0gKFVz
YkNkQnVsa01zZERldmljZSAqKWRldmljZTsKKyAgICBpbnQgcmM7CisKKyAgICByYyA9IGNkX3Nj
c2lfZGV2X3VucmVhbGl6ZShjZC0+c2NzaV90YXJnZXQsIGx1bik7CisgICAgaWYgKHJjICE9IDAp
IHsKKyAgICAgICAgU1BJQ0VfRVJST1IoIlVucmVhbGl6ZSBsdW46JSIgR19HVUlOVDMyX0ZPUk1B
VCwgbHVuKTsKKyAgICAgICAgcmV0dXJuIHJjOworICAgIH0KKworICAgIFNQSUNFX0RFQlVHKCJV
bnJlYWxpemUgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQsIGx1bik7CisgICAgcmV0dXJuIDA7Cit9
CisKK3ZvaWQgY2RfdXNiX2J1bGtfbXNkX2ZyZWUodm9pZCAqZGV2aWNlKQoreworICAgIFVzYkNk
QnVsa01zZERldmljZSAqY2QgPSAoVXNiQ2RCdWxrTXNkRGV2aWNlICopZGV2aWNlOworCisgICAg
Y2Rfc2NzaV90YXJnZXRfZnJlZShjZC0+c2NzaV90YXJnZXQpOworICAgIGdfZnJlZShjZCk7CisK
KyAgICBTUElDRV9ERUJVRygiRnJlZSIpOworfQorCitpbnQgY2RfdXNiX2J1bGtfbXNkX3Jlc2V0
KHZvaWQgKmRldmljZSkKK3sKKyAgICBVc2JDZEJ1bGtNc2REZXZpY2UgKmNkID0gKFVzYkNkQnVs
a01zZERldmljZSAqKWRldmljZTsKKworICAgIGNkX3Njc2lfdGFyZ2V0X3Jlc2V0KGNkLT5zY3Np
X3RhcmdldCk7CisgICAgY2RfdXNiX2J1bGtfbXNkX3NldF9zdGF0ZShjZCwgVVNCX0NEX1NUQVRF
X0NCVyk7CisKKyAgICBTUElDRV9ERUJVRygiUmVzZXQiKTsKKyAgICByZXR1cm4gMDsKK30KKwor
c3RhdGljIGludCBwYXJzZV91c2JfbXNkX2NtZChVc2JDZEJ1bGtNc2REZXZpY2UgKmNkLCB1aW50
OF90ICpidWYsIHVpbnQzMl90IGNid19sZW4pCit7CisgICAgc3RydWN0IFVzYkNkQ0JXICpjYncg
PSAoc3RydWN0IFVzYkNkQ0JXICopYnVmOworICAgIFVzYkNkQnVsa01zZFJlcXVlc3QgKnVzYl9y
ZXEgPSAmY2QtPnVzYl9yZXE7CisgICAgQ2RTY3NpUmVxdWVzdCAqc2NzaV9yZXEgPSAmdXNiX3Jl
cS0+c2NzaV9yZXE7CisKKyAgICBpZiAoY2J3X2xlbiAhPSAzMSkgeworICAgICAgICBTUElDRV9F
UlJPUigiQ01EOiBCYWQgQ0JXIHNpemU6JSIgR19HVUlOVDMyX0ZPUk1BVCwgY2J3X2xlbik7Cisg
ICAgICAgIHJldHVybiAtMTsKKyAgICB9CisgICAgaWYgKGxlMzJ0b2goY2J3LT5zaWcpICE9IDB4
NDM0MjUzNTUpIHsgLyogTVNEIGNvbW1hbmQgc2lnbmF0dXJlICovCisgICAgICAgIFNQSUNFX0VS
Uk9SKCJDTUQ6IEJhZCBDQlcgc2lnbmF0dXJlOiUwOHgiLCBsZTMydG9oKGNidy0+c2lnKSk7Cisg
ICAgICAgIHJldHVybiAtMTsKKyAgICB9CisKKyAgICB1c2JfcmVxLT5sdW4gPSBjYnctPmx1bjsK
KyAgICB1c2JfcmVxLT51c2JfdGFnID0gbGUzMnRvaChjYnctPnRhZyk7CisgICAgdXNiX3JlcS0+
dXNiX3JlcV9sZW4gPSBsZTMydG9oKGNidy0+ZXhwX2RhdGFfbGVuKTsKKworICAgIHVzYl9yZXEt
PnNjc2lfaW5fbGVuID0gMDsgLyogbm8gZGF0YSBmcm9tIHNjc2kgeWV0ICovCisgICAgdXNiX3Jl
cS0+eGZlcl9sZW4gPSAwOyAvKiBubyBidWxrcyB0cmFuc2ZlcmVkIHlldCAqLworICAgIHVzYl9y
ZXEtPmJ1bGtfaW5fbGVuID0gMDsgLyogbm8gYnVsay1pbiByZXF1ZXN0cyB5ZXQgKi8KKworICAg
IGlmICh1c2JfcmVxLT51c2JfcmVxX2xlbiA9PSAwKSB7CisgICAgICAgIGNkX3VzYl9idWxrX21z
ZF9zZXRfc3RhdGUoY2QsIFVTQl9DRF9TVEFURV9DU1cpOyAvKiBubyBkYXRhIC0gcmV0dXJuIHN0
YXR1cyAqLworICAgICAgICBzY3NpX3JlcS0+YnVmID0gTlVMTDsKKyAgICAgICAgc2NzaV9yZXEt
PmJ1Zl9sZW4gPSAwOworICAgIH0gZWxzZSBpZiAoY2J3LT5mbGFncyAmIDB4ODApIHsKKyAgICAg
ICAgY2RfdXNiX2J1bGtfbXNkX3NldF9zdGF0ZShjZCwgVVNCX0NEX1NUQVRFX0RBVEFJTik7IC8q
IHJlYWQgY29tbWFuZCAqLworICAgICAgICBzY3NpX3JlcS0+YnVmID0gY2QtPmRhdGFfYnVmOwor
ICAgICAgICBzY3NpX3JlcS0+YnVmX2xlbiA9IGNkLT5kYXRhX2J1Zl9sZW47CisgICAgfSBlbHNl
IHsKKyAgICAgICAgY2RfdXNiX2J1bGtfbXNkX3NldF9zdGF0ZShjZCwgVVNCX0NEX1NUQVRFX0RB
VEFPVVQpOyAvKiB3cml0ZSBjb21tYW5kICovCisgICAgICAgIHNjc2lfcmVxLT5idWYgPSBOVUxM
OworICAgICAgICBzY3NpX3JlcS0+YnVmX2xlbiA9IDA7CisgICAgfQorCisgICAgc2NzaV9yZXEt
PmNkYl9sZW4gPSAoKHVpbnQzMl90KWNidy0+Y21kX2xlbikgJiAweDFGOworICAgIGdfYXNzZXJ0
KHNjc2lfcmVxLT5jZGJfbGVuIDw9IHNpemVvZihzY3NpX3JlcS0+Y2RiKSk7CisgICAgbWVtY3B5
KHNjc2lfcmVxLT5jZGIsIGNidy0+Y21kLCBzY3NpX3JlcS0+Y2RiX2xlbik7CisKKyAgICBzY3Np
X3JlcS0+dGFnID0gdXNiX3JlcS0+dXNiX3RhZzsKKyAgICBzY3NpX3JlcS0+bHVuID0gdXNiX3Jl
cS0+bHVuOworCisgICAgU1BJQ0VfREVCVUcoIkNNRCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCAi
IHRhZzoweCV4IGZsYWdzOiUwOHggIgorICAgICAgICAiY2RiX2xlbjolIiBHX0dVSU5UMzJfRk9S
TUFUICIgcmVxX2xlbjolIiBHX0dVSU5UMzJfRk9STUFULAorICAgICAgICB1c2JfcmVxLT5sdW4s
IHVzYl9yZXEtPnVzYl90YWcsIGNidy0+ZmxhZ3MsCisgICAgICAgIHNjc2lfcmVxLT5jZGJfbGVu
LCB1c2JfcmVxLT51c2JfcmVxX2xlbik7CisKKyAgICAvKiBwcmVwYXJlIHN0YXR1cyAtIENTVyAq
LworICAgIHVzYl9yZXEtPmNzdy5zaWcgPSBodG9sZTMyKDB4NTM0MjUzNTUpOworICAgIHVzYl9y
ZXEtPmNzdy50YWcgPSBjYnctPnRhZzsKKyAgICB1c2JfcmVxLT5jc3cucmVzaWR1ZSA9IDA7Cisg
ICAgdXNiX3JlcS0+Y3N3LnN0YXR1cyA9ICh1aW50OF90KVVTQl9NU0RfU1RBVFVTX0dPT0Q7CisK
KyAgICByZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQgdXNiX2NkX2NtZF9kb25lKFVzYkNkQnVs
a01zZERldmljZSAqY2QpCit7CisgICAgVXNiQ2RCdWxrTXNkUmVxdWVzdCAqdXNiX3JlcSA9ICZj
ZC0+dXNiX3JlcTsKKyAgICBDZFNjc2lSZXF1ZXN0ICpzY3NpX3JlcSA9ICZ1c2JfcmVxLT5zY3Np
X3JlcTsKKworICAgIGNkX3VzYl9idWxrX21zZF9zZXRfc3RhdGUoY2QsIFVTQl9DRF9TVEFURV9D
QlcpOyAvKiBDb21tYW5kIG5leHQgKi8KKyAgICBjZF9zY3NpX2Rldl9yZXF1ZXN0X3JlbGVhc2Uo
Y2QtPnNjc2lfdGFyZ2V0LCBzY3NpX3JlcSk7Cit9CisKK3N0YXRpYyB2b2lkIHVzYl9jZF9zZW5k
X3N0YXR1cyhVc2JDZEJ1bGtNc2REZXZpY2UgKmNkKQoreworICAgIFVzYkNkQnVsa01zZFJlcXVl
c3QgKnVzYl9yZXEgPSAmY2QtPnVzYl9yZXE7CisKKyAgICBTUElDRV9ERUJVRygiQ29tbWFuZCBD
U1cgdGFnOjB4JXggbXNkX3N0YXR1czolZCBsZW46JSIgR19HVUlOVDY0X0ZPUk1BVCwKKyAgICAg
ICAgICAgICAgICBsZTMydG9oKHVzYl9yZXEtPmNzdy50YWcpLCAoaW50KXVzYl9yZXEtPmNzdy5z
dGF0dXMsIHNpemVvZih1c2JfcmVxLT5jc3cpKTsKKworICAgIHVzYl9jZF9jbWRfZG9uZShjZCk7
CisKKyAgICBnX2Fzc2VydCh1c2JfcmVxLT5jc3cuc2lnID09IGh0b2xlMzIoMHg1MzQyNTM1NSkp
OworICAgIGNkX3VzYl9idWxrX21zZF9yZWFkX2NvbXBsZXRlKGNkLT51c2JfdXNlcl9kYXRhLAor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICh1aW50OF90ICopJnVzYl9yZXEtPmNz
dywgc2l6ZW9mKHVzYl9yZXEtPmNzdyksCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgQlVMS19TVEFUVVNfR09PRCk7Cit9CisKK3N0YXRpYyB2b2lkIHVzYl9jZF9zZW5kX2NhbmNl
bGVkKFVzYkNkQnVsa01zZERldmljZSAqY2QpCit7CisgICAgVXNiQ2RCdWxrTXNkUmVxdWVzdCAq
dXNiX3JlcSA9ICZjZC0+dXNiX3JlcTsKKworICAgIFNQSUNFX0RFQlVHKCJDYW5jZWxlZCBjbWQg
dGFnOjB4JXgsIGxlbjolIiBHX0dVSU5UNjRfRk9STUFULAorICAgICAgICAgICAgICAgIGxlMzJ0
b2godXNiX3JlcS0+Y3N3LnRhZyksIHNpemVvZih1c2JfcmVxLT5jc3cpKTsKKworICAgIHVzYl9j
ZF9jbWRfZG9uZShjZCk7CisKKyAgICBjZF91c2JfYnVsa19tc2RfcmVhZF9jb21wbGV0ZShjZC0+
dXNiX3VzZXJfZGF0YSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOVUxMLCAw
LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEJVTEtfU1RBVFVTX0NBTkNFTEVE
KTsKK30KKworc3RhdGljIHZvaWQgdXNiX2NkX3NlbmRfZGF0YV9pbihVc2JDZEJ1bGtNc2REZXZp
Y2UgKmNkLCB1aW50MzJfdCBtYXhfbGVuKQoreworICAgIFVzYkNkQnVsa01zZFJlcXVlc3QgKnVz
Yl9yZXEgPSAmY2QtPnVzYl9yZXE7CisgICAgQ2RTY3NpUmVxdWVzdCAqc2NzaV9yZXEgPSAmdXNi
X3JlcS0+c2NzaV9yZXE7CisgICAgdWludDhfdCAqYnVmID0gKCh1aW50OF90ICopc2NzaV9yZXEt
PmJ1ZikgKyB1c2JfcmVxLT54ZmVyX2xlbjsKKyAgICB1aW50MzJfdCBhdmFpbF9sZW4gPSB1c2Jf
cmVxLT5zY3NpX2luX2xlbiAtIHVzYl9yZXEtPnhmZXJfbGVuOworICAgIHVpbnQzMl90IHNlbmRf
bGVuID0gKGF2YWlsX2xlbiA8PSBtYXhfbGVuKSA/IGF2YWlsX2xlbiA6IG1heF9sZW47CisKKyAg
ICBTUElDRV9ERUJVRygiRGF0YS1pbiBjbWQgdGFnIDB4JXgsIHJlbWFpbnMgJSIgR19HVUlOVDMy
X0ZPUk1BVAorICAgICAgICAgICAgICAgICIsIHJlcXVlc3RlZCAlIiBHX0dVSU5UMzJfRk9STUFU
ICIsIHNlbmQgJSIgR19HVUlOVDMyX0ZPUk1BVCwKKyAgICAgICAgICAgICAgICB1c2JfcmVxLT5j
c3cudGFnLCBhdmFpbF9sZW4sIG1heF9sZW4sIHNlbmRfbGVuKTsKKworICAgIGdfYXNzZXJ0KG1h
eF9sZW4gPD0gdXNiX3JlcS0+dXNiX3JlcV9sZW4pOworCisgICAgY2RfdXNiX2J1bGtfbXNkX3Jl
YWRfY29tcGxldGUoY2QtPnVzYl91c2VyX2RhdGEsCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgYnVmLCBzZW5kX2xlbiwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBCVUxLX1NUQVRVU19HT09EKTsKKworICAgIGlmIChzY3NpX3JlcS0+c3RhdHVzID09IEdPT0Qp
IHsKKyAgICAgICAgdXNiX3JlcS0+eGZlcl9sZW4gKz0gc2VuZF9sZW47CisgICAgICAgIGlmICh1
c2JfcmVxLT54ZmVyX2xlbiA9PSB1c2JfcmVxLT5zY3NpX2luX2xlbikgeworICAgICAgICAgICAg
LyogYWxsIGRhdGEgZm9yIHRoaXMgYnVsayBoYXMgYmVlbiB0cmFuc2ZlcnJlZCAqLworICAgICAg
ICAgICAgaWYgKHVzYl9yZXEtPnNjc2lfaW5fbGVuID09IHVzYl9yZXEtPnVzYl9yZXFfbGVuIHx8
IC8qIHJlcSBmdWxseSBzYXRpc2ZpbGVkICovCisgICAgICAgICAgICAgICAgc2VuZF9sZW4gPCBt
YXhfbGVuKSB7IC8qIHBhcnRpYWwgYnVsayAtIG5vIG1vcmUgZGF0YSAqLworICAgICAgICAgICAg
ICAgIGNkX3VzYl9idWxrX21zZF9zZXRfc3RhdGUoY2QsIFVTQl9DRF9TVEFURV9DU1cpOworICAg
ICAgICAgICAgfSBlbHNlIHsKKyAgICAgICAgICAgICAgICAvKiBwYXJ0aWFsIGNtZCBkYXRhIGZ1
bGxmaWxsZWQgZW50aXJlIHZ1bGstaW4gcmVxdWVzdCAqLworICAgICAgICAgICAgICAgIGNkX3Vz
Yl9idWxrX21zZF9zZXRfc3RhdGUoY2QsIFVTQl9DRF9TVEFURV9aRVJPX0RBVEFJTik7CisgICAg
ICAgICAgICB9CisgICAgICAgIH0KKyAgICB9IGVsc2UgeyAvKiBjbWQgZmFpbGVkIC0gbm8gbW9y
ZSBkYXRhICovCisgICAgICAgIGNkX3VzYl9idWxrX21zZF9zZXRfc3RhdGUoY2QsIFVTQl9DRF9T
VEFURV9DU1cpOworICAgIH0KK30KKworaW50IGNkX3VzYl9idWxrX21zZF9yZWFkKHZvaWQgKmRl
dmljZSwgdWludDMyX3QgbWF4X2xlbikKK3sKKyAgICBVc2JDZEJ1bGtNc2REZXZpY2UgKmNkID0g
KFVzYkNkQnVsa01zZERldmljZSAqKWRldmljZTsKKyAgICBVc2JDZEJ1bGtNc2RSZXF1ZXN0ICp1
c2JfcmVxID0gJmNkLT51c2JfcmVxOworICAgIENkU2NzaVJlcXVlc3QgKnNjc2lfcmVxID0gJnVz
Yl9yZXEtPnNjc2lfcmVxOworCisgICAgU1BJQ0VfREVCVUcoIm1zZF9yZWFkLCBzdGF0ZTogJXMs
IGxlbiAlIiBHX0dVSU5UMzJfRk9STUFULAorICAgICAgICAgICAgICAgIHVzYl9jZF9zdGF0ZV9z
dHIoY2QtPnN0YXRlKSwgbWF4X2xlbik7CisKKyAgICBzd2l0Y2ggKGNkLT5zdGF0ZSkgeworICAg
IGNhc2UgVVNCX0NEX1NUQVRFX0NTVzogLyogQ29tbWFuZCBTdGF0dXMgKi8KKyAgICAgICAgaWYg
KG1heF9sZW4gPCAxMykgeworICAgICAgICAgICAgZ290byBmYWlsOworICAgICAgICB9CisgICAg
ICAgIGlmIChjZF9zY3NpX2dldF9yZXFfc3RhdGUoc2NzaV9yZXEpID09IFNDU0lfUkVRX0NPTVBM
RVRFKSB7CisgICAgICAgICAgICB1c2JfY2Rfc2VuZF9zdGF0dXMoY2QpOworICAgICAgICB9IGVs
c2UgeworICAgICAgICAgICAgdXNiX3JlcS0+YnVsa19pbl9sZW4gKz0gbWF4X2xlbjsKKyAgICAg
ICAgICAgIFNQSUNFX0RFQlVHKCJtc2RfcmVhZCBDU1csIHJlcSBpbmNvbXBsZXRlLCBhZGRlZCBs
ZW4gJSIgR19HVUlOVDMyX0ZPUk1BVAorICAgICAgICAgICAgICAgICAgICAgICAgIiBzYXZlZCBs
ZW4gJSIgR19HVUlOVDMyX0ZPUk1BVCwKKyAgICAgICAgICAgICAgICAgICAgICAgIG1heF9sZW4s
IHVzYl9yZXEtPmJ1bGtfaW5fbGVuKTsKKyAgICAgICAgfQorICAgICAgICBicmVhazsKKworICAg
IGNhc2UgVVNCX0NEX1NUQVRFX0RBVEFJTjogLyogQnVsayBEYXRhLUlOICovCisgICAgICAgIGlm
IChjZF9zY3NpX2dldF9yZXFfc3RhdGUoc2NzaV9yZXEpID09IFNDU0lfUkVRX0NPTVBMRVRFKSB7
CisgICAgICAgICAgICB1c2JfY2Rfc2VuZF9kYXRhX2luKGNkLCBtYXhfbGVuKTsKKyAgICAgICAg
fSBlbHNlIHsKKyAgICAgICAgICAgIHVzYl9yZXEtPmJ1bGtfaW5fbGVuICs9IG1heF9sZW47Cisg
ICAgICAgICAgICBTUElDRV9ERUJVRygibXNkX3JlYWQgREFUQUlOLCByZXEgaW5jb21wbGV0ZSwg
YWRkZWQgbGVuICUiIEdfR1VJTlQzMl9GT1JNQVQKKyAgICAgICAgICAgICAgICAgICAgICAgICIg
c2F2ZWQgbGVuICUiIEdfR1VJTlQzMl9GT1JNQVQsCisgICAgICAgICAgICAgICAgICAgICAgICBt
YXhfbGVuLCB1c2JfcmVxLT5idWxrX2luX2xlbik7CisgICAgICAgIH0KKyAgICAgICAgYnJlYWs7
CisKKyAgICBjYXNlIFVTQl9DRF9TVEFURV9aRVJPX0RBVEFJTjoKKyAgICAgICAgY2RfdXNiX2J1
bGtfbXNkX3JlYWRfY29tcGxldGUoY2QtPnVzYl91c2VyX2RhdGEsCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIE5VTEwsIDAsCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIEJVTEtfU1RBVFVTX0dPT0QpOworICAgICAgICBjZF91c2JfYnVsa19tc2Rf
c2V0X3N0YXRlKGNkLCBVU0JfQ0RfU1RBVEVfQ1NXKTsgLyogU3RhdHVzIG5leHQgKi8KKyAgICAg
ICAgYnJlYWs7CisKKyAgICBkZWZhdWx0OgorICAgICAgICBTUElDRV9FUlJPUigiVW5leHBlY3Rl
ZCByZWFkIHN0YXRlOiAlcywgbGVuICUiIEdfR1VJTlQzMl9GT1JNQVQsCisgICAgICAgICAgICAg
ICAgICAgIHVzYl9jZF9zdGF0ZV9zdHIoY2QtPnN0YXRlKSwgbWF4X2xlbik7CisgICAgICAgIGdv
dG8gZmFpbDsKKyAgICB9CisgICAgcmV0dXJuIDA7CisKK2ZhaWw6CisgICAgcmV0dXJuIC0xOwor
fQorCit2b2lkIGNkX3Njc2lfZGV2X3JlcXVlc3RfY29tcGxldGUodm9pZCAqdGFyZ2V0X3VzZXJf
ZGF0YSwgQ2RTY3NpUmVxdWVzdCAqc2NzaV9yZXEpCit7CisgICAgVXNiQ2RCdWxrTXNkRGV2aWNl
ICpjZCA9IChVc2JDZEJ1bGtNc2REZXZpY2UgKil0YXJnZXRfdXNlcl9kYXRhOworICAgIFVzYkNk
QnVsa01zZFJlcXVlc3QgKnVzYl9yZXEgPSAmY2QtPnVzYl9yZXE7CisKKyAgICBnX2Fzc2VydChz
Y3NpX3JlcSA9PSAmdXNiX3JlcS0+c2NzaV9yZXEpOworCisgICAgaWYgKHNjc2lfcmVxLT5yZXFf
c3RhdGUgPT0gU0NTSV9SRVFfQ09NUExFVEUpIHsKKworICAgICAgICB1c2JfcmVxLT5zY3NpX2lu
X2xlbiA9IChzY3NpX3JlcS0+aW5fbGVuIDw9IHVzYl9yZXEtPnVzYl9yZXFfbGVuKSA/CisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjc2lfcmVxLT5pbl9sZW4gOiB1c2JfcmVxLT51
c2JfcmVxX2xlbjsKKworICAgICAgICAvKiBwcmVwYXJlIENTVyAqLworICAgICAgICBpZiAodXNi
X3JlcS0+dXNiX3JlcV9sZW4gPiB1c2JfcmVxLT5zY3NpX2luX2xlbikgeworICAgICAgICAgICAg
dXNiX3JlcS0+Y3N3LnJlc2lkdWUgPSBodG9sZTMyKHVzYl9yZXEtPnVzYl9yZXFfbGVuIC0gdXNi
X3JlcS0+c2NzaV9pbl9sZW4pOworICAgICAgICB9CisgICAgICAgIGlmIChzY3NpX3JlcS0+c3Rh
dHVzICE9IEdPT0QpIHsKKyAgICAgICAgICAgIHVzYl9yZXEtPmNzdy5zdGF0dXMgPSAodWludDhf
dClVU0JfTVNEX1NUQVRVU19GQUlMRUQ7CisgICAgICAgIH0KKworICAgICAgICBpZiAodXNiX3Jl
cS0+YnVsa19pbl9sZW4pIHsKKyAgICAgICAgICAgIC8qIGJ1bGstaW4gcmVxdWVzdCBhcnJpdmVk
IHdoaWxlIHNjc2kgd2FzIHN0aWxsIHJ1bm5pbmcgKi8KKyAgICAgICAgICAgIGlmIChjZC0+c3Rh
dGUgPT0gVVNCX0NEX1NUQVRFX0RBVEFJTikgeworICAgICAgICAgICAgICAgIHVzYl9jZF9zZW5k
X2RhdGFfaW4oY2QsIHVzYl9yZXEtPmJ1bGtfaW5fbGVuKTsKKyAgICAgICAgICAgIH0gZWxzZSBp
ZiAoY2QtPnN0YXRlID09IFVTQl9DRF9TVEFURV9DU1cpIHsKKyAgICAgICAgICAgICAgICB1c2Jf
Y2Rfc2VuZF9zdGF0dXMoY2QpOworICAgICAgICAgICAgfQorICAgICAgICAgICAgdXNiX3JlcS0+
YnVsa19pbl9sZW4gPSAwOworICAgICAgICB9CisgICAgfSBlbHNlIGlmIChzY3NpX3JlcS0+cmVx
X3N0YXRlID09IFNDU0lfUkVRX0NBTkNFTEVEKSB7CisgICAgICAgIHVzYl9jZF9zZW5kX2NhbmNl
bGVkKGNkKTsKKyAgICB9IGVsc2UgeworICAgICAgICBnX2Fzc2VydChzY3NpX3JlcS0+cmVxX3N0
YXRlID09IFNDU0lfUkVRX0RJU1BPU0VEKTsKKyAgICAgICAgU1BJQ0VfREVCVUcoIkRpc3Bvc2Vk
IGNtZCB0YWc6MHgleCwgbGVuOiUiIEdfR1VJTlQ2NF9GT1JNQVQsCisgICAgICAgICAgICAgICAg
bGUzMnRvaCh1c2JfcmVxLT5jc3cudGFnKSwgc2l6ZW9mKHVzYl9yZXEtPmNzdykpOworICAgICAg
ICB1c2JfY2RfY21kX2RvbmUoY2QpOworICAgIH0KK30KKworaW50IGNkX3VzYl9idWxrX21zZF9j
YW5jZWxfcmVhZCh2b2lkICpkZXZpY2UpCit7CisgICAgVXNiQ2RCdWxrTXNkRGV2aWNlICpjZCA9
IChVc2JDZEJ1bGtNc2REZXZpY2UgKilkZXZpY2U7CisgICAgVXNiQ2RCdWxrTXNkUmVxdWVzdCAq
dXNiX3JlcSA9ICZjZC0+dXNiX3JlcTsKKyAgICBDZFNjc2lSZXF1ZXN0ICpzY3NpX3JlcSA9ICZ1
c2JfcmVxLT5zY3NpX3JlcTsKKworICAgIGNkX3Njc2lfZGV2X3JlcXVlc3RfY2FuY2VsKGNkLT5z
Y3NpX3RhcmdldCwgc2NzaV9yZXEpOworICAgIHJldHVybiAwOworfQorCitpbnQgY2RfdXNiX2J1
bGtfbXNkX3dyaXRlKHZvaWQgKmRldmljZSwgdWludDhfdCAqYnVmX291dCwgdWludDMyX3QgYnVm
X291dF9sZW4pCit7CisgICAgVXNiQ2RCdWxrTXNkRGV2aWNlICpjZCA9IChVc2JDZEJ1bGtNc2RE
ZXZpY2UgKilkZXZpY2U7CisKKyAgICBzd2l0Y2ggKGNkLT5zdGF0ZSkgeworICAgIGNhc2UgVVNC
X0NEX1NUQVRFX0NCVzogLyogQ29tbWFuZCBCbG9jayAqLworICAgICAgICBwYXJzZV91c2JfbXNk
X2NtZChjZCwgYnVmX291dCwgYnVmX291dF9sZW4pOworICAgICAgICBpZiAoY2QtPnN0YXRlID09
IFVTQl9DRF9TVEFURV9EQVRBSU4gfHwgY2QtPnN0YXRlID09IFVTQl9DRF9TVEFURV9DU1cpIHsK
KyAgICAgICAgICAgIGNkX3Njc2lfZGV2X3JlcXVlc3Rfc3VibWl0KGNkLT5zY3NpX3RhcmdldCwg
JmNkLT51c2JfcmVxLnNjc2lfcmVxKTsKKyAgICAgICAgfQorICAgICAgICBicmVhazsKKyAgICBj
YXNlIFVTQl9DRF9TVEFURV9EQVRBT1VUOiAvKiBEYXRhLU91dCBmb3IgYSBXcml0ZSBjbWQgKi8K
KyAgICAgICAgY2QtPnVzYl9yZXEuc2NzaV9yZXEuYnVmID0gYnVmX291dDsKKyAgICAgICAgY2Qt
PnVzYl9yZXEuc2NzaV9yZXEuYnVmX2xlbiA9IGJ1Zl9vdXRfbGVuOworICAgICAgICBjZF9zY3Np
X2Rldl9yZXF1ZXN0X3N1Ym1pdChjZC0+c2NzaV90YXJnZXQsICZjZC0+dXNiX3JlcS5zY3NpX3Jl
cSk7CisgICAgICAgIGNkX3VzYl9idWxrX21zZF9zZXRfc3RhdGUoY2QsIFVTQl9DRF9TVEFURV9D
U1cpOyAvKiBTdGF0dXMgbmV4dCAqLworICAgICAgICBicmVhazsKKyAgICBkZWZhdWx0OgorICAg
ICAgICBTUElDRV9ERUJVRygiVW5leHBlY3RlZCB3cml0ZSBzdGF0ZTogJXMsIGxlbiAlIiBHX0dV
SU5UMzJfRk9STUFULAorICAgICAgICAgICAgICAgICAgICB1c2JfY2Rfc3RhdGVfc3RyKGNkLT5z
dGF0ZSksIGJ1Zl9vdXRfbGVuKTsKKyAgICAgICAgZ290byBmYWlsOworICAgIH0KKyAgICByZXR1
cm4gMDsKKworZmFpbDoKKyAgICByZXR1cm4gLTE7Cit9CisKK3ZvaWQgY2Rfc2NzaV9kZXZfcmVz
ZXRfY29tcGxldGUodm9pZCAqdGFyZ2V0X3VzZXJfZGF0YSwgdWludDMyX3QgbHVuKQoreworICAg
IFVzYkNkQnVsa01zZERldmljZSAqY2QgPSAoVXNiQ2RCdWxrTXNkRGV2aWNlICopdGFyZ2V0X3Vz
ZXJfZGF0YTsKKworICAgIGlmIChjZC0+c3RhdGUgPT0gVVNCX0NEX1NUQVRFX0RFVklDRV9SRVNF
VCkgeworICAgICAgICBjZF91c2JfYnVsa19tc2Rfc2V0X3N0YXRlKGNkLCBVU0JfQ0RfU1RBVEVf
Q0JXKTsKKyAgICAgICAgY2RfdXNiX2J1bGtfbXNkX3Jlc2V0X2NvbXBsZXRlKGNkLT51c2JfdXNl
cl9kYXRhLCAwKTsKKyAgICB9Cit9CisKK3ZvaWQgY2Rfc2NzaV90YXJnZXRfcmVzZXRfY29tcGxl
dGUodm9pZCAqdGFyZ2V0X3VzZXJfZGF0YSkKK3sKKyAgICBVc2JDZEJ1bGtNc2REZXZpY2UgKmNk
ID0gKFVzYkNkQnVsa01zZERldmljZSAqKXRhcmdldF91c2VyX2RhdGE7CisgICAgY2RfdXNiX2J1
bGtfbXNkX3NldF9zdGF0ZShjZCwgVVNCX0NEX1NUQVRFX0lOSVQpOworfQorCit2b2lkIGNkX3Nj
c2lfZGV2X2NoYW5nZWQodm9pZCAqdGFyZ2V0X3VzZXJfZGF0YSwgdWludDMyX3QgbHVuKQorewor
ICAgIFVzYkNkQnVsa01zZERldmljZSAqY2QgPSAoVXNiQ2RCdWxrTXNkRGV2aWNlICopdGFyZ2V0
X3VzZXJfZGF0YTsKKyAgICBTUElDRV9ERUJVRygiRGV2aWNlIGNoYW5nZWQsIHN0YXRlOiAlcyBs
dW46ICUiIEdfR1VJTlQzMl9GT1JNQVQsCisgICAgICAgICAgICAgICAgdXNiX2NkX3N0YXRlX3N0
cihjZC0+c3RhdGUpLCBsdW4pOworICAgIGNkX3VzYl9idWxrX21zZF9sdW5fY2hhbmdlZChjZC0+
dXNiX3VzZXJfZGF0YSwgbHVuKTsKK30KKworI2VuZGlmIC8qIFVTRV9VU0JSRURJUiAqLwpkaWZm
IC0tZ2l0IGEvc3JjL2NkLXVzYi1idWxrLW1zZC5oIGIvc3JjL2NkLXVzYi1idWxrLW1zZC5oCm5l
dyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwLi4xMDk4YTg3OQotLS0gL2Rldi9udWxs
CisrKyBiL3NyYy9jZC11c2ItYnVsay1tc2QuaApAQCAtMCwwICsxLDEzNCBAQAorLyogLSotIE1v
ZGU6IEM7IGMtYmFzaWMtb2Zmc2V0OiA0OyBpbmRlbnQtdGFicy1tb2RlOiBuaWwgLSotICovCisv
KgorICAgIENvcHlyaWdodCAoQykgMjAxOCBSZWQgSGF0LCBJbmMuCisKKyAgICBSZWQgSGF0IEF1
dGhvcnM6CisgICAgQWxleGFuZGVyIE5lemhpbnNreTxhbmV6aGluc0ByZWRoYXQuY29tPgorCisg
ICAgVGhpcyBsaWJyYXJ5IGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0
IGFuZC9vcgorICAgIG1vZGlmeSBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBMZXNzZXIg
R2VuZXJhbCBQdWJsaWMKKyAgICBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0
d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIKKyAgICB2ZXJzaW9uIDIuMSBvZiB0aGUgTGljZW5zZSwg
b3IgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4KKworICAgIFRoaXMgbGlicmFy
eSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAorICAg
IGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJh
bnR5IG9mCisgICAgTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQ
VVJQT1NFLiAgU2VlIHRoZSBHTlUKKyAgICBMZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBm
b3IgbW9yZSBkZXRhaWxzLgorCisgICAgWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBv
ZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYworICAgIExpY2Vuc2UgYWxvbmcgd2l0aCB0
aGlzIGxpYnJhcnk7IGlmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4K
KyovCisKKyNpZm5kZWYgX19DRF9VU0JfQlVMS19NU0RfSF9fCisjZGVmaW5lIF9fQ0RfVVNCX0JV
TEtfTVNEX0hfXworCitHX0JFR0lOX0RFQ0xTCisKKyNpbmNsdWRlIDxnaW8vZ2lvLmg+CisKKyNp
bmNsdWRlICJjZC1zY3NpLWRldi1wYXJhbXMuaCIKKwordHlwZWRlZiBlbnVtIF9DZFVzYkJ1bGtT
dGF0dXMKK3sKKyAgICBCVUxLX1NUQVRVU19HT09EID0gMCwKKyAgICBCVUxLX1NUQVRVU19FUlJP
UiwKKyAgICBCVUxLX1NUQVRVU19DQU5DRUxFRCwKKyAgICBCVUxLX1NUQVRVU19TVEFMTCwKK30g
Q2RVc2JCdWxrU3RhdHVzOworCisvKiBVU0IgYmFja2VuZCBjYWxsYmFja3MgKi8KKworLyogY2Fs
bGVkIG9uIGNvbXBsZXRlZCByZWFkIGRhdGEgYnVsayB0cmFuc2ZlcgorICAgdXNlcl9kYXRhIC0g
dXNlcl9kYXRhIGluIHVuaXQgcGFyYW1ldGVycyBzdHJ1Y3R1cmUKKyAgIHN0YXR1cyAtIGJ1bGsg
c3RhdHVzIGNvZGUKKyovCit2b2lkIGNkX3VzYl9idWxrX21zZF9yZWFkX2NvbXBsZXRlKHZvaWQg
KnVzZXJfZGF0YSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDhfdCAq
ZGF0YSwgdWludDMyX3QgbGVuZ3RoLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBDZFVzYkJ1bGtTdGF0dXMgc3RhdHVzKTsKKworLyogY2FsbGVkIHdoZW4gc3RhdGUgb2YgZGV2
aWNlJ3MgdW5pdCBjaGFuZ2VkIHRvIHNpZ25hbCBHVUkgY29tcG9uZW50CisgICB1c2VyX2RhdGEg
LSB1c2VyX2RhdGEgaW4gdW5pdCBwYXJhbWV0ZXJzIHN0cnVjdHVyZQorKi8KK3ZvaWQgY2RfdXNi
X2J1bGtfbXNkX2x1bl9jaGFuZ2VkKHZvaWQgKnVzZXJfZGF0YSwgdWludDMyX3QgbHVuKTsKKwor
LyogY2FsbGVkIG9uIGNvbXBsZXRlZCBkZXZpY2UgcmVzZXQKKyAgIHVzZXJfZGF0YSAtIHVzZXJf
ZGF0YSBpbiB1bml0IHBhcmFtZXRlcnMgc3RydWN0dXJlCisgICBzdGF0dXMgLSBlcnJvciBjb2Rl
CisqLwordm9pZCBjZF91c2JfYnVsa19tc2RfcmVzZXRfY29tcGxldGUodm9pZCAqdXNlcl9kYXRh
LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IHN0YXR1cyk7CisKKy8q
IE1TRCBiYWNrZW5kIGFwaSAqLworCisvKiBhbGxvY2F0ZSBuZXcgZGV2aWNlIGRlc2NyaXB0b3Ig
Ki8KK3ZvaWQgKmNkX3VzYl9idWxrX21zZF9hbGxvYyh2b2lkICp1c2VyX2RhdGEsIHVpbnQzMl90
IG1heF9sdW4pOworCisvKiBmcmVlIGRldmljZSBkZXNjcmlwdG9yICovCit2b2lkIGNkX3VzYl9i
dWxrX21zZF9mcmVlKHZvaWQgKmRldmljZSk7CisKKy8qIGNvbmZpZ3VyZSBhIG5ldyBMb2dpY2Fs
IFVuaXQgdG8gYmUgcmVwcmVzZW50ZWQgYnkgdGhlIGRldmljZQorICAgcmV0dXJuczogZXJyb3Ig
Y29kZQorKi8KK2ludCBjZF91c2JfYnVsa19tc2RfcmVhbGl6ZSh2b2lkICpkZXZpY2UsIHVpbnQz
Ml90IGx1biwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBDZFNjc2lEZXZpY2VQ
YXJhbWV0ZXJzICpkZXZfcGFyYW1zKTsKKworLyogbG9jayB0aGUgZGV2aWNlLCBwcmV2ZW50IHVu
bG9hZGluZworICAgcmV0dXJuczogZXJyb3IgY29kZQorKi8KK2ludCBjZF91c2JfYnVsa19tc2Rf
bG9jayh2b2lkICpkZXZpY2UsIHVpbnQzMl90IGx1biwgZ2Jvb2xlYW4gbG9jayk7CisKKy8qIGxv
YWQgbmV3IG1lZGlhLCBpZiBhbHJlYWR5IGxvYWRlZCwgc2ltdWxhdGUgbWVkaWEgY2hhbmdlCisg
ICByZXR1cm5zOiBlcnJvciBjb2RlCisqLworaW50IGNkX3VzYl9idWxrX21zZF9sb2FkKHZvaWQg
KmRldmljZSwgdWludDMyX3QgbHVuLAorICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IENk
U2NzaU1lZGlhUGFyYW1ldGVycyAqbWVkaWFfcGFyYW1zKTsKKworLyogcXVlcnkgdW5pdCBwYXJh
bWV0ZXJzIGFuZCBzdGF0dXMKKyAgIHJldHVybnM6IGVycm9yIGNvZGUKKyovCitpbnQgY2RfdXNi
X2J1bGtfbXNkX2dldF9pbmZvKHZvaWQgKmRldmljZSwgdWludDMyX3QgbHVuLAorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBDZFNjc2lEZXZpY2VJbmZvICpsdW5faW5mbyk7CisKKy8qIHVu
bG9hZCB0aGUgbWVkaWEKKyAgIHJldHVybnM6IGVycm9yIGNvZGUKKyovCitpbnQgY2RfdXNiX2J1
bGtfbXNkX3VubG9hZCh2b2lkICpkZXZpY2UsIHVpbnQzMl90IGx1bik7CisKKy8qIGRldGFjaCBh
IExvZ2ljYWwgVW5pdAorICAgcmV0dXJuczogZXJyb3IgY29kZQorKi8KK2ludCBjZF91c2JfYnVs
a19tc2RfdW5yZWFsaXplKHZvaWQgKmRldmljZSwgdWludDMyX3QgbHVuKTsKKworLyogcmVzZXQg
dGhlIGRldmljZSBpbnN0YW5jZTsgY2FuY2VsIGFsbCBJTyBvcHMsIHJlc2V0IHN0YXRlCisgICBy
ZXR1cm5zOiBlcnJvciBjb2RlCisqLworaW50IGNkX3VzYl9idWxrX21zZF9yZXNldCh2b2lkICpk
ZXZpY2UpOworCisKKy8qIHBlcmZvcm0gYSB3cml0ZSBkYXRhIGJ1bGsgdHJhbnNmZXIKKyAgIGRh
dGFfbGVuIC0gbGVuZ3RoIG9mIGF2YWlsYWJsZSBkYXRhIHRvIHdyaXRlCisgICByZXR1cm5zOiBl
cnJvciBjb2RlCisqLworaW50IGNkX3VzYl9idWxrX21zZF93cml0ZSh2b2lkICpkZXZpY2UsCisg
ICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQ4X3QgKmJ1ZiwgdWludDMyX3QgZGF0YV9sZW4p
OworCisKKy8qIHBlcmZvcm0gYSByZWFkIGRhdGEgYnVsayB0cmFuc2ZlcgorICAgbWF4X2xlbiAt
IGxlbmd0aCBvZiBhdmFpbGFibGUgYnVmZmVyIHRvIGZpbGwKKyAgIElmIGRhdGEgYXZhaWxhYmxl
IGltbWVkaWF0ZWx5LCBzaG91bGQgY2FsbCBjZF91c2JfYnVsa19tc2RfcmVhZF9jb21wbGV0ZSgp
CisgICAgIGFuZCByZXR1cm4gc3VjY2VzcworICAgSWYgZmF0YWwgZXJyb3IgZGV0ZWN0ZWQgaW1t
ZWRpYXRlbHksIHNob3VsZCBjYWxsIGNkX3VzYl9idWxrX21zZF9yZWFkX2NvbXBsZXRlKCkKKyAg
ICAgd2l0aCBlcnJvciBjb2RlIGFuZCByZXR1cm4gc3VjY2VzcworCisgICByZXR1cm5zOiAwIC0g
c3VjY2VzcywgLTEgLSBlcnJvcgorKi8KK2ludCBjZF91c2JfYnVsa19tc2RfcmVhZCh2b2lkICpk
ZXZpY2UsIHVpbnQzMl90IG1heF9sZW4pOworCisvKiBjYW5jZWxzIHBlbmRpbmcgcmVhZCBkYXRh
IGJ1bGsgdHJhbnNmZXIKKyAgIHJldHVybnM6IGVycm9yIGNvZGUKKyovCitpbnQgY2RfdXNiX2J1
bGtfbXNkX2NhbmNlbF9yZWFkKHZvaWQgKmRldmljZSk7CisKK0dfRU5EX0RFQ0xTCisKKyNlbmRp
ZiAvKiBfX0NEX1VTQl9CVUxLX01TRF9IX18gKi8KZGlmZiAtLWdpdCBhL3NyYy9zY3NpLWNvbnN0
YW50cy5oIGIvc3JjL3Njc2ktY29uc3RhbnRzLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXgg
MDAwMDAwMDAuLjMxZGE3NTA5Ci0tLSAvZGV2L251bGwKKysrIGIvc3JjL3Njc2ktY29uc3RhbnRz
LmgKQEAgLTAsMCArMSwzMjQgQEAKKy8qIC0qLSBNb2RlOiBDOyBjLWJhc2ljLW9mZnNldDogNDsg
aW5kZW50LXRhYnMtbW9kZTogbmlsIC0qLSAqLworLyoKKyAgIENvcHlyaWdodCAoQykgMjAxOCBS
ZWQgSGF0LCBJbmMuCisgICBCYXNlZCBvbiB0aGUgR0xpYiBoZWFkZXIKKworICAgVGhpcyBsaWJy
YXJ5IGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vcgorICAg
bW9kaWZ5IGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1Ymxp
YworICAgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlv
bjsgZWl0aGVyCisgICB2ZXJzaW9uIDIuMSBvZiB0aGUgTGljZW5zZSwgb3IgKGF0IHlvdXIgb3B0
aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4KKworICAgVGhpcyBsaWJyYXJ5IGlzIGRpc3RyaWJ1dGVk
IGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCisgICBidXQgV0lUSE9VVCBBTlkg
V0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgorICAgTUVSQ0hB
TlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZSBH
TlUKKyAgIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCisK
KyAgIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBMZXNzZXIgR2Vu
ZXJhbCBQdWJsaWMKKyAgIExpY2Vuc2UgYWxvbmcgd2l0aCB0aGlzIGxpYnJhcnk7IGlmIG5vdCwg
c2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4KKyovCisKKyNpZm5kZWYgX19TQ1NJ
X0NPTlNUQU5UU19IX18KKyNkZWZpbmUgX19TQ1NJX0NPTlNUQU5UU19IX18KKworLyoKKyAqICAg
ICAgU0NTSSBvcGNvZGVzCisgKi8KKworI2RlZmluZSBURVNUX1VOSVRfUkVBRFkgICAgICAgMHgw
MAorI2RlZmluZSBSRVdJTkQgICAgICAgICAgICAgICAgMHgwMQorI2RlZmluZSBSRVFVRVNUX1NF
TlNFICAgICAgICAgMHgwMworI2RlZmluZSBGT1JNQVRfVU5JVCAgICAgICAgICAgMHgwNAorI2Rl
ZmluZSBSRUFEX0JMT0NLX0xJTUlUUyAgICAgMHgwNQorI2RlZmluZSBJTklUSUFMSVpFX0VMRU1F
TlRfU1RBVFVTIDB4MDcKKyNkZWZpbmUgUkVBU1NJR05fQkxPQ0tTXyAgICAgIDB4MDcKKyNkZWZp
bmUgUkVBRF82ICAgICAgICAgICAgICAgIDB4MDgKKyNkZWZpbmUgV1JJVEVfNiAgICAgICAgICAg
ICAgIDB4MGEKKyNkZWZpbmUgU0VUX0NBUEFDSVRZICAgICAgICAgIDB4MGIKKyNkZWZpbmUgUkVB
RF9SRVZFUlNFICAgICAgICAgIDB4MGYKKyNkZWZpbmUgV1JJVEVfRklMRU1BUktTICAgICAgIDB4
MTAKKyNkZWZpbmUgU1BBQ0UgICAgICAgICAgICAgICAgIDB4MTEKKyNkZWZpbmUgSU5RVUlSWSAg
ICAgICAgICAgICAgIDB4MTIKKyNkZWZpbmUgUkVDT1ZFUl9CVUZGRVJFRF9EQVRBIDB4MTQKKyNk
ZWZpbmUgTU9ERV9TRUxFQ1QgICAgICAgICAgIDB4MTUKKyNkZWZpbmUgUkVTRVJWRSAgICAgICAg
ICAgICAgIDB4MTYKKyNkZWZpbmUgUkVMRUFTRSAgICAgICAgICAgICAgIDB4MTcKKyNkZWZpbmUg
Q09QWSAgICAgICAgICAgICAgICAgIDB4MTgKKyNkZWZpbmUgRVJBU0UgICAgICAgICAgICAgICAg
IDB4MTkKKyNkZWZpbmUgTU9ERV9TRU5TRSAgICAgICAgICAgIDB4MWEKKyNkZWZpbmUgTE9BRF9V
TkxPQUQgICAgICAgICAgIDB4MWIKKyNkZWZpbmUgU0NBTiAgICAgICAgICAgICAgICAgIDB4MWIK
KyNkZWZpbmUgU1RBUlRfU1RPUCAgICAgICAgICAgIDB4MWIKKyNkZWZpbmUgUkVDRUlWRV9ESUFH
Tk9TVElDICAgIDB4MWMKKyNkZWZpbmUgU0VORF9ESUFHTk9TVElDICAgICAgIDB4MWQKKyNkZWZp
bmUgQUxMT1dfTUVESVVNX1JFTU9WQUwgIDB4MWUKKyNkZWZpbmUgU0VUX1dJTkRPVyAgICAgICAg
ICAgIDB4MjQKKyNkZWZpbmUgUkVBRF9DQVBBQ0lUWV8xMCAgICAgIDB4MjUKKyNkZWZpbmUgR0VU
X1dJTkRPVyAgICAgICAgICAgIDB4MjUKKyNkZWZpbmUgUkVBRF8xMCAgICAgICAgICAgICAgIDB4
MjgKKyNkZWZpbmUgV1JJVEVfMTAgICAgICAgICAgICAgIDB4MmEKKyNkZWZpbmUgU0VORCAgICAg
ICAgICAgICAgICAgIDB4MmEKKyNkZWZpbmUgU0VFS18xMCAgICAgICAgICAgICAgIDB4MmIKKyNk
ZWZpbmUgTE9DQVRFXzEwICAgICAgICAgICAgIDB4MmIKKyNkZWZpbmUgUE9TSVRJT05fVE9fRUxF
TUVOVCAgIDB4MmIKKyNkZWZpbmUgV1JJVEVfVkVSSUZZXzEwICAgICAgIDB4MmUKKyNkZWZpbmUg
VkVSSUZZXzEwICAgICAgICAgICAgIDB4MmYKKyNkZWZpbmUgU0VBUkNIX0hJR0ggICAgICAgICAg
IDB4MzAKKyNkZWZpbmUgU0VBUkNIX0VRVUFMICAgICAgICAgIDB4MzEKKyNkZWZpbmUgT0JKRUNU
X1BPU0lUSU9OICAgICAgIDB4MzEKKyNkZWZpbmUgU0VBUkNIX0xPVyAgICAgICAgICAgIDB4MzIK
KyNkZWZpbmUgU0VUX0xJTUlUUyAgICAgICAgICAgIDB4MzMKKyNkZWZpbmUgUFJFX0ZFVENIICAg
ICAgICAgICAgIDB4MzQKKyNkZWZpbmUgUkVBRF9QT1NJVElPTiAgICAgICAgIDB4MzQKKyNkZWZp
bmUgR0VUX0RBVEFfQlVGRkVSX1NUQVRVUyAweDM0CisjZGVmaW5lIFNZTkNIUk9OSVpFX0NBQ0hF
ICAgICAweDM1CisjZGVmaW5lIExPQ0tfVU5MT0NLX0NBQ0hFICAgICAweDM2CisjZGVmaW5lIElO
SVRJQUxJWkVfRUxFTUVOVF9TVEFUVVNfV0lUSF9SQU5HRSAweDM3CisjZGVmaW5lIFJFQURfREVG
RUNUX0RBVEEgICAgICAweDM3CisjZGVmaW5lIE1FRElVTV9TQ0FOICAgICAgICAgICAweDM4Cisj
ZGVmaW5lIENPTVBBUkUgICAgICAgICAgICAgICAweDM5CisjZGVmaW5lIENPUFlfVkVSSUZZICAg
ICAgICAgICAweDNhCisjZGVmaW5lIFdSSVRFX0JVRkZFUiAgICAgICAgICAweDNiCisjZGVmaW5l
IFJFQURfQlVGRkVSICAgICAgICAgICAweDNjCisjZGVmaW5lIFVQREFURV9CTE9DSyAgICAgICAg
ICAweDNkCisjZGVmaW5lIFJFQURfTE9OR18xMCAgICAgICAgICAweDNlCisjZGVmaW5lIFdSSVRF
X0xPTkdfMTAgICAgICAgICAweDNmCisjZGVmaW5lIENIQU5HRV9ERUZJTklUSU9OICAgICAweDQw
CisjZGVmaW5lIFdSSVRFX1NBTUVfMTAgICAgICAgICAweDQxCisjZGVmaW5lIFVOTUFQICAgICAg
ICAgICAgICAgICAweDQyCisjZGVmaW5lIFJFQURfVE9DICAgICAgICAgICAgICAweDQzCisjZGVm
aW5lIFJFUE9SVF9ERU5TSVRZX1NVUFBPUlQgMHg0NAorI2RlZmluZSBHRVRfQ09ORklHVVJBVElP
TiAgICAgMHg0NgorI2RlZmluZSBTQU5JVElaRSAgICAgICAgICAgICAgMHg0OAorI2RlZmluZSBH
RVRfRVZFTlRfU1RBVFVTX05PVElGSUNBVElPTiAweDRhCisjZGVmaW5lIExPR19TRUxFQ1QgICAg
ICAgICAgICAweDRjCisjZGVmaW5lIExPR19TRU5TRSAgICAgICAgICAgICAweDRkCisjZGVmaW5l
IFJFQURfRElTQ19JTkZPUk1BVElPTiAweDUxCisjZGVmaW5lIFJFQURfVFJBQ0tfSU5GT1JNQVRJ
T04gMHg1MgorI2RlZmluZSBSRVNFUlZFX1RSQUNLICAgICAgICAgMHg1MworI2RlZmluZSBNT0RF
X1NFTEVDVF8xMCAgICAgICAgMHg1NQorI2RlZmluZSBSRVNFUlZFXzEwICAgICAgICAgICAgMHg1
NgorI2RlZmluZSBSRUxFQVNFXzEwICAgICAgICAgICAgMHg1NworI2RlZmluZSBNT0RFX1NFTlNF
XzEwICAgICAgICAgMHg1YQorI2RlZmluZSBTRU5EX0NVRV9TSEVFVCAgICAgICAgMHg1ZAorI2Rl
ZmluZSBQRVJTSVNURU5UX1JFU0VSVkVfSU4gMHg1ZQorI2RlZmluZSBQRVJTSVNURU5UX1JFU0VS
VkVfT1VUIDB4NWYKKyNkZWZpbmUgVkFSTEVOR1RIX0NEQiAgICAgICAgIDB4N2YKKyNkZWZpbmUg
V1JJVEVfRklMRU1BUktTXzE2ICAgIDB4ODAKKyNkZWZpbmUgUkVBRF9SRVZFUlNFXzE2ICAgICAg
IDB4ODEKKyNkZWZpbmUgQUxMT1dfT1ZFUldSSVRFICAgICAgIDB4ODIKKyNkZWZpbmUgRVhURU5E
RURfQ09QWSAgICAgICAgIDB4ODMKKyNkZWZpbmUgQVRBX1BBU1NUSFJPVUdIXzE2ICAgIDB4ODUK
KyNkZWZpbmUgQUNDRVNTX0NPTlRST0xfSU4gICAgIDB4ODYKKyNkZWZpbmUgQUNDRVNTX0NPTlRS
T0xfT1VUICAgIDB4ODcKKyNkZWZpbmUgUkVBRF8xNiAgICAgICAgICAgICAgIDB4ODgKKyNkZWZp
bmUgQ09NUEFSRV9BTkRfV1JJVEUgICAgIDB4ODkKKyNkZWZpbmUgV1JJVEVfMTYgICAgICAgICAg
ICAgIDB4OGEKKyNkZWZpbmUgV1JJVEVfVkVSSUZZXzE2ICAgICAgIDB4OGUKKyNkZWZpbmUgVkVS
SUZZXzE2ICAgICAgICAgICAgIDB4OGYKKyNkZWZpbmUgUFJFX0ZFVENIXzE2ICAgICAgICAgIDB4
OTAKKyNkZWZpbmUgU1BBQ0VfMTYgICAgICAgICAgICAgIDB4OTEKKyNkZWZpbmUgU1lOQ0hST05J
WkVfQ0FDSEVfMTYgIDB4OTEKKyNkZWZpbmUgTE9DQVRFXzE2ICAgICAgICAgICAgIDB4OTIKKyNk
ZWZpbmUgV1JJVEVfU0FNRV8xNiAgICAgICAgIDB4OTMKKyNkZWZpbmUgRVJBU0VfMTYgICAgICAg
ICAgICAgIDB4OTMKKyNkZWZpbmUgU0VSVklDRV9BQ1RJT05fSU5fMTYgIDB4OWUKKyNkZWZpbmUg
V1JJVEVfTE9OR18xNiAgICAgICAgIDB4OWYKKyNkZWZpbmUgUkVQT1JUX0xVTlMgICAgICAgICAg
IDB4YTAKKyNkZWZpbmUgQVRBX1BBU1NUSFJPVUdIXzEyICAgIDB4YTEKKyNkZWZpbmUgTUFJTlRF
TkFOQ0VfSU4gICAgICAgIDB4YTMKKyNkZWZpbmUgTUFJTlRFTkFOQ0VfT1VUICAgICAgIDB4YTQK
KyNkZWZpbmUgTU9WRV9NRURJVU0gICAgICAgICAgIDB4YTUKKyNkZWZpbmUgRVhDSEFOR0VfTUVE
SVVNICAgICAgIDB4YTYKKyNkZWZpbmUgU0VUX1JFQURfQUhFQUQgICAgICAgIDB4YTcKKyNkZWZp
bmUgUkVBRF8xMiAgICAgICAgICAgICAgIDB4YTgKKyNkZWZpbmUgV1JJVEVfMTIgICAgICAgICAg
ICAgIDB4YWEKKyNkZWZpbmUgU0VSVklDRV9BQ1RJT05fSU5fMTIgIDB4YWIKKyNkZWZpbmUgRVJB
U0VfMTIgICAgICAgICAgICAgIDB4YWMKKyNkZWZpbmUgV1JJVEVfVkVSSUZZXzEyICAgICAgIDB4
YWUKKyNkZWZpbmUgVkVSSUZZXzEyICAgICAgICAgICAgIDB4YWYKKyNkZWZpbmUgU0VBUkNIX0hJ
R0hfMTIgICAgICAgIDB4YjAKKyNkZWZpbmUgU0VBUkNIX0VRVUFMXzEyICAgICAgIDB4YjEKKyNk
ZWZpbmUgU0VBUkNIX0xPV18xMiAgICAgICAgIDB4YjIKKyNkZWZpbmUgUkVBRF9FTEVNRU5UX1NU
QVRVUyAgIDB4YjgKKyNkZWZpbmUgU0VORF9WT0xVTUVfVEFHICAgICAgIDB4YjYKKworLyogTU1D
LXNwZWNpZmljIG9wY29kZSBhc3NpZ25tZW50ICovCisjZGVmaW5lIE1NQ19TRU5EX0VWRU5UICAg
ICAgICAgIDB4YTIKKyNkZWZpbmUgTU1DX1NFTkRfS0VZICAgICAgICAgICAgMHhhMworI2RlZmlu
ZSBNTUNfUkVQT1JUX0tFWSAgICAgICAgICAweGE0CisjZGVmaW5lIE1NQ19HRVRfUEVSRk9STUFO
Q0UgICAgIDB4YWMKKyNkZWZpbmUgTU1DX1JFQURfRFZEX1NUUlVDVFVSRSAgMHhhZAorI2RlZmlu
ZSBNTUNfUkVBRF9ERUZFQ1RfREFUQV8xMiAweGI3CisjZGVmaW5lIE1NQ19TRVRfQ0RfU1BFRUQg
ICAgICAgIDB4YmIKKyNkZWZpbmUgTU1DX01FQ0hBTklTTV9TVEFUVVMgICAgMHhiZAorI2RlZmlu
ZSBNTUNfUkVBRF9DRCAgICAgICAgICAgICAweGJlCisjZGVmaW5lIE1NQ19TRU5EX0RWRF9TVFJV
Q1RVUkUgIDB4YmYKKworLyoKKyAqIFNFUlZJQ0UgQUNUSU9OIElOIHN1YmNvZGVzCisgKi8KKyNk
ZWZpbmUgU0FJX1JFQURfQ0FQQUNJVFlfMTYgIDB4MTAKKworLyoKKyAqIFJFQUQgUE9TSVRJT04g
c2VydmljZSBhY3Rpb24gY29kZXMKKyAqLworI2RlZmluZSBTSE9SVF9GT1JNX0JMT0NLX0lEICAw
eDAwCisjZGVmaW5lIFNIT1JUX0ZPUk1fVkVORE9SX1NQRUNJRklDIDB4MDEKKyNkZWZpbmUgTE9O
R19GT1JNICAgICAgICAgICAgMHgwNgorI2RlZmluZSBFWFRFTkRFRF9GT1JNICAgICAgICAweDA4
CisKKy8qCisgKiAgU0FNIFN0YXR1cyBjb2RlcworICovCisKKyNkZWZpbmUgR09PRCAgICAgICAg
ICAgICAgICAgMHgwMAorI2RlZmluZSBDSEVDS19DT05ESVRJT04gICAgICAweDAyCisjZGVmaW5l
IENPTkRJVElPTl9HT09EICAgICAgIDB4MDQKKyNkZWZpbmUgQlVTWSAgICAgICAgICAgICAgICAg
MHgwOAorI2RlZmluZSBJTlRFUk1FRElBVEVfR09PRCAgICAweDEwCisjZGVmaW5lIElOVEVSTUVE
SUFURV9DX0dPT0QgIDB4MTQKKyNkZWZpbmUgUkVTRVJWQVRJT05fQ09ORkxJQ1QgMHgxOAorI2Rl
ZmluZSBDT01NQU5EX1RFUk1JTkFURUQgICAweDIyCisjZGVmaW5lIFRBU0tfU0VUX0ZVTEwgICAg
ICAgIDB4MjgKKyNkZWZpbmUgQUNBX0FDVElWRSAgICAgICAgICAgMHgzMAorI2RlZmluZSBUQVNL
X0FCT1JURUQgICAgICAgICAweDQwCisKKyNkZWZpbmUgU1RBVFVTX01BU0sgICAgICAgICAgMHgz
ZQorCisvKgorICogIFNFTlNFIEtFWVMKKyAqLworCisjZGVmaW5lIE5PX1NFTlNFICAgICAgICAg
ICAgMHgwMAorI2RlZmluZSBSRUNPVkVSRURfRVJST1IgICAgIDB4MDEKKyNkZWZpbmUgTk9UX1JF
QURZICAgICAgICAgICAweDAyCisjZGVmaW5lIE1FRElVTV9FUlJPUiAgICAgICAgMHgwMworI2Rl
ZmluZSBIQVJEV0FSRV9FUlJPUiAgICAgIDB4MDQKKyNkZWZpbmUgSUxMRUdBTF9SRVFVRVNUICAg
ICAweDA1CisjZGVmaW5lIFVOSVRfQVRURU5USU9OICAgICAgMHgwNgorI2RlZmluZSBEQVRBX1BS
T1RFQ1QgICAgICAgIDB4MDcKKyNkZWZpbmUgQkxBTktfQ0hFQ0sgICAgICAgICAweDA4CisjZGVm
aW5lIENPUFlfQUJPUlRFRCAgICAgICAgMHgwYQorI2RlZmluZSBBQk9SVEVEX0NPTU1BTkQgICAg
IDB4MGIKKyNkZWZpbmUgVk9MVU1FX09WRVJGTE9XICAgICAweDBkCisjZGVmaW5lIE1JU0NPTVBB
UkUgICAgICAgICAgMHgwZQorCisKKy8qCisgKiAgREVWSUNFIFRZUEVTCisgKi8KKworI2RlZmlu
ZSBUWVBFX0RJU0sgICAgICAgICAgIDB4MDAKKyNkZWZpbmUgVFlQRV9UQVBFICAgICAgICAgICAw
eDAxCisjZGVmaW5lIFRZUEVfUFJJTlRFUiAgICAgICAgMHgwMgorI2RlZmluZSBUWVBFX1BST0NF
U1NPUiAgICAgIDB4MDMgICAgLyogSFAgc2Nhbm5lcnMgdXNlIHRoaXMgKi8KKyNkZWZpbmUgVFlQ
RV9XT1JNICAgICAgICAgICAweDA0ICAgIC8qIFRyZWF0ZWQgYXMgUk9NIGJ5IG91ciBzeXN0ZW0g
Ki8KKyNkZWZpbmUgVFlQRV9ST00gICAgICAgICAgICAweDA1CisjZGVmaW5lIFRZUEVfU0NBTk5F
UiAgICAgICAgMHgwNgorI2RlZmluZSBUWVBFX01PRCAgICAgICAgICAgIDB4MDcgICAgLyogTWFn
bmV0by1vcHRpY2FsIGRpc2sgLQorCQkJCSAgICAgKiAtIHRyZWF0ZWQgYXMgVFlQRV9ESVNLICov
CisjZGVmaW5lIFRZUEVfTUVESVVNX0NIQU5HRVIgMHgwOAorI2RlZmluZSBUWVBFX1NUT1JBR0Vf
QVJSQVkgIDB4MGMgICAgLyogU3RvcmFnZSBhcnJheSBkZXZpY2UgKi8KKyNkZWZpbmUgVFlQRV9F
TkNMT1NVUkUgICAgICAweDBkICAgIC8qIEVuY2xvc3VyZSBTZXJ2aWNlcyBEZXZpY2UgKi8KKyNk
ZWZpbmUgVFlQRV9SQkMgICAgICAgICAgICAweDBlICAgIC8qIFNpbXBsaWZpZWQgRGlyZWN0LUFj
Y2VzcyBEZXZpY2UgKi8KKyNkZWZpbmUgVFlQRV9PU0QgICAgICAgICAgICAweDExICAgIC8qIE9i
amVjdC1zdG9yYWdlIERldmljZSAqLworI2RlZmluZSBUWVBFX1dMVU4gICAgICAgICAgIDB4MWUg
ICAgLyogV2VsbCBrbm93biBMVU4gKi8KKyNkZWZpbmUgVFlQRV9OT1RfUFJFU0VOVCAgICAweDFm
CisjZGVmaW5lIFRZUEVfSU5BQ1RJVkUgICAgICAgMHgyMAorI2RlZmluZSBUWVBFX05PX0xVTiAg
ICAgICAgIDB4N2YKKworLyogTW9kZSBwYWdlIGNvZGVzIGZvciBtb2RlIHNlbnNlL3NldCAqLwor
I2RlZmluZSBNT0RFX1BBR0VfUl9XX0VSUk9SICAgICAgICAgICAgICAgICAgIDB4MDEKKyNkZWZp
bmUgTU9ERV9QQUdFX01SVyAgICAgICAgICAgICAgICAgICAgICAgICAweDAzCisjZGVmaW5lIE1P
REVfUEFHRV9IRF9HRU9NRVRSWSAgICAgICAgICAgICAgICAgMHgwNAorI2RlZmluZSBNT0RFX1BB
R0VfRkxFWElCTEVfRElTS19HRU9NRVRSWSAgICAgIDB4MDUgLyogU0JDICovCisjZGVmaW5lIE1P
REVfUEFHRV9XUklURV9QQVJBTUVURVIgICAgICAgICAgICAgMHgwNSAvKiBNTUMgKi8KKyNkZWZp
bmUgTU9ERV9QQUdFX0NBQ0hJTkcgICAgICAgICAgICAgICAgICAgICAweDA4CisjZGVmaW5lIE1P
REVfUEFHRV9DRF9ERVZJQ0UgICAgICAgICAgICAgICAgICAgMHgwZAorI2RlZmluZSBNT0RFX1BB
R0VfQVVESU9fQ1RMICAgICAgICAgICAgICAgICAgIDB4MGUKKyNkZWZpbmUgTU9ERV9QQUdFX1BP
V0VSICAgICAgICAgICAgICAgICAgICAgICAweDFhCisjZGVmaW5lIE1PREVfUEFHRV9GQVVMVF9G
QUlMICAgICAgICAgICAgICAgICAgMHgxYworI2RlZmluZSBNT0RFX1BBR0VfVE9fUFJPVEVDVCAg
ICAgICAgICAgICAgICAgIDB4MWQKKyNkZWZpbmUgTU9ERV9QQUdFX0NBUFNfTUVDSF9TVEFUVVMg
ICAgICAgICAgICAweDJhCisjZGVmaW5lIE1PREVfUEFHRV9NUldfVkVORE9SICAgICAgICAgICAg
ICAgICAgMHgyQworI2RlZmluZSBNT0RFX1BBR0VfQUxMUyAgICAgICAgICAgICAgICAgICAgICAg
IDB4M2YKKy8qIE5vdCBpbiBNdC4gRnVqaSwgYnV0IGluIEFUQVBJIDIuNiAtLSBkZXByZWNhdGVk
IG5vdyBpbiBmYXZvcgorICogb2YgTU9ERV9QQUdFX1NFTlNFX1BPV0VSICovCisjZGVmaW5lIE1P
REVfUEFHRV9DRFJPTSAgICAgICAgICAgICAgICAgICAgICAgMHgwZAorCisjZGVmaW5lIE1PREVf
UEFHRV9DRFJPTSAgICAgICAgICAgICAgICAgICAgICAgMHgwZAorCisvKiBFdmVudCBub3RpZmlj
YXRpb24gY2xhc3NlcyBmb3IgR0VUIEVWRU5UIFNUQVRVUyBOT1RJRklDQVRJT04gKi8KKyNkZWZp
bmUgR0VTTl9OT19FVkVOVFMgICAgICAgICAgICAgICAgMAorI2RlZmluZSBHRVNOX09QRVJBVElP
TkFMX0NIQU5HRSAgICAgICAxCisjZGVmaW5lIEdFU05fUE9XRVJfTUFOQUdFTUVOVCAgICAgICAg
IDIKKyNkZWZpbmUgR0VTTl9FWFRFUk5BTF9SRVFVRVNUICAgICAgICAgMworI2RlZmluZSBHRVNO
X01FRElBICAgICAgICAgICAgICAgICAgICA0CisjZGVmaW5lIEdFU05fTVVMVElQTEVfSE9TVFMg
ICAgICAgICAgIDUKKyNkZWZpbmUgR0VTTl9ERVZJQ0VfQlVTWSAgICAgICAgICAgICAgNgorCisv
KiBFdmVudCBjb2RlcyBmb3IgTUVESUEgZXZlbnQgc3RhdHVzIG5vdGlmaWNhdGlvbiAqLworI2Rl
ZmluZSBNRUNfTk9fQ0hBTkdFICAgICAgICAgICAgICAgICAwCisjZGVmaW5lIE1FQ19FSkVDVF9S
RVFVRVNURUQgICAgICAgICAgIDEKKyNkZWZpbmUgTUVDX05FV19NRURJQSAgICAgICAgICAgICAg
ICAgMgorI2RlZmluZSBNRUNfTUVESUFfUkVNT1ZBTCAgICAgICAgICAgICAzIC8qIG9ubHkgZm9y
IG1lZGlhIGNoYW5nZXJzICovCisjZGVmaW5lIE1FQ19NRURJQV9DSEFOR0VEICAgICAgICAgICAg
IDQgLyogb25seSBmb3IgbWVkaWEgY2hhbmdlcnMgKi8KKyNkZWZpbmUgTUVDX0JHX0ZPUk1BVF9D
T01QTEVURUQgICAgICAgNSAvKiBNUlcgb3IgRFZEK1JXIGIvZyBmb3JtYXQgY29tcGxldGVkICov
CisjZGVmaW5lIE1FQ19CR19GT1JNQVRfUkVTVEFSVEVEICAgICAgIDYgLyogTVJXIG9yIERWRCtS
VyBiL2cgZm9ybWF0IHJlc3RhcnRlZCAqLworCisjZGVmaW5lIE1TX1RSQVlfT1BFTiAgICAgICAg
ICAgICAgICAgIDEKKyNkZWZpbmUgTVNfTUVESUFfUFJFU0VOVCAgICAgICAgICAgICAgMgorCisv
KgorICogQmFzZWQgb24gdmFsdWVzIGZyb20gPGxpbnV4L2Nkcm9tLmg+IGJ1dCBleHRlbmRpbmcg
Q0RfTUlOUworICogdG8gdGhlIG1heGltdW0gY29tbW9uIHNpemUgYWxsb3dlZCBieSB0aGUgT3Jh
bmdlJ3MgQm9vayBBVElQCisgKgorICogOTAgYW5kIDk5IG1pbiBDRHMgYXJlIGFsc28gYXZhaWxh
YmxlIGJ1dCB1c2luZyB0aGVtIGFzIHRoZQorICogdXBwZXIgbGltaXQgcmVkdWNlcyB0aGUgZWZm
ZWN0aXZlbmVzcyBvZiB0aGUgaGV1cmlzdGljIHRvCisgKiBkZXRlY3QgRFZEcyBidXJuZWQgdG8g
bGVzcyB0aGFuIDI1JSBvZiB0aGVpciBtYXhpbXVtIGNhcGFjaXR5CisgKi8KKworLyogU29tZSBn
ZW5lcmFsbHkgdXNlZnVsIENELVJPTSBpbmZvcm1hdGlvbiAqLworI2RlZmluZSBDRF9NSU5TICAg
ICAgICAgICAgICAgICAgICAgICA4MCAvKiBtYXguIG1pbnV0ZXMgcGVyIENEICovCisjZGVmaW5l
IENEX1NFQ1MgICAgICAgICAgICAgICAgICAgICAgIDYwIC8qIHNlY29uZHMgcGVyIG1pbnV0ZSAq
LworI2RlZmluZSBDRF9GUkFNRVMgICAgICAgICAgICAgICAgICAgICA3NSAvKiBmcmFtZXMgcGVy
IHNlY29uZCAqLworI2RlZmluZSBDRF9GUkFNRVNJWkUgICAgICAgICAgICAgICAgMjA0OCAvKiBi
eXRlcyBwZXIgZnJhbWUsICJjb29rZWQiIG1vZGUgKi8KKyNkZWZpbmUgQ0RfTUFYX0JZVEVTICAg
ICAgIChDRF9NSU5TICogQ0RfU0VDUyAqIENEX0ZSQU1FUyAqIENEX0ZSQU1FU0laRSkKKyNkZWZp
bmUgQ0RfTUFYX1NFQ1RPUlMgICAgIChDRF9NQVhfQllURVMgLyA1MTIpCisKKy8qCisgKiBUaGUg
TU1DIHZhbHVlcyBhcmUgbm90IElERSBzcGVjaWZpYyBhbmQgbWlnaHQgbmVlZCB0byBiZSBtb3Zl
ZAorICogdG8gYSBjb21tb24gaGVhZGVyIGlmIHRoZXkgYXJlIGFsc28gbmVlZGVkIGZvciB0aGUg
U0NTSSBlbXVsYXRpb24KKyAqLworCisvKiBQcm9maWxlIGxpc3QgZnJvbSBNTUMtNiByZXZpc2lv
biAxIHRhYmxlIDkxICovCisjZGVmaW5lIE1NQ19QUk9GSUxFX05PTkUgICAgICAgICAgICAgICAg
MHgwMDAwCisjZGVmaW5lIE1NQ19QUk9GSUxFX0NEX1JPTSAgICAgICAgICAgICAgMHgwMDA4Cisj
ZGVmaW5lIE1NQ19QUk9GSUxFX0NEX1IgICAgICAgICAgICAgICAgMHgwMDA5CisjZGVmaW5lIE1N
Q19QUk9GSUxFX0NEX1JXICAgICAgICAgICAgICAgMHgwMDBBCisjZGVmaW5lIE1NQ19QUk9GSUxF
X0RWRF9ST00gICAgICAgICAgICAgMHgwMDEwCisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9SX1NS
ICAgICAgICAgICAgMHgwMDExCisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9SQU0gICAgICAgICAg
ICAgMHgwMDEyCisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9SV19STyAgICAgICAgICAgMHgwMDEz
CisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9SV19TUiAgICAgICAgICAgMHgwMDE0CisjZGVmaW5l
IE1NQ19QUk9GSUxFX0RWRF9SX0RMX1NSICAgICAgICAgMHgwMDE1CisjZGVmaW5lIE1NQ19QUk9G
SUxFX0RWRF9SX0RMX0pSICAgICAgICAgMHgwMDE2CisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9S
V19ETCAgICAgICAgICAgMHgwMDE3CisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9ERFIgICAgICAg
ICAgICAgMHgwMDE4CisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9QTFVTX1JXICAgICAgICAgMHgw
MDFBCisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9QTFVTX1IgICAgICAgICAgMHgwMDFCCisjZGVm
aW5lIE1NQ19QUk9GSUxFX0RWRF9QTFVTX1JXX0RMICAgICAgMHgwMDJBCisjZGVmaW5lIE1NQ19Q
Uk9GSUxFX0RWRF9QTFVTX1JfREwgICAgICAgMHgwMDJCCisjZGVmaW5lIE1NQ19QUk9GSUxFX0JE
X1JPTSAgICAgICAgICAgICAgMHgwMDQwCisjZGVmaW5lIE1NQ19QUk9GSUxFX0JEX1JfU1JNICAg
ICAgICAgICAgMHgwMDQxCisjZGVmaW5lIE1NQ19QUk9GSUxFX0JEX1JfUlJNICAgICAgICAgICAg
MHgwMDQyCisjZGVmaW5lIE1NQ19QUk9GSUxFX0JEX1JFICAgICAgICAgICAgICAgMHgwMDQzCisj
ZGVmaW5lIE1NQ19QUk9GSUxFX0hERFZEX1JPTSAgICAgICAgICAgMHgwMDUwCisjZGVmaW5lIE1N
Q19QUk9GSUxFX0hERFZEX1IgICAgICAgICAgICAgMHgwMDUxCisjZGVmaW5lIE1NQ19QUk9GSUxF
X0hERFZEX1JBTSAgICAgICAgICAgMHgwMDUyCisjZGVmaW5lIE1NQ19QUk9GSUxFX0hERFZEX1JX
ICAgICAgICAgICAgMHgwMDUzCisjZGVmaW5lIE1NQ19QUk9GSUxFX0hERFZEX1JfREwgICAgICAg
ICAgMHgwMDU4CisjZGVmaW5lIE1NQ19QUk9GSUxFX0hERFZEX1JXX0RMICAgICAgICAgMHgwMDVB
CisjZGVmaW5lIE1NQ19QUk9GSUxFX0lOVkFMSUQgICAgICAgICAgICAgMHhGRkZGCisKKyNlbmRp
ZgotLSAKMi4yMC4xCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fXwpTcGljZS1kZXZlbCBtYWlsaW5nIGxpc3QKU3BpY2UtZGV2ZWxAbGlzdHMuZnJlZWRlc2t0
b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vc3Bp
Y2UtZGV2ZWw=
