Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 1648D55C87
	for <lists+spice-devel@lfdr.de>; Wed, 26 Jun 2019 01:44:55 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id A6B896E1BE;
	Tue, 25 Jun 2019 23:44:53 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mail.codeweavers.com (mail.codeweavers.com [50.203.203.244])
 by gabe.freedesktop.org (Postfix) with ESMTPS id A49CF6E1BE
 for <spice-devel@lists.freedesktop.org>; Tue, 25 Jun 2019 23:44:52 +0000 (UTC)
Received: from 82-64-54-218.subs.proxad.net ([82.64.54.218] helo=amboise)
 by mail.codeweavers.com with esmtpsa (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.89) (envelope-from <fgouget@free.fr>) id 1hfv7r-0003MJ-6S
 for spice-devel@lists.freedesktop.org; Tue, 25 Jun 2019 18:45:24 -0500
Received: from fgouget by amboise with local (Exim 4.92)
 (envelope-from <fgouget@amboise.dolphin>) id 1hfv7J-000078-UR
 for spice-devel@lists.freedesktop.org; Wed, 26 Jun 2019 01:44:50 +0200
Date: Wed, 26 Jun 2019 01:44:49 +0200 (CEST)
From: Francois Gouget <fgouget@codeweavers.com>
To: Spice devel <spice-devel@lists.freedesktop.org>
In-Reply-To: <9e4beeec69d6cb7be4e5c9d4b292f2761d5158e2.1561506197.git.fgouget@free.fr>
Message-ID: <36875c437b0d3d1b444ec4997645384be9d02861.1561506197.git.fgouget@free.fr>
References: <9e4beeec69d6cb7be4e5c9d4b292f2761d5158e2.1561506197.git.fgouget@free.fr>
User-Agent: Alpine 2.21 (DEB 202 2017-01-01)
MIME-Version: 1.0
X-Spam-Score: -103.7
X-Spam-Report: Spam detection software,
 running on the system "mail.codeweavers.com", 
 has NOT identified this incoming email as spam.  The original
 message has been attached to this so you can view it or label
 similar future email.  If you have any questions, see
 the administrator of that system for details.
 Content preview: The frame display time is no longer based on the mmtime clock
 and thus is not impacted by mmtime offset changes. Signed-off-by: Francois
 Gouget <fgouget@codeweavers.com> --- src/channel-display-gst.c | 21
 src/channel-display-mjpeg.c
 | 13 -------- src/channel-display-priv.h | 3 -- src/channel-displa [...] 
 Content analysis details:   (-103.7 points, 5.0 required)
 pts rule name              description
 ---- ---------------------- --------------------------------------------------
 -100 USER_IN_WHITELIST      From: address is in the user's white-list
 -6.0 ALL_TRUSTED            Passed through trusted hosts only via SMTP
 0.0 TVD_RCVD_IP            Message was received from an IP address
 1.0 HEADER_FROM_DIFFERENT_DOMAINS From and EnvelopeFrom 2nd level
 mail domains are different
 1.0 FREEMAIL_FROM          Sender email is commonly abused enduser mail
 provider (fgouget[at]free.fr)
 0.2 FREEMAIL_FORGED_FROMDOMAIN 2nd level domains in From and
 EnvelopeFrom freemail headers are different
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt;
 c=relaxed/relaxed; 
 d=codeweavers.com; s=6377696661; h=Content-Type:MIME-Version:References:
 Message-ID:In-Reply-To:Subject:To:From:Date:Sender:Reply-To:Cc:
 Content-Transfer-Encoding:Content-ID:Content-Description:Resent-Date:
 Resent-From:Resent-Sender:Resent-To:Resent-Cc:Resent-Message-ID:List-Id:
 List-Help:List-Unsubscribe:List-Subscribe:List-Post:List-Owner:List-Archive;
 bh=5JtQbFa7I5cpm7GGIvs/WhTXyyl9jRLyg4+F/SL3yKs=; b=xXctks3SttUYMcBvQqSKvN+u/
 G+y/Tx+3IduJBvBJZjLJKnwSCTc4gKSRQGtXfcduIGpigTsr+JoSCTiIhk6zaSVRQ+MF0cowGVphy
 R5n9ABSQKl03ZtFmQdYsXhDQ5Y0ajVHaWK7piLYmJ9nheFvqT06o819Z4mGp6mnZQh7Kk=;
Subject: [Spice-devel] [client v3 3/6] channel-display: No need to rechedule
 on mmtime offset changes
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

VGhlIGZyYW1lIGRpc3BsYXkgdGltZSBpcyBubyBsb25nZXIgYmFzZWQgb24gdGhlIG1tdGltZSBj
bG9jayBhbmQgdGh1cwppcyBub3QgaW1wYWN0ZWQgYnkgbW10aW1lIG9mZnNldCBjaGFuZ2VzLgoK
U2lnbmVkLW9mZi1ieTogRnJhbmNvaXMgR291Z2V0IDxmZ291Z2V0QGNvZGV3ZWF2ZXJzLmNvbT4K
LS0tCiBzcmMvY2hhbm5lbC1kaXNwbGF5LWdzdC5jICAgfCAyMSAtLS0tLS0tLS0tLS0tCiBzcmMv
Y2hhbm5lbC1kaXNwbGF5LW1qcGVnLmMgfCAxMyAtLS0tLS0tLQogc3JjL2NoYW5uZWwtZGlzcGxh
eS1wcml2LmggIHwgIDMgLS0KIHNyYy9jaGFubmVsLWRpc3BsYXkuYyAgICAgICB8IDU5IC0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIDQgZmlsZXMgY2hhbmdlZCwgOTYgZGVs
ZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvc3JjL2NoYW5uZWwtZGlzcGxheS1nc3QuYyBiL3NyYy9j
aGFubmVsLWRpc3BsYXktZ3N0LmMKaW5kZXggN2FkNjAwOWIuLjExZDc4YWZjIDEwMDY0NAotLS0g
YS9zcmMvY2hhbm5lbC1kaXNwbGF5LWdzdC5jCisrKyBiL3NyYy9jaGFubmVsLWRpc3BsYXktZ3N0
LmMKQEAgLTU4MywyNiArNTgzLDYgQEAgc3RhdGljIGdib29sZWFuIGNyZWF0ZV9waXBlbGluZShT
cGljZUdzdERlY29kZXIgKmRlY29kZXIpCiAKIC8qIC0tLS0tLS0tLS0gVmlkZW9EZWNvZGVyJ3Mg
cHVibGljIEFQSSAtLS0tLS0tLS0tICovCiAKLXN0YXRpYyB2b2lkIHNwaWNlX2dzdF9kZWNvZGVy
X3Jlc2NoZWR1bGUoVmlkZW9EZWNvZGVyICp2aWRlb19kZWNvZGVyKQotewotICAgIFNwaWNlR3N0
RGVjb2RlciAqZGVjb2RlciA9IChTcGljZUdzdERlY29kZXIqKXZpZGVvX2RlY29kZXI7Ci0KLSAg
ICBpZiAoIWRlY29kZXItPmFwcHNpbmspIHsKLSAgICAgICAgcmV0dXJuOwotICAgIH0KLSAgICBn
dWludCB0aW1lcl9pZDsKLQotICAgIGdfbXV0ZXhfbG9jaygmZGVjb2Rlci0+cXVldWVzX211dGV4
KTsKLSAgICB0aW1lcl9pZCA9IGRlY29kZXItPnRpbWVyX2lkOwotICAgIGRlY29kZXItPnRpbWVy
X2lkID0gMDsKLSAgICBnX211dGV4X3VubG9jaygmZGVjb2Rlci0+cXVldWVzX211dGV4KTsKLQot
ICAgIGlmICh0aW1lcl9pZCAhPSAwKSB7Ci0gICAgICAgIGdfc291cmNlX3JlbW92ZSh0aW1lcl9p
ZCk7Ci0gICAgfQotICAgIHNjaGVkdWxlX2ZyYW1lKGRlY29kZXIpOwotfQotCiAvKiBtYWluIGNv
bnRleHQgKi8KIHN0YXRpYyB2b2lkIHNwaWNlX2dzdF9kZWNvZGVyX2Rlc3Ryb3koVmlkZW9EZWNv
ZGVyICp2aWRlb19kZWNvZGVyKQogewpAQCAtNzc0LDcgKzc1NCw2IEBAIFZpZGVvRGVjb2Rlciog
Y3JlYXRlX2dzdHJlYW1lcl9kZWNvZGVyKGludCBjb2RlY190eXBlLCBkaXNwbGF5X3N0cmVhbSAq
c3RyZWFtKQogICAgIGlmIChnc3R2aWRlb19pbml0KCkpIHsKICAgICAgICAgZGVjb2RlciA9IGdf
bmV3MChTcGljZUdzdERlY29kZXIsIDEpOwogICAgICAgICBkZWNvZGVyLT5iYXNlLmRlc3Ryb3kg
PSBzcGljZV9nc3RfZGVjb2Rlcl9kZXN0cm95OwotICAgICAgICBkZWNvZGVyLT5iYXNlLnJlc2No
ZWR1bGUgPSBzcGljZV9nc3RfZGVjb2Rlcl9yZXNjaGVkdWxlOwogICAgICAgICBkZWNvZGVyLT5i
YXNlLnF1ZXVlX2ZyYW1lID0gc3BpY2VfZ3N0X2RlY29kZXJfcXVldWVfZnJhbWU7CiAgICAgICAg
IGRlY29kZXItPmJhc2UuY29kZWNfdHlwZSA9IGNvZGVjX3R5cGU7CiAgICAgICAgIGRlY29kZXIt
PmJhc2Uuc3RyZWFtID0gc3RyZWFtOwpkaWZmIC0tZ2l0IGEvc3JjL2NoYW5uZWwtZGlzcGxheS1t
anBlZy5jIGIvc3JjL2NoYW5uZWwtZGlzcGxheS1tanBlZy5jCmluZGV4IGQzYWI3N2M4Li5iMDU4
NDI0ZSAxMDA2NDQKLS0tIGEvc3JjL2NoYW5uZWwtZGlzcGxheS1tanBlZy5jCisrKyBiL3NyYy9j
aGFubmVsLWRpc3BsYXktbWpwZWcuYwpAQCAtMjUwLDE4ICsyNTAsNiBAQCBzdGF0aWMgZ2Jvb2xl
YW4gbWpwZWdfZGVjb2Rlcl9xdWV1ZV9mcmFtZShWaWRlb0RlY29kZXIgKnZpZGVvX2RlY29kZXIs
CiAgICAgcmV0dXJuIFRSVUU7CiB9CiAKLXN0YXRpYyB2b2lkIG1qcGVnX2RlY29kZXJfcmVzY2hl
ZHVsZShWaWRlb0RlY29kZXIgKnZpZGVvX2RlY29kZXIpCi17Ci0gICAgTUpwZWdEZWNvZGVyICpk
ZWNvZGVyID0gKE1KcGVnRGVjb2RlciopdmlkZW9fZGVjb2RlcjsKLQotICAgIFNQSUNFX0RFQlVH
KCIlcyIsIF9fRlVOQ1RJT05fXyk7Ci0gICAgaWYgKGRlY29kZXItPnRpbWVyX2lkICE9IDApIHsK
LSAgICAgICAgZ19zb3VyY2VfcmVtb3ZlKGRlY29kZXItPnRpbWVyX2lkKTsKLSAgICAgICAgZGVj
b2Rlci0+dGltZXJfaWQgPSAwOwotICAgIH0KLSAgICBtanBlZ19kZWNvZGVyX3NjaGVkdWxlKGRl
Y29kZXIpOwotfQotCiBzdGF0aWMgdm9pZCBtanBlZ19kZWNvZGVyX2Rlc3Ryb3koVmlkZW9EZWNv
ZGVyKiB2aWRlb19kZWNvZGVyKQogewogICAgIE1KcGVnRGVjb2RlciAqZGVjb2RlciA9IChNSnBl
Z0RlY29kZXIqKXZpZGVvX2RlY29kZXI7CkBAIC0yODEsNyArMjY5LDYgQEAgVmlkZW9EZWNvZGVy
KiBjcmVhdGVfbWpwZWdfZGVjb2RlcihpbnQgY29kZWNfdHlwZSwgZGlzcGxheV9zdHJlYW0gKnN0
cmVhbSkKICAgICBNSnBlZ0RlY29kZXIgKmRlY29kZXIgPSBnX25ldzAoTUpwZWdEZWNvZGVyLCAx
KTsKIAogICAgIGRlY29kZXItPmJhc2UuZGVzdHJveSA9IG1qcGVnX2RlY29kZXJfZGVzdHJveTsK
LSAgICBkZWNvZGVyLT5iYXNlLnJlc2NoZWR1bGUgPSBtanBlZ19kZWNvZGVyX3Jlc2NoZWR1bGU7
CiAgICAgZGVjb2Rlci0+YmFzZS5xdWV1ZV9mcmFtZSA9IG1qcGVnX2RlY29kZXJfcXVldWVfZnJh
bWU7CiAgICAgZGVjb2Rlci0+YmFzZS5jb2RlY190eXBlID0gY29kZWNfdHlwZTsKICAgICBkZWNv
ZGVyLT5iYXNlLnN0cmVhbSA9IHN0cmVhbTsKZGlmZiAtLWdpdCBhL3NyYy9jaGFubmVsLWRpc3Bs
YXktcHJpdi5oIGIvc3JjL2NoYW5uZWwtZGlzcGxheS1wcml2LmgKaW5kZXggMmNhNDNlMjUuLjY2
Mjg5NTFkIDEwMDY0NAotLS0gYS9zcmMvY2hhbm5lbC1kaXNwbGF5LXByaXYuaAorKysgYi9zcmMv
Y2hhbm5lbC1kaXNwbGF5LXByaXYuaApAQCAtNTksOSArNTksNiBAQCBzdHJ1Y3QgVmlkZW9EZWNv
ZGVyIHsKICAgICAvKiBSZWxlYXNlcyB0aGUgdmlkZW8gZGVjb2RlcidzIHJlc291cmNlcyAqLwog
ICAgIHZvaWQgKCpkZXN0cm95KShWaWRlb0RlY29kZXIgKmRlY29kZXIpOwogCi0gICAgLyogTm90
aWZpZXMgdGhlIGRlY29kZXIgdGhhdCB0aGUgbW0tdGltZSBjbG9jayBjaGFuZ2VkLiAqLwotICAg
IHZvaWQgKCpyZXNjaGVkdWxlKShWaWRlb0RlY29kZXIgKmRlY29kZXIpOwotCiAgICAgLyogVGFr
ZXMgb3duZXJzaGlwIG9mIHRoZSBzcGVjaWZpZWQgZnJhbWUsIGRlY29tcHJlc3NlcyBpdCwKICAg
ICAgKiBhbmQgZGlzcGxheXMgaXQgYXQgdGhlIHJpZ2h0IHRpbWUuCiAgICAgICoKZGlmZiAtLWdp
dCBhL3NyYy9jaGFubmVsLWRpc3BsYXkuYyBiL3NyYy9jaGFubmVsLWRpc3BsYXkuYwppbmRleCAy
MWQ1ZTdjNy4uOWVmMjA1NGUgMTAwNjQ0Ci0tLSBhL3NyYy9jaGFubmVsLWRpc3BsYXkuYworKysg
Yi9zcmMvY2hhbm5lbC1kaXNwbGF5LmMKQEAgLTEwNyw3ICsxMDcsNiBAQCBzdGF0aWMgdm9pZCBz
cGljZV9kaXNwbGF5X2NoYW5uZWxfcmVzZXQoU3BpY2VDaGFubmVsICpjaGFubmVsLCBnYm9vbGVh
biBtaWdyYXRpbgogc3RhdGljIHZvaWQgc3BpY2VfZGlzcGxheV9jaGFubmVsX3NldF9jYXBhYmls
aXRpZXMoU3BpY2VDaGFubmVsICpjaGFubmVsKTsKIHN0YXRpYyB2b2lkIGRlc3Ryb3lfY2FudmFz
KGRpc3BsYXlfc3VyZmFjZSAqc3VyZmFjZSk7CiBzdGF0aWMgdm9pZCBkaXNwbGF5X3N0cmVhbV9k
ZXN0cm95KGdwb2ludGVyIHN0KTsKLXN0YXRpYyB2b2lkIGRpc3BsYXlfc2Vzc2lvbl9tbV90aW1l
X3Jlc2V0X2NiKFNwaWNlU2Vzc2lvbiAqc2Vzc2lvbiwgZ3BvaW50ZXIgZGF0YSk7CiBzdGF0aWMg
U3BpY2VHbFNjYW5vdXQqIHNwaWNlX2dsX3NjYW5vdXRfY29weShjb25zdCBTcGljZUdsU2Nhbm91
dCAqc2Nhbm91dCk7CiAKIEdfREVGSU5FX0JPWEVEX1RZUEUoU3BpY2VHbFNjYW5vdXQsIHNwaWNl
X2dsX3NjYW5vdXQsCkBAIC0xODksOSArMTg4LDYgQEAgc3RhdGljIHZvaWQgc3BpY2VfZGlzcGxh
eV9jaGFubmVsX2NvbnN0cnVjdGVkKEdPYmplY3QgKm9iamVjdCkKICAgICBnX3JldHVybl9pZl9m
YWlsKGMtPnBhbGV0dGVzICE9IE5VTEwpOwogCiAgICAgYy0+bW9uaXRvcnMgPSBnX2FycmF5X25l
dyhGQUxTRSwgVFJVRSwgc2l6ZW9mKFNwaWNlRGlzcGxheU1vbml0b3JDb25maWcpKTsKLSAgICBz
cGljZV9nX3NpZ25hbF9jb25uZWN0X29iamVjdChzLCAibW0tdGltZS1yZXNldCIsCi0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgR19DQUxMQkFDSyhkaXNwbGF5X3Nlc3Npb25fbW1f
dGltZV9yZXNldF9jYiksCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU1BJQ0Vf
Q0hBTk5FTChvYmplY3QpLCAwKTsKIAogICAgIHNwaWNlX2Rpc3BsYXlfY2hhbm5lbF9zZXRfY2Fw
YWJpbGl0aWVzKFNQSUNFX0NIQU5ORUwob2JqZWN0KSk7CiAKQEAgLTE0ODgsNjEgKzE0ODQsNiBA
QCBzdGF0aWMgdm9pZCBkaXNwbGF5X3VwZGF0ZV9zdHJlYW1fcmVwb3J0KFNwaWNlRGlzcGxheUNo
YW5uZWwgKmNoYW5uZWwsIHVpbnQzMl90CiAgICAgfQogfQogCi0vKgotICogTWlncmF0aW9uIGNh
biBvY2N1ciBiZXR3ZWVuIDIgc3BpY2Utc2VydmVycyB3aXRoIGRpZmZlcmVudCBtbS10aW1lcy4K
LSAqIFRoZW4sIHRoZSBmb2xsb3dpbmcgY2FzZXMgY2FuIGhhcHBlbiBhZnRlciBtaWdyYXRpb24g
Y29tcGxldGVzOgotICogKFdlIHJlZmVyIHRvIHNyYy9kc3QtdGltZSBhcyB0aGUgbW0tdGltZXMg
b24gdGhlIHNyYy9kc3Qgc2VydmVycyk6Ci0gKgotICogKGNhc2UgMSkgRnJhbWVzIHdpdGggdGlt
ZSB+PSBkc3QtdGltZSBhcnJpdmUgdG8gdGhlIGNsaWVudCBiZWZvcmUgdGhlCi0gKiAgICAgICAg
ICBwbGF5YmFjay1jaGFubmVsIHVwZGF0ZXMgdGhlIHNlc3Npb24ncyBtbS10aW1lIChpLmUuLCB0
aGUgbW1fdGltZQotICogICAgICAgICAgb2YgdGhlIHNlc3Npb24gaXMgc3RpbGwgYmFzZWQgb24g
dGhlIHNyYy10aW1lKS4KLSAqICAgICAoYSkgSWYgc3JjLXRpbWUgPCBkc3QtdGltZToKLSAqICAg
ICAgICAgZGlzcGxheV9zdHJlYW1fc2NoZWR1bGUgc2NoZWR1bGVzIHRoZSBuZXh0IHJlbmRlcmlu
ZyB0bwotICogICAgICAgICB+KGRzdC10aW1lIC0gc3JjLXRpbWUpIG1pbGxpc2Vjb25kcyBmcm9t
IG5vdy4KLSAqICAgICAgICAgU2luY2Ugd2UgYXNzdW1lIG1vbm90b25pYyBtbV90aW1lLCBkaXNw
bGF5X3N0cmVhbV9zY2hlZHVsZSwKLSAqICAgICAgICAgcmV0dXJucyBpbW1lZGlhdGVseSB3aGVu
IGEgcmVuZGVyaW5nIHRpbWVvdXQKLSAqICAgICAgICAgaGFzIGFscmVhZHkgYmVlbiBzZXQsIGFu
ZCBkb2Vzbid0IHVwZGF0ZSB0aGUgdGltZW91dCwKLSAqICAgICAgICAgZXZlbiBhZnRlciB0aGUg
bW1fdGltZSBpcyB1cGRhdGVkLgotICogICAgICAgICBXaGVuIHNyYy10aW1lIDw8IGRzdC10aW1l
LCBhIHNpZ25pZmljYW50IHZpZGVvIGZyYW1lcyBsb3NzIHdpbGwgb2NjdXIuCi0gKiAgICAgKGIp
IElmIHNyYy10aW1lID4gZHN0LXRpbWUKLSAqICAgICAgICAgRnJhbWVzIHdpbGwgYmUgZHJvcHBl
ZCB0aWxsIHRoZSBtbS10aW1lIHdpbGwgYmUgdXBkYXRlZC4KLSAqIChjYXNlIDIpIG1tLXRpbWUg
aXMgc3luY2VkIHdpdGggZHN0LXRpbWUsIGJ1dCBmcmFtZXMgdGhhdCB3ZXJlIGluIHRoZSBjb21t
YW5kCi0gKiAgICAgICAgIHJpbmcgZHVyaW5nIG1pZ3JhdGlvbiBzdGlsbCBhcnJpdmUgKHN1Y2gg
ZnJhbWVzIGhvbGQgc3JjLXRpbWUpLgotICogICAgKGEpIElmIHNyYy10aW1lIDwgZHN0LXRpbWUK
LSAqICAgICAgICBUaGUgZnJhbWVzIHRoYXQgaG9sZCBzcmMtdGltZSB3aWxsIGJlIGRyb3BwZWQs
IHNpbmNlIHRoZWlyCi0gKiAgICAgICAgbW1fdGltZSA8IHNlc3Npb24tbW1fdGltZS4gQnV0IGFs
bCB0aGUgbmV3IGZyYW1lcyB0aGF0IGFyZSBnZW5lcmF0ZWQgaW4KLSAqICAgICAgICB0aGUgZHJp
dmVyIGFmdGVyIG1pZ3JhdGlvbiwgd2lsbCBiZSByZW5kZXJlZCBhcHByb3ByaWF0ZWx5LgotICog
ICAgKGIpIElmIHNyYy10aW1lID4gZHN0LXRpbWUKLSAqICAgICAgICBTaW1pbGFyIGNvbnNlcXVl
bmNlcyBhcyBpbiAxIChhKQotICogY2FzZSAyIGlzIGxlc3MgbGlrZWx5LCBzaW5jZSBhdCB0YWtl
cyBhdCBsZWFzdCAyMCBmcmFtZXMgdGlsbCB0aGUgZHN0LXNlcnZlciByZS1pZGVudGlmaWVzCi0g
KiB0aGUgdmlkZW8gc3RyZWFtIGFuZCBzdGFydHMgc2VuZGluZyBzdHJlYW0gZGF0YQotICoKLSAq
IGRpc3BsYXlfc2Vzc2lvbl9tbV90aW1lX3Jlc2V0X2NiIGhhbmRsZXMgY2FzZSAxLmEgYnkgbm90
aWZ5aW5nIHRoZQotICogdmlkZW8gZGVjb2RlcnMgdGhyb3VnaCB0aGVpciByZXNjaGVkdWxlKCkg
bWV0aG9kLCBhbmQgY2FzZSAyLmIgaXMgaGFuZGxlZAotICogZGlyZWN0bHkgYnkgdGhlIHZpZGVv
IGRlY29kZXJzIGluIHRoZWlyIHF1ZXVlX2ZyYW1lKCkgbWV0aG9kCi0gKi8KLQotLyogbWFpbiBj
b250ZXh0ICovCi1zdGF0aWMgdm9pZCBkaXNwbGF5X3Nlc3Npb25fbW1fdGltZV9yZXNldF9jYihT
cGljZVNlc3Npb24gKnNlc3Npb24sIGdwb2ludGVyIGRhdGEpCi17Ci0gICAgU3BpY2VDaGFubmVs
ICpjaGFubmVsID0gZGF0YTsKLSAgICBTcGljZURpc3BsYXlDaGFubmVsUHJpdmF0ZSAqYyA9IFNQ
SUNFX0RJU1BMQVlfQ0hBTk5FTChjaGFubmVsKS0+cHJpdjsKLSAgICBndWludCBpOwotCi0gICAg
Q0hBTk5FTF9ERUJVRyhjaGFubmVsLCAiJXMiLCBfX0ZVTkNUSU9OX18pOwotCi0gICAgZm9yIChp
ID0gMDsgaSA8IGMtPm5zdHJlYW1zOyBpKyspIHsKLSAgICAgICAgZGlzcGxheV9zdHJlYW0gKnN0
OwotCi0gICAgICAgIGlmIChjLT5zdHJlYW1zW2ldID09IE5VTEwpIHsKLSAgICAgICAgICAgIGNv
bnRpbnVlOwotICAgICAgICB9Ci0gICAgICAgIFNQSUNFX0RFQlVHKCIlczogc3RyZWFtLWlkICV1
IiwgX19GVU5DVElPTl9fLCBpKTsKLSAgICAgICAgc3QgPSBjLT5zdHJlYW1zW2ldOwotICAgICAg
ICBzdC0+dmlkZW9fZGVjb2Rlci0+cmVzY2hlZHVsZShzdC0+dmlkZW9fZGVjb2Rlcik7Ci0gICAg
fQotfQotCiAjZGVmaW5lIFNUUkVBTV9QTEFZQkFDS19TWU5DX0RST1BfU0VRX0xFTl9MSU1JVCA1
CiAKIHN0YXRpYyB2b2lkIGRpc3BsYXlfc3RyZWFtX3N0YXRzX2RlYnVnKGRpc3BsYXlfc3RyZWFt
ICpzdCkKLS0gCjIuMjAuMQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX18KU3BpY2UtZGV2ZWwgbWFpbGluZyBsaXN0ClNwaWNlLWRldmVsQGxpc3RzLmZyZWVk
ZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZv
L3NwaWNlLWRldmVs
