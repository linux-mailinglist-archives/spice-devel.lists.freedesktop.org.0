Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 8A1A887CAA
	for <lists+spice-devel@lfdr.de>; Fri,  9 Aug 2019 16:27:51 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 22FBB6EE29;
	Fri,  9 Aug 2019 14:27:50 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 8EAA06EE29
 for <spice-devel@lists.freedesktop.org>; Fri,  9 Aug 2019 14:27:48 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx07.intmail.prod.int.phx2.redhat.com
 [10.5.11.22])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id 3CBEF3001808
 for <spice-devel@lists.freedesktop.org>; Fri,  9 Aug 2019 14:27:48 +0000 (UTC)
Received: from fziglio.remote.csb (ovpn-204-160.brq.redhat.com [10.40.204.160])
 by smtp.corp.redhat.com (Postfix) with ESMTP id 8A2171001DE0;
 Fri,  9 Aug 2019 14:27:46 +0000 (UTC)
From: Frediano Ziglio <fziglio@redhat.com>
To: spice-devel@lists.freedesktop.org
Date: Fri,  9 Aug 2019 15:26:32 +0100
Message-Id: <20190809142651.2967-15-fziglio@redhat.com>
In-Reply-To: <20190809142651.2967-1-fziglio@redhat.com>
References: <20190809142651.2967-1-fziglio@redhat.com>
MIME-Version: 1.0
X-Scanned-By: MIMEDefang 2.84 on 10.5.11.22
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16
 (mx1.redhat.com [10.5.110.40]); Fri, 09 Aug 2019 14:27:48 +0000 (UTC)
Subject: [Spice-devel] [PATCH spice-gtk v2 14/33] fixup! usb-redir: add
 files for SCSI and USB MSC implementation
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

UmVtb3ZlIG51bV9sdW5zLCBmaXggY2Rfc2NzaV9jbWRfcmVwb3J0X2x1bnMuCm51bV9sdW5zIHdh
cyB1c2VkIG9ubHkgaW4gY2Rfc2NzaV9jbWRfcmVwb3J0X2x1bnMuCkluIGNkX3Njc2lfY21kX3Jl
cG9ydF9sdW5zIHRoZSBsZW5ndGggb2YgdGhlIGxpc3QgaXMgZXhwcmVzc2VkIGluCmJ5dGVzIGFu
ZCB0aGUgZm9ybWF0IG9mIHRoZSBMVU4gY2FuIGJlIHF1aXRlIGNvbXBsaWNhdGVkCih0aGUgbW9y
ZSBzaW1wbGUgaXMgdXNlZCBub3cpLgotLS0KIHNyYy9jZC1zY3NpLmMgfCA0OCArKysrKysrKysr
KysrKysrKysrKystLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIDEgZmlsZSBjaGFuZ2VkLCAy
MSBpbnNlcnRpb25zKCspLCAyNyBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9zcmMvY2Qtc2Nz
aS5jIGIvc3JjL2NkLXNjc2kuYwppbmRleCBkYmI3OGU1NC4uNjE2YzY1ZGEgMTAwNjQ0Ci0tLSBh
L3NyYy9jZC1zY3NpLmMKKysrIGIvc3JjL2NkLXNjc2kuYwpAQCAtMTA3LDcgKzEwNyw2IEBAIHN0
cnVjdCBDZFNjc2lUYXJnZXQgewogICAgIENkU2NzaVJlcXVlc3QgKmN1cl9yZXE7CiAgICAgR0Nh
bmNlbGxhYmxlICpjYW5jZWxsYWJsZTsKIAotICAgIHVpbnQzMl90IG51bV9sdW5zOwogICAgIHVp
bnQzMl90IG1heF9sdW5zOwogICAgIENkU2NzaUxVIHVuaXRzW01BWF9MVU5TXTsKIH07CkBAIC00
MzksNyArNDM4LDcgQEAgc3RhdGljIGlubGluZSBnYm9vbGVhbiBjZF9zY3NpX3RhcmdldF9sdW5f
bGVnYWwoY29uc3QgQ2RTY3NpVGFyZ2V0ICpzdCwgdWludDMyX3QKIAogc3RhdGljIGlubGluZSBn
Ym9vbGVhbiBjZF9zY3NpX3RhcmdldF9sdW5fcmVhbGl6ZWQoY29uc3QgQ2RTY3NpVGFyZ2V0ICpz
dCwgdWludDMyX3QgbHVuKQogewotICAgIHJldHVybiAoc3QtPm51bV9sdW5zID09IDAgfHwgIXN0
LT51bml0c1tsdW5dLnJlYWxpemVkKSA/IEZBTFNFIDogVFJVRTsKKyAgICByZXR1cm4gc3QtPnVu
aXRzW2x1bl0ucmVhbGl6ZWQ7CiB9CiAKIGludCBjZF9zY3NpX2Rldl9yZWFsaXplKENkU2NzaVRh
cmdldCAqc3QsIHVpbnQzMl90IGx1biwKQEAgLTQ4MCw4ICs0NzksNiBAQCBpbnQgY2Rfc2NzaV9k
ZXZfcmVhbGl6ZShDZFNjc2lUYXJnZXQgKnN0LCB1aW50MzJfdCBsdW4sCiAKICAgICBjZF9zY3Np
X2Rldl9zZW5zZV9zZXRfcG93ZXJfb24oZGV2KTsKIAotICAgIHN0LT5udW1fbHVucyArKzsKLQog
ICAgIFNQSUNFX0RFQlVHKCJSZWFsaXplIGx1bjoldSBiczoldSBWUjpbJXNdIFBUOlslc10gdmVy
Olslc10gU05bJXNdIiwKICAgICAgICAgICAgICAgICBsdW4sIGRldi0+YmxvY2tfc2l6ZSwgZGV2
LT52ZW5kb3IsCiAgICAgICAgICAgICAgICAgZGV2LT5wcm9kdWN0LCBkZXYtPnZlcnNpb24sIGRl
di0+c2VyaWFsKTsKQEAgLTY1OCw4ICs2NTUsNiBAQCBpbnQgY2Rfc2NzaV9kZXZfdW5yZWFsaXpl
KENkU2NzaVRhcmdldCAqc3QsIHVpbnQzMl90IGx1bikKICAgICBkZXYtPnJlYWxpemVkID0gRkFM
U0U7CiAgICAgZGV2LT5wb3dlcl9jb25kID0gQ0RfU0NTSV9QT1dFUl9TVE9QUEVEOwogCi0gICAg
c3QtPm51bV9sdW5zIC0tOwotCiAgICAgU1BJQ0VfREVCVUcoIlVucmVhbGl6ZSBsdW46JXUiLCBs
dW4pOwogICAgIHJldHVybiAwOwogfQpAQCAtODc0LDM3ICs4NjksMzYgQEAgc3RhdGljIHZvaWQg
Y2Rfc2NzaV9jbWRfcmVwb3J0X2x1bnMoQ2RTY3NpVGFyZ2V0ICpzdCwgQ2RTY3NpTFUgKmRldiwK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENkU2NzaVJlcXVlc3QgKnJlcSkK
IHsKICAgICB1aW50OF90ICpvdXRfYnVmID0gcmVxLT5idWY7Ci0gICAgdWludDMyX3QgbnVtX2x1
bnMgPSBzdC0+bnVtX2x1bnM7CisgICAgdWludDMyX3QgbWF4X2x1bnMgPSBzdC0+bWF4X2x1bnM7
CiAgICAgdWludDMyX3QgYnVmbGVuID0gODsgLyogaGVhZGVyIGxlbmd0aCAqLwogICAgIHVpbnQz
Ml90IGx1bjsKIAogICAgIHJlcS0+cmVxX2xlbiA9IHNjc2lfY2RiX3hmZXJfbGVuZ3RoKHJlcS0+
Y2RiLCAxMik7CiAgICAgcmVxLT54ZmVyX2RpciA9IFNDU0lfWEZFUl9GUk9NX0RFVjsKIAotICAg
IGlmIChyZXEtPmNkYlswXSA9PSAweDAxKSB7CisgICAgLyogY2hlY2sgU0VMRUNUIFJFUE9SVCBm
aWVsZCAqLworICAgIGlmIChyZXEtPmNkYlsyXSA9PSAweDAxKSB7CiAgICAgICAgIC8qIG9ubHkg
d2VsbCBrbm93biBsb2dpY2FsIHVuaXRzICovCi0gICAgICAgIG51bV9sdW5zID0gMDsKLSAgICB9
Ci0KLSAgICBvdXRfYnVmWzBdID0gKHVpbnQ4X3QpKG51bV9sdW5zID4+IDI0KTsKLSAgICBvdXRf
YnVmWzFdID0gKHVpbnQ4X3QpKG51bV9sdW5zID4+IDE2KTsKLSAgICBvdXRfYnVmWzJdID0gKHVp
bnQ4X3QpKG51bV9sdW5zID4+IDgpOwotICAgIG91dF9idWZbM10gPSAodWludDhfdCkobnVtX2x1
bnMpOwotICAgIG1lbXNldCgmb3V0X2J1Zls0XSwgMCwgNCk7Ci0KLSAgICBpZiAobnVtX2x1bnMg
PiAwKSB7Ci0gICAgICAgIGZvciAobHVuID0gMDsgbHVuIDwgbnVtX2x1bnM7IGx1bisrKSB7Ci0g
ICAgICAgICAgICBpZiAoc3QtPnVuaXRzW2x1bl0ucmVhbGl6ZWQpIHsKLSAgICAgICAgICAgICAg
ICBvdXRfYnVmW2J1ZmxlbisrXSA9ICh1aW50OF90KShudW1fbHVucyA+PiAyNCk7Ci0gICAgICAg
ICAgICAgICAgb3V0X2J1ZltidWZsZW4rK10gPSAodWludDhfdCkobnVtX2x1bnMgPj4gMTYpOwot
ICAgICAgICAgICAgICAgIG91dF9idWZbYnVmbGVuKytdID0gKHVpbnQ4X3QpKG51bV9sdW5zID4+
IDgpOwotICAgICAgICAgICAgICAgIG91dF9idWZbYnVmbGVuKytdID0gKHVpbnQ4X3QpKG51bV9s
dW5zKTsKLSAgICAgICAgICAgICAgICBtZW1zZXQoJm91dF9idWZbYnVmbGVuXSwgMCwgNCk7Ci0g
ICAgICAgICAgICAgICAgYnVmbGVuICs9IDQ7Ci0gICAgICAgICAgICB9CisgICAgICAgIG1heF9s
dW5zID0gMDsKKyAgICB9CisKKyAgICBtZW1zZXQob3V0X2J1ZiwgMCwgOCk7CisKKyAgICBmb3Ig
KGx1biA9IDA7IGx1biA8IG1heF9sdW5zOyBsdW4rKykgeworICAgICAgICBpZiAoc3QtPnVuaXRz
W2x1bl0ucmVhbGl6ZWQpIHsKKyAgICAgICAgICAgIG91dF9idWZbYnVmbGVuKytdID0gMDsKKyAg
ICAgICAgICAgIG91dF9idWZbYnVmbGVuKytdID0gKHVpbnQ4X3QpKGx1bik7CisgICAgICAgICAg
ICBtZW1zZXQoJm91dF9idWZbYnVmbGVuXSwgMCwgNik7CisgICAgICAgICAgICBidWZsZW4gKz0g
NjsKICAgICAgICAgfQogICAgIH0KIAorICAgIC8qIGZpbGwgTFVOIExJU1QgTEVOR1RIICovCisg
ICAgb3V0X2J1ZlswXSA9ICh1aW50OF90KSgoYnVmbGVuLTgpID4+IDI0KTsKKyAgICBvdXRfYnVm
WzFdID0gKHVpbnQ4X3QpKChidWZsZW4tOCkgPj4gMTYpOworICAgIG91dF9idWZbMl0gPSAodWlu
dDhfdCkoKGJ1Zmxlbi04KSA+PiA4KTsKKyAgICBvdXRfYnVmWzNdID0gKHVpbnQ4X3QpKChidWZs
ZW4tOCkpOworCiAgICAgcmVxLT5pbl9sZW4gPSBidWZsZW47CiAgICAgY2Rfc2NzaV9jbWRfY29t
cGxldGVfZ29vZChkZXYsIHJlcSk7CiB9Ci0tIAoyLjIwLjEKCl9fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fClNwaWNlLWRldmVsIG1haWxpbmcgbGlzdApTcGlj
ZS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5v
cmcvbWFpbG1hbi9saXN0aW5mby9zcGljZS1kZXZlbA==
