Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id F07E9499E1
	for <lists+spice-devel@lfdr.de>; Tue, 18 Jun 2019 09:07:12 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 48CB56E0DA;
	Tue, 18 Jun 2019 07:07:11 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 1FA356E0DA
 for <spice-devel@lists.freedesktop.org>; Tue, 18 Jun 2019 07:07:10 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx01.intmail.prod.int.phx2.redhat.com
 [10.5.11.11])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id B14763092665;
 Tue, 18 Jun 2019 07:07:09 +0000 (UTC)
Received: from colo-mx.corp.redhat.com
 (colo-mx01.intmail.prod.int.phx2.redhat.com [10.5.11.20])
 by smtp.corp.redhat.com (Postfix) with ESMTPS id A3C267D510;
 Tue, 18 Jun 2019 07:07:09 +0000 (UTC)
Received: from zmail25.collab.prod.int.phx2.redhat.com
 (zmail25.collab.prod.int.phx2.redhat.com [10.5.83.31])
 by colo-mx.corp.redhat.com (Postfix) with ESMTP id 98F6A1806B16;
 Tue, 18 Jun 2019 07:07:09 +0000 (UTC)
Date: Tue, 18 Jun 2019 03:07:08 -0400 (EDT)
From: Frediano Ziglio <fziglio@redhat.com>
To: Francois Gouget <fgouget@codeweavers.com>
Message-ID: <1427472542.23347584.1560841628023.JavaMail.zimbra@redhat.com>
In-Reply-To: <ead1a35d2f1faaf2508005b74998ec3614b4c90e.1560790607.git.fgouget@free.fr>
References: <cover.1560790607.git.fgouget@free.fr>
 <ead1a35d2f1faaf2508005b74998ec3614b4c90e.1560790607.git.fgouget@free.fr>
MIME-Version: 1.0
X-Originating-IP: [10.40.204.128, 10.4.195.5]
Thread-Topic: gstreamer: Improve the statistics collection
Thread-Index: KRW1QCdq4p6UHOs3YmZwPlZvfxXCxA==
X-Scanned-By: MIMEDefang 2.79 on 10.5.11.11
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16
 (mx1.redhat.com [10.5.110.43]); Tue, 18 Jun 2019 07:07:09 +0000 (UTC)
Subject: Re: [Spice-devel] [client v2 03/12] gstreamer: Improve the
 statistics collection
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Spice devel <spice-devel@lists.freedesktop.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

Cj4gCj4gQnkgdGhlIHRpbWUgc2NoZWR1bGVfZnJhbWUoKSBwdWxscyBhIHNhbXBsZSBvZmYgR1N0
cmVhbWVyJ3MgcGlwZWxpbmUgdGhlCj4gZnJhbWUgbWF5IGhhdmUgYmVlbiBkZWNvZGVkIGZvciBo
dW5kcmVkcyBvZiBtaWxsaXNlY29uZHMsIG1ha2luZyB0aGUKPiBkZWNvZGluZyB0aW1lIGFsbCBi
dXQgbWVhbmluZ2xlc3MuCj4gVGhpcyBwYXRjaCBlbnN1cmVzIHRoZSBzdGF0aXN0aWNzIGFyZSBh
bHdheXMgY29sbGVjdGVkIGJ5Cj4gc2lua19ldmVudF9wcm9iZSgpIHdoaWNoIGlzIGNhbGxlZCBh
cyBzb29uIGFzIHRoZSBkZWNvZGVkIGZyYW1lIGlzCj4gYXZhaWxhYmxlLgo+IE5vdGUgdGhhdCBl
dmVuIHNvIHRoZSBkZWNvZGluZyB0aW1lIG1heSBiZSBvdmVyZXN0aW1hdGVkIGFzIHRoZSBmcmFt
ZQo+IG1heSBoYXZlIGJlZW4gd2FpdGluZyBmb3IgYSB3aGlsZSBpbiBlbmNvZGVkIGZvcm0gZm9y
IGEgc3BvdCB0byBiZSBmcmVlZAo+IGluIHRoZSBHU3RyZWFtZXIgcGlwZWxpbmUncyBzaW5rIHF1
ZXVlLgo+IAo+IFNpZ25lZC1vZmYtYnk6IEZyYW5jb2lzIEdvdWdldCA8ZmdvdWdldEBjb2Rld2Vh
dmVycy5jb20+CgpBY2tlZAoKPiAtLS0KPiAKPiB2MjogTm8gY2hhbmdlLgo+IAo+ICBzcmMvY2hh
bm5lbC1kaXNwbGF5LWdzdC5jIHwgMTA1ICsrKysrKysrKysrKysrKysrKysrKy0tLS0tLS0tLS0t
LS0tLS0tCj4gIDEgZmlsZSBjaGFuZ2VkLCA1OSBpbnNlcnRpb25zKCspLCA0NiBkZWxldGlvbnMo
LSkKPiAKPiBkaWZmIC0tZ2l0IGEvc3JjL2NoYW5uZWwtZGlzcGxheS1nc3QuYyBiL3NyYy9jaGFu
bmVsLWRpc3BsYXktZ3N0LmMKPiBpbmRleCA5MzA2NDYyNS4uYzJiMjRlYTcgMTAwNjQ0Cj4gLS0t
IGEvc3JjL2NoYW5uZWwtZGlzcGxheS1nc3QuYwo+ICsrKyBiL3NyYy9jaGFubmVsLWRpc3BsYXkt
Z3N0LmMKPiBAQCAtMSw2ICsxLDYgQEAKPiAgLyogLSotIE1vZGU6IEM7IGMtYmFzaWMtb2Zmc2V0
OiA0OyBpbmRlbnQtdGFicy1tb2RlOiBuaWwgLSotICovCj4gIC8qCj4gLSAgIENvcHlyaWdodCAo
QykgMjAxNS0yMDE2IENvZGVXZWF2ZXJzLCBJbmMKPiArICAgQ29weXJpZ2h0IChDKSAyMDE1LTIw
MTYsIDIwMTkgQ29kZVdlYXZlcnMsIEluYwo+ICAKPiAgICAgVGhpcyBsaWJyYXJ5IGlzIGZyZWUg
c29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vcgo+ICAgICBtb2RpZnkgaXQg
dW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCj4gQEAgLTE4
NSwxMyArMTg1LDE2IEBAIHN0YXRpYyBnYm9vbGVhbiBkaXNwbGF5X2ZyYW1lKGdwb2ludGVyIHZp
ZGVvX2RlY29kZXIpCj4gICAgICByZXR1cm4gR19TT1VSQ0VfUkVNT1ZFOwo+ICB9Cj4gIAo+IC0v
KiBHZXQgdGhlIGRlY29kZWQgZnJhbWUgcmVsYXRpdmUgdG8gYnVmZmVyIG9yIE5VTEwgaWYgbm90
IGZvdW5kLgo+IC0gKiBEZXF1ZXVlIHRoZSBmcmFtZSBmcm9tIGRlY29kaW5nX3F1ZXVlIGFuZCBy
ZXR1cm4gaXQsIGNhbGxlcgo+IC0gKiBpcyByZXNwb25zaWJsZSB0byBmcmVlIHRoZSBwb2ludGVy
Lgo+ICsvKiBSZXR1cm5zIHRoZSBkZWNvZGluZyBxdWV1ZSBlbnRyeSB0aGF0IG1hdGNoZXMgdGhl
IHNwZWNpZmllZCBHU3RyZWFtZXIKPiBidWZmZXIuCj4gKyAqCj4gKyAqIFRoZSBlbnRyeSBpcyBp
ZGVudGlmaWVkIGJhc2VkIG9uIHRoZSBidWZmZXIgdGltZXN0YW1wLiBIb3dldmVyIHNvbWV0aW1l
cwo+ICsgKiBHU3RyZWFtZXIgcmV0dXJucyB0aGUgc2FtZSBidWZmZXIgdHdpY2UgKGFuZCB0aGUg
c2Vjb25kIHRpbWUgdGhlIGVudHJ5Cj4gbWF5Cj4gKyAqIGhhdmUgYmVlbiByZW1vdmVkIGFscmVh
ZHkpIG9yIGJ1ZmZlcnMgdGhhdCBoYXZlIGEgbW9kaWZpZWQsIGFuZCB0aHVzCj4gKyAqIHVucmVj
b2duaXphYmxlLCB0aW1lc3RhbXAuIEluIHN1Y2ggY2FzZXMgTlVMTCBpcyByZXR1cm5lZC4KPiAg
ICoKPiAgICogcXVldWVzX211dGV4IG11c3QgYmUgaGVsZC4KPiAgICovCj4gLXN0YXRpYyBTcGlj
ZUdzdEZyYW1lICpnZXRfZGVjb2RlZF9mcmFtZShTcGljZUdzdERlY29kZXIgKmRlY29kZXIsIEdz
dEJ1ZmZlcgo+ICpidWZmZXIpCj4gK3N0YXRpYyBHTGlzdCAqZmluZF9mcmFtZV9lbnRyeShTcGlj
ZUdzdERlY29kZXIgKmRlY29kZXIsIEdzdEJ1ZmZlciAqYnVmZmVyKQo+ICB7Cj4gICAgICBHc3RD
bG9ja1RpbWUgYnVmZmVyX3RzID0gR1NUX0JVRkZFUl9QVFMoYnVmZmVyKTsKPiAgI2lmIEdTVF9D
SEVDS19WRVJTSU9OKDEsMTQsMCkKPiBAQCAtMjAzLDQ5ICsyMDYsMzQgQEAgc3RhdGljIFNwaWNl
R3N0RnJhbWUgKmdldF9kZWNvZGVkX2ZyYW1lKFNwaWNlR3N0RGVjb2Rlcgo+ICpkZWNvZGVyLCBH
c3RCdWZmZXIgKmJ1Zgo+ICAgICAgfQo+ICAjZW5kaWYKPiAgCj4gLSAgICAvKiBHc3RyZWFtZXIg
c29tZXRpbWVzIHJldHVybnMgdGhlIHNhbWUgYnVmZmVyIHR3aWNlCj4gLSAgICAgKiBvciBidWZm
ZXJzIHRoYXQgaGF2ZSBhIG1vZGlmaWVkLCBhbmQgdGh1cyB1bnJlY29nbml6YWJsZSwgUFRTLgo+
IC0gICAgICogQmxpbmRseSByZW1vdmluZyBmcmFtZXMgZnJvbSB0aGUgZGVjb2RpbmdfcXVldWUg
dW50aWwgd2UgZmluZCBhCj4gLSAgICAgKiBtYXRjaCB3b3VsZCBvbmx5IGVtcHR5IHRoZSBxdWV1
ZSwgcmVzdWx0aW5nIGluIGxhdGVyIGJ1ZmZlcnMgbm90Cj4gLSAgICAgKiBmaW5kaW5nIGEgbWF0
Y2ggZWl0aGVyLCBldGMuIFNvIGNoZWNrIHRoZSBidWZmZXIgaGFzIGEgbWF0Y2hpbmcKPiAtICAg
ICAqIGZyYW1lIGZpcnN0Lgo+IC0gICAgICovCj4gLSAgICBTcGljZUdzdEZyYW1lICpnc3RmcmFt
ZSA9IE5VTEw7Cj4gICAgICBHTGlzdCAqbCA9IGdfcXVldWVfcGVla19oZWFkX2xpbmsoZGVjb2Rl
ci0+ZGVjb2RpbmdfcXVldWUpOwo+ICAgICAgd2hpbGUgKGwpIHsKPiAtICAgICAgICBnc3RmcmFt
ZSA9IGwtPmRhdGE7Cj4gKyAgICAgICAgY29uc3QgU3BpY2VHc3RGcmFtZSAqZ3N0ZnJhbWUgPSBs
LT5kYXRhOwo+ICAgICAgICAgIGlmIChnc3RmcmFtZS0+dGltZXN0YW1wID09IGJ1ZmZlcl90cykg
ewo+IC0gICAgICAgICAgICBicmVhazsKPiArICAgICAgICAgICAgcmV0dXJuIGw7Cj4gICAgICAg
ICAgfQo+IC0gICAgICAgIGdzdGZyYW1lID0gTlVMTDsKPiAgICAgICAgICBsID0gbC0+bmV4dDsK
PiAgICAgIH0KPiAgCj4gLSAgICBpZiAoZ3N0ZnJhbWUgIT0gTlVMTCkgewo+IC0gICAgICAgIC8q
IE5vdyB0aGF0IHdlIGtub3cgdGhlcmUgaXMgYSBtYXRjaCwgcmVtb3ZlIGl0IGFuZCB0aGUgb2xk
ZXIKPiAtICAgICAgICAgKiBmcmFtZXMgZnJvbSB0aGUgZGVjb2RpbmcgcXVldWUgKi8KPiAtICAg
ICAgICBTcGljZUdzdEZyYW1lICpsYXRlX2ZyYW1lOwo+IC0gICAgICAgIGd1aW50IG51bV9mcmFt
ZXNfZHJvcHBlZCA9IDA7Cj4gLQo+IC0gICAgICAgIC8qIFRoZSBHU3RyZWFtZXIgcGlwZWxpbmUg
ZHJvcHBlZCB0aGUgY29ycmVzcG9uZGluZyBidWZmZXIuICovCj4gLSAgICAgICAgd2hpbGUgKChs
YXRlX2ZyYW1lID0gZ19xdWV1ZV9wb3BfaGVhZChkZWNvZGVyLT5kZWNvZGluZ19xdWV1ZSkpICE9
Cj4gZ3N0ZnJhbWUpIHsKPiAtICAgICAgICAgICAgbnVtX2ZyYW1lc19kcm9wcGVkKys7Cj4gLSAg
ICAgICAgICAgIGZyZWVfZ3N0X2ZyYW1lKGxhdGVfZnJhbWUpOwo+IC0gICAgICAgIH0KPiArICAg
IHJldHVybiBOVUxMOwo+ICt9Cj4gIAo+IC0gICAgICAgIGlmIChudW1fZnJhbWVzX2Ryb3BwZWQg
IT0gMCkgewo+IC0gICAgICAgICAgICBTUElDRV9ERUJVRygidGhlIEdTdHJlYW1lciBwaXBlbGlu
ZSBkcm9wcGVkICV1IGZyYW1lcyIsCj4gbnVtX2ZyYW1lc19kcm9wcGVkKTsKPiAtICAgICAgICB9
Cj4gKy8qIFBvcHMgdGhlIHF1ZXVlZCBmcmFtZXMgdXAgdG8gYW5kIGluY2x1ZGluZyB0aGUgc3Bl
Y2lmaWVkIGZyYW1lLgo+ICsgKiBBbGwgZnJhbWVzIGFyZSBmcmVlZCBleGNlcHQgdGhhdCBsYXN0
IGZyYW1lIHdoaWNoIGJlbG9uZ3MgdG8gdGhlIGNhbGxlci4KPiArICogUmV0dXJucyB0aGUgbnVt
YmVyIG9mIGZyZWVkIGZyYW1lcy4KPiArICoKPiArICogcXVldWVzX211dGV4IG11c3QgYmUgaGVs
ZC4KPiArICovCj4gK3N0YXRpYyBndWludDMyIHBvcF91cF90b19mcmFtZShTcGljZUdzdERlY29k
ZXIgKmRlY29kZXIsIGNvbnN0IFNwaWNlR3N0RnJhbWUKPiAqcG9wZnJhbWUpCj4gK3sKPiArICAg
IFNwaWNlR3N0RnJhbWUgKmdzdGZyYW1lOwo+ICsgICAgZ3VpbnQzMiBmcmVlZCA9IDA7Cj4gIAo+
IC0gICAgICAgIGNvbnN0IFNwaWNlRnJhbWUgKmZyYW1lID0gZ3N0ZnJhbWUtPmVuY29kZWRfZnJh
bWU7Cj4gLSAgICAgICAgaW50NjRfdCBkdXJhdGlvbiA9IGdfZ2V0X21vbm90b25pY190aW1lKCkg
LSBmcmFtZS0+Y3JlYXRpb25fdGltZTsKPiAtICAgICAgICByZWNvcmQoZnJhbWVzX3N0YXRzLAo+
IC0gICAgICAgICAgICAgICAiZnJhbWUgbW1fdGltZSAldSBzaXplICV1IGNyZWF0aW9uIHRpbWUg
JSIgUFJJZDY0Cj4gLSAgICAgICAgICAgICAgICIgZGVjb2RlZCB0aW1lICUiIFBSSWQ2NCAiIHF1
ZXVlICV1IiwKPiAtICAgICAgICAgICAgICAgZnJhbWUtPm1tX3RpbWUsIGZyYW1lLT5zaXplLCBm
cmFtZS0+Y3JlYXRpb25fdGltZSwKPiAtICAgICAgICAgICAgICAgZHVyYXRpb24sIGRlY29kZXIt
PmRlY29kaW5nX3F1ZXVlLT5sZW5ndGgpOwo+ICsgICAgd2hpbGUgKChnc3RmcmFtZSA9IGdfcXVl
dWVfcG9wX2hlYWQoZGVjb2Rlci0+ZGVjb2RpbmdfcXVldWUpKSAhPQo+IHBvcGZyYW1lKSB7Cj4g
KyAgICAgICAgZnJlZV9nc3RfZnJhbWUoZ3N0ZnJhbWUpOwo+ICsgICAgICAgIGZyZWVkKys7Cj4g
ICAgICB9Cj4gLSAgICByZXR1cm4gZ3N0ZnJhbWU7Cj4gKyAgICByZXR1cm4gZnJlZWQ7Cj4gIH0K
PiAgCj4gIC8qIEhlbHBlciBmb3Igc2NoZWR1bGVfZnJhbWUoKS4KPiBAQCAtMjY4LDggKzI1Niwx
NiBAQCBzdGF0aWMgdm9pZCBmZXRjaF9wZW5kaW5nX3NhbXBsZShTcGljZUdzdERlY29kZXIKPiAq
ZGVjb2RlcikKPiAgICAgICAgICAgKiBmaW5kaW5nIGEgbWF0Y2ggZWl0aGVyLCBldGMuIFNvIGNo
ZWNrIHRoZSBidWZmZXIgaGFzIGEgbWF0Y2hpbmcKPiAgICAgICAgICAgKiBmcmFtZSBmaXJzdC4K
PiAgICAgICAgICAgKi8KPiAtICAgICAgICBTcGljZUdzdEZyYW1lICpnc3RmcmFtZSA9IGdldF9k
ZWNvZGVkX2ZyYW1lKGRlY29kZXIsIGJ1ZmZlcik7Cj4gLSAgICAgICAgaWYgKGdzdGZyYW1lKSB7
Cj4gKyAgICAgICAgR0xpc3QgKmwgPSBmaW5kX2ZyYW1lX2VudHJ5KGRlY29kZXIsIGJ1ZmZlcik7
Cj4gKyAgICAgICAgaWYgKGwpIHsKPiArICAgICAgICAgICAgU3BpY2VHc3RGcmFtZSAqZ3N0ZnJh
bWUgPSBsLT5kYXRhOwo+ICsKPiArICAgICAgICAgICAgLyogRGVxdWV1ZSB0aGlzIGFuZCBhbnkg
ZHJvcHBlZCBmcmFtZXMgKi8KPiArICAgICAgICAgICAgZ3VpbnQzMiBkcm9wcGVkID0gcG9wX3Vw
X3RvX2ZyYW1lKGRlY29kZXIsIGdzdGZyYW1lKTsKPiArICAgICAgICAgICAgaWYgKGRyb3BwZWQp
IHsKPiArICAgICAgICAgICAgICAgIFNQSUNFX0RFQlVHKCJ0aGUgR1N0cmVhbWVyIHBpcGVsaW5l
IGRyb3BwZWQgJXUgZnJhbWVzIiwKPiBkcm9wcGVkKTsKPiArICAgICAgICAgICAgfQo+ICsKPiAg
ICAgICAgICAgICAgLyogVGhlIGZyYW1lIGlzIG5vdyByZWFkeSBmb3IgZGlzcGxheSAqLwo+ICAg
ICAgICAgICAgICBnc3RmcmFtZS0+ZGVjb2RlZF9zYW1wbGUgPSBzYW1wbGU7Cj4gICAgICAgICAg
ICAgIGRlY29kZXItPmRpc3BsYXlfZnJhbWUgPSBnc3RmcmFtZTsKPiBAQCAtNDM4LDEwICs0MzQs
MjggQEAgc2lua19ldmVudF9wcm9iZShHc3RQYWQgKnBhZCwgR3N0UGFkUHJvYmVJbmZvICppbmZv
LAo+IGdwb2ludGVyIGRhdGEpCj4gICAgICBpZiAoaW5mby0+dHlwZSAmIEdTVF9QQURfUFJPQkVf
VFlQRV9CVUZGRVIpIHsgLy8gQnVmZmVyIGFycml2ZWQKPiAgICAgICAgICBHc3RCdWZmZXIgKmJ1
ZmZlciA9IEdTVF9QQURfUFJPQkVfSU5GT19CVUZGRVIoaW5mbyk7Cj4gICAgICAgICAgZ19tdXRl
eF9sb2NrKCZkZWNvZGVyLT5xdWV1ZXNfbXV0ZXgpOwo+IC0gICAgICAgIFNwaWNlR3N0RnJhbWUg
KmdzdGZyYW1lID0gZ2V0X2RlY29kZWRfZnJhbWUoZGVjb2RlciwgYnVmZmVyKTsKPiAtICAgICAg
ICBpZiAoZ3N0ZnJhbWUpIHsKPiAtICAgICAgICAgICAgZnJlZV9nc3RfZnJhbWUoZ3N0ZnJhbWUp
Owo+ICsKPiArICAgICAgICBHTGlzdCAqbCA9IGZpbmRfZnJhbWVfZW50cnkoZGVjb2RlciwgYnVm
ZmVyKTsKPiArICAgICAgICBpZiAobCkgewo+ICsgICAgICAgICAgICBTcGljZUdzdEZyYW1lICpn
c3RmcmFtZSA9IGwtPmRhdGE7Cj4gKyAgICAgICAgICAgIGNvbnN0IFNwaWNlRnJhbWUgKmZyYW1l
ID0gZ3N0ZnJhbWUtPmVuY29kZWRfZnJhbWU7Cj4gKyAgICAgICAgICAgIGludDY0X3QgZHVyYXRp
b24gPSBnX2dldF9tb25vdG9uaWNfdGltZSgpIC0KPiBmcmFtZS0+Y3JlYXRpb25fdGltZTsKPiAr
ICAgICAgICAgICAgcmVjb3JkKGZyYW1lc19zdGF0cywKPiArICAgICAgICAgICAgICAgICAgICJm
cmFtZSBtbV90aW1lICV1IHNpemUgJXUgY3JlYXRpb24gdGltZSAlIiBQUklkNjQKPiArICAgICAg
ICAgICAgICAgICAgICIgZGVjb2RlZCB0aW1lICUiIFBSSWQ2NCAiIHF1ZXVlICV1IiwKPiArICAg
ICAgICAgICAgICAgICAgIGZyYW1lLT5tbV90aW1lLCBmcmFtZS0+c2l6ZSwgZnJhbWUtPmNyZWF0
aW9uX3RpbWUsCj4gZHVyYXRpb24sCj4gKyAgICAgICAgICAgICAgICAgICBkZWNvZGVyLT5kZWNv
ZGluZ19xdWV1ZS0+bGVuZ3RoKTsKPiArCj4gKyAgICAgICAgICAgIGlmICghZGVjb2Rlci0+YXBw
c2luaykgewo+ICsgICAgICAgICAgICAgICAgLyogVGhlIHNpbmsgd2lsbCBkaXNwbGF5IHRoZSBm
cmFtZSBkaXJlY3RseSBzbyB0aGlzCj4gKyAgICAgICAgICAgICAgICAgKiBTcGljZUdzdEZyYW1l
IGFuZCB0aG9zZSBvZiBhbnkgZHJvcHBlZCBmcmFtZSBhcmUgbm8KPiBsb25nZXIKPiArICAgICAg
ICAgICAgICAgICAqIG5lZWRlZC4KPiArICAgICAgICAgICAgICAgICAqLwo+ICsgICAgICAgICAg
ICAgICAgcG9wX3VwX3RvX2ZyYW1lKGRlY29kZXIsIGdzdGZyYW1lKTsKPiArICAgICAgICAgICAg
ICAgIGZyZWVfZ3N0X2ZyYW1lKGdzdGZyYW1lKTsKPiArICAgICAgICAgICAgfQo+ICAgICAgICAg
IH0KPiArCj4gICAgICAgICAgZ19tdXRleF91bmxvY2soJmRlY29kZXItPnF1ZXVlc19tdXRleCk7
Cj4gICAgICB9Cj4gICAgICByZXR1cm4gR1NUX1BBRF9QUk9CRV9PSzsKPiBAQCAtNDUyLDkgKzQ2
Niw4IEBAIHN0YXRpYyB2b2lkCj4gIGRlZXBfZWxlbWVudF9hZGRlZF9jYihHc3RCaW4gKnBpcGVs
aW5lLCBHc3RCaW4gKmJpbiwgR3N0RWxlbWVudCAqZWxlbWVudCwKPiAgICAgICAgICAgICAgICAg
ICAgICAgIFNwaWNlR3N0RGVjb2RlciAqZGVjb2RlcikKPiAgewo+IC0gICAgLyogYXR0YWNoIGEg
cHJvYmUgdG8gdGhlIHNpbmsgaW4gY2FzZSB3ZSBkb24ndCBoYXZlIGFwcHNpbmsgKHRoYXQKPiAt
ICAgICAqIGlzIHRoZSBmcmFtZXMgZG9lcyBub3QgZ28gdG8gbmV3X3NhbXBsZSAqLwo+IC0gICAg
aWYgKEdTVF9JU19CQVNFX1NJTksoZWxlbWVudCkgJiYgZGVjb2Rlci0+YXBwc2luayA9PSBOVUxM
KSB7Cj4gKyAgICAvKiBBdHRhY2ggYSBwcm9iZSB0byB0aGUgc2luayB0byB1cGRhdGUgdGhlIHN0
YXRpc3RpY3MgKi8KPiArICAgIGlmIChHU1RfSVNfQkFTRV9TSU5LKGVsZW1lbnQpKSB7Cj4gICAg
ICAgICAgR3N0UGFkICpwYWQgPSBnc3RfZWxlbWVudF9nZXRfc3RhdGljX3BhZChlbGVtZW50LCAi
c2luayIpOwo+ICAgICAgICAgIGdzdF9wYWRfYWRkX3Byb2JlKHBhZCwgR1NUX1BBRF9QUk9CRV9U
WVBFX0JVRkZFUiwgc2lua19ldmVudF9wcm9iZSwKPiAgICAgICAgICBkZWNvZGVyLCBOVUxMKTsK
PiAgICAgICAgICBnc3Rfb2JqZWN0X3VucmVmKHBhZCk7CgpfX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fXwpTcGljZS1kZXZlbCBtYWlsaW5nIGxpc3QKU3BpY2Ut
ZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3Jn
L21haWxtYW4vbGlzdGluZm8vc3BpY2UtZGV2ZWw=
