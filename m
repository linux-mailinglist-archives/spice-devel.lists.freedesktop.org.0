Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 698C99E3F0
	for <lists+spice-devel@lfdr.de>; Tue, 27 Aug 2019 11:23:06 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id DE82B89854;
	Tue, 27 Aug 2019 09:23:04 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id E250789854
 for <spice-devel@lists.freedesktop.org>; Tue, 27 Aug 2019 09:23:03 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx04.intmail.prod.int.phx2.redhat.com
 [10.5.11.14])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id 8BE17308A9E0;
 Tue, 27 Aug 2019 09:23:03 +0000 (UTC)
Received: from fziglio.remote.csb (ovpn-204-114.brq.redhat.com [10.40.204.114])
 by smtp.corp.redhat.com (Postfix) with ESMTP id 772915D9CC;
 Tue, 27 Aug 2019 09:23:01 +0000 (UTC)
From: Frediano Ziglio <fziglio@redhat.com>
To: spice-devel@lists.freedesktop.org
Date: Tue, 27 Aug 2019 10:22:20 +0100
Message-Id: <20190827092246.10276-4-fziglio@redhat.com>
In-Reply-To: <20190827092246.10276-1-fziglio@redhat.com>
References: <20190827092246.10276-1-fziglio@redhat.com>
MIME-Version: 1.0
X-Scanned-By: MIMEDefang 2.79 on 10.5.11.14
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16
 (mx1.redhat.com [10.5.110.41]); Tue, 27 Aug 2019 09:23:03 +0000 (UTC)
Subject: [Spice-devel] [PATCH spice-gtk v4 03/29] usb-redir: move
 implementation of device description to USB backend
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

RnJvbTogWXVyaSBCZW5kaXRvdmljaCA8eXVyaS5iZW5kaXRvdmljaEBkYXluaXguY29tPgoKRm9y
IGxvY2FsIFVTQiBkZXZpY2UgdGhlIFVTQiBiYWNrZW5kIHJldHVybnMgdGhlIHNhbWUgZGV2aWNl
CmRlc2NyaXB0aW9uIGFzIHNwaWNlLXVzYi1tYW5hZ2VyIGRpZCwgZm9yIGVtdWxhdGVkIGRldmlj
ZXMgaXQKdXNlcyB0aGUgZGVzY3JpcHRpb24gcHJvdmlkZWQgYnkgZGV2aWNlJ3MgaW1wbGVtZW50
YXRpb24uCgpTaWduZWQtb2ZmLWJ5OiBZdXJpIEJlbmRpdG92aWNoIDx5dXJpLmJlbmRpdG92aWNo
QGRheW5peC5jb20+CkFja2VkLWJ5OiBGcmVkaWFubyBaaWdsaW8gPGZ6aWdsaW9AcmVkaGF0LmNv
bT4KLS0tCiBzcmMvdXNiLWJhY2tlbmQuYyAgICAgICAgfCA0MSArKysrKysrKysrKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysrCiBzcmMvdXNiLWJhY2tlbmQuaCAgICAgICAgfCAgMSArCiBz
cmMvdXNiLWRldmljZS1tYW5hZ2VyLmMgfCAyOSArLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
CiAzIGZpbGVzIGNoYW5nZWQsIDQzIGluc2VydGlvbnMoKyksIDI4IGRlbGV0aW9ucygtKQoKZGlm
ZiAtLWdpdCBhL3NyYy91c2ItYmFja2VuZC5jIGIvc3JjL3VzYi1iYWNrZW5kLmMKaW5kZXggN2Y5
ZmNjMTcuLmFhMTFjNzkxIDEwMDY0NAotLS0gYS9zcmMvdXNiLWJhY2tlbmQuYworKysgYi9zcmMv
dXNiLWJhY2tlbmQuYwpAQCAtNDIsNiArNDIsNyBAQAogI2luY2x1ZGUgInVzYi1lbXVsYXRpb24u
aCIKICNpbmNsdWRlICJjaGFubmVsLXVzYnJlZGlyLXByaXYuaCIKICNpbmNsdWRlICJzcGljZS1j
aGFubmVsLXByaXYuaCIKKyNpbmNsdWRlICJ1c2J1dGlsLmgiCiAKICNkZWZpbmUgTE9VRF9ERUJV
Ryh4LCAuLi4pCiAKQEAgLTg0NCw2ICs4NDUsNDYgQEAgc3BpY2VfdXNiX2JhY2tlbmRfY2hhbm5l
bF9nZXRfZ3Vlc3RfZmlsdGVyKFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmNoLAogICAgIH0KIH0K
IAorZ2NoYXIgKiBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfZ2V0X2Rlc2NyaXB0aW9uKFNwaWNl
VXNiQmFja2VuZERldmljZSAqZGV2LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGNvbnN0IGdjaGFyICpmb3JtYXQpCit7CisgICAgZ3VpbnQxNiBidXMs
IGFkZHJlc3MsIHZpZCwgcGlkOworICAgIGdjaGFyICpkZXNjcmlwdGlvbiwgKmRlc2NyaXB0b3Is
ICptYW51ZmFjdHVyZXIgPSBOVUxMLCAqcHJvZHVjdCA9IE5VTEw7CisKKyAgICBnX3JldHVybl92
YWxfaWZfZmFpbChkZXYgIT0gTlVMTCwgTlVMTCk7CisKKyAgICBidXMgICAgID0gZGV2LT5kZXZp
Y2VfaW5mby5idXM7CisgICAgYWRkcmVzcyA9IGRldi0+ZGV2aWNlX2luZm8uYWRkcmVzczsKKyAg
ICB2aWQgICAgID0gZGV2LT5kZXZpY2VfaW5mby52aWQ7CisgICAgcGlkICAgICA9IGRldi0+ZGV2
aWNlX2luZm8ucGlkOworCisgICAgaWYgKCh2aWQgPiAwKSAmJiAocGlkID4gMCkpIHsKKyAgICAg
ICAgZGVzY3JpcHRvciA9IGdfc3RyZHVwX3ByaW50ZigiWyUwNHg6JTA0eF0iLCB2aWQsIHBpZCk7
CisgICAgfSBlbHNlIHsKKyAgICAgICAgZGVzY3JpcHRvciA9IGdfc3RyZHVwKCIiKTsKKyAgICB9
CisKKyAgICBpZiAoZGV2LT5saWJ1c2JfZGV2aWNlKSB7CisgICAgICAgIHNwaWNlX3VzYl91dGls
X2dldF9kZXZpY2Vfc3RyaW5ncyhidXMsIGFkZHJlc3MsIHZpZCwgcGlkLAorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJm1hbnVmYWN0dXJlciwgJnByb2R1Y3QpOwor
ICAgIH0gZWxzZSB7CisgICAgICAgIHByb2R1Y3QgPSBkZXZpY2Vfb3BzKGRldi0+ZWRldiktPmdl
dF9wcm9kdWN0X2Rlc2NyaXB0aW9uKGRldi0+ZWRldik7CisgICAgfQorCisgICAgaWYgKCFmb3Jt
YXQpIHsKKyAgICAgICAgZm9ybWF0ID0gXygiJXMgJXMgJXMgYXQgJWQtJWQiKTsKKyAgICB9CisK
KyAgICBkZXNjcmlwdGlvbiA9IGdfc3RyZHVwX3ByaW50Zihmb3JtYXQsIG1hbnVmYWN0dXJlciA/
IG1hbnVmYWN0dXJlciA6ICIiLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBy
b2R1Y3QsIGRlc2NyaXB0b3IsIGJ1cywgYWRkcmVzcyk7CisKKyAgICBnX2ZyZWUobWFudWZhY3R1
cmVyKTsKKyAgICBnX2ZyZWUoZGVzY3JpcHRvcik7CisgICAgZ19mcmVlKHByb2R1Y3QpOworCisg
ICAgcmV0dXJuIGRlc2NyaXB0aW9uOworfQorCiB2b2lkIHNwaWNlX3VzYl9iYWNrZW5kX2Rldmlj
ZV9yZXBvcnRfY2hhbmdlKFNwaWNlVXNiQmFja2VuZCAqYmUsCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIFNwaWNlVXNiQmFja2VuZERldmljZSAqZGV2KQogewpk
aWZmIC0tZ2l0IGEvc3JjL3VzYi1iYWNrZW5kLmggYi9zcmMvdXNiLWJhY2tlbmQuaAppbmRleCBj
ZDNmZjA5Ny4uYzY5NGRiYjIgMTAwNjQ0Ci0tLSBhL3NyYy91c2ItYmFja2VuZC5oCisrKyBiL3Ny
Yy91c2ItYmFja2VuZC5oCkBAIC05MCw1ICs5MCw2IEBAIHZvaWQgc3BpY2VfdXNiX2JhY2tlbmRf
Y2hhbm5lbF9nZXRfZ3Vlc3RfZmlsdGVyKFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmNoLAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RydWN0
IHVzYnJlZGlyZmlsdGVyX3J1bGUgICoqcnVsZXMsCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBpbnQgKmNvdW50KTsKIHZvaWQgc3BpY2VfdXNiX2JhY2tl
bmRfcmV0dXJuX3dyaXRlX2RhdGEoU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCAqY2gsIHZvaWQgKmRh
dGEpOworZ2NoYXIgKnNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9nZXRfZGVzY3JpcHRpb24oU3Bp
Y2VVc2JCYWNrZW5kRGV2aWNlICpkZXYsIGNvbnN0IGdjaGFyICpmb3JtYXQpOwogCiBHX0VORF9E
RUNMUwpkaWZmIC0tZ2l0IGEvc3JjL3VzYi1kZXZpY2UtbWFuYWdlci5jIGIvc3JjL3VzYi1kZXZp
Y2UtbWFuYWdlci5jCmluZGV4IGIzZGI1ZGU2Li41ODM0ZTAzMiAxMDA2NDQKLS0tIGEvc3JjL3Vz
Yi1kZXZpY2UtbWFuYWdlci5jCisrKyBiL3NyYy91c2ItZGV2aWNlLW1hbmFnZXIuYwpAQCAtMzIs
NyArMzIsNiBAQAogI2VuZGlmCiAKICNpbmNsdWRlICJjaGFubmVsLXVzYnJlZGlyLXByaXYuaCIK
LSNpbmNsdWRlICJ1c2J1dGlsLmgiCiAjZW5kaWYKIAogI2luY2x1ZGUgInNwaWNlLXNlc3Npb24t
cHJpdi5oIgpAQCAtMTQzOSwzNSArMTQzOCw5IEBAIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9j
YW5fcmVkaXJlY3RfZGV2aWNlKFNwaWNlVXNiRGV2aWNlTWFuYWdlciAgKnNlbGYsCiBnY2hhciAq
c3BpY2VfdXNiX2RldmljZV9nZXRfZGVzY3JpcHRpb24oU3BpY2VVc2JEZXZpY2UgKmRldmljZSwg
Y29uc3QgZ2NoYXIgKmZvcm1hdCkKIHsKICNpZmRlZiBVU0VfVVNCUkVESVIKLSAgICBndWludDE2
IGJ1cywgYWRkcmVzcywgdmlkLCBwaWQ7Ci0gICAgZ2NoYXIgKmRlc2NyaXB0aW9uLCAqZGVzY3Jp
cHRvciwgKm1hbnVmYWN0dXJlciA9IE5VTEwsICpwcm9kdWN0ID0gTlVMTDsKLQogICAgIGdfcmV0
dXJuX3ZhbF9pZl9mYWlsKGRldmljZSAhPSBOVUxMLCBOVUxMKTsKIAotICAgIGJ1cyAgICAgPSBz
cGljZV91c2JfZGV2aWNlX2dldF9idXNudW0oZGV2aWNlKTsKLSAgICBhZGRyZXNzID0gc3BpY2Vf
dXNiX2RldmljZV9nZXRfZGV2YWRkcihkZXZpY2UpOwotICAgIHZpZCAgICAgPSBzcGljZV91c2Jf
ZGV2aWNlX2dldF92aWQoZGV2aWNlKTsKLSAgICBwaWQgICAgID0gc3BpY2VfdXNiX2RldmljZV9n
ZXRfcGlkKGRldmljZSk7Ci0KLSAgICBpZiAoKHZpZCA+IDApICYmIChwaWQgPiAwKSkgewotICAg
ICAgICBkZXNjcmlwdG9yID0gZ19zdHJkdXBfcHJpbnRmKCJbJTA0eDolMDR4XSIsIHZpZCwgcGlk
KTsKLSAgICB9IGVsc2UgewotICAgICAgICBkZXNjcmlwdG9yID0gZ19zdHJkdXAoIiIpOwotICAg
IH0KLQotICAgIHNwaWNlX3VzYl91dGlsX2dldF9kZXZpY2Vfc3RyaW5ncyhidXMsIGFkZHJlc3Ms
IHZpZCwgcGlkLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmbWFudWZh
Y3R1cmVyLCAmcHJvZHVjdCk7Ci0KLSAgICBpZiAoIWZvcm1hdCkKLSAgICAgICAgZm9ybWF0ID0g
XygiJXMgJXMgJXMgYXQgJWQtJWQiKTsKLQotICAgIGRlc2NyaXB0aW9uID0gZ19zdHJkdXBfcHJp
bnRmKGZvcm1hdCwgbWFudWZhY3R1cmVyLCBwcm9kdWN0LCBkZXNjcmlwdG9yLCBidXMsIGFkZHJl
c3MpOwotCi0gICAgZ19mcmVlKG1hbnVmYWN0dXJlcik7Ci0gICAgZ19mcmVlKGRlc2NyaXB0b3Ip
OwotICAgIGdfZnJlZShwcm9kdWN0KTsKLQotICAgIHJldHVybiBkZXNjcmlwdGlvbjsKKyAgICBy
ZXR1cm4gc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX2dldF9kZXNjcmlwdGlvbihkZXZpY2UtPmJk
ZXYsIGZvcm1hdCk7CiAjZWxzZQogICAgIHJldHVybiBOVUxMOwogI2VuZGlmCi0tIAoyLjIwLjEK
Cl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClNwaWNlLWRl
dmVsIG1haWxpbmcgbGlzdApTcGljZS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6
Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9zcGljZS1kZXZlbA==
