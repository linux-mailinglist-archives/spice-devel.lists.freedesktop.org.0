Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id EB4FE98BC5
	for <lists+spice-devel@lfdr.de>; Thu, 22 Aug 2019 08:56:10 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 6AB506EA60;
	Thu, 22 Aug 2019 06:56:09 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id CE2466EA60
 for <spice-devel@lists.freedesktop.org>; Thu, 22 Aug 2019 06:56:07 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx03.intmail.prod.int.phx2.redhat.com
 [10.5.11.13])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id 7F0401801584;
 Thu, 22 Aug 2019 06:56:07 +0000 (UTC)
Received: from colo-mx.corp.redhat.com
 (colo-mx01.intmail.prod.int.phx2.redhat.com [10.5.11.20])
 by smtp.corp.redhat.com (Postfix) with ESMTPS id 7494460925;
 Thu, 22 Aug 2019 06:56:07 +0000 (UTC)
Received: from zmail25.collab.prod.int.phx2.redhat.com
 (zmail25.collab.prod.int.phx2.redhat.com [10.5.83.31])
 by colo-mx.corp.redhat.com (Postfix) with ESMTP id 6ADF61800202;
 Thu, 22 Aug 2019 06:56:07 +0000 (UTC)
Date: Thu, 22 Aug 2019 02:56:07 -0400 (EDT)
From: Frediano Ziglio <fziglio@redhat.com>
To: Yuri Benditovich <yuri.benditovich@daynix.com>
Message-ID: <476222235.8198018.1566456967244.JavaMail.zimbra@redhat.com>
In-Reply-To: <CAOEp5OdBZ-spO4jKoP6vLFnX6QjK8iM+caF9LyF4-mWubzNWYQ@mail.gmail.com>
References: <20190812095729.32692-1-yuri.benditovich@daynix.com>
 <20190812095729.32692-6-yuri.benditovich@daynix.com>
 <1409051095.5635285.1565697543164.JavaMail.zimbra@redhat.com>
 <CAOEp5OdBZ-spO4jKoP6vLFnX6QjK8iM+caF9LyF4-mWubzNWYQ@mail.gmail.com>
MIME-Version: 1.0
X-Originating-IP: [10.40.204.109, 10.4.195.12]
Thread-Topic: usb-redir: extend USB backend to support emulated devices
Thread-Index: GADNYdx697oHXqHxntwzbz+vQE5K6g==
X-Scanned-By: MIMEDefang 2.79 on 10.5.11.13
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.6.2
 (mx1.redhat.com [10.5.110.63]); Thu, 22 Aug 2019 06:56:07 +0000 (UTC)
Subject: Re: [Spice-devel] [spice-gtk v3 5/9] usb-redir: extend USB backend
 to support emulated devices
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Yan Vugenfirer <yan@daynix.com>,
 Spice List <spice-devel@lists.freedesktop.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

PiAKPiBPbiBUdWUsIEF1ZyAxMywgMjAxOSBhdCAyOjU5IFBNIEZyZWRpYW5vIFppZ2xpbyA8Znpp
Z2xpb0ByZWRoYXQuY29tPiB3cm90ZToKPiA+Cj4gPiA+Cj4gPiA+IFJlZGlyZWN0aW9uIG9mIGVt
dWxhdGVkIGRldmljZXMgcmVxdWlyZXMgc3BlY2lhbCBhcHByb2FjaCwKPiA+ID4gYXMgdXNicmVk
aXJob3N0IGNhbid0IGJlIHVzZWQgZm9yIHRoYXQgKGl0IHdvcmtzIG9ubHkgd2l0aAo+ID4gPiBs
aWJ1c2IgZGV2aWNlcykuIEZvciBlbXVsYXRlZCBkZXZpY2VzIHdlIGNyZWF0ZSBpbnN0YW5jZSBv
Zgo+ID4gPiB1c2JyZWRpcnBhcnNlciB0aGF0IGltcGxlbWVudHMgVVNCIHJlZGlyZWN0aW9uIHBy
b3RvY29sLgo+ID4KPiA+IE1ha2Ugc2Vuc2UuIEFjdHVhbGx5IHVzYnJlZGlyaG9zdCBpbnRlcm5h
bGx5IHVzZXMgYSBwYXJzZXIgdG8KPiA+IHBhcnNlIHByb3RvY29sIG1lc3NhZ2VzIGFuZCByZWRp
cmVjdCB0byB0aGUgcGh5c2ljYWwgZGV2aWNlLgo+ID4gQnV0IHRoZSBwYXJzZSBpcyBpbnRlcm5h
bCBhbmQgaXMgdXNlZCBieSB1c2JyZWRpcmhvc3Qgc28KPiA+IHdvdWxkIGJlIGhhcmQgdG8gcmV1
c2UuCj4gPgo+ID4gPiBJbiBvcmRlciB0byB3b3JrIHdpdGggdGhlIHNhbWUgc2V0IG9mIHByb3Rv
Y29sIGNhcGFiaWxpdGllcwo+ID4gPiB0aGF0IHVzYnJlZGlyaG9zdCBzZXRzIHVwIHdpdGggcmVt
b3RlIHNpZGUsIHRoZSBwYXJzZXIgc2hhbGw6Cj4gPiA+IC0gbm90IHNlbmQgaXRzIG93biAnaGVs
bG8nIHRvIHRoZSBzZXJ2ZXIKPiA+ID4gLSBpbml0aWFsaXplIHRoZSBzYW1lIGNhcGFiaWxpdGll
cyB0aGF0IHVzYnJlZGlyaG9zdAo+ID4gPiAtIHJlY2VpdmUgdGhlIHNhbWUgJ2hlbGxvJyByZXNw
b25zZQo+ID4gPiBGb3IgdGhhdCB3ZSBhbmFseXplICdoZWxsbycgc2VudCBieSBVU0IgcmVkaXIg
cGFyc2VyIGFuZAo+ID4gPiBleHRyYWN0IHNldCBvZiBjYXBhYmlsaXRpZXMgZnJvbSBpdCBhbmQg
dXBvbiByZWNlaXZlIG9mCj4gPiA+ICdoZWxsbycgcmVzcG9uc2Ugd2UgcHJvdmlkZSBpdCBhbHNv
IHRvIHRoZSBwYXJzZXIuCj4gPgo+ID4gVGhpcyBtYWtlIHNlbnNlIGJ1dCBzb21lIHBhcnQgb2Yg
dGhlIGNvZGUgZG9lcyBub3QgZXhhY3RseSB0aGF0Lgo+ID4gSW4gc29tZSBwYXRoIHRoZSBjb2Rl
IHNlbmQgdGhlICdoZWxsbycgaXMgc2VudCBieSB0aGUgcGFyc2VyLgo+ID4gSXQgd291bGQgYmUg
bW9yZSBjbGVhciB0byBpbXBsZW1lbnQganVzdCB3aGF0IHlvdSBkZXNjcmliZWQKPiA+IGFib3Zl
LCB3aHkgdGhlIGltcGxlbWVudGF0aW9uIGlzIGEgYml0IGRpZmZlcmVudC4KPiAKPiBEdWUgdG8g
Y29ybmVyIGNhc2UgZGVzY3JpYmVkIGJlbG93Lgo+IAo+ID4KPiA+ID4gV2hlbiBsaWJ1c2IgZGV2
aWNlIGlzIHJlZGlyZWN0ZWQgdmlhIGEgY2hhbm5lbCwgaW5zdGFuY2Ugb2YKPiA+ID4gdXNicmVk
aXJob3N0IHNlcnZlcyBpdC4KPiA+ID4gV2hlbiBlbXVsYXRlZCBkZXZpY2UgaXMgcmVkaXJlY3Rl
ZCB2aWEgYSBjaGFubmVsLCBpbnN0YW5jZQo+ID4gPiBvZiB1c2JyZWRpcnBhcnNlciBkb2VzIHRo
ZSBqb2IuCj4gPiA+Cj4gPiA+IFNpZ25lZC1vZmYtYnk6IFl1cmkgQmVuZGl0b3ZpY2ggPHl1cmku
YmVuZGl0b3ZpY2hAZGF5bml4LmNvbT4KPiA+ID4gLS0tCj4gPiA+ICBzcmMvdXNiLWJhY2tlbmQu
YyB8IDYxNiArKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrLS0tCj4g
PiA+ICAxIGZpbGUgY2hhbmdlZCwgNTgwIGluc2VydGlvbnMoKyksIDM2IGRlbGV0aW9ucygtKQo+
ID4gPgo+ID4gPiBkaWZmIC0tZ2l0IGEvc3JjL3VzYi1iYWNrZW5kLmMgYi9zcmMvdXNiLWJhY2tl
bmQuYwo+ID4gPiBpbmRleCBhYTExYzc5Li45YWVlNmM3IDEwMDY0NAo+ID4gPiAtLS0gYS9zcmMv
dXNiLWJhY2tlbmQuYwo+ID4gPiArKysgYi9zcmMvdXNiLWJhY2tlbmQuYwo+ID4gPiBAQCAtNTUs
NiArNTUsNyBAQCBzdHJ1Y3QgX1NwaWNlVXNiQmFja2VuZERldmljZQo+ID4gPiAgICAgIGdpbnQg
cmVmX2NvdW50Owo+ID4gPiAgICAgIFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmF0dGFjaGVkX3Rv
Owo+ID4gPiAgICAgIFVzYkRldmljZUluZm9ybWF0aW9uIGRldmljZV9pbmZvOwo+ID4gPiArICAg
IGdib29sZWFuIGVkZXZfY29uZmlndXJlZDsKPiA+Cj4gPiBUaGlzIHZhcmlhYmxlIGlzIG5ldmVy
IHJlc2V0LCBJIHdvdWxkIGV4cGVjdCB0aGF0IGF0IGxlYXN0Cj4gPiB3aGVuIGRldmljZSBpcyBk
ZXRhY2hlZCAodGhpcyBzaG91bGQgYmUgZXF1aXZhbGVudCB0byBwaHlzaWNhbAo+ID4gcmVtb3Zh
bCkuCj4gCj4gUHJvYmFibHksIG5lZWQgdG8gcmVzZXQgaXQgb24gYXR0YWNoLgo+IEluIGZhY3Qs
IG5vYm9keSB1c2VzIGl0LCB0aGUgZHJpdmVyIHVzdWFsbHkganVzdCBzZXRzIHRoZSBjb25maWd1
cmF0aW9uLgo+IAo+ID4gV2h5IG5vdCBtb3ZpbmcgdG8gU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbD8K
PiA+Cj4gCj4gQmVjYXVzZSBpdCBpcyBoYXJkbHkgcmVsYXRlZCB0byB0aGUgY2hhbm5lbC4KPiAK
PiA+ID4gIH07Cj4gPiA+Cj4gPiA+ICBzdHJ1Y3QgX1NwaWNlVXNiQmFja2VuZAo+ID4gPiBAQCAt
ODAsMTAgKzgxLDIwIEBAIHN0cnVjdCBfU3BpY2VVc2JCYWNrZW5kCj4gPiA+ICBzdHJ1Y3QgX1Nw
aWNlVXNiQmFja2VuZENoYW5uZWwKPiA+ID4gIHsKPiA+ID4gICAgICBzdHJ1Y3QgdXNicmVkaXJo
b3N0ICp1c2JyZWRpcmhvc3Q7Cj4gPiA+ICsgICAgc3RydWN0IHVzYnJlZGlyaG9zdCAqaGlkZGVu
X2hvc3Q7Cj4gPiA+ICsgICAgc3RydWN0IHVzYnJlZGlycGFyc2VyICpwYXJzZXI7Cj4gPiA+ICsg
ICAgc3RydWN0IHVzYnJlZGlycGFyc2VyICpoaWRkZW5fcGFyc2VyOwo+ID4KPiA+IEkgZG9uJ3Qg
dW5kZXJzdGFuZCBhbGwgdGhlc2UgdmFyaWFibGUuCj4gPiBXb24ndCBiZSBlYXNpZXIgdG8gaGF2
ZSBwYXJzZXIgaW5pdGlhbGl6ZWQgZm9yIGVtdWxhdGVkCj4gPiBkZXZpY2VzIGFuZCBiZWluZyBO
VUxMIChzbyBmcmVlZCkgd2hlbiBlbXVsYXRlZCBkZXZpY2UKPiA+IGlzIGRldGFjaGVkPwo+IAo+
IFdoZW4gdGhlIGNoYW5uZWwgaXMgY3JlYXRlZCBpdCBkb2VzIG5vdCBrbm93IHdoYXQgaXQgd2ls
bCByZWRpcmVjdC4KPiBUaGUgc2FtZSBjaGFubmVsIGlzIHVzZWQgZm9yIHJlZ3VsYXIgZGV2aWNl
cyBhbmQgZW11bGF0ZWQgb25lLiBCb3RoCj4gcGFyc2VyIGFuZCB1c2JyZWRpcmhvc3Qgc2hhbGwg
YmUgaW50ZXJuYWxseSBzeW5jaHJvbml6ZWQgd2l0aCB0aGUKPiByZW1vdGUgc2lkZS4KCkJ1dCB0
aGlzIGlzIHBhcnRpYWxseSB0cnVlLiBPbmx5IHRoZSBjYXBhYmlsaXRpZXMgYXJlIHN5bmNocm9u
aXplZCwKdGhlIGRhdGEgYXJlIHBhc3NlZCBlaXRoZXIgdG8gdXNicmVkaXJob3N0IG9yIHVzYnJl
ZGlycGFyc2VyLCBub3QgYm90aC4KCj4gSWYgSSdkIGNyZWF0ZSB0aGUgcGFyc2VyIGVhY2ggdGlt
ZSB0aGUgZW11bGF0ZWQgZGV2aWNlIGlzIGF0dGFjaGVkIEknZAo+IG5lZWQgZWFjaCB0aW1lIHRv
IGluaXRpYWxpemUgaXQgd2l0aCByZWNlaXZlZCBoZWxsbyBmcm9tIHRoZSBzZWNvbmQKPiBzaWRl
LiBXZSdkIG5lZWQgdG8gd3JpdGUgYWRkaXRpb25hbCBjb2RlIHRvIHByb2Nlc3MgKGV2ZW4gaW1h
Z2luYWJsZSkKPiBlcnJvciBjYXNlcyAod2hhdCBpZiB3ZSBjYW4ndCBjcmVhdGUgdGhlIHBhcnNl
ciBldGMpLgoKSWYgd2UgY2FuJ3QgY3JlYXRlIHRoZSBwYXJzZXIgd2UgZG8gd2hhdCB3ZSBkbyBp
biBhbGwgb3RoZXIgY2FzZXMsCndlIGp1c3QgY2FsbCBhYm9ydCgpLCBub3QgdGhhdCBoYXJkLgoK
PiBGaW5hbGx5IHRoaXMgYXBwZWFycyB0byBiZSBtb3JlIGNvbXBsaWNhdGVkIHRoYW4gaGF2ZSBl
dmVyeXRoaWduIHJlYWR5Cj4gZnJvbSB0aGUgYmVnaW5uaW5nLgo+IAoKQnV0IHRoaXMgZG9lcyBu
b3QgbmVlZCB0byBiZSBpbXBsZW1lbnRlZCB3aXRoIDQgcG9pbnRlcnMgYW5kIHNvbWUgImhpZGRl
bl8iCnByZWZpeC4gQ291bGQgYmUgYSBzaW1wbGUgZW51bSBzdGF0aW5nIHdoaWNoIG9uZSB0byB1
c2UuCgo+IFRoZXJlIGlzIGFsc28gY29ybmVyIGNhc2Ugd2hlbiB0aGUgZGV2aWNlIGlzIGF0dGFj
aGVkIGJlZm9yZSB0aGUKPiBjaGFubmVsIGlzIHJlYWR5IChyZWRpcmVjdC1vbi1jb25uZWN0IHNl
dHRpbmcpLiBXZSBkZWNpZGUgb24KPiB1c2JyZWRpaG9zdCcgb3IgJ3BhcnNlcicgZGVwZW5kaW5n
IG9uIGtpbmQgb2YgYXR0YWNoZWQgZGV2aWNlIHRvCj4gcmVkaXJlY3QuCgpJZiB0aGUgcGFyc2Vy
IGlzIGluaXRpYWxpemVkIGJlZm9yZSB0aGVuIHRoZSB1c2JyZWRpciBob3N0IGFuZCBwYXJzZQph
cmUgbm90IGluIHN5bmMgc28gdGhpcyBtZWFucyB0aGF0IHRoZSBjaGFubmVsIHdpbGwgYmUgb25s
eSBzdXBwb3J0aW5nCmVtdWxhdGVkIGRldmljZXMgYW5kIG5vdCByZWFsIG9uZXMuIFRoaXMgc2Vl
bXMgdG8gbWUgYSBidWcgdG8gYmUgZml4ZWQuCgo+IElmIHRoZSBjaGFubmVsIGlzIHN0aWxsIG5v
dCByZWFkeSwgdGhlIHBhcnNlci91c2JyZWRpcmhvc3QgY2FuJ3Qgc2VuZAo+IGFueXRoaW5nIHRp
bGwgdGhlIGNoYW5uZWwgaXMgdXAuIEluIHRoaXMgY2FzZSBzd2l0Y2hpbmcgYmFjayBhbmQgZm9y
dGgKPiBiZXR3ZWVuIHVzYnJlZGlyaG9zdCBiZWNvbWVzIG1vcmUgY29tcGxpY2F0ZWQgdGhhbiBj
dXJyZW50IHNvbHV0aW9uLgo+IAoKSSBkb24ndCB1bmRlcnN0YW5kIHRoaXMgc2VudGVuY2UuIFRo
ZSBzd2l0Y2ggaXMgbmVlZGVkIGluIGFueSBjYXNlIGJlY2F1c2UKeW91IGNhbiBhdHRhY2ggYW4g
ZW11bGF0ZWQgZGV2aWNlLCBkZXRhY2ggYW5kIHRoZW4gYXR0YWNoIGEgcmVhbCBvbmUuCklmIHRo
aXMgaXMgbm90IGltcGxlbWVudGVkIHdlIGhhdmUgYSBidWcuCgo+ID4KPiA+ID4gICAgICB1aW50
OF90ICpyZWFkX2J1ZjsKPiA+ID4gICAgICBpbnQgcmVhZF9idWZfc2l6ZTsKPiA+ID4gICAgICBz
dHJ1Y3QgdXNicmVkaXJmaWx0ZXJfcnVsZSAqcnVsZXM7Cj4gPiA+ICAgICAgaW50IHJ1bGVzX2Nv
dW50Owo+ID4gPiArICAgIHVpbnQzMl90IGhvc3RfY2FwczsKPiA+ID4gKyAgICB1aW50MzJfdCBw
YXJzZXJfaW5pdF9kb25lICA6IDE7Cj4gPiA+ICsgICAgdWludDMyX3QgcGFyc2VyX3dpdGhfaGVs
bG8gOiAxOwo+ID4gPiArICAgIHVpbnQzMl90IGhlbGxvX2RvbmVfcGFyc2VyIDogMTsKPiA+ID4g
KyAgICB1aW50MzJfdCBoZWxsb19zZW50ICAgICAgICA6IDE7Cj4gPiA+ICsgICAgdWludDMyX3Qg
cmVqZWN0ZWQgICAgICAgICAgOiAxOwo+ID4gPiArICAgIHVpbnQzMl90IHdhaXRfZGlzY19hY2sg
ICAgIDogMTsKPiA+Cj4gPiBUaGUgImRpc2MiIG5hbWluZyBpcyBjb25mdXNpbmcsIGFsc28gdGFr
aW5nIGludG8gYWNjb3VudCB0aGUKPiA+ICJDb21wYWN0IERpc2MiIGFkZGl0aW9uLiBSZWFkaW5n
IHRoZSBjb2RlIHRoaXMgImRpc2MiIGlzIGEgc2hvcnRlbgo+ID4gZm9yICJkaXNjb25uZWN0Iiwg
bWF5YmUgd291bGQgYmUgYmV0dGVyIHRvIGp1c3QgdXNlICJ3YWl0X2Rpc2Nvbm5lY3RfYWNrIj8K
PiA+Cj4gCj4gb2sKPiAKPiA+ID4gICAgICBTcGljZVVzYkJhY2tlbmREZXZpY2UgKmF0dGFjaGVk
Owo+ID4gPiAgICAgIFNwaWNlVXNicmVkaXJDaGFubmVsICAqdXNlcl9kYXRhOwo+ID4KPiA+IE9U
OiB0aGlzIGRlZmluaXRpdmVseSBzaG91bGQgYmUgcmVuYW1lZCEKPiAKPiBQcm9iYWJseSBpbiBz
ZXBhcmF0ZSBjb21taXQuCj4gCgpZZXMsIHRoYXQncyB3aGF0IHRoZSBPVCBtZWFucy4KCj4gPgo+
ID4gPiAgICAgIFNwaWNlVXNiQmFja2VuZCAqYmFja2VuZDsKPiA+ID4gQEAgLTM1NSw3ICszNjYs
MTEgQEAgZ2Jvb2xlYW4KPiA+ID4gc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX2lzb2NoKFNwaWNl
VXNiQmFja2VuZERldmljZSAqZGV2KQo+ID4gPiAgICAgIGdpbnQgaSwgaiwgazsKPiA+ID4gICAg
ICBpbnQgcmM7Cj4gPiA+Cj4gPiA+IC0gICAgZ19yZXR1cm5fdmFsX2lmX2ZhaWwobGliZGV2ICE9
IE5VTEwsIDApOwo+ID4gPiArICAgIGdfcmV0dXJuX3ZhbF9pZl9mYWlsKGxpYmRldiAhPSBOVUxM
IHx8IGRldi0+ZWRldiAhPSBOVUxMLCAwKTsKPiA+ID4gKyAgICBpZiAoZGV2LT5lZGV2KSB7Cj4g
PiA+ICsgICAgICAgIC8qIGN1cnJlbnRseSB3ZSBkbyBub3QgZW11bGF0ZSBpc29jaCBkZXZpY2Vz
ICovCj4gPiA+ICsgICAgICAgIHJldHVybiBGQUxTRTsKPiA+ID4gKyAgICB9Cj4gPiA+Cj4gPiA+
ICAgICAgcmMgPSBsaWJ1c2JfZ2V0X2FjdGl2ZV9jb25maWdfZGVzY3JpcHRvcihsaWJkZXYsICZj
b25mX2Rlc2MpOwo+ID4gPiAgICAgIGlmIChyYykgewo+ID4gPiBAQCAtMzkwLDEzICs0MDUsMTYg
QEAgZnJvbSBib3RoIHRoZSBtYWluIHRocmVhZCBhcyB3ZWxsIGFzIGZyb20gdGhlIHVzYgo+ID4g
PiBldmVudAo+ID4gPiBoYW5kbGluZyB0aHJlYWQgKi8KPiA+ID4gIHN0YXRpYyB2b2lkIHVzYnJl
ZGlyX3dyaXRlX2ZsdXNoX2NhbGxiYWNrKHZvaWQgKnVzZXJfZGF0YSkKPiA+ID4gIHsKPiA+ID4g
ICAgICBTcGljZVVzYkJhY2tlbmRDaGFubmVsICpjaCA9IHVzZXJfZGF0YTsKPiA+ID4gLSAgICBp
ZiAoIWNoLT51c2JyZWRpcmhvc3QpIHsKPiA+ID4gLSAgICAgICAgLyoganVzdCB0byBiZSBvbiB0
aGUgc2FmZSBzaWRlICovCj4gPiA+IC0gICAgICAgIHJldHVybjsKPiA+ID4gLSAgICB9Cj4gPgo+
ID4gVGhlc2UgY2hlY2sgc2hvdWxkIGJlIGluIGEgcHJlcGFyYXRvcnkgcGF0Y2guIE5vdGhpbmcg
d3Jvbmcgd2l0aCB0aGlzCj4gPiBwYXRjaCwKPiA+IGJ1dCB0aGUgY29kZSAobWFzdGVyKSBpcyBj
b25mdXNpbmcuIHVzYnJlZGlyaG9zdCBpcyBpbml0aWFsaXplZCBhcyBzb29uIGFzCj4gPiBwb3Nz
aWJsZSwgY2FuIGJlIE5VTEwgb25seSBiZWZvcmUgdXNicmVkaXJob3N0X29wZW5fZnVsbCByZXR1
cm5zLgo+ID4gQWN0dWFsbHkgY2FuIGJlIE5VTEwgaW4gdGhpcyBjYWxsIGZvciB0aGlzIHJlYXNv
biAodGhpcyBjYWxsYmFjayBpcyBjYWxsZWQKPiA+IGluc2lkZSB1c2JyZWRpcmhvc3Rfb3Blbl9m
dWxsKS4KPiA+Cj4gPiA+ICAgICAgaWYgKGlzX2NoYW5uZWxfcmVhZHkoY2gtPnVzZXJfZGF0YSkp
IHsKPiA+ID4gLSAgICAgICAgU1BJQ0VfREVCVUcoIiVzIGNoICVwIC0+IHVzYnJlZGlyaG9zdCIs
IF9fRlVOQ1RJT05fXywgY2gpOwo+ID4gPiAtICAgICAgICB1c2JyZWRpcmhvc3Rfd3JpdGVfZ3Vl
c3RfZGF0YShjaC0+dXNicmVkaXJob3N0KTsKPiA+ID4gKyAgICAgICAgaWYgKGNoLT51c2JyZWRp
cmhvc3QpIHsKPiA+ID4gKyAgICAgICAgICAgIFNQSUNFX0RFQlVHKCIlcyBjaCAlcCAtPiB1c2Jy
ZWRpcmhvc3QiLCBfX0ZVTkNUSU9OX18sIGNoKTsKPiA+ID4gKyAgICAgICAgICAgIHVzYnJlZGly
aG9zdF93cml0ZV9ndWVzdF9kYXRhKGNoLT51c2JyZWRpcmhvc3QpOwo+ID4gPiArICAgICAgICB9
IGVsc2UgaWYgKGNoLT5wYXJzZXIpIHsKPiA+ID4gKyAgICAgICAgICAgIFNQSUNFX0RFQlVHKCIl
cyBjaCAlcCAtPiBwYXJzZXIiLCBfX0ZVTkNUSU9OX18sIGNoKTsKPiA+ID4gKyAgICAgICAgICAg
IHVzYnJlZGlycGFyc2VyX2RvX3dyaXRlKGNoLT5wYXJzZXIpOwo+ID4gPiArICAgICAgICB9IGVs
c2Ugewo+ID4gPiArICAgICAgICAgICAgU1BJQ0VfREVCVUcoIiVzIGNoICVwIChOT1QgQUNUSVZF
KSIsIF9fRlVOQ1RJT05fXywgY2gpOwo+ID4KPiA+IFRoaXMgdGhpcmQgY2FzZSBzaG91bGQgbmV2
ZXIgYmUgcG9zc2libGUuIFRoaXMgaXMgb25lIGFzcGVjdCB0aGF0IG1hc3Rlcgo+ID4gY29kZSBp
cyBjb25mdXNpbmcgYWJvdXQuCj4gPgo+ID4gPiArICAgICAgICB9Cj4gPiA+ICAgICAgfSBlbHNl
IHsKPiA+ID4gICAgICAgICAgU1BJQ0VfREVCVUcoIiVzIGNoICVwIChub3QgcmVhZHkpIiwgX19G
VU5DVElPTl9fLCBjaCk7Cj4gPiA+ICAgICAgfQo+ID4gPiBAQCAtNTUxLDEzICs1NjksNTIgQEAg
dm9pZAo+ID4gPiBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfdW5yZWYoU3BpY2VVc2JCYWNrZW5k
RGV2aWNlICpkZXYpCj4gPiA+ICAgICAgfQo+ID4gPiAgfQo+ID4gPgo+ID4gPiAtaW50IHNwaWNl
X3VzYl9iYWNrZW5kX2RldmljZV9jaGVja19maWx0ZXIoCj4gPiA+IC0gICAgU3BpY2VVc2JCYWNr
ZW5kRGV2aWNlICpkZXYsCj4gPiA+IC0gICAgY29uc3Qgc3RydWN0IHVzYnJlZGlyZmlsdGVyX3J1
bGUgKnJ1bGVzLAo+ID4gPiAtICAgIGludCBjb3VudCkKPiA+ID4gK3N0YXRpYyBpbnQgY2hlY2tf
ZWRldl9kZXZpY2VfZmlsdGVyKFNwaWNlVXNiQmFja2VuZERldmljZSAqZGV2LAo+ID4gPiArICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RydWN0IHVzYnJlZGlyZmls
dGVyX3J1bGUKPiA+ID4gKnJ1bGVzLAo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgaW50IGNvdW50KQo+ID4gPiAgewo+ID4gPiAtICAgIHJldHVybiB1c2JyZWRpcmhv
c3RfY2hlY2tfZGV2aWNlX2ZpbHRlcigKPiA+ID4gLSAgICAgICAgcnVsZXMsIGNvdW50LCBkZXYt
PmxpYnVzYl9kZXZpY2UsIDApOwo+ID4gPiArICAgIFNwaWNlVXNiRW11bGF0ZWREZXZpY2UgKmVk
ZXYgPSBkZXYtPmVkZXY7Cj4gPiA+ICsgICAgdWludDhfdCBjbHNbMzJdLCBzdWJjbHNbMzJdLCBw
cm90b1szMl0sICpjZmcsIGlmbnVtID0gMDsKPiA+ID4gKyAgICB1aW50MTZfdCBzaXplLCBvZmZz
ZXQgPSAwOwo+ID4gPiArICAgIGlmICghZWRldikgewo+ID4gPiArICAgICAgICByZXR1cm4gMTsK
PiA+ID4gKyAgICB9Cj4gPiA+ICsgICAgaWYgKCFkZXZpY2Vfb3BzKGVkZXYpLT5nZXRfZGVzY3Jp
cHRvcihlZGV2LCBMSUJVU0JfRFRfQ09ORklHLCAwLAo+ID4gPiAodm9pZAo+ID4gPiAqKikmY2Zn
LCAmc2l6ZSkpIHsKPiA+ID4gKyAgICAgICAgcmV0dXJuIDE7Cj4gPiA+ICsgICAgfQo+ID4gPiAr
ICAgIHdoaWxlICgob2Zmc2V0ICsgMSkgPCBzaXplKSB7Cj4gPiA+ICsgICAgICAgIHVpbnQ4X3Qg
bGVuICA9IGNmZ1tvZmZzZXRdOwo+ID4gPiArICAgICAgICB1aW50OF90IHR5cGUgPSBjZmdbb2Zm
c2V0ICsgMV07Cj4gPiA+ICsgICAgICAgIGlmICgob2Zmc2V0ICsgbGVuKSA+IHNpemUpIHsKPiA+
ID4gKyAgICAgICAgICAgIGJyZWFrOwo+ID4gPiArICAgICAgICB9Cj4gPiA+ICsgICAgICAgIGlm
ICh0eXBlID09IExJQlVTQl9EVF9JTlRFUkZBQ0UpIHsKPiA+ID4gKyAgICAgICAgICAgIGNsc1tp
Zm51bV0gPSBjZmdbb2Zmc2V0ICsgNV07Cj4gPiA+ICsgICAgICAgICAgICBzdWJjbHNbaWZudW1d
ID0gY2ZnW29mZnNldCArIDZdOwo+ID4gPiArICAgICAgICAgICAgcHJvdG9baWZudW1dID0gY2Zn
W29mZnNldCArIDddOwo+ID4gPiArICAgICAgICAgICAgaWZudW0rKzsKPiA+ID4gKyAgICAgICAg
fQo+ID4gPiArICAgICAgICBvZmZzZXQgKz0gbGVuOwo+ID4gPiArICAgIH0KPiA+ID4gKwo+ID4g
PiArICAgIHJldHVybiB1c2JyZWRpcmZpbHRlcl9jaGVjayhydWxlcywgY291bnQsCj4gPiA+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRldi0+ZGV2aWNlX2luZm8uY2xhc3MsCj4g
PiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRldi0+ZGV2aWNlX2luZm8uc3Vi
Y2xhc3MsCj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRldi0+ZGV2aWNl
X2luZm8ucHJvdG9jb2wsCj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNs
cywgc3ViY2xzLCBwcm90bywgaWZudW0sCj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGRldi0+ZGV2aWNlX2luZm8udmlkLAo+ID4gPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBkZXYtPmRldmljZV9pbmZvLnBpZCwKPiA+ID4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgZGV2LT5kZXZpY2VfaW5mby5iY2RVU0IsIDApOwo+ID4gPiArfQo+ID4g
PiArCj4gPiA+ICtpbnQgc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX2NoZWNrX2ZpbHRlcihTcGlj
ZVVzYkJhY2tlbmREZXZpY2UgKmRldiwKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGNvbnN0IHN0cnVjdAo+ID4gPiB1c2JyZWRpcmZpbHRlcl9ydWxlCj4g
PiA+ICpydWxlcywgaW50IGNvdW50KQo+ID4gPiArewo+ID4gPiArICAgIGlmIChkZXYtPmxpYnVz
Yl9kZXZpY2UpIHsKPiA+ID4gKyAgICAgICAgcmV0dXJuIHVzYnJlZGlyaG9zdF9jaGVja19kZXZp
Y2VfZmlsdGVyKHJ1bGVzLCBjb3VudCwKPiA+ID4gZGV2LT5saWJ1c2JfZGV2aWNlLCAwKTsKPiA+
ID4gKyAgICB9IGVsc2Ugewo+ID4gPiArICAgICAgICByZXR1cm4gY2hlY2tfZWRldl9kZXZpY2Vf
ZmlsdGVyKGRldiwgcnVsZXMsIGNvdW50KTsKPiA+ID4gKyAgICB9Cj4gPiA+ICB9Cj4gPiA+Cj4g
PiA+ICBzdGF0aWMgaW50IHVzYnJlZGlyX3JlYWRfY2FsbGJhY2sodm9pZCAqdXNlcl9kYXRhLCB1
aW50OF90ICpkYXRhLCBpbnQKPiA+ID4gIGNvdW50KQo+ID4gPiBAQCAtNjIxLDYgKzY3OCwxNyBA
QCBzdGF0aWMgaW50IHVzYnJlZGlyX3dyaXRlX2NhbGxiYWNrKHZvaWQgKnVzZXJfZGF0YSwKPiA+
ID4gdWludDhfdCAqZGF0YSwgaW50IGNvdW50KQo+ID4gPiAgICAgIFNwaWNlVXNiQmFja2VuZENo
YW5uZWwgKmNoID0gdXNlcl9kYXRhOwo+ID4gPiAgICAgIGludCByZXM7Cj4gPiA+ICAgICAgU1BJ
Q0VfREVCVUcoIiVzIGNoICVwLCAlZCBieXRlcyIsIF9fRlVOQ1RJT05fXywgY2gsIGNvdW50KTsK
PiA+ID4gKyAgICBpZiAoIWNoLT5oZWxsb19zZW50KSB7Cj4gPgo+ID4gSXMgY29uZnVzaW5nIHRo
YXQgdGhlIHNhbWUgY2FsbGJhY2sgaXMgdXNlZCBmb3IgYm90aCB1c2JyZWRpciBwYXJzZXIgYW5k
Cj4gPiB1c2JyZWRpciBob3N0IGJ1dCB0aGUgaGVsbG8gc2hvdWxkIGJlIHBhcnNlZCBvbmx5IGZv
ciB0aGUgaG9zdC4KPiA+IE1heWJlIGRpc2FibGluZyBoZWxsbyBmb3IgdGhlIHBhcnNlciBhbmQg
Y2hlY2sgdGhlIHR5cGUgKGhlbGxvKSBoZXJlPwo+IAo+IAo+IAo+ID4KPiA+ID4gKyAgICAgICAg
LyogaGVsbG8gaXMgc2hvcnQgaGVhZGVyICgxMikgKyBoZWxsbyBzdHJ1Y3QgKDY0KSArIGNhcGFi
aWxpdGllcwo+ID4gPiAoNCkKPiA+ID4gKi8KPiA+ID4gKyAgICAgICAgaW50IGhlbGxvX3NpemUg
PSBzaXplb2Yoc3RydWN0IHVzYl9yZWRpcl9oZWFkZXIpICsgc2l6ZW9mKHN0cnVjdAo+ID4gPiB1
c2JfcmVkaXJfaGVsbG9faGVhZGVyKTsKPiA+Cj4gPiBUaGlzIGZvcm11bGFlIGlzIGNvbmZ1c2lu
ZyB3aXRoIHRoZSBkZXNjcmlwdGlvbi4gc2l6ZW9mKHN0cnVjdAo+ID4gdXNiX3JlZGlyX2hlYWRl
cikKPiA+IGlzIDE2IGJ1dCBpcyBub3QgdGhlIHNob3J0ICgzMmJpdCkgaGVhZGVyLgo+ID4KPiAK
PiBBdCBzdGFnZSBvZiBzZW5kaW5nIGhlbGxvIHRoZSBwYXJzZXIgKGFsc28gd2hlbiBpcyB3b3Jr
cyB1bmRlcgo+IHVzYnJlZGlyaG9zdCkgZG9lcyBub3Qga25vdyB3aGF0IHRoZSBzZWNvbmQgc2lk
ZSBzdXBwb3J0LCBzbyBpdAo+IHVzZXMgbGVnYWN5LWNvbXBhdGlibGUgc3RydWN0dXJlLiBJZiBz
aXplIG9mIGhlbGxvIGlzIGJpZ2dlciB0aGFuIHdlCj4gZXhwZWN0LCBzb21ldGhpbmcgaXMgY29t
cGxldGVseSBub3QgZ29vZC4KPiBXZSBuZWVkIHRvIGZpbmQgY2FwYWJpbGl0aWVzIGluIHRoZSBw
YWNrZXQsIHNvIHdlIG5lZWQgdG8ga25vdyBmb3IKPiBzdXJlIHdoZXJlIHRvIGxvb2sgZm9yIHRo
ZW0uCj4gCgpZZXMsIGJ1dCB0aGUgY29tbWVudCBkb2VzIG5vdCBtYXRjaCB0aGUgY29kZSBmb3Jt
dWxhZSwgdGhhdCBpcyBjb25mdXNpbmcsCnNvbWV0aGluZyBsaWtlCgogICBpbnQgaGVsbG9fc2l6
ZSA9IDEyICsgc2l6ZW9mKHN0cnVjdCB1c2JfcmVkaXJfaGVsbG9faGVhZGVyKSArIDQ7CgppcyBz
dXJlbHkgbGVzcyBjb25mdXNpbmcuIFRoaXMgaXMgaG93ZXZlciBhc3N1bWluZyB0aGF0IHVzYnJl
ZGlyIGxpYnJhcnkKd29uJ3QgYnVtcCBVU0JfUkVESVJfQ0FQU19TSVpFIGluIHRoZSBmdXR1cmUu
IEkgd291bGQgYXQgbGVhc3QgYWRkIGEKY29tcGlsZSBjaGVjayBmb3IgdGhpcyAod29uJ3QgZml4
IGlmIHVzYnJlZGlyIGlzIHVwZGF0ZWQgYnV0IGF0IGxlYXN0CmRldGVjdGVkIGF0IG5leHQgY29t
cGlsZSkuCgo+ID4gPiArICAgICAgICBjaC0+aGVsbG9fc2VudCA9IDE7Cj4gPiA+ICsgICAgICAg
IGlmIChjb3VudCA9PSBoZWxsb19zaXplKSB7Cj4gPgo+ID4gSSB3b3VsZCBzYXkgImNvdW50ID49
IGhlbGxvX3NpemUiIHRvIHN1cHBvcnQgZnV0dXJlIGV4dGVuc2lvbnMgb2YgdGhlCj4gPiBjYXBh
YmlsaXR5IGFycmF5Lgo+IAo+IElmIHRoZXJlIGFyZSBjYXBhYmlsaXRpZXMgdGhhdCB3ZSdyZSBu
b3QgYXdhcmUgb2YsIHdlJ3JlIG5vdAo+IHN5bmNocm9uaXplZCB3aXRoIHRoZSB1c2JyZWRpciBs
aWJyYXJ5Lgo+IAoKWWVzLCBhIAoKICAgU1BJQ0VfVkVSSUZZKFVTQl9SRURJUl9DQVBTX1NJWkUg
PT0gMSk7Cgp3b3VsZCBoZWxwLgoKPiA+Cj4gPiA+ICsgICAgICAgICAgICBtZW1jcHkoJmNoLT5o
b3N0X2NhcHMsIGRhdGEgKyBoZWxsb19zaXplIC0KPiA+ID4gc2l6ZW9mKGNoLT5ob3N0X2NhcHMp
LAo+ID4gPiArICAgICAgICAgICAgICAgICAgIHNpemVvZihjaC0+aG9zdF9jYXBzKSk7Cj4gPiA+
ICsgICAgICAgICAgICBTUElDRV9ERUJVRygiJXMgY2ggJXAsIHNlbmRpbmcgZmlyc3QgaGVsbG8s
IGNhcHMgJTA4WCIsCj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICBfX0ZVTkNUSU9OX18s
IGNoLCBjaC0+aG9zdF9jYXBzKTsKPiA+ID4gKyAgICAgICAgfQo+ID4gPiArICAgIH0KPiA+ID4g
ICAgICByZXMgPSBzcGljZV91c2JyZWRpcl93cml0ZV9jYWxsYmFjayhjaC0+dXNlcl9kYXRhLCBk
YXRhLCBjb3VudCk7Cj4gPiA+ICAgICAgcmV0dXJuIHJlczsKPiA+ID4gIH0KPiA+ID4gQEAgLTY0
MSw2ICs3MDksMjcgQEAgaW50Cj4gPiA+IHNwaWNlX3VzYl9iYWNrZW5kX3JlYWRfZ3Vlc3RfZGF0
YShTcGljZVVzYkJhY2tlbmRDaGFubmVsICpjaCwgdWludDhfdAo+ID4gPiAqZGF0YSwKPiA+ID4g
ICAgICBjaC0+cmVhZF9idWZfc2l6ZSA9IGNvdW50Owo+ID4gPiAgICAgIGlmIChjaC0+dXNicmVk
aXJob3N0KSB7Cj4gPgo+ID4gTWF5YmUgdGhpcyBjb3VsZCBiZSAiY2gtPnVzYnJlZGlyaG9zdCB8
fCAhY2gtPmhlbGxvX2RvbmVfcGFyc2VyIiB0bwo+ID4gcGFyc2UgdGhlICdoZWxsbycgYWx3YXlz
IHdpdGggdXNicmVkaXIgaG9zdCA/Cj4gCj4gSSBleHBlY3QgdGhpcyB3aWxsIG1ha2UgdGhlIGNv
ZGUgbW9yZSBjb21wbGljYXRlZCAoZnJvbSBwcmV2aW91cyBhdHRlbXB0cykuCj4gCj4gPgo+ID4g
PiAgICAgICAgICByZXMgPSB1c2JyZWRpcmhvc3RfcmVhZF9ndWVzdF9kYXRhKGNoLT51c2JyZWRp
cmhvc3QpOwo+ID4gPiArICAgICAgICBpZiAoIWNoLT5oZWxsb19kb25lX3BhcnNlcikgewo+ID4g
PiArICAgICAgICAgICAgaW50IHJlc19wYXJzZXI7Cj4gPiA+ICsgICAgICAgICAgICAvKiB1c2Jy
ZWRpcmhvc3Qgc2hvdWxkIGNvbnN1bWUgaGVsbG8gcmVzcG9uc2UgKi8KPiA+ID4gKyAgICAgICAg
ICAgIGdfcmV0dXJuX3ZhbF9pZl9mYWlsKGNoLT5yZWFkX2J1ZiA9PSBOVUxMLAo+ID4gPiBVU0Jf
UkVESVJfRVJST1JfUkVBRF9QQVJTRSk7Cj4gPiA+ICsKPiA+ID4gKyAgICAgICAgICAgIGNoLT5y
ZWFkX2J1ZiA9IGRhdGE7Cj4gPiA+ICsgICAgICAgICAgICBjaC0+cmVhZF9idWZfc2l6ZSA9IGNv
dW50Owo+ID4gPiArICAgICAgICAgICAgY2gtPmhlbGxvX2RvbmVfcGFyc2VyID0gMTsKPiA+ID4g
KyAgICAgICAgICAgIGlmIChjaC0+YXR0YWNoZWQgJiYgY2gtPmF0dGFjaGVkLT5lZGV2KSB7Cj4g
PiA+ICsgICAgICAgICAgICAgICAgLyogY2FzZSBvZiBDRCBzaGFyaW5nIG9uIGNvbm5lY3QgKi8K
PiA+ID4gKyAgICAgICAgICAgICAgICBjaC0+dXNicmVkaXJob3N0ID0gTlVMTDsKPiA+ID4gKyAg
ICAgICAgICAgICAgICBjaC0+cGFyc2VyID0gY2gtPmhpZGRlbl9wYXJzZXI7Cj4gPiA+ICsgICAg
ICAgICAgICAgICAgU1BJQ0VfREVCVUcoIiVzOiBzd2l0Y2ggJXAgdG8gcGFyc2VyIiwgX19GVU5D
VElPTl9fLAo+ID4gPiBjaCk7Cj4gPiA+ICsgICAgICAgICAgICB9Cj4gPiA+ICsgICAgICAgICAg
ICByZXNfcGFyc2VyID0gdXNicmVkaXJwYXJzZXJfZG9fcmVhZChjaC0+aGlkZGVuX3BhcnNlcik7
Cj4gPiA+ICsgICAgICAgICAgICBpZiAocmVzID49IDApIHsKPiA+ID4gKyAgICAgICAgICAgICAg
ICByZXMgPSByZXNfcGFyc2VyOwo+ID4gPiArICAgICAgICAgICAgfQo+ID4gPiArICAgICAgICB9
Cj4gPiA+ICsgICAgfSBlbHNlIGlmIChjaC0+cGFyc2VyKSB7Cj4gPiA+ICsgICAgICAgIHJlcyA9
IHVzYnJlZGlycGFyc2VyX2RvX3JlYWQoY2gtPnBhcnNlcik7Cj4gPiA+ICAgICAgfSBlbHNlIHsK
PiA+ID4gICAgICAgICAgcmVzID0gVVNCX1JFRElSX0VSUk9SX0lPOwo+ID4gPiAgICAgIH0KPiA+
ID4gQEAgLTY2MSw2ICs3NTAsMTEgQEAgaW50Cj4gPiA+IHNwaWNlX3VzYl9iYWNrZW5kX3JlYWRf
Z3Vlc3RfZGF0YShTcGljZVVzYkJhY2tlbmRDaGFubmVsICpjaCwgdWludDhfdAo+ID4gPiAqZGF0
YSwKPiA+ID4gICAgICB9Cj4gPiA+ICAgICAgU1BJQ0VfREVCVUcoIiVzIGNoICVwLCAlZCBieXRl
cywgcmVzICVkIiwgX19GVU5DVElPTl9fLCBjaCwgY291bnQsCj4gPiA+ICAgICAgcmVzKTsKPiA+
ID4KPiA+ID4gKyAgICBpZiAoY2gtPnJlamVjdGVkKSB7Cj4gPiA+ICsgICAgICAgIGNoLT5yZWpl
Y3RlZCA9IDA7Cj4gPiA+ICsgICAgICAgIHJlcyA9IFVTQl9SRURJUl9FUlJPUl9ERVZfUkVKRUNU
RUQ7Cj4gPiA+ICsgICAgfQo+ID4KPiA+IFdoeSB0aGlzIGlzIGFmdGVyIHRoZSByZWFkPyBXb24n
dCBpdCBkaXNjYXJkIHRoZSB2YWx1ZT8KPiAKPiBCZWNhdXNlIHdlIG5lZWQgdG8gcHJvdmlkZSB0
aGUgZXJyb3IgdG8gdGhlIHVzYi1yZWRpci1jaGFubmVsLgo+IFdlIGtub3cgYWJvdXQgJ3JlamVj
dCcgZnJvbSBvdXIgY2FsbGJhY2sgdGhhdCBpcyBub3QgaW4gY29udGV4dCBvZgo+IHVzYi1yZWRp
ci1jaGFubmVsIG9wZXJhdGlvbi4KPiAKClRoaXMgZG9lcyBub3QgYW5zd2VyIG15IHF1ZXN0aW9u
LCBpZiB3ZSByZXR1cm4gZXJyb3IgYmVmb3JlIHlvdSBhcmUgc3RpbGwKcHJvdmlkaW5nIHRoZSBl
cnJvciwganVzdCB5b3Ugd29uJ3QgZGlzY2FyZCB0aGUgcmVhZC4KT3IgaXMgdGhpcyBkZXRlY3Rp
bmcgYW4gaW50ZXJuYWwgc2F2ZWQgZXJyb3IgZGV0ZWN0ZWQgZHVyaW5nIHRoZSBwcm9jZXNzCm9m
IHRoZSBkYXRhIHdlIHNlbnQ/CgpXaHkgbm90IHVzaW5nIHRydWUvZmFsc2UgZm9yIGJvb2xlYW5z
PwoKPiA+Cj4gPiA+ICsKPiA+ID4gICAgICByZXR1cm4gcmVzOwo+ID4gPiAgfQo+ID4gPgo+ID4g
PiBAQCAtNjkwLDEzICs3ODQsNDI2IEBAIEdFcnJvciAqc3BpY2VfdXNiX2JhY2tlbmRfZ2V0X2Vy
cm9yX2RldGFpbHMoaW50Cj4gPiA+IGVycm9yX2NvZGUsIGdjaGFyICpkZXNjKQo+ID4gPiAgdm9p
ZCBzcGljZV91c2JfYmFja2VuZF9yZXR1cm5fd3JpdGVfZGF0YShTcGljZVVzYkJhY2tlbmRDaGFu
bmVsICpjaCwKPiA+ID4gIHZvaWQKPiA+ID4gICpkYXRhKQo+ID4gPiAgewo+ID4gPiAgICAgIGlm
IChjaC0+dXNicmVkaXJob3N0KSB7Cj4gPiA+IC0gICAgICAgIFNQSUNFX0RFQlVHKCIlcyBjaCAl
cCIsIF9fRlVOQ1RJT05fXywgY2gpOwo+ID4gPiArICAgICAgICBTUElDRV9ERUJVRygiJXMgY2gg
JXAgLT4gdXNicmVkaXJob3N0IiwgX19GVU5DVElPTl9fLCBjaCk7Cj4gPiA+ICAgICAgICAgIHVz
YnJlZGlyaG9zdF9mcmVlX3dyaXRlX2J1ZmZlcihjaC0+dXNicmVkaXJob3N0LCBkYXRhKTsKPiA+
ID4gKyAgICB9IGVsc2UgaWYgKGNoLT5wYXJzZXIpIHsKPiA+ID4gKyAgICAgICAgU1BJQ0VfREVC
VUcoIiVzIGNoICVwIC0+IHBhcnNlciIsIF9fRlVOQ1RJT05fXywgY2gpOwo+ID4gPiArICAgICAg
ICB1c2JyZWRpcnBhcnNlcl9mcmVlX3dyaXRlX2J1ZmZlcihjaC0+cGFyc2VyLCBkYXRhKTsKPiA+
Cj4gPiBBIGJpdCBzY2FyeSB0aGF0IGR1cmluZyBhIHN3aWN0aCBob3N0IDwtPiBwYXJzZXIgdGhp
cyBjYW4gY2FsbCB0aGUgd3JvbmcKPiA+IGZ1bmN0aW9uLiBCdXQgY3VycmVudGx5IHRoZSBpbXBs
ZW1lbnRhdGlvbiBmb3IgYm90aCBpcyB0byBmcmVlICdkYXRhJy4KPiA+Cj4gPiA+ICAgICAgfSBl
bHNlIHsKPiA+ID4gICAgICAgICAgU1BJQ0VfREVCVUcoIiVzIGNoICVwIC0gTk9CT0RZIFRPIENB
TEwiLCBfX0ZVTkNUSU9OX18sIGNoKTsKPiA+ID4gICAgICB9Cj4gPiA+ICB9Cj4gPiA+Cj4gPiA+
ICtzdGF0aWMgdm9pZCB1c2JyZWRpcl9jb250cm9sX3BhY2tldCh2b2lkICpwcml2LAo+ID4gPiAr
ICAgIHVpbnQ2NF90IGlkLCBzdHJ1Y3QgdXNiX3JlZGlyX2NvbnRyb2xfcGFja2V0X2hlYWRlciAq
aCwKPiA+ID4gKyAgICB1aW50OF90ICpkYXRhLCBpbnQgZGF0YV9sZW4pCj4gPgo+ID4gVGhpcyBz
dHlsZSBpcyBuZXcsIEkgc3VwcG9zZSBjb3BpZWQgZnJvbSB1c2JyZWRpciwgYnV0IGlzIG5vdAo+
ID4gc3BpY2UtZ3RrLgo+ID4KPiA+ID4gK3sKPiA+ID4gKyAgICBTcGljZVVzYkJhY2tlbmRDaGFu
bmVsICpjaCA9IHByaXY7Cj4gPiA+ICsgICAgU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpkID0gY2gt
PmF0dGFjaGVkOwo+ID4gPiArICAgIFNwaWNlVXNiRW11bGF0ZWREZXZpY2UgKmVkZXYgPSBkID8g
ZC0+ZWRldiA6IE5VTEw7Cj4gPiA+ICsgICAgc3RydWN0IHVzYl9yZWRpcl9jb250cm9sX3BhY2tl
dF9oZWFkZXIgcmVzcG9uc2UgPSAqaDsKPiA+ID4gKyAgICB1aW50OF90IHJlcXR5cGUgPSBoLT5y
ZXF1ZXN0dHlwZSAmIDB4N2Y7Cj4gPiA+ICsgICAgZ2Jvb2xlYW4gZG9uZSA9IEZBTFNFOwo+ID4g
PiArICAgIHZvaWQgKm91dF9idWZmZXIgPSBOVUxMOwo+ID4gPiArCj4gPiA+ICsgICAgcmVzcG9u
c2Uuc3RhdHVzID0gdXNiX3JlZGlyX3N0YWxsOwo+ID4gPiArICAgIFNQSUNFX0RFQlVHKCIlcyAl
cDogVFJWSUwgJTAyWCAlMDJYICUwNFggJTA0WCAlMDRYIiwKPiA+ID4gKyAgICAgICAgICAgICAg
ICBfX0ZVTkNUSU9OX18sCj4gPiA+ICsgICAgICAgICAgICAgICAgY2gsIGgtPnJlcXVlc3R0eXBl
LCBoLT5yZXF1ZXN0LAo+ID4gPiArICAgICAgICAgICAgICAgIGgtPnZhbHVlLCBoLT5pbmRleCwg
aC0+bGVuZ3RoKTsKPiA+ID4gKwo+ID4gPiArICAgIGlmICghZWRldikgewo+ID4gPiArICAgICAg
ICBTUElDRV9ERUJVRygiJXM6IGRldmljZSBub3QgYXR0YWNoZWQiLCBfX0ZVTkNUSU9OX18pOwo+
ID4gPiArICAgICAgICByZXNwb25zZS5zdGF0dXMgPSB1c2JfcmVkaXJfaW9lcnJvcjsKPiA+ID4g
KyAgICAgICAgZG9uZSA9IFRSVUU7Cj4gPiA+ICsgICAgfSBlbHNlIGlmIChyZXF0eXBlID09IChM
SUJVU0JfUkVRVUVTVF9UWVBFX1NUQU5EQVJEIHwKPiA+ID4gTElCVVNCX1JFQ0lQSUVOVF9ERVZJ
Q0UpICYmCj4gPiA+ICsgICAgICAgICAgICAgICBoLT5yZXF1ZXN0ID09IExJQlVTQl9SRVFVRVNU
X0dFVF9ERVNDUklQVE9SKSB7Cj4gPiA+ICsgICAgICAgIHVpbnQxNl90IHNpemU7Cj4gPiA+ICsg
ICAgICAgIGRvbmUgPSBkZXZpY2Vfb3BzKGVkZXYpLT5nZXRfZGVzY3JpcHRvcihlZGV2LCBoLT52
YWx1ZSA+PiA4LAo+ID4gPiBoLT52YWx1ZSAmIDB4ZmYsCj4gPiA+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmb3V0X2J1ZmZlciwgJnNpemUpOwo+ID4g
PiArICAgICAgICByZXNwb25zZS5sZW5ndGggPSBzaXplOwo+ID4gPiArICAgICAgICBpZiAoZG9u
ZSkgewo+ID4gPiArICAgICAgICAgICAgcmVzcG9uc2Uuc3RhdHVzID0gMDsKPiA+ID4gKyAgICAg
ICAgfQo+ID4gPiArICAgICAgICBkb25lID0gVFJVRTsKPiA+ID4gKyAgICB9Cj4gPiA+ICsKPiA+
ID4gKyAgICBpZiAoIWRvbmUpIHsKPiA+ID4gKyAgICAgICAgZGV2aWNlX29wcyhlZGV2KS0+Y29u
dHJvbF9yZXF1ZXN0KGVkZXYsIGRhdGEsIGRhdGFfbGVuLAo+ID4gPiAmcmVzcG9uc2UsCj4gPiA+
ICZvdXRfYnVmZmVyKTsKPiA+ID4gKyAgICAgICAgZG9uZSA9IFRSVUU7Cj4gPiA+ICsgICAgfQo+
ID4gPiArCj4gPiA+ICsgICAgaWYgKHJlc3BvbnNlLnN0YXR1cykgewo+ID4gPiArICAgICAgICBy
ZXNwb25zZS5sZW5ndGggPSAwOwo+ID4gPiArICAgIH0gZWxzZSBpZiAocmVzcG9uc2UubGVuZ3Ro
ID4gaC0+bGVuZ3RoKSB7Cj4gPiA+ICsgICAgICAgIHJlc3BvbnNlLmxlbmd0aCA9IGgtPmxlbmd0
aDsKPiA+ID4gKyAgICB9Cj4gPiA+ICsKPiA+ID4gKyAgICBTUElDRV9ERUJVRygiJXMgcmVzcG9u
ZGluZyB3aXRoIHBheWxvYWQgb2YgJTAyWCwgc3RhdHVzICVYIiwKPiA+ID4gKyAgICAgICAgICAg
ICAgICBfX0ZVTkNUSU9OX18sIHJlc3BvbnNlLmxlbmd0aCwgcmVzcG9uc2Uuc3RhdHVzKTsKPiA+
ID4gKyAgICB1c2JyZWRpcnBhcnNlcl9zZW5kX2NvbnRyb2xfcGFja2V0KGNoLT5wYXJzZXIsIGlk
LCAmcmVzcG9uc2UsCj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICByZXNwb25zZS5sZW5ndGggPyBvdXRfYnVmZmVyIDoKPiA+ID4gTlVMTCwKPiA+ID4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlLmxlbmd0aCk7Cj4gPiA+
ICsKPiA+ID4gKyAgICB1c2JyZWRpcl93cml0ZV9mbHVzaF9jYWxsYmFjayhjaCk7Cj4gPiA+ICsg
ICAgdXNicmVkaXJwYXJzZXJfZnJlZV9wYWNrZXRfZGF0YShjaC0+cGFyc2VyLCBkYXRhKTsKPiA+
ID4gK30KPiA+ID4gKwo+ID4gPiArc3RhdGljIHZvaWQgdXNicmVkaXJfYnVsa19wYWNrZXQodm9p
ZCAqcHJpdiwKPiA+ID4gKyAgICB1aW50NjRfdCBpZCwgc3RydWN0IHVzYl9yZWRpcl9idWxrX3Bh
Y2tldF9oZWFkZXIgKmgsCj4gPiA+ICsgICAgdWludDhfdCAqZGF0YSwgaW50IGRhdGFfbGVuKQo+
ID4gPiArewo+ID4gPiArICAgIFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmNoID0gcHJpdjsKPiA+
ID4gKyAgICBTcGljZVVzYkJhY2tlbmREZXZpY2UgKmQgPSBjaC0+YXR0YWNoZWQ7Cj4gPiA+ICsg
ICAgU3BpY2VVc2JFbXVsYXRlZERldmljZSAqZWRldiA9IGQgPyBkLT5lZGV2IDogTlVMTDsKPiA+
ID4gKyAgICBzdHJ1Y3QgdXNiX3JlZGlyX2J1bGtfcGFja2V0X2hlYWRlciBob3V0ID0gKmg7Cj4g
PiA+ICsgICAgdWludDMyX3QgbGVuID0gKGgtPmxlbmd0aF9oaWdoIDw8IDE2KSB8IGgtPmxlbmd0
aDsKPiA+ID4gKyAgICBTUElDRV9ERUJVRygiJXMgJXA6IGVwICVYLCBsZW4gJXUsIGlkICUiIEdf
R1VJTlQ2NF9GT1JNQVQsCj4gPiA+IF9fRlVOQ1RJT05fXywKPiA+ID4gKyAgICAgICAgICAgICAg
ICBjaCwgaC0+ZW5kcG9pbnQsIGxlbiwgaWQpOwo+ID4gPiArCj4gPiA+ICsgICAgaWYgKCFlZGV2
KSB7Cj4gPiA+ICsgICAgICAgIFNQSUNFX0RFQlVHKCIlczogZGV2aWNlIG5vdCBhdHRhY2hlZCIs
IF9fRlVOQ1RJT05fXyk7Cj4gPiA+ICsgICAgICAgIGhvdXQuc3RhdHVzID0gdXNiX3JlZGlyX2lv
ZXJyb3I7Cj4gPiA+ICsgICAgICAgIGhvdXQubGVuZ3RoID0gaG91dC5sZW5ndGhfaGlnaCA9IDA7
Cj4gPiA+ICsgICAgICAgIFNQSUNFX0RFQlVHKCIlczogcmVzcG9uZGluZyB3aXRoIFpMUCBzdGF0
dXMgJWQiLCBfX0ZVTkNUSU9OX18sCj4gPiA+IGhvdXQuc3RhdHVzKTsKPiA+ID4gKyAgICB9IGVs
c2UgaWYgKGgtPmVuZHBvaW50ICYgTElCVVNCX0VORFBPSU5UX0lOKSB7Cj4gPiA+ICsgICAgICAg
IGlmIChkZXZpY2Vfb3BzKGVkZXYpLT5idWxrX2luX3JlcXVlc3QoZWRldiwgaWQsICZob3V0KSkg
ewo+ID4gPiArICAgICAgICAgICAgdXNicmVkaXJwYXJzZXJfZnJlZV9wYWNrZXRfZGF0YShjaC0+
cGFyc2VyLCBkYXRhKTsKPiA+ID4gKyAgICAgICAgICAgIC8qIGNvbXBsZXRpb24gaXMgYXN5bmNo
cm9ub3VzICovCj4gPiA+ICsgICAgICAgICAgICByZXR1cm47Cj4gPiA+ICsgICAgICAgIH0KPiA+
ID4gKyAgICB9IGVsc2Ugewo+ID4gPiArICAgICAgICBob3V0LnN0YXR1cyA9IHVzYl9yZWRpcl9z
dGFsbDsKPiA+ID4gKyAgICAgICAgZGV2aWNlX29wcyhlZGV2KS0+YnVsa19vdXRfcmVxdWVzdChl
ZGV2LCBoLT5lbmRwb2ludCwgZGF0YSwKPiA+ID4gZGF0YV9sZW4sICZob3V0LnN0YXR1cyk7Cj4g
PiA+ICsgICAgICAgIFNQSUNFX0RFQlVHKCIlczogcmVzcG9uZGluZyBzdGF0dXMgJWQiLCBfX0ZV
TkNUSU9OX18sCj4gPiA+IGhvdXQuc3RhdHVzKTsKPiA+ID4gKyAgICB9Cj4gPiA+ICsKPiA+ID4g
KyAgICB1c2JyZWRpcnBhcnNlcl9zZW5kX2J1bGtfcGFja2V0KGNoLT5wYXJzZXIsIGlkLCAmaG91
dCwgTlVMTCwgMCk7Cj4gPiA+ICsgICAgdXNicmVkaXJwYXJzZXJfZnJlZV9wYWNrZXRfZGF0YShj
aC0+cGFyc2VyLCBkYXRhKTsKPiA+ID4gKyAgICB1c2JyZWRpcl93cml0ZV9mbHVzaF9jYWxsYmFj
ayhjaCk7Cj4gPiA+ICt9Cj4gPiA+ICsKPiA+ID4gK3N0YXRpYyB2b2lkIHVzYnJlZGlyX2Rldmlj
ZV9yZXNldCh2b2lkICpwcml2KQo+ID4gPiArewo+ID4gPiArICAgIFNwaWNlVXNiQmFja2VuZENo
YW5uZWwgKmNoID0gcHJpdjsKPiA+ID4gKyAgICBTcGljZVVzYkJhY2tlbmREZXZpY2UgKmQgPSBj
aC0+YXR0YWNoZWQ7Cj4gPiA+ICsgICAgU3BpY2VVc2JFbXVsYXRlZERldmljZSAqZWRldiA9IGQg
PyBkLT5lZGV2IDogTlVMTDsKPiA+ID4gKyAgICBTUElDRV9ERUJVRygiJXMgY2ggJXAiLCBfX0ZV
TkNUSU9OX18sIGNoKTsKPiA+ID4gKyAgICBpZiAoZWRldikgewo+ID4gPiArICAgICAgICBkZXZp
Y2Vfb3BzKGVkZXYpLT5yZXNldChlZGV2KTsKPiA+ID4gKyAgICB9Cj4gPiA+ICt9Cj4gPiA+ICsK
PiA+ID4gK3N0YXRpYyB2b2lkIHVzYnJlZGlyX2ludGVyZmFjZV9pbmZvKHZvaWQgKnByaXYsCj4g
PiA+ICsgICAgc3RydWN0IHVzYl9yZWRpcl9pbnRlcmZhY2VfaW5mb19oZWFkZXIgKmludGVyZmFj
ZV9pbmZvKQo+ID4gPiArewo+ID4gPiArICAgIFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmNoID0g
cHJpdjsKPiA+ID4gKyAgICBTUElDRV9ERUJVRygiJXMgbm90IGltcGxlbWVudGVkICVwIiwgX19G
VU5DVElPTl9fLCBjaCk7Cj4gPiA+ICt9Cj4gPiA+ICsKPiA+ID4gK3N0YXRpYyB2b2lkIHVzYnJl
ZGlyX2ludGVyZmFjZV9lcF9pbmZvKHZvaWQgKnByaXYsCj4gPiA+ICsgICAgc3RydWN0IHVzYl9y
ZWRpcl9lcF9pbmZvX2hlYWRlciAqZXBfaW5mbykKPiA+ID4gK3sKPiA+ID4gKyAgICBTcGljZVVz
YkJhY2tlbmRDaGFubmVsICpjaCA9IHByaXY7Cj4gPiA+ICsgICAgU1BJQ0VfREVCVUcoIiVzIG5v
dCBpbXBsZW1lbnRlZCAlcCIsIF9fRlVOQ1RJT05fXywgY2gpOwo+ID4gPiArfQo+ID4gPiArCj4g
PiA+ICtzdGF0aWMgdm9pZCB1c2JyZWRpcl9zZXRfY29uZmlndXJhdGlvbih2b2lkICpwcml2LAo+
ID4gPiArICAgIHVpbnQ2NF90IGlkLCBzdHJ1Y3QgdXNiX3JlZGlyX3NldF9jb25maWd1cmF0aW9u
X2hlYWRlcgo+ID4gPiAqc2V0X2NvbmZpZ3VyYXRpb24pCj4gPiA+ICt7Cj4gPiA+ICsgICAgU3Bp
Y2VVc2JCYWNrZW5kQ2hhbm5lbCAqY2ggPSBwcml2Owo+ID4gPiArICAgIHN0cnVjdCB1c2JfcmVk
aXJfY29uZmlndXJhdGlvbl9zdGF0dXNfaGVhZGVyIGg7Cj4gPiA+ICsgICAgaC5zdGF0dXMgPSAw
Owo+ID4gPiArICAgIGguY29uZmlndXJhdGlvbiA9IHNldF9jb25maWd1cmF0aW9uLT5jb25maWd1
cmF0aW9uOwo+ID4gPiArICAgIFNQSUNFX0RFQlVHKCIlcyBjaCAlcCwgY2ZnICVkIiwgX19GVU5D
VElPTl9fLCBjaCwgaC5jb25maWd1cmF0aW9uKTsKPiA+ID4gKyAgICBpZiAoY2gtPmF0dGFjaGVk
KSB7Cj4gPiA+ICsgICAgICAgIGNoLT5hdHRhY2hlZC0+ZWRldl9jb25maWd1cmVkID0gaC5jb25m
aWd1cmF0aW9uICE9IDA7Cj4gPiA+ICsgICAgfQo+ID4gPiArICAgIHVzYnJlZGlycGFyc2VyX3Nl
bmRfY29uZmlndXJhdGlvbl9zdGF0dXMoY2gtPnBhcnNlciwgaWQsICZoKTsKPiA+ID4gKyAgICB1
c2JyZWRpcl93cml0ZV9mbHVzaF9jYWxsYmFjayhjaCk7Cj4gPiA+ICt9Cj4gPiA+ICsKPiA+ID4g
K3N0YXRpYyB2b2lkIHVzYnJlZGlyX2dldF9jb25maWd1cmF0aW9uKHZvaWQgKnByaXYsIHVpbnQ2
NF90IGlkKQo+ID4gPiArewo+ID4gPiArICAgIFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmNoID0g
cHJpdjsKPiA+ID4gKyAgICBzdHJ1Y3QgdXNiX3JlZGlyX2NvbmZpZ3VyYXRpb25fc3RhdHVzX2hl
YWRlciBoOwo+ID4gPiArICAgIGguc3RhdHVzID0gMDsKPiA+ID4gKyAgICBoLmNvbmZpZ3VyYXRp
b24gPSBjaC0+YXR0YWNoZWQgJiYgY2gtPmF0dGFjaGVkLT5lZGV2X2NvbmZpZ3VyZWQ7Cj4gPiA+
ICsgICAgU1BJQ0VfREVCVUcoIiVzIGNoICVwLCBjZmcgJWQiLCBfX0ZVTkNUSU9OX18sIGNoLCBo
LmNvbmZpZ3VyYXRpb24pOwo+ID4gPiArICAgIHVzYnJlZGlycGFyc2VyX3NlbmRfY29uZmlndXJh
dGlvbl9zdGF0dXMoY2gtPnBhcnNlciwgaWQsICZoKTsKPiA+ID4gKyAgICB1c2JyZWRpcl93cml0
ZV9mbHVzaF9jYWxsYmFjayhjaCk7Cj4gPiA+ICt9Cj4gPiA+ICsKPiA+ID4gK3N0YXRpYyB2b2lk
IHVzYnJlZGlyX3NldF9hbHRfc2V0dGluZyh2b2lkICpwcml2LAo+ID4gPiArICAgIHVpbnQ2NF90
IGlkLCBzdHJ1Y3QgdXNiX3JlZGlyX3NldF9hbHRfc2V0dGluZ19oZWFkZXIgKnMpCj4gPiA+ICt7
Cj4gPiA+ICsgICAgU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCAqY2ggPSBwcml2Owo+ID4gPiArICAg
IHN0cnVjdCB1c2JfcmVkaXJfYWx0X3NldHRpbmdfc3RhdHVzX2hlYWRlciBzaDsKPiA+ID4gKyAg
ICBzaC5zdGF0dXMgPSAoIXMtPmludGVyZmFjZSAmJiAhcy0+YWx0KSA/IDAgOiB1c2JfcmVkaXJf
c3RhbGw7Cj4gPiA+ICsgICAgc2guaW50ZXJmYWNlID0gcy0+aW50ZXJmYWNlOwo+ID4gPiArICAg
IHNoLmFsdCA9IHMtPmFsdDsKPiA+ID4gKyAgICBTUElDRV9ERUJVRygiJXMgY2ggJXAsICVkOiVk
IiwgX19GVU5DVElPTl9fLCBjaCwgcy0+aW50ZXJmYWNlLAo+ID4gPiBzLT5hbHQpOwo+ID4gPiAr
ICAgIHVzYnJlZGlycGFyc2VyX3NlbmRfYWx0X3NldHRpbmdfc3RhdHVzKGNoLT5wYXJzZXIsIGlk
LCAmc2gpOwo+ID4gPiArICAgIHVzYnJlZGlyX3dyaXRlX2ZsdXNoX2NhbGxiYWNrKGNoKTsKPiA+
ID4gK30KPiA+ID4gKwo+ID4gPiArc3RhdGljIHZvaWQgdXNicmVkaXJfZ2V0X2FsdF9zZXR0aW5n
KHZvaWQgKnByaXYsCj4gPiA+ICsgICAgdWludDY0X3QgaWQsIHN0cnVjdCB1c2JfcmVkaXJfZ2V0
X2FsdF9zZXR0aW5nX2hlYWRlciAqcykKPiA+ID4gK3sKPiA+ID4gKyAgICBTcGljZVVzYkJhY2tl
bmRDaGFubmVsICpjaCA9IHByaXY7Cj4gPiA+ICsgICAgc3RydWN0IHVzYl9yZWRpcl9hbHRfc2V0
dGluZ19zdGF0dXNfaGVhZGVyIHNoOwo+ID4gPiArICAgIHNoLnN0YXR1cyA9IChzLT5pbnRlcmZh
Y2UgPT0gMCkgPyAwIDogdXNiX3JlZGlyX3N0YWxsOwo+ID4gPiArICAgIHNoLmludGVyZmFjZSA9
IHMtPmludGVyZmFjZTsKPiA+ID4gKyAgICBzaC5hbHQgPSAwOwo+ID4gPiArICAgIFNQSUNFX0RF
QlVHKCIlcyBjaCAlcCwgaWYgJWQiLCBfX0ZVTkNUSU9OX18sIGNoLCBzLT5pbnRlcmZhY2UpOwo+
ID4gPiArICAgIHVzYnJlZGlycGFyc2VyX3NlbmRfYWx0X3NldHRpbmdfc3RhdHVzKGNoLT5wYXJz
ZXIsIGlkLCAmc2gpOwo+ID4gPiArICAgIHVzYnJlZGlyX3dyaXRlX2ZsdXNoX2NhbGxiYWNrKGNo
KTsKPiA+ID4gK30KPiA+ID4gKwo+ID4gPiArc3RhdGljIHZvaWQgdXNicmVkaXJfY2FuY2VsX2Rh
dGEodm9pZCAqcHJpdiwgdWludDY0X3QgaWQpCj4gPiA+ICt7Cj4gPiA+ICsgICAgU3BpY2VVc2JC
YWNrZW5kQ2hhbm5lbCAqY2ggPSBwcml2Owo+ID4gPiArICAgIFNwaWNlVXNiQmFja2VuZERldmlj
ZSAqZCA9IGNoLT5hdHRhY2hlZDsKPiA+ID4gKyAgICBTcGljZVVzYkVtdWxhdGVkRGV2aWNlICpl
ZGV2ID0gZCA/IGQtPmVkZXYgOiBOVUxMOwo+ID4gPiArICAgIGlmICghZWRldikgewo+ID4gPiAr
ICAgICAgICBTUElDRV9ERUJVRygiJXM6IGRldmljZSBub3QgYXR0YWNoZWQiLCBfX0ZVTkNUSU9O
X18pOwo+ID4gPiArICAgICAgICByZXR1cm47Cj4gPiA+ICsgICAgfQo+ID4gPiArICAgIGRldmlj
ZV9vcHMoZWRldiktPmNhbmNlbF9yZXF1ZXN0KGVkZXYsIGlkKTsKPiA+ID4gK30KPiA+ID4gKwo+
ID4gPiArc3RhdGljIHZvaWQgdXNicmVkaXJfZmlsdGVyX3JlamVjdCh2b2lkICpwcml2KQo+ID4g
PiArewo+ID4gPiArICAgIFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmNoID0gcHJpdjsKPiA+ID4g
KyAgICBTUElDRV9ERUJVRygiJXMgJXAiLCBfX0ZVTkNUSU9OX18sIGNoKTsKPiA+ID4gKyAgICBj
aC0+cmVqZWN0ZWQgPSAxOwo+ID4gPiArfQo+ID4gPiArCj4gPiA+ICsvKiBOb3RlIHRoYXQgdGhl
IG93bmVyc2hpcCBvZiB0aGUgcnVsZXMgYXJyYXkgaXMgcGFzc2VkIG9uIHRvIHRoZQo+ID4gPiBj
YWxsYmFjay4KPiA+ID4gKi8KPiA+ID4gK3N0YXRpYyB2b2lkIHVzYnJlZGlyX2ZpbHRlcl9maWx0
ZXIodm9pZCAqcHJpdiwKPiA+ID4gKyAgICBzdHJ1Y3QgdXNicmVkaXJmaWx0ZXJfcnVsZSAqciwg
aW50IGNvdW50KQo+ID4gPiArewo+ID4gPiArICAgIFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmNo
ID0gcHJpdjsKPiA+ID4gKyAgICBTUElDRV9ERUJVRygiJXMgY2ggJXAgJWQgZmlsdGVycyIsIF9f
RlVOQ1RJT05fXywgY2gsIGNvdW50KTsKPiA+ID4gKwo+ID4gPiArICAgIGZyZWUoY2gtPnJ1bGVz
KTsKPiA+ID4gKwo+ID4gPiArICAgIGNoLT5ydWxlcyA9IHI7Cj4gPiA+ICsgICAgY2gtPnJ1bGVz
X2NvdW50ID0gY291bnQ7Cj4gPiA+ICsgICAgaWYgKGNvdW50KSB7Cj4gPiA+ICsgICAgICAgIGlu
dCBpOwo+ID4gPiArICAgICAgICBmb3IgKGkgPSAwOyBpIDwgY291bnQ7IGkrKykgewo+ID4gPiAr
ICAgICAgICAgICAgU1BJQ0VfREVCVUcoIiVzIGNsYXNzICVkLCAlWDolWCIsCj4gPiA+ICsgICAg
ICAgICAgICAgICAgcltpXS5hbGxvdyA/ICJhbGxvd2VkIiA6ICJkZW5pZWQiLCByW2ldLmRldmlj
ZV9jbGFzcywKPiA+ID4gKyAgICAgICAgICAgICAgICAodWludDMyX3QpcltpXS52ZW5kb3JfaWQs
ICh1aW50MzJfdClyW2ldLnByb2R1Y3RfaWQpOwo+ID4gPiArICAgICAgICB9Cj4gPiA+ICsgICAg
fQo+ID4gPiArfQo+ID4gPiArCj4gPiA+ICtzdGF0aWMgdm9pZCB1c2JyZWRpcl9kZXZpY2VfZGlz
Y29ubmVjdF9hY2sodm9pZCAqcHJpdikKPiA+ID4gK3sKPiA+ID4gKyAgICBTcGljZVVzYkJhY2tl
bmRDaGFubmVsICpjaCA9IHByaXY7Cj4gPiA+ICsgICAgU1BJQ0VfREVCVUcoIiVzIGNoICVwIiwg
X19GVU5DVElPTl9fLCBjaCk7Cj4gPiA+ICsgICAgaWYgKGNoLT5wYXJzZXIgJiYgY2gtPndhaXRf
ZGlzY19hY2spIHsKPiA+ID4gKyAgICAgICAgY2gtPnBhcnNlciA9IE5VTEw7Cj4gPiA+ICsgICAg
ICAgIFNQSUNFX0RFQlVHKCIlcyBzd2l0Y2ggdG8gdXNicmVkaXJob3N0IiwgX19GVU5DVElPTl9f
KTsKPiA+ID4gKyAgICAgICAgY2gtPnVzYnJlZGlyaG9zdCA9IGNoLT5oaWRkZW5faG9zdDsKPiA+
ID4gKyAgICB9Cj4gPiA+ICsgICAgY2gtPndhaXRfZGlzY19hY2sgPSAwOwo+ID4gPiArfQo+ID4g
PiArCj4gPiA+ICtzdGF0aWMgdm9pZCB1c2JyZWRpcl9oZWxsbyh2b2lkICpwcml2LAo+ID4gPiAr
ICAgIHN0cnVjdCB1c2JfcmVkaXJfaGVsbG9faGVhZGVyICpoZWxsbykKPiA+ID4gK3sKPiA+ID4g
KyAgICBTcGljZVVzYkJhY2tlbmRDaGFubmVsICpjaCA9IHByaXY7Cj4gPiA+ICsgICAgU3BpY2VV
c2JCYWNrZW5kRGV2aWNlICpkID0gY2gtPmF0dGFjaGVkOwo+ID4gPiArICAgIFNwaWNlVXNiRW11
bGF0ZWREZXZpY2UgKmVkZXYgPSBkID8gZC0+ZWRldiA6IE5VTEw7Cj4gPiA+ICsgICAgc3RydWN0
IHVzYl9yZWRpcl9kZXZpY2VfY29ubmVjdF9oZWFkZXIgZGV2aWNlX2Nvbm5lY3Q7Cj4gPiA+ICsg
ICAgc3RydWN0IHVzYl9yZWRpcl9lcF9pbmZvX2hlYWRlciBlcF9pbmZvID0geyAwIH07Cj4gPiA+
ICsgICAgc3RydWN0IHVzYl9yZWRpcl9pbnRlcmZhY2VfaW5mb19oZWFkZXIgaW50ZXJmYWNlX2lu
Zm8gPSB7IDAgfTsKPiA+ID4gKyAgICB1aW50OF90ICpjZmc7Cj4gPiA+ICsgICAgdWludDE2X3Qg
c2l6ZSwgb2Zmc2V0ID0gMDsKPiA+ID4gKyAgICBTUElDRV9ERUJVRygiJXMgJXAgJXNhdHRhY2hl
ZCAlcyIsIF9fRlVOQ1RJT05fXywgY2gsCj4gPiA+ICsgICAgICAgIGVkZXYgPyAiIiA6ICJub3Qg
IiwgIGhlbGxvID8gIiIgOiAiKGludGVybmFsKSIpOwo+ID4gPiArCj4gPiA+ICsgICAgaWYgKGhl
bGxvKSB7Cj4gPiA+ICsgICAgICAgIGNoLT5oZWxsb19kb25lX3BhcnNlciA9IDE7Cj4gPiA+ICsg
ICAgfQo+ID4gPiArICAgIGlmICghZWRldikgewo+ID4gPiArICAgICAgICByZXR1cm47Cj4gPiA+
ICsgICAgfQo+ID4gPiArICAgIGlmICghZGV2aWNlX29wcyhlZGV2KS0+Z2V0X2Rlc2NyaXB0b3Io
ZWRldiwgTElCVVNCX0RUX0NPTkZJRywgMCwKPiA+ID4gKHZvaWQKPiA+ID4gKiopJmNmZywgJnNp
emUpKSB7Cj4gPiA+ICsgICAgICAgIHJldHVybjsKPiA+ID4gKyAgICB9Cj4gPiA+ICsgICAgd2hp
bGUgKChvZmZzZXQgKyAxKSA8IHNpemUpIHsKPiA+ID4gKyAgICAgICAgdWludDhfdCBsZW4gID0g
Y2ZnW29mZnNldF07Cj4gPiA+ICsgICAgICAgIHVpbnQ4X3QgdHlwZSA9IGNmZ1tvZmZzZXQgKyAx
XTsKPiA+ID4gKyAgICAgICAgaWYgKChvZmZzZXQgKyBsZW4pID4gc2l6ZSkgewo+ID4gPiArICAg
ICAgICAgICAgYnJlYWs7Cj4gPiA+ICsgICAgICAgIH0KPiA+ID4gKyAgICAgICAgaWYgKHR5cGUg
PT0gTElCVVNCX0RUX0lOVEVSRkFDRSkgewo+ID4gPiArICAgICAgICAgICAgdWludDMyX3QgaSA9
IGludGVyZmFjZV9pbmZvLmludGVyZmFjZV9jb3VudDsKPiA+ID4gKyAgICAgICAgICAgIHVpbnQ4
X3QgY2xhc3MsIHN1YmNsYXNzLCBwcm90b2NvbDsKPiA+ID4gKyAgICAgICAgICAgIGNsYXNzID0g
Y2ZnW29mZnNldCArIDVdOwo+ID4gPiArICAgICAgICAgICAgc3ViY2xhc3MgPSBjZmdbb2Zmc2V0
ICsgNl07Cj4gPiA+ICsgICAgICAgICAgICBwcm90b2NvbCA9IGNmZ1tvZmZzZXQgKyA3XTsKPiA+
ID4gKyAgICAgICAgICAgIGludGVyZmFjZV9pbmZvLmludGVyZmFjZV9jbGFzc1tpXSA9IGNsYXNz
Owo+ID4gPiArICAgICAgICAgICAgaW50ZXJmYWNlX2luZm8uaW50ZXJmYWNlX3N1YmNsYXNzW2ld
ID0gc3ViY2xhc3M7Cj4gPiA+ICsgICAgICAgICAgICBpbnRlcmZhY2VfaW5mby5pbnRlcmZhY2Vf
cHJvdG9jb2xbaV0gPSBwcm90b2NvbDsKPiA+ID4gKyAgICAgICAgICAgIGludGVyZmFjZV9pbmZv
LmludGVyZmFjZV9jb3VudCsrOwo+ID4gPiArICAgICAgICAgICAgU1BJQ0VfREVCVUcoIiVzIElG
JWQ6ICVkLyVkLyVkIiwgX19GVU5DVElPTl9fLCBpLCBjbGFzcywKPiA+ID4gc3ViY2xhc3MsIHBy
b3RvY29sKTsKPiA+ID4gKyAgICAgICAgfSBlbHNlIGlmICh0eXBlID09IExJQlVTQl9EVF9FTkRQ
T0lOVCkgewo+ID4gPiArICAgICAgICAgICAgdWludDhfdCBhZGRyZXNzID0gY2ZnW29mZnNldCAr
IDJdOwo+ID4gPiArICAgICAgICAgICAgdWludDE2X3QgbWF4X3BhY2tldF9zaXplID0gMHgxMDAg
KiBjZmdbb2Zmc2V0ICsgNV0gKwo+ID4gPiBjZmdbb2Zmc2V0Cj4gPiA+ICsgNF07Cj4gPiA+ICsg
ICAgICAgICAgICB1aW50OF90IGluZGV4ID0gYWRkcmVzcyAmIDB4ZjsKPiA+ID4gKyAgICAgICAg
ICAgIGlmIChhZGRyZXNzICYgMHg4MCkgaW5kZXggKz0gMHgxMDsKPiA+ID4gKyAgICAgICAgICAg
IGVwX2luZm8udHlwZVtpbmRleF0gPSBjZmdbb2Zmc2V0ICsgM10gJiAweDM7Cj4gPiA+ICsgICAg
ICAgICAgICBlcF9pbmZvLm1heF9wYWNrZXRfc2l6ZVtpbmRleF0gPSBtYXhfcGFja2V0X3NpemU7
Cj4gPiA+ICsgICAgICAgICAgICBTUElDRV9ERUJVRygiJXMgRVBbJTAyWF06ICVkLyVkIiwgX19G
VU5DVElPTl9fLCBpbmRleCwKPiA+ID4gZXBfaW5mby50eXBlW2luZGV4XSwgbWF4X3BhY2tldF9z
aXplKTsKPiA+ID4gKyAgICAgICAgfQo+ID4gPiArICAgICAgICBvZmZzZXQgKz0gbGVuOwo+ID4g
PiArICAgIH0KPiA+ID4gKwo+ID4gPiArICAgIHVzYnJlZGlycGFyc2VyX3NlbmRfaW50ZXJmYWNl
X2luZm8oY2gtPnBhcnNlciwgJmludGVyZmFjZV9pbmZvKTsKPiA+ID4gKyAgICB1c2JyZWRpcnBh
cnNlcl9zZW5kX2VwX2luZm8oY2gtPnBhcnNlciwgJmVwX2luZm8pOwo+ID4gPiArCj4gPiA+ICsg
ICAgZGV2aWNlX2Nvbm5lY3QuZGV2aWNlX2NsYXNzID0gMDsgLy9kLT5kZXZpY2VfaW5mby5jbGFz
czsKPiA+ID4gKyAgICBkZXZpY2VfY29ubmVjdC5kZXZpY2Vfc3ViY2xhc3MgPSAwOyAvL2QtPmRl
dmljZV9pbmZvLnN1YmNsYXNzOwo+ID4gPiArICAgIGRldmljZV9jb25uZWN0LmRldmljZV9wcm90
b2NvbCA9IDA7IC8vZC0+ZGV2aWNlX2luZm8ucHJvdG9jb2w7Owo+ID4gPiArICAgIGRldmljZV9j
b25uZWN0LnZlbmRvcl9pZCA9IGQtPmRldmljZV9pbmZvLnZpZDsKPiA+ID4gKyAgICBkZXZpY2Vf
Y29ubmVjdC5wcm9kdWN0X2lkID0gZC0+ZGV2aWNlX2luZm8ucGlkOwo+ID4gPiArICAgIGRldmlj
ZV9jb25uZWN0LmRldmljZV92ZXJzaW9uX2JjZCA9IGQtPmRldmljZV9pbmZvLmJjZFVTQjsKPiA+
ID4gKyAgICBkZXZpY2VfY29ubmVjdC5zcGVlZCA9IHVzYl9yZWRpcl9zcGVlZF9oaWdoOwo+ID4g
PiArICAgIHVzYnJlZGlycGFyc2VyX3NlbmRfZGV2aWNlX2Nvbm5lY3QoY2gtPnBhcnNlciwgJmRl
dmljZV9jb25uZWN0KTsKPiA+ID4gKyAgICB1c2JyZWRpcl93cml0ZV9mbHVzaF9jYWxsYmFjayhj
aCk7Cj4gPiA+ICt9Cj4gPiA+ICsKPiA+ID4gK3N0YXRpYyB2b2lkIGluaXRpYWxpemVfcGFyc2Vy
KFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmNoLCBnYm9vbGVhbgo+ID4gPiBkb19oZWxsbykKPiA+
ID4gK3sKPiA+ID4gKyAgICB1aW50MzJfdCBmbGFncywgY2Fwc1tVU0JfUkVESVJfQ0FQU19TSVpF
XSA9IHsgMCB9Owo+ID4gPiArCj4gPiA+ICsgICAgZ19yZXR1cm5faWZfZmFpbChjaC0+aGlkZGVu
X3BhcnNlciAhPSBOVUxMKTsKPiA+ID4gKyAgICBpZiAoY2gtPnBhcnNlcl9pbml0X2RvbmUpIHsK
PiA+ID4gKyAgICAgICAgaWYgKGNoLT5wYXJzZXJfd2l0aF9oZWxsbyAhPSBkb19oZWxsbykgewo+
ID4gPiArICAgICAgICAgICAgZ19yZXR1cm5faWZfcmVhY2hlZCgpOwo+ID4gPiArICAgICAgICB9
Cj4gPiA+ICsgICAgICAgIHJldHVybjsKPiA+ID4gKyAgICB9Cj4gPiA+ICsKPiA+ID4gKyAgICBj
aC0+cGFyc2VyX2luaXRfZG9uZSA9IDE7Cj4gPiA+ICsgICAgY2gtPnBhcnNlcl93aXRoX2hlbGxv
ID0gZG9faGVsbG87Cj4gPiA+ICsgICAgZmxhZ3MgPSB1c2JyZWRpcnBhcnNlcl9mbF93cml0ZV9j
Yl9vd25zX2J1ZmZlciB8Cj4gPiA+IHVzYnJlZGlycGFyc2VyX2ZsX3VzYl9ob3N0Owo+ID4gPiAr
Cj4gPiA+ICsgICAgaWYgKGRvX2hlbGxvKSB7Cj4gPiA+ICsgICAgICAgIGNoLT5oZWxsb19zZW50
ID0gMTsKPiA+Cj4gPiBJbiB3aGljaCBjYXNlIHlvdSBuZWVkIHRvIGRvIHRoZSBoZWxsbyBpbiB0
aGUgcGFyc2VyIGluc3RlYWQgb2YgdGhlIGhvc3Q/Cj4gPiBUaGlzIGNvdWxkIGNhdXNlIGlzc3Vl
cyBzd2l0Y2hpbmcgZnJvbSBwYXJzZXIgYmFjayB0byBob3N0IGluIGNhc2UgeW91Cj4gPiByZW1v
dmUgYW4gZW11bGF0ZWQgZGV2aWNlIGFuZCB5b3UgYWRkIGEgcmVhbCBvbmUuCj4gCj4gVGhlIGNh
c2UgaXMgZGVzY3JpYmVkIGFib3ZlLiBGcm9tIG15IHBvaW50IG9mIHZpZXcsIGhhdmluZyBib3Ro
Cj4gKHVzYnJlZGlyaG9zdCBhbmQgcGFyc2VyKSByZWFkeSBhbmQgc3dpdGNoCj4gYWNjb3JkaW5n
IHRvIHRoZSBjdXJyZW50IG5lZWQgaXMgdGhlIHNpbXBsZXN0IHdheSB0byBkbyB0aGUgam9iLgo+
IAo+ID4KPiA+ID4gKyAgICAgICAgY2gtPmhvc3RfY2FwcyB8PSAxIDw8IHVzYl9yZWRpcl9jYXBf
Y29ubmVjdF9kZXZpY2VfdmVyc2lvbjsKPiA+ID4gKyAgICAgICAgY2gtPmhvc3RfY2FwcyB8PSAx
IDw8IHVzYl9yZWRpcl9jYXBfZGV2aWNlX2Rpc2Nvbm5lY3RfYWNrOwo+ID4gPiArICAgICAgICBj
aC0+aG9zdF9jYXBzIHw9IDEgPDwgdXNiX3JlZGlyX2NhcF9lcF9pbmZvX21heF9wYWNrZXRfc2l6
ZTsKPiA+ID4gKyAgICAgICAgY2gtPmhvc3RfY2FwcyB8PSAxIDw8IHVzYl9yZWRpcl9jYXBfNjRi
aXRzX2lkczsKPiA+ID4gKyAgICAgICAgY2gtPmhvc3RfY2FwcyB8PSAxIDw8IHVzYl9yZWRpcl9j
YXBfMzJiaXRzX2J1bGtfbGVuZ3RoOwo+ID4gPiArICAgIH0gZWxzZSB7Cj4gPiA+ICsgICAgICAg
IGZsYWdzIHw9IHVzYnJlZGlycGFyc2VyX2ZsX25vX2hlbGxvOwo+ID4gPiArICAgIH0KPiA+ID4g
Kwo+ID4gPiArICAgIGlmIChjaC0+aG9zdF9jYXBzICYgKDEgPDwgdXNiX3JlZGlyX2NhcF9jb25u
ZWN0X2RldmljZV92ZXJzaW9uKSkgewo+ID4gPiArICAgICAgICB1c2JyZWRpcnBhcnNlcl9jYXBz
X3NldF9jYXAoY2FwcywKPiA+ID4gdXNiX3JlZGlyX2NhcF9jb25uZWN0X2RldmljZV92ZXJzaW9u
KTsKPiA+ID4gKyAgICB9Cj4gPiA+ICsgICAgdXNicmVkaXJwYXJzZXJfY2Fwc19zZXRfY2FwKGNh
cHMsIHVzYl9yZWRpcl9jYXBfZmlsdGVyKTsKPiA+ID4gKyAgICBpZiAoY2gtPmhvc3RfY2FwcyAm
ICgxIDw8IHVzYl9yZWRpcl9jYXBfZGV2aWNlX2Rpc2Nvbm5lY3RfYWNrKSkgewo+ID4gPiArICAg
ICAgICB1c2JyZWRpcnBhcnNlcl9jYXBzX3NldF9jYXAoY2FwcywKPiA+ID4gdXNiX3JlZGlyX2Nh
cF9kZXZpY2VfZGlzY29ubmVjdF9hY2spOwo+ID4gPiArICAgIH0KPiA+ID4gKyAgICBpZiAoY2gt
Pmhvc3RfY2FwcyAmICgxIDw8IHVzYl9yZWRpcl9jYXBfZXBfaW5mb19tYXhfcGFja2V0X3NpemUp
KSB7Cj4gPiA+ICsgICAgICAgIHVzYnJlZGlycGFyc2VyX2NhcHNfc2V0X2NhcChjYXBzLAo+ID4g
PiB1c2JfcmVkaXJfY2FwX2VwX2luZm9fbWF4X3BhY2tldF9zaXplKTsKPiA+ID4gKyAgICB9Cj4g
PiA+ICsgICAgaWYgKGNoLT5ob3N0X2NhcHMgJiAoMSA8PCB1c2JfcmVkaXJfY2FwXzY0Yml0c19p
ZHMpKSB7Cj4gPiA+ICsgICAgICAgIHVzYnJlZGlycGFyc2VyX2NhcHNfc2V0X2NhcChjYXBzLCB1
c2JfcmVkaXJfY2FwXzY0Yml0c19pZHMpOwo+ID4gPiArICAgIH0KPiA+ID4gKyAgICBpZiAoY2gt
Pmhvc3RfY2FwcyAmICgxIDw8IHVzYl9yZWRpcl9jYXBfMzJiaXRzX2J1bGtfbGVuZ3RoKSkgewo+
ID4gPiArICAgICAgICB1c2JyZWRpcnBhcnNlcl9jYXBzX3NldF9jYXAoY2FwcywKPiA+ID4gdXNi
X3JlZGlyX2NhcF8zMmJpdHNfYnVsa19sZW5ndGgpOwo+ID4gPiArICAgIH0KPiA+ID4gKyAgICBp
ZiAoY2gtPmhvc3RfY2FwcyAmICgxIDw8IHVzYl9yZWRpcl9jYXBfYnVsa19zdHJlYW1zKSkgewo+
ID4gPiArICAgICAgICB1c2JyZWRpcnBhcnNlcl9jYXBzX3NldF9jYXAoY2FwcywgdXNiX3JlZGly
X2NhcF9idWxrX3N0cmVhbXMpOwo+ID4gPiArICAgIH0KPiA+ID4gKyAgICB1c2JyZWRpcnBhcnNl
cl9pbml0KGNoLT5oaWRkZW5fcGFyc2VyLCBQQUNLQUdFX1NUUklORywgY2FwcywKPiA+ID4gVVNC
X1JFRElSX0NBUFNfU0laRSwgZmxhZ3MpOwo+ID4gPiArfQo+ID4gPiArCj4gPiA+ICsvKgo+ID4g
PiArICAgIFdlIGNhbiBpbml0aWFsaXplIHRoZSB1c2JyZWRpcnBhcnNlciB3aXRoIEhFTExPIGVu
YWJsZWQgb25seSBpbiBjYXNlCj4gPiA+ICsgICAgdGhlIGxpYnVzYiBpcyBub3QgYWN0aXZlIGFu
ZCB0aGUgdXNicmVkaXJob3N0IGRvZXMgbm90IGZ1bmN0aW9uLgo+ID4gPiArICAgIFRoZW4gdGhl
IHBhcnNlciBzZW5kcyBzZXNzaW9uIEhFTExPIGFuZCByZWNlaXZlcyBzZXJ2ZXIncyByZXNwb25z
ZS4KPiA+ID4gKyAgICBPdGhlcndpc2UgKHVzYnJlZGlycGFyc2VyIGluaXRpYWxpemVkIHdpdGgg
SEVMTE8gZGlzYWJsZWQpOgo+ID4gPiArICAgIC0gdGhlIHVzYnJlZGlyaG9zdCBzZW5kcyBzZXNz
aW9uIEhFTExPCj4gPiA+ICsgICAgLSB3ZSBsb29rIGludG8gaXQgdG8ga25vdyBzZXQgb2YgY2Fw
YWJpbGl0aWVzIHdlIHNoYWxsIGluaXRpYWxpemUKPiA+ID4gKyAgICAgIHRoZSBwYXJzZXIgd2l0
aAo+ID4gPiArICAgIC0gd2hlbiB3ZSByZWNlaXZlIHNlcnZlcidzIHJlc3BvbnNlIHRvIEhFTExP
IHdlIHByb3ZpZGUgaXQgYWxzbyB0bwo+ID4gPiArICAgICAgcGFyc2VyIHRvIGxldCBpdCBzeW5j
aHJvbml6ZSB3aXRoIHNlcnZlcidzIGNhcGFiaWxpdGllcwo+ID4gPiArKi8KPiA+ID4gK3N0YXRp
YyBzdHJ1Y3QgdXNicmVkaXJwYXJzZXIgKmNyZWF0ZV9wYXJzZXIoU3BpY2VVc2JCYWNrZW5kQ2hh
bm5lbCAqY2gpCj4gPiA+ICt7Cj4gPiA+ICsgICAgc3RydWN0IHVzYnJlZGlycGFyc2VyICpwYXJz
ZXIgPSB1c2JyZWRpcnBhcnNlcl9jcmVhdGUoKTsKPiA+ID4gKwo+ID4gPiArICAgIGdfcmV0dXJu
X3ZhbF9pZl9mYWlsKHBhcnNlciAhPSBOVUxMLCBOVUxMKTsKPiA+ID4gKwo+ID4gPiArICAgIHBh
cnNlci0+cHJpdiA9IGNoOwo+ID4gPiArICAgIHBhcnNlci0+bG9nX2Z1bmMgPSB1c2JyZWRpcl9s
b2c7Cj4gPiA+ICsgICAgcGFyc2VyLT5yZWFkX2Z1bmMgPSB1c2JyZWRpcl9yZWFkX2NhbGxiYWNr
Owo+ID4gPiArICAgIHBhcnNlci0+d3JpdGVfZnVuYyA9IHVzYnJlZGlyX3dyaXRlX2NhbGxiYWNr
Owo+ID4gPiArICAgIHBhcnNlci0+cmVzZXRfZnVuYyA9IHVzYnJlZGlyX2RldmljZV9yZXNldDsK
PiA+ID4gKyAgICBwYXJzZXItPnNldF9jb25maWd1cmF0aW9uX2Z1bmMgPSB1c2JyZWRpcl9zZXRf
Y29uZmlndXJhdGlvbjsKPiA+ID4gKyAgICBwYXJzZXItPmdldF9jb25maWd1cmF0aW9uX2Z1bmMg
PSB1c2JyZWRpcl9nZXRfY29uZmlndXJhdGlvbjsKPiA+ID4gKyAgICBwYXJzZXItPnNldF9hbHRf
c2V0dGluZ19mdW5jID0gdXNicmVkaXJfc2V0X2FsdF9zZXR0aW5nOwo+ID4gPiArICAgIHBhcnNl
ci0+Z2V0X2FsdF9zZXR0aW5nX2Z1bmMgPSB1c2JyZWRpcl9nZXRfYWx0X3NldHRpbmc7Cj4gPiA+
ICsgICAgcGFyc2VyLT5jYW5jZWxfZGF0YV9wYWNrZXRfZnVuYyA9IHVzYnJlZGlyX2NhbmNlbF9k
YXRhOwo+ID4gPiArICAgIHBhcnNlci0+Y29udHJvbF9wYWNrZXRfZnVuYyA9IHVzYnJlZGlyX2Nv
bnRyb2xfcGFja2V0Owo+ID4gPiArICAgIHBhcnNlci0+YnVsa19wYWNrZXRfZnVuYyA9IHVzYnJl
ZGlyX2J1bGtfcGFja2V0Owo+ID4gPiArICAgIHBhcnNlci0+YWxsb2NfbG9ja19mdW5jID0gdXNi
cmVkaXJfYWxsb2NfbG9jazsKPiA+ID4gKyAgICBwYXJzZXItPmxvY2tfZnVuYyA9IHVzYnJlZGly
X2xvY2tfbG9jazsKPiA+ID4gKyAgICBwYXJzZXItPnVubG9ja19mdW5jID0gdXNicmVkaXJfdW5s
b2NrX2xvY2s7Cj4gPiA+ICsgICAgcGFyc2VyLT5mcmVlX2xvY2tfZnVuYyA9IHVzYnJlZGlyX2Zy
ZWVfbG9jazsKPiA+ID4gKyAgICBwYXJzZXItPmhlbGxvX2Z1bmMgPSB1c2JyZWRpcl9oZWxsbzsK
PiA+ID4gKyAgICBwYXJzZXItPmZpbHRlcl9yZWplY3RfZnVuYyA9IHVzYnJlZGlyX2ZpbHRlcl9y
ZWplY3Q7Cj4gPiA+ICsgICAgcGFyc2VyLT5kZXZpY2VfZGlzY29ubmVjdF9hY2tfZnVuYyA9IHVz
YnJlZGlyX2RldmljZV9kaXNjb25uZWN0X2FjazsKPiA+ID4gKyAgICBwYXJzZXItPmludGVyZmFj
ZV9pbmZvX2Z1bmMgPSB1c2JyZWRpcl9pbnRlcmZhY2VfaW5mbzsKPiA+ID4gKyAgICBwYXJzZXIt
PmVwX2luZm9fZnVuYyA9IHVzYnJlZGlyX2ludGVyZmFjZV9lcF9pbmZvOwo+ID4gPiArICAgIHBh
cnNlci0+ZmlsdGVyX2ZpbHRlcl9mdW5jID0gdXNicmVkaXJfZmlsdGVyX2ZpbHRlcjsKPiA+ID4g
Kwo+ID4gPiArICAgIHJldHVybiBwYXJzZXI7Cj4gPiA+ICt9Cj4gPiA+ICsKPiA+ID4gK3N0YXRp
YyBnYm9vbGVhbiBhdHRhY2hfZWRldihTcGljZVVzYkJhY2tlbmRDaGFubmVsICpjaCwKPiA+ID4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICBTcGljZVVzYkJhY2tlbmREZXZpY2UgKmRldiwK
PiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBHRXJyb3IgKiplcnJvcikKPiA+ID4g
K3sKPiA+ID4gKyAgICBpZiAoIWRldi0+ZWRldikgewo+ID4gPiArICAgICAgICBnX3NldF9lcnJv
cihlcnJvciwgU1BJQ0VfQ0xJRU5UX0VSUk9SLAo+ID4gPiBTUElDRV9DTElFTlRfRVJST1JfRkFJ
TEVELAo+ID4gPiArICAgICAgICAgICBfKCJGYWlsZWQgdG8gcmVkaXJlY3QgZGV2aWNlICVkIiks
IDEpOwo+ID4KPiA+IE1pbm9yOiBJIHdvdWxkIHNheSBtb3JlIGFuIGFzc2VydCBsZXZlbCBlcnJv
ciwgdGhlIGRldmljZSBzaG91bGQgYmUgcmVhbCBvcgo+ID4gZW11bGF0ZWQuCj4gPgo+ID4gPiAr
ICAgICAgICByZXR1cm4gRkFMU0U7Cj4gPiA+ICsgICAgfQo+ID4gPiArICAgIGlmIChjaC0+dXNi
cmVkaXJob3N0ICYmICFjaC0+aGVsbG9fZG9uZV9wYXJzZXIpIHsKPiA+ID4gKyAgICAgICAgLyoK
PiA+ID4gKyAgICAgICAgICAgIHdlIGNhbid0IGluaXRpYWxpemUgcGFyc2VyIHVudGlsIHdlIHNl
ZSBoZWxsbyBmcm9tIHVzYnJlZGlyCj4gPiA+ICsgICAgICAgICAgICBhbmQgdGhlIHBhcnNlciBj
YW4ndCB3b3JrIHVudGlsIGl0IHNlZXMgdGhlIGhlbGxvIHJlc3BvbnNlLgo+ID4gPiArICAgICAg
ICAgICAgdGhpcyBpcyBjYXNlIG9mIGF1dG9jb25uZWN0IHdoZW4gZW11bGF0ZWQgZGV2aWNlIGlz
IGF0dGFjaGVkCj4gPiA+ICsgICAgICAgICAgICBiZWZvcmUgdGhlIGNoYW5uZWwgaXMgdXAKPiA+
ID4gKyAgICAgICAgKi8KPiA+ID4gKyAgICAgICAgU1BJQ0VfREVCVUcoIiVzIHdhaXRpbmcgdW50
aWwgdGhlIGNoYW5uZWwgaXMgcmVhZHkiLAo+ID4gPiBfX0ZVTkNUSU9OX18pOwo+ID4gPiArCj4g
PiA+ICsgICAgfSBlbHNlIHsKPiA+ID4gKyAgICAgICAgaW5pdGlhbGl6ZV9wYXJzZXIoY2gsIGNo
LT5oaWRkZW5faG9zdCA9PSBOVUxMKTsKPiA+ID4gKyAgICAgICAgY2gtPnVzYnJlZGlyaG9zdCA9
IE5VTEw7Cj4gPiA+ICsgICAgICAgIGNoLT5wYXJzZXIgPSBjaC0+aGlkZGVuX3BhcnNlcjsKPiA+
ID4gKyAgICB9Cj4gPiA+ICsgICAgY2gtPndhaXRfZGlzY19hY2sgPSAwOwo+ID4gPiArICAgIGNo
LT5hdHRhY2hlZCA9IGRldjsKPiA+ID4gKyAgICBkZXYtPmF0dGFjaGVkX3RvID0gY2g7Cj4gPiA+
ICsgICAgZGV2aWNlX29wcyhkZXYtPmVkZXYpLT5hdHRhY2goZGV2LT5lZGV2LCBjaC0+aGlkZGVu
X3BhcnNlcik7Cj4gPiA+ICsgICAgaWYgKGNoLT5oZWxsb19kb25lX3BhcnNlcikgewo+ID4gPiAr
ICAgICAgICAvKiBzZW5kIGRldmljZSBpbmZvICovCj4gPiA+ICsgICAgICAgIHVzYnJlZGlyX2hl
bGxvKGNoLCBOVUxMKTsKPiA+ID4gKyAgICB9Cj4gPiA+ICsgICAgcmV0dXJuIFRSVUU7Cj4gPiA+
ICt9Cj4gPiA+ICsKPiA+ID4gIGdib29sZWFuIHNwaWNlX3VzYl9iYWNrZW5kX2NoYW5uZWxfYXR0
YWNoKFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmNoLAo+ID4gPiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpkZXYsCj4gPiA+
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBHRXJyb3IgKiplcnJv
cikKPiA+ID4gQEAgLTcwNiw3ICsxMjEzLDEzIEBAIGdib29sZWFuCj4gPiA+IHNwaWNlX3VzYl9i
YWNrZW5kX2NoYW5uZWxfYXR0YWNoKFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmNoLAo+ID4gPgo+
ID4gPiAgICAgIGdfcmV0dXJuX3ZhbF9pZl9mYWlsKGRldiAhPSBOVUxMLCBGQUxTRSk7Cj4gPiA+
Cj4gPiA+ICsgICAgaWYgKCFkZXYtPmxpYnVzYl9kZXZpY2UpIHsKPiA+ID4gKyAgICAgICAgcmV0
dXJuIGF0dGFjaF9lZGV2KGNoLCBkZXYsIGVycm9yKTsKPiA+ID4gKyAgICB9Cj4gPiA+ICsKPiA+
ID4gICAgICBsaWJ1c2JfZGV2aWNlX2hhbmRsZSAqaGFuZGxlID0gTlVMTDsKPiA+ID4gKyAgICBj
aC0+dXNicmVkaXJob3N0ID0gY2gtPmhpZGRlbl9ob3N0Owo+ID4gPiArICAgIGNoLT5wYXJzZXIg
PSBOVUxMOwo+ID4gPgo+ID4gPiAgICAgIC8qCj4gPiA+ICAgICAgICAgVW5kZXIgV2luZG93cyB3
ZSBuZWVkIHRvIGF2b2lkIHVwZGF0aW5nCj4gPiA+IEBAIC03NDAsMTggKzEyNTMsMzMgQEAgZ2Jv
b2xlYW4KPiA+ID4gc3BpY2VfdXNiX2JhY2tlbmRfY2hhbm5lbF9hdHRhY2goU3BpY2VVc2JCYWNr
ZW5kQ2hhbm5lbCAqY2gsCj4gPiA+Cj4gPiA+ICB2b2lkIHNwaWNlX3VzYl9iYWNrZW5kX2NoYW5u
ZWxfZGV0YWNoKFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmNoKQo+ID4gPiAgewo+ID4gPiArICAg
IFNwaWNlVXNiQmFja2VuZERldmljZSAqZCA9IGNoLT5hdHRhY2hlZDsKPiA+ID4gKyAgICBTcGlj
ZVVzYkVtdWxhdGVkRGV2aWNlICplZGV2ID0gZCA/IGQtPmVkZXYgOiBOVUxMOwo+ID4gPiAgICAg
IFNQSUNFX0RFQlVHKCIlcyA+PiBjaCAlcCwgd2FzIGF0dGFjaGVkICVwIiwgX19GVU5DVElPTl9f
LCBjaCwKPiA+ID4gICAgICBjaC0+YXR0YWNoZWQpOwo+ID4gPiAtICAgIGlmICghY2gtPmF0dGFj
aGVkKSB7Cj4gPiA+ICsgICAgaWYgKCFkKSB7Cj4gPiA+ICAgICAgICAgIFNQSUNFX0RFQlVHKCIl
czogbm90aGluZyB0byBkZXRhY2giLCBfX0ZVTkNUSU9OX18pOwo+ID4gPiAgICAgICAgICByZXR1
cm47Cj4gPiA+ICAgICAgfQo+ID4gPiAgICAgIGlmIChjaC0+dXNicmVkaXJob3N0KSB7Cj4gPiA+
ICAgICAgICAgIC8qIGl0IHdpbGwgY2FsbCBsaWJ1c2JfY2xvc2UgaW50ZXJuYWxseSAqLwo+ID4g
PiAgICAgICAgICB1c2JyZWRpcmhvc3Rfc2V0X2RldmljZShjaC0+dXNicmVkaXJob3N0LCBOVUxM
KTsKPiA+ID4gKyAgICB9IGVsc2UgaWYgKGNoLT5wYXJzZXIpIHsKPiA+ID4gKyAgICAgICAgaWYg
KGVkZXYpIHsKPiA+ID4gKyAgICAgICAgICAgIGRldmljZV9vcHMoZWRldiktPmRldGFjaChlZGV2
KTsKPiA+ID4gKyAgICAgICAgfQo+ID4gPiArICAgICAgICB1c2JyZWRpcnBhcnNlcl9zZW5kX2Rl
dmljZV9kaXNjb25uZWN0KGNoLT5wYXJzZXIpOwo+ID4gPiArICAgICAgICB1c2JyZWRpcl93cml0
ZV9mbHVzaF9jYWxsYmFjayhjaCk7Cj4gPiA+ICsgICAgICAgIGNoLT53YWl0X2Rpc2NfYWNrID0g
dXNicmVkaXJwYXJzZXJfcGVlcl9oYXNfY2FwKGNoLT5wYXJzZXIsCj4gPiA+ICsKPiA+ID4gdXNi
X3JlZGlyX2NhcF9kZXZpY2VfZGlzY29ubmVjdF9hY2spOwo+ID4gPiArICAgICAgICBpZiAoIWNo
LT53YWl0X2Rpc2NfYWNrKSB7Cj4gPiA+ICsgICAgICAgICAgICBjaC0+dXNicmVkaXJob3N0ID0g
Y2gtPmhpZGRlbl9ob3N0Owo+ID4gPiArICAgICAgICAgICAgY2gtPnBhcnNlciA9IE5VTEw7Cj4g
PiA+ICsgICAgICAgIH0KPiA+ID4gICAgICB9Cj4gPiA+ICAgICAgU1BJQ0VfREVCVUcoIiVzIGNo
ICVwLCBkZXRhY2ggZG9uZSIsIF9fRlVOQ1RJT05fXywgY2gpOwo+ID4gPiAgICAgIGNoLT5hdHRh
Y2hlZC0+YXR0YWNoZWRfdG8gPSBOVUxMOwo+ID4gPiAgICAgIGNoLT5hdHRhY2hlZCA9IE5VTEw7
Cj4gPiA+ICsgICAgY2gtPnJlamVjdGVkID0gMDsKPiA+ID4gIH0KPiA+ID4KPiA+ID4gIFNwaWNl
VXNiQmFja2VuZENoYW5uZWwgKnNwaWNlX3VzYl9iYWNrZW5kX2NoYW5uZWxfbmV3KFNwaWNlVXNi
QmFja2VuZAo+ID4gPiAgKmJlLAo+ID4gPiBAQCAtNzY2LDI2ICsxMjk0LDMzIEBAIFNwaWNlVXNi
QmFja2VuZENoYW5uZWwKPiA+ID4gKnNwaWNlX3VzYl9iYWNrZW5kX2NoYW5uZWxfbmV3KFNwaWNl
VXNiQmFja2VuZCAqYmUsCj4gPiA+ICAgICAgY2gtPnVzZXJfZGF0YSA9IFNQSUNFX1VTQlJFRElS
X0NIQU5ORUwodXNlcl9kYXRhKTsKPiA+ID4gICAgICBpZiAoYmUtPmxpYnVzYl9jb250ZXh0KSB7
Cj4gPgo+ID4gVGhpcyBjYW4gbmV2ZXIgYmUgTlVMTCwgaWYgd2UgYXJlIG5vdCBhYmxlIHRvIGFs
bG9jYXRlIGl0IGluc2lkZQo+ID4gc3BpY2VfdXNiX2JhY2tlbmRfbmV3IHRoZSBmdW5jdGlvbiBy
ZXR1cm5zIE5VTEwuCj4gPiBUaGlzIHNob3VsZCBiZSBpbiBhIHByZWxpbWluYXJ5IHBhdGNoIHRv
IG1ha2UgdGhpcyBjbGVhci4KPiAKPiBMb29raW5nIGEgbGl0dGxlIGZvcndhcmQsIGFmdGVyIGNk
LXNoYXJpbmcgaXMgaW4sIHRoaXMgY291bGQgYmUKPiBwb3NzaWJsZSB0byBub3QgZGlzYWJsZSB0
aGUgcmVkaXJlY3Rpb24gaXMgdGhlcmUgaXMgbm8gdXNiZGsuCj4gRXZlbiBpbiBjYXNlIHRoZSBs
aWJ1c2IgZG9lcyBub3Qgd29yaywgdGhlIGNsaWVudCBjYW4gd29yayB3aXRoCj4gcmVkaXJlY3Rp
b24gZW5hYmxlZCBhbmQgcmVkaXJlY3Qgb25seSBlbXVsYXRlZCBkZXZpY2VzLgo+IEkgd291bGQg
bm90IHJlbW92ZSB0aGlzIGNoZWNrLgo+IAoKVGhlIHByb2JsZW0gaXMgdGhhdCBjdXJyZW50IGNv
ZGUgaGFzIHNvbWUgcGFydCB3aXRoIG9uZSBsb2dpYwoodXNiIGNvbnRleHQgaXMgYWx3YXlzIGF2
YWlsYWJsZSkgYW5kIHNvbWUgb3RoZXIgcGFydCBvZiBjb2RlCndpdGggdGhlIG9wcG9zaXRlIGxv
Z2ljICh1c2IgY29udGV4dCBpcyBub3QgcmVxdWlyZWQpLgoKbGlidXNiIHdvcmtzIGFsc28gd2l0
aG91dCB1c2JkayBpbnN0YWxsZWQgYW5kIHByb3ZpZGVzIGEKdmFsaWQgKG5vdCBOVUxMKSB1c2Ig
Y29udGV4dC4KCj4gPgo+ID4gPiAgICAgICAgICBjaC0+YmFja2VuZCA9IGJlOwo+ID4gPiAtICAg
ICAgICBjaC0+dXNicmVkaXJob3N0ID0gdXNicmVkaXJob3N0X29wZW5fZnVsbCgKPiA+ID4gLSAg
ICAgICAgICAgIGJlLT5saWJ1c2JfY29udGV4dCwKPiA+ID4gLSAgICAgICAgICAgIE5VTEwsCj4g
PiA+IC0gICAgICAgICAgICB1c2JyZWRpcl9sb2csCj4gPiA+IC0gICAgICAgICAgICB1c2JyZWRp
cl9yZWFkX2NhbGxiYWNrLAo+ID4gPiAtICAgICAgICAgICAgdXNicmVkaXJfd3JpdGVfY2FsbGJh
Y2ssCj4gPiA+IC0gICAgICAgICAgICB1c2JyZWRpcl93cml0ZV9mbHVzaF9jYWxsYmFjaywKPiA+
ID4gLSAgICAgICAgICAgIHVzYnJlZGlyX2FsbG9jX2xvY2ssCj4gPiA+IC0gICAgICAgICAgICB1
c2JyZWRpcl9sb2NrX2xvY2ssCj4gPiA+IC0gICAgICAgICAgICB1c2JyZWRpcl91bmxvY2tfbG9j
aywKPiA+ID4gLSAgICAgICAgICAgIHVzYnJlZGlyX2ZyZWVfbG9jaywKPiA+ID4gLSAgICAgICAg
ICAgIGNoLCBQQUNLQUdFX1NUUklORywKPiA+ID4gLSAgICAgICAgICAgIHNwaWNlX3V0aWxfZ2V0
X2RlYnVnKCkgPyB1c2JyZWRpcnBhcnNlcl9kZWJ1ZyA6Cj4gPiA+IHVzYnJlZGlycGFyc2VyX3dh
cm5pbmcsCj4gPiA+IC0gICAgICAgICAgICB1c2JyZWRpcmhvc3RfZmxfd3JpdGVfY2Jfb3duc19i
dWZmZXIpOwo+ID4gPiArICAgICAgICBjaC0+dXNicmVkaXJob3N0ID0KPiA+ID4gKyAgICAgICAg
ICAgIHVzYnJlZGlyaG9zdF9vcGVuX2Z1bGwoYmUtPmxpYnVzYl9jb250ZXh0LAo+ID4gPiArICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOVUxMLAo+ID4gPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICB1c2JyZWRpcl9sb2csCj4gPiA+ICsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHVzYnJlZGlyX3JlYWRfY2FsbGJhY2ssCj4gPiA+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzYnJlZGlyX3dyaXRlX2NhbGxiYWNrLAo+
ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2JyZWRpcl93cml0ZV9m
bHVzaF9jYWxsYmFjaywKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
dXNicmVkaXJfYWxsb2NfbG9jaywKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgdXNicmVkaXJfbG9ja19sb2NrLAo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICB1c2JyZWRpcl91bmxvY2tfbG9jaywKPiA+ID4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgdXNicmVkaXJfZnJlZV9sb2NrLAo+ID4gPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBjaCwgUEFDS0FHRV9TVFJJTkcsCj4gPiA+ICsgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwaWNlX3V0aWxfZ2V0X2RlYnVnKCkgPwo+ID4g
PiB1c2JyZWRpcnBhcnNlcl9kZWJ1ZyA6Cj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgdXNicmVkaXJwYXJzZXJfd2FybmluZywKPiA+ID4gKwo+ID4gPiB1c2Jy
ZWRpcmhvc3RfZmxfd3JpdGVfY2Jfb3duc19idWZmZXIpOwo+ID4gPiAgICAgICAgICBnX3dhcm5f
aWZfZmFpbChjaC0+dXNicmVkaXJob3N0ICE9IE5VTEwpOwo+ID4gPiAgICAgIH0KPiA+ID4gKwo+
ID4gPiAgICAgIGlmIChjaC0+dXNicmVkaXJob3N0KSB7Cj4gPiA+IC0gICAgICAgIHVzYnJlZGly
aG9zdF9zZXRfYnVmZmVyZWRfb3V0cHV0X3NpemVfY2IoY2gtPnVzYnJlZGlyaG9zdCwKPiA+ID4g
dXNicmVkaXJfYnVmZmVyZWRfb3V0cHV0X3NpemVfY2FsbGJhY2spOwo+ID4gPiAtICAgIH0gZWxz
ZSB7Cj4gPiA+IC0gICAgICAgIGdfZnJlZShjaCk7Cj4gPiA+ICsgICAgICAgIGNoLT5oaWRkZW5f
cGFyc2VyID0gY3JlYXRlX3BhcnNlcihjaCk7Cj4gPiA+ICsgICAgICAgIGNoLT5oaWRkZW5faG9z
dCA9IGNoLT51c2JyZWRpcmhvc3Q7Cj4gPiA+ICsgICAgICAgIHVzYnJlZGlyaG9zdF9zZXRfYnVm
ZmVyZWRfb3V0cHV0X3NpemVfY2IoY2gtPnVzYnJlZGlyaG9zdCwKPiA+ID4gKwo+ID4gPiB1c2Jy
ZWRpcl9idWZmZXJlZF9vdXRwdXRfc2l6ZV9jYWxsYmFjayk7CgpIZXJlIHlvdSBhcmUgYXNzdW1p
bmcgdGhhdCB1c2IgY29udGV4dCBpcyBub3QgTlVMTCB3aGljaCBkb2VzIG5vdAptYXRjaCB3aXRo
IHlvdXIgc3RhdGVtZW50IGFib3ZlLgoKPiA+ID4gKyAgICB9Cj4gPiA+ICsKPiA+ID4gKyAgICBp
ZiAoIWNoLT5oaWRkZW5fcGFyc2VyKSB7Cj4gPiA+ICsgICAgICAgIHNwaWNlX3VzYl9iYWNrZW5k
X2NoYW5uZWxfZGVsZXRlKGNoKTsKPiA+ID4gICAgICAgICAgY2ggPSBOVUxMOwo+ID4gPiAgICAg
IH0KPiA+ID4KPiA+ID4gQEAgLTc5NSw5ICsxMzMwLDE0IEBAIFNwaWNlVXNiQmFja2VuZENoYW5u
ZWwKPiA+ID4gKnNwaWNlX3VzYl9iYWNrZW5kX2NoYW5uZWxfbmV3KFNwaWNlVXNiQmFja2VuZCAq
YmUsCj4gPiA+Cj4gPiA+ICB2b2lkIHNwaWNlX3VzYl9iYWNrZW5kX2NoYW5uZWxfZmx1c2hfd3Jp
dGVzKFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmNoKQo+ID4gPiAgewo+ID4gPiAtICAgIFNQSUNF
X0RFQlVHKCIlcyAlcCwgaG9zdCAlcCIsIF9fRlVOQ1RJT05fXywgY2gsIGNoLT51c2JyZWRpcmhv
c3QpOwo+ID4gPiArICAgIFNQSUNFX0RFQlVHKCIlcyAlcCBpcyB1cCIsIF9fRlVOQ1RJT05fXywg
Y2gpOwo+ID4gPiAgICAgIGlmIChjaC0+dXNicmVkaXJob3N0KSB7Cj4gPiA+ICAgICAgICAgIHVz
YnJlZGlyaG9zdF93cml0ZV9ndWVzdF9kYXRhKGNoLT51c2JyZWRpcmhvc3QpOwo+ID4gPiArICAg
ICAgICBpbml0aWFsaXplX3BhcnNlcihjaCwgRkFMU0UpOwo+ID4gPiArICAgIH0gZWxzZSB7Cj4g
PiA+ICsgICAgICAgIGluaXRpYWxpemVfcGFyc2VyKGNoLCBUUlVFKTsKPiA+Cj4gPiBXaHkgaW5p
dGlhbGl6ZV9wYXJzZSBpcyBjYWxsZWQgaGVyZT8KPiAKPiBUaGlzIGlzIHRoZSBkZWNpc2lvbiBw
b2ludCB3aGV0aGVyIHBhcnNlciB3b3JrcyB3aXRoIGhlbGxvPW9uIG9yIG5vdAo+IAoKQW5kIHNv
IGlmIHRoaXMgY2hhbm5lbCBzdXBwb3J0IG9ubHkgZW11bGF0ZWQgZGV2aWNlcyB3aGljaCBpcyBh
CnJlZ3Jlc3Npb24uCgo+ID4KPiA+ID4gKyAgICAgICAgY2gtPnBhcnNlciA9IGNoLT5oaWRkZW5f
cGFyc2VyOwo+ID4gPiArICAgICAgICB1c2JyZWRpcnBhcnNlcl9kb193cml0ZShjaC0+cGFyc2Vy
KTsKPiA+ID4gICAgICB9Cj4gPiA+ICB9Cj4gPiA+Cj4gPiA+IEBAIC04MDcsMTIgKzEzNDcsMTYg
QEAgdm9pZAo+ID4gPiBzcGljZV91c2JfYmFja2VuZF9jaGFubmVsX2RlbGV0ZShTcGljZVVzYkJh
Y2tlbmRDaGFubmVsICpjaCkKPiA+ID4gICAgICBpZiAoIWNoKSB7Cj4gPiA+ICAgICAgICAgIHJl
dHVybjsKPiA+ID4gICAgICB9Cj4gPiA+IC0gICAgaWYgKGNoLT51c2JyZWRpcmhvc3QpIHsKPiA+
ID4gLSAgICAgICAgdXNicmVkaXJob3N0X2Nsb3NlKGNoLT51c2JyZWRpcmhvc3QpOwo+ID4gPiAr
ICAgIGlmIChjaC0+aGlkZGVuX2hvc3QpIHsKPiA+ID4gKyAgICAgICAgdXNicmVkaXJob3N0X2Ns
b3NlKGNoLT5oaWRkZW5faG9zdCk7Cj4gPiA+ICsgICAgfQo+ID4gPiArICAgIGlmIChjaC0+aGlk
ZGVuX3BhcnNlcikgewo+ID4gPiArICAgICAgICB1c2JyZWRpcnBhcnNlcl9kZXN0cm95KGNoLT5o
aWRkZW5fcGFyc2VyKTsKPiA+ID4gICAgICB9Cj4gPiA+Cj4gPiA+ICAgICAgaWYgKGNoLT5ydWxl
cykgewo+ID4gPiAtICAgICAgICBnX2ZyZWUoY2gtPnJ1bGVzKTsKPiA+ID4gKyAgICAgICAgLyog
cnVsZXMgd2VyZSBhbGxvY2F0ZWQgYnkgdXNicmVkaXJwYXJzZXIgKi8KPiA+ID4gKyAgICAgICAg
ZnJlZShjaC0+cnVsZXMpOwo+ID4KPiA+IE1pbm9yIDpJIHN1cHBvc2UgdGhpcyBzbWFsbCBjaGFu
Z2UgY2FuIGdvIHRvIGEgcHJlbGltaW5hcnkgcGF0Y2ggdG9vCj4gCj4gVGhpcyBjb2RlIHdhcyBo
ZXJlIGJlZm9yZSwgYnV0IGl0IHdhcyBuZXZlciB1c2VkIGFzIGNoLT5ydWxlcyB3YXMKPiBuZXZl
ciBhc3NpZ25lZC4KPiAKCnllcwoKPiBIb25lc3RseSBJIGRvIG5vdCB1bmRlcnN0YW5kIHdoYXQg
dGhpcyAicHJlbGltaW5hcnkgcGF0Y2giIHNob3VsZAo+IGNvbnRhaW4gYW5kIHdoYXQgaXQgaXMg
Z29vZCBmb3IuCj4gCgpJIGRvbid0IHRoaW5rIGlzIGEgZ29vZCBpZGVhIHRvIGFkZCBjb2RlIHdp
dGggbXVsdGlwbGUgbG9naWMgZm9yCnRoZSBzYW1lIGNvbmRpdGlvbi4gQ3VycmVudGx5IG1vc3Qg
b2YgdGhlIGNvZGUgYXNzdW1lIHVzYiBjb250ZXh0CmlzIHZhbGlkLCBJIHdvdWxkIGdvIGluIGEg
c2luZ2xlIGRpcmVjdGlvbiwgbm90IGFkZGluZyBhZGRpdGlvbmFsCmNvZGUgd2l0aCAyIGRpZmZl
cmVudCBsb2dpbiBhYm91dCBpdC4KCj4gPgo+ID4gPiAgICAgIH0KPiA+ID4KPiA+ID4gICAgICBn
X2ZyZWUoY2gpOwo+ID4KPiA+IEZyZWRpYW5vCj4gCl9fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fClNwaWNlLWRldmVsIG1haWxpbmcgbGlzdApTcGljZS1kZXZl
bEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFp
bG1hbi9saXN0aW5mby9zcGljZS1kZXZlbA==
