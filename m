Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 088F974973
	for <lists+spice-devel@lfdr.de>; Thu, 25 Jul 2019 10:57:26 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id CF18D6E69A;
	Thu, 25 Jul 2019 08:57:23 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id B197A6E69A
 for <spice-devel@lists.freedesktop.org>; Thu, 25 Jul 2019 08:57:22 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx04.intmail.prod.int.phx2.redhat.com
 [10.5.11.14])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id CCA883092647;
 Thu, 25 Jul 2019 08:57:21 +0000 (UTC)
Received: from colo-mx.corp.redhat.com
 (colo-mx02.intmail.prod.int.phx2.redhat.com [10.5.11.21])
 by smtp.corp.redhat.com (Postfix) with ESMTPS id C00535DDA2;
 Thu, 25 Jul 2019 08:57:21 +0000 (UTC)
Received: from zmail25.collab.prod.int.phx2.redhat.com
 (zmail25.collab.prod.int.phx2.redhat.com [10.5.83.31])
 by colo-mx.corp.redhat.com (Postfix) with ESMTP id B57281972D;
 Thu, 25 Jul 2019 08:57:21 +0000 (UTC)
Date: Thu, 25 Jul 2019 04:57:21 -0400 (EDT)
From: Frediano Ziglio <fziglio@redhat.com>
To: Yuri Benditovich <yuri.benditovich@daynix.com>
Message-ID: <204769724.2953329.1564045041460.JavaMail.zimbra@redhat.com>
In-Reply-To: <20190724105351.13753-2-yuri.benditovich@daynix.com>
References: <20190724105351.13753-1-yuri.benditovich@daynix.com>
 <20190724105351.13753-2-yuri.benditovich@daynix.com>
MIME-Version: 1.0
X-Originating-IP: [10.33.32.8, 10.4.195.5]
Thread-Topic: usb-redir: define interfaces to support emulated devices
Thread-Index: gJQogiBANws/LdH2vN62V4A5r8FDIg==
X-Scanned-By: MIMEDefang 2.79 on 10.5.11.14
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16
 (mx1.redhat.com [10.5.110.43]); Thu, 25 Jul 2019 08:57:21 +0000 (UTC)
Subject: Re: [Spice-devel] [spice-gtk 1/9] usb-redir: define interfaces to
 support emulated devices
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: yan@daynix.com, spice-devel@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

PiAKPiBTcGljZVVzYkJhY2tlbmREZXZpY2Ugc3RydWN0dXJlIGlzIGV4dGVuZGVkIHRvIHN1cHBv
cnQKPiBhZGRpdGlvbmFsIGtpbmQgb2YgZGV2aWNlIHRoYXQgaXMgZW11bGF0ZWQgYnkgU3BpY2Ut
R1RLCj4gYW5kIG5vdCBwcmVzZW50IGxvY2FsbHkgKGFuZCBkb2VzIG5vdCBoYXZlIGxpYnVzYl9k
ZXZpY2UpLAo+IHN1Y2ggZGV2aWNlIGhhcyBpbnN0ZWFkIHBvaW50ZXIgdG8gU3BpY2VVc2JFbXVs
YXRlZERldmljZQo+IGFic3RyYWN0IHN0cnVjdHVyZS4gU3BlY2lmaWMgaW1wbGVtZW50YXRpb24g
b2Ygc3VjaCBkZXZpY2UKPiBkZXBlbmRzIG9uIGl0cyBkZXZpY2UgdHlwZSAoY3VycmVudGx5IG9u
bHkgJ0NEIGRldmljZScKPiBkZWZpbmVkKS4gSW1wbGVtZW50YXRpb24gbW9kdWxlIHJlZ2lzdGVy
cyBjb25zdHJ1Y3RvciBmb3IKPiB0aGlzIGRldmljZSB0eXBlLiBEZXZpY2Ugc3RydWN0dXJlIGlz
IGFic3RyYWN0IGJ1dCBhbHdheXMKPiBzdGFydHMgZnJvbSB0YWJsZSBvZiB2aXJ0dWFsIGZ1bmN0
aW9ucyByZXF1aXJlZCB0byByZWRpcmVjdAo+IHN1Y2ggdmlydHVhbCBkZXZpY2UuCj4gCj4gU2ln
bmVkLW9mZi1ieTogWXVyaSBCZW5kaXRvdmljaCA8eXVyaS5iZW5kaXRvdmljaEBkYXluaXguY29t
Pgo+IC0tLQo+ICBzcmMvbWVzb24uYnVpbGQgICAgIHwgICAxICsKPiAgc3JjL3VzYi1iYWNrZW5k
LmMgICB8IDEyOCArKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrLQo+
ICBzcmMvdXNiLWJhY2tlbmQuaCAgIHwgIDM2ICsrKysrKysrKysrKy0KPiAgc3JjL3VzYi1lbXVs
YXRpb24uaCB8ICA4OCArKysrKysrKysrKysrKysrKysrKysrKysrKysrKysKPiAgNCBmaWxlcyBj
aGFuZ2VkLCAyNTAgaW5zZXJ0aW9ucygrKSwgMyBkZWxldGlvbnMoLSkKPiAgY3JlYXRlIG1vZGUg
MTAwNjQ0IHNyYy91c2ItZW11bGF0aW9uLmgKPiAKPiBkaWZmIC0tZ2l0IGEvc3JjL21lc29uLmJ1
aWxkIGIvc3JjL21lc29uLmJ1aWxkCj4gaW5kZXggYWRjZmFlYy4uNDlmZWM1MiAxMDA2NDQKPiAt
LS0gYS9zcmMvbWVzb24uYnVpbGQKPiArKysgYi9zcmMvbWVzb24uYnVpbGQKPiBAQCAtMTIyLDYg
KzEyMiw3IEBAIHNwaWNlX2NsaWVudF9nbGliX3NvdXJjZXMgPSBbCj4gICAgJ3VzYnV0aWwuYycs
Cj4gICAgJ3VzYnV0aWwuaCcsCj4gICAgJ3VzYi1iYWNrZW5kLmMnLAo+ICsgICd1c2ItZW11bGF0
aW9uLmgnLAo+ICAgICd1c2ItYmFja2VuZC5oJywKPiAgICAndm1jc3RyZWFtLmMnLAo+ICAgICd2
bWNzdHJlYW0uaCcsCj4gZGlmZiAtLWdpdCBhL3NyYy91c2ItYmFja2VuZC5jIGIvc3JjL3VzYi1i
YWNrZW5kLmMKPiBpbmRleCA5YWM4NTk1Li4wYmYyZWNjIDEwMDY0NAo+IC0tLSBhL3NyYy91c2It
YmFja2VuZC5jCj4gKysrIGIvc3JjL3VzYi1iYWNrZW5kLmMKPiBAQCAtMzksNiArMzksNyBAQAo+
ICAjaW5jbHVkZSAidXNicmVkaXJwYXJzZXIuaCIKPiAgI2luY2x1ZGUgInNwaWNlLXV0aWwuaCIK
PiAgI2luY2x1ZGUgInVzYi1iYWNrZW5kLmgiCj4gKyNpbmNsdWRlICJ1c2ItZW11bGF0aW9uLmgi
Cj4gICNpbmNsdWRlICJjaGFubmVsLXVzYnJlZGlyLXByaXYuaCIKPiAgI2luY2x1ZGUgInNwaWNl
LWNoYW5uZWwtcHJpdi5oIgo+ICAKPiBAQCAtNDcsNiArNDgsNyBAQAo+ICBzdHJ1Y3QgX1NwaWNl
VXNiQmFja2VuZERldmljZQo+ICB7Cj4gICAgICBsaWJ1c2JfZGV2aWNlICpsaWJ1c2JfZGV2aWNl
Owo+ICsgICAgU3BpY2VVc2JFbXVsYXRlZERldmljZSAqZWRldjsKCkkgc3VzcGVjdCBvbmx5IG9u
ZSBvZiB0aGVzZSAyIGZpZWxkcyBhcmUgdmFsaWQsIG9yIGRldmljZQppcyBlbXVsYXRlZCBvciBp
cyBhIHJlYWwgb25lLCByaWdodD8KQSBjb21tZW50IGFib3V0IGl0IGxpa2UgCgogICAvKiBQb2lu
dGVyIHRvIGRldmljZS4gRWl0aGVyIHJlYWwgZGV2aWNlIChsaWJ1c2JfZGV2aWNlKSAKICAgICog
b3IgZW11bGF0ZWQgb25lIChlZGV2KSAqLwogICBsaWJ1c2JfZGV2aWNlICpsaWJ1c2JfZGV2aWNl
OwogICBTcGljZVVzYkVtdWxhdGVkRGV2aWNlICplZGV2OwoKaG9uZXN0bHkgImVkZXYiIGxvb2tz
IGEgYml0IHRvbyBzaG9ydGVuLCBhbHNvIGNvbXBhcmVkIHRvCiJsaWJ1c2JfZGV2aWNlIiwgbWF5
YmUgImVtdV9kZXYiID8KCgo+ICAgICAgZ2ludCByZWZfY291bnQ7Cj4gICAgICBTcGljZVVzYkJh
Y2tlbmRDaGFubmVsICphdHRhY2hlZF90bzsKPiAgICAgIFVzYkRldmljZUluZm9ybWF0aW9uIGRl
dmljZV9pbmZvOwo+IEBAIC02Niw2ICs2OCw5IEBAIHN0cnVjdCBfU3BpY2VVc2JCYWNrZW5kCj4g
ICAgICBsaWJ1c2JfZGV2aWNlICoqbGlidXNiX2RldmljZV9saXN0Owo+ICAgICAgZ2ludCByZWRp
cmVjdGluZzsKPiAgI2VuZGlmCj4gKwo+ICsgICAgU3BpY2VVc2JFbXVsYXRlZERldmljZUNyZWF0
ZSBkZXZfaW5pdFtVU0JfREVWX1RZUEVfTUFYXTsKPiArICAgIHVpbnQzMl90IG93bl9kZXZpY2Vz
X21hc2s7CgpJdCB0b29rIGEgYml0IG9mIHRpbWUgdG8gdW5kZXJzdGFuZCB3aGF0IGlzIHRoaXMu
Ckxvb2tzIGxpa2UgaXQncyBhIHNvcnQgb2YgYml0IGFycmF5IG9mIGFsbG9jYXRlZCBkZXZpY2Vz
LgpJcyB0aGUgImFkZHJlc3MiIGxpbWl0ZWQgdG8gMzIgYnkgVVNCIHNwZWNpZmljYXRpb24gb3Ig
aXMgYSBjb2RlCmxpbWl0YXRpb24/CgpJIHdvdWxkIGFkZCBhIGNvbW1lbnQgbGlrZQoKICAvKiBN
YXNrIG9mIGFsbG9jYXRlZCBkZXZpY2UsIHJlbGF0aXZlIGJpdCBzZXQgdG8gMSBpbmRpY2F0ZSBh
bGxvY2F0ZWQgKi8KICB1aW50MzJfdCBvd25fZGV2aWNlc19tYXNrOwoKPiAgfTsKPiAgCj4gIHN0
cnVjdCBfU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbAo+IEBAIC00MDgsNiArNDEzLDcgQEAgU3BpY2VV
c2JCYWNrZW5kICpzcGljZV91c2JfYmFja2VuZF9uZXcoR0Vycm9yICoqZXJyb3IpCj4gICAgICAg
ICAgbGlidXNiX3NldF9vcHRpb24oYmUtPmxpYnVzYl9jb250ZXh0LCBMSUJVU0JfT1BUSU9OX1VT
RV9VU0JESyk7Cj4gICNlbmRpZgo+ICAjZW5kaWYKPiArICAgICAgICBiZS0+b3duX2RldmljZXNf
bWFzayA9IDM7IC8qIGV4Y2x1ZGUgYWRkcmVzc2VzIDAgYW5kIDEgKi8KCldoeSB0aGVzZSBhcmUg
cmVzZXJ2ZWQ/IFVTQiBzcGVjaWZpY2F0aW9uPwoKPiAgICAgIH0KPiAgICAgIFNQSUNFX0RFQlVH
KCIlcyA8PCIsIF9fRlVOQ1RJT05fXyk7Cj4gICAgICByZXR1cm4gYmU7Cj4gQEAgLTUyNCw4ICs1
MzAsMTIgQEAgdm9pZAo+IHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV91bnJlZihTcGljZVVzYkJh
Y2tlbmREZXZpY2UgKmRldikKPiAgewo+ICAgICAgTE9VRF9ERUJVRygiJXMgPj4gJXAoJWQpIiwg
X19GVU5DVElPTl9fLCBkZXYsIGRldi0+cmVmX2NvdW50KTsKPiAgICAgIGlmIChnX2F0b21pY19p
bnRfZGVjX2FuZF90ZXN0KCZkZXYtPnJlZl9jb3VudCkpIHsKPiAtICAgICAgICBsaWJ1c2JfdW5y
ZWZfZGV2aWNlKGRldi0+bGlidXNiX2RldmljZSk7Cj4gLSAgICAgICAgTE9VRF9ERUJVRygiJXMg
ZnJlZWluZyAlcCAobGlidXNiICVwKSIsIF9fRlVOQ1RJT05fXywgZGV2LAo+IGRldi0+bGlidXNi
X2RldmljZSk7Cj4gKyAgICAgICAgaWYgKGRldi0+bGlidXNiX2RldmljZSkgewo+ICsgICAgICAg
ICAgICBsaWJ1c2JfdW5yZWZfZGV2aWNlKGRldi0+bGlidXNiX2RldmljZSk7Cj4gKyAgICAgICAg
ICAgIExPVURfREVCVUcoIiVzIGZyZWVpbmcgJXAgKGxpYnVzYiAlcCkiLCBfX0ZVTkNUSU9OX18s
IGRldiwKPiBkZXYtPmxpYnVzYl9kZXZpY2UpOwo+ICsgICAgICAgIH0gZWxzZSBpZiAoZGV2LT5l
ZGV2KSB7Cj4gKyAgICAgICAgICAgIGRldmljZV9vcHMoZGV2LT5lZGV2KS0+ZGVsZXRlKGRldi0+
ZWRldik7Cj4gKyAgICAgICAgfQoKQWx0aG91Z2ggb25seSBvbmUgc2hvdWxkIGJlIE5VTEwgSSB3
b3VsZCB0cnkgdG8gZGVsZXRlIGJvdGguCkkgd291bGQgYWxzbyBhdm9pZCB0aGUgQysrIHJlc2Vy
dmVkIGtleXdvcmQgImRlbGV0ZSIuIEFsc28gYmVjYXVzZQpmb3IgdGhlIHNhbWUgcHVycG9zZSB3
ZSB3ZSB1c2UgImZyZWUiIG9yICJ1bnJlZiIgKHRoaXMgZnVuY3Rpb24KaXMgc3BpY2VfdXNiX2Jh
Y2tlbmRfZGV2aWNlX3VucmVmIGZvciBpbnN0YW5jZSwgYWJvdmUgdGhlcmUncwphIGNhbGwgdG8g
bGlidXNiX3VucmVmX2RldmljZSkuCgo+ICAgICAgICAgIGdfZnJlZShkZXYpOwo+ICAgICAgfQo+
ICB9Cj4gQEAgLTgyNCw0ICs4MzQsMTE4IEBACj4gc3BpY2VfdXNiX2JhY2tlbmRfY2hhbm5lbF9n
ZXRfZ3Vlc3RfZmlsdGVyKFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmNoLAo+ICAgICAgfQo+ICB9
Cj4gIAo+ICtnY2hhciAqIHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9kZXNjcmlwdGlvbihTcGlj
ZVVzYkJhY2tlbmREZXZpY2UgKmRldiwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgY29uc3QgZ2NoYXIgKmZvcm1hdCkKPiArewo+ICsgICAgaWYgKCFkZXYt
PmVkZXYpIHsKPiArICAgICAgICByZXR1cm4gZ19zdHJkdXAoIk5vdCBhdmFpbGFibGUgZm9yIGxp
YnVzYiBkZXZpY2VzIik7Cj4gKyAgICB9Cj4gKyAgICBnY2hhciAqZGVzY3JpcHRpb24sICpkZXNj
cmlwdG9yLCAqcHJvZHVjdDsKPiArICAgIGRlc2NyaXB0b3IgPSBnX3N0cmR1cF9wcmludGYoIlsl
MDR4OiUwNHhdIiwgZGV2LT5kZXZpY2VfaW5mby52aWQsCj4gZGV2LT5kZXZpY2VfaW5mby5waWQp
Owo+ICsgICAgcHJvZHVjdCA9IGRldmljZV9vcHMoZGV2LT5lZGV2KS0+Z2V0X3Byb2R1Y3RfZGVz
Y3JpcHRpb24oZGV2LT5lZGV2KTsKPiArICAgIGRlc2NyaXB0aW9uID0gZ19zdHJkdXBfcHJpbnRm
KGZvcm1hdCwgIiIsIHByb2R1Y3QsIGRlc2NyaXB0b3IsCj4gKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBkZXYtPmRldmljZV9pbmZvLmJ1cywKPiBkZXYtPmRldmljZV9pbmZvLmFk
ZHJlc3MpOwoKTm90IGEgYmlnIGZ1biBvZiBoYXZpbmcgdGhlIGZvcm1hdCBub3QgY29uc3RhbnQu
IENvbXBpbGVyIGNhbiBkbwptYWdpYyB3aXRoIGEgY29uc3RhbnQgd2hpbGUgbWFueSBzYWZldHkg
Y2hlY2tzIGFyZSBub3QgcG9zc2libGUgaWYKdGhpcyBpcyBub3QgY29uc3RhbnQuCgo+ICsgICAg
Z19mcmVlKGRlc2NyaXB0b3IpOwo+ICsgICAgZ19mcmVlKHByb2R1Y3QpOwo+ICsgICAgcmV0dXJu
IGRlc2NyaXB0aW9uOwo+ICt9Cj4gKwo+ICt2b2lkIHNwaWNlX3VzYl9iYWNrZW5kX3JlZ2lzdGVy
X2RldmljZV90eXBlKFNwaWNlVXNiQmFja2VuZCAqYmUsCj4gKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgVXNiRW11bGF0ZWREZXZpY2VUeXBlIGRldl90eXBlLAo+
ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNwaWNlVXNiRW11
bGF0ZWREZXZpY2VDcmVhdGUKPiBpbml0X3Byb2MpCj4gK3sKPiArICAgIGlmIChkZXZfdHlwZSA+
PSBVU0JfREVWX1RZUEVfTUFYKSB7Cj4gKyAgICAgICAgZ19yZXR1cm5faWZfcmVhY2hlZCgpOwo+
ICsgICAgfQo+ICsgICAgYmUtPmRldl9pbml0W2Rldl90eXBlXSA9IGluaXRfcHJvYzsKPiArfQo+
ICsKPiArdm9pZCBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfcmVwb3J0X2NoYW5nZShTcGljZVVz
YkJhY2tlbmQgKmJlLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIFNwaWNlVXNiQmFja2VuZERldmljZSAqZGV2KQo+ICt7Cj4gKyAgICBnY2hhciAqZGVzYzsK
PiArICAgIGdfcmV0dXJuX2lmX2ZhaWwoZGV2ICYmIGRldi0+ZWRldik7Cj4gKwo+ICsgICAgZGVz
YyA9IGRldmljZV9vcHMoZGV2LT5lZGV2KS0+Z2V0X3Byb2R1Y3RfZGVzY3JpcHRpb24oZGV2LT5l
ZGV2KTsKPiArICAgIFNQSUNFX0RFQlVHKCIlczogJXMiLCBfX0ZVTkNUSU9OX18sIGRlc2MpOwo+
ICsgICAgZ19mcmVlKGRlc2MpOwo+ICt9Cj4gKwo+ICt2b2lkIHNwaWNlX3VzYl9iYWNrZW5kX2Rl
dmljZV9lamVjdChTcGljZVVzYkJhY2tlbmQgKmJlLAo+IFNwaWNlVXNiQmFja2VuZERldmljZSAq
ZGV2KQo+ICt7Cj4gKyAgICBnX3JldHVybl9pZl9mYWlsKGRldiAmJiBkZXYtPmVkZXYpOwo+ICsK
PiArICAgIGlmIChiZS0+aG90cGx1Z19jYWxsYmFjaykgewo+ICsgICAgICAgIGJlLT5ob3RwbHVn
X2NhbGxiYWNrKGJlLT5ob3RwbHVnX3VzZXJfZGF0YSwgZGV2LCBGQUxTRSk7Cj4gKyAgICB9Cj4g
KyAgICBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfdW5yZWYoZGV2KTsKPiArfQo+ICsKPiArZ2Jv
b2xlYW4gc3BpY2VfdXNiX2JhY2tlbmRfY3JlYXRlX2RldmljZShTcGljZVVzYkJhY2tlbmQgKmJl
LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFVzYkVtdWxhdGVk
RGV2aWNlVHlwZSBkZXZfdHlwZSwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBVc2JDcmVhdGVEZXZpY2VQYXJhbWV0ZXJzICpwYXJhbSkKPiArewo+ICsgICAgU3Bp
Y2VVc2JFbXVsYXRlZERldmljZSAqZWRldiA9IE5VTEw7Cj4gKyAgICBTcGljZVVzYkJhY2tlbmRE
ZXZpY2UgICpkZXY7Cj4gKyAgICBzdHJ1Y3QgbGlidXNiX2RldmljZV9kZXNjcmlwdG9yICpkZXNj
Owo+ICsgICAgdWludDE2X3QgZGV2aWNlX2Rlc2Nfc2l6ZTsKPiArICAgIHVpbnQ4X3QgYWRkcmVz
cyA9IDA7Cj4gKwo+ICsgICAgaWYgKGRldl90eXBlID49IFVTQl9ERVZfVFlQRV9NQVggfHwgIWJl
LT5kZXZfaW5pdFtkZXZfdHlwZV0pIHsKPiArICAgICAgICBwYXJhbS0+ZXJyb3IgPSBnX2Vycm9y
X25ldyhTUElDRV9DTElFTlRfRVJST1IsCj4gU1BJQ0VfQ0xJRU5UX0VSUk9SX0ZBSUxFRCwKPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfKCJjYW4ndCBjcmVhdGUgZGV2aWNl
IC0gbm90Cj4gc3VwcG9ydGVkIikpOwoKU3VyZSB5b3UgZG9uJ3Qgd2FudCBnX2Vycm9yX3NldCBp
bnN0ZWFkPyBUaGlzIGNvZGUgaXMgYWx3YXlzCmFzc3VtaW5nIHRoYXQgcGFyYW0tPmVycm9yIGlz
IE5VTEwuCgo+ICsgICAgICAgIHJldHVybiBGQUxTRTsKPiArICAgIH0KPiArCj4gKyAgICBpZiAo
YmUtPm93bl9kZXZpY2VzX21hc2sgPT0gMHhmZmZmZmZmZikgewo+ICsgICAgICAgIHBhcmFtLT5l
cnJvciA9IGdfZXJyb3JfbmV3KFNQSUNFX0NMSUVOVF9FUlJPUiwKPiBTUElDRV9DTElFTlRfRVJS
T1JfRkFJTEVELAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF8oImNhbid0
IGNyZWF0ZSBkZXZpY2UgLSBsaW1pdAo+IHJlYWNoZWQiKSk7Cj4gKyAgICAgICAgcmV0dXJuIEZB
TFNFOwo+ICsgICAgfQo+ICsgICAgZm9yIChhZGRyZXNzID0gMDsgYWRkcmVzcyA8IDMyOyArK2Fk
ZHJlc3MpIHsKPiArICAgICAgICBpZiAofmJlLT5vd25fZGV2aWNlc19tYXNrICYgKDEgPDwgYWRk
cmVzcykpIHsKPiArICAgICAgICAgICAgYnJlYWs7Cj4gKyAgICAgICAgfQo+ICsgICAgfQo+ICsK
PiArICAgIGRldiA9IGdfbmV3MChTcGljZVVzYkJhY2tlbmREZXZpY2UsIDEpOwo+ICsKPiArICAg
IHBhcmFtLT5hZGRyZXNzID0gYWRkcmVzczsKPiArICAgIGlmIChiZS0+ZGV2X2luaXRbZGV2X3R5
cGVdKGJlLCBkZXYsIHBhcmFtLCAmZWRldikpIHsKPiArICAgICAgICBnX2ZyZWUoZGV2KTsKPiAr
ICAgICAgICByZXR1cm4gRkFMU0U7Cj4gKyAgICB9Cj4gKwo+ICsgICAgaWYgKCFkZXZpY2Vfb3Bz
KGVkZXYpLT5nZXRfZGVzY3JpcHRvcihlZGV2LCBMSUJVU0JfRFRfREVWSUNFLCAwLAo+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAodm9pZCAqKikmZGVzYywgJmRl
dmljZV9kZXNjX3NpemUpCj4gKyAgICAgICAgfHwgZGV2aWNlX2Rlc2Nfc2l6ZSAhPSBzaXplb2Yo
KmRlc2MpKSB7Cj4gKwo+ICsgICAgICAgIGRldmljZV9vcHMoZWRldiktPmRlbGV0ZShlZGV2KTsK
PiArICAgICAgICBnX2ZyZWUoZGV2KTsKPiArICAgICAgICBwYXJhbS0+ZXJyb3IgPSBnX2Vycm9y
X25ldyhTUElDRV9DTElFTlRfRVJST1IsCj4gU1BJQ0VfQ0xJRU5UX0VSUk9SX0ZBSUxFRCwKPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfKCJjYW4ndCBjcmVhdGUgZGV2aWNl
IC0gaW50ZXJuYWwKPiBlcnJvciIpKTsKPiArICAgICAgICByZXR1cm4gRkFMU0U7Cj4gKyAgICB9
Cj4gKwo+ICsgICAgYmUtPm93bl9kZXZpY2VzX21hc2sgfD0gMSA8PCBhZGRyZXNzOwo+ICsKPiAr
ICAgIGRldi0+ZGV2aWNlX2luZm8uYnVzID0gQlVTX05VTUJFUl9GT1JfRU1VTEFURURfVVNCOwo+
ICsgICAgZGV2LT5kZXZpY2VfaW5mby5hZGRyZXNzID0gYWRkcmVzczsKPiArICAgIGRldi0+ZGV2
aWNlX2luZm8udmlkID0gZGVzYy0+aWRWZW5kb3I7Cj4gKyAgICBkZXYtPmRldmljZV9pbmZvLnBp
ZCA9IGRlc2MtPmlkUHJvZHVjdDsKPiArICAgIGRldi0+ZGV2aWNlX2luZm8uYmNkVVNCID0gZGVz
Yy0+YmNkVVNCOwo+ICsgICAgZGV2LT5kZXZpY2VfaW5mby5jbGFzcyA9IGRlc2MtPmJEZXZpY2VD
bGFzczsKPiArICAgIGRldi0+ZGV2aWNlX2luZm8uc3ViY2xhc3MgPSBkZXNjLT5iRGV2aWNlU3Vi
Q2xhc3M7Cj4gKyAgICBkZXYtPmRldmljZV9pbmZvLnByb3RvY29sID0gZGVzYy0+YkRldmljZVBy
b3RvY29sOwo+ICsgICAgZGV2LT5kZXZpY2VfaW5mby5kZXZpY2VfdHlwZSA9IGRldl90eXBlOwo+
ICsgICAgZGV2LT5yZWZfY291bnQgPSAxOwo+ICsgICAgZGV2LT5lZGV2ID0gZWRldjsKPiArCj4g
KyAgICBpZiAoYmUtPmhvdHBsdWdfY2FsbGJhY2spIHsKPiArICAgICAgICBiZS0+aG90cGx1Z19j
YWxsYmFjayhiZS0+aG90cGx1Z191c2VyX2RhdGEsIGRldiwgVFJVRSk7Cj4gKyAgICB9Cj4gKwo+
ICsgICAgcmV0dXJuIFRSVUU7Cj4gK30KPiArCj4gICNlbmRpZiAvKiBVU0JfUkVESVIgKi8KPiBk
aWZmIC0tZ2l0IGEvc3JjL3VzYi1iYWNrZW5kLmggYi9zcmMvdXNiLWJhY2tlbmQuaAo+IGluZGV4
IDY5YTQ5MGIuLjhhMDRlZDAgMTAwNjQ0Cj4gLS0tIGEvc3JjL3VzYi1iYWNrZW5kLmgKPiArKysg
Yi9zcmMvdXNiLWJhY2tlbmQuaAo+IEBAIC0zMSwxNSArMzEsMjQgQEAgdHlwZWRlZiBzdHJ1Y3Qg
X1NwaWNlVXNiQmFja2VuZCBTcGljZVVzYkJhY2tlbmQ7Cj4gIHR5cGVkZWYgc3RydWN0IF9TcGlj
ZVVzYkJhY2tlbmREZXZpY2UgU3BpY2VVc2JCYWNrZW5kRGV2aWNlOwo+ICB0eXBlZGVmIHN0cnVj
dCBfU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCBTcGljZVVzYkJhY2tlbmRDaGFubmVsOwo+ICAKPiAr
dHlwZWRlZiBlbnVtCj4gK3sKClN0eWxlOiBzdHlsZSBkb2N1bWVudCBzdGF0ZSB0aGF0IGJyYWNr
ZXQgc2hvdWxkIGJlIG9uIHRoZSBzYW1lIGxpbmUsCmhlcmUgYW5kIGluIG1hbnkgb3RoZXIgcGxh
Y2VzLiBJIGtub3cgdGhlcmUgYXJlIG90aGVyIG9jY3VycmVuY2VzIGJ1dApJIHdvdWxkIHByZWZl
ciB3ZSB1c2Ugb25lIHN0eWxlLgoKPiArICAgIFVTQl9ERVZfVFlQRV9OT05FLAo+ICsgICAgVVNC
X0RFVl9UWVBFX0NELAo+ICsgICAgVVNCX0RFVl9UWVBFX01BWAo+ICt9IFVzYkVtdWxhdGVkRGV2
aWNlVHlwZTsKPiArCj4gIHR5cGVkZWYgc3RydWN0IFVzYkRldmljZUluZm9ybWF0aW9uCj4gIHsK
PiAgICAgIHVpbnQxNl90IGJ1czsKPiAgICAgIHVpbnQxNl90IGFkZHJlc3M7Cj4gICAgICB1aW50
MTZfdCB2aWQ7Cj4gICAgICB1aW50MTZfdCBwaWQ7Cj4gKyAgICB1aW50MTZfdCBiY2RVU0I7Cj4g
ICAgICB1aW50OF90IGNsYXNzOwo+ICAgICAgdWludDhfdCBzdWJjbGFzczsKPiAgICAgIHVpbnQ4
X3QgcHJvdG9jb2w7Cj4gKyAgICB1aW50OF90IGRldmljZV90eXBlOyAvKiBVc2JFbXVsYXRlZERl
dmljZVR5cGUgKi8KCkkgc3VwcG9zZSB5b3UgZG9uJ3QgdXNlIFVzYkVtdWxhdGVkRGV2aWNlVHlw
ZSB0byByZWR1Y2Ugc3RydWN0dXJlCnNpemUsIHJpZ2h0PwpIb3cgdGhpcyBmaWVsZCBpcyBmaWxs
ZWQgZm9yIHJlYWwgZGV2aWNlcz8gVVNCX0RFVl9UWVBFX05PTkU/Ck1heWJlIHNob3VsZCBiZSBu
YW1lZCBVU0JfREVWX1RZUEVfUkVBTCB0aGVuPwoKPiAgfSBVc2JEZXZpY2VJbmZvcm1hdGlvbjsK
PiAgCj4gIHR5cGVkZWYgdm9pZCgqdXNiX2hvdF9wbHVnX2NhbGxiYWNrKSh2b2lkICp1c2VyX2Rh
dGEsIFNwaWNlVXNiQmFja2VuZERldmljZQo+ICAqZGV2LCBnYm9vbGVhbiBhZGRlZCk7Cj4gQEAg
LTcxLDcgKzgwLDYgQEAgZ2Jvb2xlYW4KPiBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfaXNvY2go
U3BpY2VVc2JCYWNrZW5kRGV2aWNlICpkZXYpOwo+ICAvKiByZXR1cm5zIDAgaWYgdGhlIGRldmlj
ZSBwYXNzZXMgdGhlIGZpbHRlciAqLwo+ICBpbnQgc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX2No
ZWNrX2ZpbHRlcihTcGljZVVzYkJhY2tlbmREZXZpY2UgKmRldiwKPiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RydWN0IHVzYnJlZGlyZmlsdGVyX3J1
bGUKPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKnJ1bGVzLCBp
bnQgY291bnQpOwo+IC0KCkkgd291bGQgbGl2ZSB0aGlzIGVtcHR5IGxpbmUuCgo+ICAvKiBTcGlj
ZSBVU0IgYmFja2VuZCBjaGFubmVsIEFQSSAqLwo+ICBTcGljZVVzYkJhY2tlbmRDaGFubmVsICpz
cGljZV91c2JfYmFja2VuZF9jaGFubmVsX25ldyhTcGljZVVzYkJhY2tlbmQKPiAgKmNvbnRleHQs
Cj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHZvaWQKPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgKnVzZXJfZGF0YSk7Cj4gQEAgLTg5LDYgKzk3LDMyIEBAIHZvaWQKPiBzcGljZV91c2Jf
YmFja2VuZF9jaGFubmVsX2dldF9ndWVzdF9maWx0ZXIoU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCAq
Y2gsCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlu
dCAqY291bnQpOwo+ICB2b2lkIHNwaWNlX3VzYl9iYWNrZW5kX3JldHVybl93cml0ZV9kYXRhKFNw
aWNlVXNiQmFja2VuZENoYW5uZWwgKmNoLCB2b2lkCj4gICpkYXRhKTsKPiAgCj4gKyNkZWZpbmUg
QlVTX05VTUJFUl9GT1JfRU1VTEFURURfVVNCICAgICAgICAgMjU1Cj4gKwoKV2hhdCBpcyB0aGlz
PyBXaGVyZSBpcyBpdCB1c2VkPwpTdHlsZTogZG8gbm90IGluZGVudCBtYWNybyBkZWZpbml0aW9u
LgoKPiArdHlwZWRlZiBzdHJ1Y3QgVXNiQ3JlYXRlRGV2aWNlUGFyYW1ldGVycwo+ICt7Cj4gKyAg
ICBHRXJyb3IgKmVycm9yOwo+ICsgICAgdWludDMyX3QgICAgYWRkcmVzczsKPiArICAgIHVpbnQz
Ml90ICAgIHJlc2VydmVkOwoKInJlc2VydmVkIj8gSXMgdGhpcyBhIGtpbmQgb2YgQUJJIGV4cG9y
dGVkIHN0cnVjdHVyZT8KQWxpZ25tZW50IHRvIGF2b2lkIGhvbGVzIG9uIDY0IGJpdD8KCj4gKyAg
ICB1bmlvbgo+ICsgICAgewo+ICsgICAgICAgIHN0cnVjdAo+ICsgICAgICAgIHsKPiArICAgICAg
ICAgICAgY29uc3QgY2hhciAqZmlsZW5hbWU7Cj4gKyAgICAgICAgICAgIHVpbnQzMl90ICAgZGVs
ZXRlX29uX2VqZWN0ICA6IDE7CgpJIHN1cHBvc2UgdGhlICI6IDEiIGlzIHRvIHJlZHVjZSBzdHJ1
Y3R1cmUgc2l6ZSBpZiBtb3JlIGZsYWdzIGFyZQphZGRlZC4KSSB3b3VsZCB1c2UgdWludDhfdCBp
bnN0ZWFkIG9mIHVpbnQzMl90IGZvciBwb3J0YWJpbGl0eSAob24gVmlzdWFsIHN0dWRpbwp0aGlz
IHdpbGwgYWxsb2NhdGUgYSB1aW50MzJfdCwgR05VIHVzZSB0aGUgc21hbGxlciB0eXBlKS4KCj4g
KyAgICAgICAgfSBjcmVhdGVfY2Q7Cj4gKyAgICB9IGRldmljZV9wYXJhbTsKPiArCj4gK30gVXNi
Q3JlYXRlRGV2aWNlUGFyYW1ldGVyczsKPiArCj4gKy8qIEFQSSByZWxhdGVkIHRvIGVtdWxhdGVk
IGRldmljZXMgKi8KPiArZ2Jvb2xlYW4gc3BpY2VfdXNiX2JhY2tlbmRfY3JlYXRlX2RldmljZShT
cGljZVVzYkJhY2tlbmQgKmJlLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIFVzYkVtdWxhdGVkRGV2aWNlVHlwZSBkZXZfdHlwZSwKPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBVc2JDcmVhdGVEZXZpY2VQYXJhbWV0ZXJzICpwYXJh
bSk7CgpMb29rcyBsaWtlIHRoaXMgQVBJIGlzIHF1aXRlIHR5cGUgZnJhZ2lsZS4gSWYgcmVxdWly
ZWQgdGhhdCBkZXZfdHlwZSBpcyByZWdpc3RlcmVkCndpdGggdGhlIHR5cGUgcmVxdWlyZWQgdG8g
YWNjZXB0IHRoYXQgc3BlY2lmaWMgcGFyYW0gKHBhcmFtIGhhcyBubyB0eXBlIGluIGl0CmJ1dCB0
aGUgdW5pb24gaGFzIGRpZmZlcmVudCBmaWVsZHMpLgpXaHkgbm90IHBhc3NpbmcgdGhlIGluaXRp
YWxpemF0aW9uIGZ1bmN0aW9uIGRpcmVjdGx5PwoKPiArZ2NoYXIgKnNwaWNlX3VzYl9iYWNrZW5k
X2RldmljZV9kZXNjcmlwdGlvbihTcGljZVVzYkJhY2tlbmREZXZpY2UgKmRldiwKPiBjb25zdCBn
Y2hhciAqZm9ybWF0KTsKPiArdm9pZCBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfZWplY3QoU3Bp
Y2VVc2JCYWNrZW5kICpiZSwKPiBTcGljZVVzYkJhY2tlbmREZXZpY2UgKmRldmljZSk7Cj4gK3Zv
aWQgc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX3JlcG9ydF9jaGFuZ2UoU3BpY2VVc2JCYWNrZW5k
ICpiZSwKPiBTcGljZVVzYkJhY2tlbmREZXZpY2UgKmRldmljZSk7Cj4gKwo+ICBHX0VORF9ERUNM
Uwo+ICAKPiAgI2VuZGlmCj4gZGlmZiAtLWdpdCBhL3NyYy91c2ItZW11bGF0aW9uLmggYi9zcmMv
dXNiLWVtdWxhdGlvbi5oCj4gbmV3IGZpbGUgbW9kZSAxMDA2NDQKPiBpbmRleCAwMDAwMDAwLi40
NDczMzYxCj4gLS0tIC9kZXYvbnVsbAo+ICsrKyBiL3NyYy91c2ItZW11bGF0aW9uLmgKPiBAQCAt
MCwwICsxLDg4IEBACj4gKy8qIC0qLSBNb2RlOiBDOyBjLWJhc2ljLW9mZnNldDogNDsgaW5kZW50
LXRhYnMtbW9kZTogbmlsIC0qLSAqLwo+ICsvKgo+ICsgICAgQ29weXJpZ2h0IChDKSAyMDE5IFJl
ZCBIYXQsIEluYy4KPiArCj4gKyAgICBSZWQgSGF0IEF1dGhvcnM6Cj4gKyAgICBZdXJpIEJlbmRp
dG92aWNoPHliZW5kaXRvQHJlZGhhdC5jb20+Cj4gKwo+ICsgICAgVGhpcyBsaWJyYXJ5IGlzIGZy
ZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vcgo+ICsgICAgbW9kaWZ5
IGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYwo+ICsg
ICAgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsg
ZWl0aGVyCj4gKyAgICB2ZXJzaW9uIDIuMSBvZiB0aGUgTGljZW5zZSwgb3IgKGF0IHlvdXIgb3B0
aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4KPiArCj4gKyAgICBUaGlzIGxpYnJhcnkgaXMgZGlzdHJp
YnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKPiArICAgIGJ1dCBXSVRI
T1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCj4g
KyAgICBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0Uu
ICBTZWUgdGhlIEdOVQo+ICsgICAgTGVzc2VyIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1v
cmUgZGV0YWlscy4KPiArCj4gKyAgICBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9m
IHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCj4gKyAgICBMaWNlbnNlIGFsb25nIHdpdGgg
dGhpcyBsaWJyYXJ5OyBpZiBub3QsIHNlZQo+IDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMv
Pi4KPiArKi8KPiArCj4gKyNpZm5kZWYgX19TUElDRV9VU0JfRU1VTEFUSU9OX0hfXwo+ICsjZGVm
aW5lIF9fU1BJQ0VfVVNCX0VNVUxBVElPTl9IX18KPiArCgpXZSBzaG91bGQgc3RvcCB1c2luZyBy
ZXNlcnZlZCBpZGVudGlmaWVyLCBDOTkgaXMgYWJvdXQgMjAgeWVhcnMgb2xkLgoKTWF5YmUgd29u
J3QgYmUgYWxzbyBiYWQgdG8gdXNlICIjcHJhZ21hIG9uY2UiIGluc3RlYWQgYnV0IHRoaXMgaXMg
T1QuCgo+ICsjaW5jbHVkZSAidXNicmVkaXJwYXJzZXIuaCIKPiArI2luY2x1ZGUgInVzYi1iYWNr
ZW5kLmgiCj4gKwo+ICt0eXBlZGVmIHN0cnVjdCBfU3BpY2VVc2JFbXVsYXRlZERldmljZSBTcGlj
ZVVzYkVtdWxhdGVkRGV2aWNlOwoKQzk5IHJlc2VydmVkIGlkZW50aWZpZXIsIHVzZSBTcGljZVVz
YkVtdWxhdGVkRGV2aWNlIG5vdCBfU3BpY2VVc2JFbXVsYXRlZERldmljZS4KCj4gK3R5cGVkZWYg
aW50ICgqU3BpY2VVc2JFbXVsYXRlZERldmljZUNyZWF0ZSkoU3BpY2VVc2JCYWNrZW5kICpiZSwK
PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTcGljZVVzYkJh
Y2tlbmREZXZpY2UgKnBhcmVudCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBVc2JDcmVhdGVEZXZpY2VQYXJhbWV0ZXJzCj4gKnBhcmFtLAo+ICsgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNwaWNlVXNiRW11bGF0ZWREZXZp
Y2UKPiAqKmRldmljZSk7Cj4gKwo+ICsvKgo+ICsgICAgZnVuY3Rpb24gdGFibGUgZm9yIGVtdWxh
dGVkIFVTQiBkZXZpY2UKPiArICAgIG11c3QgYmUgZmlyc3QgbWVtYmVyIG9mIGRldmljZSBzdHJ1
Y3R1cmUKPiArICAgIGFsbCBmdW5jdGlvbnMgYXJlIG1hbmRhdG9yeSBmb3IgaW1wbGVtZW50YXRp
b24KPiArKi8KClN0eWxlOiB3ZSB1c2Ugc3R5bGUgbGlrZQoKICAvKiBmdW5jdGlvbiB0YWJsZSBm
b3IgZW11bGF0ZWQgVVNCIGRldmljZQogICAqIG11c3QgYmUgZmlyc3QgbWVtYmVyIG9mIGRldmlj
ZSBzdHJ1Y3R1cmUKICAgKiBhbGwgZnVuY3Rpb25zIGFyZSBtYW5kYXRvcnkgZm9yIGltcGxlbWVu
dGF0aW9uCiAgICovCgpNYWluIGV4Y2VwdGlvbiBpcyBmaWxlIGhlYWRlciBidXQgYmVzaWRlIHRo
YXQgaW4gYWxsIG90aGVyIGNvbW1lbnQKdGhlcmUncyBhbiBpbml0aWFsIHN0YXIgKCIqIikgYW5k
IGNvbW1lbnQgc3RhcnQgYXQgZmlyc3QgbGluZS4KSGVyZSBhbmQgaW4gb3RoZXIgb2NjdXJlbmNl
cy4KCj4gK3R5cGVkZWYgc3RydWN0IFVzYkRldmljZU9wcwo+ICt7Cj4gKyAgICBnYm9vbGVhbiAo
KmdldF9kZXNjcmlwdG9yKShTcGljZVVzYkVtdWxhdGVkRGV2aWNlICpkZXZpY2UsCj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50OF90IHR5cGUsIHVpbnQ4X3QgaW5kZXgsCj4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2b2lkICoqYnVmZmVyLCB1aW50MTZfdCAq
c2l6ZSk7Cj4gKyAgICBnY2hhciAqICgqZ2V0X3Byb2R1Y3RfZGVzY3JpcHRpb24pKFNwaWNlVXNi
RW11bGF0ZWREZXZpY2UgKmRldmljZSk7Cj4gKyAgICB2b2lkICgqYXR0YWNoKShTcGljZVVzYkVt
dWxhdGVkRGV2aWNlICpkZXZpY2UsIHN0cnVjdCB1c2JyZWRpcnBhcnNlcgo+ICpwYXJzZXIpOwo+
ICsgICAgdm9pZCAoKnJlc2V0KShTcGljZVVzYkVtdWxhdGVkRGV2aWNlICpkZXZpY2UpOwo+ICsg
ICAgLyoKPiArICAgICAgICBwcm9jZXNzaW5nIGlzIHN5bmNocm9ub3VzLCBkZWZhdWx0ID0gc3Rh
bGw6Cj4gKyAgICAgICAgLSByZXR1cm4gc3VjY2VzcyB3aXRob3V0IGRhdGE6IHNldCBzdGF0dXMg
dG8gMAo+ICsgICAgICAgIC0gcmV0dXJuIGVycm9yIC0gc2V0IHN0YXR1cyB0byBlcnJvcgo+ICsg
ICAgICAgIC0gcmV0dXJuIHN1Y2Nlc3Mgd2l0aCBkYXRhIC0gc2V0IHN0YXR1cyB0byAwLAo+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXQgYnVmZmVyIHRvIHNvbWUgYnVm
ZmVyCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldCBsZW5ndGggdG8g
b3V0IGxlbgo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnVuY2F0aW9u
IGlzIGF1dG9tYXRpYwo+ICsgICAgKi8KPiArICAgIHZvaWQgKCpjb250cm9sX3JlcXVlc3QpKFNw
aWNlVXNiRW11bGF0ZWREZXZpY2UgKmRldmljZSwKPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHVpbnQ4X3QgKmRhdGEsIGludCBkYXRhX2xlbiwKPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHN0cnVjdCB1c2JfcmVkaXJfY29udHJvbF9wYWNrZXRfaGVhZGVyICpoLAo+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgdm9pZCAqKmJ1ZmZlcik7Cj4gKyAgICAvKgo+ICsgICAg
ICAgIHByb2Nlc3NpbmcgaXMgc3luY2hyb25vdXM6Cj4gKyAgICAgICAgLSBzZXQgaC0+c3RhdHVz
IHRvIHJlc3VsdGluZyBzdGF0dXMsIGRlZmF1bHQgPSBzdGFsbAo+ICsgICAgKi8KPiArICAgIHZv
aWQgKCpidWxrX291dF9yZXF1ZXN0KShTcGljZVVzYkVtdWxhdGVkRGV2aWNlICpkZXZpY2UsCj4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDhfdCBlcCwgdWludDhfdCAqZGF0YSwg
aW50IGRhdGFfbGVuLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQ4X3QgKnN0
YXR1cyk7Cj4gKyAgICAvKgo+ICsgICAgICAgIGlmIHJldHVybnMgdHJ1ZSwgcHJvY2Vzc2luZyBp
cyBhc3luY2hyb25vdXMKPiArICAgICAgICBvdGhlcndpc2UgaGVhZGVyIGNvbnRhaW5zIGVycm9y
IHN0YXR1cwo+ICsgICAgKi8KPiArICAgIGdib29sZWFuICgqYnVsa19pbl9yZXF1ZXN0KShTcGlj
ZVVzYkVtdWxhdGVkRGV2aWNlICpkZXZpY2UsIHVpbnQ2NF90IGlkLAo+ICsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgc3RydWN0IHVzYl9yZWRpcl9idWxrX3BhY2tldF9oZWFkZXIKPiAqYnVs
a19oZWFkZXIpOwo+ICsgICAgdm9pZCAoKmNhbmNlbF9yZXF1ZXN0KShTcGljZVVzYkVtdWxhdGVk
RGV2aWNlICpkZXZpY2UsIHVpbnQ2NF90IGlkKTsKPiArICAgIHZvaWQgKCpkZXRhY2gpKFNwaWNl
VXNiRW11bGF0ZWREZXZpY2UgKmRldmljZSk7Cj4gKyAgICB2b2lkICgqZGVsZXRlKShTcGljZVVz
YkVtdWxhdGVkRGV2aWNlICpkZXZpY2UpOwoKQXMgc3RhdGVkIGFib3ZlLCBJIHdvdWxkIHByZWZl
ciAiZnJlZSIgb3IgInVucmVmIi4KCj4gK30gVXNiRGV2aWNlT3BzOwo+ICsKPiArc3RhdGljIGlu
bGluZSBjb25zdCBVc2JEZXZpY2VPcHMgKmRldmljZV9vcHMoU3BpY2VVc2JFbXVsYXRlZERldmlj
ZSAqZGV2KSB7CgpTdHlsZTogYnJhY2tldCBvbiBuZXh0IGxpbmUgZm9yIGZ1bmN0aW9ucy4KCj4g
KyAgICByZXR1cm4gKGNvbnN0IFVzYkRldmljZU9wcyAqKWRldjsKPiArfQo+ICsKPiArdm9pZCBz
cGljZV91c2JfYmFja2VuZF9yZWdpc3Rlcl9kZXZpY2VfdHlwZShTcGljZVVzYkJhY2tlbmQgKmJl
LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFVzYkVtdWxh
dGVkRGV2aWNlVHlwZSBkZXZfdHlwZSwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBTcGljZVVzYkVtdWxhdGVkRGV2aWNlQ3JlYXRlCj4gaW5pdF9wcm9jKTsK
PiArLyogc3VwcG9ydGVkIGRldmljZSB0eXBlcyAqLwo+ICt2b2lkIHNwaWNlX3VzYl9kZXZpY2Vf
cmVnaXN0ZXJfY2QoU3BpY2VVc2JCYWNrZW5kICpiZSk7Cj4gKwo+ICsjZW5kaWYKCkkgY2FuIHdy
aXRlIGEgZm9sbG93IHVwIHBhdGNoIGZvciBzdHlsZSBhbmQgc29tZSBvdGhlciBjaGFuZ2VzIChs
aWtlIHNvbWUKY29tbWVudHMgaW4gY29kZSkgaWYgeW91IGxpa2UuCgpGcmVkaWFubwpfX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpTcGljZS1kZXZlbCBtYWls
aW5nIGxpc3QKU3BpY2UtZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMu
ZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vc3BpY2UtZGV2ZWw=
