Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 2E52DA0538
	for <lists+spice-devel@lfdr.de>; Wed, 28 Aug 2019 16:44:04 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 67BFD89CAF;
	Wed, 28 Aug 2019 14:44:02 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 73FEA89CAF
 for <spice-devel@lists.freedesktop.org>; Wed, 28 Aug 2019 14:44:01 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx06.intmail.prod.int.phx2.redhat.com
 [10.5.11.16])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id 15E383083363
 for <spice-devel@lists.freedesktop.org>; Wed, 28 Aug 2019 14:44:01 +0000 (UTC)
Received: from colo-mx.corp.redhat.com
 (colo-mx01.intmail.prod.int.phx2.redhat.com [10.5.11.20])
 by smtp.corp.redhat.com (Postfix) with ESMTPS id 0E59961785
 for <spice-devel@lists.freedesktop.org>; Wed, 28 Aug 2019 14:44:01 +0000 (UTC)
Received: from zmail25.collab.prod.int.phx2.redhat.com
 (zmail25.collab.prod.int.phx2.redhat.com [10.5.83.31])
 by colo-mx.corp.redhat.com (Postfix) with ESMTP id 02D011802216;
 Wed, 28 Aug 2019 14:44:01 +0000 (UTC)
Date: Wed, 28 Aug 2019 10:44:00 -0400 (EDT)
From: Frediano Ziglio <fziglio@redhat.com>
To: Snir Sheriber <ssheribe@redhat.com>
Message-ID: <351681027.9951411.1567003440803.JavaMail.zimbra@redhat.com>
In-Reply-To: <20190826083948.29309-1-ssheribe@redhat.com>
References: <20190826083948.29309-1-ssheribe@redhat.com>
MIME-Version: 1.0
X-Originating-IP: [10.33.32.21, 10.4.195.28]
Thread-Topic: Add Xlib capture helper files
Thread-Index: l0GpBDR+JGFpmOGkIjltvC9SJE+Vpw==
X-Scanned-By: MIMEDefang 2.79 on 10.5.11.16
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16
 (mx1.redhat.com [10.5.110.44]); Wed, 28 Aug 2019 14:44:01 +0000 (UTC)
Subject: Re: [Spice-devel] [RFC spice-streaming-agent 1/3] Add Xlib capture
 helper files
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: spice-devel@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

PiAKPiBUaGUgWGxpYiBjYXB0dXJlIGhlbHBlciBwcm92aWRlcyBhIHdyYXBwaW5nIGNsYXNzIGZv
ciBYSW1hZ2UsIERpc3BsYXkKPiBpbmZvcm1hdGlvbiBhbmQgb3RoZXIgY2FwdHVyaW5nIHJlbGF0
ZWQgZnVuY3Rpb25hbGl0aWVzIHdoaWNoIGFsbG93cwo+IHRvIHVzZSB1bmlmaWVkIGFuZCBzaW1w
bGUgQVBJIGZvciBzY3JlZW4gY2FwdHVyaW5nIHVzaW5nIFguCj4gVGhpcyBhbHNvIHV0aWxpemUg
dGhlIFggTUlULVNITSBleHRlbnNpb24gd2hpY2ggaW1wcm92ZXMgY2FwdHVyaW5nCj4gc3BlZWQs
IGhlbmNlLCB4ZXh0IGlzIHJlcXVpcmVkLgo+IC0tLQo+IAo+IFRoZSBvcmlnaW5hbCBpZGVhIHdh
cyBqdXN0IHRvIHVzZSB0aGUgWCBhbmNpZW50IE1JVC1TSE0gZXh0ZW5zaW9uIHdoaWNoCj4gcmVk
dWNlIENQVSB1dGlsaXphdGlvbiBzaWduaWZpY2FudGx5IHdoZW4gdXNpbmcgWGxpYiBjYXB0dXJp
bmcuCj4gU2luY2UgdGhpcyBjYXB0dXJpbmcgbWV0aG9kIGlzIGN1cnJlbnRseSB1c2VkIGJ5IHR3
byBkaWZmZXJlbnQgcGx1Z2lucwo+IGl0IHdhcyBzdWdnZXN0ZWQgdG8gdXNlIG9uZSBjb21tb24g
Y2xhc3MgZm9yIHRoYXQsIHRoaXMgY2xhc3MgaXMgYWRkZWQKPiBieSB0aGlzIHBhdGNoIGFuZCB0
aGUgMiBmb2xsb3dpbmcgcGF0Y2hlcyBtYWtlcyB0aGUgZXhpc3RpbmcgcGx1Z2lucwo+IHRvIHVz
ZSB0aGlzIGNsYXNzLgo+IAo+IElmIHlvdSBoYXZlIGFueSBvdGhlciBzdWdnZXN0aW9ucyBvciBj
b21tZW50cyBwbGVhc2UgZG8gOykKPiAKCkl0J3Mgbm90IGNsZWFyIHdoeSB0aGUgUkZDLiBGcm9t
IHRoZSBjb21tZW50IGxvb2tzIGxpa2UgeW91IHdhbnQgdGhlbS4KTWF5YmUgeW91IGFyZSBub3Qg
c3VyZSBhYm91dCB0aGUgc3RhdGUgb2YgdGhlIHBhdGNoZXM/Cgo+IC0tLQo+ICBjb25maWd1cmUu
YWMgICAgICAgICB8ICAgMSArCj4gIHNyYy94bGliLWNhcHR1cmUuY3BwIHwgMTY5ICsrKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysKPiAgc3JjL3hsaWItY2FwdHVyZS5o
cHAgfCAgNTMgKysrKysrKysrKysrKysKPiAgMyBmaWxlcyBjaGFuZ2VkLCAyMjMgaW5zZXJ0aW9u
cygrKQo+ICBjcmVhdGUgbW9kZSAxMDA2NDQgc3JjL3hsaWItY2FwdHVyZS5jcHAKPiAgY3JlYXRl
IG1vZGUgMTAwNjQ0IHNyYy94bGliLWNhcHR1cmUuaHBwCj4gCj4gZGlmZiAtLWdpdCBhL2NvbmZp
Z3VyZS5hYyBiL2NvbmZpZ3VyZS5hYwo+IGluZGV4IDFjNzc4OGIuLjMyMjBlMjcgMTAwNjQ0Cj4g
LS0tIGEvY29uZmlndXJlLmFjCj4gKysrIGIvY29uZmlndXJlLmFjCj4gQEAgLTM4LDYgKzM4LDcg
QEAgUEtHX0NIRUNLX01PRFVMRVMoRFJNLCBsaWJkcm0pCj4gIFBLR19DSEVDS19NT0RVTEVTKFgx
MSwgeDExKQo+ICBQS0dfQ0hFQ0tfTU9EVUxFUyhYRklYRVMsIHhmaXhlcykKPiAgUEtHX0NIRUNL
X01PRFVMRVMoWFJBTkRSLCB4cmFuZHIpCj4gK1BLR19DSEVDS19NT0RVTEVTKFhFWFQsIHhleHQp
Cj4gIAo+ICBQS0dfQ0hFQ0tfTU9EVUxFUyhKUEVHLCBsaWJqcGVnLCAsIFsKPiAgICAgIEFDX0NI
RUNLX0xJQihqcGVnLCBqcGVnX2Rlc3Ryb3lfZGVjb21wcmVzcywKPiBkaWZmIC0tZ2l0IGEvc3Jj
L3hsaWItY2FwdHVyZS5jcHAgYi9zcmMveGxpYi1jYXB0dXJlLmNwcAo+IG5ldyBmaWxlIG1vZGUg
MTAwNjQ0Cj4gaW5kZXggMDAwMDAwMC4uNzgzN2VlMgo+IC0tLSAvZGV2L251bGwKPiArKysgYi9z
cmMveGxpYi1jYXB0dXJlLmNwcAo+IEBAIC0wLDAgKzEsMTY5IEBACj4gKy8qIEEgaGVscGVyIGNs
YXNzZXMgdGhhdCB3cmFwcyBYIGRpc3BsYXkgaW5mb3JtYXRpb24gWEltYWdlIGNhcHR1cmluZwo+
IGZ1bmN0aW9ucwo+ICsgKgo+ICsgKiBcY29weXJpZ2h0Cj4gKyAqIENvcHlyaWdodCAyMDE5IFJl
ZCBIYXQgSW5jLiBBbGwgcmlnaHRzIHJlc2VydmVkLgo+ICsgKi8KPiArCj4gKyNpbmNsdWRlIDxz
eXMvaXBjLmg+Cj4gKyNpbmNsdWRlIDxzeXMvc2htLmg+Cj4gKyNpbmNsdWRlICJ4bGliLWNhcHR1
cmUuaHBwIgo+ICsKPiArbmFtZXNwYWNlIHNwaWNlIHsKPiArbmFtZXNwYWNlIHN0cmVhbWluZ19h
Z2VudCB7Cj4gKwo+ICsvKioqKioqKioqKioqKioqKioqKiogWEltZyBDbGFzcyBJbXBsICoqKioq
KioqKioqKioqKioqKioqKioqLwo+ICsKPiArWEltZzo6WEltZyhYSW1hZ2UgKnhfaW1hZ2UsIGJv
b2wgaXNfc2htLCBib29sIG5ld19yZXMpIHsKCnN0eWxlOiBicmFja2V0IG9uIG5leHQgbGluZQoK
PiArICAgICB0aGlzLT54X2ltYWdlID0geF9pbWFnZTsKPiArICAgICB0aGlzLT54X3NobSA9IGlz
X3NobTsKPiArICAgICB0aGlzLT5uZXdfcmVzID0gbmV3X3JlczsKCkJldHRlciB0byB1c2UgY2xh
c3MgaW5pdGlhbGl6ZWQsIGV2ZW4gaWYgaW4gdGhpcyBjYXNlIHdvbid0IGNoYW5nZQptdWNoLgoK
PiArfQo+ICsKPiArWEltZzo6flhJbWcoKSB7Cj4gKyAgICBpZiAoIXhfc2htKSB7Cj4gKyAgICAg
ICAgWERlc3Ryb3lJbWFnZSh4X2ltYWdlKTsKPiArICAgIH0gLy8gZWxzZSB0aGUgWGxpYkNhcHR1
cmUgd2lsbCBkZXN0cm95IGl0Cj4gK30KPiArCj4gK2NoYXIgKlhJbWc6OmdldF9kYXRhKCkgewo+
ICsgICAgcmV0dXJuIHhfaW1hZ2UtPmRhdGE7Cj4gK30KPiArCj4gK2ludCBYSW1nOjpoZWlnaHQo
KSB7Cj4gKyAgICByZXR1cm4geF9pbWFnZS0+aGVpZ2h0Owo+ICt9Cj4gKwo+ICtpbnQgWEltZzo6
d2lkdGgoKSB7Cj4gKyAgICByZXR1cm4geF9pbWFnZS0+d2lkdGg7Cj4gK30KPiArCj4gK2ludCBY
SW1nOjpkYXRhX3NpemUoKSB7Cj4gKyAgICByZXR1cm4geF9pbWFnZS0+aGVpZ2h0ICogeF9pbWFn
ZS0+Ynl0ZXNfcGVyX2xpbmU7Cj4gK30KPiArCj4gK2Jvb2wgWEltZzo6bmV3X3Jlc29sdXRpb24o
KSB7Cj4gKyAgIHJldHVybiBuZXdfcmVzOwo+ICt9Cj4gKwoKSSB3b3VsZCBpbmxpbmUgdGhlc2Ug
aW4gdGhlIGhlYWRlci4gQWxzbyBJIHdvdWxkIGFkZCBjb25zdCwgdGhleSBkb24ndAphbGxvdyB0
byBjaGFuZ2UgdGhlIG9iamVjdC4KClRoaXMgIm5ld19yZXNvbHV0aW9uIiBkb2VzIG5vdCBhcHBs
eSB0byB0aGUgInByb3ZpZGVzIGEgd3JhcHBpbmcgY2xhc3MgZm9yClhJbWFnZSIsIGFyZSBtb3Jl
IHJlbGF0ZWQgdG8gY2FwdHVyZSBpbnRlcmZhY2UuIE1heWJlICJYQ2FwdHVyZWRJbWciIGFzIG5h
bWUKb2YgdGhlIGNsYXNzPwoKPiArLyoqKioqKioqKioqKioqKioqKiBYbGliQ2FwdHVyZSBDbGFz
cyBJbXBsICoqKioqKioqKioqKioqKioqKiovCj4gKwo+ICtzdGF0aWMgaW50ICgqcHJldmlvdXNf
eF9lcnJfaGFuZGxlcikoRGlzcGxheSAqZGlzcGxheSwgWEVycm9yRXZlbnQgKmV2ZW50KSA9Cj4g
MDsKCmJldHRlciAiPSBudWxscHRyIiBvciBhdCBsZWFzdCAiPSBOVUxMIiAoYWx0aG91Z2ggMCBm
b3IgaGlzdG9yaWMgcmVhc29uIHdvcmtzKS4KCj4gK3N0YXRpYyBib29sIHhlcnJvciA9IGZhbHNl
Owo+ICsKPiArLyogVGhpcyBpcyB1c2VkIG1haW5seSB0byBzaWxlbmNlIHggZXJyb3IgaW4gY2Fz
ZSBvZiByZXNvbHV0aW9uIGNoYW5nZSAqLwo+ICtzdGF0aWMgaW50IHhfZXJyX2hhbmRsZXIoRGlz
cGxheSAqZGlzcGxheSwgWEVycm9yRXZlbnQgKmV2ZW50KSB7Cj4gKyAgICAvL1RPRE86IHByaW50
IHNvbWUgZXJyb3IgaW5mb3JtYXRpb24gPwo+ICsgICAgc3dpdGNoIChldmVudC0+ZXJyb3JfY29k
ZSkgewo+ICsgICAgICAgIGNhc2UgQmFkQWNjZXNzOgoKc3R5bGU6IHRvbyBpbmRlbnRlZC4KCj4g
KyAgICAgICAgY2FzZSBCYWRNYXRjaDoKPiArICAgICAgICAgICAgeGVycm9yID0gdHJ1ZTsKPiAr
ICAgICAgICAgICAgcmV0dXJuIDA7Cj4gKyAgICAgICAgZGVmYXVsdDoKPiArICAgICAgICAgICAg
cmV0dXJuIHByZXZpb3VzX3hfZXJyX2hhbmRsZXIoZGlzcGxheSwgZXZlbnQpOwo+ICsgICAgfQo+
ICt9Cj4gKwo+ICt2b2lkIFhsaWJDYXB0dXJlOjppbml0X3hzaG0oKSB7Cj4gKyAgICBWaXN1YWwg
KnZpc3VhbCA9IERlZmF1bHRWaXN1YWwoZGlzcGxheSwgc2NyZWVuKTsKPiArICAgIHVuc2lnbmVk
IGludCBkZXB0aCA9IERlZmF1bHREZXB0aChkaXNwbGF5LCBzY3JlZW4pOwo+ICsgICAgWFdpbmRv
d0F0dHJpYnV0ZXMgd2luX2luZm87Cj4gKwo+ICsgICAgeHNobV9lbmFibGVkID0gZmFsc2U7Cj4g
KyAgICB4ZXJyb3IgPSBmYWxzZTsKPiArICAgIC8vIENyZWF0ZSBTaGFyZWQgTWVtb3J5IFhJbWFn
ZQo+ICsgICAgWEdldFdpbmRvd0F0dHJpYnV0ZXMoZGlzcGxheSwgd2luLCAmd2luX2luZm8pOyAv
LyB1cGRhdGUgYXR0cmlidXRlcwo+ICsgICAgeHNobV9pbWFnZSA9IFhTaG1DcmVhdGVJbWFnZShk
aXNwbGF5LCB2aXN1YWwsIGRlcHRoLCBaUGl4bWFwLCBudWxscHRyLAo+ICsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAmc2htX2luZm8sIHdpbl9pbmZvLndpZHRoLAo+IHdpbl9pbmZv
LmhlaWdodCk7Cj4gKyAgICBpZiAoIXhzaG1faW1hZ2UpIHsKPiArICAgICAgICByZXR1cm47Cj4g
KyAgICB9Cj4gKyAgICAvLyBBbGxvY2F0ZSBzaG0gYnVmZmVyCj4gKyAgICBpbnQgc2htX2lkID0g
c2htZ2V0KElQQ19QUklWQVRFLCB4c2htX2ltYWdlLT5ieXRlc19wZXJfbGluZSAqCj4geHNobV9p
bWFnZS0+aGVpZ2h0LCBJUENfQ1JFQVR8MDc3Nyk7Cj4gKyAgICBpZiAoc2htX2lkID09IC0xKSB7
Cj4gKyAgICAgICAgWERlc3Ryb3lJbWFnZSh4c2htX2ltYWdlKTsKCkkgc3VwcG9zZSB5b3Ugd2Fu
dCB0byByZXNldCB4c2htX2ltYWdlIHRvbyB0byBhdm9pZCBkYW5kbGluZyBwb2ludGVycy4KCj4g
KyAgICAgICAgcmV0dXJuOwo+ICsgICAgfQo+ICsKPiArICAgIC8vIEF0dGFjaCBzaGFyZSBtZW1v
cnkgYnVmZXIKPiArICAgIHZvaWQgKnNobV9hZGRyID0gc2htYXQoc2htX2lkLCBudWxscHRyLCAw
KTsKPiArICAgIGlmIChzaG1fYWRkciA9PSAodm9pZCopLTEpIHsKPiArICAgICAgICBYRGVzdHJv
eUltYWdlKHhzaG1faW1hZ2UpOwo+ICsgICAgICAgIHNobWN0bChzaG1faWQsIElQQ19STUlELCBu
dWxscHRyKTsKPiArICAgICAgICByZXR1cm47Cj4gKyAgICB9Cj4gKyAgICBzaG1faW5mby5zaG1p
ZCA9IHNobV9pZDsKPiArICAgIHNobV9pbmZvLnNobWFkZHIgPSB4c2htX2ltYWdlLT5kYXRhID0g
KGNoYXIqKXNobV9hZGRyOwo+ICsgICAgc2htX2luZm8ucmVhZE9ubHkgPSBmYWxzZTsKPiArICAg
IFhTaG1BdHRhY2goZGlzcGxheSwgJnNobV9pbmZvKTsKPiArICAgIFhTeW5jKGRpc3BsYXksIGZh
bHNlKTsKPiArCj4gKyAgICBpZiAoIXhlcnJvcikgewo+ICsgICAgICAgIHhzaG1fZW5hYmxlZCA9
IHRydWU7Cj4gKyAgICAgICAgcmV0dXJuOyAvLyBYU2htIGluaXRpYWxpemF0aW9uIHN1Y2NlZWRl
ZAo+ICsgICAgfQo+ICt9Cj4gKwo+ICtYSW1nICpYbGliQ2FwdHVyZTo6Y2FwdHVyZSgpIHsKPiAr
ICAgIFhXaW5kb3dBdHRyaWJ1dGVzIHdpbl9pbmZvOwo+ICsgICAgYm9vbCBjaGFuZ2VkID0gZmFs
c2U7Cj4gKyAgICBpbnQgdHJpZXMgPSAwOwo+ICsKPiArICAgIC8qIFRoaXMgY29kZSBmbG93IGFs
bG93cyB0byBvdmVyY29tZSByZXNvbHV0aW9uIGNoYW5nZSB0aGF0IG9jY3VycyBqdXN0Cj4gKyAg
ICAgKiBhZnRlciBnZXR0aW5nIHRoZSBhdHRyaWJ1dGVzIGFuZCBiZWZvcmUgYXNraW5nIGZvciB0
aGUgWEltYWdlCj4gKyAgICAgKi8KPiArICAgIGRvIHsKPiArICAgICAgICBYR2V0V2luZG93QXR0
cmlidXRlcyhkaXNwbGF5LCB3aW4sICZ3aW5faW5mbyk7IC8vIHVwZGF0ZSBhdHRyaWJ1dGVzCj4g
Kwo+ICsgICAgICAgIGlmIChsYXN0X3dpZHRoICE9IHdpbl9pbmZvLndpZHRoIHx8IGxhc3RfaGVp
Z2h0ICE9IHdpbl9pbmZvLmhlaWdodCkKPiB7Cj4gKyAgICAgICAgICAgIGlmICh4c2htX2VuYWJs
ZWQgJiYgeHNobV9pbWFnZSkgeyAvLyByZWluaXQgeHNobSBleHRlbnRpb24KPiArICAgICAgICAg
ICAgICAgIGRlaW5pdF94c2htKCk7Cj4gKyAgICAgICAgICAgICAgICBpbml0X3hzaG0oKTsKPiAr
ICAgICAgICAgICAgfQo+ICsgICAgICAgICAgICBjaGFuZ2VkID0gdHJ1ZTsgLy8gcmVzb2x1dGlv
biBjaGFuZ2VkCj4gKyAgICAgICAgICAgIGxhc3Rfd2lkdGggPSB3aW5faW5mby53aWR0aDsKPiAr
ICAgICAgICAgICAgbGFzdF9oZWlnaHQgPSB3aW5faW5mby5oZWlnaHQ7Cj4gKyAgICAgICAgfQo+
ICsgICAgICAgIC8vIFRPRE86IHJvdW5kIGRvd24gdGhlIHJlc291bHRpb24gLyB1c2UgY3VzdG9t
IHJlc291bHRpb24KCnNvbWUgdHlwb3MgaW4gY29tbWVudAoKPiArICAgICAgICBpZiAoeHNobV9l
bmFibGVkICYmIHhzaG1faW1hZ2UpIHsKPiArICAgICAgICAgICAgaWYgKFhTaG1HZXRJbWFnZShk
aXNwbGF5LCB3aW4sIHhzaG1faW1hZ2UsIHdpbl9pbmZvLngsCj4gd2luX2luZm8ueSwgQWxsUGxh
bmVzKSkgewo+ICsgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBYSW1nKHhzaG1faW1hZ2UsIHRy
dWUsIGNoYW5nZWQpOwo+ICsgICAgICAgICAgICB9Cj4gKyAgICAgICAgfQo+ICsgICAgICAgIFhJ
bWFnZSAqaW1hZ2UgPSBYR2V0SW1hZ2UoZGlzcGxheSwgd2luLCB3aW5faW5mby54LCB3aW5faW5m
by55LAo+IHdpbl9pbmZvLndpZHRoLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgd2luX2luZm8uaGVpZ2h0LCBBbGxQbGFuZXMsIFpQaXhtYXApOwo+ICsgICAgICAgIGlmIChp
bWFnZSkgewo+ICsgICAgICAgICAgICByZXR1cm4gbmV3IFhJbWcoaW1hZ2UsIGZhbHNlLCBjaGFu
Z2VkKTsKPiArICAgICAgICB9Cj4gKyAgICB9IHdoaWxlICgrK3RyaWVzIDwgMik7IC8vIHRoZXJl
IHdhcyBhbiBlcnJvciB0byBnZXQgdGhlIGltYWdlLCB0cnkgb25jZQo+IG1vcmUgKG1pZ2h0IGJl
IGEgcmVzb3VsdGlvbiBjaGFuZ2UpCj4gKyAgICByZXR1cm4gbnVsbHB0cjsgLy8gZmFpbAo+ICt9
Cj4gKwo+ICt2b2lkIFhsaWJDYXB0dXJlOjpkZWluaXRfeHNobSgpIHsKPiArICAgIGlmICh4c2ht
X2VuYWJsZWQgJiYgeHNobV9pbWFnZSkgewo+ICsgICAgICAgIFhTaG1EZXRhY2ggKGRpc3BsYXks
ICZzaG1faW5mbyk7Cj4gKyAgICAgICAgeHNobV9pbWFnZS0+Zi5kZXN0cm95X2ltYWdlKHhzaG1f
aW1hZ2UpOwo+ICsgICAgICAgIHNobWR0KHNobV9pbmZvLnNobWFkZHIpOwo+ICsgICAgICAgIHNo
bWN0bChzaG1faW5mby5zaG1pZCwgSVBDX1JNSUQsIDApOwo+ICsgICAgICAgIHhzaG1faW1hZ2Ug
PSBudWxscHRyOwo+ICsgICAgICAgIHhzaG1fZW5hYmxlZCA9IGZhbHNlOwo+ICsgICAgfQo+ICt9
Cj4gKwo+ICtYbGliQ2FwdHVyZTo6WGxpYkNhcHR1cmUoRGlzcGxheSAqZGlzcGxheSk6Cj4gKyAg
ICBkaXNwbGF5KGRpc3BsYXkpCj4gK3sKPiArICAgIFhXaW5kb3dBdHRyaWJ1dGVzIHdpbl9pbmZv
Owo+ICsgICAgdGhpcy0+c2NyZWVuID0gWERlZmF1bHRTY3JlZW4oZGlzcGxheSk7Cj4gKyAgICB0
aGlzLT53aW4gPSBSb290V2luZG93KGRpc3BsYXksIHNjcmVlbik7Cj4gKyAgICBYR2V0V2luZG93
QXR0cmlidXRlcyhkaXNwbGF5LCB3aW4sICZ3aW5faW5mbyk7IC8vIHVwZGF0ZSBhdHRyaWJ1dGVz
Cj4gKyAgICBsYXN0X3dpZHRoID0gLTE7Cj4gKyAgICBsYXN0X2hlaWdodCA9IC0xOwo+ICsgICAg
cHJldmlvdXNfeF9lcnJfaGFuZGxlciA9IFhTZXRFcnJvckhhbmRsZXIoeF9lcnJfaGFuZGxlcik7
CgppdCBsb29rcyBsaWtlIHRoaXMgY2xhc3MgaXMgYSBzaW5nbGV0b24sIG1heWJlIGNhbGwgWFNl
dEVycm9ySGFuZGxlcgpvbmx5IGlmIHByZXZpb3VzX3hfZXJyX2hhbmRsZXIgaXMgbnVsbHB0ciA/
CkFyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0aGlzIGZ1bmN0aW9uIHNldCBmb3IgdGhlIGVudGlyZSBw
cm9ncmFtPwoKPiArICAgIGluaXRfeHNobSgpOwo+ICt9Cj4gKwo+ICtYbGliQ2FwdHVyZTo6flhs
aWJDYXB0dXJlKCkgewo+ICsgICAgZGVpbml0X3hzaG0oKTsKPiArfQo+ICsKPiArfX0gLy8gbmFt
ZXNwYWNlIHNwaWNlOjpzdHJlYW1pbmdfYWdlbnQKPiBkaWZmIC0tZ2l0IGEvc3JjL3hsaWItY2Fw
dHVyZS5ocHAgYi9zcmMveGxpYi1jYXB0dXJlLmhwcAo+IG5ldyBmaWxlIG1vZGUgMTAwNjQ0Cj4g
aW5kZXggMDAwMDAwMC4uOTMyMDBkYwo+IC0tLSAvZGV2L251bGwKPiArKysgYi9zcmMveGxpYi1j
YXB0dXJlLmhwcAo+IEBAIC0wLDAgKzEsNTMgQEAKPiArLyogIEEgaGVscGVyIGNsYXNzZXMgdGhh
dCB3cmFwcyBYIGRpc3BsYXkgaW5mb3JtYXRpb24gWEltYWdlIGNhcHR1cmluZwo+IGZ1bmN0aW9u
cwo+ICsgKgo+ICsgKiBcY29weXJpZ2h0Cj4gKyAqIENvcHlyaWdodCAyMDE5IFJlZCBIYXQgSW5j
LiBBbGwgcmlnaHRzIHJlc2VydmVkLgo+ICsgKi8KPiArCj4gKyNpZm5kZWYgU1BJQ0VfU1RSRUFN
SU5HX0FHRU5UX1hMSUJfQ0FQVFVSRV9IUFAgLy8gbmVlZCBoZWFkZXIgZmlsZT8KPiArI2RlZmlu
ZSBTUElDRV9TVFJFQU1JTkdfQUdFTlRfWExJQl9DQVBUVVJFX0hQUAo+ICsKPiArI2luY2x1ZGUg
PFgxMS9YbGliLmg+Cj4gKyNpbmNsdWRlIDxYMTEvWHV0aWwuaD4KPiArI2luY2x1ZGUgPFgxMS9l
eHRlbnNpb25zL1hTaG0uaD4KPiArCj4gK25hbWVzcGFjZSBzcGljZSB7Cj4gK25hbWVzcGFjZSBz
dHJlYW1pbmdfYWdlbnQgewo+ICsKPiArY2xhc3MgWEltZwo+ICt7Cj4gK3B1YmxpYzoKPiArICAg
IFhJbWcoWEltYWdlICp4X2lhbWdlLCBib29sIGlzX3NobSwgYm9vbCBuZXdfcmVzb2x1dGlvbik7
Cj4gKyAgICB+WEltZygpOwo+ICsgICAgY2hhciAqZ2V0X2RhdGEoKTsKPiArICAgIGludCBkYXRh
X3NpemUoKTsgLy8gd2l0aCBjb25zaWRlcmluZyBzdHJpZGUKPiArICAgIGludCBoZWlnaHQoKTsK
PiArICAgIGludCB3aWR0aCgpOwo+ICsgICAgYm9vbCBuZXdfcmVzb2x1dGlvbigpOwo+ICtwcml2
YXRlOgo+ICsgICAgWEltYWdlICp4X2ltYWdlOwo+ICsgICAgYm9vbCB4X3NobTsKPiArICAgIGJv
b2wgbmV3X3JlczsKPiArfTsKPiArCj4gK2NsYXNzIFhsaWJDYXB0dXJlCj4gK3sKPiArcHVibGlj
Ogo+ICsgICAgWGxpYkNhcHR1cmUoRGlzcGxheSAqZGlzcGxheSk7IC8vIGFkZCBlbXB0eSBjb25z
dHJ1Y3Rvcj8KPiArICAgIH5YbGliQ2FwdHVyZSgpOwo+ICsgICAgWEltZyAqY2FwdHVyZSgpOyAv
LyBjYWxsZXIgc2hvdWxkIGRlbGV0ZSB0aGUgcmV0dXJuIGltYWdlCgpVc2UgdW5pcXVlX3B0ciBp
bnN0ZWFkIG9mIHRoZSBjb21tZW50PwoKPiArcHJpdmF0ZToKPiArICAgIGludCBsYXN0X3dpZHRo
LCBsYXN0X2hlaWdodDsKPiArICAgIERpc3BsYXkgKmNvbnN0IGRpc3BsYXk7Cj4gKyAgICBpbnQg
c2NyZWVuOwo+ICsgICAgV2luZG93IHdpbjsKPiArICAgIFhJbWFnZSAqeHNobV9pbWFnZSA9IG51
bGxwdHI7Cj4gKyAgICBYU2htU2VnbWVudEluZm8gc2htX2luZm87Cj4gKyAgICBib29sIHhzaG1f
ZW5hYmxlZCA9IGZhbHNlOwo+ICsgICAgdm9pZCBpbml0X3hzaG0oKTsKPiArICAgIHZvaWQgZGVp
bml0X3hzaG0oKTsKPiArfTsKPiArCj4gK319IC8vIG5hbWVzcGFjZSBzcGljZTo6c3RyZWFtaW5n
X2FnZW50Cj4gKwo+ICsjZW5kaWYgLy8gU1BJQ0VfU1RSRUFNSU5HX0FHRU5UX1hMSUJfQ0FQVFVS
RV9IUFAKCkZyZWRpYW5vCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fClNwaWNlLWRldmVsIG1haWxpbmcgbGlzdApTcGljZS1kZXZlbEBsaXN0cy5mcmVlZGVz
a3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9z
cGljZS1kZXZlbA==
