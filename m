Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 851A62789F8
	for <lists+spice-devel@lfdr.de>; Fri, 25 Sep 2020 15:52:27 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 122546ECD1;
	Fri, 25 Sep 2020 13:52:26 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from us-smtp-delivery-124.mimecast.com
 (us-smtp-delivery-124.mimecast.com [216.205.24.124])
 by gabe.freedesktop.org (Postfix) with ESMTPS id EEEBA6ECD1
 for <spice-devel@lists.freedesktop.org>; Fri, 25 Sep 2020 13:52:23 +0000 (UTC)
Dkim-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=redhat.com;
 s=mimecast20190719; t=1601041943;
 h=from:from:reply-to:subject:subject:date:date:message-id:message-id:
 to:to:cc:cc:mime-version:mime-version:content-type:content-type:
 content-transfer-encoding:content-transfer-encoding:
 in-reply-to:in-reply-to:references:references;
 bh=ybywO2OTt3WzzjRYQOYXGO2tmmQ+4oz5wdGb+9ihuOg=;
 b=F957xGbYC7X6vxnKPGfKEd+SKiiMeAmPq5aZ4T/3OQbEyIFxgqdYp6/o7JC9LySoM9dTDz
 cs9bDxlhcHpYrdDFbqbHP3z3v6+pge7AO57hCETDkdLy/r/0ImbdbO3ZNfcAAuFAhCdzxr
 KozZrqjxJ5x5lZpl4fkFoXbvPATpb0c=
Received: from mimecast-mx01.redhat.com (mimecast-mx01.redhat.com
 [209.132.183.4]) (Using TLS) by relay.mimecast.com with ESMTP id
 us-mta-559-Gy8wMNSgNx659DFhM52gmg-1; Fri, 25 Sep 2020 09:52:03 -0400
X-MC-Unique: Gy8wMNSgNx659DFhM52gmg-1
Received: from smtp.corp.redhat.com (int-mx06.intmail.prod.int.phx2.redhat.com
 [10.5.11.16])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mimecast-mx01.redhat.com (Postfix) with ESMTPS id DD2F3802B78;
 Fri, 25 Sep 2020 13:51:57 +0000 (UTC)
Received: from localhost (unknown [10.36.110.56])
 by smtp.corp.redhat.com (Postfix) with ESMTP id D169568D92;
 Fri, 25 Sep 2020 13:51:41 +0000 (UTC)
From: marcandre.lureau@redhat.com
To: qemu-devel@nongnu.org
Date: Fri, 25 Sep 2020 17:50:53 +0400
Message-Id: <20200925135057.291556-3-marcandre.lureau@redhat.com>
In-Reply-To: <20200925135057.291556-1-marcandre.lureau@redhat.com>
References: <20200925135057.291556-1-marcandre.lureau@redhat.com>
MIME-Version: 1.0
X-Scanned-By: MIMEDefang 2.79 on 10.5.11.16
Authentication-Results: relay.mimecast.com;
 auth=pass smtp.auth=CUSA124A263 smtp.mailfrom=marcandre.lureau@redhat.com
X-Mimecast-Spam-Score: 0
X-Mimecast-Originator: redhat.com
Subject: [Spice-devel] [PATCH v2 2/6] edid: use physical dimensions if
 available
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: spice-devel@lists.freedesktop.org, Gerd Hoffmann <kraxel@redhat.com>,
 "Michael S. Tsirkin" <mst@redhat.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

RnJvbTogTWFyYy1BbmRyw6kgTHVyZWF1IDxtYXJjYW5kcmUubHVyZWF1QHJlZGhhdC5jb20+CgpS
ZXBsYWNlIGRwaSB3aXRoIHdpZHRoX21tL2hlaWdodF9tbSBpbiBxZW11X2VkaWRfaW5mby4KClVz
ZSBpdCB3aGVuIHNldCAobm9uLXplcm8pIHRvIGNvbXB1dGUgdGhlIERQSSBhbmQgZ2VuZXJhdGUg
dGhlIEVESUQuCgpTaWduZWQtb2ZmLWJ5OiBNYXJjLUFuZHLDqSBMdXJlYXUgPG1hcmNhbmRyZS5s
dXJlYXVAcmVkaGF0LmNvbT4KLS0tCiBody9kaXNwbGF5L2VkaWQtZ2VuZXJhdGUuYyB8IDM2ICsr
KysrKysrKysrKysrKysrKysrKysrKystLS0tLS0tLS0tLQogaW5jbHVkZS9ody9kaXNwbGF5L2Vk
aWQuaCAgfCAgNSArKysrLQogcWVtdS1lZGlkLmMgICAgICAgICAgICAgICAgfCAxMSArKysrKysr
KystLQogMyBmaWxlcyBjaGFuZ2VkLCAzOCBpbnNlcnRpb25zKCspLCAxNCBkZWxldGlvbnMoLSkK
CmRpZmYgLS1naXQgYS9ody9kaXNwbGF5L2VkaWQtZ2VuZXJhdGUuYyBiL2h3L2Rpc3BsYXkvZWRp
ZC1nZW5lcmF0ZS5jCmluZGV4IDYxOGM3NGUxZGYuLjE2NjViN2NiYjIgMTAwNjQ0Ci0tLSBhL2h3
L2Rpc3BsYXkvZWRpZC1nZW5lcmF0ZS5jCisrKyBiL2h3L2Rpc3BsYXkvZWRpZC1nZW5lcmF0ZS5j
CkBAIC0yMDUsMTIgKzIwNSw4IEBAIHN0YXRpYyB2b2lkIGVkaWRfZGVzY19kdW1teSh1aW50OF90
ICpkZXNjKQogCiBzdGF0aWMgdm9pZCBlZGlkX2Rlc2NfdGltaW5nKHVpbnQ4X3QgKmRlc2MsCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IHhyZXMsIHVpbnQzMl90IHlyZXMs
Ci0gICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IGRwaSkKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgdWludDMyX3QgeG1tLCB1aW50MzJfdCB5bW0pCiB7Ci0gICAgLyog
cGh5c2ljYWwgZGlzcGxheSBzaXplICovCi0gICAgdWludDMyX3QgeG1tID0geHJlcyAqIDI1NCAv
IDEwIC8gZHBpOwotICAgIHVpbnQzMl90IHltbSA9IHlyZXMgKiAyNTQgLyAxMCAvIGRwaTsKLQog
ICAgIC8qIHB1bGwgc29tZSByZWFsaXN0aWMgbG9va2luZyB0aW1pbmdzIG91dCBvZiB0aGluIGFp
ciAqLwogICAgIHVpbnQzMl90IHhmcm9udCA9IHhyZXMgKiAyNSAvIDEwMDsKICAgICB1aW50MzJf
dCB4c3luYyAgPSB4cmVzICogIDMgLyAxMDA7CkBAIC0yOTAsMTIgKzI4NiwyNCBAQCBzdGF0aWMg
dm9pZCBlZGlkX2NvbG9yc3BhY2UodWludDhfdCAqZWRpZCwKICAgICBlZGlkWzM0XSA9IHdoaXRl
X3kgPj4gMjsKIH0KIAorc3RhdGljIHVpbnQzMl90IHFlbXVfZWRpZF9kcGlfZnJvbV9tbSh1aW50
MzJfdCBtbSwgdWludDMyX3QgcmVzKQoreworICAgIHJldHVybiByZXMgKiAyNTQgLyAxMCAvIG1t
OworfQorCit1aW50MzJfdCBxZW11X2VkaWRfZHBpX3RvX21tKHVpbnQzMl90IGRwaSwgdWludDMy
X3QgcmVzKQoreworICAgIHJldHVybiByZXMgKiAyNTQgLyAxMCAvIGRwaTsKK30KKwogdm9pZCBx
ZW11X2VkaWRfZ2VuZXJhdGUodWludDhfdCAqZWRpZCwgc2l6ZV90IHNpemUsCiAgICAgICAgICAg
ICAgICAgICAgICAgICBxZW11X2VkaWRfaW5mbyAqaW5mbykKIHsKICAgICB1aW50MzJfdCBkZXNj
ID0gNTQ7CiAgICAgdWludDhfdCAqeHRyYTMgPSBOVUxMOwogICAgIHVpbnQ4X3QgKmR0YSA9IE5V
TEw7CisgICAgdWludDMyX3Qgd2lkdGhfbW0sIGhlaWdodF9tbTsKKyAgICB1aW50MzJfdCBkcGkg
PSAxMDA7IC8qIGlmIG5vIHdpZHRoX21tL2hlaWdodF9tbSAqLwogCiAgICAgLyogPT09PT09PT09
PT09PT09IHNldCBkZWZhdWx0cyAgPT09PT09PT09PT09PT09ICovCiAKQEAgLTMwNSwxNSArMzEz
LDIwIEBAIHZvaWQgcWVtdV9lZGlkX2dlbmVyYXRlKHVpbnQ4X3QgKmVkaWQsIHNpemVfdCBzaXpl
LAogICAgIGlmICghaW5mby0+bmFtZSkgewogICAgICAgICBpbmZvLT5uYW1lID0gIlFFTVUgTW9u
aXRvciI7CiAgICAgfQotICAgIGlmICghaW5mby0+ZHBpKSB7Ci0gICAgICAgIGluZm8tPmRwaSA9
IDEwMDsKLSAgICB9CiAgICAgaWYgKCFpbmZvLT5wcmVmeCkgewogICAgICAgICBpbmZvLT5wcmVm
eCA9IDEwMjQ7CiAgICAgfQogICAgIGlmICghaW5mby0+cHJlZnkpIHsKICAgICAgICAgaW5mby0+
cHJlZnkgPSA3Njg7CiAgICAgfQorICAgIGlmIChpbmZvLT53aWR0aF9tbSAmJiBpbmZvLT5oZWln
aHRfbW0pIHsKKyAgICAgICAgd2lkdGhfbW0gPSBpbmZvLT53aWR0aF9tbTsKKyAgICAgICAgaGVp
Z2h0X21tID0gaW5mby0+aGVpZ2h0X21tOworICAgICAgICBkcGkgPSBxZW11X2VkaWRfZHBpX2Zy
b21fbW0od2lkdGhfbW0sIGluZm8tPnByZWZ4KTsKKyAgICB9IGVsc2UgeworICAgICAgICB3aWR0
aF9tbSA9IHFlbXVfZWRpZF9kcGlfdG9fbW0oZHBpLCBpbmZvLT5wcmVmeCk7CisgICAgICAgIGhl
aWdodF9tbSA9IHFlbXVfZWRpZF9kcGlfdG9fbW0oZHBpLCBpbmZvLT5wcmVmeSk7CisgICAgfQog
CiAgICAgLyogPT09PT09PT09PT09PT09IGV4dGVuc2lvbnMgID09PT09PT09PT09PT09PSAqLwog
CkBAIC0zNjAsOCArMzczLDggQEAgdm9pZCBxZW11X2VkaWRfZ2VuZXJhdGUodWludDhfdCAqZWRp
ZCwgc2l6ZV90IHNpemUsCiAgICAgZWRpZFsyMF0gPSAweGE1OwogCiAgICAgLyogc2NyZWVuIHNp
emU6IHVuZGVmaW5lZCAqLwotICAgIGVkaWRbMjFdID0gaW5mby0+cHJlZnggKiAyNTQgLyAxMDAg
LyBpbmZvLT5kcGk7Ci0gICAgZWRpZFsyMl0gPSBpbmZvLT5wcmVmeSAqIDI1NCAvIDEwMCAvIGlu
Zm8tPmRwaTsKKyAgICBlZGlkWzIxXSA9IHdpZHRoX21tIC8gMTA7CisgICAgZWRpZFsyMl0gPSBo
ZWlnaHRfbW0gLyAxMDsKIAogICAgIC8qIGRpc3BsYXkgZ2FtbWE6IDIuMiAqLwogICAgIGVkaWRb
MjNdID0gMjIwIC0gMTAwOwpAQCAtMzg3LDcgKzQwMCw4IEBAIHZvaWQgcWVtdV9lZGlkX2dlbmVy
YXRlKHVpbnQ4X3QgKmVkaWQsIHNpemVfdCBzaXplLAogCiAgICAgLyogPT09PT09PT09PT09PT09
IGRlc2NyaXB0b3IgYmxvY2tzID09PT09PT09PT09PT09PSAqLwogCi0gICAgZWRpZF9kZXNjX3Rp
bWluZyhlZGlkICsgZGVzYywgaW5mby0+cHJlZngsIGluZm8tPnByZWZ5LCBpbmZvLT5kcGkpOwor
ICAgIGVkaWRfZGVzY190aW1pbmcoZWRpZCArIGRlc2MsIGluZm8tPnByZWZ4LCBpbmZvLT5wcmVm
eSwKKyAgICAgICAgICAgICAgICAgICAgIHdpZHRoX21tLCBoZWlnaHRfbW0pOwogICAgIGRlc2Mg
Kz0gMTg7CiAKICAgICBlZGlkX2Rlc2NfcmFuZ2VzKGVkaWQgKyBkZXNjKTsKZGlmZiAtLWdpdCBh
L2luY2x1ZGUvaHcvZGlzcGxheS9lZGlkLmggYi9pbmNsdWRlL2h3L2Rpc3BsYXkvZWRpZC5oCmlu
ZGV4IDViMWRlNTdmMjQuLjFmOGZjOWIzNzUgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvaHcvZGlzcGxh
eS9lZGlkLmgKKysrIGIvaW5jbHVkZS9ody9kaXNwbGF5L2VkaWQuaApAQCAtNSw3ICs1LDggQEAg
dHlwZWRlZiBzdHJ1Y3QgcWVtdV9lZGlkX2luZm8gewogICAgIGNvbnN0IGNoYXIgKnZlbmRvcjsg
LyogaHR0cDovL3d3dy51ZWZpLm9yZy9wbnBfaWRfbGlzdCAqLwogICAgIGNvbnN0IGNoYXIgKm5h
bWU7CiAgICAgY29uc3QgY2hhciAqc2VyaWFsOwotICAgIHVpbnQzMl90ICAgIGRwaTsKKyAgICB1
aW50MTZfdCAgICB3aWR0aF9tbTsKKyAgICB1aW50MTZfdCAgICBoZWlnaHRfbW07CiAgICAgdWlu
dDMyX3QgICAgcHJlZng7CiAgICAgdWludDMyX3QgICAgcHJlZnk7CiAgICAgdWludDMyX3QgICAg
bWF4eDsKQEAgLTE4LDYgKzE5LDggQEAgc2l6ZV90IHFlbXVfZWRpZF9zaXplKHVpbnQ4X3QgKmVk
aWQpOwogdm9pZCBxZW11X2VkaWRfcmVnaW9uX2lvKE1lbW9yeVJlZ2lvbiAqcmVnaW9uLCBPYmpl
Y3QgKm93bmVyLAogICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQ4X3QgKmVkaWQsIHNpemVf
dCBzaXplKTsKIAordWludDMyX3QgcWVtdV9lZGlkX2RwaV90b19tbSh1aW50MzJfdCBkcGksIHVp
bnQzMl90IHJlcyk7CisKICNkZWZpbmUgREVGSU5FX0VESURfUFJPUEVSVElFUyhfc3RhdGUsIF9l
ZGlkX2luZm8pICAgICAgICAgICAgICBcCiAgICAgREVGSU5FX1BST1BfVUlOVDMyKCJ4cmVzIiwg
X3N0YXRlLCBfZWRpZF9pbmZvLnByZWZ4LCAwKSwgICAgXAogICAgIERFRklORV9QUk9QX1VJTlQz
MigieXJlcyIsIF9zdGF0ZSwgX2VkaWRfaW5mby5wcmVmeSwgMCksICAgIFwKZGlmZiAtLWdpdCBh
L3FlbXUtZWRpZC5jIGIvcWVtdS1lZGlkLmMKaW5kZXggNDZlZWY3MDQ5OC4uMWRiMzM3MmI5OCAx
MDA2NDQKLS0tIGEvcWVtdS1lZGlkLmMKKysrIGIvcWVtdS1lZGlkLmMKQEAgLTksNyArOSwxMCBA
QAogI2luY2x1ZGUgInFlbXUvY3V0aWxzLmgiCiAjaW5jbHVkZSAiaHcvZGlzcGxheS9lZGlkLmgi
CiAKLXN0YXRpYyBxZW11X2VkaWRfaW5mbyBpbmZvOworc3RhdGljIHFlbXVfZWRpZF9pbmZvIGlu
Zm8gPSAocWVtdV9lZGlkX2luZm8pIHsKKyAgICAucHJlZnggPSAxMDI0LAorICAgIC5wcmVmeSA9
IDc2OCwKK307CiAKIHN0YXRpYyB2b2lkIHVzYWdlKEZJTEUgKm91dCkKIHsKQEAgLTM5LDYgKzQy
LDcgQEAgaW50IG1haW4oaW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSkKIHsKICAgICBGSUxFICpvdXRm
aWxlID0gTlVMTDsKICAgICB1aW50OF90IGJsb2JbMjU2XTsKKyAgICB1aW50MzJfdCBkcGkgPSAx
MDA7CiAgICAgaW50IHJjOwogCiAgICAgZm9yICg7OykgewpAQCAtODMsNyArODcsNyBAQCBpbnQg
bWFpbihpbnQgYXJnYywgY2hhciAqYXJndltdKQogICAgICAgICAgICAgfQogICAgICAgICAgICAg
YnJlYWs7CiAgICAgICAgIGNhc2UgJ2QnOgotICAgICAgICAgICAgaWYgKHFlbXVfc3RydG91aShv
cHRhcmcsIE5VTEwsIDEwLCAmaW5mby5kcGkpIDwgMCkgeworICAgICAgICAgICAgaWYgKHFlbXVf
c3RydG91aShvcHRhcmcsIE5VTEwsIDEwLCAmZHBpKSA8IDApIHsKICAgICAgICAgICAgICAgICBm
cHJpbnRmKHN0ZGVyciwgIm5vdCBhIG51bWJlcjogJXNcbiIsIG9wdGFyZyk7CiAgICAgICAgICAg
ICAgICAgZXhpdCgxKTsKICAgICAgICAgICAgIH0KQEAgLTExMCw2ICsxMTQsOSBAQCBpbnQgbWFp
bihpbnQgYXJnYywgY2hhciAqYXJndltdKQogICAgICAgICBvdXRmaWxlID0gc3Rkb3V0OwogICAg
IH0KIAorICAgIGluZm8ud2lkdGhfbW0gPSBxZW11X2VkaWRfZHBpX3RvX21tKGRwaSwgaW5mby5w
cmVmeCk7CisgICAgaW5mby5oZWlnaHRfbW0gPSBxZW11X2VkaWRfZHBpX3RvX21tKGRwaSwgaW5m
by5wcmVmeSk7CisKICAgICBtZW1zZXQoYmxvYiwgMCwgc2l6ZW9mKGJsb2IpKTsKICAgICBxZW11
X2VkaWRfZ2VuZXJhdGUoYmxvYiwgc2l6ZW9mKGJsb2IpLCAmaW5mbyk7CiAgICAgZndyaXRlKGJs
b2IsIHNpemVvZihibG9iKSwgMSwgb3V0ZmlsZSk7Ci0tIAoyLjI2LjIKCl9fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClNwaWNlLWRldmVsIG1haWxpbmcgbGlz
dApTcGljZS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVz
a3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9zcGljZS1kZXZlbAo=
