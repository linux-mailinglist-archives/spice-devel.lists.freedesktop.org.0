Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 27AB487CA2
	for <lists+spice-devel@lfdr.de>; Fri,  9 Aug 2019 16:27:29 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 94DF26EE24;
	Fri,  9 Aug 2019 14:27:27 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 073926EE25
 for <spice-devel@lists.freedesktop.org>; Fri,  9 Aug 2019 14:27:26 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx07.intmail.prod.int.phx2.redhat.com
 [10.5.11.22])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id 9E64F302246D;
 Fri,  9 Aug 2019 14:27:25 +0000 (UTC)
Received: from fziglio.remote.csb (ovpn-204-160.brq.redhat.com [10.40.204.160])
 by smtp.corp.redhat.com (Postfix) with ESMTP id B9DC21001284;
 Fri,  9 Aug 2019 14:27:20 +0000 (UTC)
From: Frediano Ziglio <fziglio@redhat.com>
To: spice-devel@lists.freedesktop.org
Date: Fri,  9 Aug 2019 15:26:26 +0100
Message-Id: <20190809142651.2967-9-fziglio@redhat.com>
In-Reply-To: <20190809142651.2967-1-fziglio@redhat.com>
References: <20190809142651.2967-1-fziglio@redhat.com>
MIME-Version: 1.0
X-Scanned-By: MIMEDefang 2.84 on 10.5.11.22
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16
 (mx1.redhat.com [10.5.110.49]); Fri, 09 Aug 2019 14:27:25 +0000 (UTC)
Subject: [Spice-devel] [PATCH spice-gtk v2 08/33] usb-redir: add files for
 SCSI and USB MSC implementation
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Alexander Nezhinsky <anezhins@redhat.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

RnJvbTogWXVyaSBCZW5kaXRvdmljaCA8eXVyaS5iZW5kaXRvdmljaEBkYXluaXguY29tPgoKRmls
ZXMgYWRkZWQgd2l0aG91dCBpbmNsdWRpbmcgdGhlbSBpbiBjb21waWxhdGlvbi4KVGhleSBjb250
YWluIGltcGxlbWVudGF0aW9uIG9mIFNDU0kgY29tbWFuZHMgZm9yIGxvZ2ljYWwKdW5pdHMgb2Yg
bWFzcy1zdG9yYWdlIGRldmljZSBjbGFzcyBhbmQgVVNCIGJ1bGstb25seQptYXNzLXN0b3JhZ2Ug
ZGV2aWNlIHByb3RvY29sLgoKU2lnbmVkLW9mZi1ieTogQWxleGFuZGVyIE5lemhpbnNreTxhbmV6
aGluc0ByZWRoYXQuY29tPgpTaWduZWQtb2ZmLWJ5OiBZdXJpIEJlbmRpdG92aWNoIDx5dXJpLmJl
bmRpdG92aWNoQGRheW5peC5jb20+Ci0tLQogc3JjL2NkLXNjc2ktZGV2LXBhcmFtcy5oIHwgICA0
OSArCiBzcmMvY2Qtc2NzaS5jICAgICAgICAgICAgfCAyNzU4ICsrKysrKysrKysrKysrKysrKysr
KysrKysrKysrKysrKysrKysrCiBzcmMvY2Qtc2NzaS5oICAgICAgICAgICAgfCAgMTIxICsrCiBz
cmMvY2QtdXNiLWJ1bGstbXNkLmMgICAgfCAgNTQ2ICsrKysrKysrCiBzcmMvY2QtdXNiLWJ1bGst
bXNkLmggICAgfCAgMTM0ICsrCiBzcmMvc2NzaS1jb25zdGFudHMuaCAgICAgfCAgMzI0ICsrKysr
CiA2IGZpbGVzIGNoYW5nZWQsIDM5MzIgaW5zZXJ0aW9ucygrKQogY3JlYXRlIG1vZGUgMTAwNjQ0
IHNyYy9jZC1zY3NpLWRldi1wYXJhbXMuaAogY3JlYXRlIG1vZGUgMTAwNjQ0IHNyYy9jZC1zY3Np
LmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBzcmMvY2Qtc2NzaS5oCiBjcmVhdGUgbW9kZSAxMDA2NDQg
c3JjL2NkLXVzYi1idWxrLW1zZC5jCiBjcmVhdGUgbW9kZSAxMDA2NDQgc3JjL2NkLXVzYi1idWxr
LW1zZC5oCiBjcmVhdGUgbW9kZSAxMDA2NDQgc3JjL3Njc2ktY29uc3RhbnRzLmgKCmRpZmYgLS1n
aXQgYS9zcmMvY2Qtc2NzaS1kZXYtcGFyYW1zLmggYi9zcmMvY2Qtc2NzaS1kZXYtcGFyYW1zLmgK
bmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAuLmI0ODBiY2RjCi0tLSAvZGV2L251
bGwKKysrIGIvc3JjL2NkLXNjc2ktZGV2LXBhcmFtcy5oCkBAIC0wLDAgKzEsNDkgQEAKKy8qIC0q
LSBNb2RlOiBDOyBjLWJhc2ljLW9mZnNldDogNDsgaW5kZW50LXRhYnMtbW9kZTogbmlsIC0qLSAq
LworLyoKKyAgIENEIFNDU0kgZGV2aWNlIHBhcmFtZXRlcnMKKworICAgQ29weXJpZ2h0IChDKSAy
MDE4IFJlZCBIYXQsIEluYy4KKworICAgUmVkIEhhdCBBdXRob3JzOgorICAgQWxleGFuZGVyIE5l
emhpbnNreTxhbmV6aGluc0ByZWRoYXQuY29tPgorCisgICBUaGlzIGxpYnJhcnkgaXMgZnJlZSBz
b2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yCisgICBtb2RpZnkgaXQgdW5k
ZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCisgICBMaWNlbnNl
IGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIKKyAg
IHZlcnNpb24gMi4xIG9mIHRoZSBMaWNlbnNlLCBvciAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRl
ciB2ZXJzaW9uLgorCisgICBUaGlzIGxpYnJhcnkgaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUg
dGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKKyAgIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0
aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCisgICBNRVJDSEFOVEFCSUxJVFkgb3Ig
RklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlIEdOVQorICAgTGVzc2Vy
IEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KKworICAgWW91IHNob3Vs
ZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYwor
ICAgTGljZW5zZSBhbG9uZyB3aXRoIHRoaXMgbGlicmFyeTsgaWYgbm90LCBzZWUgPGh0dHA6Ly93
d3cuZ251Lm9yZy9saWNlbnNlcy8+LgorKi8KKworI2lmbmRlZiBTUElDRV9HVEtfQ0RfU0NTSV9E
RVZfUEFSQU1TX0hfCisjZGVmaW5lIFNQSUNFX0dUS19DRF9TQ1NJX0RFVl9QQVJBTVNfSF8KKwor
I2luY2x1ZGUgPGdpby9naW8uaD4KKwordHlwZWRlZiBzdHJ1Y3QgQ2RTY3NpRGV2aWNlUGFyYW1l
dGVycyB7CisgICAgY29uc3QgY2hhciAqdmVuZG9yOworICAgIGNvbnN0IGNoYXIgKnByb2R1Y3Q7
CisgICAgY29uc3QgY2hhciAqdmVyc2lvbjsKKyAgICBjb25zdCBjaGFyICpzZXJpYWw7Cit9IENk
U2NzaURldmljZVBhcmFtZXRlcnM7CisKK3R5cGVkZWYgc3RydWN0IENkU2NzaURldmljZUluZm8g
eworICAgIENkU2NzaURldmljZVBhcmFtZXRlcnMgcGFyYW1ldGVyczsKKyAgICB1aW50MzJfdCBz
dGFydGVkICAgIDogMTsKKyAgICB1aW50MzJfdCBsb2NrZWQgICAgIDogMTsKKyAgICB1aW50MzJf
dCBsb2FkZWQgICAgIDogMTsKK30gQ2RTY3NpRGV2aWNlSW5mbzsKKwordHlwZWRlZiBzdHJ1Y3Qg
Q2RTY3NpTWVkaWFQYXJhbWV0ZXJzIHsKKyAgICBHRmlsZUlucHV0U3RyZWFtICpzdHJlYW07Cisg
ICAgdWludDY0X3Qgc2l6ZTsKKyAgICB1aW50MzJfdCBibG9ja19zaXplOworfSBDZFNjc2lNZWRp
YVBhcmFtZXRlcnM7CisKKyNlbmRpZiAvKiBTUElDRV9HVEtfQ0RfU0NTSV9ERVZfUEFSQU1TX0hf
ICovCmRpZmYgLS1naXQgYS9zcmMvY2Qtc2NzaS5jIGIvc3JjL2NkLXNjc2kuYwpuZXcgZmlsZSBt
b2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMC4uMmEzNTk1YmIKLS0tIC9kZXYvbnVsbAorKysgYi9z
cmMvY2Qtc2NzaS5jCkBAIC0wLDAgKzEsMjc1OCBAQAorLyogLSotIE1vZGU6IEM7IGMtYmFzaWMt
b2Zmc2V0OiA0OyBpbmRlbnQtdGFicy1tb2RlOiBuaWwgLSotICovCisvKgorICAgQ0QgZGV2aWNl
IGVtdWxhdGlvbiAtIFNDU0kgZW5naW5lCisKKyAgIENvcHlyaWdodCAoQykgMjAxOCBSZWQgSGF0
LCBJbmMuCisKKyAgIFJlZCBIYXQgQXV0aG9yczoKKyAgIEFsZXhhbmRlciBOZXpoaW5za3k8YW5l
emhpbnNAcmVkaGF0LmNvbT4KKworICAgVGhpcyBsaWJyYXJ5IGlzIGZyZWUgc29mdHdhcmU7IHlv
dSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vcgorICAgbW9kaWZ5IGl0IHVuZGVyIHRoZSB0ZXJt
cyBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYworICAgTGljZW5zZSBhcyBwdWJsaXNo
ZWQgYnkgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyCisgICB2ZXJzaW9uIDIu
MSBvZiB0aGUgTGljZW5zZSwgb3IgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4K
KworICAgVGhpcyBsaWJyYXJ5IGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2ls
bCBiZSB1c2VmdWwsCisgICBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0
aGUgaW1wbGllZCB3YXJyYW50eSBvZgorICAgTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9S
IEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZSBHTlUKKyAgIExlc3NlciBHZW5lcmFsIFB1
YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCisKKyAgIFlvdSBzaG91bGQgaGF2ZSByZWNl
aXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKKyAgIExpY2Vuc2Ug
YWxvbmcgd2l0aCB0aGlzIGxpYnJhcnk7IGlmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcv
bGljZW5zZXMvPi4KKyovCisKKyNpbmNsdWRlICJjb25maWcuaCIKKyNpbmNsdWRlICJzcGljZS90
eXBlcy5oIgorI2luY2x1ZGUgInNwaWNlLWNvbW1vbi5oIgorI2luY2x1ZGUgInNwaWNlLXV0aWwu
aCIKKyNpbmNsdWRlICJjZC1zY3NpLmgiCisKKyNpZmRlZiBVU0VfVVNCUkVESVIKKworI2RlZmlu
ZSBTUElDRV9FUlJPUihmbXQsIC4uLikgXAorICAgIGRvIHsgU1BJQ0VfREVCVUcoImRldi1zY3Np
IGVycm9yOiAiIGZtdCAsICMjIF9fVkFfQVJHU19fKTsgfSB3aGlsZSAoMCkKKworI2RlZmluZSBG
SVhFRF9TRU5TRV9DVVJSRU5UIDB4NzAKKyNkZWZpbmUgRklYRURfU0VOU0VfTEVOIDE4CisKKyNk
ZWZpbmUgTUFYX0xVTlMgICAzMgorCit0eXBlZGVmIGVudW0gQ2RTY3NpUG93ZXJDb25kaXRpb24g
eworICAgIENEX1NDU0lfUE9XRVJfU1RPUFBFRCwKKyAgICBDRF9TQ1NJX1BPV0VSX0FDVElWRSwK
KyAgICBDRF9TQ1NJX1BPV0VSX0lETEUsCisgICAgQ0RfU0NTSV9QT1dFUl9TVEFOREJZCit9IENk
U2NzaVBvd2VyQ29uZGl0aW9uOworCit0eXBlZGVmIHN0cnVjdCBTY3NpU2hvcnRTZW5zZSB7Cisg
ICAgdWludDhfdCBrZXk7CisgICAgdWludDhfdCBhc2M7CisgICAgdWludDhfdCBhc2NxOworICAg
IGNvbnN0IGNoYXIgKmRlc2NyOworfSBTY3NpU2hvcnRTZW5zZTsKKworI2RlZmluZSBDRF9NRURJ
QV9FVkVOVF9OT19DSEFOR0UgICAgICAgICAgICAweDAKKyNkZWZpbmUgQ0RfTUVESUFfRVZFTlRf
RUpFQ1RfUkVRICAgICAgICAgICAgMHgxIC8qIHVzZXIgcmVxdWVzdCAobWVjaGFuaWNhbCBzd2l0
Y2gpIHRvCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
KiBlamVjdCB0aGUgbWVkaWEgKi8KKyNkZWZpbmUgQ0RfTUVESUFfRVZFTlRfTkVXX01FRElBICAg
ICAgICAgICAgMHgyIC8qIG5ldyBtZWRpYSByZWNlaXZlZCAqLworI2RlZmluZSBDRF9NRURJQV9F
VkVOVF9NRURJQV9SRU1PVkFMICAgICAgICAweDMgLyogbWVkaWEgcmVtb3ZlZCAqLworI2RlZmlu
ZSBDRF9NRURJQV9FVkVOVF9NRURJQV9DSEFOR0VEICAgICAgICAweDQgLyogdXNlciByZXF1ZXN0
IHRvIGxvYWQgbmV3IG1lZGlhICovCisjZGVmaW5lIENEX01FRElBX0VWRU5UX0JHX0ZPUk1BVF9D
T01QTEVURSAgIDB4NQorI2RlZmluZSBDRF9NRURJQV9FVkVOVF9CR19GT1JNQVRfUkVTVEFSVCAg
ICAweDYKKworI2RlZmluZSBDRF9QT1dFUl9FVkVOVF9OT19DSEFOR0UgICAgICAgICAgICAweDAK
KyNkZWZpbmUgQ0RfUE9XRVJfRVZFTlRfQ0hBTkdFX1NVQ0NFU1MgICAgICAgMHgxCisjZGVmaW5l
IENEX1BPV0VSX0VWRU5UX0NIQU5HRV9GQUxFRCAgICAgICAgIDB4MgorCit0eXBlZGVmIHN0cnVj
dCBDZFNjc2lMVSB7CisgICAgQ2RTY3NpVGFyZ2V0ICp0Z3Q7CisgICAgdWludDMyX3QgbHVuOwor
CisgICAgZ2Jvb2xlYW4gcmVhbGl6ZWQ7CisgICAgZ2Jvb2xlYW4gcmVtb3ZhYmxlOworICAgIGdi
b29sZWFuIGxvYWRlZDsKKyAgICBnYm9vbGVhbiBwcmV2ZW50X21lZGlhX3JlbW92YWw7CisgICAg
Z2Jvb2xlYW4gY2Rfcm9tOworCisgICAgQ2RTY3NpUG93ZXJDb25kaXRpb24gcG93ZXJfY29uZDsK
KyAgICB1aW50MzJfdCBwb3dlcl9ldmVudDsKKyAgICB1aW50MzJfdCBtZWRpYV9ldmVudDsKKwor
ICAgIHVpbnQzMl90IGNsYWltX3ZlcnNpb247CisKKyAgICB1aW50NjRfdCBzaXplOworICAgIHVp
bnQzMl90IGJsb2NrX3NpemU7CisgICAgdWludDMyX3QgbnVtX2Jsb2NrczsKKworICAgIGNoYXIg
KnZlbmRvcjsKKyAgICBjaGFyICpwcm9kdWN0OworICAgIGNoYXIgKnZlcnNpb247CisgICAgY2hh
ciAqc2VyaWFsOworCisgICAgR0ZpbGVJbnB1dFN0cmVhbSAqc3RyZWFtOworCisgICAgU2NzaVNo
b3J0U2Vuc2Ugc2hvcnRfc2Vuc2U7IC8qIGN1cnJlbnRseSBoZWxkIHNlbnNlIG9mIHRoZSBzY3Np
IGRldmljZSAqLworICAgIHVpbnQ4X3QgZml4ZWRfc2Vuc2VbRklYRURfU0VOU0VfTEVOXTsKK30g
Q2RTY3NpTFU7CisKK3R5cGVkZWYgZW51bSBDZFNjc2lUYXJnZXRTdGF0ZSB7CisgICAgQ0RfU0NT
SV9UR1RfU1RBVEVfUlVOTklORywKKyAgICBDRF9TQ1NJX1RHVF9TVEFURV9SRVNFVCwKK30gQ2RT
Y3NpVGFyZ2V0U3RhdGU7CisKK3N0cnVjdCBDZFNjc2lUYXJnZXQgeworICAgIHZvaWQgKnVzZXJf
ZGF0YTsKKworICAgIENkU2NzaVRhcmdldFN0YXRlIHN0YXRlOworICAgIENkU2NzaVJlcXVlc3Qg
KmN1cl9yZXE7CisgICAgR0NhbmNlbGxhYmxlICpjYW5jZWxsYWJsZTsKKworICAgIHVpbnQzMl90
IG51bV9sdW5zOworICAgIHVpbnQzMl90IG1heF9sdW5zOworICAgIENkU2NzaUxVIHVuaXRzW01B
WF9MVU5TXTsKK307CisKK3N0YXRpYyBjb25zdCBjaGFyKiBzY3NpX2NtZF9uYW1lWzI1Nl07CisK
Ky8qIFByZWRlZmluZWQgc2Vuc2UgY29kZXMgKi8KKworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vu
c2VfY29kZV9OT19TRU5TRSA9IHsKKyAgICAua2V5ID0gTk9fU0VOU0UgLCAuYXNjID0gMHgwMCAs
IC5hc2NxID0gMHgwMCwKKyAgICAuZGVzY3IgPSAiIgorfTsKKworY29uc3QgU2NzaVNob3J0U2Vu
c2Ugc2Vuc2VfY29kZV9OT1RfUkVBRFlfQ0FVU0VfTk9UX1JFUE9SVEFCTEUgPSB7CisgICAgLmtl
eSA9IE5PVF9SRUFEWSwgLmFzYyA9IDB4MDQsIC5hc2NxID0gMHgwMCwKKyAgICAuZGVzY3IgPSAi
Q0FVU0UgTk9UIFJFUE9SVEFCTEUiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9j
b2RlX0JFQ09NSU5HX1JFQURZID0geworICAgIC5rZXkgPSBOT1RfUkVBRFksIC5hc2MgPSAweDA0
LCAuYXNjcSA9IDB4MDEsCisgICAgLmRlc2NyID0gIklOIFBST0NFU1MgT0YgQkVDT01JTkcgUkVB
RFkiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX0lOSVRfQ01EX1JFUVVJ
UkVEID0geworICAgIC5rZXkgPSBOT1RfUkVBRFksIC5hc2MgPSAweDA0LCAuYXNjcSA9IDB4MDIs
CisgICAgLmRlc2NyID0gIklOSVRJQUxJWklORyBDT01NQU5EIFJFUVVJUkVEIgorfTsKKworY29u
c3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9JTlRFUlZFTlRJT05fUkVRVUlSRUQgPSB7Cisg
ICAgLmtleSA9IE5PVF9SRUFEWSwgLmFzYyA9IDB4MDQsIC5hc2NxID0gMHgwMywKKyAgICAuZGVz
Y3IgPSAiTUFOVUFMIElOVEVSVkVOVElPTiBSRVFVSVJFRCIKK307CisKK2NvbnN0IFNjc2lTaG9y
dFNlbnNlIHNlbnNlX2NvZGVfTk9UX1JFQURZX05PX01FRElVTSA9IHsKKyAgICAua2V5ID0gTk9U
X1JFQURZLCAuYXNjID0gMHgzYSwgLmFzY3EgPSAweDAwLAorICAgIC5kZXNjciA9ICJNRURJVU0g
Tk9UIFBSRVNFTlQiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX05PVF9S
RUFEWV9OT19NRURJVU1fVFJBWV9DTE9TRUQgPSB7CisgICAgLmtleSA9IE5PVF9SRUFEWSwgLmFz
YyA9IDB4M2EsIC5hc2NxID0gMHgwMSwKKyAgICAuZGVzY3IgPSAiTUVESVVNIE5PVCBQUkVTRU5U
IC0gVFJBWSBDTE9TRUQiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX05P
VF9SRUFEWV9OT19NRURJVU1fVFJBWV9PUEVOID0geworICAgIC5rZXkgPSBOT1RfUkVBRFksIC5h
c2MgPSAweDNhLCAuYXNjcSA9IDB4MDIsCisgICAgLmRlc2NyID0gIk1FRElVTSBOT1QgUFJFU0VO
VCAtIFRSQVkgT1BFTiIKK307CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNlIHNlbnNlX2NvZGVfVEFS
R0VUX0ZBSUxVUkUgPSB7CisgICAgLmtleSA9IEhBUkRXQVJFX0VSUk9SLCAuYXNjID0gMHg0NCwg
LmFzY3EgPSAweDAwLAorICAgIC5kZXNjciA9ICJJTlRFUk5BTCBUQVJHRVQgRkFJTFVSRSIKK307
CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNlIHNlbnNlX2NvZGVfSU5WQUxJRF9PUENPREUgPSB7Cisg
ICAgLmtleSA9IElMTEVHQUxfUkVRVUVTVCwgLmFzYyA9IDB4MjAsIC5hc2NxID0gMHgwMCwKKyAg
ICAuZGVzY3IgPSAiSU5WQUxJRCBDT01NQU5EIE9QRVJBVElPTiBDT0RFIgorfTsKKworY29uc3Qg
U2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9MQkFfT1VUX09GX1JBTkdFID0geworICAgIC5rZXkg
PSBJTExFR0FMX1JFUVVFU1QsIC5hc2MgPSAweDIxLCAuYXNjcSA9IDB4MDAsCisgICAgLmRlc2Ny
ID0gIkxPR0lDQUwgQkxPQ0sgQUREUkVTUyBPVVQgT0YgUkFOR0UiCit9OworCitjb25zdCBTY3Np
U2hvcnRTZW5zZSBzZW5zZV9jb2RlX0lOVkFMSURfQ0RCX0ZJRUxEID0geworICAgIC5rZXkgPSBJ
TExFR0FMX1JFUVVFU1QsIC5hc2MgPSAweDI0LCAuYXNjcSA9IDB4MDAsCisgICAgLmRlc2NyID0g
IklOVkFMSUQgRklFTEQgSU4gQ0RCIgorfTsKKworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2Vf
Y29kZV9JTlZBTElEX1BBUkFNX0ZJRUxEID0geworICAgIC5rZXkgPSBJTExFR0FMX1JFUVVFU1Qs
IC5hc2MgPSAweDI2LCAuYXNjcSA9IDB4MDAsCisgICAgLmRlc2NyID0gIklOVkFMSUQgRklFTEQg
SU4gUEFSQU1FVEVSIExJU1QiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2Rl
X0lOVkFMSURfUEFSQU1fTEVOID0geworICAgIC5rZXkgPSBJTExFR0FMX1JFUVVFU1QsIC5hc2Mg
PSAweDFhLCAuYXNjcSA9IDB4MDAsCisgICAgLmRlc2NyID0gIlBBUkFNRVRFUiBMSVNUIExFTkdU
SCBFUlJPUiIKK307CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNlIHNlbnNlX2NvZGVfTFVOX05PVF9T
VVBQT1JURUQgPSB7CisgICAgLmtleSA9IElMTEVHQUxfUkVRVUVTVCwgLmFzYyA9IDB4MjUsIC5h
c2NxID0gMHgwMCwKKyAgICAuZGVzY3IgPSAiTE9HSUNBTCBVTklUIE5PVCBTVVBQT1JURUQiCit9
OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX1NBVklOR19QQVJBTVNfTk9UX1NV
UFBPUlRFRCA9IHsKKyAgICAua2V5ID0gSUxMRUdBTF9SRVFVRVNULCAuYXNjID0gMHgzOSwgLmFz
Y3EgPSAweDAwLAorICAgIC5kZXNjciA9ICJTQVZJTkcgUEFSQU1FVEVSUyBOT1QgU1VQUE9SVEVE
IgorfTsKKworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9JTkNPTVBBVElCTEVfTUVE
SVVNID0geworICAgIC5rZXkgPSBJTExFR0FMX1JFUVVFU1QsIC5hc2MgPSAweDMwLCAuYXNjcSA9
IDB4MDAsCisgICAgLmRlc2NyID0gIklOQ09NUEFUSUJMRSBNRURJVU0gSU5TVEFMTEVEIgorfTsK
KworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9NRURJVU1fUkVNT1ZBTF9QUkVWRU5U
RUQgPSB7CisgICAgLmtleSA9IElMTEVHQUxfUkVRVUVTVCwgLmFzYyA9IDB4NTMsIC5hc2NxID0g
MHgwMiwKKyAgICAuZGVzY3IgPSAiTUVESVVNIFJFTU9WQUwgUFJFVkVOVEVEIgorfTsKKworY29u
c3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9QQVJBTUVURVJTX0NIQU5HRUQgPSB7CisgICAg
LmtleSA9IFVOSVRfQVRURU5USU9OLCAuYXNjID0gMHgyYSwgLmFzY3EgPSAweDAwLAorICAgIC5k
ZXNjciA9ICJQQVJBTUVURVJTIENIQU5HRUQiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBz
ZW5zZV9jb2RlX1BPV0VSX09OX1JFU0VUID0geworICAgIC5rZXkgPSBVTklUX0FUVEVOVElPTiwg
LmFzYyA9IDB4MjksIC5hc2NxID0gMHgwMCwKKyAgICAuZGVzY3IgPSAiUE9XRVIgT04sIFJFU0VU
LCBPUiBCVVMgREVWSUNFIFJFU0VUIgorfTsKKworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2Vf
Y29kZV9TQ1NJX0JVU19SRVNFVCA9IHsKKyAgICAua2V5ID0gVU5JVF9BVFRFTlRJT04sIC5hc2Mg
PSAweDI5LCAuYXNjcSA9IDB4MDIsCisgICAgLmRlc2NyID0gIlNDU0kgQlVTIFJFU0VUIgorfTsK
KworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9VQV9OT19NRURJVU0gPSB7CisgICAg
LmtleSA9IFVOSVRfQVRURU5USU9OLCAuYXNjID0gMHgzYSwgLmFzY3EgPSAweDAwLAorICAgIC5k
ZXNjciA9ICJNRURJVU0gTk9UIFBSRVNFTlQiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBz
ZW5zZV9jb2RlX01FRElVTV9DSEFOR0VEID0geworICAgIC5rZXkgPSBVTklUX0FUVEVOVElPTiwg
LmFzYyA9IDB4MjgsIC5hc2NxID0gMHgwMCwKKyAgICAuZGVzY3IgPSAiTUVESVVNIENIQU5HRUQi
Cit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX1JFUE9SVEVEX0xVTlNfQ0hB
TkdFRCA9IHsKKyAgICAua2V5ID0gVU5JVF9BVFRFTlRJT04sIC5hc2MgPSAweDNmLCAuYXNjcSA9
IDB4MGUsCisgICAgLmRlc2NyID0gIlJFUE9SVEVEIExVTlMgQ0hBTkdFRCIKK307CisKK2NvbnN0
IFNjc2lTaG9ydFNlbnNlIHNlbnNlX2NvZGVfREVWSUNFX0lOVEVSTkFMX1JFU0VUID0geworICAg
IC5rZXkgPSBVTklUX0FUVEVOVElPTiwgLmFzYyA9IDB4MjksIC5hc2NxID0gMHgwNCwKKyAgICAu
ZGVzY3IgPSAiREVWSUNFIElOVEVSTkFMIFJFU0VUIgorfTsKKworY29uc3QgU2NzaVNob3J0U2Vu
c2Ugc2Vuc2VfY29kZV9VTklUX0FUVEVOVElPTl9NRURJVU1fUkVNT1ZBTF9SRVFVRVNUID0gewor
ICAgIC5rZXkgPSBVTklUX0FUVEVOVElPTiwgLmFzYyA9IDB4NWEsIC5hc2NxID0gMHgwMSwKKyAg
ICAuZGVzY3IgPSAiT1BFUkFUT1IgTUVESVVNIFJFTU9WQUwgUkVRVUVTVCIKK307CisKK3N0YXRp
YyBpbmxpbmUgZ2Jvb2xlYW4gY2Rfc2NzaV9vcGNvZGVfdWFfc3VwcmVzcyh1aW50MzJfdCBvcGNv
ZGUpCit7CisgICAgc3dpdGNoIChvcGNvZGUpIHsKKyAgICBjYXNlIElOUVVJUlk6CisgICAgY2Fz
ZSBSRVBPUlRfTFVOUzoKKyAgICBjYXNlIEdFVF9DT05GSUdVUkFUSU9OOgorICAgIGNhc2UgR0VU
X0VWRU5UX1NUQVRVU19OT1RJRklDQVRJT046CisgICAgY2FzZSBSRVFVRVNUX1NFTlNFOgorICAg
ICAgICByZXR1cm4gVFJVRTsKKyAgICBkZWZhdWx0OgorICAgICAgICByZXR1cm4gRkFMU0U7Cisg
ICAgfQorfQorCitzdGF0aWMgaW5saW5lIGNvbnN0IGNoYXIgKkNkU2NzaVJlcVN0YXRlX3N0cihD
ZFNjc2lSZXFTdGF0ZSBzdGF0ZSkKK3sKKyAgICBzd2l0Y2goc3RhdGUpIHsKKyAgICBjYXNlIFND
U0lfUkVRX0lETEU6CisgICAgICAgIHJldHVybiAiSURMRSI7CisgICAgY2FzZSBTQ1NJX1JFUV9S
VU5OSU5HOgorICAgICAgICByZXR1cm4gIlJVTk5JTkciOworICAgIGNhc2UgU0NTSV9SRVFfQ09N
UExFVEU6CisgICAgICAgIHJldHVybiAiQ09NUExFVEUiOworICAgIGNhc2UgU0NTSV9SRVFfQ0FO
Q0VMRUQ6CisgICAgICAgIHJldHVybiAiQ0FOQ0VMRUQiOworICAgIGRlZmF1bHQ6CisgICAgICAg
IHJldHVybiAiSUxMRUdBTCI7CisgICAgfQorfQorCitzdGF0aWMgY29uc3QgY2hhciAqY2Rfc2Nz
aV9zZW5zZV9rZXlfZGVzY3IodWludDhfdCBzZW5zZV9rZXkpCit7CisgICAgc3dpdGNoKHNlbnNl
X2tleSkgeworICAgIGNhc2UgTk9fU0VOU0U6CisgICAgICAgIHJldHVybiAiTk8gU0VOU0UiOwor
ICAgIGNhc2UgUkVDT1ZFUkVEX0VSUk9SOgorICAgICAgICByZXR1cm4gIlJFQ09WRVJFRCBFUlJP
UiI7CisgICAgY2FzZSBOT1RfUkVBRFk6CisgICAgICAgIHJldHVybiAiTFVOIE5PVCBSRUFEWSI7
CisgICAgY2FzZSBNRURJVU1fRVJST1I6CisgICAgICAgIHJldHVybiAiTUVESVVNIEVSUk9SIjsK
KyAgICBjYXNlIEhBUkRXQVJFX0VSUk9SOgorICAgICAgICByZXR1cm4gIkhBUkRXQVJFIEVSUk9S
IjsKKyAgICBjYXNlIElMTEVHQUxfUkVRVUVTVDoKKyAgICAgICAgcmV0dXJuICJJTExFR0FMIFJF
UVVFU1QiOworICAgIGNhc2UgVU5JVF9BVFRFTlRJT046CisgICAgICAgIHJldHVybiAiVU5JVCBB
VFRFTlRJT04iOworICAgIGNhc2UgQkxBTktfQ0hFQ0s6CisgICAgICAgIHJldHVybiAiQkxBTksg
Q0hFQ0siOworICAgIGNhc2UgQUJPUlRFRF9DT01NQU5EOgorICAgICAgICByZXR1cm4gIkFCT1JU
RUQgQ09NTUFORCI7CisgICAgZGVmYXVsdDoKKyAgICAgICAgcmV0dXJuICI/Pz8iOworICAgIH0K
K30KK3N0YXRpYyB1aW50MzJfdCBjZF9zY3NpX2J1aWxkX2ZpeGVkX3NlbnNlKHVpbnQ4X3QgKmJ1
ZiwgY29uc3QgU2NzaVNob3J0U2Vuc2UgKnNob3J0X3NlbnNlKQoreworICAgIG1lbXNldChidWYs
IDAsIEZJWEVEX1NFTlNFX0xFTik7CisKKyAgICBidWZbMF0gPSBGSVhFRF9TRU5TRV9DVVJSRU5U
OworICAgIGJ1ZlsyXSA9IHNob3J0X3NlbnNlLT5rZXk7CisgICAgYnVmWzddID0gMTA7CisgICAg
YnVmWzEyXSA9IHNob3J0X3NlbnNlLT5hc2M7CisgICAgYnVmWzEzXSA9IHNob3J0X3NlbnNlLT5h
c2NxOworCisgICAgcmV0dXJuIEZJWEVEX1NFTlNFX0xFTjsKK30KKworc3RhdGljIGlubGluZSB2
b2lkIGNkX3Njc2lfcmVxX2luaXQoQ2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAgIHJlcS0+cmVx
X3N0YXRlID0gU0NTSV9SRVFfSURMRTsKKyAgICByZXEtPnhmZXJfZGlyID0gU0NTSV9YRkVSX05P
TkU7CisgICAgcmVxLT5wcml2X2RhdGEgPSBOVUxMOworICAgIHJlcS0+aW5fbGVuID0gMDsKKyAg
ICByZXEtPnN0YXR1cyA9IEdPT0Q7Cit9CisKK3N0YXRpYyBpbmxpbmUgdm9pZCBjZF9zY3NpX2Rl
dl9zZW5zZV9yZXNldChDZFNjc2lMVSAqZGV2KQoreworICAgIG1lbXNldCgmZGV2LT5zaG9ydF9z
ZW5zZSwgMCwgc2l6ZW9mKGRldi0+c2hvcnRfc2Vuc2UpKTsKKyAgICBjZF9zY3NpX2J1aWxkX2Zp
eGVkX3NlbnNlKGRldi0+Zml4ZWRfc2Vuc2UsICZkZXYtPnNob3J0X3NlbnNlKTsKK30KKworc3Rh
dGljIGlubGluZSB2b2lkIGNkX3Njc2lfZGV2X3NlbnNlX3NldChDZFNjc2lMVSAqZGV2LCBjb25z
dCBTY3NpU2hvcnRTZW5zZSAqc2hvcnRfc2Vuc2UpCit7CisgICAgaWYgKHNob3J0X3NlbnNlICE9
IE5VTEwpIHsKKyAgICAgICAgLyogY29weSBzaG9ydCBzZW5zZSBhbmQgZ2VuZXJhdGUgZnVsbCBz
ZW5zZSBpbiBmaXhlZCBmb3JtYXQgKi8KKyAgICAgICAgZGV2LT5zaG9ydF9zZW5zZSA9ICpzaG9y
dF9zZW5zZTsKKyAgICAgICAgY2Rfc2NzaV9idWlsZF9maXhlZF9zZW5zZShkZXYtPmZpeGVkX3Nl
bnNlLCBzaG9ydF9zZW5zZSk7CisgICAgfQorfQorCitzdGF0aWMgaW5saW5lIHZvaWQgY2Rfc2Nz
aV9kZXZfc2Vuc2Vfc2V0X3Bvd2VyX29uKENkU2NzaUxVICpkZXYpCit7CisgICAgY2Rfc2NzaV9k
ZXZfc2Vuc2Vfc2V0KGRldiwgJnNlbnNlX2NvZGVfUE9XRVJfT05fUkVTRVQpOworfQorCitzdGF0
aWMgdm9pZCBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKENkU2NzaUxVICpkZXYsIENk
U2NzaVJlcXVlc3QgKnJlcSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgY29uc3QgU2NzaVNob3J0U2Vuc2UgKnNob3J0X3NlbnNlKQoreworICAgIHJlcS0+cmVx
X3N0YXRlID0gU0NTSV9SRVFfQ09NUExFVEU7CisgICAgcmVxLT5zdGF0dXMgPSBDSEVDS19DT05E
SVRJT047CisgICAgcmVxLT5pbl9sZW4gPSAwOworCisgICAgY2Rfc2NzaV9kZXZfc2Vuc2Vfc2V0
KGRldiwgc2hvcnRfc2Vuc2UpOworCisgICAgU1BJQ0VfREVCVUcoIkNIRUNLX0NPTkQsIHJlcXVl
c3QgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQKKyAgICAgICAgICAgICAgICAiIG9wOiAweCUwMngs
IHBlbmRpbmcgc2Vuc2U6IDB4JTAyeCAlMDJ4ICUwMnggLSAlcywgJXMiLAorICAgICAgICAgICAg
ICAgIGRldi0+bHVuLCAodWludDMyX3QpcmVxLT5jZGJbMF0sCisgICAgICAgICAgICAgICAgKHVp
bnQzMl90KWRldi0+c2hvcnRfc2Vuc2Uua2V5LAorICAgICAgICAgICAgICAgICh1aW50MzJfdClk
ZXYtPnNob3J0X3NlbnNlLmFzYywKKyAgICAgICAgICAgICAgICAodWludDMyX3QpZGV2LT5zaG9y
dF9zZW5zZS5hc2NxLAorICAgICAgICAgICAgICAgIGNkX3Njc2lfc2Vuc2Vfa2V5X2Rlc2NyKGRl
di0+c2hvcnRfc2Vuc2Uua2V5KSwKKyAgICAgICAgICAgICAgICBkZXYtPnNob3J0X3NlbnNlLmRl
c2NyKTsKK30KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRfY29tcGxldGVfZ29vZChDZFNjc2lM
VSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgcmVxLT5yZXFfc3RhdGUgPSBTQ1NJ
X1JFUV9DT01QTEVURTsKKyAgICByZXEtPnN0YXR1cyA9IEdPT0Q7Cit9CisKKy8qIFNDU0kgVGFy
Z2V0ICovCisKK1NQSUNFX0NPTlNUUlVDVE9SX0ZVTkMoY2Rfc2NzaV9jbWRfbmFtZXNfaW5pdCkK
K3sKKyAgICB1aW50MzJfdCBvcGNvZGU7CisKKyAgICBmb3IgKG9wY29kZSA9IDA7IG9wY29kZSA8
IDI1Njsgb3Bjb2RlKyspIHsKKyAgICAgICAgc2NzaV9jbWRfbmFtZVtvcGNvZGVdID0gIlVOU1VQ
UE9SVEVEIjsKKyAgICB9CisKKyAgICBzY3NpX2NtZF9uYW1lW1JFUE9SVF9MVU5TXSA9ICJSRVBP
UlQgTFVOUyI7CisgICAgc2NzaV9jbWRfbmFtZVtURVNUX1VOSVRfUkVBRFldID0gIlRFU1QgVU5J
VCBSRUFEWSI7CisgICAgc2NzaV9jbWRfbmFtZVtJTlFVSVJZXSA9ICJJTlFVSVJZIjsKKyAgICBz
Y3NpX2NtZF9uYW1lW1JFUVVFU1RfU0VOU0VdID0gIlJFUVVFU1QgU0VOU0UiOworICAgIHNjc2lf
Y21kX25hbWVbUkVBRF82XSA9ICJSRUFEKDYpIjsKKyAgICBzY3NpX2NtZF9uYW1lW1JFQURfMTBd
ID0gIlJFQUQoMTApIjsKKyAgICBzY3NpX2NtZF9uYW1lW1JFQURfMTJdID0gIlJFQUQoMTIpIjsK
KyAgICBzY3NpX2NtZF9uYW1lW1JFQURfMTZdID0gIlJFQUQoMTYpIjsKKyAgICBzY3NpX2NtZF9u
YW1lW1JFQURfQ0FQQUNJVFlfMTBdID0gIlJFQUQgQ0FQQUNJVFkoMTApIjsKKyAgICBzY3NpX2Nt
ZF9uYW1lW1JFQURfVE9DXSA9ICJSRUFEIFRPQyI7CisgICAgc2NzaV9jbWRfbmFtZVtHRVRfRVZF
TlRfU1RBVFVTX05PVElGSUNBVElPTl0gPSAiR0VUIEVWRU5UL1NUQVRVUyBOT1RJRklDQVRJT04i
OworICAgIHNjc2lfY21kX25hbWVbUkVBRF9ESVNDX0lORk9STUFUSU9OXSA9ICJSRUFEIERJU0Mg
SU5GTyI7CisgICAgc2NzaV9jbWRfbmFtZVtSRUFEX1RSQUNLX0lORk9STUFUSU9OXSA9ICJSRUFE
IFRSQUNLIElORk8iOworICAgIHNjc2lfY21kX25hbWVbTU9ERV9TRU5TRV8xMF0gPSAiTU9ERSBT
RU5TRSgxMCkiOworICAgIHNjc2lfY21kX25hbWVbTU9ERV9TRUxFQ1RdID0gIk1PREUgU0VMRUNU
KDYpIjsKKyAgICBzY3NpX2NtZF9uYW1lW01PREVfU0VMRUNUXzEwXSA9ICJNT0RFIFNFTEVDVCgx
MCkiOworICAgIHNjc2lfY21kX25hbWVbR0VUX0NPTkZJR1VSQVRJT05dID0gIkdFVCBDT05GSUdV
UkFUSU9OIjsKKyAgICBzY3NpX2NtZF9uYW1lW0FMTE9XX01FRElVTV9SRU1PVkFMXSA9ICJQUkVW
RU5UIEFMTE9XIE1FRElVTSBSRU1PVkFMIjsKKyAgICBzY3NpX2NtZF9uYW1lW01NQ19TRU5EX0VW
RU5UXSA9ICJTRU5EIEVWRU5UIjsKKyAgICBzY3NpX2NtZF9uYW1lW01NQ19SRVBPUlRfS0VZXSA9
ICJSRVBPUlQgS0VZIjsKKyAgICBzY3NpX2NtZF9uYW1lW01NQ19TRU5EX0tFWV0gPSAiU0VORF9L
RVkiOworICAgIHNjc2lfY21kX25hbWVbU1RBUlRfU1RPUF0gPSAiU1RBUlQgU1RPUCBVTklUIjsK
KyAgICBzY3NpX2NtZF9uYW1lW01NQ19HRVRfUEVSRk9STUFOQ0VdID0gIkdFVCBQRVJGT1JNQU5D
RSI7CisgICAgc2NzaV9jbWRfbmFtZVtNTUNfTUVDSEFOSVNNX1NUQVRVU10gPSAiTUVDSEFOSVNN
IFNUQVRVUyI7Cit9CisKK0NkU2NzaVRhcmdldCAqY2Rfc2NzaV90YXJnZXRfYWxsb2Modm9pZCAq
dGFyZ2V0X3VzZXJfZGF0YSwgdWludDMyX3QgbWF4X2x1bnMpCit7CisgICAgQ2RTY3NpVGFyZ2V0
ICpzdDsKKworICAgIGlmIChtYXhfbHVucyA9PSAwIHx8IG1heF9sdW5zID4gTUFYX0xVTlMpIHsK
KyAgICAgICAgU1BJQ0VfRVJST1IoIkFsbG9jLCBpbGxlZ2FsIG1heF9sdW5zOiUiIEdfR1VJTlQz
Ml9GT1JNQVQsIG1heF9sdW5zKTsKKyAgICAgICAgcmV0dXJuIE5VTEw7CisgICAgfQorCisgICAg
c3QgPSBnX21hbGxvYzAoc2l6ZW9mKCpzdCkpOworCisgICAgc3QtPnVzZXJfZGF0YSA9IHRhcmdl
dF91c2VyX2RhdGE7CisgICAgc3QtPnN0YXRlID0gQ0RfU0NTSV9UR1RfU1RBVEVfUlVOTklORzsK
KyAgICBzdC0+Y3VyX3JlcSA9IE5VTEw7CisgICAgc3QtPmNhbmNlbGxhYmxlID0gZ19jYW5jZWxs
YWJsZV9uZXcoKTsKKyAgICBzdC0+bWF4X2x1bnMgPSBtYXhfbHVuczsKKworICAgIHJldHVybiBz
dDsKK30KKwordm9pZCBjZF9zY3NpX3RhcmdldF9mcmVlKENkU2NzaVRhcmdldCAqc2NzaV90YXJn
ZXQpCit7CisgICAgY2Rfc2NzaV90YXJnZXRfcmVzZXQoc2NzaV90YXJnZXQpOworICAgIGdfZnJl
ZShzY3NpX3RhcmdldCk7Cit9CisKKy8qIFNDU0kgRGV2aWNlICovCisKK3N0YXRpYyBpbmxpbmUg
Z2Jvb2xlYW4gY2Rfc2NzaV90YXJnZXRfbHVuX2xlZ2FsKENkU2NzaVRhcmdldCAqc3QsIHVpbnQz
Ml90IGx1bikKK3sKKyAgICByZXR1cm4gKGx1biA8IHN0LT5tYXhfbHVucykgPyBUUlVFIDogRkFM
U0U7Cit9CisKK3N0YXRpYyBpbmxpbmUgZ2Jvb2xlYW4gY2Rfc2NzaV90YXJnZXRfbHVuX3JlYWxp
emVkKENkU2NzaVRhcmdldCAqc3QsIHVpbnQzMl90IGx1bikKK3sKKyAgICByZXR1cm4gKHN0LT5u
dW1fbHVucyA9PSAwIHx8ICFzdC0+dW5pdHNbbHVuXS5yZWFsaXplZCkgPyBGQUxTRSA6IFRSVUU7
Cit9CisKK2ludCBjZF9zY3NpX2Rldl9yZWFsaXplKENkU2NzaVRhcmdldCAqc3QsIHVpbnQzMl90
IGx1biwKKyAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IENkU2NzaURldmljZVBhcmFtZXRl
cnMgKmRldl9wYXJhbXMpCit7CisgICAgQ2RTY3NpTFUgKmRldjsKKworICAgIGlmICghY2Rfc2Nz
aV90YXJnZXRfbHVuX2xlZ2FsKHN0LCBsdW4pKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJSZWFs
aXplLCBpbGxlZ2FsIGx1bjolIiBHX0dVSU5UMzJfRk9STUFULCBsdW4pOworICAgICAgICByZXR1
cm4gLTE7CisgICAgfQorICAgIGlmIChjZF9zY3NpX3RhcmdldF9sdW5fcmVhbGl6ZWQoc3QsIGx1
bikpIHsKKyAgICAgICAgU1BJQ0VfRVJST1IoIlJlYWxpemUsIGFscmVhZHkgcmVhbGl6ZWQgbHVu
OiUiIEdfR1VJTlQzMl9GT1JNQVQsIGx1bik7CisgICAgICAgIHJldHVybiAtMTsKKyAgICB9Cisg
ICAgZGV2ID0gJnN0LT51bml0c1tsdW5dOworCisgICAgbWVtc2V0KGRldiwgMCwgc2l6ZW9mKCpk
ZXYpKTsKKyAgICBkZXYtPnRndCA9IHN0OworICAgIGRldi0+bHVuID0gbHVuOworCisgICAgZGV2
LT5yZWFsaXplZCA9IFRSVUU7CisgICAgZGV2LT5yZW1vdmFibGUgPSBUUlVFOworICAgIGRldi0+
bG9hZGVkID0gRkFMU0U7CisgICAgZGV2LT5wcmV2ZW50X21lZGlhX3JlbW92YWwgPSBGQUxTRTsK
KyAgICBkZXYtPmNkX3JvbSA9IEZBTFNFOworCisgICAgZGV2LT5wb3dlcl9jb25kID0gQ0RfU0NT
SV9QT1dFUl9BQ1RJVkU7CisgICAgZGV2LT5wb3dlcl9ldmVudCA9IENEX1BPV0VSX0VWRU5UX05P
X0NIQU5HRTsKKyAgICBkZXYtPm1lZGlhX2V2ZW50ID0gQ0RfTUVESUFfRVZFTlRfTk9fQ0hBTkdF
OworCisgICAgZGV2LT5jbGFpbV92ZXJzaW9uID0gMzsgLyogMCA6IG5vbmU7IDIsMyw1IDogU1BD
L01NQy14ICovCisKKyAgICBkZXYtPnZlbmRvciA9IGdfc3RyZHVwKGRldl9wYXJhbXMtPnZlbmRv
cik7CisgICAgZGV2LT5wcm9kdWN0ID0gZ19zdHJkdXAoZGV2X3BhcmFtcy0+cHJvZHVjdCk7Cisg
ICAgZGV2LT52ZXJzaW9uID0gZ19zdHJkdXAoZGV2X3BhcmFtcy0+dmVyc2lvbik7CisgICAgZGV2
LT5zZXJpYWwgPSBnX3N0cmR1cChkZXZfcGFyYW1zLT5zZXJpYWwpOworCisgICAgY2Rfc2NzaV9k
ZXZfc2Vuc2Vfc2V0X3Bvd2VyX29uKGRldik7CisKKyAgICBzdC0+bnVtX2x1bnMgKys7CisKKyAg
ICBTUElDRV9ERUJVRygiUmVhbGl6ZSBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCAiIGJzOiUiIEdf
R1VJTlQzMl9GT1JNQVQKKyAgICAgICAgICAgICAgICAiIFZSOlslc10gUFQ6WyVzXSB2ZXI6WyVz
XSBTTlslc10iLAorICAgICAgICAgICAgICAgIGx1biwgZGV2LT5ibG9ja19zaXplLCBkZXYtPnZl
bmRvciwKKyAgICAgICAgICAgICAgICBkZXYtPnByb2R1Y3QsIGRldi0+dmVyc2lvbiwgZGV2LT5z
ZXJpYWwpOworICAgIHJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2x1X21lZGlh
X3Jlc2V0KENkU2NzaUxVICpkZXYpCit7CisgICAgLyogbWVkaWFfZXZlbnQgaXMgbm90IHNldCBo
ZXJlLCBhcyBpdCBkZXBlbmRzIG9uIHRoZSBjb250ZXh0ICovCisgICAgZGV2LT5zdHJlYW0gPSBO
VUxMOworICAgIGRldi0+c2l6ZSA9IDA7CisgICAgZGV2LT5ibG9ja19zaXplID0gMDsKKyAgICBk
ZXYtPm51bV9ibG9ja3MgPSAwOworfQorCitpbnQgY2Rfc2NzaV9kZXZfbG9jayhDZFNjc2lUYXJn
ZXQgKnN0LCB1aW50MzJfdCBsdW4sIGdib29sZWFuIGxvY2spCit7CisgICAgQ2RTY3NpTFUgKmRl
djsKKworICAgIGlmICghY2Rfc2NzaV90YXJnZXRfbHVuX2xlZ2FsKHN0LCBsdW4pKSB7CisgICAg
ICAgIFNQSUNFX0VSUk9SKCJMb2NrLCBpbGxlZ2FsIGx1bjolIiBHX0dVSU5UMzJfRk9STUFULCBs
dW4pOworICAgICAgICByZXR1cm4gLTE7CisgICAgfQorICAgIGlmICghY2Rfc2NzaV90YXJnZXRf
bHVuX3JlYWxpemVkKHN0LCBsdW4pKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJMb2NrLCB1bnJl
YWxpemVkIGx1bjolIiBHX0dVSU5UMzJfRk9STUFULCBsdW4pOworICAgICAgICByZXR1cm4gLTE7
CisgICAgfQorICAgIGRldiA9ICZzdC0+dW5pdHNbbHVuXTsKKyAgICBkZXYtPnByZXZlbnRfbWVk
aWFfcmVtb3ZhbCA9IGxvY2s7CisgICAgU1BJQ0VfREVCVUcoImx1bjolIiBHX0dVSU5UMzJfRk9S
TUFUICIlc2xvY2siLCBsdW4sIGxvY2sgPyAidW4iIDoiIik7CisgICAgcmV0dXJuIDA7Cit9CisK
K3N0YXRpYyB2b2lkIGNkX3Njc2lfbHVfbG9hZChDZFNjc2lMVSAqZGV2LAorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGNvbnN0IENkU2NzaU1lZGlhUGFyYW1ldGVycyAqbWVkaWFfcGFyYW1z
KQoreworICAgIGlmIChtZWRpYV9wYXJhbXMgIT0gTlVMTCkgeworICAgICAgICBkZXYtPm1lZGlh
X2V2ZW50ID0gQ0RfTUVESUFfRVZFTlRfTkVXX01FRElBOworICAgICAgICBkZXYtPnN0cmVhbSA9
IG1lZGlhX3BhcmFtcy0+c3RyZWFtOworICAgICAgICBkZXYtPnNpemUgPSBtZWRpYV9wYXJhbXMt
PnNpemU7CisgICAgICAgIGRldi0+YmxvY2tfc2l6ZSA9IG1lZGlhX3BhcmFtcy0+YmxvY2tfc2l6
ZTsKKyAgICAgICAgZGV2LT5udW1fYmxvY2tzID0gbWVkaWFfcGFyYW1zLT5zaXplIC8gbWVkaWFf
cGFyYW1zLT5ibG9ja19zaXplOworICAgIH0gZWxzZSB7CisgICAgICAgIGRldi0+bWVkaWFfZXZl
bnQgPSBDRF9NRURJQV9FVkVOVF9NRURJQV9SRU1PVkFMOworICAgICAgICBjZF9zY3NpX2x1X21l
ZGlhX3Jlc2V0KGRldik7CisgICAgfQorICAgIGRldi0+bG9hZGVkID0gVFJVRTsKK30KKworc3Rh
dGljIHZvaWQgY2Rfc2NzaV9sdV91bmxvYWQoQ2RTY3NpTFUgKmRldikKK3sKKyAgICBkZXYtPm1l
ZGlhX2V2ZW50ID0gQ0RfTUVESUFfRVZFTlRfTUVESUFfUkVNT1ZBTDsKKyAgICBjZF9zY3NpX2x1
X21lZGlhX3Jlc2V0KGRldik7CisgICAgZGV2LT5sb2FkZWQgPSBGQUxTRTsKK30KKworaW50IGNk
X3Njc2lfZGV2X2xvYWQoQ2RTY3NpVGFyZ2V0ICpzdCwgdWludDMyX3QgbHVuLAorICAgICAgICAg
ICAgICAgICAgICAgY29uc3QgQ2RTY3NpTWVkaWFQYXJhbWV0ZXJzICptZWRpYV9wYXJhbXMpCit7
CisgICAgQ2RTY3NpTFUgKmRldjsKKworICAgIGlmICghY2Rfc2NzaV90YXJnZXRfbHVuX2xlZ2Fs
KHN0LCBsdW4pKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJMb2FkLCBpbGxlZ2FsIGx1bjolIiBH
X0dVSU5UMzJfRk9STUFULCBsdW4pOworICAgICAgICByZXR1cm4gLTE7CisgICAgfQorICAgIGlm
ICghY2Rfc2NzaV90YXJnZXRfbHVuX3JlYWxpemVkKHN0LCBsdW4pKSB7CisgICAgICAgIFNQSUNF
X0VSUk9SKCJMb2FkLCB1bnJlYWxpemVkIGx1bjolIiBHX0dVSU5UMzJfRk9STUFULCBsdW4pOwor
ICAgICAgICByZXR1cm4gLTE7CisgICAgfQorICAgIGRldiA9ICZzdC0+dW5pdHNbbHVuXTsKKwor
ICAgIGNkX3Njc2lfbHVfbG9hZChkZXYsIG1lZGlhX3BhcmFtcyk7CisgICAgZGV2LT5wb3dlcl9j
b25kID0gQ0RfU0NTSV9QT1dFUl9BQ1RJVkU7CisgICAgZGV2LT5wb3dlcl9ldmVudCA9IENEX1BP
V0VSX0VWRU5UX0NIQU5HRV9TVUNDRVNTOworCisgICAgY2Rfc2NzaV9kZXZfc2Vuc2Vfc2V0KGRl
diwgJnNlbnNlX2NvZGVfTUVESVVNX0NIQU5HRUQpOworCisgICAgU1BJQ0VfREVCVUcoIkxvYWQg
bHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQgIiBzaXplOiUiIEdfR1VJTlQ2NF9GT1JNQVQKKyAgICAg
ICAgICAgICAgICAiIGJsa19zejolIiBHX0dVSU5UMzJfRk9STUFUICIgbnVtX2Jsb2NrczolIiBH
X0dVSU5UMzJfRk9STUFULAorICAgICAgICAgICAgICAgIGx1biwgZGV2LT5zaXplLCBkZXYtPmJs
b2NrX3NpemUsIGRldi0+bnVtX2Jsb2Nrcyk7CisgICAgcmV0dXJuIDA7Cit9CisKK2ludCBjZF9z
Y3NpX2Rldl9nZXRfaW5mbyhDZFNjc2lUYXJnZXQgKnN0LCB1aW50MzJfdCBsdW4sIENkU2NzaURl
dmljZUluZm8gKmx1bl9pbmZvKQoreworICAgIENkU2NzaUxVICpkZXY7CisKKyAgICBpZiAoIWNk
X3Njc2lfdGFyZ2V0X2x1bl9sZWdhbChzdCwgbHVuKSkgeworICAgICAgICBTUElDRV9FUlJPUigi
TG9hZCwgaWxsZWdhbCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCwgbHVuKTsKKyAgICAgICAgcmV0
dXJuIC0xOworICAgIH0KKyAgICBpZiAoIWNkX3Njc2lfdGFyZ2V0X2x1bl9yZWFsaXplZChzdCwg
bHVuKSkgeworICAgICAgICBTUElDRV9FUlJPUigiTG9hZCwgdW5yZWFsaXplZCBsdW46JSIgR19H
VUlOVDMyX0ZPUk1BVCwgbHVuKTsKKyAgICAgICAgcmV0dXJuIC0xOworICAgIH0KKyAgICBkZXYg
PSAmc3QtPnVuaXRzW2x1bl07CisKKyAgICBsdW5faW5mby0+c3RhcnRlZCA9IGRldi0+cG93ZXJf
Y29uZCA9PSBDRF9TQ1NJX1BPV0VSX0FDVElWRTsKKyAgICBsdW5faW5mby0+bG9ja2VkID0gZGV2
LT5wcmV2ZW50X21lZGlhX3JlbW92YWw7CisgICAgbHVuX2luZm8tPmxvYWRlZCA9IGRldi0+bG9h
ZGVkOworCisgICAgbHVuX2luZm8tPnBhcmFtZXRlcnMudmVuZG9yID0gZGV2LT52ZW5kb3I7Cisg
ICAgbHVuX2luZm8tPnBhcmFtZXRlcnMucHJvZHVjdCA9IGRldi0+cHJvZHVjdDsKKyAgICBsdW5f
aW5mby0+cGFyYW1ldGVycy52ZXJzaW9uID0gZGV2LT52ZXJzaW9uOworICAgIGx1bl9pbmZvLT5w
YXJhbWV0ZXJzLnNlcmlhbCA9IGRldi0+c2VyaWFsOworCisgICAgcmV0dXJuIDA7Cit9CisKK2lu
dCBjZF9zY3NpX2Rldl91bmxvYWQoQ2RTY3NpVGFyZ2V0ICpzdCwgdWludDMyX3QgbHVuKQorewor
ICAgIENkU2NzaUxVICpkZXY7CisKKyAgICBpZiAoIWNkX3Njc2lfdGFyZ2V0X2x1bl9sZWdhbChz
dCwgbHVuKSkgeworICAgICAgICBTUElDRV9FUlJPUigiVW5sb2FkLCBpbGxlZ2FsIGx1bjolIiBH
X0dVSU5UMzJfRk9STUFULCBsdW4pOworICAgICAgICByZXR1cm4gLTE7CisgICAgfQorICAgIGlm
ICghY2Rfc2NzaV90YXJnZXRfbHVuX3JlYWxpemVkKHN0LCBsdW4pKSB7CisgICAgICAgIFNQSUNF
X0VSUk9SKCJVbmxvYWQsIHVucmVhbGl6ZWQgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQsIGx1bik7
CisgICAgICAgIHJldHVybiAtMTsKKyAgICB9CisgICAgZGV2ID0gJnN0LT51bml0c1tsdW5dOwor
ICAgIGlmICghZGV2LT5sb2FkZWQpIHsKKyAgICAgICAgU1BJQ0VfRVJST1IoIlVubG9hZCwgbHVu
OiUiIEdfR1VJTlQzMl9GT1JNQVQgIiBub3QgbG9hZGVkIHlldCIsIGx1bik7CisgICAgICAgIHJl
dHVybiAwOworICAgIH0KKyAgICBpZiAoZGV2LT5wcmV2ZW50X21lZGlhX3JlbW92YWwpIHsKKyAg
ICAgICAgU1BJQ0VfRVJST1IoIlVubG9hZCwgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQgIiBwcmV2
ZW50X21lZGlhX3JlbW92YWwgc2V0IiwgbHVuKTsKKyAgICAgICAgcmV0dXJuIC0xOworICAgIH0K
KworICAgIGNkX3Njc2lfbHVfdW5sb2FkKGRldik7CisgICAgZGV2LT5wb3dlcl9jb25kID0gQ0Rf
U0NTSV9QT1dFUl9TVE9QUEVEOworICAgIGRldi0+cG93ZXJfZXZlbnQgPSBDRF9QT1dFUl9FVkVO
VF9DSEFOR0VfU1VDQ0VTUzsKKworICAgIGNkX3Njc2lfZGV2X3NlbnNlX3NldChkZXYsICZzZW5z
ZV9jb2RlX1VBX05PX01FRElVTSk7CisKKyAgICBTUElDRV9ERUJVRygiVW5sb2FkIGx1bjolIiBH
X0dVSU5UMzJfRk9STUFULCBsdW4pOworICAgIHJldHVybiAwOworfQorCitpbnQgY2Rfc2NzaV9k
ZXZfdW5yZWFsaXplKENkU2NzaVRhcmdldCAqc3QsIHVpbnQzMl90IGx1bikKK3sKKyAgICBDZFNj
c2lMVSAqZGV2OworCisgICAgaWYgKCFjZF9zY3NpX3RhcmdldF9sdW5fbGVnYWwoc3QsIGx1bikp
IHsKKyAgICAgICAgU1BJQ0VfRVJST1IoIlVucmVhbGl6ZSwgaWxsZWdhbCBsdW46JSIgR19HVUlO
VDMyX0ZPUk1BVCwgbHVuKTsKKyAgICAgICAgcmV0dXJuIC0xOworICAgIH0KKyAgICBpZiAoIWNk
X3Njc2lfdGFyZ2V0X2x1bl9yZWFsaXplZChzdCwgbHVuKSkgeworICAgICAgICBTUElDRV9FUlJP
UigiVW5yZWFsaXplLCBhYnNlbnQgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQsIGx1bik7CisgICAg
ICAgIHJldHVybiAtMTsKKyAgICB9CisgICAgZGV2ID0gJnN0LT51bml0c1tsdW5dOworCisgICAg
aWYgKGRldi0+dmVuZG9yICE9IE5VTEwpIHsKKyAgICAgICAgZnJlZShkZXYtPnZlbmRvcik7Cisg
ICAgICAgIGRldi0+dmVuZG9yID0gTlVMTDsKKyAgICB9CisgICAgaWYgKGRldi0+cHJvZHVjdCAh
PSBOVUxMKSB7CisgICAgICAgIGZyZWUoZGV2LT5wcm9kdWN0KTsKKyAgICAgICAgZGV2LT5wcm9k
dWN0ID0gTlVMTDsKKyAgICB9CisgICAgaWYgKGRldi0+dmVyc2lvbiAhPSBOVUxMKSB7CisgICAg
ICAgIGZyZWUoZGV2LT52ZXJzaW9uKTsKKyAgICAgICAgZGV2LT52ZXJzaW9uID0gTlVMTDsKKyAg
ICB9CisgICAgaWYgKGRldi0+c2VyaWFsICE9IE5VTEwpIHsKKyAgICAgICAgZnJlZShkZXYtPnNl
cmlhbCk7CisgICAgICAgIGRldi0+c2VyaWFsID0gTlVMTDsKKyAgICB9CisKKyAgICBkZXYtPmxv
YWRlZCA9IEZBTFNFOworICAgIGRldi0+cmVhbGl6ZWQgPSBGQUxTRTsKKyAgICBkZXYtPnBvd2Vy
X2NvbmQgPSBDRF9TQ1NJX1BPV0VSX1NUT1BQRUQ7CisKKyAgICBzdC0+bnVtX2x1bnMgLS07CisK
KyAgICBTUElDRV9ERUJVRygiVW5yZWFsaXplIGx1bjolIiBHX0dVSU5UMzJfRk9STUFULCBsdW4p
OworICAgIHJldHVybiAwOworfQorCitpbnQgY2Rfc2NzaV9kZXZfcmVzZXQoQ2RTY3NpVGFyZ2V0
ICpzdCwgdWludDMyX3QgbHVuKQoreworICAgIENkU2NzaUxVICpkZXY7CisKKyAgICBpZiAoIWNk
X3Njc2lfdGFyZ2V0X2x1bl9sZWdhbChzdCwgbHVuKSkgeworICAgICAgICBTUElDRV9FUlJPUigi
RGV2aWNlIHJlc2V0LCBpbGxlZ2FsIGx1bjolIiBHX0dVSU5UMzJfRk9STUFULCBsdW4pOworICAg
ICAgICByZXR1cm4gLTE7CisgICAgfQorICAgIGlmICghY2Rfc2NzaV90YXJnZXRfbHVuX3JlYWxp
emVkKHN0LCBsdW4pKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJEZXZpY2UgcmVzZXQsIGFic2Vu
dCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCwgbHVuKTsKKyAgICAgICAgcmV0dXJuIC0xOworICAg
IH0KKyAgICBkZXYgPSAmc3QtPnVuaXRzW2x1bl07CisKKyAgICAvKiBpZiB3ZSByZXNldCB0aGUg
J3ByZXZlbnQnIGZsYWcgd2UgY2FuJ3QgY3JlYXRlCisgICAgICogdGhlIHVuaXQgdGhhdCBpcyBs
b2NrZWQgZnJvbSB0aGUgYmVnaW5uaW5nLCBzbworICAgICAqIHdlIGtlZXAgdGhpcyBmbGFnIGFz
IHBlcnNpc3RlbnQgb3ZlciByZXNldHMKKyAgICAgKi8KKyAgICAvKiBkZXYtPnByZXZlbnRfbWVk
aWFfcmVtb3ZhbCA9IEZBTFNFOyAqLworICAgIGRldi0+cG93ZXJfY29uZCA9IENEX1NDU0lfUE9X
RVJfQUNUSVZFOworICAgIGRldi0+cG93ZXJfZXZlbnQgPSBDRF9QT1dFUl9FVkVOVF9DSEFOR0Vf
U1VDQ0VTUzsKKyAgICBjZF9zY3NpX2Rldl9zZW5zZV9zZXRfcG93ZXJfb24oZGV2KTsKKworICAg
IFNQSUNFX0RFQlVHKCJEZXZpY2UgcmVzZXQgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQsIGx1bik7
CisgICAgcmV0dXJuIDA7Cit9CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfdGFyZ2V0X2RvX3Jlc2V0
KENkU2NzaVRhcmdldCAqc3QpCit7CisgICAgdWludDMyX3QgbHVuOworCisgICAgZm9yIChsdW4g
PSAwOyBsdW4gPCBzdC0+bWF4X2x1bnM7IGx1bisrKSB7CisgICAgICAgIGlmIChzdC0+dW5pdHNb
bHVuXS5yZWFsaXplZCkgeworICAgICAgICAgICAgY2Rfc2NzaV9kZXZfcmVzZXQoc3QsIGx1bik7
CisgICAgICAgIH0KKyAgICB9CisKKyAgICBTUElDRV9ERUJVRygiVGFyZ2V0IHJlc2V0IGNvbXBs
ZXRlIik7CisgICAgc3QtPnN0YXRlID0gQ0RfU0NTSV9UR1RfU1RBVEVfUlVOTklORzsKKyAgICBj
ZF9zY3NpX3RhcmdldF9yZXNldF9jb21wbGV0ZShzdC0+dXNlcl9kYXRhKTsKK30KKworaW50IGNk
X3Njc2lfdGFyZ2V0X3Jlc2V0KENkU2NzaVRhcmdldCAqc3QpCit7CisgICAgaWYgKHN0LT5zdGF0
ZSA9PSBDRF9TQ1NJX1RHVF9TVEFURV9SRVNFVCkgeworICAgICAgICBTUElDRV9ERUJVRygiVGFy
Z2V0IGFscmVhZHkgaW4gcmVzZXQiKTsKKyAgICAgICAgcmV0dXJuIC0xOworICAgIH0KKworICAg
IHN0LT5zdGF0ZSA9IENEX1NDU0lfVEdUX1NUQVRFX1JFU0VUOworCisgICAgaWYgKHN0LT5jdXJf
cmVxICE9IE5VTEwpIHsKKyAgICAgICAgY2Rfc2NzaV9kZXZfcmVxdWVzdF9jYW5jZWwoc3QsIHN0
LT5jdXJfcmVxKTsKKyAgICAgICAgaWYgKHN0LT5jdXJfcmVxICE9IE5VTEwpIHsKKyAgICAgICAg
ICAgIFNQSUNFX0RFQlVHKCJUYXJnZXQgcmVzZXQgaW4gcHJvZ3Jlc3MuLi4iKTsKKyAgICAgICAg
ICAgIHJldHVybiAwOworICAgICAgICB9CisgICAgfQorCisgICAgY2Rfc2NzaV90YXJnZXRfZG9f
cmVzZXQoc3QpOworICAgIHJldHVybiAwOworfQorCitDZFNjc2lSZXFTdGF0ZSBjZF9zY3NpX2dl
dF9yZXFfc3RhdGUoQ2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAgIHJldHVybiByZXEtPnJlcV9z
dGF0ZTsKK30KKworc3RhdGljIHZvaWQgc3RycGFkY3B5KGNoYXIgKmJ1ZiwgaW50IGJ1Zl9zaXpl
LCBjb25zdCBjaGFyICpzdHIsIGNoYXIgcGFkKQoreworICAgIGludCBsZW4gPSBzdHJubGVuKHN0
ciwgYnVmX3NpemUpOworICAgIG1lbWNweShidWYsIHN0ciwgbGVuKTsKKyAgICBtZW1zZXQoYnVm
ICsgbGVuLCBwYWQsIGJ1Zl9zaXplIC0gbGVuKTsKK30KKworLyogU0NTSSBDREIgKi8KKworc3Rh
dGljIGludCBzY3NpX2NkYl9sZW5ndGgodWludDhfdCAqY2RiKQoreworICAgIGludCBjZGJfbGVu
OworCisgICAgc3dpdGNoIChjZGJbMF0gPj4gNSkgeworICAgIGNhc2UgMDoKKyAgICAgICAgY2Ri
X2xlbiA9IDY7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgMToKKyAgICBjYXNlIDI6CisgICAg
ICAgIGNkYl9sZW4gPSAxMDsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSA0OgorICAgICAgICBj
ZGJfbGVuID0gMTY7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgNToKKyAgICAgICAgY2RiX2xl
biA9IDEyOworICAgICAgICBicmVhazsKKyAgICBkZWZhdWx0OgorICAgICAgICBjZGJfbGVuID0g
LTE7CisgICAgfQorICAgIHJldHVybiBjZGJfbGVuOworfQorCitzdGF0aWMgdWludDY0X3Qgc2Nz
aV9jZGJfbGJhKHVpbnQ4X3QgKmNkYiwgaW50IGNkYl9sZW4pCit7CisgICAgdWludDY0X3QgbGJh
OworCisgICAgc3dpdGNoIChjZGJfbGVuKSB7CisgICAgY2FzZSA2OgorICAgICAgICBsYmEgPSAo
KCh1aW50NjRfdCkoY2RiWzFdICYgMHgxZikpIDw8IDE2KSB8CisgICAgICAgICAgICAgICgoKHVp
bnQ2NF90KWNkYlsyXSkgPDwgOCkgfAorICAgICAgICAgICAgICAgKCh1aW50NjRfdCljZGJbM10p
OworICAgICAgICBicmVhazsKKyAgICBjYXNlIDEwOgorICAgIGNhc2UgMTI6CisgICAgICAgIGxi
YSA9ICgoKHVpbnQ2NF90KWNkYlsyXSkgPDwgMjQpIHwKKyAgICAgICAgICAgICAgKCgodWludDY0
X3QpY2RiWzNdKSA8PCAxNikgfAorICAgICAgICAgICAgICAoKCh1aW50NjRfdCljZGJbNF0pIDw8
IDgpICB8CisgICAgICAgICAgICAgICAoKHVpbnQ2NF90KWNkYls1XSk7CisgICAgICAgIGJyZWFr
OworICAgIGNhc2UgMTY6CisgICAgICAgIGxiYSA9ICgoKHVpbnQ2NF90KWNkYlsyXSkgPDwgNTYp
IHwKKyAgICAgICAgICAgICAgKCgodWludDY0X3QpY2RiWzNdKSA8PCA0OCkgfAorICAgICAgICAg
ICAgICAoKCh1aW50NjRfdCljZGJbNF0pIDw8IDQwKSB8CisgICAgICAgICAgICAgICgoKHVpbnQ2
NF90KWNkYls1XSkgPDwgMzIpIHwKKyAgICAgICAgICAgICAgKCgodWludDY0X3QpY2RiWzZdKSA8
PCAyNCkgfAorICAgICAgICAgICAgICAoKCh1aW50NjRfdCljZGJbN10pIDw8IDE2KSB8CisgICAg
ICAgICAgICAgICgoKHVpbnQ2NF90KWNkYls4XSkgPDwgOCkgIHwKKyAgICAgICAgICAgICAgICgo
dWludDY0X3QpY2RiWzldKTsKKyAgICAgICAgYnJlYWs7CisgICAgZGVmYXVsdDoKKyAgICAgICAg
bGJhID0gMDsKKyAgICB9CisgICAgcmV0dXJuIGxiYTsKK30KKworc3RhdGljIHVpbnQzMl90IHNj
c2lfY2RiX3hmZXJfbGVuZ3RoKHVpbnQ4X3QgKmNkYiwgaW50IGNkYl9sZW4pCit7CisgICAgdWlu
dDMyX3QgbGVuOworCisgICAgc3dpdGNoIChjZGJfbGVuKSB7CisgICAgY2FzZSA2OgorICAgICAg
ICBsZW4gPSAodWludDMyX3QpY2RiWzRdOworICAgICAgICBpZiAobGVuID09IDApCisgICAgICAg
ICAgICBsZW4gPSAyNTY7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgMTA6CisgICAgICAgIGxl
biA9ICgoKHVpbnQzMl90KWNkYls3XSkgPDwgOCkgfAorICAgICAgICAgICAgICAgKCh1aW50MzJf
dCljZGJbOF0pOworICAgICAgICBicmVhazsKKyAgICBjYXNlIDEyOgorICAgICAgICBsZW4gPSAo
KCh1aW50MzJfdCljZGJbNl0pIDw8IDI0KSB8CisgICAgICAgICAgICAgICgoKHVpbnQzMl90KWNk
Yls3XSkgPDwgMTYpIHwKKyAgICAgICAgICAgICAgKCgodWludDMyX3QpY2RiWzhdKSA8PCA4KSAg
fAorICAgICAgICAgICAgICAgKCh1aW50MzJfdCljZGJbOV0pOworICAgICAgICBicmVhazsKKyAg
ICBjYXNlIDE2OgorICAgICAgICBsZW4gPSAoKCh1aW50MzJfdCljZGJbMTBdKSA8PCAyNCkgfAor
ICAgICAgICAgICAgICAoKCh1aW50MzJfdCljZGJbMTFdKSA8PCAxNikgfAorICAgICAgICAgICAg
ICAoKCh1aW50MzJfdCljZGJbMTJdKSA8PCA4KSAgfAorICAgICAgICAgICAgICAgKCh1aW50MzJf
dCljZGJbMTNdKTsKKyAgICAgICAgYnJlYWs7CisgICAgZGVmYXVsdDoKKyAgICAgICAgbGVuID0g
MDsKKyAgICAgICAgYnJlYWs7CisgICAgfQorICAgIHJldHVybiBsZW47Cit9CisKKy8qIFNDU0kg
Y29tbWFuZHMgKi8KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRfdGVzdF91bml0X3JlYWR5KENk
U2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICByZXEtPnhmZXJfZGlyID0g
U0NTSV9YRkVSX05PTkU7CisgICAgcmVxLT5pbl9sZW4gPSAwOworCisgICAgaWYgKGRldi0+bG9h
ZGVkKSB7CisgICAgICAgIGlmIChkZXYtPnBvd2VyX2NvbmQgIT0gQ0RfU0NTSV9QT1dFUl9TVE9Q
UEVEKSB7CisgICAgICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsK
KyAgICAgICAgfSBlbHNlIHsKKyAgICAgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNr
X2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX0lOSVRfQ01EX1JFUVVJUkVEKTsKKyAgICAgICAg
fQorICAgIH0gZWxzZSB7CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQo
ZGV2LCByZXEsICZzZW5zZV9jb2RlX05PVF9SRUFEWV9OT19NRURJVU0pOworICAgIH0KK30KKwor
c3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRfcmVxdWVzdF9zZW5zZShDZFNjc2lMVSAqZGV2LCBDZFNj
c2lSZXF1ZXN0ICpyZXEpCit7CisgICAgcmVxLT54ZmVyX2RpciA9IFNDU0lfWEZFUl9GUk9NX0RF
VjsKKworICAgIHJlcS0+cmVxX2xlbiA9IHJlcS0+Y2RiWzRdOworICAgIHJlcS0+aW5fbGVuID0g
KHJlcS0+cmVxX2xlbiA8IHNpemVvZihkZXYtPmZpeGVkX3NlbnNlKSkgPworICAgICAgICAgICAg
ICAgICAgIHJlcS0+cmVxX2xlbiA6IHNpemVvZihkZXYtPmZpeGVkX3NlbnNlKTsKKworICAgIGlm
IChkZXYtPnNob3J0X3NlbnNlLmtleSAhPSBOT19TRU5TRSkgeworICAgICAgICBTUElDRV9ERUJV
RygiJXMsIGx1bjolIiBHX0dVSU5UMzJfRk9STUFUICIgcmVwb3J0ZWQgc2Vuc2U6IDB4JTAyeCAl
MDJ4ICUwMnggLSAlcywgJXMiLAorICAgICAgICAgICAgICAgICAgICBfX0ZVTkNUSU9OX18sIHJl
cS0+bHVuLAorICAgICAgICAgICAgICAgICAgICBkZXYtPnNob3J0X3NlbnNlLmtleSwgZGV2LT5z
aG9ydF9zZW5zZS5hc2MsIGRldi0+c2hvcnRfc2Vuc2UuYXNjcSwKKyAgICAgICAgICAgICAgICAg
ICAgY2Rfc2NzaV9zZW5zZV9rZXlfZGVzY3IoZGV2LT5zaG9ydF9zZW5zZS5rZXkpLAorICAgICAg
ICAgICAgICAgICAgICBkZXYtPnNob3J0X3NlbnNlLmRlc2NyKTsKKyAgICB9CisgICAgbWVtY3B5
KHJlcS0+YnVmLCBkZXYtPmZpeGVkX3NlbnNlLCBzaXplb2YoZGV2LT5maXhlZF9zZW5zZSkpOwor
ICAgIGNkX3Njc2lfZGV2X3NlbnNlX3Jlc2V0KGRldik7IC8qIGNsZWFyIHJlcG9ydGVkIHNlbnNl
ICovCisKKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworc3Rh
dGljIHZvaWQgY2Rfc2NzaV9jbWRfcmVwb3J0X2x1bnMoQ2RTY3NpVGFyZ2V0ICpzdCwgQ2RTY3Np
TFUgKmRldiwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENkU2NzaVJlcXVl
c3QgKnJlcSkKK3sKKyAgICB1aW50OF90ICpvdXRfYnVmID0gcmVxLT5idWY7CisgICAgdWludDMy
X3QgbnVtX2x1bnMgPSBzdC0+bnVtX2x1bnM7CisgICAgdWludDMyX3QgYnVmbGVuID0gODsgLyog
aGVhZGVyIGxlbmd0aCAqLworICAgIHVpbnQzMl90IGx1bjsKKworICAgIHJlcS0+cmVxX2xlbiA9
IHNjc2lfY2RiX3hmZXJfbGVuZ3RoKHJlcS0+Y2RiLCAxMik7CisgICAgcmVxLT54ZmVyX2RpciA9
IFNDU0lfWEZFUl9GUk9NX0RFVjsKKworICAgIGlmIChyZXEtPmNkYlswXSA9PSAweDAxKSB7Cisg
ICAgICAgIC8qIG9ubHkgd2VsbCBrbm93biBsb2dpY2FsIHVuaXRzICovCisgICAgICAgIG51bV9s
dW5zID0gMDsKKyAgICB9CisKKyAgICBvdXRfYnVmWzBdID0gKHVpbnQ4X3QpKG51bV9sdW5zID4+
IDI0KTsKKyAgICBvdXRfYnVmWzFdID0gKHVpbnQ4X3QpKG51bV9sdW5zID4+IDE2KTsKKyAgICBv
dXRfYnVmWzJdID0gKHVpbnQ4X3QpKG51bV9sdW5zID4+IDgpOworICAgIG91dF9idWZbM10gPSAo
dWludDhfdCkobnVtX2x1bnMpOworICAgIG1lbXNldCgmb3V0X2J1Zls0XSwgMCwgNCk7CisKKyAg
ICBpZiAobnVtX2x1bnMgPiAwKSB7CisgICAgICAgIGZvciAobHVuID0gMDsgbHVuIDwgbnVtX2x1
bnM7IGx1bisrKSB7CisgICAgICAgICAgICBpZiAoc3QtPnVuaXRzW2x1bl0ucmVhbGl6ZWQpIHsK
KyAgICAgICAgICAgICAgICBvdXRfYnVmW2J1ZmxlbisrXSA9ICh1aW50OF90KShudW1fbHVucyA+
PiAyNCk7CisgICAgICAgICAgICAgICAgb3V0X2J1ZltidWZsZW4rK10gPSAodWludDhfdCkobnVt
X2x1bnMgPj4gMTYpOworICAgICAgICAgICAgICAgIG91dF9idWZbYnVmbGVuKytdID0gKHVpbnQ4
X3QpKG51bV9sdW5zID4+IDgpOworICAgICAgICAgICAgICAgIG91dF9idWZbYnVmbGVuKytdID0g
KHVpbnQ4X3QpKG51bV9sdW5zKTsKKyAgICAgICAgICAgICAgICBtZW1zZXQoJm91dF9idWZbYnVm
bGVuXSwgMCwgNCk7CisgICAgICAgICAgICAgICAgYnVmbGVuICs9IDQ7CisgICAgICAgICAgICB9
CisgICAgICAgIH0KKyAgICB9CisKKyAgICByZXEtPmluX2xlbiA9IGJ1ZmxlbjsKKyAgICBjZF9z
Y3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworI2RlZmluZSBTQ1NJX01BWF9J
TlFVSVJZX0xFTiAgICAgICAgMjU2CisjZGVmaW5lIFNDU0lfTUFYX01PREVfTEVOICAgICAgICAg
ICAyNTYKKworc3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRfaW5xdWlyeV92cGRfbm9fbHVuKENkU2Nz
aUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICB1aW50MzJfdCBwZXJpZl9xdWFsKQoreworICAgIHVpbnQ4X3QgKm91
dGJ1ZiA9IHJlcS0+YnVmOworICAgIHVpbnQ4X3QgcGFnZV9jb2RlID0gcmVxLT5jZGJbMl07Cisg
ICAgdWludDMyX3QgcmVzcF9sZW4gPSA0OworCisgICAgb3V0YnVmWzBdID0gKHBlcmlmX3F1YWwg
PDwgNSkgfCBUWVBFX1JPTTsKKyAgICBvdXRidWZbMV0gPSBwYWdlX2NvZGUgOyAvKiB0aGlzIHBh
Z2UgKi8KKyAgICBvdXRidWZbMl0gPSAweDAwOyAvKiBwYWdlIGxlbmd0aCBNU0IgKi8KKyAgICBv
dXRidWZbM10gPSAweDAwOyAvKiBwYWdlIGxlbmd0aCBMU0IgLSBubyBtb3JlIGRhdGEgKi8KKwor
ICAgIHJlcS0+aW5fbGVuID0gKHJlcS0+cmVxX2xlbiA8IHJlc3BfbGVuKSA/IHJlcS0+cmVxX2xl
biA6IHJlc3BfbGVuOworCisgICAgU1BJQ0VfREVCVUcoImlucXVpcnlfdnBkLCB1bnN1cHBvcnRl
ZCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVAorICAgICAgICAgICAgICAgICIgcGVyaWZfcXVhbDow
eCV4IHJlc3BfbGVuOiAlIiBHX0dVSU5UNjRfRk9STUFULAorICAgICAgICAgICAgICAgIHJlcS0+
bHVuLCBwZXJpZl9xdWFsLCByZXEtPmluX2xlbik7CisKKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0
ZV9nb29kKGRldiwgcmVxKTsKK30KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRfaW5xdWlyeV92
cGQoQ2RTY3NpTFUgKmRldiwgQ2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAgIHVpbnQ4X3QgKm91
dGJ1ZiA9IHJlcS0+YnVmOworICAgIHVpbnQ4X3QgcGFnZV9jb2RlID0gcmVxLT5jZGJbMl07Cisg
ICAgaW50IGJ1ZmxlbiA9IDQ7CisgICAgaW50IHN0YXJ0ID0gNDsKKworICAgIG91dGJ1ZlswXSA9
IFRZUEVfUk9NOworICAgIG91dGJ1ZlsxXSA9IHBhZ2VfY29kZSA7IC8qIHRoaXMgcGFnZSAqLwor
ICAgIG91dGJ1ZlsyXSA9IDB4MDA7IC8qIHBhZ2UgbGVuZ3RoIE1TQiAqLworICAgIG91dGJ1Zlsz
XSA9IDB4MDA7IC8qIHBhZ2UgbGVuZ3RoIExTQiwgdG8gd3JpdGUgbGF0ZXIgKi8KKworICAgIHN3
aXRjaCAocGFnZV9jb2RlKSB7CisgICAgY2FzZSAweDAwOiAvKiBTdXBwb3J0ZWQgcGFnZSBjb2Rl
cywgbWFuZGF0b3J5ICovCisgICAgeworICAgICAgICBvdXRidWZbYnVmbGVuKytdID0gMHgwMDsg
Ly8gbGlzdCBvZiBzdXBwb3J0ZWQgcGFnZXMgKHRoaXMgcGFnZSkKKyAgICAgICAgaWYgKGRldi0+
c2VyaWFsKSB7CisgICAgICAgICAgICBvdXRidWZbYnVmbGVuKytdID0gMHg4MDsgLy8gdW5pdCBz
ZXJpYWwgbnVtYmVyCisgICAgICAgIH0KKyAgICAgICAgb3V0YnVmW2J1ZmxlbisrXSA9IDB4ODM7
IC8vIGRldmljZSBpZGVudGlmaWNhdGlvbgorCisgICAgICAgIFNQSUNFX0RFQlVHKCJJbnF1aXJ5
IEVWUERbU3VwcG9ydGVkIHBhZ2VzXSBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVAorICAgICAgICAg
ICAgICAgICAgICAiIHJlcV9sZW46ICUiIEdfR1VJTlQ2NF9GT1JNQVQgIiByZXNwX2xlbjogJWQi
LAorICAgICAgICAgICAgICAgICAgICByZXEtPmx1biwgcmVxLT5yZXFfbGVuLCBidWZsZW4pOwor
ICAgICAgICBicmVhazsKKyAgICB9CisgICAgY2FzZSAweDgwOiAvKiBEZXZpY2Ugc2VyaWFsIG51
bWJlciwgb3B0aW9uYWwgKi8KKyAgICB7CisgICAgICAgIGludCBzZXJpYWxfbGVuOworCisgICAg
ICAgIHNlcmlhbF9sZW4gPSBzdHJsZW4oZGV2LT5zZXJpYWwpOworICAgICAgICBpZiAoc2VyaWFs
X2xlbiA+IDM2KSB7CisgICAgICAgICAgICBzZXJpYWxfbGVuID0gMzY7CisgICAgICAgIH0KKyAg
ICAgICAgbWVtY3B5KG91dGJ1ZitidWZsZW4sIGRldi0+c2VyaWFsLCBzZXJpYWxfbGVuKTsKKyAg
ICAgICAgYnVmbGVuICs9IHNlcmlhbF9sZW47CisKKyAgICAgICAgU1BJQ0VfREVCVUcoIklucXVp
cnkgRVZQRFtTZXJpYWwgbnVtXSBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVAorICAgICAgICAgICAg
ICAgICAgICAiIHJlcV9sZW46ICUiIEdfR1VJTlQ2NF9GT1JNQVQgIiByZXNwX2xlbjogJWQiLAor
ICAgICAgICAgICAgICAgICAgICByZXEtPmx1biwgcmVxLT5yZXFfbGVuLCBidWZsZW4pOworICAg
ICAgICBicmVhazsKKyAgICB9CisgICAgY2FzZSAweDgzOiAvKiBEZXZpY2UgaWRlbnRpZmljYXRp
b24gcGFnZSwgbWFuZGF0b3J5ICovCisgICAgeworICAgICAgICBpbnQgc2VyaWFsX2xlbiA9IHN0
cmxlbihkZXYtPnNlcmlhbCk7CisgICAgICAgIGludCBtYXhfbGVuID0gMjA7CisKKyAgICAgICAg
aWYgKHNlcmlhbF9sZW4gPiBtYXhfbGVuKSB7CisgICAgICAgICAgICBzZXJpYWxfbGVuID0gbWF4
X2xlbjsKKyAgICAgICAgfQorCisgICAgICAgIG91dGJ1ZltidWZsZW4rK10gPSAweDI7IC8vIEFT
Q0lJCisgICAgICAgIG91dGJ1ZltidWZsZW4rK10gPSAwOyAgIC8vIG5vdCBvZmZpY2lhbGx5IGFz
c2lnbmVkCisgICAgICAgIG91dGJ1ZltidWZsZW4rK10gPSAwOyAgIC8vIHJlc2VydmVkCisgICAg
ICAgIG91dGJ1ZltidWZsZW4rK10gPSBzZXJpYWxfbGVuOyAvLyBsZW5ndGggb2YgZGF0YSBmb2xs
b3dpbmcKKworICAgICAgICBtZW1jcHkob3V0YnVmK2J1ZmxlbiwgZGV2LT5zZXJpYWwsIHNlcmlh
bF9sZW4pOworICAgICAgICBidWZsZW4gKz0gc2VyaWFsX2xlbjsKKworICAgICAgICBTUElDRV9E
RUJVRygiSW5xdWlyeSBFVlBEW0RldmljZSBpZF0gbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQKKyAg
ICAgICAgICAgICAgICAgICAgIiByZXFfbGVuOiAlIiBHX0dVSU5UNjRfRk9STUFUICIgcmVzcF9s
ZW46ICVkIiwKKyAgICAgICAgICAgICAgICAgICAgcmVxLT5sdW4sIHJlcS0+cmVxX2xlbiwgYnVm
bGVuKTsKKyAgICAgICAgYnJlYWs7CisgICAgfQorCisgICAgZGVmYXVsdDoKKyAgICAgICAgY2Rf
c2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfSU5WQUxJ
RF9DREJfRklFTEQpOworICAgICAgICBTUElDRV9ERUJVRygiaW5xdWlyeV9zdGFuZGFyZCwgbHVu
OiUiIEdfR1VJTlQzMl9GT1JNQVQgIiBpbnZhbGlkIHBhZ2VfY29kZTogJTAyeCIsCisgICAgICAg
ICAgICAgICAgICAgIHJlcS0+bHVuLCAoaW50KXBhZ2VfY29kZSk7CisgICAgICAgIHJldHVybjsK
KyAgICB9CisKKyAgICAvKiBkb25lIHdpdGggRVZQRCAqLworICAgIGdfYXNzZXJ0KGJ1ZmxlbiAt
IHN0YXJ0IDw9IDI1NSk7CisgICAgb3V0YnVmWzNdID0gYnVmbGVuIC0gc3RhcnQ7IC8qIHBhZ2Ug
bGVuZ3RoIExTQiAqLworCisgICAgcmVxLT5pbl9sZW4gPSBidWZsZW47CisgICAgY2Rfc2NzaV9j
bWRfY29tcGxldGVfZ29vZChkZXYsIHJlcSk7Cit9CisKKyNkZWZpbmUgSU5RVUlSWV9TVEFOREFS
RF9MRU5fTUlOICAgICAgICAgICAgMzYKKyNkZWZpbmUgSU5RVUlSWV9TVEFOREFSRF9MRU4gICAg
ICAgICAgICAgICAgOTYKKyNkZWZpbmUgSU5RVUlSWV9TVEFOREFSRF9MRU5fTk9fVkVSICAgICAg
ICAgNTcKKworI2RlZmluZSBQRVJJRl9RVUFMSUZJRVJfQ09OTkVDVEVEICAgICAgICAgICAweDAw
CisjZGVmaW5lIFBFUklGX1FVQUxJRklFUl9OT1RfQ09OTkVDVEVEICAgICAgIDB4MDEKKyNkZWZp
bmUgUEVSSUZfUVVBTElGSUVSX1VOU1VQUE9SVEVEICAgICAgICAgMHgwMworCisjZGVmaW5lIElO
UVVJUllfUkVNT1ZBQkxFX01FRElVTSAgICAgICAgICAgIDB4ODAKKworI2RlZmluZSBJTlFVSVJZ
X1ZFUlNJT05fTk9ORSAgICAgICAgICAgICAgICAweDAwCisjZGVmaW5lIElOUVVJUllfVkVSU0lP
Tl9TUEMzICAgICAgICAgICAgICAgIDB4MDUKKworLyogYnl0ZSAzICovCisjZGVmaW5lIElOUVVJ
UllfUkVTUF9ISVNVUCAgICAgICAgICAgICAgICAgICgweDAxIDw8IDQpCisjZGVmaW5lIElOUVVJ
UllfUkVTUF9OT1JNX0FDQSAgICAgICAgICAgICAgICgweDAxIDw8IDUpCisjZGVmaW5lIElOUVVJ
UllfUkVTUF9EQVRBX0ZPUk1BVF9TUEMzICAgICAgIDB4MDIKKworI2RlZmluZSBJTlFVSVJZX1ZF
UlNJT05fREVTQ19TQU0yICAgICAgICAgICAweDA0MAorI2RlZmluZSBJTlFVSVJZX1ZFUlNJT05f
REVTQ19TUEMzICAgICAgICAgICAweDMwMAorI2RlZmluZSBJTlFVSVJZX1ZFUlNJT05fREVTQ19N
TUMzICAgICAgICAgICAweDJBMAorI2RlZmluZSBJTlFVSVJZX1ZFUlNJT05fREVTQ19TQkMyICAg
ICAgICAgICAweDMyMAorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9pbnF1aXJ5X3N0YW5kYXJk
X25vX2x1bihDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEsCisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCBwZXJpZl9xdWFsKQor
eworICAgIHVpbnQ4X3QgKm91dGJ1ZiA9IHJlcS0+YnVmOworICAgIHVpbnQzMl90IHJlc3BfbGVu
ID0gSU5RVUlSWV9TVEFOREFSRF9MRU5fTUlOOworCisgICAgbWVtc2V0KHJlcS0+YnVmLCAwLCBJ
TlFVSVJZX1NUQU5EQVJEX0xFTl9NSU4pOworCisgICAgb3V0YnVmWzBdID0gKHBlcmlmX3F1YWwg
PDwgNSkgfCBUWVBFX1JPTTsKKyAgICBvdXRidWZbMl0gPSBJTlFVSVJZX1ZFUlNJT05fTk9ORTsK
KyAgICBvdXRidWZbM10gPSBJTlFVSVJZX1JFU1BfREFUQV9GT1JNQVRfU1BDMzsKKworICAgIG91
dGJ1Zls0XSA9IHJlc3BfbGVuIC0gNDsgLyogYWRkaXRpb25hbCBsZW5ndGgsIGFmdGVyIGhlYWRl
ciAqLworCisgICAgcmVxLT5pbl9sZW4gPSAocmVxLT5yZXFfbGVuIDwgcmVzcF9sZW4pID8gcmVx
LT5yZXFfbGVuIDogcmVzcF9sZW47CisKKyAgICBTUElDRV9ERUJVRygiaW5xdWlyeV9zdGFuZGFy
ZCwgdW5zdXBwb3J0ZWQgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQgIiBwZXJpZl9xdWFsOjB4JXgg
IgorICAgICAgICAgICAgICAgICJpbnF1aXJ5X2xlbjogJSIgR19HVUlOVDMyX0ZPUk1BVCAiIHJl
c3BfbGVuOiAlIiBHX0dVSU5UNjRfRk9STUFULAorICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBw
ZXJpZl9xdWFsLCByZXNwX2xlbiwgcmVxLT5pbl9sZW4pOworCisgICAgY2Rfc2NzaV9jbWRfY29t
cGxldGVfZ29vZChkZXYsIHJlcSk7Cit9CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX2lucXVp
cnlfc3RhbmRhcmQoQ2RTY3NpTFUgKmRldiwgQ2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAgIHVp
bnQ4X3QgKm91dGJ1ZiA9IHJlcS0+YnVmOworICAgIHVpbnQzMl90IHJlc3BfbGVuID0KKyAgICAg
ICAgKGRldi0+Y2xhaW1fdmVyc2lvbiA9PSAwKSA/IElOUVVJUllfU1RBTkRBUkRfTEVOX05PX1ZF
UiA6IElOUVVJUllfU1RBTkRBUkRfTEVOOworCisgICAgb3V0YnVmWzBdID0gKFBFUklGX1FVQUxJ
RklFUl9DT05ORUNURUQgPDwgNSkgfCBUWVBFX1JPTTsKKyAgICBvdXRidWZbMV0gPSAoZGV2LT5y
ZW1vdmFibGUpID8gSU5RVUlSWV9SRU1PVkFCTEVfTUVESVVNIDogMDsKKyAgICBvdXRidWZbMl0g
PSAoZGV2LT5jbGFpbV92ZXJzaW9uID09IDApID8gSU5RVUlSWV9WRVJTSU9OX05PTkUgOiBJTlFV
SVJZX1ZFUlNJT05fU1BDMzsKKyAgICBvdXRidWZbM10gPSBJTlFVSVJZX1JFU1BfTk9STV9BQ0Eg
fCBJTlFVSVJZX1JFU1BfSElTVVAgfCBJTlFVSVJZX1JFU1BfREFUQV9GT1JNQVRfU1BDMzsKKwor
ICAgIG91dGJ1Zls0XSA9IHJlc3BfbGVuIC0gNDsgLyogYWRkaXRpb25hbCBsZW5ndGgsIGFmdGVy
IGhlYWRlciAqLworCisgICAgLyogKG91dGJ1Zls2LDddID0gMCkgbWVhbnMgYWxzbyB7QlF1ZT0w
LENtZFF1ZT0wfSAtIG5vIHF1ZXVlaW5nIGF0IGFsbCAqLworCisgICAgc3RycGFkY3B5KChjaGFy
ICopICZvdXRidWZbOF0sIDgsIGRldi0+dmVuZG9yLCAnICcpOworICAgIHN0cnBhZGNweSgoY2hh
ciAqKSAmb3V0YnVmWzE2XSwgMTYsIGRldi0+cHJvZHVjdCwgJyAnKTsKKyAgICBtZW1jcHkoJm91
dGJ1ZlszMl0sIGRldi0+dmVyc2lvbiwgTUlOKDQsIHN0cmxlbihkZXYtPnZlcnNpb24pKSk7CisK
KyAgICBpZiAoZGV2LT5jbGFpbV92ZXJzaW9uID4gMCkgeworICAgICAgICAvKiBub3cgc3VwcG9y
dGluZyBvbmx5IDMgKi8KKyAgICAgICAgb3V0YnVmWzU4XSA9IChJTlFVSVJZX1ZFUlNJT05fREVT
Q19TQU0yID4+IDgpICYgMHhmZjsKKyAgICAgICAgb3V0YnVmWzU5XSA9IElOUVVJUllfVkVSU0lP
Tl9ERVNDX1NBTTIgJiAweGZmOworCisgICAgICAgIG91dGJ1Zls2MF0gPSAoSU5RVUlSWV9WRVJT
SU9OX0RFU0NfU1BDMyA+PiA4KSAmIDB4ZmY7CisgICAgICAgIG91dGJ1Zls2MV0gPSBJTlFVSVJZ
X1ZFUlNJT05fREVTQ19TUEMzICYgMHhmZjsKKworICAgICAgICBvdXRidWZbNjJdID0gKElOUVVJ
UllfVkVSU0lPTl9ERVNDX01NQzMgPj4gOCkgJiAweGZmOworICAgICAgICBvdXRidWZbNjNdID0g
SU5RVUlSWV9WRVJTSU9OX0RFU0NfTU1DMyAmIDB4ZmY7CisKKyAgICAgICAgb3V0YnVmWzY0XSA9
IChJTlFVSVJZX1ZFUlNJT05fREVTQ19TQkMyID4+IDgpICYgMHhmZjsKKyAgICAgICAgb3V0YnVm
WzY1XSA9IElOUVVJUllfVkVSU0lPTl9ERVNDX1NCQzIgJiAweGZmOworICAgIH0KKworICAgIHJl
cS0+aW5fbGVuID0gKHJlcS0+cmVxX2xlbiA8IHJlc3BfbGVuKSA/IHJlcS0+cmVxX2xlbiA6IHJl
c3BfbGVuOworCisgICAgU1BJQ0VfREVCVUcoImlucXVpcnlfc3RhbmRhcmQsIGx1bjolIiBHX0dV
SU5UMzJfRk9STUFUCisgICAgICAgICAgICAgICAgIiBpbnF1aXJ5X2xlbjogJSIgR19HVUlOVDMy
X0ZPUk1BVCAiIHJlc3BfbGVuOiAlIiBHX0dVSU5UNjRfRk9STUFULAorICAgICAgICAgICAgICAg
IHJlcS0+bHVuLCByZXNwX2xlbiwgcmVxLT5pbl9sZW4pOworCisgICAgY2Rfc2NzaV9jbWRfY29t
cGxldGVfZ29vZChkZXYsIHJlcSk7Cit9CisKKyNkZWZpbmUgQ0RfSU5RVUlSWV9GTEFHX0VWUEQg
ICAgICAgICAgICAgICAgMHgwMQorI2RlZmluZSBDRF9JTlFVSVJZX0ZMQUdfQ01EX0RUICAgICAg
ICAgICAgICAweDAyCisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX2lucXVpcnkoQ2RTY3NpTFUg
KmRldiwgQ2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAgIGdib29sZWFuIGV2cGQsIGNtZF9kYXRh
OworCisgICAgcmVxLT54ZmVyX2RpciA9IFNDU0lfWEZFUl9GUk9NX0RFVjsKKworICAgIGV2cGQg
PSAocmVxLT5jZGJbMV0gJiBDRF9JTlFVSVJZX0ZMQUdfRVZQRCkgPyBUUlVFIDogRkFMU0U7Cisg
ICAgY21kX2RhdGEgPSAocmVxLT5jZGJbMV0gJiBDRF9JTlFVSVJZX0ZMQUdfQ01EX0RUKSA/IFRS
VUUgOiBGQUxTRTsKKworICAgIGlmIChjbWRfZGF0YSkgeworICAgICAgICBTUElDRV9ERUJVRygi
aW5xdWlyeSwgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQgIiBDbWREVCBiaXQgc2V0IC0gdW5zdXBw
b3J0ZWQsICIKKyAgICAgICAgICAgICAgICAgICAgImNkYlsxXToweCUwMnggY2RiWzFdOjB4JTAy
eCIsCisgICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuLCAoaW50KXJlcS0+Y2RiWzFdLCAoaW50
KXJlcS0+Y2RiWzJdKTsKKyAgICAgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChk
ZXYsIHJlcSwgJnNlbnNlX2NvZGVfSU5WQUxJRF9DREJfRklFTEQpOworICAgICAgICByZXR1cm47
CisgICAgfQorCisgICAgcmVxLT5yZXFfbGVuID0gcmVxLT5jZGJbNF0gfCAocmVxLT5jZGJbM10g
PDwgOCk7CisgICAgbWVtc2V0KHJlcS0+YnVmLCAwLCByZXEtPnJlcV9sZW4pOworCisgICAgaWYg
KGV2cGQpIHsgLyogZW5hYmxlIHZpdGFsIHByb2R1Y3QgZGF0YSAqLworICAgICAgICBjZF9zY3Np
X2NtZF9pbnF1aXJ5X3ZwZChkZXYsIHJlcSk7CisgICAgfSBlbHNlIHsgLyogc3RhbmRhcmQgaW5x
dWlyeSBkYXRhICovCisgICAgICAgIGlmIChyZXEtPmNkYlsyXSAhPSAwKSB7CisgICAgICAgICAg
ICBTUElDRV9ERUJVRygiaW5xdWlyeV9zdGFuZGFyZCwgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQg
IiBub24temVybyBwYWdlIGNvZGU6ICUwMngiLAorICAgICAgICAgICAgICAgICAgICAgICAgcmVx
LT5sdW4sIChpbnQpcmVxLT5jZGJbMl0pOworICAgICAgICAgICAgY2Rfc2NzaV9jbWRfY29tcGxl
dGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfSU5WQUxJRF9DREJfRklFTEQpOwor
ICAgICAgICAgICAgcmV0dXJuOworICAgICAgICB9CisgICAgICAgIGNkX3Njc2lfY21kX2lucXVp
cnlfc3RhbmRhcmQoZGV2LCByZXEpOworICAgIH0KK30KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9j
bWRfcmVhZF9jYXBhY2l0eShDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7Cisg
ICAgdWludDMyX3QgbGFzdF9ibGsgPSBkZXYtPm51bV9ibG9ja3MgLSAxOworICAgIHVpbnQzMl90
IGJsa19zaXplID0gZGV2LT5ibG9ja19zaXplOworICAgIHVpbnQzMl90ICpsYXN0X2Jsa19vdXQg
PSAodWludDMyX3QgKilyZXEtPmJ1ZjsKKyAgICB1aW50MzJfdCAqYmxrX3NpemVfb3V0ID0gKHVp
bnQzMl90ICopKHJlcS0+YnVmICsgNCk7CisKKyAgICByZXEtPnhmZXJfZGlyID0gU0NTSV9YRkVS
X0ZST01fREVWOworICAgIHJlcS0+cmVxX2xlbiA9IDg7CisKKyAgICAqbGFzdF9ibGtfb3V0ID0g
aHRvYmUzMihsYXN0X2Jsayk7CisgICAgKmJsa19zaXplX291dCA9IGh0b2JlMzIoYmxrX3NpemUp
OworCisgICAgU1BJQ0VfREVCVUcoIlJlYWQgY2FwYWNpdHksIGx1bjolIiBHX0dVSU5UMzJfRk9S
TUFUCisgICAgICAgICAgICAgICAgIiBsYXN0X2JsazogJSIgR19HVUlOVDMyX0ZPUk1BVCAiIGJs
a19zejogJSIgR19HVUlOVDMyX0ZPUk1BVCwKKyAgICAgICAgICAgICAgICByZXEtPmx1biwgbGFz
dF9ibGssIGJsa19zaXplKTsKKworICAgIHJlcS0+aW5fbGVuID0gODsKKyAgICBjZF9zY3NpX2Nt
ZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworI2RlZmluZSBSRElfVFlQRV9TVEFOREFS
RCAgICAgICAgICAgMCAvKiBTdGFuZGFyZCBEaXNjIEluZm9ybWF0aW9uICovCisjZGVmaW5lIFJE
SV9UWVBFX1RSQUNLX1JFU09VUkNFUyAgICAxIC8qIFRyYWNrIFJlc291cmNlcyBJbmZvcm1hdGlv
biAqLworI2RlZmluZSBSRElfVFlQRV9QT1dfUkVTT1VSQ0VTICAgICAgMiAvKiBQT1cgUmVzb3Vy
Y2VzIEluZm9ybWF0aW9uICovCisKKyNkZWZpbmUgUkRJX1NUQU5EQVJEX0xFTiAgICAgICAgICAg
IDM0CisKKyNkZWZpbmUgUkRJX0VSQVpBQkxFICAgICAgICAgICAgICAgICgweDAxIDw8IDQpCisj
ZGVmaW5lIFJESV9OT05fRVJBWkFCTEUgICAgICAgICAgICAoMHgwMCA8PCA0KQorCisjZGVmaW5l
IFJESV9TRVNTSU9OX0VNUFRZICAgICAgICAgICAoMHgwMCA8PCAyKQorI2RlZmluZSBSRElfU0VT
U0lPTl9JTkNPTVBMRVRFICAgICAgKDB4MDEgPDwgMikKKyNkZWZpbmUgUkRJX1NFU1NJT05fREFN
QUdFRCAgICAgICAgICgweDAyIDw8IDIpCisjZGVmaW5lIFJESV9TRVNTSU9OX0NPTVBMRVRFICAg
ICAgICAoMHgwMyA8PCAyKQorCisjZGVmaW5lIFJESV9ESVNDX0VNUFRZICAgICAgICAgICAgICAw
eDAwCisjZGVmaW5lIFJESV9ESVNDX0lOQ09NUExFVEUgICAgICAgICAweDAxCisjZGVmaW5lIFJE
SV9ESVNDX0NPTVBMRVRFICAgICAgICAgICAweDAyCisjZGVmaW5lIFJESV9ESVNDX1JBTkRPTV9X
UiAgICAgICAgICAweDAzCisKKyNkZWZpbmUgUkRJX0RJU0NfUE1BX1RZUEVfQ0RfUk9NICAgIDB4
MDAKKyNkZWZpbmUgUkRJX0RJU0NfUE1BX1RZUEVfQ0RJICAgICAgIDB4MTAKKyNkZWZpbmUgUkRJ
X0RJU0NfUE1BX1RZUEVfRERDRCAgICAgIDB4MjAKKyNkZWZpbmUgUkRJX0RJU0NfUE1BX1RZUEVf
VU5ERUZJTkVEIDB4RkYKKworc3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRfZ2V0X3JlYWRfZGlzY19p
bmZvcm1hdGlvbihDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgdWlu
dDhfdCAqb3V0YnVmID0gcmVxLT5idWY7CisgICAgdWludDMyX3QgZGF0YV90eXBlOworICAgIHVp
bnQzMl90IGZpcnN0X3RyYWNrID0gMTsKKyAgICB1aW50MzJfdCBsYXN0X3RyYWNrID0gMTsKKyAg
ICB1aW50MzJfdCBudW1fc2Vzc2lvbnMgPSAxOworCisgICAgcmVxLT54ZmVyX2RpciA9IFNDU0lf
WEZFUl9GUk9NX0RFVjsKKworICAgIGRhdGFfdHlwZSA9IHJlcS0+Y2RiWzFdICYgMHg3OworICAg
IGlmIChkYXRhX3R5cGUgIT0gUkRJX1RZUEVfU1RBTkRBUkQpIHsKKyAgICAgICAgU1BJQ0VfREVC
VUcoInJlYWRfZGlzY19pbmZvcm1hdGlvbiwgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQKKyAgICAg
ICAgICAgICAgICAgICAgIiB1bnN1cHBvcnRlZCBkYXRhIHR5cGU6ICUwMngiLAorICAgICAgICAg
ICAgICAgICAgICByZXEtPmx1biwgZGF0YV90eXBlKTsKKyAgICAgICAgY2Rfc2NzaV9jbWRfY29t
cGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfSU5WQUxJRF9DREJfRklFTEQp
OworICAgICAgICByZXR1cm47CisgICAgfQorCisgICAgcmVxLT5yZXFfbGVuID0gKHJlcS0+Y2Ri
WzddIDw8IDgpIHwgcmVxLT5jZGJbOF07CisgICAgcmVxLT5pbl9sZW4gPSAocmVxLT5yZXFfbGVu
IDwgUkRJX1NUQU5EQVJEX0xFTikgPyByZXEtPnJlcV9sZW4gOiBSRElfU1RBTkRBUkRfTEVOOwor
CisgICAgbWVtc2V0KG91dGJ1ZiwgMCwgUkRJX1NUQU5EQVJEX0xFTik7CisgICAgb3V0YnVmWzFd
ID0gUkRJX1NUQU5EQVJEX0xFTiAtIDI7IC8qIGxlbmd0aCBleGNsdWRpbmcgdGhlIGNvdW50ZXIg
aXRzZWxmICovCisgICAgb3V0YnVmWzJdID0gUkRJX05PTl9FUkFaQUJMRSB8IFJESV9TRVNTSU9O
X0NPTVBMRVRFIHwgUkRJX0RJU0NfQ09NUExFVEU7CisgICAgb3V0YnVmWzNdID0gZmlyc3RfdHJh
Y2s7IC8qIG9uIGRpc2sgKi8KKyAgICBvdXRidWZbNF0gPSBudW1fc2Vzc2lvbnMgJiAweGZmOyAv
KiBsc2IgKi8KKyAgICBvdXRidWZbNV0gPSBmaXJzdF90cmFjayAmIDB4ZmY7IC8qIGluIGxhc3Qg
c2Vzc29uLCBsc2IgKi8KKyAgICBvdXRidWZbNl0gPSBsYXN0X3RyYWNrICYgMHhmZjsgLyogaW4g
bGFzdCBzZXNzb24sIGxzYiAqLworICAgIG91dGJ1Zls4XSA9IFJESV9ESVNDX1BNQV9UWVBFX0NE
X1JPTTsKKyAgICBvdXRidWZbOV0gPSAobnVtX3Nlc3Npb25zID4+IDgpICYgMHhmZjsgLyogbXNi
ICovCisgICAgb3V0YnVmWzEwXSA9IChmaXJzdF90cmFjayA+PiA4KSAmIDB4ZmY7IC8qIGluIGxh
c3Qgc2Vzc29uLCBsc2IgKi8KKyAgICBvdXRidWZbMTFdID0gKGxhc3RfdHJhY2sgPj4gOCkgJiAw
eGZmOyAvKiBpbiBsYXN0IHNlc3NvbiwgbHNiICovCisKKyAgICBTUElDRV9ERUJVRygicmVhZF9k
aXNjX2luZm9ybWF0aW9uLCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCAiIGxlbjogJSIgR19HVUlO
VDY0X0ZPUk1BVCwKKyAgICAgICAgICAgICAgICByZXEtPmx1biwgcmVxLT5pbl9sZW4pOworCisg
ICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfZ29vZChkZXYsIHJlcSk7Cit9CisKKyNkZWZpbmUgUlRJ
X0FERFJfVFlQRV9MQkEgICAgICAgICAgIDB4MDAKKyNkZWZpbmUgUlRJX0FERFJfVFlQRV9UUkFD
S19OVU0gICAgIDB4MDEKKyNkZWZpbmUgUlRJX0FERFJfVFlQRV9TRVNTSU9OX05VTSAgIDB4MDIK
KworI2RlZmluZSBSVElfVFJBQ0tfTlVNX0xFQURfSU4gICAgICAgMHgwMAorI2RlZmluZSBSVElf
VFJBQ0tfTlVNX0lOVklTSUJMRSAgICAgMHhmZgorCisjZGVmaW5lIFRJQl9MRU4gICAgICAgICAg
ICAgICAgICAgICAweDM2CisKKyNkZWZpbmUgVElCX1RSQUNLX01PREVfQ0QgICAgICAgICAgIDB4
MDQKKyNkZWZpbmUgVElCX0RBVEFfTU9ERV9JU09fMTAxNDkgICAgIDB4MDEKKworI2RlZmluZSBU
SUJfTFJBX1ZBTElEICAgICAgICAgICAgICAgKDB4MDEgPDwgMSkKKworc3RhdGljIHZvaWQgY2Rf
c2NzaV9jbWRfZ2V0X3JlYWRfdHJhY2tfaW5mb3JtYXRpb24oQ2RTY3NpTFUgKmRldiwgQ2RTY3Np
UmVxdWVzdCAqcmVxKQoreworICAgIHVpbnQ4X3QgKm91dGJ1ZiA9IHJlcS0+YnVmOworICAgIHVp
bnQzMl90IHRyYWNrX3NpemUgPSBkZXYtPm51bV9ibG9ja3M7CisgICAgdWludDMyX3QgbGFzdF9h
ZGRyID0gdHJhY2tfc2l6ZSAtIDE7CisgICAgdWludDMyX3QgdHJhY2tfbnVtID0gMTsKKyAgICB1
aW50MzJfdCBzZXNzaW9uX251bSA9IDE7CisgICAgdWludDMyX3QgYWRkcl90eXBlOworICAgIHVp
bnQzMl90IGFkZHJfbnVtOworCisgICAgcmVxLT54ZmVyX2RpciA9IFNDU0lfWEZFUl9GUk9NX0RF
VjsKKworICAgIGFkZHJfdHlwZSA9IHJlcS0+Y2RiWzFdICYgMHgzOworICAgIGFkZHJfbnVtID0g
KHJlcS0+Y2RiWzJdIDw8IDI0KSB8IChyZXEtPmNkYlszXSA8PCAxNikgfAorICAgICAgICAgICAg
ICAgKHJlcS0+Y2RiWzRdIDw8IDgpIHwgcmVxLT5jZGJbNV07CisKKyAgICBzd2l0Y2ggKGFkZHJf
dHlwZSkgeworICAgIGNhc2UgUlRJX0FERFJfVFlQRV9MQkE6CisgICAgICAgIGlmIChhZGRyX251
bSA+IGxhc3RfYWRkcikgeworICAgICAgICAgICAgU1BJQ0VfREVCVUcoInJlYWRfdHJhY2tfaW5m
b3JtYXRpb24sIGx1bjolIiBHX0dVSU5UMzJfRk9STUFUCisgICAgICAgICAgICAgICAgICAgICAg
ICAiIGFkZHJfdHlwZSBMQkE6ICUiIEdfR1VJTlQzMl9GT1JNQVQKKyAgICAgICAgICAgICAgICAg
ICAgICAgICIgaW52YWxpZCBMQkE6ICUiIEdfR1VJTlQzMl9GT1JNQVQsCisgICAgICAgICAgICAg
ICAgICAgICAgICByZXEtPmx1biwgYWRkcl90eXBlLCBhZGRyX251bSk7CisgICAgICAgICAgICBj
ZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZB
TElEX0NEQl9GSUVMRCk7CisgICAgICAgICAgICByZXR1cm47CisgICAgICAgIH0KKyAgICAgICAg
YnJlYWs7CisgICAgY2FzZSBSVElfQUREUl9UWVBFX1RSQUNLX05VTToKKyAgICAgICAgaWYgKGFk
ZHJfbnVtICE9IHRyYWNrX251bSkgeworICAgICAgICAgICAgU1BJQ0VfREVCVUcoInJlYWRfdHJh
Y2tfaW5mb3JtYXRpb24sIGx1bjolIiBHX0dVSU5UMzJfRk9STUFUCisgICAgICAgICAgICAgICAg
ICAgICAgICAiIGFkZHJfdHlwZSB0cmFjazogJSIgR19HVUlOVDMyX0ZPUk1BVAorICAgICAgICAg
ICAgICAgICAgICAgICAgIiBpbnZhbGlkIHRyYWNrOiAlIiBHX0dVSU5UMzJfRk9STUFULAorICAg
ICAgICAgICAgICAgICAgICAgICAgcmVxLT5sdW4sIGFkZHJfdHlwZSwgYWRkcl9udW0pOworICAg
ICAgICAgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNl
X2NvZGVfSU5WQUxJRF9DREJfRklFTEQpOworICAgICAgICAgICAgcmV0dXJuOworICAgICAgICB9
CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgUlRJX0FERFJfVFlQRV9TRVNTSU9OX05VTToKKyAg
ICAgICAgaWYgKGFkZHJfbnVtICE9IHNlc3Npb25fbnVtKSB7CisgICAgICAgICAgICBTUElDRV9E
RUJVRygicmVhZF90cmFja19pbmZvcm1hdGlvbiwgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQKKyAg
ICAgICAgICAgICAgICAgICAgICAgICIgYWRkcl90eXBlIHNlc3Npb246ICUiIEdfR1VJTlQzMl9G
T1JNQVQKKyAgICAgICAgICAgICAgICAgICAgICAgICIgaW52YWxpZCBzZXNzaW9uOiAlIiBHX0dV
SU5UMzJfRk9STUFULAorICAgICAgICAgICAgICAgICAgICAgICAgcmVxLT5sdW4sIGFkZHJfdHlw
ZSwgYWRkcl9udW0pOworICAgICAgICAgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29u
ZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfSU5WQUxJRF9DREJfRklFTEQpOworICAgICAgICAgICAg
cmV0dXJuOworICAgICAgICB9CisgICAgICAgIGJyZWFrOworICAgIGRlZmF1bHQ6CisgICAgICAg
IFNQSUNFX0RFQlVHKCJyZWFkX3RyYWNrX2luZm9ybWF0aW9uLCBsdW46JSIgR19HVUlOVDMyX0ZP
Uk1BVAorICAgICAgICAgICAgICAgICAgICAiaW52YWxpZCBhZGRyX3R5cGU6ICUiIEdfR1VJTlQz
Ml9GT1JNQVQKKyAgICAgICAgICAgICAgICAgICAgIiBhZGRyX251bTogJSIgR19HVUlOVDMyX0ZP
Uk1BVCwKKyAgICAgICAgICAgICAgICAgICAgcmVxLT5sdW4sIGFkZHJfdHlwZSwgYWRkcl9udW0p
OworICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vu
c2VfY29kZV9JTlZBTElEX0NEQl9GSUVMRCk7CisgICAgICAgIHJldHVybjsKKyAgICB9CisKKyAg
ICByZXEtPnJlcV9sZW4gPSAocmVxLT5jZGJbN10gPDwgOCkgfCByZXEtPmNkYls4XTsKKyAgICBy
ZXEtPmluX2xlbiA9IChyZXEtPnJlcV9sZW4gPCBUSUJfTEVOKSA/IHJlcS0+cmVxX2xlbiA6IFRJ
Ql9MRU47CisKKyAgICBtZW1zZXQob3V0YnVmLCAwLCBUSUJfTEVOKTsKKyAgICBvdXRidWZbMV0g
PSBUSUJfTEVOIC0gMjsKKyAgICBvdXRidWZbMl0gPSBzZXNzaW9uX251bTsKKyAgICBvdXRidWZb
M10gPSB0cmFja19udW07CisgICAgb3V0YnVmWzVdID0gVElCX1RSQUNLX01PREVfQ0QgJiAweDBm
OworICAgIG91dGJ1Zls2XSA9IFRJQl9EQVRBX01PREVfSVNPXzEwMTQ5ICYgMHgwZjsKKyAgICBv
dXRidWZbN10gPSBUSUJfTFJBX1ZBTElEOworCisgICAgLyogVHJhY2sgc2l6ZSAqLworICAgIG91
dGJ1ZlsyNF0gPSAodHJhY2tfc2l6ZSA+PiAyNCkgJiAweGZmOworICAgIG91dGJ1ZlsyNV0gPSAo
dHJhY2tfc2l6ZSA+PiAxNikgJiAweGZmOworICAgIG91dGJ1ZlsyNl0gPSAodHJhY2tfc2l6ZSA+
PiA4KSAmIDB4ZmY7CisgICAgb3V0YnVmWzI3XSA9ICh0cmFja19zaXplKSAmIDB4ZmY7CisKKyAg
ICAvKiBMYXN0IHJlY29yZGVkIGFkZHJlc3MgKi8KKyAgICBvdXRidWZbMjhdID0gKGxhc3RfYWRk
ciA+PiAyNCkgJiAweGZmOworICAgIG91dGJ1ZlsyOV0gPSAobGFzdF9hZGRyID4+IDE2KSAmIDB4
ZmY7CisgICAgb3V0YnVmWzMwXSA9IChsYXN0X2FkZHIgPj4gOCkgJiAweGZmOworICAgIG91dGJ1
ZlszMV0gPSAobGFzdF9hZGRyKSAmIDB4ZmY7CisKKyAgICBTUElDRV9ERUJVRygicmVhZF90cmFj
a19pbmZvcm1hdGlvbiwgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQKKyAgICAgICAgICAgICAgICAi
YWRkcl90eXBlOiAlIiBHX0dVSU5UMzJfRk9STUFUICIgYWRkcl9udW06ICUiIEdfR1VJTlQzMl9G
T1JNQVQsCisgICAgICAgICAgICAgICAgcmVxLT5sdW4sIGFkZHJfdHlwZSwgYWRkcl9udW0pOwor
CisgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfZ29vZChkZXYsIHJlcSk7Cit9CisKKyNkZWZpbmUg
UkVBRF9UT0NfVFJBQ0tfREVTQ19MRU4gICAgIDgKKyNkZWZpbmUgUkVBRF9UT0NfUkVTUF9MRU4g
ICAgICAgICAgICg0ICsgMipSRUFEX1RPQ19UUkFDS19ERVNDX0xFTikKKworc3RhdGljIHZvaWQg
Y2Rfc2NzaV9jbWRfcmVhZF90b2MoQ2RTY3NpTFUgKmRldiwgQ2RTY3NpUmVxdWVzdCAqcmVxKQor
eworICAgIHVpbnQ4X3QgKm91dGJ1ZiA9IHJlcS0+YnVmOworICAgIHVpbnQzMl90IG1zZiwgZm9y
bWF0LCB0cmFja19udW07CisgICAgdWludDMyX3QgbGFzdF9ibGsgPSBkZXYtPm51bV9ibG9ja3Mg
LSAxOworCisgICAgcmVxLT54ZmVyX2RpciA9IFNDU0lfWEZFUl9GUk9NX0RFVjsKKworICAgIG1z
ZiA9IChyZXEtPmNkYlsxXSA+PiAxKSAmIDB4MTsKKyAgICBmb3JtYXQgPSByZXEtPmNkYlsyXSAm
IDB4ZjsKKyAgICB0cmFja19udW0gPSByZXEtPmNkYls2XTsKKworICAgIHJlcS0+cmVxX2xlbiA9
IChyZXEtPmNkYls3XSA8PCA4KSB8IHJlcS0+Y2RiWzhdOworICAgIHJlcS0+aW5fbGVuID0gKHJl
cS0+cmVxX2xlbiA8IFJFQURfVE9DX1JFU1BfTEVOKSA/IHJlcS0+cmVxX2xlbiA6IFJFQURfVE9D
X1JFU1BfTEVOOworCisgICAgbWVtc2V0KG91dGJ1ZiwgMCwgUkVBRF9UT0NfUkVTUF9MRU4pOwor
ICAgIG91dGJ1ZlsxXSA9IFJFQURfVE9DX1JFU1BfTEVOIC0gMjsgLyogbGVuZ3RoIGV4Y2x1ZGlu
ZyB0aGUgY291bnRlciBpdHNlbGYgKi8KKyAgICBvdXRidWZbMl0gPSAxOyAvKiBmaXJzdCB0cmFj
ay9zZXNzaW9uICovCisgICAgb3V0YnVmWzNdID0gMTsgLyogbGFzdCB0cmFjay9zZXNzaW9uICov
CisKKyAgICBvdXRidWZbNV0gPSAweDA0OyAvKiBEYXRhIENELCBubyBRLXN1YmNoYW5uZWwgKi8K
KyAgICBvdXRidWZbNl0gPSAweDAxOyAvKiBUcmFjayBudW1iZXIgKi8KKyAgICBvdXRidWZbMTBd
ID0gbXNmID8gMHgwMiA6IDB4MDsKKworICAgIG91dGJ1ZlsxM10gPSAweDA0OyAvKiBEYXRhIENE
LCBubyBRLXN1YmNoYW5uZWwgKi8KKyAgICBvdXRidWZbMTRdID0gMHhhYTsgLyogVHJhY2sgbnVt
YmVyICovCisgICAgaWYgKG1zZikgeworICAgICAgICBsYXN0X2JsayA9IDB4ZmYzMDAwMDA7Cisg
ICAgfQorICAgIG91dGJ1ZlsxNl0gPSBsYXN0X2JsayA+PiAyNDsKKyAgICBvdXRidWZbMTddID0g
bGFzdF9ibGsgPj4gMTY7CisgICAgb3V0YnVmWzE4XSA9IGxhc3RfYmxrID4+IDg7CisgICAgb3V0
YnVmWzE5XSA9IGxhc3RfYmxrOworCisgICAgU1BJQ0VfREVCVUcoInJlYWRfdG9jLCBsdW46JSIg
R19HVUlOVDMyX0ZPUk1BVCAiIGxlbjogJSIgR19HVUlOVDY0X0ZPUk1BVAorICAgICAgICAgICAg
ICAgICIgbXNmOiAleCBmb3JtYXQ6IDB4JTAyeCB0cmFjay9zZXNzaW9uOiAweCUwMngiLAorICAg
ICAgICAgICAgICAgIHJlcS0+bHVuLCByZXEtPmluX2xlbiwgbXNmLCBmb3JtYXQsIHRyYWNrX251
bSk7CisKKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworI2Rl
ZmluZSBDRF9NT0RFX1BBUkFNXzZfTEVOX0hFQURFUiAgICAgICAgICAgICAgNAorI2RlZmluZSBD
RF9NT0RFX1BBUkFNXzEwX0xFTl9IRUFERVIgICAgICAgICAgICAgOAorCisjZGVmaW5lIENEX01P
REVfUEFHRV9MRU5fUldfRVJST1IgICAgICAgICAgICAgICAxMgorCitzdGF0aWMgdWludDMyX3Qg
Y2Rfc2NzaV9hZGRfbW9kZV9wYWdlX3J3X2Vycm9yX3JlY292ZXJ5KENkU2NzaUxVICpkZXYsIHVp
bnQ4X3QgKm91dGJ1ZikKK3sKKyAgICB1aW50MzJfdCBwYWdlX2xlbiA9IENEX01PREVfUEFHRV9M
RU5fUldfRVJST1I7CisKKyAgICBvdXRidWZbMF0gPSBNT0RFX1BBR0VfUl9XX0VSUk9SOworICAg
IG91dGJ1ZlsxXSA9IENEX01PREVfUEFHRV9MRU5fUldfRVJST1IgLSAyOworICAgIG91dGJ1Zlsz
XSA9IDE7IC8qIHJlYWQgcmV0cnkgY291bnQgKi8KKworICAgIHJldHVybiBwYWdlX2xlbjsKK30K
KworI2RlZmluZSBDRF9NT0RFX1BBR0VfTEVOX1BPV0VSICAgICAgICAgICAgICAgICAgMTIKKwor
c3RhdGljIHVpbnQzMl90IGNkX3Njc2lfYWRkX21vZGVfcGFnZV9wb3dlcl9jb25kaXRpb24oQ2RT
Y3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVmKQoreworICAgIHVpbnQzMl90IHBhZ2VfbGVuID0g
Q0RfTU9ERV9QQUdFX0xFTl9QT1dFUjsKKworICAgIG91dGJ1ZlswXSA9IE1PREVfUEFHRV9QT1dF
UjsKKyAgICBvdXRidWZbMV0gPSBDRF9NT0RFX1BBR0VfTEVOX1BPV0VSIC0gMjsKKworICAgIHJl
dHVybiBwYWdlX2xlbjsKK30KKworI2RlZmluZSBDRF9NT0RFX1BBR0VfTEVOX0ZBVUxUX0ZBSUwg
ICAgICAgICAgICAgMTIKKyNkZWZpbmUgQ0RfTU9ERV9QQUdFX0ZBVUxUX0ZBSUxfRkxBR19QRVJG
ICAgICAgIDB4ODAKKworc3RhdGljIHVpbnQzMl90IGNkX3Njc2lfYWRkX21vZGVfcGFnZV9mYXVs
dF9yZXBvcnRpbmcoQ2RTY3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVmKQoreworICAgIHVpbnQz
Ml90IHBhZ2VfbGVuID0gQ0RfTU9ERV9QQUdFX0xFTl9GQVVMVF9GQUlMOworCisgICAgb3V0YnVm
WzBdID0gTU9ERV9QQUdFX0ZBVUxUX0ZBSUw7CisgICAgb3V0YnVmWzFdID0gQ0RfTU9ERV9QQUdF
X0xFTl9GQVVMVF9GQUlMIC0gMjsKKyAgICBvdXRidWZbMl0gfD0gQ0RfTU9ERV9QQUdFX0ZBVUxU
X0ZBSUxfRkxBR19QRVJGOworCisgICAgcmV0dXJuIHBhZ2VfbGVuOworfQorCisjZGVmaW5lIENE
X01PREVfUEFHRV9MRU5fQ0FQU19NRUNIX1NUQVRVU19STyAgICAyNgorLyogYnl0ZSAyICovCisj
ZGVmaW5lIENEX01PREVfUEFHRV9DQVBTX0NEX1JfUkVBRCAgICAgICAgICAgICAweDAxCisjZGVm
aW5lIENEX01PREVfUEFHRV9DQVBTX0NEX1JXX1JFQUQgICAgICAgICAgICAoMHgwMSA8PCAxKQor
I2RlZmluZSBDRF9NT0RFX1BBR0VfQ0FQU19EVkRfUk9NX1JFQUQgICAgICAgICAgKDB4MDEgPDwg
MykKKyNkZWZpbmUgQ0RfTU9ERV9QQUdFX0NBUFNfRFZEX1JfUkVBRCAgICAgICAgICAgICgweDAx
IDw8IDQpCisjZGVmaW5lIENEX01PREVfUEFHRV9DQVBTX0RWRF9SQU1fUkVBRCAgICAgICAgICAo
MHgwMSA8PCA1KQorLyogYnl0ZSA2ICovCisjZGVmaW5lIENEX01PREVfUEFHRV9DQVBTX0xPQ0tf
U1VQUE9SVCAgICAgICAgICAoMHgwMSkKKyNkZWZpbmUgQ0RfTU9ERV9QQUdFX0NBUFNfTE9DS19T
VEFURSAgICAgICAgICAgICgweDAxIDw8IDEpCisjZGVmaW5lIENEX01PREVfUEFHRV9DQVBTX1BS
RVZFTlRfSlVNUEVSICAgICAgICAoMHgwMSA8PCAyKQorI2RlZmluZSBDRF9NT0RFX1BBR0VfQ0FQ
U19FSkVDVCAgICAgICAgICAgICAgICAgKDB4MDEgPDwgMykKKyNkZWZpbmUgQ0RfTU9ERV9QQUdF
X0NBUFNfTE9BRElOR19UUkFZICAgICAgICAgICgweDAxIDw8IDUpCisKK3N0YXRpYyB1aW50MzJf
dCBjZF9zY3NpX2FkZF9tb2RlX3BhZ2VfY2Fwc19tZWNoX3N0YXR1cyhDZFNjc2lMVSAqZGV2LCB1
aW50OF90ICpvdXRidWYpCit7CisgICAgdWludDMyX3QgcGFnZV9sZW4gPSBDRF9NT0RFX1BBR0Vf
TEVOX0NBUFNfTUVDSF9TVEFUVVNfUk87IC8qIG5vIHdyaXRlICovCisKKyAgICBvdXRidWZbMF0g
PSBNT0RFX1BBR0VfQ0FQU19NRUNIX1NUQVRVUzsKKyAgICBvdXRidWZbMV0gPSBwYWdlX2xlbjsK
KyAgICBvdXRidWZbMl0gPSBDRF9NT0RFX1BBR0VfQ0FQU19DRF9SX1JFQUQgfCBDRF9NT0RFX1BB
R0VfQ0FQU19DRF9SV19SRUFEIHwKKyAgICAgICAgICAgICAgICBDRF9NT0RFX1BBR0VfQ0FQU19E
VkRfUk9NX1JFQUQgfCBDRF9NT0RFX1BBR0VfQ0FQU19EVkRfUl9SRUFEIHwKKyAgICAgICAgICAg
ICAgICBDRF9NT0RFX1BBR0VfQ0FQU19EVkRfUkFNX1JFQUQ7CisgICAgb3V0YnVmWzZdID0gQ0Rf
TU9ERV9QQUdFX0NBUFNfTE9BRElOR19UUkFZIHwgQ0RfTU9ERV9QQUdFX0NBUFNfRUpFQ1QgfAor
ICAgICAgICAgICAgICAgIENEX01PREVfUEFHRV9DQVBTX0xPQ0tfU1VQUE9SVDsKKyAgICBpZiAo
ZGV2LT5wcmV2ZW50X21lZGlhX3JlbW92YWwpIHsKKyAgICAgICAgb3V0YnVmWzZdIHw9IENEX01P
REVfUEFHRV9DQVBTX0xPQ0tfU1RBVEU7CisgICAgfQorCisgICAgcmV0dXJuIHBhZ2VfbGVuOwor
fQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9tb2RlX3NlbnNlXzEwKENkU2NzaUxVICpkZXYs
IENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICB1aW50OF90ICpvdXRidWYgPSByZXEtPmJ1ZjsK
KyAgICBpbnQgbG9uZ19sYmEsIGRiZCwgcGFnZSwgc3ViX3BhZ2UsIHBjOworICAgIHVpbnQzMl90
IHJlc3BfbGVuID0gQ0RfTU9ERV9QQVJBTV8xMF9MRU5fSEVBREVSOworCisgICAgcmVxLT54ZmVy
X2RpciA9IFNDU0lfWEZFUl9GUk9NX0RFVjsKKworICAgIGxvbmdfbGJhID0gKHJlcS0+Y2RiWzFd
ID4+IDQpICYgMHgxOworICAgIGRiZCA9IChyZXEtPmNkYlsxXSA+PiAzKSAmIDB4MTsKKyAgICBw
YWdlID0gcmVxLT5jZGJbMl0gJiAweDNmOworICAgIHBjID0gcmVxLT5jZGJbMl0gPj4gNjsKKyAg
ICBzdWJfcGFnZSA9IHJlcS0+Y2RiWzNdICYgMHhmOworCisgICAgcmVxLT5yZXFfbGVuID0gKHJl
cS0+Y2RiWzddIDw8IDgpIHwgcmVxLT5jZGJbOF07CisKKyAgICBtZW1zZXQob3V0YnVmLCAwLCBy
ZXEtPnJlcV9sZW4pOworICAgIG91dGJ1ZlsyXSA9ICAwOyAvKiBtZWRpdW0gdHlwZSAqLworCisg
ICAgc3dpdGNoIChwYWdlKSB7CisgICAgY2FzZSBNT0RFX1BBR0VfUl9XX0VSUk9SOgorICAgICAg
ICAvKiBSZWFkL1dyaXRlIEVycm9yIFJlY292ZXJ5ICovCisgICAgICAgIHJlc3BfbGVuICs9IGNk
X3Njc2lfYWRkX21vZGVfcGFnZV9yd19lcnJvcl9yZWNvdmVyeShkZXYsIG91dGJ1ZiArIHJlc3Bf
bGVuKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBNT0RFX1BBR0VfUE9XRVI6CisgICAgICAg
IC8qIFBvd2VyIENvbmRpc3Rpb25zICovCisgICAgICAgIHJlc3BfbGVuICs9IGNkX3Njc2lfYWRk
X21vZGVfcGFnZV9wb3dlcl9jb25kaXRpb24oZGV2LCBvdXRidWYgKyByZXNwX2xlbik7CisgICAg
ICAgIGJyZWFrOworICAgIGNhc2UgTU9ERV9QQUdFX0ZBVUxUX0ZBSUw6CisgICAgICAgIC8qIEZh
dWx0IC8gRmFpbHVyZSBSZXBvcnRpbmcgQ29udHJvbCAqLworICAgICAgICByZXNwX2xlbiArPSBj
ZF9zY3NpX2FkZF9tb2RlX3BhZ2VfZmF1bHRfcmVwb3J0aW5nKGRldiwgb3V0YnVmICsgcmVzcF9s
ZW4pOworICAgICAgICBicmVhazsKKyAgICBjYXNlIE1PREVfUEFHRV9DQVBTX01FQ0hfU1RBVFVT
OgorICAgICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9tb2RlX3BhZ2VfY2Fwc19tZWNoX3N0
YXR1cyhkZXYsIG91dGJ1ZiArIHJlc3BfbGVuKTsKKyAgICAgICAgYnJlYWs7CisKKyAgICAvKiBu
b3QgaW1wbGVtZW50ZWQgKi8KKyAgICBjYXNlIE1PREVfUEFHRV9XUklURV9QQVJBTUVURVI6IC8q
IFdyaXRlciBQYXJhbWV0ZXJzICovCisgICAgY2FzZSBNT0RFX1BBR0VfTVJXOgorICAgIGNhc2Ug
TU9ERV9QQUdFX01SV19WRU5ET1I6IC8qIE1SVyAoTW91bnQgUmFpbmllciBSZS13cml0YWJsZSBE
aXNrcyAqLworICAgIGNhc2UgTU9ERV9QQUdFX0NEX0RFVklDRTogLyogQ0QgRGV2aWNlIHBhcmFt
ZXRlcnMgKi8KKyAgICBjYXNlIE1PREVfUEFHRV9UT19QUk9URUNUOiAvKiBUaW1lLW91dCBhbmQg
UHJvdGVjdCAqLworICAgIGRlZmF1bHQ6CisgICAgICAgIFNQSUNFX0RFQlVHKCJtb2RlX3NlbnNl
XzEwLCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVAorICAgICAgICAgICAgICAgICAgICAiIHBhZ2Ug
MHgleCBub3QgaW1wbGVtZW50ZWQiLAorICAgICAgICAgICAgICAgICAgICByZXEtPmx1biwgKHVu
c2lnbmVkKXBhZ2UpOworICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRl
diwgcmVxLCAmc2Vuc2VfY29kZV9JTlZBTElEX0NEQl9GSUVMRCk7CisgICAgICAgIHJldHVybjsK
KyAgICB9CisKKyAgICBvdXRidWZbMF0gPSAoKHJlc3BfbGVuIC0gMikgPj4gOCkgJiAweGZmOwor
ICAgIG91dGJ1ZlsxXSA9IChyZXNwX2xlbiAtIDIpICYgMHhmZjsKKworICAgIHJlcS0+aW5fbGVu
ID0gKHJlcS0+cmVxX2xlbiA8IHJlc3BfbGVuKSA/IHJlcS0+cmVxX2xlbiA6IHJlc3BfbGVuOwor
CisgICAgU1BJQ0VfREVCVUcoIm1vZGVfc2Vuc2VfMTAsIGx1bjolIiBHX0dVSU5UMzJfRk9STUFU
CisgICAgICAgICAgICAgICAgIiBsb25nX2xiYSAlZCwgZGJkICVkLCBwYWdlICVkLCBzdWJfcGFn
ZSAlZCwgcGMgJWQ7ICIKKyAgICAgICAgICAgICAgICAicmVzcF9sZW4gJSIgR19HVUlOVDMyX0ZP
Uk1BVCwKKyAgICAgICAgICAgICAgICByZXEtPmx1biwgbG9uZ19sYmEsIGRiZCwgcGFnZSwgc3Vi
X3BhZ2UsIHBjLCByZXNwX2xlbik7CisKKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRl
diwgcmVxKTsKK30KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRfbW9kZV9zZWxlY3RfNihDZFNj
c2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgdWludDhfdCAqYmxvY2tfZGVz
Y19kYXRhLCAqbW9kZV9kYXRhOworICAgIHVpbnQzMl90IHBhZ2VfZm9ybWF0LCBzYXZlX3BhZ2Vz
LCBsaXN0X2xlbjsgLyogY2RiICovCisgICAgdWludDMyX3QgbnVtX2Jsb2NrcyA9IDAsIGJsb2Nr
X2xlbiA9IDA7IC8qIGJsb2NrIGRlc2NyaXB0b3IgKi8KKyAgICB1aW50MzJfdCBtb2RlX2xlbiwg
bWVkaXVtX3R5cGUsIGRldl9wYXJhbSwgYmxvY2tfZGVzY19sZW47IC8qIG1vZGUgcGFyYW0gaGVh
ZGVyICovCisgICAgdWludDMyX3QgcGFnZV9udW0gPSAwLCBwYWdlX2xlbiA9IDA7IC8qIG1vZGUg
cGFnZSAqLworCisgICAgcGFnZV9mb3JtYXQgPSAocmVxLT5jZGJbMV0gPj4gNCkgJiAweDE7Cisg
ICAgc2F2ZV9wYWdlcyA9IHJlcS0+Y2RiWzFdICYgMHgxOworICAgIGxpc3RfbGVuID0gcmVxLT5j
ZGJbNF07CisKKyAgICBpZiAobGlzdF9sZW4gPiByZXEtPmJ1Zl9sZW4pIHsKKyAgICAgICAgU1BJ
Q0VfREVCVUcoIm1vZGVfc2VsZWN0XzYsIGx1bjolIiBHX0dVSU5UMzJfRk9STUFUCisgICAgICAg
ICAgICAgICAgICAgICIgcGY6JSIgR19HVUlOVDMyX0ZPUk1BVCAiIHNwOiUiIEdfR1VJTlQzMl9G
T1JNQVQKKyAgICAgICAgICAgICAgICAgICAgIiBsaXN0X2xlbjolIiBHX0dVSU5UMzJfRk9STUFU
ICIgZXhjZWVkcyBkYXRhX2xlbjolIiBHX0dVSU5UMzJfRk9STUFULAorICAgICAgICAgICAgICAg
ICAgICByZXEtPmx1biwgcGFnZV9mb3JtYXQsIHNhdmVfcGFnZXMsIGxpc3RfbGVuLCByZXEtPmJ1
Zl9sZW4pOworICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVx
LCAmc2Vuc2VfY29kZV9JTlZBTElEX1BBUkFNX0xFTik7CisgICAgICAgIHJldHVybjsKKyAgICB9
CisKKyAgICBtb2RlX2xlbiA9IHJlcS0+YnVmWzBdOworICAgIG1lZGl1bV90eXBlID0gcmVxLT5i
dWZbMV07CisgICAgZGV2X3BhcmFtID0gcmVxLT5idWZbMl07CisgICAgYmxvY2tfZGVzY19sZW4g
PSByZXEtPmJ1ZlszXTsKKworICAgIGlmIChibG9ja19kZXNjX2xlbikgeworICAgICAgICBibG9j
a19kZXNjX2RhdGEgPSAmcmVxLT5idWZbQ0RfTU9ERV9QQVJBTV82X0xFTl9IRUFERVJdOworICAg
ICAgICBudW1fYmxvY2tzID0gKGJsb2NrX2Rlc2NfZGF0YVszXSA8PCAxNikgfCAoYmxvY2tfZGVz
Y19kYXRhWzJdIDw8IDgpIHwgYmxvY2tfZGVzY19kYXRhWzNdOworICAgICAgICBibG9ja19sZW4g
PSAoYmxvY2tfZGVzY19kYXRhWzVdIDw8IDE2KSB8IChibG9ja19kZXNjX2RhdGFbNl0gPDwgOCkg
fCBibG9ja19kZXNjX2RhdGFbN107CisgICAgfQorCisgICAgaWYgKG1vZGVfbGVuKSB7CisgICAg
ICAgIG1vZGVfZGF0YSA9ICZyZXEtPmJ1ZltDRF9NT0RFX1BBUkFNXzZfTEVOX0hFQURFUl07Cisg
ICAgICAgIGlmIChibG9ja19kZXNjX2xlbikgeworICAgICAgICAgICAgbW9kZV9kYXRhICs9IGJs
b2NrX2Rlc2NfbGVuOworICAgICAgICB9CisgICAgICAgIHBhZ2VfbnVtID0gbW9kZV9kYXRhWzBd
ICYgMHgzZjsKKyAgICAgICAgcGFnZV9sZW4gPSBtb2RlX2RhdGFbMV07CisgICAgfQorCisgICAg
U1BJQ0VfREVCVUcoIm1vZGVfc2VsZWN0XzYsIGx1bjolIiBHX0dVSU5UMzJfRk9STUFUCisgICAg
ICAgICAgICAgICAgIiBwZjolIiBHX0dVSU5UMzJfRk9STUFUICIgc3A6JSIgR19HVUlOVDMyX0ZP
Uk1BVAorICAgICAgICAgICAgICAgICIgbGlzdF9sZW46JSIgR19HVUlOVDMyX0ZPUk1BVCAiIGRh
dGFfbGVuOiUiIEdfR1VJTlQzMl9GT1JNQVQKKyAgICAgICAgICAgICAgICAiIG1vZGVfbGVuOiUi
IEdfR1VJTlQzMl9GT1JNQVQgIiBtZWRpdW06JSIgR19HVUlOVDMyX0ZPUk1BVAorICAgICAgICAg
ICAgICAgICIgZGV2X3BhcmFtOiUiIEdfR1VJTlQzMl9GT1JNQVQgIiBibGtfZGVzY19sZW46JSIg
R19HVUlOVDMyX0ZPUk1BVAorICAgICAgICAgICAgICAgICIgbnVtX2Jsb2NrczolIiBHX0dVSU5U
MzJfRk9STUFUICIgYmxvY2tfbGVuOiUiIEdfR1VJTlQzMl9GT1JNQVQKKyAgICAgICAgICAgICAg
ICAiIHBhZ2VfbnVtOiUiIEdfR1VJTlQzMl9GT1JNQVQgIiBwYWdlX2xlbjolIiBHX0dVSU5UMzJf
Rk9STUFULAorICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBwYWdlX2Zvcm1hdCwgc2F2ZV9wYWdl
cywgbGlzdF9sZW4sIHJlcS0+YnVmX2xlbiwKKyAgICAgICAgICAgICAgICBtb2RlX2xlbiwgbWVk
aXVtX3R5cGUsIGRldl9wYXJhbSwgYmxvY2tfZGVzY19sZW4sCisgICAgICAgICAgICAgICAgbnVt
X2Jsb2NrcywgYmxvY2tfbGVuLAorICAgICAgICAgICAgICAgIHBhZ2VfbnVtLCBwYWdlX2xlbik7
CisKKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworc3RhdGlj
IHZvaWQgY2Rfc2NzaV9jbWRfbW9kZV9zZWxlY3RfMTAoQ2RTY3NpTFUgKmRldiwgQ2RTY3NpUmVx
dWVzdCAqcmVxKQoreworICAgIHVpbnQzMl90IHBhZ2VfZm9ybWF0LCBzYXZlX3BhZ2VzLCBsaXN0
X2xlbjsKKworICAgIHBhZ2VfZm9ybWF0ID0gKHJlcS0+Y2RiWzFdID4+IDQpICYgMHgxOworICAg
IHNhdmVfcGFnZXMgPSByZXEtPmNkYlsxXSAmIDB4MTsKKyAgICBsaXN0X2xlbiA9IChyZXEtPmNk
Yls3XSA8PCA4KSB8IHJlcS0+Y2RiWzhdOworCisgICAgaWYgKGxpc3RfbGVuID4gcmVxLT5idWZf
bGVuKSB7CisgICAgICAgIFNQSUNFX0RFQlVHKCJtb2RlX3NlbGVjdF8xMCwgbHVuOiUiIEdfR1VJ
TlQzMl9GT1JNQVQKKyAgICAgICAgICAgICAgICAgICAgIiBwZjolIiBHX0dVSU5UMzJfRk9STUFU
ICIgc3A6JSIgR19HVUlOVDMyX0ZPUk1BVAorICAgICAgICAgICAgICAgICAgICAiIGxpc3RfbGVu
OiUiIEdfR1VJTlQzMl9GT1JNQVQgIiBleGNlZWRzIGRhdGFfbGVuOiUiIEdfR1VJTlQzMl9GT1JN
QVQsCisgICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBwYWdlX2Zvcm1hdCwgc2F2ZV9wYWdl
cywgbGlzdF9sZW4sIHJlcS0+YnVmX2xlbik7CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRl
X2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX0lOVkFMSURfUEFSQU1fTEVOKTsKKyAg
ICAgICAgcmV0dXJuOworICAgIH0KKworICAgIFNQSUNFX0RFQlVHKCJtb2RlX3NlbGVjdF8xMCwg
bHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQKKyAgICAgICAgICAgICAgICAiIHBmOiUiIEdfR1VJTlQz
Ml9GT1JNQVQgIiBzcDolIiBHX0dVSU5UMzJfRk9STUFUCisgICAgICAgICAgICAgICAgIiBsaXN0
X2xlbjolIiBHX0dVSU5UMzJfRk9STUFUICIgZGF0YV9sZW46JSIgR19HVUlOVDMyX0ZPUk1BVCwK
KyAgICAgICAgICAgICAgICByZXEtPmx1biwgcGFnZV9mb3JtYXQsIHNhdmVfcGFnZXMsIGxpc3Rf
bGVuLCByZXEtPmJ1Zl9sZW4pOworCisgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfZ29vZChkZXYs
IHJlcSk7Cit9CisKKyNkZWZpbmUgQ0RfRkVBVFVSRV9IRUFERVJfTEVOICAgICAgICAgICAgICAg
OAorI2RlZmluZSBDRF9GRUFUVVJFX0RFU0NfTEVOICAgICAgICAgICAgICAgICA0CisKKyNkZWZp
bmUgQ0RfUFJPRklMRV9ERVNDX0xFTiAgICAgICAgICAgICAgICAgNAorI2RlZmluZSBDRF9QUk9G
SUxFX0NVUlJFTlQgICAgICAgICAgICAgICAgICAweDAxCisKKy8qIFByb2ZpbGVzIExpc3QgKi8K
KyNkZWZpbmUgQ0RfRkVBVFVSRV9OVU1fUFJPRklMRVNfTElTVCAgICAgICAgMHgwMAorLyogQ29y
ZSAtIEJhc2ljIEZ1bmN0aW9uYWxpdHkgKi8KKyNkZWZpbmUgQ0RfRkVBVFVSRV9OVU1fQ09SRSAg
ICAgICAgICAgICAgICAgMHgwMQorLyogTW9ycGhpbmcgLSBUaGUgZGV2aWNlIGNoYW5nZXMgaXRz
IGJlaGF2aW9yIGR1ZSB0byBleHRlcm5hbCBldmVudHMgKi8KKyNkZWZpbmUgQ0RfRkVBVFVSRV9O
VU1fTU9SUEggICAgICAgICAgICAgICAgMHgwMgorLyogUmVtb3ZhYmxlIE1lZGl1bSAtIFRoZSBt
ZWRpdW0gbWF5IGJlIHJlbW92ZWQgZnJvbSB0aGUgZGV2aWNlICovCisjZGVmaW5lIENEX0ZFQVRV
UkVfTlVNX1JFTU9WQUJMRSAgICAgICAgICAgIDB4MDMKKy8qIFJhbmRvbSBSZWFkYWJsZSAtIFBQ
PTEgUmVhZCBhYmlsaXR5IGZvciBzdG9yYWdlIGRldmljZXMgd2l0aCByYW5kb20gYWRkcmVzc2lu
ZyAqLworI2RlZmluZSBDRF9GRUFUVVJFX05VTV9SQU5ET01fUkVBRCAgICAgICAgICAweDEwCisv
KiBDRCBSZWFkIC0gVGhlIGFiaWxpdHkgdG8gcmVhZCBDRCBzcGVjaWZpYyBzdHJ1Y3R1cmVzICov
CisjZGVmaW5lIENEX0ZFQVRVUkVfTlVNX0NEX1JFQUQgICAgICAgICAgICAgIDB4MUUKKy8qIERW
RCBSZWFkIC0gVGhlIGFiaWxpdHkgdG8gcmVhZCBEVkQgc3BlY2lmaWMgc3RydWN0dXJlcyAqLwor
I2RlZmluZSBDRF9GRUFUVVJFX05VTV9EVkRfUkVBRCAgICAgICAgICAgICAweDFGCisvKiBQb3dl
ciBNYW5hZ2VtZW50IC0gSW5pdGlhdG9yIGFuZCBkZXZpY2UgZGlyZWN0ZWQgcG93ZXIgbWFuYWdl
bWVudCAqLworI2RlZmluZSBDRF9GRUFUVVJFX05VTV9QT1dFUl9NTkdUICAgICAgICAgICAweDEw
MAorLyogVGltZW91dCAqLworI2RlZmluZSBDRF9GRUFUVVJFX05VTV9USU1FT1VUICAgICAgICAg
ICAgICAweDEwNQorCisjZGVmaW5lIENEX0ZFQVRVUkVfUkVRX0FMTCAgICAgICAgICAgICAgICAg
IDAKKyNkZWZpbmUgQ0RfRkVBVFVSRV9SRVFfQ1VSUkVOVCAgICAgICAgICAgICAgMQorI2RlZmlu
ZSBDRF9GRUFUVVJFX1JFUV9TSU5HTEUgICAgICAgICAgICAgICAyCisKKyNkZWZpbmUgQ0RfRkVB
VFVSRV9DVVJSRU5UICAgICAgICAgICAgICAgICAgMHgwMQorI2RlZmluZSBDRF9GRUFUVVJFX1BF
UlNJU1RFTlQgICAgICAgICAgICAgICAweDAyCisKKyNkZWZpbmUgQ0RfRkVBVFVSRV9WRVJTSU9O
XzEgICAgICAgICAgICAgICAgKDB4MDEgPDwgMikKKworI2RlZmluZSBDRF9GRUFUVVJFX1BIWVNf
SUZfU0NTSSAgICAgICAgICAgICAweDAxCisKKyNkZWZpbmUgQ0RfRkVBVFVSRV9SRU1PVkFCTEVf
TE9BRElOR19UUkFZICAgKDB4MDEgPDwgNSkKKyNkZWZpbmUgQ0RfRkVBVFVSRV9SRU1PVkFCTEVf
RUpFQ1QgICAgICAgICAgKDB4MDEgPDwgMykKKyNkZWZpbmUgQ0RfRkVBVFVSRV9SRU1PVkFCTEVf
Tk9fUFJWTlRfSk1QUiAgKDB4MDEgPDwgMikKKyNkZWZpbmUgQ0RfRkVBVFVSRV9SRU1PVkFCTEVf
TE9DSyAgICAgICAgICAgKDB4MDEpCisKK3N0YXRpYyBnYm9vbGVhbiBjZF9zY3NpX2ZlYXR1cmVf
cmVwb3J0YWJsZSh1aW50MzJfdCBmZWF0dXJlLCB1aW50MzJfdCBzdGFydF9mZWF0dXJlLAorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IHJlcV90eXBl
KQoreworICAgIHJldHVybiAocmVxX3R5cGUgPT0gQ0RfRkVBVFVSRV9SRVFfU0lOR0xFICYmIHN0
YXJ0X2ZlYXR1cmUgPT0gZmVhdHVyZSkgfHwKKyAgICAgICAgICAgKGZlYXR1cmUgPj0gc3RhcnRf
ZmVhdHVyZSk7Cit9CisKK3N0YXRpYyB1aW50MzJfdCBjZF9zY3NpX2FkZF9mZWF0dXJlX3Byb2Zp
bGVzX2xpc3QoQ2RTY3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVmLAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCBzdGFydF9mZWF0dXJl
LCB1aW50MzJfdCByZXFfdHlwZSkKK3sKKyAgICB1aW50OF90ICpwcm9maWxlID0gb3V0YnVmICsg
Q0RfRkVBVFVSRV9ERVNDX0xFTjsKKyAgICB1aW50MzJfdCBmZWF0dXJlX2xlbiA9IENEX0ZFQVRV
UkVfREVTQ19MRU47CisgICAgdWludDMyX3QgYWRkX2xlbiwgcHJvZmlsZV9udW07CisKKyAgICBp
ZiAoIWNkX3Njc2lfZmVhdHVyZV9yZXBvcnRhYmxlKENEX0ZFQVRVUkVfTlVNX1BST0ZJTEVTX0xJ
U1QsIHN0YXJ0X2ZlYXR1cmUsIHJlcV90eXBlKSkgeworICAgICAgICByZXR1cm4gMDsKKyAgICB9
CisgICAgLyogZmVhdHVyZSBkZXNjcmlwdG9yIGhlYWRlciAqLworICAgIG91dGJ1ZlswXSA9IChD
RF9GRUFUVVJFX05VTV9QUk9GSUxFU19MSVNUID4+IDgpICYgMHhmZjsKKyAgICBvdXRidWZbMV0g
PSBDRF9GRUFUVVJFX05VTV9QUk9GSUxFU19MSVNUICYgMHhmZjsKKyAgICBvdXRidWZbMl0gPSBD
RF9GRUFUVVJFX1BFUlNJU1RFTlQgfCBDRF9GRUFUVVJFX0NVUlJFTlQ7CisKKyAgICAvKiBEVkQt
Uk9NIHByb2ZpbGUgZGVzY3JpcHRvciAqLworICAgIGFkZF9sZW4gPSBDRF9QUk9GSUxFX0RFU0Nf
TEVOOyAvKiBzdGFydCB3aXRoIHNpbmdsZSBwcm9maWxlLCBhZGQgbGF0ZXIgKi8KKyAgICBwcm9m
aWxlX251bSA9IE1NQ19QUk9GSUxFX0RWRF9ST007CisKKyAgICBwcm9maWxlWzBdID0gKHByb2Zp
bGVfbnVtID4+IDgpICYgMHhmZjsgLyogZmVhdHVyZSBjb2RlICovCisgICAgcHJvZmlsZVsxXSA9
IHByb2ZpbGVfbnVtICYgMHhmZjsKKyAgICBwcm9maWxlWzJdID0gKCFkZXYtPmNkX3JvbSkgPyBD
RF9QUk9GSUxFX0NVUlJFTlQgOiAwOworCisgICAgLyogbmV4dCBwcm9maWxlICovCisgICAgYWRk
X2xlbiArPSBDRF9QUk9GSUxFX0RFU0NfTEVOOworICAgIHByb2ZpbGUgKz0gQ0RfUFJPRklMRV9E
RVNDX0xFTjsKKworICAgIC8qIENELVJPTSBwcm9maWxlIGRlc2NyaXB0b3IgKi8KKyAgICBwcm9m
aWxlX251bSA9IE1NQ19QUk9GSUxFX0NEX1JPTTsKKyAgICBwcm9maWxlWzBdID0gKHByb2ZpbGVf
bnVtID4+IDgpICYgMHhmZjsKKyAgICBwcm9maWxlWzFdID0gcHJvZmlsZV9udW0gJiAweGZmOwor
ICAgIHByb2ZpbGVbMl0gPSBkZXYtPmNkX3JvbSA/IENEX1BST0ZJTEVfQ1VSUkVOVCA6IDA7CisK
KyAgICBvdXRidWZbM10gPSBhZGRfbGVuOworICAgIGZlYXR1cmVfbGVuICs9IGFkZF9sZW47CisK
KyAgICByZXR1cm4gZmVhdHVyZV9sZW47Cit9CisKKyNkZWZpbmUgQ0RfRkVBVFVSRV9DT1JFX1BI
WVNfUFJPRklMRV9MRU4gICAgNAorCitzdGF0aWMgdWludDMyX3QgY2Rfc2NzaV9hZGRfZmVhdHVy
ZV9jb3JlKENkU2NzaUxVICpkZXYsIHVpbnQ4X3QgKm91dGJ1ZiwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyX3Qgc3RhcnRfZmVhdHVyZSwgdWludDMyX3Qg
cmVxX3R5cGUpCit7CisgICAgdWludDhfdCAqcHJvZmlsZSA9IG91dGJ1ZiArIENEX0ZFQVRVUkVf
REVTQ19MRU47CisgICAgdWludDMyX3QgZmVhdHVyZV9sZW4gPSBDRF9GRUFUVVJFX0RFU0NfTEVO
ICsgQ0RfRkVBVFVSRV9DT1JFX1BIWVNfUFJPRklMRV9MRU47CisKKyAgICBpZiAoIWNkX3Njc2lf
ZmVhdHVyZV9yZXBvcnRhYmxlKENEX0ZFQVRVUkVfTlVNX0NPUkUsIHN0YXJ0X2ZlYXR1cmUsIHJl
cV90eXBlKSkgeworICAgICAgICByZXR1cm4gMDsKKyAgICB9CisgICAgb3V0YnVmWzBdID0gKENE
X0ZFQVRVUkVfTlVNX0NPUkUgPj4gOCkgJiAweGZmOworICAgIG91dGJ1ZlsxXSA9IENEX0ZFQVRV
UkVfTlVNX0NPUkUgJiAweGZmOworICAgIG91dGJ1ZlsyXSA9IENEX0ZFQVRVUkVfUEVSU0lTVEVO
VCB8IENEX0ZFQVRVUkVfQ1VSUkVOVDsKKyAgICBvdXRidWZbM10gPSBDRF9GRUFUVVJFX0NPUkVf
UEhZU19QUk9GSUxFX0xFTjsKKworICAgIHByb2ZpbGVbM10gPSBDRF9GRUFUVVJFX1BIWVNfSUZf
U0NTSTsKKworICAgIHJldHVybiBmZWF0dXJlX2xlbjsKK30KKworI2RlZmluZSBDRF9GRUFUVVJF
X01PUlBIX1BST0dJTEVfTEVOICAgIDQKKyNkZWZpbmUgQ0RfRkVBVFVSRV9NT1JQSF9BU1lOQ19F
VkVOVFMgICAweDAxCisKK3N0YXRpYyB1aW50MzJfdCBjZF9zY3NpX2FkZF9mZWF0dXJlX21vcnBo
KENkU2NzaUxVICpkZXYsIHVpbnQ4X3QgKm91dGJ1ZiwKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IHN0YXJ0X2ZlYXR1cmUsIHVpbnQzMl90IHJlcV90
eXBlKQoreworICAgIHVpbnQ4X3QgKnByb2ZpbGUgPSBvdXRidWYgKyBDRF9GRUFUVVJFX0RFU0Nf
TEVOOworICAgIHVpbnQzMl90IGZlYXR1cmVfbGVuID0gQ0RfRkVBVFVSRV9ERVNDX0xFTiArIENE
X0ZFQVRVUkVfTU9SUEhfUFJPR0lMRV9MRU47CisKKyAgICBpZiAoIWNkX3Njc2lfZmVhdHVyZV9y
ZXBvcnRhYmxlKENEX0ZFQVRVUkVfTlVNX01PUlBILCBzdGFydF9mZWF0dXJlLCByZXFfdHlwZSkp
IHsKKyAgICAgICAgcmV0dXJuIDA7CisgICAgfQorICAgIG91dGJ1ZlsxXSA9IENEX0ZFQVRVUkVf
TlVNX01PUlBIOworICAgIG91dGJ1ZlsyXSA9IENEX0ZFQVRVUkVfUEVSU0lTVEVOVCB8IENEX0ZF
QVRVUkVfQ1VSUkVOVDsKKyAgICBvdXRidWZbM10gPSBDRF9GRUFUVVJFX01PUlBIX1BST0dJTEVf
TEVOOworCisgICAgcHJvZmlsZVswXSA9IENEX0ZFQVRVUkVfTU9SUEhfQVNZTkNfRVZFTlRTOwor
CisgICAgcmV0dXJuIGZlYXR1cmVfbGVuOworfQorCisjZGVmaW5lIENEX0ZFQVRVUkVfUkVNT1ZB
QkxFX1BST0ZJTEVfTEVOICAgIDQKKworc3RhdGljIHVpbnQzMl90IGNkX3Njc2lfYWRkX2ZlYXR1
cmVfcmVtb3ZhYmxlKENkU2NzaUxVICpkZXYsIHVpbnQ4X3QgKm91dGJ1ZiwKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCBzdGFydF9mZWF0dXJl
LCB1aW50MzJfdCByZXFfdHlwZSkKK3sKKyAgICB1aW50OF90ICpwcm9maWxlID0gb3V0YnVmICsg
Q0RfRkVBVFVSRV9ERVNDX0xFTjsKKyAgICB1aW50MzJfdCBmZWF0dXJlX2xlbiA9IENEX0ZFQVRV
UkVfREVTQ19MRU4gKyBDRF9GRUFUVVJFX1JFTU9WQUJMRV9QUk9GSUxFX0xFTjsKKworICAgIGlm
ICghY2Rfc2NzaV9mZWF0dXJlX3JlcG9ydGFibGUoQ0RfRkVBVFVSRV9OVU1fUkVNT1ZBQkxFLCBz
dGFydF9mZWF0dXJlLCByZXFfdHlwZSkpIHsKKyAgICAgICAgcmV0dXJuIDA7CisgICAgfQorICAg
IG91dGJ1ZlsxXSA9IENEX0ZFQVRVUkVfTlVNX1JFTU9WQUJMRTsKKyAgICBvdXRidWZbMl0gPSBD
RF9GRUFUVVJFX1BFUlNJU1RFTlQgfCBDRF9GRUFUVVJFX0NVUlJFTlQ7CisgICAgb3V0YnVmWzNd
ID0gQ0RfRkVBVFVSRV9SRU1PVkFCTEVfUFJPRklMRV9MRU47CisKKyAgICBwcm9maWxlWzBdID0g
Q0RfRkVBVFVSRV9SRU1PVkFCTEVfTk9fUFJWTlRfSk1QUjsKKyAgICBpZiAoZGV2LT5yZW1vdmFi
bGUpIHsKKyAgICAgICAgcHJvZmlsZVswXSB8PSAoQ0RfRkVBVFVSRV9SRU1PVkFCTEVfTE9BRElO
R19UUkFZIHwgQ0RfRkVBVFVSRV9SRU1PVkFCTEVfRUpFQ1QpOworICAgIH0KKworICAgIHJldHVy
biBmZWF0dXJlX2xlbjsKK30KKworI2RlZmluZSBDRF9GRUFUVVJFX1JBTkRPTV9SRUFEX1BST0ZJ
TEVfTEVOICAgIDgKKworc3RhdGljIHVpbnQzMl90IGNkX3Njc2lfYWRkX2ZlYXR1cmVfcmFuZG9t
X3JlYWQoQ2RTY3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVmLAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyX3Qgc3RhcnRfZmVhdHVyZSwgdWlu
dDMyX3QgcmVxX3R5cGUpCit7CisgICAgdWludDhfdCAqcHJvZmlsZSA9IG91dGJ1ZiArIENEX0ZF
QVRVUkVfREVTQ19MRU47CisgICAgdWludDMyX3QgZmVhdHVyZV9sZW4gPSBDRF9GRUFUVVJFX0RF
U0NfTEVOICsgQ0RfRkVBVFVSRV9SQU5ET01fUkVBRF9QUk9GSUxFX0xFTjsKKworICAgIGlmICgh
Y2Rfc2NzaV9mZWF0dXJlX3JlcG9ydGFibGUoQ0RfRkVBVFVSRV9OVU1fUkFORE9NX1JFQUQsIHN0
YXJ0X2ZlYXR1cmUsIHJlcV90eXBlKSkgeworICAgICAgICByZXR1cm4gMDsKKyAgICB9CisgICAg
b3V0YnVmWzBdID0gKENEX0ZFQVRVUkVfTlVNX1JBTkRPTV9SRUFEID4+IDgpICYgMHhmZjsKKyAg
ICBvdXRidWZbMV0gPSBDRF9GRUFUVVJFX05VTV9SQU5ET01fUkVBRCAmIDB4ZmY7CisgICAgb3V0
YnVmWzJdID0gQ0RfRkVBVFVSRV9QRVJTSVNURU5UIHwgQ0RfRkVBVFVSRV9DVVJSRU5UOworICAg
IG91dGJ1ZlszXSA9IENEX0ZFQVRVUkVfUkFORE9NX1JFQURfUFJPRklMRV9MRU47CisKKyAgICBw
cm9maWxlWzBdID0gKGRldi0+YmxvY2tfc2l6ZSA+PiAyNCkgJiAweGZmOworICAgIHByb2ZpbGVb
MV0gPSAoZGV2LT5ibG9ja19zaXplID4+IDE2KSAmIDB4ZmY7CisgICAgcHJvZmlsZVsyXSA9IChk
ZXYtPmJsb2NrX3NpemUgPj4gOCkgJiAweGZmOworICAgIHByb2ZpbGVbM10gPSAoZGV2LT5ibG9j
a19zaXplKSAmIDB4ZmY7CisgICAgcHJvZmlsZVs1XSA9IChkZXYtPmNkX3JvbSkgPyAweDAxIDog
MHgxMDsgLyogbG9naWNhbCBibG9ja3MgcGVyIHJlYWRhYmxlIHVuaXQgKi8KKworICAgIHJldHVy
biBmZWF0dXJlX2xlbjsKK30KKworI2RlZmluZSBDRF9GRUFUVVJFX0NEX1JFQURfUFJPRklMRV9M
RU4gICAgNAorCitzdGF0aWMgdWludDMyX3QgY2Rfc2NzaV9hZGRfZmVhdHVyZV9jZF9yZWFkKENk
U2NzaUxVICpkZXYsIHVpbnQ4X3QgKm91dGJ1ZiwKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgdWludDMyX3Qgc3RhcnRfZmVhdHVyZSwgdWludDMyX3QgcmVxX3R5
cGUpCit7CisgICAgdWludDhfdCAqcHJvZmlsZSA9IG91dGJ1ZiArIENEX0ZFQVRVUkVfREVTQ19M
RU47CisgICAgdWludDMyX3QgZmVhdHVyZV9sZW4gPSBDRF9GRUFUVVJFX0RFU0NfTEVOICsgQ0Rf
RkVBVFVSRV9DRF9SRUFEX1BST0ZJTEVfTEVOOworCisgICAgaWYgKCFjZF9zY3NpX2ZlYXR1cmVf
cmVwb3J0YWJsZShDRF9GRUFUVVJFX05VTV9DRF9SRUFELCBzdGFydF9mZWF0dXJlLCByZXFfdHlw
ZSkpIHsKKyAgICAgICAgcmV0dXJuIDA7CisgICAgfQorICAgIG91dGJ1ZlswXSA9IChDRF9GRUFU
VVJFX05VTV9DRF9SRUFEID4+IDgpICYgMHhmZjsKKyAgICBvdXRidWZbMV0gPSAoQ0RfRkVBVFVS
RV9OVU1fQ0RfUkVBRCkgJiAweGZmOworICAgIG91dGJ1ZlsyXSA9IENEX0ZFQVRVUkVfVkVSU0lP
Tl8xIHwgQ0RfRkVBVFVSRV9QRVJTSVNURU5UIHwgQ0RfRkVBVFVSRV9DVVJSRU5UOworICAgIG91
dGJ1ZlszXSA9IENEX0ZFQVRVUkVfQ0RfUkVBRF9QUk9GSUxFX0xFTjsKKworICAgIHByb2ZpbGVb
MF0gPSAwOyAvKiBDMiBFcnJvcnMsIENELVRleHQgbm90IHN1cHBvcnRlICovCisKKyAgICByZXR1
cm4gZmVhdHVyZV9sZW47Cit9CisKKyNkZWZpbmUgQ0RfRkVBVFVSRV9EVkRfUkVBRF9QUk9GSUxF
X0xFTiAgICAwCisKK3N0YXRpYyB1aW50MzJfdCBjZF9zY3NpX2FkZF9mZWF0dXJlX2R2ZF9yZWFk
KENkU2NzaUxVICpkZXYsIHVpbnQ4X3QgKm91dGJ1ZiwKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IHN0YXJ0X2ZlYXR1cmUsIHVpbnQzMl90IHJl
cV90eXBlKQoreworICAgIHVpbnQzMl90IGZlYXR1cmVfbGVuID0gQ0RfRkVBVFVSRV9ERVNDX0xF
TiArIENEX0ZFQVRVUkVfRFZEX1JFQURfUFJPRklMRV9MRU47CisKKyAgICBpZiAoIWNkX3Njc2lf
ZmVhdHVyZV9yZXBvcnRhYmxlKENEX0ZFQVRVUkVfTlVNX0NEX1JFQUQsIHN0YXJ0X2ZlYXR1cmUs
IHJlcV90eXBlKSkgeworICAgICAgICByZXR1cm4gMDsKKyAgICB9CisgICAgb3V0YnVmWzBdID0g
KENEX0ZFQVRVUkVfTlVNX0RWRF9SRUFEID4+IDgpICYgMHhmZjsKKyAgICBvdXRidWZbMV0gPSAo
Q0RfRkVBVFVSRV9OVU1fRFZEX1JFQUQpICYgMHhmZjsKKyAgICBvdXRidWZbMl0gPSBDRF9GRUFU
VVJFX1ZFUlNJT05fMSB8IENEX0ZFQVRVUkVfUEVSU0lTVEVOVCB8IENEX0ZFQVRVUkVfQ1VSUkVO
VDsKKyAgICBvdXRidWZbM10gPSBDRF9GRUFUVVJFX0RWRF9SRUFEX1BST0ZJTEVfTEVOOworCisg
ICAgcmV0dXJuIGZlYXR1cmVfbGVuOworfQorCisjZGVmaW5lIENEX0ZFQVRVUkVfUE9XRVJfTU5H
VF9QUk9GSUxFX0xFTiAgICAwCisKK3N0YXRpYyB1aW50MzJfdCBjZF9zY3NpX2FkZF9mZWF0dXJl
X3Bvd2VyX21nbXQoQ2RTY3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVmLAorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCBzdGFydF9mZWF0dXJl
LCB1aW50MzJfdCByZXFfdHlwZSkKK3sKKyAgICB1aW50MzJfdCBmZWF0dXJlX2xlbiA9IENEX0ZF
QVRVUkVfREVTQ19MRU4gKyBDRF9GRUFUVVJFX1BPV0VSX01OR1RfUFJPRklMRV9MRU47CisKKyAg
ICBpZiAoIWNkX3Njc2lfZmVhdHVyZV9yZXBvcnRhYmxlKENEX0ZFQVRVUkVfTlVNX1BPV0VSX01O
R1QsIHN0YXJ0X2ZlYXR1cmUsIHJlcV90eXBlKSkgeworICAgICAgICByZXR1cm4gMDsKKyAgICB9
CisgICAgb3V0YnVmWzBdID0gKENEX0ZFQVRVUkVfTlVNX1BPV0VSX01OR1QgPj4gOCkgJiAweGZm
OworICAgIG91dGJ1ZlsxXSA9IChDRF9GRUFUVVJFX05VTV9QT1dFUl9NTkdUKSAmIDB4ZmY7Cisg
ICAgb3V0YnVmWzJdID0gQ0RfRkVBVFVSRV9QRVJTSVNURU5UIHwgQ0RfRkVBVFVSRV9DVVJSRU5U
OworICAgIG91dGJ1ZlszXSA9IENEX0ZFQVRVUkVfUE9XRVJfTU5HVF9QUk9GSUxFX0xFTjsKKwor
ICAgIHJldHVybiBmZWF0dXJlX2xlbjsKK30KKworI2RlZmluZSBDRF9GRUFUVVJFX1RJTUVPVVRf
UFJPRklMRV9MRU4gICAgMAorCitzdGF0aWMgdWludDMyX3QgY2Rfc2NzaV9hZGRfZmVhdHVyZV90
aW1lb3V0KENkU2NzaUxVICpkZXYsIHVpbnQ4X3QgKm91dGJ1ZiwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyX3Qgc3RhcnRfZmVhdHVyZSwgdWludDMy
X3QgcmVxX3R5cGUpCit7CisgICAgdWludDMyX3QgZmVhdHVyZV9sZW4gPSBDRF9GRUFUVVJFX0RF
U0NfTEVOICsgQ0RfRkVBVFVSRV9USU1FT1VUX1BST0ZJTEVfTEVOOworCisgICAgaWYgKCFjZF9z
Y3NpX2ZlYXR1cmVfcmVwb3J0YWJsZShDRF9GRUFUVVJFX05VTV9USU1FT1VULCBzdGFydF9mZWF0
dXJlLCByZXFfdHlwZSkpIHsKKyAgICAgICAgcmV0dXJuIDA7CisgICAgfQorICAgIG91dGJ1Zlsw
XSA9IChDRF9GRUFUVVJFX05VTV9USU1FT1VUID4+IDgpICYgMHhmZjsKKyAgICBvdXRidWZbMV0g
PSBDRF9GRUFUVVJFX05VTV9USU1FT1VUICYgMHhmZjsKKyAgICBvdXRidWZbMl0gPSBDRF9GRUFU
VVJFX1BFUlNJU1RFTlQgfCBDRF9GRUFUVVJFX0NVUlJFTlQ7CisgICAgb3V0YnVmWzNdID0gQ0Rf
RkVBVFVSRV9USU1FT1VUX1BST0ZJTEVfTEVOOworCisgICAgcmV0dXJuIGZlYXR1cmVfbGVuOwor
fQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9nZXRfY29uZmlndXJhdGlvbihDZFNjc2lMVSAq
ZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgdWludDhfdCAqb3V0YnVmID0gcmVxLT5i
dWY7CisgICAgdWludDMyX3QgcHJvZmlsZV9udW0gPSAoIWRldi0+Y2Rfcm9tKSA/IE1NQ19QUk9G
SUxFX0RWRF9ST00gOiBNTUNfUFJPRklMRV9DRF9ST007CisgICAgdWludDMyX3QgcmVxX3R5cGUs
IHN0YXJ0X2ZlYXR1cmUsIHJlc3BfbGVuOworCisgICAgcmVxLT54ZmVyX2RpciA9IFNDU0lfWEZF
Ul9GUk9NX0RFVjsKKworICAgIHJlcV90eXBlID0gcmVxLT5jZGJbMV0gJiAweDM7CisgICAgc3Rh
cnRfZmVhdHVyZSA9IChyZXEtPmNkYlsyXSA8PCA4KSB8IHJlcS0+Y2RiWzNdOworICAgIHJlcS0+
cmVxX2xlbiA9IChyZXEtPmNkYls3XSA8PCA4KSB8IHJlcS0+Y2RiWzhdOworCisgICAgbWVtc2V0
KG91dGJ1ZiwgMCwgcmVxLT5yZXFfbGVuKTsKKworICAgIC8qIGF0IGxlYXN0IEZlYXR1cmUgSGVh
ZGVyIHNob3VsZCBiZSBwcmVzZW50LCB0byBiZSBmaWxsZWQgbGF0ZXIgKi8KKyAgICByZXNwX2xl
biA9IENEX0ZFQVRVUkVfSEVBREVSX0xFTjsKKworICAgIHN3aXRjaCAocmVxX3R5cGUpIHsKKyAg
ICBjYXNlIENEX0ZFQVRVUkVfUkVRX0FMTDoKKyAgICBjYXNlIENEX0ZFQVRVUkVfUkVRX0NVUlJF
TlQ6CisgICAgICAgIHJlc3BfbGVuICs9IGNkX3Njc2lfYWRkX2ZlYXR1cmVfcHJvZmlsZXNfbGlz
dChkZXYsIG91dGJ1ZiArIHJlc3BfbGVuLCBzdGFydF9mZWF0dXJlLAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxX3R5cGUpOworICAgICAg
ICByZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9mZWF0dXJlX2NvcmUoZGV2LCBvdXRidWYgKyByZXNw
X2xlbiwgc3RhcnRfZmVhdHVyZSwgcmVxX3R5cGUpOworICAgICAgICByZXNwX2xlbiArPSBjZF9z
Y3NpX2FkZF9mZWF0dXJlX21vcnBoKGRldiwgb3V0YnVmICsgcmVzcF9sZW4sIHN0YXJ0X2ZlYXR1
cmUsIHJlcV90eXBlKTsKKyAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9hZGRfZmVhdHVyZV9y
ZW1vdmFibGUoZGV2LCBvdXRidWYgKyByZXNwX2xlbiwgc3RhcnRfZmVhdHVyZSwgcmVxX3R5cGUp
OworICAgICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9mZWF0dXJlX3JhbmRvbV9yZWFkKGRl
diwgb3V0YnVmICsgcmVzcF9sZW4sIHN0YXJ0X2ZlYXR1cmUsCisgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxX3R5cGUpOworICAgICAgICByZXNw
X2xlbiArPSBjZF9zY3NpX2FkZF9mZWF0dXJlX2NkX3JlYWQoZGV2LCBvdXRidWYgKyByZXNwX2xl
biwgc3RhcnRfZmVhdHVyZSwgcmVxX3R5cGUpOworICAgICAgICByZXNwX2xlbiArPSBjZF9zY3Np
X2FkZF9mZWF0dXJlX2R2ZF9yZWFkKGRldiwgb3V0YnVmICsgcmVzcF9sZW4sIHN0YXJ0X2ZlYXR1
cmUsIHJlcV90eXBlKTsKKyAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9hZGRfZmVhdHVyZV9w
b3dlcl9tZ210KGRldiwgb3V0YnVmICsgcmVzcF9sZW4sIHN0YXJ0X2ZlYXR1cmUsIHJlcV90eXBl
KTsKKyAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9hZGRfZmVhdHVyZV90aW1lb3V0KGRldiwg
b3V0YnVmICsgcmVzcF9sZW4sIHN0YXJ0X2ZlYXR1cmUsIHJlcV90eXBlKTsKKyAgICAgICAgYnJl
YWs7CisgICAgY2FzZSBDRF9GRUFUVVJFX1JFUV9TSU5HTEU6CisgICAgICAgIHN3aXRjaCAoc3Rh
cnRfZmVhdHVyZSkgeworICAgICAgICBjYXNlIENEX0ZFQVRVUkVfTlVNX0NPUkU6CisgICAgICAg
ICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9mZWF0dXJlX2NvcmUoZGV2LCBvdXRidWYgKyBy
ZXNwX2xlbiwgc3RhcnRfZmVhdHVyZSwgcmVxX3R5cGUpOworICAgICAgICAgICAgYnJlYWs7Cisg
ICAgICAgIGNhc2UgQ0RfRkVBVFVSRV9OVU1fTU9SUEg6CisgICAgICAgICAgICByZXNwX2xlbiAr
PSBjZF9zY3NpX2FkZF9mZWF0dXJlX21vcnBoKGRldiwgb3V0YnVmICsgcmVzcF9sZW4sIHN0YXJ0
X2ZlYXR1cmUsIHJlcV90eXBlKTsKKyAgICAgICAgICAgIGJyZWFrOworICAgICAgICBjYXNlIENE
X0ZFQVRVUkVfTlVNX1JFTU9WQUJMRToKKyAgICAgICAgICAgIHJlc3BfbGVuICs9IGNkX3Njc2lf
YWRkX2ZlYXR1cmVfcmVtb3ZhYmxlKGRldiwgb3V0YnVmICsgcmVzcF9sZW4sIHN0YXJ0X2ZlYXR1
cmUsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICByZXFfdHlwZSk7CisgICAgICAgICAgICBicmVhazsKKyAgICAgICAgY2FzZSBDRF9GRUFUVVJF
X05VTV9SQU5ET01fUkVBRDoKKyAgICAgICAgICAgIHJlc3BfbGVuICs9IGNkX3Njc2lfYWRkX2Zl
YXR1cmVfcmFuZG9tX3JlYWQoZGV2LCBvdXRidWYgKyByZXNwX2xlbiwgc3RhcnRfZmVhdHVyZSwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
cmVxX3R5cGUpOworICAgICAgICAgICAgYnJlYWs7CisgICAgICAgIGNhc2UgQ0RfRkVBVFVSRV9O
VU1fQ0RfUkVBRDoKKyAgICAgICAgICAgIHJlc3BfbGVuICs9IGNkX3Njc2lfYWRkX2ZlYXR1cmVf
Y2RfcmVhZChkZXYsIG91dGJ1ZiArIHJlc3BfbGVuLCBzdGFydF9mZWF0dXJlLAorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcV90eXBlKTsKKyAg
ICAgICAgICAgIGJyZWFrOworICAgICAgICBjYXNlIENEX0ZFQVRVUkVfTlVNX0RWRF9SRUFEOgor
ICAgICAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9hZGRfZmVhdHVyZV9kdmRfcmVhZChkZXYs
IG91dGJ1ZiArIHJlc3BfbGVuLCBzdGFydF9mZWF0dXJlLAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXFfdHlwZSk7CisgICAgICAgICAgICBi
cmVhazsKKyAgICAgICAgY2FzZSBDRF9GRUFUVVJFX05VTV9QT1dFUl9NTkdUOgorICAgICAgICAg
ICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9hZGRfZmVhdHVyZV9wb3dlcl9tZ210KGRldiwgb3V0YnVm
ICsgcmVzcF9sZW4sIHN0YXJ0X2ZlYXR1cmUsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxX3R5cGUpOworICAgICAgICAgICAgYnJlYWs7
CisgICAgICAgIGNhc2UgQ0RfRkVBVFVSRV9OVU1fVElNRU9VVDoKKyAgICAgICAgICAgIHJlc3Bf
bGVuICs9IGNkX3Njc2lfYWRkX2ZlYXR1cmVfdGltZW91dChkZXYsIG91dGJ1ZiArIHJlc3BfbGVu
LCBzdGFydF9mZWF0dXJlLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHJlcV90eXBlKTsKKyAgICAgICAgICAgIGJyZWFrOworICAgICAgICBkZWZh
dWx0OgorICAgICAgICAgICAgYnJlYWs7CisgICAgICAgIH0KKyAgICAgICAgYnJlYWs7CisKKyAg
ICBkZWZhdWx0OgorICAgICAgICBTUElDRV9ERUJVRygiZ2V0X2NvbmZpZ3VyYXRpb24sIGx1bjol
IiBHX0dVSU5UMzJfRk9STUFUCisgICAgICAgICAgICAgICAgICAgICIgaW52YWxpZCBydDolIiBH
X0dVSU5UMzJfRk9STUFUICIgc3RhcnRfZjolIiBHX0dVSU5UMzJfRk9STUFULAorICAgICAgICAg
ICAgICAgICAgICByZXEtPmx1biwgcmVxX3R5cGUsIHN0YXJ0X2ZlYXR1cmUpOworICAgICAgICBj
ZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZB
TElEX0NEQl9GSUVMRCk7CisgICAgICAgIHJldHVybjsKKyAgICB9CisKKyAgICAvKiBzZXQgdG90
YWwgZGF0YSBsZW4gKi8KKyAgICBvdXRidWZbMF0gPSAocmVzcF9sZW4gPj4gMjQpICYgMHhmZjsK
KyAgICBvdXRidWZbMV0gPSAocmVzcF9sZW4gPj4gMTYpICYgMHhmZjsKKyAgICBvdXRidWZbMl0g
PSAocmVzcF9sZW4gPj4gOCkgJiAweGZmOworICAgIG91dGJ1ZlszXSA9IHJlc3BfbGVuICYgMHhm
ZjsKKworICAgIC8qIHJlcG9ydCBjdXJyZW50IHByb2ZpbGUgbnVtICovCisgICAgb3V0YnVmWzZd
ID0gKHByb2ZpbGVfbnVtID4+IDgpICYgMHhmZjsKKyAgICBvdXRidWZbN10gPSBwcm9maWxlX251
bSAmIDB4ZmY7CisKKyAgICByZXEtPmluX2xlbiA9IChyZXEtPnJlcV9sZW4gPCByZXNwX2xlbikg
PyByZXEtPnJlcV9sZW4gOiByZXNwX2xlbjsKKworICAgIFNQSUNFX0RFQlVHKCJnZXRfY29uZmln
dXJhdGlvbiwgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQKKyAgICAgICAgICAgICAgICAiIHJ0OiUi
IEdfR1VJTlQzMl9GT1JNQVQgIiBzdGFydF9mOiUiIEdfR1VJTlQzMl9GT1JNQVQKKyAgICAgICAg
ICAgICAgICAiIHJlc3BfbGVuOiUiIEdfR1VJTlQzMl9GT1JNQVQsCisgICAgICAgICAgICAgICAg
cmVxLT5sdW4sIHJlcV90eXBlLCBzdGFydF9mZWF0dXJlLCByZXNwX2xlbik7CisKKyAgICBjZF9z
Y3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworI2RlZmluZSBDRF9HRVRfRVZF
TlRfU1RBVFVTX0lNTUVEICAgICAgICAgICAgMHgwMQorCisjZGVmaW5lIENEX0dFVF9FVkVOVF9I
RUFERVJfTk9fRVZFTlRfQVZBSUwgICgweDAxIDw8IDcpCisjZGVmaW5lIENEX0dFVF9FVkVOVF9I
RUFERVJfTEVOICAgICAgICAgICAgIDQKKworI2RlZmluZSBDRF9HRVRfRVZFTlRfQ0xBU1NfTk9O
RSAgICAgICAgICAgICAoMHgwMCkKKyNkZWZpbmUgQ0RfR0VUX0VWRU5UX0NMQVNTX09QRVJfQ0hB
TkdFICAgICAgKDB4MDEpCisjZGVmaW5lIENEX0dFVF9FVkVOVF9DTEFTU19QT1dFUl9NR01UICAg
ICAgICgweDAyKQorI2RlZmluZSBDRF9HRVRfRVZFTlRfQ0xBU1NfRVhURVJOQUxfUkVRICAgICAo
MHgwMykKKyNkZWZpbmUgQ0RfR0VUX0VWRU5UX0NMQVNTX01FRElBICAgICAgICAgICAgKDB4MDQp
CisjZGVmaW5lIENEX0dFVF9FVkVOVF9DTEFTU19NVUxUSV9JTklUSUFUT1IgICgweDA1KQorI2Rl
ZmluZSBDRF9HRVRfRVZFTlRfQ0xBU1NfREVWX0JVU1kgICAgICAgICAoMHgwNikKKworI2RlZmlu
ZSBDRF9HRVRfRVZFTlRfTEVOX01FRElBICAgICAgICAgICAgICA0CisKKyNkZWZpbmUgQ0RfTUVE
SUFfU1RBVFVTX01FRElBX1BSRVNFTlQgICAgICAgMHgxCisjZGVmaW5lIENEX01FRElBX1NUQVRV
U19UUkFZX09QRU4gICAgICAgICAgIDB4MgorCitzdGF0aWMgdWludDMyX3QgY2Rfc2NzaV9jbWRf
Z2V0X2V2ZW50X3Jlc3BfYWRkX21lZGlhKENkU2NzaUxVICpkZXYsIHVpbnQ4X3QgKm91dGJ1ZikK
K3sKKyAgICBvdXRidWZbMF0gPSAodWludDhfdClkZXYtPm1lZGlhX2V2ZW50ICYgMHgwZjsKKyAg
ICBvdXRidWZbMV0gPSAodWludDhfdCkoKGRldi0+bG9hZGVkID8gMCA6IENEX01FRElBX1NUQVRV
U19UUkFZX09QRU4pIHwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgKGRldi0+c3RyZWFtICE9
IE5VTEwgPyBDRF9NRURJQV9TVEFUVVNfTUVESUFfUFJFU0VOVCA6IDApKTsKKworICAgIGRldi0+
bWVkaWFfZXZlbnQgPSBDRF9NRURJQV9FVkVOVF9OT19DSEFOR0U7IC8qIHJlc2V0IHRoZSBldmVu
dCAqLworICAgIHJldHVybiBDRF9HRVRfRVZFTlRfTEVOX01FRElBOworfQorCisjZGVmaW5lIENE
X0dFVF9FVkVOVF9MRU5fUE9XRVIgICAgICAgICAgICAgIDQKKworI2RlZmluZSBDRF9QT1dFUl9T
VEFUVVNfQUNUSVZFICAgICAgICAgICAgICAweDEKKyNkZWZpbmUgQ0RfUE9XRVJfU1RBVFVTX0lE
TEUgICAgICAgICAgICAgICAgMHgyCisKK3N0YXRpYyB1aW50MzJfdCBjZF9zY3NpX2NtZF9nZXRf
ZXZlbnRfcmVzcF9hZGRfcG93ZXIoQ2RTY3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVmKQorewor
ICAgIG91dGJ1ZlswXSA9ICh1aW50OF90KWRldi0+cG93ZXJfZXZlbnQgJiAweDBmOworICAgIG91
dGJ1ZlsxXSA9ICh1aW50OF90KSgoZGV2LT5wb3dlcl9jb25kID09IENEX1NDU0lfUE9XRVJfQUNU
SVZFKSA/CisgICAgICAgICAgICAgICAgICAgICAgICAgICBDRF9QT1dFUl9TVEFUVVNfQUNUSVZF
IDogQ0RfUE9XRVJfU1RBVFVTX0lETEUpOworCisgICAgZGV2LT5wb3dlcl9ldmVudCA9IENEX1BP
V0VSX0VWRU5UX05PX0NIQU5HRTsgLyogcmVzZXQgdGhlIGV2ZW50ICovCisgICAgcmV0dXJuIENE
X0dFVF9FVkVOVF9MRU5fUE9XRVI7Cit9CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX2dldF9l
dmVudF9zdGF0dXNfbm90aWZpY2F0aW9uKENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJl
cSkKK3sKKyAgICB1aW50OF90ICpvdXRidWYgPSByZXEtPmJ1ZjsKKyAgICB1aW50MzJfdCByZXNw
X2xlbiA9IENEX0dFVF9FVkVOVF9IRUFERVJfTEVOOworICAgIGNvbnN0IHVpbnQzMl90IHBvd2Vy
X2NsYXNzX21hc2sgPSAoMHgwMSA8PCBDRF9HRVRfRVZFTlRfQ0xBU1NfUE9XRVJfTUdNVCk7Cisg
ICAgY29uc3QgdWludDMyX3QgbWVkaWFfY2xhc3NfbWFzayA9ICgweDAxIDw8IENEX0dFVF9FVkVO
VF9DTEFTU19NRURJQSk7CisgICAgdWludDMyX3QgY2xhc3Nlc19zdXBwb3J0ZWQgPSAgcG93ZXJf
Y2xhc3NfbWFzayB8IG1lZGlhX2NsYXNzX21hc2s7CisgICAgdWludDMyX3QgaW1tZWQsIGNsYXNz
ZXNfcmVxdWVzdGVkOworCisgICAgcmVxLT54ZmVyX2RpciA9IFNDU0lfWEZFUl9GUk9NX0RFVjsK
KworICAgIGltbWVkID0gcmVxLT5jZGJbMV0gJiBDRF9HRVRfRVZFTlRfU1RBVFVTX0lNTUVEOwor
ICAgIGNsYXNzZXNfcmVxdWVzdGVkID0gcmVxLT5jZGJbNF07CisgICAgcmVxLT5yZXFfbGVuID0g
KHJlcS0+Y2RiWzddIDw8IDgpIHwgcmVxLT5jZGJbOF07CisKKyAgICBpZiAoIWltbWVkKSB7Cisg
ICAgICAgIFNQSUNFX0RFQlVHKCJnZXRfZXZlbnRfc3RhdHVzX25vdGlmaWNhdGlvbiwgbHVuOiUi
IEdfR1VJTlQzMl9GT1JNQVQKKyAgICAgICAgICAgICAgICAiIGltbTowIGNsYXNzX3JlcTolMDJ4
LCBOb24taW1tZWRpYXRlIChhc3luYykgbW9kZSB1bnN1cHBvcnRlZCIsCisgICAgICAgICAgICAg
ICAgcmVxLT5sdW4sIGNsYXNzZXNfcmVxdWVzdGVkKTsKKyAgICAgICAgY2Rfc2NzaV9jbWRfY29t
cGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfSU5WQUxJRF9DREJfRklFTEQp
OworICAgICAgICByZXR1cm47CisgICAgfQorCisgICAgbWVtc2V0KG91dGJ1ZiwgMCwgcmVxLT5y
ZXFfbGVuKTsKKyAgICBpZiAoKGNsYXNzZXNfc3VwcG9ydGVkICYgY2xhc3Nlc19yZXF1ZXN0ZWQp
ICE9IDApIHsKKyAgICAgICAgaWYgKGNsYXNzZXNfcmVxdWVzdGVkICYgcG93ZXJfY2xhc3NfbWFz
aykgeworICAgICAgICAgICAgb3V0YnVmWzJdID0gQ0RfR0VUX0VWRU5UX0NMQVNTX1BPV0VSX01H
TVQ7CisgICAgICAgICAgICBvdXRidWZbM10gPSAodWludDhfdClwb3dlcl9jbGFzc19tYXNrOwor
CisgICAgICAgICAgICBTUElDRV9ERUJVRygiZ2V0X2V2ZW50X3N0YXR1c19ub3RpZmljYXRpb24s
IGx1bjolIiBHX0dVSU5UMzJfRk9STUFUCisgICAgICAgICAgICAgICAgICAgICAgICAiIGltbTol
IiBHX0dVSU5UMzJfRk9STUFUICIgY2xhc3NfcmVxOjB4JTAyeCBjbGFzc19zdXA6MHglMDJ4Igor
ICAgICAgICAgICAgICAgICAgICAgICAgIiBwb3dlcl9ldmVudDoweCUwMnggcG93ZXJfY29uZDow
eCUwMngiLAorICAgICAgICAgICAgICAgICAgICAgICAgcmVxLT5sdW4sIGltbWVkLCBjbGFzc2Vz
X3JlcXVlc3RlZCwgY2xhc3Nlc19zdXBwb3J0ZWQsCisgICAgICAgICAgICAgICAgICAgICAgICBk
ZXYtPnBvd2VyX2V2ZW50LCBkZXYtPnBvd2VyX2NvbmQpOworCisgICAgICAgICAgICByZXNwX2xl
biArPSBjZF9zY3NpX2NtZF9nZXRfZXZlbnRfcmVzcF9hZGRfcG93ZXIoZGV2LCBvdXRidWYgKyBy
ZXNwX2xlbik7CisgICAgICAgIH0gZWxzZSBpZiAoY2xhc3Nlc19yZXF1ZXN0ZWQgJiBtZWRpYV9j
bGFzc19tYXNrKSB7CisgICAgICAgICAgICBvdXRidWZbMl0gPSBDRF9HRVRfRVZFTlRfQ0xBU1Nf
TUVESUE7CisgICAgICAgICAgICBvdXRidWZbM10gPSAodWludDhfdCltZWRpYV9jbGFzc19tYXNr
OworCisgICAgICAgICAgICBTUElDRV9ERUJVRygiZ2V0X2V2ZW50X3N0YXR1c19ub3RpZmljYXRp
b24sIGx1bjolIiBHX0dVSU5UMzJfRk9STUFUCisgICAgICAgICAgICAgICAgICAgICAgICAiIGlt
bTolIiBHX0dVSU5UMzJfRk9STUFUICIgY2xhc3NfcmVxOjB4JTAyeCBjbGFzc19zdXA6MHglMDJ4
IgorICAgICAgICAgICAgICAgICAgICAgICAgIiBtZWRpYV9ldmVudDoweCUwMnggbG9hZGVkOiAl
ZCIsCisgICAgICAgICAgICAgICAgICAgICAgICByZXEtPmx1biwgaW1tZWQsIGNsYXNzZXNfcmVx
dWVzdGVkLCBjbGFzc2VzX3N1cHBvcnRlZCwKKyAgICAgICAgICAgICAgICAgICAgICAgIGRldi0+
bWVkaWFfZXZlbnQsIGRldi0+bG9hZGVkKTsKKworICAgICAgICAgICAgcmVzcF9sZW4gKz0gY2Rf
c2NzaV9jbWRfZ2V0X2V2ZW50X3Jlc3BfYWRkX21lZGlhKGRldiwgb3V0YnVmICsgcmVzcF9sZW4p
OworICAgICAgICB9CisgICAgfSBlbHNlIHsKKyAgICAgICAgb3V0YnVmWzJdID0gQ0RfR0VUX0VW
RU5UX0hFQURFUl9OT19FVkVOVF9BVkFJTCB8IENEX0dFVF9FVkVOVF9DTEFTU19OT05FOworCisg
ICAgICAgIFNQSUNFX0RFQlVHKCJnZXRfZXZlbnRfc3RhdHVzX25vdGlmaWNhdGlvbiwgbHVuOiUi
IEdfR1VJTlQzMl9GT1JNQVQKKyAgICAgICAgICAgICAgICAgICAgICAgICIgaW1tOiUiIEdfR1VJ
TlQzMl9GT1JNQVQgIiBjbGFzc19yZXE6MHglMDJ4IGNsYXNzX3N1cDoweCUwMngiCisgICAgICAg
ICAgICAgICAgICAgICAgICAiIG5vbmUgb2YgcmVxdWVzdGVkIGV2ZW50cyBzdXBwb3J0ZWQiLAor
ICAgICAgICAgICAgICAgICAgICAgICAgcmVxLT5sdW4sIGltbWVkLCBjbGFzc2VzX3JlcXVlc3Rl
ZCwgY2xhc3Nlc19zdXBwb3J0ZWQpOworICAgIH0KKyAgICBvdXRidWZbMV0gPSAodWludDhfdCko
cmVzcF9sZW4gLSAyKTsgLyogRXZlbnQgRGF0YSBMZW5ndGggTFNCLCBsZW5ndGggZXhjbHVkaW5n
IHRoZQorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBmaWVsZCBp
dHNlbGYgKi8KKyAgICBvdXRidWZbM10gPSAodWludDhfdCljbGFzc2VzX3N1cHBvcnRlZDsKKwor
ICAgIHJlcS0+aW5fbGVuID0gKHJlcS0+cmVxX2xlbiA8IHJlc3BfbGVuKSA/IHJlcS0+cmVxX2xl
biA6IHJlc3BfbGVuOworICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2LCByZXEpOwor
fQorCisjZGVmaW5lIENEX0VYVF9SRVFfRVZFTlRfRk9STUFUX05PX0NIRyAgICAgICAgICAweDAw
CisjZGVmaW5lIENEX0VYVF9SRVFfRVZFTlRfRk9STUFUX0xVX0tFWV9ET1dOICAgICAweDAxCisj
ZGVmaW5lIENEX0VYVF9SRVFfRVZFTlRfRk9STUFUX0xVX0tFWV9VUCAgICAgICAweDAyCisjZGVm
aW5lIENEX0VYVF9SRVFfRVZFTlRfRk9STUFUX1JFUV9OT1RJRlkgICAgICAweDAzCisKKyNkZWZp
bmUgQ0RfRVhUX1JFUV9TVEFUVVNfUkVBRFkgICAgICAgICAgICAgICAgIDB4MDAKKyNkZWZpbmUg
Q0RfRVhUX1JFUV9TVEFUVVNfT1RIRVJfUFJFVkVOVCAgICAgICAgIDB4MDEKKworI2RlZmluZSBD
RF9FWFRfUkVRX0NPREVfTk9fUkVRVUVTVCAgICAgICAgICAgICAgMHgwMAorI2RlZmluZSBDRF9F
WFRfUkVRX0NPREVfT1ZFUlJVTiAgICAgICAgICAgICAgICAgMHgwMQorI2RlZmluZSBDRF9FWFRf
UkVRX0NPREVfUExBWSAgICAgICAgICAgICAgICAgICAgMHgxMDEKKyNkZWZpbmUgQ0RfRVhUX1JF
UV9DT0RFX1JFV0lORCAgICAgICAgICAgICAgICAgIDB4MTAyCisjZGVmaW5lIENEX0VYVF9SRVFf
Q09ERV9GQVNUX0ZXICAgICAgICAgICAgICAgICAweDEwMworI2RlZmluZSBDRF9FWFRfUkVRX0NP
REVfUEFVU0UgICAgICAgICAgICAgICAgICAgMHgxMDQKKyNkZWZpbmUgQ0RfRVhUX1JFUV9DT0RF
X1NUT1AgICAgICAgICAgICAgICAgICAgIDB4MTA2CisjZGVmaW5lIENEX0VYVF9SRVFfQ09ERV9B
U0NJSV9CQVNFICAgICAgICAgICAgICAweDIwMCAvKiBTQ1NJSSB2YWx1ZSBpcyBMU0IgKi8KKwor
c3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRfc2VuZF9ldmVudChDZFNjc2lMVSAqZGV2LCBDZFNjc2lS
ZXF1ZXN0ICpyZXEpCit7CisgICAgdWludDhfdCAqcGFyYW0sICpldmVudDsKKyAgICB1aW50MzJf
dCBpbW1lZCwgcGFyYW1fbGlzdF9sZW47CisgICAgdWludDMyX3QgZXZlbnRfcGFyYW1fbGVuLCBu
b3RpZmljYXRpb25fY2xhc3M7CisgICAgdWludDMyX3QgZXh0X3JlcV9ldmVudCwgZXh0X3JlcV9z
dGF0dXMsIHBlcnNfcHJldmVudCwgZXh0X3JlcV9jb2RlOworCisgICAgcmVxLT54ZmVyX2RpciA9
IFNDU0lfWEZFUl9UT19ERVY7CisKKyAgICBpbW1lZCA9IHJlcS0+Y2RiWzFdICYgMHgwMTsKKyAg
ICBwYXJhbV9saXN0X2xlbiA9IChyZXEtPmNkYls4XSA8PCA4KSB8IHJlcS0+Y2RiWzldOworCisg
ICAgaWYgKHJlcS0+YnVmX2xlbiA8IHBhcmFtX2xpc3RfbGVuKSB7CisgICAgICAgIFNQSUNFX0RF
QlVHKCJzZW5kX2V2ZW50LCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVAorICAgICAgICAgICAgICAg
ICAgICAiIGludmFsaWQgcGFyYW0gbGlzdCBsZW46MHgleCwgYnVmX2xlbjoweCV4IiwKKyAgICAg
ICAgICAgICAgICAgICAgcmVxLT5sdW4sIHBhcmFtX2xpc3RfbGVuLCByZXEtPmJ1Zl9sZW4pOwor
ICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2Vf
Y29kZV9JTlZBTElEX1BBUkFNX0xFTik7CisgICAgICAgIHJldHVybjsKKyAgICB9CisgICAgcGFy
YW0gPSByZXEtPmJ1ZjsKKyAgICBldmVudF9wYXJhbV9sZW4gPSAocGFyYW1bMF0gPDwgOCkgfCBw
YXJhbVsxXTsKKworICAgIG5vdGlmaWNhdGlvbl9jbGFzcyA9IHBhcmFtWzJdICYgMHgwNzsKKyAg
ICBpZiAobm90aWZpY2F0aW9uX2NsYXNzICE9IENEX0dFVF9FVkVOVF9DTEFTU19FWFRFUk5BTF9S
RVEpIHsKKyAgICAgICAgU1BJQ0VfREVCVUcoInNlbmRfZXZlbnQsIGx1bjolIiBHX0dVSU5UMzJf
Rk9STUFUCisgICAgICAgICAgICAgICAgICAgICIgaW52YWxpZCBub3RpZmljYXRpb24gY2xhc3M6
MHgleCIsCisgICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBub3RpZmljYXRpb25fY2xhc3Mp
OworICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vu
c2VfY29kZV9JTlZBTElEX0NEQl9GSUVMRCk7CisgICAgICAgIHJldHVybjsKKyAgICB9CisKKyAg
ICBldmVudCA9IHBhcmFtICsgQ0RfR0VUX0VWRU5UX0hFQURFUl9MRU47CisgICAgZXh0X3JlcV9l
dmVudCA9IGV2ZW50WzBdICYgMHhmZjsKKyAgICBleHRfcmVxX3N0YXR1cyA9IGV2ZW50WzFdICYg
MHgwZjsKKyAgICBwZXJzX3ByZXZlbnQgPSBldmVudFsxXSAmIDB4ODA7CisgICAgZXh0X3JlcV9j
b2RlID0gKGV2ZW50WzJdIDw8IDgpIHwgZXZlbnRbM107CisKKyAgICBTUElDRV9ERUJVRygic2Vu
ZF9ldmVudCwgbHVuOjB4JSIgR19HVUlOVDMyX0ZPUk1BVAorICAgICAgICAgICAgICAgICIgaW1t
ZWQ6JSIgR19HVUlOVDMyX0ZPUk1BVCAiIHBhcmFtX2xlbjolIiBHX0dVSU5UMzJfRk9STUFUCisg
ICAgICAgICAgICAgICAgIiBleHRfcmVxX2V2ZW50OjB4JXggZXh0X3JlcV9zdGF0dXM6MHgleCIK
KyAgICAgICAgICAgICAgICAiIHBlcnNfcHJldmVudDoweCV4IGV4dF9yZXFfY29kZToweCV4IiwK
KyAgICAgICAgICAgICAgICByZXEtPmx1biwgaW1tZWQsIGV2ZW50X3BhcmFtX2xlbiwgZXh0X3Jl
cV9ldmVudCwKKyAgICAgICAgICAgICAgICBleHRfcmVxX3N0YXR1cywgcGVyc19wcmV2ZW50LCBl
eHRfcmVxX2NvZGUpOworCisgICAgLyogVG9EbzogcHJvY2VzcyB0aGUgZXZlbnQgKi8KKworICAg
IGNkX3Njc2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2LCByZXEpOworfQorCisjZGVmaW5lIENEX01F
RElVTV9SRU1PVkFMX1JFUV9BTExPVyAgICAgICAgICAgICAgICAgMHgwMAorI2RlZmluZSBDRF9N
RURJVU1fUkVNT1ZBTF9SRVFfUFJFVkVOVCAgICAgICAgICAgICAgIDB4MDEKKyNkZWZpbmUgQ0Rf
TUVESVVNX1JFTU9WQUxfUkVRX0FMTE9XX0NIQU5HRVIgICAgICAgICAweDAyCisjZGVmaW5lIENE
X01FRElVTV9SRU1PVkFMX1JFUV9QUkVWRU5UX0NIQU5HRVIgICAgICAgMHgwMworCitzdGF0aWMg
dm9pZCBjZF9zY3NpX2NtZF9hbGxvd19tZWRpdW1fcmVtb3ZhbChDZFNjc2lMVSAqZGV2LCBDZFNj
c2lSZXF1ZXN0ICpyZXEpCit7CisgICAgdWludDMyX3QgcHJldmVudDsKKworICAgIHJlcS0+eGZl
cl9kaXIgPSBTQ1NJX1hGRVJfRlJPTV9ERVY7CisKKyAgICBwcmV2ZW50ID0gcmVxLT5jZGJbNF0g
JiAweDAzOworICAgIGRldi0+cHJldmVudF9tZWRpYV9yZW1vdmFsID0gKHByZXZlbnQgPT0gQ0Rf
TUVESVVNX1JFTU9WQUxfUkVRX1BSRVZFTlQgfHwKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBwcmV2ZW50ID09IENEX01FRElVTV9SRU1PVkFMX1JFUV9QUkVWRU5UX0NIQU5HRVIp
OworICAgIHJlcS0+aW5fbGVuID0gMDsKKworICAgIFNQSUNFX0RFQlVHKCJhbGxvd19tZWRpdW1f
cmVtb3ZhbCwgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQgIiBwcmV2ZW50IGZpZWxkOjoweCUwMngg
ZmxhZzolZCIsCisgICAgICAgICAgICAgICAgcmVxLT5sdW4sIHByZXZlbnQsIGRldi0+cHJldmVu
dF9tZWRpYV9yZW1vdmFsKTsKKworICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2LCBy
ZXEpOworfQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9yZXBvcnRfa2V5KENkU2NzaUxVICpk
ZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICBTUElDRV9ERUJVRygicmVwb3J0X2tleSAt
IGNvbnRlbnQgcHJvdGVjdGlvbiB1bnN1cHBvcnRlZCwgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQs
IHJlcS0+bHVuKTsKKyAgICByZXEtPnhmZXJfZGlyID0gU0NTSV9YRkVSX05PTkU7CisgICAgY2Rf
c2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfSU5WQUxJ
RF9PUENPREUpOworfQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9zZW5kX2tleShDZFNjc2lM
VSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgU1BJQ0VfREVCVUcoInNlbmRfa2V5
IC0gY29udGVudCBwcm90ZWN0aW9uIHVuc3VwcG9ydGVkLCBsdW46JSIgR19HVUlOVDMyX0ZPUk1B
VCwgcmVxLT5sdW4pOworICAgIHJlcS0+eGZlcl9kaXIgPSBTQ1NJX1hGRVJfTk9ORTsKKyAgICBj
ZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZB
TElEX09QQ09ERSk7Cit9CisKKy8qIGJ5dGUgMSAqLworI2RlZmluZSBDRF9TVEFSVF9TVE9QX0ZM
QUdfSU1NRUQgICAgICAgICAgICAgICAgICAgIDB4MDEKKworLyogYnl0ZSA0ICovCisjZGVmaW5l
IENEX1NUQVJUX1NUT1BfRkxBR19TVEFSVCAgICAgICAgICAgICAgICAgICAgMHgwMQorI2RlZmlu
ZSBDRF9TVEFSVF9TVE9QX0ZMQUdfTE9FSiAgICAgICAgICAgICAgICAgICAgIDB4MDIKKworLyog
UE9XRVIgQ09ORElUSU9OIGZpZWxkIHZhbHVlcyAqLworI2RlZmluZSBDRF9TVEFSVF9TVE9QX1BP
V0VSX0NPTkRfU1RBUlRfVkFMSUQgICAgICAgIDB4MDAKKyNkZWZpbmUgQ0RfU1RBUlRfU1RPUF9Q
T1dFUl9DT05EX0FDVElWRSAgICAgICAgICAgICAweDAxCisjZGVmaW5lIENEX1NUQVJUX1NUT1Bf
UE9XRVJfQ09ORF9JRExFICAgICAgICAgICAgICAgMHgwMgorI2RlZmluZSBDRF9TVEFSVF9TVE9Q
X1BPV0VSX0NPTkRfU1RBTkRCWSAgICAgICAgICAgIDB4MDMKKyNkZWZpbmUgQ0RfU1RBUlRfU1RP
UF9QT1dFUl9DT05EX0xVX0NPTlRST0wgICAgICAgICAweDA3CisjZGVmaW5lIENEX1NUQVJUX1NU
T1BfUE9XRVJfQ09ORF9GT1JDRV9JRExFXzAgICAgICAgMHgwYQorI2RlZmluZSBDRF9TVEFSVF9T
VE9QX1BPV0VSX0NPTkRfRk9SQ0VfU1RBTkRCWV8wICAgIDB4MGIKKworc3RhdGljIGlubGluZSBj
b25zdCBjaGFyICpjZF9zY3NpX3N0YXJ0X3N0b3BfcG93ZXJfY29uZF9uYW1lKHVpbnQzMl90IHBv
d2VyX2NvbmQpCit7CisgICAgc3dpdGNoIChwb3dlcl9jb25kKSB7CisgICAgY2FzZSBDRF9TVEFS
VF9TVE9QX1BPV0VSX0NPTkRfU1RBUlRfVkFMSUQ6CisgICAgICAgIHJldHVybiAiU1RBUlRfVkFM
SUQiOworICAgIGNhc2UgQ0RfU1RBUlRfU1RPUF9QT1dFUl9DT05EX0FDVElWRToKKyAgICAgICAg
cmV0dXJuICJBQ1RJVkUiOworICAgIGNhc2UgQ0RfU1RBUlRfU1RPUF9QT1dFUl9DT05EX0lETEU6
CisgICAgICAgIHJldHVybiAiSURMRSI7CisgICAgY2FzZSBDRF9TVEFSVF9TVE9QX1BPV0VSX0NP
TkRfU1RBTkRCWToKKyAgICAgICAgcmV0dXJuICJTVEFOREJZIjsKKyAgICBjYXNlIENEX1NUQVJU
X1NUT1BfUE9XRVJfQ09ORF9MVV9DT05UUk9MOgorICAgICAgICByZXR1cm4gIkxVX0NPTlRST0wi
OworICAgIGNhc2UgQ0RfU1RBUlRfU1RPUF9QT1dFUl9DT05EX0ZPUkNFX0lETEVfMDoKKyAgICAg
ICAgcmV0dXJuICJGT1JDRV9JRExFXzAiOworICAgIGNhc2UgQ0RfU1RBUlRfU1RPUF9QT1dFUl9D
T05EX0ZPUkNFX1NUQU5EQllfMDoKKyAgICAgICAgcmV0dXJuICJGT1JDRV9TVEFOREJZXzAiOwor
ICAgIGRlZmF1bHQ6CisgICAgICAgIHJldHVybiAiUkVTRVJWRUQiOworICAgIH0KK30KKworc3Rh
dGljIHZvaWQgY2Rfc2NzaV9jbWRfc3RhcnRfc3RvcF91bml0KENkU2NzaUxVICpkZXYsIENkU2Nz
aVJlcXVlc3QgKnJlcSkKK3sKKyAgICBnYm9vbGVhbiBpbW1lZCwgc3RhcnQsIGxvYWRfZWplY3Q7
CisgICAgdWludDMyX3QgcG93ZXJfY29uZDsKKworICAgIHJlcS0+eGZlcl9kaXIgPSBTQ1NJX1hG
RVJfTk9ORTsKKyAgICByZXEtPmluX2xlbiA9IDA7CisKKyAgICBpbW1lZCA9IChyZXEtPmNkYlsx
XSAmIENEX1NUQVJUX1NUT1BfRkxBR19JTU1FRCkgPyBUUlVFIDogRkFMU0U7CisgICAgc3RhcnQg
PSAocmVxLT5jZGJbNF0gJiBDRF9TVEFSVF9TVE9QX0ZMQUdfU1RBUlQpID8gVFJVRSA6IEZBTFNF
OworICAgIGxvYWRfZWplY3QgPSAocmVxLT5jZGJbNF0gJiBDRF9TVEFSVF9TVE9QX0ZMQUdfTE9F
SikgPyBUUlVFIDogRkFMU0U7CisgICAgcG93ZXJfY29uZCA9IHJlcS0+Y2RiWzRdID4+IDQ7CisK
KyAgICBTUElDRV9ERUJVRygic3RhcnRfc3RvcF91bml0LCBsdW46MHglIiBHX0dVSU5UMzJfRk9S
TUFUCisgICAgICAgICAgICAgICAgIiBpbW1lZDolZCBzdGFydDolZCBsb2FkX2VqZWN0OiVkIHBv
d2VyX2NvbmQ6MHgleCglcykiLAorICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBpbW1lZCwgc3Rh
cnQsIGxvYWRfZWplY3QsIHBvd2VyX2NvbmQsCisgICAgICAgICAgICAgICAgY2Rfc2NzaV9zdGFy
dF9zdG9wX3Bvd2VyX2NvbmRfbmFtZShwb3dlcl9jb25kKSk7CisKKyAgICBzd2l0Y2ggKHBvd2Vy
X2NvbmQpIHsKKyAgICBjYXNlIENEX1NUQVJUX1NUT1BfUE9XRVJfQ09ORF9TVEFSVF9WQUxJRDoK
KyAgICAgICAgaWYgKCFzdGFydCkgeyAvKiBzdG9wIHRoZSB1bml0ICovCisgICAgICAgICAgICBp
ZiAobG9hZF9lamVjdCkgeyAvKiBlamVjdCBtZWRpdW0gKi8KKyAgICAgICAgICAgICAgICBpZiAo
ZGV2LT5wcmV2ZW50X21lZGlhX3JlbW92YWwpIHsKKyAgICAgICAgICAgICAgICAgICAgU1BJQ0Vf
REVCVUcoInN0YXJ0X3N0b3BfdW5pdCwgbHVuOjB4JSIgR19HVUlOVDMyX0ZPUk1BVAorICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAiIHByZXZlbnRfbWVkaWFfcmVtb3ZhbCBzZXQsIGVq
ZWN0IGZhaWxlZCIsIHJlcS0+bHVuKTsKKyAgICAgICAgICAgICAgICAgICAgY2Rfc2NzaV9jbWRf
Y29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfTUVESVVNX1JFTU9WQUxf
UFJFVkVOVEVEKTsKKyAgICAgICAgICAgICAgICAgICAgcmV0dXJuOworICAgICAgICAgICAgICAg
IH0KKyAgICAgICAgICAgICAgICBTUElDRV9ERUJVRygic3RhcnRfc3RvcF91bml0LCBsdW46MHgl
IiBHX0dVSU5UMzJfRk9STUFUICIgZWplY3QiLCByZXEtPmx1bik7CisgICAgICAgICAgICAgICAg
Y2Rfc2NzaV9sdV91bmxvYWQoZGV2KTsKKyAgICAgICAgICAgICAgICBjZF9zY3NpX2Rldl9jaGFu
Z2VkKGRldi0+dGd0LT51c2VyX2RhdGEsIHJlcS0+bHVuKTsKKyAgICAgICAgICAgIH0KKyAgICAg
ICAgICAgIGRldi0+cG93ZXJfY29uZCA9IENEX1NDU0lfUE9XRVJfU1RPUFBFRDsKKyAgICAgICAg
ICAgIFNQSUNFX0RFQlVHKCJzdGFydF9zdG9wX3VuaXQsIGx1bjoweCUiIEdfR1VJTlQzMl9GT1JN
QVQgIiBzdG9wcGVkIiwgcmVxLT5sdW4pOworICAgICAgICB9IGVsc2UgeyAvKiBzdGFydCB0aGUg
dW5pdCAqLworICAgICAgICAgICAgZGV2LT5wb3dlcl9jb25kID0gQ0RfU0NTSV9QT1dFUl9BQ1RJ
VkU7CisgICAgICAgICAgICBTUElDRV9ERUJVRygic3RhcnRfc3RvcF91bml0LCBsdW46MHglIiBH
X0dVSU5UMzJfRk9STUFUICIgc3RhcnRlZCIsIHJlcS0+bHVuKTsKKworICAgICAgICAgICAgaWYg
KGxvYWRfZWplY3QpIHsgLyogbG9hZCBtZWRpdW0gKi8KKyAgICAgICAgICAgICAgICBTUElDRV9E
RUJVRygic3RhcnRfc3RvcF91bml0LCBsdW46MHglIiBHX0dVSU5UMzJfRk9STUFUICIgbG9hZCB3
aXRoIG5vIG1lZGlhIiwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXEtPmx1bik7Cisg
ICAgICAgICAgICAgICAgY2Rfc2NzaV9sdV9sb2FkKGRldiwgTlVMTCk7CisgICAgICAgICAgICAg
ICAgY2Rfc2NzaV9kZXZfY2hhbmdlZChkZXYtPnRndC0+dXNlcl9kYXRhLCByZXEtPmx1bik7Cisg
ICAgICAgICAgICB9CisgICAgICAgIH0KKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBDRF9TVEFS
VF9TVE9QX1BPV0VSX0NPTkRfQUNUSVZFOgorICAgICAgICAvKiBub3QgZXJyb3IgdG8gc3BlY2lm
eSB0cmFuc2l0aW9uIHRvIHRoZSBjdXJyZW50IHBvd2VyIGNvbmRpdGlvbiAqLworICAgICAgICBk
ZXYtPnBvd2VyX2NvbmQgPSBDRF9TQ1NJX1BPV0VSX0FDVElWRTsKKyAgICAgICAgU1BJQ0VfREVC
VUcoInN0YXJ0X3N0b3BfdW5pdCwgbHVuOjB4JSIgR19HVUlOVDMyX0ZPUk1BVCAiIGFjdGl2ZSIs
IHJlcS0+bHVuKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBDRF9TVEFSVF9TVE9QX1BPV0VS
X0NPTkRfSURMRToKKyAgICBjYXNlIENEX1NUQVJUX1NUT1BfUE9XRVJfQ09ORF9GT1JDRV9JRExF
XzA6CisgICAgICAgIGRldi0+cG93ZXJfY29uZCA9IENEX1NDU0lfUE9XRVJfSURMRTsKKyAgICAg
ICAgU1BJQ0VfREVCVUcoInN0YXJ0X3N0b3BfdW5pdCwgbHVuOjB4JSIgR19HVUlOVDMyX0ZPUk1B
VCAiIGlkbGUiLCByZXEtPmx1bik7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgQ0RfU1RBUlRf
U1RPUF9QT1dFUl9DT05EX1NUQU5EQlk6CisgICAgY2FzZSBDRF9TVEFSVF9TVE9QX1BPV0VSX0NP
TkRfRk9SQ0VfU1RBTkRCWV8wOgorICAgICAgICBkZXYtPnBvd2VyX2NvbmQgPSBDRF9TQ1NJX1BP
V0VSX1NUQU5EQlk7CisgICAgICAgIFNQSUNFX0RFQlVHKCJzdGFydF9zdG9wX3VuaXQsIGx1bjow
eCUiIEdfR1VJTlQzMl9GT1JNQVQgIiBzdGFuZGJ5IiwgcmVxLT5sdW4pOworICAgICAgICBicmVh
azsKKyAgICBjYXNlIENEX1NUQVJUX1NUT1BfUE9XRVJfQ09ORF9MVV9DT05UUk9MOgorICAgICAg
ICBicmVhazsKKyAgICBkZWZhdWx0OgorICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVj
a19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZBTElEX0NEQl9GSUVMRCk7CisgICAgICAg
IHJldHVybjsKKyAgICB9CisgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfZ29vZChkZXYsIHJlcSk7
Cit9CisKKyNkZWZpbmUgQ0RfUEVSRl9UWVBFX1BFUkZPUk1BTkNFICAgICAgICAgICAgICAgIDB4
MDAKKyNkZWZpbmUgQ0RfUEVSRl9UWVBFX1VOVVNBQkxFX0FSRUEgICAgICAgICAgICAgIDB4MDEK
KyNkZWZpbmUgQ0RfUEVSRl9UWVBFX0RFRkVDVF9TVEFUVVMgICAgICAgICAgICAgIDB4MDIKKyNk
ZWZpbmUgQ0RfUEVSRl9UWVBFX1dSSVRFX1NQRUVEICAgICAgICAgICAgICAgIDB4MDMKKworI2Rl
ZmluZSBDRF9QRVJGX0hFQURFUl9MRU4gICAgICAgICAgICAgICAgICAgICAgOAorCisjZGVmaW5l
IENEX1BFUkZfVFlQRV9QRVJGT1JNQU5DRV9ERVNDUl9MRU4gICAgICAxNgorCisjZGVmaW5lIENE
X1BFUkZfVFlQRV9QRVJGT1JNQU5DRV9SRVBPUlRfTk9NSU5BTCAweDAwCisjZGVmaW5lIENEX1BF
UkZfVFlQRV9QRVJGT1JNQU5DRV9SRVBPUlRfQUxMICAgICAweDAxCisjZGVmaW5lIENEX1BFUkZf
VFlQRV9QRVJGT1JNQU5DRV9SRVBPUlRfRVhDRVBUICAweDEwCisKKworc3RhdGljIHZvaWQgY2Rf
c2NzaV9nZXRfcGVyZm9ybWFuY2VfcmVzcF9lbXB0eShDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1
ZXN0ICpyZXEsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHVpbnQzMl90IHR5cGUsIHVpbnQzMl90IGRhdGFfdHlwZSwKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyX3QgbWF4X251bV9kZXNjcikKK3sKKyAg
ICB1aW50OF90ICpvdXRidWYgPSByZXEtPmJ1ZjsKKyAgICB1aW50MzJfdCB3cml0ZSA9IChkYXRh
X3R5cGUgPj4gMikgJiAweDAxOworCisgICAgbWVtc2V0KG91dGJ1ZiwgMCwgQ0RfUEVSRl9IRUFE
RVJfTEVOKTsKKyAgICBpZiAod3JpdGUpIHsKKyAgICAgICAgb3V0YnVmWzRdID0gMHgwMjsKKyAg
ICB9CisgICAgcmVxLT5pbl9sZW4gPSBDRF9QRVJGX0hFQURFUl9MRU47CisKKyAgICBTUElDRV9E
RUJVRygiZ2V0X3BlcmZvcm1hbmNlLCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVAorICAgICAgICAg
ICAgICAgICIgdHlwZToweCV4IGRhdGFfdHlwZToweCV4IC0gc2VuZGluZyBlbXB0eSByZXNwb25z
ZSIsCisgICAgICAgICAgICAgICAgcmVxLT5sdW4sIHR5cGUsIGRhdGFfdHlwZSk7CisKKyAgICBj
ZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworc3RhdGljIHZvaWQgY2Rf
c2NzaV9nZXRfcGVyZm9ybWFuY2VfcmVzcF9wZXJmb3JtYW5jZShDZFNjc2lMVSAqZGV2LCBDZFNj
c2lSZXF1ZXN0ICpyZXEsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHVpbnQzMl90IHN0YXJ0X2xiYSwKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyX3QgZGF0YV90eXBlLAorICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCBt
YXhfbnVtX2Rlc2NyKQoreworICAgIHVpbnQ4X3QgKm91dGJ1ZiA9IHJlcS0+YnVmLCAqcGVyZl9k
ZXNjOworICAgIHVpbnQzMl90IHJlc3BfbGVuID0gQ0RfUEVSRl9IRUFERVJfTEVOICsKKyAgICAg
ICAgICAgICAgICAgICAgICAgIENEX1BFUkZfVFlQRV9QRVJGT1JNQU5DRV9ERVNDUl9MRU47Cisg
ICAgdWludDMyX3QgcGVyZl9kYXRhX2xlbiA9IHJlc3BfbGVuIC0gNDsgLyogbm90IGluY2wuIFBl
cmYgRGF0YSBMZW5ndGggKi8KKyAgICB1aW50MzJfdCBwZXJmX2tiID0gMTAwMDA7CisgICAgdWlu
dDMyX3QgZW5kX2xiYSA9IGRldi0+bnVtX2Jsb2NrcyAtIDE7CisgICAgdWludDMyX3QgZXhjZXB0
LCB3cml0ZSwgdG9sZXJhbmNlOworCisgICAgZXhjZXB0ID0gZGF0YV90eXBlICYgMHgwMzsKKyAg
ICBpZiAoZXhjZXB0ICE9IENEX1BFUkZfVFlQRV9QRVJGT1JNQU5DRV9SRVBPUlRfQUxMKSB7Cisg
ICAgICAgIHN0YXJ0X2xiYSA9IDA7CisgICAgfQorICAgIHdyaXRlID0gKGRhdGFfdHlwZSA+PiAy
KSAmIDB4MDE7CisgICAgdG9sZXJhbmNlID0gKGRhdGFfdHlwZSA+PiAzKSAmIDB4MDM7CisKKyAg
ICBTUElDRV9ERUJVRygiZ2V0X3BlcmZvcm1hbmNlLCBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVAor
ICAgICAgICAgICAgICAgICIgcGVyZm9ybWFuY2UgdHlwZToweDAwIGRhdGFfdHlwZToweCV4Igor
ICAgICAgICAgICAgICAgICIgZXhjZXB0OjB4JXggd3JpdGU6MHgleCB0b2xlcmFuY2U6MHgleCIK
KyAgICAgICAgICAgICAgICAiIG1heF9udW06JSIgR19HVUlOVDMyX0ZPUk1BVCwKKyAgICAgICAg
ICAgICAgICByZXEtPmx1biwgZGF0YV90eXBlLCBleGNlcHQsIHdyaXRlLAorICAgICAgICAgICAg
ICAgIHRvbGVyYW5jZSwgbWF4X251bV9kZXNjcik7CisKKyAgICBpZiAod3JpdGUpIHsKKyAgICAg
ICAgU1BJQ0VfREVCVUcoImdldF9wZXJmb3JtYW5jZSwgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQK
KyAgICAgICAgICAgICAgICAiIHBlcmZvcm1hbmNlIHR5cGU6MHgwMCBkYXRhX3R5cGU6MHgleCAt
IHdyaXRlIHVuc3VwcG9ydGVkIiwKKyAgICAgICAgICAgICAgICByZXEtPmx1biwgZGF0YV90eXBl
KTsKKyAgICAgICAgY2Rfc2NzaV9nZXRfcGVyZm9ybWFuY2VfcmVzcF9lbXB0eShkZXYsIHJlcSwg
Q0RfUEVSRl9UWVBFX1BFUkZPUk1BTkNFLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGRhdGFfdHlwZSwgbWF4X251bV9kZXNjcik7CisgICAgICAgIHJldHVybjsK
KyAgICB9CisKKyAgICBtZW1zZXQob3V0YnVmLCAwLCByZXNwX2xlbik7CisKKyAgICBvdXRidWZb
MF0gPSAocGVyZl9kYXRhX2xlbiA+PiAyNCkgJiAweGZmOworICAgIG91dGJ1ZlsxXSA9IChwZXJm
X2RhdGFfbGVuID4+IDE2KSAmIDB4ZmY7CisgICAgb3V0YnVmWzJdID0gKHBlcmZfZGF0YV9sZW4g
Pj4gOCkgJiAweGZmOworICAgIG91dGJ1ZlszXSA9IHBlcmZfZGF0YV9sZW4gJiAweGZmOworCisg
ICAgcGVyZl9kZXNjID0gb3V0YnVmICsgQ0RfUEVSRl9IRUFERVJfTEVOOworCisgICAgcGVyZl9k
ZXNjWzBdID0gKHN0YXJ0X2xiYSA+PiAyNCkgJiAweGZmOworICAgIHBlcmZfZGVzY1sxXSA9IChz
dGFydF9sYmEgPj4gMTYpICYgMHhmZjsKKyAgICBwZXJmX2Rlc2NbMl0gPSAoc3RhcnRfbGJhID4+
IDgpICYgMHhmZjsKKyAgICBwZXJmX2Rlc2NbM10gPSBzdGFydF9sYmEgJiAweGZmOworCisgICAg
cGVyZl9kZXNjWzRdID0gKHBlcmZfa2IgPj4gMjQpICYgMHhmZjsKKyAgICBwZXJmX2Rlc2NbNV0g
PSAocGVyZl9rYiA+PiAxNikgJiAweGZmOworICAgIHBlcmZfZGVzY1s2XSA9IChwZXJmX2tiID4+
IDgpICYgMHhmZjsKKyAgICBwZXJmX2Rlc2NbN10gPSBwZXJmX2tiICYgMHhmZjsKKworICAgIHBl
cmZfZGVzY1s4XSA9IChlbmRfbGJhID4+IDI0KSAmIDB4ZmY7CisgICAgcGVyZl9kZXNjWzldID0g
KGVuZF9sYmEgPj4gMTYpICYgMHhmZjsKKyAgICBwZXJmX2Rlc2NbMTBdID0gKGVuZF9sYmEgPj4g
OCkgJiAweGZmOworICAgIHBlcmZfZGVzY1sxMV0gPSBlbmRfbGJhICYgMHhmZjsKKworICAgIHBl
cmZfZGVzY1sxMl0gPSAocGVyZl9rYiA+PiAyNCkgJiAweGZmOworICAgIHBlcmZfZGVzY1sxM10g
PSAocGVyZl9rYiA+PiAxNikgJiAweGZmOworICAgIHBlcmZfZGVzY1sxNF0gPSAocGVyZl9rYiA+
PiA4KSAmIDB4ZmY7CisgICAgcGVyZl9kZXNjWzE1XSA9IHBlcmZfa2IgJiAweGZmOworCisgICAg
cmVxLT5yZXFfbGVuID0gQ0RfUEVSRl9IRUFERVJfTEVOICsKKyAgICAgICAgICAgICAgICAgICAo
bWF4X251bV9kZXNjciAqIENEX1BFUkZfVFlQRV9QRVJGT1JNQU5DRV9ERVNDUl9MRU4pOworCisg
ICAgcmVxLT5pbl9sZW4gPSAocmVxLT5yZXFfbGVuIDwgcmVzcF9sZW4pID8gcmVxLT5yZXFfbGVu
IDogcmVzcF9sZW47CisKKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsK
K30KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRfZ2V0X3BlcmZvcm1hbmNlKENkU2NzaUxVICpk
ZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICB1aW50MzJfdCBkYXRhX3R5cGUsIG1heF9u
dW1fZGVzY3IsIHN0YXJ0X2xiYSwgdHlwZTsKKworICAgIHJlcS0+eGZlcl9kaXIgPSBTQ1NJX1hG
RVJfRlJPTV9ERVY7CisKKyAgICBkYXRhX3R5cGUgPSByZXEtPmNkYlsxXSAmIDB4MGY7CisgICAg
c3RhcnRfbGJhID0gKHJlcS0+Y2RiWzJdIDw8IDI0KSB8CisgICAgICAgICAgICAgICAgKHJlcS0+
Y2RiWzNdIDw8IDE2KSB8CisgICAgICAgICAgICAgICAgKHJlcS0+Y2RiWzRdIDw8IDgpIHwKKyAg
ICAgICAgICAgICAgICAgcmVxLT5jZGJbNV07CisgICAgbWF4X251bV9kZXNjciA9IChyZXEtPmNk
Yls4XSA8PCA4KSB8IHJlcS0+Y2RiWzldOworICAgIHR5cGUgPSByZXEtPmNkYlsxMF07CisKKyAg
ICBzd2l0Y2ggKHR5cGUpIHsKKyAgICBjYXNlIENEX1BFUkZfVFlQRV9QRVJGT1JNQU5DRToKKyAg
ICAgICAgY2Rfc2NzaV9nZXRfcGVyZm9ybWFuY2VfcmVzcF9wZXJmb3JtYW5jZShkZXYsIHJlcSwg
c3RhcnRfbGJhLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGRhdGFfdHlwZSwgbWF4X251bV9kZXNjcik7CisgICAgICAgIGJyZWFrOworICAgIGNhc2Ug
Q0RfUEVSRl9UWVBFX1VOVVNBQkxFX0FSRUE6IC8qIG5vdCB3cml0YWJsZSAqLworICAgIGNhc2Ug
Q0RfUEVSRl9UWVBFX0RFRkVDVF9TVEFUVVM6IC8qIG5vdCByZXN0cmljdGVkIG92ZXJ3cml0ZSBt
ZWRpYSAqLworICAgIGNhc2UgQ0RfUEVSRl9UWVBFX1dSSVRFX1NQRUVEOiAvKiB1bnN1cHBvcnRl
ZCwgaXJyZWxldmFudCAqLworICAgIGRlZmF1bHQ6CisgICAgICAgIFNQSUNFX0RFQlVHKCJnZXRf
cGVyZm9ybWFuY2UsIGx1bjolIiBHX0dVSU5UMzJfRk9STUFUCisgICAgICAgICAgICAgICAgICAg
ICIgdW5zdXBwb3J0ZWQgdHlwZToweCV4IgorICAgICAgICAgICAgICAgICAgICAiIGRhdGFfdHlw
ZToweCV4IG1heF9udW06JSIgR19HVUlOVDMyX0ZPUk1BVCwKKyAgICAgICAgICAgICAgICAgICAg
cmVxLT5sdW4sIHR5cGUsIGRhdGFfdHlwZSwgbWF4X251bV9kZXNjcik7CisgICAgICAgIGNkX3Nj
c2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX0lOVkFMSURf
Q0RCX0ZJRUxEKTsKKyAgICAgICAgcmV0dXJuOworICAgIH0KK30KKworI2RlZmluZSBDRF9NRUNI
QU5JU01fU1RBVFVTX0hEUl9MRU4gICAgIDgKKworLyogYnl0ZSAwICovCisjZGVmaW5lIENEX0NI
QU5HRVJfRkFVTFRfRkxBRyAgICAgICAgICAgMHg4MAorCisjZGVmaW5lIENEX0NIQU5HRVJfUkVB
RFkgICAgICAgICAgICAgICAgMHgwMAorI2RlZmluZSBDRF9DSEFOR0VSX0xPQURJTkcgICAgICAg
ICAgICAgIDB4MDEKKyNkZWZpbmUgQ0RfQ0hBTkdFUl9VTkxPQURJTkcgICAgICAgICAgICAweDAy
CisjZGVmaW5lIENEX0NIQU5HRVJfSU5JVElBTElaSU5HICAgICAgICAgMHgwMworCisvKiBieXRl
IDEgKi8KKyNkZWZpbmUgQ0RfQ0hBTkdFUl9ET09SX09QRU5fRkxBRyAgICAgICAweDEwCisKKyNk
ZWZpbmUgQ0RfTUVDSEFOSVNNX1NUQVRFX0lETEUgICAgICAgICAweDAwCisjZGVmaW5lIENEX01F
Q0hBTklTTV9TVEFURV9QTEFZSU5HICAgICAgMHgwMQorI2RlZmluZSBDRF9NRUNIQU5JU01fU1RB
VEVfU0NBTk5JTkcgICAgIDB4MDIKKy8qIEFDVElWRTogd2l0aCBJbml0aWF0b3IsIENvbXBvc2l0
ZSBvciBPdGhlciBwb3J0cworICAoaS5lLiBSRUFELCBQTEFZIENELCBTQ0FOIGR1cmluZyBQTEFZ
IENEKSAqLworI2RlZmluZSBDRF9NRUNIQU5JU01fU1RBVEVfQUNUSVZFICAgICAgIDB4MDMKKyNk
ZWZpbmUgQ0RfTUVDSEFOSVNNX1NUQVRFX05PX0lORk8gICAgICAweDA3CisKKy8qIHNsb3RzICov
CisjZGVmaW5lIENEX01FQ0hBTklTTV9TVEFUVVNfU0xPVF9MRU4gICAgNAorCisjZGVmaW5lIENE
X01FQ0hBTklTTV9TTE9UX0RJU0tfQ0hBTkdFRCAgMHgwMQorI2RlZmluZSBDRF9NRUNIQU5JU01f
U0xPVF9ESVNLX1BSRVNFTlQgIDB4ODAKKyNkZWZpbmUgQ0RfTUVDSEFOSVNNX1NMT1RfRElTS19D
V1BfViAgICAweDAyCisjZGVmaW5lIENEX01FQ0hBTklTTV9TTE9UX0RJU0tfQ1dQICAgICAgMHgw
MQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9tZWNoYW5pc21fc3RhdHVzKENkU2NzaUxVICpk
ZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICB1aW50OF90ICpvdXRidWYgPSByZXEtPmJ1
ZjsKKyAgICB1aW50MzJfdCByZXNwX2xlbiA9IENEX01FQ0hBTklTTV9TVEFUVVNfSERSX0xFTjsK
KworICAgIHJlcS0+eGZlcl9kaXIgPSBTQ1NJX1hGRVJfRlJPTV9ERVY7CisKKyAgICByZXEtPnJl
cV9sZW4gPSAocmVxLT5jZGJbOF0gPDwgOCkgfCByZXEtPmNkYls5XTsKKyAgICBtZW1zZXQob3V0
YnVmLCAwLCByZXEtPnJlcV9sZW4pOworCisgICAgLyogRm9yIG5vbi1jaGFuZ2VyIGRldmljZXMg
dGhlIGN1cmVudCBzbG90IG51bWJlciBmaWVsZCBpcyByZXNlcnZlZCwgc2V0IG9ubHkgc3RhdHVz
ICovCisgICAgb3V0YnVmWzBdIHw9IChDRF9DSEFOR0VSX1JFQURZIDw8IDUpOworCisgICAgb3V0
YnVmWzFdIHw9ICghZGV2LT5sb2FkZWQpID8gQ0RfQ0hBTkdFUl9ET09SX09QRU5fRkxBRyA6IDA7
CisgICAgb3V0YnVmWzFdIHw9IChkZXYtPnBvd2VyX2NvbmQgPT0gQ0RfUE9XRVJfU1RBVFVTX0FD
VElWRSkgPworICAgICAgICAgICAgICAgICAoQ0RfTUVDSEFOSVNNX1NUQVRFX0FDVElWRSA8PCA1
KSA6IChDRF9NRUNIQU5JU01fU1RBVEVfSURMRSA8PCA1KTsKKworICAgIC8qIEZvciBub24tY2hh
bmdlciBkZXZpY2VzIHRoZSBudW1iZXIgb2Ygc2xvdCB0YWJsZXMgcmV0dXJuZWQgc2hhbGwgYmUg
emVybywgc28gd2UgbGVhdmUKKyAgICAgICBib3RoICdOdW1iZXIgb2YgU2xvdHMgQXZhaWxhYmxl
JyBhbmQgJ0xlbmd0aCBvZiBTbG90IFRhYmxlJyBmaWVsZHMgYXMgemVyb3MgKi8KKworICAgIHJl
cS0+aW5fbGVuID0gKHJlcS0+cmVxX2xlbiA8IHJlc3BfbGVuKSA/IHJlcS0+cmVxX2xlbiA6IHJl
c3BfbGVuOworCisgICAgU1BJQ0VfREVCVUcoIm1lY2hhbmlzbV9zdGF0dXMsIGx1bjolIiBHX0dV
SU5UMzJfRk9STUFULCByZXEtPmx1bik7CisKKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29k
KGRldiwgcmVxKTsKK30KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9yZWFkX2FzeW5jX2NvbXBsZXRl
KEdPYmplY3QgKnNyY19vYmplY3QsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgR0FzeW5jUmVzdWx0ICpyZXN1bHQsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgZ3BvaW50ZXIgdXNlcl9kYXRhKQoreworICAgIEdGaWxlSW5wdXRTdHJlYW0g
KnN0cmVhbSA9IEdfRklMRV9JTlBVVF9TVFJFQU0oc3JjX29iamVjdCk7CisgICAgQ2RTY3NpUmVx
dWVzdCAqcmVxID0gKENkU2NzaVJlcXVlc3QgKil1c2VyX2RhdGE7CisgICAgQ2RTY3NpVGFyZ2V0
ICpzdCA9IChDZFNjc2lUYXJnZXQgKilyZXEtPnByaXZfZGF0YTsKKyAgICBDZFNjc2lMVSAqZGV2
ID0gJnN0LT51bml0c1tyZXEtPmx1bl07CisgICAgR0Vycm9yICplcnJvciA9IE5VTEw7CisgICAg
Z3NpemUgYnl0ZXNfcmVhZDsKKyAgICBnYm9vbGVhbiBmaW5pc2hlZDsKKworICAgIHJlcS0+cmVx
X3N0YXRlID0gU0NTSV9SRVFfQ09NUExFVEU7CisgICAgcmVxLT5jYW5jZWxfaWQgPSAwOworCisv
LyAgICBnX2Fzc2VydChzdHJlYW0gPT0gZGV2LT5zdHJlYW0pOworICAgIGlmIChzdHJlYW0gIT0g
ZGV2LT5zdHJlYW0pIHsKKyAgICAgICAgdWludDMyX3Qgb3Bjb2RlID0gKHVpbnQzMl90KXJlcS0+
Y2RiWzBdOworICAgICAgICBTUElDRV9ERUJVRygicmVhZF9hc3luY19jb21wbGV0ZSBCQUQgU1RS
RUFNLCBsdW46ICUiIEdfR1VJTlQzMl9GT1JNQVQKKyAgICAgICAgICAgICAgICAgICAgIiByZXE6
ICUiIEdfR1VJTlQ2NF9GT1JNQVQgIiBvcDogMHglMDJ4IiwKKyAgICAgICAgICAgICAgICAgICAg
cmVxLT5sdW4sIHJlcS0+cmVxX2xlbiwgb3Bjb2RlKTsKKyAgICAgICAgY2Rfc2NzaV9jbWRfY29t
cGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfVEFSR0VUX0ZBSUxVUkUpOwor
ICAgICAgICBjZF9zY3NpX2Rldl9yZXF1ZXN0X2NvbXBsZXRlKHN0LT51c2VyX2RhdGEsIHJlcSk7
CisgICAgICAgIHJldHVybjsKKyAgICB9CisKKyAgICBieXRlc19yZWFkID0gZ19pbnB1dF9zdHJl
YW1fcmVhZF9maW5pc2goR19JTlBVVF9TVFJFQU0oc3RyZWFtKSwgcmVzdWx0LCAmZXJyb3IpOwor
ICAgIGZpbmlzaGVkID0gYnl0ZXNfcmVhZCA+IDA7CisgICAgaWYgKGZpbmlzaGVkKSB7CisgICAg
ICAgIFNQSUNFX0RFQlVHKCJyZWFkX2FzeW5jX2NvbXBsZXRlLCBsdW46ICUiIEdfR1VJTlQzMl9G
T1JNQVQKKyAgICAgICAgICAgICAgICAgICAgIiBmaW5pc2hlZDogJWQgYnl0ZXNfcmVhZDogJSIg
R19HVUlOVDY0X0ZPUk1BVAorICAgICAgICAgICAgICAgICAgICAiIHJlcTogJSIgIEdfR1VJTlQ2
NF9GT1JNQVQsCisgICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBmaW5pc2hlZCwgKHVpbnQ2
NF90KWJ5dGVzX3JlYWQsIHJlcS0+cmVxX2xlbik7CisKKyAgICAgICAgcmVxLT5pbl9sZW4gPSAo
Ynl0ZXNfcmVhZCA8PSByZXEtPnJlcV9sZW4pID8gYnl0ZXNfcmVhZCA6IHJlcS0+cmVxX2xlbjsK
KyAgICAgICAgcmVxLT5zdGF0dXMgPSBHT09EOworICAgIH0gZWxzZSB7CisgICAgICAgIGlmIChl
cnJvciAhPSBOVUxMKSB7CisgICAgICAgICAgICBTUElDRV9FUlJPUigiZ19pbnB1dF9zdHJlYW1f
cmVhZF9maW5pc2ggZmFpbGVkOiAlcyIsIGVycm9yLT5tZXNzYWdlKTsKKyAgICAgICAgICAgIGdf
Y2xlYXJfZXJyb3IgKCZlcnJvcik7CisgICAgICAgIH0gZWxzZSB7CisgICAgICAgICAgICBTUElD
RV9FUlJPUigiZ19pbnB1dF9zdHJlYW1fcmVhZF9maW5pc2ggZmFpbGVkIChubyBlcnIgcHJvdmlk
ZWQpIik7CisgICAgICAgIH0KKyAgICAgICAgcmVxLT5pbl9sZW4gPSAwOworICAgICAgICByZXEt
PnN0YXR1cyA9IEdPT0Q7CisgICAgfQorICAgIGNkX3Njc2lfZGV2X3JlcXVlc3RfY29tcGxldGUo
c3QtPnVzZXJfZGF0YSwgcmVxKTsKK30KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9yZWFkX2FzeW5j
X2NhbmNlbGVkKEdDYW5jZWxsYWJsZSAqY2FuY2VsbGFibGUsIGdwb2ludGVyIHVzZXJfZGF0YSkK
K3sKKyAgICBDZFNjc2lSZXF1ZXN0ICpyZXEgPSAoQ2RTY3NpUmVxdWVzdCAqKXVzZXJfZGF0YTsK
KyAgICBDZFNjc2lUYXJnZXQgKnN0ID0gKENkU2NzaVRhcmdldCAqKXJlcS0+cHJpdl9kYXRhOwor
CisgICAgZ19hc3NlcnQoY2FuY2VsbGFibGUgPT0gc3QtPmNhbmNlbGxhYmxlKTsKKyAgICBnX2Nh
bmNlbGxhYmxlX2Rpc2Nvbm5lY3QoY2FuY2VsbGFibGUsIHJlcS0+Y2FuY2VsX2lkKTsKKyAgICBy
ZXEtPmNhbmNlbF9pZCA9IDA7CisKKyAgICByZXEtPnJlcV9zdGF0ZSA9CisgICAgICAgIChzdC0+
c3RhdGUgPT0gQ0RfU0NTSV9UR1RfU1RBVEVfUlVOTklORykgPyBTQ1NJX1JFUV9DQU5DRUxFRCA6
IFNDU0lfUkVRX0RJU1BPU0VEOworICAgIHJlcS0+aW5fbGVuID0gMDsKKyAgICByZXEtPnN0YXR1
cyA9IEdPT0Q7CisKKyAgICBjZF9zY3NpX2Rldl9yZXF1ZXN0X2NvbXBsZXRlKHN0LT51c2VyX2Rh
dGEsIHJlcSk7Cit9CisKK3N0YXRpYyBpbnQgY2Rfc2NzaV9yZWFkX2FzeW5jX3N0YXJ0KENkU2Nz
aUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICBDZFNjc2lUYXJnZXQgKnN0ID0g
ZGV2LT50Z3Q7CisgICAgR0ZpbGVJbnB1dFN0cmVhbSAqc3RyZWFtID0gZGV2LT5zdHJlYW07CisK
KyAgICBTUElDRV9ERUJVRygicmVhZF9hc3luY19zdGFydCwgbHVuOiUiIEdfR1VJTlQzMl9GT1JN
QVQKKyAgICAgICAgICAgICAgICAiIGxiYTogJSIgR19HVUlOVDY0X0ZPUk1BVCAiIG9mZnNldDog
JSIgR19HVUlOVDY0X0ZPUk1BVAorICAgICAgICAgICAgICAgICIgY250OiAlIiBHX0dVSU5UNjRf
Rk9STUFUICIgbGVuOiAlIiBHX0dVSU5UNjRfRk9STUFULAorICAgICAgICAgICAgICAgIHJlcS0+
bHVuLCByZXEtPmxiYSwgcmVxLT5vZmZzZXQsIHJlcS0+Y291bnQsIHJlcS0+cmVxX2xlbik7CisK
KyAgICByZXEtPmNhbmNlbF9pZCA9IGdfY2FuY2VsbGFibGVfY29ubmVjdChzdC0+Y2FuY2VsbGFi
bGUsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgR19DQUxMQkFD
SyhjZF9zY3NpX3JlYWRfYXN5bmNfY2FuY2VsZWQpLAorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHJlcSwgLyogZGF0YSAqLworICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIE5VTEwpOyAvKiBkYXRhIGRlc3Ryb3kgY2IgKi8KKyAgICBp
ZiAocmVxLT5jYW5jZWxfaWQgPT0gMCkgeworICAgICAgICAvKiBhbHJlYWR5IGNhbmNlbGVkICov
CisgICAgICAgIHJldHVybiAtMTsKKyAgICB9CisKKyAgICBnX3NlZWthYmxlX3NlZWsoR19TRUVL
QUJMRShzdHJlYW0pLAorICAgICAgICAgICAgICAgICAgICByZXEtPm9mZnNldCwKKyAgICAgICAg
ICAgICAgICAgICAgR19TRUVLX1NFVCwKKyAgICAgICAgICAgICAgICAgICAgTlVMTCwgLyogY2Fu
Y2VsbGFibGUgKi8KKyAgICAgICAgICAgICAgICAgICAgTlVMTCk7IC8qIGVycm9yICovCisKKyAg
ICBnX2lucHV0X3N0cmVhbV9yZWFkX2FzeW5jKEdfSU5QVVRfU1RSRUFNKHN0cmVhbSksCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICByZXEtPmJ1ZiwgLyogYnVmZmVyIHRvIGZpbGwgKi8K
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcS0+cmVxX2xlbiwKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIEdfUFJJT1JJVFlfREVGQVVMVCwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHN0LT5jYW5jZWxsYWJsZSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGNkX3Njc2lfcmVhZF9hc3luY19jb21wbGV0ZSwKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIChncG9pbnRlcilyZXEpOyAvKiBjYWxsYmFjayBhcmd1bWVudCAqLworICAgIHJldHVy
biAwOworfQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9yZWFkKENkU2NzaUxVICpkZXYsIENk
U2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICBpZiAoZGV2LT5wb3dlcl9jb25kID09IENEX1NDU0lf
UE9XRVJfU1RPUFBFRCkgeworICAgICAgICBTUElDRV9ERUJVRygicmVhZCwgbHVuOiAlIiBHX0dV
SU5UMzJfRk9STUFUICIgaXMgc3RvcHBlZCIsIHJlcS0+bHVuKTsKKyAgICAgICAgY2Rfc2NzaV9j
bWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfSU5JVF9DTURfUkVR
VUlSRUQpOworICAgICAgICByZXR1cm47CisgICAgfSBlbHNlIGlmICghZGV2LT5sb2FkZWQgfHwg
ZGV2LT5zdHJlYW0gPT0gTlVMTCkgeworICAgICAgICBTUElDRV9ERUJVRygicmVhZCwgbHVuOiAl
IiBHX0dVSU5UMzJfRk9STUFUICIgaXMgbm90IGxvYWRlZCIsIHJlcS0+bHVuKTsKKyAgICAgICAg
Y2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfTk9U
X1JFQURZX05PX01FRElVTSk7CisgICAgICAgIHJldHVybjsKKyAgICB9CisKKyAgICByZXEtPmNk
Yl9sZW4gPSBzY3NpX2NkYl9sZW5ndGgocmVxLT5jZGIpOworCisgICAgcmVxLT5sYmEgPSBzY3Np
X2NkYl9sYmEocmVxLT5jZGIsIHJlcS0+Y2RiX2xlbik7CisgICAgcmVxLT5vZmZzZXQgPSByZXEt
PmxiYSAqIGRldi0+YmxvY2tfc2l6ZTsKKworICAgIHJlcS0+Y291bnQgPSBzY3NpX2NkYl94ZmVy
X2xlbmd0aChyZXEtPmNkYiwgcmVxLT5jZGJfbGVuKTsgLyogeGZlciBpbiBibG9ja3MgKi8KKyAg
ICByZXEtPnJlcV9sZW4gPSByZXEtPmNvdW50ICogZGV2LT5ibG9ja19zaXplOworCisgICAgY2Rf
c2NzaV9yZWFkX2FzeW5jX3N0YXJ0KGRldiwgcmVxKTsKK30KKwordm9pZCBjZF9zY3NpX2Rldl9y
ZXF1ZXN0X3N1Ym1pdChDZFNjc2lUYXJnZXQgKnN0LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7Cisg
ICAgdWludDMyX3QgbHVuID0gcmVxLT5sdW47CisgICAgdWludDMyX3Qgb3Bjb2RlID0gKHVpbnQz
Ml90KXJlcS0+Y2RiWzBdOworICAgIGNvbnN0IGNoYXIgKmNtZF9uYW1lID0gc2NzaV9jbWRfbmFt
ZVtvcGNvZGVdOworICAgIENkU2NzaUxVICpkZXYgPSAmc3QtPnVuaXRzW2x1bl07CisKKyAgICBT
UElDRV9ERUJVRygicmVxdWVzdF9zdWJtaXQsIGx1bjogJSIgR19HVUlOVDMyX0ZPUk1BVCAiIG9w
OiAweCUwMnggJXMiLCBsdW4sIG9wY29kZSwgY21kX25hbWUpOworCisgICAgaWYgKHN0LT5jdXJf
cmVxICE9IE5VTEwpIHsKKyAgICAgICAgU1BJQ0VfRVJST1IoInJlcXVlc3Rfc3VibWl0LCByZXF1
ZXN0IG5vdCBpZGxlIik7CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQo
ZGV2LCByZXEsICZzZW5zZV9jb2RlX1RBUkdFVF9GQUlMVVJFKTsKKyAgICAgICAgZ290byBkb25l
OworICAgIH0KKyAgICBpZiAocmVxLT5yZXFfc3RhdGUgIT0gU0NTSV9SRVFfSURMRSkgeworICAg
ICAgICBTUElDRV9FUlJPUigicmVxdWVzdF9zdWJtaXQsIHByZXYgcmVxdWVzdCBvdXRzdGFuZGlu
ZyIpOworICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAm
c2Vuc2VfY29kZV9UQVJHRVRfRkFJTFVSRSk7CisgICAgICAgIGdvdG8gZG9uZTsKKyAgICB9Cisg
ICAgcmVxLT5yZXFfc3RhdGUgPSBTQ1NJX1JFUV9SVU5OSU5HOworICAgIHN0LT5jdXJfcmVxID0g
cmVxOworCisgICAgLyogSU5RVUlSWSBzaG91bGQgc2VuZCByZXNwb25zZSBldmVuIGZvciBub24t
ZXhpc3RpbmcgTFVOcyAqLworICAgIGlmICghY2Rfc2NzaV90YXJnZXRfbHVuX2xlZ2FsKHN0LCBs
dW4pKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJyZXF1ZXN0X3N1Ym1pdCwgaWxsZWdhbCBsdW46
JSIgR19HVUlOVDMyX0ZPUk1BVCwgbHVuKTsKKyAgICAgICAgaWYgKG9wY29kZSA9PSBJTlFVSVJZ
KSB7CisgICAgICAgICAgICBpZiAocmVxLT5jZGJbMV0gJiAweDEpIHsKKyAgICAgICAgICAgICAg
ICBjZF9zY3NpX2NtZF9pbnF1aXJ5X3ZwZF9ub19sdW4oZGV2LCByZXEsIFBFUklGX1FVQUxJRklF
Ul9VTlNVUFBPUlRFRCk7CisgICAgICAgICAgICB9IGVsc2UgeworICAgICAgICAgICAgICAgIGNk
X3Njc2lfY21kX2lucXVpcnlfc3RhbmRhcmRfbm9fbHVuKGRldiwgcmVxLCBQRVJJRl9RVUFMSUZJ
RVJfVU5TVVBQT1JURUQpOworICAgICAgICAgICAgfQorICAgICAgICB9IGVsc2UgeworICAgICAg
ICAgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2Nv
ZGVfTFVOX05PVF9TVVBQT1JURUQpOworICAgICAgICB9CisgICAgICAgIGdvdG8gZG9uZTsKKyAg
ICB9CisgICAgaWYgKCFjZF9zY3NpX3RhcmdldF9sdW5fcmVhbGl6ZWQoc3QsIGx1bikpIHsKKyAg
ICAgICAgU1BJQ0VfRVJST1IoInJlcXVlc3Rfc3VibWl0LCBhYnNlbnQgbHVuOiUiIEdfR1VJTlQz
Ml9GT1JNQVQsIGx1bik7CisgICAgICAgIGlmIChvcGNvZGUgPT0gSU5RVUlSWSkgeworICAgICAg
ICAgICAgaWYgKHJlcS0+Y2RiWzFdICYgMHgxKSB7CisgICAgICAgICAgICAgICAgY2Rfc2NzaV9j
bWRfaW5xdWlyeV92cGRfbm9fbHVuKGRldiwgcmVxLCBQRVJJRl9RVUFMSUZJRVJfTk9UX0NPTk5F
Q1RFRCk7CisgICAgICAgICAgICB9IGVsc2UgeworICAgICAgICAgICAgICAgIGNkX3Njc2lfY21k
X2lucXVpcnlfc3RhbmRhcmRfbm9fbHVuKGRldiwgcmVxLCBQRVJJRl9RVUFMSUZJRVJfTk9UX0NP
Tk5FQ1RFRCk7CisgICAgICAgICAgICB9CisgICAgICAgIH0gZWxzZSB7CisgICAgICAgICAgICBj
ZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9MVU5f
Tk9UX1NVUFBPUlRFRCk7CisgICAgICAgIH0KKyAgICAgICAgZ290byBkb25lOworICAgIH0KKwor
ICAgIGlmIChkZXYtPnNob3J0X3NlbnNlLmtleSAhPSBOT19TRU5TRSkgeworICAgICAgICBnYm9v
bGVhbiBwZW5kaW5nX3NlbnNlID0gVFJVRTsKKyAgICAgICAgaWYgKGRldi0+c2hvcnRfc2Vuc2Uu
a2V5ID09IFVOSVRfQVRURU5USU9OKSB7CisgICAgICAgICAgICBpZiAoY2Rfc2NzaV9vcGNvZGVf
dWFfc3VwcmVzcyhvcGNvZGUpKSB7CisgICAgICAgICAgICAgICAgcGVuZGluZ19zZW5zZSA9IEZB
TFNFOyAvKiBVQSBzdXByZXNzZWQgKi8KKyAgICAgICAgICAgIH0KKyAgICAgICAgfSBlbHNlIGlm
IChvcGNvZGUgPT0gUkVRVUVTVF9TRU5TRSkgeworICAgICAgICAgICAgcGVuZGluZ19zZW5zZSA9
IEZBTFNFOyAvKiBzZW5zZSByZXR1cm5lZCBhcyBkYXRhICovCisgICAgICAgIH0KKyAgICAgICAg
aWYgKHBlbmRpbmdfc2Vuc2UpIHsKKyAgICAgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2No
ZWNrX2NvbmQoZGV2LCByZXEsIE5VTEwpOyAvKiBzZW5zZSBhbHJlYWR5IHNldCAqLworICAgICAg
ICAgICAgZ290byBkb25lOworICAgICAgICB9CisgICAgfQorCisgICAgLyogc2F2ZSB0aGUgdGFy
Z2V0IHRvIGJlIHVzZWQgaW4gY2FsbGJhY2tzIHdoZXJlIG9ubHkgcmVxIGlzIHBhc3NlZCAqLwor
ICAgIHJlcS0+cHJpdl9kYXRhID0gKHZvaWQgKilzdDsKKworICAgIHJlcS0+cmVxX2xlbiA9IDA7
CisKKyAgICBzd2l0Y2ggKG9wY29kZSkgeworICAgIGNhc2UgUkVQT1JUX0xVTlM6CisgICAgICAg
IGNkX3Njc2lfY21kX3JlcG9ydF9sdW5zKHN0LCBkZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOwor
ICAgIGNhc2UgVEVTVF9VTklUX1JFQURZOgorICAgICAgICBjZF9zY3NpX2NtZF90ZXN0X3VuaXRf
cmVhZHkoZGV2LCByZXEpOworICAgICAgICBicmVhazsKKyAgICBjYXNlIElOUVVJUlk6CisgICAg
ICAgIGNkX3Njc2lfY21kX2lucXVpcnkoZGV2LCByZXEpOworICAgICAgICBicmVhazsKKyAgICBj
YXNlIFJFUVVFU1RfU0VOU0U6CisgICAgICAgIGNkX3Njc2lfY21kX3JlcXVlc3Rfc2Vuc2UoZGV2
LCByZXEpOworICAgICAgICBicmVhazsKKyAgICBjYXNlIFJFQURfNjoKKyAgICBjYXNlIFJFQURf
MTA6CisgICAgY2FzZSBSRUFEXzEyOgorICAgIGNhc2UgUkVBRF8xNjoKKyAgICAgICAgY2Rfc2Nz
aV9jbWRfcmVhZChkZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgUkVBRF9DQVBB
Q0lUWV8xMDoKKyAgICAgICAgY2Rfc2NzaV9jbWRfcmVhZF9jYXBhY2l0eShkZXYsIHJlcSk7Cisg
ICAgICAgIGJyZWFrOworICAgIGNhc2UgUkVBRF9UT0M6CisgICAgICAgIGNkX3Njc2lfY21kX3Jl
YWRfdG9jKGRldiwgcmVxKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBHRVRfRVZFTlRfU1RB
VFVTX05PVElGSUNBVElPTjoKKyAgICAgICAgY2Rfc2NzaV9jbWRfZ2V0X2V2ZW50X3N0YXR1c19u
b3RpZmljYXRpb24oZGV2LCByZXEpOworICAgICAgICBicmVhazsKKyAgICBjYXNlIFJFQURfRElT
Q19JTkZPUk1BVElPTjoKKyAgICAgICAgY2Rfc2NzaV9jbWRfZ2V0X3JlYWRfZGlzY19pbmZvcm1h
dGlvbihkZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgUkVBRF9UUkFDS19JTkZP
Uk1BVElPTjoKKyAgICAgICAgY2Rfc2NzaV9jbWRfZ2V0X3JlYWRfdHJhY2tfaW5mb3JtYXRpb24o
ZGV2LCByZXEpOworICAgICAgICBicmVhazsKKyAgICBjYXNlIE1PREVfU0VOU0VfMTA6CisgICAg
ICAgIGNkX3Njc2lfY21kX21vZGVfc2Vuc2VfMTAoZGV2LCByZXEpOworICAgICAgICBicmVhazsK
KyAgICBjYXNlIE1PREVfU0VMRUNUOgorICAgICAgICBjZF9zY3NpX2NtZF9tb2RlX3NlbGVjdF82
KGRldiwgcmVxKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBNT0RFX1NFTEVDVF8xMDoKKyAg
ICAgICAgY2Rfc2NzaV9jbWRfbW9kZV9zZWxlY3RfMTAoZGV2LCByZXEpOworICAgICAgICBicmVh
azsKKyAgICBjYXNlIEdFVF9DT05GSUdVUkFUSU9OOgorICAgICAgICBjZF9zY3NpX2NtZF9nZXRf
Y29uZmlndXJhdGlvbihkZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgQUxMT1df
TUVESVVNX1JFTU9WQUw6CisgICAgICAgIGNkX3Njc2lfY21kX2FsbG93X21lZGl1bV9yZW1vdmFs
KGRldiwgcmVxKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBNTUNfU0VORF9FVkVOVDoKKyAg
ICAgICAgY2Rfc2NzaV9jbWRfc2VuZF9ldmVudChkZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOwor
ICAgIGNhc2UgTU1DX1JFUE9SVF9LRVk6CisgICAgICAgIGNkX3Njc2lfY21kX3JlcG9ydF9rZXko
ZGV2LCByZXEpOworICAgICAgICBicmVhazsKKyAgICBjYXNlIE1NQ19TRU5EX0tFWToKKyAgICAg
ICAgY2Rfc2NzaV9jbWRfc2VuZF9rZXkoZGV2LCByZXEpOworICAgICAgICBicmVhazsKKyAgICBj
YXNlIFNUQVJUX1NUT1A6CisgICAgICAgIGNkX3Njc2lfY21kX3N0YXJ0X3N0b3BfdW5pdChkZXYs
IHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgTU1DX0dFVF9QRVJGT1JNQU5DRToKKyAg
ICAgICAgY2Rfc2NzaV9jbWRfZ2V0X3BlcmZvcm1hbmNlKGRldiwgcmVxKTsKKyAgICAgICAgYnJl
YWs7CisgICAgY2FzZSBNTUNfTUVDSEFOSVNNX1NUQVRVUzoKKyAgICAgICAgY2Rfc2NzaV9jbWRf
bWVjaGFuaXNtX3N0YXR1cyhkZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGRlZmF1bHQ6
CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5z
ZV9jb2RlX0lOVkFMSURfT1BDT0RFKTsKKyAgICAgICAgYnJlYWs7CisgICAgfQorCisgICAgaWYg
KHJlcS0+cmVxX2xlbiA+IElOVDMyX01BWCkgeworICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0
ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZBTElEX0NEQl9GSUVMRCk7Cisg
ICAgICAgIGdvdG8gZG9uZTsKKyAgICB9CisKK2RvbmU6CisgICAgU1BJQ0VfREVCVUcoInJlcXVl
c3Rfc3VibWl0IGRvbmUsIGx1bjogJSIgR19HVUlOVDMyX0ZPUk1BVAorICAgICAgICAgICAgICAg
ICIgb3A6IDB4JTAyeCAlcywgc3RhdGU6ICVzIHN0YXR1czogJSIgR19HVUlOVDMyX0ZPUk1BVCAi
IGxlbjogJSIgR19HVUlOVDY0X0ZPUk1BVCwKKyAgICAgICAgICAgICAgICBsdW4sIG9wY29kZSwg
Y21kX25hbWUsIENkU2NzaVJlcVN0YXRlX3N0cihyZXEtPnJlcV9zdGF0ZSksIHJlcS0+c3RhdHVz
LAorICAgICAgICAgICAgICAgIHJlcS0+aW5fbGVuKTsKKworICAgIGlmIChyZXEtPnJlcV9zdGF0
ZSA9PSBTQ1NJX1JFUV9DT01QTEVURSkgeworICAgICAgICBjZF9zY3NpX2Rldl9yZXF1ZXN0X2Nv
bXBsZXRlKHN0LT51c2VyX2RhdGEsIHJlcSk7CisgICAgfQorfQorCit2b2lkIGNkX3Njc2lfZGV2
X3JlcXVlc3RfY2FuY2VsKENkU2NzaVRhcmdldCAqc3QsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sK
KyAgICBpZiAoc3QtPmN1cl9yZXEgPT0gcmVxKSB7CisgICAgICAgIGlmIChyZXEtPnJlcV9zdGF0
ZSA9PSBTQ1NJX1JFUV9SVU5OSU5HKSB7CisgICAgICAgICAgICBTUElDRV9ERUJVRygicmVxdWVz
dF9jYW5jZWw6IGx1bjogJSIgR19HVUlOVDMyX0ZPUk1BVAorICAgICAgICAgICAgICAgICAgICAg
ICAgICIgb3A6IDB4JTAyeCBsZW46ICUiIEdfR1VJTlQ2NF9GT1JNQVQsCisgICAgICAgICAgICAg
ICAgICAgICAgICByZXEtPmx1biwgKHVuc2lnbmVkIGludClyZXEtPmNkYlswXSwgcmVxLT5yZXFf
bGVuKTsKKyAgICAgICAgICAgIGdfY2FuY2VsbGFibGVfY2FuY2VsKHN0LT5jYW5jZWxsYWJsZSk7
CisgICAgICAgIH0gZWxzZSB7CisgICAgICAgICAgICBTUElDRV9ERUJVRygicmVxdWVzdF9jYW5j
ZWw6IHJlcXVlc3QgaXMgbm90IHJ1bm5pbmciKTsKKyAgICAgICAgfQorICAgIH0gZWxzZSB7Cisg
ICAgICAgIFNQSUNFX0RFQlVHKCJyZXF1ZXN0X2NhbmNlbDogb3RoZXIgcmVxdWVzdCBpcyBvdXRz
dGFuZGluZyIpOworICAgIH0KK30KKwordm9pZCBjZF9zY3NpX2Rldl9yZXF1ZXN0X3JlbGVhc2Uo
Q2RTY3NpVGFyZ2V0ICpzdCwgQ2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAgIHN0LT5jdXJfcmVx
ID0gTlVMTDsKKyAgICBjZF9zY3NpX3JlcV9pbml0KHJlcSk7CisKKyAgICBpZiAoc3QtPnN0YXRl
ID09IENEX1NDU0lfVEdUX1NUQVRFX1JFU0VUKSB7CisgICAgICAgIGNkX3Njc2lfdGFyZ2V0X2Rv
X3Jlc2V0KHN0KTsKKyAgICB9Cit9CisKKyNlbmRpZiAvKiBVU0VfVVNCUkVESVIgKi8KZGlmZiAt
LWdpdCBhL3NyYy9jZC1zY3NpLmggYi9zcmMvY2Qtc2NzaS5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0
CmluZGV4IDAwMDAwMDAwLi42NTI0MjQ0NAotLS0gL2Rldi9udWxsCisrKyBiL3NyYy9jZC1zY3Np
LmgKQEAgLTAsMCArMSwxMjEgQEAKKy8qIC0qLSBNb2RlOiBDOyBjLWJhc2ljLW9mZnNldDogNDsg
aW5kZW50LXRhYnMtbW9kZTogbmlsIC0qLSAqLworLyoKKyAgIENEIGRldmljZSBlbXVsYXRpb24g
LSBTQ1NJIGVuZ2luZQorCisgICBDb3B5cmlnaHQgKEMpIDIwMTggUmVkIEhhdCwgSW5jLgorCisg
ICBSZWQgSGF0IEF1dGhvcnM6CisgICBBbGV4YW5kZXIgTmV6aGluc2t5PGFuZXpoaW5zQHJlZGhh
dC5jb20+CisKKyAgIFRoaXMgbGlicmFyeSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlz
dHJpYnV0ZSBpdCBhbmQvb3IKKyAgIG1vZGlmeSBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdO
VSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKKyAgIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBG
cmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlcgorICAgdmVyc2lvbiAyLjEgb2YgdGhlIExp
Y2Vuc2UsIG9yIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCisKKyAgIFRoaXMg
bGlicmFyeSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVs
LAorICAgYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQg
d2FycmFudHkgb2YKKyAgIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VM
QVIgUFVSUE9TRS4gIFNlZSB0aGUgR05VCisgICBMZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5z
ZSBmb3IgbW9yZSBkZXRhaWxzLgorCisgICBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5
IG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCisgICBMaWNlbnNlIGFsb25nIHdpdGgg
dGhpcyBsaWJyYXJ5OyBpZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4u
CisqLworCisjaWZuZGVmIFNQSUNFX0dUS19DRF9TQ1NJX0hfXworI2RlZmluZSBTUElDRV9HVEtf
Q0RfU0NTSV9IX18KKworI2luY2x1ZGUgImNkLXNjc2ktZGV2LXBhcmFtcy5oIgorI2luY2x1ZGUg
ImNkLXVzYi1idWxrLW1zZC5oIgorI2luY2x1ZGUgInNjc2ktY29uc3RhbnRzLmgiCisKKyNpZiBk
ZWZpbmVkKEdfT1NfV0lOMzIpCisjaW5jbHVkZSA8d2luc29jazIuaD4KKyNpbmNsdWRlIDx3aW5k
b3dzLmg+CisvKiBXaW5kb3dzIGlzIGFsd2F5cyBMRSBhdCB0aGUgbW9tZW50ICovCisjZGVmaW5l
IGxlMzJ0b2goeCkgICAgICAgICAgKHgpCisjZGVmaW5lIGh0b2xlMzIoeCkgICAgICAgICAgKHgp
CisjZGVmaW5lIGh0b2JlMzIoeCkgICAgICAgICAgaHRvbmwoeCkKKyNlbmRpZgorCit0eXBlZGVm
IGVudW0gU2NzaVhmZXJEaXIgeworICAgIFNDU0lfWEZFUl9OT05FID0gMCwgIC8qIFRFU1RfVU5J
VF9SRUFEWSwgLi4uICAgICAgICAgICAqLworICAgIFNDU0lfWEZFUl9GUk9NX0RFViwgIC8qIFJF
QUQsIElOUVVJUlksIE1PREVfU0VOU0UsIC4uLiAqLworICAgIFNDU0lfWEZFUl9UT19ERVYsICAg
IC8qIFdSSVRFLCBNT0RFX1NFTEVDVCwgLi4uICAgICAgICAqLworfSBTY3NpWGZlckRpcjsKKwor
I2RlZmluZSBTQ1NJX0NEQl9CVUZfU0laRSAgIDE2CisKK3R5cGVkZWYgZW51bSBDZFNjc2lSZXFT
dGF0ZSB7CisgICAgU0NTSV9SRVFfSURMRSA9IDAsCisgICAgU0NTSV9SRVFfUlVOTklORywKKyAg
ICBTQ1NJX1JFUV9DT01QTEVURSwKKyAgICBTQ1NJX1JFUV9DQU5DRUxFRCwKKyAgICBTQ1NJX1JF
UV9ESVNQT1NFRCwKK30gQ2RTY3NpUmVxU3RhdGU7CisKK3R5cGVkZWYgc3RydWN0IENkU2NzaVJl
cXVlc3QgeworICAgIC8qIHJlcXVlc3QgKi8KKyAgICB1aW50OF90IGNkYltTQ1NJX0NEQl9CVUZf
U0laRV07CisgICAgdWludDMyX3QgY2RiX2xlbjsKKworICAgIHVpbnQzMl90IHRhZzsKKyAgICB1
aW50MzJfdCBsdW47CisKKyAgICB1aW50OF90ICpidWY7CisgICAgdWludDMyX3QgYnVmX2xlbjsK
KworICAgIC8qIGludGVybmFsICovCisgICAgQ2RTY3NpUmVxU3RhdGUgcmVxX3N0YXRlOworICAg
IFNjc2lYZmVyRGlyIHhmZXJfZGlyOworICAgIHVpbnQ2NF90IGNhbmNlbF9pZDsKKyAgICB2b2lk
ICpwcml2X2RhdGE7CisKKyAgICB1aW50NjRfdCBsYmE7IC8qIG9mZnNldCBpbiBsb2dpY2FsIGJs
b2NrcyBpZiByZWxldmFudCAqLworICAgIHVpbnQ2NF90IGNvdW50OyAvKiBjb3VudCBpbiBsb2dp
Y2FsIGJsb2NrcyAqLworCisgICAgdWludDY0X3Qgb2Zmc2V0OyAvKiBzY3NpIGNkYiBvZmZzZXQs
IG5vcm1hbGl6ZWQgdG8gYnl0ZXMgKi8KKyAgICB1aW50NjRfdCByZXFfbGVuOyAvKiBzY3NpIGNk
YiByZXF1ZXN0IGxlbmd0aCwgbm9ybWFsaXplZCB0byBieXRlcyAqLworCisgICAgLyogcmVzdWx0
ICovCisgICAgdWludDY0X3QgaW5fbGVuOyAvKiBsZW5ndGggb2YgZGF0YSBhY3R1YWxseSBhdmFp
bGFibGUgYWZ0ZXIgcmVhZCAqLworICAgIHVpbnQzMl90IHN0YXR1czsgLyogU0NTSSBzdGF0dXMg
Y29kZSAqLworCit9IENkU2NzaVJlcXVlc3Q7CisKK0NkU2NzaVJlcVN0YXRlIGNkX3Njc2lfZ2V0
X3JlcV9zdGF0ZShDZFNjc2lSZXF1ZXN0ICpyZXEpOworCisvKiBTQ1NJIHRhcmdldC9kZXZpY2Ug
QVBJICovCit0eXBlZGVmIHN0cnVjdCBDZFNjc2lUYXJnZXQgQ2RTY3NpVGFyZ2V0OworCisvKiB0
byBiZSB1c2VkIGluIGNhbGxiYWNrcyAqLworQ2RTY3NpVGFyZ2V0ICpjZF9zY3NpX3RhcmdldF9h
bGxvYyh2b2lkICp0YXJnZXRfdXNlcl9kYXRhLCB1aW50MzJfdCBtYXhfbHVucyk7Cit2b2lkIGNk
X3Njc2lfdGFyZ2V0X2ZyZWUoQ2RTY3NpVGFyZ2V0ICpzY3NpX3RhcmdldCk7CisKK2ludCBjZF9z
Y3NpX2Rldl9yZWFsaXplKENkU2NzaVRhcmdldCAqc2NzaV90YXJnZXQsIHVpbnQzMl90IGx1biwK
KyAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IENkU2NzaURldmljZVBhcmFtZXRlcnMgKmRl
dl9wYXJhbXMpOworaW50IGNkX3Njc2lfZGV2X3VucmVhbGl6ZShDZFNjc2lUYXJnZXQgKnNjc2lf
dGFyZ2V0LCB1aW50MzJfdCBsdW4pOworCitpbnQgY2Rfc2NzaV9kZXZfbG9jayhDZFNjc2lUYXJn
ZXQgKnNjc2lfdGFyZ2V0LCB1aW50MzJfdCBsdW4sIGdib29sZWFuIGxvY2spOworaW50IGNkX3Nj
c2lfZGV2X2xvYWQoQ2RTY3NpVGFyZ2V0ICpzY3NpX3RhcmdldCwgdWludDMyX3QgbHVuLAorICAg
ICAgICAgICAgICAgICAgICAgY29uc3QgQ2RTY3NpTWVkaWFQYXJhbWV0ZXJzICptZWRpYV9wYXJh
bXMpOworaW50IGNkX3Njc2lfZGV2X2dldF9pbmZvKENkU2NzaVRhcmdldCAqc2NzaV90YXJnZXQs
IHVpbnQzMl90IGx1biwgQ2RTY3NpRGV2aWNlSW5mbyAqbHVuX2luZm8pOworaW50IGNkX3Njc2lf
ZGV2X3VubG9hZChDZFNjc2lUYXJnZXQgKnNjc2lfdGFyZ2V0LCB1aW50MzJfdCBsdW4pOworCit2
b2lkIGNkX3Njc2lfZGV2X3JlcXVlc3Rfc3VibWl0KENkU2NzaVRhcmdldCAqc2NzaV90YXJnZXQs
IENkU2NzaVJlcXVlc3QgKnJlcXVlc3QpOwordm9pZCBjZF9zY3NpX2Rldl9yZXF1ZXN0X2NhbmNl
bChDZFNjc2lUYXJnZXQgKnNjc2lfdGFyZ2V0LCBDZFNjc2lSZXF1ZXN0ICpyZXF1ZXN0KTsKK3Zv
aWQgY2Rfc2NzaV9kZXZfcmVxdWVzdF9yZWxlYXNlKENkU2NzaVRhcmdldCAqc2NzaV90YXJnZXQs
IENkU2NzaVJlcXVlc3QgKnJlcXVlc3QpOworCitpbnQgY2Rfc2NzaV9kZXZfcmVzZXQoQ2RTY3Np
VGFyZ2V0ICpzY3NpX3RhcmdldCwgdWludDMyX3QgbHVuKTsKKworaW50IGNkX3Njc2lfdGFyZ2V0
X3Jlc2V0KENkU2NzaVRhcmdldCAqc2NzaV90YXJnZXQpOworCisvKiBDYWxsYmFja3MKKyAqIFRo
ZXNlIGNhbGxiYWNrcyBhcmUgdXNlZCBieSB1cHBlciBsYXllciB0byBpbXBsZW1lbnQgc3BlY2lm
aWMgU0NTSQorICogdGFyZ2V0IGRldmljZXMuCisgKi8KK3ZvaWQgY2Rfc2NzaV9kZXZfcmVxdWVz
dF9jb21wbGV0ZSh2b2lkICp0YXJnZXRfdXNlcl9kYXRhLCBDZFNjc2lSZXF1ZXN0ICpyZXF1ZXN0
KTsKK3ZvaWQgY2Rfc2NzaV9kZXZfY2hhbmdlZCh2b2lkICp0YXJnZXRfdXNlcl9kYXRhLCB1aW50
MzJfdCBsdW4pOwordm9pZCBjZF9zY3NpX2Rldl9yZXNldF9jb21wbGV0ZSh2b2lkICp0YXJnZXRf
dXNlcl9kYXRhLCB1aW50MzJfdCBsdW4pOwordm9pZCBjZF9zY3NpX3RhcmdldF9yZXNldF9jb21w
bGV0ZSh2b2lkICp0YXJnZXRfdXNlcl9kYXRhKTsKKworI2VuZGlmIC8qIFNQSUNFX0dUS19DRF9T
Q1NJX0hfXyAqLwpkaWZmIC0tZ2l0IGEvc3JjL2NkLXVzYi1idWxrLW1zZC5jIGIvc3JjL2NkLXVz
Yi1idWxrLW1zZC5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwLi45NTM2NTE2
MwotLS0gL2Rldi9udWxsCisrKyBiL3NyYy9jZC11c2ItYnVsay1tc2QuYwpAQCAtMCwwICsxLDU0
NiBAQAorLyogLSotIE1vZGU6IEM7IGMtYmFzaWMtb2Zmc2V0OiA0OyBpbmRlbnQtdGFicy1tb2Rl
OiBuaWwgLSotICovCisvKgorICAgIFVTQiBDRCBEZXZpY2UgZW11bGF0aW9uIC0gRGF0YSBCdWxr
IHRyYW5zZmVycyAtIE1hc3MgU3RvcmFnZSBEZXZpY2UKKworICAgIENvcHlyaWdodCAoQykgMjAx
OCBSZWQgSGF0LCBJbmMuCisKKyAgICBSZWQgSGF0IEF1dGhvcnM6CisgICAgQWxleGFuZGVyIE5l
emhpbnNreTxhbmV6aGluc0ByZWRoYXQuY29tPgorCisgICAgVGhpcyBsaWJyYXJ5IGlzIGZyZWUg
c29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vcgorICAgIG1vZGlmeSBpdCB1
bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKKyAgICBMaWNl
bnNlIGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIK
KyAgICB2ZXJzaW9uIDIuMSBvZiB0aGUgTGljZW5zZSwgb3IgKGF0IHlvdXIgb3B0aW9uKSBhbnkg
bGF0ZXIgdmVyc2lvbi4KKworICAgIFRoaXMgbGlicmFyeSBpcyBkaXN0cmlidXRlZCBpbiB0aGUg
aG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAorICAgIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5U
WTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCisgICAgTUVSQ0hBTlRBQklM
SVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZSBHTlUKKyAg
ICBMZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgorCisgICAg
WW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFs
IFB1YmxpYworICAgIExpY2Vuc2UgYWxvbmcgd2l0aCB0aGlzIGxpYnJhcnk7IGlmIG5vdCwgc2Vl
IDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4KKyovCisKKyNpbmNsdWRlICJjb25maWcu
aCIKKyNpbmNsdWRlICJzcGljZS90eXBlcy5oIgorI2luY2x1ZGUgInNwaWNlLWNvbW1vbi5oIgor
I2luY2x1ZGUgInNwaWNlLXV0aWwuaCIKKyNpbmNsdWRlICJjZC11c2ItYnVsay1tc2QuaCIKKyNp
bmNsdWRlICJjZC1zY3NpLmgiCisKKyNpZmRlZiBVU0VfVVNCUkVESVIKKworI2RlZmluZSBTUElD
RV9FUlJPUihmbXQsIC4uLikgXAorICAgIGRvIHsgU1BJQ0VfREVCVUcoInVzYi1tc2QgZXJyb3I6
ICIgZm10ICwgIyMgX19WQV9BUkdTX18pOyB9IHdoaWxlICgwKQorCit0eXBlZGVmIGVudW0gVXNi
Q2RTdGF0ZSB7CisgICAgVVNCX0NEX1NUQVRFX0lOSVQsIC8qIE5vdCByZWFkeSAqLworICAgIFVT
Ql9DRF9TVEFURV9DQlcsIC8qIFdhaXRpbmcgZm9yIENvbW1hbmQgQmxvY2sgKi8KKyAgICBVU0Jf
Q0RfU1RBVEVfREFUQU9VVCwgLyogVHJhbnNmZXIgZGF0YSB0byBkZXZpY2UgKi8KKyAgICBVU0Jf
Q0RfU1RBVEVfREFUQUlOLCAvKiBUcmFuc2ZlciBkYXRhIGZyb20gZGV2aWNlICovCisgICAgVVNC
X0NEX1NUQVRFX1pFUk9fREFUQUlOLCAvKiBOZWVkIHRvIHNlbmQgemVybyBidWxrLWluIGJlZm9y
ZSBzdGF0dXMgKi8KKyAgICBVU0JfQ0RfU1RBVEVfQ1NXLCAvKiBTZW5kIENvbW1hbmQgU3RhdHVz
ICovCisgICAgVVNCX0NEX1NUQVRFX0RFVklDRV9SRVNFVCwgLyogcmVzZXQgb2YgYSBzaW5nbGUg
ZGV2aWNlICovCisgICAgVVNCX0NEX1NUQVRFX1RBUkdFVF9SRVNFVCAvKiByZXNldCBvZiBlbnRp
cmUgdGFyZ2V0ICovCit9IFVzYkNkU3RhdGU7CisKKy8qIFVTQiBNU0QgQ29tbWFuZCBCbG9jayBX
cmFwcGVyICovCitzdHJ1Y3QgX19hdHRyaWJ1dGVfXygoX19wYWNrZWRfXykpIFVzYkNkQ0JXIHsK
KyAgICB1aW50MzJfdCBzaWc7CisgICAgdWludDMyX3QgdGFnOworICAgIHVpbnQzMl90IGV4cF9k
YXRhX2xlbjsgLyogZXhwZWN0ZWQgZGF0YSB4ZmVyIGxlbmd0aCBmb3IgdGhlIHJlcXVlc3QgKi8K
KyAgICB1aW50OF90IGZsYWdzOworICAgIHVpbnQ4X3QgbHVuOworICAgIHVpbnQ4X3QgY21kX2xl
bjsgLyogYWN0dWFsIGxlbmd0aCBvZiB0aGUgc2NzaSBjb21tYW5kIHRoYXQgZm9sbG93cyAqLwor
ICAgIHVpbnQ4X3QgY21kWzE2XTsgLyogc2NzaSBjb21tYW5kIHRvIHBlcmZvcm0gKi8KK307CisK
Ky8qIFVTQiBNU0QgQ29tbWFuZCBTdGF0dXMgV3JhcHBlciAqLworc3RydWN0IF9fYXR0cmlidXRl
X18oKF9fcGFja2VkX18pKSBVc2JDZENTVyB7CisgICAgdWludDMyX3Qgc2lnOworICAgIHVpbnQz
Ml90IHRhZzsKKyAgICB1aW50MzJfdCByZXNpZHVlOworICAgIHVpbnQ4X3Qgc3RhdHVzOworfTsK
KworLyogVXNiQ2RDU1c6OnN0YXR1cyAqLwordHlwZWRlZiBlbnVtIFVzYk1zZFN0YXR1cyB7Cisg
ICAgVVNCX01TRF9TVEFUVVNfR09PRCA9IDAsCisgICAgVVNCX01TRF9TVEFUVVNfRkFJTEVEID0g
MSwKKyAgICBVU0JfTVNEX1NUQVRVU19QSEFTRV9FUlIgPSAyLAorfSBVc2JNc2RTdGF0dXM7CisK
K3R5cGVkZWYgc3RydWN0IFVzYkNkQnVsa01zZFJlcXVlc3QgeworICAgIENkU2NzaVJlcXVlc3Qg
c2NzaV9yZXE7CisKKyAgICB1aW50MzJfdCBsdW47CisgICAgdWludDMyX3QgdXNiX3RhZzsKKyAg
ICB1aW50MzJfdCB1c2JfcmVxX2xlbjsgLyogbGVuZ3RoIG9mIGRhdGEgcmVxdWVzdGVkIGJ5IHVz
YiAqLworICAgIHVpbnQzMl90IHNjc2lfaW5fbGVuOyAvKiBsZW5ndGggb2YgZGF0YSByZXR1cm5l
ZCBieSBzY3NpIGxpbWl0ZWQgYnkgdXNiIHJlcXVlc3QgKi8KKworICAgIHVpbnQzMl90IHhmZXJf
bGVuOyAvKiBsZW5ndGggb2YgZGF0YSB0cmFuc2ZlcmVkIHVudGlsIG5vdyAqLworICAgIHVpbnQz
Ml90IGJ1bGtfaW5fbGVuOyAvKiBsZW5ndGggb2YgdGhlIGxhc3QgcG9zdHBvbmVkIGJ1bGstaW4g
cmVxdWVzdCAqLworCisgICAgc3RydWN0IFVzYkNkQ1NXIGNzdzsgLyogdXNiIHN0YXR1cyBoZWFk
ZXIgKi8KK30gVXNiQ2RCdWxrTXNkUmVxdWVzdDsKKwordHlwZWRlZiBzdHJ1Y3QgVXNiQ2RCdWxr
TXNkRGV2aWNlIHsKKyAgICBVc2JDZFN0YXRlIHN0YXRlOworICAgIENkU2NzaVRhcmdldCAqc2Nz
aV90YXJnZXQ7IC8qIHNjc2kgaGFuZGxlICovCisgICAgdm9pZCAqdXNiX3VzZXJfZGF0YTsgLyog
dXNlZCBpbiBjYWxsYmFja3MgdG8gdXNiICovCisgICAgVXNiQ2RCdWxrTXNkUmVxdWVzdCB1c2Jf
cmVxOyAvKiBub3cgc3VwcG9ydGluZyBhIHNpbmdsZSBjbWQgKi8KKyAgICB1aW50OF90ICpkYXRh
X2J1ZjsKKyAgICB1aW50MzJfdCBkYXRhX2J1Zl9sZW47Cit9IFVzYkNkQnVsa01zZERldmljZTsK
Kworc3RhdGljIGlubGluZSBjb25zdCBjaGFyICp1c2JfY2Rfc3RhdGVfc3RyKFVzYkNkU3RhdGUg
c3RhdGUpCit7CisgICAgc3dpdGNoIChzdGF0ZSkgeworICAgIGNhc2UgVVNCX0NEX1NUQVRFX0lO
SVQ6CisgICAgICAgIHJldHVybiAiSU5JVCI7CisgICAgY2FzZSBVU0JfQ0RfU1RBVEVfQ0JXOgor
ICAgICAgICByZXR1cm4gIkNCVyI7CisgICAgY2FzZSBVU0JfQ0RfU1RBVEVfREFUQU9VVDoKKyAg
ICAgICAgcmV0dXJuICJEQVRBT1VUIjsKKyAgICBjYXNlIFVTQl9DRF9TVEFURV9EQVRBSU46Cisg
ICAgICAgIHJldHVybiAiREFUQUlOIjsKKyAgICBjYXNlIFVTQl9DRF9TVEFURV9aRVJPX0RBVEFJ
TjoKKyAgICAgICAgcmV0dXJuICJaRVJPX0RBVEFJTiI7CisgICAgY2FzZSBVU0JfQ0RfU1RBVEVf
Q1NXOgorICAgICAgICByZXR1cm4gIkNTVyI7CisgICAgY2FzZSBVU0JfQ0RfU1RBVEVfREVWSUNF
X1JFU0VUOgorICAgICAgICByZXR1cm4gIkRFVl9SRVNFVCI7CisgICAgY2FzZSBVU0JfQ0RfU1RB
VEVfVEFSR0VUX1JFU0VUOgorICAgICAgICByZXR1cm4gIlRHVF9SRVNFVCI7CisgICAgZGVmYXVs
dDoKKyAgICAgICAgcmV0dXJuICJJTExFR0FMIjsKKyAgICB9Cit9CisKK3N0YXRpYyB2b2lkIGNk
X3VzYl9idWxrX21zZF9zZXRfc3RhdGUoVXNiQ2RCdWxrTXNkRGV2aWNlICpjZCwgVXNiQ2RTdGF0
ZSBzdGF0ZSkKK3sKKyAgICBTUElDRV9ERUJVRygiU3RhdGUgJXMgLT4gJXMiLCB1c2JfY2Rfc3Rh
dGVfc3RyKGNkLT5zdGF0ZSksIHVzYl9jZF9zdGF0ZV9zdHIoc3RhdGUpKTsKKyAgICBjZC0+c3Rh
dGUgPSBzdGF0ZTsKK30KKworVXNiQ2RCdWxrTXNkRGV2aWNlICpjZF91c2JfYnVsa19tc2RfYWxs
b2Modm9pZCAqdXNiX3VzZXJfZGF0YSwgdWludDMyX3QgbWF4X2x1bnMpCit7CisgICAgVXNiQ2RC
dWxrTXNkRGV2aWNlICpjZCA9IGdfbmV3MChVc2JDZEJ1bGtNc2REZXZpY2UsIDEpOworCisgICAg
Y2QtPmRhdGFfYnVmX2xlbiA9IDI1NiAqIDEwMjQ7CisgICAgY2QtPmRhdGFfYnVmID0gZ19tYWxs
b2MoY2QtPmRhdGFfYnVmX2xlbik7CisKKyAgICBjZC0+c2NzaV90YXJnZXQgPSBjZF9zY3NpX3Rh
cmdldF9hbGxvYyhjZCwgbWF4X2x1bnMpOworICAgIGlmIChjZC0+c2NzaV90YXJnZXQgPT0gTlVM
TCkgeworICAgICAgICBnX2ZyZWUoY2QtPmRhdGFfYnVmKTsKKyAgICAgICAgZ19mcmVlKGNkKTsK
KyAgICAgICAgcmV0dXJuIE5VTEw7CisgICAgfQorICAgIGNkX3VzYl9idWxrX21zZF9zZXRfc3Rh
dGUoY2QsIFVTQl9DRF9TVEFURV9JTklUKTsKKyAgICBjZC0+dXNiX3VzZXJfZGF0YSA9IHVzYl91
c2VyX2RhdGE7CisKKyAgICBTUElDRV9ERUJVRygiQWxsb2MsIG1heF9sdW5zOiUiIEdfR1VJTlQz
Ml9GT1JNQVQsIG1heF9sdW5zKTsKKyAgICByZXR1cm4gY2Q7Cit9CisKK2ludCBjZF91c2JfYnVs
a19tc2RfcmVhbGl6ZShVc2JDZEJ1bGtNc2REZXZpY2UgKmNkLCB1aW50MzJfdCBsdW4sCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgQ2RTY3NpRGV2aWNlUGFyYW1ldGVycyAqZGV2
X3BhcmFtcykKK3sKKyAgICBDZFNjc2lEZXZpY2VQYXJhbWV0ZXJzIHNjc2lfZGV2X3BhcmFtczsK
KyAgICBpbnQgcmM7CisKKyAgICBzY3NpX2Rldl9wYXJhbXMudmVuZG9yID0gZGV2X3BhcmFtcy0+
dmVuZG9yID8gOiAiU1BJQ0UiOworICAgIHNjc2lfZGV2X3BhcmFtcy5wcm9kdWN0ID0gZGV2X3Bh
cmFtcy0+cHJvZHVjdCA/IDogIlVTQi1DRCI7CisgICAgc2NzaV9kZXZfcGFyYW1zLnZlcnNpb24g
PSBkZXZfcGFyYW1zLT52ZXJzaW9uID8gOiAiMC4xIjsKKyAgICBzY3NpX2Rldl9wYXJhbXMuc2Vy
aWFsID0gZGV2X3BhcmFtcy0+c2VyaWFsID8gOiAiMTIzNDU2IjsKKworICAgIHJjID0gY2Rfc2Nz
aV9kZXZfcmVhbGl6ZShjZC0+c2NzaV90YXJnZXQsIGx1biwgJnNjc2lfZGV2X3BhcmFtcyk7Cisg
ICAgaWYgKHJjICE9IDApIHsKKyAgICAgICAgU1BJQ0VfRVJST1IoIkZhaWxlZCB0byByZWFsaXpl
IGx1bjolIiBHX0dVSU5UMzJfRk9STUFULCBsdW4pOworICAgICAgICByZXR1cm4gcmM7CisgICAg
fQorCisgICAgaWYgKGNkLT5zdGF0ZSA9PSBVU0JfQ0RfU1RBVEVfSU5JVCkgeworICAgICAgICAv
KiB3YWl0IG5leHQgcmVxdWVzdCAqLworICAgICAgICBjZF91c2JfYnVsa19tc2Rfc2V0X3N0YXRl
KGNkLCBVU0JfQ0RfU1RBVEVfQ0JXKTsKKyAgICAgICAgY2Rfc2NzaV9kZXZfcmVxdWVzdF9yZWxl
YXNlKGNkLT5zY3NpX3RhcmdldCwgJmNkLT51c2JfcmVxLnNjc2lfcmVxKTsKKyAgICB9CisKKyAg
ICBTUElDRV9ERUJVRygiUmVhbGl6ZSBPSyBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCwgbHVuKTsK
KyAgICByZXR1cm4gMDsKK30KKworaW50IGNkX3VzYl9idWxrX21zZF9sb2NrKFVzYkNkQnVsa01z
ZERldmljZSAqY2QsIHVpbnQzMl90IGx1biwgZ2Jvb2xlYW4gbG9jaykKK3sKKyAgICBpbnQgcmM7
CisKKyAgICByYyA9IGNkX3Njc2lfZGV2X2xvY2soY2QtPnNjc2lfdGFyZ2V0LCBsdW4sIGxvY2sp
OworICAgIGlmIChyYyAhPSAwKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJGYWlsZWQgdG8gbG9j
ayBsdW46JSIgR19HVUlOVDMyX0ZPUk1BVCwgbHVuKTsKKyAgICAgICAgcmV0dXJuIHJjOworICAg
IH0KKworICAgIFNQSUNFX0RFQlVHKCJMb2NrIE9LIGx1bjolIiBHX0dVSU5UMzJfRk9STUFULCBs
dW4pOworICAgIHJldHVybiAwOworfQorCitpbnQgY2RfdXNiX2J1bGtfbXNkX2xvYWQoVXNiQ2RC
dWxrTXNkRGV2aWNlICpjZCwgdWludDMyX3QgbHVuLAorICAgICAgICAgICAgICAgICAgICAgICAg
IGNvbnN0IENkU2NzaU1lZGlhUGFyYW1ldGVycyAqbWVkaWFfcGFyYW1zKQoreworICAgIGludCBy
YzsKKworICAgIHJjID0gY2Rfc2NzaV9kZXZfbG9hZChjZC0+c2NzaV90YXJnZXQsIGx1biwgbWVk
aWFfcGFyYW1zKTsKKyAgICBpZiAocmMgIT0gMCkgeworICAgICAgICBTUElDRV9FUlJPUigiRmFp
bGVkIHRvIGxvYWQgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQsIGx1bik7CisgICAgICAgIHJldHVy
biByYzsKKyAgICB9CisKKyAgICBTUElDRV9ERUJVRygiTG9hZCBPSyBsdW46JSIgR19HVUlOVDMy
X0ZPUk1BVCwgbHVuKTsKKyAgICByZXR1cm4gMDsKK30KKworaW50IGNkX3VzYl9idWxrX21zZF9n
ZXRfaW5mbyhVc2JDZEJ1bGtNc2REZXZpY2UgKmNkLCB1aW50MzJfdCBsdW4sIENkU2NzaURldmlj
ZUluZm8gKmx1bl9pbmZvKQoreworICAgIGludCByYzsKKworICAgIHJjID0gY2Rfc2NzaV9kZXZf
Z2V0X2luZm8oY2QtPnNjc2lfdGFyZ2V0LCBsdW4sIGx1bl9pbmZvKTsKKyAgICBpZiAocmMgIT0g
MCkgeworICAgICAgICBTUElDRV9FUlJPUigiRmFpbGVkIHRvIGdldCBpbmZvIGx1bjolIiBHX0dV
SU5UMzJfRk9STUFULCBsdW4pOworICAgICAgICByZXR1cm4gcmM7CisgICAgfQorCisgICAgcmV0
dXJuIDA7Cit9CisKK2ludCBjZF91c2JfYnVsa19tc2RfdW5sb2FkKFVzYkNkQnVsa01zZERldmlj
ZSAqY2QsIHVpbnQzMl90IGx1bikKK3sKKyAgICBpbnQgcmM7CisKKyAgICByYyA9IGNkX3Njc2lf
ZGV2X3VubG9hZChjZC0+c2NzaV90YXJnZXQsIGx1bik7CisgICAgaWYgKHJjICE9IDApIHsKKyAg
ICAgICAgU1BJQ0VfRVJST1IoIkZhaWxlZCB0byB1bmxvYWQgbHVuOiUiIEdfR1VJTlQzMl9GT1JN
QVQsIGx1bik7CisgICAgICAgIHJldHVybiByYzsKKyAgICB9CisKKyAgICBTUElDRV9ERUJVRygi
VW5sb2FkIE9LIGx1bjolIiBHX0dVSU5UMzJfRk9STUFULCBsdW4pOworICAgIHJldHVybiAwOwor
fQorCitpbnQgY2RfdXNiX2J1bGtfbXNkX3VucmVhbGl6ZShVc2JDZEJ1bGtNc2REZXZpY2UgKmNk
LCB1aW50MzJfdCBsdW4pCit7CisgICAgaW50IHJjOworCisgICAgcmMgPSBjZF9zY3NpX2Rldl91
bnJlYWxpemUoY2QtPnNjc2lfdGFyZ2V0LCBsdW4pOworICAgIGlmIChyYyAhPSAwKSB7CisgICAg
ICAgIFNQSUNFX0VSUk9SKCJVbnJlYWxpemUgbHVuOiUiIEdfR1VJTlQzMl9GT1JNQVQsIGx1bik7
CisgICAgICAgIHJldHVybiByYzsKKyAgICB9CisKKyAgICBTUElDRV9ERUJVRygiVW5yZWFsaXpl
IGx1bjolIiBHX0dVSU5UMzJfRk9STUFULCBsdW4pOworICAgIHJldHVybiAwOworfQorCit2b2lk
IGNkX3VzYl9idWxrX21zZF9mcmVlKFVzYkNkQnVsa01zZERldmljZSAqY2QpCit7CisgICAgY2Rf
c2NzaV90YXJnZXRfZnJlZShjZC0+c2NzaV90YXJnZXQpOworICAgIGdfZnJlZShjZC0+ZGF0YV9i
dWYpOworICAgIGdfZnJlZShjZCk7CisKKyAgICBTUElDRV9ERUJVRygiRnJlZSIpOworfQorCitp
bnQgY2RfdXNiX2J1bGtfbXNkX3Jlc2V0KFVzYkNkQnVsa01zZERldmljZSAqY2QpCit7CisgICAg
Y2Rfc2NzaV90YXJnZXRfcmVzZXQoY2QtPnNjc2lfdGFyZ2V0KTsKKyAgICBjZF91c2JfYnVsa19t
c2Rfc2V0X3N0YXRlKGNkLCBVU0JfQ0RfU1RBVEVfQ0JXKTsKKworICAgIFNQSUNFX0RFQlVHKCJS
ZXNldCIpOworICAgIHJldHVybiAwOworfQorCitzdGF0aWMgaW50IHBhcnNlX3VzYl9tc2RfY21k
KFVzYkNkQnVsa01zZERldmljZSAqY2QsIHVpbnQ4X3QgKmJ1ZiwgdWludDMyX3QgY2J3X2xlbikK
K3sKKyAgICBzdHJ1Y3QgVXNiQ2RDQlcgKmNidyA9IChzdHJ1Y3QgVXNiQ2RDQlcgKilidWY7Cisg
ICAgVXNiQ2RCdWxrTXNkUmVxdWVzdCAqdXNiX3JlcSA9ICZjZC0+dXNiX3JlcTsKKyAgICBDZFNj
c2lSZXF1ZXN0ICpzY3NpX3JlcSA9ICZ1c2JfcmVxLT5zY3NpX3JlcTsKKworICAgIGlmIChjYndf
bGVuICE9IHNpemVvZigqY2J3KSkgeworICAgICAgICBTUElDRV9FUlJPUigiQ01EOiBCYWQgQ0JX
IHNpemU6JSIgR19HVUlOVDMyX0ZPUk1BVCwgY2J3X2xlbik7CisgICAgICAgIHJldHVybiAtMTsK
KyAgICB9CisgICAgaWYgKGxlMzJ0b2goY2J3LT5zaWcpICE9IDB4NDM0MjUzNTUpIHsgLyogTVNE
IGNvbW1hbmQgc2lnbmF0dXJlICovCisgICAgICAgIFNQSUNFX0VSUk9SKCJDTUQ6IEJhZCBDQlcg
c2lnbmF0dXJlOiUwOHgiLCBsZTMydG9oKGNidy0+c2lnKSk7CisgICAgICAgIHJldHVybiAtMTsK
KyAgICB9CisgICAgaWYgKGNidy0+Y21kX2xlbiA8IDEgfHwgY2J3LT5jbWRfbGVuID49IDE2KSB7
CisgICAgICAgIFNQSUNFX0VSUk9SKCJDTUQ6IEJhZCBDQlcgY29tbWFuZCBsZW46JTA4eCIsIGNi
dy0+Y21kX2xlbik7CisgICAgICAgIHJldHVybiAtMTsKKyAgICB9CisKKyAgICB1c2JfcmVxLT5s
dW4gPSBjYnctPmx1bjsKKyAgICB1c2JfcmVxLT51c2JfdGFnID0gbGUzMnRvaChjYnctPnRhZyk7
CisgICAgdXNiX3JlcS0+dXNiX3JlcV9sZW4gPSBsZTMydG9oKGNidy0+ZXhwX2RhdGFfbGVuKTsK
KworICAgIHVzYl9yZXEtPnNjc2lfaW5fbGVuID0gMDsgLyogbm8gZGF0YSBmcm9tIHNjc2kgeWV0
ICovCisgICAgdXNiX3JlcS0+eGZlcl9sZW4gPSAwOyAvKiBubyBidWxrcyB0cmFuc2ZlcmVkIHll
dCAqLworICAgIHVzYl9yZXEtPmJ1bGtfaW5fbGVuID0gMDsgLyogbm8gYnVsay1pbiByZXF1ZXN0
cyB5ZXQgKi8KKworICAgIGlmICh1c2JfcmVxLT51c2JfcmVxX2xlbiA9PSAwKSB7CisgICAgICAg
IGNkX3VzYl9idWxrX21zZF9zZXRfc3RhdGUoY2QsIFVTQl9DRF9TVEFURV9DU1cpOyAvKiBubyBk
YXRhIC0gcmV0dXJuIHN0YXR1cyAqLworICAgICAgICBzY3NpX3JlcS0+YnVmID0gTlVMTDsKKyAg
ICAgICAgc2NzaV9yZXEtPmJ1Zl9sZW4gPSAwOworICAgIH0gZWxzZSBpZiAoY2J3LT5mbGFncyAm
IDB4ODApIHsKKyAgICAgICAgY2RfdXNiX2J1bGtfbXNkX3NldF9zdGF0ZShjZCwgVVNCX0NEX1NU
QVRFX0RBVEFJTik7IC8qIHJlYWQgY29tbWFuZCAqLworICAgICAgICBzY3NpX3JlcS0+YnVmID0g
Y2QtPmRhdGFfYnVmOworICAgICAgICBzY3NpX3JlcS0+YnVmX2xlbiA9IGNkLT5kYXRhX2J1Zl9s
ZW47CisgICAgfSBlbHNlIHsKKyAgICAgICAgY2RfdXNiX2J1bGtfbXNkX3NldF9zdGF0ZShjZCwg
VVNCX0NEX1NUQVRFX0RBVEFPVVQpOyAvKiB3cml0ZSBjb21tYW5kICovCisgICAgICAgIHNjc2lf
cmVxLT5idWYgPSBOVUxMOworICAgICAgICBzY3NpX3JlcS0+YnVmX2xlbiA9IDA7CisgICAgfQor
CisgICAgc2NzaV9yZXEtPmNkYl9sZW4gPSBjYnctPmNtZF9sZW47CisgICAgZ19hc3NlcnQoc2Nz
aV9yZXEtPmNkYl9sZW4gPD0gc2l6ZW9mKHNjc2lfcmVxLT5jZGIpKTsKKyAgICBtZW1jcHkoc2Nz
aV9yZXEtPmNkYiwgY2J3LT5jbWQsIHNjc2lfcmVxLT5jZGJfbGVuKTsKKworICAgIHNjc2lfcmVx
LT50YWcgPSB1c2JfcmVxLT51c2JfdGFnOworICAgIHNjc2lfcmVxLT5sdW4gPSB1c2JfcmVxLT5s
dW47CisKKyAgICBTUElDRV9ERUJVRygiQ01EIGx1bjolIiBHX0dVSU5UMzJfRk9STUFUICIgdGFn
OjB4JXggZmxhZ3M6JTA4eCAiCisgICAgICAgICJjZGJfbGVuOiUiIEdfR1VJTlQzMl9GT1JNQVQg
IiByZXFfbGVuOiUiIEdfR1VJTlQzMl9GT1JNQVQsCisgICAgICAgIHVzYl9yZXEtPmx1biwgdXNi
X3JlcS0+dXNiX3RhZywgY2J3LT5mbGFncywKKyAgICAgICAgc2NzaV9yZXEtPmNkYl9sZW4sIHVz
Yl9yZXEtPnVzYl9yZXFfbGVuKTsKKworICAgIC8qIHByZXBhcmUgc3RhdHVzIC0gQ1NXICovCisg
ICAgdXNiX3JlcS0+Y3N3LnNpZyA9IGh0b2xlMzIoMHg1MzQyNTM1NSk7CisgICAgdXNiX3JlcS0+
Y3N3LnRhZyA9IGNidy0+dGFnOworICAgIHVzYl9yZXEtPmNzdy5yZXNpZHVlID0gMDsKKyAgICB1
c2JfcmVxLT5jc3cuc3RhdHVzID0gKHVpbnQ4X3QpVVNCX01TRF9TVEFUVVNfR09PRDsKKworICAg
IHJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCB1c2JfY2RfY21kX2RvbmUoVXNiQ2RCdWxrTXNk
RGV2aWNlICpjZCkKK3sKKyAgICBVc2JDZEJ1bGtNc2RSZXF1ZXN0ICp1c2JfcmVxID0gJmNkLT51
c2JfcmVxOworICAgIENkU2NzaVJlcXVlc3QgKnNjc2lfcmVxID0gJnVzYl9yZXEtPnNjc2lfcmVx
OworCisgICAgY2RfdXNiX2J1bGtfbXNkX3NldF9zdGF0ZShjZCwgVVNCX0NEX1NUQVRFX0NCVyk7
IC8qIENvbW1hbmQgbmV4dCAqLworICAgIGNkX3Njc2lfZGV2X3JlcXVlc3RfcmVsZWFzZShjZC0+
c2NzaV90YXJnZXQsIHNjc2lfcmVxKTsKK30KKworc3RhdGljIHZvaWQgdXNiX2NkX3NlbmRfc3Rh
dHVzKFVzYkNkQnVsa01zZERldmljZSAqY2QpCit7CisgICAgVXNiQ2RCdWxrTXNkUmVxdWVzdCAq
dXNiX3JlcSA9ICZjZC0+dXNiX3JlcTsKKworICAgIFNQSUNFX0RFQlVHKCJDb21tYW5kIENTVyB0
YWc6MHgleCBtc2Rfc3RhdHVzOiVkIGxlbjolIiBHX0dVSU5UNjRfRk9STUFULAorICAgICAgICAg
ICAgICAgIGxlMzJ0b2godXNiX3JlcS0+Y3N3LnRhZyksIChpbnQpdXNiX3JlcS0+Y3N3LnN0YXR1
cywgc2l6ZW9mKHVzYl9yZXEtPmNzdykpOworCisgICAgdXNiX2NkX2NtZF9kb25lKGNkKTsKKwor
ICAgIGdfYXNzZXJ0KHVzYl9yZXEtPmNzdy5zaWcgPT0gaHRvbGUzMigweDUzNDI1MzU1KSk7Cisg
ICAgY2RfdXNiX2J1bGtfbXNkX3JlYWRfY29tcGxldGUoY2QtPnVzYl91c2VyX2RhdGEsCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHVpbnQ4X3QgKikmdXNiX3JlcS0+Y3N3LCBz
aXplb2YodXNiX3JlcS0+Y3N3KSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBC
VUxLX1NUQVRVU19HT09EKTsKK30KKworc3RhdGljIHZvaWQgdXNiX2NkX3NlbmRfY2FuY2VsZWQo
VXNiQ2RCdWxrTXNkRGV2aWNlICpjZCkKK3sKKyAgICBVc2JDZEJ1bGtNc2RSZXF1ZXN0ICp1c2Jf
cmVxID0gJmNkLT51c2JfcmVxOworCisgICAgU1BJQ0VfREVCVUcoIkNhbmNlbGVkIGNtZCB0YWc6
MHgleCwgbGVuOiUiIEdfR1VJTlQ2NF9GT1JNQVQsCisgICAgICAgICAgICAgICAgbGUzMnRvaCh1
c2JfcmVxLT5jc3cudGFnKSwgc2l6ZW9mKHVzYl9yZXEtPmNzdykpOworCisgICAgdXNiX2NkX2Nt
ZF9kb25lKGNkKTsKKworICAgIGNkX3VzYl9idWxrX21zZF9yZWFkX2NvbXBsZXRlKGNkLT51c2Jf
dXNlcl9kYXRhLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5VTEwsIDAsCisg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQlVMS19TVEFUVVNfQ0FOQ0VMRUQpOwor
fQorCitzdGF0aWMgdm9pZCB1c2JfY2Rfc2VuZF9kYXRhX2luKFVzYkNkQnVsa01zZERldmljZSAq
Y2QsIHVpbnQzMl90IG1heF9sZW4pCit7CisgICAgVXNiQ2RCdWxrTXNkUmVxdWVzdCAqdXNiX3Jl
cSA9ICZjZC0+dXNiX3JlcTsKKyAgICBDZFNjc2lSZXF1ZXN0ICpzY3NpX3JlcSA9ICZ1c2JfcmVx
LT5zY3NpX3JlcTsKKyAgICB1aW50OF90ICpidWYgPSAoKHVpbnQ4X3QgKilzY3NpX3JlcS0+YnVm
KSArIHVzYl9yZXEtPnhmZXJfbGVuOworICAgIHVpbnQzMl90IGF2YWlsX2xlbiA9IHVzYl9yZXEt
PnNjc2lfaW5fbGVuIC0gdXNiX3JlcS0+eGZlcl9sZW47CisgICAgdWludDMyX3Qgc2VuZF9sZW4g
PSBNSU4oYXZhaWxfbGVuLCBtYXhfbGVuKTsKKworICAgIFNQSUNFX0RFQlVHKCJEYXRhLWluIGNt
ZCB0YWcgMHgleCwgcmVtYWlucyAlIiBHX0dVSU5UMzJfRk9STUFUCisgICAgICAgICAgICAgICAg
IiwgcmVxdWVzdGVkICUiIEdfR1VJTlQzMl9GT1JNQVQgIiwgc2VuZCAlIiBHX0dVSU5UMzJfRk9S
TUFULAorICAgICAgICAgICAgICAgIHVzYl9yZXEtPmNzdy50YWcsIGF2YWlsX2xlbiwgbWF4X2xl
biwgc2VuZF9sZW4pOworCisgICAgZ19hc3NlcnQobWF4X2xlbiA8PSB1c2JfcmVxLT51c2JfcmVx
X2xlbik7CisKKyAgICBjZF91c2JfYnVsa19tc2RfcmVhZF9jb21wbGV0ZShjZC0+dXNiX3VzZXJf
ZGF0YSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidWYsIHNlbmRfbGVuLAor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEJVTEtfU1RBVFVTX0dPT0QpOworCisg
ICAgaWYgKHNjc2lfcmVxLT5zdGF0dXMgPT0gR09PRCkgeworICAgICAgICB1c2JfcmVxLT54ZmVy
X2xlbiArPSBzZW5kX2xlbjsKKyAgICAgICAgaWYgKHVzYl9yZXEtPnhmZXJfbGVuID09IHVzYl9y
ZXEtPnNjc2lfaW5fbGVuKSB7CisgICAgICAgICAgICAvKiBhbGwgZGF0YSBmb3IgdGhpcyBidWxr
IGhhcyBiZWVuIHRyYW5zZmVycmVkICovCisgICAgICAgICAgICBpZiAodXNiX3JlcS0+c2NzaV9p
bl9sZW4gPT0gdXNiX3JlcS0+dXNiX3JlcV9sZW4gfHwgLyogcmVxIGZ1bGx5IHNhdGlzZmllZCAq
LworICAgICAgICAgICAgICAgIHNlbmRfbGVuIDwgbWF4X2xlbikgeyAvKiBwYXJ0aWFsIGJ1bGsg
LSBubyBtb3JlIGRhdGEgKi8KKyAgICAgICAgICAgICAgICBjZF91c2JfYnVsa19tc2Rfc2V0X3N0
YXRlKGNkLCBVU0JfQ0RfU1RBVEVfQ1NXKTsKKyAgICAgICAgICAgIH0gZWxzZSB7CisgICAgICAg
ICAgICAgICAgLyogcGFydGlhbCBjbWQgZGF0YSBmdWxsZmlsbGVkIGVudGlyZSB2dWxrLWluIHJl
cXVlc3QgKi8KKyAgICAgICAgICAgICAgICBjZF91c2JfYnVsa19tc2Rfc2V0X3N0YXRlKGNkLCBV
U0JfQ0RfU1RBVEVfWkVST19EQVRBSU4pOworICAgICAgICAgICAgfQorICAgICAgICB9CisgICAg
fSBlbHNlIHsgLyogY21kIGZhaWxlZCAtIG5vIG1vcmUgZGF0YSAqLworICAgICAgICBjZF91c2Jf
YnVsa19tc2Rfc2V0X3N0YXRlKGNkLCBVU0JfQ0RfU1RBVEVfQ1NXKTsKKyAgICB9Cit9CisKK2lu
dCBjZF91c2JfYnVsa19tc2RfcmVhZChVc2JDZEJ1bGtNc2REZXZpY2UgKmNkLCB1aW50MzJfdCBt
YXhfbGVuKQoreworICAgIFVzYkNkQnVsa01zZFJlcXVlc3QgKnVzYl9yZXEgPSAmY2QtPnVzYl9y
ZXE7CisgICAgQ2RTY3NpUmVxdWVzdCAqc2NzaV9yZXEgPSAmdXNiX3JlcS0+c2NzaV9yZXE7CisK
KyAgICBTUElDRV9ERUJVRygibXNkX3JlYWQsIHN0YXRlOiAlcywgbGVuICUiIEdfR1VJTlQzMl9G
T1JNQVQsCisgICAgICAgICAgICAgICAgdXNiX2NkX3N0YXRlX3N0cihjZC0+c3RhdGUpLCBtYXhf
bGVuKTsKKworICAgIHN3aXRjaCAoY2QtPnN0YXRlKSB7CisgICAgY2FzZSBVU0JfQ0RfU1RBVEVf
Q1NXOiAvKiBDb21tYW5kIFN0YXR1cyAqLworICAgICAgICBpZiAobWF4X2xlbiA8IDEzKSB7Cisg
ICAgICAgICAgICBnb3RvIGZhaWw7CisgICAgICAgIH0KKyAgICAgICAgaWYgKGNkX3Njc2lfZ2V0
X3JlcV9zdGF0ZShzY3NpX3JlcSkgPT0gU0NTSV9SRVFfQ09NUExFVEUpIHsKKyAgICAgICAgICAg
IHVzYl9jZF9zZW5kX3N0YXR1cyhjZCk7CisgICAgICAgIH0gZWxzZSB7CisgICAgICAgICAgICB1
c2JfcmVxLT5idWxrX2luX2xlbiArPSBtYXhfbGVuOworICAgICAgICAgICAgU1BJQ0VfREVCVUco
Im1zZF9yZWFkIENTVywgcmVxIGluY29tcGxldGUsIGFkZGVkIGxlbiAlIiBHX0dVSU5UMzJfRk9S
TUFUCisgICAgICAgICAgICAgICAgICAgICAgICAiIHNhdmVkIGxlbiAlIiBHX0dVSU5UMzJfRk9S
TUFULAorICAgICAgICAgICAgICAgICAgICAgICAgbWF4X2xlbiwgdXNiX3JlcS0+YnVsa19pbl9s
ZW4pOworICAgICAgICB9CisgICAgICAgIGJyZWFrOworCisgICAgY2FzZSBVU0JfQ0RfU1RBVEVf
REFUQUlOOiAvKiBCdWxrIERhdGEtSU4gKi8KKyAgICAgICAgaWYgKGNkX3Njc2lfZ2V0X3JlcV9z
dGF0ZShzY3NpX3JlcSkgPT0gU0NTSV9SRVFfQ09NUExFVEUpIHsKKyAgICAgICAgICAgIHVzYl9j
ZF9zZW5kX2RhdGFfaW4oY2QsIG1heF9sZW4pOworICAgICAgICB9IGVsc2UgeworICAgICAgICAg
ICAgdXNiX3JlcS0+YnVsa19pbl9sZW4gKz0gbWF4X2xlbjsKKyAgICAgICAgICAgIFNQSUNFX0RF
QlVHKCJtc2RfcmVhZCBEQVRBSU4sIHJlcSBpbmNvbXBsZXRlLCBhZGRlZCBsZW4gJSIgR19HVUlO
VDMyX0ZPUk1BVAorICAgICAgICAgICAgICAgICAgICAgICAgIiBzYXZlZCBsZW4gJSIgR19HVUlO
VDMyX0ZPUk1BVCwKKyAgICAgICAgICAgICAgICAgICAgICAgIG1heF9sZW4sIHVzYl9yZXEtPmJ1
bGtfaW5fbGVuKTsKKyAgICAgICAgfQorICAgICAgICBicmVhazsKKworICAgIGNhc2UgVVNCX0NE
X1NUQVRFX1pFUk9fREFUQUlOOgorICAgICAgICBjZF91c2JfYnVsa19tc2RfcmVhZF9jb21wbGV0
ZShjZC0+dXNiX3VzZXJfZGF0YSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgTlVMTCwgMCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQlVMS19T
VEFUVVNfR09PRCk7CisgICAgICAgIGNkX3VzYl9idWxrX21zZF9zZXRfc3RhdGUoY2QsIFVTQl9D
RF9TVEFURV9DU1cpOyAvKiBTdGF0dXMgbmV4dCAqLworICAgICAgICBicmVhazsKKworICAgIGRl
ZmF1bHQ6CisgICAgICAgIFNQSUNFX0VSUk9SKCJVbmV4cGVjdGVkIHJlYWQgc3RhdGU6ICVzLCBs
ZW4gJSIgR19HVUlOVDMyX0ZPUk1BVCwKKyAgICAgICAgICAgICAgICAgICAgdXNiX2NkX3N0YXRl
X3N0cihjZC0+c3RhdGUpLCBtYXhfbGVuKTsKKyAgICAgICAgZ290byBmYWlsOworICAgIH0KKyAg
ICByZXR1cm4gMDsKKworZmFpbDoKKyAgICByZXR1cm4gLTE7Cit9CisKK3ZvaWQgY2Rfc2NzaV9k
ZXZfcmVxdWVzdF9jb21wbGV0ZSh2b2lkICp0YXJnZXRfdXNlcl9kYXRhLCBDZFNjc2lSZXF1ZXN0
ICpzY3NpX3JlcSkKK3sKKyAgICBVc2JDZEJ1bGtNc2REZXZpY2UgKmNkID0gKFVzYkNkQnVsa01z
ZERldmljZSAqKXRhcmdldF91c2VyX2RhdGE7CisgICAgVXNiQ2RCdWxrTXNkUmVxdWVzdCAqdXNi
X3JlcSA9ICZjZC0+dXNiX3JlcTsKKworICAgIGdfYXNzZXJ0KHNjc2lfcmVxID09ICZ1c2JfcmVx
LT5zY3NpX3JlcSk7CisKKyAgICBpZiAoc2NzaV9yZXEtPnJlcV9zdGF0ZSA9PSBTQ1NJX1JFUV9D
T01QTEVURSkgeworCisgICAgICAgIHVzYl9yZXEtPnNjc2lfaW5fbGVuID0gKHNjc2lfcmVxLT5p
bl9sZW4gPD0gdXNiX3JlcS0+dXNiX3JlcV9sZW4pID8KKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgc2NzaV9yZXEtPmluX2xlbiA6IHVzYl9yZXEtPnVzYl9yZXFfbGVuOworCisgICAg
ICAgIC8qIHByZXBhcmUgQ1NXICovCisgICAgICAgIGlmICh1c2JfcmVxLT51c2JfcmVxX2xlbiA+
IHVzYl9yZXEtPnNjc2lfaW5fbGVuKSB7CisgICAgICAgICAgICB1c2JfcmVxLT5jc3cucmVzaWR1
ZSA9IGh0b2xlMzIodXNiX3JlcS0+dXNiX3JlcV9sZW4gLSB1c2JfcmVxLT5zY3NpX2luX2xlbik7
CisgICAgICAgIH0KKyAgICAgICAgaWYgKHNjc2lfcmVxLT5zdGF0dXMgIT0gR09PRCkgeworICAg
ICAgICAgICAgdXNiX3JlcS0+Y3N3LnN0YXR1cyA9ICh1aW50OF90KVVTQl9NU0RfU1RBVFVTX0ZB
SUxFRDsKKyAgICAgICAgfQorCisgICAgICAgIGlmICh1c2JfcmVxLT5idWxrX2luX2xlbikgewor
ICAgICAgICAgICAgLyogYnVsay1pbiByZXF1ZXN0IGFycml2ZWQgd2hpbGUgc2NzaSB3YXMgc3Rp
bGwgcnVubmluZyAqLworICAgICAgICAgICAgaWYgKGNkLT5zdGF0ZSA9PSBVU0JfQ0RfU1RBVEVf
REFUQUlOKSB7CisgICAgICAgICAgICAgICAgdXNiX2NkX3NlbmRfZGF0YV9pbihjZCwgdXNiX3Jl
cS0+YnVsa19pbl9sZW4pOworICAgICAgICAgICAgfSBlbHNlIGlmIChjZC0+c3RhdGUgPT0gVVNC
X0NEX1NUQVRFX0NTVykgeworICAgICAgICAgICAgICAgIHVzYl9jZF9zZW5kX3N0YXR1cyhjZCk7
CisgICAgICAgICAgICB9CisgICAgICAgICAgICB1c2JfcmVxLT5idWxrX2luX2xlbiA9IDA7Cisg
ICAgICAgIH0KKyAgICB9IGVsc2UgaWYgKHNjc2lfcmVxLT5yZXFfc3RhdGUgPT0gU0NTSV9SRVFf
Q0FOQ0VMRUQpIHsKKyAgICAgICAgdXNiX2NkX3NlbmRfY2FuY2VsZWQoY2QpOworICAgIH0gZWxz
ZSB7CisgICAgICAgIGdfYXNzZXJ0KHNjc2lfcmVxLT5yZXFfc3RhdGUgPT0gU0NTSV9SRVFfRElT
UE9TRUQpOworICAgICAgICBTUElDRV9ERUJVRygiRGlzcG9zZWQgY21kIHRhZzoweCV4LCBsZW46
JSIgR19HVUlOVDY0X0ZPUk1BVCwKKyAgICAgICAgICAgICAgICBsZTMydG9oKHVzYl9yZXEtPmNz
dy50YWcpLCBzaXplb2YodXNiX3JlcS0+Y3N3KSk7CisgICAgICAgIHVzYl9jZF9jbWRfZG9uZShj
ZCk7CisgICAgfQorfQorCitpbnQgY2RfdXNiX2J1bGtfbXNkX2NhbmNlbF9yZWFkKFVzYkNkQnVs
a01zZERldmljZSAqY2QpCit7CisgICAgVXNiQ2RCdWxrTXNkUmVxdWVzdCAqdXNiX3JlcSA9ICZj
ZC0+dXNiX3JlcTsKKyAgICBDZFNjc2lSZXF1ZXN0ICpzY3NpX3JlcSA9ICZ1c2JfcmVxLT5zY3Np
X3JlcTsKKworICAgIGNkX3Njc2lfZGV2X3JlcXVlc3RfY2FuY2VsKGNkLT5zY3NpX3RhcmdldCwg
c2NzaV9yZXEpOworICAgIHJldHVybiAwOworfQorCitpbnQgY2RfdXNiX2J1bGtfbXNkX3dyaXRl
KFVzYkNkQnVsa01zZERldmljZSAqY2QsIHVpbnQ4X3QgKmJ1Zl9vdXQsIHVpbnQzMl90IGJ1Zl9v
dXRfbGVuKQoreworICAgIHN3aXRjaCAoY2QtPnN0YXRlKSB7CisgICAgY2FzZSBVU0JfQ0RfU1RB
VEVfQ0JXOiAvKiBDb21tYW5kIEJsb2NrICovCisgICAgICAgIHBhcnNlX3VzYl9tc2RfY21kKGNk
LCBidWZfb3V0LCBidWZfb3V0X2xlbik7CisgICAgICAgIGlmIChjZC0+c3RhdGUgPT0gVVNCX0NE
X1NUQVRFX0RBVEFJTiB8fCBjZC0+c3RhdGUgPT0gVVNCX0NEX1NUQVRFX0NTVykgeworICAgICAg
ICAgICAgY2Rfc2NzaV9kZXZfcmVxdWVzdF9zdWJtaXQoY2QtPnNjc2lfdGFyZ2V0LCAmY2QtPnVz
Yl9yZXEuc2NzaV9yZXEpOworICAgICAgICB9CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgVVNC
X0NEX1NUQVRFX0RBVEFPVVQ6IC8qIERhdGEtT3V0IGZvciBhIFdyaXRlIGNtZCAqLworICAgICAg
ICBjZC0+dXNiX3JlcS5zY3NpX3JlcS5idWYgPSBidWZfb3V0OworICAgICAgICBjZC0+dXNiX3Jl
cS5zY3NpX3JlcS5idWZfbGVuID0gYnVmX291dF9sZW47CisgICAgICAgIGNkX3Njc2lfZGV2X3Jl
cXVlc3Rfc3VibWl0KGNkLT5zY3NpX3RhcmdldCwgJmNkLT51c2JfcmVxLnNjc2lfcmVxKTsKKyAg
ICAgICAgY2RfdXNiX2J1bGtfbXNkX3NldF9zdGF0ZShjZCwgVVNCX0NEX1NUQVRFX0NTVyk7IC8q
IFN0YXR1cyBuZXh0ICovCisgICAgICAgIGJyZWFrOworICAgIGRlZmF1bHQ6CisgICAgICAgIFNQ
SUNFX0RFQlVHKCJVbmV4cGVjdGVkIHdyaXRlIHN0YXRlOiAlcywgbGVuICUiIEdfR1VJTlQzMl9G
T1JNQVQsCisgICAgICAgICAgICAgICAgICAgIHVzYl9jZF9zdGF0ZV9zdHIoY2QtPnN0YXRlKSwg
YnVmX291dF9sZW4pOworICAgICAgICBnb3RvIGZhaWw7CisgICAgfQorICAgIHJldHVybiAwOwor
CitmYWlsOgorICAgIHJldHVybiAtMTsKK30KKwordm9pZCBjZF9zY3NpX2Rldl9yZXNldF9jb21w
bGV0ZSh2b2lkICp0YXJnZXRfdXNlcl9kYXRhLCB1aW50MzJfdCBsdW4pCit7CisgICAgVXNiQ2RC
dWxrTXNkRGV2aWNlICpjZCA9IChVc2JDZEJ1bGtNc2REZXZpY2UgKil0YXJnZXRfdXNlcl9kYXRh
OworCisgICAgaWYgKGNkLT5zdGF0ZSA9PSBVU0JfQ0RfU1RBVEVfREVWSUNFX1JFU0VUKSB7Cisg
ICAgICAgIGNkX3VzYl9idWxrX21zZF9zZXRfc3RhdGUoY2QsIFVTQl9DRF9TVEFURV9DQlcpOwor
ICAgICAgICBjZF91c2JfYnVsa19tc2RfcmVzZXRfY29tcGxldGUoY2QtPnVzYl91c2VyX2RhdGEs
IDApOworICAgIH0KK30KKwordm9pZCBjZF9zY3NpX3RhcmdldF9yZXNldF9jb21wbGV0ZSh2b2lk
ICp0YXJnZXRfdXNlcl9kYXRhKQoreworICAgIFVzYkNkQnVsa01zZERldmljZSAqY2QgPSAoVXNi
Q2RCdWxrTXNkRGV2aWNlICopdGFyZ2V0X3VzZXJfZGF0YTsKKyAgICBjZF91c2JfYnVsa19tc2Rf
c2V0X3N0YXRlKGNkLCBVU0JfQ0RfU1RBVEVfSU5JVCk7Cit9CisKK3ZvaWQgY2Rfc2NzaV9kZXZf
Y2hhbmdlZCh2b2lkICp0YXJnZXRfdXNlcl9kYXRhLCB1aW50MzJfdCBsdW4pCit7CisgICAgVXNi
Q2RCdWxrTXNkRGV2aWNlICpjZCA9IChVc2JDZEJ1bGtNc2REZXZpY2UgKil0YXJnZXRfdXNlcl9k
YXRhOworICAgIFNQSUNFX0RFQlVHKCJEZXZpY2UgY2hhbmdlZCwgc3RhdGU6ICVzIGx1bjogJSIg
R19HVUlOVDMyX0ZPUk1BVCwKKyAgICAgICAgICAgICAgICB1c2JfY2Rfc3RhdGVfc3RyKGNkLT5z
dGF0ZSksIGx1bik7CisgICAgY2RfdXNiX2J1bGtfbXNkX2x1bl9jaGFuZ2VkKGNkLT51c2JfdXNl
cl9kYXRhLCBsdW4pOworfQorCisjZW5kaWYgLyogVVNFX1VTQlJFRElSICovCmRpZmYgLS1naXQg
YS9zcmMvY2QtdXNiLWJ1bGstbXNkLmggYi9zcmMvY2QtdXNiLWJ1bGstbXNkLmgKbmV3IGZpbGUg
bW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAuLjQ5MmE0OWI4Ci0tLSAvZGV2L251bGwKKysrIGIv
c3JjL2NkLXVzYi1idWxrLW1zZC5oCkBAIC0wLDAgKzEsMTM0IEBACisvKiAtKi0gTW9kZTogQzsg
Yy1iYXNpYy1vZmZzZXQ6IDQ7IGluZGVudC10YWJzLW1vZGU6IG5pbCAtKi0gKi8KKy8qCisgICAg
Q29weXJpZ2h0IChDKSAyMDE4IFJlZCBIYXQsIEluYy4KKworICAgIFJlZCBIYXQgQXV0aG9yczoK
KyAgICBBbGV4YW5kZXIgTmV6aGluc2t5PGFuZXpoaW5zQHJlZGhhdC5jb20+CisKKyAgICBUaGlz
IGxpYnJhcnkgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29y
CisgICAgbW9kaWZ5IGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFs
IFB1YmxpYworICAgIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZv
dW5kYXRpb247IGVpdGhlcgorICAgIHZlcnNpb24gMi4xIG9mIHRoZSBMaWNlbnNlLCBvciAoYXQg
eW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgorCisgICAgVGhpcyBsaWJyYXJ5IGlzIGRp
c3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCisgICAgYnV0IFdJ
VEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YK
KyAgICBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0Uu
ICBTZWUgdGhlIEdOVQorICAgIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3Jl
IGRldGFpbHMuCisKKyAgICBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBH
TlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCisgICAgTGljZW5zZSBhbG9uZyB3aXRoIHRoaXMgbGli
cmFyeTsgaWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+LgorKi8KKwor
I2lmbmRlZiBTUElDRV9HVEtfQ0RfVVNCX0JVTEtfTVNEX0hfXworI2RlZmluZSBTUElDRV9HVEtf
Q0RfVVNCX0JVTEtfTVNEX0hfXworCitHX0JFR0lOX0RFQ0xTCisKKyNpbmNsdWRlIDxnaW8vZ2lv
Lmg+CisKKyNpbmNsdWRlICJjZC1zY3NpLWRldi1wYXJhbXMuaCIKKwordHlwZWRlZiBlbnVtIENk
VXNiQnVsa1N0YXR1cyB7CisgICAgQlVMS19TVEFUVVNfR09PRCA9IDAsCisgICAgQlVMS19TVEFU
VVNfRVJST1IsCisgICAgQlVMS19TVEFUVVNfQ0FOQ0VMRUQsCisgICAgQlVMS19TVEFUVVNfU1RB
TEwsCit9IENkVXNiQnVsa1N0YXR1czsKKwordHlwZWRlZiBzdHJ1Y3QgVXNiQ2RCdWxrTXNkRGV2
aWNlIFVzYkNkQnVsa01zZERldmljZTsKKworLyogVVNCIGJhY2tlbmQgY2FsbGJhY2tzICovCisK
Ky8qIGNhbGxlZCBvbiBjb21wbGV0ZWQgcmVhZCBkYXRhIGJ1bGsgdHJhbnNmZXIKKyAqIHVzZXJf
ZGF0YSAtIHVzZXJfZGF0YSBpbiB1bml0IHBhcmFtZXRlcnMgc3RydWN0dXJlCisgKiBzdGF0dXMg
LSBidWxrIHN0YXR1cyBjb2RlCisgKi8KK3ZvaWQgY2RfdXNiX2J1bGtfbXNkX3JlYWRfY29tcGxl
dGUodm9pZCAqdXNlcl9kYXRhLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1
aW50OF90ICpkYXRhLCB1aW50MzJfdCBsZW5ndGgsCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIENkVXNiQnVsa1N0YXR1cyBzdGF0dXMpOworCisvKiBjYWxsZWQgd2hlbiBzdGF0
ZSBvZiBkZXZpY2UncyB1bml0IGNoYW5nZWQgdG8gc2lnbmFsIEdVSSBjb21wb25lbnQKKyAqICB1
c2VyX2RhdGEgLSB1c2VyX2RhdGEgaW4gdW5pdCBwYXJhbWV0ZXJzIHN0cnVjdHVyZQorICovCit2
b2lkIGNkX3VzYl9idWxrX21zZF9sdW5fY2hhbmdlZCh2b2lkICp1c2VyX2RhdGEsIHVpbnQzMl90
IGx1bik7CisKKy8qIGNhbGxlZCBvbiBjb21wbGV0ZWQgZGV2aWNlIHJlc2V0CisgKiB1c2VyX2Rh
dGEgLSB1c2VyX2RhdGEgaW4gdW5pdCBwYXJhbWV0ZXJzIHN0cnVjdHVyZQorICogc3RhdHVzIC0g
ZXJyb3IgY29kZQorICovCit2b2lkIGNkX3VzYl9idWxrX21zZF9yZXNldF9jb21wbGV0ZSh2b2lk
ICp1c2VyX2RhdGEsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgc3Rh
dHVzKTsKKworLyogTVNEIGJhY2tlbmQgYXBpICovCisKKy8qIGFsbG9jYXRlIG5ldyBkZXZpY2Ug
ZGVzY3JpcHRvciAqLworVXNiQ2RCdWxrTXNkRGV2aWNlICpjZF91c2JfYnVsa19tc2RfYWxsb2Mo
dm9pZCAqdXNlcl9kYXRhLCB1aW50MzJfdCBtYXhfbHVuKTsKKworLyogZnJlZSBkZXZpY2UgZGVz
Y3JpcHRvciAqLwordm9pZCBjZF91c2JfYnVsa19tc2RfZnJlZShVc2JDZEJ1bGtNc2REZXZpY2Ug
KmRldmljZSk7CisKKy8qIGNvbmZpZ3VyZSBhIG5ldyBMb2dpY2FsIFVuaXQgdG8gYmUgcmVwcmVz
ZW4gdGVkIGJ5IHRoZSBkZXZpY2UKKyAqICByZXR1cm5zOiBlcnJvciBjb2RlCisgKi8KK2ludCBj
ZF91c2JfYnVsa19tc2RfcmVhbGl6ZShVc2JDZEJ1bGtNc2REZXZpY2UgKmRldmljZSwgdWludDMy
X3QgbHVuLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IENkU2NzaURldmljZVBh
cmFtZXRlcnMgKmRldl9wYXJhbXMpOworCisvKiBsb2NrIHRoZSBkZXZpY2UsIHByZXZlbnQgdW5s
b2FkaW5nCisgKiByZXR1cm5zOiBlcnJvciBjb2RlCisgKi8KK2ludCBjZF91c2JfYnVsa19tc2Rf
bG9jayhVc2JDZEJ1bGtNc2REZXZpY2UgKmRldmljZSwgdWludDMyX3QgbHVuLCBnYm9vbGVhbiBs
b2NrKTsKKworLyogbG9hZCBuZXcgbWVkaWEsIGlmIGFscmVhZHkgbG9hZGVkLCBzaW11bGF0ZSBt
ZWRpYSBjaGFuZ2UKKyAqIHJldHVybnM6IGVycm9yIGNvZGUKKyAqLworaW50IGNkX3VzYl9idWxr
X21zZF9sb2FkKFVzYkNkQnVsa01zZERldmljZSAqZGV2aWNlLCB1aW50MzJfdCBsdW4sCisgICAg
ICAgICAgICAgICAgICAgICAgICAgY29uc3QgQ2RTY3NpTWVkaWFQYXJhbWV0ZXJzICptZWRpYV9w
YXJhbXMpOworCisvKiBxdWVyeSB1bml0IHBhcmFtZXRlcnMgYW5kIHN0YXR1cworICogcmV0dXJu
czogZXJyb3IgY29kZQorICovCitpbnQgY2RfdXNiX2J1bGtfbXNkX2dldF9pbmZvKFVzYkNkQnVs
a01zZERldmljZSAqZGV2aWNlLCB1aW50MzJfdCBsdW4sCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIENkU2NzaURldmljZUluZm8gKmx1bl9pbmZvKTsKKworLyogdW5sb2FkIHRoZSBtZWRp
YQorICogcmV0dXJuczogZXJyb3IgY29kZQorICovCitpbnQgY2RfdXNiX2J1bGtfbXNkX3VubG9h
ZChVc2JDZEJ1bGtNc2REZXZpY2UgKmRldmljZSwgdWludDMyX3QgbHVuKTsKKworLyogZGV0YWNo
IGEgTG9naWNhbCBVbml0CisgKiByZXR1cm5zOiBlcnJvciBjb2RlCisgKi8KK2ludCBjZF91c2Jf
YnVsa19tc2RfdW5yZWFsaXplKFVzYkNkQnVsa01zZERldmljZSAqZGV2aWNlLCB1aW50MzJfdCBs
dW4pOworCisvKiByZXNldCB0aGUgZGV2aWNlIGluc3RhbmNlOyBjYW5jZWwgYWxsIElPIG9wcywg
cmVzZXQgc3RhdGUKKyAqIHJldHVybnM6IGVycm9yIGNvZGUKKyAqLworaW50IGNkX3VzYl9idWxr
X21zZF9yZXNldChVc2JDZEJ1bGtNc2REZXZpY2UgKmRldmljZSk7CisKKworLyogcGVyZm9ybSBh
IHdyaXRlIGRhdGEgYnVsayB0cmFuc2ZlcgorICogZGF0YV9sZW4gLSBsZW5ndGggb2YgYXZhaWxh
YmxlIGRhdGEgdG8gd3JpdGUKKyAqIHJldHVybnM6IGVycm9yIGNvZGUKKyAqLworaW50IGNkX3Vz
Yl9idWxrX21zZF93cml0ZShVc2JDZEJ1bGtNc2REZXZpY2UqZGV2aWNlLCB1aW50OF90ICpidWYs
IHVpbnQzMl90IGRhdGFfbGVuKTsKKworCisvKiBwZXJmb3JtIGEgcmVhZCBkYXRhIGJ1bGsgdHJh
bnNmZXIKKyAqIG1heF9sZW4gLSBsZW5ndGggb2YgYXZhaWxhYmxlIGJ1ZmZlciB0byBmaWxsCisg
KiBJZiBkYXRhIGF2YWlsYWJsZSBpbW1lZGlhdGVseSwgc2hvdWxkIGNhbGwgY2RfdXNiX2J1bGtf
bXNkX3JlYWRfY29tcGxldGUoKQorICogICBhbmQgcmV0dXJuIHN1Y2Nlc3MKKyAqIElmIGZhdGFs
IGVycm9yIGRldGVjdGVkIGltbWVkaWF0ZWx5LCBzaG91bGQgY2FsbCBjZF91c2JfYnVsa19tc2Rf
cmVhZF9jb21wbGV0ZSgpCisgKiAgIHdpdGggZXJyb3IgY29kZSBhbmQgcmV0dXJuIHN1Y2Nlc3MK
KyAqCisgKiByZXR1cm5zOiAwIC0gc3VjY2VzcywgLTEgLSBlcnJvcgorICovCitpbnQgY2RfdXNi
X2J1bGtfbXNkX3JlYWQoVXNiQ2RCdWxrTXNkRGV2aWNlICpkZXZpY2UsIHVpbnQzMl90IG1heF9s
ZW4pOworCisvKiBjYW5jZWxzIHBlbmRpbmcgcmVhZCBkYXRhIGJ1bGsgdHJhbnNmZXIKKyAqIHJl
dHVybnM6IGVycm9yIGNvZGUKKyAqLworaW50IGNkX3VzYl9idWxrX21zZF9jYW5jZWxfcmVhZChV
c2JDZEJ1bGtNc2REZXZpY2UgKmRldmljZSk7CisKK0dfRU5EX0RFQ0xTCisKKyNlbmRpZiAvKiBT
UElDRV9HVEtfQ0RfVVNCX0JVTEtfTVNEX0hfXyAqLwpkaWZmIC0tZ2l0IGEvc3JjL3Njc2ktY29u
c3RhbnRzLmggYi9zcmMvc2NzaS1jb25zdGFudHMuaApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRl
eCAwMDAwMDAwMC4uY2Y4YTg4MjUKLS0tIC9kZXYvbnVsbAorKysgYi9zcmMvc2NzaS1jb25zdGFu
dHMuaApAQCAtMCwwICsxLDMyNCBAQAorLyogLSotIE1vZGU6IEM7IGMtYmFzaWMtb2Zmc2V0OiA0
OyBpbmRlbnQtdGFicy1tb2RlOiBuaWwgLSotICovCisvKgorICAgQ29weXJpZ2h0IChDKSAyMDE4
IFJlZCBIYXQsIEluYy4KKyAgIEJhc2VkIG9uIHRoZSBHTGliIGhlYWRlcgorCisgICBUaGlzIGxp
YnJhcnkgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yCisg
ICBtb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVi
bGljCisgICBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0
aW9uOyBlaXRoZXIKKyAgIHZlcnNpb24gMi4xIG9mIHRoZSBMaWNlbnNlLCBvciAoYXQgeW91ciBv
cHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgorCisgICBUaGlzIGxpYnJhcnkgaXMgZGlzdHJpYnV0
ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKKyAgIGJ1dCBXSVRIT1VUIEFO
WSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCisgICBNRVJD
SEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhl
IEdOVQorICAgTGVzc2VyIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4K
KworICAgWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIExlc3NlciBH
ZW5lcmFsIFB1YmxpYworICAgTGljZW5zZSBhbG9uZyB3aXRoIHRoaXMgbGlicmFyeTsgaWYgbm90
LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+LgorKi8KKworI2lmbmRlZiBTUElD
RV9HVEtfU0NTSV9DT05TVEFOVFNfSF9fCisjZGVmaW5lIFNQSUNFX0dUS19TQ1NJX0NPTlNUQU5U
U19IX18KKworLyoKKyAqICAgICAgU0NTSSBvcGNvZGVzCisgKi8KKworI2RlZmluZSBURVNUX1VO
SVRfUkVBRFkgICAgICAgMHgwMAorI2RlZmluZSBSRVdJTkQgICAgICAgICAgICAgICAgMHgwMQor
I2RlZmluZSBSRVFVRVNUX1NFTlNFICAgICAgICAgMHgwMworI2RlZmluZSBGT1JNQVRfVU5JVCAg
ICAgICAgICAgMHgwNAorI2RlZmluZSBSRUFEX0JMT0NLX0xJTUlUUyAgICAgMHgwNQorI2RlZmlu
ZSBJTklUSUFMSVpFX0VMRU1FTlRfU1RBVFVTIDB4MDcKKyNkZWZpbmUgUkVBU1NJR05fQkxPQ0tT
XyAgICAgIDB4MDcKKyNkZWZpbmUgUkVBRF82ICAgICAgICAgICAgICAgIDB4MDgKKyNkZWZpbmUg
V1JJVEVfNiAgICAgICAgICAgICAgIDB4MGEKKyNkZWZpbmUgU0VUX0NBUEFDSVRZICAgICAgICAg
IDB4MGIKKyNkZWZpbmUgUkVBRF9SRVZFUlNFICAgICAgICAgIDB4MGYKKyNkZWZpbmUgV1JJVEVf
RklMRU1BUktTICAgICAgIDB4MTAKKyNkZWZpbmUgU1BBQ0UgICAgICAgICAgICAgICAgIDB4MTEK
KyNkZWZpbmUgSU5RVUlSWSAgICAgICAgICAgICAgIDB4MTIKKyNkZWZpbmUgUkVDT1ZFUl9CVUZG
RVJFRF9EQVRBIDB4MTQKKyNkZWZpbmUgTU9ERV9TRUxFQ1QgICAgICAgICAgIDB4MTUKKyNkZWZp
bmUgUkVTRVJWRSAgICAgICAgICAgICAgIDB4MTYKKyNkZWZpbmUgUkVMRUFTRSAgICAgICAgICAg
ICAgIDB4MTcKKyNkZWZpbmUgQ09QWSAgICAgICAgICAgICAgICAgIDB4MTgKKyNkZWZpbmUgRVJB
U0UgICAgICAgICAgICAgICAgIDB4MTkKKyNkZWZpbmUgTU9ERV9TRU5TRSAgICAgICAgICAgIDB4
MWEKKyNkZWZpbmUgTE9BRF9VTkxPQUQgICAgICAgICAgIDB4MWIKKyNkZWZpbmUgU0NBTiAgICAg
ICAgICAgICAgICAgIDB4MWIKKyNkZWZpbmUgU1RBUlRfU1RPUCAgICAgICAgICAgIDB4MWIKKyNk
ZWZpbmUgUkVDRUlWRV9ESUFHTk9TVElDICAgIDB4MWMKKyNkZWZpbmUgU0VORF9ESUFHTk9TVElD
ICAgICAgIDB4MWQKKyNkZWZpbmUgQUxMT1dfTUVESVVNX1JFTU9WQUwgIDB4MWUKKyNkZWZpbmUg
U0VUX1dJTkRPVyAgICAgICAgICAgIDB4MjQKKyNkZWZpbmUgUkVBRF9DQVBBQ0lUWV8xMCAgICAg
IDB4MjUKKyNkZWZpbmUgR0VUX1dJTkRPVyAgICAgICAgICAgIDB4MjUKKyNkZWZpbmUgUkVBRF8x
MCAgICAgICAgICAgICAgIDB4MjgKKyNkZWZpbmUgV1JJVEVfMTAgICAgICAgICAgICAgIDB4MmEK
KyNkZWZpbmUgU0VORCAgICAgICAgICAgICAgICAgIDB4MmEKKyNkZWZpbmUgU0VFS18xMCAgICAg
ICAgICAgICAgIDB4MmIKKyNkZWZpbmUgTE9DQVRFXzEwICAgICAgICAgICAgIDB4MmIKKyNkZWZp
bmUgUE9TSVRJT05fVE9fRUxFTUVOVCAgIDB4MmIKKyNkZWZpbmUgV1JJVEVfVkVSSUZZXzEwICAg
ICAgIDB4MmUKKyNkZWZpbmUgVkVSSUZZXzEwICAgICAgICAgICAgIDB4MmYKKyNkZWZpbmUgU0VB
UkNIX0hJR0ggICAgICAgICAgIDB4MzAKKyNkZWZpbmUgU0VBUkNIX0VRVUFMICAgICAgICAgIDB4
MzEKKyNkZWZpbmUgT0JKRUNUX1BPU0lUSU9OICAgICAgIDB4MzEKKyNkZWZpbmUgU0VBUkNIX0xP
VyAgICAgICAgICAgIDB4MzIKKyNkZWZpbmUgU0VUX0xJTUlUUyAgICAgICAgICAgIDB4MzMKKyNk
ZWZpbmUgUFJFX0ZFVENIICAgICAgICAgICAgIDB4MzQKKyNkZWZpbmUgUkVBRF9QT1NJVElPTiAg
ICAgICAgIDB4MzQKKyNkZWZpbmUgR0VUX0RBVEFfQlVGRkVSX1NUQVRVUyAweDM0CisjZGVmaW5l
IFNZTkNIUk9OSVpFX0NBQ0hFICAgICAweDM1CisjZGVmaW5lIExPQ0tfVU5MT0NLX0NBQ0hFICAg
ICAweDM2CisjZGVmaW5lIElOSVRJQUxJWkVfRUxFTUVOVF9TVEFUVVNfV0lUSF9SQU5HRSAweDM3
CisjZGVmaW5lIFJFQURfREVGRUNUX0RBVEEgICAgICAweDM3CisjZGVmaW5lIE1FRElVTV9TQ0FO
ICAgICAgICAgICAweDM4CisjZGVmaW5lIENPTVBBUkUgICAgICAgICAgICAgICAweDM5CisjZGVm
aW5lIENPUFlfVkVSSUZZICAgICAgICAgICAweDNhCisjZGVmaW5lIFdSSVRFX0JVRkZFUiAgICAg
ICAgICAweDNiCisjZGVmaW5lIFJFQURfQlVGRkVSICAgICAgICAgICAweDNjCisjZGVmaW5lIFVQ
REFURV9CTE9DSyAgICAgICAgICAweDNkCisjZGVmaW5lIFJFQURfTE9OR18xMCAgICAgICAgICAw
eDNlCisjZGVmaW5lIFdSSVRFX0xPTkdfMTAgICAgICAgICAweDNmCisjZGVmaW5lIENIQU5HRV9E
RUZJTklUSU9OICAgICAweDQwCisjZGVmaW5lIFdSSVRFX1NBTUVfMTAgICAgICAgICAweDQxCisj
ZGVmaW5lIFVOTUFQICAgICAgICAgICAgICAgICAweDQyCisjZGVmaW5lIFJFQURfVE9DICAgICAg
ICAgICAgICAweDQzCisjZGVmaW5lIFJFUE9SVF9ERU5TSVRZX1NVUFBPUlQgMHg0NAorI2RlZmlu
ZSBHRVRfQ09ORklHVVJBVElPTiAgICAgMHg0NgorI2RlZmluZSBTQU5JVElaRSAgICAgICAgICAg
ICAgMHg0OAorI2RlZmluZSBHRVRfRVZFTlRfU1RBVFVTX05PVElGSUNBVElPTiAweDRhCisjZGVm
aW5lIExPR19TRUxFQ1QgICAgICAgICAgICAweDRjCisjZGVmaW5lIExPR19TRU5TRSAgICAgICAg
ICAgICAweDRkCisjZGVmaW5lIFJFQURfRElTQ19JTkZPUk1BVElPTiAweDUxCisjZGVmaW5lIFJF
QURfVFJBQ0tfSU5GT1JNQVRJT04gMHg1MgorI2RlZmluZSBSRVNFUlZFX1RSQUNLICAgICAgICAg
MHg1MworI2RlZmluZSBNT0RFX1NFTEVDVF8xMCAgICAgICAgMHg1NQorI2RlZmluZSBSRVNFUlZF
XzEwICAgICAgICAgICAgMHg1NgorI2RlZmluZSBSRUxFQVNFXzEwICAgICAgICAgICAgMHg1Nwor
I2RlZmluZSBNT0RFX1NFTlNFXzEwICAgICAgICAgMHg1YQorI2RlZmluZSBTRU5EX0NVRV9TSEVF
VCAgICAgICAgMHg1ZAorI2RlZmluZSBQRVJTSVNURU5UX1JFU0VSVkVfSU4gMHg1ZQorI2RlZmlu
ZSBQRVJTSVNURU5UX1JFU0VSVkVfT1VUIDB4NWYKKyNkZWZpbmUgVkFSTEVOR1RIX0NEQiAgICAg
ICAgIDB4N2YKKyNkZWZpbmUgV1JJVEVfRklMRU1BUktTXzE2ICAgIDB4ODAKKyNkZWZpbmUgUkVB
RF9SRVZFUlNFXzE2ICAgICAgIDB4ODEKKyNkZWZpbmUgQUxMT1dfT1ZFUldSSVRFICAgICAgIDB4
ODIKKyNkZWZpbmUgRVhURU5ERURfQ09QWSAgICAgICAgIDB4ODMKKyNkZWZpbmUgQVRBX1BBU1NU
SFJPVUdIXzE2ICAgIDB4ODUKKyNkZWZpbmUgQUNDRVNTX0NPTlRST0xfSU4gICAgIDB4ODYKKyNk
ZWZpbmUgQUNDRVNTX0NPTlRST0xfT1VUICAgIDB4ODcKKyNkZWZpbmUgUkVBRF8xNiAgICAgICAg
ICAgICAgIDB4ODgKKyNkZWZpbmUgQ09NUEFSRV9BTkRfV1JJVEUgICAgIDB4ODkKKyNkZWZpbmUg
V1JJVEVfMTYgICAgICAgICAgICAgIDB4OGEKKyNkZWZpbmUgV1JJVEVfVkVSSUZZXzE2ICAgICAg
IDB4OGUKKyNkZWZpbmUgVkVSSUZZXzE2ICAgICAgICAgICAgIDB4OGYKKyNkZWZpbmUgUFJFX0ZF
VENIXzE2ICAgICAgICAgIDB4OTAKKyNkZWZpbmUgU1BBQ0VfMTYgICAgICAgICAgICAgIDB4OTEK
KyNkZWZpbmUgU1lOQ0hST05JWkVfQ0FDSEVfMTYgIDB4OTEKKyNkZWZpbmUgTE9DQVRFXzE2ICAg
ICAgICAgICAgIDB4OTIKKyNkZWZpbmUgV1JJVEVfU0FNRV8xNiAgICAgICAgIDB4OTMKKyNkZWZp
bmUgRVJBU0VfMTYgICAgICAgICAgICAgIDB4OTMKKyNkZWZpbmUgU0VSVklDRV9BQ1RJT05fSU5f
MTYgIDB4OWUKKyNkZWZpbmUgV1JJVEVfTE9OR18xNiAgICAgICAgIDB4OWYKKyNkZWZpbmUgUkVQ
T1JUX0xVTlMgICAgICAgICAgIDB4YTAKKyNkZWZpbmUgQVRBX1BBU1NUSFJPVUdIXzEyICAgIDB4
YTEKKyNkZWZpbmUgTUFJTlRFTkFOQ0VfSU4gICAgICAgIDB4YTMKKyNkZWZpbmUgTUFJTlRFTkFO
Q0VfT1VUICAgICAgIDB4YTQKKyNkZWZpbmUgTU9WRV9NRURJVU0gICAgICAgICAgIDB4YTUKKyNk
ZWZpbmUgRVhDSEFOR0VfTUVESVVNICAgICAgIDB4YTYKKyNkZWZpbmUgU0VUX1JFQURfQUhFQUQg
ICAgICAgIDB4YTcKKyNkZWZpbmUgUkVBRF8xMiAgICAgICAgICAgICAgIDB4YTgKKyNkZWZpbmUg
V1JJVEVfMTIgICAgICAgICAgICAgIDB4YWEKKyNkZWZpbmUgU0VSVklDRV9BQ1RJT05fSU5fMTIg
IDB4YWIKKyNkZWZpbmUgRVJBU0VfMTIgICAgICAgICAgICAgIDB4YWMKKyNkZWZpbmUgV1JJVEVf
VkVSSUZZXzEyICAgICAgIDB4YWUKKyNkZWZpbmUgVkVSSUZZXzEyICAgICAgICAgICAgIDB4YWYK
KyNkZWZpbmUgU0VBUkNIX0hJR0hfMTIgICAgICAgIDB4YjAKKyNkZWZpbmUgU0VBUkNIX0VRVUFM
XzEyICAgICAgIDB4YjEKKyNkZWZpbmUgU0VBUkNIX0xPV18xMiAgICAgICAgIDB4YjIKKyNkZWZp
bmUgUkVBRF9FTEVNRU5UX1NUQVRVUyAgIDB4YjgKKyNkZWZpbmUgU0VORF9WT0xVTUVfVEFHICAg
ICAgIDB4YjYKKworLyogTU1DLXNwZWNpZmljIG9wY29kZSBhc3NpZ25tZW50ICovCisjZGVmaW5l
IE1NQ19TRU5EX0VWRU5UICAgICAgICAgIDB4YTIKKyNkZWZpbmUgTU1DX1NFTkRfS0VZICAgICAg
ICAgICAgMHhhMworI2RlZmluZSBNTUNfUkVQT1JUX0tFWSAgICAgICAgICAweGE0CisjZGVmaW5l
IE1NQ19HRVRfUEVSRk9STUFOQ0UgICAgIDB4YWMKKyNkZWZpbmUgTU1DX1JFQURfRFZEX1NUUlVD
VFVSRSAgMHhhZAorI2RlZmluZSBNTUNfUkVBRF9ERUZFQ1RfREFUQV8xMiAweGI3CisjZGVmaW5l
IE1NQ19TRVRfQ0RfU1BFRUQgICAgICAgIDB4YmIKKyNkZWZpbmUgTU1DX01FQ0hBTklTTV9TVEFU
VVMgICAgMHhiZAorI2RlZmluZSBNTUNfUkVBRF9DRCAgICAgICAgICAgICAweGJlCisjZGVmaW5l
IE1NQ19TRU5EX0RWRF9TVFJVQ1RVUkUgIDB4YmYKKworLyoKKyAqIFNFUlZJQ0UgQUNUSU9OIElO
IHN1YmNvZGVzCisgKi8KKyNkZWZpbmUgU0FJX1JFQURfQ0FQQUNJVFlfMTYgIDB4MTAKKworLyoK
KyAqIFJFQUQgUE9TSVRJT04gc2VydmljZSBhY3Rpb24gY29kZXMKKyAqLworI2RlZmluZSBTSE9S
VF9GT1JNX0JMT0NLX0lEICAweDAwCisjZGVmaW5lIFNIT1JUX0ZPUk1fVkVORE9SX1NQRUNJRklD
IDB4MDEKKyNkZWZpbmUgTE9OR19GT1JNICAgICAgICAgICAgMHgwNgorI2RlZmluZSBFWFRFTkRF
RF9GT1JNICAgICAgICAweDA4CisKKy8qCisgKiAgU0FNIFN0YXR1cyBjb2RlcworICovCisKKyNk
ZWZpbmUgR09PRCAgICAgICAgICAgICAgICAgMHgwMAorI2RlZmluZSBDSEVDS19DT05ESVRJT04g
ICAgICAweDAyCisjZGVmaW5lIENPTkRJVElPTl9HT09EICAgICAgIDB4MDQKKyNkZWZpbmUgQlVT
WSAgICAgICAgICAgICAgICAgMHgwOAorI2RlZmluZSBJTlRFUk1FRElBVEVfR09PRCAgICAweDEw
CisjZGVmaW5lIElOVEVSTUVESUFURV9DX0dPT0QgIDB4MTQKKyNkZWZpbmUgUkVTRVJWQVRJT05f
Q09ORkxJQ1QgMHgxOAorI2RlZmluZSBDT01NQU5EX1RFUk1JTkFURUQgICAweDIyCisjZGVmaW5l
IFRBU0tfU0VUX0ZVTEwgICAgICAgIDB4MjgKKyNkZWZpbmUgQUNBX0FDVElWRSAgICAgICAgICAg
MHgzMAorI2RlZmluZSBUQVNLX0FCT1JURUQgICAgICAgICAweDQwCisKKyNkZWZpbmUgU1RBVFVT
X01BU0sgICAgICAgICAgMHgzZQorCisvKgorICogIFNFTlNFIEtFWVMKKyAqLworCisjZGVmaW5l
IE5PX1NFTlNFICAgICAgICAgICAgMHgwMAorI2RlZmluZSBSRUNPVkVSRURfRVJST1IgICAgIDB4
MDEKKyNkZWZpbmUgTk9UX1JFQURZICAgICAgICAgICAweDAyCisjZGVmaW5lIE1FRElVTV9FUlJP
UiAgICAgICAgMHgwMworI2RlZmluZSBIQVJEV0FSRV9FUlJPUiAgICAgIDB4MDQKKyNkZWZpbmUg
SUxMRUdBTF9SRVFVRVNUICAgICAweDA1CisjZGVmaW5lIFVOSVRfQVRURU5USU9OICAgICAgMHgw
NgorI2RlZmluZSBEQVRBX1BST1RFQ1QgICAgICAgIDB4MDcKKyNkZWZpbmUgQkxBTktfQ0hFQ0sg
ICAgICAgICAweDA4CisjZGVmaW5lIENPUFlfQUJPUlRFRCAgICAgICAgMHgwYQorI2RlZmluZSBB
Qk9SVEVEX0NPTU1BTkQgICAgIDB4MGIKKyNkZWZpbmUgVk9MVU1FX09WRVJGTE9XICAgICAweDBk
CisjZGVmaW5lIE1JU0NPTVBBUkUgICAgICAgICAgMHgwZQorCisKKy8qCisgKiAgREVWSUNFIFRZ
UEVTCisgKi8KKworI2RlZmluZSBUWVBFX0RJU0sgICAgICAgICAgIDB4MDAKKyNkZWZpbmUgVFlQ
RV9UQVBFICAgICAgICAgICAweDAxCisjZGVmaW5lIFRZUEVfUFJJTlRFUiAgICAgICAgMHgwMgor
I2RlZmluZSBUWVBFX1BST0NFU1NPUiAgICAgIDB4MDMgICAgLyogSFAgc2Nhbm5lcnMgdXNlIHRo
aXMgKi8KKyNkZWZpbmUgVFlQRV9XT1JNICAgICAgICAgICAweDA0ICAgIC8qIFRyZWF0ZWQgYXMg
Uk9NIGJ5IG91ciBzeXN0ZW0gKi8KKyNkZWZpbmUgVFlQRV9ST00gICAgICAgICAgICAweDA1Cisj
ZGVmaW5lIFRZUEVfU0NBTk5FUiAgICAgICAgMHgwNgorI2RlZmluZSBUWVBFX01PRCAgICAgICAg
ICAgIDB4MDcgICAgLyogTWFnbmV0by1vcHRpY2FsIGRpc2sgLQorCQkJCSAgICAgKiAtIHRyZWF0
ZWQgYXMgVFlQRV9ESVNLICovCisjZGVmaW5lIFRZUEVfTUVESVVNX0NIQU5HRVIgMHgwOAorI2Rl
ZmluZSBUWVBFX1NUT1JBR0VfQVJSQVkgIDB4MGMgICAgLyogU3RvcmFnZSBhcnJheSBkZXZpY2Ug
Ki8KKyNkZWZpbmUgVFlQRV9FTkNMT1NVUkUgICAgICAweDBkICAgIC8qIEVuY2xvc3VyZSBTZXJ2
aWNlcyBEZXZpY2UgKi8KKyNkZWZpbmUgVFlQRV9SQkMgICAgICAgICAgICAweDBlICAgIC8qIFNp
bXBsaWZpZWQgRGlyZWN0LUFjY2VzcyBEZXZpY2UgKi8KKyNkZWZpbmUgVFlQRV9PU0QgICAgICAg
ICAgICAweDExICAgIC8qIE9iamVjdC1zdG9yYWdlIERldmljZSAqLworI2RlZmluZSBUWVBFX1dM
VU4gICAgICAgICAgIDB4MWUgICAgLyogV2VsbCBrbm93biBMVU4gKi8KKyNkZWZpbmUgVFlQRV9O
T1RfUFJFU0VOVCAgICAweDFmCisjZGVmaW5lIFRZUEVfSU5BQ1RJVkUgICAgICAgMHgyMAorI2Rl
ZmluZSBUWVBFX05PX0xVTiAgICAgICAgIDB4N2YKKworLyogTW9kZSBwYWdlIGNvZGVzIGZvciBt
b2RlIHNlbnNlL3NldCAqLworI2RlZmluZSBNT0RFX1BBR0VfUl9XX0VSUk9SICAgICAgICAgICAg
ICAgICAgIDB4MDEKKyNkZWZpbmUgTU9ERV9QQUdFX01SVyAgICAgICAgICAgICAgICAgICAgICAg
ICAweDAzCisjZGVmaW5lIE1PREVfUEFHRV9IRF9HRU9NRVRSWSAgICAgICAgICAgICAgICAgMHgw
NAorI2RlZmluZSBNT0RFX1BBR0VfRkxFWElCTEVfRElTS19HRU9NRVRSWSAgICAgIDB4MDUgLyog
U0JDICovCisjZGVmaW5lIE1PREVfUEFHRV9XUklURV9QQVJBTUVURVIgICAgICAgICAgICAgMHgw
NSAvKiBNTUMgKi8KKyNkZWZpbmUgTU9ERV9QQUdFX0NBQ0hJTkcgICAgICAgICAgICAgICAgICAg
ICAweDA4CisjZGVmaW5lIE1PREVfUEFHRV9DRF9ERVZJQ0UgICAgICAgICAgICAgICAgICAgMHgw
ZAorI2RlZmluZSBNT0RFX1BBR0VfQVVESU9fQ1RMICAgICAgICAgICAgICAgICAgIDB4MGUKKyNk
ZWZpbmUgTU9ERV9QQUdFX1BPV0VSICAgICAgICAgICAgICAgICAgICAgICAweDFhCisjZGVmaW5l
IE1PREVfUEFHRV9GQVVMVF9GQUlMICAgICAgICAgICAgICAgICAgMHgxYworI2RlZmluZSBNT0RF
X1BBR0VfVE9fUFJPVEVDVCAgICAgICAgICAgICAgICAgIDB4MWQKKyNkZWZpbmUgTU9ERV9QQUdF
X0NBUFNfTUVDSF9TVEFUVVMgICAgICAgICAgICAweDJhCisjZGVmaW5lIE1PREVfUEFHRV9NUldf
VkVORE9SICAgICAgICAgICAgICAgICAgMHgyQworI2RlZmluZSBNT0RFX1BBR0VfQUxMUyAgICAg
ICAgICAgICAgICAgICAgICAgIDB4M2YKKy8qIE5vdCBpbiBNdC4gRnVqaSwgYnV0IGluIEFUQVBJ
IDIuNiAtLSBkZXByZWNhdGVkIG5vdyBpbiBmYXZvcgorICogb2YgTU9ERV9QQUdFX1NFTlNFX1BP
V0VSICovCisjZGVmaW5lIE1PREVfUEFHRV9DRFJPTSAgICAgICAgICAgICAgICAgICAgICAgMHgw
ZAorCisjZGVmaW5lIE1PREVfUEFHRV9DRFJPTSAgICAgICAgICAgICAgICAgICAgICAgMHgwZAor
CisvKiBFdmVudCBub3RpZmljYXRpb24gY2xhc3NlcyBmb3IgR0VUIEVWRU5UIFNUQVRVUyBOT1RJ
RklDQVRJT04gKi8KKyNkZWZpbmUgR0VTTl9OT19FVkVOVFMgICAgICAgICAgICAgICAgMAorI2Rl
ZmluZSBHRVNOX09QRVJBVElPTkFMX0NIQU5HRSAgICAgICAxCisjZGVmaW5lIEdFU05fUE9XRVJf
TUFOQUdFTUVOVCAgICAgICAgIDIKKyNkZWZpbmUgR0VTTl9FWFRFUk5BTF9SRVFVRVNUICAgICAg
ICAgMworI2RlZmluZSBHRVNOX01FRElBICAgICAgICAgICAgICAgICAgICA0CisjZGVmaW5lIEdF
U05fTVVMVElQTEVfSE9TVFMgICAgICAgICAgIDUKKyNkZWZpbmUgR0VTTl9ERVZJQ0VfQlVTWSAg
ICAgICAgICAgICAgNgorCisvKiBFdmVudCBjb2RlcyBmb3IgTUVESUEgZXZlbnQgc3RhdHVzIG5v
dGlmaWNhdGlvbiAqLworI2RlZmluZSBNRUNfTk9fQ0hBTkdFICAgICAgICAgICAgICAgICAwCisj
ZGVmaW5lIE1FQ19FSkVDVF9SRVFVRVNURUQgICAgICAgICAgIDEKKyNkZWZpbmUgTUVDX05FV19N
RURJQSAgICAgICAgICAgICAgICAgMgorI2RlZmluZSBNRUNfTUVESUFfUkVNT1ZBTCAgICAgICAg
ICAgICAzIC8qIG9ubHkgZm9yIG1lZGlhIGNoYW5nZXJzICovCisjZGVmaW5lIE1FQ19NRURJQV9D
SEFOR0VEICAgICAgICAgICAgIDQgLyogb25seSBmb3IgbWVkaWEgY2hhbmdlcnMgKi8KKyNkZWZp
bmUgTUVDX0JHX0ZPUk1BVF9DT01QTEVURUQgICAgICAgNSAvKiBNUlcgb3IgRFZEK1JXIGIvZyBm
b3JtYXQgY29tcGxldGVkICovCisjZGVmaW5lIE1FQ19CR19GT1JNQVRfUkVTVEFSVEVEICAgICAg
IDYgLyogTVJXIG9yIERWRCtSVyBiL2cgZm9ybWF0IHJlc3RhcnRlZCAqLworCisjZGVmaW5lIE1T
X1RSQVlfT1BFTiAgICAgICAgICAgICAgICAgIDEKKyNkZWZpbmUgTVNfTUVESUFfUFJFU0VOVCAg
ICAgICAgICAgICAgMgorCisvKgorICogQmFzZWQgb24gdmFsdWVzIGZyb20gPGxpbnV4L2Nkcm9t
Lmg+IGJ1dCBleHRlbmRpbmcgQ0RfTUlOUworICogdG8gdGhlIG1heGltdW0gY29tbW9uIHNpemUg
YWxsb3dlZCBieSB0aGUgT3JhbmdlJ3MgQm9vayBBVElQCisgKgorICogOTAgYW5kIDk5IG1pbiBD
RHMgYXJlIGFsc28gYXZhaWxhYmxlIGJ1dCB1c2luZyB0aGVtIGFzIHRoZQorICogdXBwZXIgbGlt
aXQgcmVkdWNlcyB0aGUgZWZmZWN0aXZlbmVzcyBvZiB0aGUgaGV1cmlzdGljIHRvCisgKiBkZXRl
Y3QgRFZEcyBidXJuZWQgdG8gbGVzcyB0aGFuIDI1JSBvZiB0aGVpciBtYXhpbXVtIGNhcGFjaXR5
CisgKi8KKworLyogU29tZSBnZW5lcmFsbHkgdXNlZnVsIENELVJPTSBpbmZvcm1hdGlvbiAqLwor
I2RlZmluZSBDRF9NSU5TICAgICAgICAgICAgICAgICAgICAgICA4MCAvKiBtYXguIG1pbnV0ZXMg
cGVyIENEICovCisjZGVmaW5lIENEX1NFQ1MgICAgICAgICAgICAgICAgICAgICAgIDYwIC8qIHNl
Y29uZHMgcGVyIG1pbnV0ZSAqLworI2RlZmluZSBDRF9GUkFNRVMgICAgICAgICAgICAgICAgICAg
ICA3NSAvKiBmcmFtZXMgcGVyIHNlY29uZCAqLworI2RlZmluZSBDRF9GUkFNRVNJWkUgICAgICAg
ICAgICAgICAgMjA0OCAvKiBieXRlcyBwZXIgZnJhbWUsICJjb29rZWQiIG1vZGUgKi8KKyNkZWZp
bmUgQ0RfTUFYX0JZVEVTICAgICAgIChDRF9NSU5TICogQ0RfU0VDUyAqIENEX0ZSQU1FUyAqIENE
X0ZSQU1FU0laRSkKKyNkZWZpbmUgQ0RfTUFYX1NFQ1RPUlMgICAgIChDRF9NQVhfQllURVMgLyA1
MTIpCisKKy8qCisgKiBUaGUgTU1DIHZhbHVlcyBhcmUgbm90IElERSBzcGVjaWZpYyBhbmQgbWln
aHQgbmVlZCB0byBiZSBtb3ZlZAorICogdG8gYSBjb21tb24gaGVhZGVyIGlmIHRoZXkgYXJlIGFs
c28gbmVlZGVkIGZvciB0aGUgU0NTSSBlbXVsYXRpb24KKyAqLworCisvKiBQcm9maWxlIGxpc3Qg
ZnJvbSBNTUMtNiByZXZpc2lvbiAxIHRhYmxlIDkxICovCisjZGVmaW5lIE1NQ19QUk9GSUxFX05P
TkUgICAgICAgICAgICAgICAgMHgwMDAwCisjZGVmaW5lIE1NQ19QUk9GSUxFX0NEX1JPTSAgICAg
ICAgICAgICAgMHgwMDA4CisjZGVmaW5lIE1NQ19QUk9GSUxFX0NEX1IgICAgICAgICAgICAgICAg
MHgwMDA5CisjZGVmaW5lIE1NQ19QUk9GSUxFX0NEX1JXICAgICAgICAgICAgICAgMHgwMDBBCisj
ZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9ST00gICAgICAgICAgICAgMHgwMDEwCisjZGVmaW5lIE1N
Q19QUk9GSUxFX0RWRF9SX1NSICAgICAgICAgICAgMHgwMDExCisjZGVmaW5lIE1NQ19QUk9GSUxF
X0RWRF9SQU0gICAgICAgICAgICAgMHgwMDEyCisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9SV19S
TyAgICAgICAgICAgMHgwMDEzCisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9SV19TUiAgICAgICAg
ICAgMHgwMDE0CisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9SX0RMX1NSICAgICAgICAgMHgwMDE1
CisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9SX0RMX0pSICAgICAgICAgMHgwMDE2CisjZGVmaW5l
IE1NQ19QUk9GSUxFX0RWRF9SV19ETCAgICAgICAgICAgMHgwMDE3CisjZGVmaW5lIE1NQ19QUk9G
SUxFX0RWRF9ERFIgICAgICAgICAgICAgMHgwMDE4CisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9Q
TFVTX1JXICAgICAgICAgMHgwMDFBCisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9QTFVTX1IgICAg
ICAgICAgMHgwMDFCCisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9QTFVTX1JXX0RMICAgICAgMHgw
MDJBCisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9QTFVTX1JfREwgICAgICAgMHgwMDJCCisjZGVm
aW5lIE1NQ19QUk9GSUxFX0JEX1JPTSAgICAgICAgICAgICAgMHgwMDQwCisjZGVmaW5lIE1NQ19Q
Uk9GSUxFX0JEX1JfU1JNICAgICAgICAgICAgMHgwMDQxCisjZGVmaW5lIE1NQ19QUk9GSUxFX0JE
X1JfUlJNICAgICAgICAgICAgMHgwMDQyCisjZGVmaW5lIE1NQ19QUk9GSUxFX0JEX1JFICAgICAg
ICAgICAgICAgMHgwMDQzCisjZGVmaW5lIE1NQ19QUk9GSUxFX0hERFZEX1JPTSAgICAgICAgICAg
MHgwMDUwCisjZGVmaW5lIE1NQ19QUk9GSUxFX0hERFZEX1IgICAgICAgICAgICAgMHgwMDUxCisj
ZGVmaW5lIE1NQ19QUk9GSUxFX0hERFZEX1JBTSAgICAgICAgICAgMHgwMDUyCisjZGVmaW5lIE1N
Q19QUk9GSUxFX0hERFZEX1JXICAgICAgICAgICAgMHgwMDUzCisjZGVmaW5lIE1NQ19QUk9GSUxF
X0hERFZEX1JfREwgICAgICAgICAgMHgwMDU4CisjZGVmaW5lIE1NQ19QUk9GSUxFX0hERFZEX1JX
X0RMICAgICAgICAgMHgwMDVBCisjZGVmaW5lIE1NQ19QUk9GSUxFX0lOVkFMSUQgICAgICAgICAg
ICAgMHhGRkZGCisKKyNlbmRpZgotLSAKMi4yMC4xCgpfX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fXwpTcGljZS1kZXZlbCBtYWlsaW5nIGxpc3QKU3BpY2UtZGV2
ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21h
aWxtYW4vbGlzdGluZm8vc3BpY2UtZGV2ZWw=
