Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id CA357B37FB
	for <lists+spice-devel@lfdr.de>; Mon, 16 Sep 2019 12:21:17 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 5819E6E8FB;
	Mon, 16 Sep 2019 10:21:15 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 1DD8B6E8F5
 for <spice-devel@lists.freedesktop.org>; Mon, 16 Sep 2019 10:21:13 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx05.intmail.prod.int.phx2.redhat.com
 [10.5.11.15])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id BDBDB18CB8F5
 for <spice-devel@lists.freedesktop.org>; Mon, 16 Sep 2019 10:21:12 +0000 (UTC)
Received: from wingsuit.mxp.redhat.com (unknown [10.32.181.155])
 by smtp.corp.redhat.com (Postfix) with ESMTP id F07415D6B2
 for <spice-devel@lists.freedesktop.org>; Mon, 16 Sep 2019 10:21:11 +0000 (UTC)
From: Victor Toso <victortoso@redhat.com>
To: spice-devel@lists.freedesktop.org
Date: Mon, 16 Sep 2019 12:20:52 +0200
Message-Id: <20190916102104.20943-10-victortoso@redhat.com>
In-Reply-To: <20190916102104.20943-1-victortoso@redhat.com>
References: <20190916102104.20943-1-victortoso@redhat.com>
MIME-Version: 1.0
X-Scanned-By: MIMEDefang 2.79 on 10.5.11.15
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.6.2
 (mx1.redhat.com [10.5.110.63]); Mon, 16 Sep 2019 10:21:12 +0000 (UTC)
Subject: [Spice-devel] [PATCH v7 09/20] usb-redir: add files for SCSI and
 USB MSC implementation
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

RnJvbTogWXVyaSBCZW5kaXRvdmljaCA8eXVyaS5iZW5kaXRvdmljaEBkYXluaXguY29tPgoKRmls
ZXMgYWRkZWQgd2l0aG91dCBpbmNsdWRpbmcgdGhlbSBpbiBjb21waWxhdGlvbi4KVGhleSBjb250
YWluIGltcGxlbWVudGF0aW9uIG9mIFNDU0kgY29tbWFuZHMgZm9yIGxvZ2ljYWwKdW5pdHMgb2Yg
bWFzcy1zdG9yYWdlIGRldmljZSBjbGFzcyBhbmQgVVNCIGJ1bGstb25seQptYXNzLXN0b3JhZ2Ug
ZGV2aWNlIHByb3RvY29sLgoKU2lnbmVkLW9mZi1ieTogQWxleGFuZGVyIE5lemhpbnNreTxhbmV6
aGluc0ByZWRoYXQuY29tPgpTaWduZWQtb2ZmLWJ5OiBZdXJpIEJlbmRpdG92aWNoIDx5dXJpLmJl
bmRpdG92aWNoQGRheW5peC5jb20+CkFja2VkLWJ5OiBGcmVkaWFubyBaaWdsaW8gPGZ6aWdsaW9A
cmVkaGF0LmNvbT4KLS0tCiBzcmMvY2Qtc2NzaS1kZXYtcGFyYW1zLmggfCAgIDQ2ICsKIHNyYy9j
ZC1zY3NpLmMgICAgICAgICAgICB8IDI3NDAgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr
KysrKysrKysKIHNyYy9jZC1zY3NpLmggICAgICAgICAgICB8ICAxMTcgKysKIHNyYy9jZC11c2It
YnVsay1tc2QuYyAgICB8ICA1NDMgKysrKysrKysKIHNyYy9jZC11c2ItYnVsay1tc2QuaCAgICB8
ICAxMzEgKysKIHNyYy9zY3NpLWNvbnN0YW50cy5oICAgICB8ICAzMjEgKysrKysKIDYgZmlsZXMg
Y2hhbmdlZCwgMzg5OCBpbnNlcnRpb25zKCspCiBjcmVhdGUgbW9kZSAxMDA2NDQgc3JjL2NkLXNj
c2ktZGV2LXBhcmFtcy5oCiBjcmVhdGUgbW9kZSAxMDA2NDQgc3JjL2NkLXNjc2kuYwogY3JlYXRl
IG1vZGUgMTAwNjQ0IHNyYy9jZC1zY3NpLmgKIGNyZWF0ZSBtb2RlIDEwMDY0NCBzcmMvY2QtdXNi
LWJ1bGstbXNkLmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBzcmMvY2QtdXNiLWJ1bGstbXNkLmgKIGNy
ZWF0ZSBtb2RlIDEwMDY0NCBzcmMvc2NzaS1jb25zdGFudHMuaAoKZGlmZiAtLWdpdCBhL3NyYy9j
ZC1zY3NpLWRldi1wYXJhbXMuaCBiL3NyYy9jZC1zY3NpLWRldi1wYXJhbXMuaApuZXcgZmlsZSBt
b2RlIDEwMDY0NAppbmRleCAwMDAwMDAwLi4zNDRmNzIwCi0tLSAvZGV2L251bGwKKysrIGIvc3Jj
L2NkLXNjc2ktZGV2LXBhcmFtcy5oCkBAIC0wLDAgKzEsNDYgQEAKKy8qIC0qLSBNb2RlOiBDOyBj
LWJhc2ljLW9mZnNldDogNDsgaW5kZW50LXRhYnMtbW9kZTogbmlsIC0qLSAqLworLyoKKyAgIENE
IFNDU0kgZGV2aWNlIHBhcmFtZXRlcnMKKworICAgQ29weXJpZ2h0IChDKSAyMDE4IFJlZCBIYXQs
IEluYy4KKworICAgUmVkIEhhdCBBdXRob3JzOgorICAgQWxleGFuZGVyIE5lemhpbnNreTxhbmV6
aGluc0ByZWRoYXQuY29tPgorCisgICBUaGlzIGxpYnJhcnkgaXMgZnJlZSBzb2Z0d2FyZTsgeW91
IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yCisgICBtb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1z
IG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCisgICBMaWNlbnNlIGFzIHB1Ymxpc2hl
ZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIKKyAgIHZlcnNpb24gMi4x
IG9mIHRoZSBMaWNlbnNlLCBvciAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgor
CisgICBUaGlzIGxpYnJhcnkgaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxs
IGJlIHVzZWZ1bCwKKyAgIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRo
ZSBpbXBsaWVkIHdhcnJhbnR5IG9mCisgICBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1Ig
QSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlIEdOVQorICAgTGVzc2VyIEdlbmVyYWwgUHVi
bGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KKworICAgWW91IHNob3VsZCBoYXZlIHJlY2Vp
dmVkIGEgY29weSBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYworICAgTGljZW5zZSBh
bG9uZyB3aXRoIHRoaXMgbGlicmFyeTsgaWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9s
aWNlbnNlcy8+LgorKi8KKworI3ByYWdtYSBvbmNlCisKKyNpbmNsdWRlIDxnaW8vZ2lvLmg+CisK
K3R5cGVkZWYgc3RydWN0IENkU2NzaURldmljZVBhcmFtZXRlcnMgeworICAgIGNvbnN0IGNoYXIg
KnZlbmRvcjsKKyAgICBjb25zdCBjaGFyICpwcm9kdWN0OworICAgIGNvbnN0IGNoYXIgKnZlcnNp
b247CisgICAgY29uc3QgY2hhciAqc2VyaWFsOworfSBDZFNjc2lEZXZpY2VQYXJhbWV0ZXJzOwor
Cit0eXBlZGVmIHN0cnVjdCBDZFNjc2lEZXZpY2VJbmZvIHsKKyAgICBDZFNjc2lEZXZpY2VQYXJh
bWV0ZXJzIHBhcmFtZXRlcnM7CisgICAgdWludDMyX3Qgc3RhcnRlZCAgICA6IDE7CisgICAgdWlu
dDMyX3QgbG9ja2VkICAgICA6IDE7CisgICAgdWludDMyX3QgbG9hZGVkICAgICA6IDE7Cit9IENk
U2NzaURldmljZUluZm87CisKK3R5cGVkZWYgc3RydWN0IENkU2NzaU1lZGlhUGFyYW1ldGVycyB7
CisgICAgR0ZpbGVJbnB1dFN0cmVhbSAqc3RyZWFtOworICAgIHVpbnQ2NF90IHNpemU7CisgICAg
dWludDMyX3QgYmxvY2tfc2l6ZTsKK30gQ2RTY3NpTWVkaWFQYXJhbWV0ZXJzOwpkaWZmIC0tZ2l0
IGEvc3JjL2NkLXNjc2kuYyBiL3NyYy9jZC1zY3NpLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5k
ZXggMDAwMDAwMC4uMjU4NDJiMwotLS0gL2Rldi9udWxsCisrKyBiL3NyYy9jZC1zY3NpLmMKQEAg
LTAsMCArMSwyNzQwIEBACisvKiAtKi0gTW9kZTogQzsgYy1iYXNpYy1vZmZzZXQ6IDQ7IGluZGVu
dC10YWJzLW1vZGU6IG5pbCAtKi0gKi8KKy8qCisgICBDRCBkZXZpY2UgZW11bGF0aW9uIC0gU0NT
SSBlbmdpbmUKKworICAgQ29weXJpZ2h0IChDKSAyMDE4IFJlZCBIYXQsIEluYy4KKworICAgUmVk
IEhhdCBBdXRob3JzOgorICAgQWxleGFuZGVyIE5lemhpbnNreTxhbmV6aGluc0ByZWRoYXQuY29t
PgorCisgICBUaGlzIGxpYnJhcnkgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1
dGUgaXQgYW5kL29yCisgICBtb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVz
c2VyIEdlbmVyYWwgUHVibGljCisgICBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBT
b2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIKKyAgIHZlcnNpb24gMi4xIG9mIHRoZSBMaWNlbnNl
LCBvciAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgorCisgICBUaGlzIGxpYnJh
cnkgaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKKyAg
IGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJh
bnR5IG9mCisgICBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBV
UlBPU0UuICBTZWUgdGhlIEdOVQorICAgTGVzc2VyIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9y
IG1vcmUgZGV0YWlscy4KKworICAgWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0
aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYworICAgTGljZW5zZSBhbG9uZyB3aXRoIHRoaXMg
bGlicmFyeTsgaWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+LgorKi8K
KworI2luY2x1ZGUgImNvbmZpZy5oIgorI2luY2x1ZGUgInNwaWNlL3R5cGVzLmgiCisjaW5jbHVk
ZSAic3BpY2UtY29tbW9uLmgiCisjaW5jbHVkZSAic3BpY2UtdXRpbC5oIgorI2luY2x1ZGUgImNk
LXNjc2kuaCIKKworI2lmZGVmIFVTRV9VU0JSRURJUgorCisjZGVmaW5lIFNQSUNFX0VSUk9SKGZt
dCwgLi4uKSBcCisgICAgZG8geyBTUElDRV9ERUJVRygiZGV2LXNjc2kgZXJyb3I6ICIgZm10ICwg
IyMgX19WQV9BUkdTX18pOyB9IHdoaWxlICgwKQorCisjZGVmaW5lIEZJWEVEX1NFTlNFX0NVUlJF
TlQgMHg3MAorI2RlZmluZSBGSVhFRF9TRU5TRV9MRU4gMTgKKworI2RlZmluZSBNQVhfTFVOUyAg
IDMyCisKK3R5cGVkZWYgZW51bSBDZFNjc2lQb3dlckNvbmRpdGlvbiB7CisgICAgQ0RfU0NTSV9Q
T1dFUl9TVE9QUEVELAorICAgIENEX1NDU0lfUE9XRVJfQUNUSVZFLAorICAgIENEX1NDU0lfUE9X
RVJfSURMRSwKKyAgICBDRF9TQ1NJX1BPV0VSX1NUQU5EQlkKK30gQ2RTY3NpUG93ZXJDb25kaXRp
b247CisKK3R5cGVkZWYgc3RydWN0IFNjc2lTaG9ydFNlbnNlIHsKKyAgICB1aW50OF90IGtleTsK
KyAgICB1aW50OF90IGFzYzsKKyAgICB1aW50OF90IGFzY3E7CisgICAgY29uc3QgY2hhciAqZGVz
Y3I7Cit9IFNjc2lTaG9ydFNlbnNlOworCisjZGVmaW5lIENEX01FRElBX0VWRU5UX05PX0NIQU5H
RSAgICAgICAgICAgIDB4MAorI2RlZmluZSBDRF9NRURJQV9FVkVOVF9FSkVDVF9SRVEgICAgICAg
ICAgICAweDEgLyogdXNlciByZXF1ZXN0IChtZWNoYW5pY2FsIHN3aXRjaCkgdG8KKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGVqZWN0IHRoZSBtZWRp
YSAqLworI2RlZmluZSBDRF9NRURJQV9FVkVOVF9ORVdfTUVESUEgICAgICAgICAgICAweDIgLyog
bmV3IG1lZGlhIHJlY2VpdmVkICovCisjZGVmaW5lIENEX01FRElBX0VWRU5UX01FRElBX1JFTU9W
QUwgICAgICAgIDB4MyAvKiBtZWRpYSByZW1vdmVkICovCisjZGVmaW5lIENEX01FRElBX0VWRU5U
X01FRElBX0NIQU5HRUQgICAgICAgIDB4NCAvKiB1c2VyIHJlcXVlc3QgdG8gbG9hZCBuZXcgbWVk
aWEgKi8KKyNkZWZpbmUgQ0RfTUVESUFfRVZFTlRfQkdfRk9STUFUX0NPTVBMRVRFICAgMHg1Cisj
ZGVmaW5lIENEX01FRElBX0VWRU5UX0JHX0ZPUk1BVF9SRVNUQVJUICAgIDB4NgorCisjZGVmaW5l
IENEX1BPV0VSX0VWRU5UX05PX0NIQU5HRSAgICAgICAgICAgIDB4MAorI2RlZmluZSBDRF9QT1dF
Ul9FVkVOVF9DSEFOR0VfU1VDQ0VTUyAgICAgICAweDEKKyNkZWZpbmUgQ0RfUE9XRVJfRVZFTlRf
Q0hBTkdFX0ZBTEVEICAgICAgICAgMHgyCisKK3R5cGVkZWYgc3RydWN0IENkU2NzaUxVIHsKKyAg
ICBDZFNjc2lUYXJnZXQgKnRndDsKKyAgICB1aW50MzJfdCBsdW47CisKKyAgICBnYm9vbGVhbiBy
ZWFsaXplZDsKKyAgICBnYm9vbGVhbiByZW1vdmFibGU7CisgICAgZ2Jvb2xlYW4gbG9hZGVkOwor
ICAgIGdib29sZWFuIHByZXZlbnRfbWVkaWFfcmVtb3ZhbDsKKyAgICBnYm9vbGVhbiBjZF9yb207
CisKKyAgICBDZFNjc2lQb3dlckNvbmRpdGlvbiBwb3dlcl9jb25kOworICAgIHVpbnQzMl90IHBv
d2VyX2V2ZW50OworICAgIHVpbnQzMl90IG1lZGlhX2V2ZW50OworCisgICAgdWludDMyX3QgY2xh
aW1fdmVyc2lvbjsKKworICAgIHVpbnQ2NF90IHNpemU7CisgICAgdWludDMyX3QgYmxvY2tfc2l6
ZTsKKyAgICB1aW50MzJfdCBudW1fYmxvY2tzOworCisgICAgY2hhciAqdmVuZG9yOworICAgIGNo
YXIgKnByb2R1Y3Q7CisgICAgY2hhciAqdmVyc2lvbjsKKyAgICBjaGFyICpzZXJpYWw7CisKKyAg
ICBHRmlsZUlucHV0U3RyZWFtICpzdHJlYW07CisKKyAgICBTY3NpU2hvcnRTZW5zZSBzaG9ydF9z
ZW5zZTsgLyogY3VycmVudGx5IGhlbGQgc2Vuc2Ugb2YgdGhlIHNjc2kgZGV2aWNlICovCisgICAg
dWludDhfdCBmaXhlZF9zZW5zZVtGSVhFRF9TRU5TRV9MRU5dOworfSBDZFNjc2lMVTsKKwordHlw
ZWRlZiBlbnVtIENkU2NzaVRhcmdldFN0YXRlIHsKKyAgICBDRF9TQ1NJX1RHVF9TVEFURV9SVU5O
SU5HLAorICAgIENEX1NDU0lfVEdUX1NUQVRFX1JFU0VULAorfSBDZFNjc2lUYXJnZXRTdGF0ZTsK
Kworc3RydWN0IENkU2NzaVRhcmdldCB7CisgICAgdm9pZCAqdXNlcl9kYXRhOworCisgICAgQ2RT
Y3NpVGFyZ2V0U3RhdGUgc3RhdGU7CisgICAgQ2RTY3NpUmVxdWVzdCAqY3VyX3JlcTsKKyAgICBH
Q2FuY2VsbGFibGUgKmNhbmNlbGxhYmxlOworCisgICAgdWludDMyX3QgbWF4X2x1bnM7CisgICAg
Q2RTY3NpTFUgdW5pdHNbTUFYX0xVTlNdOworfTsKKworc3RhdGljIGNvbnN0IGNoYXIqIHNjc2lf
Y21kX25hbWVbMjU2XTsKKworLyogUHJlZGVmaW5lZCBzZW5zZSBjb2RlcyAqLworCitjb25zdCBT
Y3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX05PX1NFTlNFID0geworICAgIC5rZXkgPSBOT19TRU5T
RSAsIC5hc2MgPSAweDAwICwgLmFzY3EgPSAweDAwLAorICAgIC5kZXNjciA9ICIiCit9OworCitj
b25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX05PVF9SRUFEWV9DQVVTRV9OT1RfUkVQT1JU
QUJMRSA9IHsKKyAgICAua2V5ID0gTk9UX1JFQURZLCAuYXNjID0gMHgwNCwgLmFzY3EgPSAweDAw
LAorICAgIC5kZXNjciA9ICJDQVVTRSBOT1QgUkVQT1JUQUJMRSIKK307CisKK2NvbnN0IFNjc2lT
aG9ydFNlbnNlIHNlbnNlX2NvZGVfQkVDT01JTkdfUkVBRFkgPSB7CisgICAgLmtleSA9IE5PVF9S
RUFEWSwgLmFzYyA9IDB4MDQsIC5hc2NxID0gMHgwMSwKKyAgICAuZGVzY3IgPSAiSU4gUFJPQ0VT
UyBPRiBCRUNPTUlORyBSRUFEWSIKK307CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNlIHNlbnNlX2Nv
ZGVfSU5JVF9DTURfUkVRVUlSRUQgPSB7CisgICAgLmtleSA9IE5PVF9SRUFEWSwgLmFzYyA9IDB4
MDQsIC5hc2NxID0gMHgwMiwKKyAgICAuZGVzY3IgPSAiSU5JVElBTElaSU5HIENPTU1BTkQgUkVR
VUlSRUQiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX0lOVEVSVkVOVElP
Tl9SRVFVSVJFRCA9IHsKKyAgICAua2V5ID0gTk9UX1JFQURZLCAuYXNjID0gMHgwNCwgLmFzY3Eg
PSAweDAzLAorICAgIC5kZXNjciA9ICJNQU5VQUwgSU5URVJWRU5USU9OIFJFUVVJUkVEIgorfTsK
KworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9OT1RfUkVBRFlfTk9fTUVESVVNID0g
eworICAgIC5rZXkgPSBOT1RfUkVBRFksIC5hc2MgPSAweDNhLCAuYXNjcSA9IDB4MDAsCisgICAg
LmRlc2NyID0gIk1FRElVTSBOT1QgUFJFU0VOVCIKK307CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNl
IHNlbnNlX2NvZGVfTk9UX1JFQURZX05PX01FRElVTV9UUkFZX0NMT1NFRCA9IHsKKyAgICAua2V5
ID0gTk9UX1JFQURZLCAuYXNjID0gMHgzYSwgLmFzY3EgPSAweDAxLAorICAgIC5kZXNjciA9ICJN
RURJVU0gTk9UIFBSRVNFTlQgLSBUUkFZIENMT1NFRCIKK307CisKK2NvbnN0IFNjc2lTaG9ydFNl
bnNlIHNlbnNlX2NvZGVfTk9UX1JFQURZX05PX01FRElVTV9UUkFZX09QRU4gPSB7CisgICAgLmtl
eSA9IE5PVF9SRUFEWSwgLmFzYyA9IDB4M2EsIC5hc2NxID0gMHgwMiwKKyAgICAuZGVzY3IgPSAi
TUVESVVNIE5PVCBQUkVTRU5UIC0gVFJBWSBPUEVOIgorfTsKKworY29uc3QgU2NzaVNob3J0U2Vu
c2Ugc2Vuc2VfY29kZV9UQVJHRVRfRkFJTFVSRSA9IHsKKyAgICAua2V5ID0gSEFSRFdBUkVfRVJS
T1IsIC5hc2MgPSAweDQ0LCAuYXNjcSA9IDB4MDAsCisgICAgLmRlc2NyID0gIklOVEVSTkFMIFRB
UkdFVCBGQUlMVVJFIgorfTsKKworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9JTlZB
TElEX09QQ09ERSA9IHsKKyAgICAua2V5ID0gSUxMRUdBTF9SRVFVRVNULCAuYXNjID0gMHgyMCwg
LmFzY3EgPSAweDAwLAorICAgIC5kZXNjciA9ICJJTlZBTElEIENPTU1BTkQgT1BFUkFUSU9OIENP
REUiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX0xCQV9PVVRfT0ZfUkFO
R0UgPSB7CisgICAgLmtleSA9IElMTEVHQUxfUkVRVUVTVCwgLmFzYyA9IDB4MjEsIC5hc2NxID0g
MHgwMCwKKyAgICAuZGVzY3IgPSAiTE9HSUNBTCBCTE9DSyBBRERSRVNTIE9VVCBPRiBSQU5HRSIK
K307CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNlIHNlbnNlX2NvZGVfSU5WQUxJRF9DREJfRklFTEQg
PSB7CisgICAgLmtleSA9IElMTEVHQUxfUkVRVUVTVCwgLmFzYyA9IDB4MjQsIC5hc2NxID0gMHgw
MCwKKyAgICAuZGVzY3IgPSAiSU5WQUxJRCBGSUVMRCBJTiBDREIiCit9OworCitjb25zdCBTY3Np
U2hvcnRTZW5zZSBzZW5zZV9jb2RlX0lOVkFMSURfUEFSQU1fRklFTEQgPSB7CisgICAgLmtleSA9
IElMTEVHQUxfUkVRVUVTVCwgLmFzYyA9IDB4MjYsIC5hc2NxID0gMHgwMCwKKyAgICAuZGVzY3Ig
PSAiSU5WQUxJRCBGSUVMRCBJTiBQQVJBTUVURVIgTElTVCIKK307CisKK2NvbnN0IFNjc2lTaG9y
dFNlbnNlIHNlbnNlX2NvZGVfSU5WQUxJRF9QQVJBTV9MRU4gPSB7CisgICAgLmtleSA9IElMTEVH
QUxfUkVRVUVTVCwgLmFzYyA9IDB4MWEsIC5hc2NxID0gMHgwMCwKKyAgICAuZGVzY3IgPSAiUEFS
QU1FVEVSIExJU1QgTEVOR1RIIEVSUk9SIgorfTsKKworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vu
c2VfY29kZV9MVU5fTk9UX1NVUFBPUlRFRCA9IHsKKyAgICAua2V5ID0gSUxMRUdBTF9SRVFVRVNU
LCAuYXNjID0gMHgyNSwgLmFzY3EgPSAweDAwLAorICAgIC5kZXNjciA9ICJMT0dJQ0FMIFVOSVQg
Tk9UIFNVUFBPUlRFRCIKK307CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNlIHNlbnNlX2NvZGVfU0FW
SU5HX1BBUkFNU19OT1RfU1VQUE9SVEVEID0geworICAgIC5rZXkgPSBJTExFR0FMX1JFUVVFU1Qs
IC5hc2MgPSAweDM5LCAuYXNjcSA9IDB4MDAsCisgICAgLmRlc2NyID0gIlNBVklORyBQQVJBTUVU
RVJTIE5PVCBTVVBQT1JURUQiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2Rl
X0lOQ09NUEFUSUJMRV9NRURJVU0gPSB7CisgICAgLmtleSA9IElMTEVHQUxfUkVRVUVTVCwgLmFz
YyA9IDB4MzAsIC5hc2NxID0gMHgwMCwKKyAgICAuZGVzY3IgPSAiSU5DT01QQVRJQkxFIE1FRElV
TSBJTlNUQUxMRUQiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX01FRElV
TV9SRU1PVkFMX1BSRVZFTlRFRCA9IHsKKyAgICAua2V5ID0gSUxMRUdBTF9SRVFVRVNULCAuYXNj
ID0gMHg1MywgLmFzY3EgPSAweDAyLAorICAgIC5kZXNjciA9ICJNRURJVU0gUkVNT1ZBTCBQUkVW
RU5URUQiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX1BBUkFNRVRFUlNf
Q0hBTkdFRCA9IHsKKyAgICAua2V5ID0gVU5JVF9BVFRFTlRJT04sIC5hc2MgPSAweDJhLCAuYXNj
cSA9IDB4MDAsCisgICAgLmRlc2NyID0gIlBBUkFNRVRFUlMgQ0hBTkdFRCIKK307CisKK2NvbnN0
IFNjc2lTaG9ydFNlbnNlIHNlbnNlX2NvZGVfUE9XRVJfT05fUkVTRVQgPSB7CisgICAgLmtleSA9
IFVOSVRfQVRURU5USU9OLCAuYXNjID0gMHgyOSwgLmFzY3EgPSAweDAwLAorICAgIC5kZXNjciA9
ICJQT1dFUiBPTiwgUkVTRVQsIE9SIEJVUyBERVZJQ0UgUkVTRVQiCit9OworCitjb25zdCBTY3Np
U2hvcnRTZW5zZSBzZW5zZV9jb2RlX1NDU0lfQlVTX1JFU0VUID0geworICAgIC5rZXkgPSBVTklU
X0FUVEVOVElPTiwgLmFzYyA9IDB4MjksIC5hc2NxID0gMHgwMiwKKyAgICAuZGVzY3IgPSAiU0NT
SSBCVVMgUkVTRVQiCit9OworCitjb25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX1VBX05P
X01FRElVTSA9IHsKKyAgICAua2V5ID0gVU5JVF9BVFRFTlRJT04sIC5hc2MgPSAweDNhLCAuYXNj
cSA9IDB4MDAsCisgICAgLmRlc2NyID0gIk1FRElVTSBOT1QgUFJFU0VOVCIKK307CisKK2NvbnN0
IFNjc2lTaG9ydFNlbnNlIHNlbnNlX2NvZGVfTUVESVVNX0NIQU5HRUQgPSB7CisgICAgLmtleSA9
IFVOSVRfQVRURU5USU9OLCAuYXNjID0gMHgyOCwgLmFzY3EgPSAweDAwLAorICAgIC5kZXNjciA9
ICJNRURJVU0gQ0hBTkdFRCIKK307CisKK2NvbnN0IFNjc2lTaG9ydFNlbnNlIHNlbnNlX2NvZGVf
UkVQT1JURURfTFVOU19DSEFOR0VEID0geworICAgIC5rZXkgPSBVTklUX0FUVEVOVElPTiwgLmFz
YyA9IDB4M2YsIC5hc2NxID0gMHgwZSwKKyAgICAuZGVzY3IgPSAiUkVQT1JURUQgTFVOUyBDSEFO
R0VEIgorfTsKKworY29uc3QgU2NzaVNob3J0U2Vuc2Ugc2Vuc2VfY29kZV9ERVZJQ0VfSU5URVJO
QUxfUkVTRVQgPSB7CisgICAgLmtleSA9IFVOSVRfQVRURU5USU9OLCAuYXNjID0gMHgyOSwgLmFz
Y3EgPSAweDA0LAorICAgIC5kZXNjciA9ICJERVZJQ0UgSU5URVJOQUwgUkVTRVQiCit9OworCitj
b25zdCBTY3NpU2hvcnRTZW5zZSBzZW5zZV9jb2RlX1VOSVRfQVRURU5USU9OX01FRElVTV9SRU1P
VkFMX1JFUVVFU1QgPSB7CisgICAgLmtleSA9IFVOSVRfQVRURU5USU9OLCAuYXNjID0gMHg1YSwg
LmFzY3EgPSAweDAxLAorICAgIC5kZXNjciA9ICJPUEVSQVRPUiBNRURJVU0gUkVNT1ZBTCBSRVFV
RVNUIgorfTsKKworc3RhdGljIGlubGluZSBnYm9vbGVhbiBjZF9zY3NpX29wY29kZV91YV9zdXBy
ZXNzKHVpbnQzMl90IG9wY29kZSkKK3sKKyAgICBzd2l0Y2ggKG9wY29kZSkgeworICAgIGNhc2Ug
SU5RVUlSWToKKyAgICBjYXNlIFJFUE9SVF9MVU5TOgorICAgIGNhc2UgR0VUX0NPTkZJR1VSQVRJ
T046CisgICAgY2FzZSBHRVRfRVZFTlRfU1RBVFVTX05PVElGSUNBVElPTjoKKyAgICBjYXNlIFJF
UVVFU1RfU0VOU0U6CisgICAgICAgIHJldHVybiBUUlVFOworICAgIGRlZmF1bHQ6CisgICAgICAg
IHJldHVybiBGQUxTRTsKKyAgICB9Cit9CisKK3N0YXRpYyBpbmxpbmUgY29uc3QgY2hhciAqQ2RT
Y3NpUmVxU3RhdGVfc3RyKENkU2NzaVJlcVN0YXRlIHN0YXRlKQoreworICAgIHN3aXRjaChzdGF0
ZSkgeworICAgIGNhc2UgU0NTSV9SRVFfSURMRToKKyAgICAgICAgcmV0dXJuICJJRExFIjsKKyAg
ICBjYXNlIFNDU0lfUkVRX1JVTk5JTkc6CisgICAgICAgIHJldHVybiAiUlVOTklORyI7CisgICAg
Y2FzZSBTQ1NJX1JFUV9DT01QTEVURToKKyAgICAgICAgcmV0dXJuICJDT01QTEVURSI7CisgICAg
Y2FzZSBTQ1NJX1JFUV9DQU5DRUxFRDoKKyAgICAgICAgcmV0dXJuICJDQU5DRUxFRCI7CisgICAg
ZGVmYXVsdDoKKyAgICAgICAgcmV0dXJuICJJTExFR0FMIjsKKyAgICB9Cit9CisKK3N0YXRpYyBj
b25zdCBjaGFyICpjZF9zY3NpX3NlbnNlX2tleV9kZXNjcih1aW50OF90IHNlbnNlX2tleSkKK3sK
KyAgICBzd2l0Y2goc2Vuc2Vfa2V5KSB7CisgICAgY2FzZSBOT19TRU5TRToKKyAgICAgICAgcmV0
dXJuICJOTyBTRU5TRSI7CisgICAgY2FzZSBSRUNPVkVSRURfRVJST1I6CisgICAgICAgIHJldHVy
biAiUkVDT1ZFUkVEIEVSUk9SIjsKKyAgICBjYXNlIE5PVF9SRUFEWToKKyAgICAgICAgcmV0dXJu
ICJMVU4gTk9UIFJFQURZIjsKKyAgICBjYXNlIE1FRElVTV9FUlJPUjoKKyAgICAgICAgcmV0dXJu
ICJNRURJVU0gRVJST1IiOworICAgIGNhc2UgSEFSRFdBUkVfRVJST1I6CisgICAgICAgIHJldHVy
biAiSEFSRFdBUkUgRVJST1IiOworICAgIGNhc2UgSUxMRUdBTF9SRVFVRVNUOgorICAgICAgICBy
ZXR1cm4gIklMTEVHQUwgUkVRVUVTVCI7CisgICAgY2FzZSBVTklUX0FUVEVOVElPTjoKKyAgICAg
ICAgcmV0dXJuICJVTklUIEFUVEVOVElPTiI7CisgICAgY2FzZSBCTEFOS19DSEVDSzoKKyAgICAg
ICAgcmV0dXJuICJCTEFOSyBDSEVDSyI7CisgICAgY2FzZSBBQk9SVEVEX0NPTU1BTkQ6CisgICAg
ICAgIHJldHVybiAiQUJPUlRFRCBDT01NQU5EIjsKKyAgICBkZWZhdWx0OgorICAgICAgICByZXR1
cm4gIj8/PyI7CisgICAgfQorfQorc3RhdGljIHVpbnQzMl90IGNkX3Njc2lfYnVpbGRfZml4ZWRf
c2Vuc2UodWludDhfdCAqYnVmLCBjb25zdCBTY3NpU2hvcnRTZW5zZSAqc2hvcnRfc2Vuc2UpCit7
CisgICAgbWVtc2V0KGJ1ZiwgMCwgRklYRURfU0VOU0VfTEVOKTsKKworICAgIGJ1ZlswXSA9IEZJ
WEVEX1NFTlNFX0NVUlJFTlQ7CisgICAgYnVmWzJdID0gc2hvcnRfc2Vuc2UtPmtleTsKKyAgICBi
dWZbN10gPSAxMDsKKyAgICBidWZbMTJdID0gc2hvcnRfc2Vuc2UtPmFzYzsKKyAgICBidWZbMTNd
ID0gc2hvcnRfc2Vuc2UtPmFzY3E7CisKKyAgICByZXR1cm4gRklYRURfU0VOU0VfTEVOOworfQor
CitzdGF0aWMgaW5saW5lIHZvaWQgY2Rfc2NzaV9yZXFfaW5pdChDZFNjc2lSZXF1ZXN0ICpyZXEp
Cit7CisgICAgcmVxLT5yZXFfc3RhdGUgPSBTQ1NJX1JFUV9JRExFOworICAgIHJlcS0+eGZlcl9k
aXIgPSBTQ1NJX1hGRVJfTk9ORTsKKyAgICByZXEtPnByaXZfZGF0YSA9IE5VTEw7CisgICAgcmVx
LT5pbl9sZW4gPSAwOworICAgIHJlcS0+c3RhdHVzID0gR09PRDsKK30KKworc3RhdGljIGlubGlu
ZSB2b2lkIGNkX3Njc2lfZGV2X3NlbnNlX3Jlc2V0KENkU2NzaUxVICpkZXYpCit7CisgICAgbWVt
c2V0KCZkZXYtPnNob3J0X3NlbnNlLCAwLCBzaXplb2YoZGV2LT5zaG9ydF9zZW5zZSkpOworICAg
IGNkX3Njc2lfYnVpbGRfZml4ZWRfc2Vuc2UoZGV2LT5maXhlZF9zZW5zZSwgJmRldi0+c2hvcnRf
c2Vuc2UpOworfQorCitzdGF0aWMgaW5saW5lIHZvaWQgY2Rfc2NzaV9kZXZfc2Vuc2Vfc2V0KENk
U2NzaUxVICpkZXYsIGNvbnN0IFNjc2lTaG9ydFNlbnNlICpzaG9ydF9zZW5zZSkKK3sKKyAgICBp
ZiAoc2hvcnRfc2Vuc2UgIT0gTlVMTCkgeworICAgICAgICAvKiBjb3B5IHNob3J0IHNlbnNlIGFu
ZCBnZW5lcmF0ZSBmdWxsIHNlbnNlIGluIGZpeGVkIGZvcm1hdCAqLworICAgICAgICBkZXYtPnNo
b3J0X3NlbnNlID0gKnNob3J0X3NlbnNlOworICAgICAgICBjZF9zY3NpX2J1aWxkX2ZpeGVkX3Nl
bnNlKGRldi0+Zml4ZWRfc2Vuc2UsIHNob3J0X3NlbnNlKTsKKyAgICB9Cit9CisKK3N0YXRpYyBp
bmxpbmUgdm9pZCBjZF9zY3NpX2Rldl9zZW5zZV9zZXRfcG93ZXJfb24oQ2RTY3NpTFUgKmRldikK
K3sKKyAgICBjZF9zY3NpX2Rldl9zZW5zZV9zZXQoZGV2LCAmc2Vuc2VfY29kZV9QT1dFUl9PTl9S
RVNFVCk7Cit9CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQo
Q2RTY3NpTFUgKmRldiwgQ2RTY3NpUmVxdWVzdCAqcmVxLAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBTY3NpU2hvcnRTZW5zZSAqc2hvcnRfc2Vuc2Up
Cit7CisgICAgcmVxLT5yZXFfc3RhdGUgPSBTQ1NJX1JFUV9DT01QTEVURTsKKyAgICByZXEtPnN0
YXR1cyA9IENIRUNLX0NPTkRJVElPTjsKKyAgICByZXEtPmluX2xlbiA9IDA7CisKKyAgICBjZF9z
Y3NpX2Rldl9zZW5zZV9zZXQoZGV2LCBzaG9ydF9zZW5zZSk7CisKKyAgICBTUElDRV9ERUJVRygi
Q0hFQ0tfQ09ORCwgcmVxdWVzdCBsdW46JXUiCisgICAgICAgICAgICAgICAgIiBvcDogMHglMDJ4
LCBwZW5kaW5nIHNlbnNlOiAweCUwMnggJTAyeCAlMDJ4IC0gJXMsICVzIiwKKyAgICAgICAgICAg
ICAgICBkZXYtPmx1biwgKHVpbnQzMl90KXJlcS0+Y2RiWzBdLAorICAgICAgICAgICAgICAgICh1
aW50MzJfdClkZXYtPnNob3J0X3NlbnNlLmtleSwKKyAgICAgICAgICAgICAgICAodWludDMyX3Qp
ZGV2LT5zaG9ydF9zZW5zZS5hc2MsCisgICAgICAgICAgICAgICAgKHVpbnQzMl90KWRldi0+c2hv
cnRfc2Vuc2UuYXNjcSwKKyAgICAgICAgICAgICAgICBjZF9zY3NpX3NlbnNlX2tleV9kZXNjcihk
ZXYtPnNob3J0X3NlbnNlLmtleSksCisgICAgICAgICAgICAgICAgZGV2LT5zaG9ydF9zZW5zZS5k
ZXNjcik7Cit9CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX2NvbXBsZXRlX2dvb2QoQ2RTY3Np
TFUgKmRldiwgQ2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAgIHJlcS0+cmVxX3N0YXRlID0gU0NT
SV9SRVFfQ09NUExFVEU7CisgICAgcmVxLT5zdGF0dXMgPSBHT09EOworfQorCisvKiBTQ1NJIFRh
cmdldCAqLworCitTUElDRV9DT05TVFJVQ1RPUl9GVU5DKGNkX3Njc2lfY21kX25hbWVzX2luaXQp
Cit7CisgICAgdWludDMyX3Qgb3Bjb2RlOworCisgICAgZm9yIChvcGNvZGUgPSAwOyBvcGNvZGUg
PCAyNTY7IG9wY29kZSsrKSB7CisgICAgICAgIHNjc2lfY21kX25hbWVbb3Bjb2RlXSA9ICJVTlNV
UFBPUlRFRCI7CisgICAgfQorCisgICAgc2NzaV9jbWRfbmFtZVtSRVBPUlRfTFVOU10gPSAiUkVQ
T1JUIExVTlMiOworICAgIHNjc2lfY21kX25hbWVbVEVTVF9VTklUX1JFQURZXSA9ICJURVNUIFVO
SVQgUkVBRFkiOworICAgIHNjc2lfY21kX25hbWVbSU5RVUlSWV0gPSAiSU5RVUlSWSI7CisgICAg
c2NzaV9jbWRfbmFtZVtSRVFVRVNUX1NFTlNFXSA9ICJSRVFVRVNUIFNFTlNFIjsKKyAgICBzY3Np
X2NtZF9uYW1lW1JFQURfNl0gPSAiUkVBRCg2KSI7CisgICAgc2NzaV9jbWRfbmFtZVtSRUFEXzEw
XSA9ICJSRUFEKDEwKSI7CisgICAgc2NzaV9jbWRfbmFtZVtSRUFEXzEyXSA9ICJSRUFEKDEyKSI7
CisgICAgc2NzaV9jbWRfbmFtZVtSRUFEXzE2XSA9ICJSRUFEKDE2KSI7CisgICAgc2NzaV9jbWRf
bmFtZVtSRUFEX0NBUEFDSVRZXzEwXSA9ICJSRUFEIENBUEFDSVRZKDEwKSI7CisgICAgc2NzaV9j
bWRfbmFtZVtSRUFEX1RPQ10gPSAiUkVBRCBUT0MiOworICAgIHNjc2lfY21kX25hbWVbR0VUX0VW
RU5UX1NUQVRVU19OT1RJRklDQVRJT05dID0gIkdFVCBFVkVOVC9TVEFUVVMgTk9USUZJQ0FUSU9O
IjsKKyAgICBzY3NpX2NtZF9uYW1lW1JFQURfRElTQ19JTkZPUk1BVElPTl0gPSAiUkVBRCBESVND
IElORk8iOworICAgIHNjc2lfY21kX25hbWVbUkVBRF9UUkFDS19JTkZPUk1BVElPTl0gPSAiUkVB
RCBUUkFDSyBJTkZPIjsKKyAgICBzY3NpX2NtZF9uYW1lW01PREVfU0VOU0VfMTBdID0gIk1PREUg
U0VOU0UoMTApIjsKKyAgICBzY3NpX2NtZF9uYW1lW01PREVfU0VMRUNUXSA9ICJNT0RFIFNFTEVD
VCg2KSI7CisgICAgc2NzaV9jbWRfbmFtZVtNT0RFX1NFTEVDVF8xMF0gPSAiTU9ERSBTRUxFQ1Qo
MTApIjsKKyAgICBzY3NpX2NtZF9uYW1lW0dFVF9DT05GSUdVUkFUSU9OXSA9ICJHRVQgQ09ORklH
VVJBVElPTiI7CisgICAgc2NzaV9jbWRfbmFtZVtBTExPV19NRURJVU1fUkVNT1ZBTF0gPSAiUFJF
VkVOVCBBTExPVyBNRURJVU0gUkVNT1ZBTCI7CisgICAgc2NzaV9jbWRfbmFtZVtNTUNfU0VORF9F
VkVOVF0gPSAiU0VORCBFVkVOVCI7CisgICAgc2NzaV9jbWRfbmFtZVtNTUNfUkVQT1JUX0tFWV0g
PSAiUkVQT1JUIEtFWSI7CisgICAgc2NzaV9jbWRfbmFtZVtNTUNfU0VORF9LRVldID0gIlNFTkRf
S0VZIjsKKyAgICBzY3NpX2NtZF9uYW1lW1NUQVJUX1NUT1BdID0gIlNUQVJUIFNUT1AgVU5JVCI7
CisgICAgc2NzaV9jbWRfbmFtZVtNTUNfR0VUX1BFUkZPUk1BTkNFXSA9ICJHRVQgUEVSRk9STUFO
Q0UiOworICAgIHNjc2lfY21kX25hbWVbTU1DX01FQ0hBTklTTV9TVEFUVVNdID0gIk1FQ0hBTklT
TSBTVEFUVVMiOworfQorCitDZFNjc2lUYXJnZXQgKmNkX3Njc2lfdGFyZ2V0X2FsbG9jKHZvaWQg
KnRhcmdldF91c2VyX2RhdGEsIHVpbnQzMl90IG1heF9sdW5zKQoreworICAgIENkU2NzaVRhcmdl
dCAqc3Q7CisKKyAgICBpZiAobWF4X2x1bnMgPT0gMCB8fCBtYXhfbHVucyA+IE1BWF9MVU5TKSB7
CisgICAgICAgIFNQSUNFX0VSUk9SKCJBbGxvYywgaWxsZWdhbCBtYXhfbHVuczoldSIsIG1heF9s
dW5zKTsKKyAgICAgICAgcmV0dXJuIE5VTEw7CisgICAgfQorCisgICAgc3QgPSBnX21hbGxvYzAo
c2l6ZW9mKCpzdCkpOworCisgICAgc3QtPnVzZXJfZGF0YSA9IHRhcmdldF91c2VyX2RhdGE7Cisg
ICAgc3QtPnN0YXRlID0gQ0RfU0NTSV9UR1RfU1RBVEVfUlVOTklORzsKKyAgICBzdC0+Y3VyX3Jl
cSA9IE5VTEw7CisgICAgc3QtPmNhbmNlbGxhYmxlID0gZ19jYW5jZWxsYWJsZV9uZXcoKTsKKyAg
ICBzdC0+bWF4X2x1bnMgPSBtYXhfbHVuczsKKworICAgIHJldHVybiBzdDsKK30KKwordm9pZCBj
ZF9zY3NpX3RhcmdldF9mcmVlKENkU2NzaVRhcmdldCAqc3QpCit7CisgICAgdWludDMyX3QgbHVu
OworCisgICAgY2Rfc2NzaV90YXJnZXRfcmVzZXQoc3QpOworICAgIGZvciAobHVuID0gMDsgbHVu
IDwgc3QtPm1heF9sdW5zOyBsdW4rKykgeworICAgICAgICBDZFNjc2lMVSAqdW5pdCA9ICZzdC0+
dW5pdHNbbHVuXTsKKyAgICAgICAgaWYgKHVuaXQtPnJlYWxpemVkKSB7CisgICAgICAgICAgICBj
ZF9zY3NpX2Rldl91bnJlYWxpemUoc3QsIGx1bik7CisgICAgICAgIH0KKyAgICAgICAgZ19jbGVh
cl9vYmplY3QoJnVuaXQtPnN0cmVhbSk7CisgICAgfQorICAgIGdfY2xlYXJfb2JqZWN0KCZzdC0+
Y2FuY2VsbGFibGUpOworICAgIGdfZnJlZShzdCk7Cit9CisKKy8qIFNDU0kgRGV2aWNlICovCisK
K3N0YXRpYyBpbmxpbmUgZ2Jvb2xlYW4gY2Rfc2NzaV90YXJnZXRfbHVuX2xlZ2FsKGNvbnN0IENk
U2NzaVRhcmdldCAqc3QsIHVpbnQzMl90IGx1bikKK3sKKyAgICByZXR1cm4gKGx1biA8IHN0LT5t
YXhfbHVucykgPyBUUlVFIDogRkFMU0U7Cit9CisKK3N0YXRpYyBpbmxpbmUgZ2Jvb2xlYW4gY2Rf
c2NzaV90YXJnZXRfbHVuX3JlYWxpemVkKGNvbnN0IENkU2NzaVRhcmdldCAqc3QsIHVpbnQzMl90
IGx1bikKK3sKKyAgICByZXR1cm4gc3QtPnVuaXRzW2x1bl0ucmVhbGl6ZWQ7Cit9CisKK2ludCBj
ZF9zY3NpX2Rldl9yZWFsaXplKENkU2NzaVRhcmdldCAqc3QsIHVpbnQzMl90IGx1biwKKyAgICAg
ICAgICAgICAgICAgICAgICAgIGNvbnN0IENkU2NzaURldmljZVBhcmFtZXRlcnMgKmRldl9wYXJh
bXMpCit7CisgICAgQ2RTY3NpTFUgKmRldjsKKworICAgIGlmICghY2Rfc2NzaV90YXJnZXRfbHVu
X2xlZ2FsKHN0LCBsdW4pKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJSZWFsaXplLCBpbGxlZ2Fs
IGx1bjoldSIsIGx1bik7CisgICAgICAgIHJldHVybiAtMTsKKyAgICB9CisgICAgaWYgKGNkX3Nj
c2lfdGFyZ2V0X2x1bl9yZWFsaXplZChzdCwgbHVuKSkgeworICAgICAgICBTUElDRV9FUlJPUigi
UmVhbGl6ZSwgYWxyZWFkeSByZWFsaXplZCBsdW46JXUiLCBsdW4pOworICAgICAgICByZXR1cm4g
LTE7CisgICAgfQorICAgIGRldiA9ICZzdC0+dW5pdHNbbHVuXTsKKworICAgIG1lbXNldChkZXYs
IDAsIHNpemVvZigqZGV2KSk7CisgICAgZGV2LT50Z3QgPSBzdDsKKyAgICBkZXYtPmx1biA9IGx1
bjsKKworICAgIGRldi0+cmVhbGl6ZWQgPSBUUlVFOworICAgIGRldi0+cmVtb3ZhYmxlID0gVFJV
RTsKKyAgICBkZXYtPmxvYWRlZCA9IEZBTFNFOworICAgIGRldi0+cHJldmVudF9tZWRpYV9yZW1v
dmFsID0gRkFMU0U7CisgICAgZGV2LT5jZF9yb20gPSBGQUxTRTsKKworICAgIGRldi0+cG93ZXJf
Y29uZCA9IENEX1NDU0lfUE9XRVJfQUNUSVZFOworICAgIGRldi0+cG93ZXJfZXZlbnQgPSBDRF9Q
T1dFUl9FVkVOVF9OT19DSEFOR0U7CisgICAgZGV2LT5tZWRpYV9ldmVudCA9IENEX01FRElBX0VW
RU5UX05PX0NIQU5HRTsKKworICAgIGRldi0+Y2xhaW1fdmVyc2lvbiA9IDM7IC8qIDAgOiBub25l
OyAyLDMsNSA6IFNQQy9NTUMteCAqLworCisgICAgZGV2LT52ZW5kb3IgPSBnX3N0cmR1cChkZXZf
cGFyYW1zLT52ZW5kb3IpOworICAgIGRldi0+cHJvZHVjdCA9IGdfc3RyZHVwKGRldl9wYXJhbXMt
PnByb2R1Y3QpOworICAgIGRldi0+dmVyc2lvbiA9IGdfc3RyZHVwKGRldl9wYXJhbXMtPnZlcnNp
b24pOworICAgIGRldi0+c2VyaWFsID0gZ19zdHJkdXAoZGV2X3BhcmFtcy0+c2VyaWFsKTsKKwor
ICAgIGNkX3Njc2lfZGV2X3NlbnNlX3NldF9wb3dlcl9vbihkZXYpOworCisgICAgU1BJQ0VfREVC
VUcoIlJlYWxpemUgbHVuOiV1IGJzOiV1IFZSOlslc10gUFQ6WyVzXSB2ZXI6WyVzXSBTTlslc10i
LAorICAgICAgICAgICAgICAgIGx1biwgZGV2LT5ibG9ja19zaXplLCBkZXYtPnZlbmRvciwKKyAg
ICAgICAgICAgICAgICBkZXYtPnByb2R1Y3QsIGRldi0+dmVyc2lvbiwgZGV2LT5zZXJpYWwpOwor
ICAgIHJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2x1X21lZGlhX3Jlc2V0KENk
U2NzaUxVICpkZXYpCit7CisgICAgLyogbWVkaWFfZXZlbnQgaXMgbm90IHNldCBoZXJlLCBhcyBp
dCBkZXBlbmRzIG9uIHRoZSBjb250ZXh0ICovCisgICAgZ19jbGVhcl9vYmplY3QoJmRldi0+c3Ry
ZWFtKTsKKyAgICBkZXYtPnNpemUgPSAwOworICAgIGRldi0+YmxvY2tfc2l6ZSA9IDA7CisgICAg
ZGV2LT5udW1fYmxvY2tzID0gMDsKK30KKworaW50IGNkX3Njc2lfZGV2X2xvY2soQ2RTY3NpVGFy
Z2V0ICpzdCwgdWludDMyX3QgbHVuLCBnYm9vbGVhbiBsb2NrKQoreworICAgIENkU2NzaUxVICpk
ZXY7CisKKyAgICBpZiAoIWNkX3Njc2lfdGFyZ2V0X2x1bl9sZWdhbChzdCwgbHVuKSkgeworICAg
ICAgICBTUElDRV9FUlJPUigiTG9jaywgaWxsZWdhbCBsdW46JXUiLCBsdW4pOworICAgICAgICBy
ZXR1cm4gLTE7CisgICAgfQorICAgIGlmICghY2Rfc2NzaV90YXJnZXRfbHVuX3JlYWxpemVkKHN0
LCBsdW4pKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJMb2NrLCB1bnJlYWxpemVkIGx1bjoldSIs
IGx1bik7CisgICAgICAgIHJldHVybiAtMTsKKyAgICB9CisgICAgZGV2ID0gJnN0LT51bml0c1ts
dW5dOworICAgIGRldi0+cHJldmVudF9tZWRpYV9yZW1vdmFsID0gbG9jazsKKyAgICBTUElDRV9E
RUJVRygibHVuOiV1ICVzbG9jayIsIGx1biwgbG9jayA/ICJ1biIgOiIiKTsKKyAgICByZXR1cm4g
MDsKK30KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9sdV9sb2FkKENkU2NzaUxVICpkZXYsCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgQ2RTY3NpTWVkaWFQYXJhbWV0ZXJzICptZWRp
YV9wYXJhbXMpCit7CisgICAgaWYgKG1lZGlhX3BhcmFtcyAhPSBOVUxMKSB7CisgICAgICAgIGRl
di0+bWVkaWFfZXZlbnQgPSBDRF9NRURJQV9FVkVOVF9ORVdfTUVESUE7CisgICAgICAgIGRldi0+
c3RyZWFtID0gZ19vYmplY3RfcmVmKG1lZGlhX3BhcmFtcy0+c3RyZWFtKTsKKyAgICAgICAgZGV2
LT5zaXplID0gbWVkaWFfcGFyYW1zLT5zaXplOworICAgICAgICBkZXYtPmJsb2NrX3NpemUgPSBt
ZWRpYV9wYXJhbXMtPmJsb2NrX3NpemU7CisgICAgICAgIGRldi0+bnVtX2Jsb2NrcyA9IG1lZGlh
X3BhcmFtcy0+c2l6ZSAvIG1lZGlhX3BhcmFtcy0+YmxvY2tfc2l6ZTsKKyAgICAgICAgZGV2LT5s
b2FkZWQgPSBUUlVFOworICAgIH0gZWxzZSB7CisgICAgICAgIGRldi0+bWVkaWFfZXZlbnQgPSBD
RF9NRURJQV9FVkVOVF9NRURJQV9SRU1PVkFMOworICAgICAgICBjZF9zY3NpX2x1X21lZGlhX3Jl
c2V0KGRldik7CisgICAgICAgIGRldi0+bG9hZGVkID0gRkFMU0U7CisgICAgfQorfQorCitzdGF0
aWMgdm9pZCBjZF9zY3NpX2x1X3VubG9hZChDZFNjc2lMVSAqZGV2KQoreworICAgIGRldi0+bWVk
aWFfZXZlbnQgPSBDRF9NRURJQV9FVkVOVF9NRURJQV9SRU1PVkFMOworICAgIGNkX3Njc2lfbHVf
bWVkaWFfcmVzZXQoZGV2KTsKKyAgICBkZXYtPmxvYWRlZCA9IEZBTFNFOworfQorCitpbnQgY2Rf
c2NzaV9kZXZfbG9hZChDZFNjc2lUYXJnZXQgKnN0LCB1aW50MzJfdCBsdW4sCisgICAgICAgICAg
ICAgICAgICAgICBjb25zdCBDZFNjc2lNZWRpYVBhcmFtZXRlcnMgKm1lZGlhX3BhcmFtcykKK3sK
KyAgICBDZFNjc2lMVSAqZGV2OworCisgICAgaWYgKCFjZF9zY3NpX3RhcmdldF9sdW5fbGVnYWwo
c3QsIGx1bikpIHsKKyAgICAgICAgU1BJQ0VfRVJST1IoIkxvYWQsIGlsbGVnYWwgbHVuOiV1Iiwg
bHVuKTsKKyAgICAgICAgcmV0dXJuIC0xOworICAgIH0KKyAgICBpZiAoIWNkX3Njc2lfdGFyZ2V0
X2x1bl9yZWFsaXplZChzdCwgbHVuKSkgeworICAgICAgICBTUElDRV9FUlJPUigiTG9hZCwgdW5y
ZWFsaXplZCBsdW46JXUiLCBsdW4pOworICAgICAgICByZXR1cm4gLTE7CisgICAgfQorICAgIGRl
diA9ICZzdC0+dW5pdHNbbHVuXTsKKworICAgIGNkX3Njc2lfbHVfbG9hZChkZXYsIG1lZGlhX3Bh
cmFtcyk7CisgICAgZGV2LT5wb3dlcl9jb25kID0gQ0RfU0NTSV9QT1dFUl9BQ1RJVkU7CisgICAg
ZGV2LT5wb3dlcl9ldmVudCA9IENEX1BPV0VSX0VWRU5UX0NIQU5HRV9TVUNDRVNTOworCisgICAg
Y2Rfc2NzaV9kZXZfc2Vuc2Vfc2V0KGRldiwgJnNlbnNlX2NvZGVfTUVESVVNX0NIQU5HRUQpOwor
CisgICAgU1BJQ0VfREVCVUcoIkxvYWQgbHVuOiV1IHNpemU6JSIgR19HVUlOVDY0X0ZPUk1BVAor
ICAgICAgICAgICAgICAgICIgYmxrX3N6OiV1IG51bV9ibG9ja3M6JXUiLAorICAgICAgICAgICAg
ICAgIGx1biwgZGV2LT5zaXplLCBkZXYtPmJsb2NrX3NpemUsIGRldi0+bnVtX2Jsb2Nrcyk7Cisg
ICAgcmV0dXJuIDA7Cit9CisKK2ludCBjZF9zY3NpX2Rldl9nZXRfaW5mbyhDZFNjc2lUYXJnZXQg
KnN0LCB1aW50MzJfdCBsdW4sIENkU2NzaURldmljZUluZm8gKmx1bl9pbmZvKQoreworICAgIENk
U2NzaUxVICpkZXY7CisKKyAgICBpZiAoIWNkX3Njc2lfdGFyZ2V0X2x1bl9sZWdhbChzdCwgbHVu
KSkgeworICAgICAgICBTUElDRV9FUlJPUigiTG9hZCwgaWxsZWdhbCBsdW46JXUiLCBsdW4pOwor
ICAgICAgICByZXR1cm4gLTE7CisgICAgfQorICAgIGlmICghY2Rfc2NzaV90YXJnZXRfbHVuX3Jl
YWxpemVkKHN0LCBsdW4pKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJMb2FkLCB1bnJlYWxpemVk
IGx1bjoldSIsIGx1bik7CisgICAgICAgIHJldHVybiAtMTsKKyAgICB9CisgICAgZGV2ID0gJnN0
LT51bml0c1tsdW5dOworCisgICAgbHVuX2luZm8tPnN0YXJ0ZWQgPSBkZXYtPnBvd2VyX2NvbmQg
PT0gQ0RfU0NTSV9QT1dFUl9BQ1RJVkU7CisgICAgbHVuX2luZm8tPmxvY2tlZCA9IGRldi0+cHJl
dmVudF9tZWRpYV9yZW1vdmFsOworICAgIGx1bl9pbmZvLT5sb2FkZWQgPSBkZXYtPmxvYWRlZDsK
KworICAgIGx1bl9pbmZvLT5wYXJhbWV0ZXJzLnZlbmRvciA9IGRldi0+dmVuZG9yOworICAgIGx1
bl9pbmZvLT5wYXJhbWV0ZXJzLnByb2R1Y3QgPSBkZXYtPnByb2R1Y3Q7CisgICAgbHVuX2luZm8t
PnBhcmFtZXRlcnMudmVyc2lvbiA9IGRldi0+dmVyc2lvbjsKKyAgICBsdW5faW5mby0+cGFyYW1l
dGVycy5zZXJpYWwgPSBkZXYtPnNlcmlhbDsKKworICAgIHJldHVybiAwOworfQorCitpbnQgY2Rf
c2NzaV9kZXZfdW5sb2FkKENkU2NzaVRhcmdldCAqc3QsIHVpbnQzMl90IGx1bikKK3sKKyAgICBD
ZFNjc2lMVSAqZGV2OworCisgICAgaWYgKCFjZF9zY3NpX3RhcmdldF9sdW5fbGVnYWwoc3QsIGx1
bikpIHsKKyAgICAgICAgU1BJQ0VfRVJST1IoIlVubG9hZCwgaWxsZWdhbCBsdW46JXUiLCBsdW4p
OworICAgICAgICByZXR1cm4gLTE7CisgICAgfQorICAgIGlmICghY2Rfc2NzaV90YXJnZXRfbHVu
X3JlYWxpemVkKHN0LCBsdW4pKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJVbmxvYWQsIHVucmVh
bGl6ZWQgbHVuOiV1IiwgbHVuKTsKKyAgICAgICAgcmV0dXJuIC0xOworICAgIH0KKyAgICBkZXYg
PSAmc3QtPnVuaXRzW2x1bl07CisgICAgaWYgKCFkZXYtPmxvYWRlZCkgeworICAgICAgICBTUElD
RV9FUlJPUigiVW5sb2FkLCBsdW46JXUgbm90IGxvYWRlZCB5ZXQiLCBsdW4pOworICAgICAgICBy
ZXR1cm4gMDsKKyAgICB9CisgICAgaWYgKGRldi0+cHJldmVudF9tZWRpYV9yZW1vdmFsKSB7Cisg
ICAgICAgIFNQSUNFX0VSUk9SKCJVbmxvYWQsIGx1bjoldSBwcmV2ZW50X21lZGlhX3JlbW92YWwg
c2V0IiwgbHVuKTsKKyAgICAgICAgcmV0dXJuIC0xOworICAgIH0KKworICAgIGNkX3Njc2lfbHVf
dW5sb2FkKGRldik7CisgICAgZGV2LT5wb3dlcl9jb25kID0gQ0RfU0NTSV9QT1dFUl9TVE9QUEVE
OworICAgIGRldi0+cG93ZXJfZXZlbnQgPSBDRF9QT1dFUl9FVkVOVF9DSEFOR0VfU1VDQ0VTUzsK
KworICAgIGNkX3Njc2lfZGV2X3NlbnNlX3NldChkZXYsICZzZW5zZV9jb2RlX1VBX05PX01FRElV
TSk7CisKKyAgICBTUElDRV9ERUJVRygiVW5sb2FkIGx1bjoldSIsIGx1bik7CisgICAgcmV0dXJu
IDA7Cit9CisKK2ludCBjZF9zY3NpX2Rldl91bnJlYWxpemUoQ2RTY3NpVGFyZ2V0ICpzdCwgdWlu
dDMyX3QgbHVuKQoreworICAgIENkU2NzaUxVICpkZXY7CisKKyAgICBpZiAoIWNkX3Njc2lfdGFy
Z2V0X2x1bl9sZWdhbChzdCwgbHVuKSkgeworICAgICAgICBTUElDRV9FUlJPUigiVW5yZWFsaXpl
LCBpbGxlZ2FsIGx1bjoldSIsIGx1bik7CisgICAgICAgIHJldHVybiAtMTsKKyAgICB9CisgICAg
aWYgKCFjZF9zY3NpX3RhcmdldF9sdW5fcmVhbGl6ZWQoc3QsIGx1bikpIHsKKyAgICAgICAgU1BJ
Q0VfRVJST1IoIlVucmVhbGl6ZSwgYWJzZW50IGx1bjoldSIsIGx1bik7CisgICAgICAgIHJldHVy
biAtMTsKKyAgICB9CisgICAgZGV2ID0gJnN0LT51bml0c1tsdW5dOworCisgICAgZ19jbGVhcl9w
b2ludGVyKCZkZXYtPnZlbmRvciwgZ19mcmVlKTsKKyAgICBnX2NsZWFyX3BvaW50ZXIoJmRldi0+
cHJvZHVjdCwgZ19mcmVlKTsKKyAgICBnX2NsZWFyX3BvaW50ZXIoJmRldi0+dmVyc2lvbiwgZ19m
cmVlKTsKKyAgICBnX2NsZWFyX3BvaW50ZXIoJmRldi0+c2VyaWFsLCBnX2ZyZWUpOworCisgICAg
Z19jbGVhcl9vYmplY3QoJmRldi0+c3RyZWFtKTsKKworICAgIGRldi0+bG9hZGVkID0gRkFMU0U7
CisgICAgZGV2LT5yZWFsaXplZCA9IEZBTFNFOworICAgIGRldi0+cG93ZXJfY29uZCA9IENEX1ND
U0lfUE9XRVJfU1RPUFBFRDsKKworICAgIFNQSUNFX0RFQlVHKCJVbnJlYWxpemUgbHVuOiV1Iiwg
bHVuKTsKKyAgICByZXR1cm4gMDsKK30KKworaW50IGNkX3Njc2lfZGV2X3Jlc2V0KENkU2NzaVRh
cmdldCAqc3QsIHVpbnQzMl90IGx1bikKK3sKKyAgICBDZFNjc2lMVSAqZGV2OworCisgICAgaWYg
KCFjZF9zY3NpX3RhcmdldF9sdW5fbGVnYWwoc3QsIGx1bikpIHsKKyAgICAgICAgU1BJQ0VfRVJS
T1IoIkRldmljZSByZXNldCwgaWxsZWdhbCBsdW46JXUiLCBsdW4pOworICAgICAgICByZXR1cm4g
LTE7CisgICAgfQorICAgIGlmICghY2Rfc2NzaV90YXJnZXRfbHVuX3JlYWxpemVkKHN0LCBsdW4p
KSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJEZXZpY2UgcmVzZXQsIGFic2VudCBsdW46JXUiLCBs
dW4pOworICAgICAgICByZXR1cm4gLTE7CisgICAgfQorICAgIGRldiA9ICZzdC0+dW5pdHNbbHVu
XTsKKworICAgIC8qIGlmIHdlIHJlc2V0IHRoZSAncHJldmVudCcgZmxhZyB3ZSBjYW4ndCBjcmVh
dGUKKyAgICAgKiB0aGUgdW5pdCB0aGF0IGlzIGxvY2tlZCBmcm9tIHRoZSBiZWdpbm5pbmcsIHNv
CisgICAgICogd2Uga2VlcCB0aGlzIGZsYWcgYXMgcGVyc2lzdGVudCBvdmVyIHJlc2V0cworICAg
ICAqLworICAgIC8qIGRldi0+cHJldmVudF9tZWRpYV9yZW1vdmFsID0gRkFMU0U7ICovCisgICAg
ZGV2LT5wb3dlcl9jb25kID0gQ0RfU0NTSV9QT1dFUl9BQ1RJVkU7CisgICAgZGV2LT5wb3dlcl9l
dmVudCA9IENEX1BPV0VSX0VWRU5UX0NIQU5HRV9TVUNDRVNTOworICAgIGNkX3Njc2lfZGV2X3Nl
bnNlX3NldF9wb3dlcl9vbihkZXYpOworCisgICAgU1BJQ0VfREVCVUcoIkRldmljZSByZXNldCBs
dW46JXUiLCBsdW4pOworICAgIHJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX3Rh
cmdldF9kb19yZXNldChDZFNjc2lUYXJnZXQgKnN0KQoreworICAgIHVpbnQzMl90IGx1bjsKKwor
ICAgIGZvciAobHVuID0gMDsgbHVuIDwgc3QtPm1heF9sdW5zOyBsdW4rKykgeworICAgICAgICBp
ZiAoc3QtPnVuaXRzW2x1bl0ucmVhbGl6ZWQpIHsKKyAgICAgICAgICAgIGNkX3Njc2lfZGV2X3Jl
c2V0KHN0LCBsdW4pOworICAgICAgICB9CisgICAgfQorCisgICAgU1BJQ0VfREVCVUcoIlRhcmdl
dCByZXNldCBjb21wbGV0ZSIpOworICAgIHN0LT5zdGF0ZSA9IENEX1NDU0lfVEdUX1NUQVRFX1JV
Tk5JTkc7CisgICAgY2Rfc2NzaV90YXJnZXRfcmVzZXRfY29tcGxldGUoc3QtPnVzZXJfZGF0YSk7
Cit9CisKK2ludCBjZF9zY3NpX3RhcmdldF9yZXNldChDZFNjc2lUYXJnZXQgKnN0KQoreworICAg
IGlmIChzdC0+c3RhdGUgPT0gQ0RfU0NTSV9UR1RfU1RBVEVfUkVTRVQpIHsKKyAgICAgICAgU1BJ
Q0VfREVCVUcoIlRhcmdldCBhbHJlYWR5IGluIHJlc2V0Iik7CisgICAgICAgIHJldHVybiAtMTsK
KyAgICB9CisKKyAgICBzdC0+c3RhdGUgPSBDRF9TQ1NJX1RHVF9TVEFURV9SRVNFVDsKKworICAg
IGlmIChzdC0+Y3VyX3JlcSAhPSBOVUxMKSB7CisgICAgICAgIGNkX3Njc2lfZGV2X3JlcXVlc3Rf
Y2FuY2VsKHN0LCBzdC0+Y3VyX3JlcSk7CisgICAgICAgIGlmIChzdC0+Y3VyX3JlcSAhPSBOVUxM
KSB7CisgICAgICAgICAgICBTUElDRV9ERUJVRygiVGFyZ2V0IHJlc2V0IGluIHByb2dyZXNzLi4u
Iik7CisgICAgICAgICAgICByZXR1cm4gMDsKKyAgICAgICAgfQorICAgIH0KKworICAgIGNkX3Nj
c2lfdGFyZ2V0X2RvX3Jlc2V0KHN0KTsKKyAgICByZXR1cm4gMDsKK30KKworQ2RTY3NpUmVxU3Rh
dGUgY2Rfc2NzaV9nZXRfcmVxX3N0YXRlKENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICByZXR1
cm4gcmVxLT5yZXFfc3RhdGU7Cit9CisKK3N0YXRpYyB2b2lkIHN0cnBhZGNweShjaGFyICpidWYs
IGludCBidWZfc2l6ZSwgY29uc3QgY2hhciAqc3RyLCBjaGFyIHBhZCkKK3sKKyAgICBpbnQgbGVu
ID0gc3RybmxlbihzdHIsIGJ1Zl9zaXplKTsKKyAgICBtZW1jcHkoYnVmLCBzdHIsIGxlbik7Cisg
ICAgbWVtc2V0KGJ1ZiArIGxlbiwgcGFkLCBidWZfc2l6ZSAtIGxlbik7Cit9CisKKy8qIFNDU0kg
Q0RCICovCisKK3N0YXRpYyB1bnNpZ25lZCBpbnQgc2NzaV9jZGJfbGVuZ3RoKGNvbnN0IHVpbnQ4
X3QgKmNkYikKK3sKKyAgICB1bnNpZ25lZCBpbnQgY2RiX2xlbjsKKworICAgIHN3aXRjaCAoY2Ri
WzBdID4+IDUpIHsKKyAgICBjYXNlIDA6CisgICAgICAgIGNkYl9sZW4gPSA2OworICAgICAgICBi
cmVhazsKKyAgICBjYXNlIDE6CisgICAgY2FzZSAyOgorICAgICAgICBjZGJfbGVuID0gMTA7Cisg
ICAgICAgIGJyZWFrOworICAgIGNhc2UgNDoKKyAgICAgICAgY2RiX2xlbiA9IDE2OworICAgICAg
ICBicmVhazsKKyAgICBjYXNlIDU6CisgICAgICAgIGNkYl9sZW4gPSAxMjsKKyAgICAgICAgYnJl
YWs7CisgICAgZGVmYXVsdDoKKyAgICAgICAgY2RiX2xlbiA9IDA7CisgICAgfQorICAgIHJldHVy
biBjZGJfbGVuOworfQorCitzdGF0aWMgdWludDY0X3Qgc2NzaV9jZGJfbGJhKGNvbnN0IHVpbnQ4
X3QgKmNkYiwgaW50IGNkYl9sZW4pCit7CisgICAgdWludDY0X3QgbGJhOworCisgICAgc3dpdGNo
IChjZGJfbGVuKSB7CisgICAgY2FzZSA2OgorICAgICAgICBsYmEgPSAoKCh1aW50NjRfdCkoY2Ri
WzFdICYgMHgxZikpIDw8IDE2KSB8CisgICAgICAgICAgICAgICgoKHVpbnQ2NF90KWNkYlsyXSkg
PDwgOCkgfAorICAgICAgICAgICAgICAgKCh1aW50NjRfdCljZGJbM10pOworICAgICAgICBicmVh
azsKKyAgICBjYXNlIDEwOgorICAgIGNhc2UgMTI6CisgICAgICAgIGxiYSA9ICgoKHVpbnQ2NF90
KWNkYlsyXSkgPDwgMjQpIHwKKyAgICAgICAgICAgICAgKCgodWludDY0X3QpY2RiWzNdKSA8PCAx
NikgfAorICAgICAgICAgICAgICAoKCh1aW50NjRfdCljZGJbNF0pIDw8IDgpICB8CisgICAgICAg
ICAgICAgICAoKHVpbnQ2NF90KWNkYls1XSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgMTY6
CisgICAgICAgIGxiYSA9ICgoKHVpbnQ2NF90KWNkYlsyXSkgPDwgNTYpIHwKKyAgICAgICAgICAg
ICAgKCgodWludDY0X3QpY2RiWzNdKSA8PCA0OCkgfAorICAgICAgICAgICAgICAoKCh1aW50NjRf
dCljZGJbNF0pIDw8IDQwKSB8CisgICAgICAgICAgICAgICgoKHVpbnQ2NF90KWNkYls1XSkgPDwg
MzIpIHwKKyAgICAgICAgICAgICAgKCgodWludDY0X3QpY2RiWzZdKSA8PCAyNCkgfAorICAgICAg
ICAgICAgICAoKCh1aW50NjRfdCljZGJbN10pIDw8IDE2KSB8CisgICAgICAgICAgICAgICgoKHVp
bnQ2NF90KWNkYls4XSkgPDwgOCkgIHwKKyAgICAgICAgICAgICAgICgodWludDY0X3QpY2RiWzld
KTsKKyAgICAgICAgYnJlYWs7CisgICAgZGVmYXVsdDoKKyAgICAgICAgbGJhID0gMDsKKyAgICB9
CisgICAgcmV0dXJuIGxiYTsKK30KKworc3RhdGljIHVpbnQzMl90IHNjc2lfY2RiX3hmZXJfbGVu
Z3RoKGNvbnN0IHVpbnQ4X3QgKmNkYiwgaW50IGNkYl9sZW4pCit7CisgICAgdWludDMyX3QgbGVu
OworCisgICAgc3dpdGNoIChjZGJfbGVuKSB7CisgICAgY2FzZSA2OgorICAgICAgICBsZW4gPSAo
dWludDMyX3QpY2RiWzRdOworICAgICAgICBpZiAobGVuID09IDApCisgICAgICAgICAgICBsZW4g
PSAyNTY7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgMTA6CisgICAgICAgIGxlbiA9ICgoKHVp
bnQzMl90KWNkYls3XSkgPDwgOCkgfAorICAgICAgICAgICAgICAgKCh1aW50MzJfdCljZGJbOF0p
OworICAgICAgICBicmVhazsKKyAgICBjYXNlIDEyOgorICAgICAgICBsZW4gPSAoKCh1aW50MzJf
dCljZGJbNl0pIDw8IDI0KSB8CisgICAgICAgICAgICAgICgoKHVpbnQzMl90KWNkYls3XSkgPDwg
MTYpIHwKKyAgICAgICAgICAgICAgKCgodWludDMyX3QpY2RiWzhdKSA8PCA4KSAgfAorICAgICAg
ICAgICAgICAgKCh1aW50MzJfdCljZGJbOV0pOworICAgICAgICBicmVhazsKKyAgICBjYXNlIDE2
OgorICAgICAgICBsZW4gPSAoKCh1aW50MzJfdCljZGJbMTBdKSA8PCAyNCkgfAorICAgICAgICAg
ICAgICAoKCh1aW50MzJfdCljZGJbMTFdKSA8PCAxNikgfAorICAgICAgICAgICAgICAoKCh1aW50
MzJfdCljZGJbMTJdKSA8PCA4KSAgfAorICAgICAgICAgICAgICAgKCh1aW50MzJfdCljZGJbMTNd
KTsKKyAgICAgICAgYnJlYWs7CisgICAgZGVmYXVsdDoKKyAgICAgICAgbGVuID0gMDsKKyAgICAg
ICAgYnJlYWs7CisgICAgfQorICAgIHJldHVybiBsZW47Cit9CisKKy8qIFNDU0kgY29tbWFuZHMg
Ki8KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRfdGVzdF91bml0X3JlYWR5KENkU2NzaUxVICpk
ZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICByZXEtPnhmZXJfZGlyID0gU0NTSV9YRkVS
X05PTkU7CisgICAgcmVxLT5pbl9sZW4gPSAwOworCisgICAgaWYgKGRldi0+bG9hZGVkKSB7Cisg
ICAgICAgIGlmIChkZXYtPnBvd2VyX2NvbmQgIT0gQ0RfU0NTSV9QT1dFUl9TVE9QUEVEKSB7Cisg
ICAgICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKKyAgICAgICAg
fSBlbHNlIHsKKyAgICAgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2
LCByZXEsICZzZW5zZV9jb2RlX0lOSVRfQ01EX1JFUVVJUkVEKTsKKyAgICAgICAgfQorICAgIH0g
ZWxzZSB7CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEs
ICZzZW5zZV9jb2RlX05PVF9SRUFEWV9OT19NRURJVU0pOworICAgIH0KK30KKworc3RhdGljIHZv
aWQgY2Rfc2NzaV9jbWRfcmVxdWVzdF9zZW5zZShDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0
ICpyZXEpCit7CisgICAgcmVxLT54ZmVyX2RpciA9IFNDU0lfWEZFUl9GUk9NX0RFVjsKKworICAg
IHJlcS0+cmVxX2xlbiA9IHJlcS0+Y2RiWzRdOworICAgIHJlcS0+aW5fbGVuID0gTUlOKHJlcS0+
cmVxX2xlbiwgc2l6ZW9mKGRldi0+Zml4ZWRfc2Vuc2UpKTsKKworICAgIGlmIChkZXYtPnNob3J0
X3NlbnNlLmtleSAhPSBOT19TRU5TRSkgeworICAgICAgICBTUElDRV9ERUJVRygiJXMsIGx1bjol
dSByZXBvcnRlZCBzZW5zZTogMHglMDJ4ICUwMnggJTAyeCAtICVzLCAlcyIsCisgICAgICAgICAg
ICAgICAgICAgIF9fRlVOQ1RJT05fXywgcmVxLT5sdW4sCisgICAgICAgICAgICAgICAgICAgIGRl
di0+c2hvcnRfc2Vuc2Uua2V5LCBkZXYtPnNob3J0X3NlbnNlLmFzYywgZGV2LT5zaG9ydF9zZW5z
ZS5hc2NxLAorICAgICAgICAgICAgICAgICAgICBjZF9zY3NpX3NlbnNlX2tleV9kZXNjcihkZXYt
PnNob3J0X3NlbnNlLmtleSksCisgICAgICAgICAgICAgICAgICAgIGRldi0+c2hvcnRfc2Vuc2Uu
ZGVzY3IpOworICAgIH0KKyAgICBtZW1jcHkocmVxLT5idWYsIGRldi0+Zml4ZWRfc2Vuc2UsIHNp
emVvZihkZXYtPmZpeGVkX3NlbnNlKSk7CisgICAgY2Rfc2NzaV9kZXZfc2Vuc2VfcmVzZXQoZGV2
KTsgLyogY2xlYXIgcmVwb3J0ZWQgc2Vuc2UgKi8KKworICAgIGNkX3Njc2lfY21kX2NvbXBsZXRl
X2dvb2QoZGV2LCByZXEpOworfQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9yZXBvcnRfbHVu
cyhDZFNjc2lUYXJnZXQgKnN0LCBDZFNjc2lMVSAqZGV2LAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgQ2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAgIHVpbnQ4X3QgKm91dF9i
dWYgPSByZXEtPmJ1ZjsKKyAgICB1aW50MzJfdCBtYXhfbHVucyA9IHN0LT5tYXhfbHVuczsKKyAg
ICB1aW50MzJfdCBidWZsZW4gPSA4OyAvKiBoZWFkZXIgbGVuZ3RoICovCisgICAgdWludDMyX3Qg
bHVuOworCisgICAgcmVxLT5yZXFfbGVuID0gc2NzaV9jZGJfeGZlcl9sZW5ndGgocmVxLT5jZGIs
IDEyKTsKKyAgICByZXEtPnhmZXJfZGlyID0gU0NTSV9YRkVSX0ZST01fREVWOworCisgICAgLyog
Y2hlY2sgU0VMRUNUIFJFUE9SVCBmaWVsZCAqLworICAgIGlmIChyZXEtPmNkYlsyXSA9PSAweDAx
KSB7CisgICAgICAgIC8qIG9ubHkgd2VsbCBrbm93biBsb2dpY2FsIHVuaXRzICovCisgICAgICAg
IG1heF9sdW5zID0gMDsKKyAgICB9CisKKyAgICBtZW1zZXQob3V0X2J1ZiwgMCwgOCk7CisKKyAg
ICBmb3IgKGx1biA9IDA7IGx1biA8IG1heF9sdW5zOyBsdW4rKykgeworICAgICAgICBpZiAoc3Qt
PnVuaXRzW2x1bl0ucmVhbGl6ZWQpIHsKKyAgICAgICAgICAgIG91dF9idWZbYnVmbGVuKytdID0g
MDsKKyAgICAgICAgICAgIG91dF9idWZbYnVmbGVuKytdID0gKHVpbnQ4X3QpKGx1bik7CisgICAg
ICAgICAgICBtZW1zZXQoJm91dF9idWZbYnVmbGVuXSwgMCwgNik7CisgICAgICAgICAgICBidWZs
ZW4gKz0gNjsKKyAgICAgICAgfQorICAgIH0KKworICAgIC8qIGZpbGwgTFVOIExJU1QgTEVOR1RI
ICovCisgICAgb3V0X2J1ZlswXSA9ICh1aW50OF90KSgoYnVmbGVuLTgpID4+IDI0KTsKKyAgICBv
dXRfYnVmWzFdID0gKHVpbnQ4X3QpKChidWZsZW4tOCkgPj4gMTYpOworICAgIG91dF9idWZbMl0g
PSAodWludDhfdCkoKGJ1Zmxlbi04KSA+PiA4KTsKKyAgICBvdXRfYnVmWzNdID0gKHVpbnQ4X3Qp
KChidWZsZW4tOCkpOworCisgICAgcmVxLT5pbl9sZW4gPSBidWZsZW47CisgICAgY2Rfc2NzaV9j
bWRfY29tcGxldGVfZ29vZChkZXYsIHJlcSk7Cit9CisKKyNkZWZpbmUgU0NTSV9NQVhfSU5RVUlS
WV9MRU4gICAgICAgIDI1NgorI2RlZmluZSBTQ1NJX01BWF9NT0RFX0xFTiAgICAgICAgICAgMjU2
CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX2lucXVpcnlfdnBkX25vX2x1bihDZFNjc2lMVSAq
ZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgdWludDMyX3QgcGVyaWZfcXVhbCkKK3sKKyAgICB1aW50OF90ICpvdXRidWYg
PSByZXEtPmJ1ZjsKKyAgICB1aW50OF90IHBhZ2VfY29kZSA9IHJlcS0+Y2RiWzJdOworICAgIHVp
bnQzMl90IHJlc3BfbGVuID0gNDsKKworICAgIG91dGJ1ZlswXSA9IChwZXJpZl9xdWFsIDw8IDUp
IHwgVFlQRV9ST007CisgICAgb3V0YnVmWzFdID0gcGFnZV9jb2RlIDsgLyogdGhpcyBwYWdlICov
CisgICAgb3V0YnVmWzJdID0gMHgwMDsgLyogcGFnZSBsZW5ndGggTVNCICovCisgICAgb3V0YnVm
WzNdID0gMHgwMDsgLyogcGFnZSBsZW5ndGggTFNCIC0gbm8gbW9yZSBkYXRhICovCisKKyAgICBy
ZXEtPmluX2xlbiA9IE1JTihyZXEtPnJlcV9sZW4sIHJlc3BfbGVuKTsKKworICAgIFNQSUNFX0RF
QlVHKCJpbnF1aXJ5X3ZwZCwgdW5zdXBwb3J0ZWQgbHVuOiV1IgorICAgICAgICAgICAgICAgICIg
cGVyaWZfcXVhbDoweCV4IHJlc3BfbGVuOiAlIiBHX0dVSU5UNjRfRk9STUFULAorICAgICAgICAg
ICAgICAgIHJlcS0+bHVuLCBwZXJpZl9xdWFsLCByZXEtPmluX2xlbik7CisKKyAgICBjZF9zY3Np
X2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9j
bWRfaW5xdWlyeV92cGQoQ2RTY3NpTFUgKmRldiwgQ2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAg
IHVpbnQ4X3QgKm91dGJ1ZiA9IHJlcS0+YnVmOworICAgIHVpbnQ4X3QgcGFnZV9jb2RlID0gcmVx
LT5jZGJbMl07CisgICAgaW50IGJ1ZmxlbiA9IDQ7CisgICAgaW50IHN0YXJ0ID0gNDsKKworICAg
IG91dGJ1ZlswXSA9IFRZUEVfUk9NOworICAgIG91dGJ1ZlsxXSA9IHBhZ2VfY29kZSA7IC8qIHRo
aXMgcGFnZSAqLworICAgIG91dGJ1ZlsyXSA9IDB4MDA7IC8qIHBhZ2UgbGVuZ3RoIE1TQiAqLwor
ICAgIG91dGJ1ZlszXSA9IDB4MDA7IC8qIHBhZ2UgbGVuZ3RoIExTQiwgdG8gd3JpdGUgbGF0ZXIg
Ki8KKworICAgIHN3aXRjaCAocGFnZV9jb2RlKSB7CisgICAgY2FzZSAweDAwOiAvKiBTdXBwb3J0
ZWQgcGFnZSBjb2RlcywgbWFuZGF0b3J5ICovCisgICAgeworICAgICAgICBvdXRidWZbYnVmbGVu
KytdID0gMHgwMDsgLy8gbGlzdCBvZiBzdXBwb3J0ZWQgcGFnZXMgKHRoaXMgcGFnZSkKKyAgICAg
ICAgaWYgKGRldi0+c2VyaWFsKSB7CisgICAgICAgICAgICBvdXRidWZbYnVmbGVuKytdID0gMHg4
MDsgLy8gdW5pdCBzZXJpYWwgbnVtYmVyCisgICAgICAgIH0KKyAgICAgICAgb3V0YnVmW2J1Zmxl
bisrXSA9IDB4ODM7IC8vIGRldmljZSBpZGVudGlmaWNhdGlvbgorCisgICAgICAgIFNQSUNFX0RF
QlVHKCJJbnF1aXJ5IEVWUERbU3VwcG9ydGVkIHBhZ2VzXSBsdW46JXUiCisgICAgICAgICAgICAg
ICAgICAgICIgcmVxX2xlbjogJSIgR19HVUlOVDY0X0ZPUk1BVCAiIHJlc3BfbGVuOiAlZCIsCisg
ICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuLCByZXEtPnJlcV9sZW4sIGJ1Zmxlbik7CisgICAg
ICAgIGJyZWFrOworICAgIH0KKyAgICBjYXNlIDB4ODA6IC8qIERldmljZSBzZXJpYWwgbnVtYmVy
LCBvcHRpb25hbCAqLworICAgIHsKKyAgICAgICAgaW50IHNlcmlhbF9sZW47CisKKyAgICAgICAg
c2VyaWFsX2xlbiA9IHN0cmxlbihkZXYtPnNlcmlhbCk7CisgICAgICAgIGlmIChzZXJpYWxfbGVu
ID4gMzYpIHsKKyAgICAgICAgICAgIHNlcmlhbF9sZW4gPSAzNjsKKyAgICAgICAgfQorICAgICAg
ICBtZW1jcHkob3V0YnVmK2J1ZmxlbiwgZGV2LT5zZXJpYWwsIHNlcmlhbF9sZW4pOworICAgICAg
ICBidWZsZW4gKz0gc2VyaWFsX2xlbjsKKworICAgICAgICBTUElDRV9ERUJVRygiSW5xdWlyeSBF
VlBEW1NlcmlhbCBudW1dIGx1bjoldSIKKyAgICAgICAgICAgICAgICAgICAgIiByZXFfbGVuOiAl
IiBHX0dVSU5UNjRfRk9STUFUICIgcmVzcF9sZW46ICVkIiwKKyAgICAgICAgICAgICAgICAgICAg
cmVxLT5sdW4sIHJlcS0+cmVxX2xlbiwgYnVmbGVuKTsKKyAgICAgICAgYnJlYWs7CisgICAgfQor
ICAgIGNhc2UgMHg4MzogLyogRGV2aWNlIGlkZW50aWZpY2F0aW9uIHBhZ2UsIG1hbmRhdG9yeSAq
LworICAgIHsKKyAgICAgICAgaW50IHNlcmlhbF9sZW4gPSBzdHJsZW4oZGV2LT5zZXJpYWwpOwor
ICAgICAgICBpbnQgbWF4X2xlbiA9IDIwOworCisgICAgICAgIGlmIChzZXJpYWxfbGVuID4gbWF4
X2xlbikgeworICAgICAgICAgICAgc2VyaWFsX2xlbiA9IG1heF9sZW47CisgICAgICAgIH0KKwor
ICAgICAgICBvdXRidWZbYnVmbGVuKytdID0gMHgyOyAvLyBBU0NJSQorICAgICAgICBvdXRidWZb
YnVmbGVuKytdID0gMDsgICAvLyBub3Qgb2ZmaWNpYWxseSBhc3NpZ25lZAorICAgICAgICBvdXRi
dWZbYnVmbGVuKytdID0gMDsgICAvLyByZXNlcnZlZAorICAgICAgICBvdXRidWZbYnVmbGVuKytd
ID0gc2VyaWFsX2xlbjsgLy8gbGVuZ3RoIG9mIGRhdGEgZm9sbG93aW5nCisKKyAgICAgICAgbWVt
Y3B5KG91dGJ1ZitidWZsZW4sIGRldi0+c2VyaWFsLCBzZXJpYWxfbGVuKTsKKyAgICAgICAgYnVm
bGVuICs9IHNlcmlhbF9sZW47CisKKyAgICAgICAgU1BJQ0VfREVCVUcoIklucXVpcnkgRVZQRFtE
ZXZpY2UgaWRdIGx1bjoldSIKKyAgICAgICAgICAgICAgICAgICAgIiByZXFfbGVuOiAlIiBHX0dV
SU5UNjRfRk9STUFUICIgcmVzcF9sZW46ICVkIiwKKyAgICAgICAgICAgICAgICAgICAgcmVxLT5s
dW4sIHJlcS0+cmVxX2xlbiwgYnVmbGVuKTsKKyAgICAgICAgYnJlYWs7CisgICAgfQorCisgICAg
ZGVmYXVsdDoKKyAgICAgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJl
cSwgJnNlbnNlX2NvZGVfSU5WQUxJRF9DREJfRklFTEQpOworICAgICAgICBTUElDRV9ERUJVRygi
aW5xdWlyeV9zdGFuZGFyZCwgbHVuOiV1IGludmFsaWQgcGFnZV9jb2RlOiAlMDJ4IiwKKyAgICAg
ICAgICAgICAgICAgICAgcmVxLT5sdW4sIChpbnQpcGFnZV9jb2RlKTsKKyAgICAgICAgcmV0dXJu
OworICAgIH0KKworICAgIC8qIGRvbmUgd2l0aCBFVlBEICovCisgICAgZ19hc3NlcnQoYnVmbGVu
IC0gc3RhcnQgPD0gMjU1KTsKKyAgICBvdXRidWZbM10gPSBidWZsZW4gLSBzdGFydDsgLyogcGFn
ZSBsZW5ndGggTFNCICovCisKKyAgICByZXEtPmluX2xlbiA9IGJ1ZmxlbjsKKyAgICBjZF9zY3Np
X2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworI2RlZmluZSBJTlFVSVJZX1NUQU5E
QVJEX0xFTl9NSU4gICAgICAgICAgICAzNgorI2RlZmluZSBJTlFVSVJZX1NUQU5EQVJEX0xFTiAg
ICAgICAgICAgICAgICA5NgorI2RlZmluZSBJTlFVSVJZX1NUQU5EQVJEX0xFTl9OT19WRVIgICAg
ICAgICA1NworCisjZGVmaW5lIFBFUklGX1FVQUxJRklFUl9DT05ORUNURUQgICAgICAgICAgIDB4
MDAKKyNkZWZpbmUgUEVSSUZfUVVBTElGSUVSX05PVF9DT05ORUNURUQgICAgICAgMHgwMQorI2Rl
ZmluZSBQRVJJRl9RVUFMSUZJRVJfVU5TVVBQT1JURUQgICAgICAgICAweDAzCisKKyNkZWZpbmUg
SU5RVUlSWV9SRU1PVkFCTEVfTUVESVVNICAgICAgICAgICAgMHg4MAorCisjZGVmaW5lIElOUVVJ
UllfVkVSU0lPTl9OT05FICAgICAgICAgICAgICAgIDB4MDAKKyNkZWZpbmUgSU5RVUlSWV9WRVJT
SU9OX1NQQzMgICAgICAgICAgICAgICAgMHgwNQorCisvKiBieXRlIDMgKi8KKyNkZWZpbmUgSU5R
VUlSWV9SRVNQX0hJU1VQICAgICAgICAgICAgICAgICAgKDB4MDEgPDwgNCkKKyNkZWZpbmUgSU5R
VUlSWV9SRVNQX05PUk1fQUNBICAgICAgICAgICAgICAgKDB4MDEgPDwgNSkKKyNkZWZpbmUgSU5R
VUlSWV9SRVNQX0RBVEFfRk9STUFUX1NQQzMgICAgICAgMHgwMgorCisjZGVmaW5lIElOUVVJUllf
VkVSU0lPTl9ERVNDX1NBTTIgICAgICAgICAgIDB4MDQwCisjZGVmaW5lIElOUVVJUllfVkVSU0lP
Tl9ERVNDX1NQQzMgICAgICAgICAgIDB4MzAwCisjZGVmaW5lIElOUVVJUllfVkVSU0lPTl9ERVND
X01NQzMgICAgICAgICAgIDB4MkEwCisjZGVmaW5lIElOUVVJUllfVkVSU0lPTl9ERVNDX1NCQzIg
ICAgICAgICAgIDB4MzIwCisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX2lucXVpcnlfc3RhbmRh
cmRfbm9fbHVuKENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSwKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IHBlcmlmX3F1YWwp
Cit7CisgICAgdWludDhfdCAqb3V0YnVmID0gcmVxLT5idWY7CisgICAgdWludDMyX3QgcmVzcF9s
ZW4gPSBJTlFVSVJZX1NUQU5EQVJEX0xFTl9NSU47CisKKyAgICBtZW1zZXQocmVxLT5idWYsIDAs
IElOUVVJUllfU1RBTkRBUkRfTEVOX01JTik7CisKKyAgICBvdXRidWZbMF0gPSAocGVyaWZfcXVh
bCA8PCA1KSB8IFRZUEVfUk9NOworICAgIG91dGJ1ZlsyXSA9IElOUVVJUllfVkVSU0lPTl9OT05F
OworICAgIG91dGJ1ZlszXSA9IElOUVVJUllfUkVTUF9EQVRBX0ZPUk1BVF9TUEMzOworCisgICAg
b3V0YnVmWzRdID0gcmVzcF9sZW4gLSA0OyAvKiBhZGRpdGlvbmFsIGxlbmd0aCwgYWZ0ZXIgaGVh
ZGVyICovCisKKyAgICByZXEtPmluX2xlbiA9IE1JTihyZXEtPnJlcV9sZW4sIHJlc3BfbGVuKTsK
KworICAgIFNQSUNFX0RFQlVHKCJpbnF1aXJ5X3N0YW5kYXJkLCB1bnN1cHBvcnRlZCBsdW46JXUg
cGVyaWZfcXVhbDoweCV4ICIKKyAgICAgICAgICAgICAgICAiaW5xdWlyeV9sZW46ICV1IHJlc3Bf
bGVuOiAlIiBHX0dVSU5UNjRfRk9STUFULAorICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBwZXJp
Zl9xdWFsLCByZXNwX2xlbiwgcmVxLT5pbl9sZW4pOworCisgICAgY2Rfc2NzaV9jbWRfY29tcGxl
dGVfZ29vZChkZXYsIHJlcSk7Cit9CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX2lucXVpcnlf
c3RhbmRhcmQoQ2RTY3NpTFUgKmRldiwgQ2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAgIHVpbnQ4
X3QgKm91dGJ1ZiA9IHJlcS0+YnVmOworICAgIHVpbnQzMl90IHJlc3BfbGVuID0KKyAgICAgICAg
KGRldi0+Y2xhaW1fdmVyc2lvbiA9PSAwKSA/IElOUVVJUllfU1RBTkRBUkRfTEVOX05PX1ZFUiA6
IElOUVVJUllfU1RBTkRBUkRfTEVOOworCisgICAgb3V0YnVmWzBdID0gKFBFUklGX1FVQUxJRklF
Ul9DT05ORUNURUQgPDwgNSkgfCBUWVBFX1JPTTsKKyAgICBvdXRidWZbMV0gPSAoZGV2LT5yZW1v
dmFibGUpID8gSU5RVUlSWV9SRU1PVkFCTEVfTUVESVVNIDogMDsKKyAgICBvdXRidWZbMl0gPSAo
ZGV2LT5jbGFpbV92ZXJzaW9uID09IDApID8gSU5RVUlSWV9WRVJTSU9OX05PTkUgOiBJTlFVSVJZ
X1ZFUlNJT05fU1BDMzsKKyAgICBvdXRidWZbM10gPSBJTlFVSVJZX1JFU1BfTk9STV9BQ0EgfCBJ
TlFVSVJZX1JFU1BfSElTVVAgfCBJTlFVSVJZX1JFU1BfREFUQV9GT1JNQVRfU1BDMzsKKworICAg
IG91dGJ1Zls0XSA9IHJlc3BfbGVuIC0gNDsgLyogYWRkaXRpb25hbCBsZW5ndGgsIGFmdGVyIGhl
YWRlciAqLworCisgICAgLyogKG91dGJ1Zls2LDddID0gMCkgbWVhbnMgYWxzbyB7QlF1ZT0wLENt
ZFF1ZT0wfSAtIG5vIHF1ZXVlaW5nIGF0IGFsbCAqLworCisgICAgc3RycGFkY3B5KChjaGFyICop
ICZvdXRidWZbOF0sIDgsIGRldi0+dmVuZG9yLCAnICcpOworICAgIHN0cnBhZGNweSgoY2hhciAq
KSAmb3V0YnVmWzE2XSwgMTYsIGRldi0+cHJvZHVjdCwgJyAnKTsKKyAgICBtZW1jcHkoJm91dGJ1
ZlszMl0sIGRldi0+dmVyc2lvbiwgTUlOKDQsIHN0cmxlbihkZXYtPnZlcnNpb24pKSk7CisKKyAg
ICBpZiAoZGV2LT5jbGFpbV92ZXJzaW9uID4gMCkgeworICAgICAgICAvKiBub3cgc3VwcG9ydGlu
ZyBvbmx5IDMgKi8KKyAgICAgICAgb3V0YnVmWzU4XSA9IChJTlFVSVJZX1ZFUlNJT05fREVTQ19T
QU0yID4+IDgpICYgMHhmZjsKKyAgICAgICAgb3V0YnVmWzU5XSA9IElOUVVJUllfVkVSU0lPTl9E
RVNDX1NBTTIgJiAweGZmOworCisgICAgICAgIG91dGJ1Zls2MF0gPSAoSU5RVUlSWV9WRVJTSU9O
X0RFU0NfU1BDMyA+PiA4KSAmIDB4ZmY7CisgICAgICAgIG91dGJ1Zls2MV0gPSBJTlFVSVJZX1ZF
UlNJT05fREVTQ19TUEMzICYgMHhmZjsKKworICAgICAgICBvdXRidWZbNjJdID0gKElOUVVJUllf
VkVSU0lPTl9ERVNDX01NQzMgPj4gOCkgJiAweGZmOworICAgICAgICBvdXRidWZbNjNdID0gSU5R
VUlSWV9WRVJTSU9OX0RFU0NfTU1DMyAmIDB4ZmY7CisKKyAgICAgICAgb3V0YnVmWzY0XSA9IChJ
TlFVSVJZX1ZFUlNJT05fREVTQ19TQkMyID4+IDgpICYgMHhmZjsKKyAgICAgICAgb3V0YnVmWzY1
XSA9IElOUVVJUllfVkVSU0lPTl9ERVNDX1NCQzIgJiAweGZmOworICAgIH0KKworICAgIHJlcS0+
aW5fbGVuID0gTUlOKHJlcS0+cmVxX2xlbiwgcmVzcF9sZW4pOworCisgICAgU1BJQ0VfREVCVUco
ImlucXVpcnlfc3RhbmRhcmQsIGx1bjoldSIKKyAgICAgICAgICAgICAgICAiIGlucXVpcnlfbGVu
OiAldSByZXNwX2xlbjogJSIgR19HVUlOVDY0X0ZPUk1BVCwKKyAgICAgICAgICAgICAgICByZXEt
Pmx1biwgcmVzcF9sZW4sIHJlcS0+aW5fbGVuKTsKKworICAgIGNkX3Njc2lfY21kX2NvbXBsZXRl
X2dvb2QoZGV2LCByZXEpOworfQorCisjZGVmaW5lIENEX0lOUVVJUllfRkxBR19FVlBEICAgICAg
ICAgICAgICAgIDB4MDEKKyNkZWZpbmUgQ0RfSU5RVUlSWV9GTEFHX0NNRF9EVCAgICAgICAgICAg
ICAgMHgwMgorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9pbnF1aXJ5KENkU2NzaUxVICpkZXYs
IENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICBnYm9vbGVhbiBldnBkLCBjbWRfZGF0YTsKKwor
ICAgIHJlcS0+eGZlcl9kaXIgPSBTQ1NJX1hGRVJfRlJPTV9ERVY7CisKKyAgICBldnBkID0gKHJl
cS0+Y2RiWzFdICYgQ0RfSU5RVUlSWV9GTEFHX0VWUEQpID8gVFJVRSA6IEZBTFNFOworICAgIGNt
ZF9kYXRhID0gKHJlcS0+Y2RiWzFdICYgQ0RfSU5RVUlSWV9GTEFHX0NNRF9EVCkgPyBUUlVFIDog
RkFMU0U7CisKKyAgICBpZiAoY21kX2RhdGEpIHsKKyAgICAgICAgU1BJQ0VfREVCVUcoImlucXVp
cnksIGx1bjoldSBDbWREVCBiaXQgc2V0IC0gdW5zdXBwb3J0ZWQsICIKKyAgICAgICAgICAgICAg
ICAgICAgImNkYlsxXToweCUwMnggY2RiWzFdOjB4JTAyeCIsCisgICAgICAgICAgICAgICAgICAg
IHJlcS0+bHVuLCAoaW50KXJlcS0+Y2RiWzFdLCAoaW50KXJlcS0+Y2RiWzJdKTsKKyAgICAgICAg
Y2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfSU5W
QUxJRF9DREJfRklFTEQpOworICAgICAgICByZXR1cm47CisgICAgfQorCisgICAgcmVxLT5yZXFf
bGVuID0gcmVxLT5jZGJbNF0gfCAocmVxLT5jZGJbM10gPDwgOCk7CisgICAgbWVtc2V0KHJlcS0+
YnVmLCAwLCByZXEtPnJlcV9sZW4pOworCisgICAgaWYgKGV2cGQpIHsgLyogZW5hYmxlIHZpdGFs
IHByb2R1Y3QgZGF0YSAqLworICAgICAgICBjZF9zY3NpX2NtZF9pbnF1aXJ5X3ZwZChkZXYsIHJl
cSk7CisgICAgfSBlbHNlIHsgLyogc3RhbmRhcmQgaW5xdWlyeSBkYXRhICovCisgICAgICAgIGlm
IChyZXEtPmNkYlsyXSAhPSAwKSB7CisgICAgICAgICAgICBTUElDRV9ERUJVRygiaW5xdWlyeV9z
dGFuZGFyZCwgbHVuOiV1IG5vbi16ZXJvIHBhZ2UgY29kZTogJTAyeCIsCisgICAgICAgICAgICAg
ICAgICAgICAgICByZXEtPmx1biwgKGludClyZXEtPmNkYlsyXSk7CisgICAgICAgICAgICBjZF9z
Y3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZBTElE
X0NEQl9GSUVMRCk7CisgICAgICAgICAgICByZXR1cm47CisgICAgICAgIH0KKyAgICAgICAgY2Rf
c2NzaV9jbWRfaW5xdWlyeV9zdGFuZGFyZChkZXYsIHJlcSk7CisgICAgfQorfQorCitzdGF0aWMg
dm9pZCBjZF9zY3NpX2NtZF9yZWFkX2NhcGFjaXR5KENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVl
c3QgKnJlcSkKK3sKKyAgICB1aW50MzJfdCBsYXN0X2JsayA9IGRldi0+bnVtX2Jsb2NrcyAtIDE7
CisgICAgdWludDMyX3QgYmxrX3NpemUgPSBkZXYtPmJsb2NrX3NpemU7CisgICAgdWludDMyX3Qg
Kmxhc3RfYmxrX291dCA9ICh1aW50MzJfdCAqKXJlcS0+YnVmOworICAgIHVpbnQzMl90ICpibGtf
c2l6ZV9vdXQgPSAodWludDMyX3QgKikocmVxLT5idWYgKyA0KTsKKworICAgIHJlcS0+eGZlcl9k
aXIgPSBTQ1NJX1hGRVJfRlJPTV9ERVY7CisgICAgcmVxLT5yZXFfbGVuID0gODsKKworICAgICps
YXN0X2Jsa19vdXQgPSBodG9iZTMyKGxhc3RfYmxrKTsKKyAgICAqYmxrX3NpemVfb3V0ID0gaHRv
YmUzMihibGtfc2l6ZSk7CisKKyAgICBTUElDRV9ERUJVRygiUmVhZCBjYXBhY2l0eSwgbHVuOiV1
IGxhc3RfYmxrOiAldSBibGtfc3o6ICV1IiwKKyAgICAgICAgICAgICAgICByZXEtPmx1biwgbGFz
dF9ibGssIGJsa19zaXplKTsKKworICAgIHJlcS0+aW5fbGVuID0gODsKKyAgICBjZF9zY3NpX2Nt
ZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworI2RlZmluZSBSRElfVFlQRV9TVEFOREFS
RCAgICAgICAgICAgMCAvKiBTdGFuZGFyZCBEaXNjIEluZm9ybWF0aW9uICovCisjZGVmaW5lIFJE
SV9UWVBFX1RSQUNLX1JFU09VUkNFUyAgICAxIC8qIFRyYWNrIFJlc291cmNlcyBJbmZvcm1hdGlv
biAqLworI2RlZmluZSBSRElfVFlQRV9QT1dfUkVTT1VSQ0VTICAgICAgMiAvKiBQT1cgUmVzb3Vy
Y2VzIEluZm9ybWF0aW9uICovCisKKyNkZWZpbmUgUkRJX1NUQU5EQVJEX0xFTiAgICAgICAgICAg
IDM0CisKKyNkZWZpbmUgUkRJX0VSQVpBQkxFICAgICAgICAgICAgICAgICgweDAxIDw8IDQpCisj
ZGVmaW5lIFJESV9OT05fRVJBWkFCTEUgICAgICAgICAgICAoMHgwMCA8PCA0KQorCisjZGVmaW5l
IFJESV9TRVNTSU9OX0VNUFRZICAgICAgICAgICAoMHgwMCA8PCAyKQorI2RlZmluZSBSRElfU0VT
U0lPTl9JTkNPTVBMRVRFICAgICAgKDB4MDEgPDwgMikKKyNkZWZpbmUgUkRJX1NFU1NJT05fREFN
QUdFRCAgICAgICAgICgweDAyIDw8IDIpCisjZGVmaW5lIFJESV9TRVNTSU9OX0NPTVBMRVRFICAg
ICAgICAoMHgwMyA8PCAyKQorCisjZGVmaW5lIFJESV9ESVNDX0VNUFRZICAgICAgICAgICAgICAw
eDAwCisjZGVmaW5lIFJESV9ESVNDX0lOQ09NUExFVEUgICAgICAgICAweDAxCisjZGVmaW5lIFJE
SV9ESVNDX0NPTVBMRVRFICAgICAgICAgICAweDAyCisjZGVmaW5lIFJESV9ESVNDX1JBTkRPTV9X
UiAgICAgICAgICAweDAzCisKKyNkZWZpbmUgUkRJX0RJU0NfUE1BX1RZUEVfQ0RfUk9NICAgIDB4
MDAKKyNkZWZpbmUgUkRJX0RJU0NfUE1BX1RZUEVfQ0RJICAgICAgIDB4MTAKKyNkZWZpbmUgUkRJ
X0RJU0NfUE1BX1RZUEVfRERDRCAgICAgIDB4MjAKKyNkZWZpbmUgUkRJX0RJU0NfUE1BX1RZUEVf
VU5ERUZJTkVEIDB4RkYKKworc3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRfZ2V0X3JlYWRfZGlzY19p
bmZvcm1hdGlvbihDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgdWlu
dDhfdCAqb3V0YnVmID0gcmVxLT5idWY7CisgICAgdWludDMyX3QgZGF0YV90eXBlOworICAgIHVp
bnQzMl90IGZpcnN0X3RyYWNrID0gMTsKKyAgICB1aW50MzJfdCBsYXN0X3RyYWNrID0gMTsKKyAg
ICB1aW50MzJfdCBudW1fc2Vzc2lvbnMgPSAxOworCisgICAgcmVxLT54ZmVyX2RpciA9IFNDU0lf
WEZFUl9GUk9NX0RFVjsKKworICAgIGRhdGFfdHlwZSA9IHJlcS0+Y2RiWzFdICYgMHg3OworICAg
IGlmIChkYXRhX3R5cGUgIT0gUkRJX1RZUEVfU1RBTkRBUkQpIHsKKyAgICAgICAgU1BJQ0VfREVC
VUcoInJlYWRfZGlzY19pbmZvcm1hdGlvbiwgbHVuOiV1IgorICAgICAgICAgICAgICAgICAgICAi
IHVuc3VwcG9ydGVkIGRhdGEgdHlwZTogJTAyeCIsCisgICAgICAgICAgICAgICAgICAgIHJlcS0+
bHVuLCBkYXRhX3R5cGUpOworICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25k
KGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZBTElEX0NEQl9GSUVMRCk7CisgICAgICAgIHJldHVy
bjsKKyAgICB9CisKKyAgICByZXEtPnJlcV9sZW4gPSAocmVxLT5jZGJbN10gPDwgOCkgfCByZXEt
PmNkYls4XTsKKyAgICByZXEtPmluX2xlbiA9IE1JTihyZXEtPnJlcV9sZW4sIFJESV9TVEFOREFS
RF9MRU4pOworCisgICAgbWVtc2V0KG91dGJ1ZiwgMCwgUkRJX1NUQU5EQVJEX0xFTik7CisgICAg
b3V0YnVmWzFdID0gUkRJX1NUQU5EQVJEX0xFTiAtIDI7IC8qIGxlbmd0aCBleGNsdWRpbmcgdGhl
IGNvdW50ZXIgaXRzZWxmICovCisgICAgb3V0YnVmWzJdID0gUkRJX05PTl9FUkFaQUJMRSB8IFJE
SV9TRVNTSU9OX0NPTVBMRVRFIHwgUkRJX0RJU0NfQ09NUExFVEU7CisgICAgb3V0YnVmWzNdID0g
Zmlyc3RfdHJhY2s7IC8qIG9uIGRpc2sgKi8KKyAgICBvdXRidWZbNF0gPSBudW1fc2Vzc2lvbnMg
JiAweGZmOyAvKiBsc2IgKi8KKyAgICBvdXRidWZbNV0gPSBmaXJzdF90cmFjayAmIDB4ZmY7IC8q
IGluIGxhc3Qgc2Vzc29uLCBsc2IgKi8KKyAgICBvdXRidWZbNl0gPSBsYXN0X3RyYWNrICYgMHhm
ZjsgLyogaW4gbGFzdCBzZXNzb24sIGxzYiAqLworICAgIG91dGJ1Zls4XSA9IFJESV9ESVNDX1BN
QV9UWVBFX0NEX1JPTTsKKyAgICBvdXRidWZbOV0gPSAobnVtX3Nlc3Npb25zID4+IDgpICYgMHhm
ZjsgLyogbXNiICovCisgICAgb3V0YnVmWzEwXSA9IChmaXJzdF90cmFjayA+PiA4KSAmIDB4ZmY7
IC8qIGluIGxhc3Qgc2Vzc29uLCBsc2IgKi8KKyAgICBvdXRidWZbMTFdID0gKGxhc3RfdHJhY2sg
Pj4gOCkgJiAweGZmOyAvKiBpbiBsYXN0IHNlc3NvbiwgbHNiICovCisKKyAgICBTUElDRV9ERUJV
RygicmVhZF9kaXNjX2luZm9ybWF0aW9uLCBsdW46JXUgbGVuOiAlIiBHX0dVSU5UNjRfRk9STUFU
LAorICAgICAgICAgICAgICAgIHJlcS0+bHVuLCByZXEtPmluX2xlbik7CisKKyAgICBjZF9zY3Np
X2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworI2RlZmluZSBSVElfQUREUl9UWVBF
X0xCQSAgICAgICAgICAgMHgwMAorI2RlZmluZSBSVElfQUREUl9UWVBFX1RSQUNLX05VTSAgICAg
MHgwMQorI2RlZmluZSBSVElfQUREUl9UWVBFX1NFU1NJT05fTlVNICAgMHgwMgorCisjZGVmaW5l
IFJUSV9UUkFDS19OVU1fTEVBRF9JTiAgICAgICAweDAwCisjZGVmaW5lIFJUSV9UUkFDS19OVU1f
SU5WSVNJQkxFICAgICAweGZmCisKKyNkZWZpbmUgVElCX0xFTiAgICAgICAgICAgICAgICAgICAg
IDB4MzYKKworI2RlZmluZSBUSUJfVFJBQ0tfTU9ERV9DRCAgICAgICAgICAgMHgwNAorI2RlZmlu
ZSBUSUJfREFUQV9NT0RFX0lTT18xMDE0OSAgICAgMHgwMQorCisjZGVmaW5lIFRJQl9MUkFfVkFM
SUQgICAgICAgICAgICAgICAoMHgwMSA8PCAxKQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9n
ZXRfcmVhZF90cmFja19pbmZvcm1hdGlvbihDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpy
ZXEpCit7CisgICAgdWludDhfdCAqb3V0YnVmID0gcmVxLT5idWY7CisgICAgdWludDMyX3QgdHJh
Y2tfc2l6ZSA9IGRldi0+bnVtX2Jsb2NrczsKKyAgICB1aW50MzJfdCBsYXN0X2FkZHIgPSB0cmFj
a19zaXplIC0gMTsKKyAgICB1aW50MzJfdCB0cmFja19udW0gPSAxOworICAgIHVpbnQzMl90IHNl
c3Npb25fbnVtID0gMTsKKyAgICB1aW50MzJfdCBhZGRyX3R5cGU7CisgICAgdWludDMyX3QgYWRk
cl9udW07CisKKyAgICByZXEtPnhmZXJfZGlyID0gU0NTSV9YRkVSX0ZST01fREVWOworCisgICAg
YWRkcl90eXBlID0gcmVxLT5jZGJbMV0gJiAweDM7CisgICAgYWRkcl9udW0gPSAocmVxLT5jZGJb
Ml0gPDwgMjQpIHwgKHJlcS0+Y2RiWzNdIDw8IDE2KSB8CisgICAgICAgICAgICAgICAocmVxLT5j
ZGJbNF0gPDwgOCkgfCByZXEtPmNkYls1XTsKKworICAgIHN3aXRjaCAoYWRkcl90eXBlKSB7Cisg
ICAgY2FzZSBSVElfQUREUl9UWVBFX0xCQToKKyAgICAgICAgaWYgKGFkZHJfbnVtID4gbGFzdF9h
ZGRyKSB7CisgICAgICAgICAgICBTUElDRV9ERUJVRygicmVhZF90cmFja19pbmZvcm1hdGlvbiwg
bHVuOiV1IgorICAgICAgICAgICAgICAgICAgICAgICAgIiBhZGRyX3R5cGUgTEJBOiAldSIKKyAg
ICAgICAgICAgICAgICAgICAgICAgICIgaW52YWxpZCBMQkE6ICV1IiwKKyAgICAgICAgICAgICAg
ICAgICAgICAgIHJlcS0+bHVuLCBhZGRyX3R5cGUsIGFkZHJfbnVtKTsKKyAgICAgICAgICAgIGNk
X3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX0lOVkFM
SURfQ0RCX0ZJRUxEKTsKKyAgICAgICAgICAgIHJldHVybjsKKyAgICAgICAgfQorICAgICAgICBi
cmVhazsKKyAgICBjYXNlIFJUSV9BRERSX1RZUEVfVFJBQ0tfTlVNOgorICAgICAgICBpZiAoYWRk
cl9udW0gIT0gdHJhY2tfbnVtKSB7CisgICAgICAgICAgICBTUElDRV9ERUJVRygicmVhZF90cmFj
a19pbmZvcm1hdGlvbiwgbHVuOiV1IgorICAgICAgICAgICAgICAgICAgICAgICAgIiBhZGRyX3R5
cGUgdHJhY2s6ICV1IgorICAgICAgICAgICAgICAgICAgICAgICAgIiBpbnZhbGlkIHRyYWNrOiAl
dSIsCisgICAgICAgICAgICAgICAgICAgICAgICByZXEtPmx1biwgYWRkcl90eXBlLCBhZGRyX251
bSk7CisgICAgICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVx
LCAmc2Vuc2VfY29kZV9JTlZBTElEX0NEQl9GSUVMRCk7CisgICAgICAgICAgICByZXR1cm47Cisg
ICAgICAgIH0KKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBSVElfQUREUl9UWVBFX1NFU1NJT05f
TlVNOgorICAgICAgICBpZiAoYWRkcl9udW0gIT0gc2Vzc2lvbl9udW0pIHsKKyAgICAgICAgICAg
IFNQSUNFX0RFQlVHKCJyZWFkX3RyYWNrX2luZm9ybWF0aW9uLCBsdW46JXUiCisgICAgICAgICAg
ICAgICAgICAgICAgICAiIGFkZHJfdHlwZSBzZXNzaW9uOiAldSIKKyAgICAgICAgICAgICAgICAg
ICAgICAgICIgaW52YWxpZCBzZXNzaW9uOiAldSIsCisgICAgICAgICAgICAgICAgICAgICAgICBy
ZXEtPmx1biwgYWRkcl90eXBlLCBhZGRyX251bSk7CisgICAgICAgICAgICBjZF9zY3NpX2NtZF9j
b21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZBTElEX0NEQl9GSUVM
RCk7CisgICAgICAgICAgICByZXR1cm47CisgICAgICAgIH0KKyAgICAgICAgYnJlYWs7CisgICAg
ZGVmYXVsdDoKKyAgICAgICAgU1BJQ0VfREVCVUcoInJlYWRfdHJhY2tfaW5mb3JtYXRpb24sIGx1
bjoldSIKKyAgICAgICAgICAgICAgICAgICAgIiBpbnZhbGlkIGFkZHJfdHlwZTogJXUiCisgICAg
ICAgICAgICAgICAgICAgICIgYWRkcl9udW06ICV1IiwKKyAgICAgICAgICAgICAgICAgICAgcmVx
LT5sdW4sIGFkZHJfdHlwZSwgYWRkcl9udW0pOworICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0
ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZBTElEX0NEQl9GSUVMRCk7Cisg
ICAgICAgIHJldHVybjsKKyAgICB9CisKKyAgICByZXEtPnJlcV9sZW4gPSAocmVxLT5jZGJbN10g
PDwgOCkgfCByZXEtPmNkYls4XTsKKyAgICByZXEtPmluX2xlbiA9IE1JTihyZXEtPnJlcV9sZW4s
IFRJQl9MRU4pOworCisgICAgbWVtc2V0KG91dGJ1ZiwgMCwgVElCX0xFTik7CisgICAgb3V0YnVm
WzFdID0gVElCX0xFTiAtIDI7CisgICAgb3V0YnVmWzJdID0gc2Vzc2lvbl9udW07CisgICAgb3V0
YnVmWzNdID0gdHJhY2tfbnVtOworICAgIG91dGJ1Zls1XSA9IFRJQl9UUkFDS19NT0RFX0NEICYg
MHgwZjsKKyAgICBvdXRidWZbNl0gPSBUSUJfREFUQV9NT0RFX0lTT18xMDE0OSAmIDB4MGY7Cisg
ICAgb3V0YnVmWzddID0gVElCX0xSQV9WQUxJRDsKKworICAgIC8qIFRyYWNrIHNpemUgKi8KKyAg
ICBvdXRidWZbMjRdID0gKHRyYWNrX3NpemUgPj4gMjQpICYgMHhmZjsKKyAgICBvdXRidWZbMjVd
ID0gKHRyYWNrX3NpemUgPj4gMTYpICYgMHhmZjsKKyAgICBvdXRidWZbMjZdID0gKHRyYWNrX3Np
emUgPj4gOCkgJiAweGZmOworICAgIG91dGJ1ZlsyN10gPSAodHJhY2tfc2l6ZSkgJiAweGZmOwor
CisgICAgLyogTGFzdCByZWNvcmRlZCBhZGRyZXNzICovCisgICAgb3V0YnVmWzI4XSA9IChsYXN0
X2FkZHIgPj4gMjQpICYgMHhmZjsKKyAgICBvdXRidWZbMjldID0gKGxhc3RfYWRkciA+PiAxNikg
JiAweGZmOworICAgIG91dGJ1ZlszMF0gPSAobGFzdF9hZGRyID4+IDgpICYgMHhmZjsKKyAgICBv
dXRidWZbMzFdID0gKGxhc3RfYWRkcikgJiAweGZmOworCisgICAgU1BJQ0VfREVCVUcoInJlYWRf
dHJhY2tfaW5mb3JtYXRpb24sIGx1bjoldSIKKyAgICAgICAgICAgICAgICAiYWRkcl90eXBlOiAl
dSBhZGRyX251bTogJXUiLAorICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBhZGRyX3R5cGUsIGFk
ZHJfbnVtKTsKKworICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2LCByZXEpOworfQor
CisjZGVmaW5lIFJFQURfVE9DX1RSQUNLX0RFU0NfTEVOICAgICA4CisjZGVmaW5lIFJFQURfVE9D
X1JFU1BfTEVOICAgICAgICAgICAoNCArIDIqUkVBRF9UT0NfVFJBQ0tfREVTQ19MRU4pCisKK3N0
YXRpYyB2b2lkIGNkX3Njc2lfY21kX3JlYWRfdG9jKENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVl
c3QgKnJlcSkKK3sKKyAgICB1aW50OF90ICpvdXRidWYgPSByZXEtPmJ1ZjsKKyAgICB1aW50MzJf
dCBtc2YsIGZvcm1hdCwgdHJhY2tfbnVtOworICAgIHVpbnQzMl90IGxhc3RfYmxrID0gZGV2LT5u
dW1fYmxvY2tzIC0gMTsKKworICAgIHJlcS0+eGZlcl9kaXIgPSBTQ1NJX1hGRVJfRlJPTV9ERVY7
CisKKyAgICBtc2YgPSAocmVxLT5jZGJbMV0gPj4gMSkgJiAweDE7CisgICAgZm9ybWF0ID0gcmVx
LT5jZGJbMl0gJiAweGY7CisgICAgdHJhY2tfbnVtID0gcmVxLT5jZGJbNl07CisKKyAgICByZXEt
PnJlcV9sZW4gPSAocmVxLT5jZGJbN10gPDwgOCkgfCByZXEtPmNkYls4XTsKKyAgICByZXEtPmlu
X2xlbiA9IE1JTihyZXEtPnJlcV9sZW4sIFJFQURfVE9DX1JFU1BfTEVOKTsKKworICAgIG1lbXNl
dChvdXRidWYsIDAsIFJFQURfVE9DX1JFU1BfTEVOKTsKKyAgICBvdXRidWZbMV0gPSBSRUFEX1RP
Q19SRVNQX0xFTiAtIDI7IC8qIGxlbmd0aCBleGNsdWRpbmcgdGhlIGNvdW50ZXIgaXRzZWxmICov
CisgICAgb3V0YnVmWzJdID0gMTsgLyogZmlyc3QgdHJhY2svc2Vzc2lvbiAqLworICAgIG91dGJ1
ZlszXSA9IDE7IC8qIGxhc3QgdHJhY2svc2Vzc2lvbiAqLworCisgICAgb3V0YnVmWzVdID0gMHgw
NDsgLyogRGF0YSBDRCwgbm8gUS1zdWJjaGFubmVsICovCisgICAgb3V0YnVmWzZdID0gMHgwMTsg
LyogVHJhY2sgbnVtYmVyICovCisgICAgb3V0YnVmWzEwXSA9IG1zZiA/IDB4MDIgOiAweDA7CisK
KyAgICBvdXRidWZbMTNdID0gMHgwNDsgLyogRGF0YSBDRCwgbm8gUS1zdWJjaGFubmVsICovCisg
ICAgb3V0YnVmWzE0XSA9IDB4YWE7IC8qIFRyYWNrIG51bWJlciAqLworICAgIGlmIChtc2YpIHsK
KyAgICAgICAgbGFzdF9ibGsgPSAweGZmMzAwMDAwOworICAgIH0KKyAgICBvdXRidWZbMTZdID0g
bGFzdF9ibGsgPj4gMjQ7CisgICAgb3V0YnVmWzE3XSA9IGxhc3RfYmxrID4+IDE2OworICAgIG91
dGJ1ZlsxOF0gPSBsYXN0X2JsayA+PiA4OworICAgIG91dGJ1ZlsxOV0gPSBsYXN0X2JsazsKKwor
ICAgIFNQSUNFX0RFQlVHKCJyZWFkX3RvYywgbHVuOiV1IGxlbjogJSIgR19HVUlOVDY0X0ZPUk1B
VAorICAgICAgICAgICAgICAgICIgbXNmOiAleCBmb3JtYXQ6IDB4JTAyeCB0cmFjay9zZXNzaW9u
OiAweCUwMngiLAorICAgICAgICAgICAgICAgIHJlcS0+bHVuLCByZXEtPmluX2xlbiwgbXNmLCBm
b3JtYXQsIHRyYWNrX251bSk7CisKKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwg
cmVxKTsKK30KKworI2RlZmluZSBDRF9NT0RFX1BBUkFNXzZfTEVOX0hFQURFUiAgICAgICAgICAg
ICAgNAorI2RlZmluZSBDRF9NT0RFX1BBUkFNXzEwX0xFTl9IRUFERVIgICAgICAgICAgICAgOAor
CisjZGVmaW5lIENEX01PREVfUEFHRV9MRU5fUldfRVJST1IgICAgICAgICAgICAgICAxMgorCitz
dGF0aWMgdWludDMyX3QgY2Rfc2NzaV9hZGRfbW9kZV9wYWdlX3J3X2Vycm9yX3JlY292ZXJ5KENk
U2NzaUxVICpkZXYsIHVpbnQ4X3QgKm91dGJ1ZikKK3sKKyAgICB1aW50MzJfdCBwYWdlX2xlbiA9
IENEX01PREVfUEFHRV9MRU5fUldfRVJST1I7CisKKyAgICBvdXRidWZbMF0gPSBNT0RFX1BBR0Vf
Ul9XX0VSUk9SOworICAgIG91dGJ1ZlsxXSA9IENEX01PREVfUEFHRV9MRU5fUldfRVJST1IgLSAy
OworICAgIG91dGJ1ZlszXSA9IDE7IC8qIHJlYWQgcmV0cnkgY291bnQgKi8KKworICAgIHJldHVy
biBwYWdlX2xlbjsKK30KKworI2RlZmluZSBDRF9NT0RFX1BBR0VfTEVOX1BPV0VSICAgICAgICAg
ICAgICAgICAgMTIKKworc3RhdGljIHVpbnQzMl90IGNkX3Njc2lfYWRkX21vZGVfcGFnZV9wb3dl
cl9jb25kaXRpb24oQ2RTY3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVmKQoreworICAgIHVpbnQz
Ml90IHBhZ2VfbGVuID0gQ0RfTU9ERV9QQUdFX0xFTl9QT1dFUjsKKworICAgIG91dGJ1ZlswXSA9
IE1PREVfUEFHRV9QT1dFUjsKKyAgICBvdXRidWZbMV0gPSBDRF9NT0RFX1BBR0VfTEVOX1BPV0VS
IC0gMjsKKworICAgIHJldHVybiBwYWdlX2xlbjsKK30KKworI2RlZmluZSBDRF9NT0RFX1BBR0Vf
TEVOX0ZBVUxUX0ZBSUwgICAgICAgICAgICAgMTIKKyNkZWZpbmUgQ0RfTU9ERV9QQUdFX0ZBVUxU
X0ZBSUxfRkxBR19QRVJGICAgICAgIDB4ODAKKworc3RhdGljIHVpbnQzMl90IGNkX3Njc2lfYWRk
X21vZGVfcGFnZV9mYXVsdF9yZXBvcnRpbmcoQ2RTY3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVm
KQoreworICAgIHVpbnQzMl90IHBhZ2VfbGVuID0gQ0RfTU9ERV9QQUdFX0xFTl9GQVVMVF9GQUlM
OworCisgICAgb3V0YnVmWzBdID0gTU9ERV9QQUdFX0ZBVUxUX0ZBSUw7CisgICAgb3V0YnVmWzFd
ID0gQ0RfTU9ERV9QQUdFX0xFTl9GQVVMVF9GQUlMIC0gMjsKKyAgICBvdXRidWZbMl0gfD0gQ0Rf
TU9ERV9QQUdFX0ZBVUxUX0ZBSUxfRkxBR19QRVJGOworCisgICAgcmV0dXJuIHBhZ2VfbGVuOwor
fQorCisjZGVmaW5lIENEX01PREVfUEFHRV9MRU5fQ0FQU19NRUNIX1NUQVRVU19STyAgICAyNgor
LyogYnl0ZSAyICovCisjZGVmaW5lIENEX01PREVfUEFHRV9DQVBTX0NEX1JfUkVBRCAgICAgICAg
ICAgICAweDAxCisjZGVmaW5lIENEX01PREVfUEFHRV9DQVBTX0NEX1JXX1JFQUQgICAgICAgICAg
ICAoMHgwMSA8PCAxKQorI2RlZmluZSBDRF9NT0RFX1BBR0VfQ0FQU19EVkRfUk9NX1JFQUQgICAg
ICAgICAgKDB4MDEgPDwgMykKKyNkZWZpbmUgQ0RfTU9ERV9QQUdFX0NBUFNfRFZEX1JfUkVBRCAg
ICAgICAgICAgICgweDAxIDw8IDQpCisjZGVmaW5lIENEX01PREVfUEFHRV9DQVBTX0RWRF9SQU1f
UkVBRCAgICAgICAgICAoMHgwMSA8PCA1KQorLyogYnl0ZSA2ICovCisjZGVmaW5lIENEX01PREVf
UEFHRV9DQVBTX0xPQ0tfU1VQUE9SVCAgICAgICAgICAoMHgwMSkKKyNkZWZpbmUgQ0RfTU9ERV9Q
QUdFX0NBUFNfTE9DS19TVEFURSAgICAgICAgICAgICgweDAxIDw8IDEpCisjZGVmaW5lIENEX01P
REVfUEFHRV9DQVBTX1BSRVZFTlRfSlVNUEVSICAgICAgICAoMHgwMSA8PCAyKQorI2RlZmluZSBD
RF9NT0RFX1BBR0VfQ0FQU19FSkVDVCAgICAgICAgICAgICAgICAgKDB4MDEgPDwgMykKKyNkZWZp
bmUgQ0RfTU9ERV9QQUdFX0NBUFNfTE9BRElOR19UUkFZICAgICAgICAgICgweDAxIDw8IDUpCisK
K3N0YXRpYyB1aW50MzJfdCBjZF9zY3NpX2FkZF9tb2RlX3BhZ2VfY2Fwc19tZWNoX3N0YXR1cyhD
ZFNjc2lMVSAqZGV2LCB1aW50OF90ICpvdXRidWYpCit7CisgICAgdWludDMyX3QgcGFnZV9sZW4g
PSBDRF9NT0RFX1BBR0VfTEVOX0NBUFNfTUVDSF9TVEFUVVNfUk87IC8qIG5vIHdyaXRlICovCisK
KyAgICBvdXRidWZbMF0gPSBNT0RFX1BBR0VfQ0FQU19NRUNIX1NUQVRVUzsKKyAgICBvdXRidWZb
MV0gPSBwYWdlX2xlbjsKKyAgICBvdXRidWZbMl0gPSBDRF9NT0RFX1BBR0VfQ0FQU19DRF9SX1JF
QUQgfCBDRF9NT0RFX1BBR0VfQ0FQU19DRF9SV19SRUFEIHwKKyAgICAgICAgICAgICAgICBDRF9N
T0RFX1BBR0VfQ0FQU19EVkRfUk9NX1JFQUQgfCBDRF9NT0RFX1BBR0VfQ0FQU19EVkRfUl9SRUFE
IHwKKyAgICAgICAgICAgICAgICBDRF9NT0RFX1BBR0VfQ0FQU19EVkRfUkFNX1JFQUQ7CisgICAg
b3V0YnVmWzZdID0gQ0RfTU9ERV9QQUdFX0NBUFNfTE9BRElOR19UUkFZIHwgQ0RfTU9ERV9QQUdF
X0NBUFNfRUpFQ1QgfAorICAgICAgICAgICAgICAgIENEX01PREVfUEFHRV9DQVBTX0xPQ0tfU1VQ
UE9SVDsKKyAgICBpZiAoZGV2LT5wcmV2ZW50X21lZGlhX3JlbW92YWwpIHsKKyAgICAgICAgb3V0
YnVmWzZdIHw9IENEX01PREVfUEFHRV9DQVBTX0xPQ0tfU1RBVEU7CisgICAgfQorCisgICAgcmV0
dXJuIHBhZ2VfbGVuOworfQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9tb2RlX3NlbnNlXzEw
KENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICB1aW50OF90ICpvdXRi
dWYgPSByZXEtPmJ1ZjsKKyAgICBpbnQgbG9uZ19sYmEsIGRiZCwgcGFnZSwgc3ViX3BhZ2UsIHBj
OworICAgIHVpbnQzMl90IHJlc3BfbGVuID0gQ0RfTU9ERV9QQVJBTV8xMF9MRU5fSEVBREVSOwor
CisgICAgcmVxLT54ZmVyX2RpciA9IFNDU0lfWEZFUl9GUk9NX0RFVjsKKworICAgIGxvbmdfbGJh
ID0gKHJlcS0+Y2RiWzFdID4+IDQpICYgMHgxOworICAgIGRiZCA9IChyZXEtPmNkYlsxXSA+PiAz
KSAmIDB4MTsKKyAgICBwYWdlID0gcmVxLT5jZGJbMl0gJiAweDNmOworICAgIHBjID0gcmVxLT5j
ZGJbMl0gPj4gNjsKKyAgICBzdWJfcGFnZSA9IHJlcS0+Y2RiWzNdOworCisgICAgcmVxLT5yZXFf
bGVuID0gKHJlcS0+Y2RiWzddIDw8IDgpIHwgcmVxLT5jZGJbOF07CisKKyAgICBtZW1zZXQob3V0
YnVmLCAwLCByZXEtPnJlcV9sZW4pOworICAgIG91dGJ1ZlsyXSA9ICAwOyAvKiBtZWRpdW0gdHlw
ZSAqLworCisgICAgc3dpdGNoIChwYWdlKSB7CisgICAgY2FzZSBNT0RFX1BBR0VfUl9XX0VSUk9S
OgorICAgICAgICAvKiBSZWFkL1dyaXRlIEVycm9yIFJlY292ZXJ5ICovCisgICAgICAgIHJlc3Bf
bGVuICs9IGNkX3Njc2lfYWRkX21vZGVfcGFnZV9yd19lcnJvcl9yZWNvdmVyeShkZXYsIG91dGJ1
ZiArIHJlc3BfbGVuKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBNT0RFX1BBR0VfUE9XRVI6
CisgICAgICAgIC8qIFBvd2VyIENvbmRpc3Rpb25zICovCisgICAgICAgIHJlc3BfbGVuICs9IGNk
X3Njc2lfYWRkX21vZGVfcGFnZV9wb3dlcl9jb25kaXRpb24oZGV2LCBvdXRidWYgKyByZXNwX2xl
bik7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgTU9ERV9QQUdFX0ZBVUxUX0ZBSUw6CisgICAg
ICAgIC8qIEZhdWx0IC8gRmFpbHVyZSBSZXBvcnRpbmcgQ29udHJvbCAqLworICAgICAgICByZXNw
X2xlbiArPSBjZF9zY3NpX2FkZF9tb2RlX3BhZ2VfZmF1bHRfcmVwb3J0aW5nKGRldiwgb3V0YnVm
ICsgcmVzcF9sZW4pOworICAgICAgICBicmVhazsKKyAgICBjYXNlIE1PREVfUEFHRV9DQVBTX01F
Q0hfU1RBVFVTOgorICAgICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9tb2RlX3BhZ2VfY2Fw
c19tZWNoX3N0YXR1cyhkZXYsIG91dGJ1ZiArIHJlc3BfbGVuKTsKKyAgICAgICAgYnJlYWs7CisK
KyAgICAvKiBub3QgaW1wbGVtZW50ZWQgKi8KKyAgICBjYXNlIE1PREVfUEFHRV9XUklURV9QQVJB
TUVURVI6IC8qIFdyaXRlciBQYXJhbWV0ZXJzICovCisgICAgY2FzZSBNT0RFX1BBR0VfTVJXOgor
ICAgIGNhc2UgTU9ERV9QQUdFX01SV19WRU5ET1I6IC8qIE1SVyAoTW91bnQgUmFpbmllciBSZS13
cml0YWJsZSBEaXNrcyAqLworICAgIGNhc2UgTU9ERV9QQUdFX0NEX0RFVklDRTogLyogQ0QgRGV2
aWNlIHBhcmFtZXRlcnMgKi8KKyAgICBjYXNlIE1PREVfUEFHRV9UT19QUk9URUNUOiAvKiBUaW1l
LW91dCBhbmQgUHJvdGVjdCAqLworICAgIGRlZmF1bHQ6CisgICAgICAgIFNQSUNFX0RFQlVHKCJt
b2RlX3NlbnNlXzEwLCBsdW46JXUiCisgICAgICAgICAgICAgICAgICAgICIgcGFnZSAweCV4IG5v
dCBpbXBsZW1lbnRlZCIsCisgICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuLCAodW5zaWduZWQp
cGFnZSk7CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEs
ICZzZW5zZV9jb2RlX0lOVkFMSURfQ0RCX0ZJRUxEKTsKKyAgICAgICAgcmV0dXJuOworICAgIH0K
KworICAgIG91dGJ1ZlswXSA9ICgocmVzcF9sZW4gLSAyKSA+PiA4KSAmIDB4ZmY7CisgICAgb3V0
YnVmWzFdID0gKHJlc3BfbGVuIC0gMikgJiAweGZmOworCisgICAgcmVxLT5pbl9sZW4gPSBNSU4o
cmVxLT5yZXFfbGVuLCByZXNwX2xlbik7CisKKyAgICBTUElDRV9ERUJVRygibW9kZV9zZW5zZV8x
MCwgbHVuOiV1IgorICAgICAgICAgICAgICAgICIgbG9uZ19sYmEgJWQsIGRiZCAlZCwgcGFnZSAl
ZCwgc3ViX3BhZ2UgJWQsIHBjICVkOyAiCisgICAgICAgICAgICAgICAgInJlc3BfbGVuICV1IiwK
KyAgICAgICAgICAgICAgICByZXEtPmx1biwgbG9uZ19sYmEsIGRiZCwgcGFnZSwgc3ViX3BhZ2Us
IHBjLCByZXNwX2xlbik7CisKKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVx
KTsKK30KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9jbWRfbW9kZV9zZWxlY3RfNihDZFNjc2lMVSAq
ZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgdWludDhfdCAqYmxvY2tfZGVzY19kYXRh
LCAqbW9kZV9kYXRhOworICAgIHVpbnQzMl90IHBhZ2VfZm9ybWF0LCBzYXZlX3BhZ2VzLCBsaXN0
X2xlbjsgLyogY2RiICovCisgICAgdWludDMyX3QgbnVtX2Jsb2NrcyA9IDAsIGJsb2NrX2xlbiA9
IDA7IC8qIGJsb2NrIGRlc2NyaXB0b3IgKi8KKyAgICB1aW50MzJfdCBtb2RlX2xlbiwgbWVkaXVt
X3R5cGUsIGRldl9wYXJhbSwgYmxvY2tfZGVzY19sZW47IC8qIG1vZGUgcGFyYW0gaGVhZGVyICov
CisgICAgdWludDMyX3QgcGFnZV9udW0gPSAwLCBwYWdlX2xlbiA9IDA7IC8qIG1vZGUgcGFnZSAq
LworCisgICAgcGFnZV9mb3JtYXQgPSAocmVxLT5jZGJbMV0gPj4gNCkgJiAweDE7CisgICAgc2F2
ZV9wYWdlcyA9IHJlcS0+Y2RiWzFdICYgMHgxOworICAgIGxpc3RfbGVuID0gcmVxLT5jZGJbNF07
CisKKyAgICBpZiAobGlzdF9sZW4gPiByZXEtPmJ1Zl9sZW4pIHsKKyAgICAgICAgU1BJQ0VfREVC
VUcoIm1vZGVfc2VsZWN0XzYsIGx1bjoldSIKKyAgICAgICAgICAgICAgICAgICAgIiBwZjoldSBz
cDoldSIKKyAgICAgICAgICAgICAgICAgICAgIiBsaXN0X2xlbjoldSBleGNlZWRzIGRhdGFfbGVu
OiV1IiwKKyAgICAgICAgICAgICAgICAgICAgcmVxLT5sdW4sIHBhZ2VfZm9ybWF0LCBzYXZlX3Bh
Z2VzLCBsaXN0X2xlbiwgcmVxLT5idWZfbGVuKTsKKyAgICAgICAgY2Rfc2NzaV9jbWRfY29tcGxl
dGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfSU5WQUxJRF9QQVJBTV9MRU4pOwor
ICAgICAgICByZXR1cm47CisgICAgfQorCisgICAgbW9kZV9sZW4gPSByZXEtPmJ1ZlswXTsKKyAg
ICBtZWRpdW1fdHlwZSA9IHJlcS0+YnVmWzFdOworICAgIGRldl9wYXJhbSA9IHJlcS0+YnVmWzJd
OworICAgIGJsb2NrX2Rlc2NfbGVuID0gcmVxLT5idWZbM107CisKKyAgICBpZiAoYmxvY2tfZGVz
Y19sZW4pIHsKKyAgICAgICAgYmxvY2tfZGVzY19kYXRhID0gJnJlcS0+YnVmW0NEX01PREVfUEFS
QU1fNl9MRU5fSEVBREVSXTsKKyAgICAgICAgbnVtX2Jsb2NrcyA9IChibG9ja19kZXNjX2RhdGFb
M10gPDwgMTYpIHwgKGJsb2NrX2Rlc2NfZGF0YVsyXSA8PCA4KSB8IGJsb2NrX2Rlc2NfZGF0YVsz
XTsKKyAgICAgICAgYmxvY2tfbGVuID0gKGJsb2NrX2Rlc2NfZGF0YVs1XSA8PCAxNikgfCAoYmxv
Y2tfZGVzY19kYXRhWzZdIDw8IDgpIHwgYmxvY2tfZGVzY19kYXRhWzddOworICAgIH0KKworICAg
IGlmIChtb2RlX2xlbikgeworICAgICAgICBtb2RlX2RhdGEgPSAmcmVxLT5idWZbQ0RfTU9ERV9Q
QVJBTV82X0xFTl9IRUFERVJdOworICAgICAgICBpZiAoYmxvY2tfZGVzY19sZW4pIHsKKyAgICAg
ICAgICAgIG1vZGVfZGF0YSArPSBibG9ja19kZXNjX2xlbjsKKyAgICAgICAgfQorICAgICAgICBw
YWdlX251bSA9IG1vZGVfZGF0YVswXSAmIDB4M2Y7CisgICAgICAgIHBhZ2VfbGVuID0gbW9kZV9k
YXRhWzFdOworICAgIH0KKworICAgIFNQSUNFX0RFQlVHKCJtb2RlX3NlbGVjdF82LCBsdW46JXUi
CisgICAgICAgICAgICAgICAgIiBwZjoldSBzcDoldSBsaXN0X2xlbjoldSBkYXRhX2xlbjoldSIK
KyAgICAgICAgICAgICAgICAiIG1vZGVfbGVuOiV1IG1lZGl1bToldSBkZXZfcGFyYW06JXUgYmxr
X2Rlc2NfbGVuOiV1IgorICAgICAgICAgICAgICAgICIgbnVtX2Jsb2NrczoldSBibG9ja19sZW46
JXUiCisgICAgICAgICAgICAgICAgIiBwYWdlX251bToldSBwYWdlX2xlbjoldSIsCisgICAgICAg
ICAgICAgICAgcmVxLT5sdW4sIHBhZ2VfZm9ybWF0LCBzYXZlX3BhZ2VzLCBsaXN0X2xlbiwgcmVx
LT5idWZfbGVuLAorICAgICAgICAgICAgICAgIG1vZGVfbGVuLCBtZWRpdW1fdHlwZSwgZGV2X3Bh
cmFtLCBibG9ja19kZXNjX2xlbiwKKyAgICAgICAgICAgICAgICBudW1fYmxvY2tzLCBibG9ja19s
ZW4sCisgICAgICAgICAgICAgICAgcGFnZV9udW0sIHBhZ2VfbGVuKTsKKworICAgIGNkX3Njc2lf
Y21kX2NvbXBsZXRlX2dvb2QoZGV2LCByZXEpOworfQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2Nt
ZF9tb2RlX3NlbGVjdF8xMChDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7Cisg
ICAgdWludDMyX3QgcGFnZV9mb3JtYXQsIHNhdmVfcGFnZXMsIGxpc3RfbGVuOworCisgICAgcGFn
ZV9mb3JtYXQgPSAocmVxLT5jZGJbMV0gPj4gNCkgJiAweDE7CisgICAgc2F2ZV9wYWdlcyA9IHJl
cS0+Y2RiWzFdICYgMHgxOworICAgIGxpc3RfbGVuID0gKHJlcS0+Y2RiWzddIDw8IDgpIHwgcmVx
LT5jZGJbOF07CisKKyAgICBpZiAobGlzdF9sZW4gPiByZXEtPmJ1Zl9sZW4pIHsKKyAgICAgICAg
U1BJQ0VfREVCVUcoIm1vZGVfc2VsZWN0XzEwLCBsdW46JXUgcGY6JXUgc3A6JXUiCisgICAgICAg
ICAgICAgICAgICAgICIgbGlzdF9sZW46JXUgZXhjZWVkcyBkYXRhX2xlbjoldSIsCisgICAgICAg
ICAgICAgICAgICAgIHJlcS0+bHVuLCBwYWdlX2Zvcm1hdCwgc2F2ZV9wYWdlcywgbGlzdF9sZW4s
IHJlcS0+YnVmX2xlbik7CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQo
ZGV2LCByZXEsICZzZW5zZV9jb2RlX0lOVkFMSURfUEFSQU1fTEVOKTsKKyAgICAgICAgcmV0dXJu
OworICAgIH0KKworICAgIFNQSUNFX0RFQlVHKCJtb2RlX3NlbGVjdF8xMCwgbHVuOiV1IHBmOiV1
IHNwOiV1IgorICAgICAgICAgICAgICAgICIgbGlzdF9sZW46JXUgZGF0YV9sZW46JXUiLAorICAg
ICAgICAgICAgICAgIHJlcS0+bHVuLCBwYWdlX2Zvcm1hdCwgc2F2ZV9wYWdlcywgbGlzdF9sZW4s
IHJlcS0+YnVmX2xlbik7CisKKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVx
KTsKK30KKworI2RlZmluZSBDRF9GRUFUVVJFX0hFQURFUl9MRU4gICAgICAgICAgICAgICA4Cisj
ZGVmaW5lIENEX0ZFQVRVUkVfREVTQ19MRU4gICAgICAgICAgICAgICAgIDQKKworI2RlZmluZSBD
RF9QUk9GSUxFX0RFU0NfTEVOICAgICAgICAgICAgICAgICA0CisjZGVmaW5lIENEX1BST0ZJTEVf
Q1VSUkVOVCAgICAgICAgICAgICAgICAgIDB4MDEKKworLyogUHJvZmlsZXMgTGlzdCAqLworI2Rl
ZmluZSBDRF9GRUFUVVJFX05VTV9QUk9GSUxFU19MSVNUICAgICAgICAweDAwCisvKiBDb3JlIC0g
QmFzaWMgRnVuY3Rpb25hbGl0eSAqLworI2RlZmluZSBDRF9GRUFUVVJFX05VTV9DT1JFICAgICAg
ICAgICAgICAgICAweDAxCisvKiBNb3JwaGluZyAtIFRoZSBkZXZpY2UgY2hhbmdlcyBpdHMgYmVo
YXZpb3IgZHVlIHRvIGV4dGVybmFsIGV2ZW50cyAqLworI2RlZmluZSBDRF9GRUFUVVJFX05VTV9N
T1JQSCAgICAgICAgICAgICAgICAweDAyCisvKiBSZW1vdmFibGUgTWVkaXVtIC0gVGhlIG1lZGl1
bSBtYXkgYmUgcmVtb3ZlZCBmcm9tIHRoZSBkZXZpY2UgKi8KKyNkZWZpbmUgQ0RfRkVBVFVSRV9O
VU1fUkVNT1ZBQkxFICAgICAgICAgICAgMHgwMworLyogUmFuZG9tIFJlYWRhYmxlIC0gUFA9MSBS
ZWFkIGFiaWxpdHkgZm9yIHN0b3JhZ2UgZGV2aWNlcyB3aXRoIHJhbmRvbSBhZGRyZXNzaW5nICov
CisjZGVmaW5lIENEX0ZFQVRVUkVfTlVNX1JBTkRPTV9SRUFEICAgICAgICAgIDB4MTAKKy8qIENE
IFJlYWQgLSBUaGUgYWJpbGl0eSB0byByZWFkIENEIHNwZWNpZmljIHN0cnVjdHVyZXMgKi8KKyNk
ZWZpbmUgQ0RfRkVBVFVSRV9OVU1fQ0RfUkVBRCAgICAgICAgICAgICAgMHgxRQorLyogRFZEIFJl
YWQgLSBUaGUgYWJpbGl0eSB0byByZWFkIERWRCBzcGVjaWZpYyBzdHJ1Y3R1cmVzICovCisjZGVm
aW5lIENEX0ZFQVRVUkVfTlVNX0RWRF9SRUFEICAgICAgICAgICAgIDB4MUYKKy8qIFBvd2VyIE1h
bmFnZW1lbnQgLSBJbml0aWF0b3IgYW5kIGRldmljZSBkaXJlY3RlZCBwb3dlciBtYW5hZ2VtZW50
ICovCisjZGVmaW5lIENEX0ZFQVRVUkVfTlVNX1BPV0VSX01OR1QgICAgICAgICAgIDB4MTAwCisv
KiBUaW1lb3V0ICovCisjZGVmaW5lIENEX0ZFQVRVUkVfTlVNX1RJTUVPVVQgICAgICAgICAgICAg
IDB4MTA1CisKKyNkZWZpbmUgQ0RfRkVBVFVSRV9SRVFfQUxMICAgICAgICAgICAgICAgICAgMAor
I2RlZmluZSBDRF9GRUFUVVJFX1JFUV9DVVJSRU5UICAgICAgICAgICAgICAxCisjZGVmaW5lIENE
X0ZFQVRVUkVfUkVRX1NJTkdMRSAgICAgICAgICAgICAgIDIKKworI2RlZmluZSBDRF9GRUFUVVJF
X0NVUlJFTlQgICAgICAgICAgICAgICAgICAweDAxCisjZGVmaW5lIENEX0ZFQVRVUkVfUEVSU0lT
VEVOVCAgICAgICAgICAgICAgIDB4MDIKKworI2RlZmluZSBDRF9GRUFUVVJFX1ZFUlNJT05fMSAg
ICAgICAgICAgICAgICAoMHgwMSA8PCAyKQorCisjZGVmaW5lIENEX0ZFQVRVUkVfUEhZU19JRl9T
Q1NJICAgICAgICAgICAgIDB4MDEKKworI2RlZmluZSBDRF9GRUFUVVJFX1JFTU9WQUJMRV9MT0FE
SU5HX1RSQVkgICAoMHgwMSA8PCA1KQorI2RlZmluZSBDRF9GRUFUVVJFX1JFTU9WQUJMRV9FSkVD
VCAgICAgICAgICAoMHgwMSA8PCAzKQorI2RlZmluZSBDRF9GRUFUVVJFX1JFTU9WQUJMRV9OT19Q
UlZOVF9KTVBSICAoMHgwMSA8PCAyKQorI2RlZmluZSBDRF9GRUFUVVJFX1JFTU9WQUJMRV9MT0NL
ICAgICAgICAgICAoMHgwMSkKKworc3RhdGljIGdib29sZWFuIGNkX3Njc2lfZmVhdHVyZV9yZXBv
cnRhYmxlKHVpbnQzMl90IGZlYXR1cmUsIHVpbnQzMl90IHN0YXJ0X2ZlYXR1cmUsCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludDMyX3QgcmVxX3R5cGUpCit7
CisgICAgcmV0dXJuIChyZXFfdHlwZSA9PSBDRF9GRUFUVVJFX1JFUV9TSU5HTEUgJiYgc3RhcnRf
ZmVhdHVyZSA9PSBmZWF0dXJlKSB8fAorICAgICAgICAgICAoZmVhdHVyZSA+PSBzdGFydF9mZWF0
dXJlKTsKK30KKworc3RhdGljIHVpbnQzMl90IGNkX3Njc2lfYWRkX2ZlYXR1cmVfcHJvZmlsZXNf
bGlzdChDZFNjc2lMVSAqZGV2LCB1aW50OF90ICpvdXRidWYsCisgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IHN0YXJ0X2ZlYXR1cmUsIHVp
bnQzMl90IHJlcV90eXBlKQoreworICAgIHVpbnQ4X3QgKnByb2ZpbGUgPSBvdXRidWYgKyBDRF9G
RUFUVVJFX0RFU0NfTEVOOworICAgIHVpbnQzMl90IGZlYXR1cmVfbGVuID0gQ0RfRkVBVFVSRV9E
RVNDX0xFTjsKKyAgICB1aW50MzJfdCBhZGRfbGVuLCBwcm9maWxlX251bTsKKworICAgIGlmICgh
Y2Rfc2NzaV9mZWF0dXJlX3JlcG9ydGFibGUoQ0RfRkVBVFVSRV9OVU1fUFJPRklMRVNfTElTVCwg
c3RhcnRfZmVhdHVyZSwgcmVxX3R5cGUpKSB7CisgICAgICAgIHJldHVybiAwOworICAgIH0KKyAg
ICAvKiBmZWF0dXJlIGRlc2NyaXB0b3IgaGVhZGVyICovCisgICAgb3V0YnVmWzBdID0gKENEX0ZF
QVRVUkVfTlVNX1BST0ZJTEVTX0xJU1QgPj4gOCkgJiAweGZmOworICAgIG91dGJ1ZlsxXSA9IENE
X0ZFQVRVUkVfTlVNX1BST0ZJTEVTX0xJU1QgJiAweGZmOworICAgIG91dGJ1ZlsyXSA9IENEX0ZF
QVRVUkVfUEVSU0lTVEVOVCB8IENEX0ZFQVRVUkVfQ1VSUkVOVDsKKworICAgIC8qIERWRC1ST00g
cHJvZmlsZSBkZXNjcmlwdG9yICovCisgICAgYWRkX2xlbiA9IENEX1BST0ZJTEVfREVTQ19MRU47
IC8qIHN0YXJ0IHdpdGggc2luZ2xlIHByb2ZpbGUsIGFkZCBsYXRlciAqLworICAgIHByb2ZpbGVf
bnVtID0gTU1DX1BST0ZJTEVfRFZEX1JPTTsKKworICAgIHByb2ZpbGVbMF0gPSAocHJvZmlsZV9u
dW0gPj4gOCkgJiAweGZmOyAvKiBmZWF0dXJlIGNvZGUgKi8KKyAgICBwcm9maWxlWzFdID0gcHJv
ZmlsZV9udW0gJiAweGZmOworICAgIHByb2ZpbGVbMl0gPSAoIWRldi0+Y2Rfcm9tKSA/IENEX1BS
T0ZJTEVfQ1VSUkVOVCA6IDA7CisKKyAgICAvKiBuZXh0IHByb2ZpbGUgKi8KKyAgICBhZGRfbGVu
ICs9IENEX1BST0ZJTEVfREVTQ19MRU47CisgICAgcHJvZmlsZSArPSBDRF9QUk9GSUxFX0RFU0Nf
TEVOOworCisgICAgLyogQ0QtUk9NIHByb2ZpbGUgZGVzY3JpcHRvciAqLworICAgIHByb2ZpbGVf
bnVtID0gTU1DX1BST0ZJTEVfQ0RfUk9NOworICAgIHByb2ZpbGVbMF0gPSAocHJvZmlsZV9udW0g
Pj4gOCkgJiAweGZmOworICAgIHByb2ZpbGVbMV0gPSBwcm9maWxlX251bSAmIDB4ZmY7CisgICAg
cHJvZmlsZVsyXSA9IGRldi0+Y2Rfcm9tID8gQ0RfUFJPRklMRV9DVVJSRU5UIDogMDsKKworICAg
IG91dGJ1ZlszXSA9IGFkZF9sZW47CisgICAgZmVhdHVyZV9sZW4gKz0gYWRkX2xlbjsKKworICAg
IHJldHVybiBmZWF0dXJlX2xlbjsKK30KKworI2RlZmluZSBDRF9GRUFUVVJFX0NPUkVfUEhZU19Q
Uk9GSUxFX0xFTiAgICA0CisKK3N0YXRpYyB1aW50MzJfdCBjZF9zY3NpX2FkZF9mZWF0dXJlX2Nv
cmUoQ2RTY3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVmLAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCBzdGFydF9mZWF0dXJlLCB1aW50MzJfdCByZXFf
dHlwZSkKK3sKKyAgICB1aW50OF90ICpwcm9maWxlID0gb3V0YnVmICsgQ0RfRkVBVFVSRV9ERVND
X0xFTjsKKyAgICB1aW50MzJfdCBmZWF0dXJlX2xlbiA9IENEX0ZFQVRVUkVfREVTQ19MRU4gKyBD
RF9GRUFUVVJFX0NPUkVfUEhZU19QUk9GSUxFX0xFTjsKKworICAgIGlmICghY2Rfc2NzaV9mZWF0
dXJlX3JlcG9ydGFibGUoQ0RfRkVBVFVSRV9OVU1fQ09SRSwgc3RhcnRfZmVhdHVyZSwgcmVxX3R5
cGUpKSB7CisgICAgICAgIHJldHVybiAwOworICAgIH0KKyAgICBvdXRidWZbMF0gPSAoQ0RfRkVB
VFVSRV9OVU1fQ09SRSA+PiA4KSAmIDB4ZmY7CisgICAgb3V0YnVmWzFdID0gQ0RfRkVBVFVSRV9O
VU1fQ09SRSAmIDB4ZmY7CisgICAgb3V0YnVmWzJdID0gQ0RfRkVBVFVSRV9QRVJTSVNURU5UIHwg
Q0RfRkVBVFVSRV9DVVJSRU5UOworICAgIG91dGJ1ZlszXSA9IENEX0ZFQVRVUkVfQ09SRV9QSFlT
X1BST0ZJTEVfTEVOOworCisgICAgcHJvZmlsZVszXSA9IENEX0ZFQVRVUkVfUEhZU19JRl9TQ1NJ
OworCisgICAgcmV0dXJuIGZlYXR1cmVfbGVuOworfQorCisjZGVmaW5lIENEX0ZFQVRVUkVfTU9S
UEhfUFJPR0lMRV9MRU4gICAgNAorI2RlZmluZSBDRF9GRUFUVVJFX01PUlBIX0FTWU5DX0VWRU5U
UyAgIDB4MDEKKworc3RhdGljIHVpbnQzMl90IGNkX3Njc2lfYWRkX2ZlYXR1cmVfbW9ycGgoQ2RT
Y3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVmLAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgdWludDMyX3Qgc3RhcnRfZmVhdHVyZSwgdWludDMyX3QgcmVxX3R5cGUp
Cit7CisgICAgdWludDhfdCAqcHJvZmlsZSA9IG91dGJ1ZiArIENEX0ZFQVRVUkVfREVTQ19MRU47
CisgICAgdWludDMyX3QgZmVhdHVyZV9sZW4gPSBDRF9GRUFUVVJFX0RFU0NfTEVOICsgQ0RfRkVB
VFVSRV9NT1JQSF9QUk9HSUxFX0xFTjsKKworICAgIGlmICghY2Rfc2NzaV9mZWF0dXJlX3JlcG9y
dGFibGUoQ0RfRkVBVFVSRV9OVU1fTU9SUEgsIHN0YXJ0X2ZlYXR1cmUsIHJlcV90eXBlKSkgewor
ICAgICAgICByZXR1cm4gMDsKKyAgICB9CisgICAgb3V0YnVmWzFdID0gQ0RfRkVBVFVSRV9OVU1f
TU9SUEg7CisgICAgb3V0YnVmWzJdID0gQ0RfRkVBVFVSRV9QRVJTSVNURU5UIHwgQ0RfRkVBVFVS
RV9DVVJSRU5UOworICAgIG91dGJ1ZlszXSA9IENEX0ZFQVRVUkVfTU9SUEhfUFJPR0lMRV9MRU47
CisKKyAgICBwcm9maWxlWzBdID0gQ0RfRkVBVFVSRV9NT1JQSF9BU1lOQ19FVkVOVFM7CisKKyAg
ICByZXR1cm4gZmVhdHVyZV9sZW47Cit9CisKKyNkZWZpbmUgQ0RfRkVBVFVSRV9SRU1PVkFCTEVf
UFJPRklMRV9MRU4gICAgNAorCitzdGF0aWMgdWludDMyX3QgY2Rfc2NzaV9hZGRfZmVhdHVyZV9y
ZW1vdmFibGUoQ2RTY3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVmLAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IHN0YXJ0X2ZlYXR1cmUsIHVp
bnQzMl90IHJlcV90eXBlKQoreworICAgIHVpbnQ4X3QgKnByb2ZpbGUgPSBvdXRidWYgKyBDRF9G
RUFUVVJFX0RFU0NfTEVOOworICAgIHVpbnQzMl90IGZlYXR1cmVfbGVuID0gQ0RfRkVBVFVSRV9E
RVNDX0xFTiArIENEX0ZFQVRVUkVfUkVNT1ZBQkxFX1BST0ZJTEVfTEVOOworCisgICAgaWYgKCFj
ZF9zY3NpX2ZlYXR1cmVfcmVwb3J0YWJsZShDRF9GRUFUVVJFX05VTV9SRU1PVkFCTEUsIHN0YXJ0
X2ZlYXR1cmUsIHJlcV90eXBlKSkgeworICAgICAgICByZXR1cm4gMDsKKyAgICB9CisgICAgb3V0
YnVmWzFdID0gQ0RfRkVBVFVSRV9OVU1fUkVNT1ZBQkxFOworICAgIG91dGJ1ZlsyXSA9IENEX0ZF
QVRVUkVfUEVSU0lTVEVOVCB8IENEX0ZFQVRVUkVfQ1VSUkVOVDsKKyAgICBvdXRidWZbM10gPSBD
RF9GRUFUVVJFX1JFTU9WQUJMRV9QUk9GSUxFX0xFTjsKKworICAgIHByb2ZpbGVbMF0gPSBDRF9G
RUFUVVJFX1JFTU9WQUJMRV9OT19QUlZOVF9KTVBSOworICAgIGlmIChkZXYtPnJlbW92YWJsZSkg
eworICAgICAgICBwcm9maWxlWzBdIHw9IChDRF9GRUFUVVJFX1JFTU9WQUJMRV9MT0FESU5HX1RS
QVkgfCBDRF9GRUFUVVJFX1JFTU9WQUJMRV9FSkVDVCk7CisgICAgfQorCisgICAgcmV0dXJuIGZl
YXR1cmVfbGVuOworfQorCisjZGVmaW5lIENEX0ZFQVRVUkVfUkFORE9NX1JFQURfUFJPRklMRV9M
RU4gICAgOAorCitzdGF0aWMgdWludDMyX3QgY2Rfc2NzaV9hZGRfZmVhdHVyZV9yYW5kb21fcmVh
ZChDZFNjc2lMVSAqZGV2LCB1aW50OF90ICpvdXRidWYsCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCBzdGFydF9mZWF0dXJlLCB1aW50MzJf
dCByZXFfdHlwZSkKK3sKKyAgICB1aW50OF90ICpwcm9maWxlID0gb3V0YnVmICsgQ0RfRkVBVFVS
RV9ERVNDX0xFTjsKKyAgICB1aW50MzJfdCBmZWF0dXJlX2xlbiA9IENEX0ZFQVRVUkVfREVTQ19M
RU4gKyBDRF9GRUFUVVJFX1JBTkRPTV9SRUFEX1BST0ZJTEVfTEVOOworCisgICAgaWYgKCFjZF9z
Y3NpX2ZlYXR1cmVfcmVwb3J0YWJsZShDRF9GRUFUVVJFX05VTV9SQU5ET01fUkVBRCwgc3RhcnRf
ZmVhdHVyZSwgcmVxX3R5cGUpKSB7CisgICAgICAgIHJldHVybiAwOworICAgIH0KKyAgICBvdXRi
dWZbMF0gPSAoQ0RfRkVBVFVSRV9OVU1fUkFORE9NX1JFQUQgPj4gOCkgJiAweGZmOworICAgIG91
dGJ1ZlsxXSA9IENEX0ZFQVRVUkVfTlVNX1JBTkRPTV9SRUFEICYgMHhmZjsKKyAgICBvdXRidWZb
Ml0gPSBDRF9GRUFUVVJFX1BFUlNJU1RFTlQgfCBDRF9GRUFUVVJFX0NVUlJFTlQ7CisgICAgb3V0
YnVmWzNdID0gQ0RfRkVBVFVSRV9SQU5ET01fUkVBRF9QUk9GSUxFX0xFTjsKKworICAgIHByb2Zp
bGVbMF0gPSAoZGV2LT5ibG9ja19zaXplID4+IDI0KSAmIDB4ZmY7CisgICAgcHJvZmlsZVsxXSA9
IChkZXYtPmJsb2NrX3NpemUgPj4gMTYpICYgMHhmZjsKKyAgICBwcm9maWxlWzJdID0gKGRldi0+
YmxvY2tfc2l6ZSA+PiA4KSAmIDB4ZmY7CisgICAgcHJvZmlsZVszXSA9IChkZXYtPmJsb2NrX3Np
emUpICYgMHhmZjsKKyAgICBwcm9maWxlWzVdID0gKGRldi0+Y2Rfcm9tKSA/IDB4MDEgOiAweDEw
OyAvKiBsb2dpY2FsIGJsb2NrcyBwZXIgcmVhZGFibGUgdW5pdCAqLworCisgICAgcmV0dXJuIGZl
YXR1cmVfbGVuOworfQorCisjZGVmaW5lIENEX0ZFQVRVUkVfQ0RfUkVBRF9QUk9GSUxFX0xFTiAg
ICA0CisKK3N0YXRpYyB1aW50MzJfdCBjZF9zY3NpX2FkZF9mZWF0dXJlX2NkX3JlYWQoQ2RTY3Np
TFUgKmRldiwgdWludDhfdCAqb3V0YnVmLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB1aW50MzJfdCBzdGFydF9mZWF0dXJlLCB1aW50MzJfdCByZXFfdHlwZSkK
K3sKKyAgICB1aW50OF90ICpwcm9maWxlID0gb3V0YnVmICsgQ0RfRkVBVFVSRV9ERVNDX0xFTjsK
KyAgICB1aW50MzJfdCBmZWF0dXJlX2xlbiA9IENEX0ZFQVRVUkVfREVTQ19MRU4gKyBDRF9GRUFU
VVJFX0NEX1JFQURfUFJPRklMRV9MRU47CisKKyAgICBpZiAoIWNkX3Njc2lfZmVhdHVyZV9yZXBv
cnRhYmxlKENEX0ZFQVRVUkVfTlVNX0NEX1JFQUQsIHN0YXJ0X2ZlYXR1cmUsIHJlcV90eXBlKSkg
eworICAgICAgICByZXR1cm4gMDsKKyAgICB9CisgICAgb3V0YnVmWzBdID0gKENEX0ZFQVRVUkVf
TlVNX0NEX1JFQUQgPj4gOCkgJiAweGZmOworICAgIG91dGJ1ZlsxXSA9IChDRF9GRUFUVVJFX05V
TV9DRF9SRUFEKSAmIDB4ZmY7CisgICAgb3V0YnVmWzJdID0gQ0RfRkVBVFVSRV9WRVJTSU9OXzEg
fCBDRF9GRUFUVVJFX1BFUlNJU1RFTlQgfCBDRF9GRUFUVVJFX0NVUlJFTlQ7CisgICAgb3V0YnVm
WzNdID0gQ0RfRkVBVFVSRV9DRF9SRUFEX1BST0ZJTEVfTEVOOworCisgICAgcHJvZmlsZVswXSA9
IDA7IC8qIEMyIEVycm9ycywgQ0QtVGV4dCBub3Qgc3VwcG9ydGUgKi8KKworICAgIHJldHVybiBm
ZWF0dXJlX2xlbjsKK30KKworI2RlZmluZSBDRF9GRUFUVVJFX0RWRF9SRUFEX1BST0ZJTEVfTEVO
ICAgIDAKKworc3RhdGljIHVpbnQzMl90IGNkX3Njc2lfYWRkX2ZlYXR1cmVfZHZkX3JlYWQoQ2RT
Y3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVmLAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgdWludDMyX3Qgc3RhcnRfZmVhdHVyZSwgdWludDMyX3QgcmVxX3R5
cGUpCit7CisgICAgdWludDMyX3QgZmVhdHVyZV9sZW4gPSBDRF9GRUFUVVJFX0RFU0NfTEVOICsg
Q0RfRkVBVFVSRV9EVkRfUkVBRF9QUk9GSUxFX0xFTjsKKworICAgIGlmICghY2Rfc2NzaV9mZWF0
dXJlX3JlcG9ydGFibGUoQ0RfRkVBVFVSRV9OVU1fQ0RfUkVBRCwgc3RhcnRfZmVhdHVyZSwgcmVx
X3R5cGUpKSB7CisgICAgICAgIHJldHVybiAwOworICAgIH0KKyAgICBvdXRidWZbMF0gPSAoQ0Rf
RkVBVFVSRV9OVU1fRFZEX1JFQUQgPj4gOCkgJiAweGZmOworICAgIG91dGJ1ZlsxXSA9IChDRF9G
RUFUVVJFX05VTV9EVkRfUkVBRCkgJiAweGZmOworICAgIG91dGJ1ZlsyXSA9IENEX0ZFQVRVUkVf
VkVSU0lPTl8xIHwgQ0RfRkVBVFVSRV9QRVJTSVNURU5UIHwgQ0RfRkVBVFVSRV9DVVJSRU5UOwor
ICAgIG91dGJ1ZlszXSA9IENEX0ZFQVRVUkVfRFZEX1JFQURfUFJPRklMRV9MRU47CisKKyAgICBy
ZXR1cm4gZmVhdHVyZV9sZW47Cit9CisKKyNkZWZpbmUgQ0RfRkVBVFVSRV9QT1dFUl9NTkdUX1BS
T0ZJTEVfTEVOICAgIDAKKworc3RhdGljIHVpbnQzMl90IGNkX3Njc2lfYWRkX2ZlYXR1cmVfcG93
ZXJfbWdtdChDZFNjc2lMVSAqZGV2LCB1aW50OF90ICpvdXRidWYsCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IHN0YXJ0X2ZlYXR1cmUsIHVp
bnQzMl90IHJlcV90eXBlKQoreworICAgIHVpbnQzMl90IGZlYXR1cmVfbGVuID0gQ0RfRkVBVFVS
RV9ERVNDX0xFTiArIENEX0ZFQVRVUkVfUE9XRVJfTU5HVF9QUk9GSUxFX0xFTjsKKworICAgIGlm
ICghY2Rfc2NzaV9mZWF0dXJlX3JlcG9ydGFibGUoQ0RfRkVBVFVSRV9OVU1fUE9XRVJfTU5HVCwg
c3RhcnRfZmVhdHVyZSwgcmVxX3R5cGUpKSB7CisgICAgICAgIHJldHVybiAwOworICAgIH0KKyAg
ICBvdXRidWZbMF0gPSAoQ0RfRkVBVFVSRV9OVU1fUE9XRVJfTU5HVCA+PiA4KSAmIDB4ZmY7Cisg
ICAgb3V0YnVmWzFdID0gKENEX0ZFQVRVUkVfTlVNX1BPV0VSX01OR1QpICYgMHhmZjsKKyAgICBv
dXRidWZbMl0gPSBDRF9GRUFUVVJFX1BFUlNJU1RFTlQgfCBDRF9GRUFUVVJFX0NVUlJFTlQ7Cisg
ICAgb3V0YnVmWzNdID0gQ0RfRkVBVFVSRV9QT1dFUl9NTkdUX1BST0ZJTEVfTEVOOworCisgICAg
cmV0dXJuIGZlYXR1cmVfbGVuOworfQorCisjZGVmaW5lIENEX0ZFQVRVUkVfVElNRU9VVF9QUk9G
SUxFX0xFTiAgICAwCisKK3N0YXRpYyB1aW50MzJfdCBjZF9zY3NpX2FkZF9mZWF0dXJlX3RpbWVv
dXQoQ2RTY3NpTFUgKmRldiwgdWludDhfdCAqb3V0YnVmLAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCBzdGFydF9mZWF0dXJlLCB1aW50MzJfdCBy
ZXFfdHlwZSkKK3sKKyAgICB1aW50MzJfdCBmZWF0dXJlX2xlbiA9IENEX0ZFQVRVUkVfREVTQ19M
RU4gKyBDRF9GRUFUVVJFX1RJTUVPVVRfUFJPRklMRV9MRU47CisKKyAgICBpZiAoIWNkX3Njc2lf
ZmVhdHVyZV9yZXBvcnRhYmxlKENEX0ZFQVRVUkVfTlVNX1RJTUVPVVQsIHN0YXJ0X2ZlYXR1cmUs
IHJlcV90eXBlKSkgeworICAgICAgICByZXR1cm4gMDsKKyAgICB9CisgICAgb3V0YnVmWzBdID0g
KENEX0ZFQVRVUkVfTlVNX1RJTUVPVVQgPj4gOCkgJiAweGZmOworICAgIG91dGJ1ZlsxXSA9IENE
X0ZFQVRVUkVfTlVNX1RJTUVPVVQgJiAweGZmOworICAgIG91dGJ1ZlsyXSA9IENEX0ZFQVRVUkVf
UEVSU0lTVEVOVCB8IENEX0ZFQVRVUkVfQ1VSUkVOVDsKKyAgICBvdXRidWZbM10gPSBDRF9GRUFU
VVJFX1RJTUVPVVRfUFJPRklMRV9MRU47CisKKyAgICByZXR1cm4gZmVhdHVyZV9sZW47Cit9CisK
K3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX2dldF9jb25maWd1cmF0aW9uKENkU2NzaUxVICpkZXYs
IENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICB1aW50OF90ICpvdXRidWYgPSByZXEtPmJ1ZjsK
KyAgICB1aW50MzJfdCBwcm9maWxlX251bSA9ICghZGV2LT5jZF9yb20pID8gTU1DX1BST0ZJTEVf
RFZEX1JPTSA6IE1NQ19QUk9GSUxFX0NEX1JPTTsKKyAgICB1aW50MzJfdCByZXFfdHlwZSwgc3Rh
cnRfZmVhdHVyZSwgcmVzcF9sZW47CisKKyAgICByZXEtPnhmZXJfZGlyID0gU0NTSV9YRkVSX0ZS
T01fREVWOworCisgICAgcmVxX3R5cGUgPSByZXEtPmNkYlsxXSAmIDB4MzsKKyAgICBzdGFydF9m
ZWF0dXJlID0gKHJlcS0+Y2RiWzJdIDw8IDgpIHwgcmVxLT5jZGJbM107CisgICAgcmVxLT5yZXFf
bGVuID0gKHJlcS0+Y2RiWzddIDw8IDgpIHwgcmVxLT5jZGJbOF07CisKKyAgICBtZW1zZXQob3V0
YnVmLCAwLCByZXEtPnJlcV9sZW4pOworCisgICAgLyogYXQgbGVhc3QgRmVhdHVyZSBIZWFkZXIg
c2hvdWxkIGJlIHByZXNlbnQsIHRvIGJlIGZpbGxlZCBsYXRlciAqLworICAgIHJlc3BfbGVuID0g
Q0RfRkVBVFVSRV9IRUFERVJfTEVOOworCisgICAgc3dpdGNoIChyZXFfdHlwZSkgeworICAgIGNh
c2UgQ0RfRkVBVFVSRV9SRVFfQUxMOgorICAgIGNhc2UgQ0RfRkVBVFVSRV9SRVFfQ1VSUkVOVDoK
KyAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9hZGRfZmVhdHVyZV9wcm9maWxlc19saXN0KGRl
diwgb3V0YnVmICsgcmVzcF9sZW4sIHN0YXJ0X2ZlYXR1cmUsCisgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXFfdHlwZSk7CisgICAgICAgIHJl
c3BfbGVuICs9IGNkX3Njc2lfYWRkX2ZlYXR1cmVfY29yZShkZXYsIG91dGJ1ZiArIHJlc3BfbGVu
LCBzdGFydF9mZWF0dXJlLCByZXFfdHlwZSk7CisgICAgICAgIHJlc3BfbGVuICs9IGNkX3Njc2lf
YWRkX2ZlYXR1cmVfbW9ycGgoZGV2LCBvdXRidWYgKyByZXNwX2xlbiwgc3RhcnRfZmVhdHVyZSwg
cmVxX3R5cGUpOworICAgICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9mZWF0dXJlX3JlbW92
YWJsZShkZXYsIG91dGJ1ZiArIHJlc3BfbGVuLCBzdGFydF9mZWF0dXJlLCByZXFfdHlwZSk7Cisg
ICAgICAgIHJlc3BfbGVuICs9IGNkX3Njc2lfYWRkX2ZlYXR1cmVfcmFuZG9tX3JlYWQoZGV2LCBv
dXRidWYgKyByZXNwX2xlbiwgc3RhcnRfZmVhdHVyZSwKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXFfdHlwZSk7CisgICAgICAgIHJlc3BfbGVu
ICs9IGNkX3Njc2lfYWRkX2ZlYXR1cmVfY2RfcmVhZChkZXYsIG91dGJ1ZiArIHJlc3BfbGVuLCBz
dGFydF9mZWF0dXJlLCByZXFfdHlwZSk7CisgICAgICAgIHJlc3BfbGVuICs9IGNkX3Njc2lfYWRk
X2ZlYXR1cmVfZHZkX3JlYWQoZGV2LCBvdXRidWYgKyByZXNwX2xlbiwgc3RhcnRfZmVhdHVyZSwg
cmVxX3R5cGUpOworICAgICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9mZWF0dXJlX3Bvd2Vy
X21nbXQoZGV2LCBvdXRidWYgKyByZXNwX2xlbiwgc3RhcnRfZmVhdHVyZSwgcmVxX3R5cGUpOwor
ICAgICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9mZWF0dXJlX3RpbWVvdXQoZGV2LCBvdXRi
dWYgKyByZXNwX2xlbiwgc3RhcnRfZmVhdHVyZSwgcmVxX3R5cGUpOworICAgICAgICBicmVhazsK
KyAgICBjYXNlIENEX0ZFQVRVUkVfUkVRX1NJTkdMRToKKyAgICAgICAgc3dpdGNoIChzdGFydF9m
ZWF0dXJlKSB7CisgICAgICAgIGNhc2UgQ0RfRkVBVFVSRV9OVU1fQ09SRToKKyAgICAgICAgICAg
IHJlc3BfbGVuICs9IGNkX3Njc2lfYWRkX2ZlYXR1cmVfY29yZShkZXYsIG91dGJ1ZiArIHJlc3Bf
bGVuLCBzdGFydF9mZWF0dXJlLCByZXFfdHlwZSk7CisgICAgICAgICAgICBicmVhazsKKyAgICAg
ICAgY2FzZSBDRF9GRUFUVVJFX05VTV9NT1JQSDoKKyAgICAgICAgICAgIHJlc3BfbGVuICs9IGNk
X3Njc2lfYWRkX2ZlYXR1cmVfbW9ycGgoZGV2LCBvdXRidWYgKyByZXNwX2xlbiwgc3RhcnRfZmVh
dHVyZSwgcmVxX3R5cGUpOworICAgICAgICAgICAgYnJlYWs7CisgICAgICAgIGNhc2UgQ0RfRkVB
VFVSRV9OVU1fUkVNT1ZBQkxFOgorICAgICAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9hZGRf
ZmVhdHVyZV9yZW1vdmFibGUoZGV2LCBvdXRidWYgKyByZXNwX2xlbiwgc3RhcnRfZmVhdHVyZSwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJl
cV90eXBlKTsKKyAgICAgICAgICAgIGJyZWFrOworICAgICAgICBjYXNlIENEX0ZFQVRVUkVfTlVN
X1JBTkRPTV9SRUFEOgorICAgICAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9hZGRfZmVhdHVy
ZV9yYW5kb21fcmVhZChkZXYsIG91dGJ1ZiArIHJlc3BfbGVuLCBzdGFydF9mZWF0dXJlLAorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXFf
dHlwZSk7CisgICAgICAgICAgICBicmVhazsKKyAgICAgICAgY2FzZSBDRF9GRUFUVVJFX05VTV9D
RF9SRUFEOgorICAgICAgICAgICAgcmVzcF9sZW4gKz0gY2Rfc2NzaV9hZGRfZmVhdHVyZV9jZF9y
ZWFkKGRldiwgb3V0YnVmICsgcmVzcF9sZW4sIHN0YXJ0X2ZlYXR1cmUsCisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxX3R5cGUpOworICAgICAg
ICAgICAgYnJlYWs7CisgICAgICAgIGNhc2UgQ0RfRkVBVFVSRV9OVU1fRFZEX1JFQUQ6CisgICAg
ICAgICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9mZWF0dXJlX2R2ZF9yZWFkKGRldiwgb3V0
YnVmICsgcmVzcF9sZW4sIHN0YXJ0X2ZlYXR1cmUsCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcV90eXBlKTsKKyAgICAgICAgICAgIGJyZWFr
OworICAgICAgICBjYXNlIENEX0ZFQVRVUkVfTlVNX1BPV0VSX01OR1Q6CisgICAgICAgICAgICBy
ZXNwX2xlbiArPSBjZF9zY3NpX2FkZF9mZWF0dXJlX3Bvd2VyX21nbXQoZGV2LCBvdXRidWYgKyBy
ZXNwX2xlbiwgc3RhcnRfZmVhdHVyZSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICByZXFfdHlwZSk7CisgICAgICAgICAgICBicmVhazsKKyAg
ICAgICAgY2FzZSBDRF9GRUFUVVJFX05VTV9USU1FT1VUOgorICAgICAgICAgICAgcmVzcF9sZW4g
Kz0gY2Rfc2NzaV9hZGRfZmVhdHVyZV90aW1lb3V0KGRldiwgb3V0YnVmICsgcmVzcF9sZW4sIHN0
YXJ0X2ZlYXR1cmUsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgcmVxX3R5cGUpOworICAgICAgICAgICAgYnJlYWs7CisgICAgICAgIGRlZmF1bHQ6
CisgICAgICAgICAgICBicmVhazsKKyAgICAgICAgfQorICAgICAgICBicmVhazsKKworICAgIGRl
ZmF1bHQ6CisgICAgICAgIFNQSUNFX0RFQlVHKCJnZXRfY29uZmlndXJhdGlvbiwgbHVuOiV1IGlu
dmFsaWQgcnQ6JXUgc3RhcnRfZjoldSIsCisgICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBy
ZXFfdHlwZSwgc3RhcnRfZmVhdHVyZSk7CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2No
ZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX0lOVkFMSURfQ0RCX0ZJRUxEKTsKKyAgICAg
ICAgcmV0dXJuOworICAgIH0KKworICAgIC8qIHNldCB0b3RhbCBkYXRhIGxlbiAqLworICAgIG91
dGJ1ZlswXSA9IChyZXNwX2xlbiA+PiAyNCkgJiAweGZmOworICAgIG91dGJ1ZlsxXSA9IChyZXNw
X2xlbiA+PiAxNikgJiAweGZmOworICAgIG91dGJ1ZlsyXSA9IChyZXNwX2xlbiA+PiA4KSAmIDB4
ZmY7CisgICAgb3V0YnVmWzNdID0gcmVzcF9sZW4gJiAweGZmOworCisgICAgLyogcmVwb3J0IGN1
cnJlbnQgcHJvZmlsZSBudW0gKi8KKyAgICBvdXRidWZbNl0gPSAocHJvZmlsZV9udW0gPj4gOCkg
JiAweGZmOworICAgIG91dGJ1Zls3XSA9IHByb2ZpbGVfbnVtICYgMHhmZjsKKworICAgIHJlcS0+
aW5fbGVuID0gTUlOKHJlcS0+cmVxX2xlbiwgcmVzcF9sZW4pOworCisgICAgU1BJQ0VfREVCVUco
ImdldF9jb25maWd1cmF0aW9uLCBsdW46JXUgcnQ6JXUgc3RhcnRfZjoldSByZXNwX2xlbjoldSIs
CisgICAgICAgICAgICAgICAgcmVxLT5sdW4sIHJlcV90eXBlLCBzdGFydF9mZWF0dXJlLCByZXNw
X2xlbik7CisKKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKwor
I2RlZmluZSBDRF9HRVRfRVZFTlRfU1RBVFVTX0lNTUVEICAgICAgICAgICAgMHgwMQorCisjZGVm
aW5lIENEX0dFVF9FVkVOVF9IRUFERVJfTk9fRVZFTlRfQVZBSUwgICgweDAxIDw8IDcpCisjZGVm
aW5lIENEX0dFVF9FVkVOVF9IRUFERVJfTEVOICAgICAgICAgICAgIDQKKworI2RlZmluZSBDRF9H
RVRfRVZFTlRfQ0xBU1NfTk9ORSAgICAgICAgICAgICAoMHgwMCkKKyNkZWZpbmUgQ0RfR0VUX0VW
RU5UX0NMQVNTX09QRVJfQ0hBTkdFICAgICAgKDB4MDEpCisjZGVmaW5lIENEX0dFVF9FVkVOVF9D
TEFTU19QT1dFUl9NR01UICAgICAgICgweDAyKQorI2RlZmluZSBDRF9HRVRfRVZFTlRfQ0xBU1Nf
RVhURVJOQUxfUkVRICAgICAoMHgwMykKKyNkZWZpbmUgQ0RfR0VUX0VWRU5UX0NMQVNTX01FRElB
ICAgICAgICAgICAgKDB4MDQpCisjZGVmaW5lIENEX0dFVF9FVkVOVF9DTEFTU19NVUxUSV9JTklU
SUFUT1IgICgweDA1KQorI2RlZmluZSBDRF9HRVRfRVZFTlRfQ0xBU1NfREVWX0JVU1kgICAgICAg
ICAoMHgwNikKKworI2RlZmluZSBDRF9HRVRfRVZFTlRfTEVOX01FRElBICAgICAgICAgICAgICA0
CisKKyNkZWZpbmUgQ0RfTUVESUFfU1RBVFVTX01FRElBX1BSRVNFTlQgICAgICAgMHgxCisjZGVm
aW5lIENEX01FRElBX1NUQVRVU19UUkFZX09QRU4gICAgICAgICAgIDB4MgorCitzdGF0aWMgdWlu
dDMyX3QgY2Rfc2NzaV9jbWRfZ2V0X2V2ZW50X3Jlc3BfYWRkX21lZGlhKENkU2NzaUxVICpkZXYs
IHVpbnQ4X3QgKm91dGJ1ZikKK3sKKyAgICBvdXRidWZbMF0gPSAodWludDhfdClkZXYtPm1lZGlh
X2V2ZW50ICYgMHgwZjsKKyAgICBvdXRidWZbMV0gPSAodWludDhfdCkoKGRldi0+bG9hZGVkID8g
MCA6IENEX01FRElBX1NUQVRVU19UUkFZX09QRU4pIHwKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgKGRldi0+c3RyZWFtICE9IE5VTEwgPyBDRF9NRURJQV9TVEFUVVNfTUVESUFfUFJFU0VOVCA6
IDApKTsKKworICAgIGRldi0+bWVkaWFfZXZlbnQgPSBDRF9NRURJQV9FVkVOVF9OT19DSEFOR0U7
IC8qIHJlc2V0IHRoZSBldmVudCAqLworICAgIHJldHVybiBDRF9HRVRfRVZFTlRfTEVOX01FRElB
OworfQorCisjZGVmaW5lIENEX0dFVF9FVkVOVF9MRU5fUE9XRVIgICAgICAgICAgICAgIDQKKwor
I2RlZmluZSBDRF9QT1dFUl9TVEFUVVNfQUNUSVZFICAgICAgICAgICAgICAweDEKKyNkZWZpbmUg
Q0RfUE9XRVJfU1RBVFVTX0lETEUgICAgICAgICAgICAgICAgMHgyCisKK3N0YXRpYyB1aW50MzJf
dCBjZF9zY3NpX2NtZF9nZXRfZXZlbnRfcmVzcF9hZGRfcG93ZXIoQ2RTY3NpTFUgKmRldiwgdWlu
dDhfdCAqb3V0YnVmKQoreworICAgIG91dGJ1ZlswXSA9ICh1aW50OF90KWRldi0+cG93ZXJfZXZl
bnQgJiAweDBmOworICAgIG91dGJ1ZlsxXSA9ICh1aW50OF90KSgoZGV2LT5wb3dlcl9jb25kID09
IENEX1NDU0lfUE9XRVJfQUNUSVZFKSA/CisgICAgICAgICAgICAgICAgICAgICAgICAgICBDRF9Q
T1dFUl9TVEFUVVNfQUNUSVZFIDogQ0RfUE9XRVJfU1RBVFVTX0lETEUpOworCisgICAgZGV2LT5w
b3dlcl9ldmVudCA9IENEX1BPV0VSX0VWRU5UX05PX0NIQU5HRTsgLyogcmVzZXQgdGhlIGV2ZW50
ICovCisgICAgcmV0dXJuIENEX0dFVF9FVkVOVF9MRU5fUE9XRVI7Cit9CisKK3N0YXRpYyB2b2lk
IGNkX3Njc2lfY21kX2dldF9ldmVudF9zdGF0dXNfbm90aWZpY2F0aW9uKENkU2NzaUxVICpkZXYs
IENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICB1aW50OF90ICpvdXRidWYgPSByZXEtPmJ1ZjsK
KyAgICB1aW50MzJfdCByZXNwX2xlbiA9IENEX0dFVF9FVkVOVF9IRUFERVJfTEVOOworICAgIGNv
bnN0IHVpbnQzMl90IHBvd2VyX2NsYXNzX21hc2sgPSAoMHgwMSA8PCBDRF9HRVRfRVZFTlRfQ0xB
U1NfUE9XRVJfTUdNVCk7CisgICAgY29uc3QgdWludDMyX3QgbWVkaWFfY2xhc3NfbWFzayA9ICgw
eDAxIDw8IENEX0dFVF9FVkVOVF9DTEFTU19NRURJQSk7CisgICAgdWludDMyX3QgY2xhc3Nlc19z
dXBwb3J0ZWQgPSAgcG93ZXJfY2xhc3NfbWFzayB8IG1lZGlhX2NsYXNzX21hc2s7CisgICAgdWlu
dDMyX3QgaW1tZWQsIGNsYXNzZXNfcmVxdWVzdGVkOworCisgICAgcmVxLT54ZmVyX2RpciA9IFND
U0lfWEZFUl9GUk9NX0RFVjsKKworICAgIGltbWVkID0gcmVxLT5jZGJbMV0gJiBDRF9HRVRfRVZF
TlRfU1RBVFVTX0lNTUVEOworICAgIGNsYXNzZXNfcmVxdWVzdGVkID0gcmVxLT5jZGJbNF07Cisg
ICAgcmVxLT5yZXFfbGVuID0gKHJlcS0+Y2RiWzddIDw8IDgpIHwgcmVxLT5jZGJbOF07CisKKyAg
ICBpZiAoIWltbWVkKSB7CisgICAgICAgIFNQSUNFX0RFQlVHKCJnZXRfZXZlbnRfc3RhdHVzX25v
dGlmaWNhdGlvbiwgbHVuOiV1IgorICAgICAgICAgICAgICAgICIgaW1tOjAgY2xhc3NfcmVxOiUw
MngsIE5vbi1pbW1lZGlhdGUgKGFzeW5jKSBtb2RlIHVuc3VwcG9ydGVkIiwKKyAgICAgICAgICAg
ICAgICByZXEtPmx1biwgY2xhc3Nlc19yZXF1ZXN0ZWQpOworICAgICAgICBjZF9zY3NpX2NtZF9j
b21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9JTlZBTElEX0NEQl9GSUVM
RCk7CisgICAgICAgIHJldHVybjsKKyAgICB9CisKKyAgICBtZW1zZXQob3V0YnVmLCAwLCByZXEt
PnJlcV9sZW4pOworICAgIGlmICgoY2xhc3Nlc19zdXBwb3J0ZWQgJiBjbGFzc2VzX3JlcXVlc3Rl
ZCkgIT0gMCkgeworICAgICAgICBpZiAoY2xhc3Nlc19yZXF1ZXN0ZWQgJiBwb3dlcl9jbGFzc19t
YXNrKSB7CisgICAgICAgICAgICBvdXRidWZbMl0gPSBDRF9HRVRfRVZFTlRfQ0xBU1NfUE9XRVJf
TUdNVDsKKyAgICAgICAgICAgIG91dGJ1ZlszXSA9ICh1aW50OF90KXBvd2VyX2NsYXNzX21hc2s7
CisKKyAgICAgICAgICAgIFNQSUNFX0RFQlVHKCJnZXRfZXZlbnRfc3RhdHVzX25vdGlmaWNhdGlv
biwgbHVuOiV1IgorICAgICAgICAgICAgICAgICAgICAgICAgIiBpbW06JXUgY2xhc3NfcmVxOjB4
JTAyeCBjbGFzc19zdXA6MHglMDJ4IgorICAgICAgICAgICAgICAgICAgICAgICAgIiBwb3dlcl9l
dmVudDoweCUwMnggcG93ZXJfY29uZDoweCUwMngiLAorICAgICAgICAgICAgICAgICAgICAgICAg
cmVxLT5sdW4sIGltbWVkLCBjbGFzc2VzX3JlcXVlc3RlZCwgY2xhc3Nlc19zdXBwb3J0ZWQsCisg
ICAgICAgICAgICAgICAgICAgICAgICBkZXYtPnBvd2VyX2V2ZW50LCBkZXYtPnBvd2VyX2NvbmQp
OworCisgICAgICAgICAgICByZXNwX2xlbiArPSBjZF9zY3NpX2NtZF9nZXRfZXZlbnRfcmVzcF9h
ZGRfcG93ZXIoZGV2LCBvdXRidWYgKyByZXNwX2xlbik7CisgICAgICAgIH0gZWxzZSBpZiAoY2xh
c3Nlc19yZXF1ZXN0ZWQgJiBtZWRpYV9jbGFzc19tYXNrKSB7CisgICAgICAgICAgICBvdXRidWZb
Ml0gPSBDRF9HRVRfRVZFTlRfQ0xBU1NfTUVESUE7CisgICAgICAgICAgICBvdXRidWZbM10gPSAo
dWludDhfdCltZWRpYV9jbGFzc19tYXNrOworCisgICAgICAgICAgICBTUElDRV9ERUJVRygiZ2V0
X2V2ZW50X3N0YXR1c19ub3RpZmljYXRpb24sIGx1bjoldSIKKyAgICAgICAgICAgICAgICAgICAg
ICAgICIgaW1tOiV1IGNsYXNzX3JlcToweCUwMnggY2xhc3Nfc3VwOjB4JTAyeCIKKyAgICAgICAg
ICAgICAgICAgICAgICAgICIgbWVkaWFfZXZlbnQ6MHglMDJ4IGxvYWRlZDogJWQiLAorICAgICAg
ICAgICAgICAgICAgICAgICAgcmVxLT5sdW4sIGltbWVkLCBjbGFzc2VzX3JlcXVlc3RlZCwgY2xh
c3Nlc19zdXBwb3J0ZWQsCisgICAgICAgICAgICAgICAgICAgICAgICBkZXYtPm1lZGlhX2V2ZW50
LCBkZXYtPmxvYWRlZCk7CisKKyAgICAgICAgICAgIHJlc3BfbGVuICs9IGNkX3Njc2lfY21kX2dl
dF9ldmVudF9yZXNwX2FkZF9tZWRpYShkZXYsIG91dGJ1ZiArIHJlc3BfbGVuKTsKKyAgICAgICAg
fQorICAgIH0gZWxzZSB7CisgICAgICAgIG91dGJ1ZlsyXSA9IENEX0dFVF9FVkVOVF9IRUFERVJf
Tk9fRVZFTlRfQVZBSUwgfCBDRF9HRVRfRVZFTlRfQ0xBU1NfTk9ORTsKKworICAgICAgICBTUElD
RV9ERUJVRygiZ2V0X2V2ZW50X3N0YXR1c19ub3RpZmljYXRpb24sIGx1bjoldSIKKyAgICAgICAg
ICAgICAgICAgICAgIiBpbW06JXUgY2xhc3NfcmVxOjB4JTAyeCBjbGFzc19zdXA6MHglMDJ4Igor
ICAgICAgICAgICAgICAgICAgICAiIG5vbmUgb2YgcmVxdWVzdGVkIGV2ZW50cyBzdXBwb3J0ZWQi
LAorICAgICAgICAgICAgICAgICAgICByZXEtPmx1biwgaW1tZWQsIGNsYXNzZXNfcmVxdWVzdGVk
LCBjbGFzc2VzX3N1cHBvcnRlZCk7CisgICAgfQorICAgIG91dGJ1ZlsxXSA9ICh1aW50OF90KShy
ZXNwX2xlbiAtIDIpOyAvKiBFdmVudCBEYXRhIExlbmd0aCBMU0IsIGxlbmd0aCBleGNsdWRpbmcg
dGhlCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGZpZWxkIGl0
c2VsZiAqLworICAgIG91dGJ1ZlszXSA9ICh1aW50OF90KWNsYXNzZXNfc3VwcG9ydGVkOworCisg
ICAgcmVxLT5pbl9sZW4gPSBNSU4ocmVxLT5yZXFfbGVuLCByZXNwX2xlbik7CisgICAgY2Rfc2Nz
aV9jbWRfY29tcGxldGVfZ29vZChkZXYsIHJlcSk7Cit9CisKKyNkZWZpbmUgQ0RfRVhUX1JFUV9F
VkVOVF9GT1JNQVRfTk9fQ0hHICAgICAgICAgIDB4MDAKKyNkZWZpbmUgQ0RfRVhUX1JFUV9FVkVO
VF9GT1JNQVRfTFVfS0VZX0RPV04gICAgIDB4MDEKKyNkZWZpbmUgQ0RfRVhUX1JFUV9FVkVOVF9G
T1JNQVRfTFVfS0VZX1VQICAgICAgIDB4MDIKKyNkZWZpbmUgQ0RfRVhUX1JFUV9FVkVOVF9GT1JN
QVRfUkVRX05PVElGWSAgICAgIDB4MDMKKworI2RlZmluZSBDRF9FWFRfUkVRX1NUQVRVU19SRUFE
WSAgICAgICAgICAgICAgICAgMHgwMAorI2RlZmluZSBDRF9FWFRfUkVRX1NUQVRVU19PVEhFUl9Q
UkVWRU5UICAgICAgICAgMHgwMQorCisjZGVmaW5lIENEX0VYVF9SRVFfQ09ERV9OT19SRVFVRVNU
ICAgICAgICAgICAgICAweDAwCisjZGVmaW5lIENEX0VYVF9SRVFfQ09ERV9PVkVSUlVOICAgICAg
ICAgICAgICAgICAweDAxCisjZGVmaW5lIENEX0VYVF9SRVFfQ09ERV9QTEFZICAgICAgICAgICAg
ICAgICAgICAweDEwMQorI2RlZmluZSBDRF9FWFRfUkVRX0NPREVfUkVXSU5EICAgICAgICAgICAg
ICAgICAgMHgxMDIKKyNkZWZpbmUgQ0RfRVhUX1JFUV9DT0RFX0ZBU1RfRlcgICAgICAgICAgICAg
ICAgIDB4MTAzCisjZGVmaW5lIENEX0VYVF9SRVFfQ09ERV9QQVVTRSAgICAgICAgICAgICAgICAg
ICAweDEwNAorI2RlZmluZSBDRF9FWFRfUkVRX0NPREVfU1RPUCAgICAgICAgICAgICAgICAgICAg
MHgxMDYKKyNkZWZpbmUgQ0RfRVhUX1JFUV9DT0RFX0FTQ0lJX0JBU0UgICAgICAgICAgICAgIDB4
MjAwIC8qIFNDU0lJIHZhbHVlIGlzIExTQiAqLworCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9z
ZW5kX2V2ZW50KENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICB1aW50
OF90ICpwYXJhbSwgKmV2ZW50OworICAgIHVpbnQzMl90IGltbWVkLCBwYXJhbV9saXN0X2xlbjsK
KyAgICB1aW50MzJfdCBldmVudF9wYXJhbV9sZW4sIG5vdGlmaWNhdGlvbl9jbGFzczsKKyAgICB1
aW50MzJfdCBleHRfcmVxX2V2ZW50LCBleHRfcmVxX3N0YXR1cywgcGVyc19wcmV2ZW50LCBleHRf
cmVxX2NvZGU7CisKKyAgICByZXEtPnhmZXJfZGlyID0gU0NTSV9YRkVSX1RPX0RFVjsKKworICAg
IGltbWVkID0gcmVxLT5jZGJbMV0gJiAweDAxOworICAgIHBhcmFtX2xpc3RfbGVuID0gKHJlcS0+
Y2RiWzhdIDw8IDgpIHwgcmVxLT5jZGJbOV07CisKKyAgICBpZiAocmVxLT5idWZfbGVuIDwgcGFy
YW1fbGlzdF9sZW4pIHsKKyAgICAgICAgU1BJQ0VfREVCVUcoInNlbmRfZXZlbnQsIGx1bjoldSBp
bnZhbGlkIHBhcmFtIGxpc3QgbGVuOjB4JXgsIGJ1Zl9sZW46MHgleCIsCisgICAgICAgICAgICAg
ICAgICAgIHJlcS0+bHVuLCBwYXJhbV9saXN0X2xlbiwgcmVxLT5idWZfbGVuKTsKKyAgICAgICAg
Y2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfSU5W
QUxJRF9QQVJBTV9MRU4pOworICAgICAgICByZXR1cm47CisgICAgfQorICAgIHBhcmFtID0gcmVx
LT5idWY7CisgICAgZXZlbnRfcGFyYW1fbGVuID0gKHBhcmFtWzBdIDw8IDgpIHwgcGFyYW1bMV07
CisKKyAgICBub3RpZmljYXRpb25fY2xhc3MgPSBwYXJhbVsyXSAmIDB4MDc7CisgICAgaWYgKG5v
dGlmaWNhdGlvbl9jbGFzcyAhPSBDRF9HRVRfRVZFTlRfQ0xBU1NfRVhURVJOQUxfUkVRKSB7Cisg
ICAgICAgIFNQSUNFX0RFQlVHKCJzZW5kX2V2ZW50LCBsdW46JXUgaW52YWxpZCBub3RpZmljYXRp
b24gY2xhc3M6MHgleCIsCisgICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBub3RpZmljYXRp
b25fY2xhc3MpOworICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwg
cmVxLCAmc2Vuc2VfY29kZV9JTlZBTElEX0NEQl9GSUVMRCk7CisgICAgICAgIHJldHVybjsKKyAg
ICB9CisKKyAgICBldmVudCA9IHBhcmFtICsgQ0RfR0VUX0VWRU5UX0hFQURFUl9MRU47CisgICAg
ZXh0X3JlcV9ldmVudCA9IGV2ZW50WzBdICYgMHhmZjsKKyAgICBleHRfcmVxX3N0YXR1cyA9IGV2
ZW50WzFdICYgMHgwZjsKKyAgICBwZXJzX3ByZXZlbnQgPSBldmVudFsxXSAmIDB4ODA7CisgICAg
ZXh0X3JlcV9jb2RlID0gKGV2ZW50WzJdIDw8IDgpIHwgZXZlbnRbM107CisKKyAgICBTUElDRV9E
RUJVRygic2VuZF9ldmVudCwgbHVuOjB4JXUgaW1tZWQ6JXUgcGFyYW1fbGVuOiV1IgorICAgICAg
ICAgICAgICAgICIgZXh0X3JlcV9ldmVudDoweCV4IGV4dF9yZXFfc3RhdHVzOjB4JXgiCisgICAg
ICAgICAgICAgICAgIiBwZXJzX3ByZXZlbnQ6MHgleCBleHRfcmVxX2NvZGU6MHgleCIsCisgICAg
ICAgICAgICAgICAgcmVxLT5sdW4sIGltbWVkLCBldmVudF9wYXJhbV9sZW4sIGV4dF9yZXFfZXZl
bnQsCisgICAgICAgICAgICAgICAgZXh0X3JlcV9zdGF0dXMsIHBlcnNfcHJldmVudCwgZXh0X3Jl
cV9jb2RlKTsKKworICAgIC8qIFRvRG86IHByb2Nlc3MgdGhlIGV2ZW50ICovCisKKyAgICBjZF9z
Y3NpX2NtZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworI2RlZmluZSBDRF9NRURJVU1f
UkVNT1ZBTF9SRVFfQUxMT1cgICAgICAgICAgICAgICAgIDB4MDAKKyNkZWZpbmUgQ0RfTUVESVVN
X1JFTU9WQUxfUkVRX1BSRVZFTlQgICAgICAgICAgICAgICAweDAxCisjZGVmaW5lIENEX01FRElV
TV9SRU1PVkFMX1JFUV9BTExPV19DSEFOR0VSICAgICAgICAgMHgwMgorI2RlZmluZSBDRF9NRURJ
VU1fUkVNT1ZBTF9SRVFfUFJFVkVOVF9DSEFOR0VSICAgICAgIDB4MDMKKworc3RhdGljIHZvaWQg
Y2Rfc2NzaV9jbWRfYWxsb3dfbWVkaXVtX3JlbW92YWwoQ2RTY3NpTFUgKmRldiwgQ2RTY3NpUmVx
dWVzdCAqcmVxKQoreworICAgIHVpbnQzMl90IHByZXZlbnQ7CisKKyAgICByZXEtPnhmZXJfZGly
ID0gU0NTSV9YRkVSX0ZST01fREVWOworCisgICAgcHJldmVudCA9IHJlcS0+Y2RiWzRdICYgMHgw
MzsKKyAgICBkZXYtPnByZXZlbnRfbWVkaWFfcmVtb3ZhbCA9IChwcmV2ZW50ID09IENEX01FRElV
TV9SRU1PVkFMX1JFUV9QUkVWRU5UIHx8CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgcHJldmVudCA9PSBDRF9NRURJVU1fUkVNT1ZBTF9SRVFfUFJFVkVOVF9DSEFOR0VSKTsKKyAg
ICByZXEtPmluX2xlbiA9IDA7CisKKyAgICBTUElDRV9ERUJVRygiYWxsb3dfbWVkaXVtX3JlbW92
YWwsIGx1bjoldSBwcmV2ZW50IGZpZWxkOjoweCUwMnggZmxhZzolZCIsCisgICAgICAgICAgICAg
ICAgcmVxLT5sdW4sIHByZXZlbnQsIGRldi0+cHJldmVudF9tZWRpYV9yZW1vdmFsKTsKKworICAg
IGNkX3Njc2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2LCByZXEpOworfQorCitzdGF0aWMgdm9pZCBj
ZF9zY3NpX2NtZF9yZXBvcnRfa2V5KENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkK
K3sKKyAgICBTUElDRV9ERUJVRygicmVwb3J0X2tleSAtIGNvbnRlbnQgcHJvdGVjdGlvbiB1bnN1
cHBvcnRlZCwgbHVuOiV1IiwgcmVxLT5sdW4pOworICAgIHJlcS0+eGZlcl9kaXIgPSBTQ1NJX1hG
RVJfTk9ORTsKKyAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAm
c2Vuc2VfY29kZV9JTlZBTElEX09QQ09ERSk7Cit9CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21k
X3NlbmRfa2V5KENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICBTUElD
RV9ERUJVRygic2VuZF9rZXkgLSBjb250ZW50IHByb3RlY3Rpb24gdW5zdXBwb3J0ZWQsIGx1bjol
dSIsIHJlcS0+bHVuKTsKKyAgICByZXEtPnhmZXJfZGlyID0gU0NTSV9YRkVSX05PTkU7CisgICAg
Y2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfSU5W
QUxJRF9PUENPREUpOworfQorCisvKiBieXRlIDEgKi8KKyNkZWZpbmUgQ0RfU1RBUlRfU1RPUF9G
TEFHX0lNTUVEICAgICAgICAgICAgICAgICAgICAweDAxCisKKy8qIGJ5dGUgNCAqLworI2RlZmlu
ZSBDRF9TVEFSVF9TVE9QX0ZMQUdfU1RBUlQgICAgICAgICAgICAgICAgICAgIDB4MDEKKyNkZWZp
bmUgQ0RfU1RBUlRfU1RPUF9GTEFHX0xPRUogICAgICAgICAgICAgICAgICAgICAweDAyCisKKy8q
IFBPV0VSIENPTkRJVElPTiBmaWVsZCB2YWx1ZXMgKi8KKyNkZWZpbmUgQ0RfU1RBUlRfU1RPUF9Q
T1dFUl9DT05EX1NUQVJUX1ZBTElEICAgICAgICAweDAwCisjZGVmaW5lIENEX1NUQVJUX1NUT1Bf
UE9XRVJfQ09ORF9BQ1RJVkUgICAgICAgICAgICAgMHgwMQorI2RlZmluZSBDRF9TVEFSVF9TVE9Q
X1BPV0VSX0NPTkRfSURMRSAgICAgICAgICAgICAgIDB4MDIKKyNkZWZpbmUgQ0RfU1RBUlRfU1RP
UF9QT1dFUl9DT05EX1NUQU5EQlkgICAgICAgICAgICAweDAzCisjZGVmaW5lIENEX1NUQVJUX1NU
T1BfUE9XRVJfQ09ORF9MVV9DT05UUk9MICAgICAgICAgMHgwNworI2RlZmluZSBDRF9TVEFSVF9T
VE9QX1BPV0VSX0NPTkRfRk9SQ0VfSURMRV8wICAgICAgIDB4MGEKKyNkZWZpbmUgQ0RfU1RBUlRf
U1RPUF9QT1dFUl9DT05EX0ZPUkNFX1NUQU5EQllfMCAgICAweDBiCisKK3N0YXRpYyBpbmxpbmUg
Y29uc3QgY2hhciAqY2Rfc2NzaV9zdGFydF9zdG9wX3Bvd2VyX2NvbmRfbmFtZSh1aW50MzJfdCBw
b3dlcl9jb25kKQoreworICAgIHN3aXRjaCAocG93ZXJfY29uZCkgeworICAgIGNhc2UgQ0RfU1RB
UlRfU1RPUF9QT1dFUl9DT05EX1NUQVJUX1ZBTElEOgorICAgICAgICByZXR1cm4gIlNUQVJUX1ZB
TElEIjsKKyAgICBjYXNlIENEX1NUQVJUX1NUT1BfUE9XRVJfQ09ORF9BQ1RJVkU6CisgICAgICAg
IHJldHVybiAiQUNUSVZFIjsKKyAgICBjYXNlIENEX1NUQVJUX1NUT1BfUE9XRVJfQ09ORF9JRExF
OgorICAgICAgICByZXR1cm4gIklETEUiOworICAgIGNhc2UgQ0RfU1RBUlRfU1RPUF9QT1dFUl9D
T05EX1NUQU5EQlk6CisgICAgICAgIHJldHVybiAiU1RBTkRCWSI7CisgICAgY2FzZSBDRF9TVEFS
VF9TVE9QX1BPV0VSX0NPTkRfTFVfQ09OVFJPTDoKKyAgICAgICAgcmV0dXJuICJMVV9DT05UUk9M
IjsKKyAgICBjYXNlIENEX1NUQVJUX1NUT1BfUE9XRVJfQ09ORF9GT1JDRV9JRExFXzA6CisgICAg
ICAgIHJldHVybiAiRk9SQ0VfSURMRV8wIjsKKyAgICBjYXNlIENEX1NUQVJUX1NUT1BfUE9XRVJf
Q09ORF9GT1JDRV9TVEFOREJZXzA6CisgICAgICAgIHJldHVybiAiRk9SQ0VfU1RBTkRCWV8wIjsK
KyAgICBkZWZhdWx0OgorICAgICAgICByZXR1cm4gIlJFU0VSVkVEIjsKKyAgICB9Cit9CisKK3N0
YXRpYyB2b2lkIGNkX3Njc2lfY21kX3N0YXJ0X3N0b3BfdW5pdChDZFNjc2lMVSAqZGV2LCBDZFNj
c2lSZXF1ZXN0ICpyZXEpCit7CisgICAgZ2Jvb2xlYW4gaW1tZWQsIHN0YXJ0LCBsb2FkX2VqZWN0
OworICAgIHVpbnQzMl90IHBvd2VyX2NvbmQ7CisKKyAgICByZXEtPnhmZXJfZGlyID0gU0NTSV9Y
RkVSX05PTkU7CisgICAgcmVxLT5pbl9sZW4gPSAwOworCisgICAgaW1tZWQgPSAocmVxLT5jZGJb
MV0gJiBDRF9TVEFSVF9TVE9QX0ZMQUdfSU1NRUQpID8gVFJVRSA6IEZBTFNFOworICAgIHN0YXJ0
ID0gKHJlcS0+Y2RiWzRdICYgQ0RfU1RBUlRfU1RPUF9GTEFHX1NUQVJUKSA/IFRSVUUgOiBGQUxT
RTsKKyAgICBsb2FkX2VqZWN0ID0gKHJlcS0+Y2RiWzRdICYgQ0RfU1RBUlRfU1RPUF9GTEFHX0xP
RUopID8gVFJVRSA6IEZBTFNFOworICAgIHBvd2VyX2NvbmQgPSByZXEtPmNkYls0XSA+PiA0Owor
CisgICAgU1BJQ0VfREVCVUcoInN0YXJ0X3N0b3BfdW5pdCwgbHVuOjB4JXUiCisgICAgICAgICAg
ICAgICAgIiBpbW1lZDolZCBzdGFydDolZCBsb2FkX2VqZWN0OiVkIHBvd2VyX2NvbmQ6MHgleCgl
cykiLAorICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBpbW1lZCwgc3RhcnQsIGxvYWRfZWplY3Qs
IHBvd2VyX2NvbmQsCisgICAgICAgICAgICAgICAgY2Rfc2NzaV9zdGFydF9zdG9wX3Bvd2VyX2Nv
bmRfbmFtZShwb3dlcl9jb25kKSk7CisKKyAgICBzd2l0Y2ggKHBvd2VyX2NvbmQpIHsKKyAgICBj
YXNlIENEX1NUQVJUX1NUT1BfUE9XRVJfQ09ORF9TVEFSVF9WQUxJRDoKKyAgICAgICAgaWYgKCFz
dGFydCkgeyAvKiBzdG9wIHRoZSB1bml0ICovCisgICAgICAgICAgICBpZiAobG9hZF9lamVjdCkg
eyAvKiBlamVjdCBtZWRpdW0gKi8KKyAgICAgICAgICAgICAgICBpZiAoZGV2LT5wcmV2ZW50X21l
ZGlhX3JlbW92YWwpIHsKKyAgICAgICAgICAgICAgICAgICAgU1BJQ0VfREVCVUcoInN0YXJ0X3N0
b3BfdW5pdCwgbHVuOjB4JXUiCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIgcHJl
dmVudF9tZWRpYV9yZW1vdmFsIHNldCwgZWplY3QgZmFpbGVkIiwgcmVxLT5sdW4pOworICAgICAg
ICAgICAgICAgICAgICBjZF9zY3NpX2NtZF9jb21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAm
c2Vuc2VfY29kZV9NRURJVU1fUkVNT1ZBTF9QUkVWRU5URUQpOworICAgICAgICAgICAgICAgICAg
ICByZXR1cm47CisgICAgICAgICAgICAgICAgfQorICAgICAgICAgICAgICAgIFNQSUNFX0RFQlVH
KCJzdGFydF9zdG9wX3VuaXQsIGx1bjoweCV1IGVqZWN0IiwgcmVxLT5sdW4pOworICAgICAgICAg
ICAgICAgIGNkX3Njc2lfbHVfdW5sb2FkKGRldik7CisgICAgICAgICAgICAgICAgY2Rfc2NzaV9k
ZXZfY2hhbmdlZChkZXYtPnRndC0+dXNlcl9kYXRhLCByZXEtPmx1bik7CisgICAgICAgICAgICB9
CisgICAgICAgICAgICBkZXYtPnBvd2VyX2NvbmQgPSBDRF9TQ1NJX1BPV0VSX1NUT1BQRUQ7Cisg
ICAgICAgICAgICBTUElDRV9ERUJVRygic3RhcnRfc3RvcF91bml0LCBsdW46MHgldSBzdG9wcGVk
IiwgcmVxLT5sdW4pOworICAgICAgICB9IGVsc2UgeyAvKiBzdGFydCB0aGUgdW5pdCAqLworICAg
ICAgICAgICAgZGV2LT5wb3dlcl9jb25kID0gQ0RfU0NTSV9QT1dFUl9BQ1RJVkU7CisgICAgICAg
ICAgICBTUElDRV9ERUJVRygic3RhcnRfc3RvcF91bml0LCBsdW46MHgldSBzdGFydGVkIiwgcmVx
LT5sdW4pOworCisgICAgICAgICAgICBpZiAobG9hZF9lamVjdCkgeyAvKiBsb2FkIG1lZGl1bSAq
LworICAgICAgICAgICAgICAgIFNQSUNFX0RFQlVHKCJzdGFydF9zdG9wX3VuaXQsIGx1bjoweCV1
IGxvYWQgd2l0aCBubyBtZWRpYSIsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxLT5s
dW4pOworICAgICAgICAgICAgICAgIGNkX3Njc2lfbHVfbG9hZChkZXYsIE5VTEwpOworICAgICAg
ICAgICAgICAgIGNkX3Njc2lfZGV2X2NoYW5nZWQoZGV2LT50Z3QtPnVzZXJfZGF0YSwgcmVxLT5s
dW4pOworICAgICAgICAgICAgfQorICAgICAgICB9CisgICAgICAgIGJyZWFrOworICAgIGNhc2Ug
Q0RfU1RBUlRfU1RPUF9QT1dFUl9DT05EX0FDVElWRToKKyAgICAgICAgLyogbm90IGVycm9yIHRv
IHNwZWNpZnkgdHJhbnNpdGlvbiB0byB0aGUgY3VycmVudCBwb3dlciBjb25kaXRpb24gKi8KKyAg
ICAgICAgZGV2LT5wb3dlcl9jb25kID0gQ0RfU0NTSV9QT1dFUl9BQ1RJVkU7CisgICAgICAgIFNQ
SUNFX0RFQlVHKCJzdGFydF9zdG9wX3VuaXQsIGx1bjoweCV1IGFjdGl2ZSIsIHJlcS0+bHVuKTsK
KyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBDRF9TVEFSVF9TVE9QX1BPV0VSX0NPTkRfSURMRToK
KyAgICBjYXNlIENEX1NUQVJUX1NUT1BfUE9XRVJfQ09ORF9GT1JDRV9JRExFXzA6CisgICAgICAg
IGRldi0+cG93ZXJfY29uZCA9IENEX1NDU0lfUE9XRVJfSURMRTsKKyAgICAgICAgU1BJQ0VfREVC
VUcoInN0YXJ0X3N0b3BfdW5pdCwgbHVuOjB4JXUgaWRsZSIsIHJlcS0+bHVuKTsKKyAgICAgICAg
YnJlYWs7CisgICAgY2FzZSBDRF9TVEFSVF9TVE9QX1BPV0VSX0NPTkRfU1RBTkRCWToKKyAgICBj
YXNlIENEX1NUQVJUX1NUT1BfUE9XRVJfQ09ORF9GT1JDRV9TVEFOREJZXzA6CisgICAgICAgIGRl
di0+cG93ZXJfY29uZCA9IENEX1NDU0lfUE9XRVJfU1RBTkRCWTsKKyAgICAgICAgU1BJQ0VfREVC
VUcoInN0YXJ0X3N0b3BfdW5pdCwgbHVuOjB4JXUgc3RhbmRieSIsIHJlcS0+bHVuKTsKKyAgICAg
ICAgYnJlYWs7CisgICAgY2FzZSBDRF9TVEFSVF9TVE9QX1BPV0VSX0NPTkRfTFVfQ09OVFJPTDoK
KyAgICAgICAgYnJlYWs7CisgICAgZGVmYXVsdDoKKyAgICAgICAgY2Rfc2NzaV9jbWRfY29tcGxl
dGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfSU5WQUxJRF9DREJfRklFTEQpOwor
ICAgICAgICByZXR1cm47CisgICAgfQorICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2
LCByZXEpOworfQorCisjZGVmaW5lIENEX1BFUkZfVFlQRV9QRVJGT1JNQU5DRSAgICAgICAgICAg
ICAgICAweDAwCisjZGVmaW5lIENEX1BFUkZfVFlQRV9VTlVTQUJMRV9BUkVBICAgICAgICAgICAg
ICAweDAxCisjZGVmaW5lIENEX1BFUkZfVFlQRV9ERUZFQ1RfU1RBVFVTICAgICAgICAgICAgICAw
eDAyCisjZGVmaW5lIENEX1BFUkZfVFlQRV9XUklURV9TUEVFRCAgICAgICAgICAgICAgICAweDAz
CisKKyNkZWZpbmUgQ0RfUEVSRl9IRUFERVJfTEVOICAgICAgICAgICAgICAgICAgICAgIDgKKwor
I2RlZmluZSBDRF9QRVJGX1RZUEVfUEVSRk9STUFOQ0VfREVTQ1JfTEVOICAgICAgMTYKKworI2Rl
ZmluZSBDRF9QRVJGX1RZUEVfUEVSRk9STUFOQ0VfUkVQT1JUX05PTUlOQUwgMHgwMAorI2RlZmlu
ZSBDRF9QRVJGX1RZUEVfUEVSRk9STUFOQ0VfUkVQT1JUX0FMTCAgICAgMHgwMQorI2RlZmluZSBD
RF9QRVJGX1RZUEVfUEVSRk9STUFOQ0VfUkVQT1JUX0VYQ0VQVCAgMHgxMAorCisKK3N0YXRpYyB2
b2lkIGNkX3Njc2lfZ2V0X3BlcmZvcm1hbmNlX3Jlc3BfZW1wdHkoQ2RTY3NpTFUgKmRldiwgQ2RT
Y3NpUmVxdWVzdCAqcmVxLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB1aW50MzJfdCB0eXBlLCB1aW50MzJfdCBkYXRhX3R5cGUsCisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQzMl90IG1heF9udW1fZGVzY3Ip
Cit7CisgICAgdWludDhfdCAqb3V0YnVmID0gcmVxLT5idWY7CisgICAgdWludDMyX3Qgd3JpdGUg
PSAoZGF0YV90eXBlID4+IDIpICYgMHgwMTsKKworICAgIG1lbXNldChvdXRidWYsIDAsIENEX1BF
UkZfSEVBREVSX0xFTik7CisgICAgaWYgKHdyaXRlKSB7CisgICAgICAgIG91dGJ1Zls0XSA9IDB4
MDI7CisgICAgfQorICAgIHJlcS0+aW5fbGVuID0gQ0RfUEVSRl9IRUFERVJfTEVOOworCisgICAg
U1BJQ0VfREVCVUcoImdldF9wZXJmb3JtYW5jZSwgbHVuOiV1IgorICAgICAgICAgICAgICAgICIg
dHlwZToweCV4IGRhdGFfdHlwZToweCV4IC0gc2VuZGluZyBlbXB0eSByZXNwb25zZSIsCisgICAg
ICAgICAgICAgICAgcmVxLT5sdW4sIHR5cGUsIGRhdGFfdHlwZSk7CisKKyAgICBjZF9zY3NpX2Nt
ZF9jb21wbGV0ZV9nb29kKGRldiwgcmVxKTsKK30KKworc3RhdGljIHZvaWQgY2Rfc2NzaV9nZXRf
cGVyZm9ybWFuY2VfcmVzcF9wZXJmb3JtYW5jZShDZFNjc2lMVSAqZGV2LCBDZFNjc2lSZXF1ZXN0
ICpyZXEsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHVpbnQzMl90IHN0YXJ0X2xiYSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgdWludDMyX3QgZGF0YV90eXBlLAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50MzJfdCBtYXhfbnVtX2Rl
c2NyKQoreworICAgIHVpbnQ4X3QgKm91dGJ1ZiA9IHJlcS0+YnVmLCAqcGVyZl9kZXNjOworICAg
IHVpbnQzMl90IHJlc3BfbGVuID0gQ0RfUEVSRl9IRUFERVJfTEVOICsKKyAgICAgICAgICAgICAg
ICAgICAgICAgIENEX1BFUkZfVFlQRV9QRVJGT1JNQU5DRV9ERVNDUl9MRU47CisgICAgdWludDMy
X3QgcGVyZl9kYXRhX2xlbiA9IHJlc3BfbGVuIC0gNDsgLyogbm90IGluY2wuIFBlcmYgRGF0YSBM
ZW5ndGggKi8KKyAgICB1aW50MzJfdCBwZXJmX2tiID0gMTAwMDA7CisgICAgdWludDMyX3QgZW5k
X2xiYSA9IGRldi0+bnVtX2Jsb2NrcyAtIDE7CisgICAgdWludDMyX3QgZXhjZXB0LCB3cml0ZSwg
dG9sZXJhbmNlOworCisgICAgZXhjZXB0ID0gZGF0YV90eXBlICYgMHgwMzsKKyAgICBpZiAoZXhj
ZXB0ICE9IENEX1BFUkZfVFlQRV9QRVJGT1JNQU5DRV9SRVBPUlRfQUxMKSB7CisgICAgICAgIHN0
YXJ0X2xiYSA9IDA7CisgICAgfQorICAgIHdyaXRlID0gKGRhdGFfdHlwZSA+PiAyKSAmIDB4MDE7
CisgICAgdG9sZXJhbmNlID0gKGRhdGFfdHlwZSA+PiAzKSAmIDB4MDM7CisKKyAgICBTUElDRV9E
RUJVRygiZ2V0X3BlcmZvcm1hbmNlLCBsdW46JXUiCisgICAgICAgICAgICAgICAgIiBwZXJmb3Jt
YW5jZSB0eXBlOjB4MDAgZGF0YV90eXBlOjB4JXgiCisgICAgICAgICAgICAgICAgIiBleGNlcHQ6
MHgleCB3cml0ZToweCV4IHRvbGVyYW5jZToweCV4IgorICAgICAgICAgICAgICAgICIgbWF4X251
bToldSIsCisgICAgICAgICAgICAgICAgcmVxLT5sdW4sIGRhdGFfdHlwZSwgZXhjZXB0LCB3cml0
ZSwKKyAgICAgICAgICAgICAgICB0b2xlcmFuY2UsIG1heF9udW1fZGVzY3IpOworCisgICAgaWYg
KHdyaXRlKSB7CisgICAgICAgIFNQSUNFX0RFQlVHKCJnZXRfcGVyZm9ybWFuY2UsIGx1bjoldSIK
KyAgICAgICAgICAgICAgICAgICAgIiBwZXJmb3JtYW5jZSB0eXBlOjB4MDAgZGF0YV90eXBlOjB4
JXggLSB3cml0ZSB1bnN1cHBvcnRlZCIsCisgICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBk
YXRhX3R5cGUpOworICAgICAgICBjZF9zY3NpX2dldF9wZXJmb3JtYW5jZV9yZXNwX2VtcHR5KGRl
diwgcmVxLCBDRF9QRVJGX1RZUEVfUEVSRk9STUFOQ0UsCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgZGF0YV90eXBlLCBtYXhfbnVtX2Rlc2NyKTsKKyAgICAgICAg
cmV0dXJuOworICAgIH0KKworICAgIG1lbXNldChvdXRidWYsIDAsIHJlc3BfbGVuKTsKKworICAg
IG91dGJ1ZlswXSA9IChwZXJmX2RhdGFfbGVuID4+IDI0KSAmIDB4ZmY7CisgICAgb3V0YnVmWzFd
ID0gKHBlcmZfZGF0YV9sZW4gPj4gMTYpICYgMHhmZjsKKyAgICBvdXRidWZbMl0gPSAocGVyZl9k
YXRhX2xlbiA+PiA4KSAmIDB4ZmY7CisgICAgb3V0YnVmWzNdID0gcGVyZl9kYXRhX2xlbiAmIDB4
ZmY7CisKKyAgICBwZXJmX2Rlc2MgPSBvdXRidWYgKyBDRF9QRVJGX0hFQURFUl9MRU47CisKKyAg
ICBwZXJmX2Rlc2NbMF0gPSAoc3RhcnRfbGJhID4+IDI0KSAmIDB4ZmY7CisgICAgcGVyZl9kZXNj
WzFdID0gKHN0YXJ0X2xiYSA+PiAxNikgJiAweGZmOworICAgIHBlcmZfZGVzY1syXSA9IChzdGFy
dF9sYmEgPj4gOCkgJiAweGZmOworICAgIHBlcmZfZGVzY1szXSA9IHN0YXJ0X2xiYSAmIDB4ZmY7
CisKKyAgICBwZXJmX2Rlc2NbNF0gPSAocGVyZl9rYiA+PiAyNCkgJiAweGZmOworICAgIHBlcmZf
ZGVzY1s1XSA9IChwZXJmX2tiID4+IDE2KSAmIDB4ZmY7CisgICAgcGVyZl9kZXNjWzZdID0gKHBl
cmZfa2IgPj4gOCkgJiAweGZmOworICAgIHBlcmZfZGVzY1s3XSA9IHBlcmZfa2IgJiAweGZmOwor
CisgICAgcGVyZl9kZXNjWzhdID0gKGVuZF9sYmEgPj4gMjQpICYgMHhmZjsKKyAgICBwZXJmX2Rl
c2NbOV0gPSAoZW5kX2xiYSA+PiAxNikgJiAweGZmOworICAgIHBlcmZfZGVzY1sxMF0gPSAoZW5k
X2xiYSA+PiA4KSAmIDB4ZmY7CisgICAgcGVyZl9kZXNjWzExXSA9IGVuZF9sYmEgJiAweGZmOwor
CisgICAgcGVyZl9kZXNjWzEyXSA9IChwZXJmX2tiID4+IDI0KSAmIDB4ZmY7CisgICAgcGVyZl9k
ZXNjWzEzXSA9IChwZXJmX2tiID4+IDE2KSAmIDB4ZmY7CisgICAgcGVyZl9kZXNjWzE0XSA9IChw
ZXJmX2tiID4+IDgpICYgMHhmZjsKKyAgICBwZXJmX2Rlc2NbMTVdID0gcGVyZl9rYiAmIDB4ZmY7
CisKKyAgICByZXEtPnJlcV9sZW4gPSBDRF9QRVJGX0hFQURFUl9MRU4gKworICAgICAgICAgICAg
ICAgICAgIChtYXhfbnVtX2Rlc2NyICogQ0RfUEVSRl9UWVBFX1BFUkZPUk1BTkNFX0RFU0NSX0xF
Tik7CisKKyAgICByZXEtPmluX2xlbiA9IE1JTihyZXEtPnJlcV9sZW4sIHJlc3BfbGVuKTsKKwor
ICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2LCByZXEpOworfQorCitzdGF0aWMgdm9p
ZCBjZF9zY3NpX2NtZF9nZXRfcGVyZm9ybWFuY2UoQ2RTY3NpTFUgKmRldiwgQ2RTY3NpUmVxdWVz
dCAqcmVxKQoreworICAgIHVpbnQzMl90IGRhdGFfdHlwZSwgbWF4X251bV9kZXNjciwgc3RhcnRf
bGJhLCB0eXBlOworCisgICAgcmVxLT54ZmVyX2RpciA9IFNDU0lfWEZFUl9GUk9NX0RFVjsKKwor
ICAgIGRhdGFfdHlwZSA9IHJlcS0+Y2RiWzFdICYgMHgwZjsKKyAgICBzdGFydF9sYmEgPSAocmVx
LT5jZGJbMl0gPDwgMjQpIHwKKyAgICAgICAgICAgICAgICAocmVxLT5jZGJbM10gPDwgMTYpIHwK
KyAgICAgICAgICAgICAgICAocmVxLT5jZGJbNF0gPDwgOCkgfAorICAgICAgICAgICAgICAgICBy
ZXEtPmNkYls1XTsKKyAgICBtYXhfbnVtX2Rlc2NyID0gKHJlcS0+Y2RiWzhdIDw8IDgpIHwgcmVx
LT5jZGJbOV07CisgICAgdHlwZSA9IHJlcS0+Y2RiWzEwXTsKKworICAgIHN3aXRjaCAodHlwZSkg
eworICAgIGNhc2UgQ0RfUEVSRl9UWVBFX1BFUkZPUk1BTkNFOgorICAgICAgICBjZF9zY3NpX2dl
dF9wZXJmb3JtYW5jZV9yZXNwX3BlcmZvcm1hbmNlKGRldiwgcmVxLCBzdGFydF9sYmEsCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YV90eXBlLCBt
YXhfbnVtX2Rlc2NyKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBDRF9QRVJGX1RZUEVfVU5V
U0FCTEVfQVJFQTogLyogbm90IHdyaXRhYmxlICovCisgICAgY2FzZSBDRF9QRVJGX1RZUEVfREVG
RUNUX1NUQVRVUzogLyogbm90IHJlc3RyaWN0ZWQgb3ZlcndyaXRlIG1lZGlhICovCisgICAgY2Fz
ZSBDRF9QRVJGX1RZUEVfV1JJVEVfU1BFRUQ6IC8qIHVuc3VwcG9ydGVkLCBpcnJlbGV2YW50ICov
CisgICAgZGVmYXVsdDoKKyAgICAgICAgU1BJQ0VfREVCVUcoImdldF9wZXJmb3JtYW5jZSwgbHVu
OiV1IgorICAgICAgICAgICAgICAgICAgICAiIHVuc3VwcG9ydGVkIHR5cGU6MHgleCIKKyAgICAg
ICAgICAgICAgICAgICAgIiBkYXRhX3R5cGU6MHgleCBtYXhfbnVtOiV1IiwKKyAgICAgICAgICAg
ICAgICAgICAgcmVxLT5sdW4sIHR5cGUsIGRhdGFfdHlwZSwgbWF4X251bV9kZXNjcik7CisgICAg
ICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2Rl
X0lOVkFMSURfQ0RCX0ZJRUxEKTsKKyAgICAgICAgcmV0dXJuOworICAgIH0KK30KKworI2RlZmlu
ZSBDRF9NRUNIQU5JU01fU1RBVFVTX0hEUl9MRU4gICAgIDgKKworLyogYnl0ZSAwICovCisjZGVm
aW5lIENEX0NIQU5HRVJfRkFVTFRfRkxBRyAgICAgICAgICAgMHg4MAorCisjZGVmaW5lIENEX0NI
QU5HRVJfUkVBRFkgICAgICAgICAgICAgICAgMHgwMAorI2RlZmluZSBDRF9DSEFOR0VSX0xPQURJ
TkcgICAgICAgICAgICAgIDB4MDEKKyNkZWZpbmUgQ0RfQ0hBTkdFUl9VTkxPQURJTkcgICAgICAg
ICAgICAweDAyCisjZGVmaW5lIENEX0NIQU5HRVJfSU5JVElBTElaSU5HICAgICAgICAgMHgwMwor
CisvKiBieXRlIDEgKi8KKyNkZWZpbmUgQ0RfQ0hBTkdFUl9ET09SX09QRU5fRkxBRyAgICAgICAw
eDEwCisKKyNkZWZpbmUgQ0RfTUVDSEFOSVNNX1NUQVRFX0lETEUgICAgICAgICAweDAwCisjZGVm
aW5lIENEX01FQ0hBTklTTV9TVEFURV9QTEFZSU5HICAgICAgMHgwMQorI2RlZmluZSBDRF9NRUNI
QU5JU01fU1RBVEVfU0NBTk5JTkcgICAgIDB4MDIKKy8qIEFDVElWRTogd2l0aCBJbml0aWF0b3Is
IENvbXBvc2l0ZSBvciBPdGhlciBwb3J0cworICAoaS5lLiBSRUFELCBQTEFZIENELCBTQ0FOIGR1
cmluZyBQTEFZIENEKSAqLworI2RlZmluZSBDRF9NRUNIQU5JU01fU1RBVEVfQUNUSVZFICAgICAg
IDB4MDMKKyNkZWZpbmUgQ0RfTUVDSEFOSVNNX1NUQVRFX05PX0lORk8gICAgICAweDA3CisKKy8q
IHNsb3RzICovCisjZGVmaW5lIENEX01FQ0hBTklTTV9TVEFUVVNfU0xPVF9MRU4gICAgNAorCisj
ZGVmaW5lIENEX01FQ0hBTklTTV9TTE9UX0RJU0tfQ0hBTkdFRCAgMHgwMQorI2RlZmluZSBDRF9N
RUNIQU5JU01fU0xPVF9ESVNLX1BSRVNFTlQgIDB4ODAKKyNkZWZpbmUgQ0RfTUVDSEFOSVNNX1NM
T1RfRElTS19DV1BfViAgICAweDAyCisjZGVmaW5lIENEX01FQ0hBTklTTV9TTE9UX0RJU0tfQ1dQ
ICAgICAgMHgwMQorCitzdGF0aWMgdm9pZCBjZF9zY3NpX2NtZF9tZWNoYW5pc21fc3RhdHVzKENk
U2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICB1aW50OF90ICpvdXRidWYg
PSByZXEtPmJ1ZjsKKyAgICB1aW50MzJfdCByZXNwX2xlbiA9IENEX01FQ0hBTklTTV9TVEFUVVNf
SERSX0xFTjsKKworICAgIHJlcS0+eGZlcl9kaXIgPSBTQ1NJX1hGRVJfRlJPTV9ERVY7CisKKyAg
ICByZXEtPnJlcV9sZW4gPSAocmVxLT5jZGJbOF0gPDwgOCkgfCByZXEtPmNkYls5XTsKKyAgICBt
ZW1zZXQob3V0YnVmLCAwLCByZXEtPnJlcV9sZW4pOworCisgICAgLyogRm9yIG5vbi1jaGFuZ2Vy
IGRldmljZXMgdGhlIGN1cmVudCBzbG90IG51bWJlciBmaWVsZCBpcyByZXNlcnZlZCwgc2V0IG9u
bHkgc3RhdHVzICovCisgICAgb3V0YnVmWzBdIHw9IChDRF9DSEFOR0VSX1JFQURZIDw8IDUpOwor
CisgICAgb3V0YnVmWzFdIHw9ICghZGV2LT5sb2FkZWQpID8gQ0RfQ0hBTkdFUl9ET09SX09QRU5f
RkxBRyA6IDA7CisgICAgb3V0YnVmWzFdIHw9IChkZXYtPnBvd2VyX2NvbmQgPT0gQ0RfUE9XRVJf
U1RBVFVTX0FDVElWRSkgPworICAgICAgICAgICAgICAgICAoQ0RfTUVDSEFOSVNNX1NUQVRFX0FD
VElWRSA8PCA1KSA6IChDRF9NRUNIQU5JU01fU1RBVEVfSURMRSA8PCA1KTsKKworICAgIC8qIEZv
ciBub24tY2hhbmdlciBkZXZpY2VzIHRoZSBudW1iZXIgb2Ygc2xvdCB0YWJsZXMgcmV0dXJuZWQg
c2hhbGwgYmUgemVybywgc28gd2UgbGVhdmUKKyAgICAgICBib3RoICdOdW1iZXIgb2YgU2xvdHMg
QXZhaWxhYmxlJyBhbmQgJ0xlbmd0aCBvZiBTbG90IFRhYmxlJyBmaWVsZHMgYXMgemVyb3MgKi8K
KworICAgIHJlcS0+aW5fbGVuID0gTUlOKHJlcS0+cmVxX2xlbiwgcmVzcF9sZW4pOworCisgICAg
U1BJQ0VfREVCVUcoIm1lY2hhbmlzbV9zdGF0dXMsIGx1bjoldSIsIHJlcS0+bHVuKTsKKworICAg
IGNkX3Njc2lfY21kX2NvbXBsZXRlX2dvb2QoZGV2LCByZXEpOworfQorCitzdGF0aWMgdm9pZCBj
ZF9zY3NpX3JlYWRfYXN5bmNfY29tcGxldGUoR09iamVjdCAqc3JjX29iamVjdCwKKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBHQXN5bmNSZXN1bHQgKnJlc3VsdCwKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBncG9pbnRlciB1c2VyX2RhdGEp
Cit7CisgICAgR0ZpbGVJbnB1dFN0cmVhbSAqc3RyZWFtID0gR19GSUxFX0lOUFVUX1NUUkVBTShz
cmNfb2JqZWN0KTsKKyAgICBDZFNjc2lSZXF1ZXN0ICpyZXEgPSAoQ2RTY3NpUmVxdWVzdCAqKXVz
ZXJfZGF0YTsKKyAgICBDZFNjc2lUYXJnZXQgKnN0ID0gKENkU2NzaVRhcmdldCAqKXJlcS0+cHJp
dl9kYXRhOworICAgIENkU2NzaUxVICpkZXYgPSAmc3QtPnVuaXRzW3JlcS0+bHVuXTsKKyAgICBH
RXJyb3IgKmVycm9yID0gTlVMTDsKKyAgICBnc2l6ZSBieXRlc19yZWFkOworICAgIGdib29sZWFu
IGZpbmlzaGVkOworCisgICAgcmVxLT5yZXFfc3RhdGUgPSBTQ1NJX1JFUV9DT01QTEVURTsKKyAg
ICByZXEtPmNhbmNlbF9pZCA9IDA7CisKKy8vICAgIGdfYXNzZXJ0KHN0cmVhbSA9PSBkZXYtPnN0
cmVhbSk7CisgICAgaWYgKHN0cmVhbSAhPSBkZXYtPnN0cmVhbSkgeworICAgICAgICB1aW50MzJf
dCBvcGNvZGUgPSAodWludDMyX3QpcmVxLT5jZGJbMF07CisgICAgICAgIFNQSUNFX0RFQlVHKCJy
ZWFkX2FzeW5jX2NvbXBsZXRlIEJBRCBTVFJFQU0sIGx1bjogJXUiCisgICAgICAgICAgICAgICAg
ICAgICIgcmVxOiAlIiBHX0dVSU5UNjRfRk9STUFUICIgb3A6IDB4JTAyeCIsCisgICAgICAgICAg
ICAgICAgICAgIHJlcS0+bHVuLCByZXEtPnJlcV9sZW4sIG9wY29kZSk7CisgICAgICAgIGNkX3Nj
c2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX1RBUkdFVF9G
QUlMVVJFKTsKKyAgICAgICAgY2Rfc2NzaV9kZXZfcmVxdWVzdF9jb21wbGV0ZShzdC0+dXNlcl9k
YXRhLCByZXEpOworICAgICAgICByZXR1cm47CisgICAgfQorCisgICAgYnl0ZXNfcmVhZCA9IGdf
aW5wdXRfc3RyZWFtX3JlYWRfZmluaXNoKEdfSU5QVVRfU1RSRUFNKHN0cmVhbSksIHJlc3VsdCwg
JmVycm9yKTsKKyAgICBmaW5pc2hlZCA9IGJ5dGVzX3JlYWQgPiAwOworICAgIGlmIChmaW5pc2hl
ZCkgeworICAgICAgICBTUElDRV9ERUJVRygicmVhZF9hc3luY19jb21wbGV0ZSwgbHVuOiAldSIK
KyAgICAgICAgICAgICAgICAgICAgIiBmaW5pc2hlZDogJWQgYnl0ZXNfcmVhZDogJSIgR19HVUlO
VDY0X0ZPUk1BVAorICAgICAgICAgICAgICAgICAgICAiIHJlcTogJSIgIEdfR1VJTlQ2NF9GT1JN
QVQsCisgICAgICAgICAgICAgICAgICAgIHJlcS0+bHVuLCBmaW5pc2hlZCwgKHVpbnQ2NF90KWJ5
dGVzX3JlYWQsIHJlcS0+cmVxX2xlbik7CisKKyAgICAgICAgcmVxLT5pbl9sZW4gPSBNSU4oYnl0
ZXNfcmVhZCwgcmVxLT5yZXFfbGVuKTsKKyAgICAgICAgcmVxLT5zdGF0dXMgPSBHT09EOworICAg
IH0gZWxzZSB7CisgICAgICAgIGlmIChlcnJvciAhPSBOVUxMKSB7CisgICAgICAgICAgICBTUElD
RV9FUlJPUigiZ19pbnB1dF9zdHJlYW1fcmVhZF9maW5pc2ggZmFpbGVkOiAlcyIsIGVycm9yLT5t
ZXNzYWdlKTsKKyAgICAgICAgICAgIGdfY2xlYXJfZXJyb3IgKCZlcnJvcik7CisgICAgICAgIH0g
ZWxzZSB7CisgICAgICAgICAgICBTUElDRV9FUlJPUigiZ19pbnB1dF9zdHJlYW1fcmVhZF9maW5p
c2ggZmFpbGVkIChubyBlcnIgcHJvdmlkZWQpIik7CisgICAgICAgIH0KKyAgICAgICAgcmVxLT5p
bl9sZW4gPSAwOworICAgICAgICByZXEtPnN0YXR1cyA9IEdPT0Q7CisgICAgfQorICAgIGNkX3Nj
c2lfZGV2X3JlcXVlc3RfY29tcGxldGUoc3QtPnVzZXJfZGF0YSwgcmVxKTsKK30KKworc3RhdGlj
IHZvaWQgY2Rfc2NzaV9yZWFkX2FzeW5jX2NhbmNlbGVkKEdDYW5jZWxsYWJsZSAqY2FuY2VsbGFi
bGUsIGdwb2ludGVyIHVzZXJfZGF0YSkKK3sKKyAgICBDZFNjc2lSZXF1ZXN0ICpyZXEgPSAoQ2RT
Y3NpUmVxdWVzdCAqKXVzZXJfZGF0YTsKKyAgICBDZFNjc2lUYXJnZXQgKnN0ID0gKENkU2NzaVRh
cmdldCAqKXJlcS0+cHJpdl9kYXRhOworCisgICAgZ19hc3NlcnQoY2FuY2VsbGFibGUgPT0gc3Qt
PmNhbmNlbGxhYmxlKTsKKyAgICBnX2NhbmNlbGxhYmxlX2Rpc2Nvbm5lY3QoY2FuY2VsbGFibGUs
IHJlcS0+Y2FuY2VsX2lkKTsKKyAgICByZXEtPmNhbmNlbF9pZCA9IDA7CisKKyAgICByZXEtPnJl
cV9zdGF0ZSA9CisgICAgICAgIChzdC0+c3RhdGUgPT0gQ0RfU0NTSV9UR1RfU1RBVEVfUlVOTklO
RykgPyBTQ1NJX1JFUV9DQU5DRUxFRCA6IFNDU0lfUkVRX0RJU1BPU0VEOworICAgIHJlcS0+aW5f
bGVuID0gMDsKKyAgICByZXEtPnN0YXR1cyA9IEdPT0Q7CisKKyAgICBjZF9zY3NpX2Rldl9yZXF1
ZXN0X2NvbXBsZXRlKHN0LT51c2VyX2RhdGEsIHJlcSk7Cit9CisKK3N0YXRpYyBpbnQgY2Rfc2Nz
aV9yZWFkX2FzeW5jX3N0YXJ0KENkU2NzaUxVICpkZXYsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sK
KyAgICBDZFNjc2lUYXJnZXQgKnN0ID0gZGV2LT50Z3Q7CisgICAgR0ZpbGVJbnB1dFN0cmVhbSAq
c3RyZWFtID0gZGV2LT5zdHJlYW07CisKKyAgICBTUElDRV9ERUJVRygicmVhZF9hc3luY19zdGFy
dCwgbHVuOiV1IgorICAgICAgICAgICAgICAgICIgbGJhOiAlIiBHX0dVSU5UNjRfRk9STUFUICIg
b2Zmc2V0OiAlIiBHX0dVSU5UNjRfRk9STUFUCisgICAgICAgICAgICAgICAgIiBjbnQ6ICUiIEdf
R1VJTlQ2NF9GT1JNQVQgIiBsZW46ICUiIEdfR1VJTlQ2NF9GT1JNQVQsCisgICAgICAgICAgICAg
ICAgcmVxLT5sdW4sIHJlcS0+bGJhLCByZXEtPm9mZnNldCwgcmVxLT5jb3VudCwgcmVxLT5yZXFf
bGVuKTsKKworICAgIHJlcS0+Y2FuY2VsX2lkID0gZ19jYW5jZWxsYWJsZV9jb25uZWN0KHN0LT5j
YW5jZWxsYWJsZSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBH
X0NBTExCQUNLKGNkX3Njc2lfcmVhZF9hc3luY19jYW5jZWxlZCksCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxLCAvKiBkYXRhICovCisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTlVMTCk7IC8qIGRhdGEgZGVzdHJveSBjYiAq
LworICAgIGlmIChyZXEtPmNhbmNlbF9pZCA9PSAwKSB7CisgICAgICAgIC8qIGFscmVhZHkgY2Fu
Y2VsZWQgKi8KKyAgICAgICAgcmV0dXJuIC0xOworICAgIH0KKworICAgIGdfc2Vla2FibGVfc2Vl
ayhHX1NFRUtBQkxFKHN0cmVhbSksCisgICAgICAgICAgICAgICAgICAgIHJlcS0+b2Zmc2V0LAor
ICAgICAgICAgICAgICAgICAgICBHX1NFRUtfU0VULAorICAgICAgICAgICAgICAgICAgICBOVUxM
LCAvKiBjYW5jZWxsYWJsZSAqLworICAgICAgICAgICAgICAgICAgICBOVUxMKTsgLyogZXJyb3Ig
Ki8KKworICAgIGdfaW5wdXRfc3RyZWFtX3JlYWRfYXN5bmMoR19JTlBVVF9TVFJFQU0oc3RyZWFt
KSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcS0+YnVmLCAvKiBidWZmZXIgdG8g
ZmlsbCAqLworICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxLT5yZXFfbGVuLAorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgR19QUklPUklUWV9ERUZBVUxULAorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgc3QtPmNhbmNlbGxhYmxlLAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgY2Rfc2NzaV9yZWFkX2FzeW5jX2NvbXBsZXRlLAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgKGdwb2ludGVyKXJlcSk7IC8qIGNhbGxiYWNrIGFyZ3VtZW50ICovCisg
ICAgcmV0dXJuIDA7Cit9CisKK3N0YXRpYyB2b2lkIGNkX3Njc2lfY21kX3JlYWQoQ2RTY3NpTFUg
KmRldiwgQ2RTY3NpUmVxdWVzdCAqcmVxKQoreworICAgIGlmIChkZXYtPnBvd2VyX2NvbmQgPT0g
Q0RfU0NTSV9QT1dFUl9TVE9QUEVEKSB7CisgICAgICAgIFNQSUNFX0RFQlVHKCJyZWFkLCBsdW46
ICV1IGlzIHN0b3BwZWQiLCByZXEtPmx1bik7CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRl
X2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX0lOSVRfQ01EX1JFUVVJUkVEKTsKKyAg
ICAgICAgcmV0dXJuOworICAgIH0gZWxzZSBpZiAoIWRldi0+bG9hZGVkIHx8IGRldi0+c3RyZWFt
ID09IE5VTEwpIHsKKyAgICAgICAgU1BJQ0VfREVCVUcoInJlYWQsIGx1bjogJXUgaXMgbm90IGxv
YWRlZCIsIHJlcS0+bHVuKTsKKyAgICAgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29u
ZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfTk9UX1JFQURZX05PX01FRElVTSk7CisgICAgICAgIHJl
dHVybjsKKyAgICB9CisKKyAgICByZXEtPmNkYl9sZW4gPSBzY3NpX2NkYl9sZW5ndGgocmVxLT5j
ZGIpOworCisgICAgcmVxLT5sYmEgPSBzY3NpX2NkYl9sYmEocmVxLT5jZGIsIHJlcS0+Y2RiX2xl
bik7CisgICAgcmVxLT5vZmZzZXQgPSByZXEtPmxiYSAqIGRldi0+YmxvY2tfc2l6ZTsKKworICAg
IHJlcS0+Y291bnQgPSBzY3NpX2NkYl94ZmVyX2xlbmd0aChyZXEtPmNkYiwgcmVxLT5jZGJfbGVu
KTsgLyogeGZlciBpbiBibG9ja3MgKi8KKyAgICByZXEtPnJlcV9sZW4gPSAodWludDY0X3QpIHJl
cS0+Y291bnQgKiBkZXYtPmJsb2NrX3NpemU7CisKKyAgICBjZF9zY3NpX3JlYWRfYXN5bmNfc3Rh
cnQoZGV2LCByZXEpOworfQorCit2b2lkIGNkX3Njc2lfZGV2X3JlcXVlc3Rfc3VibWl0KENkU2Nz
aVRhcmdldCAqc3QsIENkU2NzaVJlcXVlc3QgKnJlcSkKK3sKKyAgICB1aW50MzJfdCBsdW4gPSBy
ZXEtPmx1bjsKKyAgICB1aW50MzJfdCBvcGNvZGUgPSAodWludDMyX3QpcmVxLT5jZGJbMF07Cisg
ICAgY29uc3QgY2hhciAqY21kX25hbWUgPSBzY3NpX2NtZF9uYW1lW29wY29kZV07CisgICAgQ2RT
Y3NpTFUgKmRldiA9ICZzdC0+dW5pdHNbbHVuXTsKKworICAgIFNQSUNFX0RFQlVHKCJyZXF1ZXN0
X3N1Ym1pdCwgbHVuOiAldSBvcDogMHglMDJ4ICVzIiwgbHVuLCBvcGNvZGUsIGNtZF9uYW1lKTsK
KworICAgIGlmIChzdC0+Y3VyX3JlcSAhPSBOVUxMKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJy
ZXF1ZXN0X3N1Ym1pdCwgcmVxdWVzdCBub3QgaWRsZSIpOworICAgICAgICBjZF9zY3NpX2NtZF9j
b21wbGV0ZV9jaGVja19jb25kKGRldiwgcmVxLCAmc2Vuc2VfY29kZV9UQVJHRVRfRkFJTFVSRSk7
CisgICAgICAgIGdvdG8gZG9uZTsKKyAgICB9CisgICAgaWYgKHJlcS0+cmVxX3N0YXRlICE9IFND
U0lfUkVRX0lETEUpIHsKKyAgICAgICAgU1BJQ0VfRVJST1IoInJlcXVlc3Rfc3VibWl0LCBwcmV2
IHJlcXVlc3Qgb3V0c3RhbmRpbmciKTsKKyAgICAgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfY2hl
Y2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfVEFSR0VUX0ZBSUxVUkUpOworICAgICAgICBn
b3RvIGRvbmU7CisgICAgfQorICAgIHJlcS0+cmVxX3N0YXRlID0gU0NTSV9SRVFfUlVOTklORzsK
KyAgICBzdC0+Y3VyX3JlcSA9IHJlcTsKKworICAgIC8qIElOUVVJUlkgc2hvdWxkIHNlbmQgcmVz
cG9uc2UgZXZlbiBmb3Igbm9uLWV4aXN0aW5nIExVTnMgKi8KKyAgICBpZiAoIWNkX3Njc2lfdGFy
Z2V0X2x1bl9sZWdhbChzdCwgbHVuKSkgeworICAgICAgICBTUElDRV9FUlJPUigicmVxdWVzdF9z
dWJtaXQsIGlsbGVnYWwgbHVuOiV1IiwgbHVuKTsKKyAgICAgICAgaWYgKG9wY29kZSA9PSBJTlFV
SVJZKSB7CisgICAgICAgICAgICBpZiAocmVxLT5jZGJbMV0gJiAweDEpIHsKKyAgICAgICAgICAg
ICAgICBjZF9zY3NpX2NtZF9pbnF1aXJ5X3ZwZF9ub19sdW4oZGV2LCByZXEsIFBFUklGX1FVQUxJ
RklFUl9VTlNVUFBPUlRFRCk7CisgICAgICAgICAgICB9IGVsc2UgeworICAgICAgICAgICAgICAg
IGNkX3Njc2lfY21kX2lucXVpcnlfc3RhbmRhcmRfbm9fbHVuKGRldiwgcmVxLCBQRVJJRl9RVUFM
SUZJRVJfVU5TVVBQT1JURUQpOworICAgICAgICAgICAgfQorICAgICAgICB9IGVsc2UgeworICAg
ICAgICAgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNl
X2NvZGVfTFVOX05PVF9TVVBQT1JURUQpOworICAgICAgICB9CisgICAgICAgIGdvdG8gZG9uZTsK
KyAgICB9CisgICAgaWYgKCFjZF9zY3NpX3RhcmdldF9sdW5fcmVhbGl6ZWQoc3QsIGx1bikpIHsK
KyAgICAgICAgU1BJQ0VfRVJST1IoInJlcXVlc3Rfc3VibWl0LCBhYnNlbnQgbHVuOiV1IiwgbHVu
KTsKKyAgICAgICAgaWYgKG9wY29kZSA9PSBJTlFVSVJZKSB7CisgICAgICAgICAgICBpZiAocmVx
LT5jZGJbMV0gJiAweDEpIHsKKyAgICAgICAgICAgICAgICBjZF9zY3NpX2NtZF9pbnF1aXJ5X3Zw
ZF9ub19sdW4oZGV2LCByZXEsIFBFUklGX1FVQUxJRklFUl9OT1RfQ09OTkVDVEVEKTsKKyAgICAg
ICAgICAgIH0gZWxzZSB7CisgICAgICAgICAgICAgICAgY2Rfc2NzaV9jbWRfaW5xdWlyeV9zdGFu
ZGFyZF9ub19sdW4oZGV2LCByZXEsIFBFUklGX1FVQUxJRklFUl9OT1RfQ09OTkVDVEVEKTsKKyAg
ICAgICAgICAgIH0KKyAgICAgICAgfSBlbHNlIHsKKyAgICAgICAgICAgIGNkX3Njc2lfY21kX2Nv
bXBsZXRlX2NoZWNrX2NvbmQoZGV2LCByZXEsICZzZW5zZV9jb2RlX0xVTl9OT1RfU1VQUE9SVEVE
KTsKKyAgICAgICAgfQorICAgICAgICBnb3RvIGRvbmU7CisgICAgfQorCisgICAgaWYgKGRldi0+
c2hvcnRfc2Vuc2Uua2V5ICE9IE5PX1NFTlNFKSB7CisgICAgICAgIGdib29sZWFuIHBlbmRpbmdf
c2Vuc2UgPSBUUlVFOworICAgICAgICBpZiAoZGV2LT5zaG9ydF9zZW5zZS5rZXkgPT0gVU5JVF9B
VFRFTlRJT04pIHsKKyAgICAgICAgICAgIGlmIChjZF9zY3NpX29wY29kZV91YV9zdXByZXNzKG9w
Y29kZSkpIHsKKyAgICAgICAgICAgICAgICBwZW5kaW5nX3NlbnNlID0gRkFMU0U7IC8qIFVBIHN1
cHJlc3NlZCAqLworICAgICAgICAgICAgfQorICAgICAgICB9IGVsc2UgaWYgKG9wY29kZSA9PSBS
RVFVRVNUX1NFTlNFKSB7CisgICAgICAgICAgICBwZW5kaW5nX3NlbnNlID0gRkFMU0U7IC8qIHNl
bnNlIHJldHVybmVkIGFzIGRhdGEgKi8KKyAgICAgICAgfQorICAgICAgICBpZiAocGVuZGluZ19z
ZW5zZSkgeworICAgICAgICAgICAgY2Rfc2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYs
IHJlcSwgTlVMTCk7IC8qIHNlbnNlIGFscmVhZHkgc2V0ICovCisgICAgICAgICAgICBnb3RvIGRv
bmU7CisgICAgICAgIH0KKyAgICB9CisKKyAgICAvKiBzYXZlIHRoZSB0YXJnZXQgdG8gYmUgdXNl
ZCBpbiBjYWxsYmFja3Mgd2hlcmUgb25seSByZXEgaXMgcGFzc2VkICovCisgICAgcmVxLT5wcml2
X2RhdGEgPSAodm9pZCAqKXN0OworCisgICAgcmVxLT5yZXFfbGVuID0gMDsKKworICAgIHN3aXRj
aCAob3Bjb2RlKSB7CisgICAgY2FzZSBSRVBPUlRfTFVOUzoKKyAgICAgICAgY2Rfc2NzaV9jbWRf
cmVwb3J0X2x1bnMoc3QsIGRldiwgcmVxKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBURVNU
X1VOSVRfUkVBRFk6CisgICAgICAgIGNkX3Njc2lfY21kX3Rlc3RfdW5pdF9yZWFkeShkZXYsIHJl
cSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgSU5RVUlSWToKKyAgICAgICAgY2Rfc2NzaV9j
bWRfaW5xdWlyeShkZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgUkVRVUVTVF9T
RU5TRToKKyAgICAgICAgY2Rfc2NzaV9jbWRfcmVxdWVzdF9zZW5zZShkZXYsIHJlcSk7CisgICAg
ICAgIGJyZWFrOworICAgIGNhc2UgUkVBRF82OgorICAgIGNhc2UgUkVBRF8xMDoKKyAgICBjYXNl
IFJFQURfMTI6CisgICAgY2FzZSBSRUFEXzE2OgorICAgICAgICBjZF9zY3NpX2NtZF9yZWFkKGRl
diwgcmVxKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBSRUFEX0NBUEFDSVRZXzEwOgorICAg
ICAgICBjZF9zY3NpX2NtZF9yZWFkX2NhcGFjaXR5KGRldiwgcmVxKTsKKyAgICAgICAgYnJlYWs7
CisgICAgY2FzZSBSRUFEX1RPQzoKKyAgICAgICAgY2Rfc2NzaV9jbWRfcmVhZF90b2MoZGV2LCBy
ZXEpOworICAgICAgICBicmVhazsKKyAgICBjYXNlIEdFVF9FVkVOVF9TVEFUVVNfTk9USUZJQ0FU
SU9OOgorICAgICAgICBjZF9zY3NpX2NtZF9nZXRfZXZlbnRfc3RhdHVzX25vdGlmaWNhdGlvbihk
ZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgUkVBRF9ESVNDX0lORk9STUFUSU9O
OgorICAgICAgICBjZF9zY3NpX2NtZF9nZXRfcmVhZF9kaXNjX2luZm9ybWF0aW9uKGRldiwgcmVx
KTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBSRUFEX1RSQUNLX0lORk9STUFUSU9OOgorICAg
ICAgICBjZF9zY3NpX2NtZF9nZXRfcmVhZF90cmFja19pbmZvcm1hdGlvbihkZXYsIHJlcSk7Cisg
ICAgICAgIGJyZWFrOworICAgIGNhc2UgTU9ERV9TRU5TRV8xMDoKKyAgICAgICAgY2Rfc2NzaV9j
bWRfbW9kZV9zZW5zZV8xMChkZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgTU9E
RV9TRUxFQ1Q6CisgICAgICAgIGNkX3Njc2lfY21kX21vZGVfc2VsZWN0XzYoZGV2LCByZXEpOwor
ICAgICAgICBicmVhazsKKyAgICBjYXNlIE1PREVfU0VMRUNUXzEwOgorICAgICAgICBjZF9zY3Np
X2NtZF9tb2RlX3NlbGVjdF8xMChkZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2Ug
R0VUX0NPTkZJR1VSQVRJT046CisgICAgICAgIGNkX3Njc2lfY21kX2dldF9jb25maWd1cmF0aW9u
KGRldiwgcmVxKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBBTExPV19NRURJVU1fUkVNT1ZB
TDoKKyAgICAgICAgY2Rfc2NzaV9jbWRfYWxsb3dfbWVkaXVtX3JlbW92YWwoZGV2LCByZXEpOwor
ICAgICAgICBicmVhazsKKyAgICBjYXNlIE1NQ19TRU5EX0VWRU5UOgorICAgICAgICBjZF9zY3Np
X2NtZF9zZW5kX2V2ZW50KGRldiwgcmVxKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBNTUNf
UkVQT1JUX0tFWToKKyAgICAgICAgY2Rfc2NzaV9jbWRfcmVwb3J0X2tleShkZXYsIHJlcSk7Cisg
ICAgICAgIGJyZWFrOworICAgIGNhc2UgTU1DX1NFTkRfS0VZOgorICAgICAgICBjZF9zY3NpX2Nt
ZF9zZW5kX2tleShkZXYsIHJlcSk7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgU1RBUlRfU1RP
UDoKKyAgICAgICAgY2Rfc2NzaV9jbWRfc3RhcnRfc3RvcF91bml0KGRldiwgcmVxKTsKKyAgICAg
ICAgYnJlYWs7CisgICAgY2FzZSBNTUNfR0VUX1BFUkZPUk1BTkNFOgorICAgICAgICBjZF9zY3Np
X2NtZF9nZXRfcGVyZm9ybWFuY2UoZGV2LCByZXEpOworICAgICAgICBicmVhazsKKyAgICBjYXNl
IE1NQ19NRUNIQU5JU01fU1RBVFVTOgorICAgICAgICBjZF9zY3NpX2NtZF9tZWNoYW5pc21fc3Rh
dHVzKGRldiwgcmVxKTsKKyAgICAgICAgYnJlYWs7CisgICAgZGVmYXVsdDoKKyAgICAgICAgY2Rf
c2NzaV9jbWRfY29tcGxldGVfY2hlY2tfY29uZChkZXYsIHJlcSwgJnNlbnNlX2NvZGVfSU5WQUxJ
RF9PUENPREUpOworICAgICAgICBicmVhazsKKyAgICB9CisKKyAgICBpZiAocmVxLT5yZXFfbGVu
ID4gSU5UMzJfTUFYKSB7CisgICAgICAgIGNkX3Njc2lfY21kX2NvbXBsZXRlX2NoZWNrX2NvbmQo
ZGV2LCByZXEsICZzZW5zZV9jb2RlX0lOVkFMSURfQ0RCX0ZJRUxEKTsKKyAgICAgICAgZ290byBk
b25lOworICAgIH0KKworZG9uZToKKyAgICBTUElDRV9ERUJVRygicmVxdWVzdF9zdWJtaXQgZG9u
ZSwgbHVuOiAldSIKKyAgICAgICAgICAgICAgICAiIG9wOiAweCUwMnggJXMsIHN0YXRlOiAlcyBz
dGF0dXM6ICV1IGxlbjogJSIgR19HVUlOVDY0X0ZPUk1BVCwKKyAgICAgICAgICAgICAgICBsdW4s
IG9wY29kZSwgY21kX25hbWUsIENkU2NzaVJlcVN0YXRlX3N0cihyZXEtPnJlcV9zdGF0ZSksIHJl
cS0+c3RhdHVzLAorICAgICAgICAgICAgICAgIHJlcS0+aW5fbGVuKTsKKworICAgIGlmIChyZXEt
PnJlcV9zdGF0ZSA9PSBTQ1NJX1JFUV9DT01QTEVURSkgeworICAgICAgICBjZF9zY3NpX2Rldl9y
ZXF1ZXN0X2NvbXBsZXRlKHN0LT51c2VyX2RhdGEsIHJlcSk7CisgICAgfQorfQorCit2b2lkIGNk
X3Njc2lfZGV2X3JlcXVlc3RfY2FuY2VsKENkU2NzaVRhcmdldCAqc3QsIENkU2NzaVJlcXVlc3Qg
KnJlcSkKK3sKKyAgICBpZiAoc3QtPmN1cl9yZXEgPT0gcmVxKSB7CisgICAgICAgIGlmIChyZXEt
PnJlcV9zdGF0ZSA9PSBTQ1NJX1JFUV9SVU5OSU5HKSB7CisgICAgICAgICAgICBTUElDRV9ERUJV
RygicmVxdWVzdF9jYW5jZWw6IGx1bjogJXUiCisgICAgICAgICAgICAgICAgICAgICAgICAgIiBv
cDogMHglMDJ4IGxlbjogJSIgR19HVUlOVDY0X0ZPUk1BVCwKKyAgICAgICAgICAgICAgICAgICAg
ICAgIHJlcS0+bHVuLCAodW5zaWduZWQgaW50KXJlcS0+Y2RiWzBdLCByZXEtPnJlcV9sZW4pOwor
ICAgICAgICAgICAgZ19jYW5jZWxsYWJsZV9jYW5jZWwoc3QtPmNhbmNlbGxhYmxlKTsKKyAgICAg
ICAgfSBlbHNlIHsKKyAgICAgICAgICAgIFNQSUNFX0RFQlVHKCJyZXF1ZXN0X2NhbmNlbDogcmVx
dWVzdCBpcyBub3QgcnVubmluZyIpOworICAgICAgICB9CisgICAgfSBlbHNlIHsKKyAgICAgICAg
U1BJQ0VfREVCVUcoInJlcXVlc3RfY2FuY2VsOiBvdGhlciByZXF1ZXN0IGlzIG91dHN0YW5kaW5n
Iik7CisgICAgfQorfQorCit2b2lkIGNkX3Njc2lfZGV2X3JlcXVlc3RfcmVsZWFzZShDZFNjc2lU
YXJnZXQgKnN0LCBDZFNjc2lSZXF1ZXN0ICpyZXEpCit7CisgICAgc3QtPmN1cl9yZXEgPSBOVUxM
OworICAgIGNkX3Njc2lfcmVxX2luaXQocmVxKTsKKworICAgIGlmIChzdC0+c3RhdGUgPT0gQ0Rf
U0NTSV9UR1RfU1RBVEVfUkVTRVQpIHsKKyAgICAgICAgY2Rfc2NzaV90YXJnZXRfZG9fcmVzZXQo
c3QpOworICAgIH0KK30KKworI2VuZGlmIC8qIFVTRV9VU0JSRURJUiAqLwpkaWZmIC0tZ2l0IGEv
c3JjL2NkLXNjc2kuaCBiL3NyYy9jZC1zY3NpLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXgg
MDAwMDAwMC4uODZlOTUxYgotLS0gL2Rldi9udWxsCisrKyBiL3NyYy9jZC1zY3NpLmgKQEAgLTAs
MCArMSwxMTcgQEAKKy8qIC0qLSBNb2RlOiBDOyBjLWJhc2ljLW9mZnNldDogNDsgaW5kZW50LXRh
YnMtbW9kZTogbmlsIC0qLSAqLworLyoKKyAgIENEIGRldmljZSBlbXVsYXRpb24gLSBTQ1NJIGVu
Z2luZQorCisgICBDb3B5cmlnaHQgKEMpIDIwMTggUmVkIEhhdCwgSW5jLgorCisgICBSZWQgSGF0
IEF1dGhvcnM6CisgICBBbGV4YW5kZXIgTmV6aGluc2t5PGFuZXpoaW5zQHJlZGhhdC5jb20+CisK
KyAgIFRoaXMgbGlicmFyeSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBp
dCBhbmQvb3IKKyAgIG1vZGlmeSBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBMZXNzZXIg
R2VuZXJhbCBQdWJsaWMKKyAgIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3
YXJlIEZvdW5kYXRpb247IGVpdGhlcgorICAgdmVyc2lvbiAyLjEgb2YgdGhlIExpY2Vuc2UsIG9y
IChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCisKKyAgIFRoaXMgbGlicmFyeSBp
cyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAorICAgYnV0
IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkg
b2YKKyAgIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9T
RS4gIFNlZSB0aGUgR05VCisgICBMZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9y
ZSBkZXRhaWxzLgorCisgICBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBH
TlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCisgICBMaWNlbnNlIGFsb25nIHdpdGggdGhpcyBsaWJy
YXJ5OyBpZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCisqLworCisj
cHJhZ21hIG9uY2UKKworI2luY2x1ZGUgImNkLXNjc2ktZGV2LXBhcmFtcy5oIgorI2luY2x1ZGUg
ImNkLXVzYi1idWxrLW1zZC5oIgorI2luY2x1ZGUgInNjc2ktY29uc3RhbnRzLmgiCisKKyNpZiBk
ZWZpbmVkKEdfT1NfV0lOMzIpCisjaW5jbHVkZSA8d2luc29jazIuaD4KKyNpbmNsdWRlIDx3aW5k
b3dzLmg+CisvKiBXaW5kb3dzIGlzIGFsd2F5cyBMRSBhdCB0aGUgbW9tZW50ICovCisjZGVmaW5l
IGxlMzJ0b2goeCkgICAgICAgICAgKHgpCisjZGVmaW5lIGh0b2xlMzIoeCkgICAgICAgICAgKHgp
CisjZGVmaW5lIGh0b2JlMzIoeCkgICAgICAgICAgaHRvbmwoeCkKKyNlbmRpZgorCit0eXBlZGVm
IGVudW0gU2NzaVhmZXJEaXIgeworICAgIFNDU0lfWEZFUl9OT05FID0gMCwgIC8qIFRFU1RfVU5J
VF9SRUFEWSwgLi4uICAgICAgICAgICAqLworICAgIFNDU0lfWEZFUl9GUk9NX0RFViwgIC8qIFJF
QUQsIElOUVVJUlksIE1PREVfU0VOU0UsIC4uLiAqLworICAgIFNDU0lfWEZFUl9UT19ERVYsICAg
IC8qIFdSSVRFLCBNT0RFX1NFTEVDVCwgLi4uICAgICAgICAqLworfSBTY3NpWGZlckRpcjsKKwor
I2RlZmluZSBTQ1NJX0NEQl9CVUZfU0laRSAgIDE2CisKK3R5cGVkZWYgZW51bSBDZFNjc2lSZXFT
dGF0ZSB7CisgICAgU0NTSV9SRVFfSURMRSA9IDAsCisgICAgU0NTSV9SRVFfUlVOTklORywKKyAg
ICBTQ1NJX1JFUV9DT01QTEVURSwKKyAgICBTQ1NJX1JFUV9DQU5DRUxFRCwKKyAgICBTQ1NJX1JF
UV9ESVNQT1NFRCwKK30gQ2RTY3NpUmVxU3RhdGU7CisKK3R5cGVkZWYgc3RydWN0IENkU2NzaVJl
cXVlc3QgeworICAgIC8qIHJlcXVlc3QgKi8KKyAgICB1aW50OF90IGNkYltTQ1NJX0NEQl9CVUZf
U0laRV07CisgICAgdWludDMyX3QgY2RiX2xlbjsKKworICAgIHVpbnQzMl90IGx1bjsKKworICAg
IHVpbnQ4X3QgKmJ1ZjsKKyAgICB1aW50MzJfdCBidWZfbGVuOworCisgICAgLyogaW50ZXJuYWwg
Ki8KKyAgICBDZFNjc2lSZXFTdGF0ZSByZXFfc3RhdGU7CisgICAgU2NzaVhmZXJEaXIgeGZlcl9k
aXI7CisgICAgdWludDY0X3QgY2FuY2VsX2lkOworICAgIHZvaWQgKnByaXZfZGF0YTsKKworICAg
IHVpbnQ2NF90IGxiYTsgLyogb2Zmc2V0IGluIGxvZ2ljYWwgYmxvY2tzIGlmIHJlbGV2YW50ICov
CisgICAgdWludDY0X3QgY291bnQ7IC8qIGNvdW50IGluIGxvZ2ljYWwgYmxvY2tzICovCisKKyAg
ICB1aW50NjRfdCBvZmZzZXQ7IC8qIHNjc2kgY2RiIG9mZnNldCwgbm9ybWFsaXplZCB0byBieXRl
cyAqLworICAgIHVpbnQ2NF90IHJlcV9sZW47IC8qIHNjc2kgY2RiIHJlcXVlc3QgbGVuZ3RoLCBu
b3JtYWxpemVkIHRvIGJ5dGVzICovCisKKyAgICAvKiByZXN1bHQgKi8KKyAgICB1aW50NjRfdCBp
bl9sZW47IC8qIGxlbmd0aCBvZiBkYXRhIGFjdHVhbGx5IGF2YWlsYWJsZSBhZnRlciByZWFkICov
CisgICAgdWludDMyX3Qgc3RhdHVzOyAvKiBTQ1NJIHN0YXR1cyBjb2RlICovCisKK30gQ2RTY3Np
UmVxdWVzdDsKKworQ2RTY3NpUmVxU3RhdGUgY2Rfc2NzaV9nZXRfcmVxX3N0YXRlKENkU2NzaVJl
cXVlc3QgKnJlcSk7CisKKy8qIFNDU0kgdGFyZ2V0L2RldmljZSBBUEkgKi8KK3R5cGVkZWYgc3Ry
dWN0IENkU2NzaVRhcmdldCBDZFNjc2lUYXJnZXQ7CisKKy8qIHRvIGJlIHVzZWQgaW4gY2FsbGJh
Y2tzICovCitDZFNjc2lUYXJnZXQgKmNkX3Njc2lfdGFyZ2V0X2FsbG9jKHZvaWQgKnRhcmdldF91
c2VyX2RhdGEsIHVpbnQzMl90IG1heF9sdW5zKTsKK3ZvaWQgY2Rfc2NzaV90YXJnZXRfZnJlZShD
ZFNjc2lUYXJnZXQgKnNjc2lfdGFyZ2V0KTsKKworaW50IGNkX3Njc2lfZGV2X3JlYWxpemUoQ2RT
Y3NpVGFyZ2V0ICpzY3NpX3RhcmdldCwgdWludDMyX3QgbHVuLAorICAgICAgICAgICAgICAgICAg
ICAgICAgY29uc3QgQ2RTY3NpRGV2aWNlUGFyYW1ldGVycyAqZGV2X3BhcmFtcyk7CitpbnQgY2Rf
c2NzaV9kZXZfdW5yZWFsaXplKENkU2NzaVRhcmdldCAqc2NzaV90YXJnZXQsIHVpbnQzMl90IGx1
bik7CisKK2ludCBjZF9zY3NpX2Rldl9sb2NrKENkU2NzaVRhcmdldCAqc2NzaV90YXJnZXQsIHVp
bnQzMl90IGx1biwgZ2Jvb2xlYW4gbG9jayk7CitpbnQgY2Rfc2NzaV9kZXZfbG9hZChDZFNjc2lU
YXJnZXQgKnNjc2lfdGFyZ2V0LCB1aW50MzJfdCBsdW4sCisgICAgICAgICAgICAgICAgICAgICBj
b25zdCBDZFNjc2lNZWRpYVBhcmFtZXRlcnMgKm1lZGlhX3BhcmFtcyk7CitpbnQgY2Rfc2NzaV9k
ZXZfZ2V0X2luZm8oQ2RTY3NpVGFyZ2V0ICpzY3NpX3RhcmdldCwgdWludDMyX3QgbHVuLCBDZFNj
c2lEZXZpY2VJbmZvICpsdW5faW5mbyk7CitpbnQgY2Rfc2NzaV9kZXZfdW5sb2FkKENkU2NzaVRh
cmdldCAqc2NzaV90YXJnZXQsIHVpbnQzMl90IGx1bik7CisKK3ZvaWQgY2Rfc2NzaV9kZXZfcmVx
dWVzdF9zdWJtaXQoQ2RTY3NpVGFyZ2V0ICpzY3NpX3RhcmdldCwgQ2RTY3NpUmVxdWVzdCAqcmVx
dWVzdCk7Cit2b2lkIGNkX3Njc2lfZGV2X3JlcXVlc3RfY2FuY2VsKENkU2NzaVRhcmdldCAqc2Nz
aV90YXJnZXQsIENkU2NzaVJlcXVlc3QgKnJlcXVlc3QpOwordm9pZCBjZF9zY3NpX2Rldl9yZXF1
ZXN0X3JlbGVhc2UoQ2RTY3NpVGFyZ2V0ICpzY3NpX3RhcmdldCwgQ2RTY3NpUmVxdWVzdCAqcmVx
dWVzdCk7CisKK2ludCBjZF9zY3NpX2Rldl9yZXNldChDZFNjc2lUYXJnZXQgKnNjc2lfdGFyZ2V0
LCB1aW50MzJfdCBsdW4pOworCitpbnQgY2Rfc2NzaV90YXJnZXRfcmVzZXQoQ2RTY3NpVGFyZ2V0
ICpzY3NpX3RhcmdldCk7CisKKy8qIENhbGxiYWNrcworICogVGhlc2UgY2FsbGJhY2tzIGFyZSB1
c2VkIGJ5IHVwcGVyIGxheWVyIHRvIGltcGxlbWVudCBzcGVjaWZpYyBTQ1NJCisgKiB0YXJnZXQg
ZGV2aWNlcy4KKyAqLwordm9pZCBjZF9zY3NpX2Rldl9yZXF1ZXN0X2NvbXBsZXRlKHZvaWQgKnRh
cmdldF91c2VyX2RhdGEsIENkU2NzaVJlcXVlc3QgKnJlcXVlc3QpOwordm9pZCBjZF9zY3NpX2Rl
dl9jaGFuZ2VkKHZvaWQgKnRhcmdldF91c2VyX2RhdGEsIHVpbnQzMl90IGx1bik7Cit2b2lkIGNk
X3Njc2lfZGV2X3Jlc2V0X2NvbXBsZXRlKHZvaWQgKnRhcmdldF91c2VyX2RhdGEsIHVpbnQzMl90
IGx1bik7Cit2b2lkIGNkX3Njc2lfdGFyZ2V0X3Jlc2V0X2NvbXBsZXRlKHZvaWQgKnRhcmdldF91
c2VyX2RhdGEpOwpkaWZmIC0tZ2l0IGEvc3JjL2NkLXVzYi1idWxrLW1zZC5jIGIvc3JjL2NkLXVz
Yi1idWxrLW1zZC5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAuLjVkOTVkYWMK
LS0tIC9kZXYvbnVsbAorKysgYi9zcmMvY2QtdXNiLWJ1bGstbXNkLmMKQEAgLTAsMCArMSw1NDMg
QEAKKy8qIC0qLSBNb2RlOiBDOyBjLWJhc2ljLW9mZnNldDogNDsgaW5kZW50LXRhYnMtbW9kZTog
bmlsIC0qLSAqLworLyoKKyAgICBVU0IgQ0QgRGV2aWNlIGVtdWxhdGlvbiAtIERhdGEgQnVsayB0
cmFuc2ZlcnMgLSBNYXNzIFN0b3JhZ2UgRGV2aWNlCisKKyAgICBDb3B5cmlnaHQgKEMpIDIwMTgg
UmVkIEhhdCwgSW5jLgorCisgICAgUmVkIEhhdCBBdXRob3JzOgorICAgIEFsZXhhbmRlciBOZXpo
aW5za3k8YW5lemhpbnNAcmVkaGF0LmNvbT4KKworICAgIFRoaXMgbGlicmFyeSBpcyBmcmVlIHNv
ZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IKKyAgICBtb2RpZnkgaXQgdW5k
ZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCisgICAgTGljZW5z
ZSBhcyBwdWJsaXNoZWQgYnkgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyCisg
ICAgdmVyc2lvbiAyLjEgb2YgdGhlIExpY2Vuc2UsIG9yIChhdCB5b3VyIG9wdGlvbikgYW55IGxh
dGVyIHZlcnNpb24uCisKKyAgICBUaGlzIGxpYnJhcnkgaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhv
cGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKKyAgICBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7
IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgorICAgIE1FUkNIQU5UQUJJTElU
WSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUgR05VCisgICAg
TGVzc2VyIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KKworICAgIFlv
dSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQ
dWJsaWMKKyAgICBMaWNlbnNlIGFsb25nIHdpdGggdGhpcyBsaWJyYXJ5OyBpZiBub3QsIHNlZSA8
aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCisqLworCisjaW5jbHVkZSAiY29uZmlnLmgi
CisjaW5jbHVkZSAic3BpY2UvdHlwZXMuaCIKKyNpbmNsdWRlICJzcGljZS1jb21tb24uaCIKKyNp
bmNsdWRlICJzcGljZS11dGlsLmgiCisjaW5jbHVkZSAiY2QtdXNiLWJ1bGstbXNkLmgiCisjaW5j
bHVkZSAiY2Qtc2NzaS5oIgorCisjaWZkZWYgVVNFX1VTQlJFRElSCisKKyNkZWZpbmUgU1BJQ0Vf
RVJST1IoZm10LCAuLi4pIFwKKyAgICBkbyB7IFNQSUNFX0RFQlVHKCJ1c2ItbXNkIGVycm9yOiAi
IGZtdCAsICMjIF9fVkFfQVJHU19fKTsgfSB3aGlsZSAoMCkKKwordHlwZWRlZiBlbnVtIFVzYkNk
U3RhdGUgeworICAgIFVTQl9DRF9TVEFURV9JTklULCAvKiBOb3QgcmVhZHkgKi8KKyAgICBVU0Jf
Q0RfU1RBVEVfQ0JXLCAvKiBXYWl0aW5nIGZvciBDb21tYW5kIEJsb2NrICovCisgICAgVVNCX0NE
X1NUQVRFX0RBVEFPVVQsIC8qIFRyYW5zZmVyIGRhdGEgdG8gZGV2aWNlICovCisgICAgVVNCX0NE
X1NUQVRFX0RBVEFJTiwgLyogVHJhbnNmZXIgZGF0YSBmcm9tIGRldmljZSAqLworICAgIFVTQl9D
RF9TVEFURV9aRVJPX0RBVEFJTiwgLyogTmVlZCB0byBzZW5kIHplcm8gYnVsay1pbiBiZWZvcmUg
c3RhdHVzICovCisgICAgVVNCX0NEX1NUQVRFX0NTVywgLyogU2VuZCBDb21tYW5kIFN0YXR1cyAq
LworICAgIFVTQl9DRF9TVEFURV9ERVZJQ0VfUkVTRVQsIC8qIHJlc2V0IG9mIGEgc2luZ2xlIGRl
dmljZSAqLworICAgIFVTQl9DRF9TVEFURV9UQVJHRVRfUkVTRVQgLyogcmVzZXQgb2YgZW50aXJl
IHRhcmdldCAqLworfSBVc2JDZFN0YXRlOworCisvKiBVU0IgTVNEIENvbW1hbmQgQmxvY2sgV3Jh
cHBlciAqLworc3RydWN0IF9fYXR0cmlidXRlX18oKF9fcGFja2VkX18pKSBVc2JDZENCVyB7Cisg
ICAgdWludDMyX3Qgc2lnOworICAgIHVpbnQzMl90IHRhZzsKKyAgICB1aW50MzJfdCBleHBfZGF0
YV9sZW47IC8qIGV4cGVjdGVkIGRhdGEgeGZlciBsZW5ndGggZm9yIHRoZSByZXF1ZXN0ICovCisg
ICAgdWludDhfdCBmbGFnczsKKyAgICB1aW50OF90IGx1bjsKKyAgICB1aW50OF90IGNtZF9sZW47
IC8qIGFjdHVhbCBsZW5ndGggb2YgdGhlIHNjc2kgY29tbWFuZCB0aGF0IGZvbGxvd3MgKi8KKyAg
ICB1aW50OF90IGNtZFsxNl07IC8qIHNjc2kgY29tbWFuZCB0byBwZXJmb3JtICovCit9OworCisv
KiBVU0IgTVNEIENvbW1hbmQgU3RhdHVzIFdyYXBwZXIgKi8KK3N0cnVjdCBfX2F0dHJpYnV0ZV9f
KChfX3BhY2tlZF9fKSkgVXNiQ2RDU1cgeworICAgIHVpbnQzMl90IHNpZzsKKyAgICB1aW50MzJf
dCB0YWc7CisgICAgdWludDMyX3QgcmVzaWR1ZTsKKyAgICB1aW50OF90IHN0YXR1czsKK307CisK
Ky8qIFVzYkNkQ1NXOjpzdGF0dXMgKi8KK3R5cGVkZWYgZW51bSBVc2JNc2RTdGF0dXMgeworICAg
IFVTQl9NU0RfU1RBVFVTX0dPT0QgPSAwLAorICAgIFVTQl9NU0RfU1RBVFVTX0ZBSUxFRCA9IDEs
CisgICAgVVNCX01TRF9TVEFUVVNfUEhBU0VfRVJSID0gMiwKK30gVXNiTXNkU3RhdHVzOworCit0
eXBlZGVmIHN0cnVjdCBVc2JDZEJ1bGtNc2RSZXF1ZXN0IHsKKyAgICBDZFNjc2lSZXF1ZXN0IHNj
c2lfcmVxOworCisgICAgdWludDMyX3QgbHVuOworICAgIHVpbnQzMl90IHVzYl9yZXFfbGVuOyAv
KiBsZW5ndGggb2YgZGF0YSByZXF1ZXN0ZWQgYnkgdXNiICovCisgICAgdWludDMyX3Qgc2NzaV9p
bl9sZW47IC8qIGxlbmd0aCBvZiBkYXRhIHJldHVybmVkIGJ5IHNjc2kgbGltaXRlZCBieSB1c2Ig
cmVxdWVzdCAqLworCisgICAgdWludDMyX3QgeGZlcl9sZW47IC8qIGxlbmd0aCBvZiBkYXRhIHRy
YW5zZmVyZWQgdW50aWwgbm93ICovCisgICAgdWludDMyX3QgYnVsa19pbl9sZW47IC8qIGxlbmd0
aCBvZiB0aGUgbGFzdCBwb3N0cG9uZWQgYnVsay1pbiByZXF1ZXN0ICovCisKKyAgICBzdHJ1Y3Qg
VXNiQ2RDU1cgY3N3OyAvKiB1c2Igc3RhdHVzIGhlYWRlciAqLworfSBVc2JDZEJ1bGtNc2RSZXF1
ZXN0OworCit0eXBlZGVmIHN0cnVjdCBVc2JDZEJ1bGtNc2REZXZpY2UgeworICAgIFVzYkNkU3Rh
dGUgc3RhdGU7CisgICAgQ2RTY3NpVGFyZ2V0ICpzY3NpX3RhcmdldDsgLyogc2NzaSBoYW5kbGUg
Ki8KKyAgICB2b2lkICp1c2JfdXNlcl9kYXRhOyAvKiB1c2VkIGluIGNhbGxiYWNrcyB0byB1c2Ig
Ki8KKyAgICBVc2JDZEJ1bGtNc2RSZXF1ZXN0IHVzYl9yZXE7IC8qIG5vdyBzdXBwb3J0aW5nIGEg
c2luZ2xlIGNtZCAqLworICAgIHVpbnQ4X3QgKmRhdGFfYnVmOworICAgIHVpbnQzMl90IGRhdGFf
YnVmX2xlbjsKK30gVXNiQ2RCdWxrTXNkRGV2aWNlOworCitzdGF0aWMgaW5saW5lIGNvbnN0IGNo
YXIgKnVzYl9jZF9zdGF0ZV9zdHIoVXNiQ2RTdGF0ZSBzdGF0ZSkKK3sKKyAgICBzd2l0Y2ggKHN0
YXRlKSB7CisgICAgY2FzZSBVU0JfQ0RfU1RBVEVfSU5JVDoKKyAgICAgICAgcmV0dXJuICJJTklU
IjsKKyAgICBjYXNlIFVTQl9DRF9TVEFURV9DQlc6CisgICAgICAgIHJldHVybiAiQ0JXIjsKKyAg
ICBjYXNlIFVTQl9DRF9TVEFURV9EQVRBT1VUOgorICAgICAgICByZXR1cm4gIkRBVEFPVVQiOwor
ICAgIGNhc2UgVVNCX0NEX1NUQVRFX0RBVEFJTjoKKyAgICAgICAgcmV0dXJuICJEQVRBSU4iOwor
ICAgIGNhc2UgVVNCX0NEX1NUQVRFX1pFUk9fREFUQUlOOgorICAgICAgICByZXR1cm4gIlpFUk9f
REFUQUlOIjsKKyAgICBjYXNlIFVTQl9DRF9TVEFURV9DU1c6CisgICAgICAgIHJldHVybiAiQ1NX
IjsKKyAgICBjYXNlIFVTQl9DRF9TVEFURV9ERVZJQ0VfUkVTRVQ6CisgICAgICAgIHJldHVybiAi
REVWX1JFU0VUIjsKKyAgICBjYXNlIFVTQl9DRF9TVEFURV9UQVJHRVRfUkVTRVQ6CisgICAgICAg
IHJldHVybiAiVEdUX1JFU0VUIjsKKyAgICBkZWZhdWx0OgorICAgICAgICByZXR1cm4gIklMTEVH
QUwiOworICAgIH0KK30KKworc3RhdGljIHZvaWQgY2RfdXNiX2J1bGtfbXNkX3NldF9zdGF0ZShV
c2JDZEJ1bGtNc2REZXZpY2UgKmNkLCBVc2JDZFN0YXRlIHN0YXRlKQoreworICAgIFNQSUNFX0RF
QlVHKCJTdGF0ZSAlcyAtPiAlcyIsIHVzYl9jZF9zdGF0ZV9zdHIoY2QtPnN0YXRlKSwgdXNiX2Nk
X3N0YXRlX3N0cihzdGF0ZSkpOworICAgIGNkLT5zdGF0ZSA9IHN0YXRlOworfQorCitVc2JDZEJ1
bGtNc2REZXZpY2UgKmNkX3VzYl9idWxrX21zZF9hbGxvYyh2b2lkICp1c2JfdXNlcl9kYXRhLCB1
aW50MzJfdCBtYXhfbHVucykKK3sKKyAgICBVc2JDZEJ1bGtNc2REZXZpY2UgKmNkID0gZ19uZXcw
KFVzYkNkQnVsa01zZERldmljZSwgMSk7CisKKyAgICBjZC0+ZGF0YV9idWZfbGVuID0gMjU2ICog
MTAyNDsKKyAgICBjZC0+ZGF0YV9idWYgPSBnX21hbGxvYyhjZC0+ZGF0YV9idWZfbGVuKTsKKwor
ICAgIGNkLT5zY3NpX3RhcmdldCA9IGNkX3Njc2lfdGFyZ2V0X2FsbG9jKGNkLCBtYXhfbHVucyk7
CisgICAgaWYgKGNkLT5zY3NpX3RhcmdldCA9PSBOVUxMKSB7CisgICAgICAgIGdfZnJlZShjZC0+
ZGF0YV9idWYpOworICAgICAgICBnX2ZyZWUoY2QpOworICAgICAgICByZXR1cm4gTlVMTDsKKyAg
ICB9CisgICAgY2RfdXNiX2J1bGtfbXNkX3NldF9zdGF0ZShjZCwgVVNCX0NEX1NUQVRFX0lOSVQp
OworICAgIGNkLT51c2JfdXNlcl9kYXRhID0gdXNiX3VzZXJfZGF0YTsKKworICAgIFNQSUNFX0RF
QlVHKCJBbGxvYywgbWF4X2x1bnM6JXUiLCBtYXhfbHVucyk7CisgICAgcmV0dXJuIGNkOworfQor
CitpbnQgY2RfdXNiX2J1bGtfbXNkX3JlYWxpemUoVXNiQ2RCdWxrTXNkRGV2aWNlICpjZCwgdWlu
dDMyX3QgbHVuLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IENkU2NzaURldmlj
ZVBhcmFtZXRlcnMgKmRldl9wYXJhbXMpCit7CisgICAgQ2RTY3NpRGV2aWNlUGFyYW1ldGVycyBz
Y3NpX2Rldl9wYXJhbXM7CisgICAgaW50IHJjOworCisgICAgc2NzaV9kZXZfcGFyYW1zLnZlbmRv
ciA9IGRldl9wYXJhbXMtPnZlbmRvciA/IDogIlNQSUNFIjsKKyAgICBzY3NpX2Rldl9wYXJhbXMu
cHJvZHVjdCA9IGRldl9wYXJhbXMtPnByb2R1Y3QgPyA6ICJVU0ItQ0QiOworICAgIHNjc2lfZGV2
X3BhcmFtcy52ZXJzaW9uID0gZGV2X3BhcmFtcy0+dmVyc2lvbiA/IDogIjAuMSI7CisgICAgc2Nz
aV9kZXZfcGFyYW1zLnNlcmlhbCA9IGRldl9wYXJhbXMtPnNlcmlhbCA/IDogIjEyMzQ1NiI7CisK
KyAgICByYyA9IGNkX3Njc2lfZGV2X3JlYWxpemUoY2QtPnNjc2lfdGFyZ2V0LCBsdW4sICZzY3Np
X2Rldl9wYXJhbXMpOworICAgIGlmIChyYyAhPSAwKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJG
YWlsZWQgdG8gcmVhbGl6ZSBsdW46JXUiLCBsdW4pOworICAgICAgICByZXR1cm4gcmM7CisgICAg
fQorCisgICAgaWYgKGNkLT5zdGF0ZSA9PSBVU0JfQ0RfU1RBVEVfSU5JVCkgeworICAgICAgICAv
KiB3YWl0IG5leHQgcmVxdWVzdCAqLworICAgICAgICBjZF91c2JfYnVsa19tc2Rfc2V0X3N0YXRl
KGNkLCBVU0JfQ0RfU1RBVEVfQ0JXKTsKKyAgICAgICAgY2Rfc2NzaV9kZXZfcmVxdWVzdF9yZWxl
YXNlKGNkLT5zY3NpX3RhcmdldCwgJmNkLT51c2JfcmVxLnNjc2lfcmVxKTsKKyAgICB9CisKKyAg
ICBTUElDRV9ERUJVRygiUmVhbGl6ZSBPSyBsdW46JXUiLCBsdW4pOworICAgIHJldHVybiAwOwor
fQorCitpbnQgY2RfdXNiX2J1bGtfbXNkX2xvY2soVXNiQ2RCdWxrTXNkRGV2aWNlICpjZCwgdWlu
dDMyX3QgbHVuLCBnYm9vbGVhbiBsb2NrKQoreworICAgIGludCByYzsKKworICAgIHJjID0gY2Rf
c2NzaV9kZXZfbG9jayhjZC0+c2NzaV90YXJnZXQsIGx1biwgbG9jayk7CisgICAgaWYgKHJjICE9
IDApIHsKKyAgICAgICAgU1BJQ0VfRVJST1IoIkZhaWxlZCB0byBsb2NrIGx1bjoldSIsIGx1bik7
CisgICAgICAgIHJldHVybiByYzsKKyAgICB9CisKKyAgICBTUElDRV9ERUJVRygiTG9jayBPSyBs
dW46JXUiLCBsdW4pOworICAgIHJldHVybiAwOworfQorCitpbnQgY2RfdXNiX2J1bGtfbXNkX2xv
YWQoVXNiQ2RCdWxrTXNkRGV2aWNlICpjZCwgdWludDMyX3QgbHVuLAorICAgICAgICAgICAgICAg
ICAgICAgICAgIGNvbnN0IENkU2NzaU1lZGlhUGFyYW1ldGVycyAqbWVkaWFfcGFyYW1zKQorewor
ICAgIGludCByYzsKKworICAgIHJjID0gY2Rfc2NzaV9kZXZfbG9hZChjZC0+c2NzaV90YXJnZXQs
IGx1biwgbWVkaWFfcGFyYW1zKTsKKyAgICBpZiAocmMgIT0gMCkgeworICAgICAgICBTUElDRV9F
UlJPUigiRmFpbGVkIHRvIGxvYWQgbHVuOiV1IiwgbHVuKTsKKyAgICAgICAgcmV0dXJuIHJjOwor
ICAgIH0KKworICAgIFNQSUNFX0RFQlVHKCJMb2FkIE9LIGx1bjoldSIsIGx1bik7CisgICAgcmV0
dXJuIDA7Cit9CisKK2ludCBjZF91c2JfYnVsa19tc2RfZ2V0X2luZm8oVXNiQ2RCdWxrTXNkRGV2
aWNlICpjZCwgdWludDMyX3QgbHVuLCBDZFNjc2lEZXZpY2VJbmZvICpsdW5faW5mbykKK3sKKyAg
ICBpbnQgcmM7CisKKyAgICByYyA9IGNkX3Njc2lfZGV2X2dldF9pbmZvKGNkLT5zY3NpX3Rhcmdl
dCwgbHVuLCBsdW5faW5mbyk7CisgICAgaWYgKHJjICE9IDApIHsKKyAgICAgICAgU1BJQ0VfRVJS
T1IoIkZhaWxlZCB0byBnZXQgaW5mbyBsdW46JXUiLCBsdW4pOworICAgICAgICByZXR1cm4gcmM7
CisgICAgfQorCisgICAgcmV0dXJuIDA7Cit9CisKK2ludCBjZF91c2JfYnVsa19tc2RfdW5sb2Fk
KFVzYkNkQnVsa01zZERldmljZSAqY2QsIHVpbnQzMl90IGx1bikKK3sKKyAgICBpbnQgcmM7CisK
KyAgICByYyA9IGNkX3Njc2lfZGV2X3VubG9hZChjZC0+c2NzaV90YXJnZXQsIGx1bik7CisgICAg
aWYgKHJjICE9IDApIHsKKyAgICAgICAgU1BJQ0VfRVJST1IoIkZhaWxlZCB0byB1bmxvYWQgbHVu
OiV1IiwgbHVuKTsKKyAgICAgICAgcmV0dXJuIHJjOworICAgIH0KKworICAgIFNQSUNFX0RFQlVH
KCJVbmxvYWQgT0sgbHVuOiV1IiwgbHVuKTsKKyAgICByZXR1cm4gMDsKK30KKworaW50IGNkX3Vz
Yl9idWxrX21zZF91bnJlYWxpemUoVXNiQ2RCdWxrTXNkRGV2aWNlICpjZCwgdWludDMyX3QgbHVu
KQoreworICAgIGludCByYzsKKworICAgIHJjID0gY2Rfc2NzaV9kZXZfdW5yZWFsaXplKGNkLT5z
Y3NpX3RhcmdldCwgbHVuKTsKKyAgICBpZiAocmMgIT0gMCkgeworICAgICAgICBTUElDRV9FUlJP
UigiVW5yZWFsaXplIGx1bjoldSIsIGx1bik7CisgICAgICAgIHJldHVybiByYzsKKyAgICB9CisK
KyAgICBTUElDRV9ERUJVRygiVW5yZWFsaXplIGx1bjoldSIsIGx1bik7CisgICAgcmV0dXJuIDA7
Cit9CisKK3ZvaWQgY2RfdXNiX2J1bGtfbXNkX2ZyZWUoVXNiQ2RCdWxrTXNkRGV2aWNlICpjZCkK
K3sKKyAgICBjZF9zY3NpX3RhcmdldF9mcmVlKGNkLT5zY3NpX3RhcmdldCk7CisgICAgZ19mcmVl
KGNkLT5kYXRhX2J1Zik7CisgICAgZ19mcmVlKGNkKTsKKworICAgIFNQSUNFX0RFQlVHKCJGcmVl
Iik7Cit9CisKK2ludCBjZF91c2JfYnVsa19tc2RfcmVzZXQoVXNiQ2RCdWxrTXNkRGV2aWNlICpj
ZCkKK3sKKyAgICBjZF9zY3NpX3RhcmdldF9yZXNldChjZC0+c2NzaV90YXJnZXQpOworICAgIGNk
X3VzYl9idWxrX21zZF9zZXRfc3RhdGUoY2QsIFVTQl9DRF9TVEFURV9DQlcpOworCisgICAgU1BJ
Q0VfREVCVUcoIlJlc2V0Iik7CisgICAgcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgcGFyc2Vf
dXNiX21zZF9jbWQoVXNiQ2RCdWxrTXNkRGV2aWNlICpjZCwgdWludDhfdCAqYnVmLCB1aW50MzJf
dCBjYndfbGVuKQoreworICAgIHN0cnVjdCBVc2JDZENCVyAqY2J3ID0gKHN0cnVjdCBVc2JDZENC
VyAqKWJ1ZjsKKyAgICBVc2JDZEJ1bGtNc2RSZXF1ZXN0ICp1c2JfcmVxID0gJmNkLT51c2JfcmVx
OworICAgIENkU2NzaVJlcXVlc3QgKnNjc2lfcmVxID0gJnVzYl9yZXEtPnNjc2lfcmVxOworCisg
ICAgaWYgKGNid19sZW4gIT0gc2l6ZW9mKCpjYncpKSB7CisgICAgICAgIFNQSUNFX0VSUk9SKCJD
TUQ6IEJhZCBDQlcgc2l6ZToldSIsIGNid19sZW4pOworICAgICAgICByZXR1cm4gLTE7CisgICAg
fQorICAgIGlmIChsZTMydG9oKGNidy0+c2lnKSAhPSAweDQzNDI1MzU1KSB7IC8qIE1TRCBjb21t
YW5kIHNpZ25hdHVyZSAqLworICAgICAgICBTUElDRV9FUlJPUigiQ01EOiBCYWQgQ0JXIHNpZ25h
dHVyZTolMDh4IiwgbGUzMnRvaChjYnctPnNpZykpOworICAgICAgICByZXR1cm4gLTE7CisgICAg
fQorICAgIGNvbnN0IHVpbnQ4X3QgY21kX2xlbiA9IGNidy0+Y21kX2xlbiAmIDB4MUY7CisgICAg
aWYgKGNtZF9sZW4gPCAxIHx8IGNtZF9sZW4gPiAxNikgeworICAgICAgICBTUElDRV9FUlJPUigi
Q01EOiBCYWQgQ0JXIGNvbW1hbmQgbGVuOiUwOHgiLCBjbWRfbGVuKTsKKyAgICAgICAgcmV0dXJu
IC0xOworICAgIH0KKworICAgIHVzYl9yZXEtPmx1biA9IGNidy0+bHVuOworICAgIHVzYl9yZXEt
PnVzYl9yZXFfbGVuID0gbGUzMnRvaChjYnctPmV4cF9kYXRhX2xlbik7CisKKyAgICB1c2JfcmVx
LT5zY3NpX2luX2xlbiA9IDA7IC8qIG5vIGRhdGEgZnJvbSBzY3NpIHlldCAqLworICAgIHVzYl9y
ZXEtPnhmZXJfbGVuID0gMDsgLyogbm8gYnVsa3MgdHJhbnNmZXJlZCB5ZXQgKi8KKyAgICB1c2Jf
cmVxLT5idWxrX2luX2xlbiA9IDA7IC8qIG5vIGJ1bGstaW4gcmVxdWVzdHMgeWV0ICovCisKKyAg
ICBpZiAodXNiX3JlcS0+dXNiX3JlcV9sZW4gPT0gMCkgeworICAgICAgICBjZF91c2JfYnVsa19t
c2Rfc2V0X3N0YXRlKGNkLCBVU0JfQ0RfU1RBVEVfQ1NXKTsgLyogbm8gZGF0YSAtIHJldHVybiBz
dGF0dXMgKi8KKyAgICAgICAgc2NzaV9yZXEtPmJ1ZiA9IE5VTEw7CisgICAgICAgIHNjc2lfcmVx
LT5idWZfbGVuID0gMDsKKyAgICB9IGVsc2UgaWYgKGNidy0+ZmxhZ3MgJiAweDgwKSB7CisgICAg
ICAgIGNkX3VzYl9idWxrX21zZF9zZXRfc3RhdGUoY2QsIFVTQl9DRF9TVEFURV9EQVRBSU4pOyAv
KiByZWFkIGNvbW1hbmQgKi8KKyAgICAgICAgc2NzaV9yZXEtPmJ1ZiA9IGNkLT5kYXRhX2J1ZjsK
KyAgICAgICAgc2NzaV9yZXEtPmJ1Zl9sZW4gPSBjZC0+ZGF0YV9idWZfbGVuOworICAgIH0gZWxz
ZSB7CisgICAgICAgIGNkX3VzYl9idWxrX21zZF9zZXRfc3RhdGUoY2QsIFVTQl9DRF9TVEFURV9E
QVRBT1VUKTsgLyogd3JpdGUgY29tbWFuZCAqLworICAgICAgICBzY3NpX3JlcS0+YnVmID0gTlVM
TDsKKyAgICAgICAgc2NzaV9yZXEtPmJ1Zl9sZW4gPSAwOworICAgIH0KKworICAgIHNjc2lfcmVx
LT5jZGJfbGVuID0gY21kX2xlbjsKKyAgICBnX2Fzc2VydChzY3NpX3JlcS0+Y2RiX2xlbiA8PSBz
aXplb2Yoc2NzaV9yZXEtPmNkYikpOworICAgIG1lbWNweShzY3NpX3JlcS0+Y2RiLCBjYnctPmNt
ZCwgc2NzaV9yZXEtPmNkYl9sZW4pOworCisgICAgc2NzaV9yZXEtPmx1biA9IHVzYl9yZXEtPmx1
bjsKKworICAgIFNQSUNFX0RFQlVHKCJDTUQgbHVuOiV1IHRhZzolI3ggZmxhZ3M6JTA4eCAiCisg
ICAgICAgICAgICAgICAgImNkYl9sZW46JXUgcmVxX2xlbjoldSIsCisgICAgICAgICAgICAgICAg
dXNiX3JlcS0+bHVuLCBsZTMydG9oKGNidy0+dGFnKSwgY2J3LT5mbGFncywKKyAgICAgICAgICAg
ICAgICBzY3NpX3JlcS0+Y2RiX2xlbiwgdXNiX3JlcS0+dXNiX3JlcV9sZW4pOworCisgICAgLyog
cHJlcGFyZSBzdGF0dXMgLSBDU1cgKi8KKyAgICB1c2JfcmVxLT5jc3cuc2lnID0gaHRvbGUzMigw
eDUzNDI1MzU1KTsKKyAgICB1c2JfcmVxLT5jc3cudGFnID0gY2J3LT50YWc7CisgICAgdXNiX3Jl
cS0+Y3N3LnJlc2lkdWUgPSAwOworICAgIHVzYl9yZXEtPmNzdy5zdGF0dXMgPSAodWludDhfdClV
U0JfTVNEX1NUQVRVU19HT09EOworCisgICAgcmV0dXJuIDA7Cit9CisKK3N0YXRpYyB2b2lkIHVz
Yl9jZF9jbWRfZG9uZShVc2JDZEJ1bGtNc2REZXZpY2UgKmNkKQoreworICAgIFVzYkNkQnVsa01z
ZFJlcXVlc3QgKnVzYl9yZXEgPSAmY2QtPnVzYl9yZXE7CisgICAgQ2RTY3NpUmVxdWVzdCAqc2Nz
aV9yZXEgPSAmdXNiX3JlcS0+c2NzaV9yZXE7CisKKyAgICBjZF91c2JfYnVsa19tc2Rfc2V0X3N0
YXRlKGNkLCBVU0JfQ0RfU1RBVEVfQ0JXKTsgLyogQ29tbWFuZCBuZXh0ICovCisgICAgY2Rfc2Nz
aV9kZXZfcmVxdWVzdF9yZWxlYXNlKGNkLT5zY3NpX3RhcmdldCwgc2NzaV9yZXEpOworfQorCitz
dGF0aWMgdm9pZCB1c2JfY2Rfc2VuZF9zdGF0dXMoVXNiQ2RCdWxrTXNkRGV2aWNlICpjZCkKK3sK
KyAgICBVc2JDZEJ1bGtNc2RSZXF1ZXN0ICp1c2JfcmVxID0gJmNkLT51c2JfcmVxOworCisgICAg
U1BJQ0VfREVCVUcoIkNvbW1hbmQgQ1NXIHRhZzoweCV4IG1zZF9zdGF0dXM6JWQgbGVuOiUiIEdf
R1VJTlQ2NF9GT1JNQVQsCisgICAgICAgICAgICAgICAgbGUzMnRvaCh1c2JfcmVxLT5jc3cudGFn
KSwgKGludCl1c2JfcmVxLT5jc3cuc3RhdHVzLCBzaXplb2YodXNiX3JlcS0+Y3N3KSk7CisKKyAg
ICB1c2JfY2RfY21kX2RvbmUoY2QpOworCisgICAgZ19hc3NlcnQodXNiX3JlcS0+Y3N3LnNpZyA9
PSBodG9sZTMyKDB4NTM0MjUzNTUpKTsKKyAgICBjZF91c2JfYnVsa19tc2RfcmVhZF9jb21wbGV0
ZShjZC0+dXNiX3VzZXJfZGF0YSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAo
dWludDhfdCAqKSZ1c2JfcmVxLT5jc3csIHNpemVvZih1c2JfcmVxLT5jc3cpLAorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIEJVTEtfU1RBVFVTX0dPT0QpOworfQorCitzdGF0aWMg
dm9pZCB1c2JfY2Rfc2VuZF9jYW5jZWxlZChVc2JDZEJ1bGtNc2REZXZpY2UgKmNkKQoreworICAg
IFVzYkNkQnVsa01zZFJlcXVlc3QgKnVzYl9yZXEgPSAmY2QtPnVzYl9yZXE7CisKKyAgICBTUElD
RV9ERUJVRygiQ2FuY2VsZWQgY21kIHRhZzoweCV4LCBsZW46JSIgR19HVUlOVDY0X0ZPUk1BVCwK
KyAgICAgICAgICAgICAgICBsZTMydG9oKHVzYl9yZXEtPmNzdy50YWcpLCBzaXplb2YodXNiX3Jl
cS0+Y3N3KSk7CisKKyAgICB1c2JfY2RfY21kX2RvbmUoY2QpOworCisgICAgY2RfdXNiX2J1bGtf
bXNkX3JlYWRfY29tcGxldGUoY2QtPnVzYl91c2VyX2RhdGEsCisgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgTlVMTCwgMCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBCVUxLX1NUQVRVU19DQU5DRUxFRCk7Cit9CisKK3N0YXRpYyB2b2lkIHVzYl9jZF9zZW5kX2Rh
dGFfaW4oVXNiQ2RCdWxrTXNkRGV2aWNlICpjZCwgdWludDMyX3QgbWF4X2xlbikKK3sKKyAgICBV
c2JDZEJ1bGtNc2RSZXF1ZXN0ICp1c2JfcmVxID0gJmNkLT51c2JfcmVxOworICAgIENkU2NzaVJl
cXVlc3QgKnNjc2lfcmVxID0gJnVzYl9yZXEtPnNjc2lfcmVxOworICAgIHVpbnQ4X3QgKmJ1ZiA9
ICgodWludDhfdCAqKXNjc2lfcmVxLT5idWYpICsgdXNiX3JlcS0+eGZlcl9sZW47CisgICAgdWlu
dDMyX3QgYXZhaWxfbGVuID0gdXNiX3JlcS0+c2NzaV9pbl9sZW4gLSB1c2JfcmVxLT54ZmVyX2xl
bjsKKyAgICB1aW50MzJfdCBzZW5kX2xlbiA9IE1JTihhdmFpbF9sZW4sIG1heF9sZW4pOworCisg
ICAgU1BJQ0VfREVCVUcoIkRhdGEtaW4gY21kIHRhZyAweCV4LCByZW1haW5zICV1IgorICAgICAg
ICAgICAgICAgICIsIHJlcXVlc3RlZCAldSwgc2VuZCAldSIsCisgICAgICAgICAgICAgICAgdXNi
X3JlcS0+Y3N3LnRhZywgYXZhaWxfbGVuLCBtYXhfbGVuLCBzZW5kX2xlbik7CisKKyAgICBnX2Fz
c2VydChtYXhfbGVuIDw9IHVzYl9yZXEtPnVzYl9yZXFfbGVuKTsKKworICAgIGNkX3VzYl9idWxr
X21zZF9yZWFkX2NvbXBsZXRlKGNkLT51c2JfdXNlcl9kYXRhLAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGJ1Ziwgc2VuZF9sZW4sCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgQlVMS19TVEFUVVNfR09PRCk7CisKKyAgICBpZiAoc2NzaV9yZXEtPnN0YXR1cyA9
PSBHT09EKSB7CisgICAgICAgIHVzYl9yZXEtPnhmZXJfbGVuICs9IHNlbmRfbGVuOworICAgICAg
ICBpZiAodXNiX3JlcS0+eGZlcl9sZW4gPT0gdXNiX3JlcS0+c2NzaV9pbl9sZW4pIHsKKyAgICAg
ICAgICAgIC8qIGFsbCBkYXRhIGZvciB0aGlzIGJ1bGsgaGFzIGJlZW4gdHJhbnNmZXJyZWQgKi8K
KyAgICAgICAgICAgIGlmICh1c2JfcmVxLT5zY3NpX2luX2xlbiA9PSB1c2JfcmVxLT51c2JfcmVx
X2xlbiB8fCAvKiByZXEgZnVsbHkgc2F0aXNmaWVkICovCisgICAgICAgICAgICAgICAgc2VuZF9s
ZW4gPCBtYXhfbGVuKSB7IC8qIHBhcnRpYWwgYnVsayAtIG5vIG1vcmUgZGF0YSAqLworICAgICAg
ICAgICAgICAgIGNkX3VzYl9idWxrX21zZF9zZXRfc3RhdGUoY2QsIFVTQl9DRF9TVEFURV9DU1cp
OworICAgICAgICAgICAgfSBlbHNlIHsKKyAgICAgICAgICAgICAgICAvKiBwYXJ0aWFsIGNtZCBk
YXRhIGZ1bGxmaWxsZWQgZW50aXJlIHZ1bGstaW4gcmVxdWVzdCAqLworICAgICAgICAgICAgICAg
IGNkX3VzYl9idWxrX21zZF9zZXRfc3RhdGUoY2QsIFVTQl9DRF9TVEFURV9aRVJPX0RBVEFJTik7
CisgICAgICAgICAgICB9CisgICAgICAgIH0KKyAgICB9IGVsc2UgeyAvKiBjbWQgZmFpbGVkIC0g
bm8gbW9yZSBkYXRhICovCisgICAgICAgIGNkX3VzYl9idWxrX21zZF9zZXRfc3RhdGUoY2QsIFVT
Ql9DRF9TVEFURV9DU1cpOworICAgIH0KK30KKworaW50IGNkX3VzYl9idWxrX21zZF9yZWFkKFVz
YkNkQnVsa01zZERldmljZSAqY2QsIHVpbnQzMl90IG1heF9sZW4pCit7CisgICAgVXNiQ2RCdWxr
TXNkUmVxdWVzdCAqdXNiX3JlcSA9ICZjZC0+dXNiX3JlcTsKKyAgICBDZFNjc2lSZXF1ZXN0ICpz
Y3NpX3JlcSA9ICZ1c2JfcmVxLT5zY3NpX3JlcTsKKworICAgIFNQSUNFX0RFQlVHKCJtc2RfcmVh
ZCwgc3RhdGU6ICVzLCBsZW4gJXUiLAorICAgICAgICAgICAgICAgIHVzYl9jZF9zdGF0ZV9zdHIo
Y2QtPnN0YXRlKSwgbWF4X2xlbik7CisKKyAgICBzd2l0Y2ggKGNkLT5zdGF0ZSkgeworICAgIGNh
c2UgVVNCX0NEX1NUQVRFX0NTVzogLyogQ29tbWFuZCBTdGF0dXMgKi8KKyAgICAgICAgaWYgKG1h
eF9sZW4gPCAxMykgeworICAgICAgICAgICAgZ290byBmYWlsOworICAgICAgICB9CisgICAgICAg
IGlmIChjZF9zY3NpX2dldF9yZXFfc3RhdGUoc2NzaV9yZXEpID09IFNDU0lfUkVRX0NPTVBMRVRF
KSB7CisgICAgICAgICAgICB1c2JfY2Rfc2VuZF9zdGF0dXMoY2QpOworICAgICAgICB9IGVsc2Ug
eworICAgICAgICAgICAgdXNiX3JlcS0+YnVsa19pbl9sZW4gKz0gbWF4X2xlbjsKKyAgICAgICAg
ICAgIFNQSUNFX0RFQlVHKCJtc2RfcmVhZCBDU1csIHJlcSBpbmNvbXBsZXRlLCBhZGRlZCBsZW4g
JXUiCisgICAgICAgICAgICAgICAgICAgICAgICAiIHNhdmVkIGxlbiAldSIsCisgICAgICAgICAg
ICAgICAgICAgICAgICBtYXhfbGVuLCB1c2JfcmVxLT5idWxrX2luX2xlbik7CisgICAgICAgIH0K
KyAgICAgICAgYnJlYWs7CisKKyAgICBjYXNlIFVTQl9DRF9TVEFURV9EQVRBSU46IC8qIEJ1bGsg
RGF0YS1JTiAqLworICAgICAgICBpZiAoY2Rfc2NzaV9nZXRfcmVxX3N0YXRlKHNjc2lfcmVxKSA9
PSBTQ1NJX1JFUV9DT01QTEVURSkgeworICAgICAgICAgICAgdXNiX2NkX3NlbmRfZGF0YV9pbihj
ZCwgbWF4X2xlbik7CisgICAgICAgIH0gZWxzZSB7CisgICAgICAgICAgICB1c2JfcmVxLT5idWxr
X2luX2xlbiArPSBtYXhfbGVuOworICAgICAgICAgICAgU1BJQ0VfREVCVUcoIm1zZF9yZWFkIERB
VEFJTiwgcmVxIGluY29tcGxldGUsIGFkZGVkIGxlbiAldSBzYXZlZCBsZW4gJXUiLAorICAgICAg
ICAgICAgICAgICAgICAgICAgbWF4X2xlbiwgdXNiX3JlcS0+YnVsa19pbl9sZW4pOworICAgICAg
ICB9CisgICAgICAgIGJyZWFrOworCisgICAgY2FzZSBVU0JfQ0RfU1RBVEVfWkVST19EQVRBSU46
CisgICAgICAgIGNkX3VzYl9idWxrX21zZF9yZWFkX2NvbXBsZXRlKGNkLT51c2JfdXNlcl9kYXRh
LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOVUxMLCAwLAorICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBCVUxLX1NUQVRVU19HT09EKTsKKyAgICAg
ICAgY2RfdXNiX2J1bGtfbXNkX3NldF9zdGF0ZShjZCwgVVNCX0NEX1NUQVRFX0NTVyk7IC8qIFN0
YXR1cyBuZXh0ICovCisgICAgICAgIGJyZWFrOworCisgICAgZGVmYXVsdDoKKyAgICAgICAgU1BJ
Q0VfRVJST1IoIlVuZXhwZWN0ZWQgcmVhZCBzdGF0ZTogJXMsIGxlbiAldSIsCisgICAgICAgICAg
ICAgICAgICAgIHVzYl9jZF9zdGF0ZV9zdHIoY2QtPnN0YXRlKSwgbWF4X2xlbik7CisgICAgICAg
IGdvdG8gZmFpbDsKKyAgICB9CisgICAgcmV0dXJuIDA7CisKK2ZhaWw6CisgICAgcmV0dXJuIC0x
OworfQorCit2b2lkIGNkX3Njc2lfZGV2X3JlcXVlc3RfY29tcGxldGUodm9pZCAqdGFyZ2V0X3Vz
ZXJfZGF0YSwgQ2RTY3NpUmVxdWVzdCAqc2NzaV9yZXEpCit7CisgICAgVXNiQ2RCdWxrTXNkRGV2
aWNlICpjZCA9IChVc2JDZEJ1bGtNc2REZXZpY2UgKil0YXJnZXRfdXNlcl9kYXRhOworICAgIFVz
YkNkQnVsa01zZFJlcXVlc3QgKnVzYl9yZXEgPSAmY2QtPnVzYl9yZXE7CisKKyAgICBnX2Fzc2Vy
dChzY3NpX3JlcSA9PSAmdXNiX3JlcS0+c2NzaV9yZXEpOworCisgICAgaWYgKHNjc2lfcmVxLT5y
ZXFfc3RhdGUgPT0gU0NTSV9SRVFfQ09NUExFVEUpIHsKKworICAgICAgICB1c2JfcmVxLT5zY3Np
X2luX2xlbiA9IChzY3NpX3JlcS0+aW5fbGVuIDw9IHVzYl9yZXEtPnVzYl9yZXFfbGVuKSA/Cisg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjc2lfcmVxLT5pbl9sZW4gOiB1c2JfcmVx
LT51c2JfcmVxX2xlbjsKKworICAgICAgICAvKiBwcmVwYXJlIENTVyAqLworICAgICAgICBpZiAo
dXNiX3JlcS0+dXNiX3JlcV9sZW4gPiB1c2JfcmVxLT5zY3NpX2luX2xlbikgeworICAgICAgICAg
ICAgdXNiX3JlcS0+Y3N3LnJlc2lkdWUgPSBodG9sZTMyKHVzYl9yZXEtPnVzYl9yZXFfbGVuIC0g
dXNiX3JlcS0+c2NzaV9pbl9sZW4pOworICAgICAgICB9CisgICAgICAgIGlmIChzY3NpX3JlcS0+
c3RhdHVzICE9IEdPT0QpIHsKKyAgICAgICAgICAgIHVzYl9yZXEtPmNzdy5zdGF0dXMgPSAodWlu
dDhfdClVU0JfTVNEX1NUQVRVU19GQUlMRUQ7CisgICAgICAgIH0KKworICAgICAgICBpZiAodXNi
X3JlcS0+YnVsa19pbl9sZW4pIHsKKyAgICAgICAgICAgIC8qIGJ1bGstaW4gcmVxdWVzdCBhcnJp
dmVkIHdoaWxlIHNjc2kgd2FzIHN0aWxsIHJ1bm5pbmcgKi8KKyAgICAgICAgICAgIGlmIChjZC0+
c3RhdGUgPT0gVVNCX0NEX1NUQVRFX0RBVEFJTikgeworICAgICAgICAgICAgICAgIHVzYl9jZF9z
ZW5kX2RhdGFfaW4oY2QsIHVzYl9yZXEtPmJ1bGtfaW5fbGVuKTsKKyAgICAgICAgICAgIH0gZWxz
ZSBpZiAoY2QtPnN0YXRlID09IFVTQl9DRF9TVEFURV9DU1cpIHsKKyAgICAgICAgICAgICAgICB1
c2JfY2Rfc2VuZF9zdGF0dXMoY2QpOworICAgICAgICAgICAgfQorICAgICAgICAgICAgdXNiX3Jl
cS0+YnVsa19pbl9sZW4gPSAwOworICAgICAgICB9CisgICAgfSBlbHNlIGlmIChzY3NpX3JlcS0+
cmVxX3N0YXRlID09IFNDU0lfUkVRX0NBTkNFTEVEKSB7CisgICAgICAgIHVzYl9jZF9zZW5kX2Nh
bmNlbGVkKGNkKTsKKyAgICB9IGVsc2UgeworICAgICAgICBnX2Fzc2VydChzY3NpX3JlcS0+cmVx
X3N0YXRlID09IFNDU0lfUkVRX0RJU1BPU0VEKTsKKyAgICAgICAgU1BJQ0VfREVCVUcoIkRpc3Bv
c2VkIGNtZCB0YWc6MHgleCwgbGVuOiUiIEdfR1VJTlQ2NF9GT1JNQVQsCisgICAgICAgICAgICAg
ICAgbGUzMnRvaCh1c2JfcmVxLT5jc3cudGFnKSwgc2l6ZW9mKHVzYl9yZXEtPmNzdykpOworICAg
ICAgICB1c2JfY2RfY21kX2RvbmUoY2QpOworICAgIH0KK30KKworaW50IGNkX3VzYl9idWxrX21z
ZF9jYW5jZWxfcmVhZChVc2JDZEJ1bGtNc2REZXZpY2UgKmNkKQoreworICAgIFVzYkNkQnVsa01z
ZFJlcXVlc3QgKnVzYl9yZXEgPSAmY2QtPnVzYl9yZXE7CisgICAgQ2RTY3NpUmVxdWVzdCAqc2Nz
aV9yZXEgPSAmdXNiX3JlcS0+c2NzaV9yZXE7CisKKyAgICBjZF9zY3NpX2Rldl9yZXF1ZXN0X2Nh
bmNlbChjZC0+c2NzaV90YXJnZXQsIHNjc2lfcmVxKTsKKyAgICByZXR1cm4gMDsKK30KKworaW50
IGNkX3VzYl9idWxrX21zZF93cml0ZShVc2JDZEJ1bGtNc2REZXZpY2UgKmNkLCB1aW50OF90ICpi
dWZfb3V0LCB1aW50MzJfdCBidWZfb3V0X2xlbikKK3sKKyAgICBzd2l0Y2ggKGNkLT5zdGF0ZSkg
eworICAgIGNhc2UgVVNCX0NEX1NUQVRFX0NCVzogLyogQ29tbWFuZCBCbG9jayAqLworICAgICAg
ICBwYXJzZV91c2JfbXNkX2NtZChjZCwgYnVmX291dCwgYnVmX291dF9sZW4pOworICAgICAgICBp
ZiAoY2QtPnN0YXRlID09IFVTQl9DRF9TVEFURV9EQVRBSU4gfHwgY2QtPnN0YXRlID09IFVTQl9D
RF9TVEFURV9DU1cpIHsKKyAgICAgICAgICAgIGNkX3Njc2lfZGV2X3JlcXVlc3Rfc3VibWl0KGNk
LT5zY3NpX3RhcmdldCwgJmNkLT51c2JfcmVxLnNjc2lfcmVxKTsKKyAgICAgICAgfQorICAgICAg
ICBicmVhazsKKyAgICBjYXNlIFVTQl9DRF9TVEFURV9EQVRBT1VUOiAvKiBEYXRhLU91dCBmb3Ig
YSBXcml0ZSBjbWQgKi8KKyAgICAgICAgY2QtPnVzYl9yZXEuc2NzaV9yZXEuYnVmID0gYnVmX291
dDsKKyAgICAgICAgY2QtPnVzYl9yZXEuc2NzaV9yZXEuYnVmX2xlbiA9IGJ1Zl9vdXRfbGVuOwor
ICAgICAgICBjZF9zY3NpX2Rldl9yZXF1ZXN0X3N1Ym1pdChjZC0+c2NzaV90YXJnZXQsICZjZC0+
dXNiX3JlcS5zY3NpX3JlcSk7CisgICAgICAgIGNkX3VzYl9idWxrX21zZF9zZXRfc3RhdGUoY2Qs
IFVTQl9DRF9TVEFURV9DU1cpOyAvKiBTdGF0dXMgbmV4dCAqLworICAgICAgICBicmVhazsKKyAg
ICBkZWZhdWx0OgorICAgICAgICBTUElDRV9ERUJVRygiVW5leHBlY3RlZCB3cml0ZSBzdGF0ZTog
JXMsIGxlbiAldSIsCisgICAgICAgICAgICAgICAgICAgIHVzYl9jZF9zdGF0ZV9zdHIoY2QtPnN0
YXRlKSwgYnVmX291dF9sZW4pOworICAgICAgICBnb3RvIGZhaWw7CisgICAgfQorICAgIHJldHVy
biAwOworCitmYWlsOgorICAgIHJldHVybiAtMTsKK30KKwordm9pZCBjZF9zY3NpX2Rldl9yZXNl
dF9jb21wbGV0ZSh2b2lkICp0YXJnZXRfdXNlcl9kYXRhLCB1aW50MzJfdCBsdW4pCit7CisgICAg
VXNiQ2RCdWxrTXNkRGV2aWNlICpjZCA9IChVc2JDZEJ1bGtNc2REZXZpY2UgKil0YXJnZXRfdXNl
cl9kYXRhOworCisgICAgaWYgKGNkLT5zdGF0ZSA9PSBVU0JfQ0RfU1RBVEVfREVWSUNFX1JFU0VU
KSB7CisgICAgICAgIGNkX3VzYl9idWxrX21zZF9zZXRfc3RhdGUoY2QsIFVTQl9DRF9TVEFURV9D
QlcpOworICAgICAgICBjZF91c2JfYnVsa19tc2RfcmVzZXRfY29tcGxldGUoY2QtPnVzYl91c2Vy
X2RhdGEsIDApOworICAgIH0KK30KKwordm9pZCBjZF9zY3NpX3RhcmdldF9yZXNldF9jb21wbGV0
ZSh2b2lkICp0YXJnZXRfdXNlcl9kYXRhKQoreworICAgIFVzYkNkQnVsa01zZERldmljZSAqY2Qg
PSAoVXNiQ2RCdWxrTXNkRGV2aWNlICopdGFyZ2V0X3VzZXJfZGF0YTsKKyAgICBjZF91c2JfYnVs
a19tc2Rfc2V0X3N0YXRlKGNkLCBVU0JfQ0RfU1RBVEVfSU5JVCk7Cit9CisKK3ZvaWQgY2Rfc2Nz
aV9kZXZfY2hhbmdlZCh2b2lkICp0YXJnZXRfdXNlcl9kYXRhLCB1aW50MzJfdCBsdW4pCit7Cisg
ICAgVXNiQ2RCdWxrTXNkRGV2aWNlICpjZCA9IChVc2JDZEJ1bGtNc2REZXZpY2UgKil0YXJnZXRf
dXNlcl9kYXRhOworICAgIFNQSUNFX0RFQlVHKCJEZXZpY2UgY2hhbmdlZCwgc3RhdGU6ICVzIGx1
bjogJXUiLAorICAgICAgICAgICAgICAgIHVzYl9jZF9zdGF0ZV9zdHIoY2QtPnN0YXRlKSwgbHVu
KTsKKyAgICBjZF91c2JfYnVsa19tc2RfbHVuX2NoYW5nZWQoY2QtPnVzYl91c2VyX2RhdGEsIGx1
bik7Cit9CisKKyNlbmRpZiAvKiBVU0VfVVNCUkVESVIgKi8KZGlmZiAtLWdpdCBhL3NyYy9jZC11
c2ItYnVsay1tc2QuaCBiL3NyYy9jZC11c2ItYnVsay1tc2QuaApuZXcgZmlsZSBtb2RlIDEwMDY0
NAppbmRleCAwMDAwMDAwLi5jMTY1YzE4Ci0tLSAvZGV2L251bGwKKysrIGIvc3JjL2NkLXVzYi1i
dWxrLW1zZC5oCkBAIC0wLDAgKzEsMTMxIEBACisvKiAtKi0gTW9kZTogQzsgYy1iYXNpYy1vZmZz
ZXQ6IDQ7IGluZGVudC10YWJzLW1vZGU6IG5pbCAtKi0gKi8KKy8qCisgICAgQ29weXJpZ2h0IChD
KSAyMDE4IFJlZCBIYXQsIEluYy4KKworICAgIFJlZCBIYXQgQXV0aG9yczoKKyAgICBBbGV4YW5k
ZXIgTmV6aGluc2t5PGFuZXpoaW5zQHJlZGhhdC5jb20+CisKKyAgICBUaGlzIGxpYnJhcnkgaXMg
ZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yCisgICAgbW9kaWZ5
IGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYworICAg
IExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVp
dGhlcgorICAgIHZlcnNpb24gMi4xIG9mIHRoZSBMaWNlbnNlLCBvciAoYXQgeW91ciBvcHRpb24p
IGFueSBsYXRlciB2ZXJzaW9uLgorCisgICAgVGhpcyBsaWJyYXJ5IGlzIGRpc3RyaWJ1dGVkIGlu
IHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCisgICAgYnV0IFdJVEhPVVQgQU5ZIFdB
UlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKKyAgICBNRVJDSEFO
VEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlIEdO
VQorICAgIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCisK
KyAgICBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgTGVzc2VyIEdl
bmVyYWwgUHVibGljCisgICAgTGljZW5zZSBhbG9uZyB3aXRoIHRoaXMgbGlicmFyeTsgaWYgbm90
LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+LgorKi8KKworI3ByYWdtYSBvbmNl
CisKKyNpbmNsdWRlIDxnaW8vZ2lvLmg+CisKKyNpbmNsdWRlICJjZC1zY3NpLWRldi1wYXJhbXMu
aCIKKworR19CRUdJTl9ERUNMUworCit0eXBlZGVmIGVudW0gQ2RVc2JCdWxrU3RhdHVzIHsKKyAg
ICBCVUxLX1NUQVRVU19HT09EID0gMCwKKyAgICBCVUxLX1NUQVRVU19FUlJPUiwKKyAgICBCVUxL
X1NUQVRVU19DQU5DRUxFRCwKKyAgICBCVUxLX1NUQVRVU19TVEFMTCwKK30gQ2RVc2JCdWxrU3Rh
dHVzOworCit0eXBlZGVmIHN0cnVjdCBVc2JDZEJ1bGtNc2REZXZpY2UgVXNiQ2RCdWxrTXNkRGV2
aWNlOworCisvKiBVU0IgYmFja2VuZCBjYWxsYmFja3MgKi8KKworLyogY2FsbGVkIG9uIGNvbXBs
ZXRlZCByZWFkIGRhdGEgYnVsayB0cmFuc2ZlcgorICogdXNlcl9kYXRhIC0gdXNlcl9kYXRhIGlu
IHVuaXQgcGFyYW1ldGVycyBzdHJ1Y3R1cmUKKyAqIHN0YXR1cyAtIGJ1bGsgc3RhdHVzIGNvZGUK
KyAqLwordm9pZCBjZF91c2JfYnVsa19tc2RfcmVhZF9jb21wbGV0ZSh2b2lkICp1c2VyX2RhdGEs
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQ4X3QgKmRhdGEsIHVpbnQz
Ml90IGxlbmd0aCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ2RVc2JCdWxr
U3RhdHVzIHN0YXR1cyk7CisKKy8qIGNhbGxlZCB3aGVuIHN0YXRlIG9mIGRldmljZSdzIHVuaXQg
Y2hhbmdlZCB0byBzaWduYWwgR1VJIGNvbXBvbmVudAorICogIHVzZXJfZGF0YSAtIHVzZXJfZGF0
YSBpbiB1bml0IHBhcmFtZXRlcnMgc3RydWN0dXJlCisgKi8KK3ZvaWQgY2RfdXNiX2J1bGtfbXNk
X2x1bl9jaGFuZ2VkKHZvaWQgKnVzZXJfZGF0YSwgdWludDMyX3QgbHVuKTsKKworLyogY2FsbGVk
IG9uIGNvbXBsZXRlZCBkZXZpY2UgcmVzZXQKKyAqIHVzZXJfZGF0YSAtIHVzZXJfZGF0YSBpbiB1
bml0IHBhcmFtZXRlcnMgc3RydWN0dXJlCisgKiBzdGF0dXMgLSBlcnJvciBjb2RlCisgKi8KK3Zv
aWQgY2RfdXNiX2J1bGtfbXNkX3Jlc2V0X2NvbXBsZXRlKHZvaWQgKnVzZXJfZGF0YSwKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBzdGF0dXMpOworCisvKiBNU0QgYmFj
a2VuZCBhcGkgKi8KKworLyogYWxsb2NhdGUgbmV3IGRldmljZSBkZXNjcmlwdG9yICovCitVc2JD
ZEJ1bGtNc2REZXZpY2UgKmNkX3VzYl9idWxrX21zZF9hbGxvYyh2b2lkICp1c2VyX2RhdGEsIHVp
bnQzMl90IG1heF9sdW4pOworCisvKiBmcmVlIGRldmljZSBkZXNjcmlwdG9yICovCit2b2lkIGNk
X3VzYl9idWxrX21zZF9mcmVlKFVzYkNkQnVsa01zZERldmljZSAqZGV2aWNlKTsKKworLyogY29u
ZmlndXJlIGEgbmV3IExvZ2ljYWwgVW5pdCB0byBiZSByZXByZXNlbiB0ZWQgYnkgdGhlIGRldmlj
ZQorICogIHJldHVybnM6IGVycm9yIGNvZGUKKyAqLworaW50IGNkX3VzYl9idWxrX21zZF9yZWFs
aXplKFVzYkNkQnVsa01zZERldmljZSAqZGV2aWNlLCB1aW50MzJfdCBsdW4sCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgY29uc3QgQ2RTY3NpRGV2aWNlUGFyYW1ldGVycyAqZGV2X3BhcmFt
cyk7CisKKy8qIGxvY2sgdGhlIGRldmljZSwgcHJldmVudCB1bmxvYWRpbmcKKyAqIHJldHVybnM6
IGVycm9yIGNvZGUKKyAqLworaW50IGNkX3VzYl9idWxrX21zZF9sb2NrKFVzYkNkQnVsa01zZERl
dmljZSAqZGV2aWNlLCB1aW50MzJfdCBsdW4sIGdib29sZWFuIGxvY2spOworCisvKiBsb2FkIG5l
dyBtZWRpYSwgaWYgYWxyZWFkeSBsb2FkZWQsIHNpbXVsYXRlIG1lZGlhIGNoYW5nZQorICogcmV0
dXJuczogZXJyb3IgY29kZQorICovCitpbnQgY2RfdXNiX2J1bGtfbXNkX2xvYWQoVXNiQ2RCdWxr
TXNkRGV2aWNlICpkZXZpY2UsIHVpbnQzMl90IGx1biwKKyAgICAgICAgICAgICAgICAgICAgICAg
ICBjb25zdCBDZFNjc2lNZWRpYVBhcmFtZXRlcnMgKm1lZGlhX3BhcmFtcyk7CisKKy8qIHF1ZXJ5
IHVuaXQgcGFyYW1ldGVycyBhbmQgc3RhdHVzCisgKiByZXR1cm5zOiBlcnJvciBjb2RlCisgKi8K
K2ludCBjZF91c2JfYnVsa19tc2RfZ2V0X2luZm8oVXNiQ2RCdWxrTXNkRGV2aWNlICpkZXZpY2Us
IHVpbnQzMl90IGx1biwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ2RTY3NpRGV2aWNl
SW5mbyAqbHVuX2luZm8pOworCisvKiB1bmxvYWQgdGhlIG1lZGlhCisgKiByZXR1cm5zOiBlcnJv
ciBjb2RlCisgKi8KK2ludCBjZF91c2JfYnVsa19tc2RfdW5sb2FkKFVzYkNkQnVsa01zZERldmlj
ZSAqZGV2aWNlLCB1aW50MzJfdCBsdW4pOworCisvKiBkZXRhY2ggYSBMb2dpY2FsIFVuaXQKKyAq
IHJldHVybnM6IGVycm9yIGNvZGUKKyAqLworaW50IGNkX3VzYl9idWxrX21zZF91bnJlYWxpemUo
VXNiQ2RCdWxrTXNkRGV2aWNlICpkZXZpY2UsIHVpbnQzMl90IGx1bik7CisKKy8qIHJlc2V0IHRo
ZSBkZXZpY2UgaW5zdGFuY2U7IGNhbmNlbCBhbGwgSU8gb3BzLCByZXNldCBzdGF0ZQorICogcmV0
dXJuczogZXJyb3IgY29kZQorICovCitpbnQgY2RfdXNiX2J1bGtfbXNkX3Jlc2V0KFVzYkNkQnVs
a01zZERldmljZSAqZGV2aWNlKTsKKworCisvKiBwZXJmb3JtIGEgd3JpdGUgZGF0YSBidWxrIHRy
YW5zZmVyCisgKiBkYXRhX2xlbiAtIGxlbmd0aCBvZiBhdmFpbGFibGUgZGF0YSB0byB3cml0ZQor
ICogcmV0dXJuczogZXJyb3IgY29kZQorICovCitpbnQgY2RfdXNiX2J1bGtfbXNkX3dyaXRlKFVz
YkNkQnVsa01zZERldmljZSpkZXZpY2UsIHVpbnQ4X3QgKmJ1ZiwgdWludDMyX3QgZGF0YV9sZW4p
OworCisKKy8qIHBlcmZvcm0gYSByZWFkIGRhdGEgYnVsayB0cmFuc2ZlcgorICogbWF4X2xlbiAt
IGxlbmd0aCBvZiBhdmFpbGFibGUgYnVmZmVyIHRvIGZpbGwKKyAqIElmIGRhdGEgYXZhaWxhYmxl
IGltbWVkaWF0ZWx5LCBzaG91bGQgY2FsbCBjZF91c2JfYnVsa19tc2RfcmVhZF9jb21wbGV0ZSgp
CisgKiAgIGFuZCByZXR1cm4gc3VjY2VzcworICogSWYgZmF0YWwgZXJyb3IgZGV0ZWN0ZWQgaW1t
ZWRpYXRlbHksIHNob3VsZCBjYWxsIGNkX3VzYl9idWxrX21zZF9yZWFkX2NvbXBsZXRlKCkKKyAq
ICAgd2l0aCBlcnJvciBjb2RlIGFuZCByZXR1cm4gc3VjY2VzcworICoKKyAqIHJldHVybnM6IDAg
LSBzdWNjZXNzLCAtMSAtIGVycm9yCisgKi8KK2ludCBjZF91c2JfYnVsa19tc2RfcmVhZChVc2JD
ZEJ1bGtNc2REZXZpY2UgKmRldmljZSwgdWludDMyX3QgbWF4X2xlbik7CisKKy8qIGNhbmNlbHMg
cGVuZGluZyByZWFkIGRhdGEgYnVsayB0cmFuc2ZlcgorICogcmV0dXJuczogZXJyb3IgY29kZQor
ICovCitpbnQgY2RfdXNiX2J1bGtfbXNkX2NhbmNlbF9yZWFkKFVzYkNkQnVsa01zZERldmljZSAq
ZGV2aWNlKTsKKworR19FTkRfREVDTFMKZGlmZiAtLWdpdCBhL3NyYy9zY3NpLWNvbnN0YW50cy5o
IGIvc3JjL3Njc2ktY29uc3RhbnRzLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAw
MC4uYTZkMzRhNgotLS0gL2Rldi9udWxsCisrKyBiL3NyYy9zY3NpLWNvbnN0YW50cy5oCkBAIC0w
LDAgKzEsMzIxIEBACisvKiAtKi0gTW9kZTogQzsgYy1iYXNpYy1vZmZzZXQ6IDQ7IGluZGVudC10
YWJzLW1vZGU6IG5pbCAtKi0gKi8KKy8qCisgICBDb3B5cmlnaHQgKEMpIDIwMTggUmVkIEhhdCwg
SW5jLgorICAgQmFzZWQgb24gdGhlIEdMaWIgaGVhZGVyCisKKyAgIFRoaXMgbGlicmFyeSBpcyBm
cmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IKKyAgIG1vZGlmeSBp
dCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKKyAgIExp
Y2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhl
cgorICAgdmVyc2lvbiAyLjEgb2YgdGhlIExpY2Vuc2UsIG9yIChhdCB5b3VyIG9wdGlvbikgYW55
IGxhdGVyIHZlcnNpb24uCisKKyAgIFRoaXMgbGlicmFyeSBpcyBkaXN0cmlidXRlZCBpbiB0aGUg
aG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAorICAgYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZ
OyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKKyAgIE1FUkNIQU5UQUJJTElU
WSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUgR05VCisgICBM
ZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgorCisgICBZb3Ug
c2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVi
bGljCisgICBMaWNlbnNlIGFsb25nIHdpdGggdGhpcyBsaWJyYXJ5OyBpZiBub3QsIHNlZSA8aHR0
cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCisqLworCisjcHJhZ21hIG9uY2UKKworLyoKKyAq
ICAgICAgU0NTSSBvcGNvZGVzCisgKi8KKworI2RlZmluZSBURVNUX1VOSVRfUkVBRFkgICAgICAg
MHgwMAorI2RlZmluZSBSRVdJTkQgICAgICAgICAgICAgICAgMHgwMQorI2RlZmluZSBSRVFVRVNU
X1NFTlNFICAgICAgICAgMHgwMworI2RlZmluZSBGT1JNQVRfVU5JVCAgICAgICAgICAgMHgwNAor
I2RlZmluZSBSRUFEX0JMT0NLX0xJTUlUUyAgICAgMHgwNQorI2RlZmluZSBJTklUSUFMSVpFX0VM
RU1FTlRfU1RBVFVTIDB4MDcKKyNkZWZpbmUgUkVBU1NJR05fQkxPQ0tTXyAgICAgIDB4MDcKKyNk
ZWZpbmUgUkVBRF82ICAgICAgICAgICAgICAgIDB4MDgKKyNkZWZpbmUgV1JJVEVfNiAgICAgICAg
ICAgICAgIDB4MGEKKyNkZWZpbmUgU0VUX0NBUEFDSVRZICAgICAgICAgIDB4MGIKKyNkZWZpbmUg
UkVBRF9SRVZFUlNFICAgICAgICAgIDB4MGYKKyNkZWZpbmUgV1JJVEVfRklMRU1BUktTICAgICAg
IDB4MTAKKyNkZWZpbmUgU1BBQ0UgICAgICAgICAgICAgICAgIDB4MTEKKyNkZWZpbmUgSU5RVUlS
WSAgICAgICAgICAgICAgIDB4MTIKKyNkZWZpbmUgUkVDT1ZFUl9CVUZGRVJFRF9EQVRBIDB4MTQK
KyNkZWZpbmUgTU9ERV9TRUxFQ1QgICAgICAgICAgIDB4MTUKKyNkZWZpbmUgUkVTRVJWRSAgICAg
ICAgICAgICAgIDB4MTYKKyNkZWZpbmUgUkVMRUFTRSAgICAgICAgICAgICAgIDB4MTcKKyNkZWZp
bmUgQ09QWSAgICAgICAgICAgICAgICAgIDB4MTgKKyNkZWZpbmUgRVJBU0UgICAgICAgICAgICAg
ICAgIDB4MTkKKyNkZWZpbmUgTU9ERV9TRU5TRSAgICAgICAgICAgIDB4MWEKKyNkZWZpbmUgTE9B
RF9VTkxPQUQgICAgICAgICAgIDB4MWIKKyNkZWZpbmUgU0NBTiAgICAgICAgICAgICAgICAgIDB4
MWIKKyNkZWZpbmUgU1RBUlRfU1RPUCAgICAgICAgICAgIDB4MWIKKyNkZWZpbmUgUkVDRUlWRV9E
SUFHTk9TVElDICAgIDB4MWMKKyNkZWZpbmUgU0VORF9ESUFHTk9TVElDICAgICAgIDB4MWQKKyNk
ZWZpbmUgQUxMT1dfTUVESVVNX1JFTU9WQUwgIDB4MWUKKyNkZWZpbmUgU0VUX1dJTkRPVyAgICAg
ICAgICAgIDB4MjQKKyNkZWZpbmUgUkVBRF9DQVBBQ0lUWV8xMCAgICAgIDB4MjUKKyNkZWZpbmUg
R0VUX1dJTkRPVyAgICAgICAgICAgIDB4MjUKKyNkZWZpbmUgUkVBRF8xMCAgICAgICAgICAgICAg
IDB4MjgKKyNkZWZpbmUgV1JJVEVfMTAgICAgICAgICAgICAgIDB4MmEKKyNkZWZpbmUgU0VORCAg
ICAgICAgICAgICAgICAgIDB4MmEKKyNkZWZpbmUgU0VFS18xMCAgICAgICAgICAgICAgIDB4MmIK
KyNkZWZpbmUgTE9DQVRFXzEwICAgICAgICAgICAgIDB4MmIKKyNkZWZpbmUgUE9TSVRJT05fVE9f
RUxFTUVOVCAgIDB4MmIKKyNkZWZpbmUgV1JJVEVfVkVSSUZZXzEwICAgICAgIDB4MmUKKyNkZWZp
bmUgVkVSSUZZXzEwICAgICAgICAgICAgIDB4MmYKKyNkZWZpbmUgU0VBUkNIX0hJR0ggICAgICAg
ICAgIDB4MzAKKyNkZWZpbmUgU0VBUkNIX0VRVUFMICAgICAgICAgIDB4MzEKKyNkZWZpbmUgT0JK
RUNUX1BPU0lUSU9OICAgICAgIDB4MzEKKyNkZWZpbmUgU0VBUkNIX0xPVyAgICAgICAgICAgIDB4
MzIKKyNkZWZpbmUgU0VUX0xJTUlUUyAgICAgICAgICAgIDB4MzMKKyNkZWZpbmUgUFJFX0ZFVENI
ICAgICAgICAgICAgIDB4MzQKKyNkZWZpbmUgUkVBRF9QT1NJVElPTiAgICAgICAgIDB4MzQKKyNk
ZWZpbmUgR0VUX0RBVEFfQlVGRkVSX1NUQVRVUyAweDM0CisjZGVmaW5lIFNZTkNIUk9OSVpFX0NB
Q0hFICAgICAweDM1CisjZGVmaW5lIExPQ0tfVU5MT0NLX0NBQ0hFICAgICAweDM2CisjZGVmaW5l
IElOSVRJQUxJWkVfRUxFTUVOVF9TVEFUVVNfV0lUSF9SQU5HRSAweDM3CisjZGVmaW5lIFJFQURf
REVGRUNUX0RBVEEgICAgICAweDM3CisjZGVmaW5lIE1FRElVTV9TQ0FOICAgICAgICAgICAweDM4
CisjZGVmaW5lIENPTVBBUkUgICAgICAgICAgICAgICAweDM5CisjZGVmaW5lIENPUFlfVkVSSUZZ
ICAgICAgICAgICAweDNhCisjZGVmaW5lIFdSSVRFX0JVRkZFUiAgICAgICAgICAweDNiCisjZGVm
aW5lIFJFQURfQlVGRkVSICAgICAgICAgICAweDNjCisjZGVmaW5lIFVQREFURV9CTE9DSyAgICAg
ICAgICAweDNkCisjZGVmaW5lIFJFQURfTE9OR18xMCAgICAgICAgICAweDNlCisjZGVmaW5lIFdS
SVRFX0xPTkdfMTAgICAgICAgICAweDNmCisjZGVmaW5lIENIQU5HRV9ERUZJTklUSU9OICAgICAw
eDQwCisjZGVmaW5lIFdSSVRFX1NBTUVfMTAgICAgICAgICAweDQxCisjZGVmaW5lIFVOTUFQICAg
ICAgICAgICAgICAgICAweDQyCisjZGVmaW5lIFJFQURfVE9DICAgICAgICAgICAgICAweDQzCisj
ZGVmaW5lIFJFUE9SVF9ERU5TSVRZX1NVUFBPUlQgMHg0NAorI2RlZmluZSBHRVRfQ09ORklHVVJB
VElPTiAgICAgMHg0NgorI2RlZmluZSBTQU5JVElaRSAgICAgICAgICAgICAgMHg0OAorI2RlZmlu
ZSBHRVRfRVZFTlRfU1RBVFVTX05PVElGSUNBVElPTiAweDRhCisjZGVmaW5lIExPR19TRUxFQ1Qg
ICAgICAgICAgICAweDRjCisjZGVmaW5lIExPR19TRU5TRSAgICAgICAgICAgICAweDRkCisjZGVm
aW5lIFJFQURfRElTQ19JTkZPUk1BVElPTiAweDUxCisjZGVmaW5lIFJFQURfVFJBQ0tfSU5GT1JN
QVRJT04gMHg1MgorI2RlZmluZSBSRVNFUlZFX1RSQUNLICAgICAgICAgMHg1MworI2RlZmluZSBN
T0RFX1NFTEVDVF8xMCAgICAgICAgMHg1NQorI2RlZmluZSBSRVNFUlZFXzEwICAgICAgICAgICAg
MHg1NgorI2RlZmluZSBSRUxFQVNFXzEwICAgICAgICAgICAgMHg1NworI2RlZmluZSBNT0RFX1NF
TlNFXzEwICAgICAgICAgMHg1YQorI2RlZmluZSBTRU5EX0NVRV9TSEVFVCAgICAgICAgMHg1ZAor
I2RlZmluZSBQRVJTSVNURU5UX1JFU0VSVkVfSU4gMHg1ZQorI2RlZmluZSBQRVJTSVNURU5UX1JF
U0VSVkVfT1VUIDB4NWYKKyNkZWZpbmUgVkFSTEVOR1RIX0NEQiAgICAgICAgIDB4N2YKKyNkZWZp
bmUgV1JJVEVfRklMRU1BUktTXzE2ICAgIDB4ODAKKyNkZWZpbmUgUkVBRF9SRVZFUlNFXzE2ICAg
ICAgIDB4ODEKKyNkZWZpbmUgQUxMT1dfT1ZFUldSSVRFICAgICAgIDB4ODIKKyNkZWZpbmUgRVhU
RU5ERURfQ09QWSAgICAgICAgIDB4ODMKKyNkZWZpbmUgQVRBX1BBU1NUSFJPVUdIXzE2ICAgIDB4
ODUKKyNkZWZpbmUgQUNDRVNTX0NPTlRST0xfSU4gICAgIDB4ODYKKyNkZWZpbmUgQUNDRVNTX0NP
TlRST0xfT1VUICAgIDB4ODcKKyNkZWZpbmUgUkVBRF8xNiAgICAgICAgICAgICAgIDB4ODgKKyNk
ZWZpbmUgQ09NUEFSRV9BTkRfV1JJVEUgICAgIDB4ODkKKyNkZWZpbmUgV1JJVEVfMTYgICAgICAg
ICAgICAgIDB4OGEKKyNkZWZpbmUgV1JJVEVfVkVSSUZZXzE2ICAgICAgIDB4OGUKKyNkZWZpbmUg
VkVSSUZZXzE2ICAgICAgICAgICAgIDB4OGYKKyNkZWZpbmUgUFJFX0ZFVENIXzE2ICAgICAgICAg
IDB4OTAKKyNkZWZpbmUgU1BBQ0VfMTYgICAgICAgICAgICAgIDB4OTEKKyNkZWZpbmUgU1lOQ0hS
T05JWkVfQ0FDSEVfMTYgIDB4OTEKKyNkZWZpbmUgTE9DQVRFXzE2ICAgICAgICAgICAgIDB4OTIK
KyNkZWZpbmUgV1JJVEVfU0FNRV8xNiAgICAgICAgIDB4OTMKKyNkZWZpbmUgRVJBU0VfMTYgICAg
ICAgICAgICAgIDB4OTMKKyNkZWZpbmUgU0VSVklDRV9BQ1RJT05fSU5fMTYgIDB4OWUKKyNkZWZp
bmUgV1JJVEVfTE9OR18xNiAgICAgICAgIDB4OWYKKyNkZWZpbmUgUkVQT1JUX0xVTlMgICAgICAg
ICAgIDB4YTAKKyNkZWZpbmUgQVRBX1BBU1NUSFJPVUdIXzEyICAgIDB4YTEKKyNkZWZpbmUgTUFJ
TlRFTkFOQ0VfSU4gICAgICAgIDB4YTMKKyNkZWZpbmUgTUFJTlRFTkFOQ0VfT1VUICAgICAgIDB4
YTQKKyNkZWZpbmUgTU9WRV9NRURJVU0gICAgICAgICAgIDB4YTUKKyNkZWZpbmUgRVhDSEFOR0Vf
TUVESVVNICAgICAgIDB4YTYKKyNkZWZpbmUgU0VUX1JFQURfQUhFQUQgICAgICAgIDB4YTcKKyNk
ZWZpbmUgUkVBRF8xMiAgICAgICAgICAgICAgIDB4YTgKKyNkZWZpbmUgV1JJVEVfMTIgICAgICAg
ICAgICAgIDB4YWEKKyNkZWZpbmUgU0VSVklDRV9BQ1RJT05fSU5fMTIgIDB4YWIKKyNkZWZpbmUg
RVJBU0VfMTIgICAgICAgICAgICAgIDB4YWMKKyNkZWZpbmUgV1JJVEVfVkVSSUZZXzEyICAgICAg
IDB4YWUKKyNkZWZpbmUgVkVSSUZZXzEyICAgICAgICAgICAgIDB4YWYKKyNkZWZpbmUgU0VBUkNI
X0hJR0hfMTIgICAgICAgIDB4YjAKKyNkZWZpbmUgU0VBUkNIX0VRVUFMXzEyICAgICAgIDB4YjEK
KyNkZWZpbmUgU0VBUkNIX0xPV18xMiAgICAgICAgIDB4YjIKKyNkZWZpbmUgUkVBRF9FTEVNRU5U
X1NUQVRVUyAgIDB4YjgKKyNkZWZpbmUgU0VORF9WT0xVTUVfVEFHICAgICAgIDB4YjYKKworLyog
TU1DLXNwZWNpZmljIG9wY29kZSBhc3NpZ25tZW50ICovCisjZGVmaW5lIE1NQ19TRU5EX0VWRU5U
ICAgICAgICAgIDB4YTIKKyNkZWZpbmUgTU1DX1NFTkRfS0VZICAgICAgICAgICAgMHhhMworI2Rl
ZmluZSBNTUNfUkVQT1JUX0tFWSAgICAgICAgICAweGE0CisjZGVmaW5lIE1NQ19HRVRfUEVSRk9S
TUFOQ0UgICAgIDB4YWMKKyNkZWZpbmUgTU1DX1JFQURfRFZEX1NUUlVDVFVSRSAgMHhhZAorI2Rl
ZmluZSBNTUNfUkVBRF9ERUZFQ1RfREFUQV8xMiAweGI3CisjZGVmaW5lIE1NQ19TRVRfQ0RfU1BF
RUQgICAgICAgIDB4YmIKKyNkZWZpbmUgTU1DX01FQ0hBTklTTV9TVEFUVVMgICAgMHhiZAorI2Rl
ZmluZSBNTUNfUkVBRF9DRCAgICAgICAgICAgICAweGJlCisjZGVmaW5lIE1NQ19TRU5EX0RWRF9T
VFJVQ1RVUkUgIDB4YmYKKworLyoKKyAqIFNFUlZJQ0UgQUNUSU9OIElOIHN1YmNvZGVzCisgKi8K
KyNkZWZpbmUgU0FJX1JFQURfQ0FQQUNJVFlfMTYgIDB4MTAKKworLyoKKyAqIFJFQUQgUE9TSVRJ
T04gc2VydmljZSBhY3Rpb24gY29kZXMKKyAqLworI2RlZmluZSBTSE9SVF9GT1JNX0JMT0NLX0lE
ICAweDAwCisjZGVmaW5lIFNIT1JUX0ZPUk1fVkVORE9SX1NQRUNJRklDIDB4MDEKKyNkZWZpbmUg
TE9OR19GT1JNICAgICAgICAgICAgMHgwNgorI2RlZmluZSBFWFRFTkRFRF9GT1JNICAgICAgICAw
eDA4CisKKy8qCisgKiAgU0FNIFN0YXR1cyBjb2RlcworICovCisKKyNkZWZpbmUgR09PRCAgICAg
ICAgICAgICAgICAgMHgwMAorI2RlZmluZSBDSEVDS19DT05ESVRJT04gICAgICAweDAyCisjZGVm
aW5lIENPTkRJVElPTl9HT09EICAgICAgIDB4MDQKKyNkZWZpbmUgQlVTWSAgICAgICAgICAgICAg
ICAgMHgwOAorI2RlZmluZSBJTlRFUk1FRElBVEVfR09PRCAgICAweDEwCisjZGVmaW5lIElOVEVS
TUVESUFURV9DX0dPT0QgIDB4MTQKKyNkZWZpbmUgUkVTRVJWQVRJT05fQ09ORkxJQ1QgMHgxOAor
I2RlZmluZSBDT01NQU5EX1RFUk1JTkFURUQgICAweDIyCisjZGVmaW5lIFRBU0tfU0VUX0ZVTEwg
ICAgICAgIDB4MjgKKyNkZWZpbmUgQUNBX0FDVElWRSAgICAgICAgICAgMHgzMAorI2RlZmluZSBU
QVNLX0FCT1JURUQgICAgICAgICAweDQwCisKKyNkZWZpbmUgU1RBVFVTX01BU0sgICAgICAgICAg
MHgzZQorCisvKgorICogIFNFTlNFIEtFWVMKKyAqLworCisjZGVmaW5lIE5PX1NFTlNFICAgICAg
ICAgICAgMHgwMAorI2RlZmluZSBSRUNPVkVSRURfRVJST1IgICAgIDB4MDEKKyNkZWZpbmUgTk9U
X1JFQURZICAgICAgICAgICAweDAyCisjZGVmaW5lIE1FRElVTV9FUlJPUiAgICAgICAgMHgwMwor
I2RlZmluZSBIQVJEV0FSRV9FUlJPUiAgICAgIDB4MDQKKyNkZWZpbmUgSUxMRUdBTF9SRVFVRVNU
ICAgICAweDA1CisjZGVmaW5lIFVOSVRfQVRURU5USU9OICAgICAgMHgwNgorI2RlZmluZSBEQVRB
X1BST1RFQ1QgICAgICAgIDB4MDcKKyNkZWZpbmUgQkxBTktfQ0hFQ0sgICAgICAgICAweDA4Cisj
ZGVmaW5lIENPUFlfQUJPUlRFRCAgICAgICAgMHgwYQorI2RlZmluZSBBQk9SVEVEX0NPTU1BTkQg
ICAgIDB4MGIKKyNkZWZpbmUgVk9MVU1FX09WRVJGTE9XICAgICAweDBkCisjZGVmaW5lIE1JU0NP
TVBBUkUgICAgICAgICAgMHgwZQorCisKKy8qCisgKiAgREVWSUNFIFRZUEVTCisgKi8KKworI2Rl
ZmluZSBUWVBFX0RJU0sgICAgICAgICAgIDB4MDAKKyNkZWZpbmUgVFlQRV9UQVBFICAgICAgICAg
ICAweDAxCisjZGVmaW5lIFRZUEVfUFJJTlRFUiAgICAgICAgMHgwMgorI2RlZmluZSBUWVBFX1BS
T0NFU1NPUiAgICAgIDB4MDMgICAgLyogSFAgc2Nhbm5lcnMgdXNlIHRoaXMgKi8KKyNkZWZpbmUg
VFlQRV9XT1JNICAgICAgICAgICAweDA0ICAgIC8qIFRyZWF0ZWQgYXMgUk9NIGJ5IG91ciBzeXN0
ZW0gKi8KKyNkZWZpbmUgVFlQRV9ST00gICAgICAgICAgICAweDA1CisjZGVmaW5lIFRZUEVfU0NB
Tk5FUiAgICAgICAgMHgwNgorI2RlZmluZSBUWVBFX01PRCAgICAgICAgICAgIDB4MDcgICAgLyog
TWFnbmV0by1vcHRpY2FsIGRpc2sgLQorCQkJCSAgICAgKiAtIHRyZWF0ZWQgYXMgVFlQRV9ESVNL
ICovCisjZGVmaW5lIFRZUEVfTUVESVVNX0NIQU5HRVIgMHgwOAorI2RlZmluZSBUWVBFX1NUT1JB
R0VfQVJSQVkgIDB4MGMgICAgLyogU3RvcmFnZSBhcnJheSBkZXZpY2UgKi8KKyNkZWZpbmUgVFlQ
RV9FTkNMT1NVUkUgICAgICAweDBkICAgIC8qIEVuY2xvc3VyZSBTZXJ2aWNlcyBEZXZpY2UgKi8K
KyNkZWZpbmUgVFlQRV9SQkMgICAgICAgICAgICAweDBlICAgIC8qIFNpbXBsaWZpZWQgRGlyZWN0
LUFjY2VzcyBEZXZpY2UgKi8KKyNkZWZpbmUgVFlQRV9PU0QgICAgICAgICAgICAweDExICAgIC8q
IE9iamVjdC1zdG9yYWdlIERldmljZSAqLworI2RlZmluZSBUWVBFX1dMVU4gICAgICAgICAgIDB4
MWUgICAgLyogV2VsbCBrbm93biBMVU4gKi8KKyNkZWZpbmUgVFlQRV9OT1RfUFJFU0VOVCAgICAw
eDFmCisjZGVmaW5lIFRZUEVfSU5BQ1RJVkUgICAgICAgMHgyMAorI2RlZmluZSBUWVBFX05PX0xV
TiAgICAgICAgIDB4N2YKKworLyogTW9kZSBwYWdlIGNvZGVzIGZvciBtb2RlIHNlbnNlL3NldCAq
LworI2RlZmluZSBNT0RFX1BBR0VfUl9XX0VSUk9SICAgICAgICAgICAgICAgICAgIDB4MDEKKyNk
ZWZpbmUgTU9ERV9QQUdFX01SVyAgICAgICAgICAgICAgICAgICAgICAgICAweDAzCisjZGVmaW5l
IE1PREVfUEFHRV9IRF9HRU9NRVRSWSAgICAgICAgICAgICAgICAgMHgwNAorI2RlZmluZSBNT0RF
X1BBR0VfRkxFWElCTEVfRElTS19HRU9NRVRSWSAgICAgIDB4MDUgLyogU0JDICovCisjZGVmaW5l
IE1PREVfUEFHRV9XUklURV9QQVJBTUVURVIgICAgICAgICAgICAgMHgwNSAvKiBNTUMgKi8KKyNk
ZWZpbmUgTU9ERV9QQUdFX0NBQ0hJTkcgICAgICAgICAgICAgICAgICAgICAweDA4CisjZGVmaW5l
IE1PREVfUEFHRV9DRF9ERVZJQ0UgICAgICAgICAgICAgICAgICAgMHgwZAorI2RlZmluZSBNT0RF
X1BBR0VfQVVESU9fQ1RMICAgICAgICAgICAgICAgICAgIDB4MGUKKyNkZWZpbmUgTU9ERV9QQUdF
X1BPV0VSICAgICAgICAgICAgICAgICAgICAgICAweDFhCisjZGVmaW5lIE1PREVfUEFHRV9GQVVM
VF9GQUlMICAgICAgICAgICAgICAgICAgMHgxYworI2RlZmluZSBNT0RFX1BBR0VfVE9fUFJPVEVD
VCAgICAgICAgICAgICAgICAgIDB4MWQKKyNkZWZpbmUgTU9ERV9QQUdFX0NBUFNfTUVDSF9TVEFU
VVMgICAgICAgICAgICAweDJhCisjZGVmaW5lIE1PREVfUEFHRV9NUldfVkVORE9SICAgICAgICAg
ICAgICAgICAgMHgyQworI2RlZmluZSBNT0RFX1BBR0VfQUxMUyAgICAgICAgICAgICAgICAgICAg
ICAgIDB4M2YKKy8qIE5vdCBpbiBNdC4gRnVqaSwgYnV0IGluIEFUQVBJIDIuNiAtLSBkZXByZWNh
dGVkIG5vdyBpbiBmYXZvcgorICogb2YgTU9ERV9QQUdFX1NFTlNFX1BPV0VSICovCisjZGVmaW5l
IE1PREVfUEFHRV9DRFJPTSAgICAgICAgICAgICAgICAgICAgICAgMHgwZAorCisjZGVmaW5lIE1P
REVfUEFHRV9DRFJPTSAgICAgICAgICAgICAgICAgICAgICAgMHgwZAorCisvKiBFdmVudCBub3Rp
ZmljYXRpb24gY2xhc3NlcyBmb3IgR0VUIEVWRU5UIFNUQVRVUyBOT1RJRklDQVRJT04gKi8KKyNk
ZWZpbmUgR0VTTl9OT19FVkVOVFMgICAgICAgICAgICAgICAgMAorI2RlZmluZSBHRVNOX09QRVJB
VElPTkFMX0NIQU5HRSAgICAgICAxCisjZGVmaW5lIEdFU05fUE9XRVJfTUFOQUdFTUVOVCAgICAg
ICAgIDIKKyNkZWZpbmUgR0VTTl9FWFRFUk5BTF9SRVFVRVNUICAgICAgICAgMworI2RlZmluZSBH
RVNOX01FRElBICAgICAgICAgICAgICAgICAgICA0CisjZGVmaW5lIEdFU05fTVVMVElQTEVfSE9T
VFMgICAgICAgICAgIDUKKyNkZWZpbmUgR0VTTl9ERVZJQ0VfQlVTWSAgICAgICAgICAgICAgNgor
CisvKiBFdmVudCBjb2RlcyBmb3IgTUVESUEgZXZlbnQgc3RhdHVzIG5vdGlmaWNhdGlvbiAqLwor
I2RlZmluZSBNRUNfTk9fQ0hBTkdFICAgICAgICAgICAgICAgICAwCisjZGVmaW5lIE1FQ19FSkVD
VF9SRVFVRVNURUQgICAgICAgICAgIDEKKyNkZWZpbmUgTUVDX05FV19NRURJQSAgICAgICAgICAg
ICAgICAgMgorI2RlZmluZSBNRUNfTUVESUFfUkVNT1ZBTCAgICAgICAgICAgICAzIC8qIG9ubHkg
Zm9yIG1lZGlhIGNoYW5nZXJzICovCisjZGVmaW5lIE1FQ19NRURJQV9DSEFOR0VEICAgICAgICAg
ICAgIDQgLyogb25seSBmb3IgbWVkaWEgY2hhbmdlcnMgKi8KKyNkZWZpbmUgTUVDX0JHX0ZPUk1B
VF9DT01QTEVURUQgICAgICAgNSAvKiBNUlcgb3IgRFZEK1JXIGIvZyBmb3JtYXQgY29tcGxldGVk
ICovCisjZGVmaW5lIE1FQ19CR19GT1JNQVRfUkVTVEFSVEVEICAgICAgIDYgLyogTVJXIG9yIERW
RCtSVyBiL2cgZm9ybWF0IHJlc3RhcnRlZCAqLworCisjZGVmaW5lIE1TX1RSQVlfT1BFTiAgICAg
ICAgICAgICAgICAgIDEKKyNkZWZpbmUgTVNfTUVESUFfUFJFU0VOVCAgICAgICAgICAgICAgMgor
CisvKgorICogQmFzZWQgb24gdmFsdWVzIGZyb20gPGxpbnV4L2Nkcm9tLmg+IGJ1dCBleHRlbmRp
bmcgQ0RfTUlOUworICogdG8gdGhlIG1heGltdW0gY29tbW9uIHNpemUgYWxsb3dlZCBieSB0aGUg
T3JhbmdlJ3MgQm9vayBBVElQCisgKgorICogOTAgYW5kIDk5IG1pbiBDRHMgYXJlIGFsc28gYXZh
aWxhYmxlIGJ1dCB1c2luZyB0aGVtIGFzIHRoZQorICogdXBwZXIgbGltaXQgcmVkdWNlcyB0aGUg
ZWZmZWN0aXZlbmVzcyBvZiB0aGUgaGV1cmlzdGljIHRvCisgKiBkZXRlY3QgRFZEcyBidXJuZWQg
dG8gbGVzcyB0aGFuIDI1JSBvZiB0aGVpciBtYXhpbXVtIGNhcGFjaXR5CisgKi8KKworLyogU29t
ZSBnZW5lcmFsbHkgdXNlZnVsIENELVJPTSBpbmZvcm1hdGlvbiAqLworI2RlZmluZSBDRF9NSU5T
ICAgICAgICAgICAgICAgICAgICAgICA4MCAvKiBtYXguIG1pbnV0ZXMgcGVyIENEICovCisjZGVm
aW5lIENEX1NFQ1MgICAgICAgICAgICAgICAgICAgICAgIDYwIC8qIHNlY29uZHMgcGVyIG1pbnV0
ZSAqLworI2RlZmluZSBDRF9GUkFNRVMgICAgICAgICAgICAgICAgICAgICA3NSAvKiBmcmFtZXMg
cGVyIHNlY29uZCAqLworI2RlZmluZSBDRF9GUkFNRVNJWkUgICAgICAgICAgICAgICAgMjA0OCAv
KiBieXRlcyBwZXIgZnJhbWUsICJjb29rZWQiIG1vZGUgKi8KKyNkZWZpbmUgQ0RfTUFYX0JZVEVT
ICAgICAgIChDRF9NSU5TICogQ0RfU0VDUyAqIENEX0ZSQU1FUyAqIENEX0ZSQU1FU0laRSkKKyNk
ZWZpbmUgQ0RfTUFYX1NFQ1RPUlMgICAgIChDRF9NQVhfQllURVMgLyA1MTIpCisKKy8qCisgKiBU
aGUgTU1DIHZhbHVlcyBhcmUgbm90IElERSBzcGVjaWZpYyBhbmQgbWlnaHQgbmVlZCB0byBiZSBt
b3ZlZAorICogdG8gYSBjb21tb24gaGVhZGVyIGlmIHRoZXkgYXJlIGFsc28gbmVlZGVkIGZvciB0
aGUgU0NTSSBlbXVsYXRpb24KKyAqLworCisvKiBQcm9maWxlIGxpc3QgZnJvbSBNTUMtNiByZXZp
c2lvbiAxIHRhYmxlIDkxICovCisjZGVmaW5lIE1NQ19QUk9GSUxFX05PTkUgICAgICAgICAgICAg
ICAgMHgwMDAwCisjZGVmaW5lIE1NQ19QUk9GSUxFX0NEX1JPTSAgICAgICAgICAgICAgMHgwMDA4
CisjZGVmaW5lIE1NQ19QUk9GSUxFX0NEX1IgICAgICAgICAgICAgICAgMHgwMDA5CisjZGVmaW5l
IE1NQ19QUk9GSUxFX0NEX1JXICAgICAgICAgICAgICAgMHgwMDBBCisjZGVmaW5lIE1NQ19QUk9G
SUxFX0RWRF9ST00gICAgICAgICAgICAgMHgwMDEwCisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9S
X1NSICAgICAgICAgICAgMHgwMDExCisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9SQU0gICAgICAg
ICAgICAgMHgwMDEyCisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9SV19STyAgICAgICAgICAgMHgw
MDEzCisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9SV19TUiAgICAgICAgICAgMHgwMDE0CisjZGVm
aW5lIE1NQ19QUk9GSUxFX0RWRF9SX0RMX1NSICAgICAgICAgMHgwMDE1CisjZGVmaW5lIE1NQ19Q
Uk9GSUxFX0RWRF9SX0RMX0pSICAgICAgICAgMHgwMDE2CisjZGVmaW5lIE1NQ19QUk9GSUxFX0RW
RF9SV19ETCAgICAgICAgICAgMHgwMDE3CisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9ERFIgICAg
ICAgICAgICAgMHgwMDE4CisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9QTFVTX1JXICAgICAgICAg
MHgwMDFBCisjZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9QTFVTX1IgICAgICAgICAgMHgwMDFCCisj
ZGVmaW5lIE1NQ19QUk9GSUxFX0RWRF9QTFVTX1JXX0RMICAgICAgMHgwMDJBCisjZGVmaW5lIE1N
Q19QUk9GSUxFX0RWRF9QTFVTX1JfREwgICAgICAgMHgwMDJCCisjZGVmaW5lIE1NQ19QUk9GSUxF
X0JEX1JPTSAgICAgICAgICAgICAgMHgwMDQwCisjZGVmaW5lIE1NQ19QUk9GSUxFX0JEX1JfU1JN
ICAgICAgICAgICAgMHgwMDQxCisjZGVmaW5lIE1NQ19QUk9GSUxFX0JEX1JfUlJNICAgICAgICAg
ICAgMHgwMDQyCisjZGVmaW5lIE1NQ19QUk9GSUxFX0JEX1JFICAgICAgICAgICAgICAgMHgwMDQz
CisjZGVmaW5lIE1NQ19QUk9GSUxFX0hERFZEX1JPTSAgICAgICAgICAgMHgwMDUwCisjZGVmaW5l
IE1NQ19QUk9GSUxFX0hERFZEX1IgICAgICAgICAgICAgMHgwMDUxCisjZGVmaW5lIE1NQ19QUk9G
SUxFX0hERFZEX1JBTSAgICAgICAgICAgMHgwMDUyCisjZGVmaW5lIE1NQ19QUk9GSUxFX0hERFZE
X1JXICAgICAgICAgICAgMHgwMDUzCisjZGVmaW5lIE1NQ19QUk9GSUxFX0hERFZEX1JfREwgICAg
ICAgICAgMHgwMDU4CisjZGVmaW5lIE1NQ19QUk9GSUxFX0hERFZEX1JXX0RMICAgICAgICAgMHgw
MDVBCisjZGVmaW5lIE1NQ19QUk9GSUxFX0lOVkFMSUQgICAgICAgICAgICAgMHhGRkZGCi0tIAoy
LjIxLjAKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClNw
aWNlLWRldmVsIG1haWxpbmcgbGlzdApTcGljZS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcK
aHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9zcGljZS1kZXZl
bA==
