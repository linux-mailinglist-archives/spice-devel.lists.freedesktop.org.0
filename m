Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 8603A463DB
	for <lists+spice-devel@lfdr.de>; Fri, 14 Jun 2019 18:19:25 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 0DDBD89AC0;
	Fri, 14 Jun 2019 16:19:24 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mail.codeweavers.com (mail.codeweavers.com [50.203.203.244])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 297E889A5E
 for <spice-devel@lists.freedesktop.org>; Fri, 14 Jun 2019 16:19:23 +0000 (UTC)
Received: from 82-64-54-218.subs.proxad.net ([82.64.54.218] helo=amboise)
 by mail.codeweavers.com with esmtpsa (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim 4.89) (envelope-from <fgouget@free.fr>) id 1hbovl-0001Pu-Mh
 for spice-devel@lists.freedesktop.org; Fri, 14 Jun 2019 11:19:58 -0500
Received: from fgouget by amboise with local (Exim 4.92)
 (envelope-from <fgouget@amboise.dolphin>) id 1hbovA-0004nC-Bt
 for spice-devel@lists.freedesktop.org; Fri, 14 Jun 2019 18:19:20 +0200
Date: Fri, 14 Jun 2019 18:19:20 +0200 (CEST)
From: Francois Gouget <fgouget@codeweavers.com>
To: Spice devel <spice-devel@lists.freedesktop.org>
In-Reply-To: <3cfa084bfb39cf77de9269282c087f8b30f99867.1560528809.git.fgouget@free.fr>
Message-ID: <c03f02279ee8a24101e80ab6da896b13f5f84d1b.1560528809.git.fgouget@free.fr>
References: <3cfa084bfb39cf77de9269282c087f8b30f99867.1560528809.git.fgouget@free.fr>
User-Agent: Alpine 2.21 (DEB 202 2017-01-01)
MIME-Version: 1.0
X-Spam-Score: -103.7
X-Spam-Report: Spam detection software,
 running on the system "mail.codeweavers.com", 
 has NOT identified this incoming email as spam.  The original
 message has been attached to this so you can view it or label
 similar future email.  If you have any questions, see
 the administrator of that system for details.
 Content preview: By the time schedule_frame() pulls a sample off GStreamer's
 pipeline the frame may have been sitting in the sink's queue for hundreds
 of milliseconds, making the decoding time meaningless. This patch [...] 
 Content analysis details:   (-103.7 points, 5.0 required)
 pts rule name              description
 ---- ---------------------- --------------------------------------------------
 -100 USER_IN_WHITELIST      From: address is in the user's white-list
 -6.0 ALL_TRUSTED            Passed through trusted hosts only via SMTP
 0.0 TVD_RCVD_IP            Message was received from an IP address
 1.0 FREEMAIL_FROM          Sender email is commonly abused enduser mail
 provider (fgouget[at]free.fr)
 1.0 HEADER_FROM_DIFFERENT_DOMAINS From and EnvelopeFrom 2nd level
 mail domains are different
 0.2 FREEMAIL_FORGED_FROMDOMAIN 2nd level domains in From and
 EnvelopeFrom freemail headers are different
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt;
 c=relaxed/relaxed; 
 d=codeweavers.com; s=6377696661; h=Content-Type:MIME-Version:References:
 Message-ID:In-Reply-To:Subject:To:From:Date:Sender:Reply-To:Cc:
 Content-Transfer-Encoding:Content-ID:Content-Description:Resent-Date:
 Resent-From:Resent-Sender:Resent-To:Resent-Cc:Resent-Message-ID:List-Id:
 List-Help:List-Unsubscribe:List-Subscribe:List-Post:List-Owner:List-Archive;
 bh=dYO4urNBglVExp0fddMXSOxRkW2pBM+rr4T7g2idsX4=; b=U/3r5o+iTRP+juM+aR5Gt/l7k
 xaN2fqV82aVSDQLEyA2lQNWulWFfYhj8xumX9GUqgUDIzwxw6XFQlpooZYcKDidZz3EqrxCkRe+tl
 reXhWGohVYOs9+SGYKAhsGQZOPkpvL4/dRaSke95awhcMcbn+8VJnrUck+mcYRRI2OSLg=;
Subject: [Spice-devel] [client 4/5] gstreamer: Improve the statistics
 collection
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

QnkgdGhlIHRpbWUgc2NoZWR1bGVfZnJhbWUoKSBwdWxscyBhIHNhbXBsZSBvZmYgR1N0cmVhbWVy
J3MgcGlwZWxpbmUgdGhlIApmcmFtZSBtYXkgaGF2ZSBiZWVuIHNpdHRpbmcgaW4gdGhlIHNpbmsn
cyBxdWV1ZSBmb3IgaHVuZHJlZHMgb2YgCm1pbGxpc2Vjb25kcywgbWFraW5nIHRoZSBkZWNvZGlu
ZyB0aW1lIG1lYW5pbmdsZXNzLgpUaGlzIHBhdGNoIGVuc3VyZXMgdGhlIHN0YXRpc3RpY3MgYXJl
IGFsd2F5cyBjb2xsZWN0ZWQgYnkKc2lua19ldmVudF9wcm9iZSgpIHdoaWNoIGlzIGNhbGxlZCBh
cyBzb29uIGFzIHRoZSBkZWNvZGVkIGZyYW1lIGlzCmF2YWlsYWJsZS4KTm90ZSB0aGF0IGV2ZW4g
c28gdGhlIGRlY29kaW5nIHRpbWUgbWF5IGJlIG92ZXJlc3RpbWF0ZWQgYXMgdGhlIGZyYW1lCm1h
eSBoYXZlIGJlZW4gd2FpdGluZyBmb3IgYSB3aGlsZSBpbiBlbmNvZGVkIGZvcm0gZm9yIGEgc3Bv
dCB0byBiZSBmcmVlZAppbiB0aGUgR1N0cmVhbWVyIHBpcGVsaW5lJ3Mgc2luayBxdWV1ZS4KClNp
Z25lZC1vZmYtYnk6IEZyYW5jb2lzIEdvdWdldCA8ZmdvdWdldEBjb2Rld2VhdmVycy5jb20+Ci0t
LQogc3JjL2NoYW5uZWwtZGlzcGxheS1nc3QuYyB8IDEwNSArKysrKysrKysrKysrKysrKysrKyst
LS0tLS0tLS0tLS0tLS0tLQogMSBmaWxlIGNoYW5nZWQsIDU5IGluc2VydGlvbnMoKyksIDQ2IGRl
bGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL3NyYy9jaGFubmVsLWRpc3BsYXktZ3N0LmMgYi9zcmMv
Y2hhbm5lbC1kaXNwbGF5LWdzdC5jCmluZGV4IGI1YjhkNTFhLi5mYzMzOGRmZiAxMDA2NDQKLS0t
IGEvc3JjL2NoYW5uZWwtZGlzcGxheS1nc3QuYworKysgYi9zcmMvY2hhbm5lbC1kaXNwbGF5LWdz
dC5jCkBAIC0xLDYgKzEsNiBAQAogLyogLSotIE1vZGU6IEM7IGMtYmFzaWMtb2Zmc2V0OiA0OyBp
bmRlbnQtdGFicy1tb2RlOiBuaWwgLSotICovCiAvKgotICAgQ29weXJpZ2h0IChDKSAyMDE1LTIw
MTYgQ29kZVdlYXZlcnMsIEluYworICAgQ29weXJpZ2h0IChDKSAyMDE1LTIwMTYsIDIwMTkgQ29k
ZVdlYXZlcnMsIEluYwogCiAgICBUaGlzIGxpYnJhcnkgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNh
biByZWRpc3RyaWJ1dGUgaXQgYW5kL29yCiAgICBtb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1zIG9m
IHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCkBAIC0xODUsMTMgKzE4NSwxNiBAQCBzdGF0
aWMgZ2Jvb2xlYW4gZGlzcGxheV9mcmFtZShncG9pbnRlciB2aWRlb19kZWNvZGVyKQogICAgIHJl
dHVybiBHX1NPVVJDRV9SRU1PVkU7CiB9CiAKLS8qIEdldCB0aGUgZGVjb2RlZCBmcmFtZSByZWxh
dGl2ZSB0byBidWZmZXIgb3IgTlVMTCBpZiBub3QgZm91bmQuCi0gKiBEZXF1ZXVlIHRoZSBmcmFt
ZSBmcm9tIGRlY29kaW5nX3F1ZXVlIGFuZCByZXR1cm4gaXQsIGNhbGxlcgotICogaXMgcmVzcG9u
c2libGUgdG8gZnJlZSB0aGUgcG9pbnRlci4KKy8qIFJldHVybnMgdGhlIGRlY29kaW5nIHF1ZXVl
IGVudHJ5IHRoYXQgbWF0Y2hlcyB0aGUgc3BlY2lmaWVkIEdTdHJlYW1lciBidWZmZXIuCisgKgor
ICogVGhlIGVudHJ5IGlzIGlkZW50aWZpZWQgYmFzZWQgb24gdGhlIGJ1ZmZlciB0aW1lc3RhbXAu
IEhvd2V2ZXIgc29tZXRpbWVzCisgKiBHU3RyZWFtZXIgcmV0dXJucyB0aGUgc2FtZSBidWZmZXIg
dHdpY2UgKGFuZCB0aGUgc2Vjb25kIHRpbWUgdGhlIGVudHJ5IG1heQorICogaGF2ZSBiZWVuIHJl
bW92ZWQgYWxyZWFkeSkgb3IgYnVmZmVycyB0aGF0IGhhdmUgYSBtb2RpZmllZCwgYW5kIHRodXMK
KyAqIHVucmVjb2duaXphYmxlLCB0aW1lc3RhbXAuIEluIHN1Y2ggY2FzZXMgTlVMTCBpcyByZXR1
cm5lZC4KICAqCiAgKiBxdWV1ZXNfbXV0ZXggbXVzdCBiZSBoZWxkLgogICovCi1zdGF0aWMgU3Bp
Y2VHc3RGcmFtZSAqZ2V0X2RlY29kZWRfZnJhbWUoU3BpY2VHc3REZWNvZGVyICpkZWNvZGVyLCBH
c3RCdWZmZXIgKmJ1ZmZlcikKK3N0YXRpYyBHTGlzdCAqZmluZF9mcmFtZV9lbnRyeShTcGljZUdz
dERlY29kZXIgKmRlY29kZXIsIEdzdEJ1ZmZlciAqYnVmZmVyKQogewogICAgIEdzdENsb2NrVGlt
ZSBidWZmZXJfdHMgPSBHU1RfQlVGRkVSX1BUUyhidWZmZXIpOwogI2lmIEdTVF9DSEVDS19WRVJT
SU9OKDEsMTQsMCkKQEAgLTIwMyw0OSArMjA2LDM0IEBAIHN0YXRpYyBTcGljZUdzdEZyYW1lICpn
ZXRfZGVjb2RlZF9mcmFtZShTcGljZUdzdERlY29kZXIgKmRlY29kZXIsIEdzdEJ1ZmZlciAqYnVm
CiAgICAgfQogI2VuZGlmCiAKLSAgICAvKiBHc3RyZWFtZXIgc29tZXRpbWVzIHJldHVybnMgdGhl
IHNhbWUgYnVmZmVyIHR3aWNlCi0gICAgICogb3IgYnVmZmVycyB0aGF0IGhhdmUgYSBtb2RpZmll
ZCwgYW5kIHRodXMgdW5yZWNvZ25pemFibGUsIFBUUy4KLSAgICAgKiBCbGluZGx5IHJlbW92aW5n
IGZyYW1lcyBmcm9tIHRoZSBkZWNvZGluZ19xdWV1ZSB1bnRpbCB3ZSBmaW5kIGEKLSAgICAgKiBt
YXRjaCB3b3VsZCBvbmx5IGVtcHR5IHRoZSBxdWV1ZSwgcmVzdWx0aW5nIGluIGxhdGVyIGJ1ZmZl
cnMgbm90Ci0gICAgICogZmluZGluZyBhIG1hdGNoIGVpdGhlciwgZXRjLiBTbyBjaGVjayB0aGUg
YnVmZmVyIGhhcyBhIG1hdGNoaW5nCi0gICAgICogZnJhbWUgZmlyc3QuCi0gICAgICovCi0gICAg
U3BpY2VHc3RGcmFtZSAqZ3N0ZnJhbWUgPSBOVUxMOwogICAgIEdMaXN0ICpsID0gZ19xdWV1ZV9w
ZWVrX2hlYWRfbGluayhkZWNvZGVyLT5kZWNvZGluZ19xdWV1ZSk7CiAgICAgd2hpbGUgKGwpIHsK
LSAgICAgICAgZ3N0ZnJhbWUgPSBsLT5kYXRhOworICAgICAgICBjb25zdCBTcGljZUdzdEZyYW1l
ICpnc3RmcmFtZSA9IGwtPmRhdGE7CiAgICAgICAgIGlmIChnc3RmcmFtZS0+dGltZXN0YW1wID09
IGJ1ZmZlcl90cykgewotICAgICAgICAgICAgYnJlYWs7CisgICAgICAgICAgICByZXR1cm4gbDsK
ICAgICAgICAgfQotICAgICAgICBnc3RmcmFtZSA9IE5VTEw7CiAgICAgICAgIGwgPSBsLT5uZXh0
OwogICAgIH0KIAotICAgIGlmIChnc3RmcmFtZSAhPSBOVUxMKSB7Ci0gICAgICAgIC8qIE5vdyB0
aGF0IHdlIGtub3cgdGhlcmUgaXMgYSBtYXRjaCwgcmVtb3ZlIGl0IGFuZCB0aGUgb2xkZXIKLSAg
ICAgICAgICogZnJhbWVzIGZyb20gdGhlIGRlY29kaW5nIHF1ZXVlICovCi0gICAgICAgIFNwaWNl
R3N0RnJhbWUgKmxhdGVfZnJhbWU7Ci0gICAgICAgIGd1aW50IG51bV9mcmFtZXNfZHJvcHBlZCA9
IDA7Ci0KLSAgICAgICAgLyogVGhlIEdTdHJlYW1lciBwaXBlbGluZSBkcm9wcGVkIHRoZSBjb3Jy
ZXNwb25kaW5nIGJ1ZmZlci4gKi8KLSAgICAgICAgd2hpbGUgKChsYXRlX2ZyYW1lID0gZ19xdWV1
ZV9wb3BfaGVhZChkZWNvZGVyLT5kZWNvZGluZ19xdWV1ZSkpICE9IGdzdGZyYW1lKSB7Ci0gICAg
ICAgICAgICBudW1fZnJhbWVzX2Ryb3BwZWQrKzsKLSAgICAgICAgICAgIGZyZWVfZ3N0X2ZyYW1l
KGxhdGVfZnJhbWUpOwotICAgICAgICB9CisgICAgcmV0dXJuIE5VTEw7Cit9CiAKLSAgICAgICAg
aWYgKG51bV9mcmFtZXNfZHJvcHBlZCAhPSAwKSB7Ci0gICAgICAgICAgICBTUElDRV9ERUJVRygi
dGhlIEdTdHJlYW1lciBwaXBlbGluZSBkcm9wcGVkICV1IGZyYW1lcyIsIG51bV9mcmFtZXNfZHJv
cHBlZCk7Ci0gICAgICAgIH0KKy8qIFBvcHMgdGhlIHF1ZXVlZCBmcmFtZXMgdXAgdG8gYW5kIGlu
Y2x1ZGluZyB0aGUgc3BlY2lmaWVkIGZyYW1lLgorICogQWxsIGZyYW1lcyBhcmUgZnJlZWQgZXhj
ZXB0IHRoYXQgbGFzdCBmcmFtZSB3aGljaCBiZWxvbmdzIHRvIHRoZSBjYWxsZXIuCisgKiBSZXR1
cm5zIHRoZSBudW1iZXIgb2YgZnJlZWQgZnJhbWVzLgorICoKKyAqIHF1ZXVlc19tdXRleCBtdXN0
IGJlIGhlbGQuCisgKi8KK3N0YXRpYyBndWludDMyIHBvcF91cF90b19mcmFtZShTcGljZUdzdERl
Y29kZXIgKmRlY29kZXIsIGNvbnN0IFNwaWNlR3N0RnJhbWUgKnBvcGZyYW1lKQoreworICAgIFNw
aWNlR3N0RnJhbWUgKmdzdGZyYW1lOworICAgIGd1aW50MzIgZnJlZWQgPSAwOwogCi0gICAgICAg
IGNvbnN0IFNwaWNlRnJhbWUgKmZyYW1lID0gZ3N0ZnJhbWUtPmVuY29kZWRfZnJhbWU7Ci0gICAg
ICAgIGludDY0X3QgZHVyYXRpb24gPSBnX2dldF9tb25vdG9uaWNfdGltZSgpIC0gZnJhbWUtPmNy
ZWF0aW9uX3RpbWU7Ci0gICAgICAgIHJlY29yZChmcmFtZXNfc3RhdHMsCi0gICAgICAgICAgICAg
ICAiZnJhbWUgbW1fdGltZSAldSBzaXplICV1IGNyZWF0aW9uIHRpbWUgJSIgUFJJZDY0Ci0gICAg
ICAgICAgICAgICAiIGRlY29kZWQgdGltZSAlIiBQUklkNjQgIiBxdWV1ZSAldSIsCi0gICAgICAg
ICAgICAgICBmcmFtZS0+bW1fdGltZSwgZnJhbWUtPnNpemUsIGZyYW1lLT5jcmVhdGlvbl90aW1l
LAotICAgICAgICAgICAgICAgZHVyYXRpb24sIGdfcXVldWVfZ2V0X2xlbmd0aChkZWNvZGVyLT5k
ZWNvZGluZ19xdWV1ZSkpOworICAgIHdoaWxlICgoZ3N0ZnJhbWUgPSBnX3F1ZXVlX3BvcF9oZWFk
KGRlY29kZXItPmRlY29kaW5nX3F1ZXVlKSkgIT0gcG9wZnJhbWUpIHsKKyAgICAgICAgZnJlZV9n
c3RfZnJhbWUoZ3N0ZnJhbWUpOworICAgICAgICBmcmVlZCsrOwogICAgIH0KLSAgICByZXR1cm4g
Z3N0ZnJhbWU7CisgICAgcmV0dXJuIGZyZWVkOwogfQogCiAvKiBIZWxwZXIgZm9yIHNjaGVkdWxl
X2ZyYW1lKCkuCkBAIC0yNjgsOCArMjU2LDE2IEBAIHN0YXRpYyB2b2lkIGZldGNoX3BlbmRpbmdf
c2FtcGxlKFNwaWNlR3N0RGVjb2RlciAqZGVjb2RlcikKICAgICAgICAgICogZmluZGluZyBhIG1h
dGNoIGVpdGhlciwgZXRjLiBTbyBjaGVjayB0aGUgYnVmZmVyIGhhcyBhIG1hdGNoaW5nCiAgICAg
ICAgICAqIGZyYW1lIGZpcnN0LgogICAgICAgICAgKi8KLSAgICAgICAgU3BpY2VHc3RGcmFtZSAq
Z3N0ZnJhbWUgPSBnZXRfZGVjb2RlZF9mcmFtZShkZWNvZGVyLCBidWZmZXIpOwotICAgICAgICBp
ZiAoZ3N0ZnJhbWUpIHsKKyAgICAgICAgR0xpc3QgKmwgPSBmaW5kX2ZyYW1lX2VudHJ5KGRlY29k
ZXIsIGJ1ZmZlcik7CisgICAgICAgIGlmIChsKSB7CisgICAgICAgICAgICBTcGljZUdzdEZyYW1l
ICpnc3RmcmFtZSA9IGwtPmRhdGE7CisKKyAgICAgICAgICAgIC8qIERlcXVldWUgdGhpcyBhbmQg
YW55IGRyb3BwZWQgZnJhbWVzICovCisgICAgICAgICAgICBndWludDMyIGRyb3BwZWQgPSBwb3Bf
dXBfdG9fZnJhbWUoZGVjb2RlciwgZ3N0ZnJhbWUpOworICAgICAgICAgICAgaWYgKGRyb3BwZWQp
IHsKKyAgICAgICAgICAgICAgICBTUElDRV9ERUJVRygidGhlIEdTdHJlYW1lciBwaXBlbGluZSBk
cm9wcGVkICV1IGZyYW1lcyIsIGRyb3BwZWQpOworICAgICAgICAgICAgfQorCiAgICAgICAgICAg
ICAvKiBUaGUgZnJhbWUgaXMgbm93IHJlYWR5IGZvciBkaXNwbGF5ICovCiAgICAgICAgICAgICBn
c3RmcmFtZS0+ZGVjb2RlZF9zYW1wbGUgPSBzYW1wbGU7CiAgICAgICAgICAgICBkZWNvZGVyLT5k
aXNwbGF5X2ZyYW1lID0gZ3N0ZnJhbWU7CkBAIC00MzgsMTAgKzQzNCwyOCBAQCBzaW5rX2V2ZW50
X3Byb2JlKEdzdFBhZCAqcGFkLCBHc3RQYWRQcm9iZUluZm8gKmluZm8sIGdwb2ludGVyIGRhdGEp
CiAgICAgaWYgKGluZm8tPnR5cGUgJiBHU1RfUEFEX1BST0JFX1RZUEVfQlVGRkVSKSB7IC8vIEJ1
ZmZlciBhcnJpdmVkCiAgICAgICAgIEdzdEJ1ZmZlciAqYnVmZmVyID0gR1NUX1BBRF9QUk9CRV9J
TkZPX0JVRkZFUihpbmZvKTsKICAgICAgICAgZ19tdXRleF9sb2NrKCZkZWNvZGVyLT5xdWV1ZXNf
bXV0ZXgpOwotICAgICAgICBTcGljZUdzdEZyYW1lICpnc3RmcmFtZSA9IGdldF9kZWNvZGVkX2Zy
YW1lKGRlY29kZXIsIGJ1ZmZlcik7Ci0gICAgICAgIGlmIChnc3RmcmFtZSkgewotICAgICAgICAg
ICAgZnJlZV9nc3RfZnJhbWUoZ3N0ZnJhbWUpOworCisgICAgICAgIEdMaXN0ICpsID0gZmluZF9m
cmFtZV9lbnRyeShkZWNvZGVyLCBidWZmZXIpOworICAgICAgICBpZiAobCkgeworICAgICAgICAg
ICAgU3BpY2VHc3RGcmFtZSAqZ3N0ZnJhbWUgPSBsLT5kYXRhOworICAgICAgICAgICAgY29uc3Qg
U3BpY2VGcmFtZSAqZnJhbWUgPSBnc3RmcmFtZS0+ZW5jb2RlZF9mcmFtZTsKKyAgICAgICAgICAg
IGludDY0X3QgZHVyYXRpb24gPSBnX2dldF9tb25vdG9uaWNfdGltZSgpIC0gZnJhbWUtPmNyZWF0
aW9uX3RpbWU7CisgICAgICAgICAgICByZWNvcmQoZnJhbWVzX3N0YXRzLAorICAgICAgICAgICAg
ICAgICAgICJmcmFtZSBtbV90aW1lICV1IHNpemUgJXUgY3JlYXRpb24gdGltZSAlIiBQUklkNjQK
KyAgICAgICAgICAgICAgICAgICAiIGRlY29kZWQgdGltZSAlIiBQUklkNjQgIiBxdWV1ZSAldSIs
CisgICAgICAgICAgICAgICAgICAgZnJhbWUtPm1tX3RpbWUsIGZyYW1lLT5zaXplLCBmcmFtZS0+
Y3JlYXRpb25fdGltZSwgZHVyYXRpb24sCisgICAgICAgICAgICAgICAgICAgZ19xdWV1ZV9nZXRf
bGVuZ3RoKGRlY29kZXItPmRlY29kaW5nX3F1ZXVlKSk7CisKKyAgICAgICAgICAgIGlmICghZGVj
b2Rlci0+YXBwc2luaykgeworICAgICAgICAgICAgICAgIC8qIFRoZSBzaW5rIHdpbGwgZGlzcGxh
eSB0aGUgZnJhbWUgZGlyZWN0bHkgc28gdGhpcworICAgICAgICAgICAgICAgICAqIFNwaWNlR3N0
RnJhbWUgYW5kIHRob3NlIG9mIGFueSBkcm9wcGVkIGZyYW1lIGFyZSBubyBsb25nZXIKKyAgICAg
ICAgICAgICAgICAgKiBuZWVkZWQuCisgICAgICAgICAgICAgICAgICovCisgICAgICAgICAgICAg
ICAgcG9wX3VwX3RvX2ZyYW1lKGRlY29kZXIsIGdzdGZyYW1lKTsKKyAgICAgICAgICAgICAgICBm
cmVlX2dzdF9mcmFtZShnc3RmcmFtZSk7CisgICAgICAgICAgICB9CiAgICAgICAgIH0KKwogICAg
ICAgICBnX211dGV4X3VubG9jaygmZGVjb2Rlci0+cXVldWVzX211dGV4KTsKICAgICB9CiAgICAg
cmV0dXJuIEdTVF9QQURfUFJPQkVfT0s7CkBAIC00NTIsOSArNDY2LDggQEAgc3RhdGljIHZvaWQK
IGRlZXBfZWxlbWVudF9hZGRlZF9jYihHc3RCaW4gKnBpcGVsaW5lLCBHc3RCaW4gKmJpbiwgR3N0
RWxlbWVudCAqZWxlbWVudCwKICAgICAgICAgICAgICAgICAgICAgICBTcGljZUdzdERlY29kZXIg
KmRlY29kZXIpCiB7Ci0gICAgLyogYXR0YWNoIGEgcHJvYmUgdG8gdGhlIHNpbmsgaW4gY2FzZSB3
ZSBkb24ndCBoYXZlIGFwcHNpbmsgKHRoYXQKLSAgICAgKiBpcyB0aGUgZnJhbWVzIGRvZXMgbm90
IGdvIHRvIG5ld19zYW1wbGUgKi8KLSAgICBpZiAoR1NUX0lTX0JBU0VfU0lOSyhlbGVtZW50KSAm
JiBkZWNvZGVyLT5hcHBzaW5rID09IE5VTEwpIHsKKyAgICAvKiBBdHRhY2ggYSBwcm9iZSB0byB0
aGUgc2luayB0byB1cGRhdGUgdGhlIHN0YXRpc3RpY3MgKi8KKyAgICBpZiAoR1NUX0lTX0JBU0Vf
U0lOSyhlbGVtZW50KSkgewogICAgICAgICBHc3RQYWQgKnBhZCA9IGdzdF9lbGVtZW50X2dldF9z
dGF0aWNfcGFkKGVsZW1lbnQsICJzaW5rIik7CiAgICAgICAgIGdzdF9wYWRfYWRkX3Byb2JlKHBh
ZCwgR1NUX1BBRF9QUk9CRV9UWVBFX0JVRkZFUiwgc2lua19ldmVudF9wcm9iZSwgZGVjb2Rlciwg
TlVMTCk7CiAgICAgICAgIGdzdF9vYmplY3RfdW5yZWYocGFkKTsKLS0gCjIuMjAuMQoKX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KU3BpY2UtZGV2ZWwgbWFp
bGluZyBsaXN0ClNwaWNlLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3Rz
LmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL3NwaWNlLWRldmVs
