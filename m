Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id B6F7C6F4D2
	for <lists+spice-devel@lfdr.de>; Sun, 21 Jul 2019 20:55:55 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 0D1CA89A4E;
	Sun, 21 Jul 2019 18:55:54 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mail-io1-xd32.google.com (mail-io1-xd32.google.com
 [IPv6:2607:f8b0:4864:20::d32])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 8F8C589A4E
 for <spice-devel@lists.freedesktop.org>; Sun, 21 Jul 2019 18:55:52 +0000 (UTC)
Received: by mail-io1-xd32.google.com with SMTP id z3so69233282iog.0
 for <spice-devel@lists.freedesktop.org>; Sun, 21 Jul 2019 11:55:52 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc;
 bh=vi60gvaKMEiaaWbME6VOrNGN+wk1ZL0F3wPLWdoq+Fg=;
 b=TnQXORG2Zr+h6zGVpp8UN6RqXgoOG5kYQzlQPyRGG3JUE2JCQbWcHBqjQdK+Myn6Wk
 eC10iySiurxLX25Izv+HLIyGUOe3u9QwxN6JJ8fnB/jDNCiiIqJsFsXM8VUEMvaQAt/E
 ieY+MfDzN8l8R+Op0xkdUSBcSt6bdz/+Zb2cqg3lgX/3XhyRcxAwCiS8ztWTdOvvrF/k
 g+wfLRfHjcROYhCEhNV+WYphXot9unlL1wwlWYS3XpPa9WnrjE3Tg2eLv51trSUx43BD
 l5EhLc4zVEMX+upvevC378NfO6XL/+iEIOCz7vryYOTfnkDS0OE/a+yCX67xkUtseiMm
 JaYA==
X-Gm-Message-State: APjAAAUEvI6YlGpSFQUYq3Ccyeys6kF5+y7PQytlbFYeYjYF+nLkaOIN
 pZEbjCf2MP6pT6JF6XxfuaTVKK16dntZ0Qt/nVg=
X-Google-Smtp-Source: APXvYqynyki3cR3qT+alBh3j9jnpmdvYugA9pN7EUnKDz74/eRWiaamfpCy1JZL0vGBQuaeN4uMXfae252yuwqlhrfg=
X-Received: by 2002:a6b:6611:: with SMTP id a17mr37836603ioc.179.1563735351568; 
 Sun, 21 Jul 2019 11:55:51 -0700 (PDT)
MIME-Version: 1.0
References: <20190714140741.3274-1-yuri.benditovich@daynix.com>
 <20190714140741.3274-3-yuri.benditovich@daynix.com>
 <20190719101411.wqdywrs6txq4wzl3@wingsuit>
In-Reply-To: <20190719101411.wqdywrs6txq4wzl3@wingsuit>
From: Yuri Benditovich <yuri.benditovich@daynix.com>
Date: Sun, 21 Jul 2019 21:55:28 +0300
Message-ID: <CAOEp5Of2oF_mHTZHX4ub5sJKOcO05T+aKJ3132dKo=evsKZkAw@mail.gmail.com>
To: Victor Toso <victortoso@redhat.com>
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=daynix-com.20150623.gappssmtp.com; s=20150623;
 h=mime-version:references:in-reply-to:from:date:message-id:subject:to
 :cc;
 bh=vi60gvaKMEiaaWbME6VOrNGN+wk1ZL0F3wPLWdoq+Fg=;
 b=Rf/JRiOysKlj9LlNm34t6L2/mHUB7yoXf1GNqTer+iRailK098uzI5CnUkvBluUihM
 mZ9ow8dsCuxW0auJEcYD097erKGvALNS2fuDM2PJeiXE3ZMJqhnbjzihW5nPMIzMCqAM
 4Z2RH9n9Mj/iGd6meqY01isB09XJE4i6PeP5DfilDq4MHg/p/SMhJoHkWLtlDovL67il
 NmgZ3JJ9afxPJR/3lHo8ywPZuj+3Z6Tv+YtzlVOeF3PVFyKNZ/VzZF7brpfOufeGJ1/m
 1TgNv78LoOIuzo+kqc7chrx35hVPy4/mvd83JcZ6qWGDhGc1c4fq0Ks4jrxB9g/zXvxj
 zOWg==
Subject: Re: [Spice-devel] [spice-gtk 2/5] usb-redir: unify device
 hotplug/unplug for Windows and Linux
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Yan Vugenfirer <yan@daynix.com>,
 Spice List <spice-devel@lists.freedesktop.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

T24gRnJpLCBKdWwgMTksIDIwMTkgYXQgMToxNCBQTSBWaWN0b3IgVG9zbyA8dmljdG9ydG9zb0By
ZWRoYXQuY29tPiB3cm90ZToKPgo+IEhpLAo+Cj4gT24gU3VuLCBKdWwgMTQsIDIwMTkgYXQgMDU6
MDc6MzhQTSArMDMwMCwgWXVyaSBCZW5kaXRvdmljaCB3cm90ZToKPiA+IFJlbW92ZSBXaW5kb3dz
LXNwZWNpZmljIHBhcnQgb2YgaG90cGx1ZyBkZXRlY3Rpb24gZnJvbQo+ID4gdXNiLWRldmljZS1t
YW5hZ2VyIGFuZCB3aW4tdXNiLWRldiBhbmQgcGxhY2UgaXQgaW50bwo+ID4gVVNCIGJhY2tlbmQg
bW9kdWxlLiBDb25uZWN0IHRoZSBob3RwbHVnL3VucGx1ZyBkZXRlY3Rpb24KPiA+IGluIFdpbmRv
d3MgdG8gdGhlIHNhbWUgY2FsbGJhY2tzIGFscmVhZHkgdXNlZCBpbiBMaW51eC4KPiA+IFRoaXMg
cmVtb3ZlcyBzaWduaWZpY2FudCBwYXJ0IG9mIFdpbmRvd3Mtc3BlY2lmaWMgY29kZQo+ID4gYW5k
IHNpbXBpZmllcyB0aGluZ3MuCj4gPiBOb3RlIHJlZ2FyZGluZyAncmVkaXJlY3RpbmcnIHByb3Bl
cnR5IG9mIHVzYi1kZXZpY2UtbWFuYWdlcjoKPiA+IC0gUHJldmlvdXNseSB1c2ItZGV2aWNlLW1h
bmFnZXIgdW5kZXIgV2luZG93cyBtYWludGFpbmVkCj4gPiAgICdyZWRpcmVjdGlvbicgcHJvcGVy
dHkgaW4gd2luLXVzYi1kZXYKPiA+IC0gTm93IGl0IG1haW50YWlucyBpdHMgb3duIHByb3BlcnR5
IGluIGJvdGggV2luZG93cyBhbmQKPiA+ICAgTGludXggKGZvciBHVUkgYW5kIHNpbmdsZSByZWRp
cmVjdCBhdCBhIHRpbWUpCj4gPiAtIFRoZSBVU0IgYmFja2VuZCBtYWludGFpbnMgaXRzIG93biAn
cmVkaXJlY3RpbmcnIGZpZWxkCj4gPiAgIGluIFdpbmRvd3MgdG8gcHJldmVudCB1cGRhdGUgb2Yg
ZGV2aWNlIGxpc3Qgd2hlbgo+ID4gICBsaWJ1c2Igb3BlbnMgdGhlIGRldmljZSAoZGV2aWNlIHJl
ZGlyZWN0aW9uIGNhdXNlcwo+ID4gICB0ZW1wb3JhcnkgcmVtb3ZhbCBvZiB0YXJnZXQgZGV2aWNl
KQo+Cj4gVGhhbmtzIGZvciB0aGUgZGVzY3JpcHRpb24uIE9ubHkgbWlub3IgdGhpbmdzLCBsb2dp
YyBzZWVtcyBmaW5lLAo+IGRpZCBxdWljayB0ZXN0cyBvbmx5LiBXb3VsZCBiZSBuaWNlIHRvIHJl
ZHVjZSBkaWZmIGZyb20gdGhpbmdzCj4gdGhhdCBjYW4gYmUgc21hbGxlciBwYXRjaGVzIHdoZW5l
dmVyIG5lZWRlZCwgZnVuY3Rpb24gcmVuYW1lcyBvcgo+IGJlaW5nIG1vdmVkIG9yIHZhcmlhYmxl
cyBiZWluZyBkcm9wcGVkIGZvciBpbnN0YW5jZSBzbyBpdCB3b3VsZAo+IGdldCBlYXNpZXIgdG8g
Zm9jdXMgb24gdGhlIGFjdHVhbCBpbnRlcmVzdGluZyBwYXJ0IG9mIHByb3Bvc2FsLgo+IFRoaXMg
aXMgYWx3YXlzIG1lbnRpb25lZCBhbmQgdGhhdCdzIG9uZSBvZiB0aGUgcmVhc29ucyB0aGF0IGl0
Cj4gdGFrZXMgdGltZSB0byByZXZpZXcuCj4KPiA+IFNpZ25lZC1vZmYtYnk6IFl1cmkgQmVuZGl0
b3ZpY2ggPHl1cmkuYmVuZGl0b3ZpY2hAZGF5bml4LmNvbT4KPiA+IC0tLQo+ID4gIG1lc29uLmJ1
aWxkICAgICAgICAgICAgICB8ICAgMiArLQo+ID4gIHNyYy9tZXNvbi5idWlsZCAgICAgICAgICB8
ICAgNCArLQo+ID4gIHNyYy91c2ItYmFja2VuZC5jICAgICAgICB8IDM2MCArKysrKysrKysrKysr
KysrKysrKysrLS0tLS0tLS0tLQo+ID4gIHNyYy91c2ItYmFja2VuZC5oICAgICAgICB8ICAgOCAt
Cj4gPiAgc3JjL3VzYi1kZXZpY2UtbWFuYWdlci5jIHwgIDYxICstLS0tLQo+ID4gIHNyYy93aW4t
dXNiLWRldi5jICAgICAgICB8IDQzNiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0KPiA+ICBzcmMvd2luLXVzYi1kZXYuaCAgICAgICAgfCAgODQgLS0tLS0tLS0KPiA+ICA3
IGZpbGVzIGNoYW5nZWQsIDI1NSBpbnNlcnRpb25zKCspLCA3MDAgZGVsZXRpb25zKC0pCj4KPiBR
dWl0ZSBoYXBweSB3aXRoIHRoZSBjb2RlIHJlZHVjdGlvbiEgVGhhdCdzIG9uZSB0aGluZyBJIHdh
cwo+IGV4cGVjdGluZyBmcm9tIGludHJvZHVjaW5nIHVzYi1iYWNrZW5kLltjaF0KPgo+ID4gIGRl
bGV0ZSBtb2RlIDEwMDY0NCBzcmMvd2luLXVzYi1kZXYuYwo+ID4gIGRlbGV0ZSBtb2RlIDEwMDY0
NCBzcmMvd2luLXVzYi1kZXYuaAo+ID4KPiA+IGRpZmYgLS1naXQgYS9tZXNvbi5idWlsZCBiL21l
c29uLmJ1aWxkCj4gPiBpbmRleCA1NDE2MGY5Li4xZjZlYTZkIDEwMDY0NAo+ID4gLS0tIGEvbWVz
b24uYnVpbGQKPiA+ICsrKyBiL21lc29uLmJ1aWxkCj4gPiBAQCAtMTE3LDcgKzExNyw3IEBAIGVu
ZGZvcmVhY2gKPiA+Cj4gPiAgZGVwcyA9IFtdCj4gPiAgaWYgaG9zdF9tYWNoaW5lLnN5c3RlbSgp
ID09ICd3aW5kb3dzJwo+ID4gLSAgZGVwcyArPSBbJ2xpYndzMl8zMicsICdsaWJnZGkzMiddCj4g
PiArICBkZXBzICs9IFsnbGlid3MyXzMyJywgJ2xpYmdkaTMyJywgJ2xpYmNvbWN0bDMyJ10KPiA+
ICBlbmRpZgo+ID4KPiA+ICBmb3JlYWNoIGRlcCA6IGRlcHMKPiA+IGRpZmYgLS1naXQgYS9zcmMv
bWVzb24uYnVpbGQgYi9zcmMvbWVzb24uYnVpbGQKPiA+IGluZGV4IGE1MWQwYTkuLmFkY2ZhZWMg
MTAwNjQ0Cj4gPiAtLS0gYS9zcmMvbWVzb24uYnVpbGQKPiA+ICsrKyBiL3NyYy9tZXNvbi5idWls
ZAo+ID4gQEAgLTE1OCw5ICsxNTgsNyBAQCBlbmRpZgo+ID4KPiA+ICBpZiBzcGljZV9ndGtfaGFz
X3VzYnJlZGlyIGFuZCBob3N0X21hY2hpbmUuc3lzdGVtKCkgPT0gJ3dpbmRvd3MnCj4gPiAgICBz
cGljZV9jbGllbnRfZ2xpYl9zb3VyY2VzICs9IFsndXNiZGtfYXBpLmMnLAo+ID4gLSAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgJ3VzYmRrX2FwaS5oJywKPiA+IC0gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICd3aW4tdXNiLWRldi5jJywKPiA+IC0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICd3aW4tdXNiLWRldi5oJ10KPiA+ICsgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICd1c2Jka19hcGkuaCddCj4gPiAgZW5kaWYKPiA+Cj4gPiAgIwo+ID4gZGlm
ZiAtLWdpdCBhL3NyYy91c2ItYmFja2VuZC5jIGIvc3JjL3VzYi1iYWNrZW5kLmMKPiA+IGluZGV4
IGEyYzUwMmQuLjk5NjRjNGYgMTAwNjQ0Cj4gPiAtLS0gYS9zcmMvdXNiLWJhY2tlbmQuYwo+ID4g
KysrIGIvc3JjL3VzYi1iYWNrZW5kLmMKPiA+IEBAIC0zMiw2ICszMiw5IEBACj4gPiAgI2luY2x1
ZGUgPGxpYnVzYi5oPgo+ID4gICNpbmNsdWRlIDxzdHJpbmcuaD4KPiA+ICAjaW5jbHVkZSA8ZmNu
dGwuaD4KPiA+ICsjaWZkZWYgR19PU19XSU4zMgo+ID4gKyNpbmNsdWRlIDxjb21tY3RybC5oPgo+
ID4gKyNlbmRpZgo+ID4gICNpbmNsdWRlICJ1c2JyZWRpcmhvc3QuaCIKPiA+ICAjaW5jbHVkZSAi
dXNicmVkaXJwYXJzZXIuaCIKPiA+ICAjaW5jbHVkZSAic3BpY2UtdXRpbC5oIgo+ID4gQEAgLTU1
LDYgKzU4LDExIEBAIHN0cnVjdCBfU3BpY2VVc2JCYWNrZW5kCj4gPiAgICAgIHVzYl9ob3RfcGx1
Z19jYWxsYmFjayBob3RwbHVnX2NhbGxiYWNrOwo+ID4gICAgICB2b2lkICpob3RwbHVnX3VzZXJf
ZGF0YTsKPiA+ICAgICAgbGlidXNiX2hvdHBsdWdfY2FsbGJhY2tfaGFuZGxlIGhvdHBsdWdfaGFu
ZGxlOwo+ID4gKyNpZmRlZiBHX09TX1dJTjMyCj4gPiArICAgIEhBTkRMRSBoV25kOwo+ID4gKyAg
ICBsaWJ1c2JfZGV2aWNlICoqbGlidXNiX2RldmljZV9saXN0Owo+ID4gKyAgICBnaW50IHJlZGly
ZWN0aW5nOwo+ID4gKyNlbmRpZgo+ID4gIH07Cj4gPgo+ID4gIHN0cnVjdCBfU3BpY2VVc2JCYWNr
ZW5kQ2hhbm5lbAo+ID4gQEAgLTY2LDkgKzc0LDIyOSBAQCBzdHJ1Y3QgX1NwaWNlVXNiQmFja2Vu
ZENoYW5uZWwKPiA+ICAgICAgaW50IHJ1bGVzX2NvdW50Owo+ID4gICAgICBTcGljZVVzYkJhY2tl
bmREZXZpY2UgKmF0dGFjaGVkOwo+ID4gICAgICBTcGljZVVzYnJlZGlyQ2hhbm5lbCAgKnVzZXJf
ZGF0YTsKPiA+ICsgICAgU3BpY2VVc2JCYWNrZW5kICpiYWNrZW5kOwo+ID4gICAgICBHRXJyb3Ig
KiplcnJvcjsKPiA+ICB9Owo+ID4KPgo+IFNvbWUgY29kZSBiZWxvdyBpcyBqdXN0IGJlaW5nIG1v
dmVkLCBtYWtlcyB0aGUgZGlmZiBhIGxpdHRsZQo+IGJpZ2dlciBhbmQgcmV2aWV3IGEgYml0IHNs
b3dlci4gSWYgSSBjb21tZW50IG9uIGNvZGUgdGhhdCBoYXMKPiBiZWVuIG9ubHkgbW92ZWQgYW5k
IHlvdSBjb25zaWRlciB0aGUgY29tbWVudHMgcmVsZXZhbnQsIHBsZWFzZQo+IGFkZHJlc3MgdGhl
bSBpbiBkaWZmZXJlbnQgcGF0Y2hlcy4KPgo+ID4gK3N0YXRpYyBnYm9vbGVhbiBmaWxsX3VzYl9p
bmZvKFNwaWNlVXNiQmFja2VuZERldmljZSAqYmRldikKPgo+IEluIHNldmVyYWwgcGxhY2VzIHdl
IGhhdmUgZGlmZmVyZW50IHZhcmlhYmxlIG5hbWVzIGZvciBnaXZpbmcKPiBzdHJ1Y3R1cmVzLCBp
dCB3b3VsZCBiZSBnb29kIHRvIGhhdmUgaXQgc29tZXdoYXQgc2ltaWxhciBzbyB0aGF0Cj4gcmVh
ZGluZyB0aGUgY29kZSB5b3UgZG9uJ3QgaGF2ZSB0byB0aGluayBpZiBkZXYgaXMgbGlidXNiX2Rl
dmljZQo+IG9yIFNwaWNlVXNiQmFja2VuZERldmljZSwgZXRjLgo+Cj4gPiArewo+ID4gKyAgICBV
c2JEZXZpY2VJbmZvcm1hdGlvbiAqaW5mbyA9ICZiZGV2LT5kZXZpY2VfaW5mbzsKPiA+ICsKPiA+
ICsgICAgc3RydWN0IGxpYnVzYl9kZXZpY2VfZGVzY3JpcHRvciBkZXNjOwo+ID4gKyAgICBsaWJ1
c2JfZGV2aWNlICpsaWJkZXYgPSBiZGV2LT5saWJ1c2JfZGV2aWNlOwo+ID4gKyAgICBsaWJ1c2Jf
Z2V0X2RldmljZV9kZXNjcmlwdG9yKGxpYmRldiwgJmRlc2MpOwo+ID4gKyAgICBpbmZvLT5idXMg
PSBsaWJ1c2JfZ2V0X2J1c19udW1iZXIobGliZGV2KTsKPiA+ICsgICAgaW5mby0+YWRkcmVzcyA9
IGxpYnVzYl9nZXRfZGV2aWNlX2FkZHJlc3MobGliZGV2KTsKPiA+ICsgICAgaWYgKGluZm8tPmFk
ZHJlc3MgPT0gMHhmZiB8fCAvKiByb290IGh1YiAoSENEKSAqLwo+ID4gKyAgICAgICAgaW5mby0+
YWRkcmVzcyA8PSAxIHx8IC8qIHJvb3QgaHViIG9yIGJhZCBhZGRyZXNzICovCj4gPiArICAgICAg
ICAoZGVzYy5iRGV2aWNlQ2xhc3MgPT0gTElCVVNCX0NMQVNTX0hVQikgLypodWIqLykgewo+ID4g
KyAgICAgICAgcmV0dXJuIEZBTFNFOwo+ID4gKyAgICB9Cj4gPiArCj4gPiArICAgIGluZm8tPnZp
ZCA9IGRlc2MuaWRWZW5kb3I7Cj4gPiArICAgIGluZm8tPnBpZCA9IGRlc2MuaWRQcm9kdWN0Owo+
ID4gKyAgICBpbmZvLT5jbGFzcyA9IGRlc2MuYkRldmljZUNsYXNzOwo+ID4gKyAgICBpbmZvLT5z
dWJjbGFzcyA9IGRlc2MuYkRldmljZVN1YkNsYXNzOwo+ID4gKyAgICBpbmZvLT5wcm90b2NvbCA9
IGRlc2MuYkRldmljZVByb3RvY29sOwo+Cj4gRmlsbGluZyBVc2JEZXZpY2VJbmZvcm1hdGlvbiBm
cm9tIGxpYnVzYl9kZXZpY2UgY2FuIGJlIG1hZGUgaW50bwo+IGEgdXRpbGl0eSBmdW5jdGlvbiBh
cyB0aGlzIGhhcHBlbnMgaGVyZSBhbmQgaXNfc2FtZV9saWJ1c2JfZGV2KCksCj4gYnV0IGFsc28g
YmVjYXVzZSBpdCBjYW4gcmVtb3ZlIGEgZXh0cmEgcGFyYW1ldGVyIG9uIHRoZSBsYXRlci4KPiBU
YWtpbmcgYSBzaG90IGF0IHRoZSBuYW1lLCBnZXRfZGV2aWNlX2luZm9fZnJvbV9saWJ1c2JfZGV2
aWNlKCkhCj4KPiA+ICsKPiA+ICsgICAgcmV0dXJuIFRSVUU7Cj4gPiArfQo+ID4gKwo+ID4gK3N0
YXRpYyBTcGljZVVzYkJhY2tlbmREZXZpY2UgKmFsbG9jYXRlX2JhY2tlbmRfZGV2aWNlKGxpYnVz
Yl9kZXZpY2UgKmxpYmRldikKPiA+ICt7Cj4gPiArICAgIFNwaWNlVXNiQmFja2VuZERldmljZSAq
ZGV2ID0gZ19uZXcwKFNwaWNlVXNiQmFja2VuZERldmljZSwgMSk7Cj4gPiArICAgIGRldi0+cmVm
X2NvdW50ID0gMTsKPiA+ICsgICAgZGV2LT5saWJ1c2JfZGV2aWNlID0gbGliZGV2Owo+ID4gKyAg
ICBpZiAoIWZpbGxfdXNiX2luZm8oZGV2KSkgewo+ID4gKyAgICAgICAgZ19jbGVhcl9wb2ludGVy
KCZkZXYsIGdfZnJlZSk7Cj4gPiArICAgIH0KPiA+ICsgICAgcmV0dXJuIGRldjsKPiA+ICt9Cj4g
PiArCj4gPiArc3RhdGljIGludCBMSUJVU0JfQ0FMTCBob3RwbHVnX2NhbGxiYWNrKGxpYnVzYl9j
b250ZXh0ICpjdHgsCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGxpYnVzYl9kZXZpY2UgKmRldmljZSwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgbGlidXNiX2hvdHBsdWdfZXZlbnQgZXZlbnQsCj4KPiBQZXJoYXBzIGFkZGlu
ZyBsaWIgcHJlZml4IHRvIGxpYnVzYiByZWxhdGVkIHZhcmlhYmxlcywgYXMgeW91IGRpZAo+IGlu
IHRoZSBvdGhlciBmdW5jdGlvbnMgYWJvdmUsIHdvdWxkIGJlIGVub3VnaC4KPgo+ID4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2b2lkICp1c2VyX2RhdGEpCj4gPiAr
ewo+ID4gKyAgICBTcGljZVVzYkJhY2tlbmQgKmJlID0gKFNwaWNlVXNiQmFja2VuZCAqKXVzZXJf
ZGF0YTsKPgo+IE5vIG5lZWQgdG8gY2FzdCB2b2lkKgo+Cj4gPiArICAgIGlmIChiZS0+aG90cGx1
Z19jYWxsYmFjaykgewo+Cj4gU2hvdWxkIHdhcm4gaWYgZmFpbCwgbm8/IFRoaXMgY2FsbGJhY2sg
c2hvdWxkIG9ubHkgYmUgY2FsbGVkCj4gYWZ0ZXIgc3BpY2VfdXNiX2JhY2tlbmRfcmVnaXN0ZXJf
aG90cGx1ZygpIC0gSWYgeW91IGFncmVlLAo+IGdfcmV0dXJuX3ZhbF9pZl9mYWlsKCkgbWlnaHQg
Zml0Cj4KPiA+ICsgICAgICAgIFNwaWNlVXNiQmFja2VuZERldmljZSAqZGV2Owo+ID4gKyAgICAg
ICAgZ2Jvb2xlYW4gdmFsID0gZXZlbnQgPT0gTElCVVNCX0hPVFBMVUdfRVZFTlRfREVWSUNFX0FS
UklWRUQ7Cj4KPiB2YWwgLT4gaGFzX2Fycml2ZWQKPgo+ID4gKyAgICAgICAgZGV2ID0gYWxsb2Nh
dGVfYmFja2VuZF9kZXZpY2UoZGV2aWNlKTsKPiA+ICsgICAgICAgIGlmIChkZXYpIHsKPiA+ICsg
ICAgICAgICAgICBTUElDRV9ERUJVRygiY3JlYXRlZCBkZXYgJXAsIHVzYmxpYiBkZXYgJXAiLCBk
ZXYsIGRldmljZSk7Cj4gPiArICAgICAgICAgICAgbGlidXNiX3JlZl9kZXZpY2UoZGV2aWNlKTsK
PiA+ICsgICAgICAgICAgICBiZS0+aG90cGx1Z19jYWxsYmFjayhiZS0+aG90cGx1Z191c2VyX2Rh
dGEsIGRldiwgdmFsKTsKPiA+ICsgICAgICAgICAgICBzcGljZV91c2JfYmFja2VuZF9kZXZpY2Vf
dW5yZWYoZGV2KTsKPiA+ICsgICAgICAgIH0KPiA+ICsgICAgfQo+ID4gKyAgICByZXR1cm4gMDsK
PiA+ICt9Cj4gPiArCj4gPiArI2lmZGVmIEdfT1NfV0lOMzIKPiA+ICsvKiBXaW5kb3dzLXNwZWNp
ZmljOiBnZXQgbm90aWZpY2F0aW9uIG9uIGRldmljZSBjaGFuZ2UgKi8KPiA+ICsKPiA+ICtzdGF0
aWMgZ2Jvb2xlYW4gaXNfc2FtZV9saWJ1c2JfZGV2KGxpYnVzYl9kZXZpY2UgKmRldjEsCj4gPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBVc2JEZXZpY2VJbmZvcm1hdGlvbiAq
aW5mbzEsCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWJ1c2JfZGV2
aWNlICpkZXYyKQo+Cj4gVGhpcyBmdW5jdGlvbiBzaG91bGQganVzdCBiZSBjb21wYXJpbmcgYm90
aCBsaWJ1c2JfZGV2aWNlcywgaW5mbzEKPiBhcmd1bWVudCBpcyBmb3IgZGVidWcgb24gdGhlIGNh
bGxlciBzbyBjYW4gYmUgcmVtb3ZlZC4uLgo+Cj4gPiArewo+ID4gKyAgICBzdHJ1Y3QgbGlidXNi
X2RldmljZV9kZXNjcmlwdG9yIGRlc2M7Cj4gPiArICAgIGluZm8xLT5idXMgPSBsaWJ1c2JfZ2V0
X2J1c19udW1iZXIoZGV2MSk7Cj4gPiArICAgIGluZm8xLT5hZGRyZXNzID0gbGlidXNiX2dldF9k
ZXZpY2VfYWRkcmVzcyhkZXYxKTsKPiA+ICsgICAgbGlidXNiX2dldF9kZXZpY2VfZGVzY3JpcHRv
cihkZXYxLCAmZGVzYyk7Cj4gPiArICAgIGluZm8xLT52aWQgPSBkZXNjLmlkVmVuZG9yOwo+ID4g
KyAgICBpbmZvMS0+cGlkID0gZGVzYy5pZFByb2R1Y3Q7Cj4gPiArICAgIGlmIChkZXYyID09IE5V
TEwpIHsKPiA+ICsgICAgICAgIHJldHVybiBGQUxTRTsKPiA+ICsgICAgfQo+Cj4gLi4uIEkgdGhp
bmsgdGhlIGZpcnN0IGNoZWNrIGlzIGlmIGVpdGhlciBsaWJkZXYxIG9yIGxpYmRldjIgYXJlIE5V
TEwKPiBhbmQgcmV0dXJuIEZBTFNFLCBvdGhlcndpc2UgeW91IGNhbiB0aGVuIGNvbXBhcmUgYWZ0
ZXIKPgo+ICAgICBpbmZvMSA9IGdldF9kZXZpY2VfaW5mb19mcm9tX2xpYnVzYl9kZXZpY2UoZGV2
MSk7Cj4gICAgIGluZm8yID0gZ2V0X2RldmljZV9pbmZvX2Zyb21fbGlidXNiX2RldmljZShkZXYy
KTsKPgo+ID4gKyAgICBsaWJ1c2JfZ2V0X2RldmljZV9kZXNjcmlwdG9yKGRldjIsICZkZXNjKTsK
PiA+ICsgICAgcmV0dXJuIGluZm8xLT5idXMgPT0gbGlidXNiX2dldF9idXNfbnVtYmVyKGRldjIp
ICYmCj4gPiArICAgICAgICAgICBpbmZvMS0+YWRkcmVzcyA9PSBsaWJ1c2JfZ2V0X2RldmljZV9h
ZGRyZXNzKGRldjIpICYmCj4gPiArICAgICAgICAgICBpbmZvMS0+dmlkID09IGRlc2MuaWRWZW5k
b3IgJiYKPiA+ICsgICAgICAgICAgIGluZm8xLT5waWQgPT0gZGVzYy5pZFByb2R1Y3Q7Cj4gPiAr
fQo+ID4gKwo+ID4gK3N0YXRpYyBpbnQgY29tcGFyZV9kZXZfbGlzdChTcGljZVVzYkJhY2tlbmQg
KmJlLAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWJ1c2JfZGV2aWNlICoqbDEs
Cj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpYnVzYl9kZXZpY2UgKipsMiwKPgo+
IEhtbSBjb25zdCB0aGVtPyBPci4uCj4KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
Z2Jvb2xlYW4gdmFsdWUpCj4KPiB2YWx1ZSAtPiBoYXNfYXJyaXZlZAo+Cj4gLi4gVGhpcyBmdW5j
dGlvbiB0cmllcyB0byBmaW5kIGVsZW1lbnRzIG9mIGxpc3QxIGluIGxpc3QyIGFuZCBjYWxscwo+
IGhvdHBsdWdfY2FsbGJhY2soKSBmb3IgZXZlcnkgZWxlbWVudCBub3QgZm91bmQuIFRoaXMgaXMg
YSBiaXQKPiBtb3JlIHRoYW4gdGhlIG5hbWUgb2YgdGhlIGZ1bmN0aW9uIHN1Z2dlc3RzLgo+Cj4K
PiBJIHdvdWxkIHJhdGhlciBoYXZlIGl0IGFzCj4gICAgIEdMaXN0KiBkZXZfbGlzdF9kaWZmZXJl
bmNlKGxpYnVzYl9kZXZpY2UgKipsaWJkZXZwMSwKPiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgbGlidXNiX2RldmljZSAqKmxpYmRldnAyKTsKPgo+ICAgICBhbmQgdGhlIGNhbGxlciB3
b3VsZCBjYWxsIGhvdHBsdWdfY2FsbGJhY2soKSBhbmQKPiAgICAgZ19saXN0X2ZyZWUoKSBpdC4K
PgoKSSBuZXZlciBhbGxvY2F0ZSBtZW1vcnkgd2hlbiB0aGVyZSBpcyBlYXN5IHdheSB0byBkZWFs
IHdpdGhvdXQgaXQKCj4gPiArewo+ID4gKyAgICBpbnQgcmVzID0gMDsKPiA+ICsgICAgd2hpbGUg
KCpsMSkgewo+ID4gKyAgICAgICAgZ2Jvb2xlYW4gZm91bmQgPSAwOwo+ID4gKyAgICAgICAgdWlu
dDMyX3QgbiA9IDA7Cj4gPiArICAgICAgICBVc2JEZXZpY2VJbmZvcm1hdGlvbiBpbmZvMTsKPiA+
ICsgICAgICAgIHdoaWxlICghZm91bmQpIHsKPiA+ICsgICAgICAgICAgICBmb3VuZCA9IGlzX3Nh
bWVfbGlidXNiX2RldigqbDEsICZpbmZvMSwgbDJbbl0pOwo+ID4gKyAgICAgICAgICAgIGlmIChs
MltuXSA9PSBOVUxMKSB7Cj4gPiArICAgICAgICAgICAgICAgIGJyZWFrOwo+ID4gKyAgICAgICAg
ICAgIH0KPiA+ICsgICAgICAgICAgICBuKys7Cj4gPiArICAgICAgICB9Cj4gPiArICAgICAgICBp
ZiAoIWZvdW5kKSB7Cj4gPiArICAgICAgICAgICAgU1BJQ0VfREVCVUcoIiVzICUwNFg6JTA0WCBh
dCAlZDolZCIsIHZhbHVlID8gImFkZGluZyIgOiAicmVtb3ZpbmciLAo+ID4gKyAgICAgICAgICAg
ICAgICBpbmZvMS52aWQsIGluZm8xLnBpZCwgaW5mbzEuYnVzLCBpbmZvMS5hZGRyZXNzKTsKPiA+
ICsgICAgICAgICAgICBob3RwbHVnX2NhbGxiYWNrKE5VTEwsICpsMSwKPiA+ICsgICAgICAgICAg
ICAgICAgdmFsdWUgPyBMSUJVU0JfSE9UUExVR19FVkVOVF9ERVZJQ0VfQVJSSVZFRCA6IExJQlVT
Ql9IT1RQTFVHX0VWRU5UX0RFVklDRV9MRUZULAo+ID4gKyAgICAgICAgICAgICAgICBiZSk7Cj4g
PiArICAgICAgICAgICAgcmVzKys7Cj4gPiArICAgICAgICB9Cj4gPiArICAgICAgICBsMSsrOwo+
ID4gKyAgICB9Cj4gPiArICAgIHJldHVybiByZXM7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyBM
UkVTVUxUIHN1YmNsYXNzX3Byb2MoSFdORCBoV25kLCBVSU5UIHVNc2csIFdQQVJBTSB3UGFyYW0s
IExQQVJBTSBsUGFyYW0sCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgIFVJTlRfUFRS
IHVJZFN1YmNsYXNzLCBEV09SRF9QVFIgZHdSZWZEYXRhKQo+ID4gK3sKPiA+ICsgICAgU3BpY2VV
c2JCYWNrZW5kICpiZSA9IChTcGljZVVzYkJhY2tlbmQgKilkd1JlZkRhdGE7Cj4gPiArICAgIGlm
ICh1TXNnID09IFdNX0RFVklDRUNIQU5HRSAmJiAhYmUtPnJlZGlyZWN0aW5nKSB7Cj4gPiArICAg
ICAgICBsaWJ1c2JfZGV2aWNlICoqbmV3X2xpc3QgPSBOVUxMOwo+ID4gKyAgICAgICAgbGlidXNi
X2dldF9kZXZpY2VfbGlzdChiZS0+bGlidXNiX2NvbnRleHQsICZuZXdfbGlzdCk7Cj4gPiArICAg
ICAgICBpZiAobmV3X2xpc3QpIHsKPiA+ICsgICAgICAgICAgICBpbnQgcmVzID0gY29tcGFyZV9k
ZXZfbGlzdChiZSwgYmUtPmxpYnVzYl9kZXZpY2VfbGlzdCwgbmV3X2xpc3QsIEZBTFNFKTsKPiA+
ICsgICAgICAgICAgICByZXMgKz0gY29tcGFyZV9kZXZfbGlzdChiZSwgbmV3X2xpc3QsIGJlLT5s
aWJ1c2JfZGV2aWNlX2xpc3QsIFRSVUUpOwo+ID4gKyAgICAgICAgICAgIGlmIChyZXMpIHsKPiA+
ICsgICAgICAgICAgICAgICAgLyogdGhlcmUgd2VyZSBjaGFuZ2VzIGluIGRldmljZSB0cmVlICov
Cj4gPiArICAgICAgICAgICAgICAgIGxpYnVzYl9mcmVlX2RldmljZV9saXN0KGJlLT5saWJ1c2Jf
ZGV2aWNlX2xpc3QsIFRSVUUpOwo+ID4gKyAgICAgICAgICAgICAgICBiZS0+bGlidXNiX2Rldmlj
ZV9saXN0ID0gbmV3X2xpc3Q7Cj4gPiArICAgICAgICAgICAgfSBlbHNlIHsKPiA+ICsgICAgICAg
ICAgICAgICAgbGlidXNiX2ZyZWVfZGV2aWNlX2xpc3QobmV3X2xpc3QsIFRSVUUpOwo+ID4gKyAg
ICAgICAgICAgIH0KPiA+ICsgICAgICAgIH0gZWxzZSB7Cj4gPiArICAgICAgICAgICAgZ193YXJu
X2lmX3JlYWNoZWQoKTsKPiA+ICsgICAgICAgIH0KPiA+ICsgICAgfQo+ID4gKyAgICByZXR1cm4g
RGVmU3ViY2xhc3NQcm9jKGhXbmQsIHVNc2csIHdQYXJhbSwgbFBhcmFtKTsKPiA+ICt9Cj4gPiAr
Cj4gPiArc3RhdGljIHZvaWQgZGlzYWJsZV9ob3RwbHVnX3N1cHBvcnQoU3BpY2VVc2JCYWNrZW5k
ICpiZSkKPiA+ICt7Cj4gPiArICAgIGlmIChiZS0+aFduZCkgewo+ID4gKyAgICAgICAgRGVzdHJv
eVdpbmRvdyhiZS0+aFduZCk7Cj4gPiArICAgICAgICBiZS0+aFduZCA9IE5VTEw7Cj4gPiArICAg
IH0KPiA+ICsgICAgaWYgKGJlLT5saWJ1c2JfZGV2aWNlX2xpc3QpIHsKPiA+ICsgICAgICAgIGxp
YnVzYl9mcmVlX2RldmljZV9saXN0KGJlLT5saWJ1c2JfZGV2aWNlX2xpc3QsIFRSVUUpOwo+ID4g
KyAgICAgICAgYmUtPmxpYnVzYl9kZXZpY2VfbGlzdCA9IE5VTEw7Cj4gPiArICAgIH0KPiA+ICt9
Cj4gPiArCj4gPiArc3RhdGljIGludCBlbmFibGVfaG90cGx1Z19zdXBwb3J0KFNwaWNlVXNiQmFj
a2VuZCAqYmUsIGNvbnN0IGNoYXIgKiplcnJvcl9vbl9lbmFibGUpCj4gPiArewo+ID4gKyAgICBs
b25nIHdpbl9lcnI7Cj4gPiArICAgIGxpYnVzYl9kZXZpY2UgKipkZXZfbGlzdCA9IE5VTEw7Cj4g
PiArICAgIGxpYnVzYl9kZXZpY2UgKmR1bW15ID0gTlVMTDsKPiA+ICsKPiA+ICsgICAgbGlidXNi
X2dldF9kZXZpY2VfbGlzdChiZS0+bGlidXNiX2NvbnRleHQsICZkZXZfbGlzdCk7Cj4gPiArICAg
IGlmICghZGV2X2xpc3QpIHsKPiA+ICsgICAgICAgICplcnJvcl9vbl9lbmFibGUgPSAiR2V0dGlu
ZyBkZXZpY2UgbGlzdCI7Cj4gPiArICAgICAgICBnb3RvIGVycm9yOwo+ID4gKyAgICB9Cj4gPiAr
ICAgIGJlLT5oV25kID0gQ3JlYXRlV2luZG93KCJTdGF0aWMiLCBOVUxMLCAwLCAwLCAwLCAwLCAw
LCBOVUxMLCBOVUxMLCBOVUxMLCBOVUxMKTsKPgo+IE5vdCBzdXJlIGlmIGNhbiBiZSBpbXBvcnRh
bnQgYnV0IGl0IHdhcyBHX1VERVZfQ0xJRU5UX1dJTkNMQVNTX05BTUUgYmVmb3JlLAo+Cj4gICAg
ICNkZWZpbmUgR19VREVWX0NMSUVOVF9XSU5DTEFTU19OQU1FICBURVhUKCJHX1VERVZfQ0xJRU5U
IikKPgo+IGFuZCBJIG5vdGljZSB0aGF0IHlvdSBkcm9wcGVkIFJlZ2lzdGVyQ2xhc3MgY2FsbCwg
bm90IG5lZWRlZAo+IGFueW1vcmU/Cj4KPgoKJ1N0YXRpYycgaXMgc3RhbmRhcmQgY2xhc3MsIHN0
YXJ0aW5nIGZyb20gWFAgdGhlcmUgaXMgZWFzeSB3YXkgdG8gd29yawp3aXRob3V0IHJlZ2lzdGVy
aW5nIG93biBjbGFzcy4KCj4gPiArICAgIGlmICghYmUtPmhXbmQpIHsKPiA+ICsgICAgICAgICpl
cnJvcl9vbl9lbmFibGUgPSAiQ3JlYXRlV2luZG93IjsKPiA+ICsgICAgICAgIGdvdG8gZXJyb3I7
Cj4gPiArICAgIH0KPiA+ICsgICAgaWYgKCFTZXRXaW5kb3dTdWJjbGFzcyhiZS0+aFduZCwgc3Vi
Y2xhc3NfcHJvYywgMCwgKERXT1JEX1BUUiliZSkpIHsKPiA+ICsgICAgICAgICplcnJvcl9vbl9l
bmFibGUgPSAiU2V0V2luZG93U3ViY2xhc3MiOwo+ID4gKyAgICAgICAgZ290byBlcnJvcjsKPiA+
ICsgICAgfQo+ID4gKyAgICBiZS0+aG90cGx1Z19oYW5kbGUgPSAxOwo+ID4gKyAgICBiZS0+bGli
dXNiX2RldmljZV9saXN0ID0gZGV2X2xpc3Q7Cj4gPiArCj4gPiArICAgIGNvbXBhcmVfZGV2X2xp
c3QoYmUsIGJlLT5saWJ1c2JfZGV2aWNlX2xpc3QsICZkdW1teSwgVFJVRSk7Cj4KPiBXaGF0J3Mg
dGhlIHBvaW50IG9mIHRoaXMgZnVuY3Rpb24gY2FsbD8gdG8gY2FsbAo+IGhvdHBsdWdfY2FsbGJh
Y2soKSBvbiBkZXZfbGlzdD8gWW91IG1pZ2h0IGFzIHdlbGwganVzdCBkbyBpdCBoZXJlCj4gd2l0
aCBhIGNvbW1lbnQKPgpUaGUgcG9pbnQgaXMgdGhhdCB0aGlzIHRha2VzIG9uZSBsaW5lIG9mIGNv
ZGUsIGp1c3QgY2FsbApob3RwbHVnX2NhbGxiYWNrIHRha2VzIG1vcmUuClByb2NlZHVyZXMgZXhp
c3QgZm9yIHJldXNlLCBJIHRoaW5rCgo+ID4gKwo+ID4gKyAgICByZXR1cm4gTElCVVNCX1NVQ0NF
U1M7Cj4gPiArZXJyb3I6Cj4gPiArICAgIHdpbl9lcnIgPSBHZXRMYXN0RXJyb3IoKTsKPiA+ICsg
ICAgaWYgKCF3aW5fZXJyKSB7Cj4gPiArICAgICAgICB3aW5fZXJyID0gLTE7Cj4gPiArICAgIH0K
PiA+ICsgICAgZ193YXJuaW5nKCIlcyBmYWlsZWQ6ICVsZCIsICplcnJvcl9vbl9lbmFibGUsIHdp
bl9lcnIpOwo+ID4gKyAgICBpZiAoZGV2X2xpc3QpIHsKPiA+ICsgICAgICAgIGxpYnVzYl9mcmVl
X2RldmljZV9saXN0KGRldl9saXN0LCBUUlVFKTsKPiA+ICsgICAgfQo+ID4gKyAgICByZXR1cm4g
d2luX2VycjsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIHZvaWQgc2V0X3JlZGlyZWN0aW5nKFNw
aWNlVXNiQmFja2VuZCAqYmUsIGdib29sZWFuIG9uKQo+ID4gK3sKPiA+ICsgICAgZ2Jvb2xlYW4g
bm9fcmVkaXI7Cj4gPiArICAgIGlmIChvbikgewo+ID4gKyAgICAgICAgZ19hdG9taWNfaW50X2lu
YygmYmUtPnJlZGlyZWN0aW5nKTsKPiA+ICsgICAgfSBlbHNlIHsKPiA+ICsgICAgICAgIG5vX3Jl
ZGlyID0gZ19hdG9taWNfaW50X2RlY19hbmRfdGVzdCgmYmUtPnJlZGlyZWN0aW5nKTsKPgo+IFlv
dSBjYW4gbW92ZSBkZWNsYXJhdGlvbiBvZiBub19yZWRpciBoZXJlCj4KPiA+ICsgICAgICAgIGlm
IChub19yZWRpciAmJiBiZS0+aFduZCkgewo+ID4gKyAgICAgICAgICAgIFBvc3RNZXNzYWdlKGJl
LT5oV25kLCBXTV9ERVZJQ0VDSEFOR0UsIDAsIDApOwo+ID4gKyAgICAgICAgfQo+ID4gKyAgICB9
Cj4gPiArfQo+ID4gKwo+ID4gKyNlbHNlCj4gPiArLyogTGludXgtc3BlY2lmaWM6IHVzZSBob3Qg
Y2FsbGJhY2sgZnJvbSBsaWJ1c2IgKi8KPiA+ICsKPiA+ICtzdGF0aWMgdm9pZCBkaXNhYmxlX2hv
dHBsdWdfc3VwcG9ydChTcGljZVVzYkJhY2tlbmQgKmJlKQo+ID4gK3sKPiA+ICsgICAgbGlidXNi
X2hvdHBsdWdfZGVyZWdpc3Rlcl9jYWxsYmFjayhiZS0+bGlidXNiX2NvbnRleHQsIGJlLT5ob3Rw
bHVnX2hhbmRsZSk7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyBpbnQgZW5hYmxlX2hvdHBsdWdf
c3VwcG9ydChTcGljZVVzYkJhY2tlbmQgKmJlLCBjb25zdCBjaGFyICoqZXJyb3Jfb25fZW5hYmxl
KQo+ID4gK3sKPiA+ICsgICAgaW50IHJjID0gMDsKPiA+ICsgICAgcmMgPSBsaWJ1c2JfaG90cGx1
Z19yZWdpc3Rlcl9jYWxsYmFjayhiZS0+bGlidXNiX2NvbnRleHQsCj4gPiArICAgICAgICBMSUJV
U0JfSE9UUExVR19FVkVOVF9ERVZJQ0VfQVJSSVZFRCB8IExJQlVTQl9IT1RQTFVHX0VWRU5UX0RF
VklDRV9MRUZULAo+ID4gKyAgICAgICAgTElCVVNCX0hPVFBMVUdfRU5VTUVSQVRFLCBMSUJVU0Jf
SE9UUExVR19NQVRDSF9BTlksCj4gPiArICAgICAgICBMSUJVU0JfSE9UUExVR19NQVRDSF9BTlks
IExJQlVTQl9IT1RQTFVHX01BVENIX0FOWSwKPiA+ICsgICAgICAgIGhvdHBsdWdfY2FsbGJhY2ss
IGJlLCAmYmUtPmhvdHBsdWdfaGFuZGxlKTsKPiA+ICsgICAgKmVycm9yX29uX2VuYWJsZSA9IGxp
YnVzYl9zdHJlcnJvcihyYyk7Cj4gPiArICAgIHJldHVybiByYzsKPiA+ICt9Cj4gPiArCj4gPiAr
I2RlZmluZSBzZXRfcmVkaXJlY3RpbmcoLi4uKQo+Cj4gb2sKPgo+ID4gKwo+ID4gKyNlbmRpZgo+
ID4gKwo+ID4gIC8qIGxvY2sgZnVuY3Rpb25zIGZvciB1c2JyZWRpcmhvc3QgYW5kIHVzYnJlZGly
cGFyc2VyICovCj4gPiAgc3RhdGljIHZvaWQgKnVzYnJlZGlyX2FsbG9jX2xvY2sodm9pZCkgewo+
ID4gICAgICBHTXV0ZXggKm11dGV4Owo+ID4gQEAgLTEzMSw0MSArMzU5LDYgQEAgZ2Jvb2xlYW4g
c3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX2lzb2NoKFNwaWNlVXNiQmFja2VuZERldmljZSAqZGV2
KQo+ID4gICAgICByZXR1cm4gaXNvY19mb3VuZDsKPiA+ICB9Cj4gPgo+ID4gLXN0YXRpYyBnYm9v
bGVhbiBmaWxsX3VzYl9pbmZvKFNwaWNlVXNiQmFja2VuZERldmljZSAqYmRldikKPiA+IC17Cj4g
PiAtICAgIFVzYkRldmljZUluZm9ybWF0aW9uICppbmZvID0gJmJkZXYtPmRldmljZV9pbmZvOwo+
ID4gLQo+ID4gLSAgICBzdHJ1Y3QgbGlidXNiX2RldmljZV9kZXNjcmlwdG9yIGRlc2M7Cj4gPiAt
ICAgIGxpYnVzYl9kZXZpY2UgKmxpYmRldiA9IGJkZXYtPmxpYnVzYl9kZXZpY2U7Cj4gPiAtICAg
IGxpYnVzYl9nZXRfZGV2aWNlX2Rlc2NyaXB0b3IobGliZGV2LCAmZGVzYyk7Cj4gPiAtICAgIGlu
Zm8tPmJ1cyA9IGxpYnVzYl9nZXRfYnVzX251bWJlcihsaWJkZXYpOwo+ID4gLSAgICBpbmZvLT5h
ZGRyZXNzID0gbGlidXNiX2dldF9kZXZpY2VfYWRkcmVzcyhsaWJkZXYpOwo+ID4gLSAgICBpZiAo
aW5mby0+YWRkcmVzcyA9PSAweGZmIHx8IC8qIHJvb3QgaHViIChIQ0QpICovCj4gPiAtICAgICAg
ICBpbmZvLT5hZGRyZXNzIDw9IDEgfHwgLyogcm9vdCBodWIgb3IgYmFkIGFkZHJlc3MgKi8KPiA+
IC0gICAgICAgIChkZXNjLmJEZXZpY2VDbGFzcyA9PSBMSUJVU0JfQ0xBU1NfSFVCKSAvKmh1Yiov
KSB7Cj4gPiAtICAgICAgICByZXR1cm4gRkFMU0U7Cj4gPiAtICAgIH0KPiA+IC0KPiA+IC0gICAg
aW5mby0+dmlkID0gZGVzYy5pZFZlbmRvcjsKPiA+IC0gICAgaW5mby0+cGlkID0gZGVzYy5pZFBy
b2R1Y3Q7Cj4gPiAtICAgIGluZm8tPmNsYXNzID0gZGVzYy5iRGV2aWNlQ2xhc3M7Cj4gPiAtICAg
IGluZm8tPnN1YmNsYXNzID0gZGVzYy5iRGV2aWNlU3ViQ2xhc3M7Cj4gPiAtICAgIGluZm8tPnBy
b3RvY29sID0gZGVzYy5iRGV2aWNlUHJvdG9jb2w7Cj4gPiAtCj4gPiAtICAgIHJldHVybiBUUlVF
Owo+ID4gLX0KPiA+IC0KPiA+IC1zdGF0aWMgU3BpY2VVc2JCYWNrZW5kRGV2aWNlICphbGxvY2F0
ZV9iYWNrZW5kX2RldmljZShsaWJ1c2JfZGV2aWNlICpsaWJkZXYpCj4gPiAtewo+ID4gLSAgICBT
cGljZVVzYkJhY2tlbmREZXZpY2UgKmRldiA9IGdfbmV3MChTcGljZVVzYkJhY2tlbmREZXZpY2Us
IDEpOwo+ID4gLSAgICBkZXYtPnJlZl9jb3VudCA9IDE7Cj4gPiAtICAgIGRldi0+bGlidXNiX2Rl
dmljZSA9IGxpYmRldjsKPiA+IC0gICAgaWYgKCFmaWxsX3VzYl9pbmZvKGRldikpIHsKPiA+IC0g
ICAgICAgIGdfY2xlYXJfcG9pbnRlcigmZGV2LCBnX2ZyZWUpOwo+ID4gLSAgICB9Cj4gPiAtICAg
IHJldHVybiBkZXY7Cj4gPiAtfQo+ID4gLQo+ID4gIHN0YXRpYyBnYm9vbGVhbiBpc19jaGFubmVs
X3JlYWR5KFNwaWNlVXNicmVkaXJDaGFubmVsICpjaGFubmVsKQo+ID4gIHsKPiA+ICAgICAgcmV0
dXJuIHNwaWNlX2NoYW5uZWxfZ2V0X3N0YXRlKFNQSUNFX0NIQU5ORUwoY2hhbm5lbCkpID09IFNQ
SUNFX0NIQU5ORUxfU1RBVEVfUkVBRFk7Cj4gPiBAQCAtMjM3LDMxICs0MzAsMTEgQEAgdm9pZCBz
cGljZV91c2JfYmFja2VuZF9pbnRlcnJ1cHRfZXZlbnRfaGFuZGxlcihTcGljZVVzYkJhY2tlbmQg
KmJlKQo+ID4gICAgICB9Cj4gPiAgfQo+ID4KPiA+IC1zdGF0aWMgaW50IExJQlVTQl9DQUxMIGhv
dHBsdWdfY2FsbGJhY2sobGlidXNiX2NvbnRleHQgKmN0eCwKPiA+IC0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgbGlidXNiX2RldmljZSAqZGV2aWNlLAo+ID4gLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWJ1c2JfaG90cGx1Z19ldmVudCBl
dmVudCwKPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdm9pZCAq
dXNlcl9kYXRhKQo+ID4gLXsKPiA+IC0gICAgU3BpY2VVc2JCYWNrZW5kICpiZSA9IChTcGljZVVz
YkJhY2tlbmQgKil1c2VyX2RhdGE7Cj4gPiAtICAgIGlmIChiZS0+aG90cGx1Z19jYWxsYmFjaykg
ewo+ID4gLSAgICAgICAgU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpkZXY7Cj4gPiAtICAgICAgICBn
Ym9vbGVhbiB2YWwgPSBldmVudCA9PSBMSUJVU0JfSE9UUExVR19FVkVOVF9ERVZJQ0VfQVJSSVZF
RDsKPiA+IC0gICAgICAgIGRldiA9IGFsbG9jYXRlX2JhY2tlbmRfZGV2aWNlKGRldmljZSk7Cj4g
PiAtICAgICAgICBpZiAoZGV2KSB7Cj4gPiAtICAgICAgICAgICAgU1BJQ0VfREVCVUcoImNyZWF0
ZWQgZGV2ICVwLCB1c2JsaWIgZGV2ICVwIiwgZGV2LCBkZXZpY2UpOwo+ID4gLSAgICAgICAgICAg
IGxpYnVzYl9yZWZfZGV2aWNlKGRldmljZSk7Cj4gPiAtICAgICAgICAgICAgYmUtPmhvdHBsdWdf
Y2FsbGJhY2soYmUtPmhvdHBsdWdfdXNlcl9kYXRhLCBkZXYsIHZhbCk7Cj4gPiAtICAgICAgICAg
ICAgc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX3VucmVmKGRldik7Cj4gPiAtICAgICAgICB9Cj4g
PiAtICAgIH0KPiA+IC0gICAgcmV0dXJuIDA7Cj4gPiAtfQo+ID4gLQo+ID4gIHZvaWQgc3BpY2Vf
dXNiX2JhY2tlbmRfZGVyZWdpc3Rlcl9ob3RwbHVnKFNwaWNlVXNiQmFja2VuZCAqYmUpCj4gPiAg
ewo+ID4gICAgICBnX3JldHVybl9pZl9mYWlsKGJlICE9IE5VTEwpOwo+ID4gICAgICBpZiAoYmUt
PmhvdHBsdWdfaGFuZGxlKSB7Cj4gPiAtICAgICAgICBsaWJ1c2JfaG90cGx1Z19kZXJlZ2lzdGVy
X2NhbGxiYWNrKGJlLT5saWJ1c2JfY29udGV4dCwgYmUtPmhvdHBsdWdfaGFuZGxlKTsKPiA+ICsg
ICAgICAgIGRpc2FibGVfaG90cGx1Z19zdXBwb3J0KGJlKTsKPiA+ICAgICAgICAgIGJlLT5ob3Rw
bHVnX2hhbmRsZSA9IDA7Cj4gPiAgICAgIH0KPiA+ICAgICAgYmUtPmhvdHBsdWdfY2FsbGJhY2sg
PSBOVUxMOwo+ID4gQEAgLTI3MiwxNyArNDQ1LDE1IEBAIGdib29sZWFuIHNwaWNlX3VzYl9iYWNr
ZW5kX3JlZ2lzdGVyX2hvdHBsdWcoU3BpY2VVc2JCYWNrZW5kICpiZSwKPiA+ICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzYl9ob3RfcGx1Z19jYWxsYmFjayBw
cm9jKQo+ID4gIHsKPiA+ICAgICAgaW50IHJjOwo+ID4gKyAgICBjb25zdCBjaGFyICpkZXNjOwo+
ID4gICAgICBnX3JldHVybl92YWxfaWZfZmFpbChiZSAhPSBOVUxMLCBGQUxTRSk7Cj4gPgo+ID4g
ICAgICBiZS0+aG90cGx1Z19jYWxsYmFjayA9IHByb2M7Cj4gPiAgICAgIGJlLT5ob3RwbHVnX3Vz
ZXJfZGF0YSA9IHVzZXJfZGF0YTsKPiA+IC0gICAgcmMgPSBsaWJ1c2JfaG90cGx1Z19yZWdpc3Rl
cl9jYWxsYmFjayhiZS0+bGlidXNiX2NvbnRleHQsCj4gPiAtICAgICAgICBMSUJVU0JfSE9UUExV
R19FVkVOVF9ERVZJQ0VfQVJSSVZFRCB8IExJQlVTQl9IT1RQTFVHX0VWRU5UX0RFVklDRV9MRUZU
LAo+ID4gLSAgICAgICAgTElCVVNCX0hPVFBMVUdfRU5VTUVSQVRFLCBMSUJVU0JfSE9UUExVR19N
QVRDSF9BTlksCj4gPiAtICAgICAgICBMSUJVU0JfSE9UUExVR19NQVRDSF9BTlksIExJQlVTQl9I
T1RQTFVHX01BVENIX0FOWSwKPiA+IC0gICAgICAgIGhvdHBsdWdfY2FsbGJhY2ssIGJlLCAmYmUt
PmhvdHBsdWdfaGFuZGxlKTsKPiA+ICsKPiA+ICsgICAgcmMgPSBlbmFibGVfaG90cGx1Z19zdXBw
b3J0KGJlLCAmZGVzYyk7Cj4gPiArCj4gPiAgICAgIGlmIChyYyAhPSBMSUJVU0JfU1VDQ0VTUykg
ewo+ID4gLSAgICAgICAgY29uc3QgY2hhciAqZGVzYyA9IGxpYnVzYl9zdHJlcnJvcihyYyk7Cj4g
PiAgICAgICAgICBnX3dhcm5pbmcoIkVycm9yIGluaXRpYWxpemluZyBVU0IgaG90cGx1ZyBzdXBw
b3J0OiAlcyBbJWldIiwgZGVzYywgcmMpOwo+ID4gICAgICAgICAgYmUtPmhvdHBsdWdfY2FsbGJh
Y2sgPSBOVUxMOwo+ID4gICAgICAgICAgcmV0dXJuIEZBTFNFOwo+ID4gQEAgLTMwMSw0NSArNDcy
LDYgQEAgdm9pZCBzcGljZV91c2JfYmFja2VuZF9kZWxldGUoU3BpY2VVc2JCYWNrZW5kICpiZSkK
PiA+ICAgICAgU1BJQ0VfREVCVUcoIiVzIDw8IiwgX19GVU5DVElPTl9fKTsKPiA+ICB9Cj4gPgo+
ID4gLVNwaWNlVXNiQmFja2VuZERldmljZSAqKnNwaWNlX3VzYl9iYWNrZW5kX2dldF9kZXZpY2Vf
bGlzdChTcGljZVVzYkJhY2tlbmQgKmJlKQo+ID4gLXsKPiA+IC0gICAgTE9VRF9ERUJVRygiJXMg
Pj4iLCBfX0ZVTkNUSU9OX18pOwo+ID4gLSAgICBsaWJ1c2JfZGV2aWNlICoqZGV2bGlzdCA9IE5V
TEwsICoqZGV2Owo+ID4gLSAgICBTcGljZVVzYkJhY2tlbmREZXZpY2UgKmQsICoqbGlzdDsKPiA+
IC0KPiA+IC0gICAgaW50IG4gPSAwLCBpbmRleDsKPiA+IC0KPiA+IC0gICAgaWYgKGJlICYmIGJl
LT5saWJ1c2JfY29udGV4dCkgewo+ID4gLSAgICAgICAgbGlidXNiX2dldF9kZXZpY2VfbGlzdChi
ZS0+bGlidXNiX2NvbnRleHQsICZkZXZsaXN0KTsKPiA+IC0gICAgfQo+ID4gLQo+ID4gLSAgICAv
KiBhZGQgYWxsIHRoZSBsaWJ1c2IgZGV2aWNlIHRoYXQgbm90IHByZXNlbnQgaW4gb3VyIGxpc3Qg
Ki8KPiA+IC0gICAgZm9yIChkZXYgPSBkZXZsaXN0OyBkZXYgJiYgKmRldjsgZGV2KyspIHsKPiA+
IC0gICAgICAgIG4rKzsKPiA+IC0gICAgfQo+ID4gLQo+ID4gLSAgICBsaXN0ID0gZ19uZXcwKFNw
aWNlVXNiQmFja2VuZERldmljZSosIG4gKyAxKTsKPiA+IC0KPiA+IC0gICAgaW5kZXggPSAwOwo+
ID4gLQo+ID4gLSAgICBmb3IgKGRldiA9IGRldmxpc3Q7IGRldiAmJiAqZGV2OyBkZXYrKykgewo+
ID4gLSAgICAgICAgZCA9IGFsbG9jYXRlX2JhY2tlbmRfZGV2aWNlKCpkZXYpOwo+ID4gLSAgICAg
ICAgaWYgKCFkKSB7Cj4gPiAtICAgICAgICAgICAgbGlidXNiX3VucmVmX2RldmljZSgqZGV2KTsK
PiA+IC0gICAgICAgIH0gZWxzZSB7Cj4gPiAtICAgICAgICAgICAgU1BJQ0VfREVCVUcoImNyZWF0
ZWQgZGV2ICVwLCB1c2JsaWIgZGV2ICVwIiwgZCwgKmRldik7Cj4gPiAtICAgICAgICAgICAgbGlz
dFtpbmRleCsrXSA9IGQ7Cj4gPiAtICAgICAgICB9Cj4gPiAtICAgIH0KPiA+IC0KPiA+IC0gICAg
aWYgKGRldmxpc3QpIHsKPiA+IC0gICAgICAgIGxpYnVzYl9mcmVlX2RldmljZV9saXN0KGRldmxp
c3QsIDApOwo+ID4gLSAgICB9Cj4gPiAtCj4gPiAtICAgIExPVURfREVCVUcoIiVzIDw8IiwgX19G
VU5DVElPTl9fKTsKPiA+IC0gICAgcmV0dXJuIGxpc3Q7Cj4gPiAtfQo+ID4gLQo+ID4gIGNvbnN0
IFVzYkRldmljZUluZm9ybWF0aW9uKiBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfZ2V0X2luZm8o
U3BpY2VVc2JCYWNrZW5kRGV2aWNlICpkZXYpCj4gPiAgewo+ID4gICAgICByZXR1cm4gJmRldi0+
ZGV2aWNlX2luZm87Cj4gPiBAQCAtMzUwLDE4ICs0ODIsNiBAQCBnY29uc3Rwb2ludGVyIHNwaWNl
X3VzYl9iYWNrZW5kX2RldmljZV9nZXRfbGliZGV2KFNwaWNlVXNiQmFja2VuZERldmljZSAqZGV2
KQo+ID4gICAgICByZXR1cm4gZGV2LT5saWJ1c2JfZGV2aWNlOwo+ID4gIH0KPiA+Cj4gPiAtdm9p
ZCBzcGljZV91c2JfYmFja2VuZF9mcmVlX2RldmljZV9saXN0KFNwaWNlVXNiQmFja2VuZERldmlj
ZSAqKmRldmxpc3QpCj4gPiAtewo+ID4gLSAgICBMT1VEX0RFQlVHKCIlcyA+PiIsIF9fRlVOQ1RJ
T05fXyk7Cj4gPiAtICAgIFNwaWNlVXNiQmFja2VuZERldmljZSAqKmRldjsKPiA+IC0gICAgZm9y
IChkZXYgPSBkZXZsaXN0OyAqZGV2OyBkZXYrKykgewo+ID4gLSAgICAgICAgU3BpY2VVc2JCYWNr
ZW5kRGV2aWNlICpkID0gKmRldjsKPiA+IC0gICAgICAgIHNwaWNlX3VzYl9iYWNrZW5kX2Rldmlj
ZV91bnJlZihkKTsKPiA+IC0gICAgfQo+ID4gLSAgICBnX2ZyZWUoZGV2bGlzdCk7Cj4gPiAtICAg
IExPVURfREVCVUcoIiVzIDw8IiwgX19GVU5DVElPTl9fKTsKPiA+IC19Cj4gPiAtCj4gPiAgU3Bp
Y2VVc2JCYWNrZW5kRGV2aWNlICpzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfcmVmKFNwaWNlVXNi
QmFja2VuZERldmljZSAqZGV2KQo+ID4gIHsKPiA+ICAgICAgTE9VRF9ERUJVRygiJXMgPj4gJXAi
LCBfX0ZVTkNUSU9OX18sIGRldik7Cj4gPiBAQCAtNTI5LDEyICs2NDksMjMgQEAgZ2Jvb2xlYW4g
c3BpY2VfdXNiX2JhY2tlbmRfY2hhbm5lbF9hdHRhY2goU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCAq
Y2gsCj4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU3BpY2VV
c2JCYWNrZW5kRGV2aWNlICpkZXYsCj4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgR0Vycm9yICoqZXJyb3IpCj4gPiAgewo+ID4gKyAgICBpbnQgcmM7Cj4gPiAg
ICAgIFNQSUNFX0RFQlVHKCIlcyA+PiBjaCAlcCwgZGV2ICVwICh3YXMgYXR0YWNoZWQgJXApIiwg
X19GVU5DVElPTl9fLCBjaCwgZGV2LCBjaC0+YXR0YWNoZWQpOwo+ID4KPiA+ICAgICAgZ19yZXR1
cm5fdmFsX2lmX2ZhaWwoZGV2ICE9IE5VTEwsIEZBTFNFKTsKPiA+Cj4gPiAgICAgIGxpYnVzYl9k
ZXZpY2VfaGFuZGxlICpoYW5kbGUgPSBOVUxMOwo+ID4gLSAgICBpbnQgcmMgPSBsaWJ1c2Jfb3Bl
bihkZXYtPmxpYnVzYl9kZXZpY2UsICZoYW5kbGUpOwo+ID4gKwo+ID4gKyAgICAvKgo+ID4gKyAg
ICAgICBVbmRlciBXaW5kb3dzIHdlIG5lZWQgdG8gYXZvaWQgdXBkYXRpbmcKPiA+ICsgICAgICAg
bGlzdCBvZiBkZXZpY2VzIHdoZW4gd2UgYXJlIGFjcXVpcmluZyB0aGUgZGV2aWNlCj4gPiArICAg
ICovCj4KPiBJJ2QgcmF0aGVyIGhhdmUKPgo+ICAgICAvKiBzdGFydCBjb21tZW50Cj4gICAgICAq
IGVuZCBjb21tZW50ICovCj4KPiBidXQgSSBkb24ndCBtaW5kIG11Y2guCj4KPiBBcGFydCBmcm9t
IHRob3NlIGNvbW1lbnRzLCBub3QgbXVjaCB0byBhZGQuCj4KPiBWaWN0b3IKPgo+ID4gKyAgICBz
ZXRfcmVkaXJlY3RpbmcoY2gtPmJhY2tlbmQsIFRSVUUpOwo+ID4gKwo+ID4gKyAgICByYyA9IGxp
YnVzYl9vcGVuKGRldi0+bGlidXNiX2RldmljZSwgJmhhbmRsZSk7Cj4gPiArCj4gPiArICAgIHNl
dF9yZWRpcmVjdGluZyhjaC0+YmFja2VuZCwgRkFMU0UpOwo+ID4gKwo+ID4gICAgICBpZiAocmMp
IHsKPiA+ICAgICAgICAgIGNvbnN0IGNoYXIgKmRlc2MgPSBsaWJ1c2Jfc3RyZXJyb3IocmMpOwo+
ID4gICAgICAgICAgZ19zZXRfZXJyb3IoZXJyb3IsIFNQSUNFX0NMSUVOVF9FUlJPUiwgU1BJQ0Vf
Q0xJRU5UX0VSUk9SX0ZBSUxFRCwKPiA+IEBAIC01ODIsNiArNzEzLDcgQEAgU3BpY2VVc2JCYWNr
ZW5kQ2hhbm5lbCAqc3BpY2VfdXNiX2JhY2tlbmRfY2hhbm5lbF9uZXcoU3BpY2VVc2JCYWNrZW5k
ICpiZSwKPiA+ICAgICAgU1BJQ0VfREVCVUcoIiVzID4+IiwgX19GVU5DVElPTl9fKTsKPiA+ICAg
ICAgY2gtPnVzZXJfZGF0YSA9IFNQSUNFX1VTQlJFRElSX0NIQU5ORUwodXNlcl9kYXRhKTsKPiA+
ICAgICAgaWYgKGJlLT5saWJ1c2JfY29udGV4dCkgewo+ID4gKyAgICAgICAgY2gtPmJhY2tlbmQg
PSBiZTsKPiA+ICAgICAgICAgIGNoLT51c2JyZWRpcmhvc3QgPSB1c2JyZWRpcmhvc3Rfb3Blbl9m
dWxsKAo+ID4gICAgICAgICAgICAgIGJlLT5saWJ1c2JfY29udGV4dCwKPiA+ICAgICAgICAgICAg
ICBOVUxMLAo+ID4gZGlmZiAtLWdpdCBhL3NyYy91c2ItYmFja2VuZC5oIGIvc3JjL3VzYi1iYWNr
ZW5kLmgKPiA+IGluZGV4IGNiYjczYzIuLjZkYTM5ODEgMTAwNjQ0Cj4gPiAtLS0gYS9zcmMvdXNi
LWJhY2tlbmQuaAo+ID4gKysrIGIvc3JjL3VzYi1iYWNrZW5kLmgKPiA+IEBAIC01NiwxNCArNTYs
NiBAQCBlbnVtIHsKPiA+ICBTcGljZVVzYkJhY2tlbmQgKnNwaWNlX3VzYl9iYWNrZW5kX25ldyhH
RXJyb3IgKiplcnJvcik7Cj4gPiAgdm9pZCBzcGljZV91c2JfYmFja2VuZF9kZWxldGUoU3BpY2VV
c2JCYWNrZW5kICpjb250ZXh0KTsKPiA+Cj4gPiAtLyoKPiA+IC1yZXR1cm5zIG5ld2x5LWFsbG9j
YXRlZCBudWxsLXRlcm1pbmF0ZWQgbGlzdCBvZgo+ID4gLVNwaWNlVXNiQmFja2VuZERldmljZSBw
b2ludGVycy4KPiA+IC1UaGUgY2FsbGVyIG11c3QgY2FsbCBzcGljZV91c2JfYmFja2VuZF9mcmVl
X2RldmljZV9saXN0Cj4gPiAtYWZ0ZXIgaXQgZmluaXNoZXMgbGlzdCBwcm9jZXNzaW5nCj4gPiAt
Ki8KPiA+IC1TcGljZVVzYkJhY2tlbmREZXZpY2UgKipzcGljZV91c2JfYmFja2VuZF9nZXRfZGV2
aWNlX2xpc3QoU3BpY2VVc2JCYWNrZW5kICpiYWNrZW5kKTsKPiA+IC12b2lkIHNwaWNlX3VzYl9i
YWNrZW5kX2ZyZWVfZGV2aWNlX2xpc3QoU3BpY2VVc2JCYWNrZW5kRGV2aWNlICoqZGV2bGlzdCk7
Cj4gPiAgZ2Jvb2xlYW4gc3BpY2VfdXNiX2JhY2tlbmRfaGFuZGxlX2V2ZW50cyhTcGljZVVzYkJh
Y2tlbmQgKmJlKTsKPiA+ICB2b2lkIHNwaWNlX3VzYl9iYWNrZW5kX2ludGVycnVwdF9ldmVudF9o
YW5kbGVyKFNwaWNlVXNiQmFja2VuZCAqYmUpOwo+ID4gIGdib29sZWFuIHNwaWNlX3VzYl9iYWNr
ZW5kX3JlZ2lzdGVyX2hvdHBsdWcoU3BpY2VVc2JCYWNrZW5kICpiZSwKPiA+IGRpZmYgLS1naXQg
YS9zcmMvdXNiLWRldmljZS1tYW5hZ2VyLmMgYi9zcmMvdXNiLWRldmljZS1tYW5hZ2VyLmMKPiA+
IGluZGV4IDlhYmEyNzUuLjkzMDBhZDIgMTAwNjQ0Cj4gPiAtLS0gYS9zcmMvdXNiLWRldmljZS1t
YW5hZ2VyLmMKPiA+ICsrKyBiL3NyYy91c2ItZGV2aWNlLW1hbmFnZXIuYwo+ID4gQEAgLTI5LDcg
KzI5LDYgQEAKPiA+ICAjaWZkZWYgR19PU19XSU4zMgo+ID4gICNpbmNsdWRlIDx3aW5kb3dzLmg+
Cj4gPiAgI2luY2x1ZGUgInVzYmRrX2FwaS5oIgo+ID4gLSNpbmNsdWRlICJ3aW4tdXNiLWRldi5o
Igo+ID4gICNlbmRpZgo+ID4KPiA+ICAjaW5jbHVkZSAiY2hhbm5lbC11c2JyZWRpci1wcml2Lmgi
Cj4gPiBAQCAtMTAxLDEyICsxMDAsMTAgQEAgc3RydWN0IF9TcGljZVVzYkRldmljZU1hbmFnZXJQ
cml2YXRlIHsKPiA+ICAgICAgc3RydWN0IHVzYnJlZGlyZmlsdGVyX3J1bGUgKnJlZGlyZWN0X29u
X2Nvbm5lY3RfcnVsZXM7Cj4gPiAgICAgIGludCBhdXRvX2Nvbm5fZmlsdGVyX3J1bGVzX2NvdW50
Owo+ID4gICAgICBpbnQgcmVkaXJlY3Rfb25fY29ubmVjdF9ydWxlc19jb3VudDsKPiA+ICsgICAg
Z2Jvb2xlYW4gcmVkaXJlY3Rpbmc7Cj4gPiAgI2lmZGVmIEdfT1NfV0lOMzIKPiA+IC0gICAgR1Vk
ZXZDbGllbnQgKnVkZXY7Cj4gPiAgICAgIHVzYmRrX2FwaV93cmFwcGVyICp1c2Jka19hcGk7Cj4g
PiAgICAgIEhBTkRMRSB1c2Jka19oaWRlcl9oYW5kbGU7Cj4gPiAtI2Vsc2UKPiA+IC0gICAgZ2Jv
b2xlYW4gcmVkaXJlY3Rpbmc7IC8qIEhhbmRsZWQgYnkgR1VkZXZDbGllbnQgaW4gdGhlIGd1ZGV2
IGNhc2UgKi8KPiA+ICAjZW5kaWYKPiA+ICAgICAgR1B0ckFycmF5ICpkZXZpY2VzOwo+ID4gICAg
ICBHUHRyQXJyYXkgKmNoYW5uZWxzOwo+ID4gQEAgLTEzOSwxNiArMTM2LDkgQEAgc3RhdGljIHZv
aWQgY2hhbm5lbF9kZXN0cm95KFNwaWNlU2Vzc2lvbiAqc2Vzc2lvbiwgU3BpY2VDaGFubmVsICpj
aGFubmVsLAo+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBncG9pbnRlciB1c2VyX2Rh
dGEpOwo+ID4gIHN0YXRpYyB2b2lkIGNoYW5uZWxfZXZlbnQoU3BpY2VDaGFubmVsICpjaGFubmVs
LCBTcGljZUNoYW5uZWxFdmVudCBldmVudCwKPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGdwb2ludGVyIHVzZXJfZGF0YSk7Cj4gPiAtI2lmZGVmIEdfT1NfV0lOMzIKPiA+IC1zdGF0aWMg
dm9pZCBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfdWV2ZW50X2NiKEdVZGV2Q2xpZW50ICAgICAq
Y2xpZW50LAo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgU3BpY2VVc2JCYWNrZW5kRGV2aWNlICp1ZGV2aWNlLAo+ID4gLSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2Jvb2xlYW4gICAgICAgICBhZGQsCj4gPiAt
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBncG9pbnRlciAg
ICAgICAgIHVzZXJfZGF0YSk7Cj4gPiAtI2Vsc2UKPiA+ICBzdGF0aWMgdm9pZCBzcGljZV91c2Jf
ZGV2aWNlX21hbmFnZXJfaG90cGx1Z19jYih2b2lkICp1c2VyX2RhdGEsCj4gPiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU3BpY2VVc2JCYWNrZW5kRGV2
aWNlICpkZXYsCj4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgZ2Jvb2xlYW4gYWRkZWQpOwo+ID4gLSNlbmRpZgo+ID4gIHN0YXRpYyB2b2lkIHNwaWNl
X3VzYl9kZXZpY2VfbWFuYWdlcl9jaGVja19yZWRpcl9vbl9jb25uZWN0KAo+ID4gICAgICBTcGlj
ZVVzYkRldmljZU1hbmFnZXIgKnNlbGYsIFNwaWNlQ2hhbm5lbCAqY2hhbm5lbCk7Cj4gPgo+ID4g
QEAgLTE5MCwxMSArMTgwLDcgQEAgR19ERUZJTkVfQk9YRURfVFlQRShTcGljZVVzYkRldmljZSwg
c3BpY2VfdXNiX2RldmljZSwKPiA+ICBzdGF0aWMgdm9pZAo+ID4gIF9zZXRfcmVkaXJlY3Rpbmco
U3BpY2VVc2JEZXZpY2VNYW5hZ2VyICpzZWxmLCBnYm9vbGVhbiBpc19yZWRpcmVjdGluZykKPiA+
ICB7Cj4gPiAtI2lmZGVmIEdfT1NfV0lOMzIKPiA+IC0gICAgZ19vYmplY3Rfc2V0KHNlbGYtPnBy
aXYtPnVkZXYsICJyZWRpcmVjdGluZyIsIGlzX3JlZGlyZWN0aW5nLCBOVUxMKTsKPiA+IC0jZWxz
ZQo+ID4gICAgICBzZWxmLT5wcml2LT5yZWRpcmVjdGluZyA9IGlzX3JlZGlyZWN0aW5nOwo+ID4g
LSNlbmRpZgo+ID4gIH0KPiA+Cj4gPiAgI2Vsc2UKPiA+IEBAIC0yMTUsMTAgKzIwMSw2IEBAIGdi
b29sZWFuIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9pc19yZWRpcmVjdGluZyhTcGljZVVzYkRl
dmljZU1hbmFnZXIgKnNlbGYpCj4gPiAgewo+ID4gICNpZm5kZWYgVVNFX1VTQlJFRElSCj4gPiAg
ICAgIHJldHVybiBGQUxTRTsKPiA+IC0jZWxpZiBkZWZpbmVkKEdfT1NfV0lOMzIpCj4gPiAtICAg
IGdib29sZWFuIHJlZGlyZWN0aW5nOwo+ID4gLSAgICBnX29iamVjdF9nZXQoc2VsZi0+cHJpdi0+
dWRldiwgInJlZGlyZWN0aW5nIiwgJnJlZGlyZWN0aW5nLCBOVUxMKTsKPiA+IC0gICAgcmV0dXJu
IHJlZGlyZWN0aW5nOwo+ID4gICNlbHNlCj4gPiAgICAgIHJldHVybiBzZWxmLT5wcml2LT5yZWRp
cmVjdGluZzsKPiA+ICAjZW5kaWYKPiA+IEBAIC0yNjcsMjkgKzI0OSwxOCBAQCBzdGF0aWMgZ2Jv
b2xlYW4gc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2luaXRhYmxlX2luaXQoR0luaXRhYmxlICAq
aW5pdGFibGUsCj4gPiAgICAgIEdMaXN0ICpsaXN0Owo+ID4gICAgICBHTGlzdCAqaXQ7Cj4gPgo+
ID4gLSAgICAvKiBTdGFydCBsaXN0ZW5pbmcgZm9yIHVzYiBkZXZpY2VzIHBsdWcgLyB1bnBsdWcg
Ki8KPiA+IC0jaWZkZWYgR19PU19XSU4zMgo+ID4gLSAgICBwcml2LT51ZGV2ID0gZ191ZGV2X2Ns
aWVudF9uZXcoKTsKPiA+IC0gICAgaWYgKHByaXYtPnVkZXYgPT0gTlVMTCkgewo+ID4gLSAgICAg
ICAgZ193YXJuaW5nKCJFcnJvciBpbml0aWFsaXppbmcgR1VkZXZDbGllbnQiKTsKPiA+IC0gICAg
ICAgIHJldHVybiBGQUxTRTsKPiA+IC0gICAgfQo+ID4gLSAgICBwcml2LT5jb250ZXh0ID0gZ191
ZGV2X2NsaWVudF9nZXRfY29udGV4dChwcml2LT51ZGV2KTsKPiA+IC0gICAgZ19zaWduYWxfY29u
bmVjdChHX09CSkVDVChwcml2LT51ZGV2KSwgInVldmVudCIsCj4gPiAtICAgICAgICAgICAgICAg
ICAgICAgR19DQUxMQkFDSyhzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfdWV2ZW50X2NiKSwgc2Vs
Zik7Cj4gPiAtICAgIC8qIERvIGNvbGRwbHVnIChkZXRlY3Rpb24gb2YgYWxyZWFkeSBjb25uZWN0
ZWQgZGV2aWNlcykgKi8KPiA+IC0gICAgZ191ZGV2X2NsaWVudF9yZXBvcnRfZGV2aWNlcyhwcml2
LT51ZGV2KTsKPiA+IC0jZWxzZQo+ID4gICAgICAvKiBJbml0aWFsaXplIGxpYnVzYiAqLwo+ID4g
ICAgICBwcml2LT5jb250ZXh0ID0gc3BpY2VfdXNiX2JhY2tlbmRfbmV3KGVycik7Cj4gPiAgICAg
IGlmICghcHJpdi0+Y29udGV4dCkgewo+ID4gICAgICAgICAgcmV0dXJuIEZBTFNFOwo+ID4gICAg
ICB9Cj4gPgo+ID4gKyAgICAvKiBTdGFydCBsaXN0ZW5pbmcgZm9yIHVzYiBkZXZpY2VzIHBsdWcg
LyB1bnBsdWcgKi8KPiA+ICAgICAgaWYgKCFzcGljZV91c2JfYmFja2VuZF9yZWdpc3Rlcl9ob3Rw
bHVnKHByaXYtPmNvbnRleHQsIHNlbGYsCj4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfaG90cGx1Z19jYikpIHsK
PiA+ICAgICAgICAgIHJldHVybiBGQUxTRTsKPiA+ICAgICAgfQo+ID4gKyNpZm5kZWYgR19PU19X
SU4zMgo+ID4gICAgICBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfc3RhcnRfZXZlbnRfbGlzdGVu
aW5nKHNlbGYsIE5VTEwpOwo+ID4gICNlbmRpZgo+ID4KPiA+IEBAIC0zMjQsOCArMjk1LDkgQEAg
c3RhdGljIHZvaWQgc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2Rpc3Bvc2UoR09iamVjdCAqZ29i
amVjdCkKPiA+ICAgICAgICAgIGdfd2Fybl9pZl9yZWFjaGVkKCk7Cj4gPiAgICAgICAgICBnX2F0
b21pY19pbnRfc2V0KCZwcml2LT5ldmVudF90aHJlYWRfcnVuLCBGQUxTRSk7Cj4gPiAgICAgIH0K
PiA+IC0gICAgc3BpY2VfdXNiX2JhY2tlbmRfZGVyZWdpc3Rlcl9ob3RwbHVnKHByaXYtPmNvbnRl
eHQpOwo+ID4gICNlbmRpZgo+ID4gKyAgICBzcGljZV91c2JfYmFja2VuZF9kZXJlZ2lzdGVyX2hv
dHBsdWcocHJpdi0+Y29udGV4dCk7Cj4gPiArCj4gPiAgICAgIGlmIChwcml2LT5ldmVudF90aHJl
YWQpIHsKPiA+ICAgICAgICAgIGdfd2Fybl9pZl9mYWlsKGdfYXRvbWljX2ludF9nZXQoJnByaXYt
PmV2ZW50X3RocmVhZF9ydW4pID09IEZBTFNFKTsKPiA+ICAgICAgICAgIGdfYXRvbWljX2ludF9z
ZXQoJnByaXYtPmV2ZW50X3RocmVhZF9ydW4sIEZBTFNFKTsKPiA+IEBAIC0zNTAsMTQgKzMyMiwx
MCBAQCBzdGF0aWMgdm9pZCBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfZmluYWxpemUoR09iamVj
dCAqZ29iamVjdCkKPiA+ICAgICAgaWYgKHByaXYtPmRldmljZXMpIHsKPiA+ICAgICAgICAgIGdf
cHRyX2FycmF5X3VucmVmKHByaXYtPmRldmljZXMpOwo+ID4gICAgICB9Cj4gPiAtI2lmZGVmIEdf
T1NfV0lOMzIKPiA+IC0gICAgZ19jbGVhcl9vYmplY3QoJnByaXYtPnVkZXYpOwo+ID4gLSNlbmRp
Zgo+ID4gICAgICBnX3JldHVybl9pZl9mYWlsKHByaXYtPmV2ZW50X3RocmVhZCA9PSBOVUxMKTsK
PiA+IC0jaWZuZGVmIEdfT1NfV0lOMzIKPiA+IC0gICAgaWYgKHByaXYtPmNvbnRleHQpCj4gPiAr
ICAgIGlmIChwcml2LT5jb250ZXh0KSB7Cj4gPiAgICAgICAgICBzcGljZV91c2JfYmFja2VuZF9k
ZWxldGUocHJpdi0+Y29udGV4dCk7Cj4gPiAtI2VuZGlmCj4gPiArICAgIH0KPiA+ICAgICAgZnJl
ZShwcml2LT5hdXRvX2Nvbm5fZmlsdGVyX3J1bGVzKTsKPiA+ICAgICAgZnJlZShwcml2LT5yZWRp
cmVjdF9vbl9jb25uZWN0X3J1bGVzKTsKPiA+ICAjaWZkZWYgR19PU19XSU4zMgo+ID4gQEAgLTg5
MSwyMCArODU5LDYgQEAgc3RhdGljIHZvaWQgc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX3JlbW92
ZV9kZXYoU3BpY2VVc2JEZXZpY2VNYW5hZ2VyICpzZWxmLAo+ID4gICAgICBzcGljZV91c2JfZGV2
aWNlX3VucmVmKGRldmljZSk7Cj4gPiAgfQo+ID4KPiA+IC0jaWZkZWYgR19PU19XSU4zMgo+ID4g
LXN0YXRpYyB2b2lkIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl91ZXZlbnRfY2IoR1VkZXZDbGll
bnQgICAgICpjbGllbnQsCj4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBTcGljZVVzYkJhY2tlbmREZXZpY2UgKmJkZXYsCj4gPiAtICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYm9vbGVhbiAgICAgICAgIGFkZCwK
PiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdwb2lu
dGVyICAgICAgICAgdXNlcl9kYXRhKQo+ID4gLXsKPiA+IC0gICAgU3BpY2VVc2JEZXZpY2VNYW5h
Z2VyICpzZWxmID0gU1BJQ0VfVVNCX0RFVklDRV9NQU5BR0VSKHVzZXJfZGF0YSk7Cj4gPiAtCj4g
PiAtICAgIGlmIChhZGQpCj4gPiAtICAgICAgICBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfYWRk
X2RldihzZWxmLCBiZGV2KTsKPiA+IC0gICAgZWxzZQo+ID4gLSAgICAgICAgc3BpY2VfdXNiX2Rl
dmljZV9tYW5hZ2VyX3JlbW92ZV9kZXYoc2VsZiwgYmRldik7Cj4gPiAtfQo+ID4gLSNlbHNlCj4g
PiAgc3RydWN0IGhvdHBsdWdfaWRsZV9jYl9hcmdzIHsKPiA+ICAgICAgU3BpY2VVc2JEZXZpY2VN
YW5hZ2VyICpzZWxmOwo+ID4gICAgICBTcGljZVVzYkJhY2tlbmREZXZpY2UgKmRldmljZTsKPiA+
IEBAIC05NDAsNyArODk0LDYgQEAgc3RhdGljIHZvaWQgc3BpY2VfdXNiX2RldmljZV9tYW5hZ2Vy
X2hvdHBsdWdfY2Iodm9pZCAqdXNlcl9kYXRhLAo+ID4gICAgICBhcmdzLT5hZGRlZCA9IGFkZGVk
Owo+ID4gICAgICBnX2lkbGVfYWRkKHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9ob3RwbHVnX2lk
bGVfY2IsIGFyZ3MpOwo+ID4gIH0KPiA+IC0jZW5kaWYgLy8gVVNFX1VTQlJFRElSCj4gPgo+ID4g
IHN0YXRpYyB2b2lkIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9jaGFubmVsX2Nvbm5lY3RfY2Io
Cj4gPiAgICAgIEdPYmplY3QgKmdvYmplY3QsIEdBc3luY1Jlc3VsdCAqY2hhbm5lbF9yZXMsIGdw
b2ludGVyIHVzZXJfZGF0YSkKPiA+IGRpZmYgLS1naXQgYS9zcmMvd2luLXVzYi1kZXYuYyBiL3Ny
Yy93aW4tdXNiLWRldi5jCj4gPiBkZWxldGVkIGZpbGUgbW9kZSAxMDA2NDQKPiA+IGluZGV4IGMy
YTUxMTUuLjAwMDAwMDAKPiA+IC0tLSBhL3NyYy93aW4tdXNiLWRldi5jCj4gPiArKysgL2Rldi9u
dWxsCj4gPiBAQCAtMSw0MzYgKzAsMCBAQAo+ID4gLS8qIC0qLSBNb2RlOiBDOyBjLWJhc2ljLW9m
ZnNldDogNDsgaW5kZW50LXRhYnMtbW9kZTogbmlsIC0qLSAqLwo+ID4gLS8qCj4gPiAtICAgQ29w
eXJpZ2h0IChDKSAyMDEyIFJlZCBIYXQsIEluYy4KPiA+IC0KPiA+IC0gICBSZWQgSGF0IEF1dGhv
cnM6Cj4gPiAtICAgQXJub24gR2lsYm9hIDxhZ2lsYm9hQHJlZGhhdC5jb20+Cj4gPiAtICAgVXJp
IEx1YmxpbiAgIDx1cmlsQHJlZGhhdC5jb20+Cj4gPiAtCj4gPiAtICAgVGhpcyBsaWJyYXJ5IGlz
IGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vcgo+ID4gLSAgIG1v
ZGlmeSBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMK
PiA+IC0gICBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0
aW9uOyBlaXRoZXIKPiA+IC0gICB2ZXJzaW9uIDIuMSBvZiB0aGUgTGljZW5zZSwgb3IgKGF0IHlv
dXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4KPiA+IC0KPiA+IC0gICBUaGlzIGxpYnJhcnkg
aXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKPiA+IC0g
ICBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJy
YW50eSBvZgo+ID4gLSAgIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VM
QVIgUFVSUE9TRS4gIFNlZSB0aGUgR05VCj4gPiAtICAgTGVzc2VyIEdlbmVyYWwgUHVibGljIExp
Y2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KPiA+IC0KPiA+IC0gICBZb3Ugc2hvdWxkIGhhdmUgcmVj
ZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCj4gPiAtICAgTGlj
ZW5zZSBhbG9uZyB3aXRoIHRoaXMgbGlicmFyeTsgaWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251
Lm9yZy9saWNlbnNlcy8+Lgo+ID4gLSovCj4gPiAtCj4gPiAtI2luY2x1ZGUgImNvbmZpZy5oIgo+
ID4gLQo+ID4gLSNpbmNsdWRlIDx3aW5kb3dzLmg+Cj4gPiAtI2luY2x1ZGUgIndpbi11c2ItZGV2
LmgiCj4gPiAtI2luY2x1ZGUgInNwaWNlLW1hcnNoYWwuaCIKPiA+IC0jaW5jbHVkZSAic3BpY2Ut
dXRpbC5oIgo+ID4gLQo+ID4gLWVudW0gewo+ID4gLSAgICBQUk9QXzAsCj4gPiAtICAgIFBST1Bf
UkVESVJFQ1RJTkcKPiA+IC19Owo+ID4gLQo+ID4gLXN0cnVjdCBfR1VkZXZDbGllbnRQcml2YXRl
IHsKPiA+IC0gICAgU3BpY2VVc2JCYWNrZW5kICpjdHg7Cj4gPiAtICAgIEdMaXN0ICp1ZGV2X2xp
c3Q7Cj4gPiAtICAgIEhXTkQgaHduZDsKPiA+IC0gICAgZ2Jvb2xlYW4gcmVkaXJlY3Rpbmc7Cj4g
PiAtfTsKPiA+IC0KPiA+IC0jZGVmaW5lIEdfVURFVl9DTElFTlRfV0lOQ0xBU1NfTkFNRSAgVEVY
VCgiR19VREVWX0NMSUVOVCIpCj4gPiAtCj4gPiAtc3RhdGljIHZvaWQgZ191ZGV2X2NsaWVudF9p
bml0YWJsZV9pZmFjZV9pbml0KEdJbml0YWJsZUlmYWNlICAqaWZhY2UpOwo+ID4gLQo+ID4gLUdf
REVGSU5FX1RZUEVfV0lUSF9DT0RFKEdVZGV2Q2xpZW50LCBnX3VkZXZfY2xpZW50LCBHX1RZUEVf
T0JKRUNULAo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgIEdfQUREX1BSSVZBVEUoR1VkZXZD
bGllbnQpCj4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgR19JTVBMRU1FTlRfSU5URVJGQUNF
KEdfVFlQRV9JTklUQUJMRSwgZ191ZGV2X2NsaWVudF9pbml0YWJsZV9pZmFjZV9pbml0KSkKPiA+
IC0KPiA+IC1lbnVtCj4gPiAtewo+ID4gLSAgICBVRVZFTlRfU0lHTkFMLAo+ID4gLSAgICBMQVNU
X1NJR05BTCwKPiA+IC19Owo+ID4gLQo+ID4gLXN0YXRpYyBndWludCBzaWduYWxzW0xBU1RfU0lH
TkFMXSA9IHsgMCwgfTsKPiA+IC1zdGF0aWMgR1VkZXZDbGllbnQgKnNpbmdsZXRvbiA9IE5VTEw7
Cj4gPiAtCj4gPiAtc3RhdGljIExSRVNVTFQgQ0FMTEJBQ0sgd25kX3Byb2MoSFdORCBod25kLCBV
SU5UIG1lc3NhZ2UsIFdQQVJBTSB3cGFyYW0sIExQQVJBTSBscGFyYW0pOwo+ID4gLQo+ID4gLS8v
dW5jb21tZW50IHRvIGRlYnVnIGd1ZGV2IGRldmljZSBsaXN0cy4KPiA+IC0vLyNkZWZpbmUgREVC
VUdfR1VERVZfREVWSUNFX0xJU1RTCj4gPiAtCj4gPiAtI2lmZGVmIERFQlVHX0dVREVWX0RFVklD
RV9MSVNUUwo+ID4gLXN0YXRpYyB2b2lkIGdfdWRldl9kZXZpY2VfcHJpbnRfbGlzdChHTGlzdCAq
bCwgY29uc3QgZ2NoYXIgKm1zZyk7Cj4gPiAtI2Vsc2UKPiA+IC1zdGF0aWMgdm9pZCBnX3VkZXZf
ZGV2aWNlX3ByaW50X2xpc3QoR0xpc3QgKmwsIGNvbnN0IGdjaGFyICptc2cpIHt9Cj4gPiAtI2Vu
ZGlmCj4gPiAtc3RhdGljIHZvaWQgZ191ZGV2X2RldmljZV9wcmludChTcGljZVVzYkJhY2tlbmRE
ZXZpY2UgKmRldiwgY29uc3QgZ2NoYXIgKm1zZyk7Cj4gPiAtCj4gPiAtR1F1YXJrIGdfdWRldl9j
bGllbnRfZXJyb3JfcXVhcmsodm9pZCkKPiA+IC17Cj4gPiAtICAgIHJldHVybiBnX3F1YXJrX2Zy
b21fc3RhdGljX3N0cmluZygid2luLWd1ZGV2LWNsaWVudC1lcnJvci1xdWFyayIpOwo+ID4gLX0K
PiA+IC0KPiA+IC1HVWRldkNsaWVudCAqZ191ZGV2X2NsaWVudF9uZXcodm9pZCkKPiA+IC17Cj4g
PiAtICAgIGlmIChzaW5nbGV0b24gIT0gTlVMTCkKPiA+IC0gICAgICAgIHJldHVybiBnX29iamVj
dF9yZWYoc2luZ2xldG9uKTsKPiA+IC0KPiA+IC0gICAgc2luZ2xldG9uID0gZ19pbml0YWJsZV9u
ZXcoR19VREVWX1RZUEVfQ0xJRU5ULCBOVUxMLCBOVUxMLCBOVUxMKTsKPiA+IC0gICAgcmV0dXJu
IHNpbmdsZXRvbjsKPiA+IC19Cj4gPiAtCj4gPiAtU3BpY2VVc2JCYWNrZW5kICpnX3VkZXZfY2xp
ZW50X2dldF9jb250ZXh0KEdVZGV2Q2xpZW50ICpjbGllbnQpCj4gPiAtewo+ID4gLSAgICByZXR1
cm4gY2xpZW50LT5wcml2LT5jdHg7Cj4gPiAtfQo+ID4gLQo+ID4gLS8qCj4gPiAtICogZGV2cyBb
aW4sb3V0XSBhbiBlbXB0eSBkZXZzIGxpc3QgaW4sIGZ1bGwgZGV2cyBsaXN0IG91dAo+ID4gLSAq
IFJldHVybnM6IG51bWJlci1vZi1kZXZpY2VzLCBvciBhIG5lZ2F0aXZlIHZhbHVlIG9uIGVycm9y
Lgo+ID4gLSAqLwo+ID4gLXN0YXRpYyBzc2l6ZV90Cj4gPiAtZ191ZGV2X2NsaWVudF9saXN0X2Rl
dmljZXMoR1VkZXZDbGllbnQgKnNlbGYsIEdMaXN0ICoqZGV2cywKPiA+IC0gICAgICAgICAgICAg
ICAgICAgICAgICAgICBHRXJyb3IgKiplcnIsIGNvbnN0IGdjaGFyICpuYW1lKQo+ID4gLXsKPiA+
IC0gICAgU3BpY2VVc2JCYWNrZW5kRGV2aWNlICoqbHVzYl9saXN0LCAqKmRldjsKPiA+IC0gICAg
R1VkZXZDbGllbnRQcml2YXRlICpwcml2Owo+ID4gLSAgICBzc2l6ZV90IG47Cj4gPiAtCj4gPiAt
ICAgIGdfcmV0dXJuX3ZhbF9pZl9mYWlsKEdfVURFVl9JU19DTElFTlQoc2VsZiksIC0xKTsKPiA+
IC0gICAgZ19yZXR1cm5fdmFsX2lmX2ZhaWwoZGV2cyAhPSBOVUxMLCAtMik7Cj4gPiAtCj4gPiAt
ICAgIHByaXYgPSBzZWxmLT5wcml2Owo+ID4gLQo+ID4gLSAgICBnX3JldHVybl92YWxfaWZfZmFp
bChzZWxmLT5wcml2LT5jdHggIT0gTlVMTCwgLTMpOwo+ID4gLQo+ID4gLSAgICBsdXNiX2xpc3Qg
PSBzcGljZV91c2JfYmFja2VuZF9nZXRfZGV2aWNlX2xpc3QocHJpdi0+Y3R4KTsKPiA+IC0gICAg
aWYgKCFsdXNiX2xpc3QpIHsKPiA+IC0gICAgICAgIGdfc2V0X2Vycm9yKGVyciwgR19VREVWX0NM
SUVOVF9FUlJPUiwgR19VREVWX0NMSUVOVF9MSUJVU0JfRkFJTEVELAo+ID4gLSAgICAgICAgICAg
ICAgICAgICAgIiVzOiBFcnJvciBnZXR0aW5nIFVTQiBkZXZpY2UgbGlzdCIsIG5hbWUpOwo+ID4g
LSAgICAgICAgcmV0dXJuIC00Owo+ID4gLSAgICB9Cj4gPiAtCj4gPiAtICAgIG4gPSAwOwo+ID4g
LSAgICBmb3IgKGRldiA9IGx1c2JfbGlzdDsgKmRldjsgZGV2KyspIHsKPiA+IC0gICAgICAgICpk
ZXZzID0gZ19saXN0X3ByZXBlbmQoKmRldnMsIHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9yZWYo
KmRldikpOwo+ID4gLSAgICAgICAgbisrOwo+ID4gLSAgICB9Cj4gPiAtICAgIHNwaWNlX3VzYl9i
YWNrZW5kX2ZyZWVfZGV2aWNlX2xpc3QobHVzYl9saXN0KTsKPiA+IC0KPiA+IC0gICAgcmV0dXJu
IG47Cj4gPiAtfQo+ID4gLQo+ID4gLXN0YXRpYyB2b2lkIHVucmVmZXJlbmNlX2JhY2tlbmRfZGV2
aWNlKGdwb2ludGVyIGRhdGEpCj4gPiAtewo+ID4gLSAgICBzcGljZV91c2JfYmFja2VuZF9kZXZp
Y2VfdW5yZWYoKFNwaWNlVXNiQmFja2VuZERldmljZSAqKWRhdGEpOwo+ID4gLX0KPiA+IC0KPiA+
IC1zdGF0aWMgdm9pZCBnX3VkZXZfY2xpZW50X2ZyZWVfZGV2aWNlX2xpc3QoR0xpc3QgKipkZXZz
KQo+ID4gLXsKPiA+IC0gICAgZ19yZXR1cm5faWZfZmFpbChkZXZzICE9IE5VTEwpOwo+ID4gLSAg
ICBpZiAoKmRldnMpIHsKPiA+IC0gICAgICAgIGdfbGlzdF9mcmVlX2Z1bGwoKmRldnMsIHVucmVm
ZXJlbmNlX2JhY2tlbmRfZGV2aWNlKTsKPiA+IC0gICAgICAgICpkZXZzID0gTlVMTDsKPiA+IC0g
ICAgfQo+ID4gLX0KPiA+IC0KPiA+IC0KPiA+IC1zdGF0aWMgZ2Jvb2xlYW4KPiA+IC1nX3VkZXZf
Y2xpZW50X2luaXRhYmxlX2luaXQoR0luaXRhYmxlICppbml0YWJsZSwgR0NhbmNlbGxhYmxlICpj
YW5jZWxsYWJsZSwKPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgR0Vycm9yICoqZXJy
KQo+ID4gLXsKPiA+IC0gICAgR1VkZXZDbGllbnQgKnNlbGY7Cj4gPiAtICAgIEdVZGV2Q2xpZW50
UHJpdmF0ZSAqcHJpdjsKPiA+IC0gICAgV05EQ0xBU1Mgd2NsczsKPiA+IC0KPiA+IC0gICAgZ19y
ZXR1cm5fdmFsX2lmX2ZhaWwoR19VREVWX0lTX0NMSUVOVChpbml0YWJsZSksIEZBTFNFKTsKPiA+
IC0gICAgZ19yZXR1cm5fdmFsX2lmX2ZhaWwoY2FuY2VsbGFibGUgPT0gTlVMTCwgRkFMU0UpOwo+
ID4gLQo+ID4gLSAgICBzZWxmID0gR19VREVWX0NMSUVOVChpbml0YWJsZSk7Cj4gPiAtICAgIHBy
aXYgPSBzZWxmLT5wcml2Owo+ID4gLQo+ID4gLSAgICBwcml2LT5jdHggPSBzcGljZV91c2JfYmFj
a2VuZF9uZXcoZXJyKTsKPiA+IC0gICAgaWYgKCFwcml2LT5jdHgpIHsKPiA+IC0gICAgICAgIHJl
dHVybiBGQUxTRTsKPiA+IC0gICAgfQo+ID4gLQo+ID4gLSNpZmRlZiBHX09TX1dJTjMyCj4gPiAt
I2lmIExJQlVTQl9BUElfVkVSU0lPTiA+PSAweDAxMDAwMTA2Cj4gPiAtICAgIGxpYnVzYl9zZXRf
b3B0aW9uKHByaXYtPmN0eCwgTElCVVNCX09QVElPTl9VU0VfVVNCREspOwo+ID4gLSNlbmRpZgo+
ID4gLSNlbmRpZgo+ID4gLQo+ID4gLSAgICAvKiBnZXQgaW5pdGlhbCBkZXZpY2UgbGlzdCAqLwo+
ID4gLSAgICBpZiAoZ191ZGV2X2NsaWVudF9saXN0X2RldmljZXMoc2VsZiwgJnByaXYtPnVkZXZf
bGlzdCwgZXJyLCBfX0ZVTkNUSU9OX18pIDwgMCkgewo+ID4gLSAgICAgICAgZ290byBnX3VkZXZf
Y2xpZW50X2luaXRfZmFpbGVkOwo+ID4gLSAgICB9Cj4gPiAtCj4gPiAtICAgIGdfdWRldl9kZXZp
Y2VfcHJpbnRfbGlzdChwcml2LT51ZGV2X2xpc3QsICJpbml0OiBmaXJzdCBsaXN0IGlzOiAiKTsK
PiA+IC0KPiA+IC0gICAgLyogY3JlYXRlIGEgaGlkZGVuIHdpbmRvdyAqLwo+ID4gLSAgICBtZW1z
ZXQoJndjbHMsIDAsIHNpemVvZih3Y2xzKSk7Cj4gPiAtICAgIHdjbHMubHBmblduZFByb2MgPSB3
bmRfcHJvYzsKPiA+IC0gICAgd2Nscy5scHN6Q2xhc3NOYW1lID0gR19VREVWX0NMSUVOVF9XSU5D
TEFTU19OQU1FOwo+ID4gLSAgICBpZiAoIVJlZ2lzdGVyQ2xhc3MoJndjbHMpKSB7Cj4gPiAtICAg
ICAgICBEV09SRCBlID0gR2V0TGFzdEVycm9yKCk7Cj4gPiAtICAgICAgICBnX3dhcm5pbmcoIlJl
Z2lzdGVyQ2xhc3MgZmFpbGVkICwgJWxkIiwgKGxvbmcpZSk7Cj4gPiAtICAgICAgICBnX3NldF9l
cnJvcihlcnIsIEdfVURFVl9DTElFTlRfRVJST1IsIEdfVURFVl9DTElFTlRfV0lOQVBJX0ZBSUxF
RCwKPiA+IC0gICAgICAgICAgICAgICAgICAgICJSZWdpc3RlckNsYXNzIGZhaWxlZDogJWxkIiwg
KGxvbmcpZSk7Cj4gPiAtICAgICAgICBnb3RvIGdfdWRldl9jbGllbnRfaW5pdF9mYWlsZWQ7Cj4g
PiAtICAgIH0KPiA+IC0gICAgcHJpdi0+aHduZCA9IENyZWF0ZVdpbmRvdyhHX1VERVZfQ0xJRU5U
X1dJTkNMQVNTX05BTUUsCj4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTlVMTCwg
MCwgMCwgMCwgMCwgMCwgTlVMTCwgTlVMTCwgTlVMTCwgTlVMTCk7Cj4gPiAtICAgIGlmICghcHJp
di0+aHduZCkgewo+ID4gLSAgICAgICAgRFdPUkQgZSA9IEdldExhc3RFcnJvcigpOwo+ID4gLSAg
ICAgICAgZ193YXJuaW5nKCJDcmVhdGVXaW5kb3cgZmFpbGVkOiAlbGQiLCAobG9uZyllKTsKPiA+
IC0gICAgICAgIGdfc2V0X2Vycm9yKGVyciwgR19VREVWX0NMSUVOVF9FUlJPUiwgR19VREVWX0NM
SUVOVF9MSUJVU0JfRkFJTEVELAo+ID4gLSAgICAgICAgICAgICAgICAgICAgIkNyZWF0ZVdpbmRv
dyBmYWlsZWQ6ICVsZCIsIChsb25nKWUpOwo+ID4gLSAgICAgICAgZ290byBnX3VkZXZfY2xpZW50
X2luaXRfZmFpbGVkX3VucmVnOwo+ID4gLSAgICB9Cj4gPiAtCj4gPiAtICAgIHJldHVybiBUUlVF
Owo+ID4gLQo+ID4gLSBnX3VkZXZfY2xpZW50X2luaXRfZmFpbGVkX3VucmVnOgo+ID4gLSAgICBV
bnJlZ2lzdGVyQ2xhc3MoR19VREVWX0NMSUVOVF9XSU5DTEFTU19OQU1FLCBOVUxMKTsKPiA+IC0g
Z191ZGV2X2NsaWVudF9pbml0X2ZhaWxlZDoKPiA+IC0gICAgcmV0dXJuIEZBTFNFOwo+ID4gLX0K
PiA+IC0KPiA+IC1zdGF0aWMgdm9pZCBnX3VkZXZfY2xpZW50X2luaXRhYmxlX2lmYWNlX2luaXQo
R0luaXRhYmxlSWZhY2UgKmlmYWNlKQo+ID4gLXsKPiA+IC0gICAgaWZhY2UtPmluaXQgPSBnX3Vk
ZXZfY2xpZW50X2luaXRhYmxlX2luaXQ7Cj4gPiAtfQo+ID4gLQo+ID4gLXN0YXRpYyB2b2lkIHJl
cG9ydF9vbmVfZGV2aWNlKGdwb2ludGVyIGRhdGEsIGdwb2ludGVyIHNlbGYpCj4gPiAtewo+ID4g
LSAgICBnX3NpZ25hbF9lbWl0KHNlbGYsIHNpZ25hbHNbVUVWRU5UX1NJR05BTF0sIDAsIGRhdGEs
IFRSVUUpOwo+ID4gLX0KPiA+IC0KPiA+IC12b2lkIGdfdWRldl9jbGllbnRfcmVwb3J0X2Rldmlj
ZXMoR1VkZXZDbGllbnQgKnNlbGYpCj4gPiAtewo+ID4gLSAgICBnX2xpc3RfZm9yZWFjaChzZWxm
LT5wcml2LT51ZGV2X2xpc3QsIHJlcG9ydF9vbmVfZGV2aWNlLCBzZWxmKTsKPiA+IC19Cj4gPiAt
Cj4gPiAtc3RhdGljIHZvaWQgZ191ZGV2X2NsaWVudF9pbml0KEdVZGV2Q2xpZW50ICpzZWxmKQo+
ID4gLXsKPiA+IC0gICAgc2VsZi0+cHJpdiA9IGdfdWRldl9jbGllbnRfZ2V0X2luc3RhbmNlX3By
aXZhdGUoc2VsZik7Cj4gPiAtfQo+ID4gLQo+ID4gLXN0YXRpYyB2b2lkIGdfdWRldl9jbGllbnRf
ZmluYWxpemUoR09iamVjdCAqZ29iamVjdCkKPiA+IC17Cj4gPiAtICAgIEdVZGV2Q2xpZW50ICpz
ZWxmID0gR19VREVWX0NMSUVOVChnb2JqZWN0KTsKPiA+IC0gICAgR1VkZXZDbGllbnRQcml2YXRl
ICpwcml2ID0gc2VsZi0+cHJpdjsKPiA+IC0KPiA+IC0gICAgc2luZ2xldG9uID0gTlVMTDsKPiA+
IC0gICAgRGVzdHJveVdpbmRvdyhwcml2LT5od25kKTsKPiA+IC0gICAgVW5yZWdpc3RlckNsYXNz
KEdfVURFVl9DTElFTlRfV0lOQ0xBU1NfTkFNRSwgTlVMTCk7Cj4gPiAtICAgIGdfdWRldl9jbGll
bnRfZnJlZV9kZXZpY2VfbGlzdCgmcHJpdi0+dWRldl9saXN0KTsKPiA+IC0KPiA+IC0gICAgLyog
ZnJlZSBiYWNrZW5kIGNvbnRleHQgKi8KPiA+IC0gICAgZ193YXJuX2lmX2ZhaWwocHJpdi0+Y3R4
ICE9IE5VTEwpOwo+ID4gLSAgICBzcGljZV91c2JfYmFja2VuZF9kZWxldGUocHJpdi0+Y3R4KTsK
PiA+IC0KPiA+IC0gICAgLyogQ2hhaW4gdXAgdG8gdGhlIHBhcmVudCBjbGFzcyAqLwo+ID4gLSAg
ICBpZiAoR19PQkpFQ1RfQ0xBU1MoZ191ZGV2X2NsaWVudF9wYXJlbnRfY2xhc3MpLT5maW5hbGl6
ZSkKPiA+IC0gICAgICAgIEdfT0JKRUNUX0NMQVNTKGdfdWRldl9jbGllbnRfcGFyZW50X2NsYXNz
KS0+ZmluYWxpemUoZ29iamVjdCk7Cj4gPiAtfQo+ID4gLQo+ID4gLXN0YXRpYyB2b2lkIGdfdWRl
dl9jbGllbnRfZ2V0X3Byb3BlcnR5KEdPYmplY3QgICAgICpnb2JqZWN0LAo+ID4gLSAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGd1aW50ICAgICAgICBwcm9wX2lkLAo+ID4g
LSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdWYWx1ZSAgICAgICp2YWx1
ZSwKPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBHUGFyYW1TcGVj
ICAqcHNwZWMpCj4gPiAtewo+ID4gLSAgICBHVWRldkNsaWVudCAqc2VsZiA9IEdfVURFVl9DTElF
TlQoZ29iamVjdCk7Cj4gPiAtICAgIEdVZGV2Q2xpZW50UHJpdmF0ZSAqcHJpdiA9IHNlbGYtPnBy
aXY7Cj4gPiAtCj4gPiAtICAgIHN3aXRjaCAocHJvcF9pZCkgewo+ID4gLSAgICBjYXNlIFBST1Bf
UkVESVJFQ1RJTkc6Cj4gPiAtICAgICAgICBnX3ZhbHVlX3NldF9ib29sZWFuKHZhbHVlLCBwcml2
LT5yZWRpcmVjdGluZyk7Cj4gPiAtICAgICAgICBicmVhazsKPiA+IC0gICAgZGVmYXVsdDoKPiA+
IC0gICAgICAgIEdfT0JKRUNUX1dBUk5fSU5WQUxJRF9QUk9QRVJUWV9JRChnb2JqZWN0LCBwcm9w
X2lkLCBwc3BlYyk7Cj4gPiAtICAgICAgICBicmVhazsKPiA+IC0gICAgfQo+ID4gLX0KPiA+IC0K
PiA+IC1zdGF0aWMgdm9pZCBoYW5kbGVfZGV2X2NoYW5nZShHVWRldkNsaWVudCAqc2VsZik7Cj4g
PiAtCj4gPiAtc3RhdGljIHZvaWQgZ191ZGV2X2NsaWVudF9zZXRfcHJvcGVydHkoR09iamVjdCAg
ICAgICAqZ29iamVjdCwKPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBndWludCAgICAgICAgICBwcm9wX2lkLAo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGNvbnN0IEdWYWx1ZSAgKnZhbHVlLAo+ID4gLSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIEdQYXJhbVNwZWMgICAgKnBzcGVjKQo+ID4gLXsKPiA+IC0g
ICAgR1VkZXZDbGllbnQgKnNlbGYgPSBHX1VERVZfQ0xJRU5UKGdvYmplY3QpOwo+ID4gLSAgICBH
VWRldkNsaWVudFByaXZhdGUgKnByaXYgPSBzZWxmLT5wcml2Owo+ID4gLSAgICBnYm9vbGVhbiBv
bGRfdmFsOwo+ID4gLQo+ID4gLSAgICBzd2l0Y2ggKHByb3BfaWQpIHsKPiA+IC0gICAgY2FzZSBQ
Uk9QX1JFRElSRUNUSU5HOgo+ID4gLSAgICAgICAgb2xkX3ZhbCA9IHByaXYtPnJlZGlyZWN0aW5n
Owo+ID4gLSAgICAgICAgcHJpdi0+cmVkaXJlY3RpbmcgPSBnX3ZhbHVlX2dldF9ib29sZWFuKHZh
bHVlKTsKPiA+IC0gICAgICAgIGlmIChvbGRfdmFsICYmICFwcml2LT5yZWRpcmVjdGluZykgewo+
ID4gLSAgICAgICAgICAgIC8qIFRoaXMgaXMgYSByZWRpcmVjdGlvbiBjb21wbGV0aW9uIGNhc2Uu
Cj4gPiAtICAgICAgICAgICAgICAgSW5qZWN0IGhvdHBsdWcgZXZlbnQgaW4gY2FzZSB3ZSBtaXNz
ZWQgZGV2aWNlIGNoYW5nZXMKPiA+IC0gICAgICAgICAgICAgICBkdXJpbmcgcmVkaXJlY3Rpb24g
cHJvY2Vzc2luZy4gKi8KPiA+IC0gICAgICAgICAgICBoYW5kbGVfZGV2X2NoYW5nZShzZWxmKTsK
PiA+IC0gICAgICAgIH0KPiA+IC0gICAgICAgIGJyZWFrOwo+ID4gLSAgICBkZWZhdWx0Ogo+ID4g
LSAgICAgICAgR19PQkpFQ1RfV0FSTl9JTlZBTElEX1BST1BFUlRZX0lEKGdvYmplY3QsIHByb3Bf
aWQsIHBzcGVjKTsKPiA+IC0gICAgICAgIGJyZWFrOwo+ID4gLSAgICB9Cj4gPiAtfQo+ID4gLQo+
ID4gLXN0YXRpYyB2b2lkIGdfdWRldl9jbGllbnRfY2xhc3NfaW5pdChHVWRldkNsaWVudENsYXNz
ICprbGFzcykKPiA+IC17Cj4gPiAtICAgIEdPYmplY3RDbGFzcyAqZ29iamVjdF9jbGFzcyA9IEdf
T0JKRUNUX0NMQVNTKGtsYXNzKTsKPiA+IC0gICAgR1BhcmFtU3BlYyAqcHNwZWM7Cj4gPiAtCj4g
PiAtICAgIGdvYmplY3RfY2xhc3MtPmZpbmFsaXplID0gZ191ZGV2X2NsaWVudF9maW5hbGl6ZTsK
PiA+IC0gICAgZ29iamVjdF9jbGFzcy0+Z2V0X3Byb3BlcnR5ID0gZ191ZGV2X2NsaWVudF9nZXRf
cHJvcGVydHk7Cj4gPiAtICAgIGdvYmplY3RfY2xhc3MtPnNldF9wcm9wZXJ0eSA9IGdfdWRldl9j
bGllbnRfc2V0X3Byb3BlcnR5Owo+ID4gLQo+ID4gLSAgICBzaWduYWxzW1VFVkVOVF9TSUdOQUxd
ID0KPiA+IC0gICAgICAgIGdfc2lnbmFsX25ldygidWV2ZW50IiwKPiA+IC0gICAgICAgICAgICAg
ICAgICAgICBHX09CSkVDVF9DTEFTU19UWVBFKGtsYXNzKSwKPiA+IC0gICAgICAgICAgICAgICAg
ICAgICBHX1NJR05BTF9SVU5fRklSU1QsCj4gPiAtICAgICAgICAgICAgICAgICAgICAgR19TVFJV
Q1RfT0ZGU0VUKEdVZGV2Q2xpZW50Q2xhc3MsIHVldmVudCksCj4gPiAtICAgICAgICAgICAgICAg
ICAgICAgTlVMTCwgTlVMTCwKPiA+IC0gICAgICAgICAgICAgICAgICAgICBnX2NjbG9zdXJlX3Vz
ZXJfbWFyc2hhbF9WT0lEX19QT0lOVEVSX0JPT0xFQU4sCj4gPiAtICAgICAgICAgICAgICAgICAg
ICAgR19UWVBFX05PTkUsCj4gPiAtICAgICAgICAgICAgICAgICAgICAgMiwKPiA+IC0gICAgICAg
ICAgICAgICAgICAgICBHX1RZUEVfUE9JTlRFUiwKPiA+IC0gICAgICAgICAgICAgICAgICAgICBH
X1RZUEVfQk9PTEVBTik7Cj4gPiAtCj4gPiAtICAgIC8qKgo+ID4gLSAgICAqIEdVZGV2Q2xpZW50
OjpyZWRpcmVjdGluZzoKPiA+IC0gICAgKgo+ID4gLSAgICAqIFRoaXMgcHJvcGVydHkgaW5kaWNh
dGVzIHdoZW4gYSByZWRpcmVjdGlvbiBvcGVyYXRpb24KPiA+IC0gICAgKiBpcyBpbiBwcm9ncmVz
cyBvbiBhIGRldmljZS4gSXQncyBzZXQgYmFjayB0byBGQUxTRQo+ID4gLSAgICAqIG9uY2UgdGhl
IGRldmljZSBpcyBmdWxseSByZWRpcmVjdGVkIHRvIHRoZSBndWVzdC4KPiA+IC0gICAgKi8KPiA+
IC0gICAgcHNwZWMgPSBnX3BhcmFtX3NwZWNfYm9vbGVhbigicmVkaXJlY3RpbmciLCAiUmVkaXJl
Y3RpbmciLAo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJVU0IgcmVkaXJl
Y3Rpb24gb3BlcmF0aW9uIGlzIGluIHByb2dyZXNzIiwKPiA+IC0gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBGQUxTRSwKPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBHX1BBUkFNX1JFQURXUklURSB8IEdfUEFSQU1fU1RBVElDX1NUUklOR1MpOwo+ID4gLQo+ID4g
LSAgICBnX29iamVjdF9jbGFzc19pbnN0YWxsX3Byb3BlcnR5KGdvYmplY3RfY2xhc3MsIFBST1Bf
UkVESVJFQ1RJTkcsIHBzcGVjKTsKPiA+IC19Cj4gPiAtCj4gPiAtLyogY29tcGFyaW5nIGJ1czph
ZGRyIGFuZCB2aWQ6cGlkICovCj4gPiAtc3RhdGljIGdpbnQgY29tcGFyZV91c2JfZGV2aWNlcyhn
Y29uc3Rwb2ludGVyIGEsIGdjb25zdHBvaW50ZXIgYikKPiA+IC17Cj4gPiAtICAgIGNvbnN0IFVz
YkRldmljZUluZm9ybWF0aW9uICphX2luZm8sICpiX2luZm87Cj4gPiAtICAgIGdib29sZWFuIHNh
bWVfYnVzLCBzYW1lX2FkZHIsIHNhbWVfdmlkLCBzYW1lX3BpZDsKPiA+IC0gICAgYV9pbmZvID0g
c3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX2dldF9pbmZvKChTcGljZVVzYkJhY2tlbmREZXZpY2Ug
KilhKTsKPiA+IC0gICAgYl9pbmZvID0gc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX2dldF9pbmZv
KChTcGljZVVzYkJhY2tlbmREZXZpY2UgKiliKTsKPiA+IC0KPiA+IC0KPiA+IC0gICAgc2FtZV9i
dXMgPSAoYV9pbmZvLT5idXMgPT0gYl9pbmZvLT5idXMpOwo+ID4gLSAgICBzYW1lX2FkZHIgPSAo
YV9pbmZvLT5hZGRyZXNzID09IGJfaW5mby0+YWRkcmVzcyk7Cj4gPiAtICAgIHNhbWVfdmlkID0g
KGFfaW5mby0+dmlkID09IGJfaW5mby0+dmlkKTsKPiA+IC0gICAgc2FtZV9waWQgPSAoYV9pbmZv
LT5waWQgPT0gYl9pbmZvLT5waWQpOwo+ID4gLQo+ID4gLSAgICByZXR1cm4gKHNhbWVfYnVzICYm
IHNhbWVfYWRkciAmJiBzYW1lX3ZpZCAmJiBzYW1lX3BpZCkgPyAwIDogLTE7Cj4gPiAtfQo+ID4g
LQo+ID4gLXN0YXRpYyB2b2lkIHVwZGF0ZV9kZXZpY2VfbGlzdChHVWRldkNsaWVudCAqc2VsZiwg
R0xpc3QgKm5ld19kZXZpY2VfbGlzdCkKPiA+IC17Cj4gPiAtICAgIEdMaXN0ICpkZXY7Cj4gPiAt
Cj4gPiAtICAgIGZvciAoZGV2ID0gZ19saXN0X2ZpcnN0KG5ld19kZXZpY2VfbGlzdCk7IGRldiAh
PSBOVUxMOyBkZXYgPSBnX2xpc3RfbmV4dChkZXYpKSB7Cj4gPiAtICAgICAgICBHTGlzdCAqZm91
bmQgPSBnX2xpc3RfZmluZF9jdXN0b20oc2VsZi0+cHJpdi0+dWRldl9saXN0LCBkZXYtPmRhdGEs
IGNvbXBhcmVfdXNiX2RldmljZXMpOwo+ID4gLSAgICAgICAgaWYgKGZvdW5kICE9IE5VTEwpIHsK
PiA+IC0gICAgICAgICAgICAvKiBrZWVwIG9sZCBleGlzdGluZyBsaWJ1c2JfZGV2aWNlIGluIHRo
ZSBuZXcgbGlzdCwgd2hlbgo+ID4gLSAgICAgICAgICAgICAgIHVzYi1kZXYtbWFuYWdlciB3aWxs
IG1haW50YWluIGl0cyBvd24gbGlzdCBvZiBsaWJ1c2JfZGV2aWNlLAo+ID4gLSAgICAgICAgICAg
ICAgIHRoZXNlIGxpc3RzIHdpbGwgYmUgY29tcGxldGVseSBjb25zaXN0ZW50ICovCj4gPiAtICAg
ICAgICAgICAgU3BpY2VVc2JCYWNrZW5kRGV2aWNlICp0ZW1wID0gZm91bmQtPmRhdGE7Cj4gPiAt
ICAgICAgICAgICAgZm91bmQtPmRhdGEgPSBkZXYtPmRhdGE7Cj4gPiAtICAgICAgICAgICAgZGV2
LT5kYXRhID0gdGVtcDsKPiA+IC0gICAgICAgIH0KPiA+IC0gICAgfQo+ID4gLQo+ID4gLSAgICBn
X3VkZXZfY2xpZW50X2ZyZWVfZGV2aWNlX2xpc3QoJnNlbGYtPnByaXYtPnVkZXZfbGlzdCk7Cj4g
PiAtICAgIHNlbGYtPnByaXYtPnVkZXZfbGlzdCA9IG5ld19kZXZpY2VfbGlzdDsKPiA+IC19Cj4g
PiAtCj4gPiAtc3RhdGljIHZvaWQgbm90aWZ5X2Rldl9zdGF0ZV9jaGFuZ2UoR1VkZXZDbGllbnQg
KnNlbGYsCj4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgR0xpc3QgKm9s
ZF9saXN0LAo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdMaXN0ICpu
ZXdfbGlzdCwKPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYm9vbGVh
biBhZGQpCj4gPiAtewo+ID4gLSAgICBHTGlzdCAqZGV2Owo+ID4gLQo+ID4gLSAgICBmb3IgKGRl
diA9IGdfbGlzdF9maXJzdChvbGRfbGlzdCk7IGRldiAhPSBOVUxMOyBkZXYgPSBnX2xpc3RfbmV4
dChkZXYpKSB7Cj4gPiAtICAgICAgICBHTGlzdCAqZm91bmQgPSBnX2xpc3RfZmluZF9jdXN0b20o
bmV3X2xpc3QsIGRldi0+ZGF0YSwgY29tcGFyZV91c2JfZGV2aWNlcyk7Cj4gPiAtICAgICAgICBp
ZiAoZm91bmQgPT0gTlVMTCkgewo+ID4gLSAgICAgICAgICAgIGdfdWRldl9kZXZpY2VfcHJpbnQo
ZGV2LT5kYXRhLCBhZGQgPyAiYWRkIiA6ICJyZW1vdmUiKTsKPiA+IC0gICAgICAgICAgICBnX3Np
Z25hbF9lbWl0KHNlbGYsIHNpZ25hbHNbVUVWRU5UX1NJR05BTF0sIDAsIGRldi0+ZGF0YSwgYWRk
KTsKPiA+IC0gICAgICAgIH0KPiA+IC0gICAgfQo+ID4gLX0KPiA+IC0KPiA+IC1zdGF0aWMgdm9p
ZCBoYW5kbGVfZGV2X2NoYW5nZShHVWRldkNsaWVudCAqc2VsZikKPiA+IC17Cj4gPiAtICAgIEdV
ZGV2Q2xpZW50UHJpdmF0ZSAqcHJpdiA9IHNlbGYtPnByaXY7Cj4gPiAtICAgIEdFcnJvciAqZXJy
ID0gTlVMTDsKPiA+IC0gICAgR0xpc3QgKm5vd19kZXZzID0gTlVMTDsKPiA+IC0KPiA+IC0gICAg
aWYgKHByaXYtPnJlZGlyZWN0aW5nID09IFRSVUUpIHsKPiA+IC0gICAgICAgIC8qIE9uIFdpbmRv
d3MsIHF1ZXJ5aW5nIFVTQiBkZXZpY2UgbGlzdCBtYXkgcmV0dXJuIGluY29uc2lzdGVudCByZXN1
bHRzCj4gPiAtICAgICAgICAgICBpZiBwZXJmb3JtZWQgaW4gcGFyYWxsZWwgdG8gcmVkaXJlY3Rp
b24gZmxvdy4KPiA+IC0gICAgICAgICAgIEEgc2ltdWxhdGVkIGhvdHBsdWcgZXZlbnQgd2lsbCBi
ZSBpbmplY3RlZCBhZnRlciByZWRpcmVjdGlvbgo+ID4gLSAgICAgICAgICAgY29tcGxldGlvbiBp
biBvcmRlciB0byBwcm9jZXNzIHJlYWwgZGV2aWNlIGxpc3QgY2hhbmdlcyB0aGF0IG1heQo+ID4g
LSAgICAgICAgICAgaGFkIHRha2VuIHBsYWNlIGR1cmluZyByZWRpcmVjdGlvbiBwcm9jZXNzLiAq
Lwo+ID4gLSAgICAgICAgcmV0dXJuOwo+ID4gLSAgICB9Cj4gPiAtCj4gPiAtICAgIGlmKGdfdWRl
dl9jbGllbnRfbGlzdF9kZXZpY2VzKHNlbGYsICZub3dfZGV2cywgJmVyciwgX19GVU5DVElPTl9f
KSA8IDApIHsKPiA+IC0gICAgICAgIGdfd2FybmluZygiY291bGQgbm90IHJldHJpZXZlIGRldmlj
ZSBsaXN0Iik7Cj4gPiAtICAgICAgICByZXR1cm47Cj4gPiAtICAgIH0KPiA+IC0KPiA+IC0gICAg
Z191ZGV2X2RldmljZV9wcmludF9saXN0KG5vd19kZXZzLCAiaGFuZGxlX2Rldl9jaGFuZ2U6IGN1
cnJlbnQgbGlzdDoiKTsKPiA+IC0gICAgZ191ZGV2X2RldmljZV9wcmludF9saXN0KHByaXYtPnVk
ZXZfbGlzdCwgImhhbmRsZV9kZXZfY2hhbmdlOiBwcmV2aW91cyBsaXN0OiIpOwo+ID4gLQo+ID4g
LSAgICAvKiBVbnJlZ2lzdGVyIGRldmljZXMgdGhhdCBhcmUgbm90IHByZXNlbnQgYW55bW9yZSAq
Lwo+ID4gLSAgICBub3RpZnlfZGV2X3N0YXRlX2NoYW5nZShzZWxmLCBwcml2LT51ZGV2X2xpc3Qs
IG5vd19kZXZzLCBGQUxTRSk7Cj4gPiAtCj4gPiAtICAgIC8qIFJlZ2lzdGVyIG5ld2x5IGluc2Vy
dGVkIGRldmljZXMgKi8KPiA+IC0gICAgbm90aWZ5X2Rldl9zdGF0ZV9jaGFuZ2Uoc2VsZiwgbm93
X2RldnMsIHByaXYtPnVkZXZfbGlzdCwgVFJVRSk7Cj4gPiAtCj4gPiAtICAgIC8qIGtlZXAgbW9z
dCByZWNlbnQgaW5mbzogZnJlZSBwcmV2aW91cyBsaXN0LCBhbmQga2VlcCBjdXJyZW50IGxpc3Qg
Ki8KPiA+IC0gICAgdXBkYXRlX2RldmljZV9saXN0KHNlbGYsIG5vd19kZXZzKTsKPiA+IC19Cj4g
PiAtCj4gPiAtc3RhdGljIExSRVNVTFQgQ0FMTEJBQ0sgd25kX3Byb2MoSFdORCBod25kLCBVSU5U
IG1lc3NhZ2UsIFdQQVJBTSB3cGFyYW0sIExQQVJBTSBscGFyYW0pCj4gPiAtewo+ID4gLSAgICAv
KiBPbmx5IERCVF9ERVZOT0RFU19DSEFOR0VEIHJlY2lldmVkICovCj4gPiAtICAgIGlmIChtZXNz
YWdlID09IFdNX0RFVklDRUNIQU5HRSkgewo+ID4gLSAgICAgICAgaGFuZGxlX2Rldl9jaGFuZ2Uo
c2luZ2xldG9uKTsKPiA+IC0gICAgfQo+ID4gLSAgICByZXR1cm4gRGVmV2luZG93UHJvYyhod25k
LCBtZXNzYWdlLCB3cGFyYW0sIGxwYXJhbSk7Cj4gPiAtfQo+ID4gLQo+ID4gLSNpZmRlZiBERUJV
R19HVURFVl9ERVZJQ0VfTElTVFMKPiA+IC1zdGF0aWMgdm9pZCBnX3VkZXZfZGV2aWNlX3ByaW50
X2xpc3QoR0xpc3QgKmwsIGNvbnN0IGdjaGFyICptc2cpCj4gPiAtewo+ID4gLSAgICBHTGlzdCAq
aXQ7Cj4gPiAtCj4gPiAtICAgIGZvciAoaXQgPSBnX2xpc3RfZmlyc3QobCk7IGl0ICE9IE5VTEw7
IGl0PWdfbGlzdF9uZXh0KGl0KSkgewo+ID4gLSAgICAgICAgZ191ZGV2X2RldmljZV9wcmludChp
dC0+ZGF0YSwgbXNnKTsKPiA+IC0gICAgfQo+ID4gLX0KPiA+IC0jZW5kaWYKPiA+IC0KPiA+IC1z
dGF0aWMgdm9pZCBnX3VkZXZfZGV2aWNlX3ByaW50KFNwaWNlVXNiQmFja2VuZERldmljZSAqZGV2
LCBjb25zdCBnY2hhciAqbXNnKQo+ID4gLXsKPiA+IC0gICAgY29uc3QgVXNiRGV2aWNlSW5mb3Jt
YXRpb24gKmluZm8gPSBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfZ2V0X2luZm8oZGV2KTsKPiA+
IC0KPiA+IC0gICAgU1BJQ0VfREVCVUcoIiVzOiAlZC4lZCAweCUwNHg6MHglMDR4IGNsYXNzICVk
IiwgbXNnLAo+ID4gLSAgICAgICAgICAgICAgICBpbmZvLT5idXMsIGluZm8tPmFkZHJlc3MsCj4g
PiAtICAgICAgICAgICAgICAgIGluZm8tPnZpZCwgaW5mby0+cGlkLCBpbmZvLT5jbGFzcyk7Cj4g
PiAtfQo+ID4gZGlmZiAtLWdpdCBhL3NyYy93aW4tdXNiLWRldi5oIGIvc3JjL3dpbi11c2ItZGV2
LmgKPiA+IGRlbGV0ZWQgZmlsZSBtb2RlIDEwMDY0NAo+ID4gaW5kZXggZmRmZTczYS4uMDAwMDAw
MAo+ID4gLS0tIGEvc3JjL3dpbi11c2ItZGV2LmgKPiA+ICsrKyAvZGV2L251bGwKPiA+IEBAIC0x
LDg0ICswLDAgQEAKPiA+IC0vKiAtKi0gTW9kZTogQzsgYy1iYXNpYy1vZmZzZXQ6IDQ7IGluZGVu
dC10YWJzLW1vZGU6IG5pbCAtKi0gKi8KPiA+IC0vKgo+ID4gLSAgIENvcHlyaWdodCAoQykgMjAx
MiBSZWQgSGF0LCBJbmMuCj4gPiAtCj4gPiAtICAgUmVkIEhhdCBBdXRob3JzOgo+ID4gLSAgIEFy
bm9uIEdpbGJvYSA8YWdpbGJvYUByZWRoYXQuY29tPgo+ID4gLSAgIFVyaSBMdWJsaW4gICA8dXJp
bEByZWRoYXQuY29tPgo+ID4gLQo+ID4gLSAgIFRoaXMgbGlicmFyeSBpcyBmcmVlIHNvZnR3YXJl
OyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IKPiA+IC0gICBtb2RpZnkgaXQgdW5kZXIg
dGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCj4gPiAtICAgTGljZW5z
ZSBhcyBwdWJsaXNoZWQgYnkgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyCj4g
PiAtICAgdmVyc2lvbiAyLjEgb2YgdGhlIExpY2Vuc2UsIG9yIChhdCB5b3VyIG9wdGlvbikgYW55
IGxhdGVyIHZlcnNpb24uCj4gPiAtCj4gPiAtICAgVGhpcyBsaWJyYXJ5IGlzIGRpc3RyaWJ1dGVk
IGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCj4gPiAtICAgYnV0IFdJVEhPVVQg
QU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKPiA+IC0g
ICBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBT
ZWUgdGhlIEdOVQo+ID4gLSAgIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3Jl
IGRldGFpbHMuCj4gPiAtCj4gPiAtICAgWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBv
ZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYwo+ID4gLSAgIExpY2Vuc2UgYWxvbmcgd2l0
aCB0aGlzIGxpYnJhcnk7IGlmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMv
Pi4KPiA+IC0qLwo+ID4gLSNpZm5kZWYgX19XSU5fVVNCX0RFVl9IX18KPiA+IC0jZGVmaW5lIF9f
V0lOX1VTQl9ERVZfSF9fCj4gPiAtCj4gPiAtI2luY2x1ZGUgPGdpby9naW8uaD4KPiA+IC0jaW5j
bHVkZSAidXNiLWJhY2tlbmQuaCIKPiA+IC0KPiA+IC1HX0JFR0lOX0RFQ0xTCj4gPiAtCj4gPiAt
LyogR1VkZXZDbGllbnQgKi8KPiA+IC0KPiA+IC0jZGVmaW5lIEdfVURFVl9UWVBFX0NMSUVOVCAg
ICAgICAgIChnX3VkZXZfY2xpZW50X2dldF90eXBlKCkpCj4gPiAtI2RlZmluZSBHX1VERVZfQ0xJ
RU5UKG8pICAgICAgICAgICAoR19UWVBFX0NIRUNLX0lOU1RBTkNFX0NBU1QoKG8pLCBHX1VERVZf
VFlQRV9DTElFTlQsIEdVZGV2Q2xpZW50KSkKPiA+IC0jZGVmaW5lIEdfVURFVl9DTElFTlRfQ0xB
U1MoaykgICAgIChHX1RZUEVfQ0hFQ0tfQ0xBU1NfQ0FTVCgoayksIEdfVURFVl9UWVBFX0NMSUVO
VCwgR1VkZXZDbGllbnRDbGFzcykpCj4gPiAtI2RlZmluZSBHX1VERVZfSVNfQ0xJRU5UKG8pICAg
ICAgICAoR19UWVBFX0NIRUNLX0lOU1RBTkNFX1RZUEUoKG8pLCBHX1VERVZfVFlQRV9DTElFTlQp
KQo+ID4gLSNkZWZpbmUgR19VREVWX0lTX0NMSUVOVF9DTEFTUyhrKSAgKEdfVFlQRV9DSEVDS19D
TEFTU19UWVBFKChrKSwgR19VREVWX1RZUEVfQ0xJRU5UKSkKPiA+IC0jZGVmaW5lIEdfVURFVl9D
TElFTlRfR0VUX0NMQVNTKG8pIChHX1RZUEVfSU5TVEFOQ0VfR0VUX0NMQVNTKChvKSwgR19VREVW
X1RZUEVfQ0xJRU5ULCBHVWRldkNsaWVudENsYXNzKSkKPiA+IC0KPiA+IC10eXBlZGVmIHN0cnVj
dCBfR1VkZXZDbGllbnQgR1VkZXZDbGllbnQ7Cj4gPiAtdHlwZWRlZiBzdHJ1Y3QgX0dVZGV2Q2xp
ZW50Q2xhc3MgR1VkZXZDbGllbnRDbGFzczsKPiA+IC10eXBlZGVmIHN0cnVjdCBfR1VkZXZDbGll
bnRQcml2YXRlIEdVZGV2Q2xpZW50UHJpdmF0ZTsKPiA+IC0KPiA+IC1zdHJ1Y3QgX0dVZGV2Q2xp
ZW50Cj4gPiAtewo+ID4gLSAgICBHT2JqZWN0IHBhcmVudDsKPiA+IC0KPiA+IC0gICAgR1VkZXZD
bGllbnRQcml2YXRlICpwcml2Owo+ID4gLX07Cj4gPiAtCj4gPiAtc3RydWN0IF9HVWRldkNsaWVu
dENsYXNzCj4gPiAtewo+ID4gLSAgICBHT2JqZWN0Q2xhc3MgcGFyZW50X2NsYXNzOwo+ID4gLQo+
ID4gLSAgICAvKiBzaWduYWxzICovCj4gPiAtICAgIHZvaWQgKCp1ZXZlbnQpKEdVZGV2Q2xpZW50
ICpjbGllbnQsIFNwaWNlVXNiQmFja2VuZERldmljZSAqZGV2aWNlLCBnYm9vbGVhbiBhZGQpOwo+
ID4gLX07Cj4gPiAtCj4gPiAtR1R5cGUgZ191ZGV2X2NsaWVudF9nZXRfdHlwZSh2b2lkKSBHX0dO
VUNfQ09OU1Q7Cj4gPiAtR1VkZXZDbGllbnQgKmdfdWRldl9jbGllbnRfbmV3KHZvaWQpOwo+ID4g
LVNwaWNlVXNiQmFja2VuZCAqZ191ZGV2X2NsaWVudF9nZXRfY29udGV4dChHVWRldkNsaWVudCAq
Y2xpZW50KTsKPiA+IC12b2lkIGdfdWRldl9jbGllbnRfcmVwb3J0X2RldmljZXMoR1VkZXZDbGll
bnQgKmNsaWVudCk7Cj4gPiAtCj4gPiAtR1F1YXJrIGdfdWRldl9jbGllbnRfZXJyb3JfcXVhcmso
dm9pZCk7Cj4gPiAtI2RlZmluZSBHX1VERVZfQ0xJRU5UX0VSUk9SIGdfdWRldl9jbGllbnRfZXJy
b3JfcXVhcmsoKQo+ID4gLQo+ID4gLS8qKgo+ID4gLSAqIEdVZGV2Q2xpZW50RXJyb3I6Cj4gPiAt
ICogQEdfVURFVl9DTElFTlRfRVJST1JfRkFJTEVEOiBnZW5lcmljIGVycm9yIGNvZGUKPiA+IC0g
KiBAR19VREVWX0NMSUVOVF9MSUJVU0JfRkFJTEVEOiBhIGxpYnVzYiBjYWxsIGZhaWxlZAo+ID4g
LSAqIEBHX1VERVZfQ0xJRU5UX1dJTkFQSV9GQUlMRUQ6IGEgd2luYXBpIGNhbGwgZmFpbGVkCj4g
PiAtICoKPiA+IC0gKiBFcnJvciBjb2RlcyByZXR1cm5lZCBieSBzcGljZS1jbGllbnQgQVBJLgo+
ID4gLSAqLwo+ID4gLXR5cGVkZWYgZW51bQo+ID4gLXsKPiA+IC0gICAgR19VREVWX0NMSUVOVF9F
UlJPUl9GQUlMRUQgPSAxLAo+ID4gLSAgICBHX1VERVZfQ0xJRU5UX0xJQlVTQl9GQUlMRUQsCj4g
PiAtICAgIEdfVURFVl9DTElFTlRfV0lOQVBJX0ZBSUxFRAo+ID4gLX0gR1VkZXZDbGllbnRFcnJv
cjsKPiA+IC0KPiA+IC0KPiA+IC1HX0VORF9ERUNMUwo+ID4gLQo+ID4gLSNlbmRpZiAvKiBfX1dJ
Tl9VU0JfREVWX0hfXyAqLwo+ID4gLS0KPiA+IDIuMTcuMQo+ID4KPiA+IF9fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCj4gPiBTcGljZS1kZXZlbCBtYWlsaW5n
IGxpc3QKPiA+IFNwaWNlLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZwo+ID4gaHR0cHM6Ly9s
aXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9zcGljZS1kZXZlbApfX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpTcGljZS1kZXZlbCBtYWls
aW5nIGxpc3QKU3BpY2UtZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMu
ZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vc3BpY2UtZGV2ZWw=
