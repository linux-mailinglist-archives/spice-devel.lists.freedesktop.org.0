Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 4E26FA6822
	for <lists+spice-devel@lfdr.de>; Tue,  3 Sep 2019 14:08:40 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 331B48919E;
	Tue,  3 Sep 2019 12:08:38 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 3806B8919E
 for <spice-devel@lists.freedesktop.org>; Tue,  3 Sep 2019 12:08:37 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx05.intmail.prod.int.phx2.redhat.com
 [10.5.11.15])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id C195B8DED60
 for <spice-devel@lists.freedesktop.org>; Tue,  3 Sep 2019 12:08:36 +0000 (UTC)
Received: from colo-mx.corp.redhat.com
 (colo-mx01.intmail.prod.int.phx2.redhat.com [10.5.11.20])
 by smtp.corp.redhat.com (Postfix) with ESMTPS id B554B5D6B7
 for <spice-devel@lists.freedesktop.org>; Tue,  3 Sep 2019 12:08:36 +0000 (UTC)
Received: from zmail25.collab.prod.int.phx2.redhat.com
 (zmail25.collab.prod.int.phx2.redhat.com [10.5.83.31])
 by colo-mx.corp.redhat.com (Postfix) with ESMTP id AD4741802216;
 Tue,  3 Sep 2019 12:08:36 +0000 (UTC)
Date: Tue, 3 Sep 2019 08:08:36 -0400 (EDT)
From: Frediano Ziglio <fziglio@redhat.com>
To: uril@redhat.com
Message-ID: <1987497362.10440756.1567512516505.JavaMail.zimbra@redhat.com>
In-Reply-To: <2d4fe923-43e3-ee91-1ebf-f1d815e14f4a@redhat.com>
References: <20190827092246.10276-1-fziglio@redhat.com>
 <20190827092246.10276-25-fziglio@redhat.com>
 <2d4fe923-43e3-ee91-1ebf-f1d815e14f4a@redhat.com>
MIME-Version: 1.0
X-Originating-IP: [10.33.5.151, 10.4.195.17]
Thread-Topic: usb-backend: Rewrite USB emulation support
Thread-Index: F8mlEPCwQONJQSd7nwno30W3PCE05A==
X-Scanned-By: MIMEDefang 2.79 on 10.5.11.15
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.6.2
 (mx1.redhat.com [10.5.110.69]); Tue, 03 Sep 2019 12:08:36 +0000 (UTC)
Subject: Re: [Spice-devel] [PATCH spice-gtk v4 24/29] usb-backend: Rewrite
 USB emulation support
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: spice-devel@lists.freedesktop.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

PiAKPiBIaSwKPiAKPiBPbiA4LzI3LzE5IDEyOjIyIFBNLCBGcmVkaWFubyBaaWdsaW8gd3JvdGU6
Cj4gPiBNYWtlIGluaXRpYWxpc2F0aW9uIGVhc2llci4KPiA+IEFsd2F5cyBpbml0aWFsaXNlIHBh
cnNlci4KPiA+IEluaXRpYWxpc2UgYm90aCBwYXJzZXIgYW5kIGhvc3QgZHVyaW5nIHNwaWNlX3Vz
Yl9iYWNrZW5kX2NoYW5uZWxfbmV3Lgo+ID4gU3VwcG9ydCBub3QgaGF2aW5nIGxpYnVzYiBjb250
ZXh0IChubyBwaHlzaWNhbCBkZXZpY2VzKS4KPiA+IEF2b2lkcyB0b28gbXVjaCBzdGF0ZSB2YXJp
YWJsZXMuCj4gPiBwYXJzZXIgaXMgYWx3YXlzIGluaXRpYWxpc2VkIGFmdGVyIGNyZWF0aW9uIG1h
a2luZyBzdXJlIHRoZSBzdGF0ZQo+ID4gaXMgY29uc2lzdGVudC4KPiAKPiBJZiB1c2JyZWRpcmhv
c3QgaXMgdXNlZCwgd2h5IGlzIHRoZXJlIGEgbmVlZCBmb3IgYSBwYXJzZXIgdG9vID8KPiBBbHNv
IGJlbG93IGluIGluaXRpYWxpemVfcGFyc2VyIHRoZXJlIGlzIGEgY2hlY2sgdGhhdAo+IGNoLT51
c2JyZWRpcmhvc3QgaXMgTlVMTCAocG9zc2libHkgYmVjYXVzZSB0aGUgcGFyc2VyIGlzIGFsd2F5
cwo+IGJlaW5nIGluaXRpYWxpemVkIGJlZm9yZSB0aGUgaG9zdCkuCj4gCgpGb3IgYSBsYXJnZXIg
ZXhwbGFuYXRpb24gc2VlIGZvcm1lciBwYXRjaCBmcm9tIFl1cmkuCkZvciBhIHNob3J0ZXIgdG8g
cGFyc2UgZGF0YSBkaXJlY3RlZCB0byBlbXVsYXRlZCBkZXZpY2VzLgpTbyBob3N0IGRldmljZXMg
KHBoeXNpY2FsKSB0aHJvdWdoIHVzYnJlZGlyaG9zdCwgZW11bGF0ZWQgZGV2aWNlcwp0aHJvdWdo
IHVzYnBhcnNlci4KClRoZSBjaGVjayBmb3IgTlVMTCBhcyB0aGlzIHBhdGggaXMgc3VwcG9zZWQg
dG8gaW5pdGlhbGl6ZSB0aGUKcGFyc2Ugb25seSBpZiB1c2JyZWRpcmhvc3QgaXMgbm90IGluaXRp
YWxpemVkLgpNYXliZSB3b3VsZCBiZSB3b3RydGggYSBjb21tZW50IG9yIGFub3RoZXIgbmFtZS4g
T3IgbWF5YmUganVzdCBpbmxpbmUKaXQgbm93LCBub3QgdmVyeSBsb25nLiBXaGF0IGRvIHlvdSBz
dWdnZXN0PwoKPiA+IFVzZSBhIHNpbmdsZSBzdGF0ZSB2YXJpYWJsZSwgZGF0YSBmbG93cyBpbnRv
L2Zyb20gYSBzaW5nbGUgcGFyc2VyLgo+ID4gCj4gPiBTaWduZWQtb2ZmLWJ5OiBGcmVkaWFubyBa
aWdsaW8gPGZ6aWdsaW9AcmVkaGF0LmNvbT4KPiA+IC0tLQo+ID4gICBzcmMvdXNiLWJhY2tlbmQu
YyB8IDIzNiArKysrKysrKysrKysrKysrKysrKysrKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCj4g
PiAgIDEgZmlsZSBjaGFuZ2VkLCAxMTYgaW5zZXJ0aW9ucygrKSwgMTIwIGRlbGV0aW9ucygtKQo+
ID4gCj4gPiBkaWZmIC0tZ2l0IGEvc3JjL3VzYi1iYWNrZW5kLmMgYi9zcmMvdXNiLWJhY2tlbmQu
Ywo+ID4gaW5kZXggMzZhNzNhODkuLmQ2MTRlNjkzIDEwMDY0NAo+ID4gLS0tIGEvc3JjL3VzYi1i
YWNrZW5kLmMKPiA+ICsrKyBiL3NyYy91c2ItYmFja2VuZC5jCj4gPiBAQCAtNzgsMjEgKzc4LDIx
IEBAIHN0cnVjdCBfU3BpY2VVc2JCYWNrZW5kCj4gPiAgICAgICB1aW50MzJfdCBvd25fZGV2aWNl
c19tYXNrOwo+ID4gICB9Owo+ID4gICAKPiA+ICt0eXBlZGVmIGVudW0gewo+ID4gKyAgICBVU0Jf
Q0hBTk5FTF9TVEFURV9JTklUSUFMSVpJTkcsCj4gPiArICAgIFVTQl9DSEFOTkVMX1NUQVRFX0hP
U1QsCj4gPiArICAgIFVTQl9DSEFOTkVMX1NUQVRFX1BBUlNFUiwKPiA+ICt9IFNwaWNlVXNiQmFj
a2VuZENoYW5uZWxTdGF0ZTsKPiA+ICsKPiA+ICAgc3RydWN0IF9TcGljZVVzYkJhY2tlbmRDaGFu
bmVsCj4gPiAgIHsKPiA+ICAgICAgIHN0cnVjdCB1c2JyZWRpcmhvc3QgKnVzYnJlZGlyaG9zdDsK
PiA+IC0gICAgc3RydWN0IHVzYnJlZGlyaG9zdCAqaGlkZGVuX2hvc3Q7Cj4gPiAgICAgICBzdHJ1
Y3QgdXNicmVkaXJwYXJzZXIgKnBhcnNlcjsKPiA+IC0gICAgc3RydWN0IHVzYnJlZGlycGFyc2Vy
ICpoaWRkZW5fcGFyc2VyOwo+ID4gKyAgICBTcGljZVVzYkJhY2tlbmRDaGFubmVsU3RhdGUgc3Rh
dGU7Cj4gPiAgICAgICB1aW50OF90ICpyZWFkX2J1ZjsKPiA+ICAgICAgIGludCByZWFkX2J1Zl9z
aXplOwo+ID4gICAgICAgc3RydWN0IHVzYnJlZGlyZmlsdGVyX3J1bGUgKnJ1bGVzOwo+ID4gICAg
ICAgaW50IHJ1bGVzX2NvdW50Owo+ID4gLSAgICB1aW50MzJfdCBob3N0X2NhcHM7Cj4gPiAtICAg
IHVpbnQzMl90IHBhcnNlcl9pbml0X2RvbmUgIDogMTsKPiA+IC0gICAgdWludDMyX3QgcGFyc2Vy
X3dpdGhfaGVsbG8gOiAxOwo+ID4gLSAgICB1aW50MzJfdCBoZWxsb19kb25lX3BhcnNlciA6IDE7
Cj4gPiAtICAgIHVpbnQzMl90IGhlbGxvX3NlbnQgICAgICAgIDogMTsKPiA+ICAgICAgIHVpbnQz
Ml90IHJlamVjdGVkICAgICAgICAgIDogMTsKPiA+ICAgICAgIHVpbnQzMl90IHdhaXRfZGlzY29u
bmVjdF9hY2sgOiAxOwo+ID4gICAgICAgU3BpY2VVc2JCYWNrZW5kRGV2aWNlICphdHRhY2hlZDsK
PiA+IEBAIC00MDUsMTUgKzQwNSwxNiBAQCBmcm9tIGJvdGggdGhlIG1haW4gdGhyZWFkIGFzIHdl
bGwgYXMgZnJvbSB0aGUgdXNiCj4gPiBldmVudCBoYW5kbGluZyB0aHJlYWQgKi8KPiA+ICAgc3Rh
dGljIHZvaWQgdXNicmVkaXJfd3JpdGVfZmx1c2hfY2FsbGJhY2sodm9pZCAqdXNlcl9kYXRhKQo+
ID4gICB7Cj4gPiAgICAgICBTcGljZVVzYkJhY2tlbmRDaGFubmVsICpjaCA9IHVzZXJfZGF0YTsK
PiA+ICsgICAgaWYgKGNoLT5wYXJzZXIgPT0gTlVMTCkgewo+ID4gKyAgICAgICAgcmV0dXJuOwo+
ID4gKyAgICB9Cj4gPiAgICAgICBpZiAoaXNfY2hhbm5lbF9yZWFkeShjaC0+dXNlcl9kYXRhKSkg
ewo+ID4gLSAgICAgICAgaWYgKGNoLT51c2JyZWRpcmhvc3QpIHsKPiAKPiBEbyB5b3UgbmVlZCB0
aGUgZm9sbG93aW5nIGdfYXNzZXJ0LCBvciBpcyB0aGUgY2gtPnBhcnNlcj09TlVMTCBlbm91Z2gK
PiAgICAgZ19hc3NlcnQoY2gtPnN0YXRlICE9IFVTQl9DSEFOTkVMX1NUQVRFX0lOSVRJQUxJWklO
Ryk7Cj4gCgpXaGljaCBvbmUgYXJlIHlvdSByZWZlcnJpbmcgdG8/Cgo+ID4gKyAgICAgICAgaWYg
KGNoLT5zdGF0ZSA9PSBVU0JfQ0hBTk5FTF9TVEFURV9IT1NUKSB7Cj4gPiAgICAgICAgICAgICAg
IFNQSUNFX0RFQlVHKCIlcyBjaCAlcCAtPiB1c2JyZWRpcmhvc3QiLCBfX0ZVTkNUSU9OX18sIGNo
KTsKPiA+ICAgICAgICAgICAgICAgdXNicmVkaXJob3N0X3dyaXRlX2d1ZXN0X2RhdGEoY2gtPnVz
YnJlZGlyaG9zdCk7Cj4gPiAtICAgICAgICB9IGVsc2UgaWYgKGNoLT5wYXJzZXIpIHsKPiA+ICsg
ICAgICAgIH0gZWxzZSB7Cj4gPiAgICAgICAgICAgICAgIFNQSUNFX0RFQlVHKCIlcyBjaCAlcCAt
PiBwYXJzZXIiLCBfX0ZVTkNUSU9OX18sIGNoKTsKPiA+ICAgICAgICAgICAgICAgdXNicmVkaXJw
YXJzZXJfZG9fd3JpdGUoY2gtPnBhcnNlcik7Cj4gPiAtICAgICAgICB9IGVsc2Ugewo+ID4gLSAg
ICAgICAgICAgIFNQSUNFX0RFQlVHKCIlcyBjaCAlcCAoTk9UIEFDVElWRSkiLCBfX0ZVTkNUSU9O
X18sIGNoKTsKPiA+ICAgICAgICAgICB9Cj4gPiAgICAgICB9IGVsc2Ugewo+ID4gICAgICAgICAg
IFNQSUNFX0RFQlVHKCIlcyBjaCAlcCAobm90IHJlYWR5KSIsIF9fRlVOQ1RJT05fXywgY2gpOwo+
ID4gQEAgLTY3MywyMSArNjc0LDQyIEBAIHN0YXRpYyB2b2lkIHVzYnJlZGlyX2xvZyh2b2lkICp1
c2VyX2RhdGEsIGludCBsZXZlbCwKPiA+IGNvbnN0IGNoYXIgKm1zZykKPiA+ICAgICAgIH0KPiA+
ICAgfQo+ID4gICAKPiA+ICtzdGF0aWMgc3RydWN0IHVzYnJlZGlycGFyc2VyICpjcmVhdGVfcGFy
c2VyKFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmNoKTsKPiA+ICsKPiA+ICAgc3RhdGljIGludCB1
c2JyZWRpcl93cml0ZV9jYWxsYmFjayh2b2lkICp1c2VyX2RhdGEsIHVpbnQ4X3QgKmRhdGEsIGlu
dAo+ID4gICBjb3VudCkKPiA+ICAgewo+ID4gICAgICAgU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCAq
Y2ggPSB1c2VyX2RhdGE7Cj4gPiAgICAgICBpbnQgcmVzOwo+ID4gICAgICAgU1BJQ0VfREVCVUco
IiVzIGNoICVwLCAlZCBieXRlcyIsIF9fRlVOQ1RJT05fXywgY2gsIGNvdW50KTsKPiA+IC0gICAg
aWYgKCFjaC0+aGVsbG9fc2VudCkgewo+ID4gLSAgICAgICAgLyogaGVsbG8gaXMgc2hvcnQgaGVh
ZGVyICgxMikgKyBoZWxsbyBzdHJ1Y3QgKDY0KSArIGNhcGFiaWxpdGllcwo+ID4gKDQpICovCj4g
PiAtICAgICAgICBpbnQgaGVsbG9fc2l6ZSA9IHNpemVvZihzdHJ1Y3QgdXNiX3JlZGlyX2hlYWRl
cikgKyBzaXplb2Yoc3RydWN0Cj4gPiB1c2JfcmVkaXJfaGVsbG9faGVhZGVyKTsKPiA+IC0gICAg
ICAgIGNoLT5oZWxsb19zZW50ID0gMTsKPiA+IC0gICAgICAgIGlmIChjb3VudCA9PSBoZWxsb19z
aXplKSB7Cj4gPiAtICAgICAgICAgICAgbWVtY3B5KCZjaC0+aG9zdF9jYXBzLCBkYXRhICsgaGVs
bG9fc2l6ZSAtCj4gPiBzaXplb2YoY2gtPmhvc3RfY2FwcyksCj4gPiAtICAgICAgICAgICAgICAg
ICAgIHNpemVvZihjaC0+aG9zdF9jYXBzKSk7Cj4gPiAtICAgICAgICAgICAgU1BJQ0VfREVCVUco
IiVzIGNoICVwLCBzZW5kaW5nIGZpcnN0IGhlbGxvLCBjYXBzICUwOFgiLAo+ID4gLSAgICAgICAg
ICAgICAgICAgICAgICAgIF9fRlVOQ1RJT05fXywgY2gsIGNoLT5ob3N0X2NhcHMpOwo+ID4gKwo+
ID4gKyAgICAvLyBoYW5kbGUgZmlyc3QgcGFja2V0IChIRUxMTykgY3JlYXRpbmcgcGFyc2VyIGZy
b20gY2FwYWJpbGl0aWVzCj4gPiArICAgIGlmIChTUElDRV9VTkxJS0VMWShjaC0+cGFyc2VyID09
IE5VTEwpKSB7Cj4gPiArICAgICAgICAvLyB3ZSBhcmUgc3RpbGwgaW5pdGlhbGl6aW5nIHRoZSBo
b3N0Cj4gPiArICAgICAgICBpZiAoY2gtPnVzYnJlZGlyaG9zdCA9PSBOVUxMKSB7Cj4gPiArICAg
ICAgICAgICAgcmV0dXJuIDA7Cj4gPiAgICAgICAgICAgfQo+ID4gKwo+ID4gKyAgICAgICAgY2gt
PnBhcnNlciA9IGNyZWF0ZV9wYXJzZXIoY2gpOwo+ID4gKyAgICAgICAgaWYgKCFjaC0+cGFyc2Vy
KSB7Cj4gPiArICAgICAgICAgICAgcmV0dXJuIDA7Cj4gPiArICAgICAgICB9Cj4gPiArCj4gPiAr
ICAgICAgICAvKiBoZWxsbyBpcyBzaG9ydCBoZWFkZXIgKDEyKSArIGhlbGxvIHN0cnVjdCAoNjQp
ICovCj4gPiArICAgICAgICBjb25zdCBpbnQgaGVsbG9fc2l6ZSA9IDEyICsgc2l6ZW9mKHN0cnVj
dCB1c2JfcmVkaXJfaGVsbG9faGVhZGVyKTsKPiAKPiBzaXplb2Yoc3RydWN0IHVzYl9yZWRpcl9o
ZWFkZXIpIGluc3RlYWQgb2YgMTIgKGFuZCBidHcgaXQncyAxNikKPiAKClllcywgdGhhdCdzIHdo
eSAxMiBpcyB1c2VkLiBJdCdzIG5vdCB1c2JfcmVkaXJfaGVhZGVyIHRoYXQgeW91IHdhbnQgYnV0
IHRoZQozMiBiaXQgdmVyc2lvbiB3aGljaCBpcyBkZWZpbmVkIG9ubHkgaW50ZXJuYWxseSBpbiB1
c2JyZWRpciBjb2RlIChub3QgcHVibGljCmhlYWRlcnMpLgoKPiA+ICsgICAgICAgIGdfYXNzZXJ0
KGNvdW50ID49IGhlbGxvX3NpemUgKyA0KTsKPiAKPiBuaXQ6IE1heWJlIHJlcGxhY2UgNCB3aXRo
Cj4gICAgY29uc3Qgc2l6ZV90IGNhcHNfc2l6ZSA9IHNpemVvZih1aW50MzJfdCkgKiBVU0JfUkVE
SVJfQ0FQU19TSVpFOwo+ICAgIGdfYXNzZXJ0KGNvdW50ID49IGhlbGxvX3NpemUgKyBjYXBzX3Np
emUpOwo+IAoKVGhpcyBwb3RlbnRpYWxseSBjYW4gY3Jhc2ggaW4gdGhlIGZ1dHVyZSB3aGVuIFVT
Ql9SRURJUl9DQVBTX1NJWkUgd2lsbCBjaGFuZ2UuCkJ1dCBJIHN1cHBvc2UgeW91IGNhbiByZXBs
YWNlICI0IiB3aXRoIHNpemVvZih1aW50MzJfdCkuCgo+IAo+IFVyaS4KPiAKCkZyZWRpYW5vCl9f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClNwaWNlLWRldmVs
IG1haWxpbmcgbGlzdApTcGljZS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9s
aXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9zcGljZS1kZXZlbA==
