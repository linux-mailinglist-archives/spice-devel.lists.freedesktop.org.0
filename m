Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 22AEB24B20
	for <lists+spice-devel@lfdr.de>; Tue, 21 May 2019 11:06:01 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 2BEC089254;
	Tue, 21 May 2019 09:05:58 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 50722891A4
 for <spice-devel@lists.freedesktop.org>; Tue, 21 May 2019 09:05:57 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx03.intmail.prod.int.phx2.redhat.com
 [10.5.11.13])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id EBBAE356DB
 for <spice-devel@lists.freedesktop.org>; Tue, 21 May 2019 09:05:56 +0000 (UTC)
Received: from toolbox.mxp.redhat.com (unknown [10.32.181.168])
 by smtp.corp.redhat.com (Postfix) with ESMTP id 00A06646B4
 for <spice-devel@lists.freedesktop.org>; Tue, 21 May 2019 09:05:55 +0000 (UTC)
From: Victor Toso <victortoso@redhat.com>
To: spice-devel@lists.freedesktop.org
Date: Tue, 21 May 2019 09:05:51 +0000
Message-Id: <20190521090552.2310-4-victortoso@redhat.com>
In-Reply-To: <20190521090552.2310-1-victortoso@redhat.com>
References: <20190521090552.2310-1-victortoso@redhat.com>
MIME-Version: 1.0
X-Scanned-By: MIMEDefang 2.79 on 10.5.11.13
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16
 (mx1.redhat.com [10.5.110.30]); Tue, 21 May 2019 09:05:56 +0000 (UTC)
Subject: [Spice-devel] [spice-gtk v1 3/4] usb-redirection: isolate usage of
 libusb and usbredirhost
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

RnJvbTogWXVyaSBCZW5kaXRvdmljaCA8eXVyaS5iZW5kaXRvdmljaEBkYXluaXguY29tPgoKQXMg
YSBzdGVwIHRvd2FyZCBwb3NzaWJpbGl0eSB0byBwcmVzZW50IGVtdWxhdGVkIFVTQiBkZXZpY2Vz
CnRvIHRoZSBndWVzdCwgd2UgcmVtb3ZlIHRoZSBrbm93bGVkZ2UgYWJvdXQgbGlidXNiIGFuZAp1
c2JyZWRpcmhvc3QgKHdoaWNoIGRlcGVuZHMgb24gbGlidXNiKSBmcm9tIGFsbCB0aGUgbW9kdWxl
cwphbmQgY29uY2VudHJhdGUgaXQgaW4gb25lICh1c2IgYmFja2VuZCkgd2hpY2ggcHJlc2VudHMK
YWJzdHJhY3QgVVNCIG9iamVjdHMgYW5kIGludGVybmFsIEFQSSB0byBhbGwgb3RoZXIgbW9kdWxl
cy4KClNpZ25lZC1vZmYtYnk6IFl1cmkgQmVuZGl0b3ZpY2ggPHl1cmkuYmVuZGl0b3ZpY2hAZGF5
bml4LmNvbT4KLS0tCiBzcmMvTWFrZWZpbGUuYW0gICAgICAgICAgICAgICB8ICAgMiArCiBzcmMv
Y2hhbm5lbC11c2JyZWRpci1wcml2LmggICB8ICAgOSArLQogc3JjL2NoYW5uZWwtdXNicmVkaXIu
YyAgICAgICAgfCAyMTYgKysrLS0tLS0tLS0tCiBzcmMvbWVzb24uYnVpbGQgICAgICAgICAgICAg
ICB8ICAgMiArCiBzcmMvdXNiLWJhY2tlbmQuYyAgICAgICAgICAgICB8IDYyMiArKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrCiBzcmMvdXNiLWJhY2tlbmQuaCAgICAgICAgICAgICB8
IDExMCArKysrKysKIHNyYy91c2ItZGV2aWNlLW1hbmFnZXItcHJpdi5oIHwgICAxIC0KIHNyYy91
c2ItZGV2aWNlLW1hbmFnZXIuYyAgICAgIHwgMzM2ICsrKysrKy0tLS0tLS0tLS0tLQogc3JjL3Vz
YnV0aWwuaCAgICAgICAgICAgICAgICAgfCAgIDEgLQogc3JjL3dpbi11c2ItZGV2LmMgICAgICAg
ICAgICAgfCAxMDMgKystLS0tCiBzcmMvd2luLXVzYi1kZXYuaCAgICAgICAgICAgICB8ICAgNSAr
LQogMTEgZmlsZXMgY2hhbmdlZCwgOTI5IGluc2VydGlvbnMoKyksIDQ3OCBkZWxldGlvbnMoLSkK
IGNyZWF0ZSBtb2RlIDEwMDY0NCBzcmMvdXNiLWJhY2tlbmQuYwogY3JlYXRlIG1vZGUgMTAwNjQ0
IHNyYy91c2ItYmFja2VuZC5oCgpkaWZmIC0tZ2l0IGEvc3JjL01ha2VmaWxlLmFtIGIvc3JjL01h
a2VmaWxlLmFtCmluZGV4IDdhN2VjYjQuLmJlYTQxMDAgMTAwNjQ0Ci0tLSBhL3NyYy9NYWtlZmls
ZS5hbQorKysgYi9zcmMvTWFrZWZpbGUuYW0KQEAgLTI2NCw2ICsyNjQsOCBAQCBsaWJzcGljZV9j
bGllbnRfZ2xpYl9pbXBsX2xhX1NPVVJDRVMgPQkJCVwKIAlzcGljZS11cmktcHJpdi5oCQkJCVwK
IAl1c2ItZGV2aWNlLW1hbmFnZXIuYwkJCQlcCiAJdXNiLWRldmljZS1tYW5hZ2VyLXByaXYuaAkJ
CVwKKwl1c2ItYmFja2VuZC5jCQkJCQlcCisJdXNiLWJhY2tlbmQuaAkJCQkJXAogCXVzYnV0aWwu
YwkJCQkJXAogCXVzYnV0aWwuaAkJCQkJXAogCSQoVVNCX0FDTF9IRUxQRVJfU1JDUykJCQkJXApk
aWZmIC0tZ2l0IGEvc3JjL2NoYW5uZWwtdXNicmVkaXItcHJpdi5oIGIvc3JjL2NoYW5uZWwtdXNi
cmVkaXItcHJpdi5oCmluZGV4IDFlYThhMTkuLmI4MjExNzAgMTAwNjQ0Ci0tLSBhL3NyYy9jaGFu
bmVsLXVzYnJlZGlyLXByaXYuaAorKysgYi9zcmMvY2hhbm5lbC11c2JyZWRpci1wcml2LmgKQEAg
LTIzLDkgKzIzLDggQEAKIAogI2lmZGVmIFVTRV9VU0JSRURJUgogCi0jaW5jbHVkZSA8bGlidXNi
Lmg+Ci0jaW5jbHVkZSA8dXNicmVkaXJmaWx0ZXIuaD4KICNpbmNsdWRlICJzcGljZS1jbGllbnQu
aCIKKyNpbmNsdWRlICJ1c2ItYmFja2VuZC5oIgogCiBHX0JFR0lOX0RFQ0xTCiAKQEAgLTMzLDcg
KzMyLDcgQEAgR19CRUdJTl9ERUNMUwogICAgY29udGV4dCBzaG91bGQgbm90IGJlIGRlc3Ryb3ll
ZCBiZWZvcmUgdGhlIGxhc3QgZGV2aWNlIGhhcyBiZWVuCiAgICBkaXNjb25uZWN0ZWQgKi8KIHZv
aWQgc3BpY2VfdXNicmVkaXJfY2hhbm5lbF9zZXRfY29udGV4dChTcGljZVVzYnJlZGlyQ2hhbm5l
bCAqY2hhbm5lbCwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWJ1
c2JfY29udGV4dCAgICAgICAqY29udGV4dCk7CisgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgU3BpY2VVc2JCYWNrZW5kICAgICAgKmNvbnRleHQpOwogCiB2b2lkIHNwaWNl
X3VzYnJlZGlyX2NoYW5uZWxfZGlzY29ubmVjdF9kZXZpY2VfYXN5bmMoU3BpY2VVc2JyZWRpckNo
YW5uZWwgKmNoYW5uZWwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgR0NhbmNlbGxhYmxlICpjYW5jZWxsYWJsZSwKQEAgLTQ4LDcgKzQ3LDcgQEAg
Z2Jvb2xlYW4gc3BpY2VfdXNicmVkaXJfY2hhbm5lbF9kaXNjb25uZWN0X2RldmljZV9maW5pc2go
U3BpY2VVc2JyZWRpckNoYW5uZWwgKmMKICAgICh0aHJvdWdoIHNwaWNlX2NoYW5uZWxfY29ubmVj
dCgpKSwgYmVmb3JlIGNhbGxpbmcgdGhpcy4gKi8KIHZvaWQgc3BpY2VfdXNicmVkaXJfY2hhbm5l
bF9jb25uZWN0X2RldmljZV9hc3luYygKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBTcGljZVVzYnJlZGlyQ2hhbm5lbCAqY2hhbm5lbCwKLSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBsaWJ1c2JfZGV2aWNlICAgICAgICAqZGV2aWNlLAorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNwaWNlVXNiQmFja2VuZERldmlj
ZSAqZGV2aWNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNwaWNl
VXNiRGV2aWNlICAgICAgICpzcGljZV9kZXZpY2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgR0NhbmNlbGxhYmxlICAgICAgICAgKmNhbmNlbGxhYmxlLAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdBc3luY1JlYWR5Q2FsbGJhY2sgICBj
YWxsYmFjaywKQEAgLTYwLDcgKzU5LDcgQEAgZ2Jvb2xlYW4gc3BpY2VfdXNicmVkaXJfY2hhbm5l
bF9jb25uZWN0X2RldmljZV9maW5pc2goCiAKIHZvaWQgc3BpY2VfdXNicmVkaXJfY2hhbm5lbF9k
aXNjb25uZWN0X2RldmljZShTcGljZVVzYnJlZGlyQ2hhbm5lbCAqY2hhbm5lbCk7CiAKLWxpYnVz
Yl9kZXZpY2UgKnNwaWNlX3VzYnJlZGlyX2NoYW5uZWxfZ2V0X2RldmljZShTcGljZVVzYnJlZGly
Q2hhbm5lbCAqY2hhbm5lbCk7CitTcGljZVVzYkJhY2tlbmREZXZpY2UgKnNwaWNlX3VzYnJlZGly
X2NoYW5uZWxfZ2V0X2RldmljZShTcGljZVVzYnJlZGlyQ2hhbm5lbCAqY2hhbm5lbCk7CiAKIHZv
aWQgc3BpY2VfdXNicmVkaXJfY2hhbm5lbF9sb2NrKFNwaWNlVXNicmVkaXJDaGFubmVsICpjaGFu
bmVsKTsKIApkaWZmIC0tZ2l0IGEvc3JjL2NoYW5uZWwtdXNicmVkaXIuYyBiL3NyYy9jaGFubmVs
LXVzYnJlZGlyLmMKaW5kZXggMDc5YTk3Ni4uM2UwODM4YyAxMDA2NDQKLS0tIGEvc3JjL2NoYW5u
ZWwtdXNicmVkaXIuYworKysgYi9zcmMvY2hhbm5lbC11c2JyZWRpci5jCkBAIC0yMyw3ICsyMyw2
IEBACiAKICNpZmRlZiBVU0VfVVNCUkVESVIKICNpbmNsdWRlIDxnbGliL2dpMThuLWxpYi5oPgot
I2luY2x1ZGUgPHVzYnJlZGlyaG9zdC5oPgogI2lmZGVmIFVTRV9MWjQKICNpbmNsdWRlIDxsejQu
aD4KICNlbmRpZgpAQCAtNjMsMTUgKzYyLDEyIEBAIGVudW0gU3BpY2VVc2JyZWRpckNoYW5uZWxT
dGF0ZSB7CiB9OwogCiBzdHJ1Y3QgX1NwaWNlVXNicmVkaXJDaGFubmVsUHJpdmF0ZSB7Ci0gICAg
bGlidXNiX2RldmljZSAqZGV2aWNlOworICAgIFNwaWNlVXNiQmFja2VuZERldmljZSAqZGV2aWNl
OwogICAgIFNwaWNlVXNiRGV2aWNlICpzcGljZV9kZXZpY2U7Ci0gICAgbGlidXNiX2NvbnRleHQg
KmNvbnRleHQ7Ci0gICAgc3RydWN0IHVzYnJlZGlyaG9zdCAqaG9zdDsKKyAgICBTcGljZVVzYkJh
Y2tlbmQgKmNvbnRleHQ7CisgICAgU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCAqaG9zdDsKICAgICAv
KiBUbyBjYXRjaCB1c2JyZWRpcmhvc3QgZXJyb3IgbWVzc2FnZXMgYW5kIHJlcG9ydCB0aGVtIGFz
IGEgR0Vycm9yICovCiAgICAgR0Vycm9yICoqY2F0Y2hfZXJyb3I7Ci0gICAgLyogRGF0YSBwYXNz
ZWQgZnJvbSBjaGFubmVsIGhhbmRsZSBtc2cgdG8gdGhlIHVzYnJlZGlyaG9zdCByZWFkIGNiICov
Ci0gICAgY29uc3QgdWludDhfdCAqcmVhZF9idWY7Ci0gICAgaW50IHJlYWRfYnVmX3NpemU7CiAg
ICAgZW51bSBTcGljZVVzYnJlZGlyQ2hhbm5lbFN0YXRlIHN0YXRlOwogI2lmZGVmIFVTRV9QT0xL
SVQKICAgICBHVGFzayAqdGFzazsKQEAgLTg3LDE2ICs4Myw5IEBAIHN0YXRpYyB2b2lkIHNwaWNl
X3VzYnJlZGlyX2NoYW5uZWxfZGlzcG9zZShHT2JqZWN0ICpvYmopOwogc3RhdGljIHZvaWQgc3Bp
Y2VfdXNicmVkaXJfY2hhbm5lbF9maW5hbGl6ZShHT2JqZWN0ICpvYmopOwogc3RhdGljIHZvaWQg
dXNicmVkaXJfaGFuZGxlX21zZyhTcGljZUNoYW5uZWwgKmNoYW5uZWwsIFNwaWNlTXNnSW4gKmlu
KTsKIAotc3RhdGljIHZvaWQgdXNicmVkaXJfbG9nKHZvaWQgKnVzZXJfZGF0YSwgaW50IGxldmVs
LCBjb25zdCBjaGFyICptc2cpOwotc3RhdGljIGludCB1c2JyZWRpcl9yZWFkX2NhbGxiYWNrKHZv
aWQgKnVzZXJfZGF0YSwgdWludDhfdCAqZGF0YSwgaW50IGNvdW50KTsKIHN0YXRpYyBpbnQgdXNi
cmVkaXJfd3JpdGVfY2FsbGJhY2sodm9pZCAqdXNlcl9kYXRhLCB1aW50OF90ICpkYXRhLCBpbnQg
Y291bnQpOwotc3RhdGljIHZvaWQgdXNicmVkaXJfd3JpdGVfZmx1c2hfY2FsbGJhY2sodm9pZCAq
dXNlcl9kYXRhKTsKLXN0YXRpYyB1aW50NjRfdCB1c2JyZWRpcl9idWZmZXJlZF9vdXRwdXRfc2l6
ZV9jYWxsYmFjayh2b2lkICp1c2VyX2RhdGEpOwotCi1zdGF0aWMgdm9pZCAqdXNicmVkaXJfYWxs
b2NfbG9jayh2b2lkKTsKLXN0YXRpYyB2b2lkIHVzYnJlZGlyX2xvY2tfbG9jayh2b2lkICp1c2Vy
X2RhdGEpOwotc3RhdGljIHZvaWQgdXNicmVkaXJfdW5sb2NrX2xvY2sodm9pZCAqdXNlcl9kYXRh
KTsKLXN0YXRpYyB2b2lkIHVzYnJlZGlyX2ZyZWVfbG9jayh2b2lkICp1c2VyX2RhdGEpOworc3Rh
dGljIGdib29sZWFuIHVzYnJlZGlyX2lzX2NoYW5uZWxfcmVhZHkodm9pZCAqdXNlcl9kYXRhKTsK
K3N0YXRpYyB1aW50NjRfdCB1c2JyZWRpcl9nZXRfcXVldWVfc2l6ZSh2b2lkICp1c2VyX2RhdGEp
OwogCiBHX0RFRklORV9UWVBFX1dJVEhfUFJJVkFURShTcGljZVVzYnJlZGlyQ2hhbm5lbCwgc3Bp
Y2VfdXNicmVkaXJfY2hhbm5lbCwgU1BJQ0VfVFlQRV9DSEFOTkVMKQogCkBAIC0xMTUsNyArMTA0
LDcgQEAgc3RhdGljIHZvaWQgX2NoYW5uZWxfcmVzZXRfZmluaXNoKFNwaWNlVXNicmVkaXJDaGFu
bmVsICpjaGFubmVsLCBnYm9vbGVhbiBtaWdyYXQKIAogICAgIHNwaWNlX3VzYnJlZGlyX2NoYW5u
ZWxfbG9jayhjaGFubmVsKTsKIAotICAgIHVzYnJlZGlyaG9zdF9jbG9zZShwcml2LT5ob3N0KTsK
KyAgICBzcGljZV91c2JfYmFja2VuZF9jaGFubmVsX2RlbGV0ZShwcml2LT5ob3N0KTsKICAgICBw
cml2LT5ob3N0ID0gTlVMTDsKIAogICAgIC8qIENhbGwgc2V0X2NvbnRleHQgdG8gcmUtY3JlYXRl
IHRoZSBob3N0ICovCkBAIC0yMjEsNyArMjEwLDcgQEAgc3RhdGljIHZvaWQgc3BpY2VfdXNicmVk
aXJfY2hhbm5lbF9maW5hbGl6ZShHT2JqZWN0ICpvYmopCiAgICAgU3BpY2VVc2JyZWRpckNoYW5u
ZWwgKmNoYW5uZWwgPSBTUElDRV9VU0JSRURJUl9DSEFOTkVMKG9iaik7CiAKICAgICBpZiAoY2hh
bm5lbC0+cHJpdi0+aG9zdCkKLSAgICAgICAgdXNicmVkaXJob3N0X2Nsb3NlKGNoYW5uZWwtPnBy
aXYtPmhvc3QpOworICAgICAgICBzcGljZV91c2JfYmFja2VuZF9jaGFubmVsX2RlbGV0ZShjaGFu
bmVsLT5wcml2LT5ob3N0KTsKICAgICBnX211dGV4X2NsZWFyKCZjaGFubmVsLT5wcml2LT5kZXZp
Y2VfY29ubmVjdF9tdXRleCk7CiAKICAgICAvKiBDaGFpbiB1cCB0byB0aGUgcGFyZW50IGNsYXNz
ICovCkBAIC0yNDQsMzAgKzIzMywyMiBAQCBzdGF0aWMgdm9pZCBjaGFubmVsX3NldF9oYW5kbGVy
cyhTcGljZUNoYW5uZWxDbGFzcyAqa2xhc3MpCiAKIEdfR05VQ19JTlRFUk5BTAogdm9pZCBzcGlj
ZV91c2JyZWRpcl9jaGFubmVsX3NldF9jb250ZXh0KFNwaWNlVXNicmVkaXJDaGFubmVsICpjaGFu
bmVsLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpYnVzYl9jb250
ZXh0ICAgICAgICpjb250ZXh0KQorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIFNwaWNlVXNiQmFja2VuZCAgICAgICpjb250ZXh0KQogewogICAgIFNwaWNlVXNicmVkaXJD
aGFubmVsUHJpdmF0ZSAqcHJpdiA9IGNoYW5uZWwtPnByaXY7CisgICAgU3BpY2VVc2JCYWNrZW5k
Q2hhbm5lbEluaXREYXRhIGluaXRfZGF0YTsKKyAgICBpbml0X2RhdGEudXNlcl9kYXRhID0gY2hh
bm5lbDsKKyAgICBpbml0X2RhdGEuZ2V0X3F1ZXVlX3NpemUgPSB1c2JyZWRpcl9nZXRfcXVldWVf
c2l6ZTsKKyAgICBpbml0X2RhdGEuaXNfY2hhbm5lbF9yZWFkeSA9IHVzYnJlZGlyX2lzX2NoYW5u
ZWxfcmVhZHk7CisgICAgaW5pdF9kYXRhLndyaXRlX2NhbGxiYWNrID0gdXNicmVkaXJfd3JpdGVf
Y2FsbGJhY2s7CiAKICAgICBnX3JldHVybl9pZl9mYWlsKHByaXYtPmhvc3QgPT0gTlVMTCk7CiAK
ICAgICBwcml2LT5jb250ZXh0ID0gY29udGV4dDsKLSAgICBwcml2LT5ob3N0ID0gdXNicmVkaXJo
b3N0X29wZW5fZnVsbCgKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4
dCwgTlVMTCwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNicmVkaXJfbG9n
LAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2JyZWRpcl9yZWFkX2NhbGxi
YWNrLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2JyZWRpcl93cml0ZV9j
YWxsYmFjaywKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNicmVkaXJfd3Jp
dGVfZmx1c2hfY2FsbGJhY2ssCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVz
YnJlZGlyX2FsbG9jX2xvY2ssCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVz
YnJlZGlyX2xvY2tfbG9jaywKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNi
cmVkaXJfdW5sb2NrX2xvY2ssCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVz
YnJlZGlyX2ZyZWVfbG9jaywKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hh
bm5lbCwgUEFDS0FHRV9TVFJJTkcsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHNwaWNlX3V0aWxfZ2V0X2RlYnVnKCkgPyB1c2JyZWRpcnBhcnNlcl9kZWJ1ZyA6IHVzYnJlZGly
cGFyc2VyX3dhcm5pbmcsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzYnJl
ZGlyaG9zdF9mbF93cml0ZV9jYl9vd25zX2J1ZmZlcik7CisgICAgcHJpdi0+aG9zdCA9IHNwaWNl
X3VzYl9iYWNrZW5kX2NoYW5uZWxfbmV3KGNvbnRleHQsICZpbml0X2RhdGEpOwogICAgIGlmICgh
cHJpdi0+aG9zdCkKLSAgICAgICAgZ19lcnJvcigiT3V0IG9mIG1lbW9yeSBhbGxvY2F0aW5nIHVz
YnJlZGlyaG9zdCIpOworICAgICAgICBnX2Vycm9yKCJPdXQgb2YgbWVtb3J5IGluaXRpYWxpemlu
ZyByZWRpcmVjdGlvbiBzdXBwb3J0Iik7CiAKLSAgICB1c2JyZWRpcmhvc3Rfc2V0X2J1ZmZlcmVk
X291dHB1dF9zaXplX2NiKHByaXYtPmhvc3QsIHVzYnJlZGlyX2J1ZmZlcmVkX291dHB1dF9zaXpl
X2NhbGxiYWNrKTsKICNpZmRlZiBVU0VfTFo0CiAgICAgc3BpY2VfY2hhbm5lbF9zZXRfY2FwYWJp
bGl0eShjaGFubmVsLCBTUElDRV9TUElDRVZNQ19DQVBfREFUQV9DT01QUkVTU19MWjQpOwogI2Vu
ZGlmCkBAIC0yNzgsOCArMjU5LDYgQEAgc3RhdGljIGdib29sZWFuIHNwaWNlX3VzYnJlZGlyX2No
YW5uZWxfb3Blbl9kZXZpY2UoCiB7CiAgICAgU3BpY2VVc2JyZWRpckNoYW5uZWxQcml2YXRlICpw
cml2ID0gY2hhbm5lbC0+cHJpdjsKICAgICBTcGljZVNlc3Npb24gKnNlc3Npb247Ci0gICAgbGli
dXNiX2RldmljZV9oYW5kbGUgKmhhbmRsZSA9IE5VTEw7Ci0gICAgaW50IHJjLCBzdGF0dXM7CiAg
ICAgU3BpY2VVc2JEZXZpY2VNYW5hZ2VyICptYW5hZ2VyOwogCiAgICAgZ19yZXR1cm5fdmFsX2lm
X2ZhaWwocHJpdi0+c3RhdGUgPT0gU1RBVEVfRElTQ09OTkVDVEVECkBAIC0yODgsMTkgKzI2Nywx
MSBAQCBzdGF0aWMgZ2Jvb2xlYW4gc3BpY2VfdXNicmVkaXJfY2hhbm5lbF9vcGVuX2RldmljZSgK
ICNlbmRpZgogICAgICAgICAgICAgICAgICAgICAgICAgICwgRkFMU0UpOwogCi0gICAgcmMgPSBs
aWJ1c2Jfb3Blbihwcml2LT5kZXZpY2UsICZoYW5kbGUpOwotICAgIGlmIChyYyAhPSAwKSB7Ci0g
ICAgICAgIGdfc2V0X2Vycm9yKGVyciwgU1BJQ0VfQ0xJRU5UX0VSUk9SLCBTUElDRV9DTElFTlRf
RVJST1JfRkFJTEVELAotICAgICAgICAgICAgICAgICAgICAiQ291bGQgbm90IG9wZW4gdXNiIGRl
dmljZTogJXMgWyVpXSIsCi0gICAgICAgICAgICAgICAgICAgIGxpYnVzYl9lcnJvcl9uYW1lKHJj
KSwgcmMpOwotICAgICAgICByZXR1cm4gRkFMU0U7Ci0gICAgfQotCi0gICAgcHJpdi0+Y2F0Y2hf
ZXJyb3IgPSBlcnI7Ci0gICAgc3RhdHVzID0gdXNicmVkaXJob3N0X3NldF9kZXZpY2UocHJpdi0+
aG9zdCwgaGFuZGxlKTsKLSAgICBwcml2LT5jYXRjaF9lcnJvciA9IE5VTEw7Ci0gICAgaWYgKHN0
YXR1cyAhPSB1c2JfcmVkaXJfc3VjY2VzcykgewotICAgICAgICBnX3JldHVybl92YWxfaWZfZmFp
bChlcnIgPT0gTlVMTCB8fCAqZXJyICE9IE5VTEwsIEZBTFNFKTsKKyAgICBpZiAoIXNwaWNlX3Vz
Yl9iYWNrZW5kX2NoYW5uZWxfYXR0YWNoKHByaXYtPmhvc3QsIHByaXYtPmRldmljZSwgZXJyKSkg
eworICAgICAgICBpZiAoKmVyciA9PSBOVUxMKSB7CisgICAgICAgICAgICBnX3NldF9lcnJvcihl
cnIsIFNQSUNFX0NMSUVOVF9FUlJPUiwgU1BJQ0VfQ0xJRU5UX0VSUk9SX0ZBSUxFRCwKKyAgICAg
ICAgICAgICAgICAiRXJyb3IgYXR0YWNoaW5nIGRldmljZTogKG5vIGVycm9yIGluZm9ybWF0aW9u
KSIpOworICAgICAgICB9CiAgICAgICAgIHJldHVybiBGQUxTRTsKICAgICB9CiAKQEAgLTMxMCw3
ICsyODEsNyBAQCBzdGF0aWMgZ2Jvb2xlYW4gc3BpY2VfdXNicmVkaXJfY2hhbm5lbF9vcGVuX2Rl
dmljZSgKIAogICAgIHByaXYtPnVzYl9kZXZpY2VfbWFuYWdlciA9IGdfb2JqZWN0X3JlZihtYW5h
Z2VyKTsKICAgICBpZiAoIXNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9zdGFydF9ldmVudF9saXN0
ZW5pbmcocHJpdi0+dXNiX2RldmljZV9tYW5hZ2VyLCBlcnIpKSB7Ci0gICAgICAgIHVzYnJlZGly
aG9zdF9zZXRfZGV2aWNlKHByaXYtPmhvc3QsIE5VTEwpOworICAgICAgICBzcGljZV91c2JfYmFj
a2VuZF9jaGFubmVsX2RldGFjaChwcml2LT5ob3N0KTsKICAgICAgICAgcmV0dXJuIEZBTFNFOwog
ICAgIH0KIApAQCAtMzQxLDggKzMxMiw3IEBAIHN0YXRpYyB2b2lkIHNwaWNlX3VzYnJlZGlyX2No
YW5uZWxfb3Blbl9hY2xfY2IoCiAgICAgICAgIHNwaWNlX3VzYnJlZGlyX2NoYW5uZWxfb3Blbl9k
ZXZpY2UoY2hhbm5lbCwgJmVycik7CiAgICAgfQogICAgIGlmIChlcnIpIHsKLSAgICAgICAgbGli
dXNiX3VucmVmX2RldmljZShwcml2LT5kZXZpY2UpOwotICAgICAgICBwcml2LT5kZXZpY2UgPSBO
VUxMOworICAgICAgICBnX2NsZWFyX3BvaW50ZXIoJnByaXYtPmRldmljZSwgc3BpY2VfdXNiX2Jh
Y2tlbmRfZGV2aWNlX3VucmVmKTsKICAgICAgICAgZ19ib3hlZF9mcmVlKHNwaWNlX3VzYl9kZXZp
Y2VfZ2V0X3R5cGUoKSwgcHJpdi0+c3BpY2VfZGV2aWNlKTsKICAgICAgICAgcHJpdi0+c3BpY2Vf
ZGV2aWNlID0gTlVMTDsKICAgICAgICAgcHJpdi0+c3RhdGUgID0gU1RBVEVfRElTQ09OTkVDVEVE
OwpAQCAtMzczLDggKzM0Myw3IEBAIF9vcGVuX2RldmljZV9hc3luY19jYihHVGFzayAqdGFzaywK
ICAgICBzcGljZV91c2JyZWRpcl9jaGFubmVsX2xvY2soY2hhbm5lbCk7CiAKICAgICBpZiAoIXNw
aWNlX3VzYnJlZGlyX2NoYW5uZWxfb3Blbl9kZXZpY2UoY2hhbm5lbCwgJmVycikpIHsKLSAgICAg
ICAgbGlidXNiX3VucmVmX2RldmljZShwcml2LT5kZXZpY2UpOwotICAgICAgICBwcml2LT5kZXZp
Y2UgPSBOVUxMOworICAgICAgICBnX2NsZWFyX3BvaW50ZXIoJnByaXYtPmRldmljZSwgc3BpY2Vf
dXNiX2JhY2tlbmRfZGV2aWNlX3VucmVmKTsKICAgICAgICAgZ19ib3hlZF9mcmVlKHNwaWNlX3Vz
Yl9kZXZpY2VfZ2V0X3R5cGUoKSwgcHJpdi0+c3BpY2VfZGV2aWNlKTsKICAgICAgICAgcHJpdi0+
c3BpY2VfZGV2aWNlID0gTlVMTDsKICAgICB9CkBAIC0zOTIsMTMgKzM2MSwxNiBAQCBfb3Blbl9k
ZXZpY2VfYXN5bmNfY2IoR1Rhc2sgKnRhc2ssCiBHX0dOVUNfSU5URVJOQUwKIHZvaWQgc3BpY2Vf
dXNicmVkaXJfY2hhbm5lbF9jb25uZWN0X2RldmljZV9hc3luYygKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIFNwaWNlVXNicmVkaXJDaGFubmVsICpjaGFubmVsLAot
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlidXNiX2RldmljZSAg
ICAgICAgKmRldmljZSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IFNwaWNlVXNiQmFja2VuZERldmljZSAqZGV2aWNlLAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgU3BpY2VVc2JEZXZpY2UgICAgICAgKnNwaWNlX2RldmljZSwKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdDYW5jZWxsYWJsZSAgICAg
ICAgICpjYW5jZWxsYWJsZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIEdBc3luY1JlYWR5Q2FsbGJhY2sgICBjYWxsYmFjaywKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGdwb2ludGVyICAgICAgICAgICAgICB1c2VyX2RhdGEpCiB7
CiAgICAgU3BpY2VVc2JyZWRpckNoYW5uZWxQcml2YXRlICpwcml2ID0gY2hhbm5lbC0+cHJpdjsK
KyNpZmRlZiBVU0VfUE9MS0lUCisgICAgY29uc3QgVXNiRGV2aWNlSW5mb3JtYXRpb24gKmluZm8g
PSBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfZ2V0X2luZm8oZGV2aWNlKTsKKyNlbmRpZgogICAg
IEdUYXNrICp0YXNrOwogCiAgICAgZ19yZXR1cm5faWZfZmFpbChTUElDRV9JU19VU0JSRURJUl9D
SEFOTkVMKGNoYW5uZWwpKTsKQEAgLTQyNSw3ICszOTcsNyBAQCB2b2lkIHNwaWNlX3VzYnJlZGly
X2NoYW5uZWxfY29ubmVjdF9kZXZpY2VfYXN5bmMoCiAgICAgICAgIGdvdG8gZG9uZTsKICAgICB9
CiAKLSAgICBwcml2LT5kZXZpY2UgPSBsaWJ1c2JfcmVmX2RldmljZShkZXZpY2UpOworICAgIHBy
aXYtPmRldmljZSA9IHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9yZWYoZGV2aWNlKTsKICAgICBw
cml2LT5zcGljZV9kZXZpY2UgPSBnX2JveGVkX2NvcHkoc3BpY2VfdXNiX2RldmljZV9nZXRfdHlw
ZSgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcGljZV9kZXZpY2Up
OwogI2lmZGVmIFVTRV9QT0xLSVQKQEAgLTQzNSw4ICs0MDcsOCBAQCB2b2lkIHNwaWNlX3VzYnJl
ZGlyX2NoYW5uZWxfY29ubmVjdF9kZXZpY2VfYXN5bmMoCiAgICAgZ19vYmplY3Rfc2V0KHNwaWNl
X2NoYW5uZWxfZ2V0X3Nlc3Npb24oU1BJQ0VfQ0hBTk5FTChjaGFubmVsKSksCiAgICAgICAgICAg
ICAgICAgICJpbmhpYml0LWtleWJvYXJkLWdyYWIiLCBUUlVFLCBOVUxMKTsKICAgICBzcGljZV91
c2JfYWNsX2hlbHBlcl9vcGVuX2FjbF9hc3luYyhwcml2LT5hY2xfaGVscGVyLAotICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpYnVzYl9nZXRfYnVzX251bWJlcihkZXZp
Y2UpLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpYnVzYl9nZXRf
ZGV2aWNlX2FkZHJlc3MoZGV2aWNlKSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBpbmZvLT5idXMsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgaW5mby0+YWRkcmVzcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBjYW5jZWxsYWJsZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBz
cGljZV91c2JyZWRpcl9jaGFubmVsX29wZW5fYWNsX2NiLAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGNoYW5uZWwpOwpAQCAtNDk0LDkgKzQ2Niw4IEBAIHZvaWQgc3Bp
Y2VfdXNicmVkaXJfY2hhbm5lbF9kaXNjb25uZWN0X2RldmljZShTcGljZVVzYnJlZGlyQ2hhbm5l
bCAqY2hhbm5lbCkKICAgICAgICAgZ19jbGVhcl9vYmplY3QoJnByaXYtPnVzYl9kZXZpY2VfbWFu
YWdlcik7CiAKICAgICAgICAgLyogVGhpcyBhbHNvIGNsb3NlcyB0aGUgbGlidXNiIGhhbmRsZSB3
ZSBwYXNzZWQgZnJvbSBvcGVuX2RldmljZSAqLwotICAgICAgICB1c2JyZWRpcmhvc3Rfc2V0X2Rl
dmljZShwcml2LT5ob3N0LCBOVUxMKTsKLSAgICAgICAgbGlidXNiX3VucmVmX2RldmljZShwcml2
LT5kZXZpY2UpOwotICAgICAgICBwcml2LT5kZXZpY2UgPSBOVUxMOworICAgICAgICBzcGljZV91
c2JfYmFja2VuZF9jaGFubmVsX2RldGFjaChwcml2LT5ob3N0KTsKKyAgICAgICAgZ19jbGVhcl9w
b2ludGVyKCZwcml2LT5kZXZpY2UsIHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV91bnJlZik7CiAg
ICAgICAgIGdfYm94ZWRfZnJlZShzcGljZV91c2JfZGV2aWNlX2dldF90eXBlKCksIHByaXYtPnNw
aWNlX2RldmljZSk7CiAgICAgICAgIHByaXYtPnNwaWNlX2RldmljZSA9IE5VTEw7CiAgICAgICAg
IHByaXYtPnN0YXRlICA9IFNUQVRFX0RJU0NPTk5FQ1RFRDsKQEAgLTU0Nyw3ICs1MTgsNyBAQCBz
cGljZV91c2JyZWRpcl9jaGFubmVsX2dldF9zcGljZV91c2JfZGV2aWNlKFNwaWNlVXNicmVkaXJD
aGFubmVsICpjaGFubmVsKQogI2VuZGlmCiAKIEdfR05VQ19JTlRFUk5BTAotbGlidXNiX2Rldmlj
ZSAqc3BpY2VfdXNicmVkaXJfY2hhbm5lbF9nZXRfZGV2aWNlKFNwaWNlVXNicmVkaXJDaGFubmVs
ICpjaGFubmVsKQorU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpzcGljZV91c2JyZWRpcl9jaGFubmVs
X2dldF9kZXZpY2UoU3BpY2VVc2JyZWRpckNoYW5uZWwgKmNoYW5uZWwpCiB7CiAgICAgcmV0dXJu
IGNoYW5uZWwtPnByaXYtPmRldmljZTsKIH0KQEAgLTU2Miw4MyArNTMzLDI0IEBAIHZvaWQgc3Bp
Y2VfdXNicmVkaXJfY2hhbm5lbF9nZXRfZ3Vlc3RfZmlsdGVyKAogCiAgICAgZ19yZXR1cm5faWZf
ZmFpbChwcml2LT5ob3N0ICE9IE5VTEwpOwogCi0gICAgdXNicmVkaXJob3N0X2dldF9ndWVzdF9m
aWx0ZXIocHJpdi0+aG9zdCwgcnVsZXNfcmV0LCBydWxlc19jb3VudF9yZXQpOworICAgIHNwaWNl
X3VzYl9iYWNrZW5kX2NoYW5uZWxfZ2V0X2d1ZXN0X2ZpbHRlcihwcml2LT5ob3N0LCBydWxlc19y
ZXQsIHJ1bGVzX2NvdW50X3JldCk7CiB9CiAKIC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqLwogLyogY2FsbGJhY2tz
IChhbnkgY29udGV4dCkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICovCiAKLXN0YXRpYyB1aW50NjRfdCB1c2JyZWRpcl9idWZmZXJlZF9vdXRwdXRfc2l6ZV9jYWxs
YmFjayh2b2lkICp1c2VyX2RhdGEpCitzdGF0aWMgdWludDY0X3QgdXNicmVkaXJfZ2V0X3F1ZXVl
X3NpemUodm9pZCAqdXNlcl9kYXRhKQogewogICAgIGdfcmV0dXJuX3ZhbF9pZl9mYWlsKFNQSUNF
X0lTX1VTQlJFRElSX0NIQU5ORUwodXNlcl9kYXRhKSwgMCk7CiAgICAgcmV0dXJuIHNwaWNlX2No
YW5uZWxfZ2V0X3F1ZXVlX3NpemUoU1BJQ0VfQ0hBTk5FTCh1c2VyX2RhdGEpKTsKIH0KIAotLyog
Tm90ZSB0aGF0IHRoaXMgZnVuY3Rpb24gbXVzdCBiZSByZS1lbnRyYW50IHNhZmUsIGFzIGl0IGNh
biBnZXQgY2FsbGVkCi0gICBmcm9tIGJvdGggdGhlIG1haW4gdGhyZWFkIGFzIHdlbGwgYXMgZnJv
bSB0aGUgdXNiIGV2ZW50IGhhbmRsaW5nIHRocmVhZCAqLwotc3RhdGljIHZvaWQgdXNicmVkaXJf
d3JpdGVfZmx1c2hfY2FsbGJhY2sodm9pZCAqdXNlcl9kYXRhKQorc3RhdGljIGdib29sZWFuIHVz
YnJlZGlyX2lzX2NoYW5uZWxfcmVhZHkodm9pZCAqdXNlcl9kYXRhKQogewogICAgIFNwaWNlVXNi
cmVkaXJDaGFubmVsICpjaGFubmVsID0gU1BJQ0VfVVNCUkVESVJfQ0hBTk5FTCh1c2VyX2RhdGEp
OwogICAgIFNwaWNlVXNicmVkaXJDaGFubmVsUHJpdmF0ZSAqcHJpdiA9IGNoYW5uZWwtPnByaXY7
Ci0KLSAgICBpZiAoc3BpY2VfY2hhbm5lbF9nZXRfc3RhdGUoU1BJQ0VfQ0hBTk5FTChjaGFubmVs
KSkgIT0KLSAgICAgICAgICAgIFNQSUNFX0NIQU5ORUxfU1RBVEVfUkVBRFkpCi0gICAgICAgIHJl
dHVybjsKLQotICAgIGlmICghcHJpdi0+aG9zdCkKLSAgICAgICAgcmV0dXJuOwotCi0gICAgdXNi
cmVkaXJob3N0X3dyaXRlX2d1ZXN0X2RhdGEocHJpdi0+aG9zdCk7Ci19Ci0KLXN0YXRpYyB2b2lk
IHVzYnJlZGlyX2xvZyh2b2lkICp1c2VyX2RhdGEsIGludCBsZXZlbCwgY29uc3QgY2hhciAqbXNn
KQotewotICAgIFNwaWNlVXNicmVkaXJDaGFubmVsICpjaGFubmVsID0gdXNlcl9kYXRhOwotICAg
IFNwaWNlVXNicmVkaXJDaGFubmVsUHJpdmF0ZSAqcHJpdiA9IGNoYW5uZWwtPnByaXY7Ci0KLSAg
ICBpZiAocHJpdi0+Y2F0Y2hfZXJyb3IgJiYgbGV2ZWwgPT0gdXNicmVkaXJwYXJzZXJfZXJyb3Ip
IHsKLSAgICAgICAgQ0hBTk5FTF9ERUJVRyhjaGFubmVsLCAiJXMiLCBtc2cpOwotICAgICAgICAv
KiBSZW1vdmUgInVzYnJlZGlyaG9zdDogIiBwcmVmaXggZnJvbSB1c2JyZWRpcmhvc3QgbWVzc2Fn
ZXMgKi8KLSAgICAgICAgaWYgKHN0cm5jbXAobXNnLCAidXNicmVkaXJob3N0OiAiLCAxNCkgPT0g
MCkKLSAgICAgICAgICAgIGdfc2V0X2Vycm9yX2xpdGVyYWwocHJpdi0+Y2F0Y2hfZXJyb3IsIFNQ
SUNFX0NMSUVOVF9FUlJPUiwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU1BJQ0Vf
Q0xJRU5UX0VSUk9SX0ZBSUxFRCwgbXNnICsgMTQpOwotICAgICAgICBlbHNlCi0gICAgICAgICAg
ICBnX3NldF9lcnJvcl9saXRlcmFsKHByaXYtPmNhdGNoX2Vycm9yLCBTUElDRV9DTElFTlRfRVJS
T1IsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNQSUNFX0NMSUVOVF9FUlJPUl9G
QUlMRUQsIG1zZyk7Ci0gICAgICAgIHJldHVybjsKLSAgICB9Ci0KLSAgICBzd2l0Y2ggKGxldmVs
KSB7Ci0gICAgICAgIGNhc2UgdXNicmVkaXJwYXJzZXJfZXJyb3I6Ci0gICAgICAgICAgICBnX2Ny
aXRpY2FsKCIlcyIsIG1zZyk7Ci0gICAgICAgICAgICBicmVhazsKLSAgICAgICAgY2FzZSB1c2Jy
ZWRpcnBhcnNlcl93YXJuaW5nOgotICAgICAgICAgICAgZ193YXJuaW5nKCIlcyIsIG1zZyk7Ci0g
ICAgICAgICAgICBicmVhazsKLSAgICAgICAgZGVmYXVsdDoKLSAgICAgICAgICAgIENIQU5ORUxf
REVCVUcoY2hhbm5lbCwgIiVzIiwgbXNnKTsKLSAgICB9Ci19Ci0KLXN0YXRpYyBpbnQgdXNicmVk
aXJfcmVhZF9jYWxsYmFjayh2b2lkICp1c2VyX2RhdGEsIHVpbnQ4X3QgKmRhdGEsIGludCBjb3Vu
dCkKLXsKLSAgICBTcGljZVVzYnJlZGlyQ2hhbm5lbCAqY2hhbm5lbCA9IHVzZXJfZGF0YTsKLSAg
ICBTcGljZVVzYnJlZGlyQ2hhbm5lbFByaXZhdGUgKnByaXYgPSBjaGFubmVsLT5wcml2OwotCi0g
ICAgY291bnQgPSBNSU4ocHJpdi0+cmVhZF9idWZfc2l6ZSwgY291bnQpOwotCi0gICAgaWYgKGNv
dW50ICE9IDApIHsKLSAgICAgICAgbWVtY3B5KGRhdGEsIHByaXYtPnJlYWRfYnVmLCBjb3VudCk7
Ci0gICAgfQotCi0gICAgcHJpdi0+cmVhZF9idWZfc2l6ZSAtPSBjb3VudDsKLSAgICBpZiAocHJp
di0+cmVhZF9idWZfc2l6ZSkgewotICAgICAgICBwcml2LT5yZWFkX2J1ZiArPSBjb3VudDsKLSAg
ICB9IGVsc2UgewotICAgICAgICBwcml2LT5yZWFkX2J1ZiA9IE5VTEw7Ci0gICAgfQotCi0gICAg
cmV0dXJuIGNvdW50OworICAgIHJldHVybiBwcml2LT5ob3N0ICE9IE5VTEwgJiYKKyAgICAgICAg
ICAgc3BpY2VfY2hhbm5lbF9nZXRfc3RhdGUoU1BJQ0VfQ0hBTk5FTChjaGFubmVsKSkgPT0gU1BJ
Q0VfQ0hBTk5FTF9TVEFURV9SRUFEWTsKIH0KIAogc3RhdGljIHZvaWQgdXNicmVkaXJfZnJlZV93
cml0ZV9jYl9kYXRhKHVpbnQ4X3QgKmRhdGEsIHZvaWQgKnVzZXJfZGF0YSkKQEAgLTY0Niw3ICs1
NTgsNyBAQCBzdGF0aWMgdm9pZCB1c2JyZWRpcl9mcmVlX3dyaXRlX2NiX2RhdGEodWludDhfdCAq
ZGF0YSwgdm9pZCAqdXNlcl9kYXRhKQogICAgIFNwaWNlVXNicmVkaXJDaGFubmVsICpjaGFubmVs
ID0gdXNlcl9kYXRhOwogICAgIFNwaWNlVXNicmVkaXJDaGFubmVsUHJpdmF0ZSAqcHJpdiA9IGNo
YW5uZWwtPnByaXY7CiAKLSAgICB1c2JyZWRpcmhvc3RfZnJlZV93cml0ZV9idWZmZXIocHJpdi0+
aG9zdCwgZGF0YSk7CisgICAgc3BpY2VfdXNiX2JhY2tlbmRfcmV0dXJuX3dyaXRlX2RhdGEocHJp
di0+aG9zdCwgZGF0YSk7CiB9CiAKICNpZmRlZiBVU0VfTFo0CkBAIC03MTgsNyArNjMwLDcgQEAg
c3RhdGljIGludCB1c2JyZWRpcl93cml0ZV9jYWxsYmFjayh2b2lkICp1c2VyX2RhdGEsIHVpbnQ4
X3QgKmRhdGEsIGludCBjb3VudCkKIAogI2lmZGVmIFVTRV9MWjQKICAgICBpZiAodHJ5X3dyaXRl
X2NvbXByZXNzX0xaNChjaGFubmVsLCBkYXRhLCBjb3VudCkpIHsKLSAgICAgICAgdXNicmVkaXJo
b3N0X2ZyZWVfd3JpdGVfYnVmZmVyKGNoYW5uZWwtPnByaXYtPmhvc3QsIGRhdGEpOworICAgICAg
ICBzcGljZV91c2JfYmFja2VuZF9yZXR1cm5fd3JpdGVfZGF0YShjaGFubmVsLT5wcml2LT5ob3N0
LCBkYXRhKTsKICAgICAgICAgcmV0dXJuIGNvdW50OwogICAgIH0KICNlbmRpZgpAQCAtNzMxLDE1
ICs2NDMsNiBAQCBzdGF0aWMgaW50IHVzYnJlZGlyX3dyaXRlX2NhbGxiYWNrKHZvaWQgKnVzZXJf
ZGF0YSwgdWludDhfdCAqZGF0YSwgaW50IGNvdW50KQogICAgIHJldHVybiBjb3VudDsKIH0KIAot
c3RhdGljIHZvaWQgKnVzYnJlZGlyX2FsbG9jX2xvY2sodm9pZCkgewotICAgIEdNdXRleCAqbXV0
ZXg7Ci0KLSAgICBtdXRleCA9IGdfbmV3MChHTXV0ZXgsIDEpOwotICAgIGdfbXV0ZXhfaW5pdCht
dXRleCk7Ci0KLSAgICByZXR1cm4gbXV0ZXg7Ci19Ci0KIEdfR05VQ19JTlRFUk5BTAogdm9pZCBz
cGljZV91c2JyZWRpcl9jaGFubmVsX2xvY2soU3BpY2VVc2JyZWRpckNoYW5uZWwgKmNoYW5uZWwp
CiB7CkBAIC03NTIsMjUgKzY1NSw2IEBAIHZvaWQgc3BpY2VfdXNicmVkaXJfY2hhbm5lbF91bmxv
Y2soU3BpY2VVc2JyZWRpckNoYW5uZWwgKmNoYW5uZWwpCiAgICAgZ19tdXRleF91bmxvY2soJmNo
YW5uZWwtPnByaXYtPmRldmljZV9jb25uZWN0X211dGV4KTsKIH0KIAotc3RhdGljIHZvaWQgdXNi
cmVkaXJfbG9ja19sb2NrKHZvaWQgKnVzZXJfZGF0YSkgewotICAgIEdNdXRleCAqbXV0ZXggPSB1
c2VyX2RhdGE7Ci0KLSAgICBnX211dGV4X2xvY2sobXV0ZXgpOwotfQotCi1zdGF0aWMgdm9pZCB1
c2JyZWRpcl91bmxvY2tfbG9jayh2b2lkICp1c2VyX2RhdGEpIHsKLSAgICBHTXV0ZXggKm11dGV4
ID0gdXNlcl9kYXRhOwotCi0gICAgZ19tdXRleF91bmxvY2sobXV0ZXgpOwotfQotCi1zdGF0aWMg
dm9pZCB1c2JyZWRpcl9mcmVlX2xvY2sodm9pZCAqdXNlcl9kYXRhKSB7Ci0gICAgR011dGV4ICpt
dXRleCA9IHVzZXJfZGF0YTsKLQotICAgIGdfbXV0ZXhfY2xlYXIobXV0ZXgpOwotICAgIGdfZnJl
ZShtdXRleCk7Ci19Ci0KIC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqLwogCiB0eXBlZGVmIHN0cnVjdCBkZXZp
Y2VfZXJyb3JfZGF0YSB7CkBAIC04MDksNyArNjkzLDcgQEAgc3RhdGljIHZvaWQgc3BpY2VfdXNi
cmVkaXJfY2hhbm5lbF91cChTcGljZUNoYW5uZWwgKmMpCiAKICAgICBnX3JldHVybl9pZl9mYWls
KHByaXYtPmhvc3QgIT0gTlVMTCk7CiAgICAgLyogRmx1c2ggYW55IHBlbmRpbmcgd3JpdGVzICov
Ci0gICAgdXNicmVkaXJob3N0X3dyaXRlX2d1ZXN0X2RhdGEocHJpdi0+aG9zdCk7CisgICAgc3Bp
Y2VfdXNiX2JhY2tlbmRfY2hhbm5lbF91cChwcml2LT5ob3N0KTsKIH0KIAogc3RhdGljIGludCB0
cnlfaGFuZGxlX2NvbXByZXNzZWRfbXNnKFNwaWNlTXNnQ29tcHJlc3NlZERhdGEgKmNvbXByZXNz
ZWRfZGF0YV9tc2csCkBAIC04NTksMjYgKzc0MywyMCBAQCBzdGF0aWMgdm9pZCB1c2JyZWRpcl9o
YW5kbGVfbXNnKFNwaWNlQ2hhbm5lbCAqYywgU3BpY2VNc2dJbiAqaW4pCiAKICAgICBnX3JldHVy
bl9pZl9mYWlsKHByaXYtPmhvc3QgIT0gTlVMTCk7CiAKLSAgICAvKiBObyByZWN1cnNpb24gYWxs
b3dlZCEgKi8KLSAgICBnX3JldHVybl9pZl9mYWlsKHByaXYtPnJlYWRfYnVmID09IE5VTEwpOwot
CiAgICAgaWYgKHNwaWNlX21zZ19pbl90eXBlKGluKSA9PSBTUElDRV9NU0dfU1BJQ0VWTUNfQ09N
UFJFU1NFRF9EQVRBKSB7CiAgICAgICAgIFNwaWNlTXNnQ29tcHJlc3NlZERhdGEgKmNvbXByZXNz
ZWRfZGF0YV9tc2cgPSBzcGljZV9tc2dfaW5fcGFyc2VkKGluKTsKICAgICAgICAgaWYgKHRyeV9o
YW5kbGVfY29tcHJlc3NlZF9tc2coY29tcHJlc3NlZF9kYXRhX21zZywgJmJ1ZiwgJnNpemUpKSB7
Ci0gICAgICAgICAgICBwcml2LT5yZWFkX2J1Zl9zaXplID0gc2l6ZTsKLSAgICAgICAgICAgIHBy
aXYtPnJlYWRfYnVmID0gYnVmOworICAgICAgICAgICAgLyogdW5jb21wcmVzc2VkIG9rKi8KICAg
ICAgICAgfSBlbHNlIHsKLSAgICAgICAgICAgIHIgPSB1c2JyZWRpcmhvc3RfcmVhZF9wYXJzZV9l
cnJvcjsKKyAgICAgICAgICAgIHIgPSBVU0JfUkVESVJfRVJST1JfUkVBRF9QQVJTRTsKICAgICAg
ICAgfQogICAgIH0gZWxzZSB7IC8qIFJlZ3VsYXIgU1BJQ0VfTVNHX1NQSUNFVk1DX0RBVEEgbXNn
ICovCiAgICAgICAgIGJ1ZiA9IHNwaWNlX21zZ19pbl9yYXcoaW4sICZzaXplKTsKLSAgICAgICAg
cHJpdi0+cmVhZF9idWZfc2l6ZSA9IHNpemU7Ci0gICAgICAgIHByaXYtPnJlYWRfYnVmID0gYnVm
OwogICAgIH0KIAogICAgIHNwaWNlX3VzYnJlZGlyX2NoYW5uZWxfbG9jayhjaGFubmVsKTsKICAg
ICBpZiAociA9PSAwKQotICAgICAgICByID0gdXNicmVkaXJob3N0X3JlYWRfZ3Vlc3RfZGF0YShw
cml2LT5ob3N0KTsKKyAgICAgICAgciA9IHNwaWNlX3VzYl9iYWNrZW5kX3Byb3ZpZGVfcmVhZF9k
YXRhKHByaXYtPmhvc3QsIGJ1Ziwgc2l6ZSk7CiAgICAgaWYgKHIgIT0gMCkgewogICAgICAgICBT
cGljZVVzYkRldmljZSAqc3BpY2VfZGV2aWNlID0gcHJpdi0+c3BpY2VfZGV2aWNlOwogICAgICAg
ICBkZXZpY2VfZXJyb3JfZGF0YSBlcnJfZGF0YTsKQEAgLTg5MiwxNiArNzcwLDE2IEBAIHN0YXRp
YyB2b2lkIHVzYnJlZGlyX2hhbmRsZV9tc2coU3BpY2VDaGFubmVsICpjLCBTcGljZU1zZ0luICpp
bikKIAogICAgICAgICBkZXNjID0gc3BpY2VfdXNiX2RldmljZV9nZXRfZGVzY3JpcHRpb24oc3Bp
Y2VfZGV2aWNlLCBOVUxMKTsKICAgICAgICAgc3dpdGNoIChyKSB7Ci0gICAgICAgIGNhc2UgdXNi
cmVkaXJob3N0X3JlYWRfcGFyc2VfZXJyb3I6CisgICAgICAgIGNhc2UgVVNCX1JFRElSX0VSUk9S
X1JFQURfUEFSU0U6CiAgICAgICAgICAgICBlcnIgPSBnX2Vycm9yX25ldyhTUElDRV9DTElFTlRf
RVJST1IsIFNQSUNFX0NMSUVOVF9FUlJPUl9GQUlMRUQsCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBfKCJ1c2JyZWRpciBwcm90b2NvbCBwYXJzZSBlcnJvciBmb3IgJXMiKSwgZGVzYyk7
CiAgICAgICAgICAgICBicmVhazsKLSAgICAgICAgY2FzZSB1c2JyZWRpcmhvc3RfcmVhZF9kZXZp
Y2VfcmVqZWN0ZWQ6CisgICAgICAgIGNhc2UgVVNCX1JFRElSX0VSUk9SX0RFVl9SRUpFQ1RFRDoK
ICAgICAgICAgICAgIGVyciA9IGdfZXJyb3JfbmV3KFNQSUNFX0NMSUVOVF9FUlJPUiwKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIFNQSUNFX0NMSUVOVF9FUlJPUl9VU0JfREVWSUNFX1JF
SkVDVEVELAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXygiJXMgcmVqZWN0ZWQgYnkg
aG9zdCIpLCBkZXNjKTsKICAgICAgICAgICAgIGJyZWFrOwotICAgICAgICBjYXNlIHVzYnJlZGly
aG9zdF9yZWFkX2RldmljZV9sb3N0OgorICAgICAgICBjYXNlIFVTQl9SRURJUl9FUlJPUl9ERVZf
TE9TVDoKICAgICAgICAgICAgIGVyciA9IGdfZXJyb3JfbmV3KFNQSUNFX0NMSUVOVF9FUlJPUiwK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNQSUNFX0NMSUVOVF9FUlJPUl9VU0JfREVW
SUNFX0xPU1QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfKCIlcyBkaXNjb25uZWN0
ZWQgKGZhdGFsIElPIGVycm9yKSIpLCBkZXNjKTsKZGlmZiAtLWdpdCBhL3NyYy9tZXNvbi5idWls
ZCBiL3NyYy9tZXNvbi5idWlsZAppbmRleCA1MzY1ZjA1Li5hNTFkMGE5IDEwMDY0NAotLS0gYS9z
cmMvbWVzb24uYnVpbGQKKysrIGIvc3JjL21lc29uLmJ1aWxkCkBAIC0xMjEsNiArMTIxLDggQEAg
c3BpY2VfY2xpZW50X2dsaWJfc291cmNlcyA9IFsKICAgJ3VzYi1kZXZpY2UtbWFuYWdlci1wcml2
LmgnLAogICAndXNidXRpbC5jJywKICAgJ3VzYnV0aWwuaCcsCisgICd1c2ItYmFja2VuZC5jJywK
KyAgJ3VzYi1iYWNrZW5kLmgnLAogICAndm1jc3RyZWFtLmMnLAogICAndm1jc3RyZWFtLmgnLAog
XQpkaWZmIC0tZ2l0IGEvc3JjL3VzYi1iYWNrZW5kLmMgYi9zcmMvdXNiLWJhY2tlbmQuYwpuZXcg
ZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwLi42NzVlYjYyCi0tLSAvZGV2L251bGwKKysr
IGIvc3JjL3VzYi1iYWNrZW5kLmMKQEAgLTAsMCArMSw2MjIgQEAKKy8qIC0qLSBNb2RlOiBDOyBj
LWJhc2ljLW9mZnNldDogNDsgaW5kZW50LXRhYnMtbW9kZTogbmlsIC0qLSAqLworLyoKKyAgICBD
b3B5cmlnaHQgKEMpIDIwMTItMjAxOCBSZWQgSGF0LCBJbmMuCisKKyAgICBSZWQgSGF0IEF1dGhv
cnM6CisgICAgWXVyaSBCZW5kaXRvdmljaDx5YmVuZGl0b0ByZWRoYXQuY29tPgorICAgIEhhbnMg
ZGUgR29lZGUgPGhkZWdvZWRlQHJlZGhhdC5jb20+CisKKyAgICBUaGlzIGxpYnJhcnkgaXMgZnJl
ZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yCisgICAgbW9kaWZ5IGl0
IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYworICAgIExp
Y2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhl
cgorICAgIHZlcnNpb24gMi4xIG9mIHRoZSBMaWNlbnNlLCBvciAoYXQgeW91ciBvcHRpb24pIGFu
eSBsYXRlciB2ZXJzaW9uLgorCisgICAgVGhpcyBsaWJyYXJ5IGlzIGRpc3RyaWJ1dGVkIGluIHRo
ZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCisgICAgYnV0IFdJVEhPVVQgQU5ZIFdBUlJB
TlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKKyAgICBNRVJDSEFOVEFC
SUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlIEdOVQor
ICAgIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCisKKyAg
ICBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVy
YWwgUHVibGljCisgICAgTGljZW5zZSBhbG9uZyB3aXRoIHRoaXMgbGlicmFyeTsgaWYgbm90LCBz
ZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+LgorKi8KKworI2luY2x1ZGUgImNvbmZp
Zy5oIgorCisjaWZkZWYgVVNFX1VTQlJFRElSCisKKyNpbmNsdWRlIDxnbGliLW9iamVjdC5oPgor
I2luY2x1ZGUgPGludHR5cGVzLmg+CisjaW5jbHVkZSA8Z2lvL2dpby5oPgorI2luY2x1ZGUgPGVy
cm5vLmg+CisjaW5jbHVkZSA8bGlidXNiLmg+CisjaW5jbHVkZSA8c3RyaW5nLmg+CisjaW5jbHVk
ZSA8ZmNudGwuaD4KKyNpbmNsdWRlICJ1c2JyZWRpcmhvc3QuaCIKKyNpbmNsdWRlICJ1c2JyZWRp
cnBhcnNlci5oIgorI2luY2x1ZGUgInNwaWNlLXV0aWwuaCIKKyNpbmNsdWRlICJ1c2ItYmFja2Vu
ZC5oIgorCisvLyNkZWZpbmUgTE9VRF9ERUJVRyBTUElDRV9ERUJVRworI2RlZmluZSBMT1VEX0RF
QlVHKHgsIC4uLikKKworc3RydWN0IF9TcGljZVVzYkJhY2tlbmREZXZpY2UKK3sKKyAgICBsaWJ1
c2JfZGV2aWNlICpsaWJ1c2JfZGV2aWNlOworICAgIGdpbnQgcmVmX2NvdW50OworICAgIFNwaWNl
VXNiQmFja2VuZENoYW5uZWwgKmF0dGFjaGVkX3RvOworICAgIFVzYkRldmljZUluZm9ybWF0aW9u
IGRldmljZV9pbmZvOworfTsKKworc3RydWN0IF9TcGljZVVzYkJhY2tlbmQKK3sKKyAgICBsaWJ1
c2JfY29udGV4dCAqbGlidXNiX2NvbnRleHQ7CisgICAgdXNiX2hvdF9wbHVnX2NhbGxiYWNrIGhv
dHBsdWdfY2FsbGJhY2s7CisgICAgdm9pZCAqaG90cGx1Z191c2VyX2RhdGE7CisgICAgbGlidXNi
X2hvdHBsdWdfY2FsbGJhY2tfaGFuZGxlIGhvdHBsdWdfaGFuZGxlOworfTsKKworc3RydWN0IF9T
cGljZVVzYkJhY2tlbmRDaGFubmVsCit7CisgICAgc3RydWN0IHVzYnJlZGlyaG9zdCAqdXNicmVk
aXJob3N0OworICAgIHVpbnQ4X3QgKnJlYWRfYnVmOworICAgIGludCByZWFkX2J1Zl9zaXplOwor
ICAgIHN0cnVjdCB1c2JyZWRpcmZpbHRlcl9ydWxlICpydWxlczsKKyAgICBpbnQgcnVsZXNfY291
bnQ7CisgICAgU3BpY2VVc2JCYWNrZW5kRGV2aWNlICphdHRhY2hlZDsKKyAgICBTcGljZVVzYkJh
Y2tlbmRDaGFubmVsSW5pdERhdGEgY2hhbm5lbF9kYXRhOworICAgIEdFcnJvciAqKmVycm9yOwor
fTsKKworLy8gbG9jayBmdW5jdGlvbnMgZm9yIHVzYnJlZGlyaG9zdCBhbmQgdXNicmVkaXJwYXJz
ZXIKK3N0YXRpYyB2b2lkICp1c2JyZWRpcl9hbGxvY19sb2NrKHZvaWQpIHsKKyAgICBHTXV0ZXgg
Km11dGV4OworCisgICAgbXV0ZXggPSBnX25ldzAoR011dGV4LCAxKTsKKyAgICBnX211dGV4X2lu
aXQobXV0ZXgpOworCisgICAgcmV0dXJuIG11dGV4OworfQorCitzdGF0aWMgdm9pZCB1c2JyZWRp
cl9mcmVlX2xvY2sodm9pZCAqdXNlcl9kYXRhKSB7CisgICAgR011dGV4ICptdXRleCA9IHVzZXJf
ZGF0YTsKKworICAgIGdfbXV0ZXhfY2xlYXIobXV0ZXgpOworICAgIGdfZnJlZShtdXRleCk7Cit9
CisKK3N0YXRpYyB2b2lkIHVzYnJlZGlyX2xvY2tfbG9jayh2b2lkICp1c2VyX2RhdGEpIHsKKyAg
ICBHTXV0ZXggKm11dGV4ID0gdXNlcl9kYXRhOworCisgICAgZ19tdXRleF9sb2NrKG11dGV4KTsK
K30KKworc3RhdGljIHZvaWQgdXNicmVkaXJfdW5sb2NrX2xvY2sodm9pZCAqdXNlcl9kYXRhKSB7
CisgICAgR011dGV4ICptdXRleCA9IHVzZXJfZGF0YTsKKworICAgIGdfbXV0ZXhfdW5sb2NrKG11
dGV4KTsKK30KKworZ2Jvb2xlYW4gc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX2lzb2NoKFNwaWNl
VXNiQmFja2VuZERldmljZSAqZGV2KQoreworICAgIGxpYnVzYl9kZXZpY2UgKmxpYmRldiA9IGRl
di0+bGlidXNiX2RldmljZTsKKyAgICBzdHJ1Y3QgbGlidXNiX2NvbmZpZ19kZXNjcmlwdG9yICpj
b25mX2Rlc2M7CisgICAgZ2Jvb2xlYW4gaXNvY19mb3VuZCA9IEZBTFNFOworICAgIGdpbnQgaSwg
aiwgazsKKworICAgIGdfcmV0dXJuX3ZhbF9pZl9mYWlsKGxpYmRldiAhPSBOVUxMLCAwKTsKKwor
ICAgIGlmIChsaWJ1c2JfZ2V0X2FjdGl2ZV9jb25maWdfZGVzY3JpcHRvcihsaWJkZXYsICZjb25m
X2Rlc2MpICE9IDApIHsKKyAgICAgICAgZ19yZXR1cm5fdmFsX2lmX3JlYWNoZWQoMCk7CisgICAg
fQorCisgICAgZm9yIChpID0gMDsgIWlzb2NfZm91bmQgJiYgaSA8IGNvbmZfZGVzYy0+Yk51bUlu
dGVyZmFjZXM7IGkrKykgeworICAgICAgICBmb3IgKGogPSAwOyAhaXNvY19mb3VuZCAmJiBqIDwg
Y29uZl9kZXNjLT5pbnRlcmZhY2VbaV0ubnVtX2FsdHNldHRpbmc7IGorKykgeworICAgICAgICAg
ICAgZm9yIChrID0gMDsgIWlzb2NfZm91bmQgJiYgayA8IGNvbmZfZGVzYy0+aW50ZXJmYWNlW2ld
LmFsdHNldHRpbmdbal0uYk51bUVuZHBvaW50cztrKyspIHsKKyAgICAgICAgICAgICAgICBnaW50
IGF0dHJpYnV0ZXMgPSBjb25mX2Rlc2MtPmludGVyZmFjZVtpXS5hbHRzZXR0aW5nW2pdLmVuZHBv
aW50W2tdLmJtQXR0cmlidXRlczsKKyAgICAgICAgICAgICAgICBnaW50IHR5cGUgPSBhdHRyaWJ1
dGVzICYgTElCVVNCX1RSQU5TRkVSX1RZUEVfTUFTSzsKKyAgICAgICAgICAgICAgICBpZiAodHlw
ZSA9PSBMSUJVU0JfVFJBTlNGRVJfVFlQRV9JU09DSFJPTk9VUykKKyAgICAgICAgICAgICAgICAg
ICAgaXNvY19mb3VuZCA9IFRSVUU7CisgICAgICAgICAgICB9CisgICAgICAgIH0KKyAgICB9CisK
KyAgICBsaWJ1c2JfZnJlZV9jb25maWdfZGVzY3JpcHRvcihjb25mX2Rlc2MpOworICAgIHJldHVy
biBpc29jX2ZvdW5kOworfQorCitzdGF0aWMgZ2Jvb2xlYW4gZmlsbF91c2JfaW5mbyhTcGljZVVz
YkJhY2tlbmREZXZpY2UgKmJkZXYpCit7CisgICAgVXNiRGV2aWNlSW5mb3JtYXRpb24gKmluZm8g
PSAmYmRldi0+ZGV2aWNlX2luZm87CisKKyAgICBzdHJ1Y3QgbGlidXNiX2RldmljZV9kZXNjcmlw
dG9yIGRlc2M7CisgICAgbGlidXNiX2RldmljZSAqbGliZGV2ID0gYmRldi0+bGlidXNiX2Rldmlj
ZTsKKyAgICBsaWJ1c2JfZ2V0X2RldmljZV9kZXNjcmlwdG9yKGxpYmRldiwgJmRlc2MpOworICAg
IGluZm8tPmJ1cyA9IGxpYnVzYl9nZXRfYnVzX251bWJlcihsaWJkZXYpOworICAgIGluZm8tPmFk
ZHJlc3MgPSBsaWJ1c2JfZ2V0X2RldmljZV9hZGRyZXNzKGxpYmRldik7CisgICAgaWYgKGluZm8t
PmFkZHJlc3MgPT0gMHhmZiB8fCAvKiByb290IGh1YiAoSENEKSAqLworICAgICAgICBpbmZvLT5h
ZGRyZXNzIDw9IDEgfHwgLyogcm9vdCBodWIgb3IgYmFkIGFkZHJlc3MgKi8KKyAgICAgICAgKGRl
c2MuYkRldmljZUNsYXNzID09IExJQlVTQl9DTEFTU19IVUIpIC8qaHViKi8pIHsKKyAgICAgICAg
cmV0dXJuIEZBTFNFOworICAgIH0KKworICAgIGluZm8tPnZpZCA9IGRlc2MuaWRWZW5kb3I7Cisg
ICAgaW5mby0+cGlkID0gZGVzYy5pZFByb2R1Y3Q7CisgICAgaW5mby0+Y2xhc3MgPSBkZXNjLmJE
ZXZpY2VDbGFzczsKKyAgICBpbmZvLT5zdWJjbGFzcyA9IGRlc2MuYkRldmljZVN1YkNsYXNzOwor
ICAgIGluZm8tPnByb3RvY29sID0gZGVzYy5iRGV2aWNlUHJvdG9jb2w7CisKKyAgICByZXR1cm4g
VFJVRTsKK30KKworc3RhdGljIFNwaWNlVXNiQmFja2VuZERldmljZSAqYWxsb2NhdGVfYmFja2Vu
ZF9kZXZpY2UobGlidXNiX2RldmljZSAqbGliZGV2KQoreworICAgIFNwaWNlVXNiQmFja2VuZERl
dmljZSAqZGV2ID0gZ19uZXcwKFNwaWNlVXNiQmFja2VuZERldmljZSwgMSk7CisgICAgZGV2LT5y
ZWZfY291bnQgPSAxOworICAgIGRldi0+bGlidXNiX2RldmljZSA9IGxpYmRldjsKKyAgICBpZiAo
IWZpbGxfdXNiX2luZm8oZGV2KSkgeworICAgICAgICBnX2ZyZWUoZGV2KTsKKyAgICAgICAgZGV2
ID0gTlVMTDsKKyAgICB9CisgICAgcmV0dXJuIGRldjsKK30KKworLyogTm90ZSB0aGF0IHRoaXMg
ZnVuY3Rpb24gbXVzdCBiZSByZS1lbnRyYW50IHNhZmUsIGFzIGl0IGNhbiBnZXQgY2FsbGVkCitm
cm9tIGJvdGggdGhlIG1haW4gdGhyZWFkIGFzIHdlbGwgYXMgZnJvbSB0aGUgdXNiIGV2ZW50IGhh
bmRsaW5nIHRocmVhZCAqLworc3RhdGljIHZvaWQgdXNicmVkaXJfd3JpdGVfZmx1c2hfY2FsbGJh
Y2sodm9pZCAqdXNlcl9kYXRhKQoreworICAgIFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmNoID0g
dXNlcl9kYXRhOworICAgIGdib29sZWFuIG9rID0gY2gtPmNoYW5uZWxfZGF0YS5pc19jaGFubmVs
X3JlYWR5KGNoLT5jaGFubmVsX2RhdGEudXNlcl9kYXRhKTsKKyAgICBpZiAob2sgJiYgY2gtPnVz
YnJlZGlyaG9zdCkgeworICAgICAgICBTUElDRV9ERUJVRygiJXMgY2ggJXAgLT4gdXNicmVkaXJo
b3N0IiwgX19GVU5DVElPTl9fLCBjaCk7CisgICAgICAgIHVzYnJlZGlyaG9zdF93cml0ZV9ndWVz
dF9kYXRhKGNoLT51c2JyZWRpcmhvc3QpOworICAgIH0gZWxzZSB7CisgICAgICAgIFNQSUNFX0RF
QlVHKCIlcyBjaCAlcCAobm90IHJlYWR5KSIsIF9fRlVOQ1RJT05fXywgY2gpOworICAgIH0KK30K
KworU3BpY2VVc2JCYWNrZW5kICpzcGljZV91c2JfYmFja2VuZF9uZXcoR0Vycm9yICoqZXJyb3Ip
Cit7CisgICAgaW50IHJjOworICAgIFNwaWNlVXNiQmFja2VuZCAqYmU7CisgICAgU1BJQ0VfREVC
VUcoIiVzID4+IiwgX19GVU5DVElPTl9fKTsKKyAgICBiZSA9IChTcGljZVVzYkJhY2tlbmQgKiln
X25ldzAoU3BpY2VVc2JCYWNrZW5kLCAxKTsKKyAgICByYyA9IGxpYnVzYl9pbml0KCZiZS0+bGli
dXNiX2NvbnRleHQpOworICAgIGlmIChyYyA8IDApIHsKKyAgICAgICAgY29uc3QgY2hhciAqZGVz
YyA9IGxpYnVzYl9lcnJvcl9uYW1lKHJjKTsKKyAgICAgICAgZ193YXJuaW5nKCJFcnJvciBpbml0
aWFsaXppbmcgTElCVVNCIHN1cHBvcnQ6ICVzIFslaV0iLCBkZXNjLCByYyk7CisgICAgICAgIGdf
c2V0X2Vycm9yKGVycm9yLCBTUElDRV9DTElFTlRfRVJST1IsIFNQSUNFX0NMSUVOVF9FUlJPUl9G
QUlMRUQsCisgICAgICAgICAgICAiRXJyb3IgaW5pdGlhbGl6aW5nIExJQlVTQiBzdXBwb3J0OiAl
cyBbJWldIiwgZGVzYywgcmMpOworICAgICAgICBnX2ZyZWUoYmUpOworICAgICAgICBiZSA9IE5V
TEw7CisgICAgfSBlbHNlIHsKKyNpZmRlZiBHX09TX1dJTjMyCisjaWYgTElCVVNCX0FQSV9WRVJT
SU9OID49IDB4MDEwMDAxMDYKKyAgICBsaWJ1c2Jfc2V0X29wdGlvbihiZS0+bGlidXNiX2NvbnRl
eHQsIExJQlVTQl9PUFRJT05fVVNFX1VTQkRLKTsKKyNlbmRpZgorI2VuZGlmCisgICAgfQorICAg
IFNQSUNFX0RFQlVHKCIlcyA8PCIsIF9fRlVOQ1RJT05fXyk7CisgICAgcmV0dXJuIGJlOworfQor
CitnYm9vbGVhbiBzcGljZV91c2JfYmFja2VuZF9oYW5kbGVfZXZlbnRzKFNwaWNlVXNiQmFja2Vu
ZCAqYmUpCit7CisgICAgU1BJQ0VfREVCVUcoIiVzID4+IiwgX19GVU5DVElPTl9fKTsKKyAgICBn
Ym9vbGVhbiBvayA9IEZBTFNFOworICAgIGlmIChiZS0+bGlidXNiX2NvbnRleHQpIHsKKyAgICAg
ICAgaW50IHJlcyA9IGxpYnVzYl9oYW5kbGVfZXZlbnRzKGJlLT5saWJ1c2JfY29udGV4dCk7Cisg
ICAgICAgIG9rID0gcmVzID09IDA7CisgICAgICAgIGlmIChyZXMgJiYgcmVzICE9IExJQlVTQl9F
UlJPUl9JTlRFUlJVUFRFRCkgeworICAgICAgICAgICAgY29uc3QgY2hhciAqZGVzYyA9IGxpYnVz
Yl9lcnJvcl9uYW1lKHJlcyk7CisgICAgICAgICAgICBnX3dhcm5pbmcoIkVycm9yIGhhbmRsaW5n
IFVTQiBldmVudHM6ICVzIFslaV0iLCBkZXNjLCByZXMpOworICAgICAgICAgICAgb2sgPSBGQUxT
RTsKKyAgICAgICAgfQorICAgIH0KKyAgICBTUElDRV9ERUJVRygiJXMgPDwgJWQiLCBfX0ZVTkNU
SU9OX18sIG9rKTsKKyAgICByZXR1cm4gb2s7Cit9CisKK3N0YXRpYyBpbnQgTElCVVNCX0NBTEwg
aG90cGx1Z19jYWxsYmFjayhsaWJ1c2JfY29udGV4dCAqY3R4LAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGxpYnVzYl9kZXZpY2UgKmRldmljZSwKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWJ1c2JfaG90cGx1Z19ldmVudCBldmVudCwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2b2lkICp1c2VyX2RhdGEp
Cit7CisgICAgU3BpY2VVc2JCYWNrZW5kICpiZSA9IChTcGljZVVzYkJhY2tlbmQgKil1c2VyX2Rh
dGE7CisgICAgaWYgKGJlLT5ob3RwbHVnX2NhbGxiYWNrKSB7CisgICAgICAgIFNwaWNlVXNiQmFj
a2VuZERldmljZSAqZGV2OworICAgICAgICBnYm9vbGVhbiB2YWwgPSBldmVudCA9PSBMSUJVU0Jf
SE9UUExVR19FVkVOVF9ERVZJQ0VfQVJSSVZFRDsKKyAgICAgICAgZGV2ID0gYWxsb2NhdGVfYmFj
a2VuZF9kZXZpY2UoZGV2aWNlKTsKKyAgICAgICAgaWYgKGRldikgeworICAgICAgICAgICAgU1BJ
Q0VfREVCVUcoImNyZWF0ZWQgZGV2ICVwLCB1c2JsaWIgZGV2ICVwIiwgZGV2LCBkZXZpY2UpOwor
ICAgICAgICAgICAgbGlidXNiX3JlZl9kZXZpY2UoZGV2aWNlKTsKKyAgICAgICAgICAgIGJlLT5o
b3RwbHVnX2NhbGxiYWNrKGJlLT5ob3RwbHVnX3VzZXJfZGF0YSwgZGV2LCB2YWwpOworICAgICAg
ICAgICAgc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX3VucmVmKGRldik7CisgICAgICAgIH0KKyAg
ICB9CisgICAgcmV0dXJuIDA7Cit9CisKK3ZvaWQgc3BpY2VfdXNiX2JhY2tlbmRfZGVyZWdpc3Rl
cl9ob3RwbHVnKFNwaWNlVXNiQmFja2VuZCAqYmUpCit7CisgICAgZ19yZXR1cm5faWZfZmFpbChi
ZSAhPSBOVUxMKTsKKyAgICBpZiAoYmUtPmhvdHBsdWdfaGFuZGxlKSB7CisgICAgICAgIGxpYnVz
Yl9ob3RwbHVnX2RlcmVnaXN0ZXJfY2FsbGJhY2soYmUtPmxpYnVzYl9jb250ZXh0LCBiZS0+aG90
cGx1Z19oYW5kbGUpOworICAgICAgICBiZS0+aG90cGx1Z19oYW5kbGUgPSAwOworICAgIH0KKyAg
ICBiZS0+aG90cGx1Z19jYWxsYmFjayA9IE5VTEw7Cit9CisKK2dib29sZWFuIHNwaWNlX3VzYl9i
YWNrZW5kX3JlZ2lzdGVyX2hvdHBsdWcoU3BpY2VVc2JCYWNrZW5kICpiZSwKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdm9pZCAqdXNlcl9kYXRhLAorICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2JfaG90X3BsdWdfY2FsbGJh
Y2sgcHJvYykKK3sKKyAgICBpbnQgcmM7CisgICAgZ19yZXR1cm5fdmFsX2lmX2ZhaWwoYmUgIT0g
TlVMTCwgRkFMU0UpOworCisgICAgYmUtPmhvdHBsdWdfY2FsbGJhY2sgPSBwcm9jOworICAgIGJl
LT5ob3RwbHVnX3VzZXJfZGF0YSA9IHVzZXJfZGF0YTsKKyAgICByYyA9IGxpYnVzYl9ob3RwbHVn
X3JlZ2lzdGVyX2NhbGxiYWNrKGJlLT5saWJ1c2JfY29udGV4dCwKKyAgICAgICAgTElCVVNCX0hP
VFBMVUdfRVZFTlRfREVWSUNFX0FSUklWRUQgfCBMSUJVU0JfSE9UUExVR19FVkVOVF9ERVZJQ0Vf
TEVGVCwKKyAgICAgICAgTElCVVNCX0hPVFBMVUdfRU5VTUVSQVRFLCBMSUJVU0JfSE9UUExVR19N
QVRDSF9BTlksCisgICAgICAgIExJQlVTQl9IT1RQTFVHX01BVENIX0FOWSwgTElCVVNCX0hPVFBM
VUdfTUFUQ0hfQU5ZLAorICAgICAgICBob3RwbHVnX2NhbGxiYWNrLCBiZSwgJmJlLT5ob3RwbHVn
X2hhbmRsZSk7CisgICAgaWYgKHJjICE9IExJQlVTQl9TVUNDRVNTKSB7CisgICAgICAgIGNvbnN0
IGNoYXIgKmRlc2MgPSBsaWJ1c2JfZXJyb3JfbmFtZShyYyk7CisgICAgICAgIGdfd2FybmluZygi
RXJyb3IgaW5pdGlhbGl6aW5nIFVTQiBob3RwbHVnIHN1cHBvcnQ6ICVzIFslaV0iLCBkZXNjLCBy
Yyk7CisgICAgICAgIGJlLT5ob3RwbHVnX2NhbGxiYWNrID0gTlVMTDsKKyAgICAgICAgcmV0dXJu
IEZBTFNFOworICAgIH0KKyAgICByZXR1cm4gVFJVRTsKK30KKwordm9pZCBzcGljZV91c2JfYmFj
a2VuZF9kZWxldGUoU3BpY2VVc2JCYWNrZW5kICpiZSkKK3sKKyAgICBnX3JldHVybl9pZl9mYWls
KGJlICE9IE5VTEwpOworICAgIFNQSUNFX0RFQlVHKCIlcyA+PiIsIF9fRlVOQ1RJT05fXyk7Cisg
ICAgaWYgKGJlLT5saWJ1c2JfY29udGV4dCkgeworICAgICAgICBsaWJ1c2JfZXhpdChiZS0+bGli
dXNiX2NvbnRleHQpOworICAgIH0KKyAgICBnX2ZyZWUoYmUpOworICAgIFNQSUNFX0RFQlVHKCIl
cyA8PCIsIF9fRlVOQ1RJT05fXyk7Cit9CisKK1NwaWNlVXNiQmFja2VuZERldmljZSAqKnNwaWNl
X3VzYl9iYWNrZW5kX2dldF9kZXZpY2VfbGlzdChTcGljZVVzYkJhY2tlbmQgKmJlKQoreworICAg
IExPVURfREVCVUcoIiVzID4+IiwgX19GVU5DVElPTl9fKTsKKyAgICBsaWJ1c2JfZGV2aWNlICoq
ZGV2bGlzdCA9IE5VTEwsICoqZGV2OworICAgIFNwaWNlVXNiQmFja2VuZERldmljZSAqZCwgKips
aXN0OworCisgICAgaW50IG4gPSAwLCBpbmRleDsKKworICAgIGlmIChiZSAmJiBiZS0+bGlidXNi
X2NvbnRleHQpIHsKKyAgICAgICAgbGlidXNiX2dldF9kZXZpY2VfbGlzdChiZS0+bGlidXNiX2Nv
bnRleHQsICZkZXZsaXN0KTsKKyAgICB9CisKKyAgICAvLyBhZGQgYWxsIHRoZSBsaWJ1c2IgZGV2
aWNlIHRoYXQgbm90IHByZXNlbnQgaW4gb3VyIGxpc3QKKyAgICBmb3IgKGRldiA9IGRldmxpc3Q7
IGRldiAmJiAqZGV2OyBkZXYrKykgeworICAgICAgICBuKys7CisgICAgfQorCisgICAgbGlzdCA9
IGdfbmV3MChTcGljZVVzYkJhY2tlbmREZXZpY2UqLCBuICsgMSk7CisKKyAgICBpbmRleCA9IDA7
CisKKyAgICBmb3IgKGRldiA9IGRldmxpc3Q7IGRldiAmJiAqZGV2OyBkZXYrKykgeworICAgICAg
ICBkID0gYWxsb2NhdGVfYmFja2VuZF9kZXZpY2UoKmRldik7CisgICAgICAgIGlmICghZCkgewor
ICAgICAgICAgICAgbGlidXNiX3VucmVmX2RldmljZSgqZGV2KTsKKyAgICAgICAgfSBlbHNlIHsK
KyAgICAgICAgICAgIFNQSUNFX0RFQlVHKCJjcmVhdGVkIGRldiAlcCwgdXNibGliIGRldiAlcCIs
IGQsICpkZXYpOworICAgICAgICAgICAgbGlzdFtpbmRleCsrXSA9IGQ7CisgICAgICAgIH0KKyAg
ICB9CisKKyAgICBpZiAoZGV2bGlzdCkgeworICAgICAgICBsaWJ1c2JfZnJlZV9kZXZpY2VfbGlz
dChkZXZsaXN0LCAwKTsKKyAgICB9CisKKyAgICBMT1VEX0RFQlVHKCIlcyA8PCIsIF9fRlVOQ1RJ
T05fXyk7CisgICAgcmV0dXJuIGxpc3Q7Cit9CisKK2dib29sZWFuIHNwaWNlX3VzYl9iYWNrZW5k
X2RldmljZV9pc19odWIoU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpkZXYpCit7CisgICAgcmV0dXJu
IGRldi0+ZGV2aWNlX2luZm8uY2xhc3MgPT0gTElCVVNCX0NMQVNTX0hVQjsKK30KKworY29uc3Qg
VXNiRGV2aWNlSW5mb3JtYXRpb24qIHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9nZXRfaW5mbyhT
cGljZVVzYkJhY2tlbmREZXZpY2UgKmRldikKK3sKKyAgICByZXR1cm4gJmRldi0+ZGV2aWNlX2lu
Zm87Cit9CisKK2djb25zdHBvaW50ZXIgc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX2dldF9saWJk
ZXYoU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpkZXYpCit7CisgICAgcmV0dXJuIGRldi0+bGlidXNi
X2RldmljZTsKK30KKwordm9pZCBzcGljZV91c2JfYmFja2VuZF9mcmVlX2RldmljZV9saXN0KFNw
aWNlVXNiQmFja2VuZERldmljZSAqKmRldmxpc3QpCit7CisgICAgTE9VRF9ERUJVRygiJXMgPj4i
LCBfX0ZVTkNUSU9OX18pOworICAgIFNwaWNlVXNiQmFja2VuZERldmljZSAqKmRldjsKKyAgICBm
b3IgKGRldiA9IGRldmxpc3Q7ICpkZXY7IGRldisrKSB7CisgICAgICAgIFNwaWNlVXNiQmFja2Vu
ZERldmljZSAqZCA9ICpkZXY7CisgICAgICAgIHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV91bnJl
ZihkKTsKKyAgICB9CisgICAgZ19mcmVlKGRldmxpc3QpOworICAgIExPVURfREVCVUcoIiVzIDw8
IiwgX19GVU5DVElPTl9fKTsKK30KKworU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpzcGljZV91c2Jf
YmFja2VuZF9kZXZpY2VfcmVmKFNwaWNlVXNiQmFja2VuZERldmljZSAqZGV2KQoreworICAgIExP
VURfREVCVUcoIiVzID4+ICVwIiwgX19GVU5DVElPTl9fLCBkZXYpOworICAgIGdfYXRvbWljX2lu
dF9pbmMoJmRldi0+cmVmX2NvdW50KTsKKyAgICByZXR1cm4gZGV2OworfQorCit2b2lkIHNwaWNl
X3VzYl9iYWNrZW5kX2RldmljZV91bnJlZihTcGljZVVzYkJhY2tlbmREZXZpY2UgKmRldikKK3sK
KyAgICBMT1VEX0RFQlVHKCIlcyA+PiAlcCglZCkiLCBfX0ZVTkNUSU9OX18sIGRldiwgZGV2LT5y
ZWZfY291bnQpOworICAgIGlmIChnX2F0b21pY19pbnRfZGVjX2FuZF90ZXN0KCZkZXYtPnJlZl9j
b3VudCkpIHsKKyAgICAgICAgbGlidXNiX3VucmVmX2RldmljZShkZXYtPmxpYnVzYl9kZXZpY2Up
OworICAgICAgICBMT1VEX0RFQlVHKCIlcyBmcmVlaW5nICVwIChsaWJ1c2IgJXApIiwgX19GVU5D
VElPTl9fLCBkZXYsIGRldi0+bGlidXNiX2RldmljZSk7CisgICAgICAgIGdfZnJlZShkZXYpOwor
ICAgIH0KK30KKworaW50IHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9jaGVja19maWx0ZXIoCisg
ICAgU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpkZXYsCisgICAgY29uc3Qgc3RydWN0IHVzYnJlZGly
ZmlsdGVyX3J1bGUgKnJ1bGVzLAorICAgIGludCBjb3VudCkKK3sKKyAgICByZXR1cm4gdXNicmVk
aXJob3N0X2NoZWNrX2RldmljZV9maWx0ZXIoCisgICAgICAgIHJ1bGVzLCBjb3VudCwgZGV2LT5s
aWJ1c2JfZGV2aWNlLCAwKTsKK30KKworc3RhdGljIGludCB1c2JyZWRpcl9yZWFkX2NhbGxiYWNr
KHZvaWQgKnVzZXJfZGF0YSwgdWludDhfdCAqZGF0YSwgaW50IGNvdW50KQoreworICAgIFNwaWNl
VXNiQmFja2VuZENoYW5uZWwgKmNoID0gdXNlcl9kYXRhOworCisgICAgY291bnQgPSBNSU4oY2gt
PnJlYWRfYnVmX3NpemUsIGNvdW50KTsKKworICAgIGlmIChjb3VudCAhPSAwKSB7CisgICAgICAg
IG1lbWNweShkYXRhLCBjaC0+cmVhZF9idWYsIGNvdW50KTsKKyAgICB9CisKKyAgICBjaC0+cmVh
ZF9idWZfc2l6ZSAtPSBjb3VudDsKKyAgICBpZiAoY2gtPnJlYWRfYnVmX3NpemUpIHsKKyAgICAg
ICAgY2gtPnJlYWRfYnVmICs9IGNvdW50OworICAgIH0KKyAgICBlbHNlIHsKKyAgICAgICAgY2gt
PnJlYWRfYnVmID0gTlVMTDsKKyAgICB9CisgICAgU1BJQ0VfREVCVUcoIiVzIGNoICVwLCAlZCBi
eXRlcyIsIF9fRlVOQ1RJT05fXywgY2gsIGNvdW50KTsKKworICAgIHJldHVybiBjb3VudDsKK30K
Kworc3RhdGljIGNvbnN0IGNoYXIgKnN0cmlwX3VzYnJlZGlyX3ByZWZpeChjb25zdCBjaGFyICpt
c2cpCit7CisgICAgaWYgKHN0cm5jbXAobXNnLCAidXNicmVkaXJob3N0OiAiLCAxNCkgPT0gMCkg
eworICAgICAgICBtc2cgKz0gMTQ7CisgICAgfQorICAgIHJldHVybiBtc2c7Cit9CisKK3N0YXRp
YyB2b2lkIGNoYW5uZWxfZXJyb3IoU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCAqY2gsIGNvbnN0IGNo
YXIgKm1zZykKK3sKKyAgICBpZiAoIWNoLT5lcnJvcikKKyAgICAgICAgcmV0dXJuOworICAgIGdf
c2V0X2Vycm9yX2xpdGVyYWwoY2gtPmVycm9yLCBTUElDRV9DTElFTlRfRVJST1IsIFNQSUNFX0NM
SUVOVF9FUlJPUl9GQUlMRUQsIG1zZyk7CisgICAgY2gtPmVycm9yID0gTlVMTDsKK30KKworc3Rh
dGljIHZvaWQgdXNicmVkaXJfbG9nKHZvaWQgKnVzZXJfZGF0YSwgaW50IGxldmVsLCBjb25zdCBj
aGFyICptc2cpCit7CisgICAgU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCAqY2ggPSAoU3BpY2VVc2JC
YWNrZW5kQ2hhbm5lbCAqKXVzZXJfZGF0YTsKKyAgICBjb25zdCBjaGFyICpzdHJpcHBlZF9tc2cg
PSBzdHJpcF91c2JyZWRpcl9wcmVmaXgobXNnKTsKKyAgICBzd2l0Y2ggKGxldmVsKSB7CisgICAg
Y2FzZSB1c2JyZWRpcnBhcnNlcl9lcnJvcjoKKyAgICAgICAgZ19jcml0aWNhbCgiJXMiLCBtc2cp
OworICAgICAgICBjaGFubmVsX2Vycm9yKGNoLCBzdHJpcHBlZF9tc2cpOworICAgICAgICBicmVh
azsKKyAgICBjYXNlIHVzYnJlZGlycGFyc2VyX3dhcm5pbmc6CisgICAgICAgIGdfd2FybmluZygi
JXMiLCBtc2cpOworICAgICAgICBjaGFubmVsX2Vycm9yKGNoLCBzdHJpcHBlZF9tc2cpOworICAg
ICAgICBicmVhazsKKyAgICBkZWZhdWx0OgorICAgICAgICBicmVhazsKKyAgICB9Cit9CisKK3N0
YXRpYyBpbnQgdXNicmVkaXJfd3JpdGVfY2FsbGJhY2sodm9pZCAqdXNlcl9kYXRhLCB1aW50OF90
ICpkYXRhLCBpbnQgY291bnQpCit7CisgICAgU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCAqY2ggPSB1
c2VyX2RhdGE7CisgICAgaW50IHJlczsKKyAgICBTUElDRV9ERUJVRygiJXMgY2ggJXAsICVkIGJ5
dGVzIiwgX19GVU5DVElPTl9fLCBjaCwgY291bnQpOworICAgIHJlcyA9IGNoLT5jaGFubmVsX2Rh
dGEud3JpdGVfY2FsbGJhY2soY2gtPmNoYW5uZWxfZGF0YS51c2VyX2RhdGEsIGRhdGEsIGNvdW50
KTsKKyAgICByZXR1cm4gcmVzOworfQorCitzdGF0aWMgdWludDY0X3QgdXNicmVkaXJfYnVmZmVy
ZWRfb3V0cHV0X3NpemVfY2FsbGJhY2sodm9pZCAqdXNlcl9kYXRhKQoreworICAgIFNwaWNlVXNi
QmFja2VuZENoYW5uZWwgKmNoID0gdXNlcl9kYXRhOworICAgIHJldHVybiBjaC0+Y2hhbm5lbF9k
YXRhLmdldF9xdWV1ZV9zaXplKGNoLT5jaGFubmVsX2RhdGEudXNlcl9kYXRhKTsKK30KKworaW50
IHNwaWNlX3VzYl9iYWNrZW5kX3Byb3ZpZGVfcmVhZF9kYXRhKFNwaWNlVXNiQmFja2VuZENoYW5u
ZWwgKmNoLCB1aW50OF90ICpkYXRhLCBpbnQgY291bnQpCit7CisgICAgaW50IHJlcyA9IDA7CisK
KyAgICBnX3JldHVybl92YWxfaWZfZmFpbChjaC0+cmVhZF9idWYgPT0gTlVMTCwgVVNCX1JFRElS
X0VSUk9SX1JFQURfUEFSU0UpOworCisgICAgY2gtPnJlYWRfYnVmID0gZGF0YTsKKyAgICBjaC0+
cmVhZF9idWZfc2l6ZSA9IGNvdW50OworICAgIGlmIChjaC0+dXNicmVkaXJob3N0KSB7CisgICAg
ICAgIHJlcyA9IHVzYnJlZGlyaG9zdF9yZWFkX2d1ZXN0X2RhdGEoY2gtPnVzYnJlZGlyaG9zdCk7
CisgICAgfSBlbHNlIHsKKyAgICAgICAgcmVzID0gVVNCX1JFRElSX0VSUk9SX0lPOworICAgIH0K
KyAgICBzd2l0Y2ggKHJlcykKKyAgICB7CisgICAgY2FzZSB1c2JyZWRpcmhvc3RfcmVhZF9pb19l
cnJvcjoKKyAgICAgICAgcmVzID0gVVNCX1JFRElSX0VSUk9SX0lPOworICAgICAgICBicmVhazsK
KyAgICBjYXNlIHVzYnJlZGlyaG9zdF9yZWFkX3BhcnNlX2Vycm9yOgorICAgICAgICByZXMgPSBV
U0JfUkVESVJfRVJST1JfUkVBRF9QQVJTRTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSB1c2Jy
ZWRpcmhvc3RfcmVhZF9kZXZpY2VfcmVqZWN0ZWQ6CisgICAgICAgIHJlcyA9IFVTQl9SRURJUl9F
UlJPUl9ERVZfUkVKRUNURUQ7CisgICAgICAgIGJyZWFrOworICAgIGNhc2UgdXNicmVkaXJob3N0
X3JlYWRfZGV2aWNlX2xvc3Q6CisgICAgICAgIHJlcyA9IFVTQl9SRURJUl9FUlJPUl9ERVZfTE9T
VDsKKyAgICAgICAgYnJlYWs7CisgICAgfQorICAgIFNQSUNFX0RFQlVHKCIlcyBjaCAlcCwgJWQg
Ynl0ZXMsIHJlcyAlZCIsIF9fRlVOQ1RJT05fXywgY2gsIGNvdW50LCByZXMpOworCisgICAgcmV0
dXJuIHJlczsKK30KKwordm9pZCBzcGljZV91c2JfYmFja2VuZF9yZXR1cm5fd3JpdGVfZGF0YShT
cGljZVVzYkJhY2tlbmRDaGFubmVsICpjaCwgdm9pZCAqZGF0YSkKK3sKKyAgICBpZiAoY2gtPnVz
YnJlZGlyaG9zdCkgeworICAgICAgICBTUElDRV9ERUJVRygiJXMgY2ggJXAiLCBfX0ZVTkNUSU9O
X18sIGNoKTsKKyAgICAgICAgdXNicmVkaXJob3N0X2ZyZWVfd3JpdGVfYnVmZmVyKGNoLT51c2Jy
ZWRpcmhvc3QsIGRhdGEpOworICAgIH0gZWxzZSB7CisgICAgICAgIFNQSUNFX0RFQlVHKCIlcyBj
aCAlcCAtIE5PQk9EWSBUTyBDQUxMIiwgX19GVU5DVElPTl9fLCBjaCk7CisgICAgfQorfQorCitn
Ym9vbGVhbiBzcGljZV91c2JfYmFja2VuZF9jaGFubmVsX2F0dGFjaChTcGljZVVzYkJhY2tlbmRD
aGFubmVsICpjaCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNw
aWNlVXNiQmFja2VuZERldmljZSAqZGV2LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgR0Vycm9yICoqZXJyb3IpCit7CisgICAgU1BJQ0VfREVCVUcoIiVzID4+IGNo
ICVwLCBkZXYgJXAgKHdhcyBhdHRhY2hlZCAlcCkiLCBfX0ZVTkNUSU9OX18sIGNoLCBkZXYsIGNo
LT5hdHRhY2hlZCk7CisgICAgZ2Jvb2xlYW4gb2sgPSBGQUxTRTsKKyAgICBpZiAoIWRldikgewor
ICAgICAgICByZXR1cm4gb2s7CisgICAgfQorCisgICAgbGlidXNiX2RldmljZV9oYW5kbGUgKmhh
bmRsZSA9IE5VTEw7CisgICAgaW50IHJjID0gbGlidXNiX29wZW4oZGV2LT5saWJ1c2JfZGV2aWNl
LCAmaGFuZGxlKTsKKyAgICBvayA9IHJjID09IDA7CisgICAgaWYgKG9rKSB7CisgICAgICAgIGNo
LT5lcnJvciA9IGVycm9yOworICAgICAgICByYyA9IHVzYnJlZGlyaG9zdF9zZXRfZGV2aWNlKGNo
LT51c2JyZWRpcmhvc3QsIGhhbmRsZSk7CisgICAgICAgIGlmIChyYykgeworICAgICAgICAgICAg
U1BJQ0VfREVCVUcoIiVzIGNoICVwLCBkZXYgJXAgdXNicmVkaXJob3N0IGVycm9yICVkIiwgX19G
VU5DVElPTl9fLCBjaCwgZGV2LCByYyk7CisgICAgICAgICAgICBvayA9IEZBTFNFOworICAgICAg
ICB9IGVsc2UgeworICAgICAgICAgICAgY2gtPmF0dGFjaGVkID0gZGV2OworICAgICAgICAgICAg
ZGV2LT5hdHRhY2hlZF90byA9IGNoOworICAgICAgICB9CisgICAgICAgIGNoLT5lcnJvciA9IE5V
TEw7CisgICAgfSBlbHNlIHsKKyAgICAgICAgY29uc3QgY2hhciAqZGVzYyA9IGxpYnVzYl9lcnJv
cl9uYW1lKHJjKTsKKyAgICAgICAgZ19zZXRfZXJyb3IoZXJyb3IsIFNQSUNFX0NMSUVOVF9FUlJP
UiwgU1BJQ0VfQ0xJRU5UX0VSUk9SX0ZBSUxFRCwKKyAgICAgICAgICAgIkVycm9yIGxpYnVzYl9v
cGVuOiAlcyBbJWldIiwgZGVzYywgcmMpOworICAgIH0KKworICAgIHJldHVybiBvazsKK30KKwor
dm9pZCBzcGljZV91c2JfYmFja2VuZF9jaGFubmVsX2RldGFjaChTcGljZVVzYkJhY2tlbmRDaGFu
bmVsICpjaCkKK3sKKyAgICBTUElDRV9ERUJVRygiJXMgPj4gY2ggJXAsIHdhcyBhdHRhY2hlZCAl
cCIsIF9fRlVOQ1RJT05fXywgY2gsIGNoLT5hdHRhY2hlZCk7CisgICAgaWYgKCFjaC0+YXR0YWNo
ZWQpIHsKKyAgICAgICAgU1BJQ0VfREVCVUcoIiVzOiBub3RoaW5nIHRvIGRldGFjaCIsIF9fRlVO
Q1RJT05fXyk7CisgICAgICAgIHJldHVybjsKKyAgICB9CisgICAgaWYgKGNoLT51c2JyZWRpcmhv
c3QpIHsKKyAgICAgICAgLy8gaXQgd2lsbCBjYWxsIGxpYnVzYl9jbG9zZSBpbnRlcm5hbGx5Cisg
ICAgICAgIHVzYnJlZGlyaG9zdF9zZXRfZGV2aWNlKGNoLT51c2JyZWRpcmhvc3QsIE5VTEwpOwor
ICAgIH0KKyAgICBTUElDRV9ERUJVRygiJXMgY2ggJXAsIGRldGFjaCBkb25lIiwgX19GVU5DVElP
Tl9fLCBjaCk7CisgICAgY2gtPmF0dGFjaGVkLT5hdHRhY2hlZF90byA9IE5VTEw7CisgICAgY2gt
PmF0dGFjaGVkID0gTlVMTDsKK30KKworU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCAqc3BpY2VfdXNi
X2JhY2tlbmRfY2hhbm5lbF9uZXcoU3BpY2VVc2JCYWNrZW5kICpiZSwKKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IFNwaWNlVXNiQmFj
a2VuZENoYW5uZWxJbml0RGF0YSAqaW5pdF9kYXRhKQoreworICAgIFNwaWNlVXNiQmFja2VuZENo
YW5uZWwgKmNoID0gZ19uZXcwKFNwaWNlVXNiQmFja2VuZENoYW5uZWwsIDEpOworICAgIFNQSUNF
X0RFQlVHKCIlcyA+PiIsIF9fRlVOQ1RJT05fXyk7CisgICAgY2gtPmNoYW5uZWxfZGF0YSA9ICpp
bml0X2RhdGE7CisgICAgaWYgKGJlLT5saWJ1c2JfY29udGV4dCkgeworICAgICAgICBjaC0+dXNi
cmVkaXJob3N0ID0gdXNicmVkaXJob3N0X29wZW5fZnVsbCgKKyAgICAgICAgICAgIGJlLT5saWJ1
c2JfY29udGV4dCwKKyAgICAgICAgICAgIE5VTEwsCisgICAgICAgICAgICB1c2JyZWRpcl9sb2cs
CisgICAgICAgICAgICB1c2JyZWRpcl9yZWFkX2NhbGxiYWNrLAorICAgICAgICAgICAgdXNicmVk
aXJfd3JpdGVfY2FsbGJhY2ssCisgICAgICAgICAgICB1c2JyZWRpcl93cml0ZV9mbHVzaF9jYWxs
YmFjaywKKyAgICAgICAgICAgIHVzYnJlZGlyX2FsbG9jX2xvY2ssCisgICAgICAgICAgICB1c2Jy
ZWRpcl9sb2NrX2xvY2ssCisgICAgICAgICAgICB1c2JyZWRpcl91bmxvY2tfbG9jaywKKyAgICAg
ICAgICAgIHVzYnJlZGlyX2ZyZWVfbG9jaywKKyAgICAgICAgICAgIGNoLCBQQUNLQUdFX1NUUklO
RywKKyAgICAgICAgICAgIHNwaWNlX3V0aWxfZ2V0X2RlYnVnKCkgPyB1c2JyZWRpcnBhcnNlcl9k
ZWJ1ZyA6IHVzYnJlZGlycGFyc2VyX3dhcm5pbmcsCisgICAgICAgICAgICB1c2JyZWRpcmhvc3Rf
Zmxfd3JpdGVfY2Jfb3duc19idWZmZXIpOworICAgICAgICBnX3dhcm5faWZfZmFpbChjaC0+dXNi
cmVkaXJob3N0ICE9IE5VTEwpOworICAgIH0KKyAgICBpZiAoY2gtPnVzYnJlZGlyaG9zdCkgewor
ICAgICAgICB1c2JyZWRpcmhvc3Rfc2V0X2J1ZmZlcmVkX291dHB1dF9zaXplX2NiKGNoLT51c2Jy
ZWRpcmhvc3QsIHVzYnJlZGlyX2J1ZmZlcmVkX291dHB1dF9zaXplX2NhbGxiYWNrKTsKKyAgICB9
IGVsc2UgeworICAgICAgICBnX2ZyZWUoY2gpOworICAgICAgICBjaCA9IE5VTEw7CisgICAgfQor
CisgICAgU1BJQ0VfREVCVUcoIiVzIDw8ICVwIiwgX19GVU5DVElPTl9fLCBjaCk7CisgICAgcmV0
dXJuIGNoOworfQorCit2b2lkIHNwaWNlX3VzYl9iYWNrZW5kX2NoYW5uZWxfdXAoU3BpY2VVc2JC
YWNrZW5kQ2hhbm5lbCAqY2gpCit7CisgICAgU1BJQ0VfREVCVUcoIiVzICVwLCBob3N0ICVwIiwg
X19GVU5DVElPTl9fLCBjaCwgY2gtPnVzYnJlZGlyaG9zdCk7CisgICAgaWYgKGNoLT51c2JyZWRp
cmhvc3QpIHsKKyAgICAgICAgdXNicmVkaXJob3N0X3dyaXRlX2d1ZXN0X2RhdGEoY2gtPnVzYnJl
ZGlyaG9zdCk7CisgICAgfQorfQorCit2b2lkIHNwaWNlX3VzYl9iYWNrZW5kX2NoYW5uZWxfZGVs
ZXRlKFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmNoKQoreworICAgIFNQSUNFX0RFQlVHKCIlcyA+
PiAlcCIsIF9fRlVOQ1RJT05fXywgY2gpOworICAgIGlmIChjaC0+dXNicmVkaXJob3N0KSB7Cisg
ICAgICAgIHVzYnJlZGlyaG9zdF9jbG9zZShjaC0+dXNicmVkaXJob3N0KTsKKyAgICB9CisKKyAg
ICBpZiAoY2gtPnJ1bGVzKSB7CisgICAgICAgIGdfZnJlZShjaC0+cnVsZXMpOworICAgIH0KKwor
ICAgIGdfZnJlZShjaCk7CisgICAgU1BJQ0VfREVCVUcoIiVzIDw8ICVwIiwgX19GVU5DVElPTl9f
LCBjaCk7Cit9CisKK3ZvaWQgc3BpY2VfdXNiX2JhY2tlbmRfY2hhbm5lbF9nZXRfZ3Vlc3RfZmls
dGVyKAorICAgIFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmNoLAorICAgIGNvbnN0IHN0cnVjdCB1
c2JyZWRpcmZpbHRlcl9ydWxlICoqciwKKyAgICBpbnQgKmNvdW50KQoreworICAgIGludCBpOwor
ICAgICpyID0gTlVMTDsKKyAgICAqY291bnQgPSAwOworICAgIGlmIChjaC0+dXNicmVkaXJob3N0
KSB7CisgICAgICAgIHVzYnJlZGlyaG9zdF9nZXRfZ3Vlc3RfZmlsdGVyKGNoLT51c2JyZWRpcmhv
c3QsIHIsIGNvdW50KTsKKyAgICB9CisgICAgaWYgKCpyID09IE5VTEwpIHsKKyAgICAgICAgKnIg
PSBjaC0+cnVsZXM7CisgICAgICAgICpjb3VudCA9IGNoLT5ydWxlc19jb3VudDsKKyAgICB9CisK
KyAgICBpZiAoKmNvdW50KSB7CisgICAgICAgIFNQSUNFX0RFQlVHKCIlcyBjaCAlcDogJWQgZmls
dGVycyIsIF9fRlVOQ1RJT05fXywgY2gsICpjb3VudCk7CisgICAgfQorICAgIGZvciAoaSA9IDA7
IGkgPCAqY291bnQ7IGkrKykgeworICAgICAgICBjb25zdCBzdHJ1Y3QgdXNicmVkaXJmaWx0ZXJf
cnVsZSAqcmEgPSAqcjsKKyAgICAgICAgU1BJQ0VfREVCVUcoIiVzIGNsYXNzICVkLCAlWDolWCIs
CisgICAgICAgICAgICByYVtpXS5hbGxvdyA/ICJhbGxvd2VkIiA6ICJkZW5pZWQiLCByYVtpXS5k
ZXZpY2VfY2xhc3MsCisgICAgICAgICAgICAodWludDMyX3QpcmFbaV0udmVuZG9yX2lkLCAodWlu
dDMyX3QpcmFbaV0ucHJvZHVjdF9pZCk7CisgICAgfQorfQorCisjZW5kaWYgLy8gVVNCX1JFRElS
CmRpZmYgLS1naXQgYS9zcmMvdXNiLWJhY2tlbmQuaCBiL3NyYy91c2ItYmFja2VuZC5oCm5ldyBm
aWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAuLjkxMzc5MTYKLS0tIC9kZXYvbnVsbAorKysg
Yi9zcmMvdXNiLWJhY2tlbmQuaApAQCAtMCwwICsxLDExMCBAQAorLyogLSotIE1vZGU6IEM7IGMt
YmFzaWMtb2Zmc2V0OiA0OyBpbmRlbnQtdGFicy1tb2RlOiBuaWwgLSotICovCisvKgorICAgIENv
cHlyaWdodCAoQykgMjAxOCBSZWQgSGF0LCBJbmMuCisKKyAgICBSZWQgSGF0IEF1dGhvcnM6Cisg
ICAgWXVyaSBCZW5kaXRvdmljaDx5YmVuZGl0b0ByZWRoYXQuY29tPgorCisgICAgVGhpcyBsaWJy
YXJ5IGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vcgorICAg
IG1vZGlmeSBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJs
aWMKKyAgICBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0
aW9uOyBlaXRoZXIKKyAgICB2ZXJzaW9uIDIuMSBvZiB0aGUgTGljZW5zZSwgb3IgKGF0IHlvdXIg
b3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4KKworICAgIFRoaXMgbGlicmFyeSBpcyBkaXN0cmli
dXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAorICAgIGJ1dCBXSVRIT1VU
IEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCisgICAg
TUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2Vl
IHRoZSBHTlUKKyAgICBMZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRh
aWxzLgorCisgICAgWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIExl
c3NlciBHZW5lcmFsIFB1YmxpYworICAgIExpY2Vuc2UgYWxvbmcgd2l0aCB0aGlzIGxpYnJhcnk7
IGlmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4KKyovCisKKyNpZm5k
ZWYgX19TUElDRV9VU0JfQkFDS0VORF9IX18KKyNkZWZpbmUgX19TUElDRV9VU0JfQkFDS0VORF9I
X18KKworI2luY2x1ZGUgPHVzYnJlZGlyZmlsdGVyLmg+CisjaW5jbHVkZSAidXNiLWRldmljZS1t
YW5hZ2VyLmgiCisKK0dfQkVHSU5fREVDTFMKKwordHlwZWRlZiBzdHJ1Y3QgX1NwaWNlVXNiQmFj
a2VuZCBTcGljZVVzYkJhY2tlbmQ7Cit0eXBlZGVmIHN0cnVjdCBfU3BpY2VVc2JCYWNrZW5kRGV2
aWNlIFNwaWNlVXNiQmFja2VuZERldmljZTsKK3R5cGVkZWYgc3RydWN0IF9TcGljZVVzYkJhY2tl
bmRDaGFubmVsIFNwaWNlVXNiQmFja2VuZENoYW5uZWw7CisKK3R5cGVkZWYgc3RydWN0IFVzYkRl
dmljZUluZm9ybWF0aW9uCit7CisgICAgdWludDE2X3QgYnVzOworICAgIHVpbnQxNl90IGFkZHJl
c3M7CisgICAgdWludDE2X3QgdmlkOworICAgIHVpbnQxNl90IHBpZDsKKyAgICB1aW50OF90IGNs
YXNzOworICAgIHVpbnQ4X3Qgc3ViY2xhc3M7CisgICAgdWludDhfdCBwcm90b2NvbDsKK30gVXNi
RGV2aWNlSW5mb3JtYXRpb247CisKK3R5cGVkZWYgc3RydWN0IFNwaWNlVXNiQmFja2VuZENoYW5u
ZWxJbml0RGF0YQoreworICAgIHZvaWQgKnVzZXJfZGF0YTsKKyAgICBpbnQgKCp3cml0ZV9jYWxs
YmFjaykodm9pZCAqdXNlcl9kYXRhLCB1aW50OF90ICpkYXRhLCBpbnQgY291bnQpOworICAgIGdi
b29sZWFuICgqaXNfY2hhbm5lbF9yZWFkeSkodm9pZCAqdXNlcl9kYXRhKTsKKyAgICB1aW50NjRf
dCAoKmdldF9xdWV1ZV9zaXplKSh2b2lkICp1c2VyX2RhdGEpOworfSBTcGljZVVzYkJhY2tlbmRD
aGFubmVsSW5pdERhdGE7CisKK3R5cGVkZWYgdm9pZCgqdXNiX2hvdF9wbHVnX2NhbGxiYWNrKSh2
b2lkICp1c2VyX2RhdGEsIFNwaWNlVXNiQmFja2VuZERldmljZSAqZGV2LCBnYm9vbGVhbiBhZGRl
ZCk7CisKK2VudW0geworICAgIFVTQl9SRURJUl9FUlJPUl9JTyA9IC0xLAorICAgIFVTQl9SRURJ
Ul9FUlJPUl9SRUFEX1BBUlNFID0gLTIsCisgICAgVVNCX1JFRElSX0VSUk9SX0RFVl9SRUpFQ1RF
RCA9IC0zLAorICAgIFVTQl9SRURJUl9FUlJPUl9ERVZfTE9TVCA9IC00LAorfTsKKworLyogU3Bp
Y2UgVVNCIGJhY2tlbmQgQVBJICovCisvKiBzZXRzIGVycm9yIG9uIGZhaWx1cmUgKi8KK1NwaWNl
VXNiQmFja2VuZCAqc3BpY2VfdXNiX2JhY2tlbmRfbmV3KEdFcnJvciAqKmVycm9yKTsKK3ZvaWQg
c3BpY2VfdXNiX2JhY2tlbmRfZGVsZXRlKFNwaWNlVXNiQmFja2VuZCAqY29udGV4dCk7CisKKy8q
CityZXR1cm5zIG5ld2x5LWFsbG9jYXRlZCBudWxsLXRlcm1pbmF0ZWQgbGlzdCBvZgorU3BpY2VV
c2JCYWNrZW5kRGV2aWNlIHBvaW50ZXJzLgorVGhlIGNhbGxlciBtdXN0IGNhbGwgc3BpY2VfdXNi
X2JhY2tlbmRfZnJlZV9kZXZpY2VfbGlzdAorYWZ0ZXIgaXQgZmluaXNoZXMgbGlzdCBwcm9jZXNz
aW5nCisqLworU3BpY2VVc2JCYWNrZW5kRGV2aWNlICoqc3BpY2VfdXNiX2JhY2tlbmRfZ2V0X2Rl
dmljZV9saXN0KFNwaWNlVXNiQmFja2VuZCAqYmFja2VuZCk7Cit2b2lkIHNwaWNlX3VzYl9iYWNr
ZW5kX2ZyZWVfZGV2aWNlX2xpc3QoU3BpY2VVc2JCYWNrZW5kRGV2aWNlICoqZGV2bGlzdCk7Citn
Ym9vbGVhbiBzcGljZV91c2JfYmFja2VuZF9oYW5kbGVfZXZlbnRzKFNwaWNlVXNiQmFja2VuZCAq
YmUpOworZ2Jvb2xlYW4gc3BpY2VfdXNiX2JhY2tlbmRfcmVnaXN0ZXJfaG90cGx1ZyhTcGljZVVz
YkJhY2tlbmQgKmJlLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICB2b2lkICp1c2VyX2RhdGEsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHVzYl9ob3RfcGx1Z19jYWxsYmFjayBwcm9jKTsKK3ZvaWQgc3BpY2VfdXNiX2JhY2tl
bmRfZGVyZWdpc3Rlcl9ob3RwbHVnKFNwaWNlVXNiQmFja2VuZCAqYmUpOworCisvKiBTcGljZSBV
U0IgYmFja2VuZCBkZXZpY2UgQVBJICovCitnYm9vbGVhbiBzcGljZV91c2JfYmFja2VuZF9kZXZp
Y2VfaXNfaHViKFNwaWNlVXNiQmFja2VuZERldmljZSAqZGV2KTsKK1NwaWNlVXNiQmFja2VuZERl
dmljZSAqc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX3JlZihTcGljZVVzYkJhY2tlbmREZXZpY2Ug
KmRldik7Cit2b2lkIHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV91bnJlZihTcGljZVVzYkJhY2tl
bmREZXZpY2UgKmRldik7CitnY29uc3Rwb2ludGVyIHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9n
ZXRfbGliZGV2KFNwaWNlVXNiQmFja2VuZERldmljZSAqZGV2KTsKK2NvbnN0IFVzYkRldmljZUlu
Zm9ybWF0aW9uKiBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfZ2V0X2luZm8oU3BpY2VVc2JCYWNr
ZW5kRGV2aWNlICpkZXYpOworZ2Jvb2xlYW4gc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX2lzb2No
KFNwaWNlVXNiQmFja2VuZERldmljZSAqZGV2KTsKKy8qIHJldHVybnMgMCBpZiB0aGUgZGV2aWNl
IHBhc3NlcyB0aGUgZmlsdGVyICovCitpbnQgc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX2NoZWNr
X2ZpbHRlcihTcGljZVVzYkJhY2tlbmREZXZpY2UgKmRldiwKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0cnVjdCB1c2JyZWRpcmZpbHRlcl9ydWxlICpy
dWxlcywgaW50IGNvdW50KTsKKworLyogU3BpY2UgVVNCIGJhY2tlbmQgY2hhbm5lbCBBUEkgKi8K
K1NwaWNlVXNiQmFja2VuZENoYW5uZWwgKnNwaWNlX3VzYl9iYWNrZW5kX2NoYW5uZWxfbmV3KFNw
aWNlVXNiQmFja2VuZCAqY29udGV4dCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IFNwaWNlVXNiQmFja2VuZENoYW5uZWxJbml0RGF0
YSAqaW5pdF9kYXRhKTsKK3ZvaWQgc3BpY2VfdXNiX2JhY2tlbmRfY2hhbm5lbF9kZWxldGUoU3Bp
Y2VVc2JCYWNrZW5kQ2hhbm5lbCAqY2gpOworLyogcmV0dXJucyAwIGZvciBzdWNjZXNzIG9yIGVy
cm9yIGNvZGUgKi8KK2ludCBzcGljZV91c2JfYmFja2VuZF9wcm92aWRlX3JlYWRfZGF0YShTcGlj
ZVVzYkJhY2tlbmRDaGFubmVsICpjaCwgdWludDhfdCAqZGF0YSwgaW50IGNvdW50KTsKK2dib29s
ZWFuIHNwaWNlX3VzYl9iYWNrZW5kX2NoYW5uZWxfYXR0YWNoKFNwaWNlVXNiQmFja2VuZENoYW5u
ZWwgKmNoLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU3BpY2VV
c2JCYWNrZW5kRGV2aWNlICpkZXYsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBHRXJyb3IgKiplcnJvcik7Cit2b2lkIHNwaWNlX3VzYl9iYWNrZW5kX2NoYW5uZWxf
ZGV0YWNoKFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmNoKTsKK3ZvaWQgc3BpY2VfdXNiX2JhY2tl
bmRfY2hhbm5lbF91cChTcGljZVVzYkJhY2tlbmRDaGFubmVsICpjaCk7Cit2b2lkIHNwaWNlX3Vz
Yl9iYWNrZW5kX2NoYW5uZWxfZ2V0X2d1ZXN0X2ZpbHRlcihTcGljZVVzYkJhY2tlbmRDaGFubmVs
ICpjaCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNv
bnN0IHN0cnVjdCB1c2JyZWRpcmZpbHRlcl9ydWxlICAqKnJ1bGVzLAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50ICpjb3VudCk7Cit2b2lkIHNwaWNl
X3VzYl9iYWNrZW5kX3JldHVybl93cml0ZV9kYXRhKFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmNo
LCB2b2lkICpkYXRhKTsKKworR19FTkRfREVDTFMKKworI2VuZGlmCmRpZmYgLS1naXQgYS9zcmMv
dXNiLWRldmljZS1tYW5hZ2VyLXByaXYuaCBiL3NyYy91c2ItZGV2aWNlLW1hbmFnZXItcHJpdi5o
CmluZGV4IDgzODg0ZDcuLjM5YWFmMmYgMTAwNjQ0Ci0tLSBhL3NyYy91c2ItZGV2aWNlLW1hbmFn
ZXItcHJpdi5oCisrKyBiL3NyYy91c2ItZGV2aWNlLW1hbmFnZXItcHJpdi5oCkBAIC0zMiw3ICsz
Miw2IEBAIHZvaWQgc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX3N0b3BfZXZlbnRfbGlzdGVuaW5n
KAogICAgIFNwaWNlVXNiRGV2aWNlTWFuYWdlciAqbWFuYWdlcik7CiAKICNpZmRlZiBVU0VfVVNC
UkVESVIKLSNpbmNsdWRlIDxsaWJ1c2IuaD4KIHZvaWQgc3BpY2VfdXNiX2RldmljZV9tYW5hZ2Vy
X2RldmljZV9lcnJvcigKICAgICBTcGljZVVzYkRldmljZU1hbmFnZXIgKm1hbmFnZXIsIFNwaWNl
VXNiRGV2aWNlICpkZXZpY2UsIEdFcnJvciAqZXJyKTsKIApkaWZmIC0tZ2l0IGEvc3JjL3VzYi1k
ZXZpY2UtbWFuYWdlci5jIGIvc3JjL3VzYi1kZXZpY2UtbWFuYWdlci5jCmluZGV4IGMxZGY5Nzcu
LjJiZWU1NWQgMTAwNjQ0Ci0tLSBhL3NyYy91c2ItZGV2aWNlLW1hbmFnZXIuYworKysgYi9zcmMv
dXNiLWRldmljZS1tYW5hZ2VyLmMKQEAgLTI1LDE1ICsyNSwxNCBAQAogCiAjaWZkZWYgVVNFX1VT
QlJFRElSCiAjaW5jbHVkZSA8ZXJybm8uaD4KLSNpbmNsdWRlIDxsaWJ1c2IuaD4KIAogI2lmZGVm
IEdfT1NfV0lOMzIKKyNpbmNsdWRlIDx3aW5kb3dzLmg+CiAjaW5jbHVkZSAidXNiZGtfYXBpLmgi
CiAjaW5jbHVkZSAid2luLXVzYi1kZXYuaCIKICNlbmRpZgogCiAjaW5jbHVkZSAiY2hhbm5lbC11
c2JyZWRpci1wcml2LmgiCi0jaW5jbHVkZSAidXNicmVkaXJob3N0LmgiCiAjaW5jbHVkZSAidXNi
dXRpbC5oIgogI2VuZGlmCiAKQEAgLTk0LDcgKzkzLDcgQEAgc3RydWN0IF9TcGljZVVzYkRldmlj
ZU1hbmFnZXJQcml2YXRlIHsKICAgICBnY2hhciAqYXV0b19jb25uZWN0X2ZpbHRlcjsKICAgICBn
Y2hhciAqcmVkaXJlY3Rfb25fY29ubmVjdDsKICNpZmRlZiBVU0VfVVNCUkVESVIKLSAgICBsaWJ1
c2JfY29udGV4dCAqY29udGV4dDsKKyAgICBTcGljZVVzYkJhY2tlbmQgKmNvbnRleHQ7CiAgICAg
aW50IGV2ZW50X2xpc3RlbmVyczsKICAgICBHVGhyZWFkICpldmVudF90aHJlYWQ7CiAgICAgZ2lu
dCBldmVudF90aHJlYWRfcnVuOwpAQCAtMTA2LDcgKzEwNSw2IEBAIHN0cnVjdCBfU3BpY2VVc2JE
ZXZpY2VNYW5hZ2VyUHJpdmF0ZSB7CiAgICAgR1VkZXZDbGllbnQgKnVkZXY7CiAjZWxzZQogICAg
IGdib29sZWFuIHJlZGlyZWN0aW5nOyAvKiBIYW5kbGVkIGJ5IEdVZGV2Q2xpZW50IGluIHRoZSBn
dWRldiBjYXNlICovCi0gICAgbGlidXNiX2hvdHBsdWdfY2FsbGJhY2tfaGFuZGxlIGhwX2hhbmRs
ZTsKICNlbmRpZgogI2lmZGVmIEdfT1NfV0lOMzIKICAgICB1c2Jka19hcGlfd3JhcHBlciAgICAg
KnVzYmRrX2FwaTsKQEAgLTEzNiw3ICsxMzQsNyBAQCB0eXBlZGVmIHN0cnVjdCBfU3BpY2VVc2JE
ZXZpY2VJbmZvIHsKICAgICBndWludDE2IHZpZDsKICAgICBndWludDE2IHBpZDsKICAgICBnYm9v
bGVhbiBpc29jaHJvbm91czsKLSAgICBsaWJ1c2JfZGV2aWNlICpsaWJkZXY7CisgICAgU3BpY2VV
c2JCYWNrZW5kRGV2aWNlICpiZGV2OwogICAgIGdpbnQgICAgcmVmOwogfSBTcGljZVVzYkRldmlj
ZUluZm87CiAKQEAgLTE0OSwxOSArMTQ3LDE4IEBAIHN0YXRpYyB2b2lkIGNoYW5uZWxfZXZlbnQo
U3BpY2VDaGFubmVsICpjaGFubmVsLCBTcGljZUNoYW5uZWxFdmVudCBldmVudCwKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgZ3BvaW50ZXIgdXNlcl9kYXRhKTsKICNpZmRlZiBHX09TX1dJTjMy
CiBzdGF0aWMgdm9pZCBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfdWV2ZW50X2NiKEdVZGV2Q2xp
ZW50ICAgICAqY2xpZW50LAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBsaWJ1c2JfZGV2aWNlICAgKnVkZXZpY2UsCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIFNwaWNlVXNiQmFja2VuZERldmljZSAqdWRldmljZSwK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2Jvb2xlYW4g
ICAgICAgICBhZGQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGdwb2ludGVyICAgICAgICAgdXNlcl9kYXRhKTsKICNlbHNlCi1zdGF0aWMgaW50IHNwaWNl
X3VzYl9kZXZpY2VfbWFuYWdlcl9ob3RwbHVnX2NiKGxpYnVzYl9jb250ZXh0ICAgICAgICpjdHgs
Ci0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpYnVzYl9k
ZXZpY2UgICAgICAgICpkZXZpY2UsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGxpYnVzYl9ob3RwbHVnX2V2ZW50ICBldmVudCwKLSAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdm9pZCAgICAgICAgICAgICAgICAgKmRh
dGEpOworc3RhdGljIHZvaWQgc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2hvdHBsdWdfY2Iodm9p
ZCAqdXNlcl9kYXRhLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpkZXYsCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBnYm9vbGVhbiBhZGRlZCk7CiAjZW5kaWYKIHN0YXRp
YyB2b2lkIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9jaGVja19yZWRpcl9vbl9jb25uZWN0KAog
ICAgIFNwaWNlVXNiRGV2aWNlTWFuYWdlciAqc2VsZiwgU3BpY2VDaGFubmVsICpjaGFubmVsKTsK
IAotc3RhdGljIFNwaWNlVXNiRGV2aWNlSW5mbyAqc3BpY2VfdXNiX2RldmljZV9uZXcobGlidXNi
X2RldmljZSAqbGliZGV2KTsKK3N0YXRpYyBTcGljZVVzYkRldmljZUluZm8gKnNwaWNlX3VzYl9k
ZXZpY2VfbmV3KFNwaWNlVXNiQmFja2VuZERldmljZSAqYmRldik7CiBzdGF0aWMgU3BpY2VVc2JE
ZXZpY2UgKnNwaWNlX3VzYl9kZXZpY2VfcmVmKFNwaWNlVXNiRGV2aWNlICpkZXZpY2UpOwogc3Rh
dGljIHZvaWQgc3BpY2VfdXNiX2RldmljZV91bnJlZihTcGljZVVzYkRldmljZSAqZGV2aWNlKTsK
IApAQCAtMTcwLDEyICsxNjcsMTIgQEAgc3RhdGljIHZvaWQgX3VzYmRrX2hpZGVyX3VwZGF0ZShT
cGljZVVzYkRldmljZU1hbmFnZXIgKm1hbmFnZXIpOwogc3RhdGljIHZvaWQgX3VzYmRrX2hpZGVy
X2NsZWFyKFNwaWNlVXNiRGV2aWNlTWFuYWdlciAqbWFuYWdlcik7CiAjZW5kaWYKIAotc3RhdGlj
IGdib29sZWFuIHNwaWNlX3VzYl9tYW5hZ2VyX2RldmljZV9lcXVhbF9saWJkZXYoU3BpY2VVc2JE
ZXZpY2VNYW5hZ2VyICptYW5hZ2VyLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgU3BpY2VVc2JEZXZpY2UgKmRldmljZSwKLSAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpYnVzYl9kZXZpY2Ug
KmxpYmRldik7Ci1zdGF0aWMgbGlidXNiX2RldmljZSAqCi1zcGljZV91c2JfZGV2aWNlX21hbmFn
ZXJfZGV2aWNlX3RvX2xpYmRldihTcGljZVVzYkRldmljZU1hbmFnZXIgKnNlbGYsCi0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTcGljZVVzYkRldmljZSAqZGV2aWNl
KTsKK3N0YXRpYyBnYm9vbGVhbiBzcGljZV91c2JfbWFuYWdlcl9kZXZpY2VfZXF1YWxfYmRldihT
cGljZVVzYkRldmljZU1hbmFnZXIgKm1hbmFnZXIsCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgU3BpY2VVc2JEZXZpY2UgKmRldmljZSwKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTcGljZVVzYkJh
Y2tlbmREZXZpY2UgKmJkZXYpOworc3RhdGljIFNwaWNlVXNiQmFja2VuZERldmljZSAqCitzcGlj
ZV91c2JfZGV2aWNlX21hbmFnZXJfZGV2aWNlX3RvX2JkZXYoU3BpY2VVc2JEZXZpY2VNYW5hZ2Vy
ICpzZWxmLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNwaWNlVXNi
RGV2aWNlICpkZXZpY2UpOwogCiBzdGF0aWMgdm9pZAogX3NwaWNlX3VzYl9kZXZpY2VfbWFuYWdl
cl9jb25uZWN0X2RldmljZV9hc3luYyhTcGljZVVzYkRldmljZU1hbmFnZXIgKnNlbGYsCkBAIC0y
NzcsMTQgKzI3NCw5IEBAIHN0YXRpYyBnYm9vbGVhbiBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJf
aW5pdGFibGVfaW5pdChHSW5pdGFibGUgICppbml0YWJsZSwKICAgICBHTGlzdCAqaXQ7CiAKICNp
Zm5kZWYgR19PU19XSU4zMgotICAgIGludCByYzsKICAgICAvKiBJbml0aWFsaXplIGxpYnVzYiAq
LwotICAgIHJjID0gbGlidXNiX2luaXQoJnByaXYtPmNvbnRleHQpOwotICAgIGlmIChyYyA8IDAp
IHsKLSAgICAgICAgY29uc3QgY2hhciAqZGVzYyA9IGxpYnVzYl9lcnJvcl9uYW1lKHJjKTsKLSAg
ICAgICAgZ193YXJuaW5nKCJFcnJvciBpbml0aWFsaXppbmcgVVNCIHN1cHBvcnQ6ICVzIFslaV0i
LCBkZXNjLCByYyk7Ci0gICAgICAgIGdfc2V0X2Vycm9yKGVyciwgU1BJQ0VfQ0xJRU5UX0VSUk9S
LCBTUElDRV9DTElFTlRfRVJST1JfRkFJTEVELAotICAgICAgICAgICAgICAgICAgICAiRXJyb3Ig
aW5pdGlhbGl6aW5nIFVTQiBzdXBwb3J0OiAlcyBbJWldIiwgZGVzYywgcmMpOworICAgIHByaXYt
PmNvbnRleHQgPSBzcGljZV91c2JfYmFja2VuZF9uZXcoZXJyKTsKKyAgICBpZiAoIXByaXYtPmNv
bnRleHQpIHsKICAgICAgICAgcmV0dXJuIEZBTFNFOwogICAgIH0KICNlbmRpZgpAQCAtMzAyLDE2
ICsyOTQsOCBAQCBzdGF0aWMgZ2Jvb2xlYW4gc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2luaXRh
YmxlX2luaXQoR0luaXRhYmxlICAqaW5pdGFibGUsCiAgICAgLyogRG8gY29sZHBsdWcgKGRldGVj
dGlvbiBvZiBhbHJlYWR5IGNvbm5lY3RlZCBkZXZpY2VzKSAqLwogICAgIGdfdWRldl9jbGllbnRf
cmVwb3J0X2RldmljZXMocHJpdi0+dWRldik7CiAjZWxzZQotICAgIHJjID0gbGlidXNiX2hvdHBs
dWdfcmVnaXN0ZXJfY2FsbGJhY2socHJpdi0+Y29udGV4dCwKLSAgICAgICAgTElCVVNCX0hPVFBM
VUdfRVZFTlRfREVWSUNFX0FSUklWRUQgfCBMSUJVU0JfSE9UUExVR19FVkVOVF9ERVZJQ0VfTEVG
VCwKLSAgICAgICAgTElCVVNCX0hPVFBMVUdfRU5VTUVSQVRFLCBMSUJVU0JfSE9UUExVR19NQVRD
SF9BTlksCi0gICAgICAgIExJQlVTQl9IT1RQTFVHX01BVENIX0FOWSwgTElCVVNCX0hPVFBMVUdf
TUFUQ0hfQU5ZLAotICAgICAgICBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfaG90cGx1Z19jYiwg
c2VsZiwgJnByaXYtPmhwX2hhbmRsZSk7Ci0gICAgaWYgKHJjIDwgMCkgewotICAgICAgICBjb25z
dCBjaGFyICpkZXNjID0gbGlidXNiX2Vycm9yX25hbWUocmMpOwotICAgICAgICBnX3dhcm5pbmco
IkVycm9yIGluaXRpYWxpemluZyBVU0IgaG90cGx1ZyBzdXBwb3J0OiAlcyBbJWldIiwgZGVzYywg
cmMpOwotICAgICAgICBnX3NldF9lcnJvcihlcnIsIFNQSUNFX0NMSUVOVF9FUlJPUiwgU1BJQ0Vf
Q0xJRU5UX0VSUk9SX0ZBSUxFRCwKLSAgICAgICAgICAgICAgICAgICJFcnJvciBpbml0aWFsaXpp
bmcgVVNCIGhvdHBsdWcgc3VwcG9ydDogJXMgWyVpXSIsIGRlc2MsIHJjKTsKKyAgICBpZiAoIXNw
aWNlX3VzYl9iYWNrZW5kX3JlZ2lzdGVyX2hvdHBsdWcocHJpdi0+Y29udGV4dCwgc2VsZiwKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BpY2VfdXNiX2Rldmlj
ZV9tYW5hZ2VyX2hvdHBsdWdfY2IpKSB7CiAgICAgICAgIHJldHVybiBGQUxTRTsKICAgICB9CiAg
ICAgc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX3N0YXJ0X2V2ZW50X2xpc3RlbmluZyhzZWxmLCBO
VUxMKTsKQEAgLTM0MiwyMSArMzI2LDE3IEBAIHN0YXRpYyB2b2lkIHNwaWNlX3VzYl9kZXZpY2Vf
bWFuYWdlcl9kaXNwb3NlKEdPYmplY3QgKmdvYmplY3QpCiAgICAgU3BpY2VVc2JEZXZpY2VNYW5h
Z2VyUHJpdmF0ZSAqcHJpdiA9IHNlbGYtPnByaXY7CiAKICNpZm5kZWYgR19PU19XSU4zMgotICAg
IGlmIChwcml2LT5ocF9oYW5kbGUpIHsKLSAgICAgICAgc3BpY2VfdXNiX2RldmljZV9tYW5hZ2Vy
X3N0b3BfZXZlbnRfbGlzdGVuaW5nKHNlbGYpOwotICAgICAgICBpZiAoZ19hdG9taWNfaW50X2dl
dCgmcHJpdi0+ZXZlbnRfdGhyZWFkX3J1bikpIHsKLSAgICAgICAgICAgIC8qIEZvcmNlIHRlcm1p
bmF0aW9uIG9mIHRoZSBldmVudCB0aHJlYWQgZXZlbiBpZiB0aGVyZSB3ZXJlIHNvbWUKLSAgICAg
ICAgICAgICAqIG1pc21hdGNoZWQgc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX3tzdGFydCxzdG9w
fV9ldmVudF9saXN0ZW5pbmcKLSAgICAgICAgICAgICAqIGNhbGxzLiBPdGhlcndpc2UsIHRoZSB1
c2IgZXZlbnQgdGhyZWFkIHdpbGwgYmUgbGVha2VkLCBhbmQgd2lsbAotICAgICAgICAgICAgICog
dHJ5IHRvIHVzZSB0aGUgbGlidXNiIGNvbnRleHQgd2UgZGVzdHJveSBpbiBmaW5hbGl6ZSgpLCB3
aGljaCB3b3VsZAotICAgICAgICAgICAgICogY2F1c2UgYSBjcmFzaCAqLwotICAgICAgICAgICAg
IGdfd2Fybl9pZl9yZWFjaGVkKCk7Ci0gICAgICAgICAgICAgZ19hdG9taWNfaW50X3NldCgmcHJp
di0+ZXZlbnRfdGhyZWFkX3J1biwgRkFMU0UpOwotICAgICAgICB9Ci0gICAgICAgIC8qIFRoaXMg
YWxzbyB3YWtlcyB1cCB0aGUgbGlidXNiX2hhbmRsZV9ldmVudHMoKSBpbiB0aGUgZXZlbnRfdGhy
ZWFkICovCi0gICAgICAgIGxpYnVzYl9ob3RwbHVnX2RlcmVnaXN0ZXJfY2FsbGJhY2socHJpdi0+
Y29udGV4dCwgcHJpdi0+aHBfaGFuZGxlKTsKLSAgICAgICAgcHJpdi0+aHBfaGFuZGxlID0gMDsK
KyAgICBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfc3RvcF9ldmVudF9saXN0ZW5pbmcoc2VsZik7
CisgICAgaWYgKGdfYXRvbWljX2ludF9nZXQoJnByaXYtPmV2ZW50X3RocmVhZF9ydW4pKSB7Cisg
ICAgICAgIC8qIEZvcmNlIHRlcm1pbmF0aW9uIG9mIHRoZSBldmVudCB0aHJlYWQgZXZlbiBpZiB0
aGVyZSB3ZXJlIHNvbWUKKyAgICAgICAgICogbWlzbWF0Y2hlZCBzcGljZV91c2JfZGV2aWNlX21h
bmFnZXJfe3N0YXJ0LHN0b3B9X2V2ZW50X2xpc3RlbmluZworICAgICAgICAgKiBjYWxscy4gT3Ro
ZXJ3aXNlLCB0aGUgdXNiIGV2ZW50IHRocmVhZCB3aWxsIGJlIGxlYWtlZCwgYW5kIHdpbGwKKyAg
ICAgICAgICogdHJ5IHRvIHVzZSB0aGUgbGlidXNiIGNvbnRleHQgd2UgZGVzdHJveSBpbiBmaW5h
bGl6ZSgpLCB3aGljaCB3b3VsZAorICAgICAgICAgKiBjYXVzZSBhIGNyYXNoICovCisgICAgICAg
IGdfd2Fybl9pZl9yZWFjaGVkKCk7CisgICAgICAgIGdfYXRvbWljX2ludF9zZXQoJnByaXYtPmV2
ZW50X3RocmVhZF9ydW4sIEZBTFNFKTsKICAgICB9CisgICAgc3BpY2VfdXNiX2JhY2tlbmRfZGVy
ZWdpc3Rlcl9ob3RwbHVnKHByaXYtPmNvbnRleHQpOwogI2VuZGlmCiAgICAgaWYgKHByaXYtPmV2
ZW50X3RocmVhZCkgewogICAgICAgICBnX3dhcm5faWZfZmFpbChnX2F0b21pY19pbnRfZ2V0KCZw
cml2LT5ldmVudF90aHJlYWRfcnVuKSA9PSBGQUxTRSk7CkBAIC0zODYsNyArMzY2LDcgQEAgc3Rh
dGljIHZvaWQgc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2ZpbmFsaXplKEdPYmplY3QgKmdvYmpl
Y3QpCiAgICAgZ19yZXR1cm5faWZfZmFpbChwcml2LT5ldmVudF90aHJlYWQgPT0gTlVMTCk7CiAj
aWZuZGVmIEdfT1NfV0lOMzIKICAgICBpZiAocHJpdi0+Y29udGV4dCkKLSAgICAgICAgbGlidXNi
X2V4aXQocHJpdi0+Y29udGV4dCk7CisgICAgICAgIHNwaWNlX3VzYl9iYWNrZW5kX2RlbGV0ZShw
cml2LT5jb250ZXh0KTsKICNlbmRpZgogICAgIGZyZWUocHJpdi0+YXV0b19jb25uX2ZpbHRlcl9y
dWxlcyk7CiAgICAgZnJlZShwcml2LT5yZWRpcmVjdF9vbl9jb25uZWN0X3J1bGVzKTsKQEAgLTcw
OSwzNyArNjg5LDYgQEAgc3RhdGljIHZvaWQgc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2NsYXNz
X2luaXQoU3BpY2VVc2JEZXZpY2VNYW5hZ2VyQ2xhc3MgKmtsYXMKICAgICAgICAgICAgICAgICAg
ICAgIEdfVFlQRV9FUlJPUik7CiB9CiAKLSNpZmRlZiBVU0VfVVNCUkVESVIKLQotLyogLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tICovCi0vKiBndWRldiAvIGxpYnVzYiBIZWxwZXIgZnVuY3Rpb25zICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgKi8KLQotc3RhdGljIGdib29sZWFuIHNwaWNlX3VzYl9kZXZp
Y2VfbWFuYWdlcl9nZXRfZGV2aWNlX2Rlc2NyaXB0b3IoCi0gICAgbGlidXNiX2RldmljZSAqbGli
ZGV2LAotICAgIHN0cnVjdCBsaWJ1c2JfZGV2aWNlX2Rlc2NyaXB0b3IgKmRlc2MpCi17Ci0gICAg
aW50IGVycmNvZGU7Ci0gICAgY29uc3QgZ2NoYXIgKmVycnN0cjsKLQotICAgIGdfcmV0dXJuX3Zh
bF9pZl9mYWlsKGxpYmRldiAhPSBOVUxMLCBGQUxTRSk7Ci0gICAgZ19yZXR1cm5fdmFsX2lmX2Zh
aWwoZGVzYyAgICE9IE5VTEwsIEZBTFNFKTsKLQotICAgIGVycmNvZGUgPSBsaWJ1c2JfZ2V0X2Rl
dmljZV9kZXNjcmlwdG9yKGxpYmRldiwgZGVzYyk7Ci0gICAgaWYgKGVycmNvZGUgPCAwKSB7Ci0g
ICAgICAgIGludCBidXMsIGFkZHI7Ci0KLSAgICAgICAgYnVzID0gbGlidXNiX2dldF9idXNfbnVt
YmVyKGxpYmRldik7Ci0gICAgICAgIGFkZHIgPSBsaWJ1c2JfZ2V0X2RldmljZV9hZGRyZXNzKGxp
YmRldik7Ci0gICAgICAgIGVycnN0ciA9IGxpYnVzYl9lcnJvcl9uYW1lKGVycmNvZGUpOwotICAg
ICAgICBnX3dhcm5pbmcoImNhbm5vdCBnZXQgZGV2aWNlIGRlc2NyaXB0b3IgZm9yICglcCkgJWQu
JWQgLS0gJXMoJWQpIiwKLSAgICAgICAgICAgICAgICAgIGxpYmRldiwgYnVzLCBhZGRyLCBlcnJz
dHIsIGVycmNvZGUpOwotICAgICAgICByZXR1cm4gRkFMU0U7Ci0gICAgfQotICAgIHJldHVybiBU
UlVFOwotfQotCi0jZW5kaWYgLy8gVVNFX1VTQlJFRElSCi0KIC8qKgogICogc3BpY2VfdXNiX2Rl
dmljZV9nZXRfbGlidXNiX2RldmljZToKICAqIEBkZXZpY2U6ICNTcGljZVVzYkRldmljZSB0byBn
ZXQgdGhlIGRlc2NyaXB0b3IgaW5mb3JtYXRpb24gb2YKQEAgLTc1OCwzMiArNzA3LDEyIEBAIHNw
aWNlX3VzYl9kZXZpY2VfZ2V0X2xpYnVzYl9kZXZpY2UoY29uc3QgU3BpY2VVc2JEZXZpY2UgKmRl
dmljZSBHX0dOVUNfVU5VU0VEKQogCiAgICAgZ19yZXR1cm5fdmFsX2lmX2ZhaWwoaW5mbyAhPSBO
VUxMLCBGQUxTRSk7CiAKLSAgICByZXR1cm4gaW5mby0+bGliZGV2OworICAgIHJldHVybiBzcGlj
ZV91c2JfYmFja2VuZF9kZXZpY2VfZ2V0X2xpYmRldihpbmZvLT5iZGV2KTsKICNlbmRpZgogICAg
IHJldHVybiBOVUxMOwogfQogCiAjaWZkZWYgVVNFX1VTQlJFRElSCi1zdGF0aWMgZ2Jvb2xlYW4g
c3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2dldF9saWJkZXZfdmlkX3BpZCgKLSAgICBsaWJ1c2Jf
ZGV2aWNlICpsaWJkZXYsIGludCAqdmlkLCBpbnQgKnBpZCkKLXsKLSAgICBzdHJ1Y3QgbGlidXNi
X2RldmljZV9kZXNjcmlwdG9yIGRlc2M7Ci0KLSAgICBnX3JldHVybl92YWxfaWZfZmFpbChsaWJk
ZXYgIT0gTlVMTCwgRkFMU0UpOwotICAgIGdfcmV0dXJuX3ZhbF9pZl9mYWlsKHZpZCAhPSBOVUxM
LCBGQUxTRSk7Ci0gICAgZ19yZXR1cm5fdmFsX2lmX2ZhaWwocGlkICE9IE5VTEwsIEZBTFNFKTsK
LQotICAgICp2aWQgPSAqcGlkID0gMDsKLQotICAgIGlmICghc3BpY2VfdXNiX2RldmljZV9tYW5h
Z2VyX2dldF9kZXZpY2VfZGVzY3JpcHRvcihsaWJkZXYsICZkZXNjKSkgewotICAgICAgICByZXR1
cm4gRkFMU0U7Ci0gICAgfQotICAgICp2aWQgPSBkZXNjLmlkVmVuZG9yOwotICAgICpwaWQgPSBk
ZXNjLmlkUHJvZHVjdDsKLQotICAgIHJldHVybiBUUlVFOwotfQotCiAvKiAtLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi8K
IC8qIGNhbGxiYWNrcyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAqLwogCkBAIC04OTksMzEgKzgyOCwyNCBAQCBzcGljZV91c2JfZGV2aWNl
X21hbmFnZXJfZmluZF9kZXZpY2UoU3BpY2VVc2JEZXZpY2VNYW5hZ2VyICpzZWxmLAogfQogCiBz
dGF0aWMgdm9pZCBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfYWRkX2RldihTcGljZVVzYkRldmlj
ZU1hbmFnZXIgICpzZWxmLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgbGlidXNiX2RldmljZSAgICAgICAgICAqbGliZGV2KQorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgU3BpY2VVc2JCYWNrZW5kRGV2aWNlICAqYmRldikK
IHsKICAgICBTcGljZVVzYkRldmljZU1hbmFnZXJQcml2YXRlICpwcml2ID0gc2VsZi0+cHJpdjsK
LSAgICBzdHJ1Y3QgbGlidXNiX2RldmljZV9kZXNjcmlwdG9yIGRlc2M7CisgICAgY29uc3QgVXNi
RGV2aWNlSW5mb3JtYXRpb24gKmJfaW5mbyA9IHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9nZXRf
aW5mbyhiZGV2KTsKICAgICBTcGljZVVzYkRldmljZSAqZGV2aWNlOwogCi0gICAgaWYgKCFzcGlj
ZV91c2JfZGV2aWNlX21hbmFnZXJfZ2V0X2RldmljZV9kZXNjcmlwdG9yKGxpYmRldiwgJmRlc2Mp
KQotICAgICAgICByZXR1cm47Ci0KLSAgICAvKiBTa2lwIGh1YnMgKi8KLSAgICBpZiAoZGVzYy5i
RGV2aWNlQ2xhc3MgPT0gTElCVVNCX0NMQVNTX0hVQikKLSAgICAgICAgcmV0dXJuOwotCiAgICAg
aWYgKHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9maW5kX2RldmljZShzZWxmLAotICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlidXNiX2dldF9idXNfbnVtYmVy
KGxpYmRldiksCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBs
aWJ1c2JfZ2V0X2RldmljZV9hZGRyZXNzKGxpYmRldikpKSB7CisgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBiX2luZm8tPmJ1cywKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJfaW5mby0+YWRkcmVzcykpIHsKICAgICAgICAg
U1BJQ0VfREVCVUcoImRldmljZSBub3QgYWRkZWQgJWQ6JWQgJTA0eDolMDR4IiwKLSAgICAgICAg
ICAgICAgICAgICAgbGlidXNiX2dldF9idXNfbnVtYmVyKGxpYmRldiksCi0gICAgICAgICAgICAg
ICAgICAgIGxpYnVzYl9nZXRfZGV2aWNlX2FkZHJlc3MobGliZGV2KSwKLSAgICAgICAgICAgICAg
ICAgICAgZGVzYy5pZFZlbmRvciwKLSAgICAgICAgICAgICAgICAgICAgZGVzYy5pZFByb2R1Y3Qp
OworICAgICAgICAgICAgICAgICAgICBiX2luZm8tPmJ1cywKKyAgICAgICAgICAgICAgICAgICAg
Yl9pbmZvLT5hZGRyZXNzLAorICAgICAgICAgICAgICAgICAgICBiX2luZm8tPnZpZCwKKyAgICAg
ICAgICAgICAgICAgICAgYl9pbmZvLT5waWQpOwogICAgICAgICByZXR1cm47CiAgICAgfQogCi0g
ICAgZGV2aWNlID0gKFNwaWNlVXNiRGV2aWNlKilzcGljZV91c2JfZGV2aWNlX25ldyhsaWJkZXYp
OworICAgIGRldmljZSA9IChTcGljZVVzYkRldmljZSopc3BpY2VfdXNiX2RldmljZV9uZXcoYmRl
dik7CiAgICAgaWYgKCFkZXZpY2UpCiAgICAgICAgIHJldHVybjsKIApAQCAtOTM1LDEwICs4NTcs
MTAgQEAgc3RhdGljIHZvaWQgc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2FkZF9kZXYoU3BpY2VV
c2JEZXZpY2VNYW5hZ2VyICAqc2VsZiwKICAgICAgICAgY2FuX3JlZGlyZWN0ID0gc3BpY2VfdXNi
X2RldmljZV9tYW5hZ2VyX2Nhbl9yZWRpcmVjdF9kZXZpY2UoCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgc2VsZiwgZGV2aWNlLCBOVUxMKTsKIAotICAgICAgICBhdXRv
X29rID0gdXNicmVkaXJob3N0X2NoZWNrX2RldmljZV9maWx0ZXIoCisgICAgICAgIGF1dG9fb2sg
PSBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfY2hlY2tfZmlsdGVyKAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGJkZXYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpdi0+YXV0
b19jb25uX2ZpbHRlcl9ydWxlcywKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcml2LT5h
dXRvX2Nvbm5fZmlsdGVyX3J1bGVzX2NvdW50LAotICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGxpYmRldiwgMCkgPT0gMDsKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcml2LT5hdXRv
X2Nvbm5fZmlsdGVyX3J1bGVzX2NvdW50KSA9PSAwOwogCiAgICAgICAgIGlmIChjYW5fcmVkaXJl
Y3QgJiYgYXV0b19vaykKICAgICAgICAgICAgIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9jb25u
ZWN0X2RldmljZV9hc3luYyhzZWxmLApAQCAtOTU1LDE1ICs4NzcsMTYgQEAgc3RhdGljIHZvaWQg
c3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2FkZF9kZXYoU3BpY2VVc2JEZXZpY2VNYW5hZ2VyICAq
c2VsZiwKIH0KIAogc3RhdGljIHZvaWQgc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX3JlbW92ZV9k
ZXYoU3BpY2VVc2JEZXZpY2VNYW5hZ2VyICpzZWxmLAotICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgZ3VpbnQgYnVzLCBndWludCBhZGRyZXNzKQorICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU3BpY2VVc2JCYWNrZW5k
RGV2aWNlICpiZGV2KQogewogICAgIFNwaWNlVXNiRGV2aWNlTWFuYWdlclByaXZhdGUgKnByaXYg
PSBzZWxmLT5wcml2OwogICAgIFNwaWNlVXNiRGV2aWNlICpkZXZpY2U7CisgICAgY29uc3QgVXNi
RGV2aWNlSW5mb3JtYXRpb24gKmJfaW5mbyA9IHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9nZXRf
aW5mbyhiZGV2KTsKIAotICAgIGRldmljZSA9IHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9maW5k
X2RldmljZShzZWxmLCBidXMsIGFkZHJlc3MpOworICAgIGRldmljZSA9IHNwaWNlX3VzYl9kZXZp
Y2VfbWFuYWdlcl9maW5kX2RldmljZShzZWxmLCBiX2luZm8tPmJ1cywgYl9pbmZvLT5hZGRyZXNz
KTsKICAgICBpZiAoIWRldmljZSkgewogICAgICAgICBnX3dhcm5pbmcoIkNvdWxkIG5vdCBmaW5k
IFVTQiBkZXZpY2UgdG8gcmVtb3ZlICIgREVWX0lEX0ZNVCwKLSAgICAgICAgICAgICAgICAgIGJ1
cywgYWRkcmVzcyk7CisgICAgICAgICAgICAgICAgICBiX2luZm8tPmJ1cywgYl9pbmZvLT5hZGRy
ZXNzKTsKICAgICAgICAgcmV0dXJuOwogICAgIH0KIApAQCAtOTgyLDI0ICs5MDUsMjIgQEAgc3Rh
dGljIHZvaWQgc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX3JlbW92ZV9kZXYoU3BpY2VVc2JEZXZp
Y2VNYW5hZ2VyICpzZWxmLAogCiAjaWZkZWYgR19PU19XSU4zMgogc3RhdGljIHZvaWQgc3BpY2Vf
dXNiX2RldmljZV9tYW5hZ2VyX3VldmVudF9jYihHVWRldkNsaWVudCAgICAgKmNsaWVudCwKLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlidXNiX2Rldmlj
ZSAgICpkZXYsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IFNwaWNlVXNiQmFja2VuZERldmljZSAqYmRldiwKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgZ2Jvb2xlYW4gICAgICAgICBhZGQsCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdwb2ludGVyICAgICAgICAgdXNlcl9k
YXRhKQogewogICAgIFNwaWNlVXNiRGV2aWNlTWFuYWdlciAqc2VsZiA9IFNQSUNFX1VTQl9ERVZJ
Q0VfTUFOQUdFUih1c2VyX2RhdGEpOwogCiAgICAgaWYgKGFkZCkKLSAgICAgICAgc3BpY2VfdXNi
X2RldmljZV9tYW5hZ2VyX2FkZF9kZXYoc2VsZiwgZGV2KTsKKyAgICAgICAgc3BpY2VfdXNiX2Rl
dmljZV9tYW5hZ2VyX2FkZF9kZXYoc2VsZiwgYmRldik7CiAgICAgZWxzZQotICAgICAgICBzcGlj
ZV91c2JfZGV2aWNlX21hbmFnZXJfcmVtb3ZlX2RldihzZWxmLAotICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBsaWJ1c2JfZ2V0X2J1c19udW1iZXIoZGV2KSwKLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlidXNiX2dldF9kZXZp
Y2VfYWRkcmVzcyhkZXYpKTsKKyAgICAgICAgc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX3JlbW92
ZV9kZXYoc2VsZiwgYmRldik7CiB9CiAjZWxzZQogc3RydWN0IGhvdHBsdWdfaWRsZV9jYl9hcmdz
IHsKICAgICBTcGljZVVzYkRldmljZU1hbmFnZXIgKnNlbGY7Ci0gICAgbGlidXNiX2RldmljZSAq
ZGV2aWNlOwotICAgIGxpYnVzYl9ob3RwbHVnX2V2ZW50IGV2ZW50OworICAgIFNwaWNlVXNiQmFj
a2VuZERldmljZSAqZGV2aWNlOworICAgIGdib29sZWFuICAgICAgICAgICAgICAgYWRkZWQ7CiB9
OwogCiBzdGF0aWMgZ2Jvb2xlYW4gc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2hvdHBsdWdfaWRs
ZV9jYihncG9pbnRlciB1c2VyX2RhdGEpCkBAIC0xMDA3LDM2ICs5MjgsMjkgQEAgc3RhdGljIGdi
b29sZWFuIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9ob3RwbHVnX2lkbGVfY2IoZ3BvaW50ZXIg
dXNlcl9kYXRhKQogICAgIHN0cnVjdCBob3RwbHVnX2lkbGVfY2JfYXJncyAqYXJncyA9IHVzZXJf
ZGF0YTsKICAgICBTcGljZVVzYkRldmljZU1hbmFnZXIgKnNlbGYgPSBTUElDRV9VU0JfREVWSUNF
X01BTkFHRVIoYXJncy0+c2VsZik7CiAKLSAgICBzd2l0Y2ggKGFyZ3MtPmV2ZW50KSB7Ci0gICAg
Y2FzZSBMSUJVU0JfSE9UUExVR19FVkVOVF9ERVZJQ0VfQVJSSVZFRDoKKyAgICBpZiAoYXJncy0+
YWRkZWQpCiAgICAgICAgIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9hZGRfZGV2KHNlbGYsIGFy
Z3MtPmRldmljZSk7Ci0gICAgICAgIGJyZWFrOwotICAgIGNhc2UgTElCVVNCX0hPVFBMVUdfRVZF
TlRfREVWSUNFX0xFRlQ6Ci0gICAgICAgIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9yZW1vdmVf
ZGV2KHNlbGYsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWJ1c2JfZ2V0
X2J1c19udW1iZXIoYXJncy0+ZGV2aWNlKSwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGxpYnVzYl9nZXRfZGV2aWNlX2FkZHJlc3MoYXJncy0+ZGV2aWNlKSk7Ci0gICAgICAg
IGJyZWFrOwotICAgIH0KLSAgICBsaWJ1c2JfdW5yZWZfZGV2aWNlKGFyZ3MtPmRldmljZSk7Cisg
ICAgZWxzZQorICAgICAgICBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfcmVtb3ZlX2RldihzZWxm
LCBhcmdzLT5kZXZpY2UpOworCisgICAgc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX3VucmVmKGFy
Z3MtPmRldmljZSk7CiAgICAgZ19vYmplY3RfdW5yZWYoc2VsZik7CiAgICAgZ19mcmVlKGFyZ3Mp
OwogICAgIHJldHVybiBGQUxTRTsKIH0KIAogLyogQ2FuIGJlIGNhbGxlZCBmcm9tIGJvdGggdGhl
IG1haW4tdGhyZWFkIGFzIHdlbGwgYXMgdGhlIGV2ZW50X3RocmVhZCAqLwotc3RhdGljIGludCBz
cGljZV91c2JfZGV2aWNlX21hbmFnZXJfaG90cGx1Z19jYihsaWJ1c2JfY29udGV4dCAgICAgICAq
Y3R4LAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWJ1
c2JfZGV2aWNlICAgICAgICAqZGV2aWNlLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBsaWJ1c2JfaG90cGx1Z19ldmVudCAgZXZlbnQsCi0gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZvaWQgICAgICAgICAgICAgICAg
ICp1c2VyX2RhdGEpCitzdGF0aWMgdm9pZCBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfaG90cGx1
Z19jYih2b2lkICp1c2VyX2RhdGEsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBTcGljZVVzYkJhY2tlbmREZXZpY2UgKmRldiwKKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdib29sZWFuIGFkZGVkKQogewogICAg
IFNwaWNlVXNiRGV2aWNlTWFuYWdlciAqc2VsZiA9IFNQSUNFX1VTQl9ERVZJQ0VfTUFOQUdFUih1
c2VyX2RhdGEpOwogICAgIHN0cnVjdCBob3RwbHVnX2lkbGVfY2JfYXJncyAqYXJncyA9IGdfbWFs
bG9jMChzaXplb2YoKmFyZ3MpKTsKIAogICAgIGFyZ3MtPnNlbGYgPSBnX29iamVjdF9yZWYoc2Vs
Zik7Ci0gICAgYXJncy0+ZGV2aWNlID0gbGlidXNiX3JlZl9kZXZpY2UoZGV2aWNlKTsKLSAgICBh
cmdzLT5ldmVudCA9IGV2ZW50OworICAgIGFyZ3MtPmRldmljZSA9IHNwaWNlX3VzYl9iYWNrZW5k
X2RldmljZV9yZWYoZGV2KTsKKyAgICBhcmdzLT5hZGRlZCA9IGFkZGVkOwogICAgIGdfaWRsZV9h
ZGQoc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2hvdHBsdWdfaWRsZV9jYiwgYXJncyk7Ci0gICAg
cmV0dXJuIDA7CiB9CiAjZW5kaWYgLy8gVVNFX1VTQlJFRElSCiAKQEAgLTEwNjMsMTMgKzk3Nyw5
IEBAIHN0YXRpYyBncG9pbnRlciBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfdXNiX2V2X3RocmVh
ZChncG9pbnRlciB1c2VyX2RhdGEpCiB7CiAgICAgU3BpY2VVc2JEZXZpY2VNYW5hZ2VyICpzZWxm
ID0gU1BJQ0VfVVNCX0RFVklDRV9NQU5BR0VSKHVzZXJfZGF0YSk7CiAgICAgU3BpY2VVc2JEZXZp
Y2VNYW5hZ2VyUHJpdmF0ZSAqcHJpdiA9IHNlbGYtPnByaXY7Ci0gICAgaW50IHJjOwogCiAgICAg
d2hpbGUgKGdfYXRvbWljX2ludF9nZXQoJnByaXYtPmV2ZW50X3RocmVhZF9ydW4pKSB7Ci0gICAg
ICAgIHJjID0gbGlidXNiX2hhbmRsZV9ldmVudHMocHJpdi0+Y29udGV4dCk7Ci0gICAgICAgIGlm
IChyYyAmJiByYyAhPSBMSUJVU0JfRVJST1JfSU5URVJSVVBURUQpIHsKLSAgICAgICAgICAgIGNv
bnN0IGNoYXIgKmRlc2MgPSBsaWJ1c2JfZXJyb3JfbmFtZShyYyk7Ci0gICAgICAgICAgICBnX3dh
cm5pbmcoIkVycm9yIGhhbmRsaW5nIFVTQiBldmVudHM6ICVzIFslaV0iLCBkZXNjLCByYyk7Cisg
ICAgICAgIGlmICghc3BpY2VfdXNiX2JhY2tlbmRfaGFuZGxlX2V2ZW50cyhwcml2LT5jb250ZXh0
KSkgewogICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgIH0KICAgICB9CkBAIC0xMTIwLDcgKzEw
MzAsNyBAQCBzdGF0aWMgdm9pZCBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfY2hlY2tfcmVkaXJf
b25fY29ubmVjdCgKICAgICBTcGljZVVzYkRldmljZU1hbmFnZXJQcml2YXRlICpwcml2ID0gc2Vs
Zi0+cHJpdjsKICAgICBHVGFzayAqdGFzazsKICAgICBTcGljZVVzYkRldmljZSAqZGV2aWNlOwot
ICAgIGxpYnVzYl9kZXZpY2UgKmxpYmRldjsKKyAgICBTcGljZVVzYkJhY2tlbmREZXZpY2UgKmJk
ZXY7CiAgICAgZ3VpbnQgaTsKIAogICAgIGlmIChwcml2LT5yZWRpcmVjdF9vbl9jb25uZWN0ID09
IE5VTEwpCkBAIC0xMTMyLDExICsxMDQyLDExIEBAIHN0YXRpYyB2b2lkIHNwaWNlX3VzYl9kZXZp
Y2VfbWFuYWdlcl9jaGVja19yZWRpcl9vbl9jb25uZWN0KAogICAgICAgICBpZiAoc3BpY2VfdXNi
X2RldmljZV9tYW5hZ2VyX2lzX2RldmljZV9jb25uZWN0ZWQoc2VsZiwgZGV2aWNlKSkKICAgICAg
ICAgICAgIGNvbnRpbnVlOwogCi0gICAgICAgIGxpYmRldiA9IHNwaWNlX3VzYl9kZXZpY2VfbWFu
YWdlcl9kZXZpY2VfdG9fbGliZGV2KHNlbGYsIGRldmljZSk7Ci0gICAgICAgIGlmICh1c2JyZWRp
cmhvc3RfY2hlY2tfZGV2aWNlX2ZpbHRlcigKKyAgICAgICAgYmRldiA9IHNwaWNlX3VzYl9kZXZp
Y2VfbWFuYWdlcl9kZXZpY2VfdG9fYmRldihzZWxmLCBkZXZpY2UpOworICAgICAgICBpZiAoc3Bp
Y2VfdXNiX2JhY2tlbmRfZGV2aWNlX2NoZWNrX2ZpbHRlcigKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBiZGV2LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaXYtPnJlZGlyZWN0
X29uX2Nvbm5lY3RfcnVsZXMsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpdi0+cmVk
aXJlY3Rfb25fY29ubmVjdF9ydWxlc19jb3VudCwKLSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBsaWJkZXYsIDApID09IDApIHsKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcml2LT5y
ZWRpcmVjdF9vbl9jb25uZWN0X3J1bGVzX2NvdW50KSA9PSAwKSB7CiAgICAgICAgICAgICAvKiBO
b3RlOiByZS11c2VzIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9jb25uZWN0X2RldmljZV9hc3lu
YydzCiAgICAgICAgICAgICAgICBjb21wbGV0aW9uIGhhbmRsaW5nIGNvZGUhICovCiAgICAgICAg
ICAgICB0YXNrID0gZ190YXNrX25ldyhzZWxmLApAQCAtMTE0NiwxNCArMTA1NiwxNCBAQCBzdGF0
aWMgdm9pZCBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfY2hlY2tfcmVkaXJfb25fY29ubmVjdCgK
IAogICAgICAgICAgICAgc3BpY2VfdXNicmVkaXJfY2hhbm5lbF9jb25uZWN0X2RldmljZV9hc3lu
YygKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTUElDRV9VU0JSRURJUl9DSEFOTkVM
KGNoYW5uZWwpLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpYmRldiwgZGV2aWNl
LCBOVUxMLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJkZXYsIGRldmljZSwgTlVM
TCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcGljZV91c2JfZGV2aWNlX21hbmFn
ZXJfY2hhbm5lbF9jb25uZWN0X2NiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRh
c2spOwotICAgICAgICAgICAgbGlidXNiX3VucmVmX2RldmljZShsaWJkZXYpOworICAgICAgICAg
ICAgc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX3VucmVmKGJkZXYpOwogICAgICAgICAgICAgcmV0
dXJuOyAvKiBXZSd2ZSB0YWtlbiB0aGUgY2hhbm5lbCEgKi8KICAgICAgICAgfQogCi0gICAgICAg
IGxpYnVzYl91bnJlZl9kZXZpY2UobGliZGV2KTsKKyAgICAgICAgc3BpY2VfdXNiX2JhY2tlbmRf
ZGV2aWNlX3VucmVmKGJkZXYpOwogICAgIH0KIH0KIApAQCAtMTE3Nyw4ICsxMDg3LDggQEAgc3Rh
dGljIFNwaWNlVXNicmVkaXJDaGFubmVsICpzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfZ2V0X2No
YW5uZWxfZm9yX2RldigKICAgICBmb3IgKGkgPSAwOyBpIDwgcHJpdi0+Y2hhbm5lbHMtPmxlbjsg
aSsrKSB7CiAgICAgICAgIFNwaWNlVXNicmVkaXJDaGFubmVsICpjaGFubmVsID0gZ19wdHJfYXJy
YXlfaW5kZXgocHJpdi0+Y2hhbm5lbHMsIGkpOwogICAgICAgICBzcGljZV91c2JyZWRpcl9jaGFu
bmVsX2xvY2soY2hhbm5lbCk7Ci0gICAgICAgIGxpYnVzYl9kZXZpY2UgKmxpYmRldiA9IHNwaWNl
X3VzYnJlZGlyX2NoYW5uZWxfZ2V0X2RldmljZShjaGFubmVsKTsKLSAgICAgICAgaWYgKHNwaWNl
X3VzYl9tYW5hZ2VyX2RldmljZV9lcXVhbF9saWJkZXYobWFuYWdlciwgZGV2aWNlLCBsaWJkZXYp
KSB7CisgICAgICAgIFNwaWNlVXNiQmFja2VuZERldmljZSAqYmRldiA9IHNwaWNlX3VzYnJlZGly
X2NoYW5uZWxfZ2V0X2RldmljZShjaGFubmVsKTsKKyAgICAgICAgaWYgKHNwaWNlX3VzYl9tYW5h
Z2VyX2RldmljZV9lcXVhbF9iZGV2KG1hbmFnZXIsIGRldmljZSwgYmRldikpIHsKICAgICAgICAg
ICAgIHNwaWNlX3VzYnJlZGlyX2NoYW5uZWxfdW5sb2NrKGNoYW5uZWwpOwogICAgICAgICAgICAg
cmV0dXJuIGNoYW5uZWw7CiAgICAgICAgIH0KQEAgLTEyMzUsOSArMTE0NSw5IEBAIEdQdHJBcnJh
eSogc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2dldF9kZXZpY2VzX3dpdGhfZmlsdGVyKAogICAg
ICAgICBTcGljZVVzYkRldmljZSAqZGV2aWNlID0gZ19wdHJfYXJyYXlfaW5kZXgocHJpdi0+ZGV2
aWNlcywgaSk7CiAKICAgICAgICAgaWYgKHJ1bGVzKSB7Ci0gICAgICAgICAgICBsaWJ1c2JfZGV2
aWNlICpsaWJkZXYgPQotICAgICAgICAgICAgICAgIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9k
ZXZpY2VfdG9fbGliZGV2KHNlbGYsIGRldmljZSk7Ci0gICAgICAgICAgICBpZiAodXNicmVkaXJo
b3N0X2NoZWNrX2RldmljZV9maWx0ZXIocnVsZXMsIGNvdW50LCBsaWJkZXYsIDApICE9IDApCisg
ICAgICAgICAgICBTcGljZVVzYkJhY2tlbmREZXZpY2UgKmJkZXYgPQorICAgICAgICAgICAgICAg
IHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9kZXZpY2VfdG9fYmRldihzZWxmLCBkZXZpY2UpOwor
ICAgICAgICAgICAgaWYgKHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9jaGVja19maWx0ZXIoYmRl
diwgcnVsZXMsIGNvdW50KSAhPSAwKQogICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAg
ICB9CiAgICAgICAgIGdfcHRyX2FycmF5X2FkZChkZXZpY2VzX2NvcHksIHNwaWNlX3VzYl9kZXZp
Y2VfcmVmKGRldmljZSkpOwpAQCAtMTMxMSw3ICsxMjIxLDcgQEAgX3NwaWNlX3VzYl9kZXZpY2Vf
bWFuYWdlcl9jb25uZWN0X2RldmljZV9hc3luYyhTcGljZVVzYkRldmljZU1hbmFnZXIgKnNlbGYs
CiAgICAgdGFzayA9IGdfdGFza19uZXcoc2VsZiwgY2FuY2VsbGFibGUsIGNhbGxiYWNrLCB1c2Vy
X2RhdGEpOwogCiAgICAgU3BpY2VVc2JEZXZpY2VNYW5hZ2VyUHJpdmF0ZSAqcHJpdiA9IHNlbGYt
PnByaXY7Ci0gICAgbGlidXNiX2RldmljZSAqbGliZGV2OworICAgIFNwaWNlVXNiQmFja2VuZERl
dmljZSAqYmRldjsKICAgICBndWludCBpOwogCiAgICAgaWYgKHNwaWNlX3VzYl9kZXZpY2VfbWFu
YWdlcl9pc19kZXZpY2VfY29ubmVjdGVkKHNlbGYsIGRldmljZSkpIHsKQEAgLTEzMjcsMTQgKzEy
MzcsMTQgQEAgX3NwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9jb25uZWN0X2RldmljZV9hc3luYyhT
cGljZVVzYkRldmljZU1hbmFnZXIgKnNlbGYsCiAgICAgICAgIGlmIChzcGljZV91c2JyZWRpcl9j
aGFubmVsX2dldF9kZXZpY2UoY2hhbm5lbCkpCiAgICAgICAgICAgICBjb250aW51ZTsgLyogU2tp
cCBhbHJlYWR5IHVzZWQgY2hhbm5lbHMgKi8KIAotICAgICAgICBsaWJkZXYgPSBzcGljZV91c2Jf
ZGV2aWNlX21hbmFnZXJfZGV2aWNlX3RvX2xpYmRldihzZWxmLCBkZXZpY2UpOworICAgICAgICBi
ZGV2ID0gc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2RldmljZV90b19iZGV2KHNlbGYsIGRldmlj
ZSk7CiAgICAgICAgIHNwaWNlX3VzYnJlZGlyX2NoYW5uZWxfY29ubmVjdF9kZXZpY2VfYXN5bmMo
Y2hhbm5lbCwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpYmRldiwKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJkZXYsCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBkZXZpY2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYW5j
ZWxsYWJsZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwaWNlX3VzYl9kZXZp
Y2VfbWFuYWdlcl9jaGFubmVsX2Nvbm5lY3RfY2IsCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB0YXNrKTsKLSAgICAgICAgbGlidXNiX3VucmVmX2RldmljZShsaWJkZXYpOworICAg
ICAgICBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfdW5yZWYoYmRldik7CiAgICAgICAgIHJldHVy
bjsKICAgICB9CiAKQEAgLTE1OTYsMTMgKzE1MDYsMTQgQEAgc3BpY2VfdXNiX2RldmljZV9tYW5h
Z2VyX2Nhbl9yZWRpcmVjdF9kZXZpY2UoU3BpY2VVc2JEZXZpY2VNYW5hZ2VyICAqc2VsZiwKIAog
ICAgIGlmIChndWVzdF9maWx0ZXJfcnVsZXMpIHsKICAgICAgICAgZ2Jvb2xlYW4gZmlsdGVyX29r
OwotICAgICAgICBsaWJ1c2JfZGV2aWNlICpsaWJkZXY7Ci0KLSAgICAgICAgbGliZGV2ID0gc3Bp
Y2VfdXNiX2RldmljZV9tYW5hZ2VyX2RldmljZV90b19saWJkZXYoc2VsZiwgZGV2aWNlKTsKLSAg
ICAgICAgZmlsdGVyX29rID0gKHVzYnJlZGlyaG9zdF9jaGVja19kZXZpY2VfZmlsdGVyKAotICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGd1ZXN0X2ZpbHRlcl9ydWxlcywgZ3Vlc3RfZmlsdGVy
X3J1bGVzX2NvdW50LAotICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpYmRldiwgMCkgPT0g
MCk7Ci0gICAgICAgIGxpYnVzYl91bnJlZl9kZXZpY2UobGliZGV2KTsKKyAgICAgICAgU3BpY2VV
c2JCYWNrZW5kRGV2aWNlICpiZGV2OworCisgICAgICAgIGJkZXYgPSBzcGljZV91c2JfZGV2aWNl
X21hbmFnZXJfZGV2aWNlX3RvX2JkZXYoc2VsZiwgZGV2aWNlKTsKKyAgICAgICAgZmlsdGVyX29r
ID0gKHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9jaGVja19maWx0ZXIoCisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgYmRldiwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBndWVzdF9m
aWx0ZXJfcnVsZXMsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3Vlc3RfZmlsdGVyX3J1
bGVzX2NvdW50KSA9PSAwKTsKKyAgICAgICAgc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX3VucmVm
KGJkZXYpOwogICAgICAgICBpZiAoIWZpbHRlcl9vaykgewogICAgICAgICAgICAgZ19zZXRfZXJy
b3JfbGl0ZXJhbChlcnIsIFNQSUNFX0NMSUVOVF9FUlJPUiwgU1BJQ0VfQ0xJRU5UX0VSUk9SX0ZB
SUxFRCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXygiU29tZSBVU0IgZGV2aWNl
cyBhcmUgYmxvY2tlZCBieSBob3N0IHBvbGljeSIpKTsKQEAgLTE2OTYsNjAgKzE2MDcsMjcgQEAg
Z2NoYXIgKnNwaWNlX3VzYl9kZXZpY2VfZ2V0X2Rlc2NyaXB0aW9uKFNwaWNlVXNiRGV2aWNlICpk
ZXZpY2UsIGNvbnN0IGdjaGFyICpmb3IKIAogCiAjaWZkZWYgVVNFX1VTQlJFRElSCi1zdGF0aWMg
Z2Jvb2xlYW4gcHJvYmVfaXNvY2hyb25vdXNfZW5kcG9pbnQobGlidXNiX2RldmljZSAqbGliZGV2
KQotewotICAgIHN0cnVjdCBsaWJ1c2JfY29uZmlnX2Rlc2NyaXB0b3IgKmNvbmZfZGVzYzsKLSAg
ICBnYm9vbGVhbiBpc29jX2ZvdW5kID0gRkFMU0U7Ci0gICAgZ2ludCBpLCBqLCBrOwotCi0gICAg
Z19yZXR1cm5fdmFsX2lmX2ZhaWwobGliZGV2ICE9IE5VTEwsIEZBTFNFKTsKLQotICAgIGlmIChs
aWJ1c2JfZ2V0X2FjdGl2ZV9jb25maWdfZGVzY3JpcHRvcihsaWJkZXYsICZjb25mX2Rlc2MpICE9
IDApIHsKLSAgICAgICAgZ19yZXR1cm5fdmFsX2lmX3JlYWNoZWQoRkFMU0UpOwotICAgIH0KLQot
ICAgIGZvciAoaSA9IDA7ICFpc29jX2ZvdW5kICYmIGkgPCBjb25mX2Rlc2MtPmJOdW1JbnRlcmZh
Y2VzOyBpKyspIHsKLSAgICAgICAgZm9yIChqID0gMDsgIWlzb2NfZm91bmQgJiYgaiA8IGNvbmZf
ZGVzYy0+aW50ZXJmYWNlW2ldLm51bV9hbHRzZXR0aW5nOyBqKyspIHsKLSAgICAgICAgICAgIGZv
ciAoayA9IDA7ICFpc29jX2ZvdW5kICYmIGsgPCBjb25mX2Rlc2MtPmludGVyZmFjZVtpXS5hbHRz
ZXR0aW5nW2pdLmJOdW1FbmRwb2ludHM7aysrKSB7Ci0gICAgICAgICAgICAgICAgZ2ludCBhdHRy
aWJ1dGVzID0gY29uZl9kZXNjLT5pbnRlcmZhY2VbaV0uYWx0c2V0dGluZ1tqXS5lbmRwb2ludFtr
XS5ibUF0dHJpYnV0ZXM7Ci0gICAgICAgICAgICAgICAgZ2ludCB0eXBlID0gYXR0cmlidXRlcyAm
IExJQlVTQl9UUkFOU0ZFUl9UWVBFX01BU0s7Ci0gICAgICAgICAgICAgICAgaWYgKHR5cGUgPT0g
TElCVVNCX1RSQU5TRkVSX1RZUEVfSVNPQ0hST05PVVMpCi0gICAgICAgICAgICAgICAgICAgIGlz
b2NfZm91bmQgPSBUUlVFOwotICAgICAgICAgICAgfQotICAgICAgICB9Ci0gICAgfQotCi0gICAg
bGlidXNiX2ZyZWVfY29uZmlnX2Rlc2NyaXB0b3IoY29uZl9kZXNjKTsKLSAgICByZXR1cm4gaXNv
Y19mb3VuZDsKLX0KLQogLyoKICAqIFNwaWNlVXNiRGV2aWNlSW5mbwogICovCi1zdGF0aWMgU3Bp
Y2VVc2JEZXZpY2VJbmZvICpzcGljZV91c2JfZGV2aWNlX25ldyhsaWJ1c2JfZGV2aWNlICpsaWJk
ZXYpCitzdGF0aWMgU3BpY2VVc2JEZXZpY2VJbmZvICpzcGljZV91c2JfZGV2aWNlX25ldyhTcGlj
ZVVzYkJhY2tlbmREZXZpY2UgKmJkZXYpCiB7CiAgICAgU3BpY2VVc2JEZXZpY2VJbmZvICppbmZv
OwotICAgIGludCB2aWQsIHBpZDsKLSAgICBndWludDggYnVzLCBhZGRyOwotCi0gICAgZ19yZXR1
cm5fdmFsX2lmX2ZhaWwobGliZGV2ICE9IE5VTEwsIE5VTEwpOworICAgIGNvbnN0IFVzYkRldmlj
ZUluZm9ybWF0aW9uICpiZGV2X2luZm87CiAKLSAgICBidXMgPSBsaWJ1c2JfZ2V0X2J1c19udW1i
ZXIobGliZGV2KTsKLSAgICBhZGRyID0gbGlidXNiX2dldF9kZXZpY2VfYWRkcmVzcyhsaWJkZXYp
OworICAgIGdfcmV0dXJuX3ZhbF9pZl9mYWlsKGJkZXYgIT0gTlVMTCwgTlVMTCk7CiAKLSAgICBp
ZiAoIXNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9nZXRfbGliZGV2X3ZpZF9waWQobGliZGV2LCAm
dmlkLCAmcGlkKSkgewotICAgICAgICByZXR1cm4gTlVMTDsKLSAgICB9CisgICAgYmRldl9pbmZv
ID0gc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX2dldF9pbmZvKGJkZXYpOwogCiAgICAgaW5mbyA9
IGdfbmV3MChTcGljZVVzYkRldmljZUluZm8sIDEpOwogCi0gICAgaW5mby0+YnVzbnVtICA9IGJ1
czsKLSAgICBpbmZvLT5kZXZhZGRyID0gYWRkcjsKLSAgICBpbmZvLT52aWQgPSB2aWQ7Ci0gICAg
aW5mby0+cGlkID0gcGlkOworICAgIGluZm8tPmJ1c251bSAgPSBiZGV2X2luZm8tPmJ1czsKKyAg
ICBpbmZvLT5kZXZhZGRyID0gYmRldl9pbmZvLT5hZGRyZXNzOworICAgIGluZm8tPnZpZCA9IGJk
ZXZfaW5mby0+dmlkOworICAgIGluZm8tPnBpZCA9IGJkZXZfaW5mby0+cGlkOwogICAgIGluZm8t
PnJlZiA9IDE7Ci0gICAgaW5mby0+aXNvY2hyb25vdXMgPSBwcm9iZV9pc29jaHJvbm91c19lbmRw
b2ludChsaWJkZXYpOwotICAgIGluZm8tPmxpYmRldiA9IGxpYnVzYl9yZWZfZGV2aWNlKGxpYmRl
dik7CisgICAgaW5mby0+YmRldiA9IHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9yZWYoYmRldik7
CisgICAgaW5mby0+aXNvY2hyb25vdXMgPSBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfaXNvY2go
YmRldik7CiAKICAgICByZXR1cm4gaW5mbzsKIH0KQEAgLTE4ODUsMzUgKzE3NjMsMzUgQEAgc3Rh
dGljIHZvaWQgc3BpY2VfdXNiX2RldmljZV91bnJlZihTcGljZVVzYkRldmljZSAqZGV2aWNlKQog
CiAgICAgcmVmX2NvdW50X2lzXzAgPSBnX2F0b21pY19pbnRfZGVjX2FuZF90ZXN0KCZpbmZvLT5y
ZWYpOwogICAgIGlmIChyZWZfY291bnRfaXNfMCkgewotICAgICAgICBsaWJ1c2JfdW5yZWZfZGV2
aWNlKGluZm8tPmxpYmRldik7CisgICAgICAgIHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV91bnJl
ZihpbmZvLT5iZGV2KTsKICAgICAgICAgZ19mcmVlKGluZm8pOwogICAgIH0KIH0KIAogc3RhdGlj
IGdib29sZWFuCi1zcGljZV91c2JfbWFuYWdlcl9kZXZpY2VfZXF1YWxfbGliZGV2KFNwaWNlVXNi
RGV2aWNlTWFuYWdlciAqbWFuYWdlciwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgU3BpY2VVc2JEZXZpY2UgKmRldmljZSwKLSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgbGlidXNiX2RldmljZSAgKmxpYmRldikKK3NwaWNlX3VzYl9tYW5hZ2VyX2Rl
dmljZV9lcXVhbF9iZGV2KFNwaWNlVXNiRGV2aWNlTWFuYWdlciAqbWFuYWdlciwKKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNwaWNlVXNiRGV2aWNlICpkZXZpY2UsCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTcGljZVVzYkJhY2tlbmREZXZpY2UgKmJk
ZXYpCiB7CiAgICAgU3BpY2VVc2JEZXZpY2VJbmZvICppbmZvID0gKFNwaWNlVXNiRGV2aWNlSW5m
byAqKWRldmljZTsKIAotICAgIGlmICgoZGV2aWNlID09IE5VTEwpIHx8IChsaWJkZXYgPT0gTlVM
TCkpCisgICAgaWYgKChkZXZpY2UgPT0gTlVMTCkgfHwgKGJkZXYgPT0gTlVMTCkpCiAgICAgICAg
IHJldHVybiBGQUxTRTsKIAotICAgIHJldHVybiBpbmZvLT5saWJkZXYgPT0gbGliZGV2OworICAg
IHJldHVybiBpbmZvLT5iZGV2ID09IGJkZXY7CiB9CiAKIC8qCiAgKiBDYWxsZXIgbXVzdCBsaWJ1
c2JfdW5yZWZfZGV2aWNlIHRoZSBsaWJ1c2JfZGV2aWNlIHJldHVybmVkIGJ5IHRoaXMgZnVuY3Rp
b24uCiAgKiBSZXR1cm5zIGEgbGlidXNiX2RldmljZSwgb3IgTlVMTCB1cG9uIGZhaWx1cmUKICAq
Lwotc3RhdGljIGxpYnVzYl9kZXZpY2UgKgotc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2Rldmlj
ZV90b19saWJkZXYoU3BpY2VVc2JEZXZpY2VNYW5hZ2VyICpzZWxmLAotICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgU3BpY2VVc2JEZXZpY2UgKmRldmljZSkKK3N0YXRp
YyBTcGljZVVzYkJhY2tlbmREZXZpY2UgKgorc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2Rldmlj
ZV90b19iZGV2KFNwaWNlVXNiRGV2aWNlTWFuYWdlciAqc2VsZiwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBTcGljZVVzYkRldmljZSAqZGV2aWNlKQogewogICAgIC8q
IFNpbXBseSByZXR1cm4gYSByZWYgdG8gdGhlIGNhY2hlZCBsaWJkZXYgKi8KICAgICBTcGljZVVz
YkRldmljZUluZm8gKmluZm8gPSAoU3BpY2VVc2JEZXZpY2VJbmZvICopZGV2aWNlOwogCi0gICAg
cmV0dXJuIGxpYnVzYl9yZWZfZGV2aWNlKGluZm8tPmxpYmRldik7CisgICAgcmV0dXJuIHNwaWNl
X3VzYl9iYWNrZW5kX2RldmljZV9yZWYoaW5mby0+YmRldik7CiB9CiAjZW5kaWYgLyogVVNFX1VT
QlJFRElSICovCmRpZmYgLS1naXQgYS9zcmMvdXNidXRpbC5oIGIvc3JjL3VzYnV0aWwuaAppbmRl
eCA1MGUzOTQ5Li5kMThkNjg4IDEwMDY0NAotLS0gYS9zcmMvdXNidXRpbC5oCisrKyBiL3NyYy91
c2J1dGlsLmgKQEAgLTI0LDcgKzI0LDYgQEAKICNpbmNsdWRlIDxnbGliLmg+CiAKICNpZmRlZiBV
U0VfVVNCUkVESVIKLSNpbmNsdWRlIDxsaWJ1c2IuaD4KIAogR19CRUdJTl9ERUNMUwogCmRpZmYg
LS1naXQgYS9zcmMvd2luLXVzYi1kZXYuYyBiL3NyYy93aW4tdXNiLWRldi5jCmluZGV4IGNlNTk5
YjkuLmMyYTUxMTUgMTAwNjQ0Ci0tLSBhL3NyYy93aW4tdXNiLWRldi5jCisrKyBiL3NyYy93aW4t
dXNiLWRldi5jCkBAIC0yMywxMSArMjMsOSBAQAogI2luY2x1ZGUgImNvbmZpZy5oIgogCiAjaW5j
bHVkZSA8d2luZG93cy5oPgotI2luY2x1ZGUgPGxpYnVzYi5oPgogI2luY2x1ZGUgIndpbi11c2It
ZGV2LmgiCiAjaW5jbHVkZSAic3BpY2UtbWFyc2hhbC5oIgogI2luY2x1ZGUgInNwaWNlLXV0aWwu
aCIKLSNpbmNsdWRlICJ1c2J1dGlsLmgiCiAKIGVudW0gewogICAgIFBST1BfMCwKQEAgLTM1LDcg
KzMzLDcgQEAgZW51bSB7CiB9OwogCiBzdHJ1Y3QgX0dVZGV2Q2xpZW50UHJpdmF0ZSB7Ci0gICAg
bGlidXNiX2NvbnRleHQgKmN0eDsKKyAgICBTcGljZVVzYkJhY2tlbmQgKmN0eDsKICAgICBHTGlz
dCAqdWRldl9saXN0OwogICAgIEhXTkQgaHduZDsKICAgICBnYm9vbGVhbiByZWRpcmVjdGluZzsK
QEAgLTY4LDkgKzY2LDcgQEAgc3RhdGljIHZvaWQgZ191ZGV2X2RldmljZV9wcmludF9saXN0KEdM
aXN0ICpsLCBjb25zdCBnY2hhciAqbXNnKTsKICNlbHNlCiBzdGF0aWMgdm9pZCBnX3VkZXZfZGV2
aWNlX3ByaW50X2xpc3QoR0xpc3QgKmwsIGNvbnN0IGdjaGFyICptc2cpIHt9CiAjZW5kaWYKLXN0
YXRpYyB2b2lkIGdfdWRldl9kZXZpY2VfcHJpbnQobGlidXNiX2RldmljZSAqZGV2LCBjb25zdCBn
Y2hhciAqbXNnKTsKLQotc3RhdGljIGdib29sZWFuIGdfdWRldl9za2lwX3NlYXJjaChsaWJ1c2Jf
ZGV2aWNlICpkZXYpOworc3RhdGljIHZvaWQgZ191ZGV2X2RldmljZV9wcmludChTcGljZVVzYkJh
Y2tlbmREZXZpY2UgKmRldiwgY29uc3QgZ2NoYXIgKm1zZyk7CiAKIEdRdWFyayBnX3VkZXZfY2xp
ZW50X2Vycm9yX3F1YXJrKHZvaWQpCiB7CkBAIC04Niw3ICs4Miw3IEBAIEdVZGV2Q2xpZW50ICpn
X3VkZXZfY2xpZW50X25ldyh2b2lkKQogICAgIHJldHVybiBzaW5nbGV0b247CiB9CiAKLWxpYnVz
Yl9jb250ZXh0ICpnX3VkZXZfY2xpZW50X2dldF9jb250ZXh0KEdVZGV2Q2xpZW50ICpjbGllbnQp
CitTcGljZVVzYkJhY2tlbmQgKmdfdWRldl9jbGllbnRfZ2V0X2NvbnRleHQoR1VkZXZDbGllbnQg
KmNsaWVudCkKIHsKICAgICByZXR1cm4gY2xpZW50LT5wcml2LT5jdHg7CiB9CkBAIC05OSw4ICs5
NSw3IEBAIHN0YXRpYyBzc2l6ZV90CiBnX3VkZXZfY2xpZW50X2xpc3RfZGV2aWNlcyhHVWRldkNs
aWVudCAqc2VsZiwgR0xpc3QgKipkZXZzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgR0Vy
cm9yICoqZXJyLCBjb25zdCBnY2hhciAqbmFtZSkKIHsKLSAgICBnc3NpemUgcmM7Ci0gICAgbGli
dXNiX2RldmljZSAqKmx1c2JfbGlzdCwgKipkZXY7CisgICAgU3BpY2VVc2JCYWNrZW5kRGV2aWNl
ICoqbHVzYl9saXN0LCAqKmRldjsKICAgICBHVWRldkNsaWVudFByaXZhdGUgKnByaXY7CiAgICAg
c3NpemVfdCBuOwogCkBAIC0xMTEsNDMgKzEwNiwzMyBAQCBnX3VkZXZfY2xpZW50X2xpc3RfZGV2
aWNlcyhHVWRldkNsaWVudCAqc2VsZiwgR0xpc3QgKipkZXZzLAogCiAgICAgZ19yZXR1cm5fdmFs
X2lmX2ZhaWwoc2VsZi0+cHJpdi0+Y3R4ICE9IE5VTEwsIC0zKTsKIAotICAgIHJjID0gbGlidXNi
X2dldF9kZXZpY2VfbGlzdChwcml2LT5jdHgsICZsdXNiX2xpc3QpOwotICAgIGlmIChyYyA8IDAp
IHsKLSAgICAgICAgY29uc3QgY2hhciAqZXJyc3RyID0gbGlidXNiX2Vycm9yX25hbWUocmMpOwot
ICAgICAgICBnX3dhcm5pbmcoIiVzOiBsaWJ1c2JfZ2V0X2RldmljZV9saXN0IGZhaWxlZCAtICVz
IiwgbmFtZSwgZXJyc3RyKTsKKyAgICBsdXNiX2xpc3QgPSBzcGljZV91c2JfYmFja2VuZF9nZXRf
ZGV2aWNlX2xpc3QocHJpdi0+Y3R4KTsKKyAgICBpZiAoIWx1c2JfbGlzdCkgewogICAgICAgICBn
X3NldF9lcnJvcihlcnIsIEdfVURFVl9DTElFTlRfRVJST1IsIEdfVURFVl9DTElFTlRfTElCVVNC
X0ZBSUxFRCwKLSAgICAgICAgICAgICAgICAgICAgIiVzOiBFcnJvciBnZXR0aW5nIGRldmljZSBs
aXN0IGZyb20gbGlidXNiOiAlcyBbJSJHX0dTU0laRV9GT1JNQVQiXSIsCi0gICAgICAgICAgICAg
ICAgICAgIG5hbWUsIGVycnN0ciwgcmMpOworICAgICAgICAgICAgICAgICAgICAiJXM6IEVycm9y
IGdldHRpbmcgVVNCIGRldmljZSBsaXN0IiwgbmFtZSk7CiAgICAgICAgIHJldHVybiAtNDsKICAg
ICB9CiAKICAgICBuID0gMDsKICAgICBmb3IgKGRldiA9IGx1c2JfbGlzdDsgKmRldjsgZGV2Kysp
IHsKLSAgICAgICAgaWYgKGdfdWRldl9za2lwX3NlYXJjaCgqZGV2KSkgewotICAgICAgICAgICAg
Y29udGludWU7Ci0gICAgICAgIH0KLSAgICAgICAgKmRldnMgPSBnX2xpc3RfcHJlcGVuZCgqZGV2
cywgbGlidXNiX3JlZl9kZXZpY2UoKmRldikpOworICAgICAgICAqZGV2cyA9IGdfbGlzdF9wcmVw
ZW5kKCpkZXZzLCBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfcmVmKCpkZXYpKTsKICAgICAgICAg
bisrOwogICAgIH0KLSAgICBsaWJ1c2JfZnJlZV9kZXZpY2VfbGlzdChsdXNiX2xpc3QsIDEpOwor
ICAgIHNwaWNlX3VzYl9iYWNrZW5kX2ZyZWVfZGV2aWNlX2xpc3QobHVzYl9saXN0KTsKIAogICAg
IHJldHVybiBuOwogfQogCi1zdGF0aWMgdm9pZCB1bnJlZmVyZW5jZV9saWJ1c2JfZGV2aWNlKGdw
b2ludGVyIGRhdGEpCitzdGF0aWMgdm9pZCB1bnJlZmVyZW5jZV9iYWNrZW5kX2RldmljZShncG9p
bnRlciBkYXRhKQogewotICAgIGxpYnVzYl91bnJlZl9kZXZpY2UoKGxpYnVzYl9kZXZpY2UgKilk
YXRhKTsKKyAgICBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfdW5yZWYoKFNwaWNlVXNiQmFja2Vu
ZERldmljZSAqKWRhdGEpOwogfQogCiBzdGF0aWMgdm9pZCBnX3VkZXZfY2xpZW50X2ZyZWVfZGV2
aWNlX2xpc3QoR0xpc3QgKipkZXZzKQogewogICAgIGdfcmV0dXJuX2lmX2ZhaWwoZGV2cyAhPSBO
VUxMKTsKICAgICBpZiAoKmRldnMpIHsKLSAgICAgICAgLyogdGhlIHVucmVmZXJlbmNlX2xpYnVz
Yl9kZXZpY2UgbWV0aG9kIGlzIHJlcXVpcmVkIGFzCi0gICAgICAgICAqIGxpYnVzYl91bnJlZl9k
ZXZpY2UgY2FsbGluZyBjb252ZW50aW9uIGRpZmZlcnMgZnJvbSBnbGliJ3MKLSAgICAgICAgICog
c2VlIDU1OGM5NjdlYwotICAgICAgICAgKi8KLSAgICAgICAgZ19saXN0X2ZyZWVfZnVsbCgqZGV2
cywgdW5yZWZlcmVuY2VfbGlidXNiX2RldmljZSk7CisgICAgICAgIGdfbGlzdF9mcmVlX2Z1bGwo
KmRldnMsIHVucmVmZXJlbmNlX2JhY2tlbmRfZGV2aWNlKTsKICAgICAgICAgKmRldnMgPSBOVUxM
OwogICAgIH0KIH0KQEAgLTE2MCw3ICsxNDUsNiBAQCBnX3VkZXZfY2xpZW50X2luaXRhYmxlX2lu
aXQoR0luaXRhYmxlICppbml0YWJsZSwgR0NhbmNlbGxhYmxlICpjYW5jZWxsYWJsZSwKICAgICBH
VWRldkNsaWVudCAqc2VsZjsKICAgICBHVWRldkNsaWVudFByaXZhdGUgKnByaXY7CiAgICAgV05E
Q0xBU1Mgd2NsczsKLSAgICBpbnQgcmM7CiAKICAgICBnX3JldHVybl92YWxfaWZfZmFpbChHX1VE
RVZfSVNfQ0xJRU5UKGluaXRhYmxlKSwgRkFMU0UpOwogICAgIGdfcmV0dXJuX3ZhbF9pZl9mYWls
KGNhbmNlbGxhYmxlID09IE5VTEwsIEZBTFNFKTsKQEAgLTE2OCwxNCArMTUyLDExIEBAIGdfdWRl
dl9jbGllbnRfaW5pdGFibGVfaW5pdChHSW5pdGFibGUgKmluaXRhYmxlLCBHQ2FuY2VsbGFibGUg
KmNhbmNlbGxhYmxlLAogICAgIHNlbGYgPSBHX1VERVZfQ0xJRU5UKGluaXRhYmxlKTsKICAgICBw
cml2ID0gc2VsZi0+cHJpdjsKIAotICAgIHJjID0gbGlidXNiX2luaXQoJnByaXYtPmN0eCk7Ci0g
ICAgaWYgKHJjIDwgMCkgewotICAgICAgICBjb25zdCBjaGFyICplcnJzdHIgPSBsaWJ1c2JfZXJy
b3JfbmFtZShyYyk7Ci0gICAgICAgIGdfd2FybmluZygiRXJyb3IgaW5pdGlhbGl6aW5nIFVTQiBz
dXBwb3J0OiAlcyBbJWldIiwgZXJyc3RyLCByYyk7Ci0gICAgICAgIGdfc2V0X2Vycm9yKGVyciwg
R19VREVWX0NMSUVOVF9FUlJPUiwgR19VREVWX0NMSUVOVF9MSUJVU0JfRkFJTEVELAotICAgICAg
ICAgICAgICAgICAgICAiRXJyb3IgaW5pdGlhbGl6aW5nIFVTQiBzdXBwb3J0OiAlcyBbJWldIiwg
ZXJyc3RyLCByYyk7CisgICAgcHJpdi0+Y3R4ID0gc3BpY2VfdXNiX2JhY2tlbmRfbmV3KGVycik7
CisgICAgaWYgKCFwcml2LT5jdHgpIHsKICAgICAgICAgcmV0dXJuIEZBTFNFOwogICAgIH0KKwog
I2lmZGVmIEdfT1NfV0lOMzIKICNpZiBMSUJVU0JfQVBJX1ZFUlNJT04gPj0gMHgwMTAwMDEwNgog
ICAgIGxpYnVzYl9zZXRfb3B0aW9uKHByaXYtPmN0eCwgTElCVVNCX09QVElPTl9VU0VfVVNCREsp
OwpAQCAtMjQ4LDkgKzIyOSw5IEBAIHN0YXRpYyB2b2lkIGdfdWRldl9jbGllbnRfZmluYWxpemUo
R09iamVjdCAqZ29iamVjdCkKICAgICBVbnJlZ2lzdGVyQ2xhc3MoR19VREVWX0NMSUVOVF9XSU5D
TEFTU19OQU1FLCBOVUxMKTsKICAgICBnX3VkZXZfY2xpZW50X2ZyZWVfZGV2aWNlX2xpc3QoJnBy
aXYtPnVkZXZfbGlzdCk7CiAKLSAgICAvKiBmcmVlIGxpYnVzYiBjb250ZXh0IGluaXRpYWxpemlu
ZyBieSBsaWJ1c2JfaW5pdCgpICovCisgICAgLyogZnJlZSBiYWNrZW5kIGNvbnRleHQgKi8KICAg
ICBnX3dhcm5faWZfZmFpbChwcml2LT5jdHggIT0gTlVMTCk7Ci0gICAgbGlidXNiX2V4aXQocHJp
di0+Y3R4KTsKKyAgICBzcGljZV91c2JfYmFja2VuZF9kZWxldGUocHJpdi0+Y3R4KTsKIAogICAg
IC8qIENoYWluIHVwIHRvIHRoZSBwYXJlbnQgY2xhc3MgKi8KICAgICBpZiAoR19PQkpFQ1RfQ0xB
U1MoZ191ZGV2X2NsaWVudF9wYXJlbnRfY2xhc3MpLT5maW5hbGl6ZSkKQEAgLTM0MCwyMCArMzIx
LDE4IEBAIHN0YXRpYyB2b2lkIGdfdWRldl9jbGllbnRfY2xhc3NfaW5pdChHVWRldkNsaWVudENs
YXNzICprbGFzcykKIH0KIAogLyogY29tcGFyaW5nIGJ1czphZGRyIGFuZCB2aWQ6cGlkICovCi1z
dGF0aWMgZ2ludCBjb21wYXJlX2xpYnVzYl9kZXZpY2VzKGdjb25zdHBvaW50ZXIgYSwgZ2NvbnN0
cG9pbnRlciBiKQorc3RhdGljIGdpbnQgY29tcGFyZV91c2JfZGV2aWNlcyhnY29uc3Rwb2ludGVy
IGEsIGdjb25zdHBvaW50ZXIgYikKIHsKLSAgICBsaWJ1c2JfZGV2aWNlICphX2RldiA9IChsaWJ1
c2JfZGV2aWNlICopYTsKLSAgICBsaWJ1c2JfZGV2aWNlICpiX2RldiA9IChsaWJ1c2JfZGV2aWNl
ICopYjsKLSAgICBzdHJ1Y3QgbGlidXNiX2RldmljZV9kZXNjcmlwdG9yIGFfZGVzYywgYl9kZXNj
OworICAgIGNvbnN0IFVzYkRldmljZUluZm9ybWF0aW9uICphX2luZm8sICpiX2luZm87CiAgICAg
Z2Jvb2xlYW4gc2FtZV9idXMsIHNhbWVfYWRkciwgc2FtZV92aWQsIHNhbWVfcGlkOworICAgIGFf
aW5mbyA9IHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9nZXRfaW5mbygoU3BpY2VVc2JCYWNrZW5k
RGV2aWNlICopYSk7CisgICAgYl9pbmZvID0gc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX2dldF9p
bmZvKChTcGljZVVzYkJhY2tlbmREZXZpY2UgKiliKTsKIAotICAgIGxpYnVzYl9nZXRfZGV2aWNl
X2Rlc2NyaXB0b3IoYV9kZXYsICZhX2Rlc2MpOwotICAgIGxpYnVzYl9nZXRfZGV2aWNlX2Rlc2Ny
aXB0b3IoYl9kZXYsICZiX2Rlc2MpOwogCi0gICAgc2FtZV9idXMgPSAobGlidXNiX2dldF9idXNf
bnVtYmVyKGFfZGV2KSA9PSBsaWJ1c2JfZ2V0X2J1c19udW1iZXIoYl9kZXYpKTsKLSAgICBzYW1l
X2FkZHIgPSAobGlidXNiX2dldF9kZXZpY2VfYWRkcmVzcyhhX2RldikgPT0gbGlidXNiX2dldF9k
ZXZpY2VfYWRkcmVzcyhiX2RldikpOwotICAgIHNhbWVfdmlkID0gKGFfZGVzYy5pZFZlbmRvciA9
PSBiX2Rlc2MuaWRWZW5kb3IpOwotICAgIHNhbWVfcGlkID0gKGFfZGVzYy5pZFByb2R1Y3QgPT0g
Yl9kZXNjLmlkUHJvZHVjdCk7CisgICAgc2FtZV9idXMgPSAoYV9pbmZvLT5idXMgPT0gYl9pbmZv
LT5idXMpOworICAgIHNhbWVfYWRkciA9IChhX2luZm8tPmFkZHJlc3MgPT0gYl9pbmZvLT5hZGRy
ZXNzKTsKKyAgICBzYW1lX3ZpZCA9IChhX2luZm8tPnZpZCA9PSBiX2luZm8tPnZpZCk7CisgICAg
c2FtZV9waWQgPSAoYV9pbmZvLT5waWQgPT0gYl9pbmZvLT5waWQpOwogCiAgICAgcmV0dXJuIChz
YW1lX2J1cyAmJiBzYW1lX2FkZHIgJiYgc2FtZV92aWQgJiYgc2FtZV9waWQpID8gMCA6IC0xOwog
fQpAQCAtMzYzLDEyICszNDIsMTIgQEAgc3RhdGljIHZvaWQgdXBkYXRlX2RldmljZV9saXN0KEdV
ZGV2Q2xpZW50ICpzZWxmLCBHTGlzdCAqbmV3X2RldmljZV9saXN0KQogICAgIEdMaXN0ICpkZXY7
CiAKICAgICBmb3IgKGRldiA9IGdfbGlzdF9maXJzdChuZXdfZGV2aWNlX2xpc3QpOyBkZXYgIT0g
TlVMTDsgZGV2ID0gZ19saXN0X25leHQoZGV2KSkgewotICAgICAgICBHTGlzdCAqZm91bmQgPSBn
X2xpc3RfZmluZF9jdXN0b20oc2VsZi0+cHJpdi0+dWRldl9saXN0LCBkZXYtPmRhdGEsIGNvbXBh
cmVfbGlidXNiX2RldmljZXMpOworICAgICAgICBHTGlzdCAqZm91bmQgPSBnX2xpc3RfZmluZF9j
dXN0b20oc2VsZi0+cHJpdi0+dWRldl9saXN0LCBkZXYtPmRhdGEsIGNvbXBhcmVfdXNiX2Rldmlj
ZXMpOwogICAgICAgICBpZiAoZm91bmQgIT0gTlVMTCkgewogICAgICAgICAgICAgLyoga2VlcCBv
bGQgZXhpc3RpbmcgbGlidXNiX2RldmljZSBpbiB0aGUgbmV3IGxpc3QsIHdoZW4KICAgICAgICAg
ICAgICAgIHVzYi1kZXYtbWFuYWdlciB3aWxsIG1haW50YWluIGl0cyBvd24gbGlzdCBvZiBsaWJ1
c2JfZGV2aWNlLAogICAgICAgICAgICAgICAgdGhlc2UgbGlzdHMgd2lsbCBiZSBjb21wbGV0ZWx5
IGNvbnNpc3RlbnQgKi8KLSAgICAgICAgICAgIGxpYnVzYl9kZXZpY2UgKnRlbXAgPSBmb3VuZC0+
ZGF0YTsKKyAgICAgICAgICAgIFNwaWNlVXNiQmFja2VuZERldmljZSAqdGVtcCA9IGZvdW5kLT5k
YXRhOwogICAgICAgICAgICAgZm91bmQtPmRhdGEgPSBkZXYtPmRhdGE7CiAgICAgICAgICAgICBk
ZXYtPmRhdGEgPSB0ZW1wOwogICAgICAgICB9CkBAIC0zODYsNyArMzY1LDcgQEAgc3RhdGljIHZv
aWQgbm90aWZ5X2Rldl9zdGF0ZV9jaGFuZ2UoR1VkZXZDbGllbnQgKnNlbGYsCiAgICAgR0xpc3Qg
KmRldjsKIAogICAgIGZvciAoZGV2ID0gZ19saXN0X2ZpcnN0KG9sZF9saXN0KTsgZGV2ICE9IE5V
TEw7IGRldiA9IGdfbGlzdF9uZXh0KGRldikpIHsKLSAgICAgICAgR0xpc3QgKmZvdW5kID0gZ19s
aXN0X2ZpbmRfY3VzdG9tKG5ld19saXN0LCBkZXYtPmRhdGEsIGNvbXBhcmVfbGlidXNiX2Rldmlj
ZXMpOworICAgICAgICBHTGlzdCAqZm91bmQgPSBnX2xpc3RfZmluZF9jdXN0b20obmV3X2xpc3Qs
IGRldi0+ZGF0YSwgY29tcGFyZV91c2JfZGV2aWNlcyk7CiAgICAgICAgIGlmIChmb3VuZCA9PSBO
VUxMKSB7CiAgICAgICAgICAgICBnX3VkZXZfZGV2aWNlX3ByaW50KGRldi0+ZGF0YSwgYWRkID8g
ImFkZCIgOiAicmVtb3ZlIik7CiAgICAgICAgICAgICBnX3NpZ25hbF9lbWl0KHNlbGYsIHNpZ25h
bHNbVUVWRU5UX1NJR05BTF0sIDAsIGRldi0+ZGF0YSwgYWRkKTsKQEAgLTQ0NywyOSArNDI2LDEx
IEBAIHN0YXRpYyB2b2lkIGdfdWRldl9kZXZpY2VfcHJpbnRfbGlzdChHTGlzdCAqbCwgY29uc3Qg
Z2NoYXIgKm1zZykKIH0KICNlbmRpZgogCi1zdGF0aWMgdm9pZCBnX3VkZXZfZGV2aWNlX3ByaW50
KGxpYnVzYl9kZXZpY2UgKmRldiwgY29uc3QgZ2NoYXIgKm1zZykKK3N0YXRpYyB2b2lkIGdfdWRl
dl9kZXZpY2VfcHJpbnQoU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpkZXYsIGNvbnN0IGdjaGFyICpt
c2cpCiB7Ci0gICAgc3RydWN0IGxpYnVzYl9kZXZpY2VfZGVzY3JpcHRvciBkZXNjOwotCi0gICAg
bGlidXNiX2dldF9kZXZpY2VfZGVzY3JpcHRvcihkZXYsICZkZXNjKTsKKyAgICBjb25zdCBVc2JE
ZXZpY2VJbmZvcm1hdGlvbiAqaW5mbyA9IHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9nZXRfaW5m
byhkZXYpOwogCiAgICAgU1BJQ0VfREVCVUcoIiVzOiAlZC4lZCAweCUwNHg6MHglMDR4IGNsYXNz
ICVkIiwgbXNnLAotICAgICAgICAgICAgICAgIGxpYnVzYl9nZXRfYnVzX251bWJlcihkZXYpLAot
ICAgICAgICAgICAgICAgIGxpYnVzYl9nZXRfZGV2aWNlX2FkZHJlc3MoZGV2KSwKLSAgICAgICAg
ICAgICAgICBkZXNjLmlkVmVuZG9yLCBkZXNjLmlkUHJvZHVjdCwgZGVzYy5iRGV2aWNlQ2xhc3Mp
OwotfQotCi1zdGF0aWMgZ2Jvb2xlYW4gZ191ZGV2X3NraXBfc2VhcmNoKGxpYnVzYl9kZXZpY2Ug
KmRldikKLXsKLSAgICBnYm9vbGVhbiBza2lwOwotICAgIHVpbnQ4X3QgYWRkciA9IGxpYnVzYl9n
ZXRfZGV2aWNlX2FkZHJlc3MoZGV2KTsKLSAgICBzdHJ1Y3QgbGlidXNiX2RldmljZV9kZXNjcmlw
dG9yIGRlc2M7Ci0KLSAgICBsaWJ1c2JfZ2V0X2RldmljZV9kZXNjcmlwdG9yKGRldiwgJmRlc2Mp
OwotCi0gICAgc2tpcCA9ICgoYWRkciA9PSAweGZmKSB8fCAgLyogcm9vdCBodWIgKEhDRCkgKi8K
LSAgICAgICAgICAgIChhZGRyID09IDEpIHx8IC8qIHJvb3QgaHViIGFkZHIgKi8KLSAgICAgICAg
ICAgIChkZXNjLmJEZXZpY2VDbGFzcyA9PSBMSUJVU0JfQ0xBU1NfSFVCKSB8fCAvKiBodWIqLwot
ICAgICAgICAgICAgKGFkZHIgPT0gMCkpOyAvKiBiYWQgYWRkcmVzcyAqLwotICAgIHJldHVybiBz
a2lwOworICAgICAgICAgICAgICAgIGluZm8tPmJ1cywgaW5mby0+YWRkcmVzcywKKyAgICAgICAg
ICAgICAgICBpbmZvLT52aWQsIGluZm8tPnBpZCwgaW5mby0+Y2xhc3MpOwogfQpkaWZmIC0tZ2l0
IGEvc3JjL3dpbi11c2ItZGV2LmggYi9zcmMvd2luLXVzYi1kZXYuaAppbmRleCBiMWMwZTI3Li5m
ZGZlNzNhIDEwMDY0NAotLS0gYS9zcmMvd2luLXVzYi1kZXYuaAorKysgYi9zcmMvd2luLXVzYi1k
ZXYuaApAQCAtMjMsNiArMjMsNyBAQAogI2RlZmluZSBfX1dJTl9VU0JfREVWX0hfXwogCiAjaW5j
bHVkZSA8Z2lvL2dpby5oPgorI2luY2x1ZGUgInVzYi1iYWNrZW5kLmgiCiAKIEdfQkVHSU5fREVD
TFMKIApAQCAtNTEsMTIgKzUyLDEyIEBAIHN0cnVjdCBfR1VkZXZDbGllbnRDbGFzcwogICAgIEdP
YmplY3RDbGFzcyBwYXJlbnRfY2xhc3M7CiAKICAgICAvKiBzaWduYWxzICovCi0gICAgdm9pZCAo
KnVldmVudCkoR1VkZXZDbGllbnQgKmNsaWVudCwgbGlidXNiX2RldmljZSAqZGV2aWNlLCBnYm9v
bGVhbiBhZGQpOworICAgIHZvaWQgKCp1ZXZlbnQpKEdVZGV2Q2xpZW50ICpjbGllbnQsIFNwaWNl
VXNiQmFja2VuZERldmljZSAqZGV2aWNlLCBnYm9vbGVhbiBhZGQpOwogfTsKIAogR1R5cGUgZ191
ZGV2X2NsaWVudF9nZXRfdHlwZSh2b2lkKSBHX0dOVUNfQ09OU1Q7CiBHVWRldkNsaWVudCAqZ191
ZGV2X2NsaWVudF9uZXcodm9pZCk7Ci1saWJ1c2JfY29udGV4dCAqZ191ZGV2X2NsaWVudF9nZXRf
Y29udGV4dChHVWRldkNsaWVudCAqY2xpZW50KTsKK1NwaWNlVXNiQmFja2VuZCAqZ191ZGV2X2Ns
aWVudF9nZXRfY29udGV4dChHVWRldkNsaWVudCAqY2xpZW50KTsKIHZvaWQgZ191ZGV2X2NsaWVu
dF9yZXBvcnRfZGV2aWNlcyhHVWRldkNsaWVudCAqY2xpZW50KTsKIAogR1F1YXJrIGdfdWRldl9j
bGllbnRfZXJyb3JfcXVhcmsodm9pZCk7Ci0tIAoyLjIwLjEKCl9fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fClNwaWNlLWRldmVsIG1haWxpbmcgbGlzdApTcGlj
ZS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5v
cmcvbWFpbG1hbi9saXN0aW5mby9zcGljZS1kZXZlbA==
