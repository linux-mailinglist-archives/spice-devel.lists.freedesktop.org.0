Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 560D715FDF
	for <lists+spice-devel@lfdr.de>; Tue,  7 May 2019 10:56:14 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id CD90089F97;
	Tue,  7 May 2019 08:56:12 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id AA83F89F6F
 for <spice-devel@lists.freedesktop.org>; Tue,  7 May 2019 08:56:10 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx03.intmail.prod.int.phx2.redhat.com
 [10.5.11.13])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id 54BF83097031
 for <spice-devel@lists.freedesktop.org>; Tue,  7 May 2019 08:56:10 +0000 (UTC)
Received: from toolbox.mxp.redhat.com (unknown [10.32.181.168])
 by smtp.corp.redhat.com (Postfix) with ESMTP id CFA01611DC
 for <spice-devel@lists.freedesktop.org>; Tue,  7 May 2019 08:56:09 +0000 (UTC)
From: Victor Toso <victortoso@redhat.com>
To: spice-devel@lists.freedesktop.org
Date: Tue,  7 May 2019 08:56:05 +0000
Message-Id: <20190507085605.10054-5-victortoso@redhat.com>
In-Reply-To: <20190507085605.10054-1-victortoso@redhat.com>
References: <20190507085605.10054-1-victortoso@redhat.com>
MIME-Version: 1.0
X-Scanned-By: MIMEDefang 2.79 on 10.5.11.13
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16
 (mx1.redhat.com [10.5.110.43]); Tue, 07 May 2019 08:56:10 +0000 (UTC)
Subject: [Spice-devel] [spice-gtk v1 4/4] channel-usbredir: move polkit
 related checks to usb-acl-helper
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

RnJvbTogVmljdG9yIFRvc28gPG1lQHZpY3RvcnRvc28uY29tPgoKVGhlcmUgaXMgbm8gbmVlZCB0
byBkaXJlY3QgaW50ZXJhY3Rpb24gd2l0aCBwb2xraXQgaW4KY2hhbm5lbC11c2JyZWRpci4gTGV0
J3Mga2VlcCBhbGwgdGhlIGFjY2VzcyBjb250cm9sIHJlbGF0ZWQgY29kZSB0bwp1c2ItYWNsLWhl
bHBlciBBUElzLgoKVGhpcyBwYXRjaCBtb3ZlcyB0aGUgZ190YXNrX3J1bl9pbl90aHJlYWQoKSB0
bwpzcGljZV91c2JfYWNsX2hlbHBlcl9vcGVuX2FjbF9hc3luYygpIHRvIGtlZXAgY29kZSBiZWhh
dmluZyBzaW1pbGFybHkKdG8gd2hhdCB3ZSBoYWQgYmVmb3JlIHRoaXMgcGF0Y2guCgpTaWduZWQt
b2ZmLWJ5OiBWaWN0b3IgVG9zbyA8dmljdG9ydG9zb0ByZWRoYXQuY29tPgotLS0KIHNyYy9jaGFu
bmVsLXVzYnJlZGlyLmMgfCA1MiArKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0KIHNyYy91c2ItYWNsLWhlbHBlci5jICAgfCAyMSArKysrKysrKysrKysrKysrKwogMiBm
aWxlcyBjaGFuZ2VkLCAyMyBpbnNlcnRpb25zKCspLCA1MCBkZWxldGlvbnMoLSkKCmRpZmYgLS1n
aXQgYS9zcmMvY2hhbm5lbC11c2JyZWRpci5jIGIvc3JjL2NoYW5uZWwtdXNicmVkaXIuYwppbmRl
eCA1MjE0MTYwLi41NDExYTUxIDEwMDY0NAotLS0gYS9zcmMvY2hhbm5lbC11c2JyZWRpci5jCisr
KyBiL3NyYy9jaGFubmVsLXVzYnJlZGlyLmMKQEAgLTI3LDkgKzI3LDcgQEAKICNpZmRlZiBVU0Vf
TFo0CiAjaW5jbHVkZSA8bHo0Lmg+CiAjZW5kaWYKLSNpZmRlZiBVU0VfUE9MS0lUCiAjaW5jbHVk
ZSAidXNiLWFjbC1oZWxwZXIuaCIKLSNlbmRpZgogI2luY2x1ZGUgImNoYW5uZWwtdXNicmVkaXIt
cHJpdi5oIgogI2luY2x1ZGUgInVzYi1kZXZpY2UtbWFuYWdlci1wcml2LmgiCiAjaW5jbHVkZSAi
dXNidXRpbC5oIgpAQCAtNTUsOSArNTMsNyBAQAogI2RlZmluZSBDT01QUkVTU19USFJFU0hPTEQg
MTAwMAogZW51bSBTcGljZVVzYnJlZGlyQ2hhbm5lbFN0YXRlIHsKICAgICBTVEFURV9ESVNDT05O
RUNURUQsCi0jaWZkZWYgVVNFX1BPTEtJVAogICAgIFNUQVRFX1dBSVRJTkdfRk9SX0FDTF9IRUxQ
RVIsCi0jZW5kaWYKICAgICBTVEFURV9DT05ORUNURUQsCiAgICAgU1RBVEVfRElTQ09OTkVDVElO
RywKIH07CkBAIC03MywxMCArNjksOCBAQCBzdHJ1Y3QgX1NwaWNlVXNicmVkaXJDaGFubmVsUHJp
dmF0ZSB7CiAgICAgY29uc3QgdWludDhfdCAqcmVhZF9idWY7CiAgICAgaW50IHJlYWRfYnVmX3Np
emU7CiAgICAgZW51bSBTcGljZVVzYnJlZGlyQ2hhbm5lbFN0YXRlIHN0YXRlOwotI2lmZGVmIFVT
RV9QT0xLSVQKICAgICBHVGFzayAqdGFzazsKICAgICBTcGljZVVzYkFjbEhlbHBlciAqYWNsX2hl
bHBlcjsKLSNlbmRpZgogICAgIEdNdXRleCBkZXZpY2VfY29ubmVjdF9tdXRleDsKICAgICBTcGlj
ZVVzYkRldmljZU1hbmFnZXIgKnVzYl9kZXZpY2VfbWFuYWdlcjsKIH07CkBAIC0yODIsMTEgKzI3
Niw4IEBAIHN0YXRpYyBnYm9vbGVhbiBzcGljZV91c2JyZWRpcl9jaGFubmVsX29wZW5fZGV2aWNl
KAogICAgIGludCByYywgc3RhdHVzOwogICAgIFNwaWNlVXNiRGV2aWNlTWFuYWdlciAqbWFuYWdl
cjsKIAotICAgIGdfcmV0dXJuX3ZhbF9pZl9mYWlsKHByaXYtPnN0YXRlID09IFNUQVRFX0RJU0NP
Tk5FQ1RFRAotI2lmZGVmIFVTRV9QT0xLSVQKLSAgICAgICAgICAgICAgICAgICAgICAgICB8fCBw
cml2LT5zdGF0ZSA9PSBTVEFURV9XQUlUSU5HX0ZPUl9BQ0xfSEVMUEVSCi0jZW5kaWYKLSAgICAg
ICAgICAgICAgICAgICAgICAgICAsIEZBTFNFKTsKKyAgICBnX3JldHVybl92YWxfaWZfZmFpbChw
cml2LT5zdGF0ZSA9PSBTVEFURV9ESVNDT05ORUNURUQgfHwKKyAgICAgICAgICAgICAgICAgICAg
ICAgICBwcml2LT5zdGF0ZSA9PSBTVEFURV9XQUlUSU5HX0ZPUl9BQ0xfSEVMUEVSLCBGQUxTRSk7
CiAKICAgICByYyA9IGxpYnVzYl9vcGVuKHByaXYtPmRldmljZSwgJmhhbmRsZSk7CiAgICAgaWYg
KHJjICE9IDApIHsKQEAgLTMxOSw3ICszMTAsNiBAQCBzdGF0aWMgZ2Jvb2xlYW4gc3BpY2VfdXNi
cmVkaXJfY2hhbm5lbF9vcGVuX2RldmljZSgKICAgICByZXR1cm4gVFJVRTsKIH0KIAotI2lmZGVm
IFVTRV9QT0xLSVQKIHN0YXRpYyB2b2lkIHNwaWNlX3VzYnJlZGlyX2NoYW5uZWxfb3Blbl9hY2xf
Y2IoCiAgICAgR09iamVjdCAqZ29iamVjdCwgR0FzeW5jUmVzdWx0ICphY2xfcmVzLCBncG9pbnRl
ciB1c2VyX2RhdGEpCiB7CkBAIC0zNTksMzcgKzM0OSw2IEBAIHN0YXRpYyB2b2lkIHNwaWNlX3Vz
YnJlZGlyX2NoYW5uZWxfb3Blbl9hY2xfY2IoCiAKICAgICBnX2NsZWFyX29iamVjdCgmcHJpdi0+
dGFzayk7CiB9Ci0jZW5kaWYKLQotI2lmbmRlZiBVU0VfUE9MS0lUCi1zdGF0aWMgdm9pZAotX29w
ZW5fZGV2aWNlX2FzeW5jX2NiKEdUYXNrICp0YXNrLAotICAgICAgICAgICAgICAgICAgICAgIGdw
b2ludGVyIG9iamVjdCwKLSAgICAgICAgICAgICAgICAgICAgICBncG9pbnRlciB0YXNrX2RhdGEs
Ci0gICAgICAgICAgICAgICAgICAgICAgR0NhbmNlbGxhYmxlICpjYW5jZWxsYWJsZSkKLXsKLSAg
ICBHRXJyb3IgKmVyciA9IE5VTEw7Ci0gICAgU3BpY2VVc2JyZWRpckNoYW5uZWwgKmNoYW5uZWwg
PSBTUElDRV9VU0JSRURJUl9DSEFOTkVMKG9iamVjdCk7Ci0gICAgU3BpY2VVc2JyZWRpckNoYW5u
ZWxQcml2YXRlICpwcml2ID0gY2hhbm5lbC0+cHJpdjsKLQotICAgIHNwaWNlX3VzYnJlZGlyX2No
YW5uZWxfbG9jayhjaGFubmVsKTsKLQotICAgIGlmICghc3BpY2VfdXNicmVkaXJfY2hhbm5lbF9v
cGVuX2RldmljZShjaGFubmVsLCAmZXJyKSkgewotICAgICAgICBsaWJ1c2JfdW5yZWZfZGV2aWNl
KHByaXYtPmRldmljZSk7Ci0gICAgICAgIHByaXYtPmRldmljZSA9IE5VTEw7Ci0gICAgICAgIGdf
Ym94ZWRfZnJlZShzcGljZV91c2JfZGV2aWNlX2dldF90eXBlKCksIHByaXYtPnNwaWNlX2Rldmlj
ZSk7Ci0gICAgICAgIHByaXYtPnNwaWNlX2RldmljZSA9IE5VTEw7Ci0gICAgfQotCi0gICAgc3Bp
Y2VfdXNicmVkaXJfY2hhbm5lbF91bmxvY2soY2hhbm5lbCk7Ci0KLSAgICBpZiAoZXJyKSB7Ci0g
ICAgICAgIGdfdGFza19yZXR1cm5fZXJyb3IodGFzaywgZXJyKTsKLSAgICB9IGVsc2UgewotICAg
ICAgICBnX3Rhc2tfcmV0dXJuX2Jvb2xlYW4odGFzaywgVFJVRSk7Ci0gICAgfQotfQotI2VuZGlm
CiAKIEdfR05VQ19JTlRFUk5BTAogdm9pZCBzcGljZV91c2JyZWRpcl9jaGFubmVsX2Nvbm5lY3Rf
ZGV2aWNlX2FzeW5jKApAQCAtNDMwLDcgKzM4OSw2IEBAIHZvaWQgc3BpY2VfdXNicmVkaXJfY2hh
bm5lbF9jb25uZWN0X2RldmljZV9hc3luYygKICAgICBwcml2LT5kZXZpY2UgPSBsaWJ1c2JfcmVm
X2RldmljZShkZXZpY2UpOwogICAgIHByaXYtPnNwaWNlX2RldmljZSA9IGdfYm94ZWRfY29weShz
cGljZV91c2JfZGV2aWNlX2dldF90eXBlKCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHNwaWNlX2RldmljZSk7Ci0jaWZkZWYgVVNFX1BPTEtJVAogICAgIHByaXYtPnRh
c2sgPSB0YXNrOwogICAgIHByaXYtPnN0YXRlICA9IFNUQVRFX1dBSVRJTkdfRk9SX0FDTF9IRUxQ
RVI7CiAgICAgcHJpdi0+YWNsX2hlbHBlciA9IHNwaWNlX3VzYl9hY2xfaGVscGVyX25ldygpOwpA
QCAtNDQzLDEwICs0MDEsNiBAQCB2b2lkIHNwaWNlX3VzYnJlZGlyX2NoYW5uZWxfY29ubmVjdF9k
ZXZpY2VfYXN5bmMoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Bp
Y2VfdXNicmVkaXJfY2hhbm5lbF9vcGVuX2FjbF9jYiwKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBjaGFubmVsKTsKICAgICByZXR1cm47Ci0jZWxzZQotICAgIGdfdGFz
a19ydW5faW5fdGhyZWFkKHRhc2ssIF9vcGVuX2RldmljZV9hc3luY19jYik7Ci0jZW5kaWYKLQog
ZG9uZToKICAgICBnX29iamVjdF91bnJlZih0YXNrKTsKIH0KQEAgLTQ3NywxMyArNDMxLDExIEBA
IHZvaWQgc3BpY2VfdXNicmVkaXJfY2hhbm5lbF9kaXNjb25uZWN0X2RldmljZShTcGljZVVzYnJl
ZGlyQ2hhbm5lbCAqY2hhbm5lbCkKICAgICBjYXNlIFNUQVRFX0RJU0NPTk5FQ1RFRDoKICAgICBj
YXNlIFNUQVRFX0RJU0NPTk5FQ1RJTkc6CiAgICAgICAgIGJyZWFrOwotI2lmZGVmIFVTRV9QT0xL
SVQKICAgICBjYXNlIFNUQVRFX1dBSVRJTkdfRk9SX0FDTF9IRUxQRVI6CiAgICAgICAgIHByaXYt
PnN0YXRlID0gU1RBVEVfRElTQ09OTkVDVElORzsKICAgICAgICAgLyogV2UncmUgc3RpbGwgd2Fp
dGluZyBmb3IgdGhlIGFjbCBoZWxwZXIgLT4gY2FuY2VsIGl0ICovCiAgICAgICAgIHNwaWNlX3Vz
Yl9hY2xfaGVscGVyX2NhbmNlbChwcml2LT5hY2xfaGVscGVyKTsKICAgICAgICAgYnJlYWs7Ci0j
ZW5kaWYKICAgICBjYXNlIFNUQVRFX0NPTk5FQ1RFRDoKICAgICAgICAgLyoKICAgICAgICAgICog
VGhpcyBzZXRzIHRoZSB1c2IgZXZlbnQgdGhyZWFkIHJ1biBjb25kaXRpb24gdG8gRkFMU0UsIHRo
ZXJlZm9yCmRpZmYgLS1naXQgYS9zcmMvdXNiLWFjbC1oZWxwZXIuYyBiL3NyYy91c2ItYWNsLWhl
bHBlci5jCmluZGV4IDMwYWMzZGQuLjZlOWEwYWIgMTAwNjQ0Ci0tLSBhL3NyYy91c2ItYWNsLWhl
bHBlci5jCisrKyBiL3NyYy91c2ItYWNsLWhlbHBlci5jCkBAIC0yMDMsNiArMjAzLDIzIEBAIGV4
ZWNfdXNiX2FjbF9oZWxwZXJfYmluKFNwaWNlVXNiQWNsSGVscGVyICpzZWxmLAogICAgICAgICAg
ICAgICAgICAgIChHSU9GdW5jKWNiX291dF93YXRjaCwgZ19vYmplY3RfcmVmKHNlbGYpKTsKICAg
ICByZXR1cm4gVFJVRTsKIH0KKworI2Vsc2UKKworc3RhdGljIHZvaWQKK2NvbXBsZXRlX2xhdGVy
KEdUYXNrICp0YXNrLAorICAgICAgICAgICAgICAgR19HTlVDX1VOVVNFRCBncG9pbnRlciBvYmpl
Y3QsCisgICAgICAgICAgICAgICBHX0dOVUNfVU5VU0VEIGdwb2ludGVyIHRhc2tfZGF0YSwKKyAg
ICAgICAgICAgICAgIEdDYW5jZWxsYWJsZSAqY2FuY2VsbGFibGUpCit7CisgICAgaWYgKGdfY2Fu
Y2VsbGFibGVfaXNfY2FuY2VsbGVkKGNhbmNlbGxhYmxlKSkgeworICAgICAgICBhc3luY19yZXN1
bHRfc2V0X2NhbmNlbGxlZCh0YXNrKTsKKyAgICAgICAgcmV0dXJuOworICAgIH0KKworICAgIGdf
dGFza19yZXR1cm5fYm9vbGVhbih0YXNrLCBUUlVFKTsKK30KKwogI2VuZGlmIC8qIFVTRV9QT0xL
SVQgKi8KIAogLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tICovCkBAIC0yNjEsNiArMjc4LDEwIEBAIHZvaWQgc3BpY2Vf
dXNiX2FjbF9oZWxwZXJfb3Blbl9hY2xfYXN5bmMoU3BpY2VVc2JBY2xIZWxwZXIgKnNlbGYsCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdfQ0FM
TEJBQ0soY2FuY2VsbGVkX2NiKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgc2VsZiwgTlVMTCk7CiAgICAgfQorCisjaWZuZGVmIFVTRV9QT0xL
SVQKKyAgICBnX3Rhc2tfcnVuX2luX3RocmVhZCh0YXNrLCBjb21wbGV0ZV9sYXRlcik7CisjZW5k
aWYKICAgICByZXR1cm47CiAKIGRvbmU6Ci0tIAoyLjIwLjEKCl9fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fClNwaWNlLWRldmVsIG1haWxpbmcgbGlzdApTcGlj
ZS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5v
cmcvbWFpbG1hbi9saXN0aW5mby9zcGljZS1kZXZlbA==
