Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 9713172D4B
	for <lists+spice-devel@lfdr.de>; Wed, 24 Jul 2019 13:20:23 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 1A6336E523;
	Wed, 24 Jul 2019 11:20:22 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id C53386E523
 for <spice-devel@lists.freedesktop.org>; Wed, 24 Jul 2019 11:20:20 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx07.intmail.prod.int.phx2.redhat.com
 [10.5.11.22])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id 56F2BC065F8D
 for <spice-devel@lists.freedesktop.org>; Wed, 24 Jul 2019 11:20:20 +0000 (UTC)
Received: from lub.tlv (dhcp-4-204.tlv.redhat.com [10.35.4.204])
 by smtp.corp.redhat.com (Postfix) with ESMTPS id B2EC71001B0F;
 Wed, 24 Jul 2019 11:20:17 +0000 (UTC)
To: Frediano Ziglio <fziglio@redhat.com>, spice-devel@lists.freedesktop.org
References: <20190723202114.3076-1-fziglio@redhat.com>
From: Uri Lublin <uril@redhat.com>
Organization: Red Hat
Message-ID: <b0c0a7f9-4879-f0a0-7fbd-babe166a056d@redhat.com>
Date: Wed, 24 Jul 2019 14:20:15 +0300
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.8.0
MIME-Version: 1.0
In-Reply-To: <20190723202114.3076-1-fziglio@redhat.com>
Content-Language: en-US
X-Scanned-By: MIMEDefang 2.84 on 10.5.11.22
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16
 (mx1.redhat.com [10.5.110.31]); Wed, 24 Jul 2019 11:20:20 +0000 (UTC)
Subject: Re: [Spice-devel] [PATCH spice-server v2] red-parse-qxl: Fix QUIC
 images from QXL
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Reply-To: uril@redhat.com
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

SGkgRnJlZGlhbm8sCgpPbiA3LzIzLzE5IDExOjIxIFBNLCBGcmVkaWFubyBaaWdsaW8gd3JvdGU6
Cj4gVGhlIGRlY29kaW5nIGlzIHdyb25nLCB0aGUgUmVkIGFuZCBRWEwgc3RydWN0dXJlcyBhcmUg
ZGlmZmVyZW50IHNvCj4gY29kZSBpcyBub3QgZG9pbmcgd2hhdCBpcyBleHBlY3RlZC4gcmVkLXBh
cnNlLXF4bCB0cmFuc2xhdGUgZnJvbSBRWEwKPiB0byBSZWQgc3RydWN0dXJlcywgcmVkLXJlY29y
ZC1xeGwgc2F2ZXMgUmVkIHN0cnVjdHVyZSB0byBmaWxlLAo+IHJlZC1yZXBsYXktcXhsIGlzIHN1
cHBvc2VkIHRvIHJlYWQgZnJvbSBmaWxlIGludG8gUVhMIGRpcmVjdGx5Lgo+IAo+IElmIGEgUXVp
YyBpbWFnZSBpcyBzdG9yZWQgaW5zaWRlIFFYTCBtZW1vcnkgdGhlIGxheW91dCBvZiB0aGUgUVhM
SW1hZ2UKPiBpbiBtZW1vcnkgaXM6Cj4gLSBRWExJbWFnZURlc2NyaXB0b3IKPiAtIFFYTFFVSUNE
YXRhCj4gLSBRWExEYXRhQ2h1bmsKPiAtIGZpcnN0IGNodW5rIGRhdGEKPiBhbmQgYWxsIHJlbWFp
bmluZyBkYXRhIGluIGxpbmtlZCBRWExEYXRhQ2h1bmsuCj4gcmVkX3JlcGxheV9pbWFnZSB3YXMg
cmVhZGluZyB0aGUgaW1hZ2UgYXMgZGF0YSB3YXMgYWxsIGNvbnRhaW5lZCBpbgo+IFFYTEltYWdl
LT5xdWljLmRhdGEgaG93ZXZlciAiZGF0YSIgc2hvdWxlIHN0b3JlIHRoZSBmaXJzdCBRWExEYXRh
Q2h1bmsKCnNob3VsZSAtPiBzaG91bGQKCj4gZm9sbG93ZWQgYnkgUVhMRGF0YUNodW5rIGRhdGEu
Cj4gVXNlIHByb3BlciBiYXNlX3NpemUgY2FsbGluZyByZWRfcmVwbGF5X2RhdGFfY2h1bmtzIGlu
IG9yZGVyIHRvCj4gaW5pdGlhbGlzZSB0aGUgaW1hZ2Ugd2l0aCB0aGUgZmlyc3QgZGF0YSBjaHVu
ayBjb3JyZWN0bHkuCgpJIGxpa2UgdGhpcyBwYXRjaCBiZXR0ZXIgdGhlbiB0aGUgZmlyc3Qgb25l
LgoKCgo+IAo+IE5vdCBlYXN5IHRvIHJlcHJvZHVjZSwgdGhlIG9ubHkgZHJpdmVyIGlzIFhERE0g
d2hpY2ggbWVhbnMgV2luZG93cyBYUAo+IG9yIHNpbWlsYXJzLCBJIGdvdCBubyByZWNvcmRpbmcg
d2l0aCBzdWNoIGltYWdlcy4KPiAKPiBTaWduZWQtb2ZmLWJ5OiBGcmVkaWFubyBaaWdsaW8gPGZ6
aWdsaW9AcmVkaGF0LmNvbT4KPiAtLS0KPiAgIHNlcnZlci9yZWQtcmVwbGF5LXF4bC5jIHwgMTcg
KysrKysrKysrKy0tLS0tLS0KPiAgIDEgZmlsZSBjaGFuZ2VkLCAxMCBpbnNlcnRpb25zKCspLCA3
IGRlbGV0aW9ucygtKQo+IAo+IENoYW5nZXMgdjE6Cj4gLSByZWFsbG9jIHRoZSBidWZmZXIgaW5z
aWRlIHJlYWRfYmluYXJ5IHdpdGggdGhlIHByb3BlciBzaXplLgo+ICAgIFRoZSBwcm9wZXIgc2l6
ZSBpZiBub3QgYXZhaWxhYmxlIGluIHJlZF9yZXBsYXlfaW1hZ2UuCgpDYW4gd2Ugbm90IGp1c3Qg
Zml4IHRoZSBhYm92ZSB3aXRob3V0IG1vdmluZyB0aGUgcmVhbGxvYyBjYWxsID8KQmVmb3JlIG9u
bHkgUVVJQyBtZW1vcnkgKHdoaWNoIHdhcyBtYWxsb2MnZWQpIHdhcyByZWFsbG9jJ2VkLgpXaXRo
IHRoaXMgb3RoZXIgbWVtb3J5IG1heSBiZSByZWFsbG9jZWQuCgpBbGxvY2F0ZSBtb3JlIG1lbW9y
eSAoYWRkIHNpemVvZihRWExEYXRhQ2h1bmspKQogICAgcXhsID0gcmVwbGF5X3JlYWxsb2MocmVw
bGF5LCBxeGwsIHNpemVvZihRWExJbWFnZURlc2NyaXB0b3IpCiAgICAgICAgICAgICAgICAgICAg
ICAgICArIHNpemVvZihRWExRVUlDRGF0YSkKICAgICAgICAgICAgICAgICAgICAgICAgICsgc2l6
ZW9mKFFYTERhdGFDaHVuaykKICAgICAgICAgICAgICAgICAgICAgICAgICsgcXhsLT5xdWljLmRh
dGFfc2l6ZSk7CgpDYWxsIHJlZF9yZXBsYXlfZGF0YV9jaHVua3MgYXMgeW91IGRvIGluIHRoaXMg
cGF0Y2gKQ2FsbCByZWRfcmVwbGF5X2RhdGFfY2h1bmtzX2ZyZWUgYXMgeW91IGRvIGluIHRoaXMg
cGF0Y2guCgpVcmkuCgo+IAo+IGRpZmYgLS1naXQgYS9zZXJ2ZXIvcmVkLXJlcGxheS1xeGwuYyBi
L3NlcnZlci9yZWQtcmVwbGF5LXF4bC5jCj4gaW5kZXggNjc0ZmVhZTJmLi4xZjFiZDhjMWQgMTAw
NjQ0Cj4gLS0tIGEvc2VydmVyL3JlZC1yZXBsYXktcXhsLmMKPiArKysgYi9zZXJ2ZXIvcmVkLXJl
cGxheS1xeGwuYwo+IEBAIC0xMTQsNiArMTE0LDkgQEAgc3RhdGljIGlubGluZSB2b2lkIHJlcGxh
eV9mcmVlKFNwaWNlUmVwbGF5ICpyZXBsYXksIHZvaWQgKm1lbSkKPiAgIAo+ICAgc3RhdGljIGlu
bGluZSB2b2lkICpyZXBsYXlfcmVhbGxvYyhTcGljZVJlcGxheSAqcmVwbGF5LCB2b2lkICptZW0s
IHNpemVfdCBuX2J5dGVzKQo+ICAgewo+ICsgICAgaWYgKG1lbSA9PSBOVUxMKSB7Cj4gKyAgICAg
ICAgcmV0dXJuIHJlcGxheV9tYWxsb2MocmVwbGF5LCBuX2J5dGVzKTsKPiArICAgIH0KPiAgICAg
ICBHTGlzdCAqZWxlbSA9IGdfbGlzdF9maW5kKHJlcGxheS0+YWxsb2NhdGVkLCBtZW0pOwo+ICAg
ICAgIGVsZW0tPmRhdGEgPSBnX3JlYWxsb2MobWVtLCBuX2J5dGVzKTsKPiAgICAgICByZXR1cm4g
ZWxlbS0+ZGF0YTsKPiBAQCAtMjMxLDkgKzIzNCw3IEBAIHN0YXRpYyByZXBsYXlfdCByZWFkX2Jp
bmFyeShTcGljZVJlcGxheSAqcmVwbGF5LCBjb25zdCBjaGFyICpwcmVmaXgsIHNpemVfdCAqc2l6
Cj4gICAgICAgICAgIHJldHVybiBSRVBMQVlfRVJST1I7Cj4gICAgICAgfQo+ICAgCj4gLSAgICBp
ZiAoKmJ1ZiA9PSBOVUxMKSB7Cj4gLSAgICAgICAgKmJ1ZiA9IHJlcGxheV9tYWxsb2MocmVwbGF5
LCAqc2l6ZSArIGJhc2Vfc2l6ZSk7Cj4gLSAgICB9Cj4gKyAgICAqYnVmID0gcmVwbGF5X3JlYWxs
b2MocmVwbGF5LCAqYnVmLCAqc2l6ZSArIGJhc2Vfc2l6ZSk7Cj4gICAjaWYgMAo+ICAgICAgIHsK
PiAgICAgICAgICAgaW50IG51bV9yZWFkID0gZnJlYWQoKmJ1ZiArIGJhc2Vfc2l6ZSwgKnNpemUs
IDEsIGZkKTsKPiBAQCAtNDk3LDkgKzQ5OCw5IEBAIHN0YXRpYyBRWExJbWFnZSAqcmVkX3JlcGxh
eV9pbWFnZShTcGljZVJlcGxheSAqcmVwbGF5LCB1aW50MzJfdCBmbGFncykKPiAgICAgICAgICAg
aWYgKHJlcGxheS0+ZXJyb3IpIHsKPiAgICAgICAgICAgICAgIHJldHVybiBOVUxMOwo+ICAgICAg
ICAgICB9Cj4gLSAgICAgICAgcXhsID0gcmVwbGF5X3JlYWxsb2MocmVwbGF5LCBxeGwsIHNpemVv
ZihRWExJbWFnZURlc2NyaXB0b3IpICsgc2l6ZW9mKFFYTFFVSUNEYXRhKSArCj4gLSAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgcXhsLT5xdWljLmRhdGFfc2l6ZSk7Cj4gLSAgICAgICAgc2l6
ZSA9IHJlZF9yZXBsYXlfZGF0YV9jaHVua3MocmVwbGF5LCAicXVpYy5kYXRhIiwgKHVpbnQ4X3Qq
KikmcXhsLT5xdWljLmRhdGEsIDApOwo+ICsgICAgICAgIHNpemUgPSByZWRfcmVwbGF5X2RhdGFf
Y2h1bmtzKHJlcGxheSwgInF1aWMuZGF0YSIsICh1aW50OF90KiopJnF4bCwKPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplb2YoUVhMSW1hZ2VEZXNjcmlwdG9yKSAr
IHNpemVvZihRWExRVUlDRGF0YSkgKwo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHNpemVvZihRWExEYXRhQ2h1bmspKTsKPiAgICAgICAgICAgc3BpY2VfYXNzZXJ0KHNp
emUgPT0gcXhsLT5xdWljLmRhdGFfc2l6ZSk7Cj4gICAgICAgICAgIGJyZWFrOwo+ICAgICAgIGRl
ZmF1bHQ6Cj4gQEAgLTUyNiw3ICs1MjcsOSBAQCBzdGF0aWMgdm9pZCByZWRfcmVwbGF5X2ltYWdl
X2ZyZWUoU3BpY2VSZXBsYXkgKnJlcGxheSwgUVhMUEhZU0lDQUwgcCwgdWludDMyX3QgZgo+ICAg
ICAgIGNhc2UgU1BJQ0VfSU1BR0VfVFlQRV9TVVJGQUNFOgo+ICAgICAgICAgICBicmVhazsKPiAg
ICAgICBjYXNlIFNQSUNFX0lNQUdFX1RZUEVfUVVJQzoKPiAtICAgICAgICByZWRfcmVwbGF5X2Rh
dGFfY2h1bmtzX2ZyZWUocmVwbGF5LCBxeGwsIDApOwo+ICsgICAgICAgIHJlZF9yZXBsYXlfZGF0
YV9jaHVua3NfZnJlZShyZXBsYXksIHF4bCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgc2l6ZW9mKFFYTEltYWdlRGVzY3JpcHRvcikgKyBzaXplb2YoUVhMUVVJQ0RhdGEp
ICsKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZW9mKFFYTERhdGFD
aHVuaykpOwo+ICAgICAgICAgICBxeGwgPSBOVUxMOwo+ICAgICAgICAgICBicmVhazsKPiAgICAg
ICBkZWZhdWx0Ogo+IAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX18KU3BpY2UtZGV2ZWwgbWFpbGluZyBsaXN0ClNwaWNlLWRldmVsQGxpc3RzLmZyZWVkZXNr
dG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL3Nw
aWNlLWRldmVs
