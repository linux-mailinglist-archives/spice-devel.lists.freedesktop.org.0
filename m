Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 45C9ADC9BF
	for <lists+spice-devel@lfdr.de>; Fri, 18 Oct 2019 17:51:39 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id A18E66E135;
	Fri, 18 Oct 2019 15:51:37 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from us-smtp-delivery-1.mimecast.com (us-smtp-2.mimecast.com
 [207.211.31.81])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 605986E135
 for <spice-devel@lists.freedesktop.org>; Fri, 18 Oct 2019 15:51:36 +0000 (UTC)
Received: from mail-wm1-f70.google.com (mail-wm1-f70.google.com
 [209.85.128.70]) (Using TLS) by relay.mimecast.com with ESMTP id
 us-mta-377-UA3UO4zwMyCgzQMPJRWKlw-1; Fri, 18 Oct 2019 11:51:32 -0400
Received: by mail-wm1-f70.google.com with SMTP id z24so1667477wmk.8
 for <spice-devel@lists.freedesktop.org>; Fri, 18 Oct 2019 08:51:32 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:subject:date:message-id:mime-version
 :content-transfer-encoding;
 bh=sYVrCayQM8Hgfs61YS2MLwDVsI4fw4t77CeRS3OVITQ=;
 b=mvRg3RxOPjL/YPldhBzHy1rJEgRCfjyEiGw0dXFQPKt2R+cRbWET4V6gobxBRDXUzU
 O9P/7t0F9vLOJcSDDDd+1vITrA9qOiXlQqgxjxtSnAAsBPPHx/O6629TDhcEUmVvHF2t
 bKO7y9dvTOHU2TQ5dDakjjTB5eJV+txsspayp4tYt9sSj6zsb7HeK/AvMqnapDpMGHAf
 nISsC0mtPna6S+wz6Y+UJQxcbBaHEuiF0ymEGhdMyH8ssdujfLS1DBB1N7XM8f8yX82h
 5NeCdhFIVgyCIJKtTPy9ClAHTz56RQDXZWXewe66XuOhCHe9LoTRT3zS5fnCBSySlxtk
 gvWA==
X-Gm-Message-State: APjAAAXw7RKxfKF4DZdYALp1XI6j20PdG3ZQf8MoXlRhBzzX5WKuUFBK
 ZMjK+gi92CX6EYMG4Blw5hmiIpLKTf6sI9Mns/8DMCHgesZR2J9I797Nw+iXvvEkTRo1BmgA6Py
 FqaSriZMoyE4j8tiKujAseypaShRnzUc=
X-Received: by 2002:a05:600c:2214:: with SMTP id
 z20mr8403984wml.10.1571413890832; 
 Fri, 18 Oct 2019 08:51:30 -0700 (PDT)
X-Google-Smtp-Source: APXvYqwu1BHptVcHKfDcrICrL6K6zfu/iVgpYEAdGzyNfu+syHQrLvl1riX4fIKcarhrFyW/opPnFQ==
X-Received: by 2002:a05:600c:2214:: with SMTP id
 z20mr8403929wml.10.1571413889943; 
 Fri, 18 Oct 2019 08:51:29 -0700 (PDT)
Received: from pinea.redhat.com ([2001:861:3440:6a0:2cf1:592d:314d:825])
 by smtp.gmail.com with ESMTPSA id o19sm6650179wmh.27.2019.10.18.08.51.27
 for <spice-devel@lists.freedesktop.org>
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Fri, 18 Oct 2019 08:51:28 -0700 (PDT)
From: Kevin Pouget <kpouget@redhat.com>
To: spice-devel@lists.freedesktop.org
Date: Fri, 18 Oct 2019 17:51:17 +0200
Message-Id: <20191018155119.19188-1-kpouget@redhat.com>
X-Mailer: git-send-email 2.21.0
MIME-Version: 1.0
X-MC-Unique: UA3UO4zwMyCgzQMPJRWKlw-1
X-Mimecast-Spam-Score: 0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=redhat.com; 
 s=mimecast20190719; t=1571413895;
 h=from:from:reply-to:subject:subject:date:date:message-id:message-id:
 to:to:cc:mime-version:mime-version:content-type:content-type:
 content-transfer-encoding:content-transfer-encoding;
 bh=KQf5tZTefbM+tcZTTKkrTNiTAStIZO157tVQfTt1Tzc=;
 b=VX4b+6nEgXhc19t+DHFI1v0n49z02df2TZSnMmJOf2PvRYeUSZQ6UkndCv2cPLIwI9clch
 F5uOCV5yp20Xy6ddtbGXa9VbtnoRqkItJLp24roz19brU4y6E4y3awFlEw7e4opwJsMfPs
 8P4uQDQuE7InnEg9u0QJNQXr2KaMiTE=
Subject: [Spice-devel] [PATCH spice-common v3 1/3] agent-interface:
 introduce the core of the Agent Interface
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

V2hlbiBpbml0aWFsaXplZCAocmVjb3JkZXJfaW5pdGlhbGl6YXRpb24pLCB0aGUgQWdlbnQgSW50
ZXJmYWNlIGxhdW5jaAphIEdUaHJlYWQgKGhhbmRsZV9jb21tdW5pY2F0aW9ucykgdGhhdCBvcGVu
cyBhIFRDUCBzZXJ2ZXIgc29ja2V0IGFuZAp3YWl0cyBmb3IgU21hcnQgTG9jYWwgQWdlbnQgY29u
bmVjdGlvbnMuIFdoZW4gYSBMb2NhbCBBZ2VudCBjb25uZWN0cwp0byB0aGUgc29ja2V0cywgdGhl
IGNvbW11bmljYXRpb24gaXMgaW5pdGlhbGl6ZWQKKGFnZW50X2luaXRpYWxpemVfY29tbXVuaWNh
dGlvbiksIHRoZSBjb21tdW5pY2F0aW9uIHNvY2tldCBpcyBzdG9yZWQKYW5kIHRoZSBsaXN0IG9m
IFJlY29yZGVycyBpcyBzZW50LiBJbiByZXR1cm4sIHRoZSBsb2NhbCBhZ2VudAppbmRpY2F0ZXMg
d2hpY2ggcmVjb3JkZXJzIHRvIGVuYWJsZS4KCk9uIHRoZSBTUElDRSBzaWRlLCB0aGUgQWdlbnQg
SW50ZXJmYWNlIGhhbmRsZXMgdGhlIHJlY29yZCgpIGNhbGxzCihyZWNvcmRlcl9hcHBlbmQqKS4g
V2hlbiBhIHJlY29yZCBpcyByZWNlaXZlZCBmcm9tIFNQSUNFLCBhbmQgaWYgdGhlCnJlY29yZGVy
IGlzIGVuYWJsZWQsIHRoZSByZWNvcmQgZW50cnkgaXMgc2VudCB0aHJvdWdoIHRoZSBUQ1AKY29u
bmVjdGlvbi4gT3RoZXJ3aXNlLCB0aGUgcmVjb3JkIGlzIGRyb3BwZWQuCgpTaWduZWQtb2ZmLWJ5
OiBLZXZpbiBQb3VnZXQgPGtwb3VnZXRAcmVkaGF0LmNvbT4KLS0tCnYyLT52MzogdW5jaGFuZ2Vk
Ci0tLQogY29tbW9uL2FnZW50X2ludGVyZmFjZS5jICAgIHwgNDY3ICsrKysrKysrKysrKysrKysr
KysrKysrKysrKysrKysKIGNvbW1vbi9hZ2VudF9pbnRlcmZhY2UuaCAgICB8IDU0MiArKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysKIHRlc3RzL3Rlc3QtZHVtbXktcmVjb3JkZXIu
YyB8ICAgMyArLQogMyBmaWxlcyBjaGFuZ2VkLCAxMDExIGluc2VydGlvbnMoKyksIDEgZGVsZXRp
b24oLSkKIGNyZWF0ZSBtb2RlIDEwMDY0NCBjb21tb24vYWdlbnRfaW50ZXJmYWNlLmMKIGNyZWF0
ZSBtb2RlIDEwMDY0NCBjb21tb24vYWdlbnRfaW50ZXJmYWNlLmgKCmRpZmYgLS1naXQgYS9jb21t
b24vYWdlbnRfaW50ZXJmYWNlLmMgYi9jb21tb24vYWdlbnRfaW50ZXJmYWNlLmMKbmV3IGZpbGUg
bW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMC4uNzY4YjZhOQotLS0gL2Rldi9udWxsCisrKyBiL2Nv
bW1vbi9hZ2VudF9pbnRlcmZhY2UuYwpAQCAtMCwwICsxLDQ2NyBAQAorLyogLSotIE1vZGU6IEM7
IGMtYmFzaWMtb2Zmc2V0OiA0OyBpbmRlbnQtdGFicy1tb2RlOiBuaWwgLSotICovCisvKgorICAg
Q29weXJpZ2h0IChDKSAyMDE5IFJlZCBIYXQsIEluYy4KKworICAgVGhpcyBsaWJyYXJ5IGlzIGZy
ZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vcgorICAgbW9kaWZ5IGl0
IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYworICAgTGlj
ZW5zZSBhcyBwdWJsaXNoZWQgYnkgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVy
CisgICB2ZXJzaW9uIDIuMSBvZiB0aGUgTGljZW5zZSwgb3IgKGF0IHlvdXIgb3B0aW9uKSBhbnkg
bGF0ZXIgdmVyc2lvbi4KKworICAgVGhpcyBsaWJyYXJ5IGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBo
b3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCisgICBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7
IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgorICAgTUVSQ0hBTlRBQklMSVRZ
IG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZSBHTlUKKyAgIExl
c3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCisKKyAgIFlvdSBz
aG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJs
aWMKKyAgIExpY2Vuc2UgYWxvbmcgd2l0aCB0aGlzIGxpYnJhcnk7IGlmIG5vdCwgc2VlIDxodHRw
Oi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4KKyovCisKKyNpbmNsdWRlIDxjb25maWcuaD4KKyNp
bmNsdWRlIDxzdGRsaWIuaD4KKyNpbmNsdWRlIDxzeXMvdGltZS5oPgorI2luY2x1ZGUgPHN0cmlu
Zy5oPgorI2luY2x1ZGUgPGdsaWIuaD4KKyNpbmNsdWRlIDxzdGRpby5oPgorI2luY2x1ZGUgPHN5
cy9zb2NrZXQuaD4KKyNpbmNsdWRlIDxuZXRpbmV0L2luLmg+CisjaW5jbHVkZSA8dW5pc3RkLmg+
CisjaW5jbHVkZSA8YXJwYS9pbmV0Lmg+CisjaW5jbHVkZSA8c3lzL2V2ZW50ZmQuaD4KKyNpbmNs
dWRlIDxlcnJuby5oPgorI2luY2x1ZGUgPHBvbGwuaD4KKworI2luY2x1ZGUgPGNvbW1vbi9hZ2Vu
dF9pbnRlcmZhY2UuaD4KKwordHlwZWRlZiBzdHJ1Y3Qgc29ja2FkZHIgU0E7CisKK3N0YXRpYyBH
VGhyZWFkICpyZWNvcmRlcl9jb21tX3RocjsKK3N0YXRpYyBib29sIGFnZW50X3Rlcm1pbmF0ZWQg
PSBmYWxzZTsKK3N0YXRpYyBpbnQgdGVybWluYXRlX2VmZCA9IC0xOworc3RhdGljIEZJTEUgKmNv
bW11bmljYXRpb25fZiA9IE5VTEw7CisKKyNkZWZpbmUgTkJfTUFYX1JFQ09SREVSUyAxNgorc3Rh
dGljIHJlY29yZGVyX2luZm8gKnJlY29yZGVyc1tOQl9NQVhfUkVDT1JERVJTXTsKK3N0YXRpYyB1
aW50MzJfdCBuYl9yZWNvcmRlcnMgPSAwOworCitzdGF0aWMgdWludHB0cl90IHJlY29yZGVyX3Rp
Y2sodm9pZCk7CisKKyNpZm5kZWYgUkVDT1JERVJfSFoKKyNkZWZpbmUgUkVDT1JERVJfSFogICAg
IDEwMDAwMDAKKyNlbmRpZiAvLyBSRUNPUkRFUl9IWgorCitzdGF0aWMgR011dGV4IG11dGV4X3Nv
Y2tldDsKKworc3RhdGljIGludCBhZ2VudF9pbml0aWFsaXplX2NvbW11bmljYXRpb24oaW50IHNv
Y2tldCkKK3sKKyAgICB1aW50MzJfdCBpOworICAgIGludCByZXQgPSAtMTsKKyAgICBGSUxFICpz
b2NrZXRfZjsKKworICAgIGdfbXV0ZXhfbG9jaygmbXV0ZXhfc29ja2V0KTsKKworICAgIGlmIChj
b21tdW5pY2F0aW9uX2YgIT0gTlVMTCkgeworICAgICAgICBnX3dhcm5pbmcoIkEgY2xpZW50IGlz
IGFscmVhZHkgY29ubmVjdGVkLCByZWplY3RpbmcgdGhlIGNvbm5lY3Rpb24uIik7CisKKyAgICAg
ICAgZ290byB1bmxvY2s7CisgICAgfQorCisgICAgc29ja2V0X2YgPSBmZG9wZW4oc29ja2V0LCAi
dytiIik7CisKKyAgICBmcHJpbnRmKHNvY2tldF9mLCAiUmVjb3JkZXJzOiAiKTsKKyAgICBmb3Ig
KGkgPSAwOyBpIDwgbmJfcmVjb3JkZXJzOyBpKyspIHsKKyAgICAgICAgZ19kZWJ1ZygiU2VuZGlu
ZyAlcyIsIHJlY29yZGVyc1tpXS0+bmFtZSk7CisgICAgICAgIGZwcmludGYoc29ja2V0X2YsICIl
czsiLCByZWNvcmRlcnNbaV0tPm5hbWUpOworICAgIH0KKyAgICBmcHJpbnRmKHNvY2tldF9mLCAi
XG4iKTsKKyAgICBmZmx1c2goc29ja2V0X2YpOworCisgICAgZm9yIChpID0gMDsgaSA8IG5iX3Jl
Y29yZGVyczsgaSsrKSB7CisgICAgICAgIGNoYXIgZW5hYmxlOworCisgICAgICAgIGlmIChyZWFk
KHNvY2tldCwgJmVuYWJsZSwgc2l6ZW9mKGVuYWJsZSkpICE9IHNpemVvZihlbmFibGUpKSB7Cisg
ICAgICAgICAgICBnX3dhcm5pbmcoIkludmFsaWQgcmVhZCBvbiB0aGUgY2xpZW50IHNvY2tldCIp
OworCisgICAgICAgICAgICBnb3RvIHVubG9jazsKKyAgICAgICAgfQorICAgICAgICBpZiAoZW5h
YmxlICE9ICcwJyAmJiBlbmFibGUgIT0gJzEnKSB7CisgICAgICAgICAgICBnX2NyaXRpY2FsKCJJ
bnZhbGlkIGVuYWJsZS12YWx1ZSByZWNlaXZlZCBmb3IgcmVjb3JkZXIgJyVzJzogJXUiLAorICAg
ICAgICAgICAgICAgICAgICAgICByZWNvcmRlcnNbaV0tPm5hbWUsIGVuYWJsZSk7CisKKyAgICAg
ICAgICAgIGdvdG8gdW5sb2NrOworICAgICAgICB9CisKKyAgICAgICAgaWYgKGVuYWJsZSA9PSAn
MCcpIHsKKyAgICAgICAgICAgIGNvbnRpbnVlOworICAgICAgICB9CisKKyAgICAgICAgcmVjb3Jk
ZXJzW2ldLT50cmFjZSA9IDE7CisgICAgICAgIGdfaW5mbygiRW5hYmxlIHJlY29yZGVyICclcyci
LCByZWNvcmRlcnNbaV0tPm5hbWUpOworICAgIH0KKworICAgIGNvbW11bmljYXRpb25fZiA9IHNv
Y2tldF9mOworICAgIHJldCA9IDA7CisKK3VubG9jazoKKyAgICBnX211dGV4X3VubG9jaygmbXV0
ZXhfc29ja2V0KTsKKworICAgIHJldHVybiByZXQ7Cit9CisKK3N0YXRpYyB2b2lkIGFnZW50X2Zp
bmFsaXplX2NvbW11bmljYXRpb24oaW50IHNvY2tldCkKK3sKKyAgICB1aW50MzJfdCBpOworICAg
IGdfaW5mbygiQ29tbXVuaWNhdGlvbiBzb2NrZXQgY2xvc2VkLiIpOworCisgICAgZ19tdXRleF9s
b2NrKCZtdXRleF9zb2NrZXQpOworICAgIGdfYXNzZXJ0KHNvY2tldCA9PSBmaWxlbm8oY29tbXVu
aWNhdGlvbl9mKSk7CisKKyAgICBmY2xvc2UoY29tbXVuaWNhdGlvbl9mKTsKKyAgICBjb21tdW5p
Y2F0aW9uX2YgPSBOVUxMOworCisgICAgZm9yIChpID0gMDsgaSA8IG5iX3JlY29yZGVyczsgaSsr
KSB7CisgICAgICAgIHJlY29yZGVyc1tpXS0+dHJhY2UgPSAwOworICAgIH0KKyAgICBnX211dGV4
X3VubG9jaygmbXV0ZXhfc29ja2V0KTsKK30KKworc3RhdGljIGludCBhZ2VudF9wcm9jZXNzX2Nv
bW11bmljYXRpb24oaW50IHNvY2tldCkKK3sKKyAgICBzdGF0aWMgY2hhciBtc2dfaW5bMTI4XTsK
KworICAgIHN0YXRpYyBsb25nIHVuc2lnbmVkIGludCBsZW4gPSAwOworCisgICAgZ19hc3NlcnQo
c29ja2V0ID09IGZpbGVubyhjb21tdW5pY2F0aW9uX2YpKTsKKworICAgIGludCBuYnl0ZXMgPSBy
ZWFkKHNvY2tldCwgbXNnX2luICsgbGVuLCAxKTsKKworICAgIGlmIChuYnl0ZXMgPCAwICYmIGVy
cm5vID09IEVJTlRSKSB7CisgICAgICAgcmV0dXJuIDA7CisgICAgfQorCisgICAgaWYgKG5ieXRl
cyA8PSAwKSB7CisgICAgICAgIGFnZW50X2ZpbmFsaXplX2NvbW11bmljYXRpb24oc29ja2V0KTsK
KyAgICAgICAgcmV0dXJuIC0xOyAvLyBzb2NrZXQgY2xvc2VkCisgICAgfQorCisgICAgaWYgKG1z
Z19pbltsZW5dID09ICdcMCcpIHsKKyAgICAgICAgLy8gVE9ETzogcHJvY2VzcyBxdWFsaXR5IGlu
ZGljYXRvcgorICAgICAgICBsZW4gPSAwOworICAgICAgICByZXR1cm4gMDsKKyAgICB9CisKKyAg
ICBsZW4gKz0gbmJ5dGVzOworCisgICAgaWYgKGxlbiA+PSBzaXplb2YobXNnX2luKSAtIDEpIHsK
KyAgICAgICAgbXNnX2luW3NpemVvZihtc2dfaW4pIC0gMV0gPSAnXDAnOworICAgICAgICBnX3dh
cm5pbmcoIkludmFsaWQgbWVzc2FnZSByZWNlaXZlZCAodG9vIGxvbmc/KTogJXMiLCBtc2dfaW4p
OworICAgICAgICBsZW4gPSAwOworICAgIH0KKworICAgIHJldHVybiAwOworfQorCitzdGF0aWMg
aW50IG1ha2Vfc29ja2V0KGd1aW50IHBvcnQpCit7CisgICAgc3RydWN0IHNvY2thZGRyX2luIHNl
cnZhZGRyOworICAgIGludCBsaXN0ZW5fc29ja2V0ID0gc29ja2V0KEFGX0lORVQsIFNPQ0tfU1RS
RUFNLCAwKTsKKworICAgIGlmIChsaXN0ZW5fc29ja2V0ID09IC0xKSB7CisgICAgICAgIGdfY3Jp
dGljYWwoInNvY2tldCBjcmVhdGlvbiBmYWlsZWQiKTsKKyAgICAgICAgcmV0dXJuIC0xOworICAg
IH0KKworICAgIGludCBlbmFibGUgPSAxOworICAgIGlmIChzZXRzb2Nrb3B0KGxpc3Rlbl9zb2Nr
ZXQsIFNPTF9TT0NLRVQsIFNPX1JFVVNFQUREUiwgJmVuYWJsZSwgc2l6ZW9mKGludCkpIDwgMCkg
eworICAgICAgICBnX2NyaXRpY2FsKCJzZXRzb2Nrb3B0KFNPX1JFVVNFQUREUikgZmFpbGVkIik7
CisgICAgICAgIGNsb3NlKGxpc3Rlbl9zb2NrZXQpOworICAgICAgICByZXR1cm4gLTE7CisgICAg
fQorCisgICAgbWVtc2V0KCZzZXJ2YWRkciwgMCwgc2l6ZW9mKHNlcnZhZGRyKSk7CisKKyAgICBz
ZXJ2YWRkci5zaW5fZmFtaWx5ID0gQUZfSU5FVDsKKyAgICBzZXJ2YWRkci5zaW5fYWRkci5zX2Fk
ZHIgPSBodG9ubChJTkFERFJfQU5ZKTsKKyAgICBzZXJ2YWRkci5zaW5fcG9ydCA9IGh0b25zKHBv
cnQpOworCisgICAgaWYgKGJpbmQobGlzdGVuX3NvY2tldCwgKFNBICopICZzZXJ2YWRkciwgc2l6
ZW9mKHNlcnZhZGRyKSkgIT0gMCkgeworICAgICAgICBnX2NyaXRpY2FsKCJzb2NrZXQgYmluZCBm
YWlsZWQiKTsKKyAgICAgICAgY2xvc2UobGlzdGVuX3NvY2tldCk7CisgICAgICAgIHJldHVybiAt
MTsKKyAgICB9CisKKyAgICByZXR1cm4gbGlzdGVuX3NvY2tldDsKK30KKworc3RhdGljIGdwb2lu
dGVyIGhhbmRsZV9jb21tdW5pY2F0aW9ucyhncG9pbnRlciB1c2VyX2RhdGEpCit7CisgICAgc3Ry
dWN0IHBvbGxmZCBmZHNbM107CisgICAgaW50IG5iX2ZkID0gMDsKKyAgICBpbnQgbGlzdGVuX3Nv
Y2tldDsKKyAgICBpbnQgaTsKKyAgICBndWludCBwb3J0ID0gR1BPSU5URVJfVE9fVUlOVCh1c2Vy
X2RhdGEpOworCisgICAgbGlzdGVuX3NvY2tldCA9IG1ha2Vfc29ja2V0KHBvcnQpOworICAgIGlm
IChsaXN0ZW5fc29ja2V0IDwgMCkgeworICAgICAgICByZXR1cm4gTlVMTDsKKyAgICB9CisKKyAg
ICBnX2RlYnVnKCJMaXN0ZW5pbmchIik7CisKKyAgICBpZiAoKGxpc3RlbihsaXN0ZW5fc29ja2V0
LCAxKSkgIT0gMCkgeworICAgICAgICBnX2NyaXRpY2FsKCJsaXN0ZW4gZmFpbGVkOiAlbSIpOwor
ICAgICAgICByZXR1cm4gTlVMTDsKKyAgICB9CisKKyAgICBmZHNbMF0uZmQgPSB0ZXJtaW5hdGVf
ZWZkOworICAgIGZkc1swXS5ldmVudHMgPSBQT0xMSU47CisgICAgZmRzWzFdLmZkID0gbGlzdGVu
X3NvY2tldDsKKyAgICBmZHNbMV0uZXZlbnRzID0gUE9MTElOOworICAgIG5iX2ZkID0gMjsKKwor
ICAgIHdoaWxlICghYWdlbnRfdGVybWluYXRlZCkgeworCisgICAgICAgIC8qIEJsb2NrIHVudGls
IGlucHV0IGFycml2ZXMgb24gb25lIG9yIG1vcmUgYWN0aXZlIHNvY2tldHMuICovCisgICAgICAg
IGludCByZXQgPSBwb2xsKGZkcywgbmJfZmQsIC0xKTsKKworICAgICAgICBpZiAocmV0IDwgMCkg
eworICAgICAgICAgICAgZ19jcml0aWNhbCgicG9sbCBmYWlsZWQ6ICVtIik7CisgICAgICAgICAg
ICBicmVhazsKKyAgICAgICAgfQorCisgICAgICAgIC8qIFNlcnZpY2UgYWxsIHRoZSBzb2NrZXRz
IHdpdGggaW5wdXQgcGVuZGluZy4gKi8KKyAgICAgICAgZm9yIChpID0gMDsgaSA8IG5iX2ZkOyBp
KyspIHsKKyAgICAgICAgICAgIGludCBmZCA9IGZkc1tpXS5mZDsKKyAgICAgICAgICAgIGlmIChm
ZCA9PSB0ZXJtaW5hdGVfZWZkKSB7CisgICAgICAgICAgICAgICAgaWYgKGZkc1tpXS5yZXZlbnRz
ICYgUE9MTElOKSB7CisgICAgICAgICAgICAgICAgICAgIGdfYXNzZXJ0KGFnZW50X3Rlcm1pbmF0
ZWQpOworICAgICAgICAgICAgICAgICAgICBicmVhazsKKyAgICAgICAgICAgICAgICB9CisgICAg
ICAgICAgICB9IGVsc2UgaWYgKGZkID09IGxpc3Rlbl9zb2NrZXQpIHsKKyAgICAgICAgICAgICAg
ICBpZiAoZmRzW2ldLnJldmVudHMgJiB+UE9MTElOKSB7CisgICAgICAgICAgICAgICAgICAgIGdf
Y3JpdGljYWwoInNlcnZlciBzb2NrZXQgY2xvc2VkIik7CisgICAgICAgICAgICAgICAgICAgIGJy
ZWFrOworICAgICAgICAgICAgICAgIH0KKyAgICAgICAgICAgICAgICBpZiAoIShmZHNbaV0ucmV2
ZW50cyAmIFBPTExJTikpIHsKKyAgICAgICAgICAgICAgICAgICAgY29udGludWU7CisgICAgICAg
ICAgICAgICAgfQorCisgICAgICAgICAgICAgICAgLyogQ29ubmVjdGlvbiByZXF1ZXN0IG9uIG9y
aWdpbmFsIHNvY2tldC4gKi8KKyAgICAgICAgICAgICAgICBpbnQgbmV3X2ZkID0gYWNjZXB0KGxp
c3Rlbl9zb2NrZXQsIE5VTEwsIE5VTEwpOworCisgICAgICAgICAgICAgICAgaWYgKG5ld19mZCA8
IDApIHsKKyAgICAgICAgICAgICAgICAgICAgZ19jcml0aWNhbCgiYWNjZXB0IGZhaWxlZDogJW0i
KTsKKyAgICAgICAgICAgICAgICAgICAgYnJlYWs7CisgICAgICAgICAgICAgICAgfQorCisgICAg
ICAgICAgICAgICAgaWYgKG5iX2ZkID09IDMpIHsKKyAgICAgICAgICAgICAgICAgICAgY2xvc2Uo
bmV3X2ZkKTsKKyAgICAgICAgICAgICAgICAgICAgZ193YXJuaW5nKCJUb28gbWFueSBjbGllbnRz
IGFjY2VwdGVkIC4uLiIpOworICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKKyAgICAgICAg
ICAgICAgICB9CisKKyAgICAgICAgICAgICAgICBnX2RlYnVnKCJBZ2VudCBJbnRlcmZhY2U6IGNs
aWVudCBjb25uZWN0ZWQhIik7CisKKyAgICAgICAgICAgICAgICBpZiAoYWdlbnRfaW5pdGlhbGl6
ZV9jb21tdW5pY2F0aW9uKG5ld19mZCkpIHsKKyAgICAgICAgICAgICAgICAgICAgY2xvc2UobmV3
X2ZkKTsKKyAgICAgICAgICAgICAgICAgICAgZ193YXJuaW5nKCJJbml0aWFsaXphdGlvbiBmYWls
ZWQgLi4uIik7CisgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOworICAgICAgICAgICAgICAg
IH0KKworICAgICAgICAgICAgICAgIGZkc1tuYl9mZF0uZmQgPSBuZXdfZmQ7CisgICAgICAgICAg
ICAgICAgZmRzW25iX2ZkXS5ldmVudHMgPSBQT0xMSU47CisgICAgICAgICAgICAgICAgbmJfZmQr
KzsKKworICAgICAgICAgICAgICAgIC8qIGZkcyBhcnJheSBtb2RpZmllZCwgcmVzdGFydCB0aGUg
cG9sbC4gKi8KKyAgICAgICAgICAgICAgICBicmVhazsKKyAgICAgICAgICAgIH0gZWxzZSB7Cisg
ICAgICAgICAgICAgICAgaWYgKCEoZmRzW2ldLnJldmVudHMgJiBQT0xMSU4pKSB7CisgICAgICAg
ICAgICAgICAgICAgIGNvbnRpbnVlOworICAgICAgICAgICAgICAgIH0KKworICAgICAgICAgICAg
ICAgIC8qIERhdGEgYXJyaXZpbmcgb24gYW4gYWxyZWFkeS1jb25uZWN0ZWQgc29ja2V0LiAqLwor
ICAgICAgICAgICAgICAgIGlmIChhZ2VudF9wcm9jZXNzX2NvbW11bmljYXRpb24oZmQpIDwgMCkg
eworICAgICAgICAgICAgICAgICAgICBuYl9mZC0tOworICAgICAgICAgICAgICAgIH0KKyAgICAg
ICAgICAgIH0KKyAgICAgICAgfQorICAgIH0KKworICAgIGNsb3NlKHRlcm1pbmF0ZV9lZmQpOwor
ICAgIGNsb3NlKGxpc3Rlbl9zb2NrZXQpOworCisgICAgZ19pbmZvKCJBZ2VudCBpbnRlcmZhY2Ug
dGhyZWFkOiBieWUhIik7CisgICAgcmV0dXJuIE5VTEw7Cit9CisKK3N0YXRpYyB2b2lkIHJlY29y
ZGVyX2RlcmVnaXN0ZXIodm9pZCk7CisKK3N0YXRpYyB2b2lkIHJlY29yZGVyX2luaXRpYWxpemF0
aW9uKHVuc2lnbmVkIGludCBwb3J0KQoreworICAgIEdFcnJvciAqZXJyb3IgPSBOVUxMOworCisg
ICAgdGVybWluYXRlX2VmZCA9IGV2ZW50ZmQoMCwgMCk7CisgICAgaWYgKHRlcm1pbmF0ZV9lZmQg
PT0gLTEpIHsKKyAgICAgICAgZ19jcml0aWNhbCgiZXZlbnRmZCBmYWlsZWQ6ICVtIik7CisgICAg
ICAgIHJldHVybjsKKyAgICB9CisKKyAgICByZWNvcmRlcl9jb21tX3RociA9IGdfdGhyZWFkX3Ry
eV9uZXcoInNtYXJ0X2FnZW50X2ludGVyZmFjZSIsCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGhhbmRsZV9jb21tdW5pY2F0aW9ucywKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgR1VJTlRfVE9fUE9JTlRFUigoZ3VpbnQpIHBvcnQpLCAm
ZXJyb3IpOworICAgIGlmIChlcnJvcikgeworICAgICAgICBnX2Fzc2VydCghcmVjb3JkZXJfY29t
bV90aHIpOworICAgICAgICBnX2NyaXRpY2FsKCJFcnJvcjogQ291bGQgbm90IHN0YXJ0IHRoZSBh
Z2VudCBpbnRlcmZhY2UgdGhyZWFkOiAlcyIsIGVycm9yLT5tZXNzYWdlKTsKKyAgICAgICAgZ19l
cnJvcl9mcmVlKGVycm9yKTsKKyAgICAgICAgcmV0dXJuOworICAgIH0KKworICAgIGF0ZXhpdChy
ZWNvcmRlcl9kZXJlZ2lzdGVyKTsKK30KKworc3RhdGljIHZvaWQgcmVjb3JkZXJfaW50ZXJydXB0
X2NvbW11bmljYXRpb25zKHZvaWQpCit7CisgICAgYWdlbnRfdGVybWluYXRlZCA9IHRydWU7CisK
KyAgICB1aW50NjRfdCBtc2cgPSAxOworICAgIHNzaXplX3QgcyA9IHdyaXRlKHRlcm1pbmF0ZV9l
ZmQsICZtc2csIHNpemVvZih1aW50NjRfdCkpOworCisgICAgaWYgKHMgIT0gc2l6ZW9mKHVpbnQ2
NF90KSkgeworICAgICAgICBnX3dhcm5pbmcoImZhaWxlZCB0byBzZW5kIHJlY29yZGVyIHRocmVh
ZCB0ZXJtaW5hdGlvbiBldmVudDogJW0iKTsKKyAgICB9Cit9CisKKworc3RhdGljIHZvaWQgcmVj
b3JkZXJfZGVyZWdpc3Rlcih2b2lkKQoreworICAgIGlmIChyZWNvcmRlcl9jb21tX3Rocikgewor
ICAgICAgICByZWNvcmRlcl9pbnRlcnJ1cHRfY29tbXVuaWNhdGlvbnMoKTsKKyAgICAgICAgZ190
aHJlYWRfam9pbihyZWNvcmRlcl9jb21tX3Rocik7CisgICAgICAgIHJlY29yZGVyX2NvbW1fdGhy
ID0gTlVMTDsKKyAgICB9Cit9CisKK3ZvaWQgcmVjb3JkZXJfYWN0aXZhdGUocmVjb3JkZXJfaW5m
byAqcmVjb3JkZXIpCit7CisgICAgaWYgKG5iX3JlY29yZGVycyA+PSBOQl9NQVhfUkVDT1JERVJT
KSB7CisgICAgICAgIGdfY3JpdGljYWwoIlRvbyBtYW55IHJlY29yZGVycyBjb25maWd1cmVkIChu
YiBtYXg6ICVkKSIsIE5CX01BWF9SRUNPUkRFUlMpOworICAgICAgICByZXR1cm47CisgICAgfQor
CisgICAgcmVjb3JkZXJzW25iX3JlY29yZGVyc10gPSByZWNvcmRlcjsKKyAgICBuYl9yZWNvcmRl
cnMrKzsKK30KKworc3RhdGljIHZvaWQgZG9fc2VuZF9lbnRyeShGSUxFICpkZXN0LCByZWNvcmRl
cl9pbmZvICppbmZvLCByZWNvcmRlcl9lbnRyeSAqZW50cnksIHZhX2xpc3QgYXJncykKK3sKKyAg
ICBmcHJpbnRmKGRlc3QsICJOYW1lOiAlc1xuRnVuY3Rpb246ICVzXG5UaW1lOiAlbHVcbiIsCisg
ICAgICAgICAgICBpbmZvLT5uYW1lLCBlbnRyeS0+d2hlcmUsIGVudHJ5LT50aW1lc3RhbXApOwor
CisgICAgdmZwcmludGYoZGVzdCwgZW50cnktPmZvcm1hdCwgYXJncyk7CisgICAgZnByaW50Zihk
ZXN0LCAiXG5cbiIpOworCisgICAgZmZsdXNoKGRlc3QpOworfQorCisKK3N0YXRpYyB2b2lkIHJl
Y29yZGVyX3RyYWNlX2VudHJ5KHJlY29yZGVyX2luZm8gKmluZm8sIHJlY29yZGVyX2VudHJ5ICpl
bnRyeSwgLi4uKQorLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQorLy8gICBTaG93IGEgcmVjb3JkZXIg
ZW50cnkgd2hlbiBhIHRyYWNlIGlzIGVuYWJsZWQKKy8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KK3sK
KyAgICB2YV9saXN0IGFyZ3M7CisKKyAgICBpZiAoc3RyY2hyKGVudHJ5LT5mb3JtYXQsICdcbicp
ICE9IE5VTEwpIHsKKyAgICAgICAgZ19jcml0aWNhbCgiQWdlbnQgcmVjb3JkcyBjYW5ub3QgY29u
dGFpbiAnXG4nIGNoYXIgLi4uICglcykiLCBlbnRyeS0+d2hlcmUpOworICAgICAgICByZXR1cm47
CisgICAgfQorCisgICAgLy8gc2VuZCBpbmZvL2VudHJ5IHRvIHRoZSBzb2NrZXQKKyAgICBnX211
dGV4X2xvY2soJm11dGV4X3NvY2tldCk7CisKKyAgICBpZiAoY29tbXVuaWNhdGlvbl9mID09IE5V
TEwpIHsKKyAgICAgICAgZ19tdXRleF91bmxvY2soJm11dGV4X3NvY2tldCk7CisgICAgICAgIHJl
dHVybjsKKyAgICB9CisKKyAgICB2YV9zdGFydChhcmdzLCBlbnRyeSk7CisgICAgZG9fc2VuZF9l
bnRyeShjb21tdW5pY2F0aW9uX2YsIGluZm8sIGVudHJ5LCBhcmdzKTsKKyAgICB2YV9lbmQoYXJn
cyk7CisKKyAgICBpZiAoZ19zdHJjbXAwKGdfZ2V0ZW52KCJTUElDRV9BR0VOVF9MT0dfUkVDT1JE
UyIpLCAiMSIpID09IDApIHsKKyAgICAgICAgdmFfc3RhcnQoYXJncywgZW50cnkpOworICAgICAg
ICBkb19zZW5kX2VudHJ5KHN0ZGVyciwgaW5mbywgZW50cnksIGFyZ3MpOworICAgICAgICB2YV9l
bmQoYXJncyk7CisgICAgfQorCisgICAgZ19tdXRleF91bmxvY2soJm11dGV4X3NvY2tldCk7Cit9
CisKK3ZvaWQgcmVjb3JkZXJfYXBwZW5kKHJlY29yZGVyX2luZm8gKnJlYywKKyAgICAgICAgICAg
ICAgICAgICAgIGNvbnN0IGNoYXIgKndoZXJlLAorICAgICAgICAgICAgICAgICAgICAgY29uc3Qg
Y2hhciAqZm9ybWF0LAorICAgICAgICAgICAgICAgICAgICAgdWludHB0cl90IGEwLAorICAgICAg
ICAgICAgICAgICAgICAgdWludHB0cl90IGExLAorICAgICAgICAgICAgICAgICAgICAgdWludHB0
cl90IGEyLAorICAgICAgICAgICAgICAgICAgICAgdWludHB0cl90IGEzKQorLy8gLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLQorLy8gIEVudGVyIGEgcmVjb3JkIGVudHJ5IGluIHJpbmcgYnVmZmVyIHdpdGgg
Z2l2ZW4gc2V0IG9mIGFyZ3MKKy8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KK3sKKyAgICByZWNvcmRl
cl9lbnRyeSBlbnRyeTsKKworICAgIGlmICghcmVjLT50cmFjZSkgeworICAgICAgICByZXR1cm47
CisgICAgfQorCisgICAgZW50cnkuZm9ybWF0ID0gZm9ybWF0OworICAgIGVudHJ5LnRpbWVzdGFt
cCA9IHJlY29yZGVyX3RpY2soKTsKKyAgICBlbnRyeS53aGVyZSA9IHdoZXJlOworCisgICAgcmVj
b3JkZXJfdHJhY2VfZW50cnkocmVjLCAmZW50cnksIGEwLCBhMSwgYTIsIGEzKTsKK30KKwordm9p
ZCByZWNvcmRlcl9hcHBlbmQyKHJlY29yZGVyX2luZm8gKnJlYywKKyAgICAgICAgICAgICAgICAg
ICAgICBjb25zdCBjaGFyICp3aGVyZSwKKyAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjaGFy
ICpmb3JtYXQsCisgICAgICAgICAgICAgICAgICAgICAgdWludHB0cl90IGEwLAorICAgICAgICAg
ICAgICAgICAgICAgIHVpbnRwdHJfdCBhMSwKKyAgICAgICAgICAgICAgICAgICAgICB1aW50cHRy
X3QgYTIsCisgICAgICAgICAgICAgICAgICAgICAgdWludHB0cl90IGEzLAorICAgICAgICAgICAg
ICAgICAgICAgIHVpbnRwdHJfdCBhNCwKKyAgICAgICAgICAgICAgICAgICAgICB1aW50cHRyX3Qg
YTUsCisgICAgICAgICAgICAgICAgICAgICAgdWludHB0cl90IGE2LAorICAgICAgICAgICAgICAg
ICAgICAgIHVpbnRwdHJfdCBhNykKKy8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKy8vICAgRW50ZXIg
YSBkb3VibGUgcmVjb3JkICh1cCB0byA4IGFyZ3MpCisvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCit7
CisgICAgcmVjb3JkZXJfZW50cnkgZW50cnk7CisKKyAgICBpZiAoIXJlYy0+dHJhY2UpIHsKKyAg
ICAgICAgcmV0dXJuOworICAgIH0KKworICAgIGVudHJ5LmZvcm1hdCA9IGZvcm1hdDsKKyAgICBl
bnRyeS50aW1lc3RhbXAgPSByZWNvcmRlcl90aWNrKCk7CisgICAgZW50cnkud2hlcmUgPSB3aGVy
ZTsKKworICAgIHJlY29yZGVyX3RyYWNlX2VudHJ5KHJlYywgJmVudHJ5LCBhMCwgYTEsIGEyLCBh
MywgYTQsIGE1LCBhNiwgYTcpOworfQorCisvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CisvLworLy8g
ICAgU3VwcG9ydCBmdW5jdGlvbnMKKy8vCisvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CisKK3N0YXRp
YyB1aW50cHRyX3QgcmVjb3JkZXJfdGljayh2b2lkKQorLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQor
Ly8gICBSZXR1cm4gdGhlICJ0aWNrcyIgYXMgc3RvcmVkIGluIHRoZSByZWNvcmRlcgorLy8gLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLQoreworICAgIHN0cnVjdCB0aW1ldmFsIHQ7CisKKyAgICBnZXR0aW1l
b2ZkYXkoJnQsIE5VTEwpOworCisgICAgcmV0dXJuIHQudHZfc2VjICogUkVDT1JERVJfSFogKyB0
LnR2X3VzZWMgLyAoMTAwMDAwMCAvIFJFQ09SREVSX0haKTsKK30KZGlmZiAtLWdpdCBhL2NvbW1v
bi9hZ2VudF9pbnRlcmZhY2UuaCBiL2NvbW1vbi9hZ2VudF9pbnRlcmZhY2UuaApuZXcgZmlsZSBt
b2RlIDEwMDY0NAppbmRleCAwMDAwMDAwLi4wNDIxMjBlCi0tLSAvZGV2L251bGwKKysrIGIvY29t
bW9uL2FnZW50X2ludGVyZmFjZS5oCkBAIC0wLDAgKzEsNTQyIEBACisjcHJhZ21hIG9uY2UKKwor
Ly8gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioKKy8vIFRoaXMgc29mdHdhcmUgaXMgbGljZW5zZWQgdW5k
ZXIgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSB2MisKKy8vIChDKSAyMDE3
LTIwMTksIENocmlzdG9waGUgZGUgRGluZWNoaW4gPGNocmlzdG9waGVAZGluZWNoaW4ub3JnPgor
Ly8gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioKKy8vIFRoaXMgZmlsZSB3YXMgcGFydCBvZiBSZWNvcmRl
cgorLy8KKy8vIFJlY29yZGVyIGlzIGZyZWUgc29mdHdhcmU6IHlvdSBjYW4gcmVkaXN0cmlidXRl
IGl0IGFuZC9vciBtb2RpZnkKKy8vIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIExlc3Nl
ciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQorLy8gdGhlIEZyZWUgU29m
dHdhcmUgRm91bmRhdGlvbiwgZWl0aGVyIHZlcnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3IKKy8v
IChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCisvLworLy8gUmVjb3JkZXIgaXMg
ZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKKy8vIGJ1dCBX
SVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9m
CisvLyBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0Uu
ICBTZWUgdGhlCisvLyBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUg
ZGV0YWlscy4KKy8vCisvLyBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBH
TlUgTGVzc2VyIEdlbmVyYWwgUHVibGljIExpY2Vuc2UKKy8vIGFsb25nIHdpdGggUmVjb3JkZXIs
IGluIGEgZmlsZSBuYW1lZCBDT1BZSU5HLgorLy8gSWYgbm90LCBzZWUgPGh0dHBzOi8vd3d3Lmdu
dS5vcmcvbGljZW5zZXMvPi4KKy8vICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCisvKiBUaGlzIGZpbGUg
aXMgYmFzZWQgb24gUmVjb3JkZXIncyByZWNvcmRlci5oIGZpbGUsIHRoYXQgZGVzY3JpYmVzIGEg
Z2VuZXJhbC0KKyAqIHB1cnBvc2UgaW5zdHJ1bWVudGF0aW9uIGludGVyZmFjZS4gYWdlbnRfaW50
ZXJmYWNlLmggaXMgYSB0cmltbWVkLWRvd24KKyAqIHZlcnNpb24gb2YgaXQuICovCisKKyNpbmNs
dWRlIDxzdGRhcmcuaD4KKyNpbmNsdWRlIDxzdGRpbnQuaD4KKyNpbmNsdWRlIDxzdGRib29sLmg+
CisjaW5jbHVkZSA8c3RkZGVmLmg+CisKKyNpZmRlZiBfX2NwbHVzcGx1cworZXh0ZXJuICJDIiB7
CisjZW5kaWYgLy8gX19jcGx1c3BsdXMKKworc3RhdGljIGlubGluZSB2b2lkCityZWNvcmRlcl9k
dW1wX29uX2NvbW1vbl9zaWduYWxzKHVuc2lnbmVkIGFkZCwgdW5zaWduZWQgcmVtb3ZlKQorewor
fQorCisvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09CisvLworLy8gICAgUmVjb3JkZXIgZGF0YSBzdHJ1
Y3R1cmVzCisvLworLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQorCit0eXBlZGVmIHN0cnVjdCByZWNv
cmRlcl9lbnRyeQorLy8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQorLy8vICAgRW50cnkgaW4gdGhlIGZs
aWdodCByZWNvcmRlci4KKy8vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKy8vLyAgTm90aWNlIHRoYXQg
dGhlIGFyZ3VtZW50cyBhcmUgc3RvcmVkIGFzICJpbnRwdHJfdCIgYmVjYXVzZSB0aGF0IHR5cGUK
Ky8vLyAgaXMgZ3VhcmFudGVlZCB0byBiZSB0aGUgc2FtZSBzaXplIGFzIGEgcG9pbnRlci4gVGhp
cyBhbGxvd3MgdXMgdG8KKy8vLyAgcHJvcGVybHkgYWxpZ24gcmVjb3JkZXIgZW50cmllcyB0byBw
b3dlcnMgb2YgMiBmb3IgZWZmaWNpZW5jeS4KKy8vLyAgQWxzbyByZWFkIGV4cGxhbmF0aW9ucyBv
ZiBccmVmIF9yZWNvcmRlcl9kb3VibGUgYW5kIFxyZWYgX3JlY29yZGVyX2Zsb2F0CisvLy8gIGJl
bG93IHJlZ2FyZGluZyBob3cgdG8gdXNlIGZsb2F0aW5nLXBvaW50IHdpdGggdGhlIHJlY29yZGVy
LgoreworICAgIGNvbnN0IGNoYXIgKmZvcm1hdDsgICAgICAgICAvLy88IFByaW50Zi1zdHlsZSBm
b3JtYXQgZm9yIHJlY29yZCArIGZpbGUvbGluZQorICAgIHVpbnRwdHJfdCAgIHRpbWVzdGFtcDsg
ICAgICAvLy88IFRpbWUgYXQgd2hpY2ggcmVjb3JkIHRvb2sgcGxhY2UKKyAgICBjb25zdCBjaGFy
ICp3aGVyZTsgICAgICAgICAgLy8vPCBTb3VyY2UgY29kZSBmdW5jdGlvbgorICAgIHVpbnRwdHJf
dCAgIGFyZ3NbNF07ICAgICAgICAvLy88IEZvdXIgYXJndW1lbnRzLCBmb3IgYSB0b3RhbCBvZiA4
IGZpZWxkcworfSByZWNvcmRlcl9lbnRyeTsKKworCisvLy8gQSBnbG9iYWwgY291bnRlciBpbmRp
Y2F0aW5nIHRoZSBvcmRlciBvZiBlbnRyaWVzIGFjcm9zcyByZWNvcmRlcnMuCisvLy8gdGhpcyBp
cyBpbmNyZW1lbnRlZCBhdG9taWNhbGx5IGZvciBlYWNoIHJlY29yZCgpIGNhbGwuCisvLy8gSXQg
bXVzdCBiZSBleHBvc2VkIGJlY2F1c2UgYWxsIFhZWl9yZWNvcmQoKSBpbXBsZW1lbnRhdGlvbnMg
bmVlZCB0bworLy8vIHRvdWNoIHRoZSBzYW1lIHNoYXJlZCB2YXJpYWJsZSBpbiBvcmRlciB0byBw
cm92aWRlIGEgZ2xvYmFsIG9yZGVyLgorZXh0ZXJuIHVpbnRwdHJfdCByZWNvcmRlcl9vcmRlcjsK
KwordHlwZWRlZiBzdHJ1Y3QgcmVjb3JkZXJfaW5mbworLy8vLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQor
Ly8vICAgQSBsaW5rZWQgbGlzdCBvZiB0aGUgYWN0aXZhdGVkIHJlY29yZGVycworLy8vLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLQoreworICAgIGludHB0cl90ICAgICAgICAgICAgICAgIHRyYWNlOyAgICAg
IC8vLzwgVHJhY2UgdGhpcyByZWNvcmRlcgorICAgIGNvbnN0IGNoYXIgKiAgICAgICAgICAgIG5h
bWU7ICAgICAgIC8vLzwgTmFtZSBvZiB0aGlzIHBhcmFtZXRlciAvIHJlY29yZGVyCisgICAgY29u
c3QgY2hhciAqICAgICAgICAgICAgZGVzY3JpcHRpb247Ly8vPCBEZXNjcmlwdGlvbiBvZiB3aGF0
IGlzIHJlY29yZGVkCisgICAgcmVjb3JkZXJfZW50cnkgICAgICAgICAgZGF0YVswXTsgICAgLy8v
PCBEYXRhIGZvciB0aGlzIHJlY29yZGVyCit9IHJlY29yZGVyX2luZm87CisKKy8vID09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT0KKy8vCisvLyAgIEFkZGluZyBkYXRhIHRvIGEgcmVjb3JkZXIKKy8vCisvLyA9
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09CisKK2V4dGVybiB2b2lkIHJlY29yZGVyX2FwcGVuZChyZWNvcmRl
cl9pbmZvICpyZWMsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hhciAqd2hl
cmUsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hhciAqZm9ybWF0LAorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnRwdHJfdCBhMCwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICB1aW50cHRyX3QgYTEsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWlu
dHB0cl90IGEyLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnRwdHJfdCBhMyk7Citl
eHRlcm4gdm9pZCByZWNvcmRlcl9hcHBlbmQyKHJlY29yZGVyX2luZm8gKnJlYywKKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hhciAqd2hlcmUsCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGNvbnN0IGNoYXIgKmZvcm1hdCwKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgdWludHB0cl90IGEwLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50cHRy
X3QgYTEsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnRwdHJfdCBhMiwKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgdWludHB0cl90IGEzLAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICB1aW50cHRyX3QgYTQsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVp
bnRwdHJfdCBhNSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludHB0cl90IGE2LAor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50cHRyX3QgYTcpOworZXh0ZXJuIHZvaWQg
cmVjb3JkZXJfYXBwZW5kMyhyZWNvcmRlcl9pbmZvICpyZWMsCisgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGNvbnN0IGNoYXIgKndoZXJlLAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBjb25zdCBjaGFyICpmb3JtYXQsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnRw
dHJfdCBhMCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludHB0cl90IGExLAorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50cHRyX3QgYTIsCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHVpbnRwdHJfdCBhMywKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
dWludHB0cl90IGE0LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aW50cHRyX3QgYTUs
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnRwdHJfdCBhNiwKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgdWludHB0cl90IGE3LAorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICB1aW50cHRyX3QgYTgsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnRwdHJf
dCBhOSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWludHB0cl90IGExMCwKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgdWludHB0cl90IGExMSk7CisKKy8vLyBBY3RpdmF0ZSBh
IHJlY29yZGVyIChkdXJpbmcgY29uc3RydWN0aW9uIHRpbWUpCitleHRlcm4gdm9pZCByZWNvcmRl
cl9hY3RpdmF0ZShyZWNvcmRlcl9pbmZvICpyZWNvcmRlcik7CisKKy8vID09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT0KKy8vCisvLyAgICBEZWNsYXJhdGlvbiBvZiByZWNvcmRlcnMgYW5kIHR3ZWFrcworLy8K
Ky8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT0KKworI2RlZmluZSBSRUNPUkRFUl9ERUNMQVJFKE5hbWUp
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorLyogLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSov
ICAgXAorLyogIERlY2xhcmUgYSByZWNvcmRlciB3aXRoIHRoZSBnaXZlbiBuYW1lIChmb3IgdXNl
IGluIGhlYWRlcnMpICAgICovICAgXAorLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovICAgXAorICAgIGV4dGVybiByZWNv
cmRlcl9pbmZvICogY29uc3QgcmVjb3JkZXJfaW5mb19wdHJfZm9yXyMjTmFtZTsgICAgICAgICAg
XAorICAgIGV4dGVybiBzdHJ1Y3QgcmVjb3JkZXJfaW5mb19mb3JfIyNOYW1lIHJlY29yZGVyX2lu
Zm9fZm9yXyMjTmFtZQorCisKKy8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KKy8vCisvLyAgICBEZWZp
bml0aW9uIG9mIHJlY29yZGVycyBhbmQgdHdlYWtzCisvLworLy8gPT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PQorCisjZGVmaW5lIFJFQ09SREVSKE5hbWUsIFNpemUsIEluZm8pICAgICAgUkVDT1JERVJfREVG
SU5FKE5hbWUsU2l6ZSxJbmZvKQorCisjZGVmaW5lIFJFQ09SREVSX0RFRklORShOYW1lLCBTaXpl
LCBJbmZvKSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisvKiEtLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8gICBc
CisvKiEgRGVmaW5lIGEgcmVjb3JkZXIgdHlwZSB3aXRoIFNpemUgZWxlbWVudHMgICAgICAgICAg
ICAgICAgICAgICAgKi8gICBcCisvKiEtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8gICBcCisvKiEgXHBhcmFtIE5hbWUgaXMg
dGhlIEMgbmFtZSBmbyB0aGUgcmVjb3JkZXIuICAgICAgICAgICAgICAgICAgICAgICAgICBcCisg
KiEgXHBhcmFtIFNpemUgaXMgdGhlIG51bWJlciBvZiBlbnRyaWVzIGluIHRoZSBjaXJjdWxhciBi
dWZmZXIuICAgICAgICBcCisgKiEgXHBhcmFtIEluZm8gaXMgYSBkZXNjcmlwdGlvbiBvZiB0aGUg
cmVjb3JkZXIgZm9yIGhlbHAuICovICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisvKiBU
aGUgZW50cnkgaW4gbGlua2VkIGxpc3QgZm9yIHRoaXMgdHlwZSAqLyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBcCitzdHJ1Y3QgcmVjb3JkZXJfaW5mb19mb3JfIyNOYW1lICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCit7ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgcmVj
b3JkZXJfaW5mbyAgICAgICBpbmZvOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBcCisgICAgcmVjb3JkZXJfZW50cnkgICAgICBkYXRhW1NpemVdOyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBcCit9ICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCityZWNvcmRlcl9p
bmZvX2Zvcl8jI05hbWUgPSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBcCit7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgeyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgICAgIDAsICNO
YW1lLCBJbmZvLCB7fSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBcCisgICAgfSwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBcCisgICAge30gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCit9OyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBc
CityZWNvcmRlcl9pbmZvICogY29uc3QgcmVjb3JkZXJfaW5mb19wdHJfZm9yXyMjTmFtZSA9ICAg
ICAgICAgICAgICAgICAgICBcCisgICAgJnJlY29yZGVyX2luZm9fZm9yXyMjTmFtZS5pbmZvOyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCitS
RUNPUkRFUl9DT05TVFJVQ1RPUiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBcCitzdGF0aWMgdm9pZCByZWNvcmRlcl9hY3RpdmF0ZV8jI05hbWUodm9p
ZCkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisvKiAtLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8gICBcCisvKiAg
QWN0aXZhdGUgcmVjb3JkZXIgYmVmb3JlIGVudGVyaW5nIG1haW4oKSAgICAgICAgICAgICAgICAg
ICAgICAgKi8gICBcCisvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8gICBcCit7ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgcmVj
b3JkZXJfYWN0aXZhdGUoUkVDT1JERVJfSU5GTyhOYW1lKSk7ICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBcCit9ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisvKiBQdXJwb3Nl
ZnVsbHkgZ2VuZXJhdGUgY29tcGlsZSBlcnJvciBpZiBtYWNybyBub3QgZm9sbG93ZWQgYnkgOyAq
LyAgICBcCitleHRlcm4gdm9pZCByZWNvcmRlcl9hY3RpdmF0ZShyZWNvcmRlcl9pbmZvICpyZWNv
cmRlcikKKwordHlwZWRlZiBzdHJ1Y3QgU3BpY2VEdW1teVR3ZWFrIHsKKyAgICBpbnRwdHJfdCB0
d2Vha192YWx1ZTsKK30gU3BpY2VEdW1teVR3ZWFrOworCit0eXBlZGVmIHN0cnVjdCBTcGljZUVt
cHR5U3RydWN0IHsKKyAgICBjaGFyIGR1bW15WzBdOworfSBTcGljZUVtcHR5U3RydWN0OworCisj
ZGVmaW5lIFJFQ09SREVSX1RXRUFLX0RFQ0xBUkUocmVjKSBcCisgICAgZXh0ZXJuIGNvbnN0IFNw
aWNlRHVtbXlUd2VhayBzcGljZV9yZWNvcmRlcl90d2Vha18gIyMgcmVjCisKKyNkZWZpbmUgUkVD
T1JERVJfVFdFQUtfREVGSU5FKHJlYywgdmFsdWUsIGNvbW1lbnQpIFwKKyAgICBjb25zdCBTcGlj
ZUR1bW15VHdlYWsgc3BpY2VfcmVjb3JkZXJfdHdlYWtfICMjIHJlYyA9IHsgKHZhbHVlKSB9CisK
KyNkZWZpbmUgUkVDT1JERVJfVFdFQUsocmVjKSBcCisgICAgKChzcGljZV9yZWNvcmRlcl90d2Vh
a18gIyMgcmVjKS50d2Vha192YWx1ZSkKKworI2RlZmluZSBSRUNPUkRFUl9UUkFDRShyZWMpIFwK
KyAgICAoc2l6ZW9mKHN0cnVjdCByZWNvcmRlcl9pbmZvX2Zvcl8gIyMgcmVjKSAhPSBzaXplb2Yo
U3BpY2VFbXB0eVN0cnVjdCkpCisKKworLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQorLy8KKy8vICAg
IEFjY2VzcyB0byByZWNvcmRlciBhbmQgdHdlYWsgaW5mbworLy8KKy8vID09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT0KKworI2RlZmluZSBSRUNPUkRFUl9JTkZPKE5hbWUpICAgICAocmVjb3JkZXJfaW5mb19w
dHJfZm9yXyMjTmFtZSkKKworLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQorLy8KKy8vICAgIFJlY29y
ZGluZyBzdHVmZgorLy8KKy8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KKworI2RlZmluZSByZWNvcmQo
TmFtZSwgLi4uKSAgICAgICAgICAgICAgIFJFQ09SRF9NQUNSTyhOYW1lLCBfX1ZBX0FSR1NfXykK
KyNkZWZpbmUgUkVDT1JEKE5hbWUsLi4uKSAgICAgICAgICAgICAgICBSRUNPUkRfTUFDUk8oTmFt
ZSwgX19WQV9BUkdTX18pCisjZGVmaW5lIFJFQ09SRF9NQUNSTyhOYW1lLCBGb3JtYXQsLi4uKSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgUkVDT1JEXyhSRUNPUkQsUkVD
T1JEX0NPVU5UXyhfX1ZBX0FSR1NfXyksTmFtZSxGb3JtYXQsIyNfX1ZBX0FSR1NfXykKKyNkZWZp
bmUgUkVDT1JEXyhSRUNPUkQsUkNPVU5ULE5hbWUsRm9ybWF0LC4uLikgICAgICAgICAgICAgICAg
ICAgICAgICAgIFwKKyAgICBSRUNPUkRfXyhSRUNPUkQsUkNPVU5ULE5hbWUsRm9ybWF0LCMjIF9f
VkFfQVJHU19fKQorI2RlZmluZSBSRUNPUkRfXyhSRUNPUkQsUkNPVU5ULE5hbWUsRm9ybWF0LC4u
LikgICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgIFJFQ09SRCMjUkNPVU5UKE5hbWUsRm9y
bWF0LCMjX19WQV9BUkdTX18pCisjZGVmaW5lIFJFQ09SRF9DT1VOVF8oLi4uKSAgICAgIFJFQ09S
RF9DT1VOVF9fKER1bW15LCMjX19WQV9BUkdTX18sX1gsX1gsXzEyLF8xMSxfMTAsXzksXzgsXzcs
XzYsXzUsXzQsXzMsXzIsXzEsXzApCisjZGVmaW5lIFJFQ09SRF9DT1VOVF9fKER1bW15LF8wLF8x
LF8yLF8zLF80LF81LF82LF83LF84LF85LF8xMCxfMTEsXzEyLF8xMyxfTiwuLi4pICAgICAgX04K
KworI2RlZmluZSBSRUNPUkRfMChOYW1lLCBGb3JtYXQpICAgICAgICAgICAgICAgICAgICAgICAg
ICBcCisgICAgcmVjb3JkZXJfYXBwZW5kKFJFQ09SREVSX0lORk8oTmFtZSksICAgICAgICAgICAg
ICAgIFwKKyAgICAgICAgICAgICAgICAgICAgUkVDT1JERVJfU09VUkNFX0ZVTkNUSU9OLCAgICAg
ICAgICAgXAorICAgICAgICAgICAgICAgICAgICBSRUNPUkRFUl9TT1VSQ0VfTE9DQVRJT04gICAg
ICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgIEZvcm1hdCwgMCwgMCwgMCwgMCkKKyNkZWZp
bmUgUkVDT1JEXzEoTmFtZSwgRm9ybWF0LCBhKSAgICAgICAgICAgICAgICAgICAgICAgXAorICAg
IHJlY29yZGVyX2FwcGVuZChSRUNPUkRFUl9JTkZPKE5hbWUpLCAgICAgICAgICAgICAgICBcCisg
ICAgICAgICAgICAgICAgICAgIFJFQ09SREVSX1NPVVJDRV9GVU5DVElPTiwgICAgICAgICAgIFwK
KyAgICAgICAgICAgICAgICAgICAgUkVDT1JERVJfU09VUkNFX0xPQ0FUSU9OICAgICAgICAgICAg
XAorICAgICAgICAgICAgICAgICAgICBGb3JtYXQsICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBcCisgICAgICAgICAgICAgICAgICAgIFJFQ09SREVSX0FSRyhhKSwgMCwgMCwgMCkKKyNkZWZp
bmUgUkVDT1JEXzIoTmFtZSwgRm9ybWF0LCBhLGIpICAgICAgICAgICAgICAgICAgICAgXAorICAg
IHJlY29yZGVyX2FwcGVuZChSRUNPUkRFUl9JTkZPKE5hbWUpLCAgICAgICAgICAgICAgICBcCisg
ICAgICAgICAgICAgICAgICAgIFJFQ09SREVSX1NPVVJDRV9GVU5DVElPTiwgICAgICAgICAgIFwK
KyAgICAgICAgICAgICAgICAgICAgUkVDT1JERVJfU09VUkNFX0xPQ0FUSU9OICAgICAgICAgICAg
XAorICAgICAgICAgICAgICAgICAgICBGb3JtYXQsICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBcCisgICAgICAgICAgICAgICAgICAgIFJFQ09SREVSX0FSRyhhKSwgICAgICAgICAgICAgICAg
ICAgIFwKKyAgICAgICAgICAgICAgICAgICAgUkVDT1JERVJfQVJHKGIpLCAwLCAwKQorI2RlZmlu
ZSBSRUNPUkRfMyhOYW1lLCBGb3JtYXQsIGEsYixjKSAgICAgICAgICAgICAgICAgICBcCisgICAg
cmVjb3JkZXJfYXBwZW5kKFJFQ09SREVSX0lORk8oTmFtZSksICAgICAgICAgICAgICAgIFwKKyAg
ICAgICAgICAgICAgICAgICAgUkVDT1JERVJfU09VUkNFX0ZVTkNUSU9OLCAgICAgICAgICAgXAor
ICAgICAgICAgICAgICAgICAgICBSRUNPUkRFUl9TT1VSQ0VfTE9DQVRJT04gICAgICAgICAgICBc
CisgICAgICAgICAgICAgICAgICAgIEZvcm1hdCwgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IFwKKyAgICAgICAgICAgICAgICAgICAgUkVDT1JERVJfQVJHKGEpLCAgICAgICAgICAgICAgICAg
ICAgXAorICAgICAgICAgICAgICAgICAgICBSRUNPUkRFUl9BUkcoYiksICAgICAgICAgICAgICAg
ICAgICBcCisgICAgICAgICAgICAgICAgICAgIFJFQ09SREVSX0FSRyhjKSwgMCkKKyNkZWZpbmUg
UkVDT1JEXzQoTmFtZSwgRm9ybWF0LCBhLGIsYyxkKSAgICAgICAgICAgICAgICAgXAorICAgIHJl
Y29yZGVyX2FwcGVuZChSRUNPUkRFUl9JTkZPKE5hbWUpLCAgICAgICAgICAgICAgICBcCisgICAg
ICAgICAgICAgICAgICAgIFJFQ09SREVSX1NPVVJDRV9GVU5DVElPTiwgICAgICAgICAgIFwKKyAg
ICAgICAgICAgICAgICAgICAgUkVDT1JERVJfU09VUkNFX0xPQ0FUSU9OICAgICAgICAgICAgXAor
ICAgICAgICAgICAgICAgICAgICBGb3JtYXQsICAgICAgICAgICAgICAgICAgICAgICAgICAgICBc
CisgICAgICAgICAgICAgICAgICAgIFJFQ09SREVSX0FSRyhhKSwgICAgICAgICAgICAgICAgICAg
IFwKKyAgICAgICAgICAgICAgICAgICAgUkVDT1JERVJfQVJHKGIpLCAgICAgICAgICAgICAgICAg
ICAgXAorICAgICAgICAgICAgICAgICAgICBSRUNPUkRFUl9BUkcoYyksICAgICAgICAgICAgICAg
ICAgICBcCisgICAgICAgICAgICAgICAgICAgIFJFQ09SREVSX0FSRyhkKSkKKyNkZWZpbmUgUkVD
T1JEXzUoTmFtZSwgRm9ybWF0LCBhLGIsYyxkLGUpICAgICAgICAgICAgICAgXAorICAgIHJlY29y
ZGVyX2FwcGVuZDIoUkVDT1JERVJfSU5GTyhOYW1lKSwgICAgICAgICAgICAgICBcCisgICAgICAg
ICAgICAgICAgICAgICBSRUNPUkRFUl9TT1VSQ0VfRlVOQ1RJT04sICAgICAgICAgIFwKKyAgICAg
ICAgICAgICAgICAgICAgIFJFQ09SREVSX1NPVVJDRV9MT0NBVElPTiAgICAgICAgICAgXAorICAg
ICAgICAgICAgICAgICAgICAgRm9ybWF0LCAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisg
ICAgICAgICAgICAgICAgICAgICBSRUNPUkRFUl9BUkcoYSksICAgICAgICAgICAgICAgICAgIFwK
KyAgICAgICAgICAgICAgICAgICAgIFJFQ09SREVSX0FSRyhiKSwgICAgICAgICAgICAgICAgICAg
XAorICAgICAgICAgICAgICAgICAgICAgUkVDT1JERVJfQVJHKGMpLCAgICAgICAgICAgICAgICAg
ICBcCisgICAgICAgICAgICAgICAgICAgICBSRUNPUkRFUl9BUkcoZCksICAgICAgICAgICAgICAg
ICAgIFwKKyAgICAgICAgICAgICAgICAgICAgIFJFQ09SREVSX0FSRyhlKSwgMCwgMCwgMCkKKyNk
ZWZpbmUgUkVDT1JEXzYoTmFtZSwgRm9ybWF0LCBhLGIsYyxkLGUsZikgICAgICAgICAgICAgXAor
ICAgIHJlY29yZGVyX2FwcGVuZDIoUkVDT1JERVJfSU5GTyhOYW1lKSwgICAgICAgICAgICAgICBc
CisgICAgICAgICAgICAgICAgICAgICBSRUNPUkRFUl9TT1VSQ0VfRlVOQ1RJT04sICAgICAgICAg
IFwKKyAgICAgICAgICAgICAgICAgICAgIFJFQ09SREVSX1NPVVJDRV9MT0NBVElPTiAgICAgICAg
ICAgXAorICAgICAgICAgICAgICAgICAgICAgRm9ybWF0LCAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBcCisgICAgICAgICAgICAgICAgICAgICBSRUNPUkRFUl9BUkcoYSksICAgICAgICAgICAg
ICAgICAgIFwKKyAgICAgICAgICAgICAgICAgICAgIFJFQ09SREVSX0FSRyhiKSwgICAgICAgICAg
ICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICAgUkVDT1JERVJfQVJHKGMpLCAgICAgICAg
ICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgICBSRUNPUkRFUl9BUkcoZCksICAgICAg
ICAgICAgICAgICAgIFwKKyAgICAgICAgICAgICAgICAgICAgIFJFQ09SREVSX0FSRyhlKSwgICAg
ICAgICAgICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICAgUkVDT1JERVJfQVJHKGYpLCAw
LCAwKQorI2RlZmluZSBSRUNPUkRfNyhOYW1lLCBGb3JtYXQsIGEsYixjLGQsZSxmLGcpICAgICAg
ICAgICBcCisgICAgcmVjb3JkZXJfYXBwZW5kMihSRUNPUkRFUl9JTkZPKE5hbWUpLCAgICAgICAg
ICAgICAgIFwKKyAgICAgICAgICAgICAgICAgICAgIFJFQ09SREVSX1NPVVJDRV9GVU5DVElPTiwg
ICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICAgUkVDT1JERVJfU09VUkNFX0xPQ0FUSU9O
ICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgICBGb3JtYXQsICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIFwKKyAgICAgICAgICAgICAgICAgICAgIFJFQ09SREVSX0FSRyhhKSwgICAg
ICAgICAgICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICAgUkVDT1JERVJfQVJHKGIpLCAg
ICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgICBSRUNPUkRFUl9BUkcoYyks
ICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgICAgICAgICAgICAgIFJFQ09SREVSX0FSRyhk
KSwgICAgICAgICAgICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICAgUkVDT1JERVJfQVJH
KGUpLCAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgICBSRUNPUkRFUl9B
UkcoZiksICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgICAgICAgICAgICAgIFJFQ09SREVS
X0FSRyhnKSwgMCkKKyNkZWZpbmUgUkVDT1JEXzgoTmFtZSwgRm9ybWF0LCBhLGIsYyxkLGUsZixn
LGgpICAgICAgICAgXAorICAgIHJlY29yZGVyX2FwcGVuZDIoUkVDT1JERVJfSU5GTyhOYW1lKSwg
ICAgICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgICBSRUNPUkRFUl9TT1VSQ0VfRlVO
Q1RJT04sICAgICAgICAgIFwKKyAgICAgICAgICAgICAgICAgICAgIFJFQ09SREVSX1NPVVJDRV9M
T0NBVElPTiAgICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICAgRm9ybWF0LCAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgICBSRUNPUkRFUl9BUkco
YSksICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgICAgICAgICAgICAgIFJFQ09SREVSX0FS
RyhiKSwgICAgICAgICAgICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICAgUkVDT1JERVJf
QVJHKGMpLCAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgICBSRUNPUkRF
Ul9BUkcoZCksICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgICAgICAgICAgICAgIFJFQ09S
REVSX0FSRyhlKSwgICAgICAgICAgICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICAgUkVD
T1JERVJfQVJHKGYpLCAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgICBS
RUNPUkRFUl9BUkcoZyksICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgICAgICAgICAgICAg
IFJFQ09SREVSX0FSRyhoKSkKKyNkZWZpbmUgUkVDT1JEXzkoTmFtZSwgRm9ybWF0LCBhLGIsYyxk
LGUsZixnLGgsaSkgICAgICAgXAorICAgIHJlY29yZGVyX2FwcGVuZDMoUkVDT1JERVJfSU5GTyhO
YW1lKSwgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgICBSRUNPUkRFUl9TT1VS
Q0VfRlVOQ1RJT04sICAgICAgICAgIFwKKyAgICAgICAgICAgICAgICAgICAgIFJFQ09SREVSX1NP
VVJDRV9MT0NBVElPTiAgICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICAgRm9ybWF0LCAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgICBSRUNPUkRF
Ul9BUkcoYSksICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgICAgICAgICAgICAgIFJFQ09S
REVSX0FSRyhiKSwgICAgICAgICAgICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICAgUkVD
T1JERVJfQVJHKGMpLCAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgICBS
RUNPUkRFUl9BUkcoZCksICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgICAgICAgICAgICAg
IFJFQ09SREVSX0FSRyhlKSwgICAgICAgICAgICAgICAgICAgXAorICAgICAgICAgICAgICAgICAg
ICAgUkVDT1JERVJfQVJHKGYpLCAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAgICAg
ICAgICBSRUNPUkRFUl9BUkcoZyksICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgICAgICAg
ICAgICAgIFJFQ09SREVSX0FSRyhoKSwgICAgICAgICAgICAgICAgICAgXAorICAgICAgICAgICAg
ICAgICAgICAgUkVDT1JERVJfQVJHKGkpLCAwLDAsMCkKKyNkZWZpbmUgUkVDT1JEXzEwKE5hbWUs
IEZvcm1hdCwgYSxiLGMsZCxlLGYsZyxoLGksaikgICAgXAorICAgIHJlY29yZGVyX2FwcGVuZDMo
UkVDT1JERVJfSU5GTyhOYW1lKSwgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAg
ICBSRUNPUkRFUl9TT1VSQ0VfRlVOQ1RJT04sICAgICAgICAgIFwKKyAgICAgICAgICAgICAgICAg
ICAgIFJFQ09SREVSX1NPVVJDRV9MT0NBVElPTiAgICAgICAgICAgXAorICAgICAgICAgICAgICAg
ICAgICAgRm9ybWF0LCAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAg
ICAgICAgICBSRUNPUkRFUl9BUkcoYSksICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgICAg
ICAgICAgICAgIFJFQ09SREVSX0FSRyhiKSwgICAgICAgICAgICAgICAgICAgXAorICAgICAgICAg
ICAgICAgICAgICAgUkVDT1JERVJfQVJHKGMpLCAgICAgICAgICAgICAgICAgICBcCisgICAgICAg
ICAgICAgICAgICAgICBSRUNPUkRFUl9BUkcoZCksICAgICAgICAgICAgICAgICAgIFwKKyAgICAg
ICAgICAgICAgICAgICAgIFJFQ09SREVSX0FSRyhlKSwgICAgICAgICAgICAgICAgICAgXAorICAg
ICAgICAgICAgICAgICAgICAgUkVDT1JERVJfQVJHKGYpLCAgICAgICAgICAgICAgICAgICBcCisg
ICAgICAgICAgICAgICAgICAgICBSRUNPUkRFUl9BUkcoZyksICAgICAgICAgICAgICAgICAgIFwK
KyAgICAgICAgICAgICAgICAgICAgIFJFQ09SREVSX0FSRyhoKSwgICAgICAgICAgICAgICAgICAg
XAorICAgICAgICAgICAgICAgICAgICAgUkVDT1JERVJfQVJHKGkpLCAgICAgICAgICAgICAgICAg
ICBcCisgICAgICAgICAgICAgICAgICAgICBSRUNPUkRFUl9BUkcoaiksIDAsMCkKKyNkZWZpbmUg
UkVDT1JEXzExKE5hbWUsIEZvcm1hdCwgYSxiLGMsZCxlLGYsZyxoLGksaixrKSAgXAorICAgIHJl
Y29yZGVyX2FwcGVuZDMoUkVDT1JERVJfSU5GTyhOYW1lKSwgICAgICAgICAgICAgICBcCisgICAg
ICAgICAgICAgICAgICAgICBSRUNPUkRFUl9TT1VSQ0VfRlVOQ1RJT04sICAgICAgICAgIFwKKyAg
ICAgICAgICAgICAgICAgICAgIFJFQ09SREVSX1NPVVJDRV9MT0NBVElPTiAgICAgICAgICAgXAor
ICAgICAgICAgICAgICAgICAgICAgRm9ybWF0LCAgICAgICAgICAgICAgICAgICAgICAgICAgICBc
CisgICAgICAgICAgICAgICAgICAgICBSRUNPUkRFUl9BUkcoYSksICAgICAgICAgICAgICAgICAg
IFwKKyAgICAgICAgICAgICAgICAgICAgIFJFQ09SREVSX0FSRyhiKSwgICAgICAgICAgICAgICAg
ICAgXAorICAgICAgICAgICAgICAgICAgICAgUkVDT1JERVJfQVJHKGMpLCAgICAgICAgICAgICAg
ICAgICBcCisgICAgICAgICAgICAgICAgICAgICBSRUNPUkRFUl9BUkcoZCksICAgICAgICAgICAg
ICAgICAgIFwKKyAgICAgICAgICAgICAgICAgICAgIFJFQ09SREVSX0FSRyhlKSwgICAgICAgICAg
ICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICAgUkVDT1JERVJfQVJHKGYpLCAgICAgICAg
ICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgICBSRUNPUkRFUl9BUkcoZyksICAgICAg
ICAgICAgICAgICAgIFwKKyAgICAgICAgICAgICAgICAgICAgIFJFQ09SREVSX0FSRyhoKSwgICAg
ICAgICAgICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICAgUkVDT1JERVJfQVJHKGkpLCAg
ICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgICBSRUNPUkRFUl9BUkcoaiks
ICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgICAgICAgICAgICAgIFJFQ09SREVSX0FSRyhr
KSwwKQorI2RlZmluZSBSRUNPUkRfMTIoTmFtZSxGb3JtYXQsYSxiLGMsZCxlLGYsZyxoLGksaixr
LGwpICBcCisgICAgcmVjb3JkZXJfYXBwZW5kMyhSRUNPUkRFUl9JTkZPKE5hbWUpLCAgICAgICAg
ICAgICAgIFwKKyAgICAgICAgICAgICAgICAgICAgIFJFQ09SREVSX1NPVVJDRV9GVU5DVElPTiwg
ICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICAgUkVDT1JERVJfU09VUkNFX0xPQ0FUSU9O
ICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgICBGb3JtYXQsICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIFwKKyAgICAgICAgICAgICAgICAgICAgIFJFQ09SREVSX0FSRyhhKSwgICAg
ICAgICAgICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICAgUkVDT1JERVJfQVJHKGIpLCAg
ICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgICBSRUNPUkRFUl9BUkcoYyks
ICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgICAgICAgICAgICAgIFJFQ09SREVSX0FSRyhk
KSwgICAgICAgICAgICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICAgUkVDT1JERVJfQVJH
KGUpLCAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgICBSRUNPUkRFUl9B
UkcoZiksICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgICAgICAgICAgICAgIFJFQ09SREVS
X0FSRyhnKSwgICAgICAgICAgICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICAgUkVDT1JE
RVJfQVJHKGgpLCAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAgICBSRUNP
UkRFUl9BUkcoaSksICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgICAgICAgICAgICAgIFJF
Q09SREVSX0FSRyhqKSwgICAgICAgICAgICAgICAgICAgXAorICAgICAgICAgICAgICAgICAgICAg
UkVDT1JERVJfQVJHKGspLCAgICAgICAgICAgICAgICAgICBcCisgICAgICAgICAgICAgICAgICAg
ICBSRUNPUkRFUl9BUkcobCkpCisjZGVmaW5lIFJFQ09SRF9YKE5hbWUsIEZvcm1hdCwgLi4uKSAg
IFJFQ09SRF9UT09fTUFOWV9BUkdTKHByaW50ZihGb3JtYXQsIF9fVkFfQVJHU19fKSkKKworCisv
LyBTb21lIHVnbHkgbWFjcm8gZHJ1ZGdlcnkgdG8gbWFrZSB0aGluZ3MgZWFzeSB0byB1c2UuIEFk
anVzdCB0eXBlLgorI2lmZGVmIF9fY3BsdXNwbHVzCisjZGVmaW5lIFJFQ09SREVSX0FSRyhhcmcp
ICAgICAgIF9yZWNvcmRlcl9hcmcoYXJnKQorI2Vsc2UgLy8gIV9fY3BsdXNwbHVzCisKKyNpZiBk
ZWZpbmVkKF9fR05VQ19fKSAmJiAhZGVmaW5lZChfX2NsYW5nX18pCisjICBpZiBfX0dOVUNfXyA8
PSA0IHx8IChfX0dOVUNfXyA9PSA0ICYmIF9fR05VQ19NSU5PUl9fIDwgOSkKKyMgICAgZGVmaW5l
IFJFQ09SREVSX1dJVEhPVVRfR0VORVJJQworIyAgZW5kaWYKKyNlbmRpZiAvLyBfX0dOVUNfXwor
CisjaWZkZWYgUkVDT1JERVJfV0lUSE9VVF9HRU5FUklDCisjZGVmaW5lIFJFQ09SREVSX0FSRyhh
cmcpICgodWludHB0cl90KSAoYXJnKSkKKyNlbHNlIC8vICFSRUNPUkRFUl9XSVRIT1VUX0dFTkVS
SUMKKyNkZWZpbmUgUkVDT1JERVJfQVJHKGFyZykgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgXAorICAgIF9HZW5lcmljKGFyZywgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBcCisgICAgICAgICAgICAgdW5zaWduZWQgY2hhcjogICAgIF9yZWNvcmRlcl91bnNpZ25l
ZCwgICAgIFwKKyAgICAgICAgICAgICB1bnNpZ25lZCBzaG9ydDogICAgX3JlY29yZGVyX3Vuc2ln
bmVkLCAgICAgXAorICAgICAgICAgICAgIHVuc2lnbmVkOiAgICAgICAgICBfcmVjb3JkZXJfdW5z
aWduZWQsICAgICBcCisgICAgICAgICAgICAgdW5zaWduZWQgbG9uZzogICAgIF9yZWNvcmRlcl91
bnNpZ25lZCwgICAgIFwKKyAgICAgICAgICAgICB1bnNpZ25lZCBsb25nIGxvbmc6X3JlY29yZGVy
X3Vuc2lnbmVkLCAgICAgXAorICAgICAgICAgICAgIGNoYXI6ICAgICAgICAgICAgICBfcmVjb3Jk
ZXJfY2hhciwgICAgICAgICBcCisgICAgICAgICAgICAgc2lnbmVkIGNoYXI6ICAgICAgIF9yZWNv
cmRlcl9zaWduZWQsICAgICAgIFwKKyAgICAgICAgICAgICBzaWduZWQgc2hvcnQ6ICAgICAgX3Jl
Y29yZGVyX3NpZ25lZCwgICAgICAgXAorICAgICAgICAgICAgIHNpZ25lZDogICAgICAgICAgICBf
cmVjb3JkZXJfc2lnbmVkLCAgICAgICBcCisgICAgICAgICAgICAgc2lnbmVkIGxvbmc6ICAgICAg
IF9yZWNvcmRlcl9zaWduZWQsICAgICAgIFwKKyAgICAgICAgICAgICBzaWduZWQgbG9uZyBsb25n
OiAgX3JlY29yZGVyX3NpZ25lZCwgICAgICAgXAorICAgICAgICAgICAgIGZsb2F0OiAgICAgICAg
ICAgICBfcmVjb3JkZXJfZmxvYXQsICAgICAgICBcCisgICAgICAgICAgICAgZG91YmxlOiAgICAg
ICAgICAgIF9yZWNvcmRlcl9kb3VibGUsICAgICAgIFwKKyAgICAgICAgICAgICBkZWZhdWx0OiAg
ICAgICAgICAgX3JlY29yZGVyX3BvaW50ZXIpKGFyZykKKyNlbmRpZiAvLyBSRUNPUkRFUl9XSVRI
T1VUX0dFTkVSSUMKKyNlbmRpZiAvLyBfX2NwbHVzcGx1cworCisvLyA9PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09CisvLworLy8gICAgVGltaW5nIGluZm9ybWF0aW9uCisvLworLy8gPT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PQorCisjZGVmaW5lIFJFQ09SRF9USU1JTkdfQkVHSU4ocmVjKSBcCisgICAgZG8geyBSRUNP
UkQocmVjLCAiYmVnaW4iKTsKKyNkZWZpbmUgUkVDT1JEX1RJTUlOR19FTkQocmVjLCBvcCwgbmFt
ZSwgdmFsdWUpIFwKKyAgICAgICAgUkVDT1JEKHJlYywgImVuZCIgb3AgbmFtZSk7IFwKKyAgICB9
IHdoaWxlICgwKQorCisKKy8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KKy8vCisvLyAgIFN1cHBvcnQg
bWFjcm9zCisvLworLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQorCisjZGVmaW5lIFJFQ09SREVSX1NP
VVJDRV9GVU5DVElPTiAgICBfX2Z1bmNfXyAvKiBXb3JrcyBpbiBDOTkgYW5kIEMrKzExICovCisj
ZGVmaW5lIFJFQ09SREVSX1NPVVJDRV9MT0NBVElPTiAgICBfX0ZJTEVfXyAiOiIgUkVDT1JERVJf
U1RSSU5HKF9fTElORV9fKSAiOiIKKyNkZWZpbmUgUkVDT1JERVJfU1RSSU5HKExJTkUpICAgICAg
IFJFQ09SREVSX1NUUklOR18oTElORSkKKyNkZWZpbmUgUkVDT1JERVJfU1RSSU5HXyhMSU5FKSAg
ICAgICNMSU5FCisKKyNpZmRlZiBfX0dOVUNfXworI2RlZmluZSBSRUNPUkRFUl9DT05TVFJVQ1RP
UiAgICAgICAgICAgIF9fYXR0cmlidXRlX18oKGNvbnN0cnVjdG9yKSkKKyNlbHNlCisjZGVmaW5l
IFJFQ09SREVSX0NPTlNUUlVDVE9SCisjZW5kaWYKKworI2lmZGVmIF9fY3BsdXNwbHVzCit9Cisj
ZW5kaWYgLy8gX19jcGx1c3BsdXMKKworLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQorLy8KKy8vICAg
IFV0aWxpdHk6IENvbnZlcnQgZmxvYXRpbmcgcG9pbnQgdmFsdWVzIGZvciB2YXJhcmcgZm9ybWF0
CisvLworLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PQorLy8KKy8vICAgVGhlIHJlY29yZGVyIHN0b3Jl
cyBvbmx5IHVpbnRwdHJfdCBpbiByZWNvcmRlciBlbnRyaWVzLiBJbnRlZ2VyIHR5cGVzCisvLyAg
IGFyZSBwcm9tb3RlZCwgcG9pbnRlciB0eXBlcyBhcmUgY29udmVydGVkLiBGbG9hdGluZyBwb2lu
dCB2YWx1ZXMKKy8vICAgYXJlIGNvbnZlcnRlZCBhIGZsb2F0aW5nIHBvaW50IHR5cGUgb2YgdGhl
IHNhbWUgc2l6ZSBhcyB1aW50cHRyX3QsCisvLyAgIGkuZS4gZmxvYXQgYXJlIGNvbnZlcnRlZCB0
byBkb3VibGUgb24gNjQtYml0IHBsYXRmb3JtcywgYW5kIGNvbnZlcnNlbHkuCisKKyNpZmRlZiBf
X2NwbHVzcGx1cworI2luY2x1ZGUgPHN0cmluZz4KKworLy8gSW4gQysrLCB3ZSBkb24ndCB1c2Ug
X0dlbmVyaWMgYnV0IGFjdHVhbCBvdmVybG9hZGluZwordGVtcGxhdGUgPGNsYXNzIGludHR5cGU+
CitzdGF0aWMgaW5saW5lIHVpbnRwdHJfdCAgICAgICAgIF9yZWNvcmRlcl9hcmcoaW50dHlwZSBp
KQoreworICAgIHJldHVybiAodWludHB0cl90KSBpOworfQorCisKK3N0YXRpYyBpbmxpbmUgdWlu
dHB0cl90ICAgICAgICAgX3JlY29yZGVyX2FyZyhjb25zdCBzdGQ6OnN0cmluZyAmYXJnKQorewor
ICAgIHJldHVybiAodWludHB0cl90KSBhcmcuY19zdHIoKTsKK30KKyNkZWZpbmUgX3JlY29yZGVy
X2Zsb2F0ICAgICAgICAgX3JlY29yZGVyX2FyZworI2RlZmluZSBfcmVjb3JkZXJfZG91YmxlICAg
ICAgICBfcmVjb3JkZXJfYXJnCisKKyNlbHNlIC8vICFfX2NwbHVzcGx1cworCitzdGF0aWMgaW5s
aW5lIHVpbnRwdHJfdCBfcmVjb3JkZXJfY2hhcihjaGFyIGMpCisvLyAtLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tCisvLyAgIE5lY2Vzc2FyeSBiZWNhdXNlIG9mIHRoZSB3YXkgZ2VuZXJpYyBzZWxlY3Rpb25z
IHdvcmsKKy8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KK3sKKyAgICByZXR1cm4gYzsKK30KKworCitz
dGF0aWMgaW5saW5lIHVpbnRwdHJfdCBfcmVjb3JkZXJfdW5zaWduZWQodWludHB0cl90IGkpCisv
LyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tCisvLyAgIE5lY2Vzc2FyeSBiZWNhdXNlIG9mIHRoZSB3YXkg
Z2VuZXJpYyBzZWxlY3Rpb25zIHdvcmsKKy8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KK3sKKyAgICBy
ZXR1cm4gaTsKK30KKworCitzdGF0aWMgaW5saW5lIHVpbnRwdHJfdCBfcmVjb3JkZXJfc2lnbmVk
KGludHB0cl90IGkpCisvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCisvLyAgIE5lY2Vzc2FyeSBiZWNh
dXNlIG9mIHRoZSB3YXkgZ2VuZXJpYyBzZWxlY3Rpb25zIHdvcmsKKy8vIC0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0KK3sKKyAgICByZXR1cm4gKHVpbnRwdHJfdCkgaTsKK30KKworCitzdGF0aWMgaW5saW5l
IHVpbnRwdHJfdCBfcmVjb3JkZXJfcG9pbnRlcihjb25zdCB2b2lkICppKQorLy8gLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLQorLy8gICBOZWNlc3NhcnkgYmVjYXVzZSBvZiB0aGUgd2F5IGdlbmVyaWMgc2Vs
ZWN0aW9ucyB3b3JrCisvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCit7CisgICAgcmV0dXJuICh1aW50
cHRyX3QpIGk7Cit9CisKKyNlbmRpZiAvLyBfX2NwbHVzcGx1cworCisKK3N0YXRpYyBpbmxpbmUg
dWludHB0cl90IF9yZWNvcmRlcl9mbG9hdChmbG9hdCBmKQorLy8gLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LQorLy8gICBDb252ZXJ0IGZsb2F0aW5nIHBvaW50IG51bWJlciB0byBpbnRwdHJfdCByZXByZXNl
bnRhdGlvbiBmb3IgcmVjb3JkZXIKKy8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KK3sKKyAgICBpZiAo
c2l6ZW9mKGZsb2F0KSA9PSBzaXplb2YoaW50cHRyX3QpKSB7CisgICAgICAgIHVuaW9uIHsgZmxv
YXQgZjsgdWludHB0cl90IGk7IH0gdTsKKyAgICAgICAgdS5mID0gZjsKKyAgICAgICAgcmV0dXJu
IHUuaTsKKyAgICB9IGVsc2UgeworICAgICAgICB1bmlvbiB7IGRvdWJsZSBkOyB1aW50cHRyX3Qg
aTsgfSB1OworICAgICAgICB1LmQgPSAoZG91YmxlKSBmOworICAgICAgICByZXR1cm4gdS5pOwor
ICAgIH0KK30KKworCitzdGF0aWMgaW5saW5lIHVpbnRwdHJfdCBfcmVjb3JkZXJfZG91YmxlKGRv
dWJsZSBkKQorLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQorLy8gICBDb252ZXJ0IGRvdWJsZS1wcmVj
aXNpb24gZmxvYXRpbmcgcG9pbnQgbnVtYmVyIHRvIGludHB0cl90IHJlcHJlc2VudGF0aW9uCisv
LyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tCit7CisgICAgaWYgKHNpemVvZihkb3VibGUpID09IHNpemVv
ZihpbnRwdHJfdCkpIHsKKyAgICAgICAgdW5pb24geyBkb3VibGUgZDsgdWludHB0cl90IGk7IH0g
dTsKKyAgICAgICAgdS5kID0gZDsKKyAgICAgICAgcmV0dXJuIHUuaTsKKyAgICB9IGVsc2Ugewor
ICAgICAgICAvLyBCZXR0ZXIgdG8gbG9zZSBwcmVjaXNpb24gdGhhbiBub3Qgc3RvcmUgYW55IGRh
dGEKKyAgICAgICAgdW5pb24geyBmbG9hdCBmOyB1aW50cHRyX3QgaTsgfSB1OworICAgICAgICB1
LmYgPSBkOworICAgICAgICByZXR1cm4gdS5pOworICAgIH0KK30KZGlmZiAtLWdpdCBhL3Rlc3Rz
L3Rlc3QtZHVtbXktcmVjb3JkZXIuYyBiL3Rlc3RzL3Rlc3QtZHVtbXktcmVjb3JkZXIuYwppbmRl
eCA0ZTY3NGE5Li41YmU0Y2JkIDEwMDY0NAotLS0gYS90ZXN0cy90ZXN0LWR1bW15LXJlY29yZGVy
LmMKKysrIGIvdGVzdHMvdGVzdC1kdW1teS1yZWNvcmRlci5jCkBAIC0xOSw3ICsxOSw4IEBACiAj
aW5jbHVkZSA8Y29uZmlnLmg+CiAjaW5jbHVkZSA8YXNzZXJ0Lmg+CgotI3VuZGVmIEVOQUJMRV9S
RUNPUkRFUgorI3VuZGVmIEVOQUJMRV9DM0RfUkVDT1JERVIKKyN1bmRlZiBFTkFCTEVfQUdFTlRf
SU5URVJGQUNFCgogI2luY2x1ZGUgPGNvbW1vbi9yZWNvcmRlci5oPgoKLS0KMi4yMS4wCgpfX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpTcGljZS1kZXZlbCBt
YWlsaW5nIGxpc3QKU3BpY2UtZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlz
dHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vc3BpY2UtZGV2ZWw=
