Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 94D11A541B
	for <lists+spice-devel@lfdr.de>; Mon,  2 Sep 2019 12:35:34 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 99964899E7;
	Mon,  2 Sep 2019 10:35:32 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 858C3899E7
 for <spice-devel@lists.freedesktop.org>; Mon,  2 Sep 2019 10:35:29 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx06.intmail.prod.int.phx2.redhat.com
 [10.5.11.16])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id 320033084212
 for <spice-devel@lists.freedesktop.org>; Mon,  2 Sep 2019 10:35:29 +0000 (UTC)
Received: from fziglio.remote.csb (unknown [10.33.32.16])
 by smtp.corp.redhat.com (Postfix) with ESMTP id 182125C207;
 Mon,  2 Sep 2019 10:35:27 +0000 (UTC)
From: Frediano Ziglio <fziglio@redhat.com>
To: spice-devel@lists.freedesktop.org
Date: Mon,  2 Sep 2019 11:35:20 +0100
Message-Id: <20190902103520.29210-3-fziglio@redhat.com>
In-Reply-To: <20190902103520.29210-1-fziglio@redhat.com>
References: <20190902103520.29210-1-fziglio@redhat.com>
MIME-Version: 1.0
X-Scanned-By: MIMEDefang 2.79 on 10.5.11.16
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16
 (mx1.redhat.com [10.5.110.40]); Mon, 02 Sep 2019 10:35:29 +0000 (UTC)
Subject: [Spice-devel] [PATCH spice-gtk v2 3/3] usb-device-manager: Use
 SpiceUsbBackendDevice directly instead of SpiceUsbDevice
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

VGhleSB3ZXJlIHRoZSBzYW1lIHN0cnVjdHVyZS4KClNpZ25lZC1vZmYtYnk6IEZyZWRpYW5vIFpp
Z2xpbyA8ZnppZ2xpb0ByZWRoYXQuY29tPgotLS0KIHNyYy91c2ItYmFja2VuZC5jICAgICAgICB8
ICA2ICsrKy0tLQogc3JjL3VzYi1iYWNrZW5kLmggICAgICAgIHwgIDYgKysrLS0tCiBzcmMvdXNi
LWRldmljZS1tYW5hZ2VyLmMgfCA0MiArKysrKysrKysrKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tCiAzIGZpbGVzIGNoYW5nZWQsIDE3IGluc2VydGlvbnMoKyksIDM3IGRlbGV0aW9ucygt
KQoKZGlmZiAtLWdpdCBhL3NyYy91c2ItYmFja2VuZC5jIGIvc3JjL3VzYi1iYWNrZW5kLmMKaW5k
ZXggZTYxZWMwMWYuLmNmZDE0ZTJjIDEwMDY0NAotLS0gYS9zcmMvdXNiLWJhY2tlbmQuYworKysg
Yi9zcmMvdXNiLWJhY2tlbmQuYwpAQCAtNDQsNyArNDQsNyBAQAogCiAjZGVmaW5lIExPVURfREVC
VUcoeCwgLi4uKQogCi1zdHJ1Y3QgX1NwaWNlVXNiQmFja2VuZERldmljZQorc3RydWN0IF9TcGlj
ZVVzYkRldmljZQogewogICAgIGxpYnVzYl9kZXZpY2UgKmxpYnVzYl9kZXZpY2U7CiAgICAgZ2lu
dCByZWZfY291bnQ7CkBAIC01MTcsMTIgKzUxNywxMiBAQCB2b2lkIHNwaWNlX3VzYl9iYWNrZW5k
X2RlbGV0ZShTcGljZVVzYkJhY2tlbmQgKmJlKQogICAgIFNQSUNFX0RFQlVHKCIlcyA8PCIsIF9f
RlVOQ1RJT05fXyk7CiB9CiAKLWNvbnN0IFVzYkRldmljZUluZm9ybWF0aW9uKiBzcGljZV91c2Jf
YmFja2VuZF9kZXZpY2VfZ2V0X2luZm8oU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpkZXYpCitjb25z
dCBVc2JEZXZpY2VJbmZvcm1hdGlvbiogc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX2dldF9pbmZv
KGNvbnN0IFNwaWNlVXNiQmFja2VuZERldmljZSAqZGV2KQogewogICAgIHJldHVybiAmZGV2LT5k
ZXZpY2VfaW5mbzsKIH0KIAotZ2NvbnN0cG9pbnRlciBzcGljZV91c2JfYmFja2VuZF9kZXZpY2Vf
Z2V0X2xpYmRldihTcGljZVVzYkJhY2tlbmREZXZpY2UgKmRldikKK2djb25zdHBvaW50ZXIgc3Bp
Y2VfdXNiX2JhY2tlbmRfZGV2aWNlX2dldF9saWJkZXYoY29uc3QgU3BpY2VVc2JCYWNrZW5kRGV2
aWNlICpkZXYpCiB7CiAgICAgcmV0dXJuIGRldi0+bGlidXNiX2RldmljZTsKIH0KZGlmZiAtLWdp
dCBhL3NyYy91c2ItYmFja2VuZC5oIGIvc3JjL3VzYi1iYWNrZW5kLmgKaW5kZXggNjZlMTNmNTQu
LjU4MzAzMTJiIDEwMDY0NAotLS0gYS9zcmMvdXNiLWJhY2tlbmQuaAorKysgYi9zcmMvdXNiLWJh
Y2tlbmQuaApAQCAtMjcsNyArMjcsNyBAQAogR19CRUdJTl9ERUNMUwogCiB0eXBlZGVmIHN0cnVj
dCBfU3BpY2VVc2JCYWNrZW5kIFNwaWNlVXNiQmFja2VuZDsKLXR5cGVkZWYgc3RydWN0IF9TcGlj
ZVVzYkJhY2tlbmREZXZpY2UgU3BpY2VVc2JCYWNrZW5kRGV2aWNlOwordHlwZWRlZiBzdHJ1Y3Qg
X1NwaWNlVXNiRGV2aWNlIFNwaWNlVXNiQmFja2VuZERldmljZTsKIHR5cGVkZWYgc3RydWN0IF9T
cGljZVVzYkJhY2tlbmRDaGFubmVsIFNwaWNlVXNiQmFja2VuZENoYW5uZWw7CiAKIHR5cGVkZWYg
c3RydWN0IFVzYkRldmljZUluZm9ybWF0aW9uCkBAIC02NCw4ICs2NCw4IEBAIHZvaWQgc3BpY2Vf
dXNiX2JhY2tlbmRfZGVyZWdpc3Rlcl9ob3RwbHVnKFNwaWNlVXNiQmFja2VuZCAqYmUpOwogLyog
U3BpY2UgVVNCIGJhY2tlbmQgZGV2aWNlIEFQSSAqLwogU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpz
cGljZV91c2JfYmFja2VuZF9kZXZpY2VfcmVmKFNwaWNlVXNiQmFja2VuZERldmljZSAqZGV2KTsK
IHZvaWQgc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX3VucmVmKFNwaWNlVXNiQmFja2VuZERldmlj
ZSAqZGV2KTsKLWdjb25zdHBvaW50ZXIgc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX2dldF9saWJk
ZXYoU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpkZXYpOwotY29uc3QgVXNiRGV2aWNlSW5mb3JtYXRp
b24qIHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9nZXRfaW5mbyhTcGljZVVzYkJhY2tlbmREZXZp
Y2UgKmRldik7CitnY29uc3Rwb2ludGVyIHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9nZXRfbGli
ZGV2KGNvbnN0IFNwaWNlVXNiQmFja2VuZERldmljZSAqZGV2KTsKK2NvbnN0IFVzYkRldmljZUlu
Zm9ybWF0aW9uKiBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfZ2V0X2luZm8oY29uc3QgU3BpY2VV
c2JCYWNrZW5kRGV2aWNlICpkZXYpOwogZ2Jvb2xlYW4gc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNl
X2lzb2NoKFNwaWNlVXNiQmFja2VuZERldmljZSAqZGV2KTsKIC8qIHJldHVybnMgMCBpZiB0aGUg
ZGV2aWNlIHBhc3NlcyB0aGUgZmlsdGVyICovCiBpbnQgc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNl
X2NoZWNrX2ZpbHRlcihTcGljZVVzYkJhY2tlbmREZXZpY2UgKmRldiwKZGlmZiAtLWdpdCBhL3Ny
Yy91c2ItZGV2aWNlLW1hbmFnZXIuYyBiL3NyYy91c2ItZGV2aWNlLW1hbmFnZXIuYwppbmRleCBi
ODViMjBkZS4uMTdiY2EwOTkgMTAwNjQ0Ci0tLSBhL3NyYy91c2ItZGV2aWNlLW1hbmFnZXIuYwor
KysgYi9zcmMvdXNiLWRldmljZS1tYW5hZ2VyLmMKQEAgLTEyMCwxMiArMTIwLDYgQEAgZW51bSB7
CiAKICNpZmRlZiBVU0VfVVNCUkVESVIKIAotc3RydWN0IF9TcGljZVVzYkRldmljZSB7Ci0gICAg
U3BpY2VVc2JCYWNrZW5kRGV2aWNlICpiZGV2OwotICAgIGdpbnQgICAgcmVmOwotfTsKLQotCiBz
dGF0aWMgdm9pZCBjaGFubmVsX25ldyhTcGljZVNlc3Npb24gKnNlc3Npb24sIFNwaWNlQ2hhbm5l
bCAqY2hhbm5lbCwKICAgICAgICAgICAgICAgICAgICAgICAgIGdwb2ludGVyIHVzZXJfZGF0YSk7
CiBzdGF0aWMgdm9pZCBjaGFubmVsX2Rlc3Ryb3koU3BpY2VTZXNzaW9uICpzZXNzaW9uLCBTcGlj
ZUNoYW5uZWwgKmNoYW5uZWwsCkBAIC02MzcsNyArNjMxLDcgQEAgc3BpY2VfdXNiX2RldmljZV9n
ZXRfbGlidXNiX2RldmljZShjb25zdCBTcGljZVVzYkRldmljZSAqaW5mbyBHX0dOVUNfVU5VU0VE
KQogI2lmZGVmIFVTRV9VU0JSRURJUgogICAgIGdfcmV0dXJuX3ZhbF9pZl9mYWlsKGluZm8gIT0g
TlVMTCwgRkFMU0UpOwogCi0gICAgcmV0dXJuIHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9nZXRf
bGliZGV2KGluZm8tPmJkZXYpOworICAgIHJldHVybiBzcGljZV91c2JfYmFja2VuZF9kZXZpY2Vf
Z2V0X2xpYmRldihpbmZvKTsKICNlbmRpZgogICAgIHJldHVybiBOVUxMOwogfQpAQCAtMTQ4MCwx
NiArMTQ3NCw5IEBAIGdjaGFyICpzcGljZV91c2JfZGV2aWNlX2dldF9kZXNjcmlwdGlvbihTcGlj
ZVVzYkRldmljZSAqZGV2aWNlLCBjb25zdCBnY2hhciAqZm9yCiAgKi8KIHN0YXRpYyBTcGljZVVz
YkRldmljZSAqc3BpY2VfdXNiX2RldmljZV9uZXcoU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpiZGV2
KQogewotICAgIFNwaWNlVXNiRGV2aWNlICppbmZvOwotCiAgICAgZ19yZXR1cm5fdmFsX2lmX2Zh
aWwoYmRldiAhPSBOVUxMLCBOVUxMKTsKIAotICAgIGluZm8gPSBnX25ldzAoU3BpY2VVc2JEZXZp
Y2UsIDEpOwotCi0gICAgaW5mby0+cmVmID0gMTsKLSAgICBpbmZvLT5iZGV2ID0gc3BpY2VfdXNi
X2JhY2tlbmRfZGV2aWNlX3JlZihiZGV2KTsKLQotICAgIHJldHVybiBpbmZvOworICAgIHJldHVy
biBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfcmVmKGJkZXYpOwogfQogCiBndWludDE2IHNwaWNl
X3VzYl9kZXZpY2VfZ2V0X2J1c251bShjb25zdCBTcGljZVVzYkRldmljZSAqaW5mbykKQEAgLTE0
OTgsNyArMTQ4NSw3IEBAIGd1aW50MTYgc3BpY2VfdXNiX2RldmljZV9nZXRfYnVzbnVtKGNvbnN0
IFNwaWNlVXNiRGV2aWNlICppbmZvKQogCiAgICAgZ19yZXR1cm5fdmFsX2lmX2ZhaWwoaW5mbyAh
PSBOVUxMLCAwKTsKIAotICAgIGJfaW5mbyA9IHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9nZXRf
aW5mbyhpbmZvLT5iZGV2KTsKKyAgICBiX2luZm8gPSBzcGljZV91c2JfYmFja2VuZF9kZXZpY2Vf
Z2V0X2luZm8oaW5mbyk7CiAgICAgcmV0dXJuIGJfaW5mby0+YnVzOwogfQogCkBAIC0xNTA4LDcg
KzE0OTUsNyBAQCBndWludDggc3BpY2VfdXNiX2RldmljZV9nZXRfZGV2YWRkcihjb25zdCBTcGlj
ZVVzYkRldmljZSAqaW5mbykKIAogICAgIGdfcmV0dXJuX3ZhbF9pZl9mYWlsKGluZm8gIT0gTlVM
TCwgMCk7CiAKLSAgICBiX2luZm8gPSBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfZ2V0X2luZm8o
aW5mby0+YmRldik7CisgICAgYl9pbmZvID0gc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX2dldF9p
bmZvKGluZm8pOwogICAgIHJldHVybiBiX2luZm8tPmFkZHJlc3M7CiB9CiAKQEAgLTE1MTgsNyAr
MTUwNSw3IEBAIGd1aW50MTYgc3BpY2VfdXNiX2RldmljZV9nZXRfdmlkKGNvbnN0IFNwaWNlVXNi
RGV2aWNlICppbmZvKQogCiAgICAgZ19yZXR1cm5fdmFsX2lmX2ZhaWwoaW5mbyAhPSBOVUxMLCAw
KTsKIAotICAgIGJfaW5mbyA9IHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9nZXRfaW5mbyhpbmZv
LT5iZGV2KTsKKyAgICBiX2luZm8gPSBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfZ2V0X2luZm8o
aW5mbyk7CiAgICAgcmV0dXJuIGJfaW5mby0+dmlkOwogfQogCkBAIC0xNTI4LDcgKzE1MTUsNyBA
QCBndWludDE2IHNwaWNlX3VzYl9kZXZpY2VfZ2V0X3BpZChjb25zdCBTcGljZVVzYkRldmljZSAq
aW5mbykKIAogICAgIGdfcmV0dXJuX3ZhbF9pZl9mYWlsKGluZm8gIT0gTlVMTCwgMCk7CiAKLSAg
ICBiX2luZm8gPSBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfZ2V0X2luZm8oaW5mby0+YmRldik7
CisgICAgYl9pbmZvID0gc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX2dldF9pbmZvKGluZm8pOwog
ICAgIHJldHVybiBiX2luZm8tPnBpZDsKIH0KIApAQCAtMTUzNiw3ICsxNTIzLDcgQEAgZ2Jvb2xl
YW4gc3BpY2VfdXNiX2RldmljZV9pc19pc29jaHJvbm91cyhjb25zdCBTcGljZVVzYkRldmljZSAq
aW5mbykKIHsKICAgICBnX3JldHVybl92YWxfaWZfZmFpbChpbmZvICE9IE5VTEwsIDApOwogCi0g
ICAgcmV0dXJuIHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9pc29jaChpbmZvLT5iZGV2KTsKKyAg
ICByZXR1cm4gc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX2lzb2NoKChTcGljZVVzYkJhY2tlbmRE
ZXZpY2UqKSBpbmZvKTsKIH0KIAogI2lmZGVmIEdfT1NfV0lOMzIKQEAgLTE2MTUsMjEgKzE2MDIs
MTQgQEAgdm9pZCBfdXNiZGtfaGlkZXJfdXBkYXRlKFNwaWNlVXNiRGV2aWNlTWFuYWdlciAqbWFu
YWdlcikKIHN0YXRpYyBTcGljZVVzYkRldmljZSAqc3BpY2VfdXNiX2RldmljZV9yZWYoU3BpY2VV
c2JEZXZpY2UgKmluZm8pCiB7CiAgICAgZ19yZXR1cm5fdmFsX2lmX2ZhaWwoaW5mbyAhPSBOVUxM
LCBOVUxMKTsKLSAgICBnX2F0b21pY19pbnRfaW5jKCZpbmZvLT5yZWYpOwotICAgIHJldHVybiBp
bmZvOworICAgIHJldHVybiBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfcmVmKGluZm8pOwogfQog
CiBzdGF0aWMgdm9pZCBzcGljZV91c2JfZGV2aWNlX3VucmVmKFNwaWNlVXNiRGV2aWNlICppbmZv
KQogewotICAgIGdib29sZWFuIHJlZl9jb3VudF9pc18wOwotCiAgICAgZ19yZXR1cm5faWZfZmFp
bChpbmZvICE9IE5VTEwpOwogCi0gICAgcmVmX2NvdW50X2lzXzAgPSBnX2F0b21pY19pbnRfZGVj
X2FuZF90ZXN0KCZpbmZvLT5yZWYpOwotICAgIGlmIChyZWZfY291bnRfaXNfMCkgewotICAgICAg
ICBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfdW5yZWYoaW5mby0+YmRldik7Ci0gICAgICAgIGdf
ZnJlZShpbmZvKTsKLSAgICB9CisgICAgc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX3VucmVmKGlu
Zm8pOwogfQogCiBzdGF0aWMgZ2Jvb2xlYW4KQEAgLTE2NDAsNyArMTYyMCw3IEBAIHNwaWNlX3Vz
Yl9tYW5hZ2VyX2RldmljZV9lcXVhbF9iZGV2KFNwaWNlVXNiRGV2aWNlTWFuYWdlciAqbWFuYWdl
ciwKICAgICBpZiAoKGluZm8gPT0gTlVMTCkgfHwgKGJkZXYgPT0gTlVMTCkpCiAgICAgICAgIHJl
dHVybiBGQUxTRTsKIAotICAgIHJldHVybiBpbmZvLT5iZGV2ID09IGJkZXY7CisgICAgcmV0dXJu
IGluZm8gPT0gYmRldjsKIH0KIAogLyoKQEAgLTE2NTIsNiArMTYzMiw2IEBAIHNwaWNlX3VzYl9k
ZXZpY2VfbWFuYWdlcl9kZXZpY2VfdG9fYmRldihTcGljZVVzYkRldmljZU1hbmFnZXIgKnNlbGYs
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU3BpY2VVc2JEZXZpY2Ug
KmluZm8pCiB7CiAgICAgLyogU2ltcGx5IHJldHVybiBhIHJlZiB0byB0aGUgY2FjaGVkIGxpYmRl
diAqLwotICAgIHJldHVybiBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfcmVmKGluZm8tPmJkZXYp
OworICAgIHJldHVybiBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfcmVmKGluZm8pOwogfQogI2Vu
ZGlmIC8qIFVTRV9VU0JSRURJUiAqLwotLSAKMi4yMC4xCgpfX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fXwpTcGljZS1kZXZlbCBtYWlsaW5nIGxpc3QKU3BpY2Ut
ZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3Jn
L21haWxtYW4vbGlzdGluZm8vc3BpY2UtZGV2ZWw=
