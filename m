Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 2857973166
	for <lists+spice-devel@lfdr.de>; Wed, 24 Jul 2019 16:17:35 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 3181A6E5AA;
	Wed, 24 Jul 2019 14:17:33 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mail.codeweavers.com (mail.codeweavers.com [50.203.203.244])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 558626E5AD
 for <spice-devel@lists.freedesktop.org>; Wed, 24 Jul 2019 14:17:32 +0000 (UTC)
Received: from jwhite.mn.codeweavers.com ([10.69.137.101])
 by mail.codeweavers.com with esmtpsa (TLS1.2:ECDHE_RSA_AES_128_GCM_SHA256:128)
 (Exim 4.89) (envelope-from <jwhite@codeweavers.com>)
 id 1hqI5Y-0001ed-6C
 for spice-devel@lists.freedesktop.org; Wed, 24 Jul 2019 09:17:52 -0500
From: Jeremy White <jwhite@codeweavers.com>
To: spice-devel@lists.freedesktop.org
Date: Wed, 24 Jul 2019 09:17:25 -0500
Message-Id: <20190724141726.32063-3-jwhite@codeweavers.com>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20190724141726.32063-1-jwhite@codeweavers.com>
References: <20190724141726.32063-1-jwhite@codeweavers.com>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt;
 c=relaxed/relaxed; 
 d=codeweavers.com; s=6377696661; h=Content-Transfer-Encoding:MIME-Version:
 References:In-Reply-To:Message-Id:Date:Subject:To:From:Sender:Reply-To:Cc:
 Content-Type:Content-ID:Content-Description:Resent-Date:Resent-From:
 Resent-Sender:Resent-To:Resent-Cc:Resent-Message-ID:List-Id:List-Help:
 List-Unsubscribe:List-Subscribe:List-Post:List-Owner:List-Archive;
 bh=r3FZ79ag2zcG233HAZ3ElSi4H6A7t0lhgZhoLqz7G4w=; b=VTdBMhp/++dtO8hLdX4UBWUi4x
 HzKJIorVgZLZOYH40/pH5VQDjvdPj0jhovNYGBKTLpj4a5l1OOcpVu7kP8yCmRyxHCyfSWef8bAhQ
 8OXnGHEb8i9ECXO7C9tVKwOKONxdB+GWXgDoxbvviXHiyiYjhM/+ZY83kVUBeveT7F+8=;
Subject: [Spice-devel] [PATCH fixup1 x11spice 2/3] Simplify the expression
 of argument parsing.
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

VGhpcyBmaXhlcyBhIGJ1ZyB3aXRoIC0tY29uZmlnPWhhbmRsaW5nLgoKVGhpcyBhbHNvIGluY2x1
ZGVzIHRlc3QgY29kZSBjb3VydGVzeSBvZiBGcmVkaWFubyBaaWdsaW8gPGZ6aWdsaW9AcmVkaGF0
LmNvbT4uCgpTaWduZWQtb2ZmLWJ5OiBKZXJlbXkgV2hpdGUgPGp3aGl0ZUBjb2Rld2VhdmVycy5j
b20+Ci0tLQogc3JjL21haW4uYyAgICB8ICA4ICsrKy0tCiBzcmMvb3B0aW9ucy5jIHwgOTEgKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrLS0tLS0tLS0tCiBzcmMvb3B0
aW9ucy5oIHwgIDEgLQogMyBmaWxlcyBjaGFuZ2VkLCA4MiBpbnNlcnRpb25zKCspLCAxOCBkZWxl
dGlvbnMoLSkKCmRpZmYgLS1naXQgYS9zcmMvbWFpbi5jIGIvc3JjL21haW4uYwppbmRleCBmMTgz
MTFjOS4uZGE2ZDQ4ODIgMTAwNjQ0Ci0tLSBhL3NyYy9tYWluLmMKKysrIGIvc3JjL21haW4uYwpA
QCAtNjcsOSArNjcsMTMgQEAgaW50IG1haW4oaW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSkKICAgICAq
KiAgUGFyc2UgYXJndW1lbnRzCiAgICAgKiotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KICAgICBvcHRpb25zX2lu
aXQoJnNlc3Npb24ub3B0aW9ucyk7Ci0gICAgb3B0aW9uc19oYW5kbGVfdXNlcl9jb25maWcoYXJn
YywgYXJndiwgJnNlc3Npb24ub3B0aW9ucyk7Ci0gICAgb3B0aW9uc19mcm9tX2NvbmZpZygmc2Vz
c2lvbi5vcHRpb25zKTsKICAgICByYyA9IG9wdGlvbnNfcGFyc2VfYXJndW1lbnRzKGFyZ2MsIGFy
Z3YsICZzZXNzaW9uLm9wdGlvbnMpOworICAgIGlmIChyYyA9PSAwKSB7CisgICAgICAgIG9wdGlv
bnNfZnJvbV9jb25maWcoJnNlc3Npb24ub3B0aW9ucyk7CisgICAgICAgIC8qIFdlIHBhcnNlIGNv
bW1hbmQgbGluZSBhcmd1bWVudHMgYSBzZWNvbmQgdGltZSB0byBlbnN1cmUKKyAgICAgICAgKiog
IHRoYXQgY29tbWFuZCBsaW5lIG9wdGlvbnMgdGFrZSBwcmVjZWRlbmNlIG92ZXIgY29uZmlnIGZp
bGVzICovCisgICAgICAgIHJjID0gb3B0aW9uc19wYXJzZV9hcmd1bWVudHMoYXJnYywgYXJndiwg
JnNlc3Npb24ub3B0aW9ucyk7CisgICAgfQogICAgIGlmIChyYykKICAgICAgICAgZ290byBleGl0
OwogCmRpZmYgLS1naXQgYS9zcmMvb3B0aW9ucy5jIGIvc3JjL29wdGlvbnMuYwppbmRleCBjZmY0
YWMxNy4uNjYyMGI4NTMgMTAwNjQ0Ci0tLSBhL3NyYy9vcHRpb25zLmMKKysrIGIvc3JjL29wdGlv
bnMuYwpAQCAtMjE0LDE2ICsyMTQsNiBAQCB2b2lkIG9wdGlvbnNfaGFuZGxlX3NzbF9maWxlX29w
dGlvbnMob3B0aW9uc190ICpvcHRpb25zLAogICAgIHN0cmluZ19vcHRpb24oJm9wdGlvbnMtPnNz
bC5jaXBoZXJzdWl0ZSwgdXNlcmtleSwgc3lzdGVta2V5LCAic3NsIiwgImNpcGhlcnN1aXRlIik7
CiB9CiAKLXZvaWQgb3B0aW9uc19oYW5kbGVfdXNlcl9jb25maWcoaW50IGFyZ2MsIGNoYXIgKmFy
Z3ZbXSwgb3B0aW9uc190ICpvcHRpb25zKQotewotICAgIGludCBpOwotICAgIGZvciAoaSA9IDE7
IGkgPCBhcmdjIC0gMTsgaSsrKQotICAgICAgICBpZiAoc3RyY21wKGFyZ3ZbaV0sICItLWNvbmZp
ZyIpID09IDAgfHwgc3RyY21wKGFyZ3ZbaV0sICItY29uZmlnIikgPT0gMCkgewotICAgICAgICAg
ICAgb3B0aW9ucy0+dXNlcl9jb25maWdfZmlsZSA9IGdfc3RyZHVwKGFyZ3ZbaSArIDFdKTsKLSAg
ICAgICAgICAgIGkrKzsKLSAgICAgICAgfQotfQotCiBpbnQgb3B0aW9uc19wYXJzZV9hcmd1bWVu
dHMoaW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSwgb3B0aW9uc190ICpvcHRpb25zKQogewogICAgIGlu
dCByYzsKQEAgLTI1NCw2ICsyNDQsNyBAQCBpbnQgb3B0aW9uc19wYXJzZV9hcmd1bWVudHMoaW50
IGFyZ2MsIGNoYXIgKmFyZ3ZbXSwgb3B0aW9uc190ICpvcHRpb25zKQogICAgICAgICB7MCwgMCwg
MCwgMH0KICAgICB9OwogCisgICAgb3B0aW5kID0gMTsgLyogQWxsb3cgcmV1c2Ugb2YgdGhpcyBm
dW5jdGlvbiAqLwogICAgIHdoaWxlICgxKSB7CiAgICAgICAgIHJjID0gZ2V0b3B0X2xvbmdfb25s
eShhcmdjLCBhcmd2LCAiIiwgbG9uZ19vcHRpb25zLCAmbG9uZ2luZGV4KTsKICAgICAgICAgaWYg
KHJjID09IC0xKSB7CkBAIC01MDEsMTUgKzQ5Miw4NSBAQCBpbnQgb3B0aW9uc19pbXBvc3NpYmxl
X2NvbmZpZyhvcHRpb25zX3QgKm9wdGlvbnMpCiAgICAgcmV0dXJuIDE7CiB9CiAKLSNpZiBkZWZp
bmVkKE9QVElPTlNfTUFJTikKLWludCBtYWluKGludCBhcmdjLCBjaGFyICphcmd2W10pCisjaWYg
ZGVmaW5lZChNQUlOX1RFU1QpCitzdGF0aWMgaW50IHRlc3RfbG9hZF9vcHRpb25zKG9wdGlvbnNf
dCAqb3B0aW9ucywgaW50IGFyZ2MsIGNoYXIgKiphcmd2KQoreworICAgIGludCByYzsKKyAgICBy
YyA9IG9wdGlvbnNfcGFyc2VfYXJndW1lbnRzKGFyZ2MsIGFyZ3YsIG9wdGlvbnMpOworICAgIGlm
IChyYyA9PSAwKSB7CisgICAgICAgIG9wdGlvbnNfZnJvbV9jb25maWcob3B0aW9ucyk7CisgICAg
ICAgIC8qIFdlIHBhcnNlIGNvbW1hbmQgbGluZSBhcmd1bWVudHMgYSBzZWNvbmQgdGltZSB0byBl
bnN1cmUKKyAgICAgICAgKiogIHRoYXQgY29tbWFuZCBsaW5lIG9wdGlvbnMgdGFrZSBwcmVjZWRl
bmNlIG92ZXIgY29uZmlnIGZpbGVzICovCisgICAgICAgIHJjID0gb3B0aW9uc19wYXJzZV9hcmd1
bWVudHMoYXJnYywgYXJndiwgb3B0aW9ucyk7CisgICAgfQorICAgIGlmIChyYyA9PSAwKSB7Cisg
ICAgICAgIHJjID0gb3B0aW9uc19wcm9jZXNzX2lvKG9wdGlvbnMpOworICAgIH0KKyAgICByZXR1
cm4gcmM7Cit9CisKK3N0YXRpYyB2b2lkIHRlc3QoY29uc3QgY2hhciAqZXhwZWN0ZWQsIGNoYXIg
Kiphcmd2KQogewogICAgIG9wdGlvbnNfdCBvcHRpb25zOworICAgIGludCBhcmdjID0gMDsKKyAg
ICBpbnQgcmM7CisgICAgY2hhciBidWZbMTAwMF07CisKKyAgICB3aGlsZSAoYXJndlthcmdjXSkg
eworICAgICAgICArK2FyZ2M7CisgICAgfQogCiAgICAgb3B0aW9uc19pbml0KCZvcHRpb25zKTsK
LSAgICBvcHRpb25zX3BhcnNlX2FyZ3VtZW50cyhhcmdjLCBhcmd2LCAmb3B0aW9ucyk7Ci0gICAg
b3B0aW9uc19mcm9tX2NvbmZpZygmb3B0aW9ucyk7Ci0gICAgZ19tZXNzYWdlKCJPcHRpb25zIHBh
cnNlZCIpOworICAgIHJjID0gdGVzdF9sb2FkX29wdGlvbnMoJm9wdGlvbnMsIGFyZ2MsIGFyZ3Yp
OworICAgIGlmIChyYyA9PSAwKSB7CisgICAgICAgIHNucHJpbnRmKGJ1Ziwgc2l6ZW9mKGJ1Ziks
ICJkaXNwbGF5ICVzIGFsbG93X2NvbnRyb2wgJWQgbGlzdGVuICVzIGNhX2ZpbGUgJXMiLAorICAg
ICAgICAgICAgICAgICBvcHRpb25zLmRpc3BsYXksIG9wdGlvbnMuYWxsb3dfY29udHJvbCwgb3B0
aW9ucy5saXN0ZW4sIG9wdGlvbnMuc3NsLmNhX2NlcnRfZmlsZSk7CisgICAgICAgIGlmIChzdHJj
bXAoYnVmLCBleHBlY3RlZCkgIT0gMCkgeworICAgICAgICAgICAgZnByaW50ZihzdGRlcnIsICJV
bmV4cGVjdGVkIHJlc3VsdHM6XG5cdCVzXG4lc1xuIiwKKyAgICAgICAgICAgICAgICAgICAgYnVm
LCBleHBlY3RlZCk7CisgICAgICAgIH0KKyAgICB9CisgICAgZWxzZSB7CisgICAgICAgIGZwcmlu
dGYoc3RkZXJyLCAiVW5hYmxlIHRvIGxvYWQgb3B0aW9ucywgcmMgJWRcbiIsIHJjKTsKKyAgICB9
CiAgICAgb3B0aW9uc19mcmVlKCZvcHRpb25zKTsKIH0KKworI2RlZmluZSBURVNUKGV4cCwgLi4u
KSBkbyB7IFwKKyAgICBjaGFyICphcmd2W10gPSB7ICJQUk9HUkFNIiwgX19WQV9BUkdTX18sIE5V
TEwgfTsgXAorICAgIHRlc3QoZXhwLCBhcmd2KTsgXAorfSB3aGlsZSgwKQorCitpbnQgbWFpbihp
bnQgYXJnYywgY2hhciAqKmFyZ3YpCit7CisgICAgRklMRSAqZiA9IGZvcGVuKCJ0ZXN0LmNvbmYi
LCAidyIpOworCisgICAgaWYgKGFyZ2MgPiAxKSB7CisgICAgICAgIG9wdGlvbnNfdCBvcHRpb25z
OworICAgICAgICBvcHRpb25zX2luaXQoJm9wdGlvbnMpOworICAgICAgICBwcmludGYoInRlc3Rf
bG9hZF9vcHRpb25zIHJldHVybnMgJWRcbiIsCisgICAgICAgICAgICB0ZXN0X2xvYWRfb3B0aW9u
cygmb3B0aW9ucywgYXJnYywgYXJndikpOworICAgICAgICBvcHRpb25zX2ZyZWUoJm9wdGlvbnMp
OworICAgIH0KKworICAgIGZwcmludGYoZiwgIltzcGljZV1cbmRpc3BsYXk9Y29uZmlnX2Rpc3Bs
YXlcbmxpc3Rlbj04NzY1XG5hbGxvdy1jb250cm9sPXRydWUiKTsKKyAgICBmY2xvc2UoZik7CisK
KyAgICBURVNUKCJkaXNwbGF5IChudWxsKSBhbGxvd19jb250cm9sIDAgbGlzdGVuIDU5MDAgY2Ff
ZmlsZSAobnVsbCkiLAorICAgICAgICAgIi0taGlkZSIpOworICAgIFRFU1QoImRpc3BsYXkgKG51
bGwpIGFsbG93X2NvbnRyb2wgMCBsaXN0ZW4gMTIzNCBjYV9maWxlIChudWxsKSIsCisgICAgICAg
ICAiMTIzNCIpOworICAgIFRFU1QoImRpc3BsYXkgY29uZmlnX2Rpc3BsYXkgYWxsb3dfY29udHJv
bCAxIGxpc3RlbiA4NzY1IGNhX2ZpbGUgKG51bGwpIiwKKyAgICAgICAgICItLWNvbmZpZz10ZXN0
LmNvbmYiKTsKKyAgICBURVNUKCJkaXNwbGF5IGNvbmZpZ19kaXNwbGF5IGFsbG93X2NvbnRyb2wg
MSBsaXN0ZW4gMTIzIGNhX2ZpbGUgKG51bGwpIiwKKyAgICAgICAgICItLWNvbmZpZz10ZXN0LmNv
bmYiLCAiMTIzIik7CisgICAgVEVTVCgiZGlzcGxheSBjb25maWdfZGlzcGxheSBhbGxvd19jb250
cm9sIDAgbGlzdGVuIDEyMyBjYV9maWxlIChudWxsKSIsCisgICAgICAgICAiLS1uby1hbGxvdy1j
b250cm9sIiwgIi0tY29uZmlnPXRlc3QuY29uZiIsICIxMjMiKTsKKyAgICBURVNUKCJkaXNwbGF5
IERJU1BMQVkgYWxsb3dfY29udHJvbCAxIGxpc3RlbiAxMjMgY2FfZmlsZSAobnVsbCkiLAorICAg
ICAgICAgIi0tZGlzcGxheSIsICJESVNQTEFZIiwgIi0tY29uZmlnPXRlc3QuY29uZiIsICIxMjMi
KTsKKyAgICBURVNUKCJkaXNwbGF5IChudWxsKSBhbGxvd19jb250cm9sIDAgbGlzdGVuIDU5MDAg
Y2FfZmlsZSBmb28iLAorICAgICAgICAgIi0tc3NsPWZvbyIpOworICAgIHVubGluaygidGVzdC5j
b25mIik7CisgICAgcmV0dXJuIDA7Cit9CiAjZW5kaWYKZGlmZiAtLWdpdCBhL3NyYy9vcHRpb25z
LmggYi9zcmMvb3B0aW9ucy5oCmluZGV4IDYxNTU5ODRiLi4yMzAyYzg1YiAxMDA2NDQKLS0tIGEv
c3JjL29wdGlvbnMuaAorKysgYi9zcmMvb3B0aW9ucy5oCkBAIC03Myw3ICs3Myw2IEBAIHR5cGVk
ZWYgc3RydWN0IHsKICoqICBQcm90b3R5cGVzCiAqKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KIHZvaWQg
b3B0aW9uc19pbml0KG9wdGlvbnNfdCAqb3B0aW9ucyk7Ci12b2lkIG9wdGlvbnNfaGFuZGxlX3Vz
ZXJfY29uZmlnKGludCBhcmdjLCBjaGFyICphcmd2W10sIG9wdGlvbnNfdCAqb3B0aW9ucyk7CiBp
bnQgb3B0aW9uc19wYXJzZV9hcmd1bWVudHMoaW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSwgb3B0aW9u
c190ICpvcHRpb25zKTsKIGludCBvcHRpb25zX3Byb2Nlc3NfaW8ob3B0aW9uc190ICpvcHRpb25z
KTsKIHZvaWQgb3B0aW9uc19mcmVlKG9wdGlvbnNfdCAqb3B0aW9ucyk7Ci0tIAoyLjIwLjEKCl9f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClNwaWNlLWRldmVs
IG1haWxpbmcgbGlzdApTcGljZS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9s
aXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9zcGljZS1kZXZlbA==
