Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id EFE445F673
	for <lists+spice-devel@lfdr.de>; Thu,  4 Jul 2019 12:17:39 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 71C326E2B4;
	Thu,  4 Jul 2019 10:17:37 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mail-wm1-f67.google.com (mail-wm1-f67.google.com
 [209.85.128.67])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 654556E2B4
 for <spice-devel@lists.freedesktop.org>; Thu,  4 Jul 2019 10:17:36 +0000 (UTC)
Received: by mail-wm1-f67.google.com with SMTP id s15so5526998wmj.3
 for <spice-devel@lists.freedesktop.org>; Thu, 04 Jul 2019 03:17:36 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:subject:date:message-id:mime-version
 :content-transfer-encoding;
 bh=YNYIQmT9YlmyeYfYTtwdNN9pnWQaxTTtidEFvJQ84Ms=;
 b=ieV6XmM50XC86a/g5OGWYjrqG1eG7XFQrdNTOrtk+vGfWr9Z7fa3F0PehO9bWHGmP1
 mRja+LjjS/FpU4QoPl8cWLDAPZwRZKnctUOSQzjBpXtUNIx7FR6CT2Ob+AGUp+02fU+2
 kivX4w+fnBja3PGjOazAnLHHglXxiY75DEX4SbvC16NhP/PCfuoCQ8izEW1izM4qfp+P
 2P2gTbbkoNebh5sUQzvKssGlJJ1slTlWnPT+YxdGuSR8R4Zz1G6uYiZoRQCSEGt3cWHb
 0yhJdfwjepxoF76YmaF7f5dVLJKb/GJ2vakhzATAd/BDGIYFzSwQhqDDEv+ZL3E5+Zkl
 IZZg==
X-Gm-Message-State: APjAAAXOUHJR2MBMZ18kE4wTcBPyVHidMOVoEUdXviVEqakhnPyjWLlV
 x2wrBFyiGMXfM+EUMAgAVoYmgg52dfY=
X-Google-Smtp-Source: APXvYqxnjYF1E2nkgthhjm6vL9c40KkM9CWhKPn1XKoyWYf2NpKnak5a+jVeL1t9W6mxB3gZOar8JQ==
X-Received: by 2002:a1c:e28b:: with SMTP id
 z133mr11096557wmg.136.1562235454748; 
 Thu, 04 Jul 2019 03:17:34 -0700 (PDT)
Received: from pinea.redhat.com ([2001:861:3440:6a0:71b6:dd5f:657d:58e3])
 by smtp.gmail.com with ESMTPSA id o185sm5315547wmo.45.2019.07.04.03.17.33
 for <spice-devel@lists.freedesktop.org>
 (version=TLS1_3 cipher=AEAD-AES256-GCM-SHA384 bits=256/256);
 Thu, 04 Jul 2019 03:17:34 -0700 (PDT)
From: Kevin Pouget <kpouget@redhat.com>
To: spice-devel@lists.freedesktop.org
Date: Thu,  4 Jul 2019 12:17:32 +0200
Message-Id: <20190704101732.9877-1-kpouget@redhat.com>
X-Mailer: git-send-email 2.21.0
MIME-Version: 1.0
Subject: [Spice-devel] [PATCH spice-server] reds: Add ability to query the
 video-codecs currently enabled
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

c3BpY2Vfc2VydmVyX2dldF92aWRlb19jb2RlY3M6IG5ldyBwdWJsaWMgZnVuY3Rpb24gdG8gcXVl
cnkgdGhlIHZpZGVvCmVuY29kZXJzL2NvZGVjcyBjdXJyZW50bHkgZW5hYmxlZCBpbiB0aGUgc3Bp
Y2Ugc2VydmVyLiBJdCByZXR1cm5zIGEKc3RyaW5nIHRoYXQgY2FuIGJlIGZlZCB0byB0aGUgc2V0
dGVyIGNvdW50ZXIKKHNwaWNlX3NlcnZlcl9zZXRfdmlkZW9fY29kZWNzKS4gVGhlIHN0cmluZyBy
ZXR1cm5lZCBieSB0aGlzIGZ1bmN0aW9uCnNob3VsZCBiZSByZWxlYXNlZCB3aXRoIHNwaWNlX3Nl
cnZlcl9mcmVlX3ZpZGVvX2NvZGVjcy4KCnNwaWNlX3NlcnZlcl9mcmVlX3ZpZGVvX2NvZGVjczog
bmV3IHB1YmxpYyBmdW5jdGlvbiB0byBmcmVlIHRoZSB0aGUKdmlkZW8gY29kZWMgbGlzdCByZXR1
cm5lZCBieSBzcGljZV9zZXJ2ZXJfZ2V0X3ZpZGVvX2NvZGVjcy4KClNpZ25lZC1vZmYtYnk6IEtl
dmluIFBvdWdldCA8a3BvdWdldEByZWRoYXQuY29tPgotLS0KIHNlcnZlci9kY2MuYyAgICAgICAg
ICAgICB8ICA1ICsrKy0KIHNlcnZlci9yZWRzLmMgICAgICAgICAgICB8IDUyICsrKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysKIHNlcnZlci9yZWRzLmggICAgICAgICAgICB8
ICAyICsrCiBzZXJ2ZXIvc3BpY2Utc2VydmVyLmggICAgfCAxMiArKysrKysrKysrCiBzZXJ2ZXIv
c3BpY2Utc2VydmVyLnN5bXMgfCAgNiArKysrKwogNSBmaWxlcyBjaGFuZ2VkLCA3NiBpbnNlcnRp
b25zKCspLCAxIGRlbGV0aW9uKC0pCgpkaWZmIC0tZ2l0IGEvc2VydmVyL2RjYy5jIGIvc2VydmVy
L2RjYy5jCmluZGV4IDcxZDA5Yjc3Li44MDhlNDI0OCAxMDA2NDQKLS0tIGEvc2VydmVyL2RjYy5j
CisrKyBiL3NlcnZlci9kY2MuYwpAQCAtMTE0MCw3ICsxMTQwLDEwIEBAIHN0YXRpYyB2b2lkIGRj
Y191cGRhdGVfcHJlZmVycmVkX3ZpZGVvX2NvZGVjcyhEaXNwbGF5Q2hhbm5lbENsaWVudCAqZGNj
KQogICAgIG1zZyA9IGdfc3RyaW5nX25ldygiUHJlZmVycmVkIHZpZGVvLWNvZGVjczoiKTsKICAg
ICBmb3IgKGkgPSAwOyBpIDwgdmlkZW9fY29kZWNzLT5sZW47IGkrKykgewogICAgICAgICBSZWRW
aWRlb0NvZGVjIGNvZGVjID0gZ19hcnJheV9pbmRleCh2aWRlb19jb2RlY3MsIFJlZFZpZGVvQ29k
ZWMsIGkpOwotICAgICAgICBnX3N0cmluZ19hcHBlbmRfcHJpbnRmKG1zZywgIiAlZCIsIGNvZGVj
LnR5cGUpOworICAgICAgICBjaGFyICpjb2RlY19uYW1lID0gcmVkc19nZXRfdmlkZW9fY29kZWNf
ZnVsbG5hbWUoJmNvZGVjKTsKKworICAgICAgICBnX3N0cmluZ19hcHBlbmRfcHJpbnRmKG1zZywg
IiVzICIsIGNvZGVjX25hbWUpOworICAgICAgICBnX2ZyZWUoY29kZWNfbmFtZSk7CiAgICAgfQog
ICAgIHNwaWNlX2RlYnVnKCIlcyIsIG1zZy0+c3RyKTsKICAgICBnX3N0cmluZ19mcmVlKG1zZywg
VFJVRSk7CmRpZmYgLS1naXQgYS9zZXJ2ZXIvcmVkcy5jIGIvc2VydmVyL3JlZHMuYwppbmRleCA2
NzFlMGE4Ni4uYTUxZDU3NmUgMTAwNjQ0Ci0tLSBhL3NlcnZlci9yZWRzLmMKKysrIGIvc2VydmVy
L3JlZHMuYwpAQCAtMzcwOCw2ICszNzA4LDE4IEBAIHN0YXRpYyBnYm9vbGVhbiBnZXRfbmFtZV9p
bmRleChjb25zdCBFbnVtTmFtZXMgbmFtZXNbXSwgY29uc3QgY2hhciAqbmFtZSwgdWludDMyCiAg
ICAgcmV0dXJuIEZBTFNFOwogfQoKKy8qIHJldHVybnMgTlVMTCBpZiBpbmRleCBpcyBpbnZhbGlk
LiAqLworc3RhdGljIGNvbnN0IGNoYXIgKmdldF9pbmRleF9uYW1lKGNvbnN0IEVudW1OYW1lcyBu
YW1lc1tdLCB1aW50MzJfdCBpbmRleCkKK3sKKyAgICBpbnQgaTsKKworICAgIGZvciAoaSA9IDA7
IG5hbWVzW2ldLm5hbWUgIT0gTlVMTCAmJiBuYW1lc1tpXS5pZCAhPSBpbmRleDsgaSsrKSB7Cisg
ICAgICAgIGNvbnRpbnVlOworICAgIH0KKworICAgIHJldHVybiBuYW1lc1tpXS5uYW1lOworfQor
CiBzdGF0aWMgY29uc3QgRW51bU5hbWVzIHJlbmRlcmVyX25hbWVzW10gPSB7CiAgICAge1JFRF9S
RU5ERVJFUl9TVywgInN3In0sCiAgICAge1JFRF9SRU5ERVJFUl9JTlZBTElELCBOVUxMfSwKQEAg
LTM3NTUsNiArMzc2NywyNCBAQCBzdGF0aWMgY29uc3QgaW50IHZpZGVvX2NvZGVjX2NhcHNbXSA9
IHsKICAgICBTUElDRV9ESVNQTEFZX0NBUF9DT0RFQ19WUDksCiB9OwoKK2NoYXIgKnJlZHNfZ2V0
X3ZpZGVvX2NvZGVjX2Z1bGxuYW1lKFJlZFZpZGVvQ29kZWMgKmNvZGVjKQoreworICAgIGludCBp
OworICAgIGNvbnN0IGNoYXIgKmVuY29kZXJfbmFtZSA9IE5VTEw7CisgICAgY29uc3QgY2hhciAq
Y29kZWNfbmFtZSA9IGdldF9pbmRleF9uYW1lKHZpZGVvX2NvZGVjX25hbWVzLCBjb2RlYy0+dHlw
ZSk7CisKKyAgICBzcGljZV9hc3NlcnQoY29kZWNfbmFtZSk7CisKKyAgICBmb3IgKGkgPSAwOyBp
IDwgR19OX0VMRU1FTlRTKHZpZGVvX2VuY29kZXJfcHJvY3MpOyBpKyspIHsKKyAgICAgICAgaWYg
KHZpZGVvX2VuY29kZXJfcHJvY3NbaV0gPT0gY29kZWMtPmNyZWF0ZSkgeworICAgICAgICAgICAg
ZW5jb2Rlcl9uYW1lID0gZ2V0X2luZGV4X25hbWUodmlkZW9fZW5jb2Rlcl9uYW1lcywgaSk7Cisg
ICAgICAgICAgICBicmVhazsKKyAgICAgICAgfQorICAgIH0KKyAgICBzcGljZV9hc3NlcnQoZW5j
b2Rlcl9uYW1lKTsKKworICAgIHJldHVybiBnX3N0cmR1cF9wcmludGYoIiVzOiVzIiwgZW5jb2Rl
cl9uYW1lLCBjb2RlY19uYW1lKTsKK30KCiAvKiBQYXJzZXMgdGhlIGdpdmVuIGNvZGVjIHN0cmlu
ZyBhbmQgcmV0dXJucyBuZXdseS1hbGxvY2F0ZWQgc3RyaW5ncyBkZXNjcmliaW5nCiAgKiB0aGUg
bmV4dCBlbmNvZGVyIGFuZCBjb2RlYyBpbiB0aGUgbGlzdC4gVGhlc2Ugc3RyaW5ncyBtdXN0IGJl
IGZyZWVkIGJ5IHRoZQpAQCAtNDE5Niw2ICs0MjI2LDI4IEBAIFNQSUNFX0dOVUNfVklTSUJMRSBp
bnQgc3BpY2Vfc2VydmVyX3NldF92aWRlb19jb2RlY3MoU3BpY2VTZXJ2ZXIgKnJlZHMsIGNvbnN0
IGNoCiAgICAgcmV0dXJuIDA7CiB9CgorU1BJQ0VfR05VQ19WSVNJQkxFIGNvbnN0IGNoYXIgKnNw
aWNlX3NlcnZlcl9nZXRfdmlkZW9fY29kZWNzKFNwaWNlU2VydmVyICpyZWRzKQoreworICAgIEdT
dHJpbmcgKm1zZzsKKyAgICBpbnQgaTsKKyAgICBHQXJyYXkgKnZpZGVvX2NvZGVjcyA9IHJlZHNf
Z2V0X3ZpZGVvX2NvZGVjcyhyZWRzKTsKKworICAgIG1zZyA9IGdfc3RyaW5nX25ldygiIik7Cisg
ICAgZm9yIChpID0gMDsgaSA8IHZpZGVvX2NvZGVjcy0+bGVuOyBpKyspIHsKKyAgICAgICAgUmVk
VmlkZW9Db2RlYyBjb2RlYyA9IGdfYXJyYXlfaW5kZXgodmlkZW9fY29kZWNzLCBSZWRWaWRlb0Nv
ZGVjLCBpKTsKKyAgICAgICAgY2hhciAqY29kZWNfbmFtZSA9IHJlZHNfZ2V0X3ZpZGVvX2NvZGVj
X2Z1bGxuYW1lKCZjb2RlYyk7CisKKyAgICAgICAgZ19zdHJpbmdfYXBwZW5kX3ByaW50Zihtc2cs
ICIlczsiLCBjb2RlY19uYW1lKTsKKyAgICAgICAgZ19mcmVlKGNvZGVjX25hbWUpOworICAgIH0K
KworICAgIHJldHVybiBnX3N0cmluZ19mcmVlKG1zZywgRkFMU0UpOworfQorCitTUElDRV9HTlVD
X1ZJU0lCTEUgdm9pZCBzcGljZV9zZXJ2ZXJfZnJlZV92aWRlb19jb2RlY3MoU3BpY2VTZXJ2ZXIg
KnJlZHMsIGNvbnN0IGNoYXIgKnZpZGVvX2NvZGVjcykgeworICAgIGdfZnJlZSgoY2hhciAqKSB2
aWRlb19jb2RlY3MpOworfQorCiBHQXJyYXkqIHJlZHNfZ2V0X3ZpZGVvX2NvZGVjcyhjb25zdCBS
ZWRzU3RhdGUgKnJlZHMpCiB7CiAgICAgcmV0dXJuIHJlZHMtPmNvbmZpZy0+dmlkZW9fY29kZWNz
OwpkaWZmIC0tZ2l0IGEvc2VydmVyL3JlZHMuaCBiL3NlcnZlci9yZWRzLmgKaW5kZXggOGM1ZWU4
NGQuLmUzMzU1ZjgxIDEwMDY0NAotLS0gYS9zZXJ2ZXIvcmVkcy5oCisrKyBiL3NlcnZlci9yZWRz
LmgKQEAgLTI3LDYgKzI3LDcgQEAKICNpbmNsdWRlICJjaGFyLWRldmljZS5oIgogI2luY2x1ZGUg
InNwaWNlLmgiCiAjaW5jbHVkZSAicmVkLWNoYW5uZWwuaCIKKyNpbmNsdWRlICJ2aWRlby1lbmNv
ZGVyLmgiCiAjaW5jbHVkZSAibWFpbi1kaXNwYXRjaGVyLmgiCiAjaW5jbHVkZSAibWlncmF0aW9u
LXByb3RvY29sLmgiCgpAQCAtNTQsNiArNTUsNyBAQCB2b2lkIHJlZHNfc2VuZF9kZXZpY2VfZGlz
cGxheV9pbmZvKFJlZHNTdGF0ZSAqcmVkcyk7CiB2b2lkIHJlZHNfaGFuZGxlX2FnZW50X21vdXNl
X2V2ZW50KFJlZHNTdGF0ZSAqcmVkcywgY29uc3QgVkRBZ2VudE1vdXNlU3RhdGUgKm1vdXNlX3N0
YXRlKTsgLy8gdXNlZCBieSBpbnB1dHNfY2hhbm5lbAoKIEdBcnJheSogcmVkc19nZXRfcmVuZGVy
ZXJzKFJlZHNTdGF0ZSAqcmVkcyk7CitjaGFyICpyZWRzX2dldF92aWRlb19jb2RlY19mdWxsbmFt
ZShSZWRWaWRlb0NvZGVjICpjb2RlYyk7CgogZW51bSB7CiAgICAgUkVEX1JFTkRFUkVSX0lOVkFM
SUQsCmRpZmYgLS1naXQgYS9zZXJ2ZXIvc3BpY2Utc2VydmVyLmggYi9zZXJ2ZXIvc3BpY2Utc2Vy
dmVyLmgKaW5kZXggNWY1NzJmNGYuLjQ4MWQ1MTk0IDEwMDY0NAotLS0gYS9zZXJ2ZXIvc3BpY2Ut
c2VydmVyLmgKKysrIGIvc2VydmVyL3NwaWNlLXNlcnZlci5oCkBAIC0xMzYsNiArMTM2LDE4IEBA
IGVudW0gewogfTsKCiBpbnQgc3BpY2Vfc2VydmVyX3NldF92aWRlb19jb2RlY3MoU3BpY2VTZXJ2
ZXIgKnMsIGNvbnN0IGNoYXIqIHZpZGVvX2NvZGVjcyk7CisvKiBSZXR1cm5zIGEgbmV3bHkgYWxs
b2NhdGVkIHN0cmluZyBkZXNjcmliaW5nIHZpZGVvIGVuY29kZXJzL2NvZGVjcworICogY3VycmVu
dGx5IGFsbG93ZWQgaW4gQHJlZHMgU3BpY2Ugc2VydmVyLiBUaGUgc3RyaW5nIHJldHVybmVkIGJ5
CisgKiB0aGlzIGZ1bmN0aW9uIG11c3QgYmUgcmVsZWFzZWQgd2l0aCBzcGljZV9zZXJ2ZXJfZnJl
ZV92aWRlb19jb2RlY3MuCisgKgorICogQHJlZHM6IHRoZSBTcGljZSBzZXJ2ZXIgdG8gcXVlcnkK
KyAqIEByZXR1cm4gdGhlIHN0cmluZyBkZXNjcmliaW5nIHRoZSB2aWRlbyBlbmNvZGVycy9jb2Rl
Y3MgY3VycmVudGx5IGVuYWJsZWQKKyAqLworY29uc3QgY2hhciAqc3BpY2Vfc2VydmVyX2dldF92
aWRlb19jb2RlY3MoU3BpY2VTZXJ2ZXIgKnMpOworLyogUmVsZWFzZXMgdGhlIG1lbW9yeSBvZiB0
aGUgdmlkZW8tY29kZWMgc3RyaW5nIHJldHVybmVkIGJ5CisgKiBzcGljZV9zZXJ2ZXJfZ2V0X3Zp
ZGVvX2NvZGVjcy4KKyAqICovCit2b2lkIHNwaWNlX3NlcnZlcl9mcmVlX3ZpZGVvX2NvZGVjcyhT
cGljZVNlcnZlciAqcmVkcywgY29uc3QgY2hhciAqdmlkZW9fY29kZWNzKTsKIGludCBzcGljZV9z
ZXJ2ZXJfc2V0X3BsYXliYWNrX2NvbXByZXNzaW9uKFNwaWNlU2VydmVyICpzLCBpbnQgZW5hYmxl
KTsKIGludCBzcGljZV9zZXJ2ZXJfc2V0X2FnZW50X21vdXNlKFNwaWNlU2VydmVyICpzLCBpbnQg
ZW5hYmxlKTsKIGludCBzcGljZV9zZXJ2ZXJfc2V0X2FnZW50X2NvcHlwYXN0ZShTcGljZVNlcnZl
ciAqcywgaW50IGVuYWJsZSk7CmRpZmYgLS1naXQgYS9zZXJ2ZXIvc3BpY2Utc2VydmVyLnN5bXMg
Yi9zZXJ2ZXIvc3BpY2Utc2VydmVyLnN5bXMKaW5kZXggYWM0ZDliMTQuLmUzMzUyNmYzIDEwMDY0
NAotLS0gYS9zZXJ2ZXIvc3BpY2Utc2VydmVyLnN5bXMKKysrIGIvc2VydmVyL3NwaWNlLXNlcnZl
ci5zeW1zCkBAIC0xNzgsMyArMTc4LDkgQEAgU1BJQ0VfU0VSVkVSXzAuMTQuMiB7CiBnbG9iYWw6
CiAgICAgc3BpY2VfcXhsX3NldF9kZXZpY2VfaW5mbzsKIH0gU1BJQ0VfU0VSVkVSXzAuMTMuMjsK
KworU1BJQ0VfU0VSVkVSXzAuMTQuMyB7CitnbG9iYWw6CisgICAgc3BpY2Vfc2VydmVyX2dldF92
aWRlb19jb2RlY3M7CisgICAgc3BpY2Vfc2VydmVyX2ZyZWVfdmlkZW9fY29kZWNzOworfSBTUElD
RV9TRVJWRVJfMC4xNC4yOwotLQoyLjIxLjAKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX18KU3BpY2UtZGV2ZWwgbWFpbGluZyBsaXN0ClNwaWNlLWRldmVsQGxp
c3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFu
L2xpc3RpbmZvL3NwaWNlLWRldmVs
