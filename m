Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id C5A895542C
	for <lists+spice-devel@lfdr.de>; Tue, 25 Jun 2019 18:12:27 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 0A1D96E193;
	Tue, 25 Jun 2019 16:12:26 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id A5F026E192
 for <spice-devel@lists.freedesktop.org>; Tue, 25 Jun 2019 16:12:24 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx05.intmail.prod.int.phx2.redhat.com
 [10.5.11.15])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id 50E2A309B153
 for <spice-devel@lists.freedesktop.org>; Tue, 25 Jun 2019 16:12:24 +0000 (UTC)
Received: from fziglio.remote.csb (unknown [10.33.32.4])
 by smtp.corp.redhat.com (Postfix) with ESMTP id 9AB675D70D;
 Tue, 25 Jun 2019 16:12:23 +0000 (UTC)
From: Frediano Ziglio <fziglio@redhat.com>
To: spice-devel@lists.freedesktop.org
Date: Tue, 25 Jun 2019 17:11:45 +0100
Message-Id: <20190625161147.25211-22-fziglio@redhat.com>
In-Reply-To: <20190625161147.25211-1-fziglio@redhat.com>
References: <20190625161147.25211-1-fziglio@redhat.com>
MIME-Version: 1.0
X-Scanned-By: MIMEDefang 2.79 on 10.5.11.15
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16
 (mx1.redhat.com [10.5.110.49]); Tue, 25 Jun 2019 16:12:24 +0000 (UTC)
Subject: [Spice-devel] [PATCH spice-server 21/23] websocket: Handle text data
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

QWxsb3dzIHRvIHNwZWNpZnkgYW5kIGdldCBmcmFtZSB0eXBlLgpUeXBlIGFuZCBmbGFncyBhcmUg
cmV0dXJuZWQgY2FsbGluZyB3ZWJzb2NrZXRfcmVhZCBhbmQgcmV0dXJuZWQKY2FsbGluZyB3ZWJz
b2NrZXRfd3JpdGUgb3Igd2Vic29ja2V0X3dyaXRldi4KClNpZ25lZC1vZmYtYnk6IEZyZWRpYW5v
IFppZ2xpbyA8ZnppZ2xpb0ByZWRoYXQuY29tPgotLS0KIHNlcnZlci9yZWQtc3RyZWFtLmMgICAg
ICAgICAgIHwgMTIgKysrKysrKysrLS0tCiBzZXJ2ZXIvdGVzdHMvdGVzdC13ZWJzb2NrZXQuYyB8
ICA2ICsrKystLQogc2VydmVyL3dlYnNvY2tldC5jICAgICAgICAgICAgfCAyOCArKysrKysrKysr
KysrKysrKystLS0tLS0tLS0tCiBzZXJ2ZXIvd2Vic29ja2V0LmggICAgICAgICAgICB8IDIwICsr
KysrKysrKysrKysrKysrLS0tCiA0IGZpbGVzIGNoYW5nZWQsIDQ4IGluc2VydGlvbnMoKyksIDE4
IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL3NlcnZlci9yZWQtc3RyZWFtLmMgYi9zZXJ2ZXIv
cmVkLXN0cmVhbS5jCmluZGV4IDFlMDEwM2IwOC4uMDRiZTNhZjM3IDEwMDY0NAotLS0gYS9zZXJ2
ZXIvcmVkLXN0cmVhbS5jCisrKyBiL3NlcnZlci9yZWQtc3RyZWFtLmMKQEAgLTExNjMsMTcgKzEx
NjMsMjMgQEAgZXJyb3I6CiAKIHN0YXRpYyBzc2l6ZV90IHN0cmVhbV93ZWJzb2NrZXRfcmVhZChS
ZWRTdHJlYW0gKnMsIHZvaWQgKmJ1Ziwgc2l6ZV90IHNpemUpCiB7Ci0gICAgcmV0dXJuIHdlYnNv
Y2tldF9yZWFkKHMtPnByaXYtPndzLCBidWYsIHNpemUpOworICAgIHVuc2lnbmVkIGZsYWdzOwor
ICAgIGludCBsZW47CisKKyAgICBkbyB7CisgICAgICAgIGxlbiA9IHdlYnNvY2tldF9yZWFkKHMt
PnByaXYtPndzLCBidWYsIHNpemUsICZmbGFncyk7CisgICAgfSB3aGlsZSAobGVuID09IDAgJiYg
ZmxhZ3MgIT0gMCk7CisgICAgcmV0dXJuIGxlbjsKIH0KIAogc3RhdGljIHNzaXplX3Qgc3RyZWFt
X3dlYnNvY2tldF93cml0ZShSZWRTdHJlYW0gKnMsIGNvbnN0IHZvaWQgKmJ1Ziwgc2l6ZV90IHNp
emUpCiB7Ci0gICAgcmV0dXJuIHdlYnNvY2tldF93cml0ZShzLT5wcml2LT53cywgYnVmLCBzaXpl
KTsKKyAgICByZXR1cm4gd2Vic29ja2V0X3dyaXRlKHMtPnByaXYtPndzLCBidWYsIHNpemUsIFdF
QlNPQ0tFVF9CSU5BUllfRklOQUwpOwogfQogCiBzdGF0aWMgc3NpemVfdCBzdHJlYW1fd2Vic29j
a2V0X3dyaXRldihSZWRTdHJlYW0gKnMsIGNvbnN0IHN0cnVjdCBpb3ZlYyAqaW92LCBpbnQgaW92
Y250KQogewotICAgIHJldHVybiB3ZWJzb2NrZXRfd3JpdGV2KHMtPnByaXYtPndzLCAoc3RydWN0
IGlvdmVjICopIGlvdiwgaW92Y250KTsKKyAgICByZXR1cm4gd2Vic29ja2V0X3dyaXRldihzLT5w
cml2LT53cywgKHN0cnVjdCBpb3ZlYyAqKSBpb3YsIGlvdmNudCwgV0VCU09DS0VUX0JJTkFSWV9G
SU5BTCk7CiB9CiAKIC8qCmRpZmYgLS1naXQgYS9zZXJ2ZXIvdGVzdHMvdGVzdC13ZWJzb2NrZXQu
YyBiL3NlcnZlci90ZXN0cy90ZXN0LXdlYnNvY2tldC5jCmluZGV4IDY1OTZjMjdlZi4uMTIwYTUy
MmYxIDEwMDY0NAotLS0gYS9zZXJ2ZXIvdGVzdHMvdGVzdC13ZWJzb2NrZXQuYworKysgYi9zZXJ2
ZXIvdGVzdHMvdGVzdC13ZWJzb2NrZXQuYwpAQCAtMjIwLDYgKzIyMCw3IEBAIGhhbmRsZV9jbGll
bnQoaW50IG5ld19zb2NrKQogCiAgICAgY2hhciBidWZmZXJbNDA5Nl07CiAgICAgc2l6ZV90IHRv
X3NlbmQgPSAwOworICAgIHVuc2lnbmVkIHdzX2ZsYWdzID0gV0VCU09DS0VUX0JJTkFSWV9GSU5B
TDsKICAgICB3aGlsZSAoIWdvdF90ZXJtKSB7CiAgICAgICAgIGludCBldmVudHMgPSAwOwogICAg
ICAgICBpZiAoc2l6ZW9mKGJ1ZmZlcikgPiB0b19zZW5kKSB7CkBAIC0yMzEsNyArMjMyLDggQEAg
aGFuZGxlX2NsaWVudChpbnQgbmV3X3NvY2spCiAgICAgICAgIGV2ZW50cyA9IHdhaXRfZm9yKG5l
d19zb2NrLCBldmVudHMpOwogICAgICAgICBpZiAoZXZlbnRzICYgUE9MTElOKSB7CiAgICAgICAg
ICAgICBhc3NlcnQoc2l6ZW9mKGJ1ZmZlcikgPiB0b19zZW5kKTsKLSAgICAgICAgICAgIGludCBz
aXplID0gd2Vic29ja2V0X3JlYWQod3MsICh2b2lkICopIChidWZmZXIgKyB0b19zZW5kKSwgc2l6
ZW9mKGJ1ZmZlcikgLSB0b19zZW5kKTsKKyAgICAgICAgICAgIGludCBzaXplID0gd2Vic29ja2V0
X3JlYWQod3MsICh2b2lkICopIChidWZmZXIgKyB0b19zZW5kKSwgc2l6ZW9mKGJ1ZmZlcikgLSB0
b19zZW5kLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmd3NfZmxhZ3Mp
OwogCiAgICAgICAgICAgICBpZiAoc2l6ZSA8IDApIHsKICAgICAgICAgICAgICAgICBpZiAoZXJy
bm8gPT0gRUlPKSB7CkBAIC0yNTQsNyArMjU2LDcgQEAgaGFuZGxlX2NsaWVudChpbnQgbmV3X3Nv
Y2spCiAgICAgICAgIH0KIAogICAgICAgICBpZiAoZXZlbnRzICYgUE9MTE9VVCkgewotICAgICAg
ICAgICAgaW50IHNpemUgPSB3ZWJzb2NrZXRfd3JpdGUod3MsIGJ1ZmZlciwgdG9fc2VuZCk7Cisg
ICAgICAgICAgICBpbnQgc2l6ZSA9IHdlYnNvY2tldF93cml0ZSh3cywgYnVmZmVyLCB0b19zZW5k
LCB3c19mbGFncyk7CiAKICAgICAgICAgICAgIGlmIChzaXplIDwgMCkgewogICAgICAgICAgICAg
ICAgIHN3aXRjaCAoZXJybm8pIHsKZGlmZiAtLWdpdCBhL3NlcnZlci93ZWJzb2NrZXQuYyBiL3Nl
cnZlci93ZWJzb2NrZXQuYwppbmRleCA1MTRlNzJjOTYuLmUwNzY2NDVkMyAxMDA2NDQKLS0tIGEv
c2VydmVyL3dlYnNvY2tldC5jCisrKyBiL3NlcnZlci93ZWJzb2NrZXQuYwpAQCAtMzEzLDEyICsz
MTMsMTQgQEAgc3RhdGljIHZvaWQgcmVsYXlfZGF0YSh1aW50OF90KiBidWYsIHNpemVfdCBzaXpl
LCB3ZWJzb2NrZXRfZnJhbWVfdCAqZnJhbWUpCiAgICAgfQogfQogCi1pbnQgd2Vic29ja2V0X3Jl
YWQoUmVkc1dlYlNvY2tldCAqd3MsIHVpbnQ4X3QgKmJ1Ziwgc2l6ZV90IHNpemUpCitpbnQgd2Vi
c29ja2V0X3JlYWQoUmVkc1dlYlNvY2tldCAqd3MsIHVpbnQ4X3QgKmJ1Ziwgc2l6ZV90IHNpemUs
IHVuc2lnbmVkICpmbGFncykKIHsKICAgICBpbnQgbiA9IDA7CiAgICAgaW50IHJjOwogICAgIHdl
YnNvY2tldF9mcmFtZV90ICpmcmFtZSA9ICZ3cy0+cmVhZF9mcmFtZTsKIAorICAgICpmbGFncyA9
IDA7CisKICAgICBpZiAod3MtPmNsb3NlZCB8fCB3cy0+Y2xvc2VfcGVuZGluZykgewogICAgICAg
ICAvKiB0aGlzIGF2b2lkcyBpbmZpbml0ZSBsb29wIGluIHRoZSBjYXNlIGNvbm5lY3Rpb24gaXMg
c3RpbGwgb3BlbiBhbmQgd2UgaGF2ZQogICAgICAgICAgKiBwZW5kaW5nIGRhdGEgKi8KQEAgLTM1
NSwxMyArMzU3LDE1IEBAIGludCB3ZWJzb2NrZXRfcmVhZChSZWRzV2ViU29ja2V0ICp3cywgdWlu
dDhfdCAqYnVmLCBzaXplX3Qgc2l6ZSkKICAgICAgICAgICAgIHdlYnNvY2tldF9jbGVhcl9mcmFt
ZShmcmFtZSk7CiAgICAgICAgICAgICBzZW5kX3BlbmRpbmdfZGF0YSh3cyk7CiAgICAgICAgICAg
ICByZXR1cm4gMDsKLSAgICAgICAgfSBlbHNlIGlmIChmcmFtZS0+dHlwZSA9PSBCSU5BUllfRlJB
TUUpIHsKKyAgICAgICAgfSBlbHNlIGlmIChmcmFtZS0+dHlwZSA9PSBCSU5BUllfRlJBTUUgfHwg
ZnJhbWUtPnR5cGUgPT0gVEVYVF9GUkFNRSkgewogICAgICAgICAgICAgcmMgPSB3cy0+cmF3X3Jl
YWQod3MtPnJhd19zdHJlYW0sIGJ1ZiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1J
TihzaXplLCBmcmFtZS0+ZXhwZWN0ZWRfbGVuIC0gZnJhbWUtPnJlbGF5ZWQpKTsKICAgICAgICAg
ICAgIGlmIChyYyA8PSAwKSB7CiAgICAgICAgICAgICAgICAgZ290byByZWFkX2Vycm9yOwogICAg
ICAgICAgICAgfQogCisgICAgICAgICAgICAqZmxhZ3MgPSBmcmFtZS0+dHlwZTsKKwogICAgICAg
ICAgICAgcmVsYXlfZGF0YShidWYsIHJjLCBmcmFtZSk7CiAgICAgICAgICAgICBuICs9IHJjOwog
ICAgICAgICAgICAgYnVmICs9IHJjOwpAQCAtNDA2LDYgKzQxMCw5IEBAIGludCB3ZWJzb2NrZXRf
cmVhZChSZWRzV2ViU29ja2V0ICp3cywgdWludDhfdCAqYnVmLCBzaXplX3Qgc2l6ZSkKICAgICAg
ICAgZnJhbWUtPnJlbGF5ZWQgKz0gcmM7CiAgICAgICAgIGlmIChmcmFtZS0+cmVsYXllZCA+PSBm
cmFtZS0+ZXhwZWN0ZWRfbGVuKSB7CiAgICAgICAgICAgICB3ZWJzb2NrZXRfY2xlYXJfZnJhbWUo
ZnJhbWUpOworICAgICAgICAgICAgaWYgKG4pIHsKKyAgICAgICAgICAgICAgICBicmVhazsKKyAg
ICAgICAgICAgIH0KICAgICAgICAgfQogICAgIH0KIApAQCAtNDIxLDEyICs0MjgsMTMgQEAgcmVh
ZF9lcnJvcjoKICAgICByZXR1cm4gcmM7CiB9CiAKLXN0YXRpYyBpbnQgZmlsbF9oZWFkZXIodWlu
dDhfdCAqaGVhZGVyLCB1aW50NjRfdCBsZW4pCitzdGF0aWMgaW50IGZpbGxfaGVhZGVyKHVpbnQ4
X3QgKmhlYWRlciwgdWludDY0X3QgbGVuLCB1aW50OF90IHR5cGUpCiB7CiAgICAgaW50IHVzZWQg
PSAwOwogICAgIGludCBpOwogCi0gICAgaGVhZGVyWzBdID0gRklOX0ZMQUcgfCBCSU5BUllfRlJB
TUU7CisgICAgdHlwZSAmPSBUWVBFX01BU0s7CisgICAgaGVhZGVyWzBdID0gRklOX0ZMQUcgfCAo
dHlwZSA/IHR5cGUgOiBCSU5BUllfRlJBTUUpOwogICAgIHVzZWQrKzsKIAogICAgIGhlYWRlclsx
XSA9IDA7CkBAIC00OTcsMTQgKzUwNSwxNCBAQCBzdGF0aWMgaW50IHNlbmRfZGF0YV9oZWFkZXJf
bGVmdChSZWRzV2ViU29ja2V0ICp3cykKICAgICByZXR1cm4gLTE7CiB9CiAKLXN0YXRpYyBpbnQg
c2VuZF9kYXRhX2hlYWRlcihSZWRzV2ViU29ja2V0ICp3cywgdWludDY0X3QgbGVuKQorc3RhdGlj
IGludCBzZW5kX2RhdGFfaGVhZGVyKFJlZHNXZWJTb2NrZXQgKndzLCB1aW50NjRfdCBsZW4sIHVp
bnQ4X3QgdHlwZSkKIHsKICAgICBzcGljZV9hc3NlcnQod3MtPndyaXRlX2hlYWRlcl9wb3MgPj0g
d3MtPndyaXRlX2hlYWRlcl9sZW4pOwogICAgIHNwaWNlX2Fzc2VydCh3cy0+d3JpdGVfcmVtYWlu
ZGVyID09IDApOwogCiAgICAgLyogZmlsbCBhIG5ldyBoZWFkZXIgKi8KICAgICB3cy0+d3JpdGVf
aGVhZGVyX3BvcyA9IDA7Ci0gICAgd3MtPndyaXRlX2hlYWRlcl9sZW4gPSBmaWxsX2hlYWRlcih3
cy0+d3JpdGVfaGVhZGVyLCBsZW4pOworICAgIHdzLT53cml0ZV9oZWFkZXJfbGVuID0gZmlsbF9o
ZWFkZXIod3MtPndyaXRlX2hlYWRlciwgbGVuLCB0eXBlKTsKIAogICAgIHJldHVybiBzZW5kX2Rh
dGFfaGVhZGVyX2xlZnQod3MpOwogfQpAQCAtNTU3LDcgKzU2NSw3IEBAIHN0YXRpYyBpbnQgc2Vu
ZF9wZW5kaW5nX2RhdGEoUmVkc1dlYlNvY2tldCAqd3MpCiB9CiAKIC8qIFdyaXRlIGEgV2ViU29j
a2V0IGZyYW1lIHdpdGggdGhlIGVuY2xvc2VkIGRhdGEgb3V0LiAqLwotaW50IHdlYnNvY2tldF93
cml0ZXYoUmVkc1dlYlNvY2tldCAqd3MsIGNvbnN0IHN0cnVjdCBpb3ZlYyAqaW92LCBpbnQgaW92
Y250KQoraW50IHdlYnNvY2tldF93cml0ZXYoUmVkc1dlYlNvY2tldCAqd3MsIGNvbnN0IHN0cnVj
dCBpb3ZlYyAqaW92LCBpbnQgaW92Y250LCB1bnNpZ25lZCBmbGFncykKIHsKICAgICB1aW50NjRf
dCBsZW47CiAgICAgaW50IHJjOwpAQCAtNTk1LDcgKzYwMyw3IEBAIGludCB3ZWJzb2NrZXRfd3Jp
dGV2KFJlZHNXZWJTb2NrZXQgKndzLCBjb25zdCBzdHJ1Y3QgaW92ZWMgKmlvdiwgaW50IGlvdmNu
dCkKICAgICB9CiAKICAgICB3cy0+d3JpdGVfaGVhZGVyX3BvcyA9IDA7Ci0gICAgd3MtPndyaXRl
X2hlYWRlcl9sZW4gPSBmaWxsX2hlYWRlcih3cy0+d3JpdGVfaGVhZGVyLCBsZW4pOworICAgIHdz
LT53cml0ZV9oZWFkZXJfbGVuID0gZmlsbF9oZWFkZXIod3MtPndyaXRlX2hlYWRlciwgbGVuLCBm
bGFncyk7CiAgICAgaW92X291dFswXS5pb3ZfbGVuID0gd3MtPndyaXRlX2hlYWRlcl9sZW47CiAg
ICAgaW92X291dFswXS5pb3ZfYmFzZSA9IHdzLT53cml0ZV9oZWFkZXI7CiAgICAgcmMgPSB3cy0+
cmF3X3dyaXRldih3cy0+cmF3X3N0cmVhbSwgaW92X291dCwgaW92X291dF9jbnQpOwpAQCAtNjIy
LDcgKzYzMCw3IEBAIGludCB3ZWJzb2NrZXRfd3JpdGV2KFJlZHNXZWJTb2NrZXQgKndzLCBjb25z
dCBzdHJ1Y3QgaW92ZWMgKmlvdiwgaW50IGlvdmNudCkKICAgICByZXR1cm4gcmM7CiB9CiAKLWlu
dCB3ZWJzb2NrZXRfd3JpdGUoUmVkc1dlYlNvY2tldCAqd3MsIGNvbnN0IHZvaWQgKmJ1Ziwgc2l6
ZV90IGxlbikKK2ludCB3ZWJzb2NrZXRfd3JpdGUoUmVkc1dlYlNvY2tldCAqd3MsIGNvbnN0IHZv
aWQgKmJ1Ziwgc2l6ZV90IGxlbiwgdW5zaWduZWQgZmxhZ3MpCiB7CiAgICAgaW50IHJjOwogCkBA
IC02MzYsNyArNjQ0LDcgQEAgaW50IHdlYnNvY2tldF93cml0ZShSZWRzV2ViU29ja2V0ICp3cywg
Y29uc3Qgdm9pZCAqYnVmLCBzaXplX3QgbGVuKQogICAgICAgICByZXR1cm4gcmM7CiAgICAgfQog
ICAgIGlmICh3cy0+d3JpdGVfcmVtYWluZGVyID09IDApIHsKLSAgICAgICAgcmMgPSBzZW5kX2Rh
dGFfaGVhZGVyKHdzLCBsZW4pOworICAgICAgICByYyA9IHNlbmRfZGF0YV9oZWFkZXIod3MsIGxl
biwgZmxhZ3MpOwogICAgICAgICBpZiAocmMgPD0gMCkgewogICAgICAgICAgICAgcmV0dXJuIHJj
OwogICAgICAgICB9CmRpZmYgLS1naXQgYS9zZXJ2ZXIvd2Vic29ja2V0LmggYi9zZXJ2ZXIvd2Vi
c29ja2V0LmgKaW5kZXggYjU4NmUzMDM1Li4yMjEyMGQ5MzkgMTAwNjQ0Ci0tLSBhL3NlcnZlci93
ZWJzb2NrZXQuaAorKysgYi9zZXJ2ZXIvd2Vic29ja2V0LmgKQEAgLTIxLDkgKzIxLDIzIEBAIHR5
cGVkZWYgc3NpemVfdCAoKndlYnNvY2tldF93cml0ZXZfY2JfdCkodm9pZCAqb3BhcXVlLCBzdHJ1
Y3QgaW92ZWMgKmlvdiwgaW50IGlvCiAKIHR5cGVkZWYgc3RydWN0IFJlZHNXZWJTb2NrZXQgUmVk
c1dlYlNvY2tldDsKIAorZW51bSB7CisgICAgV0VCU09DS0VUX1RFWFQgPSAxLAorICAgIFdFQlNP
Q0tFVF9CSU5BUlk9IDIsCisgICAgV0VCU09DS0VUX0ZJTkFMID0gMHg4MCwKKyAgICBXRUJTT0NL
RVRfVEVYVF9GSU5BTCA9IFdFQlNPQ0tFVF9URVhUIHwgV0VCU09DS0VUX0ZJTkFMLAorICAgIFdF
QlNPQ0tFVF9CSU5BUllfRklOQUwgPSBXRUJTT0NLRVRfQklOQVJZIHwgV0VCU09DS0VUX0ZJTkFM
LAorfTsKKwogUmVkc1dlYlNvY2tldCAqd2Vic29ja2V0X25ldyhjb25zdCB2b2lkICpidWYsIHNp
emVfdCBsZW4sIHZvaWQgKnN0cmVhbSwgd2Vic29ja2V0X3JlYWRfY2JfdCByZWFkX2NiLAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICB3ZWJzb2NrZXRfd3JpdGVfY2JfdCB3cml0ZV9jYiwg
d2Vic29ja2V0X3dyaXRldl9jYl90IHdyaXRldl9jYik7CiB2b2lkIHdlYnNvY2tldF9mcmVlKFJl
ZHNXZWJTb2NrZXQgKndzKTsKLWludCB3ZWJzb2NrZXRfcmVhZChSZWRzV2ViU29ja2V0ICp3cywg
dWludDhfdCAqYnVmLCBzaXplX3QgbGVuKTsKLWludCB3ZWJzb2NrZXRfd3JpdGUoUmVkc1dlYlNv
Y2tldCAqd3MsIGNvbnN0IHZvaWQgKmJ1Ziwgc2l6ZV90IGxlbik7Ci1pbnQgd2Vic29ja2V0X3dy
aXRldihSZWRzV2ViU29ja2V0ICp3cywgY29uc3Qgc3RydWN0IGlvdmVjICppb3YsIGludCBpb3Zj
bnQpOworCisvKioKKyAqIFJlYWQgZGF0YSBmcm9tIHdlYnNvY2tldC4KKyAqIENhbiByZXR1cm4g
MCBpbiBjYXNlIGNsaWVudCBzZW50IGFuIGVtcHR5IHRleHQvYmluYXJ5IGRhdGEsIGNoZWNrCisg
KiBmbGFncyB0byBkZXRlY3QgdGhpcy4KKyAqLworaW50IHdlYnNvY2tldF9yZWFkKFJlZHNXZWJT
b2NrZXQgKndzLCB1aW50OF90ICpidWYsIHNpemVfdCBsZW4sIHVuc2lnbmVkICpmbGFncyk7Citp
bnQgd2Vic29ja2V0X3dyaXRlKFJlZHNXZWJTb2NrZXQgKndzLCBjb25zdCB2b2lkICpidWYsIHNp
emVfdCBsZW4sIHVuc2lnbmVkIGZsYWdzKTsKK2ludCB3ZWJzb2NrZXRfd3JpdGV2KFJlZHNXZWJT
b2NrZXQgKndzLCBjb25zdCBzdHJ1Y3QgaW92ZWMgKmlvdiwgaW50IGlvdmNudCwgdW5zaWduZWQg
ZmxhZ3MpOwotLSAKMi4yMC4xCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fXwpTcGljZS1kZXZlbCBtYWlsaW5nIGxpc3QKU3BpY2UtZGV2ZWxAbGlzdHMuZnJl
ZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGlu
Zm8vc3BpY2UtZGV2ZWw=
