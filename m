Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id B1D2050F85
	for <lists+spice-devel@lfdr.de>; Mon, 24 Jun 2019 17:02:43 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 41D7389C2C;
	Mon, 24 Jun 2019 15:02:42 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mail-io1-xd2c.google.com (mail-io1-xd2c.google.com
 [IPv6:2607:f8b0:4864:20::d2c])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 1ED9589C2C
 for <spice-devel@lists.freedesktop.org>; Mon, 24 Jun 2019 15:02:40 +0000 (UTC)
Received: by mail-io1-xd2c.google.com with SMTP id e3so2304762ioc.12
 for <spice-devel@lists.freedesktop.org>; Mon, 24 Jun 2019 08:02:40 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc;
 bh=+Pp2ZzuaL6BrpDIDqxhH7XXe/8y4HiN6WLZQdh1E7f8=;
 b=sNl4x7532oS0Q5MbmUUVBUoS0U5q/As5qRRPXeo3nRYOi7n0PoKLU9aZT1XmMKCXgv
 Rw+1WWiFy0m/FGPdoXwhcDUo68tvcNTighQDbr1c1/0xJzvWg+K0HWjRkndHeQrTHFy3
 9ycXpkaXztJZtDJZr2RWRz6XNG04YTqG1G2Y1GoMO5UxH0bYp/goqNiKlxDq+w2ykvpj
 mpvfQHO3RAg6K36+2JSJ26NjQ+keMFVEhguOO/KYvv1XbKW3rlK6zf/63Z3dk41J+UVY
 6hLfsbp1DBsmOfskjFpq9NJy/Ciu0bCMVYLpHF8BH0PguYCj6fwF5jNz21cHTWv2bVfH
 v2PQ==
X-Gm-Message-State: APjAAAXQRM9L0vuT+fsFHyYeBBk9hkEj2M+cKauoBWo6AGf8bgds8tSy
 ablLpUkRqfoG3EACilKa25aCHH7w/08zZZoCpXwtiQ==
X-Google-Smtp-Source: APXvYqzz29FwkLp1+lZPO7Ffow6k7sm3xI3e/27r79tXAJ43PjoCPB3EkE4R4UDvPz56gRtEEr/4pYa5EcHQr2fdMPo=
X-Received: by 2002:a02:13c3:: with SMTP id 186mr40305926jaz.30.1561388558352; 
 Mon, 24 Jun 2019 08:02:38 -0700 (PDT)
MIME-Version: 1.0
References: <20190410193139.10912-1-yuri.benditovich@daynix.com>
 <20190410193139.10912-3-yuri.benditovich@daynix.com>
 <20190610104820.lyydy6rmbroobb5x@toolbox>
In-Reply-To: <20190610104820.lyydy6rmbroobb5x@toolbox>
From: Yuri Benditovich <yuri.benditovich@daynix.com>
Date: Mon, 24 Jun 2019 18:02:23 +0300
Message-ID: <CAOEp5Od5vXhdPF2L+6dH-Et2Sv_pc_LxsSFfREdN2jyukoeNcg@mail.gmail.com>
To: Victor Toso <victortoso@redhat.com>
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=daynix-com.20150623.gappssmtp.com; s=20150623;
 h=mime-version:references:in-reply-to:from:date:message-id:subject:to
 :cc;
 bh=+Pp2ZzuaL6BrpDIDqxhH7XXe/8y4HiN6WLZQdh1E7f8=;
 b=BuVksMRuXGaFb9UFPM6/1qR8r+d00sMZvpjt7stIp9+FaTmWeVt4b/nzp8Fdo5nOwB
 awqGugbA6i0ssR9RcLrdWDqjLx3raIhIbx2MxAKF2GaSAdLA4/XntHPnTxf/2SNQJKMK
 JPRgVsQ6VriEdrAkLiSeld3iA7qJWtBPCbb4vdJldhuZvVubfurD5QhhiVXK1vrk5hqW
 zrxAfLfwgb5ZfUZRNwfBYelZLShpY3U+0Wq1GunPqj3z2Lm0P2QT+6NKmhqg31T+b7zH
 ORYd/b8rQQ7FqKtUBoL9Xd45RDruHUG7Nj/VQnWeRWuPS9B4dItNCdvy6HnrTNo/Qovh
 uOtw==
Subject: Re: [Spice-devel] [PATCH 2/3] usb-redirection: isolate usage of
 libusb and usbredirhost
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Yan Vugenfirer <yan@daynix.com>,
 Spice List <spice-devel@lists.freedesktop.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

T24gTW9uLCBKdW4gMTAsIDIwMTkgYXQgMTo0OCBQTSBWaWN0b3IgVG9zbyA8dmljdG9ydG9zb0By
ZWRoYXQuY29tPiB3cm90ZToKPgo+IEhpLAo+Cj4gS2VlcGluZyB0aGUgY2hhdCBhcyB5b3UgbWln
aHQgZW5qb3kgdGhlbiwgaW4gb3JkZXIgdG8gbWVyZ2UgdGhpcwo+IHBhdGNoZXM6Cj4KPiBPbiBX
ZWQsIEFwciAxMCwgMjAxOSBhdCAxMDozMTozOFBNICswMzAwLCBZdXJpIEJlbmRpdG92aWNoIHdy
b3RlOgo+ID4gQXMgYSBzdGVwIHRvd2FyZCBwb3NzaWJpbGl0eSB0byBwcmVzZW50IGVtdWxhdGVk
IFVTQiBkZXZpY2VzCj4gPiB0byB0aGUgZ3Vlc3QsIHdlIHJlbW92ZSB0aGUga25vd2xlZGdlIGFi
b3V0IGxpYnVzYiBhbmQKPiA+IHVzYnJlZGlyaG9zdCAod2hpY2ggZGVwZW5kcyBvbiBsaWJ1c2Ip
IGZyb20gYWxsIHRoZSBtb2R1bGVzCj4gPiBhbmQgY29uY2VudHJhdGUgaXQgaW4gb25lICh1c2Ig
YmFja2VuZCkgd2hpY2ggcHJlc2VudHMKPiA+IGFic3RyYWN0IFVTQiBvYmplY3RzIGFuZCBpbnRl
cm5hbCBBUEkgdG8gYWxsIG90aGVyIG1vZHVsZXMuCj4KPiBJJ20gYXNraW5nIHlvdSB0byBhZGQg
aW5mb3JtYXRpb24gYWJvdXQgImFic3RyYWN0IFVTQiBvYmplY3RzIGFuZAo+IGludGVybmFsIEFQ
SSIgdGhhdCBhcmUgYmVpbmcgaW50cm9kdWNlZCB0byB0aGUgY29tbWl0IGxvZyBhbmQgYQo+IHNo
b3J0IGludHJvIG9uIHRoZWlyIHJvbGUuCj4KPiA+IFNpZ25lZC1vZmYtYnk6IFl1cmkgQmVuZGl0
b3ZpY2ggPHl1cmkuYmVuZGl0b3ZpY2hAZGF5bml4LmNvbT4KPiA+IC0tLQo+ID4gIHNyYy9NYWtl
ZmlsZS5hbSAgICAgICAgICAgICAgIHwgICAyICsKPiA+ICBzcmMvY2hhbm5lbC11c2JyZWRpci1w
cml2LmggICB8ICAgOSArLQo+ID4gIHNyYy9jaGFubmVsLXVzYnJlZGlyLmMgICAgICAgIHwgMjE2
ICsrKy0tLS0tLS0tLQo+ID4gIHNyYy9tZXNvbi5idWlsZCAgICAgICAgICAgICAgIHwgICAyICsK
PiA+ICBzcmMvdXNiLWJhY2tlbmQuYyAgICAgICAgICAgICB8IDYyMiArKysrKysrKysrKysrKysr
KysrKysrKysrKysrKysrKysrCj4gPiAgc3JjL3VzYi1iYWNrZW5kLmggICAgICAgICAgICAgfCAx
MTAgKysrKysrCj4gPiAgc3JjL3VzYi1kZXZpY2UtbWFuYWdlci1wcml2LmggfCAgIDEgLQo+ID4g
IHNyYy91c2ItZGV2aWNlLW1hbmFnZXIuYyAgICAgIHwgMzM2ICsrKysrKy0tLS0tLS0tLS0tLQo+
ID4gIHNyYy91c2J1dGlsLmMgICAgICAgICAgICAgICAgIHwgICA2IC0KPiA+ICBzcmMvdXNidXRp
bC5oICAgICAgICAgICAgICAgICB8ICAgMiAtCj4gPiAgc3JjL3dpbi11c2ItZGV2LmMgICAgICAg
ICAgICAgfCAxMDMgKystLS0tCj4gPiAgc3JjL3dpbi11c2ItZGV2LmggICAgICAgICAgICAgfCAg
IDUgKy0KPiA+ICAxMiBmaWxlcyBjaGFuZ2VkLCA5MjkgaW5zZXJ0aW9ucygrKSwgNDg1IGRlbGV0
aW9ucygtKQo+ID4gIGNyZWF0ZSBtb2RlIDEwMDY0NCBzcmMvdXNiLWJhY2tlbmQuYwo+ID4gIGNy
ZWF0ZSBtb2RlIDEwMDY0NCBzcmMvdXNiLWJhY2tlbmQuaAo+ID4KPiA+IGRpZmYgLS1naXQgYS9z
cmMvTWFrZWZpbGUuYW0gYi9zcmMvTWFrZWZpbGUuYW0KPiA+IGluZGV4IGNkYzRkMjguLjZjNWRl
OWYgMTAwNjQ0Cj4gPiAtLS0gYS9zcmMvTWFrZWZpbGUuYW0KPiA+ICsrKyBiL3NyYy9NYWtlZmls
ZS5hbQo+ID4gQEAgLTI2Miw2ICsyNjIsOCBAQCBsaWJzcGljZV9jbGllbnRfZ2xpYl9pbXBsX2xh
X1NPVVJDRVMgPSAgICAgICAgICAgICAgICAgICAgXAo+ID4gICAgICAgc3BpY2UtdXJpLXByaXYu
aCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAo+ID4gICAgICAgdXNiLWRldmljZS1t
YW5hZ2VyLmMgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAo+ID4gICAgICAgdXNiLWRldmlj
ZS1tYW5hZ2VyLXByaXYuaCAgICAgICAgICAgICAgICAgICAgICAgXAo+ID4gKyAgICAgdXNiLWJh
Y2tlbmQuYyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAo+ID4gKyAgICAgdXNi
LWJhY2tlbmQuaCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAo+ID4gICAgICAg
dXNidXRpbC5jICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAo+ID4gICAg
ICAgdXNidXRpbC5oICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAo+ID4g
ICAgICAgJChVU0JfQUNMX0hFTFBFUl9TUkNTKSAgICAgICAgICAgICAgICAgICAgICAgICAgXAo+
ID4gZGlmZiAtLWdpdCBhL3NyYy9jaGFubmVsLXVzYnJlZGlyLXByaXYuaCBiL3NyYy9jaGFubmVs
LXVzYnJlZGlyLXByaXYuaAo+ID4gaW5kZXggMTdlOTcxNi4uNDZjMmM1NiAxMDA2NDQKPiA+IC0t
LSBhL3NyYy9jaGFubmVsLXVzYnJlZGlyLXByaXYuaAo+ID4gKysrIGIvc3JjL2NoYW5uZWwtdXNi
cmVkaXItcHJpdi5oCj4gPiBAQCAtMjEsOSArMjEsOCBAQAo+ID4gICNpZm5kZWYgX19TUElDRV9D
TElFTlRfVVNCUkVESVJfQ0hBTk5FTF9QUklWX0hfXwo+ID4gICNkZWZpbmUgX19TUElDRV9DTElF
TlRfVVNCUkVESVJfQ0hBTk5FTF9QUklWX0hfXwo+ID4KPiA+IC0jaW5jbHVkZSA8bGlidXNiLmg+
Cj4gPiAtI2luY2x1ZGUgPHVzYnJlZGlyZmlsdGVyLmg+Cj4gPiAgI2luY2x1ZGUgInNwaWNlLWNs
aWVudC5oIgo+ID4gKyNpbmNsdWRlICJ1c2ItYmFja2VuZC5oIgo+ID4KPiA+ICBHX0JFR0lOX0RF
Q0xTCj4gPgo+ID4gQEAgLTMxLDcgKzMwLDcgQEAgR19CRUdJTl9ERUNMUwo+ID4gICAgIGNvbnRl
eHQgc2hvdWxkIG5vdCBiZSBkZXN0cm95ZWQgYmVmb3JlIHRoZSBsYXN0IGRldmljZSBoYXMgYmVl
bgo+ID4gICAgIGRpc2Nvbm5lY3RlZCAqLwo+ID4gIHZvaWQgc3BpY2VfdXNicmVkaXJfY2hhbm5l
bF9zZXRfY29udGV4dChTcGljZVVzYnJlZGlyQ2hhbm5lbCAqY2hhbm5lbCwKPiA+IC0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlidXNiX2NvbnRleHQgICAgICAgKmNv
bnRleHQpOwo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTcGlj
ZVVzYkJhY2tlbmQgICAgICAqY29udGV4dCk7Cj4gPgo+ID4gIHZvaWQgc3BpY2VfdXNicmVkaXJf
Y2hhbm5lbF9kaXNjb25uZWN0X2RldmljZV9hc3luYyhTcGljZVVzYnJlZGlyQ2hhbm5lbCAqY2hh
bm5lbCwKPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgR0NhbmNlbGxhYmxlICpjYW5jZWxsYWJsZSwKPiA+IEBAIC00Niw3ICs0NSw3IEBAIGdi
b29sZWFuIHNwaWNlX3VzYnJlZGlyX2NoYW5uZWxfZGlzY29ubmVjdF9kZXZpY2VfZmluaXNoKFNw
aWNlVXNicmVkaXJDaGFubmVsICpjCj4gPiAgICAgKHRocm91Z2ggc3BpY2VfY2hhbm5lbF9jb25u
ZWN0KCkpLCBiZWZvcmUgY2FsbGluZyB0aGlzLiAqLwo+ID4gIHZvaWQgc3BpY2VfdXNicmVkaXJf
Y2hhbm5lbF9jb25uZWN0X2RldmljZV9hc3luYygKPiA+ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgU3BpY2VVc2JyZWRpckNoYW5uZWwgKmNoYW5uZWwsCj4gPiAtICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpYnVzYl9kZXZpY2UgICAgICAg
ICpkZXZpY2UsCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNw
aWNlVXNiQmFja2VuZERldmljZSAqZGV2aWNlLAo+ID4gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBTcGljZVVzYkRldmljZSAgICAgICAqc3BpY2VfZGV2aWNlLAo+ID4g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBHQ2FuY2VsbGFibGUgICAg
ICAgICAqY2FuY2VsbGFibGUsCj4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIEdBc3luY1JlYWR5Q2FsbGJhY2sgICBjYWxsYmFjaywKPiA+IEBAIC01OCw3ICs1Nyw3
IEBAIGdib29sZWFuIHNwaWNlX3VzYnJlZGlyX2NoYW5uZWxfY29ubmVjdF9kZXZpY2VfZmluaXNo
KAo+ID4KPiA+ICB2b2lkIHNwaWNlX3VzYnJlZGlyX2NoYW5uZWxfZGlzY29ubmVjdF9kZXZpY2Uo
U3BpY2VVc2JyZWRpckNoYW5uZWwgKmNoYW5uZWwpOwo+ID4KPiA+IC1saWJ1c2JfZGV2aWNlICpz
cGljZV91c2JyZWRpcl9jaGFubmVsX2dldF9kZXZpY2UoU3BpY2VVc2JyZWRpckNoYW5uZWwgKmNo
YW5uZWwpOwo+ID4gK1NwaWNlVXNiQmFja2VuZERldmljZSAqc3BpY2VfdXNicmVkaXJfY2hhbm5l
bF9nZXRfZGV2aWNlKFNwaWNlVXNicmVkaXJDaGFubmVsICpjaGFubmVsKTsKPiA+Cj4gPiAgdm9p
ZCBzcGljZV91c2JyZWRpcl9jaGFubmVsX2xvY2soU3BpY2VVc2JyZWRpckNoYW5uZWwgKmNoYW5u
ZWwpOwo+ID4KPiA+IGRpZmYgLS1naXQgYS9zcmMvY2hhbm5lbC11c2JyZWRpci5jIGIvc3JjL2No
YW5uZWwtdXNicmVkaXIuYwo+ID4gaW5kZXggMzU2MjE2NC4uZDg5NDEzMCAxMDA2NDQKPiA+IC0t
LSBhL3NyYy9jaGFubmVsLXVzYnJlZGlyLmMKPiA+ICsrKyBiL3NyYy9jaGFubmVsLXVzYnJlZGly
LmMKPiA+IEBAIC0yMyw3ICsyMyw2IEBACj4gPgo+ID4gICNpZmRlZiBVU0VfVVNCUkVESVIKPiA+
ICAjaW5jbHVkZSA8Z2xpYi9naTE4bi1saWIuaD4KPiA+IC0jaW5jbHVkZSA8dXNicmVkaXJob3N0
Lmg+Cj4gPiAgI2lmZGVmIFVTRV9MWjQKPiA+ICAjaW5jbHVkZSA8bHo0Lmg+Cj4gPiAgI2VuZGlm
Cj4gPiBAQCAtNjYsMTUgKzY1LDEyIEBAIGVudW0gU3BpY2VVc2JyZWRpckNoYW5uZWxTdGF0ZSB7
Cj4gPiAgfTsKPiA+Cj4gPiAgc3RydWN0IF9TcGljZVVzYnJlZGlyQ2hhbm5lbFByaXZhdGUgewo+
ID4gLSAgICBsaWJ1c2JfZGV2aWNlICpkZXZpY2U7Cj4gPiArICAgIFNwaWNlVXNiQmFja2VuZERl
dmljZSAqZGV2aWNlOwo+ID4gICAgICBTcGljZVVzYkRldmljZSAqc3BpY2VfZGV2aWNlOwo+ID4g
LSAgICBsaWJ1c2JfY29udGV4dCAqY29udGV4dDsKPiA+IC0gICAgc3RydWN0IHVzYnJlZGlyaG9z
dCAqaG9zdDsKPiA+ICsgICAgU3BpY2VVc2JCYWNrZW5kICpjb250ZXh0Owo+ID4gKyAgICBTcGlj
ZVVzYkJhY2tlbmRDaGFubmVsICpob3N0Owo+ID4gICAgICAvKiBUbyBjYXRjaCB1c2JyZWRpcmhv
c3QgZXJyb3IgbWVzc2FnZXMgYW5kIHJlcG9ydCB0aGVtIGFzIGEgR0Vycm9yICovCj4gPiAgICAg
IEdFcnJvciAqKmNhdGNoX2Vycm9yOwo+ID4gLSAgICAvKiBEYXRhIHBhc3NlZCBmcm9tIGNoYW5u
ZWwgaGFuZGxlIG1zZyB0byB0aGUgdXNicmVkaXJob3N0IHJlYWQgY2IgKi8KPiA+IC0gICAgY29u
c3QgdWludDhfdCAqcmVhZF9idWY7Cj4gPiAtICAgIGludCByZWFkX2J1Zl9zaXplOwo+ID4gICAg
ICBlbnVtIFNwaWNlVXNicmVkaXJDaGFubmVsU3RhdGUgc3RhdGU7Cj4gPiAgI2lmZGVmIFVTRV9Q
T0xLSVQKPiA+ICAgICAgR1Rhc2sgKnRhc2s7Cj4gPiBAQCAtOTAsMTYgKzg2LDkgQEAgc3RhdGlj
IHZvaWQgc3BpY2VfdXNicmVkaXJfY2hhbm5lbF9kaXNwb3NlKEdPYmplY3QgKm9iaik7Cj4gPiAg
c3RhdGljIHZvaWQgc3BpY2VfdXNicmVkaXJfY2hhbm5lbF9maW5hbGl6ZShHT2JqZWN0ICpvYmop
Owo+ID4gIHN0YXRpYyB2b2lkIHVzYnJlZGlyX2hhbmRsZV9tc2coU3BpY2VDaGFubmVsICpjaGFu
bmVsLCBTcGljZU1zZ0luICppbik7Cj4gPgo+ID4gLXN0YXRpYyB2b2lkIHVzYnJlZGlyX2xvZyh2
b2lkICp1c2VyX2RhdGEsIGludCBsZXZlbCwgY29uc3QgY2hhciAqbXNnKTsKPiA+IC1zdGF0aWMg
aW50IHVzYnJlZGlyX3JlYWRfY2FsbGJhY2sodm9pZCAqdXNlcl9kYXRhLCB1aW50OF90ICpkYXRh
LCBpbnQgY291bnQpOwo+ID4gIHN0YXRpYyBpbnQgdXNicmVkaXJfd3JpdGVfY2FsbGJhY2sodm9p
ZCAqdXNlcl9kYXRhLCB1aW50OF90ICpkYXRhLCBpbnQgY291bnQpOwo+ID4gLXN0YXRpYyB2b2lk
IHVzYnJlZGlyX3dyaXRlX2ZsdXNoX2NhbGxiYWNrKHZvaWQgKnVzZXJfZGF0YSk7Cj4gPiAtc3Rh
dGljIHVpbnQ2NF90IHVzYnJlZGlyX2J1ZmZlcmVkX291dHB1dF9zaXplX2NhbGxiYWNrKHZvaWQg
KnVzZXJfZGF0YSk7Cj4gPiAtCj4gPiAtc3RhdGljIHZvaWQgKnVzYnJlZGlyX2FsbG9jX2xvY2so
dm9pZCk7Cj4gPiAtc3RhdGljIHZvaWQgdXNicmVkaXJfbG9ja19sb2NrKHZvaWQgKnVzZXJfZGF0
YSk7Cj4gPiAtc3RhdGljIHZvaWQgdXNicmVkaXJfdW5sb2NrX2xvY2sodm9pZCAqdXNlcl9kYXRh
KTsKPiA+IC1zdGF0aWMgdm9pZCB1c2JyZWRpcl9mcmVlX2xvY2sodm9pZCAqdXNlcl9kYXRhKTsK
PiA+ICtzdGF0aWMgZ2Jvb2xlYW4gdXNicmVkaXJfaXNfY2hhbm5lbF9yZWFkeSh2b2lkICp1c2Vy
X2RhdGEpOwo+ID4gK3N0YXRpYyB1aW50NjRfdCB1c2JyZWRpcl9nZXRfcXVldWVfc2l6ZSh2b2lk
ICp1c2VyX2RhdGEpOwo+ID4KPiA+ICAjZWxzZQo+ID4gIHN0cnVjdCBfU3BpY2VVc2JyZWRpckNo
YW5uZWxQcml2YXRlIHsKPiA+IEBAIC0xMjYsNyArMTE1LDcgQEAgc3RhdGljIHZvaWQgX2NoYW5u
ZWxfcmVzZXRfZmluaXNoKFNwaWNlVXNicmVkaXJDaGFubmVsICpjaGFubmVsLCBnYm9vbGVhbiBt
aWdyYXQKPiA+Cj4gPiAgICAgIHNwaWNlX3VzYnJlZGlyX2NoYW5uZWxfbG9jayhjaGFubmVsKTsK
PiA+Cj4gPiAtICAgIHVzYnJlZGlyaG9zdF9jbG9zZShwcml2LT5ob3N0KTsKPiA+ICsgICAgc3Bp
Y2VfdXNiX2JhY2tlbmRfY2hhbm5lbF9kZWxldGUocHJpdi0+aG9zdCk7Cj4gPiAgICAgIHByaXYt
Pmhvc3QgPSBOVUxMOwo+ID4KPiA+ICAgICAgLyogQ2FsbCBzZXRfY29udGV4dCB0byByZS1jcmVh
dGUgdGhlIGhvc3QgKi8KPiA+IEBAIC0yMzYsNyArMjI1LDcgQEAgc3RhdGljIHZvaWQgc3BpY2Vf
dXNicmVkaXJfY2hhbm5lbF9maW5hbGl6ZShHT2JqZWN0ICpvYmopCj4gPiAgICAgIFNwaWNlVXNi
cmVkaXJDaGFubmVsICpjaGFubmVsID0gU1BJQ0VfVVNCUkVESVJfQ0hBTk5FTChvYmopOwo+ID4K
PiA+ICAgICAgaWYgKGNoYW5uZWwtPnByaXYtPmhvc3QpCj4gPiAtICAgICAgICB1c2JyZWRpcmhv
c3RfY2xvc2UoY2hhbm5lbC0+cHJpdi0+aG9zdCk7Cj4gPiArICAgICAgICBzcGljZV91c2JfYmFj
a2VuZF9jaGFubmVsX2RlbGV0ZShjaGFubmVsLT5wcml2LT5ob3N0KTsKPiA+ICAjaWZkZWYgVVNF
X1VTQlJFRElSCj4gPiAgICAgIGdfbXV0ZXhfY2xlYXIoJmNoYW5uZWwtPnByaXYtPmRldmljZV9j
b25uZWN0X211dGV4KTsKPiA+ICAjZW5kaWYKPiA+IEBAIC0yNjEsMzAgKzI1MCwyMiBAQCBzdGF0
aWMgdm9pZCBjaGFubmVsX3NldF9oYW5kbGVycyhTcGljZUNoYW5uZWxDbGFzcyAqa2xhc3MpCj4g
Pgo+ID4gIEdfR05VQ19JTlRFUk5BTAo+ID4gIHZvaWQgc3BpY2VfdXNicmVkaXJfY2hhbm5lbF9z
ZXRfY29udGV4dChTcGljZVVzYnJlZGlyQ2hhbm5lbCAqY2hhbm5lbCwKPiA+IC0gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlidXNiX2NvbnRleHQgICAgICAgKmNvbnRl
eHQpCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNwaWNlVXNi
QmFja2VuZCAgICAgICpjb250ZXh0KQo+ID4gIHsKPiA+ICAgICAgU3BpY2VVc2JyZWRpckNoYW5u
ZWxQcml2YXRlICpwcml2ID0gY2hhbm5lbC0+cHJpdjsKPiA+ICsgICAgU3BpY2VVc2JCYWNrZW5k
Q2hhbm5lbEluaXREYXRhIGluaXRfZGF0YTsKPiA+ICsgICAgaW5pdF9kYXRhLnVzZXJfZGF0YSA9
IGNoYW5uZWw7Cj4gPiArICAgIGluaXRfZGF0YS5nZXRfcXVldWVfc2l6ZSA9IHVzYnJlZGlyX2dl
dF9xdWV1ZV9zaXplOwo+ID4gKyAgICBpbml0X2RhdGEuaXNfY2hhbm5lbF9yZWFkeSA9IHVzYnJl
ZGlyX2lzX2NoYW5uZWxfcmVhZHk7Cj4gPiArICAgIGluaXRfZGF0YS53cml0ZV9jYWxsYmFjayA9
IHVzYnJlZGlyX3dyaXRlX2NhbGxiYWNrOwo+Cj4gSSdkIHJhdGhlciB3ZSBleHBvcnQgdGhvc2Ug
dGhyZWUgZnVuY3Rpb25zIGluc3RlYWQgb2YgdXNpbmcKPiBTcGljZVVzYkJhY2tlbmRDaGFubmVs
SW5pdERhdGEuIFlvdSBqdXN0IGNyZWF0ZSB3cmFwcGVycyBhZ2FpbiB0bwo+IHRoZW0gaW4gdXNi
LWJhY2tlbmQuIEkgZG9uJ3QgdGhpbmsgaXQgaXMgYSBnb29kIGVmZm9ydCBtYWlubHkKPiBiZWNh
dXNlIHVzYi1iYWNrZW5kIGFuZCBjaGFubmVsLXVzYnJlZGlyIGFyZSBib3VuZGVkLgo+Cj4gQ2hh
bm5lbC11c2JyZWRpciBpcyBhIFNwaWNlQ2hhbm5lbCBzbyB5b3UgY291bGQgZXZlbiByZW1vdmUK
PiBfZ2V0X3F1ZXVlX3NpemUoKSBhbmQgX2lzX2NoYW5uZWxfcmVhZHkoKSBpZiBjb21wcm9taXNl
ZCBhIGJpdAo+IHRoZSBkZXNpZ24gYW5kIGhhdmUgdGhvc2UgZnVuY3Rpb25zIHRoZXJlIGFzIHRo
ZXknbGwgYmUgdXNlbGVzcwo+IGluIGNoYW5uZWwtdXNicmVkaXIgKC4uLikKPgo+IElmIHdlIGhh
ZCBkaWZmZXJlbnQgdXNlcnMgZm9yIHNwaWNlX3VzYl9iYWNrZW5kX2NoYW5uZWxfbmV3KCkgSQo+
IHdvdWxkbid0IG1pbmQuCj4KPiBTbywgcGxlYXNlIEdfR05VQ19JTlRFUk5BTCBvbiB0aG9zZSBh
bmQgcmVtb3ZlIHRob3NlIHdyYXBwZXJzIGluCj4gdXNiLWJhY2tlbmQuYwo+Cj4gPiAgICAgIGdf
cmV0dXJuX2lmX2ZhaWwocHJpdi0+aG9zdCA9PSBOVUxMKTsKPiA+Cj4gPiAgICAgIHByaXYtPmNv
bnRleHQgPSBjb250ZXh0Owo+ID4gLSAgICBwcml2LT5ob3N0ID0gdXNicmVkaXJob3N0X29wZW5f
ZnVsbCgKPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQsIE5V
TEwsCj4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2JyZWRpcl9sb2cs
Cj4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2JyZWRpcl9yZWFkX2Nh
bGxiYWNrLAo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNicmVkaXJf
d3JpdGVfY2FsbGJhY2ssCj4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1
c2JyZWRpcl93cml0ZV9mbHVzaF9jYWxsYmFjaywKPiA+IC0gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHVzYnJlZGlyX2FsbG9jX2xvY2ssCj4gPiAtICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICB1c2JyZWRpcl9sb2NrX2xvY2ssCj4gPiAtICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICB1c2JyZWRpcl91bmxvY2tfbG9jaywKPiA+IC0gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHVzYnJlZGlyX2ZyZWVfbG9jaywKPiA+IC0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5uZWwsIFBBQ0tBR0VfU1RSSU5HLAo+ID4g
LSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BpY2VfdXRpbF9nZXRfZGVidWco
KSA/IHVzYnJlZGlycGFyc2VyX2RlYnVnIDogdXNicmVkaXJwYXJzZXJfd2FybmluZywKPiA+IC0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzYnJlZGlyaG9zdF9mbF93cml0ZV9j
Yl9vd25zX2J1ZmZlcik7Cj4gPiArICAgIHByaXYtPmhvc3QgPSBzcGljZV91c2JfYmFja2VuZF9j
aGFubmVsX25ldyhjb250ZXh0LCAmaW5pdF9kYXRhKTsKPiA+ICAgICAgaWYgKCFwcml2LT5ob3N0
KQo+ID4gLSAgICAgICAgZ19lcnJvcigiT3V0IG9mIG1lbW9yeSBhbGxvY2F0aW5nIHVzYnJlZGly
aG9zdCIpOwo+ID4gKyAgICAgICAgZ19lcnJvcigiT3V0IG9mIG1lbW9yeSBpbml0aWFsaXppbmcg
cmVkaXJlY3Rpb24gc3VwcG9ydCIpOwo+ID4KPiA+IC0gICAgdXNicmVkaXJob3N0X3NldF9idWZm
ZXJlZF9vdXRwdXRfc2l6ZV9jYihwcml2LT5ob3N0LCB1c2JyZWRpcl9idWZmZXJlZF9vdXRwdXRf
c2l6ZV9jYWxsYmFjayk7Cj4gPiAgI2lmZGVmIFVTRV9MWjQKPiA+ICAgICAgc3BpY2VfY2hhbm5l
bF9zZXRfY2FwYWJpbGl0eShjaGFubmVsLCBTUElDRV9TUElDRVZNQ19DQVBfREFUQV9DT01QUkVT
U19MWjQpOwo+ID4gICNlbmRpZgo+ID4gQEAgLTI5NSw4ICsyNzYsNiBAQCBzdGF0aWMgZ2Jvb2xl
YW4gc3BpY2VfdXNicmVkaXJfY2hhbm5lbF9vcGVuX2RldmljZSgKPiA+ICB7Cj4gPiAgICAgIFNw
aWNlVXNicmVkaXJDaGFubmVsUHJpdmF0ZSAqcHJpdiA9IGNoYW5uZWwtPnByaXY7Cj4gPiAgICAg
IFNwaWNlU2Vzc2lvbiAqc2Vzc2lvbjsKPiA+IC0gICAgbGlidXNiX2RldmljZV9oYW5kbGUgKmhh
bmRsZSA9IE5VTEw7Cj4gPiAtICAgIGludCByYywgc3RhdHVzOwo+ID4gICAgICBTcGljZVVzYkRl
dmljZU1hbmFnZXIgKm1hbmFnZXI7Cj4gPgo+ID4gICAgICBnX3JldHVybl92YWxfaWZfZmFpbChw
cml2LT5zdGF0ZSA9PSBTVEFURV9ESVNDT05ORUNURUQKPiA+IEBAIC0zMDUsMTkgKzI4NCwxMSBA
QCBzdGF0aWMgZ2Jvb2xlYW4gc3BpY2VfdXNicmVkaXJfY2hhbm5lbF9vcGVuX2RldmljZSgKPiA+
ICAjZW5kaWYKPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgLCBGQUxTRSk7Cj4gPgo+ID4g
LSAgICByYyA9IGxpYnVzYl9vcGVuKHByaXYtPmRldmljZSwgJmhhbmRsZSk7Cj4gPiAtICAgIGlm
IChyYyAhPSAwKSB7Cj4gPiAtICAgICAgICBnX3NldF9lcnJvcihlcnIsIFNQSUNFX0NMSUVOVF9F
UlJPUiwgU1BJQ0VfQ0xJRU5UX0VSUk9SX0ZBSUxFRCwKPiA+IC0gICAgICAgICAgICAgICAgICAg
ICJDb3VsZCBub3Qgb3BlbiB1c2IgZGV2aWNlOiAlcyBbJWldIiwKPiA+IC0gICAgICAgICAgICAg
ICAgICAgIHNwaWNlX3VzYnV0aWxfbGlidXNiX3N0cmVycm9yKHJjKSwgcmMpOwo+ID4gLSAgICAg
ICAgcmV0dXJuIEZBTFNFOwo+ID4gLSAgICB9Cj4gPiAtCj4gPiAtICAgIHByaXYtPmNhdGNoX2Vy
cm9yID0gZXJyOwo+ID4gLSAgICBzdGF0dXMgPSB1c2JyZWRpcmhvc3Rfc2V0X2RldmljZShwcml2
LT5ob3N0LCBoYW5kbGUpOwo+ID4gLSAgICBwcml2LT5jYXRjaF9lcnJvciA9IE5VTEw7Cj4gPiAt
ICAgIGlmIChzdGF0dXMgIT0gdXNiX3JlZGlyX3N1Y2Nlc3MpIHsKPiA+IC0gICAgICAgIGdfcmV0
dXJuX3ZhbF9pZl9mYWlsKGVyciA9PSBOVUxMIHx8ICplcnIgIT0gTlVMTCwgRkFMU0UpOwo+ID4g
KyAgICBpZiAoIXNwaWNlX3VzYl9iYWNrZW5kX2NoYW5uZWxfYXR0YWNoKHByaXYtPmhvc3QsIHBy
aXYtPmRldmljZSwgZXJyKSkgewo+ID4gKyAgICAgICAgaWYgKCplcnIgPT0gTlVMTCkgewo+ID4g
KyAgICAgICAgICAgIGdfc2V0X2Vycm9yKGVyciwgU1BJQ0VfQ0xJRU5UX0VSUk9SLCBTUElDRV9D
TElFTlRfRVJST1JfRkFJTEVELAo+ID4gKyAgICAgICAgICAgICAgICAiRXJyb3IgYXR0YWNoaW5n
IGRldmljZTogKG5vIGVycm9yIGluZm9ybWF0aW9uKSIpOwo+ID4gKyAgICAgICAgfQo+ID4gICAg
ICAgICAgcmV0dXJuIEZBTFNFOwo+ID4gICAgICB9Cj4gPgo+ID4gQEAgLTMyNyw3ICsyOTgsNyBA
QCBzdGF0aWMgZ2Jvb2xlYW4gc3BpY2VfdXNicmVkaXJfY2hhbm5lbF9vcGVuX2RldmljZSgKPiA+
Cj4gPiAgICAgIHByaXYtPnVzYl9kZXZpY2VfbWFuYWdlciA9IGdfb2JqZWN0X3JlZihtYW5hZ2Vy
KTsKPiA+ICAgICAgaWYgKCFzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfc3RhcnRfZXZlbnRfbGlz
dGVuaW5nKHByaXYtPnVzYl9kZXZpY2VfbWFuYWdlciwgZXJyKSkgewo+ID4gLSAgICAgICAgdXNi
cmVkaXJob3N0X3NldF9kZXZpY2UocHJpdi0+aG9zdCwgTlVMTCk7Cj4gPiArICAgICAgICBzcGlj
ZV91c2JfYmFja2VuZF9jaGFubmVsX2RldGFjaChwcml2LT5ob3N0KTsKPiA+ICAgICAgICAgIHJl
dHVybiBGQUxTRTsKPiA+ICAgICAgfQo+ID4KPiA+IEBAIC0zNTgsOCArMzI5LDcgQEAgc3RhdGlj
IHZvaWQgc3BpY2VfdXNicmVkaXJfY2hhbm5lbF9vcGVuX2FjbF9jYigKPiA+ICAgICAgICAgIHNw
aWNlX3VzYnJlZGlyX2NoYW5uZWxfb3Blbl9kZXZpY2UoY2hhbm5lbCwgJmVycik7Cj4gPiAgICAg
IH0KPiA+ICAgICAgaWYgKGVycikgewo+ID4gLSAgICAgICAgbGlidXNiX3VucmVmX2RldmljZShw
cml2LT5kZXZpY2UpOwo+ID4gLSAgICAgICAgcHJpdi0+ZGV2aWNlID0gTlVMTDsKPiA+ICsgICAg
ICAgIGdfY2xlYXJfcG9pbnRlcigmcHJpdi0+ZGV2aWNlLCBzcGljZV91c2JfYmFja2VuZF9kZXZp
Y2VfdW5yZWYpOwo+ID4gICAgICAgICAgZ19ib3hlZF9mcmVlKHNwaWNlX3VzYl9kZXZpY2VfZ2V0
X3R5cGUoKSwgcHJpdi0+c3BpY2VfZGV2aWNlKTsKPiA+ICAgICAgICAgIHByaXYtPnNwaWNlX2Rl
dmljZSA9IE5VTEw7Cj4gPiAgICAgICAgICBwcml2LT5zdGF0ZSAgPSBTVEFURV9ESVNDT05ORUNU
RUQ7Cj4gPiBAQCAtMzkwLDggKzM2MCw3IEBAIF9vcGVuX2RldmljZV9hc3luY19jYihHVGFzayAq
dGFzaywKPiA+ICAgICAgc3BpY2VfdXNicmVkaXJfY2hhbm5lbF9sb2NrKGNoYW5uZWwpOwo+ID4K
PiA+ICAgICAgaWYgKCFzcGljZV91c2JyZWRpcl9jaGFubmVsX29wZW5fZGV2aWNlKGNoYW5uZWws
ICZlcnIpKSB7Cj4gPiAtICAgICAgICBsaWJ1c2JfdW5yZWZfZGV2aWNlKHByaXYtPmRldmljZSk7
Cj4gPiAtICAgICAgICBwcml2LT5kZXZpY2UgPSBOVUxMOwo+ID4gKyAgICAgICAgZ19jbGVhcl9w
b2ludGVyKCZwcml2LT5kZXZpY2UsIHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV91bnJlZik7Cj4g
PiAgICAgICAgICBnX2JveGVkX2ZyZWUoc3BpY2VfdXNiX2RldmljZV9nZXRfdHlwZSgpLCBwcml2
LT5zcGljZV9kZXZpY2UpOwo+ID4gICAgICAgICAgcHJpdi0+c3BpY2VfZGV2aWNlID0gTlVMTDsK
PiA+ICAgICAgfQo+ID4gQEAgLTQwOSwxMyArMzc4LDE2IEBAIF9vcGVuX2RldmljZV9hc3luY19j
YihHVGFzayAqdGFzaywKPiA+ICBHX0dOVUNfSU5URVJOQUwKPiA+ICB2b2lkIHNwaWNlX3VzYnJl
ZGlyX2NoYW5uZWxfY29ubmVjdF9kZXZpY2VfYXN5bmMoCj4gPiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgU3BpY2VVc2JyZWRpckNoYW5uZWwgKmNoYW5uZWwsCj4g
PiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlidXNiX2Rldmlj
ZSAgICAgICAgKmRldmljZSwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBTcGljZVVzYkJhY2tlbmREZXZpY2UgKmRldmljZSwKPiA+ICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTcGljZVVzYkRldmljZSAgICAgICAqc3BpY2Vf
ZGV2aWNlLAo+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdD
YW5jZWxsYWJsZSAgICAgICAgICpjYW5jZWxsYWJsZSwKPiA+ICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBHQXN5bmNSZWFkeUNhbGxiYWNrICAgY2FsbGJhY2ssCj4g
PiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3BvaW50ZXIgICAg
ICAgICAgICAgIHVzZXJfZGF0YSkKPiA+ICB7Cj4gPiAgICAgIFNwaWNlVXNicmVkaXJDaGFubmVs
UHJpdmF0ZSAqcHJpdiA9IGNoYW5uZWwtPnByaXY7Cj4gPiArI2lmZGVmIFVTRV9QT0xLSVQKPiA+
ICsgICAgY29uc3QgVXNiRGV2aWNlSW5mb3JtYXRpb24gKmluZm8gPSBzcGljZV91c2JfYmFja2Vu
ZF9kZXZpY2VfZ2V0X2luZm8oZGV2aWNlKTsKPiA+ICsjZW5kaWYKPiA+ICAgICAgR1Rhc2sgKnRh
c2s7Cj4gPgo+ID4gICAgICBnX3JldHVybl9pZl9mYWlsKFNQSUNFX0lTX1VTQlJFRElSX0NIQU5O
RUwoY2hhbm5lbCkpOwo+ID4gQEAgLTQ0Miw3ICs0MTQsNyBAQCB2b2lkIHNwaWNlX3VzYnJlZGly
X2NoYW5uZWxfY29ubmVjdF9kZXZpY2VfYXN5bmMoCj4gPiAgICAgICAgICBnb3RvIGRvbmU7Cj4g
PiAgICAgIH0KPiA+Cj4gPiAtICAgIHByaXYtPmRldmljZSA9IGxpYnVzYl9yZWZfZGV2aWNlKGRl
dmljZSk7Cj4gPiArICAgIHByaXYtPmRldmljZSA9IHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9y
ZWYoZGV2aWNlKTsKPiA+ICAgICAgcHJpdi0+c3BpY2VfZGV2aWNlID0gZ19ib3hlZF9jb3B5KHNw
aWNlX3VzYl9kZXZpY2VfZ2V0X3R5cGUoKSwKPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHNwaWNlX2RldmljZSk7Cj4gPiAgI2lmZGVmIFVTRV9QT0xLSVQKPiA+IEBA
IC00NTIsOCArNDI0LDggQEAgdm9pZCBzcGljZV91c2JyZWRpcl9jaGFubmVsX2Nvbm5lY3RfZGV2
aWNlX2FzeW5jKAo+ID4gICAgICBnX29iamVjdF9zZXQoc3BpY2VfY2hhbm5lbF9nZXRfc2Vzc2lv
bihTUElDRV9DSEFOTkVMKGNoYW5uZWwpKSwKPiA+ICAgICAgICAgICAgICAgICAgICJpbmhpYml0
LWtleWJvYXJkLWdyYWIiLCBUUlVFLCBOVUxMKTsKPiA+ICAgICAgc3BpY2VfdXNiX2FjbF9oZWxw
ZXJfb3Blbl9hY2xfYXN5bmMocHJpdi0+YWNsX2hlbHBlciwKPiA+IC0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgbGlidXNiX2dldF9idXNfbnVtYmVyKGRldmljZSksCj4g
PiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpYnVzYl9nZXRfZGV2
aWNlX2FkZHJlc3MoZGV2aWNlKSwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgaW5mby0+YnVzLAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBpbmZvLT5hZGRyZXNzLAo+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBjYW5jZWxsYWJsZSwKPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgc3BpY2VfdXNicmVkaXJfY2hhbm5lbF9vcGVuX2FjbF9jYiwKPiA+ICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhbm5lbCk7Cj4gPiBAQCAtNTEx
LDkgKzQ4Myw4IEBAIHZvaWQgc3BpY2VfdXNicmVkaXJfY2hhbm5lbF9kaXNjb25uZWN0X2Rldmlj
ZShTcGljZVVzYnJlZGlyQ2hhbm5lbCAqY2hhbm5lbCkKPiA+ICAgICAgICAgIGdfY2xlYXJfb2Jq
ZWN0KCZwcml2LT51c2JfZGV2aWNlX21hbmFnZXIpOwo+ID4KPiA+ICAgICAgICAgIC8qIFRoaXMg
YWxzbyBjbG9zZXMgdGhlIGxpYnVzYiBoYW5kbGUgd2UgcGFzc2VkIGZyb20gb3Blbl9kZXZpY2Ug
Ki8KPiA+IC0gICAgICAgIHVzYnJlZGlyaG9zdF9zZXRfZGV2aWNlKHByaXYtPmhvc3QsIE5VTEwp
Owo+ID4gLSAgICAgICAgbGlidXNiX3VucmVmX2RldmljZShwcml2LT5kZXZpY2UpOwo+ID4gLSAg
ICAgICAgcHJpdi0+ZGV2aWNlID0gTlVMTDsKPiA+ICsgICAgICAgIHNwaWNlX3VzYl9iYWNrZW5k
X2NoYW5uZWxfZGV0YWNoKHByaXYtPmhvc3QpOwo+ID4gKyAgICAgICAgZ19jbGVhcl9wb2ludGVy
KCZwcml2LT5kZXZpY2UsIHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV91bnJlZik7Cj4gPiAgICAg
ICAgICBnX2JveGVkX2ZyZWUoc3BpY2VfdXNiX2RldmljZV9nZXRfdHlwZSgpLCBwcml2LT5zcGlj
ZV9kZXZpY2UpOwo+ID4gICAgICAgICAgcHJpdi0+c3BpY2VfZGV2aWNlID0gTlVMTDsKPiA+ICAg
ICAgICAgIHByaXYtPnN0YXRlICA9IFNUQVRFX0RJU0NPTk5FQ1RFRDsKPiA+IEBAIC01NjQsNyAr
NTM1LDcgQEAgc3BpY2VfdXNicmVkaXJfY2hhbm5lbF9nZXRfc3BpY2VfdXNiX2RldmljZShTcGlj
ZVVzYnJlZGlyQ2hhbm5lbCAqY2hhbm5lbCkKPiA+ICAjZW5kaWYKPiA+Cj4gPiAgR19HTlVDX0lO
VEVSTkFMCj4gPiAtbGlidXNiX2RldmljZSAqc3BpY2VfdXNicmVkaXJfY2hhbm5lbF9nZXRfZGV2
aWNlKFNwaWNlVXNicmVkaXJDaGFubmVsICpjaGFubmVsKQo+ID4gK1NwaWNlVXNiQmFja2VuZERl
dmljZSAqc3BpY2VfdXNicmVkaXJfY2hhbm5lbF9nZXRfZGV2aWNlKFNwaWNlVXNicmVkaXJDaGFu
bmVsICpjaGFubmVsKQo+ID4gIHsKPiA+ICAgICAgcmV0dXJuIGNoYW5uZWwtPnByaXYtPmRldmlj
ZTsKPiA+ICB9Cj4gPiBAQCAtNTc5LDgzICs1NTAsMjQgQEAgdm9pZCBzcGljZV91c2JyZWRpcl9j
aGFubmVsX2dldF9ndWVzdF9maWx0ZXIoCj4gPgo+ID4gICAgICBnX3JldHVybl9pZl9mYWlsKHBy
aXYtPmhvc3QgIT0gTlVMTCk7Cj4gPgo+ID4gLSAgICB1c2JyZWRpcmhvc3RfZ2V0X2d1ZXN0X2Zp
bHRlcihwcml2LT5ob3N0LCBydWxlc19yZXQsIHJ1bGVzX2NvdW50X3JldCk7Cj4gPiArICAgIHNw
aWNlX3VzYl9iYWNrZW5kX2NoYW5uZWxfZ2V0X2d1ZXN0X2ZpbHRlcihwcml2LT5ob3N0LCBydWxl
c19yZXQsIHJ1bGVzX2NvdW50X3JldCk7Cj4gPiAgfQo+ID4KPiA+ICAvKiAtLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi8K
PiA+ICAvKiBjYWxsYmFja3MgKGFueSBjb250ZXh0KSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgKi8KPiA+Cj4gPiAtc3RhdGljIHVpbnQ2NF90IHVzYnJlZGlyX2J1
ZmZlcmVkX291dHB1dF9zaXplX2NhbGxiYWNrKHZvaWQgKnVzZXJfZGF0YSkKPiA+ICtzdGF0aWMg
dWludDY0X3QgdXNicmVkaXJfZ2V0X3F1ZXVlX3NpemUodm9pZCAqdXNlcl9kYXRhKQo+ID4gIHsK
PiA+ICAgICAgZ19yZXR1cm5fdmFsX2lmX2ZhaWwoU1BJQ0VfSVNfVVNCUkVESVJfQ0hBTk5FTCh1
c2VyX2RhdGEpLCAwKTsKPiA+ICAgICAgcmV0dXJuIHNwaWNlX2NoYW5uZWxfZ2V0X3F1ZXVlX3Np
emUoU1BJQ0VfQ0hBTk5FTCh1c2VyX2RhdGEpKTsKPiA+ICB9Cj4gPgo+ID4gLS8qIE5vdGUgdGhh
dCB0aGlzIGZ1bmN0aW9uIG11c3QgYmUgcmUtZW50cmFudCBzYWZlLCBhcyBpdCBjYW4gZ2V0IGNh
bGxlZAo+ID4gLSAgIGZyb20gYm90aCB0aGUgbWFpbiB0aHJlYWQgYXMgd2VsbCBhcyBmcm9tIHRo
ZSB1c2IgZXZlbnQgaGFuZGxpbmcgdGhyZWFkICovCj4gPiAtc3RhdGljIHZvaWQgdXNicmVkaXJf
d3JpdGVfZmx1c2hfY2FsbGJhY2sodm9pZCAqdXNlcl9kYXRhKQo+ID4gK3N0YXRpYyBnYm9vbGVh
biB1c2JyZWRpcl9pc19jaGFubmVsX3JlYWR5KHZvaWQgKnVzZXJfZGF0YSkKPiA+ICB7Cj4gPiAg
ICAgIFNwaWNlVXNicmVkaXJDaGFubmVsICpjaGFubmVsID0gU1BJQ0VfVVNCUkVESVJfQ0hBTk5F
TCh1c2VyX2RhdGEpOwo+ID4gICAgICBTcGljZVVzYnJlZGlyQ2hhbm5lbFByaXZhdGUgKnByaXYg
PSBjaGFubmVsLT5wcml2Owo+ID4gLQo+ID4gLSAgICBpZiAoc3BpY2VfY2hhbm5lbF9nZXRfc3Rh
dGUoU1BJQ0VfQ0hBTk5FTChjaGFubmVsKSkgIT0KPiA+IC0gICAgICAgICAgICBTUElDRV9DSEFO
TkVMX1NUQVRFX1JFQURZKQo+ID4gLSAgICAgICAgcmV0dXJuOwo+ID4gLQo+ID4gLSAgICBpZiAo
IXByaXYtPmhvc3QpCj4gPiAtICAgICAgICByZXR1cm47Cj4gPiAtCj4gPiAtICAgIHVzYnJlZGly
aG9zdF93cml0ZV9ndWVzdF9kYXRhKHByaXYtPmhvc3QpOwo+ID4gLX0KPiA+IC0KPiA+IC1zdGF0
aWMgdm9pZCB1c2JyZWRpcl9sb2codm9pZCAqdXNlcl9kYXRhLCBpbnQgbGV2ZWwsIGNvbnN0IGNo
YXIgKm1zZykKPiA+IC17Cj4gPiAtICAgIFNwaWNlVXNicmVkaXJDaGFubmVsICpjaGFubmVsID0g
dXNlcl9kYXRhOwo+ID4gLSAgICBTcGljZVVzYnJlZGlyQ2hhbm5lbFByaXZhdGUgKnByaXYgPSBj
aGFubmVsLT5wcml2Owo+ID4gLQo+ID4gLSAgICBpZiAocHJpdi0+Y2F0Y2hfZXJyb3IgJiYgbGV2
ZWwgPT0gdXNicmVkaXJwYXJzZXJfZXJyb3IpIHsKPiA+IC0gICAgICAgIENIQU5ORUxfREVCVUco
Y2hhbm5lbCwgIiVzIiwgbXNnKTsKPiA+IC0gICAgICAgIC8qIFJlbW92ZSAidXNicmVkaXJob3N0
OiAiIHByZWZpeCBmcm9tIHVzYnJlZGlyaG9zdCBtZXNzYWdlcyAqLwo+ID4gLSAgICAgICAgaWYg
KHN0cm5jbXAobXNnLCAidXNicmVkaXJob3N0OiAiLCAxNCkgPT0gMCkKPiA+IC0gICAgICAgICAg
ICBnX3NldF9lcnJvcl9saXRlcmFsKHByaXYtPmNhdGNoX2Vycm9yLCBTUElDRV9DTElFTlRfRVJS
T1IsCj4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTUElDRV9DTElFTlRfRVJS
T1JfRkFJTEVELCBtc2cgKyAxNCk7Cj4gPiAtICAgICAgICBlbHNlCj4gPiAtICAgICAgICAgICAg
Z19zZXRfZXJyb3JfbGl0ZXJhbChwcml2LT5jYXRjaF9lcnJvciwgU1BJQ0VfQ0xJRU5UX0VSUk9S
LAo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU1BJQ0VfQ0xJRU5UX0VSUk9S
X0ZBSUxFRCwgbXNnKTsKPiA+IC0gICAgICAgIHJldHVybjsKPiA+IC0gICAgfQo+ID4gLQo+ID4g
LSAgICBzd2l0Y2ggKGxldmVsKSB7Cj4gPiAtICAgICAgICBjYXNlIHVzYnJlZGlycGFyc2VyX2Vy
cm9yOgo+ID4gLSAgICAgICAgICAgIGdfY3JpdGljYWwoIiVzIiwgbXNnKTsKPiA+IC0gICAgICAg
ICAgICBicmVhazsKPiA+IC0gICAgICAgIGNhc2UgdXNicmVkaXJwYXJzZXJfd2FybmluZzoKPiA+
IC0gICAgICAgICAgICBnX3dhcm5pbmcoIiVzIiwgbXNnKTsKPiA+IC0gICAgICAgICAgICBicmVh
azsKPiA+IC0gICAgICAgIGRlZmF1bHQ6Cj4gPiAtICAgICAgICAgICAgQ0hBTk5FTF9ERUJVRyhj
aGFubmVsLCAiJXMiLCBtc2cpOwo+ID4gLSAgICB9Cj4gPiAtfQo+ID4gLQo+ID4gLXN0YXRpYyBp
bnQgdXNicmVkaXJfcmVhZF9jYWxsYmFjayh2b2lkICp1c2VyX2RhdGEsIHVpbnQ4X3QgKmRhdGEs
IGludCBjb3VudCkKPiA+IC17Cj4gPiAtICAgIFNwaWNlVXNicmVkaXJDaGFubmVsICpjaGFubmVs
ID0gdXNlcl9kYXRhOwo+ID4gLSAgICBTcGljZVVzYnJlZGlyQ2hhbm5lbFByaXZhdGUgKnByaXYg
PSBjaGFubmVsLT5wcml2Owo+ID4gLQo+ID4gLSAgICBjb3VudCA9IE1JTihwcml2LT5yZWFkX2J1
Zl9zaXplLCBjb3VudCk7Cj4gPiAtCj4gPiAtICAgIGlmIChjb3VudCAhPSAwKSB7Cj4gPiAtICAg
ICAgICBtZW1jcHkoZGF0YSwgcHJpdi0+cmVhZF9idWYsIGNvdW50KTsKPiA+IC0gICAgfQo+ID4g
LQo+ID4gLSAgICBwcml2LT5yZWFkX2J1Zl9zaXplIC09IGNvdW50Owo+ID4gLSAgICBpZiAocHJp
di0+cmVhZF9idWZfc2l6ZSkgewo+ID4gLSAgICAgICAgcHJpdi0+cmVhZF9idWYgKz0gY291bnQ7
Cj4gPiAtICAgIH0gZWxzZSB7Cj4gPiAtICAgICAgICBwcml2LT5yZWFkX2J1ZiA9IE5VTEw7Cj4g
PiAtICAgIH0KPiA+IC0KPiA+IC0gICAgcmV0dXJuIGNvdW50Owo+ID4gKyAgICByZXR1cm4gcHJp
di0+aG9zdCAhPSBOVUxMICYmCj4gPiArICAgICAgICAgICBzcGljZV9jaGFubmVsX2dldF9zdGF0
ZShTUElDRV9DSEFOTkVMKGNoYW5uZWwpKSA9PSBTUElDRV9DSEFOTkVMX1NUQVRFX1JFQURZOwo+
ID4gIH0KPiA+Cj4gPiAgc3RhdGljIHZvaWQgdXNicmVkaXJfZnJlZV93cml0ZV9jYl9kYXRhKHVp
bnQ4X3QgKmRhdGEsIHZvaWQgKnVzZXJfZGF0YSkKPiA+IEBAIC02NjMsNyArNTc1LDcgQEAgc3Rh
dGljIHZvaWQgdXNicmVkaXJfZnJlZV93cml0ZV9jYl9kYXRhKHVpbnQ4X3QgKmRhdGEsIHZvaWQg
KnVzZXJfZGF0YSkKPiA+ICAgICAgU3BpY2VVc2JyZWRpckNoYW5uZWwgKmNoYW5uZWwgPSB1c2Vy
X2RhdGE7Cj4gPiAgICAgIFNwaWNlVXNicmVkaXJDaGFubmVsUHJpdmF0ZSAqcHJpdiA9IGNoYW5u
ZWwtPnByaXY7Cj4gPgo+ID4gLSAgICB1c2JyZWRpcmhvc3RfZnJlZV93cml0ZV9idWZmZXIocHJp
di0+aG9zdCwgZGF0YSk7Cj4gPiArICAgIHNwaWNlX3VzYl9iYWNrZW5kX3JldHVybl93cml0ZV9k
YXRhKHByaXYtPmhvc3QsIGRhdGEpOwo+ID4gIH0KPiA+Cj4gPiAgI2lmZGVmIFVTRV9MWjQKPiA+
IEBAIC03MzUsNyArNjQ3LDcgQEAgc3RhdGljIGludCB1c2JyZWRpcl93cml0ZV9jYWxsYmFjayh2
b2lkICp1c2VyX2RhdGEsIHVpbnQ4X3QgKmRhdGEsIGludCBjb3VudCkKPiA+Cj4gPiAgI2lmZGVm
IFVTRV9MWjQKPiA+ICAgICAgaWYgKHRyeV93cml0ZV9jb21wcmVzc19MWjQoY2hhbm5lbCwgZGF0
YSwgY291bnQpKSB7Cj4gPiAtICAgICAgICB1c2JyZWRpcmhvc3RfZnJlZV93cml0ZV9idWZmZXIo
Y2hhbm5lbC0+cHJpdi0+aG9zdCwgZGF0YSk7Cj4gPiArICAgICAgICBzcGljZV91c2JfYmFja2Vu
ZF9yZXR1cm5fd3JpdGVfZGF0YShjaGFubmVsLT5wcml2LT5ob3N0LCBkYXRhKTsKPiA+ICAgICAg
ICAgIHJldHVybiBjb3VudDsKPiA+ICAgICAgfQo+ID4gICNlbmRpZgo+ID4gQEAgLTc0OCwxNSAr
NjYwLDYgQEAgc3RhdGljIGludCB1c2JyZWRpcl93cml0ZV9jYWxsYmFjayh2b2lkICp1c2VyX2Rh
dGEsIHVpbnQ4X3QgKmRhdGEsIGludCBjb3VudCkKPiA+ICAgICAgcmV0dXJuIGNvdW50Owo+ID4g
IH0KPiA+Cj4gPiAtc3RhdGljIHZvaWQgKnVzYnJlZGlyX2FsbG9jX2xvY2sodm9pZCkgewo+ID4g
LSAgICBHTXV0ZXggKm11dGV4Owo+ID4gLQo+ID4gLSAgICBtdXRleCA9IGdfbmV3MChHTXV0ZXgs
IDEpOwo+ID4gLSAgICBnX211dGV4X2luaXQobXV0ZXgpOwo+ID4gLQo+ID4gLSAgICByZXR1cm4g
bXV0ZXg7Cj4gPiAtfQo+ID4gLQo+ID4gIEdfR05VQ19JTlRFUk5BTAo+ID4gIHZvaWQgc3BpY2Vf
dXNicmVkaXJfY2hhbm5lbF9sb2NrKFNwaWNlVXNicmVkaXJDaGFubmVsICpjaGFubmVsKQo+ID4g
IHsKPiA+IEBAIC03NjksMjUgKzY3Miw2IEBAIHZvaWQgc3BpY2VfdXNicmVkaXJfY2hhbm5lbF91
bmxvY2soU3BpY2VVc2JyZWRpckNoYW5uZWwgKmNoYW5uZWwpCj4gPiAgICAgIGdfbXV0ZXhfdW5s
b2NrKCZjaGFubmVsLT5wcml2LT5kZXZpY2VfY29ubmVjdF9tdXRleCk7Cj4gPiAgfQo+ID4KPiA+
IC1zdGF0aWMgdm9pZCB1c2JyZWRpcl9sb2NrX2xvY2sodm9pZCAqdXNlcl9kYXRhKSB7Cj4gPiAt
ICAgIEdNdXRleCAqbXV0ZXggPSB1c2VyX2RhdGE7Cj4gPiAtCj4gPiAtICAgIGdfbXV0ZXhfbG9j
ayhtdXRleCk7Cj4gPiAtfQo+ID4gLQo+ID4gLXN0YXRpYyB2b2lkIHVzYnJlZGlyX3VubG9ja19s
b2NrKHZvaWQgKnVzZXJfZGF0YSkgewo+ID4gLSAgICBHTXV0ZXggKm11dGV4ID0gdXNlcl9kYXRh
Owo+ID4gLQo+ID4gLSAgICBnX211dGV4X3VubG9jayhtdXRleCk7Cj4gPiAtfQo+ID4gLQo+ID4g
LXN0YXRpYyB2b2lkIHVzYnJlZGlyX2ZyZWVfbG9jayh2b2lkICp1c2VyX2RhdGEpIHsKPiA+IC0g
ICAgR011dGV4ICptdXRleCA9IHVzZXJfZGF0YTsKPiA+IC0KPiA+IC0gICAgZ19tdXRleF9jbGVh
cihtdXRleCk7Cj4gPiAtICAgIGdfZnJlZShtdXRleCk7Cj4gPiAtfQo+ID4gLQo+ID4gIC8qIC0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLSAqLwo+ID4KPiA+ICB0eXBlZGVmIHN0cnVjdCBkZXZpY2VfZXJyb3JfZGF0YSB7
Cj4gPiBAQCAtODI2LDcgKzcxMCw3IEBAIHN0YXRpYyB2b2lkIHNwaWNlX3VzYnJlZGlyX2NoYW5u
ZWxfdXAoU3BpY2VDaGFubmVsICpjKQo+ID4KPiA+ICAgICAgZ19yZXR1cm5faWZfZmFpbChwcml2
LT5ob3N0ICE9IE5VTEwpOwo+ID4gICAgICAvKiBGbHVzaCBhbnkgcGVuZGluZyB3cml0ZXMgKi8K
PiA+IC0gICAgdXNicmVkaXJob3N0X3dyaXRlX2d1ZXN0X2RhdGEocHJpdi0+aG9zdCk7Cj4gPiAr
ICAgIHNwaWNlX3VzYl9iYWNrZW5kX2NoYW5uZWxfdXAocHJpdi0+aG9zdCk7Cj4KPiBzcGljZV91
c2JfYmFja2VuZF9jaGFubmVsX3VwKCkgY2FsbHMKPiB1c2JyZWRpcmhvc3Rfd3JpdGVfZ3Vlc3Rf
ZGF0YSgpIHNvIElNSE8gYSBiZXR0ZXIgbmFtZSBpcyBuZWVkZWQKPiBmb3IgdGhpcyB3cmFwcGVy
LiBQZXJoYXBzIHNwaWNlX3VzYl9iYWNrZW5kX3dyaXRlX3RvX2d1ZXN0KCkgb3IKPiBzb21ldGhp
bmcuCgpGcm9tIG15IHBvaW50IG9mIHZpZXcsIHRoZSBuYW1lIGxpa2UgInNwaWNlX3VzYl9iYWNr
ZW5kX3dyaXRlX3RvX2d1ZXN0IgppcyBtdWNoIGxlc3MgY2xlYXIgYW5kIG1ha2VzIGltcHJlc3Np
b24gdGhhdCB0aGUgdXNiLXJlZGlyLWNoYW5uZWwgc2hvdWxkCnVzZSBpdCB0byB3cml0ZSBkYXRh
IHRvIGd1ZXN0IHdoZW4gaXQgaXMgbm90LgpUeXBpY2FsbHkgd2UgY2FsbCB1c2JyZWRpcmhvc3Rf
d3JpdGVfZ3Vlc3RfZGF0YSgpIG9ubHkgd2hlbiB3ZSByZWNlaXZlCidmbHVzaCcgY2FsbGJhY2sg
ZnJvbSB0aGUgdXNicmVkaXJob3N0IGFuZCBvbmx5IHdoZW4gd2UncmUgcmVhZHkgdG8Kc2VuZCBk
YXRhLiBCdXQgaXQgaXMgcG9zc2libGUgdGhhdCB3aGVuIHdlIGNyZWF0ZSB0aGUgaW5zdGFuY2Ug
b2YKdXNicmVkaXJob3N0LCB3ZSBhcmUgbm90IHJlYWR5IHRvIHNlbmQgZGF0YSB5ZXQgYW5kIHVz
YnJlZGlyaG9zdCBob2xkcwp0aGUgZGF0YSBidXQgbm90IGFibGUgdG8gc2VuZCB0aGVtOyBpdCB3
aWxsIG5vdCBpc3N1ZSBhbm90aGVyICdmbHVzaCcgY2FsbGJhY2sKdW50aWwgaXQgaGFzIGEgcmVh
c29uLiBTbywgd2hlbiB0aGUgY2hhbm5lbCBnZXRzIHVwLCB3ZSBtYWtlIHNpbmdsZQpjYWxsIHRv
IHVzYnJlZGlyaG9zdCB0byBmbHVzaCB0aGUgZGF0YSB0aGF0IGl0IGhhcyBpbnNpZGUgaWYgYW55
LiBUaGlzIGlzCmV4YWN0bHkgJ2NoYW5uZWwgaXMgdXAnIG5vdGlmaWNhdGlvbiB0byB0aGUgdXNi
IGJhY2tlbmQuCgo+Cj4gPiAgfQo+ID4KPiA+ICBzdGF0aWMgaW50IHRyeV9oYW5kbGVfY29tcHJl
c3NlZF9tc2coU3BpY2VNc2dDb21wcmVzc2VkRGF0YSAqY29tcHJlc3NlZF9kYXRhX21zZywKPiA+
IEBAIC04NzYsMjYgKzc2MCwyMCBAQCBzdGF0aWMgdm9pZCB1c2JyZWRpcl9oYW5kbGVfbXNnKFNw
aWNlQ2hhbm5lbCAqYywgU3BpY2VNc2dJbiAqaW4pCj4gPgo+ID4gICAgICBnX3JldHVybl9pZl9m
YWlsKHByaXYtPmhvc3QgIT0gTlVMTCk7Cj4gPgo+ID4gLSAgICAvKiBObyByZWN1cnNpb24gYWxs
b3dlZCEgKi8KPiA+IC0gICAgZ19yZXR1cm5faWZfZmFpbChwcml2LT5yZWFkX2J1ZiA9PSBOVUxM
KTsKPiA+IC0KPiA+ICAgICAgaWYgKHNwaWNlX21zZ19pbl90eXBlKGluKSA9PSBTUElDRV9NU0df
U1BJQ0VWTUNfQ09NUFJFU1NFRF9EQVRBKSB7Cj4gPiAgICAgICAgICBTcGljZU1zZ0NvbXByZXNz
ZWREYXRhICpjb21wcmVzc2VkX2RhdGFfbXNnID0gc3BpY2VfbXNnX2luX3BhcnNlZChpbik7Cj4g
PiAgICAgICAgICBpZiAodHJ5X2hhbmRsZV9jb21wcmVzc2VkX21zZyhjb21wcmVzc2VkX2RhdGFf
bXNnLCAmYnVmLCAmc2l6ZSkpIHsKPiA+IC0gICAgICAgICAgICBwcml2LT5yZWFkX2J1Zl9zaXpl
ID0gc2l6ZTsKPiA+IC0gICAgICAgICAgICBwcml2LT5yZWFkX2J1ZiA9IGJ1ZjsKPiA+ICsgICAg
ICAgICAgICAvKiB1bmNvbXByZXNzZWQgb2sqLwo+ID4gICAgICAgICAgfSBlbHNlIHsKPiA+IC0g
ICAgICAgICAgICByID0gdXNicmVkaXJob3N0X3JlYWRfcGFyc2VfZXJyb3I7Cj4gPiArICAgICAg
ICAgICAgciA9IFVTQl9SRURJUl9FUlJPUl9SRUFEX1BBUlNFOwo+ID4gICAgICAgICAgfQo+ID4g
ICAgICB9IGVsc2UgeyAvKiBSZWd1bGFyIFNQSUNFX01TR19TUElDRVZNQ19EQVRBIG1zZyAqLwo+
ID4gICAgICAgICAgYnVmID0gc3BpY2VfbXNnX2luX3JhdyhpbiwgJnNpemUpOwo+ID4gLSAgICAg
ICAgcHJpdi0+cmVhZF9idWZfc2l6ZSA9IHNpemU7Cj4gPiAtICAgICAgICBwcml2LT5yZWFkX2J1
ZiA9IGJ1ZjsKPiA+ICAgICAgfQo+ID4KPiA+ICAgICAgc3BpY2VfdXNicmVkaXJfY2hhbm5lbF9s
b2NrKGNoYW5uZWwpOwo+ID4gICAgICBpZiAociA9PSAwKQo+ID4gLSAgICAgICAgciA9IHVzYnJl
ZGlyaG9zdF9yZWFkX2d1ZXN0X2RhdGEocHJpdi0+aG9zdCk7Cj4gPiArICAgICAgICByID0gc3Bp
Y2VfdXNiX2JhY2tlbmRfcHJvdmlkZV9yZWFkX2RhdGEocHJpdi0+aG9zdCwgYnVmLCBzaXplKTsK
Pgo+IFBlcmhhcHMgc3BpY2VfdXNiX2JhY2tlbmRfcmVhZF9mcm9tX2d1ZXN0KCkKPgo+ID4gICAg
ICBpZiAociAhPSAwKSB7Cj4gPiAgICAgICAgICBTcGljZVVzYkRldmljZSAqc3BpY2VfZGV2aWNl
ID0gcHJpdi0+c3BpY2VfZGV2aWNlOwo+ID4gICAgICAgICAgZGV2aWNlX2Vycm9yX2RhdGEgZXJy
X2RhdGE7Cj4gPiBAQCAtOTA5LDE2ICs3ODcsMTYgQEAgc3RhdGljIHZvaWQgdXNicmVkaXJfaGFu
ZGxlX21zZyhTcGljZUNoYW5uZWwgKmMsIFNwaWNlTXNnSW4gKmluKQo+ID4KPiA+ICAgICAgICAg
IGRlc2MgPSBzcGljZV91c2JfZGV2aWNlX2dldF9kZXNjcmlwdGlvbihzcGljZV9kZXZpY2UsIE5V
TEwpOwo+ID4gICAgICAgICAgc3dpdGNoIChyKSB7Cj4gPiAtICAgICAgICBjYXNlIHVzYnJlZGly
aG9zdF9yZWFkX3BhcnNlX2Vycm9yOgo+ID4gKyAgICAgICAgY2FzZSBVU0JfUkVESVJfRVJST1Jf
UkVBRF9QQVJTRToKPiA+ICAgICAgICAgICAgICBlcnIgPSBnX2Vycm9yX25ldyhTUElDRV9DTElF
TlRfRVJST1IsIFNQSUNFX0NMSUVOVF9FUlJPUl9GQUlMRUQsCj4gPiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgXygidXNicmVkaXIgcHJvdG9jb2wgcGFyc2UgZXJyb3IgZm9yICVzIiks
IGRlc2MpOwo+ID4gICAgICAgICAgICAgIGJyZWFrOwo+ID4gLSAgICAgICAgY2FzZSB1c2JyZWRp
cmhvc3RfcmVhZF9kZXZpY2VfcmVqZWN0ZWQ6Cj4gPiArICAgICAgICBjYXNlIFVTQl9SRURJUl9F
UlJPUl9ERVZfUkVKRUNURUQ6Cj4gPiAgICAgICAgICAgICAgZXJyID0gZ19lcnJvcl9uZXcoU1BJ
Q0VfQ0xJRU5UX0VSUk9SLAo+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNQSUNF
X0NMSUVOVF9FUlJPUl9VU0JfREVWSUNFX1JFSkVDVEVELAo+ID4gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIF8oIiVzIHJlamVjdGVkIGJ5IGhvc3QiKSwgZGVzYyk7Cj4gPiAgICAgICAg
ICAgICAgYnJlYWs7Cj4gPiAtICAgICAgICBjYXNlIHVzYnJlZGlyaG9zdF9yZWFkX2RldmljZV9s
b3N0Ogo+ID4gKyAgICAgICAgY2FzZSBVU0JfUkVESVJfRVJST1JfREVWX0xPU1Q6Cj4KPiBBbiB1
dGlsaXR5IGZ1bmN0aW9uIGZyb20gdXNiLWJhY2tlbmQgdG8gbWFrZSBhbiBlcnJvciB0byBHRXJy
b3IKPiB3b3VsZCBiZSBnb29kIGZpdCBJIHRoaW5rLCB3aGljaCB3b3VsZCByZW1vdmUgdGhpcyBj
b2RlIGhlcmUgYXMKPiB3ZWxsLgo+Cj4gPiAgICAgICAgICAgICAgZXJyID0gZ19lcnJvcl9uZXco
U1BJQ0VfQ0xJRU5UX0VSUk9SLAo+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNQ
SUNFX0NMSUVOVF9FUlJPUl9VU0JfREVWSUNFX0xPU1QsCj4gPiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgXygiJXMgZGlzY29ubmVjdGVkIChmYXRhbCBJTyBlcnJvcikiKSwgZGVzYyk7
Cj4gPiBkaWZmIC0tZ2l0IGEvc3JjL21lc29uLmJ1aWxkIGIvc3JjL21lc29uLmJ1aWxkCj4gPiBp
bmRleCA1MzY1ZjA1Li5hNTFkMGE5IDEwMDY0NAo+ID4gLS0tIGEvc3JjL21lc29uLmJ1aWxkCj4g
PiArKysgYi9zcmMvbWVzb24uYnVpbGQKPiA+IEBAIC0xMjEsNiArMTIxLDggQEAgc3BpY2VfY2xp
ZW50X2dsaWJfc291cmNlcyA9IFsKPiA+ICAgICd1c2ItZGV2aWNlLW1hbmFnZXItcHJpdi5oJywK
PiA+ICAgICd1c2J1dGlsLmMnLAo+ID4gICAgJ3VzYnV0aWwuaCcsCj4gPiArICAndXNiLWJhY2tl
bmQuYycsCj4gPiArICAndXNiLWJhY2tlbmQuaCcsCj4gPiAgICAndm1jc3RyZWFtLmMnLAo+ID4g
ICAgJ3ZtY3N0cmVhbS5oJywKPiA+ICBdCj4gPiBkaWZmIC0tZ2l0IGEvc3JjL3VzYi1iYWNrZW5k
LmMgYi9zcmMvdXNiLWJhY2tlbmQuYwo+ID4gbmV3IGZpbGUgbW9kZSAxMDA2NDQKPiA+IGluZGV4
IDAwMDAwMDAuLjY3NWViNjIKPiA+IC0tLSAvZGV2L251bGwKPiA+ICsrKyBiL3NyYy91c2ItYmFj
a2VuZC5jCj4gPiBAQCAtMCwwICsxLDYyMiBAQAo+ID4gKy8qIC0qLSBNb2RlOiBDOyBjLWJhc2lj
LW9mZnNldDogNDsgaW5kZW50LXRhYnMtbW9kZTogbmlsIC0qLSAqLwo+ID4gKy8qCj4gPiArICAg
IENvcHlyaWdodCAoQykgMjAxMi0yMDE4IFJlZCBIYXQsIEluYy4KPiA+ICsKPiA+ICsgICAgUmVk
IEhhdCBBdXRob3JzOgo+ID4gKyAgICBZdXJpIEJlbmRpdG92aWNoPHliZW5kaXRvQHJlZGhhdC5j
b20+Cj4gPiArICAgIEhhbnMgZGUgR29lZGUgPGhkZWdvZWRlQHJlZGhhdC5jb20+Cj4gPiArCj4g
PiArICAgIFRoaXMgbGlicmFyeSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0
ZSBpdCBhbmQvb3IKPiA+ICsgICAgbW9kaWZ5IGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05V
IExlc3NlciBHZW5lcmFsIFB1YmxpYwo+ID4gKyAgICBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieSB0
aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIKPiA+ICsgICAgdmVyc2lvbiAyLjEg
b2YgdGhlIExpY2Vuc2UsIG9yIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCj4g
PiArCj4gPiArICAgIFRoaXMgbGlicmFyeSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0
IGl0IHdpbGwgYmUgdXNlZnVsLAo+ID4gKyAgICBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdp
dGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgo+ID4gKyAgICBNRVJDSEFOVEFCSUxJ
VFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlIEdOVQo+ID4g
KyAgICBMZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgo+ID4g
Kwo+ID4gKyAgICBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgTGVz
c2VyIEdlbmVyYWwgUHVibGljCj4gPiArICAgIExpY2Vuc2UgYWxvbmcgd2l0aCB0aGlzIGxpYnJh
cnk7IGlmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4KPiA+ICsqLwo+
ID4gKwo+ID4gKyNpbmNsdWRlICJjb25maWcuaCIKPiA+ICsKPiA+ICsjaWZkZWYgVVNFX1VTQlJF
RElSCj4gPiArCj4gPiArI2luY2x1ZGUgPGdsaWItb2JqZWN0Lmg+Cj4gPiArI2luY2x1ZGUgPGlu
dHR5cGVzLmg+Cj4gPiArI2luY2x1ZGUgPGdpby9naW8uaD4KPiA+ICsjaW5jbHVkZSA8ZXJybm8u
aD4KPiA+ICsjaW5jbHVkZSA8bGlidXNiLmg+Cj4gPiArI2luY2x1ZGUgPHN0cmluZy5oPgo+ID4g
KyNpbmNsdWRlIDxmY250bC5oPgo+ID4gKyNpbmNsdWRlICJ1c2JyZWRpcmhvc3QuaCIKPiA+ICsj
aW5jbHVkZSAidXNicmVkaXJwYXJzZXIuaCIKPiA+ICsjaW5jbHVkZSAic3BpY2UtdXRpbC5oIgo+
ID4gKyNpbmNsdWRlICJ1c2ItYmFja2VuZC5oIgo+ID4gKwo+ID4gKy8vI2RlZmluZSBMT1VEX0RF
QlVHIFNQSUNFX0RFQlVHCj4gPiArI2RlZmluZSBMT1VEX0RFQlVHKHgsIC4uLikKPgo+IEFueSBy
ZWFzb24gdGhpcyBpcyBiZWluZyBrZXB0PwoKVGhpcyBpcyBjbGVhciBwbGFjZSB3aGVyZSBsb3Vk
IHByaW50b3V0cyBjYW4gYmUgZW5hYmxlZApmb3IgZGVidWcgcHVycG9zZS4KCj4KPiA+ICsKPiA+
ICtzdHJ1Y3QgX1NwaWNlVXNiQmFja2VuZERldmljZQo+ID4gK3sKPiA+ICsgICAgbGlidXNiX2Rl
dmljZSAqbGlidXNiX2RldmljZTsKPiA+ICsgICAgZ2ludCByZWZfY291bnQ7Cj4gPiArICAgIFNw
aWNlVXNiQmFja2VuZENoYW5uZWwgKmF0dGFjaGVkX3RvOwo+ID4gKyAgICBVc2JEZXZpY2VJbmZv
cm1hdGlvbiBkZXZpY2VfaW5mbzsKPiA+ICt9Owo+ID4gKwo+ID4gK3N0cnVjdCBfU3BpY2VVc2JC
YWNrZW5kCj4gPiArewo+ID4gKyAgICBsaWJ1c2JfY29udGV4dCAqbGlidXNiX2NvbnRleHQ7Cj4g
PiArICAgIHVzYl9ob3RfcGx1Z19jYWxsYmFjayBob3RwbHVnX2NhbGxiYWNrOwo+ID4gKyAgICB2
b2lkICpob3RwbHVnX3VzZXJfZGF0YTsKPiA+ICsgICAgbGlidXNiX2hvdHBsdWdfY2FsbGJhY2tf
aGFuZGxlIGhvdHBsdWdfaGFuZGxlOwo+ID4gK307Cj4gPiArCj4gPiArc3RydWN0IF9TcGljZVVz
YkJhY2tlbmRDaGFubmVsCj4gPiArewo+ID4gKyAgICBzdHJ1Y3QgdXNicmVkaXJob3N0ICp1c2Jy
ZWRpcmhvc3Q7Cj4gPiArICAgIHVpbnQ4X3QgKnJlYWRfYnVmOwo+ID4gKyAgICBpbnQgcmVhZF9i
dWZfc2l6ZTsKPiA+ICsgICAgc3RydWN0IHVzYnJlZGlyZmlsdGVyX3J1bGUgKnJ1bGVzOwo+ID4g
KyAgICBpbnQgcnVsZXNfY291bnQ7Cj4gPiArICAgIFNwaWNlVXNiQmFja2VuZERldmljZSAqYXR0
YWNoZWQ7Cj4gPiArICAgIFNwaWNlVXNiQmFja2VuZENoYW5uZWxJbml0RGF0YSBjaGFubmVsX2Rh
dGE7Cj4gPiArICAgIEdFcnJvciAqKmVycm9yOwo+ID4gK307Cj4gPiArCj4gPiArLy8gbG9jayBm
dW5jdGlvbnMgZm9yIHVzYnJlZGlyaG9zdCBhbmQgdXNicmVkaXJwYXJzZXIKPiA+ICtzdGF0aWMg
dm9pZCAqdXNicmVkaXJfYWxsb2NfbG9jayh2b2lkKSB7Cj4gPiArICAgIEdNdXRleCAqbXV0ZXg7
Cj4gPiArCj4gPiArICAgIG11dGV4ID0gZ19uZXcwKEdNdXRleCwgMSk7Cj4gPiArICAgIGdfbXV0
ZXhfaW5pdChtdXRleCk7Cj4gPiArCj4gPiArICAgIHJldHVybiBtdXRleDsKPiA+ICt9Cj4gPiAr
Cj4gPiArc3RhdGljIHZvaWQgdXNicmVkaXJfZnJlZV9sb2NrKHZvaWQgKnVzZXJfZGF0YSkgewo+
ID4gKyAgICBHTXV0ZXggKm11dGV4ID0gdXNlcl9kYXRhOwo+ID4gKwo+ID4gKyAgICBnX211dGV4
X2NsZWFyKG11dGV4KTsKPiA+ICsgICAgZ19mcmVlKG11dGV4KTsKPiA+ICt9Cj4gPiArCj4gPiAr
c3RhdGljIHZvaWQgdXNicmVkaXJfbG9ja19sb2NrKHZvaWQgKnVzZXJfZGF0YSkgewo+ID4gKyAg
ICBHTXV0ZXggKm11dGV4ID0gdXNlcl9kYXRhOwo+ID4gKwo+ID4gKyAgICBnX211dGV4X2xvY2so
bXV0ZXgpOwo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgdm9pZCB1c2JyZWRpcl91bmxvY2tfbG9j
ayh2b2lkICp1c2VyX2RhdGEpIHsKPiA+ICsgICAgR011dGV4ICptdXRleCA9IHVzZXJfZGF0YTsK
PiA+ICsKPiA+ICsgICAgZ19tdXRleF91bmxvY2sobXV0ZXgpOwo+ID4gK30KPiA+ICsKPiA+ICtn
Ym9vbGVhbiBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfaXNvY2goU3BpY2VVc2JCYWNrZW5kRGV2
aWNlICpkZXYpCj4gPiArewo+ID4gKyAgICBsaWJ1c2JfZGV2aWNlICpsaWJkZXYgPSBkZXYtPmxp
YnVzYl9kZXZpY2U7Cj4gPiArICAgIHN0cnVjdCBsaWJ1c2JfY29uZmlnX2Rlc2NyaXB0b3IgKmNv
bmZfZGVzYzsKPiA+ICsgICAgZ2Jvb2xlYW4gaXNvY19mb3VuZCA9IEZBTFNFOwo+ID4gKyAgICBn
aW50IGksIGosIGs7Cj4gPiArCj4gPiArICAgIGdfcmV0dXJuX3ZhbF9pZl9mYWlsKGxpYmRldiAh
PSBOVUxMLCAwKTsKPiA+ICsKPiA+ICsgICAgaWYgKGxpYnVzYl9nZXRfYWN0aXZlX2NvbmZpZ19k
ZXNjcmlwdG9yKGxpYmRldiwgJmNvbmZfZGVzYykgIT0gMCkgewo+ID4gKyAgICAgICAgZ19yZXR1
cm5fdmFsX2lmX3JlYWNoZWQoMCk7Cj4KPiBBIHByb3BlciBkZWJ1Zy93YXJuaW5nIG1lc3NhZ2Ug
d291bGQgYmUgbmljZS4KPgo+ID4gKyAgICB9Cj4gPiArCj4gPiArICAgIGZvciAoaSA9IDA7ICFp
c29jX2ZvdW5kICYmIGkgPCBjb25mX2Rlc2MtPmJOdW1JbnRlcmZhY2VzOyBpKyspIHsKPiA+ICsg
ICAgICAgIGZvciAoaiA9IDA7ICFpc29jX2ZvdW5kICYmIGogPCBjb25mX2Rlc2MtPmludGVyZmFj
ZVtpXS5udW1fYWx0c2V0dGluZzsgaisrKSB7Cj4gPiArICAgICAgICAgICAgZm9yIChrID0gMDsg
IWlzb2NfZm91bmQgJiYgayA8IGNvbmZfZGVzYy0+aW50ZXJmYWNlW2ldLmFsdHNldHRpbmdbal0u
Yk51bUVuZHBvaW50cztrKyspIHsKPiA+ICsgICAgICAgICAgICAgICAgZ2ludCBhdHRyaWJ1dGVz
ID0gY29uZl9kZXNjLT5pbnRlcmZhY2VbaV0uYWx0c2V0dGluZ1tqXS5lbmRwb2ludFtrXS5ibUF0
dHJpYnV0ZXM7Cj4gPiArICAgICAgICAgICAgICAgIGdpbnQgdHlwZSA9IGF0dHJpYnV0ZXMgJiBM
SUJVU0JfVFJBTlNGRVJfVFlQRV9NQVNLOwo+ID4gKyAgICAgICAgICAgICAgICBpZiAodHlwZSA9
PSBMSUJVU0JfVFJBTlNGRVJfVFlQRV9JU09DSFJPTk9VUykKPiA+ICsgICAgICAgICAgICAgICAg
ICAgIGlzb2NfZm91bmQgPSBUUlVFOwo+Cj4gQWx3YXlzIG9wZW4vY2xvc2UgYnJhY2VzIHt9IGlu
IG5ldyBjb2RlCj4KPiA+ICsgICAgICAgICAgICB9Cj4gPiArICAgICAgICB9Cj4gPiArICAgIH0K
PiA+ICsKPiA+ICsgICAgbGlidXNiX2ZyZWVfY29uZmlnX2Rlc2NyaXB0b3IoY29uZl9kZXNjKTsK
PiA+ICsgICAgcmV0dXJuIGlzb2NfZm91bmQ7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyBnYm9v
bGVhbiBmaWxsX3VzYl9pbmZvKFNwaWNlVXNiQmFja2VuZERldmljZSAqYmRldikKPiA+ICt7Cj4g
PiArICAgIFVzYkRldmljZUluZm9ybWF0aW9uICppbmZvID0gJmJkZXYtPmRldmljZV9pbmZvOwo+
ID4gKwo+ID4gKyAgICBzdHJ1Y3QgbGlidXNiX2RldmljZV9kZXNjcmlwdG9yIGRlc2M7Cj4gPiAr
ICAgIGxpYnVzYl9kZXZpY2UgKmxpYmRldiA9IGJkZXYtPmxpYnVzYl9kZXZpY2U7Cj4gPiArICAg
IGxpYnVzYl9nZXRfZGV2aWNlX2Rlc2NyaXB0b3IobGliZGV2LCAmZGVzYyk7Cj4gPiArICAgIGlu
Zm8tPmJ1cyA9IGxpYnVzYl9nZXRfYnVzX251bWJlcihsaWJkZXYpOwo+ID4gKyAgICBpbmZvLT5h
ZGRyZXNzID0gbGlidXNiX2dldF9kZXZpY2VfYWRkcmVzcyhsaWJkZXYpOwo+ID4gKyAgICBpZiAo
aW5mby0+YWRkcmVzcyA9PSAweGZmIHx8IC8qIHJvb3QgaHViIChIQ0QpICovCj4gPiArICAgICAg
ICBpbmZvLT5hZGRyZXNzIDw9IDEgfHwgLyogcm9vdCBodWIgb3IgYmFkIGFkZHJlc3MgKi8KPiA+
ICsgICAgICAgIChkZXNjLmJEZXZpY2VDbGFzcyA9PSBMSUJVU0JfQ0xBU1NfSFVCKSAvKmh1Yiov
KSB7Cj4KPiBOb3RlIHRoYXQgdGhlcmUgaXMgYSBtaXggb2YgY29tbWVudCBzdHlsZSBhcyB3ZWxs
LCBpZiBJJ20gbm90Cj4gbWlzdGFrZW4gLyogaXMgcHJlZmVycmVkICovIG92ZXIgLy8gdGhpcwo+
Cj4gPiArICAgICAgICByZXR1cm4gRkFMU0U7Cj4gPiArICAgIH0KPiA+ICsKPiA+ICsgICAgaW5m
by0+dmlkID0gZGVzYy5pZFZlbmRvcjsKPiA+ICsgICAgaW5mby0+cGlkID0gZGVzYy5pZFByb2R1
Y3Q7Cj4gPiArICAgIGluZm8tPmNsYXNzID0gZGVzYy5iRGV2aWNlQ2xhc3M7Cj4gPiArICAgIGlu
Zm8tPnN1YmNsYXNzID0gZGVzYy5iRGV2aWNlU3ViQ2xhc3M7Cj4gPiArICAgIGluZm8tPnByb3Rv
Y29sID0gZGVzYy5iRGV2aWNlUHJvdG9jb2w7Cj4gPiArCj4gPiArICAgIHJldHVybiBUUlVFOwo+
ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgU3BpY2VVc2JCYWNrZW5kRGV2aWNlICphbGxvY2F0ZV9i
YWNrZW5kX2RldmljZShsaWJ1c2JfZGV2aWNlICpsaWJkZXYpCj4gPiArewo+ID4gKyAgICBTcGlj
ZVVzYkJhY2tlbmREZXZpY2UgKmRldiA9IGdfbmV3MChTcGljZVVzYkJhY2tlbmREZXZpY2UsIDEp
Owo+ID4gKyAgICBkZXYtPnJlZl9jb3VudCA9IDE7Cj4gPiArICAgIGRldi0+bGlidXNiX2Rldmlj
ZSA9IGxpYmRldjsKPiA+ICsgICAgaWYgKCFmaWxsX3VzYl9pbmZvKGRldikpIHsKPiA+ICsgICAg
ICAgIGdfZnJlZShkZXYpOwo+ID4gKyAgICAgICAgZGV2ID0gTlVMTDsKPgo+IGdfY2xlYXJfcG9p
bnRlcigmZGV2LCBnX2ZyZWUpOwo+Cj4gPiArICAgIH0KPiA+ICsgICAgcmV0dXJuIGRldjsKPiA+
ICt9Cj4gPiArCj4gPiArLyogTm90ZSB0aGF0IHRoaXMgZnVuY3Rpb24gbXVzdCBiZSByZS1lbnRy
YW50IHNhZmUsIGFzIGl0IGNhbiBnZXQgY2FsbGVkCj4gPiArZnJvbSBib3RoIHRoZSBtYWluIHRo
cmVhZCBhcyB3ZWxsIGFzIGZyb20gdGhlIHVzYiBldmVudCBoYW5kbGluZyB0aHJlYWQgKi8KPiA+
ICtzdGF0aWMgdm9pZCB1c2JyZWRpcl93cml0ZV9mbHVzaF9jYWxsYmFjayh2b2lkICp1c2VyX2Rh
dGEpCj4gPiArewo+ID4gKyAgICBTcGljZVVzYkJhY2tlbmRDaGFubmVsICpjaCA9IHVzZXJfZGF0
YTsKPiA+ICsgICAgZ2Jvb2xlYW4gb2sgPSBjaC0+Y2hhbm5lbF9kYXRhLmlzX2NoYW5uZWxfcmVh
ZHkoY2gtPmNoYW5uZWxfZGF0YS51c2VyX2RhdGEpOwo+ID4gKyAgICBpZiAob2sgJiYgY2gtPnVz
YnJlZGlyaG9zdCkgewo+Cj4gSSdkIG1vdmUgdGhlIGNoLT51c2JyZWRpcmhvc3QgdG8gaXRzIG93
biBjaGVjaywgcHJpb3IgdG8KPiBfaXNfY2hhbm5lbF9yZWFkeSgpLiBXaHkgZmx1c2hfY2FsbGJh
Y2sgY2FuIGJlIGNhbGxlZCB3aXRob3V0IGEKPiBjaC0+dXNicmVkaXJob3N0IGJlaW5nIHNldD8K
Pgo+ID4gKyAgICAgICAgU1BJQ0VfREVCVUcoIiVzIGNoICVwIC0+IHVzYnJlZGlyaG9zdCIsIF9f
RlVOQ1RJT05fXywgY2gpOwo+ID4gKyAgICAgICAgdXNicmVkaXJob3N0X3dyaXRlX2d1ZXN0X2Rh
dGEoY2gtPnVzYnJlZGlyaG9zdCk7Cj4gPiArICAgIH0gZWxzZSB7Cj4gPiArICAgICAgICBTUElD
RV9ERUJVRygiJXMgY2ggJXAgKG5vdCByZWFkeSkiLCBfX0ZVTkNUSU9OX18sIGNoKTsKPiA+ICsg
ICAgfQo+ID4gK30KPiA+ICsKPiA+ICtTcGljZVVzYkJhY2tlbmQgKnNwaWNlX3VzYl9iYWNrZW5k
X25ldyhHRXJyb3IgKiplcnJvcikKPiA+ICt7Cj4gPiArICAgIGludCByYzsKPiA+ICsgICAgU3Bp
Y2VVc2JCYWNrZW5kICpiZTsKPiA+ICsgICAgU1BJQ0VfREVCVUcoIiVzID4+IiwgX19GVU5DVElP
Tl9fKTsKPiA+ICsgICAgYmUgPSAoU3BpY2VVc2JCYWNrZW5kICopZ19uZXcwKFNwaWNlVXNiQmFj
a2VuZCwgMSk7Cj4KPiAiUmV0dXJucyBhIHBvaW50ZXIgdG8gdGhlIGFsbG9jYXRlZCBtZW1vcnks
IGNhc3QgdG8gYSBwb2ludGVyIHRvCj4gc3RydWN0X3R5cGUpIiB+IENhc3QgaXMgbm90IG5lZWRl
ZC4KPgo+ID4gKyAgICByYyA9IGxpYnVzYl9pbml0KCZiZS0+bGlidXNiX2NvbnRleHQpOwo+ID4g
KyAgICBpZiAocmMgPCAwKSB7Cj4gPiArICAgICAgICBjb25zdCBjaGFyICpkZXNjID0gbGlidXNi
X2Vycm9yX25hbWUocmMpOwo+ID4gKyAgICAgICAgZ193YXJuaW5nKCJFcnJvciBpbml0aWFsaXpp
bmcgTElCVVNCIHN1cHBvcnQ6ICVzIFslaV0iLCBkZXNjLCByYyk7Cj4gPiArICAgICAgICBnX3Nl
dF9lcnJvcihlcnJvciwgU1BJQ0VfQ0xJRU5UX0VSUk9SLCBTUElDRV9DTElFTlRfRVJST1JfRkFJ
TEVELAo+ID4gKyAgICAgICAgICAgICJFcnJvciBpbml0aWFsaXppbmcgTElCVVNCIHN1cHBvcnQ6
ICVzIFslaV0iLCBkZXNjLCByYyk7Cj4gPiArICAgICAgICBnX2ZyZWUoYmUpOwo+ID4gKyAgICAg
ICAgYmUgPSBOVUxMOwo+ID4gKyAgICB9IGVsc2Ugewo+ID4gKyNpZmRlZiBHX09TX1dJTjMyCj4g
PiArI2lmIExJQlVTQl9BUElfVkVSU0lPTiA+PSAweDAxMDAwMTA2Cj4gPiArICAgIGxpYnVzYl9z
ZXRfb3B0aW9uKGJlLT5saWJ1c2JfY29udGV4dCwgTElCVVNCX09QVElPTl9VU0VfVVNCREspOwo+
Cj4gSW5kZW50YXRpb24KPgo+ID4gKyNlbmRpZgo+ID4gKyNlbmRpZgo+ID4gKyAgICB9Cj4gPiAr
ICAgIFNQSUNFX0RFQlVHKCIlcyA8PCIsIF9fRlVOQ1RJT05fXyk7Cj4gPiArICAgIHJldHVybiBi
ZTsKPiA+ICt9Cj4gPiArCj4gPiArZ2Jvb2xlYW4gc3BpY2VfdXNiX2JhY2tlbmRfaGFuZGxlX2V2
ZW50cyhTcGljZVVzYkJhY2tlbmQgKmJlKQo+ID4gK3sKPiA+ICsgICAgU1BJQ0VfREVCVUcoIiVz
ID4+IiwgX19GVU5DVElPTl9fKTsKPiA+ICsgICAgZ2Jvb2xlYW4gb2sgPSBGQUxTRTsKPiA+ICsg
ICAgaWYgKGJlLT5saWJ1c2JfY29udGV4dCkgewo+ID4gKyAgICAgICAgaW50IHJlcyA9IGxpYnVz
Yl9oYW5kbGVfZXZlbnRzKGJlLT5saWJ1c2JfY29udGV4dCk7Cj4gPiArICAgICAgICBvayA9IHJl
cyA9PSAwOwo+ID4gKyAgICAgICAgaWYgKHJlcyAmJiByZXMgIT0gTElCVVNCX0VSUk9SX0lOVEVS
UlVQVEVEKSB7Cj4gPiArICAgICAgICAgICAgY29uc3QgY2hhciAqZGVzYyA9IGxpYnVzYl9lcnJv
cl9uYW1lKHJlcyk7Cj4gPiArICAgICAgICAgICAgZ193YXJuaW5nKCJFcnJvciBoYW5kbGluZyBV
U0IgZXZlbnRzOiAlcyBbJWldIiwgZGVzYywgcmVzKTsKPiA+ICsgICAgICAgICAgICBvayA9IEZB
TFNFOwo+ID4gKyAgICAgICAgfQo+ID4gKyAgICB9Cj4gPiArICAgIFNQSUNFX0RFQlVHKCIlcyA8
PCAlZCIsIF9fRlVOQ1RJT05fXywgb2spOwo+ID4gKyAgICByZXR1cm4gb2s7Cj4gPiArfQo+ID4g
Kwo+ID4gK3N0YXRpYyBpbnQgTElCVVNCX0NBTEwgaG90cGx1Z19jYWxsYmFjayhsaWJ1c2JfY29u
dGV4dCAqY3R4LAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBs
aWJ1c2JfZGV2aWNlICpkZXZpY2UsCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGxpYnVzYl9ob3RwbHVnX2V2ZW50IGV2ZW50LAo+ID4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICB2b2lkICp1c2VyX2RhdGEpCj4gPiArewo+ID4gKyAg
ICBTcGljZVVzYkJhY2tlbmQgKmJlID0gKFNwaWNlVXNiQmFja2VuZCAqKXVzZXJfZGF0YTsKPiA+
ICsgICAgaWYgKGJlLT5ob3RwbHVnX2NhbGxiYWNrKSB7Cj4gPiArICAgICAgICBTcGljZVVzYkJh
Y2tlbmREZXZpY2UgKmRldjsKPiA+ICsgICAgICAgIGdib29sZWFuIHZhbCA9IGV2ZW50ID09IExJ
QlVTQl9IT1RQTFVHX0VWRU5UX0RFVklDRV9BUlJJVkVEOwo+ID4gKyAgICAgICAgZGV2ID0gYWxs
b2NhdGVfYmFja2VuZF9kZXZpY2UoZGV2aWNlKTsKPiA+ICsgICAgICAgIGlmIChkZXYpIHsKPiA+
ICsgICAgICAgICAgICBTUElDRV9ERUJVRygiY3JlYXRlZCBkZXYgJXAsIHVzYmxpYiBkZXYgJXAi
LCBkZXYsIGRldmljZSk7Cj4gPiArICAgICAgICAgICAgbGlidXNiX3JlZl9kZXZpY2UoZGV2aWNl
KTsKPiA+ICsgICAgICAgICAgICBiZS0+aG90cGx1Z19jYWxsYmFjayhiZS0+aG90cGx1Z191c2Vy
X2RhdGEsIGRldiwgdmFsKTsKPiA+ICsgICAgICAgICAgICBzcGljZV91c2JfYmFja2VuZF9kZXZp
Y2VfdW5yZWYoZGV2KTsKPiA+ICsgICAgICAgIH0KPiA+ICsgICAgfQo+ID4gKyAgICByZXR1cm4g
MDsKPiA+ICt9Cj4gPiArCj4gPiArdm9pZCBzcGljZV91c2JfYmFja2VuZF9kZXJlZ2lzdGVyX2hv
dHBsdWcoU3BpY2VVc2JCYWNrZW5kICpiZSkKPiA+ICt7Cj4gPiArICAgIGdfcmV0dXJuX2lmX2Zh
aWwoYmUgIT0gTlVMTCk7Cj4gPiArICAgIGlmIChiZS0+aG90cGx1Z19oYW5kbGUpIHsKPiA+ICsg
ICAgICAgIGxpYnVzYl9ob3RwbHVnX2RlcmVnaXN0ZXJfY2FsbGJhY2soYmUtPmxpYnVzYl9jb250
ZXh0LCBiZS0+aG90cGx1Z19oYW5kbGUpOwo+ID4gKyAgICAgICAgYmUtPmhvdHBsdWdfaGFuZGxl
ID0gMDsKPiA+ICsgICAgfQo+ID4gKyAgICBiZS0+aG90cGx1Z19jYWxsYmFjayA9IE5VTEw7Cj4g
PiArfQo+ID4gKwo+ID4gK2dib29sZWFuIHNwaWNlX3VzYl9iYWNrZW5kX3JlZ2lzdGVyX2hvdHBs
dWcoU3BpY2VVc2JCYWNrZW5kICpiZSwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHZvaWQgKnVzZXJfZGF0YSwKPiA+ICsgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHVzYl9ob3RfcGx1Z19jYWxsYmFjayBwcm9jKQo+ID4g
K3sKPiA+ICsgICAgaW50IHJjOwo+ID4gKyAgICBnX3JldHVybl92YWxfaWZfZmFpbChiZSAhPSBO
VUxMLCBGQUxTRSk7Cj4gPiArCj4gPiArICAgIGJlLT5ob3RwbHVnX2NhbGxiYWNrID0gcHJvYzsK
PiA+ICsgICAgYmUtPmhvdHBsdWdfdXNlcl9kYXRhID0gdXNlcl9kYXRhOwo+ID4gKyAgICByYyA9
IGxpYnVzYl9ob3RwbHVnX3JlZ2lzdGVyX2NhbGxiYWNrKGJlLT5saWJ1c2JfY29udGV4dCwKPiA+
ICsgICAgICAgIExJQlVTQl9IT1RQTFVHX0VWRU5UX0RFVklDRV9BUlJJVkVEIHwgTElCVVNCX0hP
VFBMVUdfRVZFTlRfREVWSUNFX0xFRlQsCj4gPiArICAgICAgICBMSUJVU0JfSE9UUExVR19FTlVN
RVJBVEUsIExJQlVTQl9IT1RQTFVHX01BVENIX0FOWSwKPiA+ICsgICAgICAgIExJQlVTQl9IT1RQ
TFVHX01BVENIX0FOWSwgTElCVVNCX0hPVFBMVUdfTUFUQ0hfQU5ZLAo+ID4gKyAgICAgICAgaG90
cGx1Z19jYWxsYmFjaywgYmUsICZiZS0+aG90cGx1Z19oYW5kbGUpOwo+ID4gKyAgICBpZiAocmMg
IT0gTElCVVNCX1NVQ0NFU1MpIHsKPiA+ICsgICAgICAgIGNvbnN0IGNoYXIgKmRlc2MgPSBsaWJ1
c2JfZXJyb3JfbmFtZShyYyk7Cj4gPiArICAgICAgICBnX3dhcm5pbmcoIkVycm9yIGluaXRpYWxp
emluZyBVU0IgaG90cGx1ZyBzdXBwb3J0OiAlcyBbJWldIiwgZGVzYywgcmMpOwo+ID4gKyAgICAg
ICAgYmUtPmhvdHBsdWdfY2FsbGJhY2sgPSBOVUxMOwo+ID4gKyAgICAgICAgcmV0dXJuIEZBTFNF
Owo+ID4gKyAgICB9Cj4gPiArICAgIHJldHVybiBUUlVFOwo+ID4gK30KPiA+ICsKPiA+ICt2b2lk
IHNwaWNlX3VzYl9iYWNrZW5kX2RlbGV0ZShTcGljZVVzYkJhY2tlbmQgKmJlKQo+ID4gK3sKPiA+
ICsgICAgZ19yZXR1cm5faWZfZmFpbChiZSAhPSBOVUxMKTsKPiA+ICsgICAgU1BJQ0VfREVCVUco
IiVzID4+IiwgX19GVU5DVElPTl9fKTsKPiA+ICsgICAgaWYgKGJlLT5saWJ1c2JfY29udGV4dCkg
ewo+ID4gKyAgICAgICAgbGlidXNiX2V4aXQoYmUtPmxpYnVzYl9jb250ZXh0KTsKPiA+ICsgICAg
fQo+ID4gKyAgICBnX2ZyZWUoYmUpOwo+ID4gKyAgICBTUElDRV9ERUJVRygiJXMgPDwiLCBfX0ZV
TkNUSU9OX18pOwo+ID4gK30KPiA+ICsKPiA+ICtTcGljZVVzYkJhY2tlbmREZXZpY2UgKipzcGlj
ZV91c2JfYmFja2VuZF9nZXRfZGV2aWNlX2xpc3QoU3BpY2VVc2JCYWNrZW5kICpiZSkKPiA+ICt7
Cj4gPiArICAgIExPVURfREVCVUcoIiVzID4+IiwgX19GVU5DVElPTl9fKTsKPiA+ICsgICAgbGli
dXNiX2RldmljZSAqKmRldmxpc3QgPSBOVUxMLCAqKmRldjsKPiA+ICsgICAgU3BpY2VVc2JCYWNr
ZW5kRGV2aWNlICpkLCAqKmxpc3Q7Cj4gPiArCj4gPiArICAgIGludCBuID0gMCwgaW5kZXg7Cj4g
PiArCj4gPiArICAgIGlmIChiZSAmJiBiZS0+bGlidXNiX2NvbnRleHQpIHsKPiA+ICsgICAgICAg
IGxpYnVzYl9nZXRfZGV2aWNlX2xpc3QoYmUtPmxpYnVzYl9jb250ZXh0LCAmZGV2bGlzdCk7Cj4g
PiArICAgIH0KPiA+ICsKPiA+ICsgICAgLy8gYWRkIGFsbCB0aGUgbGlidXNiIGRldmljZSB0aGF0
IG5vdCBwcmVzZW50IGluIG91ciBsaXN0Cj4gPiArICAgIGZvciAoZGV2ID0gZGV2bGlzdDsgZGV2
ICYmICpkZXY7IGRldisrKSB7Cj4gPiArICAgICAgICBuKys7Cj4gPiArICAgIH0KPiA+ICsKPiA+
ICsgICAgbGlzdCA9IGdfbmV3MChTcGljZVVzYkJhY2tlbmREZXZpY2UqLCBuICsgMSk7Cj4gPiAr
Cj4gPiArICAgIGluZGV4ID0gMDsKPiA+ICsKPiA+ICsgICAgZm9yIChkZXYgPSBkZXZsaXN0OyBk
ZXYgJiYgKmRldjsgZGV2KyspIHsKPiA+ICsgICAgICAgIGQgPSBhbGxvY2F0ZV9iYWNrZW5kX2Rl
dmljZSgqZGV2KTsKPiA+ICsgICAgICAgIGlmICghZCkgewo+ID4gKyAgICAgICAgICAgIGxpYnVz
Yl91bnJlZl9kZXZpY2UoKmRldik7Cj4gPiArICAgICAgICB9IGVsc2Ugewo+ID4gKyAgICAgICAg
ICAgIFNQSUNFX0RFQlVHKCJjcmVhdGVkIGRldiAlcCwgdXNibGliIGRldiAlcCIsIGQsICpkZXYp
Owo+ID4gKyAgICAgICAgICAgIGxpc3RbaW5kZXgrK10gPSBkOwo+ID4gKyAgICAgICAgfQo+ID4g
KyAgICB9Cj4gPiArCj4gPiArICAgIGlmIChkZXZsaXN0KSB7Cj4gPiArICAgICAgICBsaWJ1c2Jf
ZnJlZV9kZXZpY2VfbGlzdChkZXZsaXN0LCAwKTsKPiA+ICsgICAgfQo+ID4gKwo+ID4gKyAgICBM
T1VEX0RFQlVHKCIlcyA8PCIsIF9fRlVOQ1RJT05fXyk7Cj4gPiArICAgIHJldHVybiBsaXN0Owo+
ID4gK30KPiA+ICsKPiA+ICtnYm9vbGVhbiBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfaXNfaHVi
KFNwaWNlVXNiQmFja2VuZERldmljZSAqZGV2KQo+ID4gK3sKPiA+ICsgICAgcmV0dXJuIGRldi0+
ZGV2aWNlX2luZm8uY2xhc3MgPT0gTElCVVNCX0NMQVNTX0hVQjsKPiA+ICt9Cj4gPiArCj4gPiAr
Y29uc3QgVXNiRGV2aWNlSW5mb3JtYXRpb24qIHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9nZXRf
aW5mbyhTcGljZVVzYkJhY2tlbmREZXZpY2UgKmRldikKPiA+ICt7Cj4gPiArICAgIHJldHVybiAm
ZGV2LT5kZXZpY2VfaW5mbzsKPiA+ICt9Cj4gPiArCj4gPiArZ2NvbnN0cG9pbnRlciBzcGljZV91
c2JfYmFja2VuZF9kZXZpY2VfZ2V0X2xpYmRldihTcGljZVVzYkJhY2tlbmREZXZpY2UgKmRldikK
PiA+ICt7Cj4gPiArICAgIHJldHVybiBkZXYtPmxpYnVzYl9kZXZpY2U7Cj4gPiArfQo+ID4gKwo+
ID4gK3ZvaWQgc3BpY2VfdXNiX2JhY2tlbmRfZnJlZV9kZXZpY2VfbGlzdChTcGljZVVzYkJhY2tl
bmREZXZpY2UgKipkZXZsaXN0KQo+ID4gK3sKPiA+ICsgICAgTE9VRF9ERUJVRygiJXMgPj4iLCBf
X0ZVTkNUSU9OX18pOwo+ID4gKyAgICBTcGljZVVzYkJhY2tlbmREZXZpY2UgKipkZXY7Cj4gPiAr
ICAgIGZvciAoZGV2ID0gZGV2bGlzdDsgKmRldjsgZGV2KyspIHsKPiA+ICsgICAgICAgIFNwaWNl
VXNiQmFja2VuZERldmljZSAqZCA9ICpkZXY7Cj4gPiArICAgICAgICBzcGljZV91c2JfYmFja2Vu
ZF9kZXZpY2VfdW5yZWYoZCk7Cj4gPiArICAgIH0KPiA+ICsgICAgZ19mcmVlKGRldmxpc3QpOwo+
ID4gKyAgICBMT1VEX0RFQlVHKCIlcyA8PCIsIF9fRlVOQ1RJT05fXyk7Cj4gPiArfQo+ID4gKwo+
ID4gK1NwaWNlVXNiQmFja2VuZERldmljZSAqc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX3JlZihT
cGljZVVzYkJhY2tlbmREZXZpY2UgKmRldikKPiA+ICt7Cj4gPiArICAgIExPVURfREVCVUcoIiVz
ID4+ICVwIiwgX19GVU5DVElPTl9fLCBkZXYpOwo+ID4gKyAgICBnX2F0b21pY19pbnRfaW5jKCZk
ZXYtPnJlZl9jb3VudCk7Cj4gPiArICAgIHJldHVybiBkZXY7Cj4gPiArfQo+ID4gKwo+ID4gK3Zv
aWQgc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX3VucmVmKFNwaWNlVXNiQmFja2VuZERldmljZSAq
ZGV2KQo+ID4gK3sKPiA+ICsgICAgTE9VRF9ERUJVRygiJXMgPj4gJXAoJWQpIiwgX19GVU5DVElP
Tl9fLCBkZXYsIGRldi0+cmVmX2NvdW50KTsKPiA+ICsgICAgaWYgKGdfYXRvbWljX2ludF9kZWNf
YW5kX3Rlc3QoJmRldi0+cmVmX2NvdW50KSkgewo+ID4gKyAgICAgICAgbGlidXNiX3VucmVmX2Rl
dmljZShkZXYtPmxpYnVzYl9kZXZpY2UpOwo+ID4gKyAgICAgICAgTE9VRF9ERUJVRygiJXMgZnJl
ZWluZyAlcCAobGlidXNiICVwKSIsIF9fRlVOQ1RJT05fXywgZGV2LCBkZXYtPmxpYnVzYl9kZXZp
Y2UpOwo+ID4gKyAgICAgICAgZ19mcmVlKGRldik7Cj4gPiArICAgIH0KPiA+ICt9Cj4gPiArCj4g
PiAraW50IHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9jaGVja19maWx0ZXIoCj4gPiArICAgIFNw
aWNlVXNiQmFja2VuZERldmljZSAqZGV2LAo+ID4gKyAgICBjb25zdCBzdHJ1Y3QgdXNicmVkaXJm
aWx0ZXJfcnVsZSAqcnVsZXMsCj4gPiArICAgIGludCBjb3VudCkKPiA+ICt7Cj4gPiArICAgIHJl
dHVybiB1c2JyZWRpcmhvc3RfY2hlY2tfZGV2aWNlX2ZpbHRlcigKPiA+ICsgICAgICAgIHJ1bGVz
LCBjb3VudCwgZGV2LT5saWJ1c2JfZGV2aWNlLCAwKTsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGlj
IGludCB1c2JyZWRpcl9yZWFkX2NhbGxiYWNrKHZvaWQgKnVzZXJfZGF0YSwgdWludDhfdCAqZGF0
YSwgaW50IGNvdW50KQo+ID4gK3sKPiA+ICsgICAgU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCAqY2gg
PSB1c2VyX2RhdGE7Cj4gPiArCj4gPiArICAgIGNvdW50ID0gTUlOKGNoLT5yZWFkX2J1Zl9zaXpl
LCBjb3VudCk7Cj4gPiArCj4gPiArICAgIGlmIChjb3VudCAhPSAwKSB7Cj4gPiArICAgICAgICBt
ZW1jcHkoZGF0YSwgY2gtPnJlYWRfYnVmLCBjb3VudCk7Cj4gPiArICAgIH0KPiA+ICsKPiA+ICsg
ICAgY2gtPnJlYWRfYnVmX3NpemUgLT0gY291bnQ7Cj4gPiArICAgIGlmIChjaC0+cmVhZF9idWZf
c2l6ZSkgewo+ID4gKyAgICAgICAgY2gtPnJlYWRfYnVmICs9IGNvdW50Owo+ID4gKyAgICB9Cj4g
PiArICAgIGVsc2Ugewo+ID4gKyAgICAgICAgY2gtPnJlYWRfYnVmID0gTlVMTDsKPiA+ICsgICAg
fQo+ID4gKyAgICBTUElDRV9ERUJVRygiJXMgY2ggJXAsICVkIGJ5dGVzIiwgX19GVU5DVElPTl9f
LCBjaCwgY291bnQpOwo+ID4gKwo+ID4gKyAgICByZXR1cm4gY291bnQ7Cj4gPiArfQo+ID4gKwo+
ID4gK3N0YXRpYyBjb25zdCBjaGFyICpzdHJpcF91c2JyZWRpcl9wcmVmaXgoY29uc3QgY2hhciAq
bXNnKQo+ID4gK3sKPiA+ICsgICAgaWYgKHN0cm5jbXAobXNnLCAidXNicmVkaXJob3N0OiAiLCAx
NCkgPT0gMCkgewo+ID4gKyAgICAgICAgbXNnICs9IDE0Owo+ID4gKyAgICB9Cj4gPiArICAgIHJl
dHVybiBtc2c7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyB2b2lkIGNoYW5uZWxfZXJyb3IoU3Bp
Y2VVc2JCYWNrZW5kQ2hhbm5lbCAqY2gsIGNvbnN0IGNoYXIgKm1zZykKPiA+ICt7Cj4gPiArICAg
IGlmICghY2gtPmVycm9yKQo+ID4gKyAgICAgICAgcmV0dXJuOwo+ID4gKyAgICBnX3NldF9lcnJv
cl9saXRlcmFsKGNoLT5lcnJvciwgU1BJQ0VfQ0xJRU5UX0VSUk9SLCBTUElDRV9DTElFTlRfRVJS
T1JfRkFJTEVELCBtc2cpOwo+ID4gKyAgICBjaC0+ZXJyb3IgPSBOVUxMOwo+ID4gK30KPiA+ICsK
PiA+ICtzdGF0aWMgdm9pZCB1c2JyZWRpcl9sb2codm9pZCAqdXNlcl9kYXRhLCBpbnQgbGV2ZWws
IGNvbnN0IGNoYXIgKm1zZykKPiA+ICt7Cj4gPiArICAgIFNwaWNlVXNiQmFja2VuZENoYW5uZWwg
KmNoID0gKFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKil1c2VyX2RhdGE7Cj4gPiArICAgIGNvbnN0
IGNoYXIgKnN0cmlwcGVkX21zZyA9IHN0cmlwX3VzYnJlZGlyX3ByZWZpeChtc2cpOwo+ID4gKyAg
ICBzd2l0Y2ggKGxldmVsKSB7Cj4gPiArICAgIGNhc2UgdXNicmVkaXJwYXJzZXJfZXJyb3I6Cj4g
PiArICAgICAgICBnX2NyaXRpY2FsKCIlcyIsIG1zZyk7Cj4gPiArICAgICAgICBjaGFubmVsX2Vy
cm9yKGNoLCBzdHJpcHBlZF9tc2cpOwo+ID4gKyAgICAgICAgYnJlYWs7Cj4gPiArICAgIGNhc2Ug
dXNicmVkaXJwYXJzZXJfd2FybmluZzoKPiA+ICsgICAgICAgIGdfd2FybmluZygiJXMiLCBtc2cp
Owo+ID4gKyAgICAgICAgY2hhbm5lbF9lcnJvcihjaCwgc3RyaXBwZWRfbXNnKTsKPiA+ICsgICAg
ICAgIGJyZWFrOwo+ID4gKyAgICBkZWZhdWx0Ogo+ID4gKyAgICAgICAgYnJlYWs7Cj4gPiArICAg
IH0KPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIGludCB1c2JyZWRpcl93cml0ZV9jYWxsYmFjayh2
b2lkICp1c2VyX2RhdGEsIHVpbnQ4X3QgKmRhdGEsIGludCBjb3VudCkKPiA+ICt7Cj4gPiArICAg
IFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmNoID0gdXNlcl9kYXRhOwo+ID4gKyAgICBpbnQgcmVz
Owo+ID4gKyAgICBTUElDRV9ERUJVRygiJXMgY2ggJXAsICVkIGJ5dGVzIiwgX19GVU5DVElPTl9f
LCBjaCwgY291bnQpOwo+ID4gKyAgICByZXMgPSBjaC0+Y2hhbm5lbF9kYXRhLndyaXRlX2NhbGxi
YWNrKGNoLT5jaGFubmVsX2RhdGEudXNlcl9kYXRhLCBkYXRhLCBjb3VudCk7Cj4gPiArICAgIHJl
dHVybiByZXM7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyB1aW50NjRfdCB1c2JyZWRpcl9idWZm
ZXJlZF9vdXRwdXRfc2l6ZV9jYWxsYmFjayh2b2lkICp1c2VyX2RhdGEpCj4gPiArewo+ID4gKyAg
ICBTcGljZVVzYkJhY2tlbmRDaGFubmVsICpjaCA9IHVzZXJfZGF0YTsKPiA+ICsgICAgcmV0dXJu
IGNoLT5jaGFubmVsX2RhdGEuZ2V0X3F1ZXVlX3NpemUoY2gtPmNoYW5uZWxfZGF0YS51c2VyX2Rh
dGEpOwo+ID4gK30KPiA+ICsKPiA+ICtpbnQgc3BpY2VfdXNiX2JhY2tlbmRfcHJvdmlkZV9yZWFk
X2RhdGEoU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCAqY2gsIHVpbnQ4X3QgKmRhdGEsIGludCBjb3Vu
dCkKPiA+ICt7Cj4gPiArICAgIGludCByZXMgPSAwOwo+ID4gKwo+ID4gKyAgICBnX3JldHVybl92
YWxfaWZfZmFpbChjaC0+cmVhZF9idWYgPT0gTlVMTCwgVVNCX1JFRElSX0VSUk9SX1JFQURfUEFS
U0UpOwo+ID4gKwo+ID4gKyAgICBjaC0+cmVhZF9idWYgPSBkYXRhOwo+ID4gKyAgICBjaC0+cmVh
ZF9idWZfc2l6ZSA9IGNvdW50Owo+ID4gKyAgICBpZiAoY2gtPnVzYnJlZGlyaG9zdCkgewo+ID4g
KyAgICAgICAgcmVzID0gdXNicmVkaXJob3N0X3JlYWRfZ3Vlc3RfZGF0YShjaC0+dXNicmVkaXJo
b3N0KTsKPiA+ICsgICAgfSBlbHNlIHsKPiA+ICsgICAgICAgIHJlcyA9IFVTQl9SRURJUl9FUlJP
Ul9JTzsKPiA+ICsgICAgfQo+ID4gKyAgICBzd2l0Y2ggKHJlcykKPiA+ICsgICAgewo+ID4gKyAg
ICBjYXNlIHVzYnJlZGlyaG9zdF9yZWFkX2lvX2Vycm9yOgo+ID4gKyAgICAgICAgcmVzID0gVVNC
X1JFRElSX0VSUk9SX0lPOwo+ID4gKyAgICAgICAgYnJlYWs7Cj4gPiArICAgIGNhc2UgdXNicmVk
aXJob3N0X3JlYWRfcGFyc2VfZXJyb3I6Cj4gPiArICAgICAgICByZXMgPSBVU0JfUkVESVJfRVJS
T1JfUkVBRF9QQVJTRTsKPiA+ICsgICAgICAgIGJyZWFrOwo+ID4gKyAgICBjYXNlIHVzYnJlZGly
aG9zdF9yZWFkX2RldmljZV9yZWplY3RlZDoKPiA+ICsgICAgICAgIHJlcyA9IFVTQl9SRURJUl9F
UlJPUl9ERVZfUkVKRUNURUQ7Cj4gPiArICAgICAgICBicmVhazsKPiA+ICsgICAgY2FzZSB1c2Jy
ZWRpcmhvc3RfcmVhZF9kZXZpY2VfbG9zdDoKPiA+ICsgICAgICAgIHJlcyA9IFVTQl9SRURJUl9F
UlJPUl9ERVZfTE9TVDsKPiA+ICsgICAgICAgIGJyZWFrOwo+ID4gKyAgICB9Cj4gPiArICAgIFNQ
SUNFX0RFQlVHKCIlcyBjaCAlcCwgJWQgYnl0ZXMsIHJlcyAlZCIsIF9fRlVOQ1RJT05fXywgY2gs
IGNvdW50LCByZXMpOwo+ID4gKwo+ID4gKyAgICByZXR1cm4gcmVzOwo+ID4gK30KPiA+ICsKPiA+
ICt2b2lkIHNwaWNlX3VzYl9iYWNrZW5kX3JldHVybl93cml0ZV9kYXRhKFNwaWNlVXNiQmFja2Vu
ZENoYW5uZWwgKmNoLCB2b2lkICpkYXRhKQo+ID4gK3sKPiA+ICsgICAgaWYgKGNoLT51c2JyZWRp
cmhvc3QpIHsKPiA+ICsgICAgICAgIFNQSUNFX0RFQlVHKCIlcyBjaCAlcCIsIF9fRlVOQ1RJT05f
XywgY2gpOwo+ID4gKyAgICAgICAgdXNicmVkaXJob3N0X2ZyZWVfd3JpdGVfYnVmZmVyKGNoLT51
c2JyZWRpcmhvc3QsIGRhdGEpOwo+ID4gKyAgICB9IGVsc2Ugewo+ID4gKyAgICAgICAgU1BJQ0Vf
REVCVUcoIiVzIGNoICVwIC0gTk9CT0RZIFRPIENBTEwiLCBfX0ZVTkNUSU9OX18sIGNoKTsKPiA+
ICsgICAgfQo+ID4gK30KPiA+ICsKPiA+ICtnYm9vbGVhbiBzcGljZV91c2JfYmFja2VuZF9jaGFu
bmVsX2F0dGFjaChTcGljZVVzYkJhY2tlbmRDaGFubmVsICpjaCwKPiA+ICsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTcGljZVVzYkJhY2tlbmREZXZpY2UgKmRldiwK
PiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBHRXJyb3IgKipl
cnJvcikKPiA+ICt7Cj4gPiArICAgIFNQSUNFX0RFQlVHKCIlcyA+PiBjaCAlcCwgZGV2ICVwICh3
YXMgYXR0YWNoZWQgJXApIiwgX19GVU5DVElPTl9fLCBjaCwgZGV2LCBjaC0+YXR0YWNoZWQpOwo+
ID4gKyAgICBnYm9vbGVhbiBvayA9IEZBTFNFOwo+Cj4gSSB0aGluayB0aGlzIG9rIHZhcmlhYmxl
IGlzIGp1c3QgbWFraW5nIHRoZSBjb2RlIGEgYml0IG1vcmUKPiBjb21wbGljYXRlZC4KPgo+ID4g
KyAgICBpZiAoIWRldikgewo+ID4gKyAgICAgICAgcmV0dXJuIG9rOwo+ID4gKyAgICB9Cj4KPiBX
aHkgbm90IGdfcmV0dXJuX3ZhbF9pZl9mYWlsKGRldiAhPSBOVUxMLCBGQUxTRSk7Cj4KPiA+ICsK
PiA+ICsgICAgbGlidXNiX2RldmljZV9oYW5kbGUgKmhhbmRsZSA9IE5VTEw7Cj4gPiArICAgIGlu
dCByYyA9IGxpYnVzYl9vcGVuKGRldi0+bGlidXNiX2RldmljZSwgJmhhbmRsZSk7Cj4KPiAgICAg
aWYgKHJjICE9IDApIHsKPiAgICAgICAgIC8qIGVycm9yIHBhcnQgZmlyc3QgKi8KPiAgICAgfQo+
ICAgICAuLi4KPiAgICAgcmMgPSB1c2JyZWRpcmhvc3Rfc2V0X2RldmljZShjaC0+dXNicmVkaXJo
b3N0LCBoYW5kbGUpOwo+ICAgICBpZiAocmMgIT0gMCkgewo+ICAgICAgICAgLyogZXJyb3IgcGFy
dCBmaXJzdCAqLwo+ICAgICB9Cj4gICAgIC4uLgo+ICAgICBjaC0+ZXJyb3IgPSBOVUxMOwo+ICAg
ICByZXR1cm4gVFJVRTsKPiAgfQo+Cj4gPiArICAgIG9rID0gcmMgPT0gMDsKPiA+ICsgICAgaWYg
KG9rKSB7Cj4gPiArICAgICAgICBjaC0+ZXJyb3IgPSBlcnJvcjsKPiA+ICsgICAgICAgIHJjID0g
dXNicmVkaXJob3N0X3NldF9kZXZpY2UoY2gtPnVzYnJlZGlyaG9zdCwgaGFuZGxlKTsKPiA+ICsg
ICAgICAgIGlmIChyYykgewo+ID4gKyAgICAgICAgICAgIFNQSUNFX0RFQlVHKCIlcyBjaCAlcCwg
ZGV2ICVwIHVzYnJlZGlyaG9zdCBlcnJvciAlZCIsIF9fRlVOQ1RJT05fXywgY2gsIGRldiwgcmMp
Owo+ID4gKyAgICAgICAgICAgIG9rID0gRkFMU0U7Cj4gPiArICAgICAgICB9IGVsc2Ugewo+ID4g
KyAgICAgICAgICAgIGNoLT5hdHRhY2hlZCA9IGRldjsKPiA+ICsgICAgICAgICAgICBkZXYtPmF0
dGFjaGVkX3RvID0gY2g7Cj4gPiArICAgICAgICB9Cj4gPiArICAgICAgICBjaC0+ZXJyb3IgPSBO
VUxMOwo+ID4gKyAgICB9IGVsc2Ugewo+ID4gKyAgICAgICAgY29uc3QgY2hhciAqZGVzYyA9IGxp
YnVzYl9lcnJvcl9uYW1lKHJjKTsKPiA+ICsgICAgICAgIGdfc2V0X2Vycm9yKGVycm9yLCBTUElD
RV9DTElFTlRfRVJST1IsIFNQSUNFX0NMSUVOVF9FUlJPUl9GQUlMRUQsCj4gPiArICAgICAgICAg
ICAiRXJyb3IgbGlidXNiX29wZW46ICVzIFslaV0iLCBkZXNjLCByYyk7Cj4gPiArICAgIH0KPiA+
ICsKPiA+ICsgICAgcmV0dXJuIG9rOwo+ID4gK30KPiA+ICsKPiA+ICt2b2lkIHNwaWNlX3VzYl9i
YWNrZW5kX2NoYW5uZWxfZGV0YWNoKFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmNoKQo+ID4gK3sK
PiA+ICsgICAgU1BJQ0VfREVCVUcoIiVzID4+IGNoICVwLCB3YXMgYXR0YWNoZWQgJXAiLCBfX0ZV
TkNUSU9OX18sIGNoLCBjaC0+YXR0YWNoZWQpOwo+ID4gKyAgICBpZiAoIWNoLT5hdHRhY2hlZCkg
ewo+ID4gKyAgICAgICAgU1BJQ0VfREVCVUcoIiVzOiBub3RoaW5nIHRvIGRldGFjaCIsIF9fRlVO
Q1RJT05fXyk7Cj4gPiArICAgICAgICByZXR1cm47Cj4gPiArICAgIH0KPiA+ICsgICAgaWYgKGNo
LT51c2JyZWRpcmhvc3QpIHsKPiA+ICsgICAgICAgIC8vIGl0IHdpbGwgY2FsbCBsaWJ1c2JfY2xv
c2UgaW50ZXJuYWxseQo+ID4gKyAgICAgICAgdXNicmVkaXJob3N0X3NldF9kZXZpY2UoY2gtPnVz
YnJlZGlyaG9zdCwgTlVMTCk7Cj4gPiArICAgIH0KPiA+ICsgICAgU1BJQ0VfREVCVUcoIiVzIGNo
ICVwLCBkZXRhY2ggZG9uZSIsIF9fRlVOQ1RJT05fXywgY2gpOwo+ID4gKyAgICBjaC0+YXR0YWNo
ZWQtPmF0dGFjaGVkX3RvID0gTlVMTDsKPiA+ICsgICAgY2gtPmF0dGFjaGVkID0gTlVMTDsKPiA+
ICt9Cj4gPiArCj4gPiArU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCAqc3BpY2VfdXNiX2JhY2tlbmRf
Y2hhbm5lbF9uZXcoU3BpY2VVc2JCYWNrZW5kICpiZSwKPiA+ICsgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBTcGljZVVzYkJhY2tlbmRD
aGFubmVsSW5pdERhdGEgKmluaXRfZGF0YSkKPiA+ICt7Cj4gPiArICAgIFNwaWNlVXNiQmFja2Vu
ZENoYW5uZWwgKmNoID0gZ19uZXcwKFNwaWNlVXNiQmFja2VuZENoYW5uZWwsIDEpOwo+ID4gKyAg
ICBTUElDRV9ERUJVRygiJXMgPj4iLCBfX0ZVTkNUSU9OX18pOwo+ID4gKyAgICBjaC0+Y2hhbm5l
bF9kYXRhID0gKmluaXRfZGF0YTsKPiA+ICsgICAgaWYgKGJlLT5saWJ1c2JfY29udGV4dCkgewo+
ID4gKyAgICAgICAgY2gtPnVzYnJlZGlyaG9zdCA9IHVzYnJlZGlyaG9zdF9vcGVuX2Z1bGwoCj4g
PiArICAgICAgICAgICAgYmUtPmxpYnVzYl9jb250ZXh0LAo+ID4gKyAgICAgICAgICAgIE5VTEws
Cj4gPiArICAgICAgICAgICAgdXNicmVkaXJfbG9nLAo+ID4gKyAgICAgICAgICAgIHVzYnJlZGly
X3JlYWRfY2FsbGJhY2ssCj4gPiArICAgICAgICAgICAgdXNicmVkaXJfd3JpdGVfY2FsbGJhY2ss
Cj4gPiArICAgICAgICAgICAgdXNicmVkaXJfd3JpdGVfZmx1c2hfY2FsbGJhY2ssCj4gPiArICAg
ICAgICAgICAgdXNicmVkaXJfYWxsb2NfbG9jaywKPiA+ICsgICAgICAgICAgICB1c2JyZWRpcl9s
b2NrX2xvY2ssCj4gPiArICAgICAgICAgICAgdXNicmVkaXJfdW5sb2NrX2xvY2ssCj4gPiArICAg
ICAgICAgICAgdXNicmVkaXJfZnJlZV9sb2NrLAo+ID4gKyAgICAgICAgICAgIGNoLCBQQUNLQUdF
X1NUUklORywKPiA+ICsgICAgICAgICAgICBzcGljZV91dGlsX2dldF9kZWJ1ZygpID8gdXNicmVk
aXJwYXJzZXJfZGVidWcgOiB1c2JyZWRpcnBhcnNlcl93YXJuaW5nLAo+ID4gKyAgICAgICAgICAg
IHVzYnJlZGlyaG9zdF9mbF93cml0ZV9jYl9vd25zX2J1ZmZlcik7Cj4gPiArICAgICAgICBnX3dh
cm5faWZfZmFpbChjaC0+dXNicmVkaXJob3N0ICE9IE5VTEwpOwo+ID4gKyAgICB9Cj4gPiArICAg
IGlmIChjaC0+dXNicmVkaXJob3N0KSB7Cj4gPiArICAgICAgICB1c2JyZWRpcmhvc3Rfc2V0X2J1
ZmZlcmVkX291dHB1dF9zaXplX2NiKGNoLT51c2JyZWRpcmhvc3QsIHVzYnJlZGlyX2J1ZmZlcmVk
X291dHB1dF9zaXplX2NhbGxiYWNrKTsKPiA+ICsgICAgfSBlbHNlIHsKPiA+ICsgICAgICAgIGdf
ZnJlZShjaCk7Cj4gPiArICAgICAgICBjaCA9IE5VTEw7Cj4gPiArICAgIH0KPiA+ICsKPiA+ICsg
ICAgU1BJQ0VfREVCVUcoIiVzIDw8ICVwIiwgX19GVU5DVElPTl9fLCBjaCk7Cj4gPiArICAgIHJl
dHVybiBjaDsKPiA+ICt9Cj4gPiArCj4gPiArdm9pZCBzcGljZV91c2JfYmFja2VuZF9jaGFubmVs
X3VwKFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmNoKQo+ID4gK3sKPiA+ICsgICAgU1BJQ0VfREVC
VUcoIiVzICVwLCBob3N0ICVwIiwgX19GVU5DVElPTl9fLCBjaCwgY2gtPnVzYnJlZGlyaG9zdCk7
Cj4gPiArICAgIGlmIChjaC0+dXNicmVkaXJob3N0KSB7Cj4gPiArICAgICAgICB1c2JyZWRpcmhv
c3Rfd3JpdGVfZ3Vlc3RfZGF0YShjaC0+dXNicmVkaXJob3N0KTsKPiA+ICsgICAgfQo+ID4gK30K
PiA+ICsKPiA+ICt2b2lkIHNwaWNlX3VzYl9iYWNrZW5kX2NoYW5uZWxfZGVsZXRlKFNwaWNlVXNi
QmFja2VuZENoYW5uZWwgKmNoKQo+ID4gK3sKPiA+ICsgICAgU1BJQ0VfREVCVUcoIiVzID4+ICVw
IiwgX19GVU5DVElPTl9fLCBjaCk7Cj4KPiBQZXJoYXBzIGlmIChjaCA9PSBOVUxMKSB7IHJldHVy
bjsgfSBjb3VsZCByZW1vdmUgc29tZSBjaGVja3Mgb24KPiB0aGUgY2FsbGVyIHNpZGUuCj4KPiA+
ICsgICAgaWYgKGNoLT51c2JyZWRpcmhvc3QpIHsKPiA+ICsgICAgICAgIHVzYnJlZGlyaG9zdF9j
bG9zZShjaC0+dXNicmVkaXJob3N0KTsKPiA+ICsgICAgfQo+ID4gKwo+ID4gKyAgICBpZiAoY2gt
PnJ1bGVzKSB7Cj4gPiArICAgICAgICBnX2ZyZWUoY2gtPnJ1bGVzKTsKPiA+ICsgICAgfQo+ID4g
Kwo+ID4gKyAgICBnX2ZyZWUoY2gpOwo+ID4gKyAgICBTUElDRV9ERUJVRygiJXMgPDwgJXAiLCBf
X0ZVTkNUSU9OX18sIGNoKTsKPiA+ICt9Cj4gPiArCj4gPiArdm9pZCBzcGljZV91c2JfYmFja2Vu
ZF9jaGFubmVsX2dldF9ndWVzdF9maWx0ZXIoCj4gPiArICAgIFNwaWNlVXNiQmFja2VuZENoYW5u
ZWwgKmNoLAo+ID4gKyAgICBjb25zdCBzdHJ1Y3QgdXNicmVkaXJmaWx0ZXJfcnVsZSAqKnIsCj4g
PiArICAgIGludCAqY291bnQpCj4gPiArewo+Cj4gUGxlYXNlLCBkb24ndCB1c2VyIHBhcmFtZXRl
cnMgbGlrZSB0aGF0IGV2ZW4gaWYgcHJldmlvdXMgY29kZSB3YXMKPiBsaWtlIHRoaXMuIFdlIGhh
dmUgNCBleGFtcGxlcyBvbiBGdW5jdGlvbiBpbmRlbnRhdGlvbiBhbmQgSQo+IHBlcnNvbmFsbHkg
d291bGQganVzdCBzdGljayB3aXRoCj4KPiAgICAgdm9pZAo+ICAgICBzcGljZV91c2JfYmFja2Vu
ZF9jaGFubmVsX2dldF9ndWVzdF9maWx0ZXIoU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCAqY2gsCj4g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJ1
Y3QgdXNicmVkaXJmaWx0ZXJfcnVsZSAqKnIsCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBpbnQgKmNvdW50KQo+Cj4KPiA+ICsgICAgaW50IGk7Cj4gPiAr
ICAgICpyID0gTlVMTDsKPiA+ICsgICAgKmNvdW50ID0gMDsKPiA+ICsgICAgaWYgKGNoLT51c2Jy
ZWRpcmhvc3QpIHsKPiA+ICsgICAgICAgIHVzYnJlZGlyaG9zdF9nZXRfZ3Vlc3RfZmlsdGVyKGNo
LT51c2JyZWRpcmhvc3QsIHIsIGNvdW50KTsKPiA+ICsgICAgfQo+ID4gKyAgICBpZiAoKnIgPT0g
TlVMTCkgewo+ID4gKyAgICAgICAgKnIgPSBjaC0+cnVsZXM7Cj4gPiArICAgICAgICAqY291bnQg
PSBjaC0+cnVsZXNfY291bnQ7Cj4gPiArICAgIH0KPiA+ICsKPiA+ICsgICAgaWYgKCpjb3VudCkg
ewo+ID4gKyAgICAgICAgU1BJQ0VfREVCVUcoIiVzIGNoICVwOiAlZCBmaWx0ZXJzIiwgX19GVU5D
VElPTl9fLCBjaCwgKmNvdW50KTsKPiA+ICsgICAgfQo+Cj4gTm90IHN1cmUgd2h5IHRvIGNoZWNr
ICpjb3VudCwgMCBpcyBub3QgaW50ZXJlc3RpbmcgZmlsdGVyPwo+Cj4gPiArICAgIGZvciAoaSA9
IDA7IGkgPCAqY291bnQ7IGkrKykgewo+ID4gKyAgICAgICAgY29uc3Qgc3RydWN0IHVzYnJlZGly
ZmlsdGVyX3J1bGUgKnJhID0gKnI7Cj4gPiArICAgICAgICBTUElDRV9ERUJVRygiJXMgY2xhc3Mg
JWQsICVYOiVYIiwKPiA+ICsgICAgICAgICAgICByYVtpXS5hbGxvdyA/ICJhbGxvd2VkIiA6ICJk
ZW5pZWQiLCByYVtpXS5kZXZpY2VfY2xhc3MsCj4gPiArICAgICAgICAgICAgKHVpbnQzMl90KXJh
W2ldLnZlbmRvcl9pZCwgKHVpbnQzMl90KXJhW2ldLnByb2R1Y3RfaWQpOwo+ID4gKyAgICB9Cj4g
PiArfQo+ID4gKwo+ID4gKyNlbmRpZiAvLyBVU0JfUkVESVIKPiA+IGRpZmYgLS1naXQgYS9zcmMv
dXNiLWJhY2tlbmQuaCBiL3NyYy91c2ItYmFja2VuZC5oCj4gPiBuZXcgZmlsZSBtb2RlIDEwMDY0
NAo+ID4gaW5kZXggMDAwMDAwMC4uOTEzNzkxNgo+ID4gLS0tIC9kZXYvbnVsbAo+ID4gKysrIGIv
c3JjL3VzYi1iYWNrZW5kLmgKPiA+IEBAIC0wLDAgKzEsMTEwIEBACj4gPiArLyogLSotIE1vZGU6
IEM7IGMtYmFzaWMtb2Zmc2V0OiA0OyBpbmRlbnQtdGFicy1tb2RlOiBuaWwgLSotICovCj4gPiAr
LyoKPiA+ICsgICAgQ29weXJpZ2h0IChDKSAyMDE4IFJlZCBIYXQsIEluYy4KPiA+ICsKPiA+ICsg
ICAgUmVkIEhhdCBBdXRob3JzOgo+ID4gKyAgICBZdXJpIEJlbmRpdG92aWNoPHliZW5kaXRvQHJl
ZGhhdC5jb20+Cj4gPiArCj4gPiArICAgIFRoaXMgbGlicmFyeSBpcyBmcmVlIHNvZnR3YXJlOyB5
b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IKPiA+ICsgICAgbW9kaWZ5IGl0IHVuZGVyIHRo
ZSB0ZXJtcyBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYwo+ID4gKyAgICBMaWNlbnNl
IGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIKPiA+
ICsgICAgdmVyc2lvbiAyLjEgb2YgdGhlIExpY2Vuc2UsIG9yIChhdCB5b3VyIG9wdGlvbikgYW55
IGxhdGVyIHZlcnNpb24uCj4gPiArCj4gPiArICAgIFRoaXMgbGlicmFyeSBpcyBkaXN0cmlidXRl
ZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAo+ID4gKyAgICBidXQgV0lUSE9V
VCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgo+ID4g
KyAgICBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0Uu
ICBTZWUgdGhlIEdOVQo+ID4gKyAgICBMZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3Ig
bW9yZSBkZXRhaWxzLgo+ID4gKwo+ID4gKyAgICBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBj
b3B5IG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCj4gPiArICAgIExpY2Vuc2UgYWxv
bmcgd2l0aCB0aGlzIGxpYnJhcnk7IGlmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGlj
ZW5zZXMvPi4KPiA+ICsqLwo+ID4gKwo+ID4gKyNpZm5kZWYgX19TUElDRV9VU0JfQkFDS0VORF9I
X18KPiA+ICsjZGVmaW5lIF9fU1BJQ0VfVVNCX0JBQ0tFTkRfSF9fCj4gPiArCj4gPiArI2luY2x1
ZGUgPHVzYnJlZGlyZmlsdGVyLmg+Cj4gPiArI2luY2x1ZGUgInVzYi1kZXZpY2UtbWFuYWdlci5o
Igo+ID4gKwo+ID4gK0dfQkVHSU5fREVDTFMKPiA+ICsKPiA+ICt0eXBlZGVmIHN0cnVjdCBfU3Bp
Y2VVc2JCYWNrZW5kIFNwaWNlVXNiQmFja2VuZDsKPiA+ICt0eXBlZGVmIHN0cnVjdCBfU3BpY2VV
c2JCYWNrZW5kRGV2aWNlIFNwaWNlVXNiQmFja2VuZERldmljZTsKPiA+ICt0eXBlZGVmIHN0cnVj
dCBfU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCBTcGljZVVzYkJhY2tlbmRDaGFubmVsOwo+ID4gKwo+
ID4gK3R5cGVkZWYgc3RydWN0IFVzYkRldmljZUluZm9ybWF0aW9uCj4gPiArewo+ID4gKyAgICB1
aW50MTZfdCBidXM7Cj4gPiArICAgIHVpbnQxNl90IGFkZHJlc3M7Cj4gPiArICAgIHVpbnQxNl90
IHZpZDsKPiA+ICsgICAgdWludDE2X3QgcGlkOwo+ID4gKyAgICB1aW50OF90IGNsYXNzOwo+ID4g
KyAgICB1aW50OF90IHN1YmNsYXNzOwo+ID4gKyAgICB1aW50OF90IHByb3RvY29sOwo+ID4gK30g
VXNiRGV2aWNlSW5mb3JtYXRpb247Cj4gPiArCj4gPiArdHlwZWRlZiBzdHJ1Y3QgU3BpY2VVc2JC
YWNrZW5kQ2hhbm5lbEluaXREYXRhCj4gPiArewo+ID4gKyAgICB2b2lkICp1c2VyX2RhdGE7Cj4g
PiArICAgIGludCAoKndyaXRlX2NhbGxiYWNrKSh2b2lkICp1c2VyX2RhdGEsIHVpbnQ4X3QgKmRh
dGEsIGludCBjb3VudCk7Cj4gPiArICAgIGdib29sZWFuICgqaXNfY2hhbm5lbF9yZWFkeSkodm9p
ZCAqdXNlcl9kYXRhKTsKPiA+ICsgICAgdWludDY0X3QgKCpnZXRfcXVldWVfc2l6ZSkodm9pZCAq
dXNlcl9kYXRhKTsKPiA+ICt9IFNwaWNlVXNiQmFja2VuZENoYW5uZWxJbml0RGF0YTsKPiA+ICsK
PiA+ICt0eXBlZGVmIHZvaWQoKnVzYl9ob3RfcGx1Z19jYWxsYmFjaykodm9pZCAqdXNlcl9kYXRh
LCBTcGljZVVzYkJhY2tlbmREZXZpY2UgKmRldiwgZ2Jvb2xlYW4gYWRkZWQpOwo+ID4gKwo+ID4g
K2VudW0gewo+ID4gKyAgICBVU0JfUkVESVJfRVJST1JfSU8gPSAtMSwKPiA+ICsgICAgVVNCX1JF
RElSX0VSUk9SX1JFQURfUEFSU0UgPSAtMiwKPiA+ICsgICAgVVNCX1JFRElSX0VSUk9SX0RFVl9S
RUpFQ1RFRCA9IC0zLAo+ID4gKyAgICBVU0JfUkVESVJfRVJST1JfREVWX0xPU1QgPSAtNCwKPiA+
ICt9Owo+ID4gKwo+ID4gKy8qIFNwaWNlIFVTQiBiYWNrZW5kIEFQSSAqLwo+ID4gKy8qIHNldHMg
ZXJyb3Igb24gZmFpbHVyZSAqLwo+ID4gK1NwaWNlVXNiQmFja2VuZCAqc3BpY2VfdXNiX2JhY2tl
bmRfbmV3KEdFcnJvciAqKmVycm9yKTsKPiA+ICt2b2lkIHNwaWNlX3VzYl9iYWNrZW5kX2RlbGV0
ZShTcGljZVVzYkJhY2tlbmQgKmNvbnRleHQpOwo+ID4gKwo+ID4gKy8qCj4gPiArcmV0dXJucyBu
ZXdseS1hbGxvY2F0ZWQgbnVsbC10ZXJtaW5hdGVkIGxpc3Qgb2YKPiA+ICtTcGljZVVzYkJhY2tl
bmREZXZpY2UgcG9pbnRlcnMuCj4gPiArVGhlIGNhbGxlciBtdXN0IGNhbGwgc3BpY2VfdXNiX2Jh
Y2tlbmRfZnJlZV9kZXZpY2VfbGlzdAo+ID4gK2FmdGVyIGl0IGZpbmlzaGVzIGxpc3QgcHJvY2Vz
c2luZwo+ID4gKyovCj4gPiArU3BpY2VVc2JCYWNrZW5kRGV2aWNlICoqc3BpY2VfdXNiX2JhY2tl
bmRfZ2V0X2RldmljZV9saXN0KFNwaWNlVXNiQmFja2VuZCAqYmFja2VuZCk7Cj4gPiArdm9pZCBz
cGljZV91c2JfYmFja2VuZF9mcmVlX2RldmljZV9saXN0KFNwaWNlVXNiQmFja2VuZERldmljZSAq
KmRldmxpc3QpOwo+ID4gK2dib29sZWFuIHNwaWNlX3VzYl9iYWNrZW5kX2hhbmRsZV9ldmVudHMo
U3BpY2VVc2JCYWNrZW5kICpiZSk7Cj4gPiArZ2Jvb2xlYW4gc3BpY2VfdXNiX2JhY2tlbmRfcmVn
aXN0ZXJfaG90cGx1ZyhTcGljZVVzYkJhY2tlbmQgKmJlLAo+ID4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgdm9pZCAqdXNlcl9kYXRhLAo+ID4gKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNiX2hvdF9wbHVnX2NhbGxiYWNr
IHByb2MpOwo+ID4gK3ZvaWQgc3BpY2VfdXNiX2JhY2tlbmRfZGVyZWdpc3Rlcl9ob3RwbHVnKFNw
aWNlVXNiQmFja2VuZCAqYmUpOwo+ID4gKwo+ID4gKy8qIFNwaWNlIFVTQiBiYWNrZW5kIGRldmlj
ZSBBUEkgKi8KPiA+ICtnYm9vbGVhbiBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfaXNfaHViKFNw
aWNlVXNiQmFja2VuZERldmljZSAqZGV2KTsKPiA+ICtTcGljZVVzYkJhY2tlbmREZXZpY2UgKnNw
aWNlX3VzYl9iYWNrZW5kX2RldmljZV9yZWYoU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpkZXYpOwo+
ID4gK3ZvaWQgc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX3VucmVmKFNwaWNlVXNiQmFja2VuZERl
dmljZSAqZGV2KTsKPiA+ICtnY29uc3Rwb2ludGVyIHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9n
ZXRfbGliZGV2KFNwaWNlVXNiQmFja2VuZERldmljZSAqZGV2KTsKPiA+ICtjb25zdCBVc2JEZXZp
Y2VJbmZvcm1hdGlvbiogc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX2dldF9pbmZvKFNwaWNlVXNi
QmFja2VuZERldmljZSAqZGV2KTsKPiA+ICtnYm9vbGVhbiBzcGljZV91c2JfYmFja2VuZF9kZXZp
Y2VfaXNvY2goU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpkZXYpOwo+ID4gKy8qIHJldHVybnMgMCBp
ZiB0aGUgZGV2aWNlIHBhc3NlcyB0aGUgZmlsdGVyICovCj4gPiAraW50IHNwaWNlX3VzYl9iYWNr
ZW5kX2RldmljZV9jaGVja19maWx0ZXIoU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpkZXYsCj4gPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RydWN0IHVz
YnJlZGlyZmlsdGVyX3J1bGUgKnJ1bGVzLCBpbnQgY291bnQpOwo+ID4gKwo+ID4gKy8qIFNwaWNl
IFVTQiBiYWNrZW5kIGNoYW5uZWwgQVBJICovCj4gPiArU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCAq
c3BpY2VfdXNiX2JhY2tlbmRfY2hhbm5lbF9uZXcoU3BpY2VVc2JCYWNrZW5kICpjb250ZXh0LAo+
ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGNvbnN0IFNwaWNlVXNiQmFja2VuZENoYW5uZWxJbml0RGF0YSAqaW5pdF9kYXRhKTsKPiA+ICt2
b2lkIHNwaWNlX3VzYl9iYWNrZW5kX2NoYW5uZWxfZGVsZXRlKFNwaWNlVXNiQmFja2VuZENoYW5u
ZWwgKmNoKTsKPiA+ICsvKiByZXR1cm5zIDAgZm9yIHN1Y2Nlc3Mgb3IgZXJyb3IgY29kZSAqLwo+
ID4gK2ludCBzcGljZV91c2JfYmFja2VuZF9wcm92aWRlX3JlYWRfZGF0YShTcGljZVVzYkJhY2tl
bmRDaGFubmVsICpjaCwgdWludDhfdCAqZGF0YSwgaW50IGNvdW50KTsKPiA+ICtnYm9vbGVhbiBz
cGljZV91c2JfYmFja2VuZF9jaGFubmVsX2F0dGFjaChTcGljZVVzYkJhY2tlbmRDaGFubmVsICpj
aCwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTcGljZVVz
YkJhY2tlbmREZXZpY2UgKmRldiwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBHRXJyb3IgKiplcnJvcik7Cj4gPiArdm9pZCBzcGljZV91c2JfYmFja2VuZF9j
aGFubmVsX2RldGFjaChTcGljZVVzYkJhY2tlbmRDaGFubmVsICpjaCk7Cj4gPiArdm9pZCBzcGlj
ZV91c2JfYmFja2VuZF9jaGFubmVsX3VwKFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmNoKTsKPiA+
ICt2b2lkIHNwaWNlX3VzYl9iYWNrZW5kX2NoYW5uZWxfZ2V0X2d1ZXN0X2ZpbHRlcihTcGljZVVz
YkJhY2tlbmRDaGFubmVsICpjaCwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBjb25zdCBzdHJ1Y3QgdXNicmVkaXJmaWx0ZXJfcnVsZSAgKipydWxl
cywKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBp
bnQgKmNvdW50KTsKPiA+ICt2b2lkIHNwaWNlX3VzYl9iYWNrZW5kX3JldHVybl93cml0ZV9kYXRh
KFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmNoLCB2b2lkICpkYXRhKTsKPiA+ICsKPiA+ICtHX0VO
RF9ERUNMUwo+ID4gKwo+ID4gKyNlbmRpZgo+ID4gZGlmZiAtLWdpdCBhL3NyYy91c2ItZGV2aWNl
LW1hbmFnZXItcHJpdi5oIGIvc3JjL3VzYi1kZXZpY2UtbWFuYWdlci1wcml2LmgKPiA+IGluZGV4
IDgzODg0ZDcuLjM5YWFmMmYgMTAwNjQ0Cj4gPiAtLS0gYS9zcmMvdXNiLWRldmljZS1tYW5hZ2Vy
LXByaXYuaAo+ID4gKysrIGIvc3JjL3VzYi1kZXZpY2UtbWFuYWdlci1wcml2LmgKPiA+IEBAIC0z
Miw3ICszMiw2IEBAIHZvaWQgc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX3N0b3BfZXZlbnRfbGlz
dGVuaW5nKAo+ID4gICAgICBTcGljZVVzYkRldmljZU1hbmFnZXIgKm1hbmFnZXIpOwo+ID4KPiA+
ICAjaWZkZWYgVVNFX1VTQlJFRElSCj4gPiAtI2luY2x1ZGUgPGxpYnVzYi5oPgo+ID4gIHZvaWQg
c3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2RldmljZV9lcnJvcigKPiA+ICAgICAgU3BpY2VVc2JE
ZXZpY2VNYW5hZ2VyICptYW5hZ2VyLCBTcGljZVVzYkRldmljZSAqZGV2aWNlLCBHRXJyb3IgKmVy
cik7Cj4gPgo+ID4gZGlmZiAtLWdpdCBhL3NyYy91c2ItZGV2aWNlLW1hbmFnZXIuYyBiL3NyYy91
c2ItZGV2aWNlLW1hbmFnZXIuYwo+ID4gaW5kZXggYmQ0MjE0Mi4uMmJlZTU1ZCAxMDA2NDQKPiA+
IC0tLSBhL3NyYy91c2ItZGV2aWNlLW1hbmFnZXIuYwo+ID4gKysrIGIvc3JjL3VzYi1kZXZpY2Ut
bWFuYWdlci5jCj4gPiBAQCAtMjUsMTUgKzI1LDE0IEBACj4gPgo+ID4gICNpZmRlZiBVU0VfVVNC
UkVESVIKPiA+ICAjaW5jbHVkZSA8ZXJybm8uaD4KPiA+IC0jaW5jbHVkZSA8bGlidXNiLmg+Cj4g
Pgo+ID4gICNpZmRlZiBHX09TX1dJTjMyCj4gPiArI2luY2x1ZGUgPHdpbmRvd3MuaD4KPiA+ICAj
aW5jbHVkZSAidXNiZGtfYXBpLmgiCj4gPiAgI2luY2x1ZGUgIndpbi11c2ItZGV2LmgiCj4gPiAg
I2VuZGlmCj4gPgo+ID4gICNpbmNsdWRlICJjaGFubmVsLXVzYnJlZGlyLXByaXYuaCIKPiA+IC0j
aW5jbHVkZSAidXNicmVkaXJob3N0LmgiCj4gPiAgI2luY2x1ZGUgInVzYnV0aWwuaCIKPiA+ICAj
ZW5kaWYKPiA+Cj4gPiBAQCAtOTQsNyArOTMsNyBAQCBzdHJ1Y3QgX1NwaWNlVXNiRGV2aWNlTWFu
YWdlclByaXZhdGUgewo+ID4gICAgICBnY2hhciAqYXV0b19jb25uZWN0X2ZpbHRlcjsKPiA+ICAg
ICAgZ2NoYXIgKnJlZGlyZWN0X29uX2Nvbm5lY3Q7Cj4gPiAgI2lmZGVmIFVTRV9VU0JSRURJUgo+
ID4gLSAgICBsaWJ1c2JfY29udGV4dCAqY29udGV4dDsKPiA+ICsgICAgU3BpY2VVc2JCYWNrZW5k
ICpjb250ZXh0Owo+ID4gICAgICBpbnQgZXZlbnRfbGlzdGVuZXJzOwo+ID4gICAgICBHVGhyZWFk
ICpldmVudF90aHJlYWQ7Cj4gPiAgICAgIGdpbnQgZXZlbnRfdGhyZWFkX3J1bjsKPiA+IEBAIC0x
MDYsNyArMTA1LDYgQEAgc3RydWN0IF9TcGljZVVzYkRldmljZU1hbmFnZXJQcml2YXRlIHsKPiA+
ICAgICAgR1VkZXZDbGllbnQgKnVkZXY7Cj4gPiAgI2Vsc2UKPiA+ICAgICAgZ2Jvb2xlYW4gcmVk
aXJlY3Rpbmc7IC8qIEhhbmRsZWQgYnkgR1VkZXZDbGllbnQgaW4gdGhlIGd1ZGV2IGNhc2UgKi8K
PiA+IC0gICAgbGlidXNiX2hvdHBsdWdfY2FsbGJhY2tfaGFuZGxlIGhwX2hhbmRsZTsKPiA+ICAj
ZW5kaWYKPiA+ICAjaWZkZWYgR19PU19XSU4zMgo+ID4gICAgICB1c2Jka19hcGlfd3JhcHBlciAg
ICAgKnVzYmRrX2FwaTsKPiA+IEBAIC0xMzYsNyArMTM0LDcgQEAgdHlwZWRlZiBzdHJ1Y3QgX1Nw
aWNlVXNiRGV2aWNlSW5mbyB7Cj4gPiAgICAgIGd1aW50MTYgdmlkOwo+ID4gICAgICBndWludDE2
IHBpZDsKPiA+ICAgICAgZ2Jvb2xlYW4gaXNvY2hyb25vdXM7Cj4gPiAtICAgIGxpYnVzYl9kZXZp
Y2UgKmxpYmRldjsKPiA+ICsgICAgU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpiZGV2Owo+ID4gICAg
ICBnaW50ICAgIHJlZjsKPiA+ICB9IFNwaWNlVXNiRGV2aWNlSW5mbzsKPiA+Cj4gPiBAQCAtMTQ5
LDE5ICsxNDcsMTggQEAgc3RhdGljIHZvaWQgY2hhbm5lbF9ldmVudChTcGljZUNoYW5uZWwgKmNo
YW5uZWwsIFNwaWNlQ2hhbm5lbEV2ZW50IGV2ZW50LAo+ID4gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgZ3BvaW50ZXIgdXNlcl9kYXRhKTsKPiA+ICAjaWZkZWYgR19PU19XSU4zMgo+ID4gIHN0
YXRpYyB2b2lkIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl91ZXZlbnRfY2IoR1VkZXZDbGllbnQg
ICAgICpjbGllbnQsCj4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBsaWJ1c2JfZGV2aWNlICAgKnVkZXZpY2UsCj4gPiArICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTcGljZVVzYkJhY2tlbmREZXZpY2UgKnVkZXZp
Y2UsCj4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBn
Ym9vbGVhbiAgICAgICAgIGFkZCwKPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGdwb2ludGVyICAgICAgICAgdXNlcl9kYXRhKTsKPiA+ICAjZWxzZQo+
ID4gLXN0YXRpYyBpbnQgc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2hvdHBsdWdfY2IobGlidXNi
X2NvbnRleHQgICAgICAgKmN0eCwKPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGxpYnVzYl9kZXZpY2UgICAgICAgICpkZXZpY2UsCj4gPiAtICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWJ1c2JfaG90cGx1Z19l
dmVudCAgZXZlbnQsCj4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB2b2lkICAgICAgICAgICAgICAgICAqZGF0YSk7Cj4gPiArc3RhdGljIHZvaWQgc3Bp
Y2VfdXNiX2RldmljZV9tYW5hZ2VyX2hvdHBsdWdfY2Iodm9pZCAqdXNlcl9kYXRhLAo+ID4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNwaWNlVXNiQmFj
a2VuZERldmljZSAqZGV2LAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGdib29sZWFuIGFkZGVkKTsKPiA+ICAjZW5kaWYKPiA+ICBzdGF0aWMgdm9p
ZCBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfY2hlY2tfcmVkaXJfb25fY29ubmVjdCgKPiA+ICAg
ICAgU3BpY2VVc2JEZXZpY2VNYW5hZ2VyICpzZWxmLCBTcGljZUNoYW5uZWwgKmNoYW5uZWwpOwo+
ID4KPiA+IC1zdGF0aWMgU3BpY2VVc2JEZXZpY2VJbmZvICpzcGljZV91c2JfZGV2aWNlX25ldyhs
aWJ1c2JfZGV2aWNlICpsaWJkZXYpOwo+ID4gK3N0YXRpYyBTcGljZVVzYkRldmljZUluZm8gKnNw
aWNlX3VzYl9kZXZpY2VfbmV3KFNwaWNlVXNiQmFja2VuZERldmljZSAqYmRldik7Cj4gPiAgc3Rh
dGljIFNwaWNlVXNiRGV2aWNlICpzcGljZV91c2JfZGV2aWNlX3JlZihTcGljZVVzYkRldmljZSAq
ZGV2aWNlKTsKPiA+ICBzdGF0aWMgdm9pZCBzcGljZV91c2JfZGV2aWNlX3VucmVmKFNwaWNlVXNi
RGV2aWNlICpkZXZpY2UpOwo+ID4KPiA+IEBAIC0xNzAsMTIgKzE2NywxMiBAQCBzdGF0aWMgdm9p
ZCBfdXNiZGtfaGlkZXJfdXBkYXRlKFNwaWNlVXNiRGV2aWNlTWFuYWdlciAqbWFuYWdlcik7Cj4g
PiAgc3RhdGljIHZvaWQgX3VzYmRrX2hpZGVyX2NsZWFyKFNwaWNlVXNiRGV2aWNlTWFuYWdlciAq
bWFuYWdlcik7Cj4gPiAgI2VuZGlmCj4gPgo+ID4gLXN0YXRpYyBnYm9vbGVhbiBzcGljZV91c2Jf
bWFuYWdlcl9kZXZpY2VfZXF1YWxfbGliZGV2KFNwaWNlVXNiRGV2aWNlTWFuYWdlciAqbWFuYWdl
ciwKPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBTcGljZVVzYkRldmljZSAqZGV2aWNlLAo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpYnVzYl9kZXZpY2UgKmxpYmRldik7Cj4g
PiAtc3RhdGljIGxpYnVzYl9kZXZpY2UgKgo+ID4gLXNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9k
ZXZpY2VfdG9fbGliZGV2KFNwaWNlVXNiRGV2aWNlTWFuYWdlciAqc2VsZiwKPiA+IC0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTcGljZVVzYkRldmljZSAqZGV2aWNl
KTsKPiA+ICtzdGF0aWMgZ2Jvb2xlYW4gc3BpY2VfdXNiX21hbmFnZXJfZGV2aWNlX2VxdWFsX2Jk
ZXYoU3BpY2VVc2JEZXZpY2VNYW5hZ2VyICptYW5hZ2VyLAo+ID4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTcGljZVVzYkRldmljZSAqZGV2aWNl
LAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBTcGljZVVzYkJhY2tlbmREZXZpY2UgKmJkZXYpOwo+ID4gK3N0YXRpYyBTcGljZVVzYkJhY2tl
bmREZXZpY2UgKgo+ID4gK3NwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9kZXZpY2VfdG9fYmRldihT
cGljZVVzYkRldmljZU1hbmFnZXIgKnNlbGYsCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIFNwaWNlVXNiRGV2aWNlICpkZXZpY2UpOwo+ID4KPiA+ICBzdGF0aWMg
dm9pZAo+ID4gIF9zcGljZV91c2JfZGV2aWNlX21hbmFnZXJfY29ubmVjdF9kZXZpY2VfYXN5bmMo
U3BpY2VVc2JEZXZpY2VNYW5hZ2VyICpzZWxmLAo+ID4gQEAgLTI3NywxNCArMjc0LDkgQEAgc3Rh
dGljIGdib29sZWFuIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9pbml0YWJsZV9pbml0KEdJbml0
YWJsZSAgKmluaXRhYmxlLAo+ID4gICAgICBHTGlzdCAqaXQ7Cj4gPgo+ID4gICNpZm5kZWYgR19P
U19XSU4zMgo+ID4gLSAgICBpbnQgcmM7Cj4gPiAgICAgIC8qIEluaXRpYWxpemUgbGlidXNiICov
Cj4gPiAtICAgIHJjID0gbGlidXNiX2luaXQoJnByaXYtPmNvbnRleHQpOwo+ID4gLSAgICBpZiAo
cmMgPCAwKSB7Cj4gPiAtICAgICAgICBjb25zdCBjaGFyICpkZXNjID0gc3BpY2VfdXNidXRpbF9s
aWJ1c2Jfc3RyZXJyb3IocmMpOwo+ID4gLSAgICAgICAgZ193YXJuaW5nKCJFcnJvciBpbml0aWFs
aXppbmcgVVNCIHN1cHBvcnQ6ICVzIFslaV0iLCBkZXNjLCByYyk7Cj4gPiAtICAgICAgICBnX3Nl
dF9lcnJvcihlcnIsIFNQSUNFX0NMSUVOVF9FUlJPUiwgU1BJQ0VfQ0xJRU5UX0VSUk9SX0ZBSUxF
RCwKPiA+IC0gICAgICAgICAgICAgICAgICAgICJFcnJvciBpbml0aWFsaXppbmcgVVNCIHN1cHBv
cnQ6ICVzIFslaV0iLCBkZXNjLCByYyk7Cj4gPiArICAgIHByaXYtPmNvbnRleHQgPSBzcGljZV91
c2JfYmFja2VuZF9uZXcoZXJyKTsKPiA+ICsgICAgaWYgKCFwcml2LT5jb250ZXh0KSB7Cj4gPiAg
ICAgICAgICByZXR1cm4gRkFMU0U7Cj4gPiAgICAgIH0KPiA+ICAjZW5kaWYKPiA+IEBAIC0zMDIs
MTYgKzI5NCw4IEBAIHN0YXRpYyBnYm9vbGVhbiBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfaW5p
dGFibGVfaW5pdChHSW5pdGFibGUgICppbml0YWJsZSwKPiA+ICAgICAgLyogRG8gY29sZHBsdWcg
KGRldGVjdGlvbiBvZiBhbHJlYWR5IGNvbm5lY3RlZCBkZXZpY2VzKSAqLwo+ID4gICAgICBnX3Vk
ZXZfY2xpZW50X3JlcG9ydF9kZXZpY2VzKHByaXYtPnVkZXYpOwo+ID4gICNlbHNlCj4gPiAtICAg
IHJjID0gbGlidXNiX2hvdHBsdWdfcmVnaXN0ZXJfY2FsbGJhY2socHJpdi0+Y29udGV4dCwKPiA+
IC0gICAgICAgIExJQlVTQl9IT1RQTFVHX0VWRU5UX0RFVklDRV9BUlJJVkVEIHwgTElCVVNCX0hP
VFBMVUdfRVZFTlRfREVWSUNFX0xFRlQsCj4gPiAtICAgICAgICBMSUJVU0JfSE9UUExVR19FTlVN
RVJBVEUsIExJQlVTQl9IT1RQTFVHX01BVENIX0FOWSwKPiA+IC0gICAgICAgIExJQlVTQl9IT1RQ
TFVHX01BVENIX0FOWSwgTElCVVNCX0hPVFBMVUdfTUFUQ0hfQU5ZLAo+ID4gLSAgICAgICAgc3Bp
Y2VfdXNiX2RldmljZV9tYW5hZ2VyX2hvdHBsdWdfY2IsIHNlbGYsICZwcml2LT5ocF9oYW5kbGUp
Owo+ID4gLSAgICBpZiAocmMgPCAwKSB7Cj4gPiAtICAgICAgICBjb25zdCBjaGFyICpkZXNjID0g
c3BpY2VfdXNidXRpbF9saWJ1c2Jfc3RyZXJyb3IocmMpOwo+ID4gLSAgICAgICAgZ193YXJuaW5n
KCJFcnJvciBpbml0aWFsaXppbmcgVVNCIGhvdHBsdWcgc3VwcG9ydDogJXMgWyVpXSIsIGRlc2Ms
IHJjKTsKPiA+IC0gICAgICAgIGdfc2V0X2Vycm9yKGVyciwgU1BJQ0VfQ0xJRU5UX0VSUk9SLCBT
UElDRV9DTElFTlRfRVJST1JfRkFJTEVELAo+ID4gLSAgICAgICAgICAgICAgICAgICJFcnJvciBp
bml0aWFsaXppbmcgVVNCIGhvdHBsdWcgc3VwcG9ydDogJXMgWyVpXSIsIGRlc2MsIHJjKTsKPiA+
ICsgICAgaWYgKCFzcGljZV91c2JfYmFja2VuZF9yZWdpc3Rlcl9ob3RwbHVnKHByaXYtPmNvbnRl
eHQsIHNlbGYsCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfaG90cGx1Z19jYikpIHsKPiA+ICAgICAgICAgIHJl
dHVybiBGQUxTRTsKPiA+ICAgICAgfQo+ID4gICAgICBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJf
c3RhcnRfZXZlbnRfbGlzdGVuaW5nKHNlbGYsIE5VTEwpOwo+ID4gQEAgLTM0MiwyMSArMzI2LDE3
IEBAIHN0YXRpYyB2b2lkIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9kaXNwb3NlKEdPYmplY3Qg
KmdvYmplY3QpCj4gPiAgICAgIFNwaWNlVXNiRGV2aWNlTWFuYWdlclByaXZhdGUgKnByaXYgPSBz
ZWxmLT5wcml2Owo+ID4KPiA+ICAjaWZuZGVmIEdfT1NfV0lOMzIKPiA+IC0gICAgaWYgKHByaXYt
PmhwX2hhbmRsZSkgewo+ID4gLSAgICAgICAgc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX3N0b3Bf
ZXZlbnRfbGlzdGVuaW5nKHNlbGYpOwo+ID4gLSAgICAgICAgaWYgKGdfYXRvbWljX2ludF9nZXQo
JnByaXYtPmV2ZW50X3RocmVhZF9ydW4pKSB7Cj4gPiAtICAgICAgICAgICAgLyogRm9yY2UgdGVy
bWluYXRpb24gb2YgdGhlIGV2ZW50IHRocmVhZCBldmVuIGlmIHRoZXJlIHdlcmUgc29tZQo+ID4g
LSAgICAgICAgICAgICAqIG1pc21hdGNoZWQgc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX3tzdGFy
dCxzdG9wfV9ldmVudF9saXN0ZW5pbmcKPiA+IC0gICAgICAgICAgICAgKiBjYWxscy4gT3RoZXJ3
aXNlLCB0aGUgdXNiIGV2ZW50IHRocmVhZCB3aWxsIGJlIGxlYWtlZCwgYW5kIHdpbGwKPiA+IC0g
ICAgICAgICAgICAgKiB0cnkgdG8gdXNlIHRoZSBsaWJ1c2IgY29udGV4dCB3ZSBkZXN0cm95IGlu
IGZpbmFsaXplKCksIHdoaWNoIHdvdWxkCj4gPiAtICAgICAgICAgICAgICogY2F1c2UgYSBjcmFz
aCAqLwo+ID4gLSAgICAgICAgICAgICBnX3dhcm5faWZfcmVhY2hlZCgpOwo+ID4gLSAgICAgICAg
ICAgICBnX2F0b21pY19pbnRfc2V0KCZwcml2LT5ldmVudF90aHJlYWRfcnVuLCBGQUxTRSk7Cj4g
PiAtICAgICAgICB9Cj4gPiAtICAgICAgICAvKiBUaGlzIGFsc28gd2FrZXMgdXAgdGhlIGxpYnVz
Yl9oYW5kbGVfZXZlbnRzKCkgaW4gdGhlIGV2ZW50X3RocmVhZCAqLwo+ID4gLSAgICAgICAgbGli
dXNiX2hvdHBsdWdfZGVyZWdpc3Rlcl9jYWxsYmFjayhwcml2LT5jb250ZXh0LCBwcml2LT5ocF9o
YW5kbGUpOwo+ID4gLSAgICAgICAgcHJpdi0+aHBfaGFuZGxlID0gMDsKPiA+ICsgICAgc3BpY2Vf
dXNiX2RldmljZV9tYW5hZ2VyX3N0b3BfZXZlbnRfbGlzdGVuaW5nKHNlbGYpOwo+ID4gKyAgICBp
ZiAoZ19hdG9taWNfaW50X2dldCgmcHJpdi0+ZXZlbnRfdGhyZWFkX3J1bikpIHsKPiA+ICsgICAg
ICAgIC8qIEZvcmNlIHRlcm1pbmF0aW9uIG9mIHRoZSBldmVudCB0aHJlYWQgZXZlbiBpZiB0aGVy
ZSB3ZXJlIHNvbWUKPiA+ICsgICAgICAgICAqIG1pc21hdGNoZWQgc3BpY2VfdXNiX2RldmljZV9t
YW5hZ2VyX3tzdGFydCxzdG9wfV9ldmVudF9saXN0ZW5pbmcKPiA+ICsgICAgICAgICAqIGNhbGxz
LiBPdGhlcndpc2UsIHRoZSB1c2IgZXZlbnQgdGhyZWFkIHdpbGwgYmUgbGVha2VkLCBhbmQgd2ls
bAo+ID4gKyAgICAgICAgICogdHJ5IHRvIHVzZSB0aGUgbGlidXNiIGNvbnRleHQgd2UgZGVzdHJv
eSBpbiBmaW5hbGl6ZSgpLCB3aGljaCB3b3VsZAo+ID4gKyAgICAgICAgICogY2F1c2UgYSBjcmFz
aCAqLwo+ID4gKyAgICAgICAgZ193YXJuX2lmX3JlYWNoZWQoKTsKPiA+ICsgICAgICAgIGdfYXRv
bWljX2ludF9zZXQoJnByaXYtPmV2ZW50X3RocmVhZF9ydW4sIEZBTFNFKTsKPiA+ICAgICAgfQo+
ID4gKyAgICBzcGljZV91c2JfYmFja2VuZF9kZXJlZ2lzdGVyX2hvdHBsdWcocHJpdi0+Y29udGV4
dCk7Cj4gPiAgI2VuZGlmCj4gPiAgICAgIGlmIChwcml2LT5ldmVudF90aHJlYWQpIHsKPiA+ICAg
ICAgICAgIGdfd2Fybl9pZl9mYWlsKGdfYXRvbWljX2ludF9nZXQoJnByaXYtPmV2ZW50X3RocmVh
ZF9ydW4pID09IEZBTFNFKTsKPiA+IEBAIC0zODYsNyArMzY2LDcgQEAgc3RhdGljIHZvaWQgc3Bp
Y2VfdXNiX2RldmljZV9tYW5hZ2VyX2ZpbmFsaXplKEdPYmplY3QgKmdvYmplY3QpCj4gPiAgICAg
IGdfcmV0dXJuX2lmX2ZhaWwocHJpdi0+ZXZlbnRfdGhyZWFkID09IE5VTEwpOwo+ID4gICNpZm5k
ZWYgR19PU19XSU4zMgo+ID4gICAgICBpZiAocHJpdi0+Y29udGV4dCkKPiA+IC0gICAgICAgIGxp
YnVzYl9leGl0KHByaXYtPmNvbnRleHQpOwo+ID4gKyAgICAgICAgc3BpY2VfdXNiX2JhY2tlbmRf
ZGVsZXRlKHByaXYtPmNvbnRleHQpOwo+ID4gICNlbmRpZgo+ID4gICAgICBmcmVlKHByaXYtPmF1
dG9fY29ubl9maWx0ZXJfcnVsZXMpOwo+ID4gICAgICBmcmVlKHByaXYtPnJlZGlyZWN0X29uX2Nv
bm5lY3RfcnVsZXMpOwo+ID4gQEAgLTcwOSwzNyArNjg5LDYgQEAgc3RhdGljIHZvaWQgc3BpY2Vf
dXNiX2RldmljZV9tYW5hZ2VyX2NsYXNzX2luaXQoU3BpY2VVc2JEZXZpY2VNYW5hZ2VyQ2xhc3Mg
KmtsYXMKPiA+ICAgICAgICAgICAgICAgICAgICAgICBHX1RZUEVfRVJST1IpOwo+ID4gIH0KPiA+
Cj4gPiAtI2lmZGVmIFVTRV9VU0JSRURJUgo+ID4gLQo+ID4gLS8qIC0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqLwo+ID4g
LS8qIGd1ZGV2IC8gbGlidXNiIEhlbHBlciBmdW5jdGlvbnMgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAqLwo+ID4gLQo+ID4gLXN0YXRpYyBnYm9vbGVhbiBzcGljZV91c2JfZGV2
aWNlX21hbmFnZXJfZ2V0X2RldmljZV9kZXNjcmlwdG9yKAo+ID4gLSAgICBsaWJ1c2JfZGV2aWNl
ICpsaWJkZXYsCj4gPiAtICAgIHN0cnVjdCBsaWJ1c2JfZGV2aWNlX2Rlc2NyaXB0b3IgKmRlc2Mp
Cj4gPiAtewo+ID4gLSAgICBpbnQgZXJyY29kZTsKPiA+IC0gICAgY29uc3QgZ2NoYXIgKmVycnN0
cjsKPiA+IC0KPiA+IC0gICAgZ19yZXR1cm5fdmFsX2lmX2ZhaWwobGliZGV2ICE9IE5VTEwsIEZB
TFNFKTsKPiA+IC0gICAgZ19yZXR1cm5fdmFsX2lmX2ZhaWwoZGVzYyAgICE9IE5VTEwsIEZBTFNF
KTsKPiA+IC0KPiA+IC0gICAgZXJyY29kZSA9IGxpYnVzYl9nZXRfZGV2aWNlX2Rlc2NyaXB0b3Io
bGliZGV2LCBkZXNjKTsKPiA+IC0gICAgaWYgKGVycmNvZGUgPCAwKSB7Cj4gPiAtICAgICAgICBp
bnQgYnVzLCBhZGRyOwo+ID4gLQo+ID4gLSAgICAgICAgYnVzID0gbGlidXNiX2dldF9idXNfbnVt
YmVyKGxpYmRldik7Cj4gPiAtICAgICAgICBhZGRyID0gbGlidXNiX2dldF9kZXZpY2VfYWRkcmVz
cyhsaWJkZXYpOwo+ID4gLSAgICAgICAgZXJyc3RyID0gc3BpY2VfdXNidXRpbF9saWJ1c2Jfc3Ry
ZXJyb3IoZXJyY29kZSk7Cj4gPiAtICAgICAgICBnX3dhcm5pbmcoImNhbm5vdCBnZXQgZGV2aWNl
IGRlc2NyaXB0b3IgZm9yICglcCkgJWQuJWQgLS0gJXMoJWQpIiwKPiA+IC0gICAgICAgICAgICAg
ICAgICBsaWJkZXYsIGJ1cywgYWRkciwgZXJyc3RyLCBlcnJjb2RlKTsKPiA+IC0gICAgICAgIHJl
dHVybiBGQUxTRTsKPiA+IC0gICAgfQo+ID4gLSAgICByZXR1cm4gVFJVRTsKPiA+IC19Cj4gPiAt
Cj4gPiAtI2VuZGlmIC8vIFVTRV9VU0JSRURJUgo+ID4gLQo+ID4gIC8qKgo+ID4gICAqIHNwaWNl
X3VzYl9kZXZpY2VfZ2V0X2xpYnVzYl9kZXZpY2U6Cj4gPiAgICogQGRldmljZTogI1NwaWNlVXNi
RGV2aWNlIHRvIGdldCB0aGUgZGVzY3JpcHRvciBpbmZvcm1hdGlvbiBvZgo+ID4gQEAgLTc1OCwz
MiArNzA3LDEyIEBAIHNwaWNlX3VzYl9kZXZpY2VfZ2V0X2xpYnVzYl9kZXZpY2UoY29uc3QgU3Bp
Y2VVc2JEZXZpY2UgKmRldmljZSBHX0dOVUNfVU5VU0VEKQo+ID4KPiA+ICAgICAgZ19yZXR1cm5f
dmFsX2lmX2ZhaWwoaW5mbyAhPSBOVUxMLCBGQUxTRSk7Cj4gPgo+ID4gLSAgICByZXR1cm4gaW5m
by0+bGliZGV2Owo+ID4gKyAgICByZXR1cm4gc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX2dldF9s
aWJkZXYoaW5mby0+YmRldik7Cj4gPiAgI2VuZGlmCj4gPiAgICAgIHJldHVybiBOVUxMOwo+ID4g
IH0KPiA+Cj4gPiAgI2lmZGVmIFVTRV9VU0JSRURJUgo+ID4gLXN0YXRpYyBnYm9vbGVhbiBzcGlj
ZV91c2JfZGV2aWNlX21hbmFnZXJfZ2V0X2xpYmRldl92aWRfcGlkKAo+ID4gLSAgICBsaWJ1c2Jf
ZGV2aWNlICpsaWJkZXYsIGludCAqdmlkLCBpbnQgKnBpZCkKPiA+IC17Cj4gPiAtICAgIHN0cnVj
dCBsaWJ1c2JfZGV2aWNlX2Rlc2NyaXB0b3IgZGVzYzsKPiA+IC0KPiA+IC0gICAgZ19yZXR1cm5f
dmFsX2lmX2ZhaWwobGliZGV2ICE9IE5VTEwsIEZBTFNFKTsKPiA+IC0gICAgZ19yZXR1cm5fdmFs
X2lmX2ZhaWwodmlkICE9IE5VTEwsIEZBTFNFKTsKPiA+IC0gICAgZ19yZXR1cm5fdmFsX2lmX2Zh
aWwocGlkICE9IE5VTEwsIEZBTFNFKTsKPiA+IC0KPiA+IC0gICAgKnZpZCA9ICpwaWQgPSAwOwo+
ID4gLQo+ID4gLSAgICBpZiAoIXNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9nZXRfZGV2aWNlX2Rl
c2NyaXB0b3IobGliZGV2LCAmZGVzYykpIHsKPiA+IC0gICAgICAgIHJldHVybiBGQUxTRTsKPiA+
IC0gICAgfQo+ID4gLSAgICAqdmlkID0gZGVzYy5pZFZlbmRvcjsKPiA+IC0gICAgKnBpZCA9IGRl
c2MuaWRQcm9kdWN0Owo+ID4gLQo+ID4gLSAgICByZXR1cm4gVFJVRTsKPiA+IC19Cj4gPiAtCj4g
PiAgLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tICovCj4gPiAgLyogY2FsbGJhY2tzICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovCj4gPgo+ID4gQEAgLTg5OSwz
MSArODI4LDI0IEBAIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9maW5kX2RldmljZShTcGljZVVz
YkRldmljZU1hbmFnZXIgKnNlbGYsCj4gPiAgfQo+ID4KPiA+ICBzdGF0aWMgdm9pZCBzcGljZV91
c2JfZGV2aWNlX21hbmFnZXJfYWRkX2RldihTcGljZVVzYkRldmljZU1hbmFnZXIgICpzZWxmLAo+
ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpYnVzYl9k
ZXZpY2UgICAgICAgICAgKmxpYmRldikKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBTcGljZVVzYkJhY2tlbmREZXZpY2UgICpiZGV2KQo+ID4gIHsKPiA+
ICAgICAgU3BpY2VVc2JEZXZpY2VNYW5hZ2VyUHJpdmF0ZSAqcHJpdiA9IHNlbGYtPnByaXY7Cj4g
PiAtICAgIHN0cnVjdCBsaWJ1c2JfZGV2aWNlX2Rlc2NyaXB0b3IgZGVzYzsKPiA+ICsgICAgY29u
c3QgVXNiRGV2aWNlSW5mb3JtYXRpb24gKmJfaW5mbyA9IHNwaWNlX3VzYl9iYWNrZW5kX2Rldmlj
ZV9nZXRfaW5mbyhiZGV2KTsKPiA+ICAgICAgU3BpY2VVc2JEZXZpY2UgKmRldmljZTsKPiA+Cj4g
PiAtICAgIGlmICghc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2dldF9kZXZpY2VfZGVzY3JpcHRv
cihsaWJkZXYsICZkZXNjKSkKPiA+IC0gICAgICAgIHJldHVybjsKPiA+IC0KPiA+IC0gICAgLyog
U2tpcCBodWJzICovCj4gPiAtICAgIGlmIChkZXNjLmJEZXZpY2VDbGFzcyA9PSBMSUJVU0JfQ0xB
U1NfSFVCKQo+ID4gLSAgICAgICAgcmV0dXJuOwo+ID4gLQo+ID4gICAgICBpZiAoc3BpY2VfdXNi
X2RldmljZV9tYW5hZ2VyX2ZpbmRfZGV2aWNlKHNlbGYsCj4gPiAtICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlidXNiX2dldF9idXNfbnVtYmVyKGxpYmRldiks
Cj4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlidXNi
X2dldF9kZXZpY2VfYWRkcmVzcyhsaWJkZXYpKSkgewo+ID4gKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGJfaW5mby0+YnVzLAo+ID4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJfaW5mby0+YWRkcmVzcykpIHsKPiA+ICAg
ICAgICAgIFNQSUNFX0RFQlVHKCJkZXZpY2Ugbm90IGFkZGVkICVkOiVkICUwNHg6JTA0eCIsCj4g
PiAtICAgICAgICAgICAgICAgICAgICBsaWJ1c2JfZ2V0X2J1c19udW1iZXIobGliZGV2KSwKPiA+
IC0gICAgICAgICAgICAgICAgICAgIGxpYnVzYl9nZXRfZGV2aWNlX2FkZHJlc3MobGliZGV2KSwK
PiA+IC0gICAgICAgICAgICAgICAgICAgIGRlc2MuaWRWZW5kb3IsCj4gPiAtICAgICAgICAgICAg
ICAgICAgICBkZXNjLmlkUHJvZHVjdCk7Cj4gPiArICAgICAgICAgICAgICAgICAgICBiX2luZm8t
PmJ1cywKPiA+ICsgICAgICAgICAgICAgICAgICAgIGJfaW5mby0+YWRkcmVzcywKPiA+ICsgICAg
ICAgICAgICAgICAgICAgIGJfaW5mby0+dmlkLAo+ID4gKyAgICAgICAgICAgICAgICAgICAgYl9p
bmZvLT5waWQpOwo+ID4gICAgICAgICAgcmV0dXJuOwo+ID4gICAgICB9Cj4gPgo+ID4gLSAgICBk
ZXZpY2UgPSAoU3BpY2VVc2JEZXZpY2UqKXNwaWNlX3VzYl9kZXZpY2VfbmV3KGxpYmRldik7Cj4g
PiArICAgIGRldmljZSA9IChTcGljZVVzYkRldmljZSopc3BpY2VfdXNiX2RldmljZV9uZXcoYmRl
dik7Cj4gPiAgICAgIGlmICghZGV2aWNlKQo+ID4gICAgICAgICAgcmV0dXJuOwo+ID4KPiA+IEBA
IC05MzUsMTAgKzg1NywxMCBAQCBzdGF0aWMgdm9pZCBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJf
YWRkX2RldihTcGljZVVzYkRldmljZU1hbmFnZXIgICpzZWxmLAo+ID4gICAgICAgICAgY2FuX3Jl
ZGlyZWN0ID0gc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2Nhbl9yZWRpcmVjdF9kZXZpY2UoCj4g
PiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYsIGRldmljZSwg
TlVMTCk7Cj4gPgo+ID4gLSAgICAgICAgYXV0b19vayA9IHVzYnJlZGlyaG9zdF9jaGVja19kZXZp
Y2VfZmlsdGVyKAo+ID4gKyAgICAgICAgYXV0b19vayA9IHNwaWNlX3VzYl9iYWNrZW5kX2Rldmlj
ZV9jaGVja19maWx0ZXIoCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJkZXYsCj4g
PiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaXYtPmF1dG9fY29ubl9maWx0ZXJfcnVs
ZXMsCj4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaXYtPmF1dG9fY29ubl9maWx0
ZXJfcnVsZXNfY291bnQsCj4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpYmRldiwg
MCkgPT0gMDsKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpdi0+YXV0b19jb25u
X2ZpbHRlcl9ydWxlc19jb3VudCkgPT0gMDsKPiA+Cj4gPiAgICAgICAgICBpZiAoY2FuX3JlZGly
ZWN0ICYmIGF1dG9fb2spCj4gPiAgICAgICAgICAgICAgc3BpY2VfdXNiX2RldmljZV9tYW5hZ2Vy
X2Nvbm5lY3RfZGV2aWNlX2FzeW5jKHNlbGYsCj4gPiBAQCAtOTU1LDE1ICs4NzcsMTYgQEAgc3Rh
dGljIHZvaWQgc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2FkZF9kZXYoU3BpY2VVc2JEZXZpY2VN
YW5hZ2VyICAqc2VsZiwKPiA+ICB9Cj4gPgo+ID4gIHN0YXRpYyB2b2lkIHNwaWNlX3VzYl9kZXZp
Y2VfbWFuYWdlcl9yZW1vdmVfZGV2KFNwaWNlVXNiRGV2aWNlTWFuYWdlciAqc2VsZiwKPiA+IC0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBndWludCBidXMs
IGd1aW50IGFkZHJlc3MpCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpiZGV2KQo+ID4gIHsKPiA+ICAgICAg
U3BpY2VVc2JEZXZpY2VNYW5hZ2VyUHJpdmF0ZSAqcHJpdiA9IHNlbGYtPnByaXY7Cj4gPiAgICAg
IFNwaWNlVXNiRGV2aWNlICpkZXZpY2U7Cj4gPiArICAgIGNvbnN0IFVzYkRldmljZUluZm9ybWF0
aW9uICpiX2luZm8gPSBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfZ2V0X2luZm8oYmRldik7Cj4g
Pgo+ID4gLSAgICBkZXZpY2UgPSBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfZmluZF9kZXZpY2Uo
c2VsZiwgYnVzLCBhZGRyZXNzKTsKPiA+ICsgICAgZGV2aWNlID0gc3BpY2VfdXNiX2RldmljZV9t
YW5hZ2VyX2ZpbmRfZGV2aWNlKHNlbGYsIGJfaW5mby0+YnVzLCBiX2luZm8tPmFkZHJlc3MpOwo+
ID4gICAgICBpZiAoIWRldmljZSkgewo+ID4gICAgICAgICAgZ193YXJuaW5nKCJDb3VsZCBub3Qg
ZmluZCBVU0IgZGV2aWNlIHRvIHJlbW92ZSAiIERFVl9JRF9GTVQsCj4gPiAtICAgICAgICAgICAg
ICAgICAgYnVzLCBhZGRyZXNzKTsKPiA+ICsgICAgICAgICAgICAgICAgICBiX2luZm8tPmJ1cywg
Yl9pbmZvLT5hZGRyZXNzKTsKPiA+ICAgICAgICAgIHJldHVybjsKPiA+ICAgICAgfQo+ID4KPiA+
IEBAIC05ODIsMjQgKzkwNSwyMiBAQCBzdGF0aWMgdm9pZCBzcGljZV91c2JfZGV2aWNlX21hbmFn
ZXJfcmVtb3ZlX2RldihTcGljZVVzYkRldmljZU1hbmFnZXIgKnNlbGYsCj4gPgo+ID4gICNpZmRl
ZiBHX09TX1dJTjMyCj4gPiAgc3RhdGljIHZvaWQgc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX3Vl
dmVudF9jYihHVWRldkNsaWVudCAgICAgKmNsaWVudCwKPiA+IC0gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpYnVzYl9kZXZpY2UgICAqZGV2LAo+ID4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU3BpY2VVc2JCYWNr
ZW5kRGV2aWNlICpiZGV2LAo+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgZ2Jvb2xlYW4gICAgICAgICBhZGQsCj4gPiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBncG9pbnRlciAgICAgICAgIHVzZXJfZGF0YSkK
PiA+ICB7Cj4gPiAgICAgIFNwaWNlVXNiRGV2aWNlTWFuYWdlciAqc2VsZiA9IFNQSUNFX1VTQl9E
RVZJQ0VfTUFOQUdFUih1c2VyX2RhdGEpOwo+ID4KPiA+ICAgICAgaWYgKGFkZCkKPiA+IC0gICAg
ICAgIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9hZGRfZGV2KHNlbGYsIGRldik7Cj4gPiArICAg
ICAgICBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfYWRkX2RldihzZWxmLCBiZGV2KTsKPiA+ICAg
ICAgZWxzZQo+ID4gLSAgICAgICAgc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX3JlbW92ZV9kZXYo
c2VsZiwKPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxp
YnVzYl9nZXRfYnVzX251bWJlcihkZXYpLAo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgbGlidXNiX2dldF9kZXZpY2VfYWRkcmVzcyhkZXYpKTsKPiA+ICsg
ICAgICAgIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9yZW1vdmVfZGV2KHNlbGYsIGJkZXYpOwo+
ID4gIH0KPiA+ICAjZWxzZQo+ID4gIHN0cnVjdCBob3RwbHVnX2lkbGVfY2JfYXJncyB7Cj4gPiAg
ICAgIFNwaWNlVXNiRGV2aWNlTWFuYWdlciAqc2VsZjsKPiA+IC0gICAgbGlidXNiX2RldmljZSAq
ZGV2aWNlOwo+ID4gLSAgICBsaWJ1c2JfaG90cGx1Z19ldmVudCBldmVudDsKPiA+ICsgICAgU3Bp
Y2VVc2JCYWNrZW5kRGV2aWNlICpkZXZpY2U7Cj4gPiArICAgIGdib29sZWFuICAgICAgICAgICAg
ICAgYWRkZWQ7Cj4gPiAgfTsKPiA+Cj4gPiAgc3RhdGljIGdib29sZWFuIHNwaWNlX3VzYl9kZXZp
Y2VfbWFuYWdlcl9ob3RwbHVnX2lkbGVfY2IoZ3BvaW50ZXIgdXNlcl9kYXRhKQo+ID4gQEAgLTEw
MDcsMzYgKzkyOCwyOSBAQCBzdGF0aWMgZ2Jvb2xlYW4gc3BpY2VfdXNiX2RldmljZV9tYW5hZ2Vy
X2hvdHBsdWdfaWRsZV9jYihncG9pbnRlciB1c2VyX2RhdGEpCj4gPiAgICAgIHN0cnVjdCBob3Rw
bHVnX2lkbGVfY2JfYXJncyAqYXJncyA9IHVzZXJfZGF0YTsKPiA+ICAgICAgU3BpY2VVc2JEZXZp
Y2VNYW5hZ2VyICpzZWxmID0gU1BJQ0VfVVNCX0RFVklDRV9NQU5BR0VSKGFyZ3MtPnNlbGYpOwo+
ID4KPiA+IC0gICAgc3dpdGNoIChhcmdzLT5ldmVudCkgewo+ID4gLSAgICBjYXNlIExJQlVTQl9I
T1RQTFVHX0VWRU5UX0RFVklDRV9BUlJJVkVEOgo+ID4gKyAgICBpZiAoYXJncy0+YWRkZWQpCj4g
PiAgICAgICAgICBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfYWRkX2RldihzZWxmLCBhcmdzLT5k
ZXZpY2UpOwo+ID4gLSAgICAgICAgYnJlYWs7Cj4gPiAtICAgIGNhc2UgTElCVVNCX0hPVFBMVUdf
RVZFTlRfREVWSUNFX0xFRlQ6Cj4gPiAtICAgICAgICBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJf
cmVtb3ZlX2RldihzZWxmLAo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGxpYnVzYl9nZXRfYnVzX251bWJlcihhcmdzLT5kZXZpY2UpLAo+ID4gLSAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGxpYnVzYl9nZXRfZGV2aWNlX2FkZHJlc3MoYXJncy0+ZGV2
aWNlKSk7Cj4gPiAtICAgICAgICBicmVhazsKPiA+IC0gICAgfQo+ID4gLSAgICBsaWJ1c2JfdW5y
ZWZfZGV2aWNlKGFyZ3MtPmRldmljZSk7Cj4gPiArICAgIGVsc2UKPiA+ICsgICAgICAgIHNwaWNl
X3VzYl9kZXZpY2VfbWFuYWdlcl9yZW1vdmVfZGV2KHNlbGYsIGFyZ3MtPmRldmljZSk7Cj4gPiAr
Cj4gPiArICAgIHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV91bnJlZihhcmdzLT5kZXZpY2UpOwo+
ID4gICAgICBnX29iamVjdF91bnJlZihzZWxmKTsKPiA+ICAgICAgZ19mcmVlKGFyZ3MpOwo+ID4g
ICAgICByZXR1cm4gRkFMU0U7Cj4gPiAgfQo+ID4KPiA+ICAvKiBDYW4gYmUgY2FsbGVkIGZyb20g
Ym90aCB0aGUgbWFpbi10aHJlYWQgYXMgd2VsbCBhcyB0aGUgZXZlbnRfdGhyZWFkICovCj4gPiAt
c3RhdGljIGludCBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfaG90cGx1Z19jYihsaWJ1c2JfY29u
dGV4dCAgICAgICAqY3R4LAo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgbGlidXNiX2RldmljZSAgICAgICAgKmRldmljZSwKPiA+IC0gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpYnVzYl9ob3RwbHVnX2V2ZW50
ICBldmVudCwKPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHZvaWQgICAgICAgICAgICAgICAgICp1c2VyX2RhdGEpCj4gPiArc3RhdGljIHZvaWQgc3Bp
Y2VfdXNiX2RldmljZV9tYW5hZ2VyX2hvdHBsdWdfY2Iodm9pZCAqdXNlcl9kYXRhLAo+ID4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNwaWNlVXNiQmFj
a2VuZERldmljZSAqZGV2LAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGdib29sZWFuIGFkZGVkKQo+ID4gIHsKPiA+ICAgICAgU3BpY2VVc2JEZXZp
Y2VNYW5hZ2VyICpzZWxmID0gU1BJQ0VfVVNCX0RFVklDRV9NQU5BR0VSKHVzZXJfZGF0YSk7Cj4g
PiAgICAgIHN0cnVjdCBob3RwbHVnX2lkbGVfY2JfYXJncyAqYXJncyA9IGdfbWFsbG9jMChzaXpl
b2YoKmFyZ3MpKTsKPiA+Cj4gPiAgICAgIGFyZ3MtPnNlbGYgPSBnX29iamVjdF9yZWYoc2VsZik7
Cj4gPiAtICAgIGFyZ3MtPmRldmljZSA9IGxpYnVzYl9yZWZfZGV2aWNlKGRldmljZSk7Cj4gPiAt
ICAgIGFyZ3MtPmV2ZW50ID0gZXZlbnQ7Cj4gPiArICAgIGFyZ3MtPmRldmljZSA9IHNwaWNlX3Vz
Yl9iYWNrZW5kX2RldmljZV9yZWYoZGV2KTsKPiA+ICsgICAgYXJncy0+YWRkZWQgPSBhZGRlZDsK
PiA+ICAgICAgZ19pZGxlX2FkZChzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfaG90cGx1Z19pZGxl
X2NiLCBhcmdzKTsKPiA+IC0gICAgcmV0dXJuIDA7Cj4gPiAgfQo+ID4gICNlbmRpZiAvLyBVU0Vf
VVNCUkVESVIKPiA+Cj4gPiBAQCAtMTA2MywxMyArOTc3LDkgQEAgc3RhdGljIGdwb2ludGVyIHNw
aWNlX3VzYl9kZXZpY2VfbWFuYWdlcl91c2JfZXZfdGhyZWFkKGdwb2ludGVyIHVzZXJfZGF0YSkK
PiA+ICB7Cj4gPiAgICAgIFNwaWNlVXNiRGV2aWNlTWFuYWdlciAqc2VsZiA9IFNQSUNFX1VTQl9E
RVZJQ0VfTUFOQUdFUih1c2VyX2RhdGEpOwo+ID4gICAgICBTcGljZVVzYkRldmljZU1hbmFnZXJQ
cml2YXRlICpwcml2ID0gc2VsZi0+cHJpdjsKPiA+IC0gICAgaW50IHJjOwo+ID4KPiA+ICAgICAg
d2hpbGUgKGdfYXRvbWljX2ludF9nZXQoJnByaXYtPmV2ZW50X3RocmVhZF9ydW4pKSB7Cj4gPiAt
ICAgICAgICByYyA9IGxpYnVzYl9oYW5kbGVfZXZlbnRzKHByaXYtPmNvbnRleHQpOwo+ID4gLSAg
ICAgICAgaWYgKHJjICYmIHJjICE9IExJQlVTQl9FUlJPUl9JTlRFUlJVUFRFRCkgewo+ID4gLSAg
ICAgICAgICAgIGNvbnN0IGNoYXIgKmRlc2MgPSBzcGljZV91c2J1dGlsX2xpYnVzYl9zdHJlcnJv
cihyYyk7Cj4gPiAtICAgICAgICAgICAgZ193YXJuaW5nKCJFcnJvciBoYW5kbGluZyBVU0IgZXZl
bnRzOiAlcyBbJWldIiwgZGVzYywgcmMpOwo+ID4gKyAgICAgICAgaWYgKCFzcGljZV91c2JfYmFj
a2VuZF9oYW5kbGVfZXZlbnRzKHByaXYtPmNvbnRleHQpKSB7Cj4gPiAgICAgICAgICAgICAgYnJl
YWs7Cj4gPiAgICAgICAgICB9Cj4gPiAgICAgIH0KPiA+IEBAIC0xMTIwLDcgKzEwMzAsNyBAQCBz
dGF0aWMgdm9pZCBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfY2hlY2tfcmVkaXJfb25fY29ubmVj
dCgKPiA+ICAgICAgU3BpY2VVc2JEZXZpY2VNYW5hZ2VyUHJpdmF0ZSAqcHJpdiA9IHNlbGYtPnBy
aXY7Cj4gPiAgICAgIEdUYXNrICp0YXNrOwo+ID4gICAgICBTcGljZVVzYkRldmljZSAqZGV2aWNl
Owo+ID4gLSAgICBsaWJ1c2JfZGV2aWNlICpsaWJkZXY7Cj4gPiArICAgIFNwaWNlVXNiQmFja2Vu
ZERldmljZSAqYmRldjsKPiA+ICAgICAgZ3VpbnQgaTsKPiA+Cj4gPiAgICAgIGlmIChwcml2LT5y
ZWRpcmVjdF9vbl9jb25uZWN0ID09IE5VTEwpCj4gPiBAQCAtMTEzMiwxMSArMTA0MiwxMSBAQCBz
dGF0aWMgdm9pZCBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfY2hlY2tfcmVkaXJfb25fY29ubmVj
dCgKPiA+ICAgICAgICAgIGlmIChzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfaXNfZGV2aWNlX2Nv
bm5lY3RlZChzZWxmLCBkZXZpY2UpKQo+ID4gICAgICAgICAgICAgIGNvbnRpbnVlOwo+ID4KPiA+
IC0gICAgICAgIGxpYmRldiA9IHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9kZXZpY2VfdG9fbGli
ZGV2KHNlbGYsIGRldmljZSk7Cj4gPiAtICAgICAgICBpZiAodXNicmVkaXJob3N0X2NoZWNrX2Rl
dmljZV9maWx0ZXIoCj4gPiArICAgICAgICBiZGV2ID0gc3BpY2VfdXNiX2RldmljZV9tYW5hZ2Vy
X2RldmljZV90b19iZGV2KHNlbGYsIGRldmljZSk7Cj4gPiArICAgICAgICBpZiAoc3BpY2VfdXNi
X2JhY2tlbmRfZGV2aWNlX2NoZWNrX2ZpbHRlcigKPiA+ICsgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgYmRldiwKPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpdi0+cmVkaXJl
Y3Rfb25fY29ubmVjdF9ydWxlcywKPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJp
di0+cmVkaXJlY3Rfb25fY29ubmVjdF9ydWxlc19jb3VudCwKPiA+IC0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgbGliZGV2LCAwKSA9PSAwKSB7Cj4gPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHByaXYtPnJlZGlyZWN0X29uX2Nvbm5lY3RfcnVsZXNfY291bnQpID09IDApIHsKPiA+
ICAgICAgICAgICAgICAvKiBOb3RlOiByZS11c2VzIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9j
b25uZWN0X2RldmljZV9hc3luYydzCj4gPiAgICAgICAgICAgICAgICAgY29tcGxldGlvbiBoYW5k
bGluZyBjb2RlISAqLwo+ID4gICAgICAgICAgICAgIHRhc2sgPSBnX3Rhc2tfbmV3KHNlbGYsCj4g
PiBAQCAtMTE0NiwxNCArMTA1NiwxNCBAQCBzdGF0aWMgdm9pZCBzcGljZV91c2JfZGV2aWNlX21h
bmFnZXJfY2hlY2tfcmVkaXJfb25fY29ubmVjdCgKPiA+Cj4gPiAgICAgICAgICAgICAgc3BpY2Vf
dXNicmVkaXJfY2hhbm5lbF9jb25uZWN0X2RldmljZV9hc3luYygKPiA+ICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgU1BJQ0VfVVNCUkVESVJfQ0hBTk5FTChjaGFubmVsKSwKPiA+IC0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGliZGV2LCBkZXZpY2UsIE5VTEwsCj4gPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJkZXYsIGRldmljZSwgTlVMTCwKPiA+ICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2No
YW5uZWxfY29ubmVjdF9jYiwKPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFz
ayk7Cj4gPiAtICAgICAgICAgICAgbGlidXNiX3VucmVmX2RldmljZShsaWJkZXYpOwo+ID4gKyAg
ICAgICAgICAgIHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV91bnJlZihiZGV2KTsKPiA+ICAgICAg
ICAgICAgICByZXR1cm47IC8qIFdlJ3ZlIHRha2VuIHRoZSBjaGFubmVsISAqLwo+ID4gICAgICAg
ICAgfQo+ID4KPiA+IC0gICAgICAgIGxpYnVzYl91bnJlZl9kZXZpY2UobGliZGV2KTsKPiA+ICsg
ICAgICAgIHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV91bnJlZihiZGV2KTsKPiA+ICAgICAgfQo+
ID4gIH0KPiA+Cj4gPiBAQCAtMTE3Nyw4ICsxMDg3LDggQEAgc3RhdGljIFNwaWNlVXNicmVkaXJD
aGFubmVsICpzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfZ2V0X2NoYW5uZWxfZm9yX2RldigKPiA+
ICAgICAgZm9yIChpID0gMDsgaSA8IHByaXYtPmNoYW5uZWxzLT5sZW47IGkrKykgewo+ID4gICAg
ICAgICAgU3BpY2VVc2JyZWRpckNoYW5uZWwgKmNoYW5uZWwgPSBnX3B0cl9hcnJheV9pbmRleChw
cml2LT5jaGFubmVscywgaSk7Cj4gPiAgICAgICAgICBzcGljZV91c2JyZWRpcl9jaGFubmVsX2xv
Y2soY2hhbm5lbCk7Cj4gPiAtICAgICAgICBsaWJ1c2JfZGV2aWNlICpsaWJkZXYgPSBzcGljZV91
c2JyZWRpcl9jaGFubmVsX2dldF9kZXZpY2UoY2hhbm5lbCk7Cj4gPiAtICAgICAgICBpZiAoc3Bp
Y2VfdXNiX21hbmFnZXJfZGV2aWNlX2VxdWFsX2xpYmRldihtYW5hZ2VyLCBkZXZpY2UsIGxpYmRl
dikpIHsKPiA+ICsgICAgICAgIFNwaWNlVXNiQmFja2VuZERldmljZSAqYmRldiA9IHNwaWNlX3Vz
YnJlZGlyX2NoYW5uZWxfZ2V0X2RldmljZShjaGFubmVsKTsKPiA+ICsgICAgICAgIGlmIChzcGlj
ZV91c2JfbWFuYWdlcl9kZXZpY2VfZXF1YWxfYmRldihtYW5hZ2VyLCBkZXZpY2UsIGJkZXYpKSB7
Cj4gPiAgICAgICAgICAgICAgc3BpY2VfdXNicmVkaXJfY2hhbm5lbF91bmxvY2soY2hhbm5lbCk7
Cj4gPiAgICAgICAgICAgICAgcmV0dXJuIGNoYW5uZWw7Cj4gPiAgICAgICAgICB9Cj4gPiBAQCAt
MTIzNSw5ICsxMTQ1LDkgQEAgR1B0ckFycmF5KiBzcGljZV91c2JfZGV2aWNlX21hbmFnZXJfZ2V0
X2RldmljZXNfd2l0aF9maWx0ZXIoCj4gPiAgICAgICAgICBTcGljZVVzYkRldmljZSAqZGV2aWNl
ID0gZ19wdHJfYXJyYXlfaW5kZXgocHJpdi0+ZGV2aWNlcywgaSk7Cj4gPgo+ID4gICAgICAgICAg
aWYgKHJ1bGVzKSB7Cj4gPiAtICAgICAgICAgICAgbGlidXNiX2RldmljZSAqbGliZGV2ID0KPiA+
IC0gICAgICAgICAgICAgICAgc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2RldmljZV90b19saWJk
ZXYoc2VsZiwgZGV2aWNlKTsKPiA+IC0gICAgICAgICAgICBpZiAodXNicmVkaXJob3N0X2NoZWNr
X2RldmljZV9maWx0ZXIocnVsZXMsIGNvdW50LCBsaWJkZXYsIDApICE9IDApCj4gPiArICAgICAg
ICAgICAgU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpiZGV2ID0KPiA+ICsgICAgICAgICAgICAgICAg
c3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2RldmljZV90b19iZGV2KHNlbGYsIGRldmljZSk7Cj4g
PiArICAgICAgICAgICAgaWYgKHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9jaGVja19maWx0ZXIo
YmRldiwgcnVsZXMsIGNvdW50KSAhPSAwKQo+ID4gICAgICAgICAgICAgICAgICBjb250aW51ZTsK
PiA+ICAgICAgICAgIH0KPiA+ICAgICAgICAgIGdfcHRyX2FycmF5X2FkZChkZXZpY2VzX2NvcHks
IHNwaWNlX3VzYl9kZXZpY2VfcmVmKGRldmljZSkpOwo+ID4gQEAgLTEzMTEsNyArMTIyMSw3IEBA
IF9zcGljZV91c2JfZGV2aWNlX21hbmFnZXJfY29ubmVjdF9kZXZpY2VfYXN5bmMoU3BpY2VVc2JE
ZXZpY2VNYW5hZ2VyICpzZWxmLAo+ID4gICAgICB0YXNrID0gZ190YXNrX25ldyhzZWxmLCBjYW5j
ZWxsYWJsZSwgY2FsbGJhY2ssIHVzZXJfZGF0YSk7Cj4gPgo+ID4gICAgICBTcGljZVVzYkRldmlj
ZU1hbmFnZXJQcml2YXRlICpwcml2ID0gc2VsZi0+cHJpdjsKPiA+IC0gICAgbGlidXNiX2Rldmlj
ZSAqbGliZGV2Owo+ID4gKyAgICBTcGljZVVzYkJhY2tlbmREZXZpY2UgKmJkZXY7Cj4gPiAgICAg
IGd1aW50IGk7Cj4gPgo+ID4gICAgICBpZiAoc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2lzX2Rl
dmljZV9jb25uZWN0ZWQoc2VsZiwgZGV2aWNlKSkgewo+ID4gQEAgLTEzMjcsMTQgKzEyMzcsMTQg
QEAgX3NwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9jb25uZWN0X2RldmljZV9hc3luYyhTcGljZVVz
YkRldmljZU1hbmFnZXIgKnNlbGYsCj4gPiAgICAgICAgICBpZiAoc3BpY2VfdXNicmVkaXJfY2hh
bm5lbF9nZXRfZGV2aWNlKGNoYW5uZWwpKQo+ID4gICAgICAgICAgICAgIGNvbnRpbnVlOyAvKiBT
a2lwIGFscmVhZHkgdXNlZCBjaGFubmVscyAqLwo+ID4KPiA+IC0gICAgICAgIGxpYmRldiA9IHNw
aWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9kZXZpY2VfdG9fbGliZGV2KHNlbGYsIGRldmljZSk7Cj4g
PiArICAgICAgICBiZGV2ID0gc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2RldmljZV90b19iZGV2
KHNlbGYsIGRldmljZSk7Cj4gPiAgICAgICAgICBzcGljZV91c2JyZWRpcl9jaGFubmVsX2Nvbm5l
Y3RfZGV2aWNlX2FzeW5jKGNoYW5uZWwsCj4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgbGliZGV2LAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJkZXYs
Cj4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGV2aWNlLAo+ID4gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbmNlbGxhYmxlLAo+ID4gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHNwaWNlX3VzYl9kZXZpY2VfbWFuYWdlcl9jaGFubmVsX2Nv
bm5lY3RfY2IsCj4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFzayk7Cj4g
PiAtICAgICAgICBsaWJ1c2JfdW5yZWZfZGV2aWNlKGxpYmRldik7Cj4gPiArICAgICAgICBzcGlj
ZV91c2JfYmFja2VuZF9kZXZpY2VfdW5yZWYoYmRldik7Cj4gPiAgICAgICAgICByZXR1cm47Cj4g
PiAgICAgIH0KPiA+Cj4gPiBAQCAtMTU5NiwxMyArMTUwNiwxNCBAQCBzcGljZV91c2JfZGV2aWNl
X21hbmFnZXJfY2FuX3JlZGlyZWN0X2RldmljZShTcGljZVVzYkRldmljZU1hbmFnZXIgICpzZWxm
LAo+ID4KPiA+ICAgICAgaWYgKGd1ZXN0X2ZpbHRlcl9ydWxlcykgewo+ID4gICAgICAgICAgZ2Jv
b2xlYW4gZmlsdGVyX29rOwo+ID4gLSAgICAgICAgbGlidXNiX2RldmljZSAqbGliZGV2Owo+ID4g
LQo+ID4gLSAgICAgICAgbGliZGV2ID0gc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2RldmljZV90
b19saWJkZXYoc2VsZiwgZGV2aWNlKTsKPiA+IC0gICAgICAgIGZpbHRlcl9vayA9ICh1c2JyZWRp
cmhvc3RfY2hlY2tfZGV2aWNlX2ZpbHRlcigKPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgZ3Vlc3RfZmlsdGVyX3J1bGVzLCBndWVzdF9maWx0ZXJfcnVsZXNfY291bnQsCj4gPiAtICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGxpYmRldiwgMCkgPT0gMCk7Cj4gPiAtICAgICAgICBs
aWJ1c2JfdW5yZWZfZGV2aWNlKGxpYmRldik7Cj4gPiArICAgICAgICBTcGljZVVzYkJhY2tlbmRE
ZXZpY2UgKmJkZXY7Cj4gPiArCj4gPiArICAgICAgICBiZGV2ID0gc3BpY2VfdXNiX2RldmljZV9t
YW5hZ2VyX2RldmljZV90b19iZGV2KHNlbGYsIGRldmljZSk7Cj4gPiArICAgICAgICBmaWx0ZXJf
b2sgPSAoc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX2NoZWNrX2ZpbHRlcigKPiA+ICsgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgYmRldiwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgZ3Vlc3RfZmlsdGVyX3J1bGVzLAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBn
dWVzdF9maWx0ZXJfcnVsZXNfY291bnQpID09IDApOwo+ID4gKyAgICAgICAgc3BpY2VfdXNiX2Jh
Y2tlbmRfZGV2aWNlX3VucmVmKGJkZXYpOwo+ID4gICAgICAgICAgaWYgKCFmaWx0ZXJfb2spIHsK
PiA+ICAgICAgICAgICAgICBnX3NldF9lcnJvcl9saXRlcmFsKGVyciwgU1BJQ0VfQ0xJRU5UX0VS
Uk9SLCBTUElDRV9DTElFTlRfRVJST1JfRkFJTEVELAo+ID4gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgXygiU29tZSBVU0IgZGV2aWNlcyBhcmUgYmxvY2tlZCBieSBob3N0IHBvbGlj
eSIpKTsKPiA+IEBAIC0xNjk2LDYwICsxNjA3LDI3IEBAIGdjaGFyICpzcGljZV91c2JfZGV2aWNl
X2dldF9kZXNjcmlwdGlvbihTcGljZVVzYkRldmljZSAqZGV2aWNlLCBjb25zdCBnY2hhciAqZm9y
Cj4gPgo+ID4KPiA+ICAjaWZkZWYgVVNFX1VTQlJFRElSCj4gPiAtc3RhdGljIGdib29sZWFuIHBy
b2JlX2lzb2Nocm9ub3VzX2VuZHBvaW50KGxpYnVzYl9kZXZpY2UgKmxpYmRldikKPiA+IC17Cj4g
PiAtICAgIHN0cnVjdCBsaWJ1c2JfY29uZmlnX2Rlc2NyaXB0b3IgKmNvbmZfZGVzYzsKPiA+IC0g
ICAgZ2Jvb2xlYW4gaXNvY19mb3VuZCA9IEZBTFNFOwo+ID4gLSAgICBnaW50IGksIGosIGs7Cj4g
PiAtCj4gPiAtICAgIGdfcmV0dXJuX3ZhbF9pZl9mYWlsKGxpYmRldiAhPSBOVUxMLCBGQUxTRSk7
Cj4gPiAtCj4gPiAtICAgIGlmIChsaWJ1c2JfZ2V0X2FjdGl2ZV9jb25maWdfZGVzY3JpcHRvcihs
aWJkZXYsICZjb25mX2Rlc2MpICE9IDApIHsKPiA+IC0gICAgICAgIGdfcmV0dXJuX3ZhbF9pZl9y
ZWFjaGVkKEZBTFNFKTsKPiA+IC0gICAgfQo+ID4gLQo+ID4gLSAgICBmb3IgKGkgPSAwOyAhaXNv
Y19mb3VuZCAmJiBpIDwgY29uZl9kZXNjLT5iTnVtSW50ZXJmYWNlczsgaSsrKSB7Cj4gPiAtICAg
ICAgICBmb3IgKGogPSAwOyAhaXNvY19mb3VuZCAmJiBqIDwgY29uZl9kZXNjLT5pbnRlcmZhY2Vb
aV0ubnVtX2FsdHNldHRpbmc7IGorKykgewo+ID4gLSAgICAgICAgICAgIGZvciAoayA9IDA7ICFp
c29jX2ZvdW5kICYmIGsgPCBjb25mX2Rlc2MtPmludGVyZmFjZVtpXS5hbHRzZXR0aW5nW2pdLmJO
dW1FbmRwb2ludHM7aysrKSB7Cj4gPiAtICAgICAgICAgICAgICAgIGdpbnQgYXR0cmlidXRlcyA9
IGNvbmZfZGVzYy0+aW50ZXJmYWNlW2ldLmFsdHNldHRpbmdbal0uZW5kcG9pbnRba10uYm1BdHRy
aWJ1dGVzOwo+ID4gLSAgICAgICAgICAgICAgICBnaW50IHR5cGUgPSBhdHRyaWJ1dGVzICYgTElC
VVNCX1RSQU5TRkVSX1RZUEVfTUFTSzsKPiA+IC0gICAgICAgICAgICAgICAgaWYgKHR5cGUgPT0g
TElCVVNCX1RSQU5TRkVSX1RZUEVfSVNPQ0hST05PVVMpCj4gPiAtICAgICAgICAgICAgICAgICAg
ICBpc29jX2ZvdW5kID0gVFJVRTsKPiA+IC0gICAgICAgICAgICB9Cj4gPiAtICAgICAgICB9Cj4g
PiAtICAgIH0KPiA+IC0KPiA+IC0gICAgbGlidXNiX2ZyZWVfY29uZmlnX2Rlc2NyaXB0b3IoY29u
Zl9kZXNjKTsKPiA+IC0gICAgcmV0dXJuIGlzb2NfZm91bmQ7Cj4gPiAtfQo+ID4gLQo+ID4gIC8q
Cj4gPiAgICogU3BpY2VVc2JEZXZpY2VJbmZvCj4gPiAgICovCj4gPiAtc3RhdGljIFNwaWNlVXNi
RGV2aWNlSW5mbyAqc3BpY2VfdXNiX2RldmljZV9uZXcobGlidXNiX2RldmljZSAqbGliZGV2KQo+
ID4gK3N0YXRpYyBTcGljZVVzYkRldmljZUluZm8gKnNwaWNlX3VzYl9kZXZpY2VfbmV3KFNwaWNl
VXNiQmFja2VuZERldmljZSAqYmRldikKPiA+ICB7Cj4gPiAgICAgIFNwaWNlVXNiRGV2aWNlSW5m
byAqaW5mbzsKPiA+IC0gICAgaW50IHZpZCwgcGlkOwo+ID4gLSAgICBndWludDggYnVzLCBhZGRy
Owo+ID4gLQo+ID4gLSAgICBnX3JldHVybl92YWxfaWZfZmFpbChsaWJkZXYgIT0gTlVMTCwgTlVM
TCk7Cj4gPiArICAgIGNvbnN0IFVzYkRldmljZUluZm9ybWF0aW9uICpiZGV2X2luZm87Cj4gPgo+
ID4gLSAgICBidXMgPSBsaWJ1c2JfZ2V0X2J1c19udW1iZXIobGliZGV2KTsKPiA+IC0gICAgYWRk
ciA9IGxpYnVzYl9nZXRfZGV2aWNlX2FkZHJlc3MobGliZGV2KTsKPiA+ICsgICAgZ19yZXR1cm5f
dmFsX2lmX2ZhaWwoYmRldiAhPSBOVUxMLCBOVUxMKTsKPiA+Cj4gPiAtICAgIGlmICghc3BpY2Vf
dXNiX2RldmljZV9tYW5hZ2VyX2dldF9saWJkZXZfdmlkX3BpZChsaWJkZXYsICZ2aWQsICZwaWQp
KSB7Cj4gPiAtICAgICAgICByZXR1cm4gTlVMTDsKPiA+IC0gICAgfQo+ID4gKyAgICBiZGV2X2lu
Zm8gPSBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfZ2V0X2luZm8oYmRldik7Cj4gPgo+ID4gICAg
ICBpbmZvID0gZ19uZXcwKFNwaWNlVXNiRGV2aWNlSW5mbywgMSk7Cj4gPgo+ID4gLSAgICBpbmZv
LT5idXNudW0gID0gYnVzOwo+ID4gLSAgICBpbmZvLT5kZXZhZGRyID0gYWRkcjsKPiA+IC0gICAg
aW5mby0+dmlkID0gdmlkOwo+ID4gLSAgICBpbmZvLT5waWQgPSBwaWQ7Cj4gPiArICAgIGluZm8t
PmJ1c251bSAgPSBiZGV2X2luZm8tPmJ1czsKPiA+ICsgICAgaW5mby0+ZGV2YWRkciA9IGJkZXZf
aW5mby0+YWRkcmVzczsKPiA+ICsgICAgaW5mby0+dmlkID0gYmRldl9pbmZvLT52aWQ7Cj4gPiAr
ICAgIGluZm8tPnBpZCA9IGJkZXZfaW5mby0+cGlkOwo+ID4gICAgICBpbmZvLT5yZWYgPSAxOwo+
ID4gLSAgICBpbmZvLT5pc29jaHJvbm91cyA9IHByb2JlX2lzb2Nocm9ub3VzX2VuZHBvaW50KGxp
YmRldik7Cj4gPiAtICAgIGluZm8tPmxpYmRldiA9IGxpYnVzYl9yZWZfZGV2aWNlKGxpYmRldik7
Cj4gPiArICAgIGluZm8tPmJkZXYgPSBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfcmVmKGJkZXYp
Owo+ID4gKyAgICBpbmZvLT5pc29jaHJvbm91cyA9IHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV9p
c29jaChiZGV2KTsKPiA+Cj4gPiAgICAgIHJldHVybiBpbmZvOwo+ID4gIH0KPiA+IEBAIC0xODg1
LDM1ICsxNzYzLDM1IEBAIHN0YXRpYyB2b2lkIHNwaWNlX3VzYl9kZXZpY2VfdW5yZWYoU3BpY2VV
c2JEZXZpY2UgKmRldmljZSkKPiA+Cj4gPiAgICAgIHJlZl9jb3VudF9pc18wID0gZ19hdG9taWNf
aW50X2RlY19hbmRfdGVzdCgmaW5mby0+cmVmKTsKPiA+ICAgICAgaWYgKHJlZl9jb3VudF9pc18w
KSB7Cj4gPiAtICAgICAgICBsaWJ1c2JfdW5yZWZfZGV2aWNlKGluZm8tPmxpYmRldik7Cj4gPiAr
ICAgICAgICBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfdW5yZWYoaW5mby0+YmRldik7Cj4gPiAg
ICAgICAgICBnX2ZyZWUoaW5mbyk7Cj4gPiAgICAgIH0KPiA+ICB9Cj4gPgo+ID4gIHN0YXRpYyBn
Ym9vbGVhbgo+ID4gLXNwaWNlX3VzYl9tYW5hZ2VyX2RldmljZV9lcXVhbF9saWJkZXYoU3BpY2VV
c2JEZXZpY2VNYW5hZ2VyICptYW5hZ2VyLAo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgU3BpY2VVc2JEZXZpY2UgKmRldmljZSwKPiA+IC0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGxpYnVzYl9kZXZpY2UgICpsaWJkZXYpCj4gPiArc3BpY2Vf
dXNiX21hbmFnZXJfZGV2aWNlX2VxdWFsX2JkZXYoU3BpY2VVc2JEZXZpY2VNYW5hZ2VyICptYW5h
Z2VyLAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNwaWNlVXNiRGV2
aWNlICpkZXZpY2UsCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU3Bp
Y2VVc2JCYWNrZW5kRGV2aWNlICpiZGV2KQo+ID4gIHsKPiA+ICAgICAgU3BpY2VVc2JEZXZpY2VJ
bmZvICppbmZvID0gKFNwaWNlVXNiRGV2aWNlSW5mbyAqKWRldmljZTsKPiA+Cj4gPiAtICAgIGlm
ICgoZGV2aWNlID09IE5VTEwpIHx8IChsaWJkZXYgPT0gTlVMTCkpCj4gPiArICAgIGlmICgoZGV2
aWNlID09IE5VTEwpIHx8IChiZGV2ID09IE5VTEwpKQo+ID4gICAgICAgICAgcmV0dXJuIEZBTFNF
Owo+ID4KPiA+IC0gICAgcmV0dXJuIGluZm8tPmxpYmRldiA9PSBsaWJkZXY7Cj4gPiArICAgIHJl
dHVybiBpbmZvLT5iZGV2ID09IGJkZXY7Cj4gPiAgfQo+ID4KPiA+ICAvKgo+ID4gICAqIENhbGxl
ciBtdXN0IGxpYnVzYl91bnJlZl9kZXZpY2UgdGhlIGxpYnVzYl9kZXZpY2UgcmV0dXJuZWQgYnkg
dGhpcyBmdW5jdGlvbi4KPiA+ICAgKiBSZXR1cm5zIGEgbGlidXNiX2RldmljZSwgb3IgTlVMTCB1
cG9uIGZhaWx1cmUKPiA+ICAgKi8KPiA+IC1zdGF0aWMgbGlidXNiX2RldmljZSAqCj4gPiAtc3Bp
Y2VfdXNiX2RldmljZV9tYW5hZ2VyX2RldmljZV90b19saWJkZXYoU3BpY2VVc2JEZXZpY2VNYW5h
Z2VyICpzZWxmLAo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IFNwaWNlVXNiRGV2aWNlICpkZXZpY2UpCj4gPiArc3RhdGljIFNwaWNlVXNiQmFja2VuZERldmlj
ZSAqCj4gPiArc3BpY2VfdXNiX2RldmljZV9tYW5hZ2VyX2RldmljZV90b19iZGV2KFNwaWNlVXNi
RGV2aWNlTWFuYWdlciAqc2VsZiwKPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgU3BpY2VVc2JEZXZpY2UgKmRldmljZSkKPiA+ICB7Cj4gPiAgICAgIC8qIFNpbXBs
eSByZXR1cm4gYSByZWYgdG8gdGhlIGNhY2hlZCBsaWJkZXYgKi8KPiA+ICAgICAgU3BpY2VVc2JE
ZXZpY2VJbmZvICppbmZvID0gKFNwaWNlVXNiRGV2aWNlSW5mbyAqKWRldmljZTsKPiA+Cj4gPiAt
ICAgIHJldHVybiBsaWJ1c2JfcmVmX2RldmljZShpbmZvLT5saWJkZXYpOwo+ID4gKyAgICByZXR1
cm4gc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX3JlZihpbmZvLT5iZGV2KTsKPiA+ICB9Cj4gPiAg
I2VuZGlmIC8qIFVTRV9VU0JSRURJUiAqLwo+ID4gZGlmZiAtLWdpdCBhL3NyYy91c2J1dGlsLmMg
Yi9zcmMvdXNidXRpbC5jCj4gPiBpbmRleCA0YWE2ZWY3Li41MDUyZWYzIDEwMDY0NAo+ID4gLS0t
IGEvc3JjL3VzYnV0aWwuYwo+ID4gKysrIGIvc3JjL3VzYnV0aWwuYwo+ID4gQEAgLTU4LDEyICs1
OCw2IEBAIHN0YXRpYyBHTXV0ZXggdXNiaWRzX2xvYWRfbXV0ZXg7Cj4gPiAgc3RhdGljIGludCB1
c2JpZHNfdmVuZG9yX2NvdW50ID0gMDsgLyogPCAwOiBmYWlsZWQsIDA6IGVtcHR5LCA+IDA6IGxv
YWRlZCAqLwo+ID4gIHN0YXRpYyB1c2JfdmVuZG9yX2luZm8gKnVzYmlkc192ZW5kb3JfaW5mbyA9
IE5VTEw7Cj4gPgo+ID4gLUdfR05VQ19JTlRFUk5BTAo+ID4gLWNvbnN0IGNoYXIgKnNwaWNlX3Vz
YnV0aWxfbGlidXNiX3N0cmVycm9yKGVudW0gbGlidXNiX2Vycm9yIGVycm9yX2NvZGUpCj4gPiAt
ewo+ID4gLSAgICByZXR1cm4gbGlidXNiX2Vycm9yX25hbWUoZXJyb3JfY29kZSk7Cj4gPiAtfQo+
ID4gLQo+ID4gICNpZmRlZiBfX2xpbnV4X18KPiA+ICAvKiA8U2lnaD4gbGlidXNiIGRvZXMgbm90
IGFsbG93IGdldHRpbmcgdGhlIG1hbnVmYWN0dXJlciBhbmQgcHJvZHVjdCBzdHJpbmdzCj4gPiAg
ICAgd2l0aG91dCBvcGVuaW5nIHRoZSBkZXZpY2UsIHNvIGdyYWIgdGhlbSBkaXJlY3RseSBmcm9t
IHN5c2ZzICovCj4gPiBkaWZmIC0tZ2l0IGEvc3JjL3VzYnV0aWwuaCBiL3NyYy91c2J1dGlsLmgK
PiA+IGluZGV4IGRlNWU5MmEuLmQxOGQ2ODggMTAwNjQ0Cj4gPiAtLS0gYS9zcmMvdXNidXRpbC5o
Cj4gPiArKysgYi9zcmMvdXNidXRpbC5oCj4gPiBAQCAtMjQsMTEgKzI0LDkgQEAKPiA+ICAjaW5j
bHVkZSA8Z2xpYi5oPgo+ID4KPiA+ICAjaWZkZWYgVVNFX1VTQlJFRElSCj4gPiAtI2luY2x1ZGUg
PGxpYnVzYi5oPgo+ID4KPiA+ICBHX0JFR0lOX0RFQ0xTCj4gPgo+ID4gLWNvbnN0IGNoYXIgKnNw
aWNlX3VzYnV0aWxfbGlidXNiX3N0cmVycm9yKGVudW0gbGlidXNiX2Vycm9yIGVycm9yX2NvZGUp
Owo+ID4gIHZvaWQgc3BpY2VfdXNiX3V0aWxfZ2V0X2RldmljZV9zdHJpbmdzKGludCBidXMsIGlu
dCBhZGRyZXNzLAo+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlu
dCB2ZW5kb3JfaWQsIGludCBwcm9kdWN0X2lkLAo+ID4gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGdjaGFyICoqbWFudWZhY3R1cmVyLCBnY2hhciAqKnByb2R1Y3QpOwo+
ID4gZGlmZiAtLWdpdCBhL3NyYy93aW4tdXNiLWRldi5jIGIvc3JjL3dpbi11c2ItZGV2LmMKPiA+
IGluZGV4IGE0ZGZhNzguLmMyYTUxMTUgMTAwNjQ0Cj4gPiAtLS0gYS9zcmMvd2luLXVzYi1kZXYu
Ywo+ID4gKysrIGIvc3JjL3dpbi11c2ItZGV2LmMKPiA+IEBAIC0yMywxMSArMjMsOSBAQAo+ID4g
ICNpbmNsdWRlICJjb25maWcuaCIKPiA+Cj4gPiAgI2luY2x1ZGUgPHdpbmRvd3MuaD4KPiA+IC0j
aW5jbHVkZSA8bGlidXNiLmg+Cj4gPiAgI2luY2x1ZGUgIndpbi11c2ItZGV2LmgiCj4gPiAgI2lu
Y2x1ZGUgInNwaWNlLW1hcnNoYWwuaCIKPiA+ICAjaW5jbHVkZSAic3BpY2UtdXRpbC5oIgo+ID4g
LSNpbmNsdWRlICJ1c2J1dGlsLmgiCj4gPgo+ID4gIGVudW0gewo+ID4gICAgICBQUk9QXzAsCj4g
PiBAQCAtMzUsNyArMzMsNyBAQCBlbnVtIHsKPiA+ICB9Owo+ID4KPiA+ICBzdHJ1Y3QgX0dVZGV2
Q2xpZW50UHJpdmF0ZSB7Cj4gPiAtICAgIGxpYnVzYl9jb250ZXh0ICpjdHg7Cj4gPiArICAgIFNw
aWNlVXNiQmFja2VuZCAqY3R4Owo+ID4gICAgICBHTGlzdCAqdWRldl9saXN0Owo+ID4gICAgICBI
V05EIGh3bmQ7Cj4gPiAgICAgIGdib29sZWFuIHJlZGlyZWN0aW5nOwo+ID4gQEAgLTY4LDkgKzY2
LDcgQEAgc3RhdGljIHZvaWQgZ191ZGV2X2RldmljZV9wcmludF9saXN0KEdMaXN0ICpsLCBjb25z
dCBnY2hhciAqbXNnKTsKPiA+ICAjZWxzZQo+ID4gIHN0YXRpYyB2b2lkIGdfdWRldl9kZXZpY2Vf
cHJpbnRfbGlzdChHTGlzdCAqbCwgY29uc3QgZ2NoYXIgKm1zZykge30KPiA+ICAjZW5kaWYKPiA+
IC1zdGF0aWMgdm9pZCBnX3VkZXZfZGV2aWNlX3ByaW50KGxpYnVzYl9kZXZpY2UgKmRldiwgY29u
c3QgZ2NoYXIgKm1zZyk7Cj4gPiAtCj4gPiAtc3RhdGljIGdib29sZWFuIGdfdWRldl9za2lwX3Nl
YXJjaChsaWJ1c2JfZGV2aWNlICpkZXYpOwo+ID4gK3N0YXRpYyB2b2lkIGdfdWRldl9kZXZpY2Vf
cHJpbnQoU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpkZXYsIGNvbnN0IGdjaGFyICptc2cpOwo+ID4K
PiA+ICBHUXVhcmsgZ191ZGV2X2NsaWVudF9lcnJvcl9xdWFyayh2b2lkKQo+ID4gIHsKPiA+IEBA
IC04Niw3ICs4Miw3IEBAIEdVZGV2Q2xpZW50ICpnX3VkZXZfY2xpZW50X25ldyh2b2lkKQo+ID4g
ICAgICByZXR1cm4gc2luZ2xldG9uOwo+ID4gIH0KPiA+Cj4gPiAtbGlidXNiX2NvbnRleHQgKmdf
dWRldl9jbGllbnRfZ2V0X2NvbnRleHQoR1VkZXZDbGllbnQgKmNsaWVudCkKPiA+ICtTcGljZVVz
YkJhY2tlbmQgKmdfdWRldl9jbGllbnRfZ2V0X2NvbnRleHQoR1VkZXZDbGllbnQgKmNsaWVudCkK
PiA+ICB7Cj4gPiAgICAgIHJldHVybiBjbGllbnQtPnByaXYtPmN0eDsKPiA+ICB9Cj4gPiBAQCAt
OTksOCArOTUsNyBAQCBzdGF0aWMgc3NpemVfdAo+ID4gIGdfdWRldl9jbGllbnRfbGlzdF9kZXZp
Y2VzKEdVZGV2Q2xpZW50ICpzZWxmLCBHTGlzdCAqKmRldnMsCj4gPiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgR0Vycm9yICoqZXJyLCBjb25zdCBnY2hhciAqbmFtZSkKPiA+ICB7Cj4gPiAt
ICAgIGdzc2l6ZSByYzsKPiA+IC0gICAgbGlidXNiX2RldmljZSAqKmx1c2JfbGlzdCwgKipkZXY7
Cj4gPiArICAgIFNwaWNlVXNiQmFja2VuZERldmljZSAqKmx1c2JfbGlzdCwgKipkZXY7Cj4gPiAg
ICAgIEdVZGV2Q2xpZW50UHJpdmF0ZSAqcHJpdjsKPiA+ICAgICAgc3NpemVfdCBuOwo+ID4KPiA+
IEBAIC0xMTEsNDMgKzEwNiwzMyBAQCBnX3VkZXZfY2xpZW50X2xpc3RfZGV2aWNlcyhHVWRldkNs
aWVudCAqc2VsZiwgR0xpc3QgKipkZXZzLAo+ID4KPiA+ICAgICAgZ19yZXR1cm5fdmFsX2lmX2Zh
aWwoc2VsZi0+cHJpdi0+Y3R4ICE9IE5VTEwsIC0zKTsKPiA+Cj4gPiAtICAgIHJjID0gbGlidXNi
X2dldF9kZXZpY2VfbGlzdChwcml2LT5jdHgsICZsdXNiX2xpc3QpOwo+ID4gLSAgICBpZiAocmMg
PCAwKSB7Cj4gPiAtICAgICAgICBjb25zdCBjaGFyICplcnJzdHIgPSBzcGljZV91c2J1dGlsX2xp
YnVzYl9zdHJlcnJvcihyYyk7Cj4gPiAtICAgICAgICBnX3dhcm5pbmcoIiVzOiBsaWJ1c2JfZ2V0
X2RldmljZV9saXN0IGZhaWxlZCAtICVzIiwgbmFtZSwgZXJyc3RyKTsKPiA+ICsgICAgbHVzYl9s
aXN0ID0gc3BpY2VfdXNiX2JhY2tlbmRfZ2V0X2RldmljZV9saXN0KHByaXYtPmN0eCk7Cj4gPiAr
ICAgIGlmICghbHVzYl9saXN0KSB7Cj4gPiAgICAgICAgICBnX3NldF9lcnJvcihlcnIsIEdfVURF
Vl9DTElFTlRfRVJST1IsIEdfVURFVl9DTElFTlRfTElCVVNCX0ZBSUxFRCwKPiA+IC0gICAgICAg
ICAgICAgICAgICAgICIlczogRXJyb3IgZ2V0dGluZyBkZXZpY2UgbGlzdCBmcm9tIGxpYnVzYjog
JXMgWyUiR19HU1NJWkVfRk9STUFUIl0iLAo+ID4gLSAgICAgICAgICAgICAgICAgICAgbmFtZSwg
ZXJyc3RyLCByYyk7Cj4gPiArICAgICAgICAgICAgICAgICAgICAiJXM6IEVycm9yIGdldHRpbmcg
VVNCIGRldmljZSBsaXN0IiwgbmFtZSk7Cj4gPiAgICAgICAgICByZXR1cm4gLTQ7Cj4gPiAgICAg
IH0KPiA+Cj4gPiAgICAgIG4gPSAwOwo+ID4gICAgICBmb3IgKGRldiA9IGx1c2JfbGlzdDsgKmRl
djsgZGV2KyspIHsKPiA+IC0gICAgICAgIGlmIChnX3VkZXZfc2tpcF9zZWFyY2goKmRldikpIHsK
PiA+IC0gICAgICAgICAgICBjb250aW51ZTsKPiA+IC0gICAgICAgIH0KPiA+IC0gICAgICAgICpk
ZXZzID0gZ19saXN0X3ByZXBlbmQoKmRldnMsIGxpYnVzYl9yZWZfZGV2aWNlKCpkZXYpKTsKPiA+
ICsgICAgICAgICpkZXZzID0gZ19saXN0X3ByZXBlbmQoKmRldnMsIHNwaWNlX3VzYl9iYWNrZW5k
X2RldmljZV9yZWYoKmRldikpOwo+ID4gICAgICAgICAgbisrOwo+ID4gICAgICB9Cj4gPiAtICAg
IGxpYnVzYl9mcmVlX2RldmljZV9saXN0KGx1c2JfbGlzdCwgMSk7Cj4gPiArICAgIHNwaWNlX3Vz
Yl9iYWNrZW5kX2ZyZWVfZGV2aWNlX2xpc3QobHVzYl9saXN0KTsKPiA+Cj4gPiAgICAgIHJldHVy
biBuOwo+ID4gIH0KPiA+Cj4gPiAtc3RhdGljIHZvaWQgdW5yZWZlcmVuY2VfbGlidXNiX2Rldmlj
ZShncG9pbnRlciBkYXRhKQo+ID4gK3N0YXRpYyB2b2lkIHVucmVmZXJlbmNlX2JhY2tlbmRfZGV2
aWNlKGdwb2ludGVyIGRhdGEpCj4gPiAgewo+ID4gLSAgICBsaWJ1c2JfdW5yZWZfZGV2aWNlKChs
aWJ1c2JfZGV2aWNlICopZGF0YSk7Cj4gPiArICAgIHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV91
bnJlZigoU3BpY2VVc2JCYWNrZW5kRGV2aWNlICopZGF0YSk7Cj4gPiAgfQo+ID4KPiA+ICBzdGF0
aWMgdm9pZCBnX3VkZXZfY2xpZW50X2ZyZWVfZGV2aWNlX2xpc3QoR0xpc3QgKipkZXZzKQo+ID4g
IHsKPiA+ICAgICAgZ19yZXR1cm5faWZfZmFpbChkZXZzICE9IE5VTEwpOwo+ID4gICAgICBpZiAo
KmRldnMpIHsKPiA+IC0gICAgICAgIC8qIHRoZSB1bnJlZmVyZW5jZV9saWJ1c2JfZGV2aWNlIG1l
dGhvZCBpcyByZXF1aXJlZCBhcwo+ID4gLSAgICAgICAgICogbGlidXNiX3VucmVmX2RldmljZSBj
YWxsaW5nIGNvbnZlbnRpb24gZGlmZmVycyBmcm9tIGdsaWIncwo+ID4gLSAgICAgICAgICogc2Vl
IDU1OGM5NjdlYwo+ID4gLSAgICAgICAgICovCj4gPiAtICAgICAgICBnX2xpc3RfZnJlZV9mdWxs
KCpkZXZzLCB1bnJlZmVyZW5jZV9saWJ1c2JfZGV2aWNlKTsKPiA+ICsgICAgICAgIGdfbGlzdF9m
cmVlX2Z1bGwoKmRldnMsIHVucmVmZXJlbmNlX2JhY2tlbmRfZGV2aWNlKTsKPiA+ICAgICAgICAg
ICpkZXZzID0gTlVMTDsKPiA+ICAgICAgfQo+ID4gIH0KPiA+IEBAIC0xNjAsNyArMTQ1LDYgQEAg
Z191ZGV2X2NsaWVudF9pbml0YWJsZV9pbml0KEdJbml0YWJsZSAqaW5pdGFibGUsIEdDYW5jZWxs
YWJsZSAqY2FuY2VsbGFibGUsCj4gPiAgICAgIEdVZGV2Q2xpZW50ICpzZWxmOwo+ID4gICAgICBH
VWRldkNsaWVudFByaXZhdGUgKnByaXY7Cj4gPiAgICAgIFdORENMQVNTIHdjbHM7Cj4gPiAtICAg
IGludCByYzsKPiA+Cj4gPiAgICAgIGdfcmV0dXJuX3ZhbF9pZl9mYWlsKEdfVURFVl9JU19DTElF
TlQoaW5pdGFibGUpLCBGQUxTRSk7Cj4gPiAgICAgIGdfcmV0dXJuX3ZhbF9pZl9mYWlsKGNhbmNl
bGxhYmxlID09IE5VTEwsIEZBTFNFKTsKPiA+IEBAIC0xNjgsMTQgKzE1MiwxMSBAQCBnX3VkZXZf
Y2xpZW50X2luaXRhYmxlX2luaXQoR0luaXRhYmxlICppbml0YWJsZSwgR0NhbmNlbGxhYmxlICpj
YW5jZWxsYWJsZSwKPiA+ICAgICAgc2VsZiA9IEdfVURFVl9DTElFTlQoaW5pdGFibGUpOwo+ID4g
ICAgICBwcml2ID0gc2VsZi0+cHJpdjsKPiA+Cj4gPiAtICAgIHJjID0gbGlidXNiX2luaXQoJnBy
aXYtPmN0eCk7Cj4gPiAtICAgIGlmIChyYyA8IDApIHsKPiA+IC0gICAgICAgIGNvbnN0IGNoYXIg
KmVycnN0ciA9IHNwaWNlX3VzYnV0aWxfbGlidXNiX3N0cmVycm9yKHJjKTsKPiA+IC0gICAgICAg
IGdfd2FybmluZygiRXJyb3IgaW5pdGlhbGl6aW5nIFVTQiBzdXBwb3J0OiAlcyBbJWldIiwgZXJy
c3RyLCByYyk7Cj4gPiAtICAgICAgICBnX3NldF9lcnJvcihlcnIsIEdfVURFVl9DTElFTlRfRVJS
T1IsIEdfVURFVl9DTElFTlRfTElCVVNCX0ZBSUxFRCwKPiA+IC0gICAgICAgICAgICAgICAgICAg
ICJFcnJvciBpbml0aWFsaXppbmcgVVNCIHN1cHBvcnQ6ICVzIFslaV0iLCBlcnJzdHIsIHJjKTsK
PiA+ICsgICAgcHJpdi0+Y3R4ID0gc3BpY2VfdXNiX2JhY2tlbmRfbmV3KGVycik7Cj4gPiArICAg
IGlmICghcHJpdi0+Y3R4KSB7Cj4gPiAgICAgICAgICByZXR1cm4gRkFMU0U7Cj4gPiAgICAgIH0K
PiA+ICsKPiA+ICAjaWZkZWYgR19PU19XSU4zMgo+ID4gICNpZiBMSUJVU0JfQVBJX1ZFUlNJT04g
Pj0gMHgwMTAwMDEwNgo+ID4gICAgICBsaWJ1c2Jfc2V0X29wdGlvbihwcml2LT5jdHgsIExJQlVT
Ql9PUFRJT05fVVNFX1VTQkRLKTsKPiA+IEBAIC0yNDgsOSArMjI5LDkgQEAgc3RhdGljIHZvaWQg
Z191ZGV2X2NsaWVudF9maW5hbGl6ZShHT2JqZWN0ICpnb2JqZWN0KQo+ID4gICAgICBVbnJlZ2lz
dGVyQ2xhc3MoR19VREVWX0NMSUVOVF9XSU5DTEFTU19OQU1FLCBOVUxMKTsKPiA+ICAgICAgZ191
ZGV2X2NsaWVudF9mcmVlX2RldmljZV9saXN0KCZwcml2LT51ZGV2X2xpc3QpOwo+ID4KPiA+IC0g
ICAgLyogZnJlZSBsaWJ1c2IgY29udGV4dCBpbml0aWFsaXppbmcgYnkgbGlidXNiX2luaXQoKSAq
Lwo+ID4gKyAgICAvKiBmcmVlIGJhY2tlbmQgY29udGV4dCAqLwo+ID4gICAgICBnX3dhcm5faWZf
ZmFpbChwcml2LT5jdHggIT0gTlVMTCk7Cj4gPiAtICAgIGxpYnVzYl9leGl0KHByaXYtPmN0eCk7
Cj4gPiArICAgIHNwaWNlX3VzYl9iYWNrZW5kX2RlbGV0ZShwcml2LT5jdHgpOwo+ID4KPiA+ICAg
ICAgLyogQ2hhaW4gdXAgdG8gdGhlIHBhcmVudCBjbGFzcyAqLwo+ID4gICAgICBpZiAoR19PQkpF
Q1RfQ0xBU1MoZ191ZGV2X2NsaWVudF9wYXJlbnRfY2xhc3MpLT5maW5hbGl6ZSkKPiA+IEBAIC0z
NDAsMjAgKzMyMSwxOCBAQCBzdGF0aWMgdm9pZCBnX3VkZXZfY2xpZW50X2NsYXNzX2luaXQoR1Vk
ZXZDbGllbnRDbGFzcyAqa2xhc3MpCj4gPiAgfQo+ID4KPiA+ICAvKiBjb21wYXJpbmcgYnVzOmFk
ZHIgYW5kIHZpZDpwaWQgKi8KPiA+IC1zdGF0aWMgZ2ludCBjb21wYXJlX2xpYnVzYl9kZXZpY2Vz
KGdjb25zdHBvaW50ZXIgYSwgZ2NvbnN0cG9pbnRlciBiKQo+ID4gK3N0YXRpYyBnaW50IGNvbXBh
cmVfdXNiX2RldmljZXMoZ2NvbnN0cG9pbnRlciBhLCBnY29uc3Rwb2ludGVyIGIpCj4gPiAgewo+
ID4gLSAgICBsaWJ1c2JfZGV2aWNlICphX2RldiA9IChsaWJ1c2JfZGV2aWNlICopYTsKPiA+IC0g
ICAgbGlidXNiX2RldmljZSAqYl9kZXYgPSAobGlidXNiX2RldmljZSAqKWI7Cj4gPiAtICAgIHN0
cnVjdCBsaWJ1c2JfZGV2aWNlX2Rlc2NyaXB0b3IgYV9kZXNjLCBiX2Rlc2M7Cj4gPiArICAgIGNv
bnN0IFVzYkRldmljZUluZm9ybWF0aW9uICphX2luZm8sICpiX2luZm87Cj4gPiAgICAgIGdib29s
ZWFuIHNhbWVfYnVzLCBzYW1lX2FkZHIsIHNhbWVfdmlkLCBzYW1lX3BpZDsKPiA+ICsgICAgYV9p
bmZvID0gc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX2dldF9pbmZvKChTcGljZVVzYkJhY2tlbmRE
ZXZpY2UgKilhKTsKPiA+ICsgICAgYl9pbmZvID0gc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX2dl
dF9pbmZvKChTcGljZVVzYkJhY2tlbmREZXZpY2UgKiliKTsKPiA+Cj4gPiAtICAgIGxpYnVzYl9n
ZXRfZGV2aWNlX2Rlc2NyaXB0b3IoYV9kZXYsICZhX2Rlc2MpOwo+ID4gLSAgICBsaWJ1c2JfZ2V0
X2RldmljZV9kZXNjcmlwdG9yKGJfZGV2LCAmYl9kZXNjKTsKPiA+Cj4gPiAtICAgIHNhbWVfYnVz
ID0gKGxpYnVzYl9nZXRfYnVzX251bWJlcihhX2RldikgPT0gbGlidXNiX2dldF9idXNfbnVtYmVy
KGJfZGV2KSk7Cj4gPiAtICAgIHNhbWVfYWRkciA9IChsaWJ1c2JfZ2V0X2RldmljZV9hZGRyZXNz
KGFfZGV2KSA9PSBsaWJ1c2JfZ2V0X2RldmljZV9hZGRyZXNzKGJfZGV2KSk7Cj4gPiAtICAgIHNh
bWVfdmlkID0gKGFfZGVzYy5pZFZlbmRvciA9PSBiX2Rlc2MuaWRWZW5kb3IpOwo+ID4gLSAgICBz
YW1lX3BpZCA9IChhX2Rlc2MuaWRQcm9kdWN0ID09IGJfZGVzYy5pZFByb2R1Y3QpOwo+ID4gKyAg
ICBzYW1lX2J1cyA9IChhX2luZm8tPmJ1cyA9PSBiX2luZm8tPmJ1cyk7Cj4gPiArICAgIHNhbWVf
YWRkciA9IChhX2luZm8tPmFkZHJlc3MgPT0gYl9pbmZvLT5hZGRyZXNzKTsKPiA+ICsgICAgc2Ft
ZV92aWQgPSAoYV9pbmZvLT52aWQgPT0gYl9pbmZvLT52aWQpOwo+ID4gKyAgICBzYW1lX3BpZCA9
IChhX2luZm8tPnBpZCA9PSBiX2luZm8tPnBpZCk7Cj4gPgo+ID4gICAgICByZXR1cm4gKHNhbWVf
YnVzICYmIHNhbWVfYWRkciAmJiBzYW1lX3ZpZCAmJiBzYW1lX3BpZCkgPyAwIDogLTE7Cj4gPiAg
fQo+ID4gQEAgLTM2MywxMiArMzQyLDEyIEBAIHN0YXRpYyB2b2lkIHVwZGF0ZV9kZXZpY2VfbGlz
dChHVWRldkNsaWVudCAqc2VsZiwgR0xpc3QgKm5ld19kZXZpY2VfbGlzdCkKPiA+ICAgICAgR0xp
c3QgKmRldjsKPiA+Cj4gPiAgICAgIGZvciAoZGV2ID0gZ19saXN0X2ZpcnN0KG5ld19kZXZpY2Vf
bGlzdCk7IGRldiAhPSBOVUxMOyBkZXYgPSBnX2xpc3RfbmV4dChkZXYpKSB7Cj4gPiAtICAgICAg
ICBHTGlzdCAqZm91bmQgPSBnX2xpc3RfZmluZF9jdXN0b20oc2VsZi0+cHJpdi0+dWRldl9saXN0
LCBkZXYtPmRhdGEsIGNvbXBhcmVfbGlidXNiX2RldmljZXMpOwo+ID4gKyAgICAgICAgR0xpc3Qg
KmZvdW5kID0gZ19saXN0X2ZpbmRfY3VzdG9tKHNlbGYtPnByaXYtPnVkZXZfbGlzdCwgZGV2LT5k
YXRhLCBjb21wYXJlX3VzYl9kZXZpY2VzKTsKPiA+ICAgICAgICAgIGlmIChmb3VuZCAhPSBOVUxM
KSB7Cj4gPiAgICAgICAgICAgICAgLyoga2VlcCBvbGQgZXhpc3RpbmcgbGlidXNiX2RldmljZSBp
biB0aGUgbmV3IGxpc3QsIHdoZW4KPiA+ICAgICAgICAgICAgICAgICB1c2ItZGV2LW1hbmFnZXIg
d2lsbCBtYWludGFpbiBpdHMgb3duIGxpc3Qgb2YgbGlidXNiX2RldmljZSwKPiA+ICAgICAgICAg
ICAgICAgICB0aGVzZSBsaXN0cyB3aWxsIGJlIGNvbXBsZXRlbHkgY29uc2lzdGVudCAqLwo+ID4g
LSAgICAgICAgICAgIGxpYnVzYl9kZXZpY2UgKnRlbXAgPSBmb3VuZC0+ZGF0YTsKPiA+ICsgICAg
ICAgICAgICBTcGljZVVzYkJhY2tlbmREZXZpY2UgKnRlbXAgPSBmb3VuZC0+ZGF0YTsKPiA+ICAg
ICAgICAgICAgICBmb3VuZC0+ZGF0YSA9IGRldi0+ZGF0YTsKPiA+ICAgICAgICAgICAgICBkZXYt
PmRhdGEgPSB0ZW1wOwo+ID4gICAgICAgICAgfQo+ID4gQEAgLTM4Niw3ICszNjUsNyBAQCBzdGF0
aWMgdm9pZCBub3RpZnlfZGV2X3N0YXRlX2NoYW5nZShHVWRldkNsaWVudCAqc2VsZiwKPiA+ICAg
ICAgR0xpc3QgKmRldjsKPiA+Cj4gPiAgICAgIGZvciAoZGV2ID0gZ19saXN0X2ZpcnN0KG9sZF9s
aXN0KTsgZGV2ICE9IE5VTEw7IGRldiA9IGdfbGlzdF9uZXh0KGRldikpIHsKPiA+IC0gICAgICAg
IEdMaXN0ICpmb3VuZCA9IGdfbGlzdF9maW5kX2N1c3RvbShuZXdfbGlzdCwgZGV2LT5kYXRhLCBj
b21wYXJlX2xpYnVzYl9kZXZpY2VzKTsKPiA+ICsgICAgICAgIEdMaXN0ICpmb3VuZCA9IGdfbGlz
dF9maW5kX2N1c3RvbShuZXdfbGlzdCwgZGV2LT5kYXRhLCBjb21wYXJlX3VzYl9kZXZpY2VzKTsK
PiA+ICAgICAgICAgIGlmIChmb3VuZCA9PSBOVUxMKSB7Cj4gPiAgICAgICAgICAgICAgZ191ZGV2
X2RldmljZV9wcmludChkZXYtPmRhdGEsIGFkZCA/ICJhZGQiIDogInJlbW92ZSIpOwo+ID4gICAg
ICAgICAgICAgIGdfc2lnbmFsX2VtaXQoc2VsZiwgc2lnbmFsc1tVRVZFTlRfU0lHTkFMXSwgMCwg
ZGV2LT5kYXRhLCBhZGQpOwo+ID4gQEAgLTQ0NywyOSArNDI2LDExIEBAIHN0YXRpYyB2b2lkIGdf
dWRldl9kZXZpY2VfcHJpbnRfbGlzdChHTGlzdCAqbCwgY29uc3QgZ2NoYXIgKm1zZykKPiA+ICB9
Cj4gPiAgI2VuZGlmCj4gPgo+ID4gLXN0YXRpYyB2b2lkIGdfdWRldl9kZXZpY2VfcHJpbnQobGli
dXNiX2RldmljZSAqZGV2LCBjb25zdCBnY2hhciAqbXNnKQo+ID4gK3N0YXRpYyB2b2lkIGdfdWRl
dl9kZXZpY2VfcHJpbnQoU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpkZXYsIGNvbnN0IGdjaGFyICpt
c2cpCj4gPiAgewo+ID4gLSAgICBzdHJ1Y3QgbGlidXNiX2RldmljZV9kZXNjcmlwdG9yIGRlc2M7
Cj4gPiAtCj4gPiAtICAgIGxpYnVzYl9nZXRfZGV2aWNlX2Rlc2NyaXB0b3IoZGV2LCAmZGVzYyk7
Cj4gPiArICAgIGNvbnN0IFVzYkRldmljZUluZm9ybWF0aW9uICppbmZvID0gc3BpY2VfdXNiX2Jh
Y2tlbmRfZGV2aWNlX2dldF9pbmZvKGRldik7Cj4gPgo+ID4gICAgICBTUElDRV9ERUJVRygiJXM6
ICVkLiVkIDB4JTA0eDoweCUwNHggY2xhc3MgJWQiLCBtc2csCj4gPiAtICAgICAgICAgICAgICAg
IGxpYnVzYl9nZXRfYnVzX251bWJlcihkZXYpLAo+ID4gLSAgICAgICAgICAgICAgICBsaWJ1c2Jf
Z2V0X2RldmljZV9hZGRyZXNzKGRldiksCj4gPiAtICAgICAgICAgICAgICAgIGRlc2MuaWRWZW5k
b3IsIGRlc2MuaWRQcm9kdWN0LCBkZXNjLmJEZXZpY2VDbGFzcyk7Cj4gPiAtfQo+ID4gLQo+ID4g
LXN0YXRpYyBnYm9vbGVhbiBnX3VkZXZfc2tpcF9zZWFyY2gobGlidXNiX2RldmljZSAqZGV2KQo+
ID4gLXsKPiA+IC0gICAgZ2Jvb2xlYW4gc2tpcDsKPiA+IC0gICAgdWludDhfdCBhZGRyID0gbGli
dXNiX2dldF9kZXZpY2VfYWRkcmVzcyhkZXYpOwo+ID4gLSAgICBzdHJ1Y3QgbGlidXNiX2Rldmlj
ZV9kZXNjcmlwdG9yIGRlc2M7Cj4gPiAtCj4gPiAtICAgIGxpYnVzYl9nZXRfZGV2aWNlX2Rlc2Ny
aXB0b3IoZGV2LCAmZGVzYyk7Cj4gPiAtCj4gPiAtICAgIHNraXAgPSAoKGFkZHIgPT0gMHhmZikg
fHwgIC8qIHJvb3QgaHViIChIQ0QpICovCj4gPiAtICAgICAgICAgICAgKGFkZHIgPT0gMSkgfHwg
Lyogcm9vdCBodWIgYWRkciAqLwo+ID4gLSAgICAgICAgICAgIChkZXNjLmJEZXZpY2VDbGFzcyA9
PSBMSUJVU0JfQ0xBU1NfSFVCKSB8fCAvKiBodWIqLwo+ID4gLSAgICAgICAgICAgIChhZGRyID09
IDApKTsgLyogYmFkIGFkZHJlc3MgKi8KPiA+IC0gICAgcmV0dXJuIHNraXA7Cj4gPiArICAgICAg
ICAgICAgICAgIGluZm8tPmJ1cywgaW5mby0+YWRkcmVzcywKPiA+ICsgICAgICAgICAgICAgICAg
aW5mby0+dmlkLCBpbmZvLT5waWQsIGluZm8tPmNsYXNzKTsKPiA+ICB9Cj4gPiBkaWZmIC0tZ2l0
IGEvc3JjL3dpbi11c2ItZGV2LmggYi9zcmMvd2luLXVzYi1kZXYuaAo+ID4gaW5kZXggYjFjMGUy
Ny4uZmRmZTczYSAxMDA2NDQKPiA+IC0tLSBhL3NyYy93aW4tdXNiLWRldi5oCj4gPiArKysgYi9z
cmMvd2luLXVzYi1kZXYuaAo+ID4gQEAgLTIzLDYgKzIzLDcgQEAKPiA+ICAjZGVmaW5lIF9fV0lO
X1VTQl9ERVZfSF9fCj4gPgo+ID4gICNpbmNsdWRlIDxnaW8vZ2lvLmg+Cj4gPiArI2luY2x1ZGUg
InVzYi1iYWNrZW5kLmgiCj4gPgo+ID4gIEdfQkVHSU5fREVDTFMKPiA+Cj4gPiBAQCAtNTEsMTIg
KzUyLDEyIEBAIHN0cnVjdCBfR1VkZXZDbGllbnRDbGFzcwo+ID4gICAgICBHT2JqZWN0Q2xhc3Mg
cGFyZW50X2NsYXNzOwo+ID4KPiA+ICAgICAgLyogc2lnbmFscyAqLwo+ID4gLSAgICB2b2lkICgq
dWV2ZW50KShHVWRldkNsaWVudCAqY2xpZW50LCBsaWJ1c2JfZGV2aWNlICpkZXZpY2UsIGdib29s
ZWFuIGFkZCk7Cj4gPiArICAgIHZvaWQgKCp1ZXZlbnQpKEdVZGV2Q2xpZW50ICpjbGllbnQsIFNw
aWNlVXNiQmFja2VuZERldmljZSAqZGV2aWNlLCBnYm9vbGVhbiBhZGQpOwo+ID4gIH07Cj4gPgo+
ID4gIEdUeXBlIGdfdWRldl9jbGllbnRfZ2V0X3R5cGUodm9pZCkgR19HTlVDX0NPTlNUOwo+ID4g
IEdVZGV2Q2xpZW50ICpnX3VkZXZfY2xpZW50X25ldyh2b2lkKTsKPiA+IC1saWJ1c2JfY29udGV4
dCAqZ191ZGV2X2NsaWVudF9nZXRfY29udGV4dChHVWRldkNsaWVudCAqY2xpZW50KTsKPiA+ICtT
cGljZVVzYkJhY2tlbmQgKmdfdWRldl9jbGllbnRfZ2V0X2NvbnRleHQoR1VkZXZDbGllbnQgKmNs
aWVudCk7Cj4gPiAgdm9pZCBnX3VkZXZfY2xpZW50X3JlcG9ydF9kZXZpY2VzKEdVZGV2Q2xpZW50
ICpjbGllbnQpOwo+ID4KPiA+ICBHUXVhcmsgZ191ZGV2X2NsaWVudF9lcnJvcl9xdWFyayh2b2lk
KTsKCkFsbCBvdGhlciBub3RlcyBoYXMgYmVlbiBhZGRyZXNzZWQgKEkgaG9wZSkuCkluY3JlbWVu
dGFsIGZpeGVzIHlvdSBjYW4gc2VlIGF0Cmh0dHBzOi8vZ2l0bGFiLmZyZWVkZXNrdG9wLm9yZy95
dXJpX2JlbmRpdG92aWNoL3NwaWNlLWd0ay9jb21taXRzL2JhY2tlbmQyLWluY3JlbWVudAoKPiA+
IC0tCj4gPiAyLjE3LjEKPiA+Cj4gPiBfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fXwo+ID4gU3BpY2UtZGV2ZWwgbWFpbGluZyBsaXN0Cj4gPiBTcGljZS1kZXZl
bEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKPiA+IGh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3Jn
L21haWxtYW4vbGlzdGluZm8vc3BpY2UtZGV2ZWwKX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX18KU3BpY2UtZGV2ZWwgbWFpbGluZyBsaXN0ClNwaWNlLWRldmVs
QGxpc3RzLmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWls
bWFuL2xpc3RpbmZvL3NwaWNlLWRldmVs
