Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 79DFC958D1
	for <lists+spice-devel@lfdr.de>; Tue, 20 Aug 2019 09:49:29 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 1ECD26E61C;
	Tue, 20 Aug 2019 07:39:03 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 6041F6E61C
 for <spice-devel@lists.freedesktop.org>; Tue, 20 Aug 2019 07:39:01 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx07.intmail.prod.int.phx2.redhat.com
 [10.5.11.22])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id 162F53082E0F
 for <spice-devel@lists.freedesktop.org>; Tue, 20 Aug 2019 07:39:00 +0000 (UTC)
Received: from colo-mx.corp.redhat.com
 (colo-mx01.intmail.prod.int.phx2.redhat.com [10.5.11.20])
 by smtp.corp.redhat.com (Postfix) with ESMTPS id 0B338100195C
 for <spice-devel@lists.freedesktop.org>; Tue, 20 Aug 2019 07:39:00 +0000 (UTC)
Received: from zmail25.collab.prod.int.phx2.redhat.com
 (zmail25.collab.prod.int.phx2.redhat.com [10.5.83.31])
 by colo-mx.corp.redhat.com (Postfix) with ESMTP id 034D718005A0
 for <spice-devel@lists.freedesktop.org>; Tue, 20 Aug 2019 07:39:00 +0000 (UTC)
Date: Tue, 20 Aug 2019 03:38:59 -0400 (EDT)
From: Frediano Ziglio <fziglio@redhat.com>
To: spice-devel@lists.freedesktop.org
Message-ID: <388150387.7680431.1566286739402.JavaMail.zimbra@redhat.com>
In-Reply-To: <20190806145250.31813-1-fziglio@redhat.com>
References: <20190806145250.31813-1-fziglio@redhat.com>
MIME-Version: 1.0
X-Originating-IP: [10.40.204.142, 10.4.195.14]
Thread-Topic: event-loop: Move adapter interface from reds.c
Thread-Index: 7CSJiCSHTxhJdEyfmMwZRW+XzhTmDQ==
X-Scanned-By: MIMEDefang 2.84 on 10.5.11.22
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16
 (mx1.redhat.com [10.5.110.46]); Tue, 20 Aug 2019 07:39:00 +0000 (UTC)
Subject: Re: [Spice-devel] [PATCH spice-server 1/2] event-loop: Move adapter
 interface from reds.c
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

cGluZyB0aGUgc2VyaWVzCgo+IAo+IFB1dCBtb3JlIGV2ZW50IGxvb3AgY29kZSBpbiBldmVudC1s
b29wLmMuCj4gVGhpcyBpcyBhIHByZXBhcmF0aW9uIHBhdGNoIGZvciB0aGUgbmV4dCBvbmUuCj4g
Cj4gU2lnbmVkLW9mZi1ieTogRnJlZGlhbm8gWmlnbGlvIDxmemlnbGlvQHJlZGhhdC5jb20+Cj4g
LS0tCj4gIHNlcnZlci9ldmVudC1sb29wLmMgfCA1OCArKysrKysrKysrKysrKysrKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysKPiAgc2VydmVyL3JlZC1jb21tb24uaCB8ICAxICsKPiAgc2Vy
dmVyL3JlZHMuYyAgICAgICB8IDU0IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tCj4gIDMgZmlsZXMgY2hhbmdlZCwgNTkgaW5zZXJ0aW9ucygrKSwgNTQgZGVsZXRpb25z
KC0pCj4gCj4gZGlmZiAtLWdpdCBhL3NlcnZlci9ldmVudC1sb29wLmMgYi9zZXJ2ZXIvZXZlbnQt
bG9vcC5jCj4gaW5kZXggODEyYzNhNTNiLi4xY2NmZDY3MWYgMTAwNjQ0Cj4gLS0tIGEvc2VydmVy
L2V2ZW50LWxvb3AuYwo+ICsrKyBiL3NlcnZlci9ldmVudC1sb29wLmMKPiBAQCAtMjY0LDMgKzI2
NCw2MSBAQCBjb25zdCBTcGljZUNvcmVJbnRlcmZhY2VJbnRlcm5hbCBldmVudF9sb29wX2NvcmUg
PSB7Cj4gICAgICAud2F0Y2hfdXBkYXRlX21hc2sgPSB3YXRjaF91cGRhdGVfbWFzaywKPiAgICAg
IC53YXRjaF9yZW1vdmUgPSB3YXRjaF9yZW1vdmUsCj4gIH07Cj4gKwo+ICsvKgo+ICsgKiBBZGFw
dGVyIGZvciBTcGljZUNvZGVJbnRlcmZhY2UKPiArICovCj4gKwo+ICtzdGF0aWMgU3BpY2VUaW1l
ciAqYWRhcHRlcl90aW1lcl9hZGQoY29uc3QgU3BpY2VDb3JlSW50ZXJmYWNlSW50ZXJuYWwKPiAq
aWZhY2UsIFNwaWNlVGltZXJGdW5jIGZ1bmMsIHZvaWQgKm9wYXF1ZSkKPiArewo+ICsgICAgcmV0
dXJuIGlmYWNlLT5wdWJsaWNfaW50ZXJmYWNlLT50aW1lcl9hZGQoZnVuYywgb3BhcXVlKTsKPiAr
fQo+ICsKPiArc3RhdGljIHZvaWQgYWRhcHRlcl90aW1lcl9zdGFydChjb25zdCBTcGljZUNvcmVJ
bnRlcmZhY2VJbnRlcm5hbCAqaWZhY2UsCj4gU3BpY2VUaW1lciAqdGltZXIsIHVpbnQzMl90IG1z
KQo+ICt7Cj4gKyAgICBpZmFjZS0+cHVibGljX2ludGVyZmFjZS0+dGltZXJfc3RhcnQodGltZXIs
IG1zKTsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgYWRhcHRlcl90aW1lcl9jYW5jZWwoY29uc3Qg
U3BpY2VDb3JlSW50ZXJmYWNlSW50ZXJuYWwgKmlmYWNlLAo+IFNwaWNlVGltZXIgKnRpbWVyKQo+
ICt7Cj4gKyAgICBpZmFjZS0+cHVibGljX2ludGVyZmFjZS0+dGltZXJfY2FuY2VsKHRpbWVyKTsK
PiArfQo+ICsKPiArc3RhdGljIHZvaWQgYWRhcHRlcl90aW1lcl9yZW1vdmUoY29uc3QgU3BpY2VD
b3JlSW50ZXJmYWNlSW50ZXJuYWwgKmlmYWNlLAo+IFNwaWNlVGltZXIgKnRpbWVyKQo+ICt7Cj4g
KyAgICBpZmFjZS0+cHVibGljX2ludGVyZmFjZS0+dGltZXJfcmVtb3ZlKHRpbWVyKTsKPiArfQo+
ICsKPiArc3RhdGljIFNwaWNlV2F0Y2ggKmFkYXB0ZXJfd2F0Y2hfYWRkKGNvbnN0IFNwaWNlQ29y
ZUludGVyZmFjZUludGVybmFsCj4gKmlmYWNlLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgaW50IGZkLCBpbnQgZXZlbnRfbWFzaywgU3BpY2VXYXRjaEZ1bmMKPiBmdW5j
LCB2b2lkICpvcGFxdWUpCj4gK3sKPiArICAgIC8vIG5vdGU6IFFlbXUgQVBJIGlzIGZpbmUgaGF2
aW5nIGEgU09DS0VUIG9uIFdpbmRvd3MKPiArICAgIHJldHVybiBpZmFjZS0+cHVibGljX2ludGVy
ZmFjZS0+d2F0Y2hfYWRkKGZkLCBldmVudF9tYXNrLCBmdW5jLCBvcGFxdWUpOwo+ICt9Cj4gKwo+
ICtzdGF0aWMgdm9pZCBhZGFwdGVyX3dhdGNoX3VwZGF0ZV9tYXNrKGNvbnN0IFNwaWNlQ29yZUlu
dGVyZmFjZUludGVybmFsCj4gKmlmYWNlLCBTcGljZVdhdGNoICp3YXRjaCwgaW50IGV2ZW50X21h
c2spCj4gK3sKPiArICAgIGlmYWNlLT5wdWJsaWNfaW50ZXJmYWNlLT53YXRjaF91cGRhdGVfbWFz
ayh3YXRjaCwgZXZlbnRfbWFzayk7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIGFkYXB0ZXJfd2F0
Y2hfcmVtb3ZlKGNvbnN0IFNwaWNlQ29yZUludGVyZmFjZUludGVybmFsICppZmFjZSwKPiBTcGlj
ZVdhdGNoICp3YXRjaCkKPiArewo+ICsgICAgaWZhY2UtPnB1YmxpY19pbnRlcmZhY2UtPndhdGNo
X3JlbW92ZSh3YXRjaCk7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIGFkYXB0ZXJfY2hhbm5lbF9l
dmVudChjb25zdCBTcGljZUNvcmVJbnRlcmZhY2VJbnRlcm5hbCAqaWZhY2UsCj4gaW50IGV2ZW50
LCBTcGljZUNoYW5uZWxFdmVudEluZm8gKmluZm8pCj4gK3sKPiArICAgIGlmIChpZmFjZS0+cHVi
bGljX2ludGVyZmFjZS0+YmFzZS5taW5vcl92ZXJzaW9uID49IDMgJiYKPiBpZmFjZS0+cHVibGlj
X2ludGVyZmFjZS0+Y2hhbm5lbF9ldmVudCAhPSBOVUxMKQo+ICsgICAgICAgIGlmYWNlLT5wdWJs
aWNfaW50ZXJmYWNlLT5jaGFubmVsX2V2ZW50KGV2ZW50LCBpbmZvKTsKPiArfQo+ICsKPiArY29u
c3QgU3BpY2VDb3JlSW50ZXJmYWNlSW50ZXJuYWwgY29yZV9pbnRlcmZhY2VfYWRhcHRlciA9IHsK
PiArICAgIC50aW1lcl9hZGQgPSBhZGFwdGVyX3RpbWVyX2FkZCwKPiArICAgIC50aW1lcl9zdGFy
dCA9IGFkYXB0ZXJfdGltZXJfc3RhcnQsCj4gKyAgICAudGltZXJfY2FuY2VsID0gYWRhcHRlcl90
aW1lcl9jYW5jZWwsCj4gKyAgICAudGltZXJfcmVtb3ZlID0gYWRhcHRlcl90aW1lcl9yZW1vdmUs
Cj4gKyAgICAud2F0Y2hfYWRkID0gYWRhcHRlcl93YXRjaF9hZGQsCj4gKyAgICAud2F0Y2hfdXBk
YXRlX21hc2sgPSBhZGFwdGVyX3dhdGNoX3VwZGF0ZV9tYXNrLAo+ICsgICAgLndhdGNoX3JlbW92
ZSA9IGFkYXB0ZXJfd2F0Y2hfcmVtb3ZlLAo+ICsgICAgLmNoYW5uZWxfZXZlbnQgPSBhZGFwdGVy
X2NoYW5uZWxfZXZlbnQsCj4gK307Cj4gZGlmZiAtLWdpdCBhL3NlcnZlci9yZWQtY29tbW9uLmgg
Yi9zZXJ2ZXIvcmVkLWNvbW1vbi5oCj4gaW5kZXggMjIzZjI4NjkwLi4yMmVhOGZjMzcgMTAwNjQ0
Cj4gLS0tIGEvc2VydmVyL3JlZC1jb21tb24uaAo+ICsrKyBiL3NlcnZlci9yZWQtY29tbW9uLmgK
PiBAQCAtNzEsNiArNzEsNyBAQCBzdHJ1Y3QgU3BpY2VDb3JlSW50ZXJmYWNlSW50ZXJuYWwgewo+
ICB9Owo+ICAKPiAgZXh0ZXJuIGNvbnN0IFNwaWNlQ29yZUludGVyZmFjZUludGVybmFsIGV2ZW50
X2xvb3BfY29yZTsKPiArZXh0ZXJuIGNvbnN0IFNwaWNlQ29yZUludGVyZmFjZUludGVybmFsIGNv
cmVfaW50ZXJmYWNlX2FkYXB0ZXI7Cj4gIAo+ICB0eXBlZGVmIHN0cnVjdCBSZWRzU3RhdGUgUmVk
c1N0YXRlOwo+ICAKPiBkaWZmIC0tZ2l0IGEvc2VydmVyL3JlZHMuYyBiL3NlcnZlci9yZWRzLmMK
PiBpbmRleCBhMzc5NWFiOTAuLmY0MzJmNTVhNCAxMDA2NDQKPiAtLS0gYS9zZXJ2ZXIvcmVkcy5j
Cj4gKysrIGIvc2VydmVyL3JlZHMuYwo+IEBAIC04Myw2MCArODMsNiBAQCBzdGF0aWMgdm9pZCBy
ZWRzX2NsaWVudF9tb25pdG9yc19jb25maWcoUmVkc1N0YXRlICpyZWRzLAo+IFZEQWdlbnRNb25p
dG9yc0NvbmZpZyAqCj4gIHN0YXRpYyBnYm9vbGVhbiByZWRzX3VzZV9jbGllbnRfbW9uaXRvcnNf
Y29uZmlnKFJlZHNTdGF0ZSAqcmVkcyk7Cj4gIHN0YXRpYyB2b2lkIHJlZHNfc2V0X3ZpZGVvX2Nv
ZGVjcyhSZWRzU3RhdGUgKnJlZHMsIEdBcnJheSAqdmlkZW9fY29kZWNzKTsKPiAgCj4gLXN0YXRp
YyBTcGljZVRpbWVyICphZGFwdGVyX3RpbWVyX2FkZChjb25zdCBTcGljZUNvcmVJbnRlcmZhY2VJ
bnRlcm5hbAo+ICppZmFjZSwgU3BpY2VUaW1lckZ1bmMgZnVuYywgdm9pZCAqb3BhcXVlKQo+IC17
Cj4gLSAgICByZXR1cm4gaWZhY2UtPnB1YmxpY19pbnRlcmZhY2UtPnRpbWVyX2FkZChmdW5jLCBv
cGFxdWUpOwo+IC19Cj4gLQo+IC1zdGF0aWMgdm9pZCBhZGFwdGVyX3RpbWVyX3N0YXJ0KGNvbnN0
IFNwaWNlQ29yZUludGVyZmFjZUludGVybmFsICppZmFjZSwKPiBTcGljZVRpbWVyICp0aW1lciwg
dWludDMyX3QgbXMpCj4gLXsKPiAtICAgIGlmYWNlLT5wdWJsaWNfaW50ZXJmYWNlLT50aW1lcl9z
dGFydCh0aW1lciwgbXMpOwo+IC19Cj4gLQo+IC1zdGF0aWMgdm9pZCBhZGFwdGVyX3RpbWVyX2Nh
bmNlbChjb25zdCBTcGljZUNvcmVJbnRlcmZhY2VJbnRlcm5hbCAqaWZhY2UsCj4gU3BpY2VUaW1l
ciAqdGltZXIpCj4gLXsKPiAtICAgIGlmYWNlLT5wdWJsaWNfaW50ZXJmYWNlLT50aW1lcl9jYW5j
ZWwodGltZXIpOwo+IC19Cj4gLQo+IC1zdGF0aWMgdm9pZCBhZGFwdGVyX3RpbWVyX3JlbW92ZShj
b25zdCBTcGljZUNvcmVJbnRlcmZhY2VJbnRlcm5hbCAqaWZhY2UsCj4gU3BpY2VUaW1lciAqdGlt
ZXIpCj4gLXsKPiAtICAgIGlmYWNlLT5wdWJsaWNfaW50ZXJmYWNlLT50aW1lcl9yZW1vdmUodGlt
ZXIpOwo+IC19Cj4gLQo+IC1zdGF0aWMgU3BpY2VXYXRjaCAqYWRhcHRlcl93YXRjaF9hZGQoY29u
c3QgU3BpY2VDb3JlSW50ZXJmYWNlSW50ZXJuYWwKPiAqaWZhY2UsCj4gLSAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBpbnQgZmQsIGludCBldmVudF9tYXNrLCBTcGljZVdhdGNo
RnVuYwo+IGZ1bmMsIHZvaWQgKm9wYXF1ZSkKPiAtewo+IC0gICAgLy8gbm90ZTogUWVtdSBBUEkg
aXMgZmluZSBoYXZpbmcgYSBTT0NLRVQgb24gV2luZG93cwo+IC0gICAgcmV0dXJuIGlmYWNlLT5w
dWJsaWNfaW50ZXJmYWNlLT53YXRjaF9hZGQoZmQsIGV2ZW50X21hc2ssIGZ1bmMsIG9wYXF1ZSk7
Cj4gLX0KPiAtCj4gLXN0YXRpYyB2b2lkIGFkYXB0ZXJfd2F0Y2hfdXBkYXRlX21hc2soY29uc3Qg
U3BpY2VDb3JlSW50ZXJmYWNlSW50ZXJuYWwKPiAqaWZhY2UsIFNwaWNlV2F0Y2ggKndhdGNoLCBp
bnQgZXZlbnRfbWFzaykKPiAtewo+IC0gICAgaWZhY2UtPnB1YmxpY19pbnRlcmZhY2UtPndhdGNo
X3VwZGF0ZV9tYXNrKHdhdGNoLCBldmVudF9tYXNrKTsKPiAtfQo+IC0KPiAtc3RhdGljIHZvaWQg
YWRhcHRlcl93YXRjaF9yZW1vdmUoY29uc3QgU3BpY2VDb3JlSW50ZXJmYWNlSW50ZXJuYWwgKmlm
YWNlLAo+IFNwaWNlV2F0Y2ggKndhdGNoKQo+IC17Cj4gLSAgICBpZmFjZS0+cHVibGljX2ludGVy
ZmFjZS0+d2F0Y2hfcmVtb3ZlKHdhdGNoKTsKPiAtfQo+IC0KPiAtc3RhdGljIHZvaWQgYWRhcHRl
cl9jaGFubmVsX2V2ZW50KGNvbnN0IFNwaWNlQ29yZUludGVyZmFjZUludGVybmFsICppZmFjZSwK
PiBpbnQgZXZlbnQsIFNwaWNlQ2hhbm5lbEV2ZW50SW5mbyAqaW5mbykKPiAtewo+IC0gICAgaWYg
KGlmYWNlLT5wdWJsaWNfaW50ZXJmYWNlLT5iYXNlLm1pbm9yX3ZlcnNpb24gPj0gMyAmJgo+IGlm
YWNlLT5wdWJsaWNfaW50ZXJmYWNlLT5jaGFubmVsX2V2ZW50ICE9IE5VTEwpCj4gLSAgICAgICAg
aWZhY2UtPnB1YmxpY19pbnRlcmZhY2UtPmNoYW5uZWxfZXZlbnQoZXZlbnQsIGluZm8pOwo+IC19
Cj4gLQo+IC1zdGF0aWMgY29uc3QgU3BpY2VDb3JlSW50ZXJmYWNlSW50ZXJuYWwgY29yZV9pbnRl
cmZhY2VfYWRhcHRlciA9IHsKPiAtICAgIC50aW1lcl9hZGQgPSBhZGFwdGVyX3RpbWVyX2FkZCwK
PiAtICAgIC50aW1lcl9zdGFydCA9IGFkYXB0ZXJfdGltZXJfc3RhcnQsCj4gLSAgICAudGltZXJf
Y2FuY2VsID0gYWRhcHRlcl90aW1lcl9jYW5jZWwsCj4gLSAgICAudGltZXJfcmVtb3ZlID0gYWRh
cHRlcl90aW1lcl9yZW1vdmUsCj4gLSAgICAud2F0Y2hfYWRkID0gYWRhcHRlcl93YXRjaF9hZGQs
Cj4gLSAgICAud2F0Y2hfdXBkYXRlX21hc2sgPSBhZGFwdGVyX3dhdGNoX3VwZGF0ZV9tYXNrLAo+
IC0gICAgLndhdGNoX3JlbW92ZSA9IGFkYXB0ZXJfd2F0Y2hfcmVtb3ZlLAo+IC0gICAgLmNoYW5u
ZWxfZXZlbnQgPSBhZGFwdGVyX2NoYW5uZWxfZXZlbnQsCj4gLX07Cj4gLQo+ICAvKiBEZWJ1Z2dp
bmcgb25seSB2YXJpYWJsZTogYWxsb3cgbXVsdGlwbGUgY2xpZW50IGNvbm5lY3Rpb25zIHRvIHRo
ZSBzcGljZQo+ICAgKiBzZXJ2ZXIgKi8KPiAgI2RlZmluZSBTUElDRV9ERUJVR19BTExPV19NQ19F
TlYgIlNQSUNFX0RFQlVHX0FMTE9XX01DIgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fXwpTcGljZS1kZXZlbCBtYWlsaW5nIGxpc3QKU3BpY2UtZGV2ZWxAbGlz
dHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4v
bGlzdGluZm8vc3BpY2UtZGV2ZWw=
