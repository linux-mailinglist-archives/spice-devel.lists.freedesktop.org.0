Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 53FAD98D9C
	for <lists+spice-devel@lfdr.de>; Thu, 22 Aug 2019 10:27:37 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 8C5F16EAA2;
	Thu, 22 Aug 2019 08:27:35 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mail-io1-xd44.google.com (mail-io1-xd44.google.com
 [IPv6:2607:f8b0:4864:20::d44])
 by gabe.freedesktop.org (Postfix) with ESMTPS id D9E136EAA8
 for <spice-devel@lists.freedesktop.org>; Thu, 22 Aug 2019 08:27:33 +0000 (UTC)
Received: by mail-io1-xd44.google.com with SMTP id j4so1865867iog.11
 for <spice-devel@lists.freedesktop.org>; Thu, 22 Aug 2019 01:27:33 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc;
 bh=qFgEHJycOxxBdnnYepfGXraHM60zn6pxq4QafGepLNI=;
 b=k0N6YLlLJtQZLj4ZZnMobghBS3XuVO7ffF0zaRBGWBGDA70wv+A4FymV8h5sDQ6npe
 /4lrC+zSEMAEzq2+cBWtmGyIxl8zLcZt48D3Rj7NAEFhyxmOvt0T67PSKjf84ewFI7e6
 eN3pQWOC0G7VVcuGeocZssUbjmDSfLpe0qaTiF59gfKF3eIRC425nROQwHxXBaYi/uVB
 PGY1qyD8Wn05CbCt4jbbPt7xV4wBoIOmZ+mG7eESI4x+veqbc07KKKPgpjtJZIbZvqPe
 EQGt6GhHPdx6ax4FfnHBsO6y1zZpio2ANY0tdBo0infVFwViA+le6Ks0r8oUk/KhBqqm
 d1iA==
X-Gm-Message-State: APjAAAWnankaoSqGI+AvVmKmfBdpCGYNxaP4aXVC6cpkrTiUsOHXOqhK
 lICUuHAzTUJ2AiDIphcnOxAcdO9uSznqF4obBVoClBdnTO3d5A==
X-Google-Smtp-Source: APXvYqzpxMR5amdbO981QVwY/+g1perpHs3MQmwm8nV0xYEonV5FIFDbb84OcIwZH3712qkU5/5JOmRAZK6d3Jo2QZY=
X-Received: by 2002:a5d:9655:: with SMTP id d21mr39048387ios.99.1566462452895; 
 Thu, 22 Aug 2019 01:27:32 -0700 (PDT)
MIME-Version: 1.0
References: <20190812095729.32692-1-yuri.benditovich@daynix.com>
 <20190812095729.32692-6-yuri.benditovich@daynix.com>
 <1409051095.5635285.1565697543164.JavaMail.zimbra@redhat.com>
 <CAOEp5OdBZ-spO4jKoP6vLFnX6QjK8iM+caF9LyF4-mWubzNWYQ@mail.gmail.com>
 <476222235.8198018.1566456967244.JavaMail.zimbra@redhat.com>
In-Reply-To: <476222235.8198018.1566456967244.JavaMail.zimbra@redhat.com>
From: Yuri Benditovich <yuri.benditovich@daynix.com>
Date: Thu, 22 Aug 2019 11:27:19 +0300
Message-ID: <CAOEp5OeoY_8bD1pFzeve8tkF4kbdTMToyJX62T8vi_7enoOnvw@mail.gmail.com>
To: Frediano Ziglio <fziglio@redhat.com>
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=daynix-com.20150623.gappssmtp.com; s=20150623;
 h=mime-version:references:in-reply-to:from:date:message-id:subject:to
 :cc;
 bh=qFgEHJycOxxBdnnYepfGXraHM60zn6pxq4QafGepLNI=;
 b=0j+QTRRJjkwsSRWzh9cew8Ivopf+QEl8aP3XOE+7zwgqCv1pgY/4kYtOdrCtyx/auM
 A5SThLyq1757gGqH3nACeo92+vkmPoWc4DUXncX4OyfB/ikZh88NbbW4an+Dlaol8b3o
 /Ncpd6DxBXqoC5yGODMXI5czjwd4aAL07JYxb7vYsjhG54UYld2UzUdYZvgc3CV8gG7/
 yXOR8w70Dw6MWK9UxmSQzTcSRayMmUxvNuY8X/ArbPx2q1wHsx1R9NILeNH9zak3Er8r
 mioPh2YaaI5QPbCV5LcizK0TCnHp7pq/InrzLx4qAKe91SqNdNQ421vgQxEV8m0n/0MO
 ukeA==
Subject: Re: [Spice-devel] [spice-gtk v3 5/9] usb-redir: extend USB backend
 to support emulated devices
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Yan Vugenfirer <yan@daynix.com>,
 Spice List <spice-devel@lists.freedesktop.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

T24gVGh1LCBBdWcgMjIsIDIwMTkgYXQgOTo1NiBBTSBGcmVkaWFubyBaaWdsaW8gPGZ6aWdsaW9A
cmVkaGF0LmNvbT4gd3JvdGU6Cj4KPiA+Cj4gPiBPbiBUdWUsIEF1ZyAxMywgMjAxOSBhdCAyOjU5
IFBNIEZyZWRpYW5vIFppZ2xpbyA8ZnppZ2xpb0ByZWRoYXQuY29tPiB3cm90ZToKPiA+ID4KPiA+
ID4gPgo+ID4gPiA+IFJlZGlyZWN0aW9uIG9mIGVtdWxhdGVkIGRldmljZXMgcmVxdWlyZXMgc3Bl
Y2lhbCBhcHByb2FjaCwKPiA+ID4gPiBhcyB1c2JyZWRpcmhvc3QgY2FuJ3QgYmUgdXNlZCBmb3Ig
dGhhdCAoaXQgd29ya3Mgb25seSB3aXRoCj4gPiA+ID4gbGlidXNiIGRldmljZXMpLiBGb3IgZW11
bGF0ZWQgZGV2aWNlcyB3ZSBjcmVhdGUgaW5zdGFuY2Ugb2YKPiA+ID4gPiB1c2JyZWRpcnBhcnNl
ciB0aGF0IGltcGxlbWVudHMgVVNCIHJlZGlyZWN0aW9uIHByb3RvY29sLgo+ID4gPgo+ID4gPiBN
YWtlIHNlbnNlLiBBY3R1YWxseSB1c2JyZWRpcmhvc3QgaW50ZXJuYWxseSB1c2VzIGEgcGFyc2Vy
IHRvCj4gPiA+IHBhcnNlIHByb3RvY29sIG1lc3NhZ2VzIGFuZCByZWRpcmVjdCB0byB0aGUgcGh5
c2ljYWwgZGV2aWNlLgo+ID4gPiBCdXQgdGhlIHBhcnNlIGlzIGludGVybmFsIGFuZCBpcyB1c2Vk
IGJ5IHVzYnJlZGlyaG9zdCBzbwo+ID4gPiB3b3VsZCBiZSBoYXJkIHRvIHJldXNlLgo+ID4gPgo+
ID4gPiA+IEluIG9yZGVyIHRvIHdvcmsgd2l0aCB0aGUgc2FtZSBzZXQgb2YgcHJvdG9jb2wgY2Fw
YWJpbGl0aWVzCj4gPiA+ID4gdGhhdCB1c2JyZWRpcmhvc3Qgc2V0cyB1cCB3aXRoIHJlbW90ZSBz
aWRlLCB0aGUgcGFyc2VyIHNoYWxsOgo+ID4gPiA+IC0gbm90IHNlbmQgaXRzIG93biAnaGVsbG8n
IHRvIHRoZSBzZXJ2ZXIKPiA+ID4gPiAtIGluaXRpYWxpemUgdGhlIHNhbWUgY2FwYWJpbGl0aWVz
IHRoYXQgdXNicmVkaXJob3N0Cj4gPiA+ID4gLSByZWNlaXZlIHRoZSBzYW1lICdoZWxsbycgcmVz
cG9uc2UKPiA+ID4gPiBGb3IgdGhhdCB3ZSBhbmFseXplICdoZWxsbycgc2VudCBieSBVU0IgcmVk
aXIgcGFyc2VyIGFuZAo+ID4gPiA+IGV4dHJhY3Qgc2V0IG9mIGNhcGFiaWxpdGllcyBmcm9tIGl0
IGFuZCB1cG9uIHJlY2VpdmUgb2YKPiA+ID4gPiAnaGVsbG8nIHJlc3BvbnNlIHdlIHByb3ZpZGUg
aXQgYWxzbyB0byB0aGUgcGFyc2VyLgo+ID4gPgo+ID4gPiBUaGlzIG1ha2Ugc2Vuc2UgYnV0IHNv
bWUgcGFydCBvZiB0aGUgY29kZSBkb2VzIG5vdCBleGFjdGx5IHRoYXQuCj4gPiA+IEluIHNvbWUg
cGF0aCB0aGUgY29kZSBzZW5kIHRoZSAnaGVsbG8nIGlzIHNlbnQgYnkgdGhlIHBhcnNlci4KPiA+
ID4gSXQgd291bGQgYmUgbW9yZSBjbGVhciB0byBpbXBsZW1lbnQganVzdCB3aGF0IHlvdSBkZXNj
cmliZWQKPiA+ID4gYWJvdmUsIHdoeSB0aGUgaW1wbGVtZW50YXRpb24gaXMgYSBiaXQgZGlmZmVy
ZW50Lgo+ID4KPiA+IER1ZSB0byBjb3JuZXIgY2FzZSBkZXNjcmliZWQgYmVsb3cuCj4gPgo+ID4g
Pgo+ID4gPiA+IFdoZW4gbGlidXNiIGRldmljZSBpcyByZWRpcmVjdGVkIHZpYSBhIGNoYW5uZWws
IGluc3RhbmNlIG9mCj4gPiA+ID4gdXNicmVkaXJob3N0IHNlcnZlcyBpdC4KPiA+ID4gPiBXaGVu
IGVtdWxhdGVkIGRldmljZSBpcyByZWRpcmVjdGVkIHZpYSBhIGNoYW5uZWwsIGluc3RhbmNlCj4g
PiA+ID4gb2YgdXNicmVkaXJwYXJzZXIgZG9lcyB0aGUgam9iLgo+ID4gPiA+Cj4gPiA+ID4gU2ln
bmVkLW9mZi1ieTogWXVyaSBCZW5kaXRvdmljaCA8eXVyaS5iZW5kaXRvdmljaEBkYXluaXguY29t
Pgo+ID4gPiA+IC0tLQo+ID4gPiA+ICBzcmMvdXNiLWJhY2tlbmQuYyB8IDYxNiArKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrLS0tCj4gPiA+ID4gIDEgZmlsZSBjaGFu
Z2VkLCA1ODAgaW5zZXJ0aW9ucygrKSwgMzYgZGVsZXRpb25zKC0pCj4gPiA+ID4KPiA+ID4gPiBk
aWZmIC0tZ2l0IGEvc3JjL3VzYi1iYWNrZW5kLmMgYi9zcmMvdXNiLWJhY2tlbmQuYwo+ID4gPiA+
IGluZGV4IGFhMTFjNzkuLjlhZWU2YzcgMTAwNjQ0Cj4gPiA+ID4gLS0tIGEvc3JjL3VzYi1iYWNr
ZW5kLmMKPiA+ID4gPiArKysgYi9zcmMvdXNiLWJhY2tlbmQuYwo+ID4gPiA+IEBAIC01NSw2ICs1
NSw3IEBAIHN0cnVjdCBfU3BpY2VVc2JCYWNrZW5kRGV2aWNlCj4gPiA+ID4gICAgICBnaW50IHJl
Zl9jb3VudDsKPiA+ID4gPiAgICAgIFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmF0dGFjaGVkX3Rv
Owo+ID4gPiA+ICAgICAgVXNiRGV2aWNlSW5mb3JtYXRpb24gZGV2aWNlX2luZm87Cj4gPiA+ID4g
KyAgICBnYm9vbGVhbiBlZGV2X2NvbmZpZ3VyZWQ7Cj4gPiA+Cj4gPiA+IFRoaXMgdmFyaWFibGUg
aXMgbmV2ZXIgcmVzZXQsIEkgd291bGQgZXhwZWN0IHRoYXQgYXQgbGVhc3QKPiA+ID4gd2hlbiBk
ZXZpY2UgaXMgZGV0YWNoZWQgKHRoaXMgc2hvdWxkIGJlIGVxdWl2YWxlbnQgdG8gcGh5c2ljYWwK
PiA+ID4gcmVtb3ZhbCkuCj4gPgo+ID4gUHJvYmFibHksIG5lZWQgdG8gcmVzZXQgaXQgb24gYXR0
YWNoLgo+ID4gSW4gZmFjdCwgbm9ib2R5IHVzZXMgaXQsIHRoZSBkcml2ZXIgdXN1YWxseSBqdXN0
IHNldHMgdGhlIGNvbmZpZ3VyYXRpb24uCj4gPgo+ID4gPiBXaHkgbm90IG1vdmluZyB0byBTcGlj
ZVVzYkJhY2tlbmRDaGFubmVsPwo+ID4gPgo+ID4KPiA+IEJlY2F1c2UgaXQgaXMgaGFyZGx5IHJl
bGF0ZWQgdG8gdGhlIGNoYW5uZWwuCj4gPgo+ID4gPiA+ICB9Owo+ID4gPiA+Cj4gPiA+ID4gIHN0
cnVjdCBfU3BpY2VVc2JCYWNrZW5kCj4gPiA+ID4gQEAgLTgwLDEwICs4MSwyMCBAQCBzdHJ1Y3Qg
X1NwaWNlVXNiQmFja2VuZAo+ID4gPiA+ICBzdHJ1Y3QgX1NwaWNlVXNiQmFja2VuZENoYW5uZWwK
PiA+ID4gPiAgewo+ID4gPiA+ICAgICAgc3RydWN0IHVzYnJlZGlyaG9zdCAqdXNicmVkaXJob3N0
Owo+ID4gPiA+ICsgICAgc3RydWN0IHVzYnJlZGlyaG9zdCAqaGlkZGVuX2hvc3Q7Cj4gPiA+ID4g
KyAgICBzdHJ1Y3QgdXNicmVkaXJwYXJzZXIgKnBhcnNlcjsKPiA+ID4gPiArICAgIHN0cnVjdCB1
c2JyZWRpcnBhcnNlciAqaGlkZGVuX3BhcnNlcjsKPiA+ID4KPiA+ID4gSSBkb24ndCB1bmRlcnN0
YW5kIGFsbCB0aGVzZSB2YXJpYWJsZS4KPiA+ID4gV29uJ3QgYmUgZWFzaWVyIHRvIGhhdmUgcGFy
c2VyIGluaXRpYWxpemVkIGZvciBlbXVsYXRlZAo+ID4gPiBkZXZpY2VzIGFuZCBiZWluZyBOVUxM
IChzbyBmcmVlZCkgd2hlbiBlbXVsYXRlZCBkZXZpY2UKPiA+ID4gaXMgZGV0YWNoZWQ/Cj4gPgo+
ID4gV2hlbiB0aGUgY2hhbm5lbCBpcyBjcmVhdGVkIGl0IGRvZXMgbm90IGtub3cgd2hhdCBpdCB3
aWxsIHJlZGlyZWN0Lgo+ID4gVGhlIHNhbWUgY2hhbm5lbCBpcyB1c2VkIGZvciByZWd1bGFyIGRl
dmljZXMgYW5kIGVtdWxhdGVkIG9uZS4gQm90aAo+ID4gcGFyc2VyIGFuZCB1c2JyZWRpcmhvc3Qg
c2hhbGwgYmUgaW50ZXJuYWxseSBzeW5jaHJvbml6ZWQgd2l0aCB0aGUKPiA+IHJlbW90ZSBzaWRl
Lgo+Cj4gQnV0IHRoaXMgaXMgcGFydGlhbGx5IHRydWUuIE9ubHkgdGhlIGNhcGFiaWxpdGllcyBh
cmUgc3luY2hyb25pemVkLAo+IHRoZSBkYXRhIGFyZSBwYXNzZWQgZWl0aGVyIHRvIHVzYnJlZGly
aG9zdCBvciB1c2JyZWRpcnBhcnNlciwgbm90IGJvdGguCgpGaW5hbCBpbml0aWFsaXphdGlvbiBv
ZiBhY3R1YWwgY2FwYWJpbGl0aWVzIGhhcHBlbnMgd2hlbgpwYXJzZXIvdXNicmVkaXJob3N0IHJl
Y2VpdmVzIGhlbGxvIHJlc3BvbnNlIGZyb20gdGhlIHJlbW90ZSBzaWRlLgpCb3RoIHJlY2VpdmUg
dGhlIHJlc3BvbnNlIGF0IHByb3BlciB0aW1lLgoKPgo+ID4gSWYgSSdkIGNyZWF0ZSB0aGUgcGFy
c2VyIGVhY2ggdGltZSB0aGUgZW11bGF0ZWQgZGV2aWNlIGlzIGF0dGFjaGVkIEknZAo+ID4gbmVl
ZCBlYWNoIHRpbWUgdG8gaW5pdGlhbGl6ZSBpdCB3aXRoIHJlY2VpdmVkIGhlbGxvIGZyb20gdGhl
IHNlY29uZAo+ID4gc2lkZS4gV2UnZCBuZWVkIHRvIHdyaXRlIGFkZGl0aW9uYWwgY29kZSB0byBw
cm9jZXNzIChldmVuIGltYWdpbmFibGUpCj4gPiBlcnJvciBjYXNlcyAod2hhdCBpZiB3ZSBjYW4n
dCBjcmVhdGUgdGhlIHBhcnNlciBldGMpLgo+Cj4gSWYgd2UgY2FuJ3QgY3JlYXRlIHRoZSBwYXJz
ZXIgd2UgZG8gd2hhdCB3ZSBkbyBpbiBhbGwgb3RoZXIgY2FzZXMsCj4gd2UganVzdCBjYWxsIGFi
b3J0KCksIG5vdCB0aGF0IGhhcmQuCj4KPiA+IEZpbmFsbHkgdGhpcyBhcHBlYXJzIHRvIGJlIG1v
cmUgY29tcGxpY2F0ZWQgdGhhbiBoYXZlIGV2ZXJ5dGhpZ24gcmVhZHkKPiA+IGZyb20gdGhlIGJl
Z2lubmluZy4KPiA+Cj4KPiBCdXQgdGhpcyBkb2VzIG5vdCBuZWVkIHRvIGJlIGltcGxlbWVudGVk
IHdpdGggNCBwb2ludGVycyBhbmQgc29tZSAiaGlkZGVuXyIKPiBwcmVmaXguIENvdWxkIGJlIGEg
c2ltcGxlIGVudW0gc3RhdGluZyB3aGljaCBvbmUgdG8gdXNlLgoKVGhlcmUgYXJlIG1heSB3YXlz
IHRvIGltcGxlbWVudCBpdCwgSSd2ZSBzZWxlY3RlZCBzaW1wbGUgb25lLgpJIHN0aWxsIHRoaW5r
IGl0IGlzIGJldHRlciB0byBoYXZlIGV2ZXJ5dGhpbmcgcmVhZHkgZnJvbSB0aGUKYmVnaW5uaW5n
LCB0aGlzIG1ha2VzIHRoZSBjb2RlIG1vcmUgY29uc2lzdGVudC4KSW4gdGhlIHBhc3QgSSd2ZSB0
cmllZCBkaWZmZXJlbnQgYXBwcm9hY2hlcyB0byBhZGRyZXNzIGFsbCBwb3NzaWJsZQpmbG93cyBh
bmQgdGhpcyBvbmUgbG9va3Mgb3B0aW1hbCBmb3IgbWUuCgo+Cj4gPiBUaGVyZSBpcyBhbHNvIGNv
cm5lciBjYXNlIHdoZW4gdGhlIGRldmljZSBpcyBhdHRhY2hlZCBiZWZvcmUgdGhlCj4gPiBjaGFu
bmVsIGlzIHJlYWR5IChyZWRpcmVjdC1vbi1jb25uZWN0IHNldHRpbmcpLiBXZSBkZWNpZGUgb24K
PiA+IHVzYnJlZGlob3N0JyBvciAncGFyc2VyJyBkZXBlbmRpbmcgb24ga2luZCBvZiBhdHRhY2hl
ZCBkZXZpY2UgdG8KPiA+IHJlZGlyZWN0Lgo+Cj4gSWYgdGhlIHBhcnNlciBpcyBpbml0aWFsaXpl
ZCBiZWZvcmUgdGhlbiB0aGUgdXNicmVkaXIgaG9zdCBhbmQgcGFyc2UKPiBhcmUgbm90IGluIHN5
bmMgc28gdGhpcyBtZWFucyB0aGF0IHRoZSBjaGFubmVsIHdpbGwgYmUgb25seSBzdXBwb3J0aW5n
Cj4gZW11bGF0ZWQgZGV2aWNlcyBhbmQgbm90IHJlYWwgb25lcy4gVGhpcyBzZWVtcyB0byBtZSBh
IGJ1ZyB0byBiZSBmaXhlZC4KClRoZXJlIGlzIG5vIGJ1ZywgYW5kIHRoZSBjaGFubmVsIGlzIGFi
bGUgdG8gc3VwcG9ydCBib3RoIHR5cGVzIG9mCmRldmljZXMgYXQgcHJvcGVyIHRpbWUuCgo+Cj4g
PiBJZiB0aGUgY2hhbm5lbCBpcyBzdGlsbCBub3QgcmVhZHksIHRoZSBwYXJzZXIvdXNicmVkaXJo
b3N0IGNhbid0IHNlbmQKPiA+IGFueXRoaW5nIHRpbGwgdGhlIGNoYW5uZWwgaXMgdXAuIEluIHRo
aXMgY2FzZSBzd2l0Y2hpbmcgYmFjayBhbmQgZm9ydGgKPiA+IGJldHdlZW4gdXNicmVkaXJob3N0
IGJlY29tZXMgbW9yZSBjb21wbGljYXRlZCB0aGFuIGN1cnJlbnQgc29sdXRpb24uCj4gPgo+Cj4g
SSBkb24ndCB1bmRlcnN0YW5kIHRoaXMgc2VudGVuY2UuIFRoZSBzd2l0Y2ggaXMgbmVlZGVkIGlu
IGFueSBjYXNlIGJlY2F1c2UKPiB5b3UgY2FuIGF0dGFjaCBhbiBlbXVsYXRlZCBkZXZpY2UsIGRl
dGFjaCBhbmQgdGhlbiBhdHRhY2ggYSByZWFsIG9uZS4KPiBJZiB0aGlzIGlzIG5vdCBpbXBsZW1l
bnRlZCB3ZSBoYXZlIGEgYnVnLgoKT2YgY291cnNlIHRoaXMgaXMgaW1wbGVtZW50ZWQuClRoZSBx
dWVzdGlvbiBpcyB3aGVuIGV4YWN0bHkgd2UgZG8gdGhlIHN3aXRjaC4gQ3VycmVudGx5IHRoZSBz
d2l0Y2ggaXMKZG9uZSBhdCB0aW1lIG9mIGF0dGFjaCwgdGhpcyBpcyBzaW1wbGVyLgoKPgo+ID4g
Pgo+ID4gPiA+ICAgICAgdWludDhfdCAqcmVhZF9idWY7Cj4gPiA+ID4gICAgICBpbnQgcmVhZF9i
dWZfc2l6ZTsKPiA+ID4gPiAgICAgIHN0cnVjdCB1c2JyZWRpcmZpbHRlcl9ydWxlICpydWxlczsK
PiA+ID4gPiAgICAgIGludCBydWxlc19jb3VudDsKPiA+ID4gPiArICAgIHVpbnQzMl90IGhvc3Rf
Y2FwczsKPiA+ID4gPiArICAgIHVpbnQzMl90IHBhcnNlcl9pbml0X2RvbmUgIDogMTsKPiA+ID4g
PiArICAgIHVpbnQzMl90IHBhcnNlcl93aXRoX2hlbGxvIDogMTsKPiA+ID4gPiArICAgIHVpbnQz
Ml90IGhlbGxvX2RvbmVfcGFyc2VyIDogMTsKPiA+ID4gPiArICAgIHVpbnQzMl90IGhlbGxvX3Nl
bnQgICAgICAgIDogMTsKPiA+ID4gPiArICAgIHVpbnQzMl90IHJlamVjdGVkICAgICAgICAgIDog
MTsKPiA+ID4gPiArICAgIHVpbnQzMl90IHdhaXRfZGlzY19hY2sgICAgIDogMTsKPiA+ID4KPiA+
ID4gVGhlICJkaXNjIiBuYW1pbmcgaXMgY29uZnVzaW5nLCBhbHNvIHRha2luZyBpbnRvIGFjY291
bnQgdGhlCj4gPiA+ICJDb21wYWN0IERpc2MiIGFkZGl0aW9uLiBSZWFkaW5nIHRoZSBjb2RlIHRo
aXMgImRpc2MiIGlzIGEgc2hvcnRlbgo+ID4gPiBmb3IgImRpc2Nvbm5lY3QiLCBtYXliZSB3b3Vs
ZCBiZSBiZXR0ZXIgdG8ganVzdCB1c2UgIndhaXRfZGlzY29ubmVjdF9hY2siPwo+ID4gPgo+ID4K
PiA+IG9rCj4gPgo+ID4gPiA+ICAgICAgU3BpY2VVc2JCYWNrZW5kRGV2aWNlICphdHRhY2hlZDsK
PiA+ID4gPiAgICAgIFNwaWNlVXNicmVkaXJDaGFubmVsICAqdXNlcl9kYXRhOwo+ID4gPgo+ID4g
PiBPVDogdGhpcyBkZWZpbml0aXZlbHkgc2hvdWxkIGJlIHJlbmFtZWQhCj4gPgo+ID4gUHJvYmFi
bHkgaW4gc2VwYXJhdGUgY29tbWl0Lgo+ID4KPgo+IFllcywgdGhhdCdzIHdoYXQgdGhlIE9UIG1l
YW5zLgo+Cj4gPiA+Cj4gPiA+ID4gICAgICBTcGljZVVzYkJhY2tlbmQgKmJhY2tlbmQ7Cj4gPiA+
ID4gQEAgLTM1NSw3ICszNjYsMTEgQEAgZ2Jvb2xlYW4KPiA+ID4gPiBzcGljZV91c2JfYmFja2Vu
ZF9kZXZpY2VfaXNvY2goU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpkZXYpCj4gPiA+ID4gICAgICBn
aW50IGksIGosIGs7Cj4gPiA+ID4gICAgICBpbnQgcmM7Cj4gPiA+ID4KPiA+ID4gPiAtICAgIGdf
cmV0dXJuX3ZhbF9pZl9mYWlsKGxpYmRldiAhPSBOVUxMLCAwKTsKPiA+ID4gPiArICAgIGdfcmV0
dXJuX3ZhbF9pZl9mYWlsKGxpYmRldiAhPSBOVUxMIHx8IGRldi0+ZWRldiAhPSBOVUxMLCAwKTsK
PiA+ID4gPiArICAgIGlmIChkZXYtPmVkZXYpIHsKPiA+ID4gPiArICAgICAgICAvKiBjdXJyZW50
bHkgd2UgZG8gbm90IGVtdWxhdGUgaXNvY2ggZGV2aWNlcyAqLwo+ID4gPiA+ICsgICAgICAgIHJl
dHVybiBGQUxTRTsKPiA+ID4gPiArICAgIH0KPiA+ID4gPgo+ID4gPiA+ICAgICAgcmMgPSBsaWJ1
c2JfZ2V0X2FjdGl2ZV9jb25maWdfZGVzY3JpcHRvcihsaWJkZXYsICZjb25mX2Rlc2MpOwo+ID4g
PiA+ICAgICAgaWYgKHJjKSB7Cj4gPiA+ID4gQEAgLTM5MCwxMyArNDA1LDE2IEBAIGZyb20gYm90
aCB0aGUgbWFpbiB0aHJlYWQgYXMgd2VsbCBhcyBmcm9tIHRoZSB1c2IKPiA+ID4gPiBldmVudAo+
ID4gPiA+IGhhbmRsaW5nIHRocmVhZCAqLwo+ID4gPiA+ICBzdGF0aWMgdm9pZCB1c2JyZWRpcl93
cml0ZV9mbHVzaF9jYWxsYmFjayh2b2lkICp1c2VyX2RhdGEpCj4gPiA+ID4gIHsKPiA+ID4gPiAg
ICAgIFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmNoID0gdXNlcl9kYXRhOwo+ID4gPiA+IC0gICAg
aWYgKCFjaC0+dXNicmVkaXJob3N0KSB7Cj4gPiA+ID4gLSAgICAgICAgLyoganVzdCB0byBiZSBv
biB0aGUgc2FmZSBzaWRlICovCj4gPiA+ID4gLSAgICAgICAgcmV0dXJuOwo+ID4gPiA+IC0gICAg
fQo+ID4gPgo+ID4gPiBUaGVzZSBjaGVjayBzaG91bGQgYmUgaW4gYSBwcmVwYXJhdG9yeSBwYXRj
aC4gTm90aGluZyB3cm9uZyB3aXRoIHRoaXMKPiA+ID4gcGF0Y2gsCj4gPiA+IGJ1dCB0aGUgY29k
ZSAobWFzdGVyKSBpcyBjb25mdXNpbmcuIHVzYnJlZGlyaG9zdCBpcyBpbml0aWFsaXplZCBhcyBz
b29uIGFzCj4gPiA+IHBvc3NpYmxlLCBjYW4gYmUgTlVMTCBvbmx5IGJlZm9yZSB1c2JyZWRpcmhv
c3Rfb3Blbl9mdWxsIHJldHVybnMuCj4gPiA+IEFjdHVhbGx5IGNhbiBiZSBOVUxMIGluIHRoaXMg
Y2FsbCBmb3IgdGhpcyByZWFzb24gKHRoaXMgY2FsbGJhY2sgaXMgY2FsbGVkCj4gPiA+IGluc2lk
ZSB1c2JyZWRpcmhvc3Rfb3Blbl9mdWxsKS4KPiA+ID4KPiA+ID4gPiAgICAgIGlmIChpc19jaGFu
bmVsX3JlYWR5KGNoLT51c2VyX2RhdGEpKSB7Cj4gPiA+ID4gLSAgICAgICAgU1BJQ0VfREVCVUco
IiVzIGNoICVwIC0+IHVzYnJlZGlyaG9zdCIsIF9fRlVOQ1RJT05fXywgY2gpOwo+ID4gPiA+IC0g
ICAgICAgIHVzYnJlZGlyaG9zdF93cml0ZV9ndWVzdF9kYXRhKGNoLT51c2JyZWRpcmhvc3QpOwo+
ID4gPiA+ICsgICAgICAgIGlmIChjaC0+dXNicmVkaXJob3N0KSB7Cj4gPiA+ID4gKyAgICAgICAg
ICAgIFNQSUNFX0RFQlVHKCIlcyBjaCAlcCAtPiB1c2JyZWRpcmhvc3QiLCBfX0ZVTkNUSU9OX18s
IGNoKTsKPiA+ID4gPiArICAgICAgICAgICAgdXNicmVkaXJob3N0X3dyaXRlX2d1ZXN0X2RhdGEo
Y2gtPnVzYnJlZGlyaG9zdCk7Cj4gPiA+ID4gKyAgICAgICAgfSBlbHNlIGlmIChjaC0+cGFyc2Vy
KSB7Cj4gPiA+ID4gKyAgICAgICAgICAgIFNQSUNFX0RFQlVHKCIlcyBjaCAlcCAtPiBwYXJzZXIi
LCBfX0ZVTkNUSU9OX18sIGNoKTsKPiA+ID4gPiArICAgICAgICAgICAgdXNicmVkaXJwYXJzZXJf
ZG9fd3JpdGUoY2gtPnBhcnNlcik7Cj4gPiA+ID4gKyAgICAgICAgfSBlbHNlIHsKPiA+ID4gPiAr
ICAgICAgICAgICAgU1BJQ0VfREVCVUcoIiVzIGNoICVwIChOT1QgQUNUSVZFKSIsIF9fRlVOQ1RJ
T05fXywgY2gpOwo+ID4gPgo+ID4gPiBUaGlzIHRoaXJkIGNhc2Ugc2hvdWxkIG5ldmVyIGJlIHBv
c3NpYmxlLiBUaGlzIGlzIG9uZSBhc3BlY3QgdGhhdCBtYXN0ZXIKPiA+ID4gY29kZSBpcyBjb25m
dXNpbmcgYWJvdXQuCj4gPiA+Cj4gPiA+ID4gKyAgICAgICAgfQo+ID4gPiA+ICAgICAgfSBlbHNl
IHsKPiA+ID4gPiAgICAgICAgICBTUElDRV9ERUJVRygiJXMgY2ggJXAgKG5vdCByZWFkeSkiLCBf
X0ZVTkNUSU9OX18sIGNoKTsKPiA+ID4gPiAgICAgIH0KPiA+ID4gPiBAQCAtNTUxLDEzICs1Njks
NTIgQEAgdm9pZAo+ID4gPiA+IHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV91bnJlZihTcGljZVVz
YkJhY2tlbmREZXZpY2UgKmRldikKPiA+ID4gPiAgICAgIH0KPiA+ID4gPiAgfQo+ID4gPiA+Cj4g
PiA+ID4gLWludCBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfY2hlY2tfZmlsdGVyKAo+ID4gPiA+
IC0gICAgU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpkZXYsCj4gPiA+ID4gLSAgICBjb25zdCBzdHJ1
Y3QgdXNicmVkaXJmaWx0ZXJfcnVsZSAqcnVsZXMsCj4gPiA+ID4gLSAgICBpbnQgY291bnQpCj4g
PiA+ID4gK3N0YXRpYyBpbnQgY2hlY2tfZWRldl9kZXZpY2VfZmlsdGVyKFNwaWNlVXNiQmFja2Vu
ZERldmljZSAqZGV2LAo+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBjb25zdCBzdHJ1Y3QgdXNicmVkaXJmaWx0ZXJfcnVsZQo+ID4gPiA+ICpydWxlcywKPiA+ID4g
PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IGNvdW50KQo+ID4gPiA+
ICB7Cj4gPiA+ID4gLSAgICByZXR1cm4gdXNicmVkaXJob3N0X2NoZWNrX2RldmljZV9maWx0ZXIo
Cj4gPiA+ID4gLSAgICAgICAgcnVsZXMsIGNvdW50LCBkZXYtPmxpYnVzYl9kZXZpY2UsIDApOwo+
ID4gPiA+ICsgICAgU3BpY2VVc2JFbXVsYXRlZERldmljZSAqZWRldiA9IGRldi0+ZWRldjsKPiA+
ID4gPiArICAgIHVpbnQ4X3QgY2xzWzMyXSwgc3ViY2xzWzMyXSwgcHJvdG9bMzJdLCAqY2ZnLCBp
Zm51bSA9IDA7Cj4gPiA+ID4gKyAgICB1aW50MTZfdCBzaXplLCBvZmZzZXQgPSAwOwo+ID4gPiA+
ICsgICAgaWYgKCFlZGV2KSB7Cj4gPiA+ID4gKyAgICAgICAgcmV0dXJuIDE7Cj4gPiA+ID4gKyAg
ICB9Cj4gPiA+ID4gKyAgICBpZiAoIWRldmljZV9vcHMoZWRldiktPmdldF9kZXNjcmlwdG9yKGVk
ZXYsIExJQlVTQl9EVF9DT05GSUcsIDAsCj4gPiA+ID4gKHZvaWQKPiA+ID4gPiAqKikmY2ZnLCAm
c2l6ZSkpIHsKPiA+ID4gPiArICAgICAgICByZXR1cm4gMTsKPiA+ID4gPiArICAgIH0KPiA+ID4g
PiArICAgIHdoaWxlICgob2Zmc2V0ICsgMSkgPCBzaXplKSB7Cj4gPiA+ID4gKyAgICAgICAgdWlu
dDhfdCBsZW4gID0gY2ZnW29mZnNldF07Cj4gPiA+ID4gKyAgICAgICAgdWludDhfdCB0eXBlID0g
Y2ZnW29mZnNldCArIDFdOwo+ID4gPiA+ICsgICAgICAgIGlmICgob2Zmc2V0ICsgbGVuKSA+IHNp
emUpIHsKPiA+ID4gPiArICAgICAgICAgICAgYnJlYWs7Cj4gPiA+ID4gKyAgICAgICAgfQo+ID4g
PiA+ICsgICAgICAgIGlmICh0eXBlID09IExJQlVTQl9EVF9JTlRFUkZBQ0UpIHsKPiA+ID4gPiAr
ICAgICAgICAgICAgY2xzW2lmbnVtXSA9IGNmZ1tvZmZzZXQgKyA1XTsKPiA+ID4gPiArICAgICAg
ICAgICAgc3ViY2xzW2lmbnVtXSA9IGNmZ1tvZmZzZXQgKyA2XTsKPiA+ID4gPiArICAgICAgICAg
ICAgcHJvdG9baWZudW1dID0gY2ZnW29mZnNldCArIDddOwo+ID4gPiA+ICsgICAgICAgICAgICBp
Zm51bSsrOwo+ID4gPiA+ICsgICAgICAgIH0KPiA+ID4gPiArICAgICAgICBvZmZzZXQgKz0gbGVu
Owo+ID4gPiA+ICsgICAgfQo+ID4gPiA+ICsKPiA+ID4gPiArICAgIHJldHVybiB1c2JyZWRpcmZp
bHRlcl9jaGVjayhydWxlcywgY291bnQsCj4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgZGV2LT5kZXZpY2VfaW5mby5jbGFzcywKPiA+ID4gPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBkZXYtPmRldmljZV9pbmZvLnN1YmNsYXNzLAo+ID4gPiA+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRldi0+ZGV2aWNlX2luZm8ucHJvdG9jb2wsCj4g
PiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xzLCBzdWJjbHMsIHByb3Rv
LCBpZm51bSwKPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXYtPmRl
dmljZV9pbmZvLnZpZCwKPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBk
ZXYtPmRldmljZV9pbmZvLnBpZCwKPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBkZXYtPmRldmljZV9pbmZvLmJjZFVTQiwgMCk7Cj4gPiA+ID4gK30KPiA+ID4gPiArCj4g
PiA+ID4gK2ludCBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfY2hlY2tfZmlsdGVyKFNwaWNlVXNi
QmFja2VuZERldmljZSAqZGV2LAo+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBjb25zdCBzdHJ1Y3QKPiA+ID4gPiB1c2JyZWRpcmZpbHRlcl9ydWxlCj4g
PiA+ID4gKnJ1bGVzLCBpbnQgY291bnQpCj4gPiA+ID4gK3sKPiA+ID4gPiArICAgIGlmIChkZXYt
PmxpYnVzYl9kZXZpY2UpIHsKPiA+ID4gPiArICAgICAgICByZXR1cm4gdXNicmVkaXJob3N0X2No
ZWNrX2RldmljZV9maWx0ZXIocnVsZXMsIGNvdW50LAo+ID4gPiA+IGRldi0+bGlidXNiX2Rldmlj
ZSwgMCk7Cj4gPiA+ID4gKyAgICB9IGVsc2Ugewo+ID4gPiA+ICsgICAgICAgIHJldHVybiBjaGVj
a19lZGV2X2RldmljZV9maWx0ZXIoZGV2LCBydWxlcywgY291bnQpOwo+ID4gPiA+ICsgICAgfQo+
ID4gPiA+ICB9Cj4gPiA+ID4KPiA+ID4gPiAgc3RhdGljIGludCB1c2JyZWRpcl9yZWFkX2NhbGxi
YWNrKHZvaWQgKnVzZXJfZGF0YSwgdWludDhfdCAqZGF0YSwgaW50Cj4gPiA+ID4gIGNvdW50KQo+
ID4gPiA+IEBAIC02MjEsNiArNjc4LDE3IEBAIHN0YXRpYyBpbnQgdXNicmVkaXJfd3JpdGVfY2Fs
bGJhY2sodm9pZCAqdXNlcl9kYXRhLAo+ID4gPiA+IHVpbnQ4X3QgKmRhdGEsIGludCBjb3VudCkK
PiA+ID4gPiAgICAgIFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmNoID0gdXNlcl9kYXRhOwo+ID4g
PiA+ICAgICAgaW50IHJlczsKPiA+ID4gPiAgICAgIFNQSUNFX0RFQlVHKCIlcyBjaCAlcCwgJWQg
Ynl0ZXMiLCBfX0ZVTkNUSU9OX18sIGNoLCBjb3VudCk7Cj4gPiA+ID4gKyAgICBpZiAoIWNoLT5o
ZWxsb19zZW50KSB7Cj4gPiA+Cj4gPiA+IElzIGNvbmZ1c2luZyB0aGF0IHRoZSBzYW1lIGNhbGxi
YWNrIGlzIHVzZWQgZm9yIGJvdGggdXNicmVkaXIgcGFyc2VyIGFuZAo+ID4gPiB1c2JyZWRpciBo
b3N0IGJ1dCB0aGUgaGVsbG8gc2hvdWxkIGJlIHBhcnNlZCBvbmx5IGZvciB0aGUgaG9zdC4KPiA+
ID4gTWF5YmUgZGlzYWJsaW5nIGhlbGxvIGZvciB0aGUgcGFyc2VyIGFuZCBjaGVjayB0aGUgdHlw
ZSAoaGVsbG8pIGhlcmU/Cj4gPgo+ID4KPiA+Cj4gPiA+Cj4gPiA+ID4gKyAgICAgICAgLyogaGVs
bG8gaXMgc2hvcnQgaGVhZGVyICgxMikgKyBoZWxsbyBzdHJ1Y3QgKDY0KSArIGNhcGFiaWxpdGll
cwo+ID4gPiA+ICg0KQo+ID4gPiA+ICovCj4gPiA+ID4gKyAgICAgICAgaW50IGhlbGxvX3NpemUg
PSBzaXplb2Yoc3RydWN0IHVzYl9yZWRpcl9oZWFkZXIpICsgc2l6ZW9mKHN0cnVjdAo+ID4gPiA+
IHVzYl9yZWRpcl9oZWxsb19oZWFkZXIpOwo+ID4gPgo+ID4gPiBUaGlzIGZvcm11bGFlIGlzIGNv
bmZ1c2luZyB3aXRoIHRoZSBkZXNjcmlwdGlvbi4gc2l6ZW9mKHN0cnVjdAo+ID4gPiB1c2JfcmVk
aXJfaGVhZGVyKQo+ID4gPiBpcyAxNiBidXQgaXMgbm90IHRoZSBzaG9ydCAoMzJiaXQpIGhlYWRl
ci4KPiA+ID4KPiA+Cj4gPiBBdCBzdGFnZSBvZiBzZW5kaW5nIGhlbGxvIHRoZSBwYXJzZXIgKGFs
c28gd2hlbiBpcyB3b3JrcyB1bmRlcgo+ID4gdXNicmVkaXJob3N0KSBkb2VzIG5vdCBrbm93IHdo
YXQgdGhlIHNlY29uZCBzaWRlIHN1cHBvcnQsIHNvIGl0Cj4gPiB1c2VzIGxlZ2FjeS1jb21wYXRp
YmxlIHN0cnVjdHVyZS4gSWYgc2l6ZSBvZiBoZWxsbyBpcyBiaWdnZXIgdGhhbiB3ZQo+ID4gZXhw
ZWN0LCBzb21ldGhpbmcgaXMgY29tcGxldGVseSBub3QgZ29vZC4KPiA+IFdlIG5lZWQgdG8gZmlu
ZCBjYXBhYmlsaXRpZXMgaW4gdGhlIHBhY2tldCwgc28gd2UgbmVlZCB0byBrbm93IGZvcgo+ID4g
c3VyZSB3aGVyZSB0byBsb29rIGZvciB0aGVtLgo+ID4KPgo+IFllcywgYnV0IHRoZSBjb21tZW50
IGRvZXMgbm90IG1hdGNoIHRoZSBjb2RlIGZvcm11bGFlLCB0aGF0IGlzIGNvbmZ1c2luZywKPiBz
b21ldGhpbmcgbGlrZQo+Cj4gICAgaW50IGhlbGxvX3NpemUgPSAxMiArIHNpemVvZihzdHJ1Y3Qg
dXNiX3JlZGlyX2hlbGxvX2hlYWRlcikgKyA0Owo+Cj4gaXMgc3VyZWx5IGxlc3MgY29uZnVzaW5n
LiBUaGlzIGlzIGhvd2V2ZXIgYXNzdW1pbmcgdGhhdCB1c2JyZWRpciBsaWJyYXJ5Cj4gd29uJ3Qg
YnVtcCBVU0JfUkVESVJfQ0FQU19TSVpFIGluIHRoZSBmdXR1cmUuIEkgd291bGQgYXQgbGVhc3Qg
YWRkIGEKPiBjb21waWxlIGNoZWNrIGZvciB0aGlzICh3b24ndCBmaXggaWYgdXNicmVkaXIgaXMg
dXBkYXRlZCBidXQgYXQgbGVhc3QKPiBkZXRlY3RlZCBhdCBuZXh0IGNvbXBpbGUpLgo+Cj4gPiA+
ID4gKyAgICAgICAgY2gtPmhlbGxvX3NlbnQgPSAxOwo+ID4gPiA+ICsgICAgICAgIGlmIChjb3Vu
dCA9PSBoZWxsb19zaXplKSB7Cj4gPiA+Cj4gPiA+IEkgd291bGQgc2F5ICJjb3VudCA+PSBoZWxs
b19zaXplIiB0byBzdXBwb3J0IGZ1dHVyZSBleHRlbnNpb25zIG9mIHRoZQo+ID4gPiBjYXBhYmls
aXR5IGFycmF5Lgo+ID4KPiA+IElmIHRoZXJlIGFyZSBjYXBhYmlsaXRpZXMgdGhhdCB3ZSdyZSBu
b3QgYXdhcmUgb2YsIHdlJ3JlIG5vdAo+ID4gc3luY2hyb25pemVkIHdpdGggdGhlIHVzYnJlZGly
IGxpYnJhcnkuCj4gPgo+Cj4gWWVzLCBhCj4KPiAgICBTUElDRV9WRVJJRlkoVVNCX1JFRElSX0NB
UFNfU0laRSA9PSAxKTsKPgo+IHdvdWxkIGhlbHAuCj4KPiA+ID4KPiA+ID4gPiArICAgICAgICAg
ICAgbWVtY3B5KCZjaC0+aG9zdF9jYXBzLCBkYXRhICsgaGVsbG9fc2l6ZSAtCj4gPiA+ID4gc2l6
ZW9mKGNoLT5ob3N0X2NhcHMpLAo+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgc2l6ZW9mKGNo
LT5ob3N0X2NhcHMpKTsKPiA+ID4gPiArICAgICAgICAgICAgU1BJQ0VfREVCVUcoIiVzIGNoICVw
LCBzZW5kaW5nIGZpcnN0IGhlbGxvLCBjYXBzICUwOFgiLAo+ID4gPiA+ICsgICAgICAgICAgICAg
ICAgICAgICAgICBfX0ZVTkNUSU9OX18sIGNoLCBjaC0+aG9zdF9jYXBzKTsKPiA+ID4gPiArICAg
ICAgICB9Cj4gPiA+ID4gKyAgICB9Cj4gPiA+ID4gICAgICByZXMgPSBzcGljZV91c2JyZWRpcl93
cml0ZV9jYWxsYmFjayhjaC0+dXNlcl9kYXRhLCBkYXRhLCBjb3VudCk7Cj4gPiA+ID4gICAgICBy
ZXR1cm4gcmVzOwo+ID4gPiA+ICB9Cj4gPiA+ID4gQEAgLTY0MSw2ICs3MDksMjcgQEAgaW50Cj4g
PiA+ID4gc3BpY2VfdXNiX2JhY2tlbmRfcmVhZF9ndWVzdF9kYXRhKFNwaWNlVXNiQmFja2VuZENo
YW5uZWwgKmNoLCB1aW50OF90Cj4gPiA+ID4gKmRhdGEsCj4gPiA+ID4gICAgICBjaC0+cmVhZF9i
dWZfc2l6ZSA9IGNvdW50Owo+ID4gPiA+ICAgICAgaWYgKGNoLT51c2JyZWRpcmhvc3QpIHsKPiA+
ID4KPiA+ID4gTWF5YmUgdGhpcyBjb3VsZCBiZSAiY2gtPnVzYnJlZGlyaG9zdCB8fCAhY2gtPmhl
bGxvX2RvbmVfcGFyc2VyIiB0bwo+ID4gPiBwYXJzZSB0aGUgJ2hlbGxvJyBhbHdheXMgd2l0aCB1
c2JyZWRpciBob3N0ID8KPiA+Cj4gPiBJIGV4cGVjdCB0aGlzIHdpbGwgbWFrZSB0aGUgY29kZSBt
b3JlIGNvbXBsaWNhdGVkIChmcm9tIHByZXZpb3VzIGF0dGVtcHRzKS4KPiA+Cj4gPiA+Cj4gPiA+
ID4gICAgICAgICAgcmVzID0gdXNicmVkaXJob3N0X3JlYWRfZ3Vlc3RfZGF0YShjaC0+dXNicmVk
aXJob3N0KTsKPiA+ID4gPiArICAgICAgICBpZiAoIWNoLT5oZWxsb19kb25lX3BhcnNlcikgewo+
ID4gPiA+ICsgICAgICAgICAgICBpbnQgcmVzX3BhcnNlcjsKPiA+ID4gPiArICAgICAgICAgICAg
LyogdXNicmVkaXJob3N0IHNob3VsZCBjb25zdW1lIGhlbGxvIHJlc3BvbnNlICovCj4gPiA+ID4g
KyAgICAgICAgICAgIGdfcmV0dXJuX3ZhbF9pZl9mYWlsKGNoLT5yZWFkX2J1ZiA9PSBOVUxMLAo+
ID4gPiA+IFVTQl9SRURJUl9FUlJPUl9SRUFEX1BBUlNFKTsKPiA+ID4gPiArCj4gPiA+ID4gKyAg
ICAgICAgICAgIGNoLT5yZWFkX2J1ZiA9IGRhdGE7Cj4gPiA+ID4gKyAgICAgICAgICAgIGNoLT5y
ZWFkX2J1Zl9zaXplID0gY291bnQ7Cj4gPiA+ID4gKyAgICAgICAgICAgIGNoLT5oZWxsb19kb25l
X3BhcnNlciA9IDE7Cj4gPiA+ID4gKyAgICAgICAgICAgIGlmIChjaC0+YXR0YWNoZWQgJiYgY2gt
PmF0dGFjaGVkLT5lZGV2KSB7Cj4gPiA+ID4gKyAgICAgICAgICAgICAgICAvKiBjYXNlIG9mIENE
IHNoYXJpbmcgb24gY29ubmVjdCAqLwo+ID4gPiA+ICsgICAgICAgICAgICAgICAgY2gtPnVzYnJl
ZGlyaG9zdCA9IE5VTEw7Cj4gPiA+ID4gKyAgICAgICAgICAgICAgICBjaC0+cGFyc2VyID0gY2gt
PmhpZGRlbl9wYXJzZXI7Cj4gPiA+ID4gKyAgICAgICAgICAgICAgICBTUElDRV9ERUJVRygiJXM6
IHN3aXRjaCAlcCB0byBwYXJzZXIiLCBfX0ZVTkNUSU9OX18sCj4gPiA+ID4gY2gpOwo+ID4gPiA+
ICsgICAgICAgICAgICB9Cj4gPiA+ID4gKyAgICAgICAgICAgIHJlc19wYXJzZXIgPSB1c2JyZWRp
cnBhcnNlcl9kb19yZWFkKGNoLT5oaWRkZW5fcGFyc2VyKTsKPiA+ID4gPiArICAgICAgICAgICAg
aWYgKHJlcyA+PSAwKSB7Cj4gPiA+ID4gKyAgICAgICAgICAgICAgICByZXMgPSByZXNfcGFyc2Vy
Owo+ID4gPiA+ICsgICAgICAgICAgICB9Cj4gPiA+ID4gKyAgICAgICAgfQo+ID4gPiA+ICsgICAg
fSBlbHNlIGlmIChjaC0+cGFyc2VyKSB7Cj4gPiA+ID4gKyAgICAgICAgcmVzID0gdXNicmVkaXJw
YXJzZXJfZG9fcmVhZChjaC0+cGFyc2VyKTsKPiA+ID4gPiAgICAgIH0gZWxzZSB7Cj4gPiA+ID4g
ICAgICAgICAgcmVzID0gVVNCX1JFRElSX0VSUk9SX0lPOwo+ID4gPiA+ICAgICAgfQo+ID4gPiA+
IEBAIC02NjEsNiArNzUwLDExIEBAIGludAo+ID4gPiA+IHNwaWNlX3VzYl9iYWNrZW5kX3JlYWRf
Z3Vlc3RfZGF0YShTcGljZVVzYkJhY2tlbmRDaGFubmVsICpjaCwgdWludDhfdAo+ID4gPiA+ICpk
YXRhLAo+ID4gPiA+ICAgICAgfQo+ID4gPiA+ICAgICAgU1BJQ0VfREVCVUcoIiVzIGNoICVwLCAl
ZCBieXRlcywgcmVzICVkIiwgX19GVU5DVElPTl9fLCBjaCwgY291bnQsCj4gPiA+ID4gICAgICBy
ZXMpOwo+ID4gPiA+Cj4gPiA+ID4gKyAgICBpZiAoY2gtPnJlamVjdGVkKSB7Cj4gPiA+ID4gKyAg
ICAgICAgY2gtPnJlamVjdGVkID0gMDsKPiA+ID4gPiArICAgICAgICByZXMgPSBVU0JfUkVESVJf
RVJST1JfREVWX1JFSkVDVEVEOwo+ID4gPiA+ICsgICAgfQo+ID4gPgo+ID4gPiBXaHkgdGhpcyBp
cyBhZnRlciB0aGUgcmVhZD8gV29uJ3QgaXQgZGlzY2FyZCB0aGUgdmFsdWU/Cj4gPgo+ID4gQmVj
YXVzZSB3ZSBuZWVkIHRvIHByb3ZpZGUgdGhlIGVycm9yIHRvIHRoZSB1c2ItcmVkaXItY2hhbm5l
bC4KPiA+IFdlIGtub3cgYWJvdXQgJ3JlamVjdCcgZnJvbSBvdXIgY2FsbGJhY2sgdGhhdCBpcyBu
b3QgaW4gY29udGV4dCBvZgo+ID4gdXNiLXJlZGlyLWNoYW5uZWwgb3BlcmF0aW9uLgo+ID4KPgo+
IFRoaXMgZG9lcyBub3QgYW5zd2VyIG15IHF1ZXN0aW9uLCBpZiB3ZSByZXR1cm4gZXJyb3IgYmVm
b3JlIHlvdSBhcmUgc3RpbGwKPiBwcm92aWRpbmcgdGhlIGVycm9yLCBqdXN0IHlvdSB3b24ndCBk
aXNjYXJkIHRoZSByZWFkLgoKV2UgZG8gbm90IGRpc2NhcmQgaGVyZSBhbnl0aGluZy4gVGhpcyBw
cm9jZWR1cmUgc2F2ZXMgZGF0YSBidWZmZXIgZm9yCmZ1cnRoZXIgcmVhZCBvcGVyYXRpb24gYW5k
IGlzc3VlcyByZXF1ZXN0IHRvIHBhcnNlci91c2JyZWRpcmhvc3QgdG8KcmVhZCB0aGUgZGF0YS4K
SXQgcmV0dXJucyBlcnJvciBvciBPSyB0byB1c2ItcmVkaXItY2hhbm5lbCBhbmQgaW4gY2FzZSBv
ZiBlcnJvciB0aGUKdXNicmVkaXItY2hhbm5lbCB3aWxsIHNwYXduIGVycm9yIGhhbmRsZXIgdGhh
dCB3aWxsIGluaXRpYXRlIGRldmljZQpkaXNjb25uZWN0aW9uIGFuZCBpbmRpY2F0ZSB0aGUgZXJy
b3IgdG8gdGhlIGFwcGxpY2F0aW9uLgoKPiBPciBpcyB0aGlzIGRldGVjdGluZyBhbiBpbnRlcm5h
bCBzYXZlZCBlcnJvciBkZXRlY3RlZCBkdXJpbmcgdGhlIHByb2Nlc3MKPiBvZiB0aGUgZGF0YSB3
ZSBzZW50PwoKV2UgZG8gbm90IGhhdmUgb3RoZXIgcGF0aCB0byByZXR1cm4gZXJyb3IgdG8gdGhl
IHVzYnJlZGlyLWNoYW5uZWwuClRoaXMgcHJvY2VkdXJlIHJldHVybnMgZXJyb3IgdG8gaXQgSW4g
Ym90aCBjYXNlcyAodGhlIGVycm9yIGlzCnJldHVybmVkIGJ5IHBhcnNlci91YnJlZGlyIG9yIHRo
ZSBlcnJvciBpcyBzYXZlZCBpbnRlcm5hbGx5KS4KCj4gV2h5IG5vdCB1c2luZyB0cnVlL2ZhbHNl
IGZvciBib29sZWFucz8KCkkgZG8gbm90IHNlZSBoZXJlIGFueSBib29sZWFuIGV4Y2VwdCBvZiAn
cmVqZWN0ZWQnIGZsYWcuCldoeSBib29sZWFuIGlzIGJldHRlciB0aGFuIGZsYWc/PwoKPgo+ID4g
Pgo+ID4gPiA+ICsKPiA+ID4gPiAgICAgIHJldHVybiByZXM7Cj4gPiA+ID4gIH0KPiA+ID4gPgo+
ID4gPiA+IEBAIC02OTAsMTMgKzc4NCw0MjYgQEAgR0Vycm9yICpzcGljZV91c2JfYmFja2VuZF9n
ZXRfZXJyb3JfZGV0YWlscyhpbnQKPiA+ID4gPiBlcnJvcl9jb2RlLCBnY2hhciAqZGVzYykKPiA+
ID4gPiAgdm9pZCBzcGljZV91c2JfYmFja2VuZF9yZXR1cm5fd3JpdGVfZGF0YShTcGljZVVzYkJh
Y2tlbmRDaGFubmVsICpjaCwKPiA+ID4gPiAgdm9pZAo+ID4gPiA+ICAqZGF0YSkKPiA+ID4gPiAg
ewo+ID4gPiA+ICAgICAgaWYgKGNoLT51c2JyZWRpcmhvc3QpIHsKPiA+ID4gPiAtICAgICAgICBT
UElDRV9ERUJVRygiJXMgY2ggJXAiLCBfX0ZVTkNUSU9OX18sIGNoKTsKPiA+ID4gPiArICAgICAg
ICBTUElDRV9ERUJVRygiJXMgY2ggJXAgLT4gdXNicmVkaXJob3N0IiwgX19GVU5DVElPTl9fLCBj
aCk7Cj4gPiA+ID4gICAgICAgICAgdXNicmVkaXJob3N0X2ZyZWVfd3JpdGVfYnVmZmVyKGNoLT51
c2JyZWRpcmhvc3QsIGRhdGEpOwo+ID4gPiA+ICsgICAgfSBlbHNlIGlmIChjaC0+cGFyc2VyKSB7
Cj4gPiA+ID4gKyAgICAgICAgU1BJQ0VfREVCVUcoIiVzIGNoICVwIC0+IHBhcnNlciIsIF9fRlVO
Q1RJT05fXywgY2gpOwo+ID4gPiA+ICsgICAgICAgIHVzYnJlZGlycGFyc2VyX2ZyZWVfd3JpdGVf
YnVmZmVyKGNoLT5wYXJzZXIsIGRhdGEpOwo+ID4gPgo+ID4gPiBBIGJpdCBzY2FyeSB0aGF0IGR1
cmluZyBhIHN3aWN0aCBob3N0IDwtPiBwYXJzZXIgdGhpcyBjYW4gY2FsbCB0aGUgd3JvbmcKPiA+
ID4gZnVuY3Rpb24uIEJ1dCBjdXJyZW50bHkgdGhlIGltcGxlbWVudGF0aW9uIGZvciBib3RoIGlz
IHRvIGZyZWUgJ2RhdGEnLgo+ID4gPgo+ID4gPiA+ICAgICAgfSBlbHNlIHsKPiA+ID4gPiAgICAg
ICAgICBTUElDRV9ERUJVRygiJXMgY2ggJXAgLSBOT0JPRFkgVE8gQ0FMTCIsIF9fRlVOQ1RJT05f
XywgY2gpOwo+ID4gPiA+ICAgICAgfQo+ID4gPiA+ICB9Cj4gPiA+ID4KPiA+ID4gPiArc3RhdGlj
IHZvaWQgdXNicmVkaXJfY29udHJvbF9wYWNrZXQodm9pZCAqcHJpdiwKPiA+ID4gPiArICAgIHVp
bnQ2NF90IGlkLCBzdHJ1Y3QgdXNiX3JlZGlyX2NvbnRyb2xfcGFja2V0X2hlYWRlciAqaCwKPiA+
ID4gPiArICAgIHVpbnQ4X3QgKmRhdGEsIGludCBkYXRhX2xlbikKPiA+ID4KPiA+ID4gVGhpcyBz
dHlsZSBpcyBuZXcsIEkgc3VwcG9zZSBjb3BpZWQgZnJvbSB1c2JyZWRpciwgYnV0IGlzIG5vdAo+
ID4gPiBzcGljZS1ndGsuCj4gPiA+Cj4gPiA+ID4gK3sKPiA+ID4gPiArICAgIFNwaWNlVXNiQmFj
a2VuZENoYW5uZWwgKmNoID0gcHJpdjsKPiA+ID4gPiArICAgIFNwaWNlVXNiQmFja2VuZERldmlj
ZSAqZCA9IGNoLT5hdHRhY2hlZDsKPiA+ID4gPiArICAgIFNwaWNlVXNiRW11bGF0ZWREZXZpY2Ug
KmVkZXYgPSBkID8gZC0+ZWRldiA6IE5VTEw7Cj4gPiA+ID4gKyAgICBzdHJ1Y3QgdXNiX3JlZGly
X2NvbnRyb2xfcGFja2V0X2hlYWRlciByZXNwb25zZSA9ICpoOwo+ID4gPiA+ICsgICAgdWludDhf
dCByZXF0eXBlID0gaC0+cmVxdWVzdHR5cGUgJiAweDdmOwo+ID4gPiA+ICsgICAgZ2Jvb2xlYW4g
ZG9uZSA9IEZBTFNFOwo+ID4gPiA+ICsgICAgdm9pZCAqb3V0X2J1ZmZlciA9IE5VTEw7Cj4gPiA+
ID4gKwo+ID4gPiA+ICsgICAgcmVzcG9uc2Uuc3RhdHVzID0gdXNiX3JlZGlyX3N0YWxsOwo+ID4g
PiA+ICsgICAgU1BJQ0VfREVCVUcoIiVzICVwOiBUUlZJTCAlMDJYICUwMlggJTA0WCAlMDRYICUw
NFgiLAo+ID4gPiA+ICsgICAgICAgICAgICAgICAgX19GVU5DVElPTl9fLAo+ID4gPiA+ICsgICAg
ICAgICAgICAgICAgY2gsIGgtPnJlcXVlc3R0eXBlLCBoLT5yZXF1ZXN0LAo+ID4gPiA+ICsgICAg
ICAgICAgICAgICAgaC0+dmFsdWUsIGgtPmluZGV4LCBoLT5sZW5ndGgpOwo+ID4gPiA+ICsKPiA+
ID4gPiArICAgIGlmICghZWRldikgewo+ID4gPiA+ICsgICAgICAgIFNQSUNFX0RFQlVHKCIlczog
ZGV2aWNlIG5vdCBhdHRhY2hlZCIsIF9fRlVOQ1RJT05fXyk7Cj4gPiA+ID4gKyAgICAgICAgcmVz
cG9uc2Uuc3RhdHVzID0gdXNiX3JlZGlyX2lvZXJyb3I7Cj4gPiA+ID4gKyAgICAgICAgZG9uZSA9
IFRSVUU7Cj4gPiA+ID4gKyAgICB9IGVsc2UgaWYgKHJlcXR5cGUgPT0gKExJQlVTQl9SRVFVRVNU
X1RZUEVfU1RBTkRBUkQgfAo+ID4gPiA+IExJQlVTQl9SRUNJUElFTlRfREVWSUNFKSAmJgo+ID4g
PiA+ICsgICAgICAgICAgICAgICBoLT5yZXF1ZXN0ID09IExJQlVTQl9SRVFVRVNUX0dFVF9ERVND
UklQVE9SKSB7Cj4gPiA+ID4gKyAgICAgICAgdWludDE2X3Qgc2l6ZTsKPiA+ID4gPiArICAgICAg
ICBkb25lID0gZGV2aWNlX29wcyhlZGV2KS0+Z2V0X2Rlc2NyaXB0b3IoZWRldiwgaC0+dmFsdWUg
Pj4gOCwKPiA+ID4gPiBoLT52YWx1ZSAmIDB4ZmYsCj4gPiA+ID4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZvdXRfYnVmZmVyLCAmc2l6ZSk7Cj4gPiA+
ID4gKyAgICAgICAgcmVzcG9uc2UubGVuZ3RoID0gc2l6ZTsKPiA+ID4gPiArICAgICAgICBpZiAo
ZG9uZSkgewo+ID4gPiA+ICsgICAgICAgICAgICByZXNwb25zZS5zdGF0dXMgPSAwOwo+ID4gPiA+
ICsgICAgICAgIH0KPiA+ID4gPiArICAgICAgICBkb25lID0gVFJVRTsKPiA+ID4gPiArICAgIH0K
PiA+ID4gPiArCj4gPiA+ID4gKyAgICBpZiAoIWRvbmUpIHsKPiA+ID4gPiArICAgICAgICBkZXZp
Y2Vfb3BzKGVkZXYpLT5jb250cm9sX3JlcXVlc3QoZWRldiwgZGF0YSwgZGF0YV9sZW4sCj4gPiA+
ID4gJnJlc3BvbnNlLAo+ID4gPiA+ICZvdXRfYnVmZmVyKTsKPiA+ID4gPiArICAgICAgICBkb25l
ID0gVFJVRTsKPiA+ID4gPiArICAgIH0KPiA+ID4gPiArCj4gPiA+ID4gKyAgICBpZiAocmVzcG9u
c2Uuc3RhdHVzKSB7Cj4gPiA+ID4gKyAgICAgICAgcmVzcG9uc2UubGVuZ3RoID0gMDsKPiA+ID4g
PiArICAgIH0gZWxzZSBpZiAocmVzcG9uc2UubGVuZ3RoID4gaC0+bGVuZ3RoKSB7Cj4gPiA+ID4g
KyAgICAgICAgcmVzcG9uc2UubGVuZ3RoID0gaC0+bGVuZ3RoOwo+ID4gPiA+ICsgICAgfQo+ID4g
PiA+ICsKPiA+ID4gPiArICAgIFNQSUNFX0RFQlVHKCIlcyByZXNwb25kaW5nIHdpdGggcGF5bG9h
ZCBvZiAlMDJYLCBzdGF0dXMgJVgiLAo+ID4gPiA+ICsgICAgICAgICAgICAgICAgX19GVU5DVElP
Tl9fLCByZXNwb25zZS5sZW5ndGgsIHJlc3BvbnNlLnN0YXR1cyk7Cj4gPiA+ID4gKyAgICB1c2Jy
ZWRpcnBhcnNlcl9zZW5kX2NvbnRyb2xfcGFja2V0KGNoLT5wYXJzZXIsIGlkLCAmcmVzcG9uc2Us
Cj4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNl
Lmxlbmd0aCA/IG91dF9idWZmZXIgOgo+ID4gPiA+IE5VTEwsCj4gPiA+ID4gKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlLmxlbmd0aCk7Cj4gPiA+ID4gKwo+
ID4gPiA+ICsgICAgdXNicmVkaXJfd3JpdGVfZmx1c2hfY2FsbGJhY2soY2gpOwo+ID4gPiA+ICsg
ICAgdXNicmVkaXJwYXJzZXJfZnJlZV9wYWNrZXRfZGF0YShjaC0+cGFyc2VyLCBkYXRhKTsKPiA+
ID4gPiArfQo+ID4gPiA+ICsKPiA+ID4gPiArc3RhdGljIHZvaWQgdXNicmVkaXJfYnVsa19wYWNr
ZXQodm9pZCAqcHJpdiwKPiA+ID4gPiArICAgIHVpbnQ2NF90IGlkLCBzdHJ1Y3QgdXNiX3JlZGly
X2J1bGtfcGFja2V0X2hlYWRlciAqaCwKPiA+ID4gPiArICAgIHVpbnQ4X3QgKmRhdGEsIGludCBk
YXRhX2xlbikKPiA+ID4gPiArewo+ID4gPiA+ICsgICAgU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCAq
Y2ggPSBwcml2Owo+ID4gPiA+ICsgICAgU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpkID0gY2gtPmF0
dGFjaGVkOwo+ID4gPiA+ICsgICAgU3BpY2VVc2JFbXVsYXRlZERldmljZSAqZWRldiA9IGQgPyBk
LT5lZGV2IDogTlVMTDsKPiA+ID4gPiArICAgIHN0cnVjdCB1c2JfcmVkaXJfYnVsa19wYWNrZXRf
aGVhZGVyIGhvdXQgPSAqaDsKPiA+ID4gPiArICAgIHVpbnQzMl90IGxlbiA9IChoLT5sZW5ndGhf
aGlnaCA8PCAxNikgfCBoLT5sZW5ndGg7Cj4gPiA+ID4gKyAgICBTUElDRV9ERUJVRygiJXMgJXA6
IGVwICVYLCBsZW4gJXUsIGlkICUiIEdfR1VJTlQ2NF9GT1JNQVQsCj4gPiA+ID4gX19GVU5DVElP
Tl9fLAo+ID4gPiA+ICsgICAgICAgICAgICAgICAgY2gsIGgtPmVuZHBvaW50LCBsZW4sIGlkKTsK
PiA+ID4gPiArCj4gPiA+ID4gKyAgICBpZiAoIWVkZXYpIHsKPiA+ID4gPiArICAgICAgICBTUElD
RV9ERUJVRygiJXM6IGRldmljZSBub3QgYXR0YWNoZWQiLCBfX0ZVTkNUSU9OX18pOwo+ID4gPiA+
ICsgICAgICAgIGhvdXQuc3RhdHVzID0gdXNiX3JlZGlyX2lvZXJyb3I7Cj4gPiA+ID4gKyAgICAg
ICAgaG91dC5sZW5ndGggPSBob3V0Lmxlbmd0aF9oaWdoID0gMDsKPiA+ID4gPiArICAgICAgICBT
UElDRV9ERUJVRygiJXM6IHJlc3BvbmRpbmcgd2l0aCBaTFAgc3RhdHVzICVkIiwgX19GVU5DVElP
Tl9fLAo+ID4gPiA+IGhvdXQuc3RhdHVzKTsKPiA+ID4gPiArICAgIH0gZWxzZSBpZiAoaC0+ZW5k
cG9pbnQgJiBMSUJVU0JfRU5EUE9JTlRfSU4pIHsKPiA+ID4gPiArICAgICAgICBpZiAoZGV2aWNl
X29wcyhlZGV2KS0+YnVsa19pbl9yZXF1ZXN0KGVkZXYsIGlkLCAmaG91dCkpIHsKPiA+ID4gPiAr
ICAgICAgICAgICAgdXNicmVkaXJwYXJzZXJfZnJlZV9wYWNrZXRfZGF0YShjaC0+cGFyc2VyLCBk
YXRhKTsKPiA+ID4gPiArICAgICAgICAgICAgLyogY29tcGxldGlvbiBpcyBhc3luY2hyb25vdXMg
Ki8KPiA+ID4gPiArICAgICAgICAgICAgcmV0dXJuOwo+ID4gPiA+ICsgICAgICAgIH0KPiA+ID4g
PiArICAgIH0gZWxzZSB7Cj4gPiA+ID4gKyAgICAgICAgaG91dC5zdGF0dXMgPSB1c2JfcmVkaXJf
c3RhbGw7Cj4gPiA+ID4gKyAgICAgICAgZGV2aWNlX29wcyhlZGV2KS0+YnVsa19vdXRfcmVxdWVz
dChlZGV2LCBoLT5lbmRwb2ludCwgZGF0YSwKPiA+ID4gPiBkYXRhX2xlbiwgJmhvdXQuc3RhdHVz
KTsKPiA+ID4gPiArICAgICAgICBTUElDRV9ERUJVRygiJXM6IHJlc3BvbmRpbmcgc3RhdHVzICVk
IiwgX19GVU5DVElPTl9fLAo+ID4gPiA+IGhvdXQuc3RhdHVzKTsKPiA+ID4gPiArICAgIH0KPiA+
ID4gPiArCj4gPiA+ID4gKyAgICB1c2JyZWRpcnBhcnNlcl9zZW5kX2J1bGtfcGFja2V0KGNoLT5w
YXJzZXIsIGlkLCAmaG91dCwgTlVMTCwgMCk7Cj4gPiA+ID4gKyAgICB1c2JyZWRpcnBhcnNlcl9m
cmVlX3BhY2tldF9kYXRhKGNoLT5wYXJzZXIsIGRhdGEpOwo+ID4gPiA+ICsgICAgdXNicmVkaXJf
d3JpdGVfZmx1c2hfY2FsbGJhY2soY2gpOwo+ID4gPiA+ICt9Cj4gPiA+ID4gKwo+ID4gPiA+ICtz
dGF0aWMgdm9pZCB1c2JyZWRpcl9kZXZpY2VfcmVzZXQodm9pZCAqcHJpdikKPiA+ID4gPiArewo+
ID4gPiA+ICsgICAgU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCAqY2ggPSBwcml2Owo+ID4gPiA+ICsg
ICAgU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpkID0gY2gtPmF0dGFjaGVkOwo+ID4gPiA+ICsgICAg
U3BpY2VVc2JFbXVsYXRlZERldmljZSAqZWRldiA9IGQgPyBkLT5lZGV2IDogTlVMTDsKPiA+ID4g
PiArICAgIFNQSUNFX0RFQlVHKCIlcyBjaCAlcCIsIF9fRlVOQ1RJT05fXywgY2gpOwo+ID4gPiA+
ICsgICAgaWYgKGVkZXYpIHsKPiA+ID4gPiArICAgICAgICBkZXZpY2Vfb3BzKGVkZXYpLT5yZXNl
dChlZGV2KTsKPiA+ID4gPiArICAgIH0KPiA+ID4gPiArfQo+ID4gPiA+ICsKPiA+ID4gPiArc3Rh
dGljIHZvaWQgdXNicmVkaXJfaW50ZXJmYWNlX2luZm8odm9pZCAqcHJpdiwKPiA+ID4gPiArICAg
IHN0cnVjdCB1c2JfcmVkaXJfaW50ZXJmYWNlX2luZm9faGVhZGVyICppbnRlcmZhY2VfaW5mbykK
PiA+ID4gPiArewo+ID4gPiA+ICsgICAgU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCAqY2ggPSBwcml2
Owo+ID4gPiA+ICsgICAgU1BJQ0VfREVCVUcoIiVzIG5vdCBpbXBsZW1lbnRlZCAlcCIsIF9fRlVO
Q1RJT05fXywgY2gpOwo+ID4gPiA+ICt9Cj4gPiA+ID4gKwo+ID4gPiA+ICtzdGF0aWMgdm9pZCB1
c2JyZWRpcl9pbnRlcmZhY2VfZXBfaW5mbyh2b2lkICpwcml2LAo+ID4gPiA+ICsgICAgc3RydWN0
IHVzYl9yZWRpcl9lcF9pbmZvX2hlYWRlciAqZXBfaW5mbykKPiA+ID4gPiArewo+ID4gPiA+ICsg
ICAgU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCAqY2ggPSBwcml2Owo+ID4gPiA+ICsgICAgU1BJQ0Vf
REVCVUcoIiVzIG5vdCBpbXBsZW1lbnRlZCAlcCIsIF9fRlVOQ1RJT05fXywgY2gpOwo+ID4gPiA+
ICt9Cj4gPiA+ID4gKwo+ID4gPiA+ICtzdGF0aWMgdm9pZCB1c2JyZWRpcl9zZXRfY29uZmlndXJh
dGlvbih2b2lkICpwcml2LAo+ID4gPiA+ICsgICAgdWludDY0X3QgaWQsIHN0cnVjdCB1c2JfcmVk
aXJfc2V0X2NvbmZpZ3VyYXRpb25faGVhZGVyCj4gPiA+ID4gKnNldF9jb25maWd1cmF0aW9uKQo+
ID4gPiA+ICt7Cj4gPiA+ID4gKyAgICBTcGljZVVzYkJhY2tlbmRDaGFubmVsICpjaCA9IHByaXY7
Cj4gPiA+ID4gKyAgICBzdHJ1Y3QgdXNiX3JlZGlyX2NvbmZpZ3VyYXRpb25fc3RhdHVzX2hlYWRl
ciBoOwo+ID4gPiA+ICsgICAgaC5zdGF0dXMgPSAwOwo+ID4gPiA+ICsgICAgaC5jb25maWd1cmF0
aW9uID0gc2V0X2NvbmZpZ3VyYXRpb24tPmNvbmZpZ3VyYXRpb247Cj4gPiA+ID4gKyAgICBTUElD
RV9ERUJVRygiJXMgY2ggJXAsIGNmZyAlZCIsIF9fRlVOQ1RJT05fXywgY2gsIGguY29uZmlndXJh
dGlvbik7Cj4gPiA+ID4gKyAgICBpZiAoY2gtPmF0dGFjaGVkKSB7Cj4gPiA+ID4gKyAgICAgICAg
Y2gtPmF0dGFjaGVkLT5lZGV2X2NvbmZpZ3VyZWQgPSBoLmNvbmZpZ3VyYXRpb24gIT0gMDsKPiA+
ID4gPiArICAgIH0KPiA+ID4gPiArICAgIHVzYnJlZGlycGFyc2VyX3NlbmRfY29uZmlndXJhdGlv
bl9zdGF0dXMoY2gtPnBhcnNlciwgaWQsICZoKTsKPiA+ID4gPiArICAgIHVzYnJlZGlyX3dyaXRl
X2ZsdXNoX2NhbGxiYWNrKGNoKTsKPiA+ID4gPiArfQo+ID4gPiA+ICsKPiA+ID4gPiArc3RhdGlj
IHZvaWQgdXNicmVkaXJfZ2V0X2NvbmZpZ3VyYXRpb24odm9pZCAqcHJpdiwgdWludDY0X3QgaWQp
Cj4gPiA+ID4gK3sKPiA+ID4gPiArICAgIFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmNoID0gcHJp
djsKPiA+ID4gPiArICAgIHN0cnVjdCB1c2JfcmVkaXJfY29uZmlndXJhdGlvbl9zdGF0dXNfaGVh
ZGVyIGg7Cj4gPiA+ID4gKyAgICBoLnN0YXR1cyA9IDA7Cj4gPiA+ID4gKyAgICBoLmNvbmZpZ3Vy
YXRpb24gPSBjaC0+YXR0YWNoZWQgJiYgY2gtPmF0dGFjaGVkLT5lZGV2X2NvbmZpZ3VyZWQ7Cj4g
PiA+ID4gKyAgICBTUElDRV9ERUJVRygiJXMgY2ggJXAsIGNmZyAlZCIsIF9fRlVOQ1RJT05fXywg
Y2gsIGguY29uZmlndXJhdGlvbik7Cj4gPiA+ID4gKyAgICB1c2JyZWRpcnBhcnNlcl9zZW5kX2Nv
bmZpZ3VyYXRpb25fc3RhdHVzKGNoLT5wYXJzZXIsIGlkLCAmaCk7Cj4gPiA+ID4gKyAgICB1c2Jy
ZWRpcl93cml0ZV9mbHVzaF9jYWxsYmFjayhjaCk7Cj4gPiA+ID4gK30KPiA+ID4gPiArCj4gPiA+
ID4gK3N0YXRpYyB2b2lkIHVzYnJlZGlyX3NldF9hbHRfc2V0dGluZyh2b2lkICpwcml2LAo+ID4g
PiA+ICsgICAgdWludDY0X3QgaWQsIHN0cnVjdCB1c2JfcmVkaXJfc2V0X2FsdF9zZXR0aW5nX2hl
YWRlciAqcykKPiA+ID4gPiArewo+ID4gPiA+ICsgICAgU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCAq
Y2ggPSBwcml2Owo+ID4gPiA+ICsgICAgc3RydWN0IHVzYl9yZWRpcl9hbHRfc2V0dGluZ19zdGF0
dXNfaGVhZGVyIHNoOwo+ID4gPiA+ICsgICAgc2guc3RhdHVzID0gKCFzLT5pbnRlcmZhY2UgJiYg
IXMtPmFsdCkgPyAwIDogdXNiX3JlZGlyX3N0YWxsOwo+ID4gPiA+ICsgICAgc2guaW50ZXJmYWNl
ID0gcy0+aW50ZXJmYWNlOwo+ID4gPiA+ICsgICAgc2guYWx0ID0gcy0+YWx0Owo+ID4gPiA+ICsg
ICAgU1BJQ0VfREVCVUcoIiVzIGNoICVwLCAlZDolZCIsIF9fRlVOQ1RJT05fXywgY2gsIHMtPmlu
dGVyZmFjZSwKPiA+ID4gPiBzLT5hbHQpOwo+ID4gPiA+ICsgICAgdXNicmVkaXJwYXJzZXJfc2Vu
ZF9hbHRfc2V0dGluZ19zdGF0dXMoY2gtPnBhcnNlciwgaWQsICZzaCk7Cj4gPiA+ID4gKyAgICB1
c2JyZWRpcl93cml0ZV9mbHVzaF9jYWxsYmFjayhjaCk7Cj4gPiA+ID4gK30KPiA+ID4gPiArCj4g
PiA+ID4gK3N0YXRpYyB2b2lkIHVzYnJlZGlyX2dldF9hbHRfc2V0dGluZyh2b2lkICpwcml2LAo+
ID4gPiA+ICsgICAgdWludDY0X3QgaWQsIHN0cnVjdCB1c2JfcmVkaXJfZ2V0X2FsdF9zZXR0aW5n
X2hlYWRlciAqcykKPiA+ID4gPiArewo+ID4gPiA+ICsgICAgU3BpY2VVc2JCYWNrZW5kQ2hhbm5l
bCAqY2ggPSBwcml2Owo+ID4gPiA+ICsgICAgc3RydWN0IHVzYl9yZWRpcl9hbHRfc2V0dGluZ19z
dGF0dXNfaGVhZGVyIHNoOwo+ID4gPiA+ICsgICAgc2guc3RhdHVzID0gKHMtPmludGVyZmFjZSA9
PSAwKSA/IDAgOiB1c2JfcmVkaXJfc3RhbGw7Cj4gPiA+ID4gKyAgICBzaC5pbnRlcmZhY2UgPSBz
LT5pbnRlcmZhY2U7Cj4gPiA+ID4gKyAgICBzaC5hbHQgPSAwOwo+ID4gPiA+ICsgICAgU1BJQ0Vf
REVCVUcoIiVzIGNoICVwLCBpZiAlZCIsIF9fRlVOQ1RJT05fXywgY2gsIHMtPmludGVyZmFjZSk7
Cj4gPiA+ID4gKyAgICB1c2JyZWRpcnBhcnNlcl9zZW5kX2FsdF9zZXR0aW5nX3N0YXR1cyhjaC0+
cGFyc2VyLCBpZCwgJnNoKTsKPiA+ID4gPiArICAgIHVzYnJlZGlyX3dyaXRlX2ZsdXNoX2NhbGxi
YWNrKGNoKTsKPiA+ID4gPiArfQo+ID4gPiA+ICsKPiA+ID4gPiArc3RhdGljIHZvaWQgdXNicmVk
aXJfY2FuY2VsX2RhdGEodm9pZCAqcHJpdiwgdWludDY0X3QgaWQpCj4gPiA+ID4gK3sKPiA+ID4g
PiArICAgIFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmNoID0gcHJpdjsKPiA+ID4gPiArICAgIFNw
aWNlVXNiQmFja2VuZERldmljZSAqZCA9IGNoLT5hdHRhY2hlZDsKPiA+ID4gPiArICAgIFNwaWNl
VXNiRW11bGF0ZWREZXZpY2UgKmVkZXYgPSBkID8gZC0+ZWRldiA6IE5VTEw7Cj4gPiA+ID4gKyAg
ICBpZiAoIWVkZXYpIHsKPiA+ID4gPiArICAgICAgICBTUElDRV9ERUJVRygiJXM6IGRldmljZSBu
b3QgYXR0YWNoZWQiLCBfX0ZVTkNUSU9OX18pOwo+ID4gPiA+ICsgICAgICAgIHJldHVybjsKPiA+
ID4gPiArICAgIH0KPiA+ID4gPiArICAgIGRldmljZV9vcHMoZWRldiktPmNhbmNlbF9yZXF1ZXN0
KGVkZXYsIGlkKTsKPiA+ID4gPiArfQo+ID4gPiA+ICsKPiA+ID4gPiArc3RhdGljIHZvaWQgdXNi
cmVkaXJfZmlsdGVyX3JlamVjdCh2b2lkICpwcml2KQo+ID4gPiA+ICt7Cj4gPiA+ID4gKyAgICBT
cGljZVVzYkJhY2tlbmRDaGFubmVsICpjaCA9IHByaXY7Cj4gPiA+ID4gKyAgICBTUElDRV9ERUJV
RygiJXMgJXAiLCBfX0ZVTkNUSU9OX18sIGNoKTsKPiA+ID4gPiArICAgIGNoLT5yZWplY3RlZCA9
IDE7Cj4gPiA+ID4gK30KPiA+ID4gPiArCj4gPiA+ID4gKy8qIE5vdGUgdGhhdCB0aGUgb3duZXJz
aGlwIG9mIHRoZSBydWxlcyBhcnJheSBpcyBwYXNzZWQgb24gdG8gdGhlCj4gPiA+ID4gY2FsbGJh
Y2suCj4gPiA+ID4gKi8KPiA+ID4gPiArc3RhdGljIHZvaWQgdXNicmVkaXJfZmlsdGVyX2ZpbHRl
cih2b2lkICpwcml2LAo+ID4gPiA+ICsgICAgc3RydWN0IHVzYnJlZGlyZmlsdGVyX3J1bGUgKnIs
IGludCBjb3VudCkKPiA+ID4gPiArewo+ID4gPiA+ICsgICAgU3BpY2VVc2JCYWNrZW5kQ2hhbm5l
bCAqY2ggPSBwcml2Owo+ID4gPiA+ICsgICAgU1BJQ0VfREVCVUcoIiVzIGNoICVwICVkIGZpbHRl
cnMiLCBfX0ZVTkNUSU9OX18sIGNoLCBjb3VudCk7Cj4gPiA+ID4gKwo+ID4gPiA+ICsgICAgZnJl
ZShjaC0+cnVsZXMpOwo+ID4gPiA+ICsKPiA+ID4gPiArICAgIGNoLT5ydWxlcyA9IHI7Cj4gPiA+
ID4gKyAgICBjaC0+cnVsZXNfY291bnQgPSBjb3VudDsKPiA+ID4gPiArICAgIGlmIChjb3VudCkg
ewo+ID4gPiA+ICsgICAgICAgIGludCBpOwo+ID4gPiA+ICsgICAgICAgIGZvciAoaSA9IDA7IGkg
PCBjb3VudDsgaSsrKSB7Cj4gPiA+ID4gKyAgICAgICAgICAgIFNQSUNFX0RFQlVHKCIlcyBjbGFz
cyAlZCwgJVg6JVgiLAo+ID4gPiA+ICsgICAgICAgICAgICAgICAgcltpXS5hbGxvdyA/ICJhbGxv
d2VkIiA6ICJkZW5pZWQiLCByW2ldLmRldmljZV9jbGFzcywKPiA+ID4gPiArICAgICAgICAgICAg
ICAgICh1aW50MzJfdClyW2ldLnZlbmRvcl9pZCwgKHVpbnQzMl90KXJbaV0ucHJvZHVjdF9pZCk7
Cj4gPiA+ID4gKyAgICAgICAgfQo+ID4gPiA+ICsgICAgfQo+ID4gPiA+ICt9Cj4gPiA+ID4gKwo+
ID4gPiA+ICtzdGF0aWMgdm9pZCB1c2JyZWRpcl9kZXZpY2VfZGlzY29ubmVjdF9hY2sodm9pZCAq
cHJpdikKPiA+ID4gPiArewo+ID4gPiA+ICsgICAgU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCAqY2gg
PSBwcml2Owo+ID4gPiA+ICsgICAgU1BJQ0VfREVCVUcoIiVzIGNoICVwIiwgX19GVU5DVElPTl9f
LCBjaCk7Cj4gPiA+ID4gKyAgICBpZiAoY2gtPnBhcnNlciAmJiBjaC0+d2FpdF9kaXNjX2Fjaykg
ewo+ID4gPiA+ICsgICAgICAgIGNoLT5wYXJzZXIgPSBOVUxMOwo+ID4gPiA+ICsgICAgICAgIFNQ
SUNFX0RFQlVHKCIlcyBzd2l0Y2ggdG8gdXNicmVkaXJob3N0IiwgX19GVU5DVElPTl9fKTsKPiA+
ID4gPiArICAgICAgICBjaC0+dXNicmVkaXJob3N0ID0gY2gtPmhpZGRlbl9ob3N0Owo+ID4gPiA+
ICsgICAgfQo+ID4gPiA+ICsgICAgY2gtPndhaXRfZGlzY19hY2sgPSAwOwo+ID4gPiA+ICt9Cj4g
PiA+ID4gKwo+ID4gPiA+ICtzdGF0aWMgdm9pZCB1c2JyZWRpcl9oZWxsbyh2b2lkICpwcml2LAo+
ID4gPiA+ICsgICAgc3RydWN0IHVzYl9yZWRpcl9oZWxsb19oZWFkZXIgKmhlbGxvKQo+ID4gPiA+
ICt7Cj4gPiA+ID4gKyAgICBTcGljZVVzYkJhY2tlbmRDaGFubmVsICpjaCA9IHByaXY7Cj4gPiA+
ID4gKyAgICBTcGljZVVzYkJhY2tlbmREZXZpY2UgKmQgPSBjaC0+YXR0YWNoZWQ7Cj4gPiA+ID4g
KyAgICBTcGljZVVzYkVtdWxhdGVkRGV2aWNlICplZGV2ID0gZCA/IGQtPmVkZXYgOiBOVUxMOwo+
ID4gPiA+ICsgICAgc3RydWN0IHVzYl9yZWRpcl9kZXZpY2VfY29ubmVjdF9oZWFkZXIgZGV2aWNl
X2Nvbm5lY3Q7Cj4gPiA+ID4gKyAgICBzdHJ1Y3QgdXNiX3JlZGlyX2VwX2luZm9faGVhZGVyIGVw
X2luZm8gPSB7IDAgfTsKPiA+ID4gPiArICAgIHN0cnVjdCB1c2JfcmVkaXJfaW50ZXJmYWNlX2lu
Zm9faGVhZGVyIGludGVyZmFjZV9pbmZvID0geyAwIH07Cj4gPiA+ID4gKyAgICB1aW50OF90ICpj
Zmc7Cj4gPiA+ID4gKyAgICB1aW50MTZfdCBzaXplLCBvZmZzZXQgPSAwOwo+ID4gPiA+ICsgICAg
U1BJQ0VfREVCVUcoIiVzICVwICVzYXR0YWNoZWQgJXMiLCBfX0ZVTkNUSU9OX18sIGNoLAo+ID4g
PiA+ICsgICAgICAgIGVkZXYgPyAiIiA6ICJub3QgIiwgIGhlbGxvID8gIiIgOiAiKGludGVybmFs
KSIpOwo+ID4gPiA+ICsKPiA+ID4gPiArICAgIGlmIChoZWxsbykgewo+ID4gPiA+ICsgICAgICAg
IGNoLT5oZWxsb19kb25lX3BhcnNlciA9IDE7Cj4gPiA+ID4gKyAgICB9Cj4gPiA+ID4gKyAgICBp
ZiAoIWVkZXYpIHsKPiA+ID4gPiArICAgICAgICByZXR1cm47Cj4gPiA+ID4gKyAgICB9Cj4gPiA+
ID4gKyAgICBpZiAoIWRldmljZV9vcHMoZWRldiktPmdldF9kZXNjcmlwdG9yKGVkZXYsIExJQlVT
Ql9EVF9DT05GSUcsIDAsCj4gPiA+ID4gKHZvaWQKPiA+ID4gPiAqKikmY2ZnLCAmc2l6ZSkpIHsK
PiA+ID4gPiArICAgICAgICByZXR1cm47Cj4gPiA+ID4gKyAgICB9Cj4gPiA+ID4gKyAgICB3aGls
ZSAoKG9mZnNldCArIDEpIDwgc2l6ZSkgewo+ID4gPiA+ICsgICAgICAgIHVpbnQ4X3QgbGVuICA9
IGNmZ1tvZmZzZXRdOwo+ID4gPiA+ICsgICAgICAgIHVpbnQ4X3QgdHlwZSA9IGNmZ1tvZmZzZXQg
KyAxXTsKPiA+ID4gPiArICAgICAgICBpZiAoKG9mZnNldCArIGxlbikgPiBzaXplKSB7Cj4gPiA+
ID4gKyAgICAgICAgICAgIGJyZWFrOwo+ID4gPiA+ICsgICAgICAgIH0KPiA+ID4gPiArICAgICAg
ICBpZiAodHlwZSA9PSBMSUJVU0JfRFRfSU5URVJGQUNFKSB7Cj4gPiA+ID4gKyAgICAgICAgICAg
IHVpbnQzMl90IGkgPSBpbnRlcmZhY2VfaW5mby5pbnRlcmZhY2VfY291bnQ7Cj4gPiA+ID4gKyAg
ICAgICAgICAgIHVpbnQ4X3QgY2xhc3MsIHN1YmNsYXNzLCBwcm90b2NvbDsKPiA+ID4gPiArICAg
ICAgICAgICAgY2xhc3MgPSBjZmdbb2Zmc2V0ICsgNV07Cj4gPiA+ID4gKyAgICAgICAgICAgIHN1
YmNsYXNzID0gY2ZnW29mZnNldCArIDZdOwo+ID4gPiA+ICsgICAgICAgICAgICBwcm90b2NvbCA9
IGNmZ1tvZmZzZXQgKyA3XTsKPiA+ID4gPiArICAgICAgICAgICAgaW50ZXJmYWNlX2luZm8uaW50
ZXJmYWNlX2NsYXNzW2ldID0gY2xhc3M7Cj4gPiA+ID4gKyAgICAgICAgICAgIGludGVyZmFjZV9p
bmZvLmludGVyZmFjZV9zdWJjbGFzc1tpXSA9IHN1YmNsYXNzOwo+ID4gPiA+ICsgICAgICAgICAg
ICBpbnRlcmZhY2VfaW5mby5pbnRlcmZhY2VfcHJvdG9jb2xbaV0gPSBwcm90b2NvbDsKPiA+ID4g
PiArICAgICAgICAgICAgaW50ZXJmYWNlX2luZm8uaW50ZXJmYWNlX2NvdW50Kys7Cj4gPiA+ID4g
KyAgICAgICAgICAgIFNQSUNFX0RFQlVHKCIlcyBJRiVkOiAlZC8lZC8lZCIsIF9fRlVOQ1RJT05f
XywgaSwgY2xhc3MsCj4gPiA+ID4gc3ViY2xhc3MsIHByb3RvY29sKTsKPiA+ID4gPiArICAgICAg
ICB9IGVsc2UgaWYgKHR5cGUgPT0gTElCVVNCX0RUX0VORFBPSU5UKSB7Cj4gPiA+ID4gKyAgICAg
ICAgICAgIHVpbnQ4X3QgYWRkcmVzcyA9IGNmZ1tvZmZzZXQgKyAyXTsKPiA+ID4gPiArICAgICAg
ICAgICAgdWludDE2X3QgbWF4X3BhY2tldF9zaXplID0gMHgxMDAgKiBjZmdbb2Zmc2V0ICsgNV0g
Kwo+ID4gPiA+IGNmZ1tvZmZzZXQKPiA+ID4gPiArIDRdOwo+ID4gPiA+ICsgICAgICAgICAgICB1
aW50OF90IGluZGV4ID0gYWRkcmVzcyAmIDB4ZjsKPiA+ID4gPiArICAgICAgICAgICAgaWYgKGFk
ZHJlc3MgJiAweDgwKSBpbmRleCArPSAweDEwOwo+ID4gPiA+ICsgICAgICAgICAgICBlcF9pbmZv
LnR5cGVbaW5kZXhdID0gY2ZnW29mZnNldCArIDNdICYgMHgzOwo+ID4gPiA+ICsgICAgICAgICAg
ICBlcF9pbmZvLm1heF9wYWNrZXRfc2l6ZVtpbmRleF0gPSBtYXhfcGFja2V0X3NpemU7Cj4gPiA+
ID4gKyAgICAgICAgICAgIFNQSUNFX0RFQlVHKCIlcyBFUFslMDJYXTogJWQvJWQiLCBfX0ZVTkNU
SU9OX18sIGluZGV4LAo+ID4gPiA+IGVwX2luZm8udHlwZVtpbmRleF0sIG1heF9wYWNrZXRfc2l6
ZSk7Cj4gPiA+ID4gKyAgICAgICAgfQo+ID4gPiA+ICsgICAgICAgIG9mZnNldCArPSBsZW47Cj4g
PiA+ID4gKyAgICB9Cj4gPiA+ID4gKwo+ID4gPiA+ICsgICAgdXNicmVkaXJwYXJzZXJfc2VuZF9p
bnRlcmZhY2VfaW5mbyhjaC0+cGFyc2VyLCAmaW50ZXJmYWNlX2luZm8pOwo+ID4gPiA+ICsgICAg
dXNicmVkaXJwYXJzZXJfc2VuZF9lcF9pbmZvKGNoLT5wYXJzZXIsICZlcF9pbmZvKTsKPiA+ID4g
PiArCj4gPiA+ID4gKyAgICBkZXZpY2VfY29ubmVjdC5kZXZpY2VfY2xhc3MgPSAwOyAvL2QtPmRl
dmljZV9pbmZvLmNsYXNzOwo+ID4gPiA+ICsgICAgZGV2aWNlX2Nvbm5lY3QuZGV2aWNlX3N1YmNs
YXNzID0gMDsgLy9kLT5kZXZpY2VfaW5mby5zdWJjbGFzczsKPiA+ID4gPiArICAgIGRldmljZV9j
b25uZWN0LmRldmljZV9wcm90b2NvbCA9IDA7IC8vZC0+ZGV2aWNlX2luZm8ucHJvdG9jb2w7Owo+
ID4gPiA+ICsgICAgZGV2aWNlX2Nvbm5lY3QudmVuZG9yX2lkID0gZC0+ZGV2aWNlX2luZm8udmlk
Owo+ID4gPiA+ICsgICAgZGV2aWNlX2Nvbm5lY3QucHJvZHVjdF9pZCA9IGQtPmRldmljZV9pbmZv
LnBpZDsKPiA+ID4gPiArICAgIGRldmljZV9jb25uZWN0LmRldmljZV92ZXJzaW9uX2JjZCA9IGQt
PmRldmljZV9pbmZvLmJjZFVTQjsKPiA+ID4gPiArICAgIGRldmljZV9jb25uZWN0LnNwZWVkID0g
dXNiX3JlZGlyX3NwZWVkX2hpZ2g7Cj4gPiA+ID4gKyAgICB1c2JyZWRpcnBhcnNlcl9zZW5kX2Rl
dmljZV9jb25uZWN0KGNoLT5wYXJzZXIsICZkZXZpY2VfY29ubmVjdCk7Cj4gPiA+ID4gKyAgICB1
c2JyZWRpcl93cml0ZV9mbHVzaF9jYWxsYmFjayhjaCk7Cj4gPiA+ID4gK30KPiA+ID4gPiArCj4g
PiA+ID4gK3N0YXRpYyB2b2lkIGluaXRpYWxpemVfcGFyc2VyKFNwaWNlVXNiQmFja2VuZENoYW5u
ZWwgKmNoLCBnYm9vbGVhbgo+ID4gPiA+IGRvX2hlbGxvKQo+ID4gPiA+ICt7Cj4gPiA+ID4gKyAg
ICB1aW50MzJfdCBmbGFncywgY2Fwc1tVU0JfUkVESVJfQ0FQU19TSVpFXSA9IHsgMCB9Owo+ID4g
PiA+ICsKPiA+ID4gPiArICAgIGdfcmV0dXJuX2lmX2ZhaWwoY2gtPmhpZGRlbl9wYXJzZXIgIT0g
TlVMTCk7Cj4gPiA+ID4gKyAgICBpZiAoY2gtPnBhcnNlcl9pbml0X2RvbmUpIHsKPiA+ID4gPiAr
ICAgICAgICBpZiAoY2gtPnBhcnNlcl93aXRoX2hlbGxvICE9IGRvX2hlbGxvKSB7Cj4gPiA+ID4g
KyAgICAgICAgICAgIGdfcmV0dXJuX2lmX3JlYWNoZWQoKTsKPiA+ID4gPiArICAgICAgICB9Cj4g
PiA+ID4gKyAgICAgICAgcmV0dXJuOwo+ID4gPiA+ICsgICAgfQo+ID4gPiA+ICsKPiA+ID4gPiAr
ICAgIGNoLT5wYXJzZXJfaW5pdF9kb25lID0gMTsKPiA+ID4gPiArICAgIGNoLT5wYXJzZXJfd2l0
aF9oZWxsbyA9IGRvX2hlbGxvOwo+ID4gPiA+ICsgICAgZmxhZ3MgPSB1c2JyZWRpcnBhcnNlcl9m
bF93cml0ZV9jYl9vd25zX2J1ZmZlciB8Cj4gPiA+ID4gdXNicmVkaXJwYXJzZXJfZmxfdXNiX2hv
c3Q7Cj4gPiA+ID4gKwo+ID4gPiA+ICsgICAgaWYgKGRvX2hlbGxvKSB7Cj4gPiA+ID4gKyAgICAg
ICAgY2gtPmhlbGxvX3NlbnQgPSAxOwo+ID4gPgo+ID4gPiBJbiB3aGljaCBjYXNlIHlvdSBuZWVk
IHRvIGRvIHRoZSBoZWxsbyBpbiB0aGUgcGFyc2VyIGluc3RlYWQgb2YgdGhlIGhvc3Q/Cj4gPiA+
IFRoaXMgY291bGQgY2F1c2UgaXNzdWVzIHN3aXRjaGluZyBmcm9tIHBhcnNlciBiYWNrIHRvIGhv
c3QgaW4gY2FzZSB5b3UKPiA+ID4gcmVtb3ZlIGFuIGVtdWxhdGVkIGRldmljZSBhbmQgeW91IGFk
ZCBhIHJlYWwgb25lLgo+ID4KPiA+IFRoZSBjYXNlIGlzIGRlc2NyaWJlZCBhYm92ZS4gRnJvbSBt
eSBwb2ludCBvZiB2aWV3LCBoYXZpbmcgYm90aAo+ID4gKHVzYnJlZGlyaG9zdCBhbmQgcGFyc2Vy
KSByZWFkeSBhbmQgc3dpdGNoCj4gPiBhY2NvcmRpbmcgdG8gdGhlIGN1cnJlbnQgbmVlZCBpcyB0
aGUgc2ltcGxlc3Qgd2F5IHRvIGRvIHRoZSBqb2IuCj4gPgo+ID4gPgo+ID4gPiA+ICsgICAgICAg
IGNoLT5ob3N0X2NhcHMgfD0gMSA8PCB1c2JfcmVkaXJfY2FwX2Nvbm5lY3RfZGV2aWNlX3ZlcnNp
b247Cj4gPiA+ID4gKyAgICAgICAgY2gtPmhvc3RfY2FwcyB8PSAxIDw8IHVzYl9yZWRpcl9jYXBf
ZGV2aWNlX2Rpc2Nvbm5lY3RfYWNrOwo+ID4gPiA+ICsgICAgICAgIGNoLT5ob3N0X2NhcHMgfD0g
MSA8PCB1c2JfcmVkaXJfY2FwX2VwX2luZm9fbWF4X3BhY2tldF9zaXplOwo+ID4gPiA+ICsgICAg
ICAgIGNoLT5ob3N0X2NhcHMgfD0gMSA8PCB1c2JfcmVkaXJfY2FwXzY0Yml0c19pZHM7Cj4gPiA+
ID4gKyAgICAgICAgY2gtPmhvc3RfY2FwcyB8PSAxIDw8IHVzYl9yZWRpcl9jYXBfMzJiaXRzX2J1
bGtfbGVuZ3RoOwo+ID4gPiA+ICsgICAgfSBlbHNlIHsKPiA+ID4gPiArICAgICAgICBmbGFncyB8
PSB1c2JyZWRpcnBhcnNlcl9mbF9ub19oZWxsbzsKPiA+ID4gPiArICAgIH0KPiA+ID4gPiArCj4g
PiA+ID4gKyAgICBpZiAoY2gtPmhvc3RfY2FwcyAmICgxIDw8IHVzYl9yZWRpcl9jYXBfY29ubmVj
dF9kZXZpY2VfdmVyc2lvbikpIHsKPiA+ID4gPiArICAgICAgICB1c2JyZWRpcnBhcnNlcl9jYXBz
X3NldF9jYXAoY2FwcywKPiA+ID4gPiB1c2JfcmVkaXJfY2FwX2Nvbm5lY3RfZGV2aWNlX3ZlcnNp
b24pOwo+ID4gPiA+ICsgICAgfQo+ID4gPiA+ICsgICAgdXNicmVkaXJwYXJzZXJfY2Fwc19zZXRf
Y2FwKGNhcHMsIHVzYl9yZWRpcl9jYXBfZmlsdGVyKTsKPiA+ID4gPiArICAgIGlmIChjaC0+aG9z
dF9jYXBzICYgKDEgPDwgdXNiX3JlZGlyX2NhcF9kZXZpY2VfZGlzY29ubmVjdF9hY2spKSB7Cj4g
PiA+ID4gKyAgICAgICAgdXNicmVkaXJwYXJzZXJfY2Fwc19zZXRfY2FwKGNhcHMsCj4gPiA+ID4g
dXNiX3JlZGlyX2NhcF9kZXZpY2VfZGlzY29ubmVjdF9hY2spOwo+ID4gPiA+ICsgICAgfQo+ID4g
PiA+ICsgICAgaWYgKGNoLT5ob3N0X2NhcHMgJiAoMSA8PCB1c2JfcmVkaXJfY2FwX2VwX2luZm9f
bWF4X3BhY2tldF9zaXplKSkgewo+ID4gPiA+ICsgICAgICAgIHVzYnJlZGlycGFyc2VyX2NhcHNf
c2V0X2NhcChjYXBzLAo+ID4gPiA+IHVzYl9yZWRpcl9jYXBfZXBfaW5mb19tYXhfcGFja2V0X3Np
emUpOwo+ID4gPiA+ICsgICAgfQo+ID4gPiA+ICsgICAgaWYgKGNoLT5ob3N0X2NhcHMgJiAoMSA8
PCB1c2JfcmVkaXJfY2FwXzY0Yml0c19pZHMpKSB7Cj4gPiA+ID4gKyAgICAgICAgdXNicmVkaXJw
YXJzZXJfY2Fwc19zZXRfY2FwKGNhcHMsIHVzYl9yZWRpcl9jYXBfNjRiaXRzX2lkcyk7Cj4gPiA+
ID4gKyAgICB9Cj4gPiA+ID4gKyAgICBpZiAoY2gtPmhvc3RfY2FwcyAmICgxIDw8IHVzYl9yZWRp
cl9jYXBfMzJiaXRzX2J1bGtfbGVuZ3RoKSkgewo+ID4gPiA+ICsgICAgICAgIHVzYnJlZGlycGFy
c2VyX2NhcHNfc2V0X2NhcChjYXBzLAo+ID4gPiA+IHVzYl9yZWRpcl9jYXBfMzJiaXRzX2J1bGtf
bGVuZ3RoKTsKPiA+ID4gPiArICAgIH0KPiA+ID4gPiArICAgIGlmIChjaC0+aG9zdF9jYXBzICYg
KDEgPDwgdXNiX3JlZGlyX2NhcF9idWxrX3N0cmVhbXMpKSB7Cj4gPiA+ID4gKyAgICAgICAgdXNi
cmVkaXJwYXJzZXJfY2Fwc19zZXRfY2FwKGNhcHMsIHVzYl9yZWRpcl9jYXBfYnVsa19zdHJlYW1z
KTsKPiA+ID4gPiArICAgIH0KPiA+ID4gPiArICAgIHVzYnJlZGlycGFyc2VyX2luaXQoY2gtPmhp
ZGRlbl9wYXJzZXIsIFBBQ0tBR0VfU1RSSU5HLCBjYXBzLAo+ID4gPiA+IFVTQl9SRURJUl9DQVBT
X1NJWkUsIGZsYWdzKTsKPiA+ID4gPiArfQo+ID4gPiA+ICsKPiA+ID4gPiArLyoKPiA+ID4gPiAr
ICAgIFdlIGNhbiBpbml0aWFsaXplIHRoZSB1c2JyZWRpcnBhcnNlciB3aXRoIEhFTExPIGVuYWJs
ZWQgb25seSBpbiBjYXNlCj4gPiA+ID4gKyAgICB0aGUgbGlidXNiIGlzIG5vdCBhY3RpdmUgYW5k
IHRoZSB1c2JyZWRpcmhvc3QgZG9lcyBub3QgZnVuY3Rpb24uCj4gPiA+ID4gKyAgICBUaGVuIHRo
ZSBwYXJzZXIgc2VuZHMgc2Vzc2lvbiBIRUxMTyBhbmQgcmVjZWl2ZXMgc2VydmVyJ3MgcmVzcG9u
c2UuCj4gPiA+ID4gKyAgICBPdGhlcndpc2UgKHVzYnJlZGlycGFyc2VyIGluaXRpYWxpemVkIHdp
dGggSEVMTE8gZGlzYWJsZWQpOgo+ID4gPiA+ICsgICAgLSB0aGUgdXNicmVkaXJob3N0IHNlbmRz
IHNlc3Npb24gSEVMTE8KPiA+ID4gPiArICAgIC0gd2UgbG9vayBpbnRvIGl0IHRvIGtub3cgc2V0
IG9mIGNhcGFiaWxpdGllcyB3ZSBzaGFsbCBpbml0aWFsaXplCj4gPiA+ID4gKyAgICAgIHRoZSBw
YXJzZXIgd2l0aAo+ID4gPiA+ICsgICAgLSB3aGVuIHdlIHJlY2VpdmUgc2VydmVyJ3MgcmVzcG9u
c2UgdG8gSEVMTE8gd2UgcHJvdmlkZSBpdCBhbHNvIHRvCj4gPiA+ID4gKyAgICAgIHBhcnNlciB0
byBsZXQgaXQgc3luY2hyb25pemUgd2l0aCBzZXJ2ZXIncyBjYXBhYmlsaXRpZXMKPiA+ID4gPiAr
Ki8KPiA+ID4gPiArc3RhdGljIHN0cnVjdCB1c2JyZWRpcnBhcnNlciAqY3JlYXRlX3BhcnNlcihT
cGljZVVzYkJhY2tlbmRDaGFubmVsICpjaCkKPiA+ID4gPiArewo+ID4gPiA+ICsgICAgc3RydWN0
IHVzYnJlZGlycGFyc2VyICpwYXJzZXIgPSB1c2JyZWRpcnBhcnNlcl9jcmVhdGUoKTsKPiA+ID4g
PiArCj4gPiA+ID4gKyAgICBnX3JldHVybl92YWxfaWZfZmFpbChwYXJzZXIgIT0gTlVMTCwgTlVM
TCk7Cj4gPiA+ID4gKwo+ID4gPiA+ICsgICAgcGFyc2VyLT5wcml2ID0gY2g7Cj4gPiA+ID4gKyAg
ICBwYXJzZXItPmxvZ19mdW5jID0gdXNicmVkaXJfbG9nOwo+ID4gPiA+ICsgICAgcGFyc2VyLT5y
ZWFkX2Z1bmMgPSB1c2JyZWRpcl9yZWFkX2NhbGxiYWNrOwo+ID4gPiA+ICsgICAgcGFyc2VyLT53
cml0ZV9mdW5jID0gdXNicmVkaXJfd3JpdGVfY2FsbGJhY2s7Cj4gPiA+ID4gKyAgICBwYXJzZXIt
PnJlc2V0X2Z1bmMgPSB1c2JyZWRpcl9kZXZpY2VfcmVzZXQ7Cj4gPiA+ID4gKyAgICBwYXJzZXIt
PnNldF9jb25maWd1cmF0aW9uX2Z1bmMgPSB1c2JyZWRpcl9zZXRfY29uZmlndXJhdGlvbjsKPiA+
ID4gPiArICAgIHBhcnNlci0+Z2V0X2NvbmZpZ3VyYXRpb25fZnVuYyA9IHVzYnJlZGlyX2dldF9j
b25maWd1cmF0aW9uOwo+ID4gPiA+ICsgICAgcGFyc2VyLT5zZXRfYWx0X3NldHRpbmdfZnVuYyA9
IHVzYnJlZGlyX3NldF9hbHRfc2V0dGluZzsKPiA+ID4gPiArICAgIHBhcnNlci0+Z2V0X2FsdF9z
ZXR0aW5nX2Z1bmMgPSB1c2JyZWRpcl9nZXRfYWx0X3NldHRpbmc7Cj4gPiA+ID4gKyAgICBwYXJz
ZXItPmNhbmNlbF9kYXRhX3BhY2tldF9mdW5jID0gdXNicmVkaXJfY2FuY2VsX2RhdGE7Cj4gPiA+
ID4gKyAgICBwYXJzZXItPmNvbnRyb2xfcGFja2V0X2Z1bmMgPSB1c2JyZWRpcl9jb250cm9sX3Bh
Y2tldDsKPiA+ID4gPiArICAgIHBhcnNlci0+YnVsa19wYWNrZXRfZnVuYyA9IHVzYnJlZGlyX2J1
bGtfcGFja2V0Owo+ID4gPiA+ICsgICAgcGFyc2VyLT5hbGxvY19sb2NrX2Z1bmMgPSB1c2JyZWRp
cl9hbGxvY19sb2NrOwo+ID4gPiA+ICsgICAgcGFyc2VyLT5sb2NrX2Z1bmMgPSB1c2JyZWRpcl9s
b2NrX2xvY2s7Cj4gPiA+ID4gKyAgICBwYXJzZXItPnVubG9ja19mdW5jID0gdXNicmVkaXJfdW5s
b2NrX2xvY2s7Cj4gPiA+ID4gKyAgICBwYXJzZXItPmZyZWVfbG9ja19mdW5jID0gdXNicmVkaXJf
ZnJlZV9sb2NrOwo+ID4gPiA+ICsgICAgcGFyc2VyLT5oZWxsb19mdW5jID0gdXNicmVkaXJfaGVs
bG87Cj4gPiA+ID4gKyAgICBwYXJzZXItPmZpbHRlcl9yZWplY3RfZnVuYyA9IHVzYnJlZGlyX2Zp
bHRlcl9yZWplY3Q7Cj4gPiA+ID4gKyAgICBwYXJzZXItPmRldmljZV9kaXNjb25uZWN0X2Fja19m
dW5jID0gdXNicmVkaXJfZGV2aWNlX2Rpc2Nvbm5lY3RfYWNrOwo+ID4gPiA+ICsgICAgcGFyc2Vy
LT5pbnRlcmZhY2VfaW5mb19mdW5jID0gdXNicmVkaXJfaW50ZXJmYWNlX2luZm87Cj4gPiA+ID4g
KyAgICBwYXJzZXItPmVwX2luZm9fZnVuYyA9IHVzYnJlZGlyX2ludGVyZmFjZV9lcF9pbmZvOwo+
ID4gPiA+ICsgICAgcGFyc2VyLT5maWx0ZXJfZmlsdGVyX2Z1bmMgPSB1c2JyZWRpcl9maWx0ZXJf
ZmlsdGVyOwo+ID4gPiA+ICsKPiA+ID4gPiArICAgIHJldHVybiBwYXJzZXI7Cj4gPiA+ID4gK30K
PiA+ID4gPiArCj4gPiA+ID4gK3N0YXRpYyBnYm9vbGVhbiBhdHRhY2hfZWRldihTcGljZVVzYkJh
Y2tlbmRDaGFubmVsICpjaCwKPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNw
aWNlVXNiQmFja2VuZERldmljZSAqZGV2LAo+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgR0Vycm9yICoqZXJyb3IpCj4gPiA+ID4gK3sKPiA+ID4gPiArICAgIGlmICghZGV2LT5l
ZGV2KSB7Cj4gPiA+ID4gKyAgICAgICAgZ19zZXRfZXJyb3IoZXJyb3IsIFNQSUNFX0NMSUVOVF9F
UlJPUiwKPiA+ID4gPiBTUElDRV9DTElFTlRfRVJST1JfRkFJTEVELAo+ID4gPiA+ICsgICAgICAg
ICAgIF8oIkZhaWxlZCB0byByZWRpcmVjdCBkZXZpY2UgJWQiKSwgMSk7Cj4gPiA+Cj4gPiA+IE1p
bm9yOiBJIHdvdWxkIHNheSBtb3JlIGFuIGFzc2VydCBsZXZlbCBlcnJvciwgdGhlIGRldmljZSBz
aG91bGQgYmUgcmVhbCBvcgo+ID4gPiBlbXVsYXRlZC4KPiA+ID4KPiA+ID4gPiArICAgICAgICBy
ZXR1cm4gRkFMU0U7Cj4gPiA+ID4gKyAgICB9Cj4gPiA+ID4gKyAgICBpZiAoY2gtPnVzYnJlZGly
aG9zdCAmJiAhY2gtPmhlbGxvX2RvbmVfcGFyc2VyKSB7Cj4gPiA+ID4gKyAgICAgICAgLyoKPiA+
ID4gPiArICAgICAgICAgICAgd2UgY2FuJ3QgaW5pdGlhbGl6ZSBwYXJzZXIgdW50aWwgd2Ugc2Vl
IGhlbGxvIGZyb20gdXNicmVkaXIKPiA+ID4gPiArICAgICAgICAgICAgYW5kIHRoZSBwYXJzZXIg
Y2FuJ3Qgd29yayB1bnRpbCBpdCBzZWVzIHRoZSBoZWxsbyByZXNwb25zZS4KPiA+ID4gPiArICAg
ICAgICAgICAgdGhpcyBpcyBjYXNlIG9mIGF1dG9jb25uZWN0IHdoZW4gZW11bGF0ZWQgZGV2aWNl
IGlzIGF0dGFjaGVkCj4gPiA+ID4gKyAgICAgICAgICAgIGJlZm9yZSB0aGUgY2hhbm5lbCBpcyB1
cAo+ID4gPiA+ICsgICAgICAgICovCj4gPiA+ID4gKyAgICAgICAgU1BJQ0VfREVCVUcoIiVzIHdh
aXRpbmcgdW50aWwgdGhlIGNoYW5uZWwgaXMgcmVhZHkiLAo+ID4gPiA+IF9fRlVOQ1RJT05fXyk7
Cj4gPiA+ID4gKwo+ID4gPiA+ICsgICAgfSBlbHNlIHsKPiA+ID4gPiArICAgICAgICBpbml0aWFs
aXplX3BhcnNlcihjaCwgY2gtPmhpZGRlbl9ob3N0ID09IE5VTEwpOwo+ID4gPiA+ICsgICAgICAg
IGNoLT51c2JyZWRpcmhvc3QgPSBOVUxMOwo+ID4gPiA+ICsgICAgICAgIGNoLT5wYXJzZXIgPSBj
aC0+aGlkZGVuX3BhcnNlcjsKPiA+ID4gPiArICAgIH0KPiA+ID4gPiArICAgIGNoLT53YWl0X2Rp
c2NfYWNrID0gMDsKPiA+ID4gPiArICAgIGNoLT5hdHRhY2hlZCA9IGRldjsKPiA+ID4gPiArICAg
IGRldi0+YXR0YWNoZWRfdG8gPSBjaDsKPiA+ID4gPiArICAgIGRldmljZV9vcHMoZGV2LT5lZGV2
KS0+YXR0YWNoKGRldi0+ZWRldiwgY2gtPmhpZGRlbl9wYXJzZXIpOwo+ID4gPiA+ICsgICAgaWYg
KGNoLT5oZWxsb19kb25lX3BhcnNlcikgewo+ID4gPiA+ICsgICAgICAgIC8qIHNlbmQgZGV2aWNl
IGluZm8gKi8KPiA+ID4gPiArICAgICAgICB1c2JyZWRpcl9oZWxsbyhjaCwgTlVMTCk7Cj4gPiA+
ID4gKyAgICB9Cj4gPiA+ID4gKyAgICByZXR1cm4gVFJVRTsKPiA+ID4gPiArfQo+ID4gPiA+ICsK
PiA+ID4gPiAgZ2Jvb2xlYW4gc3BpY2VfdXNiX2JhY2tlbmRfY2hhbm5lbF9hdHRhY2goU3BpY2VV
c2JCYWNrZW5kQ2hhbm5lbCAqY2gsCj4gPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIFNwaWNlVXNiQmFja2VuZERldmljZSAqZGV2LAo+ID4gPiA+ICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBHRXJyb3IgKiplcnJvcikKPiA+
ID4gPiBAQCAtNzA2LDcgKzEyMTMsMTMgQEAgZ2Jvb2xlYW4KPiA+ID4gPiBzcGljZV91c2JfYmFj
a2VuZF9jaGFubmVsX2F0dGFjaChTcGljZVVzYkJhY2tlbmRDaGFubmVsICpjaCwKPiA+ID4gPgo+
ID4gPiA+ICAgICAgZ19yZXR1cm5fdmFsX2lmX2ZhaWwoZGV2ICE9IE5VTEwsIEZBTFNFKTsKPiA+
ID4gPgo+ID4gPiA+ICsgICAgaWYgKCFkZXYtPmxpYnVzYl9kZXZpY2UpIHsKPiA+ID4gPiArICAg
ICAgICByZXR1cm4gYXR0YWNoX2VkZXYoY2gsIGRldiwgZXJyb3IpOwo+ID4gPiA+ICsgICAgfQo+
ID4gPiA+ICsKPiA+ID4gPiAgICAgIGxpYnVzYl9kZXZpY2VfaGFuZGxlICpoYW5kbGUgPSBOVUxM
Owo+ID4gPiA+ICsgICAgY2gtPnVzYnJlZGlyaG9zdCA9IGNoLT5oaWRkZW5faG9zdDsKPiA+ID4g
PiArICAgIGNoLT5wYXJzZXIgPSBOVUxMOwo+ID4gPiA+Cj4gPiA+ID4gICAgICAvKgo+ID4gPiA+
ICAgICAgICAgVW5kZXIgV2luZG93cyB3ZSBuZWVkIHRvIGF2b2lkIHVwZGF0aW5nCj4gPiA+ID4g
QEAgLTc0MCwxOCArMTI1MywzMyBAQCBnYm9vbGVhbgo+ID4gPiA+IHNwaWNlX3VzYl9iYWNrZW5k
X2NoYW5uZWxfYXR0YWNoKFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmNoLAo+ID4gPiA+Cj4gPiA+
ID4gIHZvaWQgc3BpY2VfdXNiX2JhY2tlbmRfY2hhbm5lbF9kZXRhY2goU3BpY2VVc2JCYWNrZW5k
Q2hhbm5lbCAqY2gpCj4gPiA+ID4gIHsKPiA+ID4gPiArICAgIFNwaWNlVXNiQmFja2VuZERldmlj
ZSAqZCA9IGNoLT5hdHRhY2hlZDsKPiA+ID4gPiArICAgIFNwaWNlVXNiRW11bGF0ZWREZXZpY2Ug
KmVkZXYgPSBkID8gZC0+ZWRldiA6IE5VTEw7Cj4gPiA+ID4gICAgICBTUElDRV9ERUJVRygiJXMg
Pj4gY2ggJXAsIHdhcyBhdHRhY2hlZCAlcCIsIF9fRlVOQ1RJT05fXywgY2gsCj4gPiA+ID4gICAg
ICBjaC0+YXR0YWNoZWQpOwo+ID4gPiA+IC0gICAgaWYgKCFjaC0+YXR0YWNoZWQpIHsKPiA+ID4g
PiArICAgIGlmICghZCkgewo+ID4gPiA+ICAgICAgICAgIFNQSUNFX0RFQlVHKCIlczogbm90aGlu
ZyB0byBkZXRhY2giLCBfX0ZVTkNUSU9OX18pOwo+ID4gPiA+ICAgICAgICAgIHJldHVybjsKPiA+
ID4gPiAgICAgIH0KPiA+ID4gPiAgICAgIGlmIChjaC0+dXNicmVkaXJob3N0KSB7Cj4gPiA+ID4g
ICAgICAgICAgLyogaXQgd2lsbCBjYWxsIGxpYnVzYl9jbG9zZSBpbnRlcm5hbGx5ICovCj4gPiA+
ID4gICAgICAgICAgdXNicmVkaXJob3N0X3NldF9kZXZpY2UoY2gtPnVzYnJlZGlyaG9zdCwgTlVM
TCk7Cj4gPiA+ID4gKyAgICB9IGVsc2UgaWYgKGNoLT5wYXJzZXIpIHsKPiA+ID4gPiArICAgICAg
ICBpZiAoZWRldikgewo+ID4gPiA+ICsgICAgICAgICAgICBkZXZpY2Vfb3BzKGVkZXYpLT5kZXRh
Y2goZWRldik7Cj4gPiA+ID4gKyAgICAgICAgfQo+ID4gPiA+ICsgICAgICAgIHVzYnJlZGlycGFy
c2VyX3NlbmRfZGV2aWNlX2Rpc2Nvbm5lY3QoY2gtPnBhcnNlcik7Cj4gPiA+ID4gKyAgICAgICAg
dXNicmVkaXJfd3JpdGVfZmx1c2hfY2FsbGJhY2soY2gpOwo+ID4gPiA+ICsgICAgICAgIGNoLT53
YWl0X2Rpc2NfYWNrID0gdXNicmVkaXJwYXJzZXJfcGVlcl9oYXNfY2FwKGNoLT5wYXJzZXIsCj4g
PiA+ID4gKwo+ID4gPiA+IHVzYl9yZWRpcl9jYXBfZGV2aWNlX2Rpc2Nvbm5lY3RfYWNrKTsKPiA+
ID4gPiArICAgICAgICBpZiAoIWNoLT53YWl0X2Rpc2NfYWNrKSB7Cj4gPiA+ID4gKyAgICAgICAg
ICAgIGNoLT51c2JyZWRpcmhvc3QgPSBjaC0+aGlkZGVuX2hvc3Q7Cj4gPiA+ID4gKyAgICAgICAg
ICAgIGNoLT5wYXJzZXIgPSBOVUxMOwo+ID4gPiA+ICsgICAgICAgIH0KPiA+ID4gPiAgICAgIH0K
PiA+ID4gPiAgICAgIFNQSUNFX0RFQlVHKCIlcyBjaCAlcCwgZGV0YWNoIGRvbmUiLCBfX0ZVTkNU
SU9OX18sIGNoKTsKPiA+ID4gPiAgICAgIGNoLT5hdHRhY2hlZC0+YXR0YWNoZWRfdG8gPSBOVUxM
Owo+ID4gPiA+ICAgICAgY2gtPmF0dGFjaGVkID0gTlVMTDsKPiA+ID4gPiArICAgIGNoLT5yZWpl
Y3RlZCA9IDA7Cj4gPiA+ID4gIH0KPiA+ID4gPgo+ID4gPiA+ICBTcGljZVVzYkJhY2tlbmRDaGFu
bmVsICpzcGljZV91c2JfYmFja2VuZF9jaGFubmVsX25ldyhTcGljZVVzYkJhY2tlbmQKPiA+ID4g
PiAgKmJlLAo+ID4gPiA+IEBAIC03NjYsMjYgKzEyOTQsMzMgQEAgU3BpY2VVc2JCYWNrZW5kQ2hh
bm5lbAo+ID4gPiA+ICpzcGljZV91c2JfYmFja2VuZF9jaGFubmVsX25ldyhTcGljZVVzYkJhY2tl
bmQgKmJlLAo+ID4gPiA+ICAgICAgY2gtPnVzZXJfZGF0YSA9IFNQSUNFX1VTQlJFRElSX0NIQU5O
RUwodXNlcl9kYXRhKTsKPiA+ID4gPiAgICAgIGlmIChiZS0+bGlidXNiX2NvbnRleHQpIHsKPiA+
ID4KPiA+ID4gVGhpcyBjYW4gbmV2ZXIgYmUgTlVMTCwgaWYgd2UgYXJlIG5vdCBhYmxlIHRvIGFs
bG9jYXRlIGl0IGluc2lkZQo+ID4gPiBzcGljZV91c2JfYmFja2VuZF9uZXcgdGhlIGZ1bmN0aW9u
IHJldHVybnMgTlVMTC4KPiA+ID4gVGhpcyBzaG91bGQgYmUgaW4gYSBwcmVsaW1pbmFyeSBwYXRj
aCB0byBtYWtlIHRoaXMgY2xlYXIuCj4gPgo+ID4gTG9va2luZyBhIGxpdHRsZSBmb3J3YXJkLCBh
ZnRlciBjZC1zaGFyaW5nIGlzIGluLCB0aGlzIGNvdWxkIGJlCj4gPiBwb3NzaWJsZSB0byBub3Qg
ZGlzYWJsZSB0aGUgcmVkaXJlY3Rpb24gaXMgdGhlcmUgaXMgbm8gdXNiZGsuCj4gPiBFdmVuIGlu
IGNhc2UgdGhlIGxpYnVzYiBkb2VzIG5vdCB3b3JrLCB0aGUgY2xpZW50IGNhbiB3b3JrIHdpdGgK
PiA+IHJlZGlyZWN0aW9uIGVuYWJsZWQgYW5kIHJlZGlyZWN0IG9ubHkgZW11bGF0ZWQgZGV2aWNl
cy4KPiA+IEkgd291bGQgbm90IHJlbW92ZSB0aGlzIGNoZWNrLgo+ID4KPgo+IFRoZSBwcm9ibGVt
IGlzIHRoYXQgY3VycmVudCBjb2RlIGhhcyBzb21lIHBhcnQgd2l0aCBvbmUgbG9naWMKPiAodXNi
IGNvbnRleHQgaXMgYWx3YXlzIGF2YWlsYWJsZSkgYW5kIHNvbWUgb3RoZXIgcGFydCBvZiBjb2Rl
Cj4gd2l0aCB0aGUgb3Bwb3NpdGUgbG9naWMgKHVzYiBjb250ZXh0IGlzIG5vdCByZXF1aXJlZCku
Cj4KPiBsaWJ1c2Igd29ya3MgYWxzbyB3aXRob3V0IHVzYmRrIGluc3RhbGxlZCBhbmQgcHJvdmlk
ZXMgYQo+IHZhbGlkIChub3QgTlVMTCkgdXNiIGNvbnRleHQuCgpJZiBJJ20gbm90IG1pc3Rha2Vu
LCB0aGlzIGlzIHRydWUgb25seSB3aXRoIGxhdGVzdCBsaWJ1c2IgKHdoaWNoCnN1cHBvcnRzIFdp
blVTQiBhbmQgVXNiRGspLgpXaXRoIHByZXZpb3VzIGxpYnVzYiB3aGljaCBpcyBidWlsdCBmb3Ig
VXNiRGssIHRoZSBjb250ZXh0IGNhbid0IGJlCmluaXRpYWxpemVkIHdpdGhvdXQgVXNiRGsuCgo+
Cj4gPiA+Cj4gPiA+ID4gICAgICAgICAgY2gtPmJhY2tlbmQgPSBiZTsKPiA+ID4gPiAtICAgICAg
ICBjaC0+dXNicmVkaXJob3N0ID0gdXNicmVkaXJob3N0X29wZW5fZnVsbCgKPiA+ID4gPiAtICAg
ICAgICAgICAgYmUtPmxpYnVzYl9jb250ZXh0LAo+ID4gPiA+IC0gICAgICAgICAgICBOVUxMLAo+
ID4gPiA+IC0gICAgICAgICAgICB1c2JyZWRpcl9sb2csCj4gPiA+ID4gLSAgICAgICAgICAgIHVz
YnJlZGlyX3JlYWRfY2FsbGJhY2ssCj4gPiA+ID4gLSAgICAgICAgICAgIHVzYnJlZGlyX3dyaXRl
X2NhbGxiYWNrLAo+ID4gPiA+IC0gICAgICAgICAgICB1c2JyZWRpcl93cml0ZV9mbHVzaF9jYWxs
YmFjaywKPiA+ID4gPiAtICAgICAgICAgICAgdXNicmVkaXJfYWxsb2NfbG9jaywKPiA+ID4gPiAt
ICAgICAgICAgICAgdXNicmVkaXJfbG9ja19sb2NrLAo+ID4gPiA+IC0gICAgICAgICAgICB1c2Jy
ZWRpcl91bmxvY2tfbG9jaywKPiA+ID4gPiAtICAgICAgICAgICAgdXNicmVkaXJfZnJlZV9sb2Nr
LAo+ID4gPiA+IC0gICAgICAgICAgICBjaCwgUEFDS0FHRV9TVFJJTkcsCj4gPiA+ID4gLSAgICAg
ICAgICAgIHNwaWNlX3V0aWxfZ2V0X2RlYnVnKCkgPyB1c2JyZWRpcnBhcnNlcl9kZWJ1ZyA6Cj4g
PiA+ID4gdXNicmVkaXJwYXJzZXJfd2FybmluZywKPiA+ID4gPiAtICAgICAgICAgICAgdXNicmVk
aXJob3N0X2ZsX3dyaXRlX2NiX293bnNfYnVmZmVyKTsKPiA+ID4gPiArICAgICAgICBjaC0+dXNi
cmVkaXJob3N0ID0KPiA+ID4gPiArICAgICAgICAgICAgdXNicmVkaXJob3N0X29wZW5fZnVsbChi
ZS0+bGlidXNiX2NvbnRleHQsCj4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgTlVMTCwKPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1
c2JyZWRpcl9sb2csCj4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
dXNicmVkaXJfcmVhZF9jYWxsYmFjaywKPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICB1c2JyZWRpcl93cml0ZV9jYWxsYmFjaywKPiA+ID4gPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICB1c2JyZWRpcl93cml0ZV9mbHVzaF9jYWxsYmFjaywKPiA+
ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2JyZWRpcl9hbGxvY19s
b2NrLAo+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzYnJlZGly
X2xvY2tfbG9jaywKPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1
c2JyZWRpcl91bmxvY2tfbG9jaywKPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB1c2JyZWRpcl9mcmVlX2xvY2ssCj4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgY2gsIFBBQ0tBR0VfU1RSSU5HLAo+ID4gPiA+ICsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHNwaWNlX3V0aWxfZ2V0X2RlYnVnKCkgPwo+ID4gPiA+IHVz
YnJlZGlycGFyc2VyX2RlYnVnIDoKPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHVzYnJlZGlycGFyc2VyX3dhcm5pbmcsCj4gPiA+ID4gKwo+ID4gPiA+IHVz
YnJlZGlyaG9zdF9mbF93cml0ZV9jYl9vd25zX2J1ZmZlcik7Cj4gPiA+ID4gICAgICAgICAgZ193
YXJuX2lmX2ZhaWwoY2gtPnVzYnJlZGlyaG9zdCAhPSBOVUxMKTsKPiA+ID4gPiAgICAgIH0KPiA+
ID4gPiArCj4gPiA+ID4gICAgICBpZiAoY2gtPnVzYnJlZGlyaG9zdCkgewo+ID4gPiA+IC0gICAg
ICAgIHVzYnJlZGlyaG9zdF9zZXRfYnVmZmVyZWRfb3V0cHV0X3NpemVfY2IoY2gtPnVzYnJlZGly
aG9zdCwKPiA+ID4gPiB1c2JyZWRpcl9idWZmZXJlZF9vdXRwdXRfc2l6ZV9jYWxsYmFjayk7Cj4g
PiA+ID4gLSAgICB9IGVsc2Ugewo+ID4gPiA+IC0gICAgICAgIGdfZnJlZShjaCk7Cj4gPiA+ID4g
KyAgICAgICAgY2gtPmhpZGRlbl9wYXJzZXIgPSBjcmVhdGVfcGFyc2VyKGNoKTsKPiA+ID4gPiAr
ICAgICAgICBjaC0+aGlkZGVuX2hvc3QgPSBjaC0+dXNicmVkaXJob3N0Owo+ID4gPiA+ICsgICAg
ICAgIHVzYnJlZGlyaG9zdF9zZXRfYnVmZmVyZWRfb3V0cHV0X3NpemVfY2IoY2gtPnVzYnJlZGly
aG9zdCwKPiA+ID4gPiArCj4gPiA+ID4gdXNicmVkaXJfYnVmZmVyZWRfb3V0cHV0X3NpemVfY2Fs
bGJhY2spOwo+Cj4gSGVyZSB5b3UgYXJlIGFzc3VtaW5nIHRoYXQgdXNiIGNvbnRleHQgaXMgbm90
IE5VTEwgd2hpY2ggZG9lcyBub3QKPiBtYXRjaCB3aXRoIHlvdXIgc3RhdGVtZW50IGFib3ZlLgo+
Cj4gPiA+ID4gKyAgICB9Cj4gPiA+ID4gKwo+ID4gPiA+ICsgICAgaWYgKCFjaC0+aGlkZGVuX3Bh
cnNlcikgewo+ID4gPiA+ICsgICAgICAgIHNwaWNlX3VzYl9iYWNrZW5kX2NoYW5uZWxfZGVsZXRl
KGNoKTsKPiA+ID4gPiAgICAgICAgICBjaCA9IE5VTEw7Cj4gPiA+ID4gICAgICB9Cj4gPiA+ID4K
PiA+ID4gPiBAQCAtNzk1LDkgKzEzMzAsMTQgQEAgU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbAo+ID4g
PiA+ICpzcGljZV91c2JfYmFja2VuZF9jaGFubmVsX25ldyhTcGljZVVzYkJhY2tlbmQgKmJlLAo+
ID4gPiA+Cj4gPiA+ID4gIHZvaWQgc3BpY2VfdXNiX2JhY2tlbmRfY2hhbm5lbF9mbHVzaF93cml0
ZXMoU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCAqY2gpCj4gPiA+ID4gIHsKPiA+ID4gPiAtICAgIFNQ
SUNFX0RFQlVHKCIlcyAlcCwgaG9zdCAlcCIsIF9fRlVOQ1RJT05fXywgY2gsIGNoLT51c2JyZWRp
cmhvc3QpOwo+ID4gPiA+ICsgICAgU1BJQ0VfREVCVUcoIiVzICVwIGlzIHVwIiwgX19GVU5DVElP
Tl9fLCBjaCk7Cj4gPiA+ID4gICAgICBpZiAoY2gtPnVzYnJlZGlyaG9zdCkgewo+ID4gPiA+ICAg
ICAgICAgIHVzYnJlZGlyaG9zdF93cml0ZV9ndWVzdF9kYXRhKGNoLT51c2JyZWRpcmhvc3QpOwo+
ID4gPiA+ICsgICAgICAgIGluaXRpYWxpemVfcGFyc2VyKGNoLCBGQUxTRSk7Cj4gPiA+ID4gKyAg
ICB9IGVsc2Ugewo+ID4gPiA+ICsgICAgICAgIGluaXRpYWxpemVfcGFyc2VyKGNoLCBUUlVFKTsK
PiA+ID4KPiA+ID4gV2h5IGluaXRpYWxpemVfcGFyc2UgaXMgY2FsbGVkIGhlcmU/Cj4gPgo+ID4g
VGhpcyBpcyB0aGUgZGVjaXNpb24gcG9pbnQgd2hldGhlciBwYXJzZXIgd29ya3Mgd2l0aCBoZWxs
bz1vbiBvciBub3QKPiA+Cj4KPiBBbmQgc28gaWYgdGhpcyBjaGFubmVsIHN1cHBvcnQgb25seSBl
bXVsYXRlZCBkZXZpY2VzIHdoaWNoIGlzIGEKPiByZWdyZXNzaW9uLgoKVGhlcmUgaXMgbm8gcmVn
cmVzc2lvbi4KQXQgdGhpcyBzcGVjaWZpYyBwb2ludCAoaW4gdGhpcyBjb3JuZXIgY2FzZSBmbG93
LCBiZWNhdXNlIHdlIGp1c3Qgc2VuZApvdXIgY2FwYWJpbGl0aWVzKSB0aGlzIGNoYW5uZWwgc3Vw
cG9ydHMgb25seSBlbXVsYXRlZCBkZXZpY2UgYmVjYXVzZQp0aGUgZW11bGF0ZWQgZGV2aWNlIGlz
IGF0dGFjaGVkLgpTdHJpY3RseSBzcGVha2luZywgaXQgZG9lcyBub3Qgc3VwcG9ydCBldmVuIGVt
dWxhdGVkIGRldmljZXMgYXMgd2UgZGlkCm5vdCByZWNlaXZlIHRoZSBoZWxsbyByZXNwb25zZSB5
ZXQuCkl0IGRvZXMgbm90IG5lZWQgdG8gc3VwcG9ydCBsb2NhbCBkZXZpY2UgX2JlZm9yZV8gdGhl
IGxvY2FsIGRldmljZSBpcyBhdHRhY2hlZC4KVG93YXJkIHRoZSBtb21lbnQgd2hlbiBsb2NhbCBk
ZXZpY2UgaXMgYXR0YWNoZWQgdGhlIGhlbGxvIHJlc3BvbnNlCndpbGwgYmUgcHJvdmlkZWQgdG8g
dGhlIHVzYnJlZGlyaG9zdCBhbmQgaXQgd2lsbCBzdXBwb3J0IHByb3Blcmx5IHRoZQpsb2NhbCBk
ZXZpY2UgYWxzby4KCj4KPiA+ID4KPiA+ID4gPiArICAgICAgICBjaC0+cGFyc2VyID0gY2gtPmhp
ZGRlbl9wYXJzZXI7Cj4gPiA+ID4gKyAgICAgICAgdXNicmVkaXJwYXJzZXJfZG9fd3JpdGUoY2gt
PnBhcnNlcik7Cj4gPiA+ID4gICAgICB9Cj4gPiA+ID4gIH0KPiA+ID4gPgo+ID4gPiA+IEBAIC04
MDcsMTIgKzEzNDcsMTYgQEAgdm9pZAo+ID4gPiA+IHNwaWNlX3VzYl9iYWNrZW5kX2NoYW5uZWxf
ZGVsZXRlKFNwaWNlVXNiQmFja2VuZENoYW5uZWwgKmNoKQo+ID4gPiA+ICAgICAgaWYgKCFjaCkg
ewo+ID4gPiA+ICAgICAgICAgIHJldHVybjsKPiA+ID4gPiAgICAgIH0KPiA+ID4gPiAtICAgIGlm
IChjaC0+dXNicmVkaXJob3N0KSB7Cj4gPiA+ID4gLSAgICAgICAgdXNicmVkaXJob3N0X2Nsb3Nl
KGNoLT51c2JyZWRpcmhvc3QpOwo+ID4gPiA+ICsgICAgaWYgKGNoLT5oaWRkZW5faG9zdCkgewo+
ID4gPiA+ICsgICAgICAgIHVzYnJlZGlyaG9zdF9jbG9zZShjaC0+aGlkZGVuX2hvc3QpOwo+ID4g
PiA+ICsgICAgfQo+ID4gPiA+ICsgICAgaWYgKGNoLT5oaWRkZW5fcGFyc2VyKSB7Cj4gPiA+ID4g
KyAgICAgICAgdXNicmVkaXJwYXJzZXJfZGVzdHJveShjaC0+aGlkZGVuX3BhcnNlcik7Cj4gPiA+
ID4gICAgICB9Cj4gPiA+ID4KPiA+ID4gPiAgICAgIGlmIChjaC0+cnVsZXMpIHsKPiA+ID4gPiAt
ICAgICAgICBnX2ZyZWUoY2gtPnJ1bGVzKTsKPiA+ID4gPiArICAgICAgICAvKiBydWxlcyB3ZXJl
IGFsbG9jYXRlZCBieSB1c2JyZWRpcnBhcnNlciAqLwo+ID4gPiA+ICsgICAgICAgIGZyZWUoY2gt
PnJ1bGVzKTsKPiA+ID4KPiA+ID4gTWlub3IgOkkgc3VwcG9zZSB0aGlzIHNtYWxsIGNoYW5nZSBj
YW4gZ28gdG8gYSBwcmVsaW1pbmFyeSBwYXRjaCB0b28KPiA+Cj4gPiBUaGlzIGNvZGUgd2FzIGhl
cmUgYmVmb3JlLCBidXQgaXQgd2FzIG5ldmVyIHVzZWQgYXMgY2gtPnJ1bGVzIHdhcwo+ID4gbmV2
ZXIgYXNzaWduZWQuCj4gPgo+Cj4geWVzCj4KPiA+IEhvbmVzdGx5IEkgZG8gbm90IHVuZGVyc3Rh
bmQgd2hhdCB0aGlzICJwcmVsaW1pbmFyeSBwYXRjaCIgc2hvdWxkCj4gPiBjb250YWluIGFuZCB3
aGF0IGl0IGlzIGdvb2QgZm9yLgo+ID4KPgo+IEkgZG9uJ3QgdGhpbmsgaXMgYSBnb29kIGlkZWEg
dG8gYWRkIGNvZGUgd2l0aCBtdWx0aXBsZSBsb2dpYyBmb3IKPiB0aGUgc2FtZSBjb25kaXRpb24u
IEN1cnJlbnRseSBtb3N0IG9mIHRoZSBjb2RlIGFzc3VtZSB1c2IgY29udGV4dAo+IGlzIHZhbGlk
LCBJIHdvdWxkIGdvIGluIGEgc2luZ2xlIGRpcmVjdGlvbiwgbm90IGFkZGluZyBhZGRpdGlvbmFs
Cj4gY29kZSB3aXRoIDIgZGlmZmVyZW50IGxvZ2luIGFib3V0IGl0LgoKSSBzdGlsbCBkbyBub3Qg
dW5kZXJzdGFuZCB3aGF0IGlzICdwcmVsaW1pbmFyeSBwYXRjaCcsIHdoYXQgaXQgc2hvdWxkCmNv
bnRhaW4gYW5kIHdoeSBpdCBpcyBnb29kIHRvIGhhdmUgaXQuCgo+Cj4gPiA+Cj4gPiA+ID4gICAg
ICB9Cj4gPiA+ID4KPiA+ID4gPiAgICAgIGdfZnJlZShjaCk7Cj4gPiA+Cj4gPiA+IEZyZWRpYW5v
Cj4gPgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpTcGlj
ZS1kZXZlbCBtYWlsaW5nIGxpc3QKU3BpY2UtZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0
dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vc3BpY2UtZGV2ZWw=
