Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 1CE087AB62
	for <lists+spice-devel@lfdr.de>; Tue, 30 Jul 2019 16:49:26 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 08D4B6E2A9;
	Tue, 30 Jul 2019 14:49:24 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mail-io1-xd32.google.com (mail-io1-xd32.google.com
 [IPv6:2607:f8b0:4864:20::d32])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 8804C8979E
 for <spice-devel@lists.freedesktop.org>; Tue, 30 Jul 2019 14:49:22 +0000 (UTC)
Received: by mail-io1-xd32.google.com with SMTP id k8so128721863iot.1
 for <spice-devel@lists.freedesktop.org>; Tue, 30 Jul 2019 07:49:22 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc;
 bh=CNtKUbzrE2qN3UqWq1j0uuO0tByefi7HbRvfXfZBRBM=;
 b=anYTxylfcqRBHBfGqBryyrAJ0Duf+CBBT4YzbXT2M2Ix9baHeM9qWSDDseTRNvHLF8
 2R+DO85h3EPl2n6mWfW8Jd6uJYG1qNsKd98bLa1uGI73hquln4RH55AEC9J83Uz8wc0Y
 TC4JCxUYJYARa0Np5CLbMwslUD9LK7SYkd9/KyajhlUmY/ZofgCcHHQCn2rjx5XZFJAh
 Ghxo2sa8FzVxY7KD/2qgiq0FXkPUbvrcyuzR99/o4dgVgmnu+cM0dpjlS2MU5+UgKd0+
 ZQSKW6HObz5xWaExRdVnAQpogi6NqPKCooAns5LJcwTIkBa1stdt5kU7L7UUGruXonej
 kIrA==
X-Gm-Message-State: APjAAAXDiCYetU0BQCNWVJDSN7cBBuXRNXYUwL/FJ9yMfI8mv8nVCHWh
 QIGSvyqQkEAOUrIK/ujGFAZlkKqouTJGGo7OcenHgWAV
X-Google-Smtp-Source: APXvYqwpmuWfTqaYzubUByKxD0jYZPjnxHsFcgR35LFvHDqsi0DeGM2GntfcLNdSVrTlRpG/HNOB0aKHE0PIvqKiISc=
X-Received: by 2002:a6b:b214:: with SMTP id b20mr51871325iof.149.1564498161544; 
 Tue, 30 Jul 2019 07:49:21 -0700 (PDT)
MIME-Version: 1.0
References: <20190724105351.13753-1-yuri.benditovich@daynix.com>
 <20190724105351.13753-9-yuri.benditovich@daynix.com>
 <1039725951.3474044.1564483429122.JavaMail.zimbra@redhat.com>
 <CAOEp5OfDHLcfLL4z7QtH7iUvB3Ldk+ASZjkyVevAgr6rm5C0Uw@mail.gmail.com>
 <1522914548.3511381.1564495193504.JavaMail.zimbra@redhat.com>
In-Reply-To: <1522914548.3511381.1564495193504.JavaMail.zimbra@redhat.com>
From: Yuri Benditovich <yuri.benditovich@daynix.com>
Date: Tue, 30 Jul 2019 17:49:07 +0300
Message-ID: <CAOEp5Oc=Y5Ya_oVqhSH9ymwH-FoFxU_m13NdWN-uKdxCswz-KQ@mail.gmail.com>
To: Frediano Ziglio <fziglio@redhat.com>
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=daynix-com.20150623.gappssmtp.com; s=20150623;
 h=mime-version:references:in-reply-to:from:date:message-id:subject:to
 :cc;
 bh=CNtKUbzrE2qN3UqWq1j0uuO0tByefi7HbRvfXfZBRBM=;
 b=aFyrFZr11DMLb1/ymjh0LsqVKBdv9/iepRvJu9RuUSQKvEFdCJjIKRh77TDpB+YKAs
 9klqgsCQbETeNQmo67QSP5B7AvP3UOYCLYarEfgHmy0sTq9UIpE3MuqdTfGpZ7pDDy7e
 jlhMxNhx7dh2JvRB64H8anO8+muZ70P5d3hPGRhg+F2i33zIbhdr63FJ+/2m6YqXOCQL
 gKwKzVJSPcbQrTHqfWUSj++iqpHXP0G5do7c7KbbYvWQs+JZrJKK6iKDvG7QkA5FAPnS
 Y40IpBYDve7fjMshCfU4Bfq6lXZV3QBKgVnbdf0oo3Tzqz8pbOLv50VNhVwrIdNZu2sf
 kr8g==
Subject: Re: [Spice-devel] [spice-gtk 8/9] usb-redir: add implementation of
 emulated CD device
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: Yan Vugenfirer <yan@daynix.com>,
 Spice List <spice-devel@lists.freedesktop.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

T24gVHVlLCBKdWwgMzAsIDIwMTkgYXQgNDo1OSBQTSBGcmVkaWFubyBaaWdsaW8gPGZ6aWdsaW9A
cmVkaGF0LmNvbT4gd3JvdGU6Cj4KPiA+Cj4gPiBPbiBUdWUsIEp1bCAzMCwgMjAxOSBhdCAxOjQz
IFBNIEZyZWRpYW5vIFppZ2xpbyA8ZnppZ2xpb0ByZWRoYXQuY29tPiB3cm90ZToKPiA+ID4KPiA+
ID4gPgo+ID4gPiA+IFRoaXMgbW9kdWxlIGNvbnRhaW5zIGltcGxlbWVudGF0aW9uIG9mIGVtdWxh
dGVkIGRldmljZQo+ID4gPiA+IGludGVyZmFjZSBmb3Igc2hhcmVkIENELgo+ID4gPiA+Cj4gPiA+
ID4gU2lnbmVkLW9mZi1ieTogWXVyaSBCZW5kaXRvdmljaCA8eXVyaS5iZW5kaXRvdmljaEBkYXlu
aXguY29tPgo+ID4gPiA+IC0tLQo+ID4gPiA+ICBzcmMvdXNiLWRldmljZS1jZC5jIHwgNzk0ICsr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrCj4gPiA+ID4gIDEgZmls
ZSBjaGFuZ2VkLCA3OTQgaW5zZXJ0aW9ucygrKQo+ID4gPiA+ICBjcmVhdGUgbW9kZSAxMDA2NDQg
c3JjL3VzYi1kZXZpY2UtY2QuYwo+ID4gPiA+Cj4gPiA+ID4gZGlmZiAtLWdpdCBhL3NyYy91c2It
ZGV2aWNlLWNkLmMgYi9zcmMvdXNiLWRldmljZS1jZC5jCj4gPiA+ID4gbmV3IGZpbGUgbW9kZSAx
MDA2NDQKPiA+ID4gPiBpbmRleCAwMDAwMDAwLi4xOGRiY2VhCj4gPiA+ID4gLS0tIC9kZXYvbnVs
bAo+ID4gPiA+ICsrKyBiL3NyYy91c2ItZGV2aWNlLWNkLmMKPiA+ID4gPiBAQCAtMCwwICsxLDc5
NCBAQAo+ID4gPiA+ICsvKiAtKi0gTW9kZTogQzsgYy1iYXNpYy1vZmZzZXQ6IDQ7IGluZGVudC10
YWJzLW1vZGU6IG5pbCAtKi0gKi8KPiA+ID4gPiArLyoKPiA+ID4gPiArICAgIENvcHlyaWdodCAo
QykgMjAxOSBSZWQgSGF0LCBJbmMuCj4gPiA+ID4gKwo+ID4gPiA+ICsgICAgUmVkIEhhdCBBdXRo
b3JzOgo+ID4gPiA+ICsgICAgWXVyaSBCZW5kaXRvdmljaDx5YmVuZGl0b0ByZWRoYXQuY29tPgo+
ID4gPiA+ICsKPiA+ID4gPiArICAgIFRoaXMgbGlicmFyeSBpcyBmcmVlIHNvZnR3YXJlOyB5b3Ug
Y2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IKPiA+ID4gPiArICAgIG1vZGlmeSBpdCB1bmRlciB0
aGUgdGVybXMgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKPiA+ID4gPiArICAgIExp
Y2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhl
cgo+ID4gPiA+ICsgICAgdmVyc2lvbiAyLjEgb2YgdGhlIExpY2Vuc2UsIG9yIChhdCB5b3VyIG9w
dGlvbikgYW55IGxhdGVyIHZlcnNpb24uCj4gPiA+ID4gKwo+ID4gPiA+ICsgICAgVGhpcyBsaWJy
YXJ5IGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCj4g
PiA+ID4gKyAgICBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1w
bGllZCB3YXJyYW50eSBvZgo+ID4gPiA+ICsgICAgTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1Mg
Rk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZSBHTlUKPiA+ID4gPiArICAgIExlc3Nl
ciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCj4gPiA+ID4gKwo+ID4g
PiA+ICsgICAgWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIExlc3Nl
ciBHZW5lcmFsIFB1YmxpYwo+ID4gPiA+ICsgICAgTGljZW5zZSBhbG9uZyB3aXRoIHRoaXMgbGli
cmFyeTsgaWYgbm90LCBzZWUKPiA+ID4gPiA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4u
Cj4gPiA+ID4gKyovCj4gPiA+ID4gKwo+ID4gPiA+ICsjaW5jbHVkZSAiY29uZmlnLmgiCj4gPiA+
ID4gKwo+ID4gPiA+ICsjaWZkZWYgVVNFX1VTQlJFRElSCj4gPiA+ID4gKwo+ID4gPiA+ICsjaW5j
bHVkZSA8Z2xpYi1vYmplY3QuaD4KPiA+ID4gPiArI2luY2x1ZGUgPGludHR5cGVzLmg+Cj4gPiA+
ID4gKyNpbmNsdWRlIDxnaW8vZ2lvLmg+Cj4gPiA+ID4gKyNpbmNsdWRlIDxnbGliL2dpMThuLWxp
Yi5oPgo+ID4gPiA+ICsjaW5jbHVkZSA8ZXJybm8uaD4KPiA+ID4gPiArI2luY2x1ZGUgPGxpYnVz
Yi5oPgo+ID4gPiA+ICsjaW5jbHVkZSA8ZmNudGwuaD4KPiA+ID4gPiArCj4gPiA+ID4gKyNpZmRl
ZiBHX09TX1dJTjMyCj4gPiA+ID4gKyNpbmNsdWRlIDx3aW5kb3dzLmg+Cj4gPiA+ID4gKyNpbmNs
dWRlIDxudGRkY2RybS5oPgo+ID4gPiA+ICsjaW5jbHVkZSA8bnRkZG1tYy5oPgo+ID4gPiA+ICsj
ZWxzZQo+ID4gPiA+ICsjaW5jbHVkZSA8c3lzL3N0YXQuaD4KPiA+ID4gPiArI2luY2x1ZGUgPHN5
cy9pb2N0bC5oPgo+ID4gPiA+ICsjaW5jbHVkZSA8bGludXgvZnMuaD4KPiA+ID4gPiArI2luY2x1
ZGUgPGxpbnV4L2Nkcm9tLmg+Cj4gPiA+ID4gKyNlbmRpZgo+ID4gPiA+ICsKPiA+ID4gPiArI2lu
Y2x1ZGUgInVzYi1lbXVsYXRpb24uaCIKPiA+ID4gPiArI2luY2x1ZGUgImNkLXVzYi1idWxrLW1z
ZC5oIgo+ID4gPiA+ICsKPiA+ID4gPiArdHlwZWRlZiBzdHJ1Y3QgU3BpY2VDZExVCj4gPiA+ID4g
K3sKPiA+ID4gPiArICAgIGNoYXIgKmZpbGVuYW1lOwo+ID4gPiA+ICsgICAgR0ZpbGUgKmZpbGVf
b2JqZWN0Owo+ID4gPiA+ICsgICAgR0ZpbGVJbnB1dFN0cmVhbSAqc3RyZWFtOwo+ID4gPiA+ICsg
ICAgdWludDY0X3Qgc2l6ZTsKPiA+ID4gPiArICAgIHVpbnQzMl90IGJsb2NrU2l6ZTsKPiA+ID4g
PiArICAgIHVpbnQzMl90IGxvYWRlZCA6IDE7Cj4gPiA+ID4gKyAgICB1aW50MzJfdCBkZXZpY2Ug
OiAxOwo+ID4gPiA+ICt9IFNwaWNlQ2RMVTsKPiA+ID4gPiArCj4gPiA+ID4gKyNkZWZpbmUgTUFY
X0xVTl9QRVJfREVWSUNFICAgICAgICAgICAgICAxCj4gPiA+ID4gKyNkZWZpbmUgVVNCMl9CQ0Qg
ICAgICAgICAgICAgICAgICAgICAgICAweDIwMAo+ID4gPiA+ICsjZGVmaW5lIENEX0RFVl9WSUQg
ICAgICAgICAgICAgICAgICAgICAgMHgyYjIzCj4gPiA+ID4gKyNkZWZpbmUgQ0RfREVWX1BJRCAg
ICAgICAgICAgICAgICAgICAgICAweENEQ0QKPiA+ID4KPiA+ID4gV2hlcmUgdGhlc2UgdmFsdWVz
IGNhbWU/IExhdGVyIHlvdSBhcmUgc3RhdGluZyB2ZW5kb3IKPiA+ID4gaXMgIlJlZCBIYXQiIGJ1
dCBSZWQgSGF0IGlzIDB4MWIzNiBhbmQgUXVtcmFuZXQgaXMgMHgxYWY0Lgo+ID4gPiBBcmUgdGhl
c2UgdGVtcG9yYXJ5IHZhbHVlcz8KPiA+Cj4gPiBJIHN1cHBvc2UgeW91IG1lYW4gUENJIHZlbmRv
ciBJRHMuIFVTQiBvbmUgY29tZSBmcm9tIGFub3RoZXIgc291cmNlLgo+ID4gaHR0cHM6Ly9idWd6
aWxsYS5yZWRoYXQuY29tL3Nob3dfYnVnLmNnaT9pZD0xMTMyMzMwCj4gPgo+Cj4gT2ssIHdvcnRo
IGEgbWVudGlvbiBmb3IgdGhlIFZJRC4KPiBBbmQgdGhlIFBJRCA/IFdhcyB0aGlzIDB4Q0RDRCBy
ZWdpc3RlcmVkIHNvbWVob3c/CgpOb3QgeWV0LiBPdXIgdG9kbyB0byBhbGxvY2F0ZSBpdCAoaW5z
aWRlIFJlZCBIYXQpLgoKPgo+ID4gPgo+ID4gPiA+ICsjZGVmaW5lIENEX0RFVl9DTEFTUyAgICAg
ICAgICAgICAgICAgICAgOAo+ID4gPiA+ICsjZGVmaW5lIENEX0RFVl9TVUJDTEFTUyAgICAgICAg
ICAgICAgICAgNgo+ID4gPiA+ICsjZGVmaW5lIENEX0RFVl9QUk9UT0NPTCAgICAgICAgICAgICAg
ICAgMHg1MAo+ID4gPiA+ICsjZGVmaW5lIENEX0RFVl9CTE9DS19TSVpFICAgICAgICAgICAgICAg
MHgyMDAKPiA+ID4KPiA+ID4gSSBkaWRuJ3QgZXhwZWN0ZWQgdGhpcy4gSSB0aG91Z2ggYWxsIENE
cyB3ZXJlIDIwNDggc2VjdG9yIHNpemVkLgo+ID4KPiA+IEFzIGZhciBhcyBJIHJlbWVtYmVyLCBJ
J3ZlIGNoZWNrZWQgdGhhdCBkdXJpbmcgZGV2ZWxvcG1lbnQsIENERlMgaGFzCj4gPiBzZWN0b3Ig
b2YgNTEyIGJ5dGVzLgo+ID4KPiA+ID4KPiA+ID4gPiArI2RlZmluZSBDRF9ERVZfTUFYX1NJWkUg
ICAgICAgICAgICAgICAgIDczNzI4MDAwMAo+ID4gPgo+ID4gPiBUaGlzIGlzIHVudXNlZC4gSSB3
b3VsZCByZW1vdmUgSSBzdXBwb3NlIERWRCBkZXZpY2VzIG9yIGltYWdlcwo+ID4gPiB3b24ndCBm
aXQgaGVyZSBhbnl3YXkuCj4gPgo+ID4gV2hlbiB0aGUgc2l6ZSBpcyBiaWdnZXIgdGhhbiByZWd1
bGFyIENEIGltYWdlLCBzZWN0b3Igc2l6ZSBpcyAySy4KPiA+IEFzIGZhciBhcyBJIHJlbWVtYmVy
LCBvdGhlciBGUyB1c2VkIGluIHRoaXMgY2FzZSAoVURGIGV0YykKPiA+IHdvbid0IGZpciB3aGVy
ZT8gVGhpcyBpcyBDRC1EVkQgcmVhZGVyLCB3ZSB1c2VkIGl0IHdpdGggbGFyZ2UgaW1hZ2VzLgo+
ID4KPgo+IEEgRFZEIGNhbiBiZSBsYXJnZXIuIEJ5IHRoZSB3YXksIHRoaXMgY29uc3RhbnQgaXMg
bm90IHVzZWQgaW4gdGhlIGNvZGUuCj4KCk9LLCB0aGlzIGlzIG15IGZhdWx0LCBpbmRlZWQgdGhl
IGNvbnN0YW50IGNhbiBiZSByZW1vdmVkIChqdXN0CmZvcmdvdHRlbiB0aGF0IEkndmUgY2hhbmdl
ZCB0aGUgbG9naWMgb2YgNTEyLzJLKS4KV2hlbiB0aGUgaW1hZ2Ugc2l6ZSBjYW4gYmUgZGl2aWRl
ZCB0byAySywgdGhlcmUgaXMgbm8gcHJvYmxlbSB0bwpyZXBvcnQgMksgc2VjdG9yLgpUaGUgcHJv
YmxlbSB3YXMgd2l0aCBzbWFsbCBpbWFnZXMgdGhhdCByZXF1aXJlIDUxMiBieXRlcy4KCj4gPiA+
Cj4gPiA+ID4gKyNkZWZpbmUgRFZEX0RFVl9CTE9DS19TSVpFICAgICAgICAgICAgICAweDgwMAo+
ID4gPiA+ICsjZGVmaW5lIE1BWF9CVUxLX0lOX1JFUVVFU1RTICAgICAgICAgICAgNjQKPiA+ID4g
PiArCj4gPiA+ID4gK3N0cnVjdCBCdWZmZXJlZEJ1bGtSZWFkCj4gPiA+ID4gK3sKPiA+ID4gPiAr
ICAgIHN0cnVjdCB1c2JfcmVkaXJfYnVsa19wYWNrZXRfaGVhZGVyIGhvdXQ7Cj4gPiA+ID4gKyAg
ICB1aW50NjRfdCBpZDsKPiA+ID4gPiArfTsKPiA+ID4gPiArCj4gPiA+ID4gK3N0cnVjdCBfU3Bp
Y2VVc2JFbXVsYXRlZERldmljZQo+ID4gPiA+ICt7Cj4gPiA+ID4gKyAgICBVc2JEZXZpY2VPcHMg
ZGV2X29wczsKPiA+ID4gPiArICAgIFNwaWNlVXNiQmFja2VuZCAqYmFja2VuZDsKPiA+ID4gPiAr
ICAgIFNwaWNlVXNiQmFja2VuZERldmljZSAqcGFyZW50Owo+ID4gPiA+ICsgICAgc3RydWN0IHVz
YnJlZGlycGFyc2VyICpwYXJzZXI7Cj4gPiA+ID4gKyAgICB2b2lkICogbXNjOwo+ID4gPiA+ICsg
ICAgU3BpY2VDZExVIHVuaXRzW01BWF9MVU5fUEVSX0RFVklDRV07Cj4gPiA+ID4gKyAgICBnYm9v
bGVhbiBsb2NrZWQ7Cj4gPiA+ID4gKyAgICBnYm9vbGVhbiBkZWxldGVfb25fZWplY3Q7Cj4gPiA+
ID4gKyAgICBnYm9vbGVhbiBkZWxldGluZzsKPiA+ID4gPiArICAgIHVpbnQzMl90IG51bV9yZWFk
czsKPiA+ID4gPiArICAgIHN0cnVjdCBCdWZmZXJlZEJ1bGtSZWFkIHJlYWRfYnVsa1tNQVhfQlVM
S19JTl9SRVFVRVNUU107Cj4gPiA+ID4gKyAgICB1aW50MTZfdCBzZXJpYWxbNF07Cj4gPiA+Cj4g
PiA+IFNwZWNpZmljYXRpb25zIHN0YXRlIHRoYXQgc2VyaWFsIHNob3VsZCBiZSBhdCBsZWFzdCAx
MiBjaGFyYWN0ZXJzLgo+ID4KPiA+IFdoaWNoIHNwZWNpZmljYXRpb24/IEkgZG8gbm90IHJlbWVt
YmVyIGluIFVTQiBzcGVjIHN1Y2ggcmVxdWlyZW1lbnQuCj4gPgo+Cj4gaHR0cHM6Ly93d3cudXNi
Lm9yZy9zaXRlcy9kZWZhdWx0L2ZpbGVzL3VzYm1hc3NidWxrXzEwLnBkZgoKSW5kZWVkLiBXb3J0
aCB0byBjaGFuZ2UuCgoKPgo+ID4gPgo+ID4gPiA+ICsgICAgdWludDhfdCAgbWF4X2x1bl9pbmRl
eDsKPiA+ID4gPiArfTsKPiA+ID4gPiArCj4gPiA+ID4gK3R5cGVkZWYgU3BpY2VVc2JFbXVsYXRl
ZERldmljZSBVc2JDZDsKPiA+ID4gPiArCj4gPiA+ID4gKyNpZm5kZWYgR19PU19XSU4zMgo+ID4g
PiA+ICsKPiA+ID4gPiArc3RhdGljIGludCBjZF9kZXZpY2Vfb3Blbl9zdHJlYW0oU3BpY2VDZExV
ICp1bml0LCBjb25zdCBjaGFyICpmaWxlbmFtZSkKPiA+ID4gPiArewo+ID4gPiA+ICsgICAgaW50
IGVycm9yID0gMDsKPiA+ID4gPiArICAgIHVuaXQtPmRldmljZSA9IDA7Cj4gPiA+ID4gKwo+ID4g
PiA+ICsgICAgaWYgKCF1bml0LT5maWxlbmFtZSAmJiAhZmlsZW5hbWUpIHsKPiA+ID4gPiArICAg
ICAgICBTUElDRV9ERUJVRygiJXM6IGZpbGUgbmFtZSBub3QgcHJvdmlkZWQiLCBfX0ZVTkNUSU9O
X18pOwo+ID4gPiA+ICsgICAgICAgIHJldHVybiAtMTsKPiA+ID4gPiArICAgIH0KPiA+ID4gPiAr
ICAgIGlmICh1bml0LT5maWxlbmFtZSAmJiBmaWxlbmFtZSkgewo+ID4gPiA+ICsgICAgICAgIGdf
ZnJlZSh1bml0LT5maWxlbmFtZSk7Cj4gPiA+ID4gKyAgICAgICAgdW5pdC0+ZmlsZW5hbWUgPSBO
VUxMOwo+ID4gPiA+ICsgICAgfQo+ID4gPiA+ICsgICAgaWYgKGZpbGVuYW1lKSB7Cj4gPiA+ID4g
KyAgICAgICAgdW5pdC0+ZmlsZW5hbWUgPSBnX3N0cmR1cChmaWxlbmFtZSk7Cj4gPiA+ID4gKyAg
ICB9Cj4gPiA+ID4gKwo+ID4gPiA+ICsgICAgaW50IGZkID0gb3Blbih1bml0LT5maWxlbmFtZSwg
T19SRE9OTFkgfCBPX05PTkJMT0NLKTsKPiA+ID4gPiArICAgIGlmIChmZCA+IDApIHsKPiA+ID4g
PiArICAgICAgICBzdHJ1Y3Qgc3RhdCBmaWxlX3N0YXQgPSB7IDAgfTsKPiA+ID4gPiArICAgICAg
ICBpZiAoZnN0YXQoZmQsICZmaWxlX3N0YXQpIHx8IGZpbGVfc3RhdC5zdF9zaXplID09IDApIHsK
PiA+ID4gPiArICAgICAgICAgICAgZmlsZV9zdGF0LnN0X3NpemUgPSAwOwo+ID4gPiA+ICsgICAg
ICAgICAgICB1bml0LT5kZXZpY2UgPSAxOwo+ID4gPiA+ICsgICAgICAgICAgICBpZiAoIWlvY3Rs
KGZkLCBCTEtHRVRTSVpFNjQsICZmaWxlX3N0YXQuc3Rfc2l6ZSkgJiYKPiA+ID4gPiArICAgICAg
ICAgICAgICAgICFpb2N0bChmZCwgQkxLU1NaR0VULCAmdW5pdC0+YmxvY2tTaXplKSkgewo+ID4g
PiA+ICsgICAgICAgICAgICB9Cj4gPiA+ID4gKyAgICAgICAgfQo+ID4gPiA+ICsgICAgICAgIHVu
aXQtPnNpemUgPSBmaWxlX3N0YXQuc3Rfc2l6ZTsKPiA+ID4gPiArICAgICAgICBjbG9zZShmZCk7
Cj4gPiA+ID4gKyAgICAgICAgaWYgKHVuaXQtPnNpemUpIHsKPiA+ID4gPiArICAgICAgICAgICAg
dW5pdC0+ZmlsZV9vYmplY3QgPSBnX2ZpbGVfbmV3X2Zvcl9wYXRoKHVuaXQtPmZpbGVuYW1lKTsK
PiA+ID4gPiArICAgICAgICAgICAgdW5pdC0+c3RyZWFtID0gZ19maWxlX3JlYWQodW5pdC0+Zmls
ZV9vYmplY3QsIE5VTEwsIE5VTEwpOwo+ID4gPiA+ICsgICAgICAgIH0KPiA+ID4gPiArICAgICAg
ICBpZiAoIXVuaXQtPnN0cmVhbSkgewo+ID4gPiA+ICsgICAgICAgICAgICBTUElDRV9ERUJVRygi
JXM6IGNhbid0IG9wZW4gc3RyZWFtIG9uICVzIiwgX19GVU5DVElPTl9fLAo+ID4gPiA+IHVuaXQt
PmZpbGVuYW1lKTsKPiA+ID4gPiArICAgICAgICAgICAgZ19vYmplY3RfdW5yZWYodW5pdC0+Zmls
ZV9vYmplY3QpOwo+ID4gPiA+ICsgICAgICAgICAgICB1bml0LT5maWxlX29iamVjdCA9IE5VTEw7
Cj4gPiA+ID4gKyAgICAgICAgICAgIGVycm9yID0gLTE7Cj4gPiA+ID4gKyAgICAgICAgfQo+ID4g
PiA+ICsgICAgfQo+ID4gPiA+ICsgICAgZWxzZSB7Cj4gPiA+ID4gKyAgICAgICAgU1BJQ0VfREVC
VUcoIiVzOiBjYW4ndCBvcGVuIGZpbGUgJXMiLCBfX0ZVTkNUSU9OX18sCj4gPiA+ID4gdW5pdC0+
ZmlsZW5hbWUpOwo+ID4gPiA+ICsgICAgICAgIGVycm9yID0gLTE7Cj4gPiA+ID4gKyAgICB9Cj4g
PiA+ID4gKwo+ID4gPiA+ICsgICAgcmV0dXJuIGVycm9yOwo+ID4gPiA+ICt9Cj4gPiA+ID4gKwo+
ID4gPiA+ICtzdGF0aWMgaW50IGNkX2RldmljZV9sb2FkKFNwaWNlQ2RMVSAqdW5pdCwgZ2Jvb2xl
YW4gbG9hZCkKPiA+ID4gPiArewo+ID4gPiA+ICsgICAgaW50IGVycm9yOwo+ID4gPiA+ICsgICAg
aWYgKCF1bml0LT5kZXZpY2UgfHwgIXVuaXQtPmZpbGVuYW1lKSB7Cj4gPiA+ID4gKyAgICAgICAg
cmV0dXJuIC0xOwo+ID4gPiA+ICsgICAgfQo+ID4gPiA+ICsgICAgaW50IGZkID0gb3Blbih1bml0
LT5maWxlbmFtZSwgT19SRE9OTFkgfCBPX05PTkJMT0NLKTsKPiA+ID4gPiArICAgIGlmIChmZCA8
IDApIHsKPiA+ID4gPiArICAgICAgICByZXR1cm4gLTE7Cj4gPiA+ID4gKyAgICB9Cj4gPiA+ID4g
KyAgICBpZiAobG9hZCkgewo+ID4gPiA+ICsgICAgICAgIGVycm9yID0gaW9jdGwoZmQsIENEUk9N
Q0xPU0VUUkFZLCAwKTsKPiA+ID4gPiArICAgIH0gZWxzZSB7Cj4gPiA+ID4gKyAgICAgICAgZXJy
b3IgPSBpb2N0bChmZCwgQ0RST01fTE9DS0RPT1IsIDApOwo+ID4gPiA+ICsgICAgICAgIGVycm9y
ID0gaW9jdGwoZmQsIENEUk9NRUpFQ1QsIDApOwo+ID4gPiA+ICsgICAgfQo+ID4gPiA+ICsgICAg
aWYgKGVycm9yKSB7Cj4gPiA+ID4gKyAgICAgICAgLy8gbm90ZSB0aGF0IGVqZWN0aW5nIG1pZ2h0
IGJlIGF2YWlsYWJsZSBvbmx5IGZvciByb290Cj4gPiA+ID4gKyAgICAgICAgLy8gbG9hZGluZyBt
aWdodCBiZSBhdmFpbGFibGUgYWxzbyBmb3IgcmVndWxhciB1c2VyCj4gPiA+ID4gKyAgICAgICAg
U1BJQ0VfREVCVUcoIiVzOiBjYW4ndCAlc2xvYWQgJXMsIHJlcyAlZCwgZXJybm8gJWQiLAo+ID4g
PiA+ICsgICAgICAgICAgICBfX0ZVTkNUSU9OX18sIGxvYWQgPyAiIiA6ICJ1biIsIHVuaXQtPmZp
bGVuYW1lLCBlcnJvciwKPiA+ID4gPiBlcnJubyk7Cj4gPiA+ID4gKyAgICB9Cj4gPiA+ID4gKyAg
ICBjbG9zZShmZCk7Cj4gPiA+ID4gKyAgICByZXR1cm4gZXJyb3I7Cj4gPiA+ID4gK30KPiA+ID4g
PiArCj4gPiA+ID4gK3N0YXRpYyBpbnQgY2RfZGV2aWNlX2NoZWNrKFNwaWNlQ2RMVSAqdW5pdCkK
PiA+ID4gPiArewo+ID4gPiA+ICsgICAgaW50IGVycm9yOwo+ID4gPiA+ICsgICAgaWYgKCF1bml0
LT5kZXZpY2UgfHwgIXVuaXQtPmZpbGVuYW1lKSB7Cj4gPiA+ID4gKyAgICAgICAgcmV0dXJuIC0x
Owo+ID4gPiA+ICsgICAgfQo+ID4gPiA+ICsgICAgaW50IGZkID0gb3Blbih1bml0LT5maWxlbmFt
ZSwgT19SRE9OTFkgfCBPX05PTkJMT0NLKTsKPiA+ID4gPiArICAgIGlmIChmZCA8IDApIHsKPiA+
ID4gPiArICAgICAgICByZXR1cm4gLTE7Cj4gPiA+ID4gKyAgICB9Cj4gPiA+ID4gKyAgICBlcnJv
ciA9IGlvY3RsKGZkLCBDRFJPTV9EUklWRV9TVEFUVVMsIDApOwo+ID4gPiA+ICsgICAgZXJyb3Ig
PSAoZXJyb3IgPT0gQ0RTX0RJU0NfT0spID8gMCA6IC0xOwo+ID4gPiA+ICsgICAgaWYgKCFlcnJv
cikgewo+ID4gPiA+ICsgICAgICAgIGVycm9yID0gaW9jdGwoZmQsIENEUk9NX0RJU0NfU1RBVFVT
LCAwKTsKPiA+ID4gPiArICAgICAgICBlcnJvciA9IChlcnJvciA9PSBDRFNfREFUQV8xKSA/IDAg
OiAtMTsKPiA+ID4gPiArICAgIH0KPiA+ID4gPiArICAgIGNsb3NlKGZkKTsKPiA+ID4gPiArICAg
IHJldHVybiBlcnJvcjsKPiA+ID4gPiArfQo+ID4gPiA+ICsKPiA+ID4gPiArI2Vsc2UKPiA+ID4g
PiArCj4gPiA+ID4gK3N0YXRpYyBnYm9vbGVhbiBpc19kZXZpY2VfbmFtZShjb25zdCBjaGFyICpm
aWxlbmFtZSkKPiA+ID4gPiArewo+ID4gPiA+ICsgICAgZ2Jvb2xlYW4gYiA9IHN0cmxlbihmaWxl
bmFtZSkgPT0gMiAmJiBmaWxlbmFtZVsxXSA9PSAnOic7Cj4gPiA+ID4gKyAgICByZXR1cm4gYjsK
PiA+ID4KPiA+ID4gSGVyZSAiOjoiIG9yICIwOiIgYXJlIGFjY2VwdGVkLiBJIGhhdmUgYSBmb2xs
b3cgdXAgZm9yIHRoaXMuCj4gPiA+Cj4gPiA+ID4gK30KPiA+ID4gPiArCj4gPiA+ID4gK3N0YXRp
YyBIQU5ETEUgb3Blbl9maWxlKGNvbnN0IGNoYXIgKmZpbGVuYW1lKQo+ID4gPiA+ICt7Cj4gPiA+
ID4gKyAgICBIQU5ETEUgaCA9IENyZWF0ZUZpbGVBKGZpbGVuYW1lLAo+ID4gPgo+ID4gPiBNaW5v
ciBidXQgbWF5YmUgd2Ugd2FudCB0byBjb252ZXJ0IGZyb20gdXRmOCAodXN1YWxseSB1c2VkIGJ5
Cj4gPiA+IEdMaWIpIHRvIHV0ZjE2IGFuZCB1c2UgQ3JlYXRlRmlsZVcuCj4gPiA+Cj4gPiA+ID4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgIEdFTkVSSUNfUkVBRCwKPiA+ID4gPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgRklMRV9TSEFSRV9SRUFEIHwgRklMRV9TSEFSRV9XUklURSwK
PiA+ID4KPiA+ID4gVGhpcyB3aWxsIGFsbG93IG90aGVyIHByb2dyYW0gdG8gY2hhbmdlIHRoZSBJ
U08gd2hpbGUgdGhlIHByb2dyYW0gaXMKPiA+ID4gcnVubmluZy4gSXMgdGhpcyB3YW50ZWQ/IEkg
a25vdyBpdCdzIGNvbXBhdGlibGUgd2l0aCBVbml4IHNvbWVob3cgYnV0Cj4gPiA+IEkgdGhpbmsg
dXN1YWxseSBvbiBXaW5kb3dzIHlvdSBkb24ndCBleHBlY3QgdGhpcy4KPiA+ID4gQnV0IGhvbmVz
dGx5IGlzIGp1c3QgYSBtaW5vci4KPiA+ID4KPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgTlVMTCwgT1BFTl9FWElTVElORywKPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgMCwKPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgTlVMTCk7Cj4gPiA+
ID4gKyAgICBpZiAoaCA9PSBJTlZBTElEX0hBTkRMRV9WQUxVRSkgewo+ID4gPiA+ICsgICAgICAg
IGggPSBOVUxMOwo+ID4gPiA+ICsgICAgfQo+ID4gPiA+ICsgICAgcmV0dXJuIGg7Cj4gPiA+ID4g
K30KPiA+ID4gPiArCj4gPiA+ID4gK3N0YXRpYyB1aW50MzJfdCBpb2N0bF9vdXQoSEFORExFIGgs
IHVpbnQzMl90IGNvZGUsIHZvaWQgKm91dF9idWZmZXIsCj4gPiA+ID4gdWludDMyX3Qgb3V0X3Np
emUpCj4gPiA+ID4gK3sKPiA+ID4gPiArICAgIHVpbnQzMl90IGVycm9yOwo+ID4gPiA+ICsgICAg
RFdPUkQgcmV0Owo+ID4gPiA+ICsgICAgQk9PTCBiID0gRGV2aWNlSW9Db250cm9sKGgsIGNvZGUs
IE5VTEwsIDAsIG91dF9idWZmZXIsIG91dF9zaXplLAo+ID4gPiA+ICZyZXQsCj4gPiA+ID4gTlVM
TCk7Cj4gPiA+ID4gKyAgICBlcnJvciA9IGIgPyAwIDogR2V0TGFzdEVycm9yKCk7Cj4gPiA+ID4g
KyAgICByZXR1cm4gZXJyb3I7Cj4gPiA+ID4gK30KPiA+ID4gPiArCj4gPiA+ID4gK3N0YXRpYyB1
aW50MzJfdCBpb2N0bF9ub25lKEhBTkRMRSBoLCB1aW50MzJfdCBjb2RlKQo+ID4gPiA+ICt7Cj4g
PiA+ID4gKyAgICByZXR1cm4gaW9jdGxfb3V0KGgsIGNvZGUsIE5VTEwsIDApOwo+ID4gPiA+ICt9
Cj4gPiA+ID4gKwo+ID4gPiA+ICtzdGF0aWMgZ2Jvb2xlYW4gY2hlY2tfZGV2aWNlKEhBTkRMRSBo
KQo+ID4gPiA+ICt7Cj4gPiA+ID4gKyAgICBHRVRfQ09ORklHVVJBVElPTl9JT0NUTF9JTlBVVCBj
ZmdJbiA9Cj4gPiA+ID4gKyAgICAgICAgeyBGZWF0dXJlQ2RSZWFkLCBTQ1NJX0dFVF9DT05GSUdV
UkFUSU9OX1JFUVVFU1RfVFlQRV9BTEwsIHt9IH07Cj4gPiA+ID4gKyAgICBEV09SRCByZXQ7Cj4g
PiA+ID4gKyAgICBHRVRfQ09ORklHVVJBVElPTl9IRUFERVIgY2ZnT3V0Owo+ID4gPiA+ICsgICAg
cmV0dXJuIERldmljZUlvQ29udHJvbChoLCBJT0NUTF9DRFJPTV9HRVRfQ09ORklHVVJBVElPTiwK
PiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgJmNmZ0luLCBzaXplb2YoY2ZnSW4p
LCAmY2ZnT3V0LAo+ID4gPiA+IHNpemVvZihjZmdPdXQpLAo+ID4gPiA+ICsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAmcmV0LCBOVUxMKTsKPiA+ID4gPiArfQo+ID4gPiA+ICsKPiA+ID4gPiAr
c3RhdGljIGludCBjZF9kZXZpY2Vfb3Blbl9zdHJlYW0oU3BpY2VDZExVICp1bml0LCBjb25zdCBj
aGFyICpmaWxlbmFtZSkKPiA+ID4gPiArewo+ID4gPiA+ICsgICAgaW50IGVycm9yID0gMDsKPiA+
ID4gPiArICAgIEhBTkRMRSBoOwo+ID4gPiA+ICsgICAgdW5pdC0+ZGV2aWNlID0gMDsKPiA+ID4g
PiArICAgIGlmICghdW5pdC0+ZmlsZW5hbWUgJiYgIWZpbGVuYW1lKSB7Cj4gPiA+ID4gKyAgICAg
ICAgU1BJQ0VfREVCVUcoIiVzOiB1bm5hbWVkIGZpbGUiLCBfX0ZVTkNUSU9OX18pOwo+ID4gPiA+
ICsgICAgICAgIHJldHVybiAtMTsKPiA+ID4gPiArICAgIH0KPiA+ID4gPiArICAgIGlmICh1bml0
LT5maWxlbmFtZSAmJiBmaWxlbmFtZSkgewo+ID4gPiA+ICsgICAgICAgIGdfZnJlZSh1bml0LT5m
aWxlbmFtZSk7Cj4gPiA+ID4gKyAgICAgICAgdW5pdC0+ZmlsZW5hbWUgPSBOVUxMOwo+ID4gPiA+
ICsgICAgfQo+ID4gPiA+ICsgICAgaWYgKCFmaWxlbmFtZSkgewo+ID4gPiA+ICsgICAgICAgIC8v
IHJlb3BlbmluZyB0aGUgc3RyZWFtIG9uIGV4aXN0aW5nIGZpbGUgbmFtZQo+ID4gPiA+ICsgICAg
fSBlbHNlIGlmIChpc19kZXZpY2VfbmFtZShmaWxlbmFtZSkpIHsKPiA+ID4gPiArICAgICAgICB1
bml0LT5maWxlbmFtZSA9IGdfc3RyZHVwX3ByaW50ZigiXFxcXC5cXCVzIiwgZmlsZW5hbWUpOwo+
ID4gPiA+ICsgICAgfSBlbHNlIHsKPiA+ID4gPiArICAgICAgICB1bml0LT5maWxlbmFtZSA9IGdf
c3RyZHVwKGZpbGVuYW1lKTsKPiA+ID4gPiArICAgIH0KPiA+ID4gPiArICAgIGggPSBvcGVuX2Zp
bGUodW5pdC0+ZmlsZW5hbWUpOwo+ID4gPiA+ICsgICAgaWYgKGgpIHsKPiA+ID4gPiArICAgICAg
ICBMQVJHRV9JTlRFR0VSIHNpemUgPSB7IDAgfTsKPiA+ID4gPiArICAgICAgICBpZiAoIUdldEZp
bGVTaXplRXgoaCwgJnNpemUpKSB7Cj4gPiA+ID4gKyAgICAgICAgICAgIHVpbnQ2NF90IGJ1ZmZl
clsyNTZdOwo+ID4gPiA+ICsgICAgICAgICAgICB1aW50MzJfdCByZXM7Cj4gPiA+ID4gKyAgICAg
ICAgICAgIHVuaXQtPmRldmljZSA9IGNoZWNrX2RldmljZShoKTsKPiA+ID4gPiArICAgICAgICAg
ICAgU1BJQ0VfREVCVUcoIiVzOiBDRCBkZXZpY2UgJXNyZWNvZ25pemVkIG9uICVzIiwKPiA+ID4g
PiArICAgICAgICAgICAgICAgIF9fRlVOQ1RJT05fXywgdW5pdC0+ZGV2aWNlID8gIiIgOiAiTk9U
ICIsCj4gPiA+ID4gdW5pdC0+ZmlsZW5hbWUpOwo+ID4gPiA+ICsgICAgICAgICAgICByZXMgPSBp
b2N0bF9vdXQoaCwgSU9DVExfRElTS19HRVRfRFJJVkVfR0VPTUVUUllfRVgsCj4gPiA+ID4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBidWZmZXIsIHNpemVvZihidWZmZXIpKTsKPiA+ID4g
PiArICAgICAgICAgICAgaWYgKCFyZXMpCj4gPiA+ID4gKyAgICAgICAgICAgIHsKPiA+ID4gPiAr
ICAgICAgICAgICAgICAgIERJU0tfR0VPTUVUUllfRVggKnBnID0gKERJU0tfR0VPTUVUUllfRVgg
KilidWZmZXI7Cj4gPiA+ID4gKyAgICAgICAgICAgICAgICB1bml0LT5ibG9ja1NpemUgPSBwZy0+
R2VvbWV0cnkuQnl0ZXNQZXJTZWN0b3I7Cj4gPiA+ID4gKyAgICAgICAgICAgICAgICBzaXplID0g
cGctPkRpc2tTaXplOwo+ID4gPiA+ICsgICAgICAgICAgICB9IGVsc2Ugewo+ID4gPiA+ICsgICAg
ICAgICAgICAgICAgU1BJQ0VfREVCVUcoIiVzOiBjYW4ndCBvYnRhaW4gc2l6ZSBvZiAlcyAoZXJy
b3IgJXUpIiwKPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICBfX0ZVTkNUSU9OX18sIHVuaXQt
PmZpbGVuYW1lLCByZXMpOwo+ID4gPiA+ICsgICAgICAgICAgICB9Cj4gPiA+ID4gKyAgICAgICAg
fQo+ID4gPiA+ICsgICAgICAgIHVuaXQtPnNpemUgPSBzaXplLlF1YWRQYXJ0Owo+ID4gPiA+ICsg
ICAgICAgIENsb3NlSGFuZGxlKGgpOwo+ID4gPiA+ICsgICAgICAgIGlmICh1bml0LT5zaXplKSB7
Cj4gPiA+ID4gKyAgICAgICAgICAgIHVuaXQtPmZpbGVfb2JqZWN0ID0gZ19maWxlX25ld19mb3Jf
cGF0aCh1bml0LT5maWxlbmFtZSk7Cj4gPiA+ID4gKyAgICAgICAgICAgIHVuaXQtPnN0cmVhbSA9
IGdfZmlsZV9yZWFkKHVuaXQtPmZpbGVfb2JqZWN0LCBOVUxMLCBOVUxMKTsKPiA+ID4gPiArICAg
ICAgICB9Cj4gPiA+ID4gKyAgICAgICAgaWYgKCF1bml0LT5zdHJlYW0pIHsKPiA+ID4gPiArICAg
ICAgICAgICAgU1BJQ0VfREVCVUcoIiVzOiBjYW4ndCBvcGVuIHN0cmVhbSBvbiAlcyIsIF9fRlVO
Q1RJT05fXywKPiA+ID4gPiB1bml0LT5maWxlbmFtZSk7Cj4gPiA+ID4gKyAgICAgICAgICAgIGdf
b2JqZWN0X3VucmVmKHVuaXQtPmZpbGVfb2JqZWN0KTsKPiA+ID4gPiArICAgICAgICAgICAgdW5p
dC0+ZmlsZV9vYmplY3QgPSBOVUxMOwo+ID4gPiA+ICsgICAgICAgICAgICBlcnJvciA9IC0xOwo+
ID4gPiA+ICsgICAgICAgIH0KPiA+ID4gPiArICAgIH0gZWxzZSB7Cj4gPiA+ID4gKyAgICAgICAg
U1BJQ0VfREVCVUcoIiVzOiBjYW4ndCBvcGVuIGZpbGUgJXMiLCBfX0ZVTkNUSU9OX18sCj4gPiA+
ID4gdW5pdC0+ZmlsZW5hbWUpOwo+ID4gPiA+ICsgICAgICAgIGVycm9yID0gLTE7Cj4gPiA+ID4g
KyAgICB9Cj4gPiA+ID4gKyAgICByZXR1cm4gZXJyb3I7Cj4gPiA+ID4gK30KPiA+ID4gPiArCj4g
PiA+ID4gK3N0YXRpYyBpbnQgY2RfZGV2aWNlX2xvYWQoU3BpY2VDZExVICp1bml0LCBnYm9vbGVh
biBsb2FkKQo+ID4gPiA+ICt7Cj4gPiA+ID4gKyAgICBpbnQgZXJyb3IgPSAwOwo+ID4gPiA+ICsg
ICAgSEFORExFIGg7Cj4gPiA+ID4gKyAgICBpZiAoIXVuaXQtPmRldmljZSB8fCAhdW5pdC0+Zmls
ZW5hbWUpIHsKPiA+ID4gPiArICAgICAgICByZXR1cm4gLTE7Cj4gPiA+ID4gKyAgICB9Cj4gPiA+
ID4gKyAgICBoID0gb3Blbl9maWxlKHVuaXQtPmZpbGVuYW1lKTsKPiA+ID4gPiArICAgIGlmICho
KSB7Cj4gPiA+ID4gKyAgICAgICAgdWludDMyX3QgcmVzID0gaW9jdGxfbm9uZShoLCBsb2FkID8g
SU9DVExfU1RPUkFHRV9MT0FEX01FRElBIDoKPiA+ID4gPiBJT0NUTF9TVE9SQUdFX0VKRUNUX01F
RElBKTsKPiA+ID4gPiArICAgICAgICBpZiAocmVzKSB7Cj4gPiA+ID4gKyAgICAgICAgICAgIFNQ
SUNFX0RFQlVHKCIlczogY2FuJ3QgJXNsb2FkICVzLCB3aW4gZXJyb3IgJXUiLAo+ID4gPiA+ICsg
ICAgICAgICAgICAgICAgICAgICAgICBfX0ZVTkNUSU9OX18sIGxvYWQgPyAiIiA6ICJ1biIsIHVu
aXQtPmZpbGVuYW1lLAo+ID4gPiA+IHJlcyk7Cj4gPiA+ID4gKyAgICAgICAgICAgIGVycm9yID0g
LTE7Cj4gPiA+ID4gKyAgICAgICAgfSBlbHNlIHsKPiA+ID4gPiArICAgICAgICAgICAgU1BJQ0Vf
REVCVUcoIiVzOiBkZXZpY2UgJXMgWyVzXSIsCj4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAg
ICAgIF9fRlVOQ1RJT05fXywgbG9hZCA/ICJsb2FkZWQiIDogImVqZWN0ZWQiLAo+ID4gPiA+IHVu
aXQtPmZpbGVuYW1lKTsKPiA+ID4gPiArICAgICAgICB9Cj4gPiA+ID4gKyAgICAgICAgQ2xvc2VI
YW5kbGUoaCk7Cj4gPiA+ID4gKyAgICB9Cj4gPiA+ID4gKyAgICByZXR1cm4gZXJyb3I7Cj4gPiA+
ID4gK30KPiA+ID4gPiArCj4gPiA+ID4gK3N0YXRpYyBpbnQgY2RfZGV2aWNlX2NoZWNrKFNwaWNl
Q2RMVSAqdW5pdCkKPiA+ID4gPiArewo+ID4gPiA+ICsgICAgaW50IGVycm9yID0gMDsKPiA+ID4g
PiArICAgIENEUk9NX0RJU0tfREFUQSBkYXRhOwo+ID4gPiA+ICsgICAgSEFORExFIGg7Cj4gPiA+
ID4gKyAgICBpZiAoIXVuaXQtPmRldmljZSB8fCAhdW5pdC0+ZmlsZW5hbWUpIHsKPiA+ID4gPiAr
ICAgICAgICByZXR1cm4gLTE7Cj4gPiA+ID4gKyAgICB9Cj4gPiA+ID4gKyAgICBoID0gb3Blbl9m
aWxlKHVuaXQtPmZpbGVuYW1lKTsKPiA+ID4gPiArICAgIGlmIChoKSB7Cj4gPiA+ID4gKyAgICAg
ICAgdWludDMyX3QgcmVzID0gaW9jdGxfbm9uZShoLCBJT0NUTF9TVE9SQUdFX0NIRUNLX1ZFUklG
WSk7Cj4gPiA+ID4gKyAgICAgICAgaWYgKCFyZXMpIHsKPiA+ID4gPiArICAgICAgICAgICAgcmVz
ID0gaW9jdGxfb3V0KGgsIElPQ1RMX0NEUk9NX0RJU0tfVFlQRSwgJmRhdGEsCj4gPiA+ID4gc2l6
ZW9mKGRhdGEpKTsKPiA+ID4gPiArICAgICAgICB9Cj4gPiA+ID4gKyAgICAgICAgaWYgKHJlcyAh
PSAwIHx8IGRhdGEuRGlza0RhdGEgIT0gQ0RST01fRElTS19EQVRBX1RSQUNLKSB7Cj4gPiA+ID4g
KyAgICAgICAgICAgIGVycm9yID0gLTE7Cj4gPiA+ID4gKyAgICAgICAgfQo+ID4gPiA+ICsgICAg
ICAgIENsb3NlSGFuZGxlKGgpOwo+ID4gPiA+ICsgICAgfQo+ID4gPiA+ICsgICAgcmV0dXJuIGVy
cm9yOwo+ID4gPiA+ICt9Cj4gPiA+ID4gKwo+ID4gPiA+ICsjZW5kaWYKPiA+ID4gPiArCj4gPiA+
ID4gK3N0YXRpYyBnYm9vbGVhbiBvcGVuX3N0cmVhbShTcGljZUNkTFUgKnVuaXQsIGNvbnN0IGNo
YXIgKmZpbGVuYW1lKQo+ID4gPiA+ICt7Cj4gPiA+ID4gKyAgICBnYm9vbGVhbiBiID0gRkFMU0U7
Cj4gPiA+ID4gKyAgICBiID0gY2RfZGV2aWNlX29wZW5fc3RyZWFtKHVuaXQsIGZpbGVuYW1lKSA9
PSAwOwo+ID4gPiA+ICsgICAgcmV0dXJuIGI7Cj4gPiA+ID4gK30KPiA+ID4gPiArCj4gPiA+ID4g
K3N0YXRpYyB2b2lkIGNsb3NlX3N0cmVhbShTcGljZUNkTFUgKnVuaXQpCj4gPiA+ID4gK3sKPiA+
ID4gPiArICAgIGlmICh1bml0LT5zdHJlYW0pIHsKPiA+ID4gPiArICAgICAgICBnX29iamVjdF91
bnJlZih1bml0LT5zdHJlYW0pOwo+ID4gPiA+ICsgICAgICAgIHVuaXQtPnN0cmVhbSA9IE5VTEw7
Cj4gPiA+ID4gKyAgICB9Cj4gPiA+ID4gKyAgICBpZiAodW5pdC0+ZmlsZV9vYmplY3QpIHsKPiA+
ID4gPiArICAgICAgICBnX29iamVjdF91bnJlZih1bml0LT5maWxlX29iamVjdCk7Cj4gPiA+ID4g
KyAgICAgICAgdW5pdC0+ZmlsZV9vYmplY3QgPSBOVUxMOwo+ID4gPiA+ICsgICAgfQo+ID4gPiA+
ICt9Cj4gPiA+ID4gKwo+ID4gPiA+ICtzdGF0aWMgZ2Jvb2xlYW4gbG9hZF9sdW4oVXNiQ2QgKmQs
IGludCB1bml0LCBnYm9vbGVhbiBsb2FkKQo+ID4gPiA+ICt7Cj4gPiA+ID4gKyAgICBnYm9vbGVh
biBiID0gVFJVRTsKPiA+ID4gPiArICAgIGlmIChsb2FkICYmIGQtPnVuaXRzW3VuaXRdLmRldmlj
ZSkgewo+ID4gPiA+ICsgICAgICAgIC8vIHRoZXJlIGlzIG9uZSBwb3NzaWJsZSBwcm9ibGVtIGlu
IGNhc2Ugb3VyIGJhY2tlbmQgaXMgdGhlCj4gPiA+ID4gKyAgICAgICAgLy8gbG9jYWwgQ0QgZGV2
aWNlIGFuZCBpdCBpcyBlamVjdGVkCj4gPiA+ID4gKyAgICAgICAgY2RfZGV2aWNlX2xvYWQoJmQt
PnVuaXRzW3VuaXRdLCBUUlVFKTsKPiA+ID4gPiArICAgICAgICBjbG9zZV9zdHJlYW0oJmQtPnVu
aXRzW3VuaXRdKTsKPiA+ID4gPiArICAgICAgICBpZiAoY2RfZGV2aWNlX2NoZWNrKCZkLT51bml0
c1t1bml0XSkgfHwKPiA+ID4gPiAhb3Blbl9zdHJlYW0oJmQtPnVuaXRzW3VuaXRdLCBOVUxMKSkg
ewo+ID4gPiA+ICsgICAgICAgICAgICByZXR1cm4gRkFMU0U7Cj4gPiA+ID4gKyAgICAgICAgfQo+
ID4gPiA+ICsgICAgfQo+ID4gPiA+ICsKPiA+ID4gPiArICAgIGlmIChsb2FkKSB7Cj4gPiA+ID4g
KyAgICAgICAgQ2RTY3NpTWVkaWFQYXJhbWV0ZXJzIG1lZGlhX3BhcmFtcyA9IHsgMCB9Owo+ID4g
PiA+ICsKPiA+ID4gPiArICAgICAgICBtZWRpYV9wYXJhbXMuc3RyZWFtID0gZC0+dW5pdHNbdW5p
dF0uc3RyZWFtOwo+ID4gPiA+ICsgICAgICAgIG1lZGlhX3BhcmFtcy5zaXplID0gZC0+dW5pdHNb
dW5pdF0uc2l6ZTsKPiA+ID4gPiArICAgICAgICBtZWRpYV9wYXJhbXMuYmxvY2tfc2l6ZSA9IGQt
PnVuaXRzW3VuaXRdLmJsb2NrU2l6ZTsKPiA+ID4gPiArICAgICAgICBpZiAobWVkaWFfcGFyYW1z
LmJsb2NrX3NpemUgPT0gQ0RfREVWX0JMT0NLX1NJWkUgJiYKPiA+ID4gPiArICAgICAgICAgICAg
bWVkaWFfcGFyYW1zLnNpemUgJSBEVkRfREVWX0JMT0NLX1NJWkUgPT0gMCkgewo+ID4gPiA+ICsg
ICAgICAgICAgICBtZWRpYV9wYXJhbXMuYmxvY2tfc2l6ZSA9IERWRF9ERVZfQkxPQ0tfU0laRTsK
PiA+ID4gPiArICAgICAgICB9Cj4gPiA+ID4gKyAgICAgICAgU1BJQ0VfREVCVUcoIiVzOiBsb2Fk
aW5nICVzLCBzaXplICUiIFBSSXU2NCAiLCBibG9jayAldSIsCj4gPiA+ID4gKyAgICAgICAgICAg
ICAgICAgICAgX19GVU5DVElPTl9fLCBkLT51bml0c1t1bml0XS5maWxlbmFtZSwKPiA+ID4gPiBt
ZWRpYV9wYXJhbXMuc2l6ZSwgbWVkaWFfcGFyYW1zLmJsb2NrX3NpemUpOwo+ID4gPiA+ICsKPiA+
ID4gPiArICAgICAgICBiID0gIWNkX3VzYl9idWxrX21zZF9sb2FkKGQtPm1zYywgdW5pdCwgJm1l
ZGlhX3BhcmFtcyk7Cj4gPiA+ID4gKwo+ID4gPiA+ICsgICAgICAgIGQtPnVuaXRzW3VuaXRdLmxv
YWRlZCA9ICEhYjsKPiA+ID4gPiArCj4gPiA+ID4gKyAgICB9IGVsc2Ugewo+ID4gPiA+ICsgICAg
ICAgIFNQSUNFX0RFQlVHKCIlczogdW5sb2FkaW5nICVzIiwgX19GVU5DVElPTl9fLAo+ID4gPiA+
IGQtPnVuaXRzW3VuaXRdLmZpbGVuYW1lKTsKPiA+ID4gPiArICAgICAgICBjZF91c2JfYnVsa19t
c2RfdW5sb2FkKGQtPm1zYywgdW5pdCk7Cj4gPiA+ID4gKyAgICAgICAgZC0+dW5pdHNbdW5pdF0u
bG9hZGVkID0gRkFMU0U7Cj4gPiA+ID4gKyAgICB9Cj4gPiA+ID4gKyAgICByZXR1cm4gYjsKPiA+
ID4gPiArfQo+ID4gPiA+ICsKPiA+ID4gPiArc3RhdGljIHZvaWQgdXNiX2NkX2RlbGV0ZShVc2JD
ZCAqZCkKPiA+ID4gPiArewo+ID4gPiA+ICsgICAgdWludDMyX3QgdW5pdCA9IDA7Cj4gPiA+Cj4g
PiA+IFdoeSB1bml0IGlzIGFsd2F5cyAwPyBIZXJlIGFuZCBpbiBvdGhlciBwbGFjZXMuCj4gPiA+
IE1heWJlIHdvcnRoIGFkZGluZyBhIG1uZW1vbmljPwo+ID4KPiA+IEJlY2F1c2UgY3VycmVudGx5
IHdlIGRlZmluZSB0aGUgZGV2aWNlIGFzIHNpbmdsZS11bml0Lgo+ID4gQnV0IHRoZSBjb2RlIG9m
IE1TRC9TQ1NJIGluIGdlbmVyYWwgc3VwcG9ydHMgbXVsdGlwbGUgdW5pdHMuCj4gPgo+ID4gPgo+
ID4gPiA+ICsgICAgY2RfdXNiX2J1bGtfbXNkX3VucmVhbGl6ZShkLT5tc2MsIHVuaXQpOwo+ID4g
PiA+ICsgICAgZ19jbGVhcl9wb2ludGVyKCZkLT51bml0c1t1bml0XS5maWxlbmFtZSwgZ19mcmVl
KTsKPiA+ID4gPiArICAgIGNsb3NlX3N0cmVhbSgmZC0+dW5pdHNbdW5pdF0pOwo+ID4gPiA+ICsg
ICAgZ19jbGVhcl9wb2ludGVyKCZkLT5tc2MsIGNkX3VzYl9idWxrX21zZF9mcmVlKTsKPiA+ID4g
PiArICAgIGdfZnJlZShkKTsKPiA+ID4gPiArfQo+ID4gPiA+ICsKPiA+ID4gPiArc3RhdGljIGdi
b29sZWFuIHVzYl9jZF9nZXRfZGVzY3JpcHRvcihVc2JDZCAqZCwgdWludDhfdCB0eXBlLCB1aW50
OF90Cj4gPiA+ID4gaW5kZXgsCj4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgdm9pZCAqKmJ1ZmZlciwgdWludDE2X3QgKnNpemUpCj4gPiA+ID4gK3sKPiA+ID4g
PiArICAgIHN0YXRpYyBzdHJ1Y3QgbGlidXNiX2RldmljZV9kZXNjcmlwdG9yIGRlc2MgPQo+ID4g
PiA+ICsgICAgewo+ID4gPiA+ICsgICAgICAgIC5iTGVuZ3RoID0gMTgsCj4gPiA+ID4gKyAgICAg
ICAgLmJEZXNjcmlwdG9yVHlwZSA9IExJQlVTQl9EVF9ERVZJQ0UsCj4gPiA+ID4gKyAgICAgICAg
LmJjZFVTQiA9IFVTQjJfQkNELAo+ID4gPiA+ICsgICAgICAgIC5iRGV2aWNlQ2xhc3MgPSAwLAo+
ID4gPiA+ICsgICAgICAgIC5iRGV2aWNlU3ViQ2xhc3MgPSAwLAo+ID4gPiA+ICsgICAgICAgIC5i
RGV2aWNlUHJvdG9jb2wgPSAwLAo+ID4gPiA+ICsgICAgICAgIC5iTWF4UGFja2V0U2l6ZTAgPSA2
NCwKPiA+ID4gPiArICAgICAgICAuaWRWZW5kb3IgPSBDRF9ERVZfVklELAo+ID4gPiA+ICsgICAg
ICAgIC5pZFByb2R1Y3QgPSBDRF9ERVZfUElELAo+ID4gPiA+ICsgICAgICAgIC5iY2REZXZpY2Ug
PSAweDEwMCwKPiA+ID4gPiArICAgICAgICAuaU1hbnVmYWN0dXJlciA9IDEsCj4gPiA+ID4gKyAg
ICAgICAgLmlQcm9kdWN0ID0gMiwKPiA+ID4gPiArICAgICAgICAuaVNlcmlhbE51bWJlciA9IDMs
Cj4gPiA+ID4gKyAgICAgICAgLmJOdW1Db25maWd1cmF0aW9ucyA9IDEKPiA+ID4gPiArICAgIH07
Cj4gPiA+Cj4gPiA+IFNvIGFyZSB3ZSBleHBlY3RpbmcgdGhlIGNhbGxlciB0byBiZSBhYmxlIHRv
IGNoYW5nZSB0aGVzZSBzdGF0aWMKPiA+ID4gc3RydWN0dXJlcz8KPiA+ID4gQm90aCBmdW5jdGlv
biBkZWNsYXJhdGlvbiBhbmQgZGF0YSBvbmVzIGFyZSBzdWdnZXN0aW5nIGl0Lgo+ID4gPgo+ID4g
PiA+ICsgICAgc3RhdGljIHVpbnQ4X3QgY2ZnW10gPQo+ID4gPiA+ICsgICAgewo+ID4gPiA+ICsg
ICAgICAgIDksIC8vbGVuIG9mIGNmZyBkZXNjCj4gPiA+ID4gKyAgICAgICAgTElCVVNCX0RUX0NP
TkZJRywgLy8gZGVzYyB0eXBlCj4gPiA+ID4gKyAgICAgICAgMHgyMCwgLy8gd2xlbgo+ID4gPiA+
ICsgICAgICAgIDAsCj4gPiA+ID4gKyAgICAgICAgMSwgLy8gbnVtIGlmCj4gPiA+ID4gKyAgICAg
ICAgMSwgLy8gY2ZnIHZhbAo+ID4gPiA+ICsgICAgICAgIDAsIC8vIGNmZyBuYW1lCj4gPiA+ID4g
KyAgICAgICAgMHg4MCwgLy8gYnVzIHBvd2VyZWQKPiA+ID4gPiArICAgICAgICAweDMyLCAvLyAx
MDAgbWEKPiA+ID4gPiArICAgICAgICA5LCAvLyBsZW4gb2YgSUYgZGVzYwo+ID4gPiA+ICsgICAg
ICAgIExJQlVTQl9EVF9JTlRFUkZBQ0UsCj4gPiA+ID4gKyAgICAgICAgMCwgLy8gbnVtIGlmCj4g
PiA+ID4gKyAgICAgICAgMCwgLy8gYWx0IHNldHRpbmcKPiA+ID4gPiArICAgICAgICAyLCAvLyBu
dW0gb2YgZW5kcG9pbnRzCj4gPiA+ID4gKyAgICAgICAgQ0RfREVWX0NMQVNTLAo+ID4gPiA+ICsg
ICAgICAgIENEX0RFVl9TVUJDTEFTUywKPiA+ID4gPiArICAgICAgICBDRF9ERVZfUFJPVE9DT0ws
Cj4gPiA+ID4gKyAgICAgICAgMCwgLy8gaWYgbmFtZQo+ID4gPiA+ICsgICAgICAgIDcsCj4gPiA+
ID4gKyAgICAgICAgTElCVVNCX0RUX0VORFBPSU5ULAo+ID4gPiA+ICsgICAgICAgIDB4ODEsIC8v
LT5EaXJlY3Rpb24gOiBJTiAtIEVuZHBvaW50SUQgOiAxCj4gPiA+ID4gKyAgICAgICAgMHgwMiwg
Ly8tPkJ1bGsgVHJhbnNmZXIgVHlwZQo+ID4gPiA+ICsgICAgICAgIDAsICAgIC8vd01heFBhY2tl
dFNpemUgOiAweDAyMDAgPSAweDIwMCBtYXggYnl0ZXMKPiA+ID4gPiArICAgICAgICAyLAo+ID4g
PiA+ICsgICAgICAgIDAsICAgIC8vYkludGVydmFsCj4gPiA+ID4gKyAgICAgICAgNywKPiA+ID4g
PiArICAgICAgICBMSUJVU0JfRFRfRU5EUE9JTlQsCj4gPiA+ID4gKyAgICAgICAgMHgwMiwgLy8t
PkRpcmVjdGlvbiA6IE9VVCAtIEVuZHBvaW50SUQgOiAyCj4gPiA+ID4gKyAgICAgICAgMHgwMiwg
Ly8tPkJ1bGsgVHJhbnNmZXIgVHlwZQo+ID4gPiA+ICsgICAgICAgIDAsICAgIC8vd01heFBhY2tl
dFNpemUgOiAweDAyMDAgPSAweDIwMCBtYXggYnl0ZXMKPiA+ID4gPiArICAgICAgICAyLAo+ID4g
PiA+ICsgICAgICAgIDAsICAgIC8vYkludGVydmFsCj4gPiA+ID4gKyAgICB9Owo+ID4gPiA+ICsg
ICAgc3RhdGljIHVpbnQxNl90IHMwWzJdID0geyAweDMwNCwgMHg0MDkgfTsKPiA+ID4gPiArICAg
IHN0YXRpYyB1aW50MTZfdCBzMVs4XSA9IHsgMHgzMTAsICdSJywgJ2UnLCAnZCcsICcgJywgJ0gn
LCAnYScsICd0Jwo+ID4gPiA+IH07Cj4gPiA+ID4gKyAgICBzdGF0aWMgdWludDE2X3QgczJbOV0g
PSB7IDB4MzEyLCAnUycsICdwJywgJ2knLCAnYycsICdlJywgJyAnLCAnQycsCj4gPiA+ID4gJ0Qn
Cj4gPiA+Cj4gPiA+IE1pbm9yOiB0aGVzZSB3aWxsIHdvcmsgb25seSBvbiBsaXR0bGUgZW5kaWFu
LCBub3QgYSBiaWcgaXNzdWUgYXQgdGhlIG1vbWVudAo+ID4gPiBidXQKPiA+ID4gSSBzYXcgb3Ro
ZXIgY29kZSBkZWFsaW5nIHdpdGggYmlnIGVuZGlhbiBtYWNoaW5lcy4KPiA+ID4KPiA+IEN1cnJl
bnRseSBJIGRvIG5vdCBoYXZlIGFueSBwb3NzaWJpbGl0eSB0byB0ZXN0IHRoZSBjb2RlIG9uIGJp
Zy1lbmRpYW4KPiA+IG1hY2hpbmUuCj4gPgo+ID4gPiA+IH07Cj4gPiA+ID4gKwo+ID4gPiA+ICsg
ICAgdm9pZCAqcCA9IE5VTEw7Cj4gPiA+ID4gKyAgICB1aW50MTZfdCBsZW4gPSAwOwo+ID4gPiA+
ICsKPiA+ID4gPiArICAgIHN3aXRjaCAodHlwZSkKPiA+ID4gPiArICAgIHsKPiA+ID4gPiArICAg
ICAgICBjYXNlIExJQlVTQl9EVF9ERVZJQ0U6Cj4gPiA+ID4gKyAgICAgICAgICAgIHAgPSAmZGVz
YzsKPiA+ID4gPiArICAgICAgICAgICAgbGVuID0gc2l6ZW9mKGRlc2MpOwo+ID4gPiA+ICsgICAg
ICAgICAgICBicmVhazsKPiA+ID4gPiArICAgICAgICBjYXNlIExJQlVTQl9EVF9DT05GSUc6Cj4g
PiA+ID4gKyAgICAgICAgICAgIHAgPSBjZmc7Cj4gPiA+ID4gKyAgICAgICAgICAgIGxlbiA9IHNp
emVvZihjZmcpOwo+ID4gPiA+ICsgICAgICAgICAgICBicmVhazsKPiA+ID4gPiArICAgICAgICBj
YXNlIExJQlVTQl9EVF9TVFJJTkc6Cj4gPiA+ID4gKyAgICAgICAgICAgIGlmIChpbmRleCA9PSAw
KSB7Cj4gPiA+ID4gKyAgICAgICAgICAgICAgICBwID0gczA7IGxlbiA9IHNpemVvZihzMCk7Cj4g
PiA+ID4gKyAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5kZXggPT0gMSkgewo+ID4gPiA+ICsgICAg
ICAgICAgICAgICAgcCA9IHMxOyBsZW4gPSBzaXplb2YoczEpOwo+ID4gPiA+ICsgICAgICAgICAg
ICB9IGVsc2UgaWYgKGluZGV4ID09IDIpIHsKPiA+ID4gPiArICAgICAgICAgICAgICAgIHAgPSBz
MjsgbGVuID0gc2l6ZW9mKHMyKTsKPiA+ID4gPiArICAgICAgICAgICAgfSBlbHNlIGlmIChpbmRl
eCA9PSAzKSB7Cj4gPiA+ID4gKyAgICAgICAgICAgICAgICBwID0gZC0+c2VyaWFsOyBsZW4gPSBz
aXplb2YoZC0+c2VyaWFsKTsKPiA+ID4gPiArICAgICAgICAgICAgfQo+ID4gPiA+ICsgICAgICAg
ICAgICBicmVhazsKPiA+ID4gPiArICAgIH0KPiA+ID4gPiArCj4gPiA+ID4gKyAgICBpZiAocCkg
ewo+ID4gPiA+ICsgICAgICAgICpidWZmZXIgPSBwOwo+ID4gPiA+ICsgICAgICAgICpzaXplID0g
bGVuOwo+ID4gPiA+ICsgICAgfQo+ID4gPiA+ICsKPiA+ID4gPiArICAgIHJldHVybiBwICE9IE5V
TEw7Cj4gPiA+ID4gK30KPiA+ID4gPiArCj4gPiA+ID4gK3N0YXRpYyB2b2lkIHVzYl9jZF9hdHRh
Y2goVXNiQ2QgKmRldmljZSwgc3RydWN0IHVzYnJlZGlycGFyc2VyICpwYXJzZXIpCj4gPiA+ID4g
K3sKPiA+ID4gPiArICAgIGRldmljZS0+cGFyc2VyID0gcGFyc2VyOwo+ID4gPiA+ICt9Cj4gPiA+
ID4gKwo+ID4gPiA+ICtzdGF0aWMgdm9pZCB1c2JfY2RfZGV0YWNoKFVzYkNkICpkZXZpY2UpCj4g
PiA+ID4gK3sKPiA+ID4gPiArICAgIGRldmljZS0+cGFyc2VyID0gTlVMTDsKPiA+ID4gPiArfQo+
ID4gPiA+ICsKPiA+ID4gPiArc3RhdGljIHZvaWQgdXNiX2NkX3Jlc2V0KFVzYkNkICpkZXZpY2Up
Cj4gPiA+ID4gK3sKPiA+ID4gPiArICAgIGNkX3VzYl9idWxrX21zZF9yZXNldChkZXZpY2UtPm1z
Yyk7Cj4gPiA+ID4gK30KPiA+ID4gPiArCj4gPiA+ID4gK3N0YXRpYyB2b2lkIHVzYl9jZF9jb250
cm9sX3JlcXVlc3QoVXNiQ2QgKmRldmljZSwKPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB1aW50OF90ICpkYXRhLCBpbnQgZGF0YV9sZW4sCj4gPiA+ID4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0Cj4gPiA+ID4gdXNiX3JlZGlyX2Nv
bnRyb2xfcGFja2V0X2hlYWRlcgo+ID4gPiA+ICpoLAo+ID4gPiA+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHZvaWQgKipidWZmZXIpCj4gPiA+ID4gK3sKPiA+ID4gPiArICAg
IHVpbnQ4X3QgcmVxdHlwZSA9IGgtPnJlcXVlc3R0eXBlICYgMHg3ZjsKPiA+ID4gPiArICAgIGlm
ICghZGV2aWNlLT5tc2MpIHsKPiA+ID4gPiArICAgICAgICByZXR1cm47Cj4gPiA+ID4gKyAgICB9
Cj4gPiA+ID4gKyAgICBpZiAocmVxdHlwZSA9PSAoTElCVVNCX1JFUVVFU1RfVFlQRV9TVEFOREFS
RCB8Cj4gPiA+ID4gTElCVVNCX1JFQ0lQSUVOVF9FTkRQT0lOVCkpIHsKPiA+ID4gPiArICAgICAg
ICAvLyBtaWdodCBiZSBjbGVhciBzdGFsbCByZXF1ZXN0Cj4gPiA+ID4gKyAgICAgICAgaC0+bGVu
Z3RoID0gMDsKPiA+ID4gPiArICAgICAgICBoLT5zdGF0dXMgPSB1c2JfcmVkaXJfc3VjY2Vzczs7
Cj4gPiA+ID4gKyAgICAgICAgcmV0dXJuOwo+ID4gPiA+ICsgICAgfQo+ID4gPiA+ICsKPiA+ID4g
PiArICAgIGlmIChyZXF0eXBlID09IChMSUJVU0JfUkVRVUVTVF9UWVBFX0NMQVNTIHwKPiA+ID4g
PiBMSUJVU0JfUkVDSVBJRU5UX0lOVEVSRkFDRSkpCj4gPiA+ID4gewo+ID4gPiA+ICsgICAgICAg
IHN3aXRjaCAoaC0+cmVxdWVzdCkgewo+ID4gPiA+ICsgICAgICAgICAgICBjYXNlIDB4RkY6Cj4g
PiA+ID4gKyAgICAgICAgICAgICAgICAvLyBtYXNzLXN0b3JhZ2UgY2xhc3MgcmVxdWVzdCAncmVz
ZXQnCj4gPiA+ID4gKyAgICAgICAgICAgICAgICB1c2JfY2RfcmVzZXQoZGV2aWNlKTsKPiA+ID4g
PiArICAgICAgICAgICAgICAgIGgtPmxlbmd0aCA9IDA7Cj4gPiA+ID4gKyAgICAgICAgICAgICAg
ICBoLT5zdGF0dXMgPSB1c2JfcmVkaXJfc3VjY2VzczsKPiA+ID4gPiArICAgICAgICAgICAgICAg
IGJyZWFrOwo+ID4gPiA+ICsgICAgICAgICAgICBjYXNlIDB4RkU6Cj4gPiA+ID4gKyAgICAgICAg
ICAgICAgICAvLyBtYXNzLXN0b3JhZ2UgY2xhc3MgcmVxdWVzdCAnZ2V0IG1heCBsdW4nCj4gPiA+
ID4gKyAgICAgICAgICAgICAgICAvLyByZXR1cm5pbmcgb25lIGJ5dGUKPiA+ID4gPiArICAgICAg
ICAgICAgICAgIGlmIChoLT5sZW5ndGgpIHsKPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICBo
LT5sZW5ndGggPSAxOwo+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgIGgtPnN0YXR1cyA9IHVz
Yl9yZWRpcl9zdWNjZXNzOzsKPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAqYnVmZmVyID0g
JmRldmljZS0+bWF4X2x1bl9pbmRleDsKPiA+ID4gPiArICAgICAgICAgICAgICAgIH0KPiA+ID4g
PiArICAgICAgICAgICAgICAgIGJyZWFrOwo+ID4gPiA+ICsgICAgICAgIH0KPiA+ID4gPiArICAg
IH0KPiA+ID4gPiArfQo+ID4gPiA+ICsKPiA+ID4gPiArc3RhdGljIHZvaWQgdXNiX2NkX2J1bGtf
b3V0X3JlcXVlc3QoVXNiQ2QgKmRldmljZSwKPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgdWludDhfdCBlcCwgdWludDhfdCAqZGF0YSwgaW50Cj4gPiA+ID4gZGF0
YV9sZW4sCj4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQ4
X3QgKnN0YXR1cykKPiA+ID4gPiArewo+ID4gPiA+ICsgICAgaWYgKCFjZF91c2JfYnVsa19tc2Rf
d3JpdGUoZGV2aWNlLT5tc2MsIGRhdGEsIGRhdGFfbGVuKSkgewo+ID4gPiA+ICsgICAgICAgICpz
dGF0dXMgPSB1c2JfcmVkaXJfc3VjY2VzczsKPiA+ID4gPiArICAgIH0KPiA+ID4gPiArfQo+ID4g
PiA+ICsKPiA+ID4gPiArdm9pZCBjZF91c2JfYnVsa19tc2RfcmVhZF9jb21wbGV0ZSh2b2lkICp1
c2VyX2RhdGEsCj4gPiA+ID4gKyAgICB1aW50OF90ICpkYXRhLCB1aW50MzJfdCBsZW5ndGgsIENk
VXNiQnVsa1N0YXR1cyBzdGF0dXMpCj4gPiA+ID4gK3sKPiA+ID4gPiArICAgIFVzYkNkICpkID0g
KFVzYkNkICopdXNlcl9kYXRhOwo+ID4gPiA+ICsKPiA+ID4gPiArICAgIGlmIChkLT5kZWxldGlu
Zykgewo+ID4gPiA+ICsgICAgICAgIGQtPmRlbGV0aW5nID0gRkFMU0U7Cj4gPiA+ID4gKyAgICAg
ICAgc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX2VqZWN0KGQtPmJhY2tlbmQsIGQtPnBhcmVudCk7
Cj4gPiA+Cj4gPiA+IEkgd291bGQgcGxhY2UgYSByZXR1cm4gYWZ0ZXIgdGhpcywgdGhlIHBhcmVu
dCBpcyBkZWxldGVkIGFuZCBwb3RlbnRpYWxseQo+ID4gPiBhbGwgdGhpcyBzdHJ1Y3R1cmUgdG9v
Lgo+ID4KPiA+IE5vYm9keSBpcyBkZWxldGVkLCBqdXN0IGluZGljYXRpb24gaXNzdWVkIGFuZCB0
aGUgZGVsZXRlIHdpbGwgaGFwcGVuCj4gPiBvbiBuZXh0IGlkbGUuCj4gPiBXZSBuZWVkIHRvIHJl
c3BvbmQgdGhlIFVTQiByZXF1ZXN0Lgo+ID4KPiA+ID4KPiA+ID4gPiArICAgIH0KPiA+ID4gPiAr
Cj4gPiA+ID4gKyAgICBpZiAoZC0+cGFyc2VyKSB7Cj4gPiA+ID4gKyAgICAgICAgaW50IG5yZWFk
Owo+ID4gPiA+ICsgICAgICAgIHVpbnQzMl90IG9mZnNldCA9IDA7Cj4gPiA+ID4gKwo+ID4gPiA+
ICsgICAgICAgIGZvciAobnJlYWQgPSAwOyBucmVhZCA8IGQtPm51bV9yZWFkczsgbnJlYWQrKykg
ewo+ID4gPiA+ICsgICAgICAgICAgICB1aW50MzJfdCBtYXhfbGVuOwo+ID4gPiA+ICsgICAgICAg
ICAgICBtYXhfbGVuID0gKGQtPnJlYWRfYnVsa1tucmVhZF0uaG91dC5sZW5ndGhfaGlnaCA8PCAx
NikgfAo+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICBkLT5yZWFkX2J1bGtbbnJlYWRd
LmhvdXQubGVuZ3RoOwo+ID4gPiA+ICsgICAgICAgICAgICBpZiAobWF4X2xlbiA+IGxlbmd0aCkg
ewo+ID4gPiA+ICsgICAgICAgICAgICAgICAgbWF4X2xlbiA9IGxlbmd0aDsKPiA+ID4gPiArICAg
ICAgICAgICAgICAgIGQtPnJlYWRfYnVsa1tucmVhZF0uaG91dC5sZW5ndGggPSBsZW5ndGg7Cj4g
PiA+ID4gKyAgICAgICAgICAgICAgICBkLT5yZWFkX2J1bGtbbnJlYWRdLmhvdXQubGVuZ3RoX2hp
Z2ggPSBsZW5ndGggPj4gMTY7Cj4gPiA+ID4gKyAgICAgICAgICAgIH0KPiA+ID4gPiArCj4gPiA+
ID4gKyAgICAgICAgICAgIHN3aXRjaCAoc3RhdHVzKSB7Cj4gPiA+ID4gKyAgICAgICAgICAgIGNh
c2UgQlVMS19TVEFUVVNfR09PRDoKPiA+ID4gPiArICAgICAgICAgICAgICAgIGQtPnJlYWRfYnVs
a1tucmVhZF0uaG91dC5zdGF0dXMgPSB1c2JfcmVkaXJfc3VjY2VzczsKPiA+ID4gPiArICAgICAg
ICAgICAgICAgIGJyZWFrOwo+ID4gPiA+ICsgICAgICAgICAgICBjYXNlIEJVTEtfU1RBVFVTX0NB
TkNFTEVEOgo+ID4gPiA+ICsgICAgICAgICAgICAgICAgZC0+cmVhZF9idWxrW25yZWFkXS5ob3V0
LnN0YXR1cyA9IHVzYl9yZWRpcl9jYW5jZWxsZWQ7Cj4gPiA+ID4gKyAgICAgICAgICAgICAgICBi
cmVhazsKPiA+ID4gPiArICAgICAgICAgICAgY2FzZSBCVUxLX1NUQVRVU19FUlJPUjoKPiA+ID4g
PiArICAgICAgICAgICAgICAgIGQtPnJlYWRfYnVsa1tucmVhZF0uaG91dC5zdGF0dXMgPSB1c2Jf
cmVkaXJfaW9lcnJvcjsKPiA+ID4gPiArICAgICAgICAgICAgICAgIGJyZWFrOwo+ID4gPiA+ICsg
ICAgICAgICAgICBjYXNlIEJVTEtfU1RBVFVTX1NUQUxMOgo+ID4gPiA+ICsgICAgICAgICAgICBk
ZWZhdWx0Ogo+ID4gPiA+ICsgICAgICAgICAgICAgICAgZC0+cmVhZF9idWxrW25yZWFkXS5ob3V0
LnN0YXR1cyA9IHVzYl9yZWRpcl9zdGFsbDsKPiA+ID4gPiArICAgICAgICAgICAgICAgIGJyZWFr
Owo+ID4gPiA+ICsgICAgICAgICAgICB9Cj4gPiA+ID4gKwo+ID4gPiA+ICsgICAgICAgICAgICBT
UElDRV9ERUJVRygiJXM6IHJlc3BvbmRpbmcgJSIgUFJJdTY0ICIgd2l0aCBsZW4gJXUgb3V0IG9m
Cj4gPiA+ID4gJXUsCj4gPiA+ID4gc3RhdHVzICVkIiwKPiA+ID4gPiArICAgICAgICAgICAgICAg
ICAgICAgICAgX19GVU5DVElPTl9fLCBkLT5yZWFkX2J1bGtbbnJlYWRdLmlkLCBtYXhfbGVuLAo+
ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICBsZW5ndGgsIGQtPnJlYWRfYnVsa1tucmVh
ZF0uaG91dC5zdGF0dXMpOwo+ID4gPiA+ICsgICAgICAgICAgICB1c2JyZWRpcnBhcnNlcl9zZW5k
X2J1bGtfcGFja2V0KGQtPnBhcnNlciwKPiA+ID4gPiBkLT5yZWFkX2J1bGtbbnJlYWRdLmlkLAo+
ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZkLT5y
ZWFkX2J1bGtbbnJlYWRdLmhvdXQsCj4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgbWF4X2xlbiA/IChkYXRhICsgb2Zmc2V0KSA6Cj4gPiA+ID4gTlVM
TCwKPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBt
YXhfbGVuKTsKPiA+ID4gPiArICAgICAgICAgICAgb2Zmc2V0ICs9IG1heF9sZW47Cj4gPiA+ID4g
KyAgICAgICAgICAgIGxlbmd0aCAtPSBtYXhfbGVuOwo+ID4gPiA+ICsgICAgICAgIH0KPiA+ID4g
PiArICAgICAgICBkLT5udW1fcmVhZHMgPSAwOwo+ID4gPiA+ICsgICAgICAgIHVzYnJlZGlycGFy
c2VyX2RvX3dyaXRlKGQtPnBhcnNlcik7Cj4gPiA+ID4gKwo+ID4gPiA+ICsgICAgICAgIGlmIChs
ZW5ndGgpIHsKPiA+ID4gPiArICAgICAgICAgICAgU1BJQ0VfREVCVUcoIiVzOiBFUlJPUjogJXUg
Ynl0ZXMgd2VyZSBub3QgcmVwb3J0ZWQhIiwKPiA+ID4gPiBfX0ZVTkNUSU9OX18sIGxlbmd0aCk7
Cj4gPiA+ID4gKyAgICAgICAgfQo+ID4gPiA+ICsKPiA+ID4gPiArICAgIH0gZWxzZSB7Cj4gPiA+
ID4gKyAgICAgICAgU1BJQ0VfREVCVUcoIiVzOiBicm9rZW4gZGV2aWNlPC0+Y2hhbm5lbCByZWxh
dGlvbnNoaXAhIiwKPiA+ID4gPiBfX0ZVTkNUSU9OX18pOwo+ID4gPiA+ICsgICAgfQo+ID4gPiA+
ICt9Cj4gPiA+ID4gKwo+ID4gPiA+ICsvKiBkZXZpY2UgcmVzZXQgY29tcGxldGlvbiBjYWxsYmFj
ayAqLwo+ID4gPiA+ICt2b2lkIGNkX3VzYl9idWxrX21zZF9yZXNldF9jb21wbGV0ZSh2b2lkICp1
c2VyX2RhdGEsIGludCBzdGF0dXMpCj4gPiA+ID4gK3sKPiA+ID4gPiArICAgIC8vIFVzYkNkICpk
ID0gKFVzYkNkICopdXNlcl9kYXRhOwo+ID4gPiA+ICt9Cj4gPiA+ID4gKwo+ID4gPiA+ICtzdGF0
aWMgZ2Jvb2xlYW4gdXNiX2NkX2J1bGtfaW5fcmVxdWVzdChVc2JDZCAqZCwgdWludDY0X3QgaWQs
Cj4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHVzYl9y
ZWRpcl9idWxrX3BhY2tldF9oZWFkZXIKPiA+ID4gPiAqaCkKPiA+ID4gPiArewo+ID4gPiA+ICsg
ICAgaW50IHJlczsKPiA+ID4gPiArICAgIHVpbnQzMl90IGxlbiA9IChoLT5sZW5ndGhfaGlnaCA8
PCAxNikgfCBoLT5sZW5ndGg7Cj4gPiA+ID4gKyAgICBpZiAoZC0+bnVtX3JlYWRzID49IE1BWF9C
VUxLX0lOX1JFUVVFU1RTKSB7Cj4gPiA+ID4gKyAgICAgICAgaC0+bGVuZ3RoID0gaC0+bGVuZ3Ro
X2hpZ2ggPSAwOwo+ID4gPiA+ICsgICAgICAgIFNQSUNFX0RFQlVHKCIlczogdG9vIG1hbnkgcGVu
ZGluZyByZWFkcyIsIF9fRlVOQ1RJT05fXyk7Cj4gPiA+ID4gKyAgICAgICAgaC0+c3RhdHVzID0g
dXNiX3JlZGlyX2JhYmJsZTsKPiA+ID4gPiArICAgICAgICByZXR1cm4gRkFMU0U7Cj4gPiA+ID4g
KyAgICB9Cj4gPiA+ID4gKwo+ID4gPiA+ICsgICAgaWYgKGQtPm51bV9yZWFkcykgewo+ID4gPiA+
ICsgICAgICAgIFNQSUNFX0RFQlVHKCIlczogYWxyZWFkeSBoYXMgJXUgcGVuZGluZyByZWFkcyIs
IF9fRlVOQ1RJT05fXywKPiA+ID4gPiBkLT5udW1fcmVhZHMpOwo+ID4gPiA+ICsgICAgfQo+ID4g
PiA+ICsKPiA+ID4gPiArICAgIGQtPnJlYWRfYnVsa1tkLT5udW1fcmVhZHNdLmhvdXQgPSAqaDsK
PiA+ID4gPiArICAgIGQtPnJlYWRfYnVsa1tkLT5udW1fcmVhZHNdLmlkID0gaWQ7Cj4gPiA+ID4g
KyAgICBkLT5udW1fcmVhZHMrKzsKPiA+ID4gPiArICAgIHJlcyA9IGNkX3VzYl9idWxrX21zZF9y
ZWFkKGQtPm1zYywgbGVuKTsKPiA+ID4gPiArICAgIGlmICghcmVzKSB7Cj4gPiA+ID4gKyAgICAg
ICAgcmV0dXJuIFRSVUU7Cj4gPiA+ID4gKyAgICB9Cj4gPiA+ID4gKwo+ID4gPiA+ICsgICAgU1BJ
Q0VfREVCVUcoIiVzOiBlcnJvciBvbiBidWxrIHJlYWQiLCBfX0ZVTkNUSU9OX18pOwo+ID4gPiA+
ICsgICAgZC0+bnVtX3JlYWRzLS07Cj4gPiA+ID4gKyAgICBoLT5sZW5ndGggPSBoLT5sZW5ndGhf
aGlnaCA9IDA7Cj4gPiA+ID4gKyAgICBoLT5zdGF0dXMgPSB1c2JfcmVkaXJfaW9lcnJvcjsKPiA+
ID4gPiArCj4gPiA+ID4gKyAgICByZXR1cm4gRkFMU0U7Cj4gPiA+ID4gK30KPiA+ID4gPiArCj4g
PiA+ID4gK3N0YXRpYyB2b2lkIHVzYl9jZF9jYW5jZWxfcmVxdWVzdChVc2JDZCAqZCwgdWludDY0
X3QgaWQpCj4gPiA+ID4gK3sKPiA+ID4gPiArICAgIHVpbnQzMl90IG5yZWFkOwo+ID4gPiA+ICsK
PiA+ID4gPiArICAgIGZvciAobnJlYWQgPSAwOyBucmVhZCA8IGQtPm51bV9yZWFkczsgbnJlYWQr
Kykgewo+ID4gPiA+ICsgICAgICAgIGlmIChkLT5yZWFkX2J1bGtbbnJlYWRdLmlkID09IGlkKSB7
Cj4gPiA+ID4gKyAgICAgICAgICAgIGlmIChjZF91c2JfYnVsa19tc2RfY2FuY2VsX3JlYWQoZC0+
bXNjKSkgewo+ID4gPiA+ICsgICAgICAgICAgICAgICAgY2RfdXNiX2J1bGtfbXNkX3JlYWRfY29t
cGxldGUoZCwgTlVMTCwgMCwKPiA+ID4gPiBCVUxLX1NUQVRVU19DQU5DRUxFRCk7Cj4gPiA+ID4g
KyAgICAgICAgICAgIH0KPiA+ID4gPiArICAgICAgICAgICAgcmV0dXJuOwo+ID4gPiA+ICsgICAg
ICAgIH0KPiA+ID4gPiArICAgIH0KPiA+ID4gPiArICAgIFNQSUNFX0RFQlVHKCIlczogRVJST1I6
IG5vIHN1Y2ggaWQgdG8gY2FuY2VsISIsIF9fRlVOQ1RJT05fXyk7Cj4gPiA+ID4gK30KPiA+ID4g
PiArCj4gPiA+ID4gKy8vIGNhbGxlZCB3aGVuIGEgY2hhbmdlIGhhcHBlbnMgb24gU0NTSSBsYXll
cgo+ID4gPiA+ICt2b2lkIGNkX3VzYl9idWxrX21zZF9sdW5fY2hhbmdlZCh2b2lkICp1c2VyX2Rh
dGEsIHVpbnQzMl90IGx1bikKPiA+ID4gPiArewo+ID4gPiA+ICsgICAgVXNiQ2QgKmQgPSAoVXNi
Q2QgKil1c2VyX2RhdGE7Cj4gPiA+ID4gKyAgICBDZFNjc2lEZXZpY2VJbmZvIGNkX2luZm87Cj4g
PiA+ID4gKwo+ID4gPiA+ICsgICAgaWYgKCFjZF91c2JfYnVsa19tc2RfZ2V0X2luZm8oZC0+bXNj
LCBsdW4sICZjZF9pbmZvKSkgewo+ID4gPiA+ICsgICAgICAgIC8vIGxvYWQgb3IgdW5sb2FkIGNv
bW1hbmQgcmVjZWl2ZWQgZnJvbSBTQ1NJCj4gPiA+ID4gKyAgICAgICAgaWYgKGQtPnVuaXRzW2x1
bl0ubG9hZGVkICE9IGNkX2luZm8ubG9hZGVkKSB7Cj4gPiA+ID4gKyAgICAgICAgICAgIGlmICgh
bG9hZF9sdW4oZCwgbHVuLCBjZF9pbmZvLmxvYWRlZCkpIHsKPiA+ID4gPiArICAgICAgICAgICAg
ICAgIFNQSUNFX0RFQlVHKCIlczogbG9hZCBmYWlsZWQsIHVubG9hZGluZyB1bml0IiwKPiA+ID4g
PiBfX0ZVTkNUSU9OX18pOwo+ID4gPiA+ICsgICAgICAgICAgICAgICAgY2RfdXNiX2J1bGtfbXNk
X3VubG9hZChkLT5tc2MsIGx1bik7Cj4gPiA+ID4gKyAgICAgICAgICAgIH0KPiA+ID4gPiArICAg
ICAgICB9Cj4gPiA+ID4gKyAgICB9Cj4gPiA+ID4gKwo+ID4gPiA+ICsgICAgaWYgKGQtPmRlbGV0
ZV9vbl9lamVjdCkgewo+ID4gPiA+ICsgICAgICAgIGQtPmRlbGV0ZV9vbl9lamVjdCA9IEZBTFNF
Owo+ID4gPiA+ICsgICAgICAgIGQtPmRlbGV0aW5nID0gVFJVRTsKPiA+ID4gPiArICAgIH0gZWxz
ZSB7Cj4gPiA+ID4gKyAgICAgICAgc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX3JlcG9ydF9jaGFu
Z2UoZC0+YmFja2VuZCwgZC0+cGFyZW50KTsKPiA+ID4gPiArICAgIH0KPiA+ID4gPiArfQo+ID4g
PiA+ICsKPiA+ID4gPiArc3RhdGljIGdjaGFyICp1c2JfY2RfZ2V0X3Byb2R1Y3RfZGVzY3JpcHRp
b24oVXNiQ2QgKmRldmljZSkKPiA+ID4gPiArewo+ID4gPiA+ICsgICAgZ2NoYXIgKmJhc2VfbmFt
ZSA9IGdfcGF0aF9nZXRfYmFzZW5hbWUoZGV2aWNlLT51bml0c1swXS5maWxlbmFtZSk7Cj4gPiA+
ID4gKyAgICBnY2hhciAqcmVzID0gZ19zdHJkdXBfcHJpbnRmKCJTUElDRSBDRCglcykiLCBiYXNl
X25hbWUpOwo+ID4gPgo+ID4gPiBNYXliZSBsZWF2ZSBhIHNwYWNlIGJldHdlZW4gIlNQSUNFIENE
IiBhbmQgdGhlIGZpbGUgbmFtZT8KPiA+ID4gT24gdGhlIEdVSSBkb2VzIG5vdCBhcHBlYXIgdGhh
dCBncmVhdCB3aXRob3V0Lgo+ID4KPiA+IE5vIHByb2JsZW0KPiA+Cj4gPiA+Cj4gPiA+ID4gKyAg
ICBnX2ZyZWUoYmFzZV9uYW1lKTsKPiA+ID4gPiArICAgIHJldHVybiByZXM7Cj4gPiA+ID4gK30K
PiA+ID4gPiArCj4gPiA+ID4gK3N0YXRpYyBjb25zdCBVc2JEZXZpY2VPcHMgZGV2b3BzID0KPiA+
ID4gPiArewo+ID4gPiA+ICsgICAgLmdldF9kZXNjcmlwdG9yID0gdXNiX2NkX2dldF9kZXNjcmlw
dG9yLAo+ID4gPiA+ICsgICAgLmdldF9wcm9kdWN0X2Rlc2NyaXB0aW9uID0gdXNiX2NkX2dldF9w
cm9kdWN0X2Rlc2NyaXB0aW9uLAo+ID4gPiA+ICsgICAgLmF0dGFjaCA9IHVzYl9jZF9hdHRhY2gs
Cj4gPiA+ID4gKyAgICAucmVzZXQgPSB1c2JfY2RfcmVzZXQsCj4gPiA+ID4gKyAgICAuZGV0YWNo
ID0gdXNiX2NkX2RldGFjaCwKPiA+ID4gPiArICAgIC5jb250cm9sX3JlcXVlc3QgPSB1c2JfY2Rf
Y29udHJvbF9yZXF1ZXN0LAo+ID4gPiA+ICsgICAgLmJ1bGtfb3V0X3JlcXVlc3QgPSB1c2JfY2Rf
YnVsa19vdXRfcmVxdWVzdCwKPiA+ID4gPiArICAgIC5idWxrX2luX3JlcXVlc3QgPSB1c2JfY2Rf
YnVsa19pbl9yZXF1ZXN0LAo+ID4gPiA+ICsgICAgLmNhbmNlbF9yZXF1ZXN0ID0gdXNiX2NkX2Nh
bmNlbF9yZXF1ZXN0LAo+ID4gPiA+ICsgICAgLmRlbGV0ZSA9IHVzYl9jZF9kZWxldGUsCj4gPiA+
ID4gK307Cj4gPiA+ID4gKwo+ID4gPiA+ICtzdGF0aWMgaW50IHVzYl9jZF9jcmVhdGUoU3BpY2VV
c2JCYWNrZW5kICpiZSwKPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgIFNwaWNlVXNi
QmFja2VuZERldmljZSAqcGFyZW50LAo+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
VXNiQ3JlYXRlRGV2aWNlUGFyYW1ldGVycyAqcGFyYW0sCj4gPiA+ID4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICBVc2JDZCAqKmRldikKPiA+ID4gPiArewo+ID4gPiA+ICsgICAgaW50IGVycm9y
ID0gMDsKPiA+ID4KPiA+ID4gSXMgdGhpcyByZXN1bHQgdmFsdWUgdXNlZCBvciBwbGFubmVkIHRv
IGJlIHVzZWQ/IExvb2tzIGxpa2Ugd2UgdXNlCj4gPiA+IChhbmQgdGhlIGNhbGxlciB0b28pIGxp
a2UgYSBib29sZWFuLgo+ID4gPgo+ID4gPiA+ICsgICAgdWludDMyX3QgdW5pdCA9IDA7Cj4gPiA+
Cj4gPiA+IFRoaXMgaXMgdGhlIG90aGVyICJ1bml0IiBjb25zdGFudCBzZXQgdG8gMCAoY29tbWVu
dCBhYm92ZSkuCj4gPgo+ID4gVGhlIGNvZGUgaXMgaW4gZ2VuZXJhbCB3YXMgcHJlcGFyZWQgYWxz
byB0byB3b3JrIGFsc28gd2l0aAo+ID4gbXVsdGlwbGUtdW5pdCBkZXZpY2VzLgo+ID4gU3dpdGNo
IGZyb20gc2luZ2xlLXVuaXQgdG8gbXVsdGlwbGUtdW5pdCwgaWYgbmVlZGVkLCB3aWxsIGJlIHZl
cnkgc2ltcGxlLgo+ID4KPiA+ID4KPiA+ID4gPiArICAgIFVzYkNkICpkID0gZ19uZXcwKFVzYkNk
LCAxKTsKPiA+ID4gPiArICAgIENkU2NzaURldmljZVBhcmFtZXRlcnMgZGV2X3BhcmFtcyA9IHsg
MCB9Owo+ID4gPiA+ICsKPiA+ID4gPiArICAgIGQtPmRldl9vcHMgPSBkZXZvcHM7Cj4gPiA+ID4g
KyAgICBkLT5iYWNrZW5kID0gYmU7Cj4gPiA+ID4gKyAgICBkLT5wYXJlbnQgID0gcGFyZW50Owo+
ID4gPiA+ICsgICAgZC0+ZGVsZXRlX29uX2VqZWN0ID0KPiA+ID4gPiAhIXBhcmFtLT5kZXZpY2Vf
cGFyYW0uY3JlYXRlX2NkLmRlbGV0ZV9vbl9lamVjdDsKPiA+ID4gPiArICAgIGQtPmxvY2tlZCA9
ICFkLT5kZWxldGVfb25fZWplY3Q7Cj4gPiA+ID4gKyAgICBkLT5zZXJpYWxbMF0gPSAweDAzMDg7
Cj4gPiA+ID4gKyAgICBkLT5zZXJpYWxbMV0gPSAnWCc7Cj4gPiA+Cj4gPiA+IFNwZWNpZmljYXRp
b25zIHN0YXRlIHRoYXQgdmFsdWUgY2hhcmFjdGVycyBhcmUgMC05IGFuZCBBLUYgKGNhcGl0YWwg
Y2FzZQo+ID4gPiBoZXhhZGVjaW1hbCwgeWVzIHF1aXRlIGEgd2FzdGUgb2Ygc3BhY2UgSSB3b3Vs
ZCBzYXkpLgo+ID4KPiA+IFdoaWNoIHNwZWM/Cj4gPiBUaGlzIGlzIHNlcmlhbCBzdHJpbmcgZm9y
IFVTQiB0byBkaXN0aW5ndWlzaCBiZXR3ZWVuIG11bHRpcGxlIENEcy4KPiA+Cj4KPiBTZWUgYWJv
dmUgZm9yIGxpbmsgdG8gc3BlY3MKPgo+ID4gPgo+ID4gPiA+ICsgICAgZC0+c2VyaWFsWzJdID0g
JzAnICsgcGFyYW0tPmFkZHJlc3MgLyAxMDsKPiA+ID4gPiArICAgIGQtPnNlcmlhbFszXSA9ICcw
JyArIHBhcmFtLT5hZGRyZXNzICUgMTA7Cj4gPiA+ID4gKyAgICBkLT5tYXhfbHVuX2luZGV4ID0g
TUFYX0xVTl9QRVJfREVWSUNFIC0gMTsKPiA+ID4gPiArCj4gPiA+ID4gKyAgICBkZXZfcGFyYW1z
LnZlbmRvciA9ICJTUElDRSI7Cj4gPiA+ID4gKyAgICBkZXZfcGFyYW1zLnByb2R1Y3QgPSAic2hh
cmVkIENEIjsKPiA+ID4KPiA+ID4gV2h5IG5vdCAiUmVkIEhhdCIgYW5kICJTUElDRSBDRCIgZXZl
biBoZXJlPwo+ID4KPiA+IEV2ZXJ5dGhpbmcgeW91IHdhbnQuIFRoZXkgYXJlIFNDU0kgcGFyYW1l
dGVycy4KPiA+Cj4gPiA+Cj4gPiA+ID4gKyAgICBkZXZfcGFyYW1zLnZlcnNpb24gPSAiMCI7Cj4g
PiA+ID4gKwo+ID4gPiA+ICsgICAgZC0+bXNjID0gY2RfdXNiX2J1bGtfbXNkX2FsbG9jKGQsIE1B
WF9MVU5fUEVSX0RFVklDRSk7Cj4gPiA+ID4gKyAgICBpZiAoIWQtPm1zYykgewo+ID4gPiA+ICsg
ICAgICAgIGdfY2xlYXJfcG9pbnRlcigmZCwgZ19mcmVlKTsKPiA+ID4gPiArICAgICAgICBwYXJh
bS0+ZXJyb3IgPSBnX2Vycm9yX25ldyhTUElDRV9DTElFTlRfRVJST1IsCj4gPiA+ID4gU1BJQ0Vf
Q0xJRU5UX0VSUk9SX0ZBSUxFRCwKPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBfKCJjYW4ndCBhbGxvY2F0ZSBkZXZpY2UiKSk7Cj4gPiA+ID4gKyAgICAgICAgcmV0
dXJuIDE7Cj4gPiA+ID4gKyAgICB9Cj4gPiA+ID4gKyAgICBkLT51bml0c1t1bml0XS5ibG9ja1Np
emUgPSBDRF9ERVZfQkxPQ0tfU0laRTsKPiA+ID4gPiArICAgIGlmICghY2RfdXNiX2J1bGtfbXNk
X3JlYWxpemUoZC0+bXNjLCB1bml0LCAmZGV2X3BhcmFtcykpIHsKPiA+ID4gPiArICAgICAgICBp
ZiAob3Blbl9zdHJlYW0oJmQtPnVuaXRzW3VuaXRdLAo+ID4gPiA+IHBhcmFtLT5kZXZpY2VfcGFy
YW0uY3JlYXRlX2NkLmZpbGVuYW1lKSAmJgo+ID4gPiA+ICsgICAgICAgICAgICBsb2FkX2x1bihk
LCB1bml0LCBUUlVFKSkgewo+ID4gPiA+ICsgICAgICAgICAgICBpZiAoZC0+bG9ja2VkKSB7Cj4g
PiA+ID4gKyAgICAgICAgICAgICAgICBjZF91c2JfYnVsa19tc2RfbG9jayhkLT5tc2MsIHVuaXQs
IFRSVUUpOwo+ID4gPiA+ICsgICAgICAgICAgICB9Cj4gPiA+ID4gKyAgICAgICAgfSBlbHNlIHsK
PiA+ID4gPiArICAgICAgICAgICAgY2xvc2Vfc3RyZWFtKCZkLT51bml0c1t1bml0XSk7Cj4gPiA+
ID4gKyAgICAgICAgICAgIGNkX3VzYl9idWxrX21zZF91bnJlYWxpemUoZC0+bXNjLCB1bml0KTsK
PiA+ID4gPiArICAgICAgICAgICAgcGFyYW0tPmVycm9yID0gZ19lcnJvcl9uZXcoU1BJQ0VfQ0xJ
RU5UX0VSUk9SLAo+ID4gPiA+IFNQSUNFX0NMSUVOVF9FUlJPUl9GQUlMRUQsCj4gPiA+ID4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF8oImNhbid0IGNyZWF0ZSBkZXZp
Y2Ugd2l0aCAlcyIpLAo+ID4gPiA+ICsKPiA+ID4gPiBwYXJhbS0+ZGV2aWNlX3BhcmFtLmNyZWF0
ZV9jZC5maWxlbmFtZSk7Cj4gPiA+ID4gKyAgICAgICAgICAgIGVycm9yID0gMzsKPiA+ID4gPiAr
ICAgICAgICB9Cj4gPiA+ID4gKyAgICB9IGVsc2Ugewo+ID4gPiA+ICsgICAgICAgIGVycm9yID0g
MjsKPiA+ID4gPiArICAgICAgICBwYXJhbS0+ZXJyb3IgPSBnX2Vycm9yX25ldyhTUElDRV9DTElF
TlRfRVJST1IsCj4gPiA+ID4gU1BJQ0VfQ0xJRU5UX0VSUk9SX0ZBSUxFRCwKPiA+ID4gPiArICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfKCJjYW4ndCBhbGxvY2F0ZSBkZXZpY2Ui
KSk7Cj4gPiA+ID4gKyAgICB9Cj4gPiA+ID4gKyAgICBpZiAoZXJyb3IpIHsKPiA+ID4gPiArICAg
ICAgICBnX2NsZWFyX3BvaW50ZXIoJmQtPm1zYywgY2RfdXNiX2J1bGtfbXNkX2ZyZWUpOwo+ID4g
PiA+ICsgICAgICAgIGdfY2xlYXJfcG9pbnRlcigmZCwgZ19mcmVlKTsKPiA+ID4gPiArICAgIH0K
PiA+ID4gPiArCj4gPiA+ID4gKyAgICAqZGV2ID0gZDsKPiA+ID4gPiArICAgIHJldHVybiBlcnJv
cjsKPiA+ID4gPiArfQo+ID4gPiA+ICsKPiA+ID4gPiArdm9pZCBzcGljZV91c2JfZGV2aWNlX3Jl
Z2lzdGVyX2NkKFNwaWNlVXNiQmFja2VuZCAqYmUpCj4gPiA+ID4gK3sKPiA+ID4gPiArICAgIHNw
aWNlX3VzYl9iYWNrZW5kX3JlZ2lzdGVyX2RldmljZV90eXBlKGJlLCBVU0JfREVWX1RZUEVfQ0Qs
Cj4gPiA+ID4gdXNiX2NkX2NyZWF0ZSk7Cj4gPiA+ID4gK30KPiA+ID4gPiArCj4gPiA+ID4gKyNl
bmRpZiAvKiBVU0VfVVNCUkVESVIgKi8KPiA+ID4KPiA+ID4gQnkgdGhlIHdheSwgcHJlcGFyaW5n
IHNvbWUgZm9sbG93IHVwcy4KPiA+ID4KPiA+ID4gRnJlZGlhbm8KPiA+Cl9fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClNwaWNlLWRldmVsIG1haWxpbmcgbGlz
dApTcGljZS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVz
a3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9zcGljZS1kZXZlbA==
