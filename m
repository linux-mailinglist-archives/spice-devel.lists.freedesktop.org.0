Return-Path: <spice-devel-bounces@lists.freedesktop.org>
X-Original-To: lists+spice-devel@lfdr.de
Delivered-To: lists+spice-devel@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id B61D580C1A
	for <lists+spice-devel@lfdr.de>; Sun,  4 Aug 2019 21:16:38 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 9411489D99;
	Sun,  4 Aug 2019 19:16:35 +0000 (UTC)
X-Original-To: spice-devel@lists.freedesktop.org
Delivered-To: spice-devel@lists.freedesktop.org
Received: from mail-wr1-x441.google.com (mail-wr1-x441.google.com
 [IPv6:2a00:1450:4864:20::441])
 by gabe.freedesktop.org (Postfix) with ESMTPS id D067189D8E
 for <spice-devel@lists.freedesktop.org>; Sun,  4 Aug 2019 19:16:34 +0000 (UTC)
Received: by mail-wr1-x441.google.com with SMTP id x4so29058617wrt.6
 for <spice-devel@lists.freedesktop.org>; Sun, 04 Aug 2019 12:16:34 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references;
 bh=c0BKk1KePhXqh+6aupC50GWrQ097rT4zb6989si4Hn0=;
 b=SHT6dvR9JKjj2Nym89dn02PaShcrdxX2eAYW4l+TA9XXQKEbgNW6xWl/m7oF1NlK8M
 kPkDEJRt1PyqDF2HLQBqZ904I2qOuY0aiDcrLv5uBtGP9+EuHUeV5t+Gg8faf8ghJPGi
 IMhRLMc4w895k95+XCsgDYE9Y4s1fsZ7vsOJ+W4HeU3t3mheSA3tmJXMI4gqTC+BDv3T
 wPv8Dq2RM/6tjvi67UHoyto1+/LCissYv/OW9MHQ6JAWAQujmE5g7uHEVfwspGBle2er
 1DDLrnBXG1sNg6UwSNDl8FgEZCjHJ8YTB61xLkUNG8MM6gR2jl6o8HNC5x/cVzkzarHd
 LiSQ==
X-Gm-Message-State: APjAAAWi+LQZun/o0h+0JzmJYKDTfkXqw/EwAaCCYy3koWwo3A0GI0xp
 jrVYbr21hhbbXVl9JwFgzXwv3Xfs
X-Google-Smtp-Source: APXvYqxGVkpWGLyyIDEGRUR2YkcgEPvuoLaf2DqWKetamPBj86Rw50h+o/wuSZes3TfkpewhAjHPbw==
X-Received: by 2002:adf:b1d1:: with SMTP id
 r17mr158742942wra.273.1564946193050; 
 Sun, 04 Aug 2019 12:16:33 -0700 (PDT)
Received: from f2.redhat.com (bzq-79-182-115-245.red.bezeqint.net.
 [79.182.115.245])
 by smtp.gmail.com with ESMTPSA id f204sm136527687wme.18.2019.08.04.12.16.31
 (version=TLS1_2 cipher=ECDHE-RSA-CHACHA20-POLY1305 bits=256/256);
 Sun, 04 Aug 2019 12:16:32 -0700 (PDT)
From: Yuri Benditovich <yuri.benditovich@daynix.com>
To: spice-devel@lists.freedesktop.org
Date: Sun,  4 Aug 2019 22:16:17 +0300
Message-Id: <20190804191624.29235-2-yuri.benditovich@daynix.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20190804191624.29235-1-yuri.benditovich@daynix.com>
References: <20190804191624.29235-1-yuri.benditovich@daynix.com>
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=daynix-com.20150623.gappssmtp.com; s=20150623;
 h=from:to:cc:subject:date:message-id:in-reply-to:references;
 bh=c0BKk1KePhXqh+6aupC50GWrQ097rT4zb6989si4Hn0=;
 b=hA3V51rnEQm6SiELFmCnF41Ksjw9iOCCjH/58TFTLD9u4igzsu5E0pgnxrGsbM78dG
 XxUzeI1C2tA09fMlyr8SVWRko7zodWlQZGd0FD+hvUNf9kMTY0W4+FT0bgJApj0x70gN
 Vcqju4Tk5jypPkOBQjei2PbAAl2lQS6XVM8jxdvihkuM6xmpL71LyRwkk6ra45TvNKql
 aiPtEZSbKjBrcf9Jk4/mN7SfgUwlOBhsz+5RP1aJDrCmlKiVMP/FfIvuEWIZxIbfz/pQ
 iHAT1Gw/eeEHhZvmaVy41m+D81pNkLTd+XCZaWoHWzT3L2b76wu527tz93TH7gFmkdCC
 P0fQ==
Subject: [Spice-devel] [spice-gtk v2 1/8] usb-redir: define interfaces to
 support emulated devices
X-BeenThere: spice-devel@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <spice-devel.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/spice-devel>
List-Post: <mailto:spice-devel@lists.freedesktop.org>
List-Help: <mailto:spice-devel-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/spice-devel>, 
 <mailto:spice-devel-request@lists.freedesktop.org?subject=subscribe>
Cc: yan@daynix.com
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: spice-devel-bounces@lists.freedesktop.org
Sender: "Spice-devel" <spice-devel-bounces@lists.freedesktop.org>

U3BpY2VVc2JCYWNrZW5kRGV2aWNlIHN0cnVjdHVyZSBpcyBleHRlbmRlZCB0byBzdXBwb3J0CmFk
ZGl0aW9uYWwga2luZCBvZiBkZXZpY2UgdGhhdCBpcyBlbXVsYXRlZCBieSBTcGljZS1HVEsKYW5k
IG5vdCBwcmVzZW50IGxvY2FsbHkgKGFuZCBkb2VzIG5vdCBoYXZlIGxpYnVzYl9kZXZpY2UpLApz
dWNoIGRldmljZSBoYXMgaW5zdGVhZCBwb2ludGVyIHRvIFNwaWNlVXNiRW11bGF0ZWREZXZpY2UK
YWJzdHJhY3Qgc3RydWN0dXJlLiBTcGVjaWZpYyBpbXBsZW1lbnRhdGlvbiBvZiBzdWNoIGRldmlj
ZQpkZXBlbmRzIG9uIGl0cyBkZXZpY2UgdHlwZS4gSW1wbGVtZW50YXRpb24gbW9kdWxlIHdpbGwg
ZGVmaW5lCmNvbnN0cnVjdG9yIGZvciBzcGVjaWZpYyBkZXZpY2UgdHlwZS4KRGV2aWNlIHN0cnVj
dHVyZSBpcyBhYnN0cmFjdCBidXQgYWx3YXlzIHN0YXJ0cyBmcm9tIHRhYmxlIG9mCnZpcnR1YWwg
ZnVuY3Rpb25zIHJlcXVpcmVkIHRvIHJlZGlyZWN0IHN1Y2ggdmlydHVhbCBkZXZpY2UuCgpTaWdu
ZWQtb2ZmLWJ5OiBZdXJpIEJlbmRpdG92aWNoIDx5dXJpLmJlbmRpdG92aWNoQGRheW5peC5jb20+
Ci0tLQogc3JjL21lc29uLmJ1aWxkICAgICB8ICAgMSArCiBzcmMvdXNiLWJhY2tlbmQuYyAgIHwg
MTAyICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKystCiBzcmMvdXNi
LWJhY2tlbmQuaCAgIHwgICAzICsrCiBzcmMvdXNiLWVtdWxhdGlvbi5oIHwgIDkxICsrKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKwogNCBmaWxlcyBjaGFuZ2VkLCAxOTUgaW5z
ZXJ0aW9ucygrKSwgMiBkZWxldGlvbnMoLSkKIGNyZWF0ZSBtb2RlIDEwMDY0NCBzcmMvdXNiLWVt
dWxhdGlvbi5oCgpkaWZmIC0tZ2l0IGEvc3JjL21lc29uLmJ1aWxkIGIvc3JjL21lc29uLmJ1aWxk
CmluZGV4IGI0YTY4NzAuLmZlMTljMTYgMTAwNjQ0Ci0tLSBhL3NyYy9tZXNvbi5idWlsZAorKysg
Yi9zcmMvbWVzb24uYnVpbGQKQEAgLTEyMiw2ICsxMjIsNyBAQCBzcGljZV9jbGllbnRfZ2xpYl9z
b3VyY2VzID0gWwogICAndXNidXRpbC5jJywKICAgJ3VzYnV0aWwuaCcsCiAgICd1c2ItYmFja2Vu
ZC5jJywKKyAgJ3VzYi1lbXVsYXRpb24uaCcsCiAgICd1c2ItYmFja2VuZC5oJywKICAgJ3ZtY3N0
cmVhbS5jJywKICAgJ3ZtY3N0cmVhbS5oJywKZGlmZiAtLWdpdCBhL3NyYy91c2ItYmFja2VuZC5j
IGIvc3JjL3VzYi1iYWNrZW5kLmMKaW5kZXggMzMzNGY1Ni4uYmU2MGNmMyAxMDA2NDQKLS0tIGEv
c3JjL3VzYi1iYWNrZW5kLmMKKysrIGIvc3JjL3VzYi1iYWNrZW5kLmMKQEAgLTM5LDYgKzM5LDcg
QEAKICNpbmNsdWRlICJ1c2JyZWRpcnBhcnNlci5oIgogI2luY2x1ZGUgInNwaWNlLXV0aWwuaCIK
ICNpbmNsdWRlICJ1c2ItYmFja2VuZC5oIgorI2luY2x1ZGUgInVzYi1lbXVsYXRpb24uaCIKICNp
bmNsdWRlICJjaGFubmVsLXVzYnJlZGlyLXByaXYuaCIKICNpbmNsdWRlICJzcGljZS1jaGFubmVs
LXByaXYuaCIKIApAQCAtNDYsNyArNDcsMTAgQEAKIAogc3RydWN0IF9TcGljZVVzYkJhY2tlbmRE
ZXZpY2UKIHsKKyAgICAvKiBQb2ludGVyIHRvIGRldmljZS4gRWl0aGVyIHJlYWwgZGV2aWNlIChs
aWJ1c2JfZGV2aWNlKQorICAgICAqIG9yIGVtdWxhdGVkIG9uZSAoZWRldikgKi8KICAgICBsaWJ1
c2JfZGV2aWNlICpsaWJ1c2JfZGV2aWNlOworICAgIFNwaWNlVXNiRW11bGF0ZWREZXZpY2UgKmVk
ZXY7CiAgICAgZ2ludCByZWZfY291bnQ7CiAgICAgU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCAqYXR0
YWNoZWRfdG87CiAgICAgVXNiRGV2aWNlSW5mb3JtYXRpb24gZGV2aWNlX2luZm87CkBAIC02Niw2
ICs3MCwxMCBAQCBzdHJ1Y3QgX1NwaWNlVXNiQmFja2VuZAogICAgIGxpYnVzYl9kZXZpY2UgKips
aWJ1c2JfZGV2aWNlX2xpc3Q7CiAgICAgZ2ludCByZWRpcmVjdGluZzsKICNlbmRpZgorCisgICAg
LyogTWFzayBvZiBhbGxvY2F0ZWQgZGV2aWNlLCBhIHNwZWNpZmljIGJpdCBzZXQgdG8gMSB0byBp
bmRpY2F0ZSB0aGF0IHRoZSBkZXZpY2UgYXQKKyAgICAgKiB0aGF0IGFkZHJlc3MgaXMgYWxsb2Nh
dGVkICovCisgICAgdWludDMyX3Qgb3duX2RldmljZXNfbWFzazsKIH07CiAKIHN0cnVjdCBfU3Bp
Y2VVc2JCYWNrZW5kQ2hhbm5lbApAQCAtNDEzLDYgKzQyMSw4IEBAIFNwaWNlVXNiQmFja2VuZCAq
c3BpY2VfdXNiX2JhY2tlbmRfbmV3KEdFcnJvciAqKmVycm9yKQogICAgICAgICBsaWJ1c2Jfc2V0
X29wdGlvbihiZS0+bGlidXNiX2NvbnRleHQsIExJQlVTQl9PUFRJT05fVVNFX1VTQkRLKTsKICNl
bmRpZgogI2VuZGlmCisgICAgICAgIC8qIGV4Y2x1ZGUgYWRkcmVzc2VzIDAgKHJlc2VydmVkKSBh
bmQgMSAocm9vdCBodWIpICovCisgICAgICAgIGJlLT5vd25fZGV2aWNlc19tYXNrID0gMzsKICAg
ICB9CiAgICAgU1BJQ0VfREVCVUcoIiVzIDw8IiwgX19GVU5DVElPTl9fKTsKICAgICByZXR1cm4g
YmU7CkBAIC01MjksOCArNTM5LDEzIEBAIHZvaWQgc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX3Vu
cmVmKFNwaWNlVXNiQmFja2VuZERldmljZSAqZGV2KQogewogICAgIExPVURfREVCVUcoIiVzID4+
ICVwKCVkKSIsIF9fRlVOQ1RJT05fXywgZGV2LCBkZXYtPnJlZl9jb3VudCk7CiAgICAgaWYgKGdf
YXRvbWljX2ludF9kZWNfYW5kX3Rlc3QoJmRldi0+cmVmX2NvdW50KSkgewotICAgICAgICBsaWJ1
c2JfdW5yZWZfZGV2aWNlKGRldi0+bGlidXNiX2RldmljZSk7Ci0gICAgICAgIExPVURfREVCVUco
IiVzIGZyZWVpbmcgJXAgKGxpYnVzYiAlcCkiLCBfX0ZVTkNUSU9OX18sIGRldiwgZGV2LT5saWJ1
c2JfZGV2aWNlKTsKKyAgICAgICAgaWYgKGRldi0+bGlidXNiX2RldmljZSkgeworICAgICAgICAg
ICAgbGlidXNiX3VucmVmX2RldmljZShkZXYtPmxpYnVzYl9kZXZpY2UpOworICAgICAgICAgICAg
TE9VRF9ERUJVRygiJXMgZnJlZWluZyAlcCAobGlidXNiICVwKSIsIF9fRlVOQ1RJT05fXywgZGV2
LCBkZXYtPmxpYnVzYl9kZXZpY2UpOworICAgICAgICB9CisgICAgICAgIGlmIChkZXYtPmVkZXYp
IHsKKyAgICAgICAgICAgIGRldmljZV9vcHMoZGV2LT5lZGV2KS0+dW5yZWFsaXplKGRldi0+ZWRl
dik7CisgICAgICAgIH0KICAgICAgICAgZ19mcmVlKGRldik7CiAgICAgfQogfQpAQCAtODI5LDQg
Kzg0NCw4NyBAQCBzcGljZV91c2JfYmFja2VuZF9jaGFubmVsX2dldF9ndWVzdF9maWx0ZXIoU3Bp
Y2VVc2JCYWNrZW5kQ2hhbm5lbCAqY2gsCiAgICAgfQogfQogCit2b2lkIHNwaWNlX3VzYl9iYWNr
ZW5kX2RldmljZV9yZXBvcnRfY2hhbmdlKFNwaWNlVXNiQmFja2VuZCAqYmUsCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNwaWNlVXNiQmFja2VuZERldmljZSAq
ZGV2KQoreworICAgIGdjaGFyICpkZXNjOworICAgIGdfcmV0dXJuX2lmX2ZhaWwoZGV2ICYmIGRl
di0+ZWRldik7CisKKyAgICBkZXNjID0gZGV2aWNlX29wcyhkZXYtPmVkZXYpLT5nZXRfcHJvZHVj
dF9kZXNjcmlwdGlvbihkZXYtPmVkZXYpOworICAgIFNQSUNFX0RFQlVHKCIlczogJXMiLCBfX0ZV
TkNUSU9OX18sIGRlc2MpOworICAgIGdfZnJlZShkZXNjKTsKK30KKwordm9pZCBzcGljZV91c2Jf
YmFja2VuZF9kZXZpY2VfZWplY3QoU3BpY2VVc2JCYWNrZW5kICpiZSwgU3BpY2VVc2JCYWNrZW5k
RGV2aWNlICpkZXYpCit7CisgICAgZ19yZXR1cm5faWZfZmFpbChkZXYgJiYgZGV2LT5lZGV2KTsK
KworICAgIGlmIChiZS0+aG90cGx1Z19jYWxsYmFjaykgeworICAgICAgICBiZS0+aG90cGx1Z19j
YWxsYmFjayhiZS0+aG90cGx1Z191c2VyX2RhdGEsIGRldiwgRkFMU0UpOworICAgIH0KKyAgICBi
ZS0+b3duX2RldmljZXNfbWFzayAmPSB+KDEgPDwgZGV2LT5kZXZpY2VfaW5mby5hZGRyZXNzKTsK
KworICAgIHNwaWNlX3VzYl9iYWNrZW5kX2RldmljZV91bnJlZihkZXYpOworfQorCitTcGljZVVz
YkJhY2tlbmREZXZpY2UqCitzcGljZV91c2JfYmFja2VuZF9jcmVhdGVfZW11bGF0ZWRfZGV2aWNl
KFNwaWNlVXNiQmFja2VuZCAqYmUsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIFNwaWNlVXNiRW11bGF0ZWREZXZpY2VDcmVhdGUgY3JlYXRlX3Byb2MsCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZvaWQgKmNyZWF0ZV9wYXJhbXMsCisg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdFcnJvciAqKmVycikKK3sK
KyAgICBTcGljZVVzYkVtdWxhdGVkRGV2aWNlICplZGV2OworICAgIFNwaWNlVXNiQmFja2VuZERl
dmljZSAqZGV2OworICAgIHN0cnVjdCBsaWJ1c2JfZGV2aWNlX2Rlc2NyaXB0b3IgKmRlc2M7Cisg
ICAgdWludDE2X3QgZGV2aWNlX2Rlc2Nfc2l6ZTsKKyAgICB1aW50OF90IGFkZHJlc3MgPSAwOwor
CisgICAgaWYgKGJlLT5vd25fZGV2aWNlc19tYXNrID09IDB4ZmZmZmZmZmYpIHsKKyAgICAgICAg
Z19zZXRfZXJyb3IoZXJyLCBTUElDRV9DTElFTlRfRVJST1IsIFNQSUNFX0NMSUVOVF9FUlJPUl9G
QUlMRUQsCisgICAgICAgICAgICAgICAgICAgIF8oImNhbid0IGNyZWF0ZSBkZXZpY2UgLSBsaW1p
dCByZWFjaGVkIikpOworICAgICAgICByZXR1cm4gTlVMTDsKKyAgICB9CisgICAgZm9yIChhZGRy
ZXNzID0gMDsgYWRkcmVzcyA8IDMyOyArK2FkZHJlc3MpIHsKKyAgICAgICAgaWYgKH5iZS0+b3du
X2RldmljZXNfbWFzayAmICgxIDw8IGFkZHJlc3MpKSB7CisgICAgICAgICAgICBicmVhazsKKyAg
ICAgICAgfQorICAgIH0KKworICAgIGRldiA9IGdfbmV3MChTcGljZVVzYkJhY2tlbmREZXZpY2Us
IDEpOworICAgIGRldi0+ZGV2aWNlX2luZm8uYnVzID0gQlVTX05VTUJFUl9GT1JfRU1VTEFURURf
VVNCOworICAgIGRldi0+ZGV2aWNlX2luZm8uYWRkcmVzcyA9IGFkZHJlc3M7CisgICAgZGV2LT5y
ZWZfY291bnQgPSAxOworCisgICAgZGV2LT5lZGV2ID0gZWRldiA9IGNyZWF0ZV9wcm9jKGJlLCBk
ZXYsIGNyZWF0ZV9wYXJhbXMsIGVycik7CisgICAgaWYgKGVkZXYgPT0gTlVMTCkgeworICAgICAg
ICBzcGljZV91c2JfYmFja2VuZF9kZXZpY2VfdW5yZWYoZGV2KTsKKyAgICAgICAgcmV0dXJuIE5V
TEw7CisgICAgfQorCisgICAgaWYgKCFkZXZpY2Vfb3BzKGVkZXYpLT5nZXRfZGVzY3JpcHRvcihl
ZGV2LCBMSUJVU0JfRFRfREVWSUNFLCAwLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgKHZvaWQgKiopJmRlc2MsICZkZXZpY2VfZGVzY19zaXplKQorICAgICAgICB8
fCBkZXZpY2VfZGVzY19zaXplICE9IHNpemVvZigqZGVzYykpIHsKKworICAgICAgICBzcGljZV91
c2JfYmFja2VuZF9kZXZpY2VfdW5yZWYoZGV2KTsKKyAgICAgICAgZ19zZXRfZXJyb3IoZXJyLCBT
UElDRV9DTElFTlRfRVJST1IsIFNQSUNFX0NMSUVOVF9FUlJPUl9GQUlMRUQsCisgICAgICAgICAg
ICAgICAgICAgIF8oImNhbid0IGNyZWF0ZSBkZXZpY2UgLSBpbnRlcm5hbCBlcnJvciIpKTsKKyAg
ICAgICAgcmV0dXJuIE5VTEw7CisgICAgfQorCisgICAgYmUtPm93bl9kZXZpY2VzX21hc2sgfD0g
MSA8PCBhZGRyZXNzOworCisgICAgZGV2LT5kZXZpY2VfaW5mby52aWQgPSBkZXNjLT5pZFZlbmRv
cjsKKyAgICBkZXYtPmRldmljZV9pbmZvLnBpZCA9IGRlc2MtPmlkUHJvZHVjdDsKKyAgICBkZXYt
PmRldmljZV9pbmZvLmJjZFVTQiA9IGRlc2MtPmJjZFVTQjsKKyAgICBkZXYtPmRldmljZV9pbmZv
LmNsYXNzID0gZGVzYy0+YkRldmljZUNsYXNzOworICAgIGRldi0+ZGV2aWNlX2luZm8uc3ViY2xh
c3MgPSBkZXNjLT5iRGV2aWNlU3ViQ2xhc3M7CisgICAgZGV2LT5kZXZpY2VfaW5mby5wcm90b2Nv
bCA9IGRlc2MtPmJEZXZpY2VQcm90b2NvbDsKKworICAgIGlmIChiZS0+aG90cGx1Z19jYWxsYmFj
aykgeworICAgICAgICBiZS0+aG90cGx1Z19jYWxsYmFjayhiZS0+aG90cGx1Z191c2VyX2RhdGEs
IGRldiwgVFJVRSk7CisgICAgfQorCisgICAgcmV0dXJuIGRldjsKK30KKwogI2VuZGlmIC8qIFVT
Ql9SRURJUiAqLwpkaWZmIC0tZ2l0IGEvc3JjL3VzYi1iYWNrZW5kLmggYi9zcmMvdXNiLWJhY2tl
bmQuaAppbmRleCA2OWE0OTBiLi42M2I5MjAyIDEwMDY0NAotLS0gYS9zcmMvdXNiLWJhY2tlbmQu
aAorKysgYi9zcmMvdXNiLWJhY2tlbmQuaApAQCAtMzEsMTIgKzMxLDE1IEBAIHR5cGVkZWYgc3Ry
dWN0IF9TcGljZVVzYkJhY2tlbmQgU3BpY2VVc2JCYWNrZW5kOwogdHlwZWRlZiBzdHJ1Y3QgX1Nw
aWNlVXNiQmFja2VuZERldmljZSBTcGljZVVzYkJhY2tlbmREZXZpY2U7CiB0eXBlZGVmIHN0cnVj
dCBfU3BpY2VVc2JCYWNrZW5kQ2hhbm5lbCBTcGljZVVzYkJhY2tlbmRDaGFubmVsOwogCisjZGVm
aW5lIEJVU19OVU1CRVJfRk9SX0VNVUxBVEVEX1VTQiBHX01BWFVJTlQxNgorCiB0eXBlZGVmIHN0
cnVjdCBVc2JEZXZpY2VJbmZvcm1hdGlvbgogewogICAgIHVpbnQxNl90IGJ1czsKICAgICB1aW50
MTZfdCBhZGRyZXNzOwogICAgIHVpbnQxNl90IHZpZDsKICAgICB1aW50MTZfdCBwaWQ7CisgICAg
dWludDE2X3QgYmNkVVNCOwogICAgIHVpbnQ4X3QgY2xhc3M7CiAgICAgdWludDhfdCBzdWJjbGFz
czsKICAgICB1aW50OF90IHByb3RvY29sOwpkaWZmIC0tZ2l0IGEvc3JjL3VzYi1lbXVsYXRpb24u
aCBiL3NyYy91c2ItZW11bGF0aW9uLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAw
MC4uOWU2MjZhMgotLS0gL2Rldi9udWxsCisrKyBiL3NyYy91c2ItZW11bGF0aW9uLmgKQEAgLTAs
MCArMSw5MSBAQAorLyogLSotIE1vZGU6IEM7IGMtYmFzaWMtb2Zmc2V0OiA0OyBpbmRlbnQtdGFi
cy1tb2RlOiBuaWwgLSotICovCisvKgorICAgIENvcHlyaWdodCAoQykgMjAxOSBSZWQgSGF0LCBJ
bmMuCisKKyAgICBSZWQgSGF0IEF1dGhvcnM6CisgICAgWXVyaSBCZW5kaXRvdmljaDx5YmVuZGl0
b0ByZWRoYXQuY29tPgorCisgICAgVGhpcyBsaWJyYXJ5IGlzIGZyZWUgc29mdHdhcmU7IHlvdSBj
YW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vcgorICAgIG1vZGlmeSBpdCB1bmRlciB0aGUgdGVybXMg
b2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKKyAgICBMaWNlbnNlIGFzIHB1Ymxpc2hl
ZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIKKyAgICB2ZXJzaW9uIDIu
MSBvZiB0aGUgTGljZW5zZSwgb3IgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4K
KworICAgIFRoaXMgbGlicmFyeSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdp
bGwgYmUgdXNlZnVsLAorICAgIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVu
IHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCisgICAgTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1Mg
Rk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZSBHTlUKKyAgICBMZXNzZXIgR2VuZXJh
bCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgorCisgICAgWW91IHNob3VsZCBoYXZl
IHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYworICAgIExp
Y2Vuc2UgYWxvbmcgd2l0aCB0aGlzIGxpYnJhcnk7IGlmIG5vdCwgc2VlIDxodHRwOi8vd3d3Lmdu
dS5vcmcvbGljZW5zZXMvPi4KKyovCisKKyNpZm5kZWYgX19TUElDRV9VU0JfRU1VTEFUSU9OX0hf
XworI2RlZmluZSBfX1NQSUNFX1VTQl9FTVVMQVRJT05fSF9fCisKKyNpbmNsdWRlICJ1c2JyZWRp
cnBhcnNlci5oIgorI2luY2x1ZGUgInVzYi1iYWNrZW5kLmgiCisKK3R5cGVkZWYgc3RydWN0IFNw
aWNlVXNiRW11bGF0ZWREZXZpY2UgU3BpY2VVc2JFbXVsYXRlZERldmljZTsKK3R5cGVkZWYgU3Bp
Y2VVc2JFbXVsYXRlZERldmljZSoKKygqU3BpY2VVc2JFbXVsYXRlZERldmljZUNyZWF0ZSkoU3Bp
Y2VVc2JCYWNrZW5kICpiZSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU3BpY2VV
c2JCYWNrZW5kRGV2aWNlICpwYXJlbnQsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHZvaWQgKmNyZWF0ZV9wYXJhbXMsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdF
cnJvciAqKmVycik7CisKKy8qCisgICAgZnVuY3Rpb24gdGFibGUgZm9yIGVtdWxhdGVkIFVTQiBk
ZXZpY2UKKyAgICBtdXN0IGJlIGZpcnN0IG1lbWJlciBvZiBkZXZpY2Ugc3RydWN0dXJlCisgICAg
YWxsIGZ1bmN0aW9ucyBhcmUgbWFuZGF0b3J5IGZvciBpbXBsZW1lbnRhdGlvbgorKi8KK3R5cGVk
ZWYgc3RydWN0IFVzYkRldmljZU9wcyB7CisgICAgZ2Jvb2xlYW4gKCpnZXRfZGVzY3JpcHRvciko
U3BpY2VVc2JFbXVsYXRlZERldmljZSAqZGV2aWNlLAorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHVpbnQ4X3QgdHlwZSwgdWludDhfdCBpbmRleCwKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICB2b2lkICoqYnVmZmVyLCB1aW50MTZfdCAqc2l6ZSk7CisgICAgZ2NoYXIgKiAo
KmdldF9wcm9kdWN0X2Rlc2NyaXB0aW9uKShTcGljZVVzYkVtdWxhdGVkRGV2aWNlICpkZXZpY2Up
OworICAgIHZvaWQgKCphdHRhY2gpKFNwaWNlVXNiRW11bGF0ZWREZXZpY2UgKmRldmljZSwgc3Ry
dWN0IHVzYnJlZGlycGFyc2VyICpwYXJzZXIpOworICAgIHZvaWQgKCpyZXNldCkoU3BpY2VVc2JF
bXVsYXRlZERldmljZSAqZGV2aWNlKTsKKyAgICAvKgorICAgICAgICBwcm9jZXNzaW5nIGlzIHN5
bmNocm9ub3VzLCBkZWZhdWx0ID0gc3RhbGw6CisgICAgICAgIC0gcmV0dXJuIHN1Y2Nlc3Mgd2l0
aG91dCBkYXRhOiBzZXQgc3RhdHVzIHRvIDAKKyAgICAgICAgLSByZXR1cm4gZXJyb3IgLSBzZXQg
c3RhdHVzIHRvIGVycm9yCisgICAgICAgIC0gcmV0dXJuIHN1Y2Nlc3Mgd2l0aCBkYXRhIC0gc2V0
IHN0YXR1cyB0byAwLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0IGJ1
ZmZlciB0byBzb21lIGJ1ZmZlcgorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
c2V0IGxlbmd0aCB0byBvdXQgbGVuCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICB0cnVuY2F0aW9uIGlzIGF1dG9tYXRpYworICAgICovCisgICAgdm9pZCAoKmNvbnRyb2xfcmVx
dWVzdCkoU3BpY2VVc2JFbXVsYXRlZERldmljZSAqZGV2aWNlLAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHVpbnQ4X3QgKmRhdGEsIGludCBkYXRhX2xlbiwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBzdHJ1Y3QgdXNiX3JlZGlyX2NvbnRyb2xfcGFja2V0X2hlYWRlciAqaCwKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICB2b2lkICoqYnVmZmVyKTsKKyAgICAvKgorICAgICAg
ICBwcm9jZXNzaW5nIGlzIHN5bmNocm9ub3VzOgorICAgICAgICAtIHNldCBoLT5zdGF0dXMgdG8g
cmVzdWx0aW5nIHN0YXR1cywgZGVmYXVsdCA9IHN0YWxsCisgICAgKi8KKyAgICB2b2lkICgqYnVs
a19vdXRfcmVxdWVzdCkoU3BpY2VVc2JFbXVsYXRlZERldmljZSAqZGV2aWNlLAorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICB1aW50OF90IGVwLCB1aW50OF90ICpkYXRhLCBpbnQgZGF0YV9s
ZW4sCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQ4X3QgKnN0YXR1cyk7CisgICAg
LyoKKyAgICAgICAgaWYgcmV0dXJucyB0cnVlLCBwcm9jZXNzaW5nIGlzIGFzeW5jaHJvbm91cwor
ICAgICAgICBvdGhlcndpc2UgaGVhZGVyIGNvbnRhaW5zIGVycm9yIHN0YXR1cworICAgICovCisg
ICAgZ2Jvb2xlYW4gKCpidWxrX2luX3JlcXVlc3QpKFNwaWNlVXNiRW11bGF0ZWREZXZpY2UgKmRl
dmljZSwgdWludDY0X3QgaWQsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHVz
Yl9yZWRpcl9idWxrX3BhY2tldF9oZWFkZXIgKmJ1bGtfaGVhZGVyKTsKKyAgICB2b2lkICgqY2Fu
Y2VsX3JlcXVlc3QpKFNwaWNlVXNiRW11bGF0ZWREZXZpY2UgKmRldmljZSwgdWludDY0X3QgaWQp
OworICAgIHZvaWQgKCpkZXRhY2gpKFNwaWNlVXNiRW11bGF0ZWREZXZpY2UgKmRldmljZSk7Cisg
ICAgdm9pZCAoKnVucmVhbGl6ZSkoU3BpY2VVc2JFbXVsYXRlZERldmljZSAqZGV2aWNlKTsKK30g
VXNiRGV2aWNlT3BzOworCitzdGF0aWMgaW5saW5lIGNvbnN0IFVzYkRldmljZU9wcyAqZGV2aWNl
X29wcyhTcGljZVVzYkVtdWxhdGVkRGV2aWNlICpkZXYpCit7CisgICAgcmV0dXJuIChjb25zdCBV
c2JEZXZpY2VPcHMgKilkZXY7Cit9CisKK1NwaWNlVXNiQmFja2VuZERldmljZSoKK3NwaWNlX3Vz
Yl9iYWNrZW5kX2NyZWF0ZV9lbXVsYXRlZF9kZXZpY2UoU3BpY2VVc2JCYWNrZW5kICpiZSwKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU3BpY2VVc2JFbXVsYXRlZERl
dmljZUNyZWF0ZSBjcmVhdGVfcHJvYywKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgdm9pZCAqY3JlYXRlX3BhcmFtcywKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgR0Vycm9yICoqZXJyKTsKK3ZvaWQgc3BpY2VfdXNiX2JhY2tlbmRfZGV2
aWNlX2VqZWN0KFNwaWNlVXNiQmFja2VuZCAqYmUsIFNwaWNlVXNiQmFja2VuZERldmljZSAqZGV2
aWNlKTsKK3ZvaWQgc3BpY2VfdXNiX2JhY2tlbmRfZGV2aWNlX3JlcG9ydF9jaGFuZ2UoU3BpY2VV
c2JCYWNrZW5kICpiZSwgU3BpY2VVc2JCYWNrZW5kRGV2aWNlICpkZXZpY2UpOworCisjZW5kaWYK
LS0gCjIuMTcuMQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X18KU3BpY2UtZGV2ZWwgbWFpbGluZyBsaXN0ClNwaWNlLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9w
Lm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL3NwaWNl
LWRldmVs
